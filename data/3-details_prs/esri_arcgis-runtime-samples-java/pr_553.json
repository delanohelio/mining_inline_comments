{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzODg4NTQ2", "number": 553, "title": "New Sample: Edit with branch versioning", "bodyText": "Description\n\nThe new edit with branch versioning sample ready for review! Few bits of UI going on so it's an FXML sample. Look forward to comments and thoughts. @JonLavi up first :)\nChecklist:\n\n Set target branch to master (current release) or dev (next release)\n Request a reviewer\n Assign a reviewer\n Tag reviewer in comment", "createdAt": "2020-09-10T13:55:41Z", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553", "merged": true, "mergeCommit": {"oid": "4287d509c431fca9bc8d0c4d4ace72234a706fce"}, "closed": true, "closedAt": "2020-10-12T12:47:36Z", "author": {"login": "jenmerritt"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE4qyUgH2gAyNDgzODg4NTQ2OjY0M2ZlODkzNWM0NDNlYzI1ZTgzZThlZjMxNzQ2MTBjZDI1MDkzMDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRyedKAFqTUwNjU0Mzc1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "643fe8935c443ec25e83e8ef3174610cd2509304", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/643fe8935c443ec25e83e8ef3174610cd2509304", "committedDate": "2020-09-02T09:34:21Z", "message": "setup file structure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a166b7899b864d4f70b7b6fcd88702c0b9096b9b", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/a166b7899b864d4f70b7b6fcd88702c0b9096b9b", "committedDate": "2020-09-02T10:08:22Z", "message": "load feature layer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8379d7827e73e88316624186d794ef051f35b0ed", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/8379d7827e73e88316624186d794ef051f35b0ed", "committedDate": "2020-09-03T11:22:00Z", "message": "create and switch versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f17a4adbb7994ae82f76d97c4e20f1b3cce6a733", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/f17a4adbb7994ae82f76d97c4e20f1b3cce6a733", "committedDate": "2020-09-04T14:43:37Z", "message": "ui layout, update and switch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f49b8a2be34316c649ca0f0be41be1db68e126c", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/8f49b8a2be34316c649ca0f0be41be1db68e126c", "committedDate": "2020-09-08T15:54:09Z", "message": "update geometry functionality"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67e9e5fccbf455a276c1c012d2f154706210a484", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/67e9e5fccbf455a276c1c012d2f154706210a484", "committedDate": "2020-09-10T10:30:56Z", "message": "refactor methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ea34e800d1adf418c1db2a756625937fde132fe", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/0ea34e800d1adf418c1db2a756625937fde132fe", "committedDate": "2020-09-10T12:39:00Z", "message": "tidy up spacing and comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e12a14c294f6b768731725d2d281e2a12099509", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/2e12a14c294f6b768731725d2d281e2a12099509", "committedDate": "2020-09-10T13:08:38Z", "message": "update readme and add screenshot"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad82e32a668af85b12891b40df1679aae2f8f3f9", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/ad82e32a668af85b12891b40df1679aae2f8f3f9", "committedDate": "2020-09-10T13:46:02Z", "message": "update metadata file with script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/83e9ff1c86eb2d1955d8b3661d03676ed34e8885", "committedDate": "2020-09-10T13:49:39Z", "message": "correction to metadata file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MDE4ODk4", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#pullrequestreview-486018898", "createdAt": "2020-09-10T14:51:06Z", "commit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "state": "COMMENTED", "comments": {"totalCount": 38, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNDo1MTowN1rOHP37lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwODowNzo0MlrOHQSwYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwNzA2MQ==", "bodyText": "There's an extra newline here that could be deleted", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486407061", "createdAt": "2020-09-10T14:51:07Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningSample.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.io.IOException;\n+\n+import javafx.application.Application;\n+import javafx.fxml.FXMLLoader;\n+import javafx.scene.Parent;\n+import javafx.scene.Scene;\n+import javafx.stage.Stage;\n+\n+public class EditWithBranchVersioningSample extends Application {\n+\n+  private static EditWithBranchVersioningController controller;\n+\n+  @Override\n+  public void start(Stage stage) throws IOException {\n+\n+    FXMLLoader loader = new FXMLLoader(getClass().getResource(\"/edit_with_branch_versioning/main.fxml\"));\n+    Parent root = loader.load();\n+    controller = loader.getController();\n+    Scene scene = new Scene(root);\n+\n+    // set title, size, and add scene to stage\n+    stage.setTitle(\"Edit With Branch Versioning Sample\");\n+    stage.setWidth(800);\n+    stage.setHeight(700);\n+    stage.setScene(scene);\n+    stage.show();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwNzE4Mw==", "bodyText": "Another newline I think we could delete", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486407183", "createdAt": "2020-09-10T14:51:17Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningSample.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.io.IOException;\n+\n+import javafx.application.Application;\n+import javafx.fxml.FXMLLoader;\n+import javafx.scene.Parent;\n+import javafx.scene.Scene;\n+import javafx.stage.Stage;\n+\n+public class EditWithBranchVersioningSample extends Application {\n+\n+  private static EditWithBranchVersioningController controller;\n+\n+  @Override\n+  public void start(Stage stage) throws IOException {\n+\n+    FXMLLoader loader = new FXMLLoader(getClass().getResource(\"/edit_with_branch_versioning/main.fxml\"));\n+    Parent root = loader.load();\n+    controller = loader.getController();\n+    Scene scene = new Scene(root);\n+\n+    // set title, size, and add scene to stage\n+    stage.setTitle(\"Edit With Branch Versioning Sample\");\n+    stage.setWidth(800);\n+    stage.setHeight(700);\n+    stage.setScene(scene);\n+    stage.show();\n+\n+  }\n+\n+  /**\n+   * Stops and releases all resources used in application.\n+   */\n+  @Override\n+  public void stop() {\n+    controller.terminate();\n+  }\n+\n+  /**\n+   * Opens and runs application.\n+   *\n+   * @param args arguments passed to this application\n+   */\n+  public static void main(String[] args) {\n+\n+    Application.launch(args);\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwOTQ0OA==", "bodyText": "Are we sure we can't do this in the CSS file?\nIt definitely works for some samples:\nhttps://github.com/Esri/arcgis-runtime-samples-java/search?q=-fx-background-color&unscoped_q=-fx-background-color\nBut doesn't work so well for others:\nhttps://github.com/Esri/arcgis-runtime-samples-java/pull/537/files#diff-38e17ddf73e7e54f8c694abad3ecd67cL3\nIf anything it might be worth trying to figure out why it breaks the SV in some cases", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486409448", "createdAt": "2020-09-10T14:54:20Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/resources/edit_with_branch_versioning/main.fxml", "diffHunk": "@@ -0,0 +1,96 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Copyright 2020 Esri.\n+  ~\n+  ~ Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+  ~ use this file except in compliance with the License. You may obtain a copy of\n+  ~ the License at\n+  ~\n+  ~ http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+  ~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+  ~ License for the specific language governing permissions and limitations under\n+  ~ the License.\n+  -->\n+\n+<?import javafx.scene.layout.StackPane?>\n+<?import javafx.scene.layout.VBox?>\n+<?import javafx.geometry.Insets?>\n+<?import javafx.scene.layout.Background?>\n+<?import javafx.scene.layout.BackgroundFill?>\n+<?import javafx.scene.paint.Color?>\n+<?import javafx.scene.control.Label?>\n+<?import javafx.scene.control.Button?>\n+<?import javafx.scene.control.ProgressIndicator?>\n+<?import javafx.scene.control.TextField?>\n+<?import javafx.scene.control.Separator?>\n+<?import javafx.scene.control.ComboBox?>\n+<?import com.esri.arcgisruntime.mapping.view.MapView?>\n+\n+<StackPane fx:controller=\"com.esri.samples.edit_with_branch_versioning.EditWithBranchVersioningController\" xmlns:fx=\"http://javafx.com/fxml\"\n+           stylesheets=\"/edit_with_branch_versioning/style.css\">\n+    <!--SDK MapView-->\n+    <MapView fx:id=\"mapView\"/>\n+    <ProgressIndicator fx:id=\"progressIndicator\" maxWidth=\"25\" maxHeight=\"25\"/>\n+    <!--Controls box for version controls-->\n+    <VBox StackPane.alignment=\"TOP_LEFT\" maxWidth=\"250\" maxHeight=\"170\" spacing=\"10\" styleClass=\"panel-region\">\n+        <padding>\n+            <Insets topRightBottomLeft=\"10\"/>\n+        </padding>\n+        <background>\n+            <Background>\n+                <fills>\n+                    <BackgroundFill>\n+                        <fill>\n+                            <Color opacity=\"0.6\"/>\n+                        </fill>\n+                    </BackgroundFill>\n+                </fills>\n+            </Background>\n+        </background>\n+        <Label fx:id=\"currentVersionLabel\" text=\"Current version: \"/>\n+        <Button fx:id=\"switchVersionButton\" text=\"Switch version\" onMouseClicked=\"#handleSwitchVersionButtonClicked\"/>\n+        <Separator/>\n+        <!--Controls box for editing features-->\n+        <VBox fx:id=\"editFeatureVBox\">\n+            <Label text=\"Edit feature attributes\" styleClass=\"header-label\"/>\n+            <Label text=\"Damage type:\"/>\n+            <ComboBox fx:id=\"damageTypeComboBox\" />\n+        </VBox>\n+    </VBox>\n+    <!--Controls box for creating new version-->\n+    <VBox fx:id=\"createVersionVBox\" StackPane.alignment=\"TOP_RIGHT\" maxWidth=\"250\" maxHeight=\"220\" spacing=\"5\" styleClass=\"panel-region\">\n+        <padding>\n+            <Insets topRightBottomLeft=\"10\"/>\n+        </padding>\n+        <background>\n+            <Background>\n+                <fills>\n+                    <BackgroundFill>\n+                        <fill>\n+                            <Color opacity=\"0.6\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQxMDQxMQ==", "bodyText": "Github is telling us that there's a newline missing here", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486410411", "createdAt": "2020-09-10T14:55:37Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/resources/edit_with_branch_versioning/style.css", "diffHunk": "@@ -0,0 +1,7 @@\n+.panel-region .label {\n+  -fx-text-fill: white;\n+}\n+\n+.panel-region .header-label {\n+  -fx-font-size: 14;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQxODgyNA==", "bodyText": "We should call the mouse buttons 'primary' and 'secondary' this is because some people swap the functions on their mouse buttons, so we'd want to be inclusive \ud83d\ude04", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486418824", "createdAt": "2020-09-10T15:06:45Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature to edit an attribute and/or click again with the right mouse button to relocate the point.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQyMjg1Mg==", "bodyText": "A better way to check if a collection is empty is .isEmpty():\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (edits == null || edits.size() == 0) {\n          \n          \n            \n                        if (edits == null || edits.isEmpty()) {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486422852", "createdAt": "2020-09-10T15:12:10Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 247}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQyMzY0MQ==", "bodyText": "Let's just make sure this is alphabetised:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import javafx.fxml.FXML;\n          \n          \n            \n            import javafx.scene.control.Alert;\n          \n          \n            \n            import javafx.scene.control.Button;\n          \n          \n            \n            import javafx.scene.control.ComboBox;\n          \n          \n            \n            import javafx.scene.control.Label;\n          \n          \n            \n            import javafx.scene.control.ProgressIndicator;\n          \n          \n            \n            import javafx.scene.control.TextField;\n          \n          \n            \n            import javafx.scene.input.MouseButton;\n          \n          \n            \n            import javafx.scene.layout.VBox;\n          \n          \n            \n            import javafx.geometry.Point2D;\n          \n          \n            \n            import javafx.fxml.FXML;\n          \n          \n            \n            import javafx.geometry.Point2D;\n          \n          \n            \n            import javafx.scene.control.Alert;\n          \n          \n            \n            import javafx.scene.control.Button;\n          \n          \n            \n            import javafx.scene.control.ComboBox;\n          \n          \n            \n            import javafx.scene.control.Label;\n          \n          \n            \n            import javafx.scene.control.ProgressIndicator;\n          \n          \n            \n            import javafx.scene.control.TextField;\n          \n          \n            \n            import javafx.scene.input.MouseButton;\n          \n          \n            \n            import javafx.scene.layout.VBox;", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486423641", "createdAt": "2020-09-10T15:13:17Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQyNDExMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n          \n          \n            \n                      if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486424113", "createdAt": "2020-09-10T15:13:58Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 157}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQyNDM2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n          \n          \n            \n                } else if (name.getText().length() > 0 && Character.isWhitespace(name.getText().charAt(0))) {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486424367", "createdAt": "2020-09-10T15:14:17Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 182}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQyNTAyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private void selectFeature(Point2D point){\n          \n          \n            \n              private void selectFeature(Point2D point) {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486425026", "createdAt": "2020-09-10T15:15:08Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      } else {\n+        // if there are no local edits, switch to the default version\n+        switchVersion(defaultVersion);\n+      }\n+    } else if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        new Alert(Alert.AlertType.ERROR, \"Error switching version.\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 290}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQyNTUyMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              void terminate () {\n          \n          \n            \n              void terminate() {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486425522", "createdAt": "2020-09-10T15:15:48Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      } else {\n+        // if there are no local edits, switch to the default version\n+        switchVersion(defaultVersion);\n+      }\n+    } else if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        new Alert(Alert.AlertType.ERROR, \"Error switching version.\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point){\n+    ListenableFuture<IdentifyLayerResult> results = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    results.addDoneListener(() -> {\n+      try {\n+        IdentifyLayerResult layer = results.get();\n+        List<GeoElement> identified = layer.getElements();\n+        if (!identified.isEmpty()) {\n+          GeoElement element = identified.get(0);\n+          if (element instanceof ArcGISFeature) {\n+            // get the selected feature\n+            selectedFeature = (ArcGISFeature) element;\n+            featureLayer.selectFeature(selectedFeature);\n+            selectedFeature.loadAsync();\n+            selectedFeature.addDoneLoadingListener(() -> {\n+              if (selectedFeature.getLoadStatus() == LoadStatus.LOADED) {\n+                // when a feature has been selected set the damage combo box to the feature's attribute value\n+                damageTypeComboBox.getSelectionModel().select((String) selectedFeature.getAttributes().get(\"typdamage\"));\n+\n+                // enable feature editing UI if not on the default branch version\n+                if (!serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+                  editFeatureVBox.setDisable(false);\n+                }\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature failed to load.\").show();\n+              }\n+            });\n+          }\n+        }\n+      } catch (InterruptedException | ExecutionException e) {\n+        new Alert(Alert.AlertType.ERROR, \"Exception getting identify result\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Update the selected feature in the service feature table\n+   *\n+   * @param selectedFeature the selected feature to be updated\n+   */\n+  private void updateFeature(ArcGISFeature selectedFeature) {\n+    if (serviceFeatureTable.canUpdate(selectedFeature) && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // update the feature in the feature table\n+      ListenableFuture<Void> editResult = serviceFeatureTable.updateFeatureAsync(selectedFeature);\n+      editResult.addDoneListener(() -> {\n+        Alert alert = new Alert(Alert.AlertType.INFORMATION);\n+        alert.setHeaderText(\"Feature updated\");\n+        alert.setContentText(\"Changes will be synced to the service geodatabase\\nwhen you switch branch.\");\n+        alert.show();\n+      });\n+    } else {\n+      new Alert(Alert.AlertType.ERROR, \"Feature cannot be updated\").show();\n+    }\n+  }\n+\n+  /**\n+   * Disposes application resources.\n+   */\n+  void terminate () {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 347}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ2MDU2Ng==", "bodyText": "For some reason in the UI the last two elements are much closer to each other than the previous label and button (lines 53-54). Looks as if the spacing from line 38 doesn't apply to this internal vbox, so adding extra spacing here gives the whole thing a bit more breathing space.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    <VBox fx:id=\"editFeatureVBox\">\n          \n          \n            \n                        <Label text=\"Edit feature attributes\" styleClass=\"header-label\"/>\n          \n          \n            \n                        <Label text=\"Damage type:\"/>\n          \n          \n            \n                        <ComboBox fx:id=\"damageTypeComboBox\" />\n          \n          \n            \n                    <VBox fx:id=\"editFeatureVBox\" spacing=\"10\">\n          \n          \n            \n                        <Label text=\"Edit feature attributes\" styleClass=\"header-label\"/>\n          \n          \n            \n                        <Label text=\"Damage type:\"/>\n          \n          \n            \n                        <ComboBox fx:id=\"damageTypeComboBox\" />", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486460566", "createdAt": "2020-09-10T16:04:15Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/resources/edit_with_branch_versioning/main.fxml", "diffHunk": "@@ -0,0 +1,96 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Copyright 2020 Esri.\n+  ~\n+  ~ Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+  ~ use this file except in compliance with the License. You may obtain a copy of\n+  ~ the License at\n+  ~\n+  ~ http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+  ~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+  ~ License for the specific language governing permissions and limitations under\n+  ~ the License.\n+  -->\n+\n+<?import javafx.scene.layout.StackPane?>\n+<?import javafx.scene.layout.VBox?>\n+<?import javafx.geometry.Insets?>\n+<?import javafx.scene.layout.Background?>\n+<?import javafx.scene.layout.BackgroundFill?>\n+<?import javafx.scene.paint.Color?>\n+<?import javafx.scene.control.Label?>\n+<?import javafx.scene.control.Button?>\n+<?import javafx.scene.control.ProgressIndicator?>\n+<?import javafx.scene.control.TextField?>\n+<?import javafx.scene.control.Separator?>\n+<?import javafx.scene.control.ComboBox?>\n+<?import com.esri.arcgisruntime.mapping.view.MapView?>\n+\n+<StackPane fx:controller=\"com.esri.samples.edit_with_branch_versioning.EditWithBranchVersioningController\" xmlns:fx=\"http://javafx.com/fxml\"\n+           stylesheets=\"/edit_with_branch_versioning/style.css\">\n+    <!--SDK MapView-->\n+    <MapView fx:id=\"mapView\"/>\n+    <ProgressIndicator fx:id=\"progressIndicator\" maxWidth=\"25\" maxHeight=\"25\"/>\n+    <!--Controls box for version controls-->\n+    <VBox StackPane.alignment=\"TOP_LEFT\" maxWidth=\"250\" maxHeight=\"170\" spacing=\"10\" styleClass=\"panel-region\">\n+        <padding>\n+            <Insets topRightBottomLeft=\"10\"/>\n+        </padding>\n+        <background>\n+            <Background>\n+                <fills>\n+                    <BackgroundFill>\n+                        <fill>\n+                            <Color opacity=\"0.6\"/>\n+                        </fill>\n+                    </BackgroundFill>\n+                </fills>\n+            </Background>\n+        </background>\n+        <Label fx:id=\"currentVersionLabel\" text=\"Current version: \"/>\n+        <Button fx:id=\"switchVersionButton\" text=\"Switch version\" onMouseClicked=\"#handleSwitchVersionButtonClicked\"/>\n+        <Separator/>\n+        <!--Controls box for editing features-->\n+        <VBox fx:id=\"editFeatureVBox\">\n+            <Label text=\"Edit feature attributes\" styleClass=\"header-label\"/>\n+            <Label text=\"Damage type:\"/>\n+            <ComboBox fx:id=\"damageTypeComboBox\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ2MTg0MA==", "bodyText": "Maybe it'd be helpful to sort the items in each block alphabetically? It kind of makes it easier to find a specific element.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486461840", "createdAt": "2020-09-10T16:05:42Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ2Mzk3MA==", "bodyText": "All these variables are used in several methods, so I think they would have to be class members anyway? What I'm getting at is that the comment about GC is possibly not necessary. I don't remember the exact details about the GC bug though, so I might be wrong!", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486463970", "createdAt": "2020-09-10T16:08:25Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ2NTEwMw==", "bodyText": "You can do this in the fxml file by adding disable=\"true\". That parameter would apply to the elements when the app is started up, and will then be overwritten when the state changes (e.g. through the method calls)", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486465103", "createdAt": "2020-09-10T16:10:03Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ2OTU4NA==", "bodyText": "In previous samples we didn't chop longer lines because of URLs. So in theory we could write this on one line, but I'm not too fussed either way", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486469584", "createdAt": "2020-09-10T16:16:48Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3MDgyMA==", "bodyText": "Not sure about whether an established pattern exists for this kind of operation. In some other samples we do .addDoneLoadingListener() first, then call .loadAsync(). Again, I'm not too fussed which way it goes, but would be nice if it were consistent \ud83d\ude04 Maybe add something to the contribution guide as well, once this is decided?\nBecause we do things with async operations in this order (async call first, then add listener):\nListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\nresultOfApplyEdits.addDoneListener(() -> {\n\nIt might be best to do it the way you have here (loadAsync first, then add listener).\nI think we could add this to the contribution guide, and perhaps even make an issue for technical debt to make this all consistent", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486470820", "createdAt": "2020-09-10T16:18:45Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3NDM5Ng==", "bodyText": "technically we're not hiding the progressIndicator if this error message is hit. Not that it matters, because if we got this far the samples is not very useful anyway \ud83d\ude1b .\nIf you wanted, you could put the line hiding the indicator (128) directly beneath line 123\n(`featureLayer.addDoneLoadingListener(() -> {)\n\nThat way, the indicator disappears as soon as the layer is 'done' loading, regardless of which LoadStatus comes back.\nThis is being a bit pedantic though - maybe samples readability is better with the call on progressIndicator where it is right now", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486474396", "createdAt": "2020-09-10T16:24:16Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 133}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3NjMxMQ==", "bodyText": "Let's add a comment here to tell the users roughly what's going on in the block, something along the lines of :\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  mapView.setOnMouseClicked(event -> {\n          \n          \n            \n            \t  // listen to clicks on the map to select or move features\n          \n          \n            \n                  mapView.setOnMouseClicked(event -> {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486476311", "createdAt": "2020-09-10T16:27:07Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3NjYwNw==", "bodyText": "Technically we're not just selectin 'a' feature, but the one we clicked on:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      // select a feature\n          \n          \n            \n                      // select the clicked feature", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486476607", "createdAt": "2020-09-10T16:27:34Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 150}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3ODU5NQ==", "bodyText": "We could call this var 'point' as well, because there wouldn't be any clash with the variable defined above (it's in a different scope). However I see the benefit for users to give this a different name, so I wouldn't mind leaving it as is as well.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n          \n          \n            \n                        Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n          \n          \n            \n                        Point2D point = new Point2D(event.getX(), event.getY());\n          \n          \n            \n                        Point mapPoint = mapView.screenToLocation(point);", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486478595", "createdAt": "2020-09-10T16:30:47Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 159}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyMjI3Mg==", "bodyText": "Lets be a bit more specific with these variable names and call them nameTextField, etc.\nI noticed these in the code below and it said name.getText(), which was a bit confusing without knowing what king of object name was.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486822272", "createdAt": "2020-09-11T07:19:25Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyMzU0MQ==", "bodyText": "I think it would be helpful to elaborate on this message to tell the user why their input is invalid (e.g.\nThe name cannot contain the following characters:  \n. ; ' \\", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486823541", "createdAt": "2020-09-11T07:22:03Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 180}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyNTIwNQ==", "bodyText": "Also wondering, can it contain other special characters? e.g. $%&*, etc?\nMight be easier to just restrict the input to roman letters (Maybe there's a method for it, like .isWhitespace?).", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486825205", "createdAt": "2020-09-11T07:25:34Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyMzU0MQ=="}, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 180}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyNjQ3MA==", "bodyText": "The is a very clear way of limiting the input, and the resulting message is also very helpful.\nIn case you were interested, there's also the option of adding a listener to the TextField, to stop users from typing in invalid characters alltogether:\nhttps://stackoverflow.com/questions/15615890/recommended-way-to-restrict-input-in-javafx-textfield\nI always find it a bit frustrating though when I try and type into a field and no characters appear, so much prefer the way you did it here (giving an error when trying to submit).", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486826470", "createdAt": "2020-09-11T07:28:10Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 177}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyNzIxOQ==", "bodyText": "The parameters are named newVersionParameters, so perhaps it'd be more consistent to call this variable newVersion?", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486827219", "createdAt": "2020-09-11T07:29:48Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 210}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyODYwOQ==", "bodyText": "I think a newline here would help separate these two blocks a bit better\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    switchVersionButton.setDisable(false);\n          \n          \n            \n                  } catch (Exception ex) {\n          \n          \n            \n                    switchVersionButton.setDisable(false);\n          \n          \n            \n            \n          \n          \n            \n                  } catch (Exception ex) {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486828609", "createdAt": "2020-09-11T07:32:45Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 221}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgyOTIzNQ==", "bodyText": "This error message might be a bit confusing. If the user doesn't know the version name already exists, they might be under the impression that it's 'unique' and wouldn't know why it should'nt be? We could elaborate:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n          \n          \n            \n                      new Alert(Alert.AlertType.ERROR, \"A service version with this name already exists. Please enter a unique version name\").show();", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486829235", "createdAt": "2020-09-11T07:34:14Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 224}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgzNDQ1MA==", "bodyText": "Perhaps it would be a bit easier to read if we got this 'simple' if case out of the way first, and then moved to the more complex one?\nReally just depends on the story you want to tell!\nif (if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n // do a small thing\n\n} else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n // do the more complex thing\n}", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486834450", "createdAt": "2020-09-11T07:44:39Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      } else {\n+        // if there are no local edits, switch to the default version\n+        switchVersion(defaultVersion);\n+      }\n+    } else if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 264}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgzNjUxOQ==", "bodyText": "Javadoc style annotation usually has full stops at the end. Looks like this applies to the rest of the javadoc as well, so remember to update them \ud83d\ude04\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Create a new branch version using user defined values\n          \n          \n            \n               * Create a new branch version using user defined values.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486836519", "createdAt": "2020-09-11T07:48:33Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 172}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgzODIxNQ==", "bodyText": "We should give the variables in here more recognisable names so it's easier to tell what class the objects are:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                ListenableFuture<IdentifyLayerResult> results = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n          \n          \n            \n                results.addDoneListener(() -> {\n          \n          \n            \n                  try {\n          \n          \n            \n                    IdentifyLayerResult layer = results.get();\n          \n          \n            \n                    List<GeoElement> identified = layer.getElements();\n          \n          \n            \n                    if (!identified.isEmpty()) {\n          \n          \n            \n                      GeoElement element = identified.get(0);\n          \n          \n            \n                ListenableFuture<IdentifyLayerResult> identifyLayerResultFuture = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n          \n          \n            \n                identifyLayerResultFuture.addDoneListener(() -> {\n          \n          \n            \n                  try {\n          \n          \n            \n                    IdentifyLayerResult identifyLayerResult = identifyLayerResultFuture.get();\n          \n          \n            \n                    List<GeoElement> identifiedElements = identifyLayerResult.getElements();\n          \n          \n            \n                    if (!identifiedElements.isEmpty()) {\n          \n          \n            \n                      GeoElement element = identifiedElements.get(0);", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486838215", "createdAt": "2020-09-11T07:51:53Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      } else {\n+        // if there are no local edits, switch to the default version\n+        switchVersion(defaultVersion);\n+      }\n+    } else if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        new Alert(Alert.AlertType.ERROR, \"Error switching version.\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point){\n+    ListenableFuture<IdentifyLayerResult> results = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    results.addDoneListener(() -> {\n+      try {\n+        IdentifyLayerResult layer = results.get();\n+        List<GeoElement> identified = layer.getElements();\n+        if (!identified.isEmpty()) {\n+          GeoElement element = identified.get(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 297}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjgzOTE2NQ==", "bodyText": "This is quite a long statement, perhaps it'd be easier to recognise what's happening if we split it a bit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            damageTypeComboBox.getSelectionModel().select((String) selectedFeature.getAttributes().get(\"typdamage\"));\n          \n          \n            \n            \t\t\t\tString attributeValue = (String) selectedFeature.getAttributes().get(\"typdamage\");\n          \n          \n            \n                            damageTypeComboBox.getSelectionModel().select(attributeValue);\n          \n      \n    \n    \n  \n\nOverall this seems like quite a 'risky' way of correlating between the attribute and the item in the ComboBox. We'd have to know for 100% certainty that the result of the attribute exists within the combobox, otherwise the app would crash with quite a nasty error.\nMight be worth thinking about adding a method that checks attributeValue against the options available in the ComboBox, and returns an error if it doesn't exist? We know this wouldn't happen in our sample, but should a user borrow this code for their app, we might want to make sure there's some validation (which would be 'best practice'). If it complicates the sample too much, then it should be ok to just leave it.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486839165", "createdAt": "2020-09-11T07:53:33Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      } else {\n+        // if there are no local edits, switch to the default version\n+        switchVersion(defaultVersion);\n+      }\n+    } else if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        new Alert(Alert.AlertType.ERROR, \"Error switching version.\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point){\n+    ListenableFuture<IdentifyLayerResult> results = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    results.addDoneListener(() -> {\n+      try {\n+        IdentifyLayerResult layer = results.get();\n+        List<GeoElement> identified = layer.getElements();\n+        if (!identified.isEmpty()) {\n+          GeoElement element = identified.get(0);\n+          if (element instanceof ArcGISFeature) {\n+            // get the selected feature\n+            selectedFeature = (ArcGISFeature) element;\n+            featureLayer.selectFeature(selectedFeature);\n+            selectedFeature.loadAsync();\n+            selectedFeature.addDoneLoadingListener(() -> {\n+              if (selectedFeature.getLoadStatus() == LoadStatus.LOADED) {\n+                // when a feature has been selected set the damage combo box to the feature's attribute value\n+                damageTypeComboBox.getSelectionModel().select((String) selectedFeature.getAttributes().get(\"typdamage\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 306}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0MTkyMA==", "bodyText": "exception is a bit of a technical term in a message that's shown to the end user. Perhaps this would be simpler?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    new Alert(Alert.AlertType.ERROR, \"Exception getting identify result\").show();\n          \n          \n            \n                    new Alert(Alert.AlertType.ERROR, \"Failed to identify the feature\").show();", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486841920", "createdAt": "2020-09-11T07:58:33Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;\n+\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private FeatureLayer featureLayer; // keeps loadable in scope to avoid garbage collection\n+  private ArcGISFeature selectedFeature; // keeps loadable in scope to avoid garbage collection\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // configure the initial UI settings\n+      createVersionButton.setDisable(true);\n+      switchVersionButton.setDisable(true);\n+      editFeatureVBox.setDisable(true);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"typdamage\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"typdamage\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select a feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current branch version is not the default, update the feature's geometry\n+          if(selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)){\n+            Point2D secondaryClickPoint = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(secondaryClickPoint);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n+      name.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+      return;\n+    } else if (name.getText().length()> 0 && Character.isWhitespace(name.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (name.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (name.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(name.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(description.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> createdVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    createdVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = createdVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"Please enter a unique version name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+    if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the user created version has local edits, apply the edits to the service geodatabase\n+      if (serviceGeodatabase.hasLocalEdits()) {\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.size() == 0) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      } else {\n+        // if there are no local edits, switch to the default version\n+        switchVersion(defaultVersion);\n+      }\n+    } else if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        new Alert(Alert.AlertType.ERROR, \"Error switching version.\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point){\n+    ListenableFuture<IdentifyLayerResult> results = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    results.addDoneListener(() -> {\n+      try {\n+        IdentifyLayerResult layer = results.get();\n+        List<GeoElement> identified = layer.getElements();\n+        if (!identified.isEmpty()) {\n+          GeoElement element = identified.get(0);\n+          if (element instanceof ArcGISFeature) {\n+            // get the selected feature\n+            selectedFeature = (ArcGISFeature) element;\n+            featureLayer.selectFeature(selectedFeature);\n+            selectedFeature.loadAsync();\n+            selectedFeature.addDoneLoadingListener(() -> {\n+              if (selectedFeature.getLoadStatus() == LoadStatus.LOADED) {\n+                // when a feature has been selected set the damage combo box to the feature's attribute value\n+                damageTypeComboBox.getSelectionModel().select((String) selectedFeature.getAttributes().get(\"typdamage\"));\n+\n+                // enable feature editing UI if not on the default branch version\n+                if (!serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+                  editFeatureVBox.setDisable(false);\n+                }\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature failed to load.\").show();\n+              }\n+            });\n+          }\n+        }\n+      } catch (InterruptedException | ExecutionException e) {\n+        new Alert(Alert.AlertType.ERROR, \"Exception getting identify result\").show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 319}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0MzcyNA==", "bodyText": "Might also be worth alphabetising these?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              @FXML private MapView mapView;\n          \n          \n            \n              @FXML private ProgressIndicator progressIndicator;\n          \n          \n            \n              @FXML private Button createVersionButton;\n          \n          \n            \n              @FXML private Button switchVersionButton;\n          \n          \n            \n              @FXML private VBox editFeatureVBox;\n          \n          \n            \n              @FXML private ComboBox<VersionAccess> accessComboBox;\n          \n          \n            \n              @FXML private ComboBox<String> damageTypeComboBox;\n          \n          \n            \n              @FXML private Label currentVersionLabel;\n          \n          \n            \n              @FXML private VBox createVersionVBox;\n          \n          \n            \n              @FXML private TextField name;\n          \n          \n            \n              @FXML private TextField description;\n          \n          \n            \n              @FXML private Button createVersionButton;\n          \n          \n            \n              @FXML private Button switchVersionButton;\n          \n          \n            \n              @FXML private ComboBox<String> damageTypeComboBox;\n          \n          \n            \n              @FXML private ComboBox<VersionAccess> accessComboBox;\n          \n          \n            \n              @FXML private Label currentVersionLabel;\n          \n          \n            \n              @FXML private MapView mapView;\n          \n          \n            \n              @FXML private ProgressIndicator progressIndicator;\n          \n          \n            \n              @FXML private TextField description;\n          \n          \n            \n              @FXML private TextField name;\n          \n          \n            \n              @FXML private VBox createVersionVBox;\n          \n          \n            \n              @FXML private VBox editFeatureVBox;", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486843724", "createdAt": "2020-09-11T08:02:11Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,352 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+import javafx.geometry.Point2D;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private VBox editFeatureVBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private TextField name;\n+  @FXML private TextField description;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0NDkyMQ==", "bodyText": "Create a new version by calling ServiceGeodatabase.createVersionAsync() and passing in the service version parameters.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486844921", "createdAt": "2020-09-11T08:04:35Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature to edit an attribute and/or click again with the right mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.\n+2. Get the `ServiceFeatureTable` from the service geodatabase.\n+3. Create a `FeatureLayer` from the service feature table.\n+4. Create `ServiceVersionParameters` with a unique name, `VersionAccess`, and description.\n+    * Note - See the additional information section for more restrictions on the version name.\n+5. Create a new version calling `ServiceGeodatabase.createVersionAsync()` passing in the service version parameters.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0NTc4Nw==", "bodyText": "I would probably phrase this a little differently.\nPerhaps\nRetreive the result of the async call, to obtain the `ServiceVersionInfo` of the version created.\n\nAlso ServiceVersionInfo wasn't mentioned yet, so I think it can be in backticks", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486845787", "createdAt": "2020-09-11T08:06:16Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature to edit an attribute and/or click again with the right mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.\n+2. Get the `ServiceFeatureTable` from the service geodatabase.\n+3. Create a `FeatureLayer` from the service feature table.\n+4. Create `ServiceVersionParameters` with a unique name, `VersionAccess`, and description.\n+    * Note - See the additional information section for more restrictions on the version name.\n+5. Create a new version calling `ServiceGeodatabase.createVersionAsync()` passing in the service version parameters.\n+6. Connect to a `ListenableFuture<ServiceVersionInfo>` to obtain the ServiceVersionInfo of the version created.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0NjEzMQ==", "bodyText": "I don't think it's necessary to specify 'step 6':\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            7. Switch to the version you have just created using `ServiceGeodatabase.switchVersionAsync()`, passing in the version name obtained from the service version info from *step 6*.\n          \n          \n            \n            7. Switch to the version you have just created using `ServiceGeodatabase.switchVersionAsync()`, passing in the version name obtained from the service version info.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486846131", "createdAt": "2020-09-11T08:06:56Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature to edit an attribute and/or click again with the right mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.\n+2. Get the `ServiceFeatureTable` from the service geodatabase.\n+3. Create a `FeatureLayer` from the service feature table.\n+4. Create `ServiceVersionParameters` with a unique name, `VersionAccess`, and description.\n+    * Note - See the additional information section for more restrictions on the version name.\n+5. Create a new version calling `ServiceGeodatabase.createVersionAsync()` passing in the service version parameters.\n+6. Connect to a `ListenableFuture<ServiceVersionInfo>` to obtain the ServiceVersionInfo of the version created.\n+7. Switch to the version you have just created using `ServiceGeodatabase.switchVersionAsync()`, passing in the version name obtained from the service version info from *step 6*.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njg0NjU2MQ==", "bodyText": "The attribute is \"typdamage\" everywhere in our code, so maybe we need to update it?\nIf it's SQL then it should probably be uppercase everywhere", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r486846561", "createdAt": "2020-09-11T08:07:42Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature to edit an attribute and/or click again with the right mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.\n+2. Get the `ServiceFeatureTable` from the service geodatabase.\n+3. Create a `FeatureLayer` from the service feature table.\n+4. Create `ServiceVersionParameters` with a unique name, `VersionAccess`, and description.\n+    * Note - See the additional information section for more restrictions on the version name.\n+5. Create a new version calling `ServiceGeodatabase.createVersionAsync()` passing in the service version parameters.\n+6. Connect to a `ListenableFuture<ServiceVersionInfo>` to obtain the ServiceVersionInfo of the version created.\n+7. Switch to the version you have just created using `ServiceGeodatabase.switchVersionAsync()`, passing in the version name obtained from the service version info from *step 6*.\n+8. Select a `Feature` from the map to edit it's \"TYPDAMAGE\" attribute and location.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e9ff1c86eb2d1955d8b3661d03676ed34e8885"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8a70300cc1734118b9e5f368a9429b0aa0f7cfc", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/d8a70300cc1734118b9e5f368a9429b0aa0f7cfc", "committedDate": "2020-09-11T09:48:21Z", "message": "tidy ups from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16e642f5973edc69326b0390a98cc4548d6c8967", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/16e642f5973edc69326b0390a98cc4548d6c8967", "committedDate": "2020-09-14T09:48:10Z", "message": "tidy ups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/02dd594e7f66cb6d631fcad981ae76384b4c6832", "committedDate": "2020-09-17T13:11:02Z", "message": "code review changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNjAyNTYy", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#pullrequestreview-490602562", "createdAt": "2020-09-17T13:36:53Z", "commit": {"oid": "d8a70300cc1734118b9e5f368a9429b0aa0f7cfc"}, "state": "COMMENTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMzozNjo1NFrOHTinPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNDoxNDo1NFrOHTkaJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1MjA5NA==", "bodyText": "I'm just thinking since we repeat nameTextField.getText() so many times here, we could save this to a variable, eg. String inputName = nameTextField.getText();\nand then refer to the variable within these if/else satements, as well as on line 202.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490252094", "createdAt": "2020-09-17T13:36:54Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -169,23 +170,23 @@ public void initialize() {\n   }\n \n   /**\n-   * Create a new branch version using user defined values\n+   * Create a new branch version using user defined values.\n    */\n   @FXML\n   private void handleCreateVersionButtonClicked() {\n \n     // validate version name input\n-    if (name.getText().contains(\".\") || name.getText().contains(\";\") || name.getText().contains(\"'\") ||\n-      name.getText().contains(\"\\\"\")) {\n-      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name\").show();\n+    if (nameTextField.getText().contains(\".\") || nameTextField.getText().contains(\";\") || nameTextField.getText().contains(\"'\") ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8a70300cc1734118b9e5f368a9429b0aa0f7cfc"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1MzU5MA==", "bodyText": "Although we could use the predictive typing var here (it's more modern and sleek), since we're trying to demonstrate how the API works, lets declare this variable with the full type (as you had it before):\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    var identifyLayerResult = identifyLayerResultFuture.get();\n          \n          \n            \n                    IdentifyLayerResult identifyLayerResult = identifyLayerResultFuture.get();\n          \n      \n    \n    \n  \n\nThat would help the users understand what the return type is of the .get()\nSame would apply to line 299:\nGeoElement element = identified.get(0);", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490253590", "createdAt": "2020-09-17T13:38:59Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -283,18 +285,18 @@ private void switchVersion(String versionName) {\n   }\n \n   /**\n-   * Select a feature if one exists where the user clicked\n+   * Select a feature if one exists where the user clicked.\n    *\n    * @param point location where the user clicked\n    */\n-  private void selectFeature(Point2D point){\n-    ListenableFuture<IdentifyLayerResult> results = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n-    results.addDoneListener(() -> {\n+  private void selectFeature(Point2D point) {\n+    ListenableFuture<IdentifyLayerResult> identifyLayerResultFuture = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    identifyLayerResultFuture.addDoneListener(() -> {\n       try {\n-        IdentifyLayerResult layer = results.get();\n-        List<GeoElement> identified = layer.getElements();\n-        if (!identified.isEmpty()) {\n-          GeoElement element = identified.get(0);\n+        var identifyLayerResult = identifyLayerResultFuture.get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8a70300cc1734118b9e5f368a9429b0aa0f7cfc"}, "originalPosition": 192}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1Njg4NQ==", "bodyText": "Perhaps on more 'advanced' samples, we could consolidate these two lines? The thought would be that users who look at this sample already understand how maps and MapViews work, so they wouldn't need an in-depth explanation of every step?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  // create a map with the streets vector basemap\n          \n          \n            \n                  ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n          \n          \n            \n            \n          \n          \n            \n                  // create a map view and set its map\n          \n          \n            \n                  mapView.setMap(map);\n          \n          \n            \n                  // create a map and set it to the map view\n          \n          \n            \n                  ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n          \n          \n            \n                  mapView.setMap(map);", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490256885", "createdAt": "2020-09-17T13:43:39Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI1ODQ3MA==", "bodyText": "Perhaps we could elaborate here a bit about which combo box / what purpose it serves?\nI'm noticing this because the next comment also says add ... to the combo box, which could be a bit misleading. How about access type combo box and attribute selection combo box?", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490258470", "createdAt": "2020-09-17T13:45:49Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI2MTE1MQ==", "bodyText": "I think this block is worthy of getting a slightly more detailed comment.\nHow about something like\n// add a handler to the damage type combo box the currently selected feature with the attribute selected within the combo box\n\nI'm not the best with these descriptions, so I'll just leave that as a starting point \ud83d\ude09", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490261151", "createdAt": "2020-09-17T13:49:26Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI2Mzg3Mw==", "bodyText": "I think we could get away with removing the try/catch block here, and dealing with any exceptions within a try/catch block within the method updateFeature. This is because it looks like that is the source of any potential exception, so that would be the place to catch/throw them.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490263873", "createdAt": "2020-09-17T13:53:07Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI2NDYyMw==", "bodyText": "I still think this could go in one line (unless we're going to start being more strict about the line character limit)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n          \n          \n            \n                    \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n          \n          \n            \n                  serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline.com/arcgis/rest/services/DamageAssessment/FeatureServer\");", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490264623", "createdAt": "2020-09-17T13:54:05Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI3NDI5NA==", "bodyText": "If we wanted, we could pre-select one of the three options in this combo box, effectively eliminating the scenario where no Item is selected. Eg. after adding the enum values to the box:\naccessComboBox.getSelectionModel().select(VersionAccess.PUBLIC);   \n\nThat way you could get rid of this block entirely.\nHowever I do like the way it is right now, with the prompt 'select', as it doesn't imply any of these options are the 'standard'. So feel free to keep it as is! Just thought it'd be woth mentioning pre-selecting a value.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490274294", "createdAt": "2020-09-17T14:05:54Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (nameTextField.getText().contains(\".\") || nameTextField.getText().contains(\";\") || nameTextField.getText().contains(\"'\") ||\n+      nameTextField.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (nameTextField.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 193}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI3NTc4Ng==", "bodyText": "I think a bit of whitespace between the blocks would help make this section a little easier to read:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n          \n          \n            \n                  // if the current version is the default version, switch to the user created version\n          \n          \n            \n                  switchVersion(userCreatedVersion);\n          \n          \n            \n                } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n          \n          \n            \n                  // if the current version is the user created version, check if there are local edits\n          \n          \n            \n                  if (!serviceGeodatabase.hasLocalEdits()) {\n          \n          \n            \n                    // if there are no local edits switch to the default version\n          \n          \n            \n                    switchVersion(defaultVersion);\n          \n          \n            \n                  } else {\n          \n          \n            \n                    // if local edits exist apply the edits\n          \n          \n            \n                    ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n          \n          \n            \n                    resultOfApplyEdits.addDoneListener(() -> {\n          \n          \n            \n                      try {\n          \n          \n            \n                        // check if the server edit was successful\n          \n          \n            \n                        List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n          \n          \n            \n                        if (edits == null || edits.isEmpty()) {\n          \n          \n            \n                          new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n          \n          \n            \n                        } else {\n          \n          \n            \n                          // if the edits were successful, switch to the default version\n          \n          \n            \n                          switchVersion(defaultVersion);\n          \n          \n            \n                        }\n          \n          \n            \n                      } catch (InterruptedException | ExecutionException e) {\n          \n          \n            \n                        new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n          \n          \n            \n                      }\n          \n          \n            \n                    });\n          \n          \n            \n                  }\n          \n          \n            \n                }\n          \n          \n            \n              }\n          \n          \n            \n                if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n          \n          \n            \n                  // if the current version is the default version, switch to the user created version\n          \n          \n            \n                  switchVersion(userCreatedVersion);\n          \n          \n            \n                  \n          \n          \n            \n                } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n          \n          \n            \n                  // if the current version is the user created version, check if there are local edits\n          \n          \n            \n                  if (!serviceGeodatabase.hasLocalEdits()) {\n          \n          \n            \n                    // if there are no local edits switch to the default version\n          \n          \n            \n                    switchVersion(defaultVersion);\n          \n          \n            \n                  \n          \n          \n            \n                  } else {\n          \n          \n            \n                    // if local edits exist apply the edits\n          \n          \n            \n                    ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n          \n          \n            \n                    resultOfApplyEdits.addDoneListener(() -> {\n          \n          \n            \n                      try {\n          \n          \n            \n                       \n          \n          \n            \n                        // check if the server edit was successful\n          \n          \n            \n                        List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n          \n          \n            \n                        if (edits == null || edits.isEmpty()) {\n          \n          \n            \n                          new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n          \n          \n            \n                        \n          \n          \n            \n                        } else {\n          \n          \n            \n                          // if the edits were successful, switch to the default version\n          \n          \n            \n                          switchVersion(defaultVersion);\n          \n          \n            \n                        }\n          \n          \n            \n                      } catch (InterruptedException | ExecutionException e) {\n          \n          \n            \n                        new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n          \n          \n            \n                      }\n          \n          \n            \n                    });\n          \n          \n            \n                  }\n          \n          \n            \n                }\n          \n          \n            \n              }", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490275786", "createdAt": "2020-09-17T14:07:46Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (nameTextField.getText().contains(\".\") || nameTextField.getText().contains(\";\") || nameTextField.getText().contains(\"'\") ||\n+      nameTextField.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (nameTextField.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(nameTextField.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"A version with this name already exists.\\nPlease enter a unique name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersion);\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      }\n+    }\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 264}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI3NzI2Mw==", "bodyText": "Technically we should be naming this variable 'Future':\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n          \n          \n            \n                switchVersionResult.addDoneListener(() -> {\n          \n          \n            \n                ListenableFuture<Void> switchVersionFuture = serviceGeodatabase.switchVersionAsync(versionName);\n          \n          \n            \n                switchVersionFuture.addDoneListener(() -> {", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490277263", "createdAt": "2020-09-17T14:09:39Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (nameTextField.getText().contains(\".\") || nameTextField.getText().contains(\";\") || nameTextField.getText().contains(\"'\") ||\n+      nameTextField.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (nameTextField.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(nameTextField.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"A version with this name already exists.\\nPlease enter a unique name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersion);\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      }\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version.\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 273}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI4MDI4OA==", "bodyText": "I've noticed there are a lot of calls to serviceGeodatabase.getVersionName(). It looks as if this is the central place where a change to that value happens, meaning perhaps it might be nice to save it as a member variable (e.g. String currentGeodatabaseVersion), from which other methods could read, avoiding the repeated calls of the methos .getVersionName.\nHowever there's an argument to be made about that approach creating two 'sources of truth', and in a more complex app the actual serviceGeodatabase and a string currentGeodatabaseVersion could go out of sync, creating a whole other bunch of problems...\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n          \n          \n            \n            \t\tserviceGeodatabaseVersion\n          \n          \n            \n                    currentVersionLabel.setText(\"Current version: \" + currentGeodatabaseVersion);\n          \n      \n    \n    \n  \n\nI'm not too attached to any solution, so I'll just leave this here as a comment rather than a request for a change \ud83d\ude1b", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490280288", "createdAt": "2020-09-17T14:13:25Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (nameTextField.getText().contains(\".\") || nameTextField.getText().contains(\";\") || nameTextField.getText().contains(\"'\") ||\n+      nameTextField.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (nameTextField.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(nameTextField.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"A version with this name already exists.\\nPlease enter a unique name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersion);\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      }\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version.\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 276}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI4MTUwOQ==", "bodyText": "consider adding some whitespace in this block as well, e.g. before each comment", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490281509", "createdAt": "2020-09-17T14:14:54Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,356 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+\n+      // create a map view and set its map\n+      mapView.setMap(map);\n+\n+      // add the version access types to the combo box\n+      accessComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the combo box and handle selection\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (!selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          try {\n+            selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+            updateFeature(selectedFeature);\n+          } catch (Exception e) {\n+            new Alert(Alert.AlertType.ERROR, \"Feature attributes failed to update\").show();\n+          }\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    if (nameTextField.getText().contains(\".\") || nameTextField.getText().contains(\";\") || nameTextField.getText().contains(\"'\") ||\n+      nameTextField.getText().contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (nameTextField.getText().length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (nameTextField.getText().length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }\n+\n+    // validate version access input\n+    if (accessComboBox.getSelectionModel().getSelectedItem() == null) {\n+      new Alert(Alert.AlertType.ERROR, \"Please select an access level\").show();\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(nameTextField.getText());\n+    newVersionParameters.setAccess(accessComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersion = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersion);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          new Alert(Alert.AlertType.ERROR, \"A version with this name already exists.\\nPlease enter a unique name\").show();\n+        } else {\n+          new Alert(Alert.AlertType.ERROR, \"Error creating new version\").show();\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersion);\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersion)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersion);\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersion);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            new Alert(Alert.AlertType.ERROR, \"Error applying edits on server\").show();\n+          }\n+        });\n+      }\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version.\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionResult = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionResult.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        new Alert(Alert.AlertType.ERROR, \"Error switching version.\").show();\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked.\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point) {\n+    ListenableFuture<IdentifyLayerResult> identifyLayerResultFuture = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    identifyLayerResultFuture.addDoneListener(() -> {\n+      try {\n+        var identifyLayerResult = identifyLayerResultFuture.get();\n+        List<GeoElement> identifiedElements = identifyLayerResult.getElements();\n+        if (!identifiedElements.isEmpty()) {\n+          var element = identifiedElements.get(0);\n+          if (element instanceof ArcGISFeature) {\n+            // get the selected feature\n+            selectedFeature = (ArcGISFeature) element;\n+            featureLayer.selectFeature(selectedFeature);\n+            selectedFeature.addDoneLoadingListener(() -> {\n+              if (selectedFeature.getLoadStatus() == LoadStatus.LOADED) {\n+                // when a feature has been selected, get it's damage type value and select it in the damage combo box\n+                String selectedFeatureAttributeValue = (String) selectedFeature.getAttributes().get(\"TYPDAMAGE\");\n+\n+                if (damageTypeComboBox.getItems().contains(selectedFeatureAttributeValue)) {\n+                  damageTypeComboBox.getSelectionModel().select(selectedFeatureAttributeValue);\n+                } else {\n+                  new Alert(Alert.AlertType.ERROR, \"Unexepected attribute value\").show();\n+                }\n+\n+                // enable feature editing UI if not on the default version\n+                if (!serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+                  editFeatureVBox.setDisable(false);\n+                }\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature failed to load.\").show();\n+              }\n+            });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02dd594e7f66cb6d631fcad981ae76384b4c6832"}, "originalPosition": 319}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce30505833ac823b8377aaac4e0c73a7889347bd", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/ce30505833ac823b8377aaac4e0c73a7889347bd", "committedDate": "2020-09-17T16:40:16Z", "message": "refactors from review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMjMzNTk4", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#pullrequestreview-491233598", "createdAt": "2020-09-18T07:56:39Z", "commit": {"oid": "ce30505833ac823b8377aaac4e0c73a7889347bd"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNzo1NjozOVrOHUCLYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwODowMjo0MVrOHUCXkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc2OTI0OA==", "bodyText": "I think this should also say GeoElement element", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490769248", "createdAt": "2020-09-18T07:56:39Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -290,23 +290,25 @@ private void selectFeature(Point2D point) {\n     ListenableFuture<IdentifyLayerResult> identifyLayerResultFuture = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n     identifyLayerResultFuture.addDoneListener(() -> {\n       try {\n-        var identifyLayerResult = identifyLayerResultFuture.get();\n+        IdentifyLayerResult identifyLayerResult = identifyLayerResultFuture.get();\n         List<GeoElement> identifiedElements = identifyLayerResult.getElements();\n         if (!identifiedElements.isEmpty()) {\n           var element = identifiedElements.get(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce30505833ac823b8377aaac4e0c73a7889347bd"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc3MjM3MA==", "bodyText": "I think this all looks alright. Other samples usually put a call to applyEdits in the .addDoneListener, but since we're just doing the 'apply' when versions are switched, this is ok.\nAnother thing I've noticed is that updateFeatureAsync only throws one type of exceptions:\nIllegalArgumentException - if feature is null:\nhttps://developers.arcgis.com/java/latest/api-reference/reference/com/esri/arcgisruntime/data/FeatureTable.html#updateFeatureAsync(com.esri.arcgisruntime.data.Feature)\nSo, perhaps if you include a null check before this method is called (line89?) we can get rid of the try/catch alltogether?", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r490772370", "createdAt": "2020-09-18T08:02:41Z", "author": {"login": "JonLavi"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -332,13 +334,18 @@ private void selectFeature(Point2D point) {\n    */\n   private void updateFeature(ArcGISFeature selectedFeature) {\n     if (serviceFeatureTable.canUpdate(selectedFeature) && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+\n       // update the feature in the feature table\n-      ListenableFuture<Void> editResult = serviceFeatureTable.updateFeatureAsync(selectedFeature);\n-      editResult.addDoneListener(() -> {\n-        Alert alert = new Alert(Alert.AlertType.INFORMATION);\n-        alert.setHeaderText(\"Feature updated\");\n-        alert.setContentText(\"Changes will be synced to the service geodatabase\\nwhen you switch version.\");\n-        alert.show();\n+      ListenableFuture<Void> updateFuture = serviceFeatureTable.updateFeatureAsync(selectedFeature);\n+      updateFuture.addDoneListener(() -> {\n+        try {\n+          Alert alert = new Alert(Alert.AlertType.INFORMATION);\n+          alert.setHeaderText(\"Feature updated\");\n+          alert.setContentText(\"Changes will be synced to the service geodatabase\\nwhen you switch version.\");\n+          alert.show();\n+        } catch (Exception ex) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce30505833ac823b8377aaac4e0c73a7889347bd"}, "originalPosition": 183}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/9ad843f137132e5754df1443fe160e79a45068cf", "committedDate": "2020-09-18T10:05:04Z", "message": "tidy ups"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MjYxNjIz", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#pullrequestreview-499261623", "createdAt": "2020-09-30T09:47:32Z", "commit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "state": "COMMENTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwOTo0NzozMlrOHaVy1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNDo1MDo1MVrOHahdKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM4MjEwMg==", "bodyText": "I feel we need to have some brief documentation to explain what Version Management is. Presumably this is a setting on AGOL or is it a REST service? (https://developers.arcgis.com/rest/services-reference/version-management-service.htm). Either way there needs to be a reference to further documentation to explain Version Management.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497382102", "createdAt": "2020-09-30T09:47:32Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature using the primary mouse button to edit an attribute and/or click again with the secondary mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5NzkzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            8. Select a `Feature` from the map to edit it's \"TYPDAMAGE\" attribute and location.\n          \n          \n            \n            8. Select a `Feature` from the map to edit its \"TYPDAMAGE\" attribute and location.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497397936", "createdAt": "2020-09-30T10:14:35Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature using the primary mouse button to edit an attribute and/or click again with the secondary mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.\n+2. Get the `ServiceFeatureTable` from the service geodatabase.\n+3. Create a `FeatureLayer` from the service feature table.\n+4. Create `ServiceVersionParameters` with a unique name, `VersionAccess`, and description.\n+    * Note - See the additional information section for more restrictions on the version name.\n+5. Create a new version by calling `ServiceGeodatabase.createVersionAsync()` and passing in the service version parameters.\n+6. Retrieve the result of the async call, to obtain the `ServiceVersionInfo` of the version created.\n+7. Switch to the version you have just created using `ServiceGeodatabase.switchVersionAsync()`, passing in the version name obtained from the service version info.\n+8. Select a `Feature` from the map to edit it's \"TYPDAMAGE\" attribute and location.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5ODM0Ng==", "bodyText": "this is more of a UI instruction, not a how it works from an API perspective. We can remove this point", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497398346", "createdAt": "2020-09-30T10:15:14Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# Edit with branch versioning\n+\n+Create, query and edit a specific server version using service geodatabase.\n+\n+![Image of edit with branch versioning](EditWithBranchVersioning.png)\n+\n+## Use case\n+\n+Workflows often progress in discrete stages, with each stage requiring the allocation of a different set of resources and business rules. Typically, each stage in the overall process represents a single unit of work, such as a work order or job. To manage these, you can create a separate, isolated version and modify it. Once this work is complete, you can integrate the changes into the default version.\n+\n+## How to use the sample\n+\n+Upon opening the sample, you will be prompted to enter credentials for the service (un: editor01 / pwd: editor01.password). Once loaded, the map will zoom to the extent of the feature layer. The current version is indicated in the top left corner of the map. You can create a new version by specifying the version information (name, access, and description) in the form in the top right corner, and then clicking \"Create version\". See the *Additional Information* section for restrictions on the version name.\n+\n+Select a feature using the primary mouse button to edit an attribute and/or click again with the secondary mouse button to relocate the point.\n+\n+Click the \"Switch version\" button in the top left corner to switch back and forth between the version you created and the default version. Edits will automatically be applied to your version when switching to the default version.\n+\n+## How it works\n+\n+1. Create and load a `ServiceGeodatabase` with a feature service URL that has enabled Version Management.\n+2. Get the `ServiceFeatureTable` from the service geodatabase.\n+3. Create a `FeatureLayer` from the service feature table.\n+4. Create `ServiceVersionParameters` with a unique name, `VersionAccess`, and description.\n+    * Note - See the additional information section for more restrictions on the version name.\n+5. Create a new version by calling `ServiceGeodatabase.createVersionAsync()` and passing in the service version parameters.\n+6. Retrieve the result of the async call, to obtain the `ServiceVersionInfo` of the version created.\n+7. Switch to the version you have just created using `ServiceGeodatabase.switchVersionAsync()`, passing in the version name obtained from the service version info.\n+8. Select a `Feature` from the map to edit it's \"TYPDAMAGE\" attribute and location.\n+9. Apply these edits to your version by calling `ServiceGeodatabase.applyEditsAsync()`.\n+10. Switch back and forth between your version and the default version to see how the two versions differ.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQwMzI2Mg==", "bodyText": "new line between initialize() and the try block needed here (just for readability)", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497403262", "createdAt": "2020-09-30T10:24:31Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQxMzIzNg==", "bodyText": "just a wee tip, can ignore or implement as you prefer!\nwhen a one liner follows an else block, you can move all the code on to one line for improved readability:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          } else {\n          \n          \n            \n                            new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n          \n          \n            \n                          } else new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497413236", "createdAt": "2020-09-30T10:43:13Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQxMzQwMQ==", "bodyText": "same here as above if you like, up to you", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497413401", "createdAt": "2020-09-30T10:43:33Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQxNzkzMQ==", "bodyText": "we can move this line of code up to just under the setOnMouseClicked call, and remove the repeated code on line 149. That way the reference to this Point2D is kept and both if statements can reference it without having to repeat the code.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497417931", "createdAt": "2020-09-30T10:52:49Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU1NTQwMg==", "bodyText": "there are a lot of repeated new Alert(Alert.AlertType.ERROR) in this method: we could create a new method showAlert(String alertText) later in the code and call that instead, just to make this a bit more readable.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n          \n          \n            \n                  showAlert(\"Version name cannot begin with a space\");", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497555402", "createdAt": "2020-09-30T14:28:32Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+    if (inputName.contains(\".\") || inputName.contains(\";\") || inputName.contains(\"'\") || inputName.contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR,\n+        \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (inputName.length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU2NDYwOQ==", "bodyText": "I'd be tempted to abstract this out into its own method (validateTextInput). This is quite a chunk of code for handling input which detracts from the main point of this method, which is to show the ServiceVersionParameters etc functionality. We don't often go for individual methods but in a case like this where there is a lot of UI specific case handling, it's ok to move that out.", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497564609", "createdAt": "2020-09-30T14:40:08Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;\n+\n+  public void initialize() {\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersion = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else {\n+                new Alert(Alert.AlertType.ERROR, \"Feature layer failed to load\").show();\n+              }\n+            });\n+          } else {\n+            new Alert(Alert.AlertType.ERROR, \"Unable to get the service feature table\").show();\n+          }\n+        } else {\n+          progressIndicator.setVisible(false);\n+          new Alert(Alert.AlertType.ERROR, \"Service geodatabase failed to load\").show();\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          Point2D point = new Point2D(event.getX(), event.getY());\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersion)) {\n+            Point2D point = new Point2D(event.getX(), event.getY());\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+    if (inputName.contains(\".\") || inputName.contains(\";\") || inputName.contains(\"'\") || inputName.contains(\"\\\"\")) {\n+      new Alert(Alert.AlertType.ERROR,\n+        \"Please enter a valid version name.\\nThe name cannot contain the following characters:\\n. ; ' \\\" \").show();\n+      return;\n+    } else if (inputName.length() > 0 && Character.isWhitespace(nameTextField.getText().charAt(0))) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name cannot begin with a space\").show();\n+      return;\n+    } else if (inputName.length() > 62) {\n+      new Alert(Alert.AlertType.ERROR, \"Version name must not exceed 62 characters\").show();\n+      return;\n+    } else if (inputName.length() == 0) {\n+      new Alert(Alert.AlertType.ERROR, \"Please enter a version name\").show();\n+      return;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 183}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU2OTA5OQ==", "bodyText": "can we rename this to defaultVersionName: currently the variable name is a little obscure as to what a defaultVersion object is, especially when reading it later down the code without the context.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private String defaultVersion;\n          \n          \n            \n              private String defaultVersionName;", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497569099", "createdAt": "2020-09-30T14:45:39Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU3MzE2MA==", "bodyText": "same for this\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private String userCreatedVersion;\n          \n          \n            \n              private String userCreatedVersionName;", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r497573160", "createdAt": "2020-09-30T14:50:51Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,359 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersion;\n+  private String userCreatedVersion;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad843f137132e5754df1443fe160e79a45068cf"}, "originalPosition": 72}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a587a7d50a09004c86cc4ee4386fbd0316d8cede", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/a587a7d50a09004c86cc4ee4386fbd0316d8cede", "committedDate": "2020-10-02T09:53:14Z", "message": "small fixes from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96618213b9c02e5e1b4ab536a09a76fbf9371ca5", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/96618213b9c02e5e1b4ab536a09a76fbf9371ca5", "committedDate": "2020-10-02T10:42:40Z", "message": "create error alert method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b59ac3065a32a24cf51995840f905f8df6fa52e6", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/b59ac3065a32a24cf51995840f905f8df6fa52e6", "committedDate": "2020-10-02T11:02:00Z", "message": "create method for text validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fa6040c05fcb1d1d231c564d7c538b78320c7da", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/3fa6040c05fcb1d1d231c564d7c538b78320c7da", "committedDate": "2020-10-02T14:11:07Z", "message": "updates to readme"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/59dfd0af9a095dd0c239f4931ab3abe83df53668", "committedDate": "2020-10-02T15:02:48Z", "message": "add link to docs in readme"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMTYwNDg1", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#pullrequestreview-502160485", "createdAt": "2020-10-05T15:14:43Z", "commit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNToxNDo0NFrOHchw3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxMToxNToxMlrOHdBaVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3NTM1Ng==", "bodyText": "since we are using serviceGeodatabase across multiple methods, we can remove the comment for garbage collection here. Let's only use that comment if the sole purpose it has been made a class variable is to counteract garbage collection!", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r499675356", "createdAt": "2020-10-05T15:14:44Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4MjAyOQ==", "bodyText": "getting an IDE prompt to shorten the above to the following:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               if (!isTextInputValid(inputName)) {\n          \n          \n            \n                 return;\n          \n          \n            \n               };\n          \n          \n            \n               if (!isTextInputValid(inputName)) return;", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r499682029", "createdAt": "2020-10-05T15:24:17Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4NDgxOQ==", "bodyText": "the indentation is a little out on this line: there is an auto indent function in IntelliJ if you haven't come across this already which helps sort things like this!", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r499684819", "createdAt": "2020-10-05T15:28:15Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4NTkzOA==", "bodyText": "could opt for a one liner here too\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    } else {\n          \n          \n            \n                      showAlert(\"Error creating new version\");\n          \n          \n            \n                    }\n          \n          \n            \n             } else showAlert(\"Error creating new version\");", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r499685938", "createdAt": "2020-10-05T15:29:42Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };\n+\n+    // validate version access input\n+    if (accessTypeComboBox.getSelectionModel().getSelectedItem() == null) {\n+      showAlert(\"Please select an access level\");\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(inputName);\n+    newVersionParameters.setAccess(accessTypeComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersionName = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersionName);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          showAlert(\"A version with this name already exists.\\\\nPlease enter a unique name\");\n+        } else {\n+          showAlert(\"Error creating new version\");\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 208}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE3NTU0OA==", "bodyText": "We can improve this slightly. Currently there are two instances where an identical alert will be shown \"Error applying edits on server\". We could switch it round to deliver a \"success\" alert if all is well (after doing a robust check of that), and if it's not, display a more meaningful error message by directly accessing the error message.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  } else {\n          \n          \n            \n                    // if local edits exist apply the edits\n          \n          \n            \n                    ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n          \n          \n            \n                    resultOfApplyEdits.addDoneListener(() -> {\n          \n          \n            \n                      try {\n          \n          \n            \n            \n          \n          \n            \n                        // check if the server edit was successful\n          \n          \n            \n                        List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n          \n          \n            \n                        if (edits == null || edits.isEmpty()) {\n          \n          \n            \n                          showAlert(\"Error applying edits on server\");\n          \n          \n            \n                        } else {\n          \n          \n            \n                          // if the edits were successful, switch to the default version\n          \n          \n            \n                          switchVersion(defaultVersionName);\n          \n          \n            \n                        }\n          \n          \n            \n                      } catch (InterruptedException | ExecutionException e) {\n          \n          \n            \n                        showAlert(\"Error applying edits on server\");\n          \n          \n            \n                      }\n          \n          \n            \n            } else {\n          \n          \n            \n                    // if local edits exist apply the edits to the service geodatabase\n          \n          \n            \n                    ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n          \n          \n            \n                    resultOfApplyEdits.addDoneListener(() -> {\n          \n          \n            \n                      try {\n          \n          \n            \n                        // retrieve the edits\n          \n          \n            \n                        List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n          \n          \n            \n                        // if the edits were successful, switch to the default version\n          \n          \n            \n                        if (edits != null && edits.size() > 0) {\n          \n          \n            \n                          if (!edits.get(0).getEditResult().get(0).hasCompletedWithErrors()) {\n          \n          \n            \n                            new Alert(Alert.AlertType.INFORMATION, \"Applied edits successfully on the server\").show();\n          \n          \n            \n                            switchVersion(defaultVersionName);\n          \n          \n            \n                          } else {\n          \n          \n            \n                            throw edits.get(0).getEditResult().get(0).getError();\n          \n          \n            \n                          }\n          \n          \n            \n                        }\n          \n          \n            \n                      } catch (InterruptedException | ExecutionException e) {\n          \n          \n            \n                        showAlert(\"Error applying edits on server\" + e.getCause().getMessage());\n          \n          \n            \n                      }", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r500175548", "createdAt": "2020-10-06T10:40:51Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };\n+\n+    // validate version access input\n+    if (accessTypeComboBox.getSelectionModel().getSelectedItem() == null) {\n+      showAlert(\"Please select an access level\");\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(inputName);\n+    newVersionParameters.setAccess(accessTypeComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersionName = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersionName);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          showAlert(\"A version with this name already exists.\\\\nPlease enter a unique name\");\n+        } else {\n+          showAlert(\"Error creating new version\");\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersionName);\n+\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersionName)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersionName);\n+\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              showAlert(\"Error applying edits on server\");\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersionName);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            showAlert(\"Error applying edits on server\");\n+          }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 247}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE4ODc3NA==", "bodyText": "having a look at some similar samples which use ListenableFutures, I'm recognising the use of a try/catch within their addDoneListeners. There are some instances in the code where this switchVersion method is called within a try/catch anyway, so it's caught there, but in some places it isn't. We will get a more meaningful error message for the user by catching an exception and printing it out rather than a hard coded string alert: although this can be helpful too.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                switchVersionFuture.addDoneListener(() -> {\n          \n          \n            \n                  // check if the active version has switched successfully and update the UI\n          \n          \n            \n                  if (serviceGeodatabase.getVersionName().equals(versionName)) {\n          \n          \n            \n                    currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n          \n          \n            \n                    editFeatureVBox.setDisable(true);\n          \n          \n            \n                  } else {\n          \n          \n            \n                    showAlert(\"Error switching version\");\n          \n          \n            \n                  }\n          \n          \n            \n                });\n          \n          \n            \n                switchVersionFuture.addDoneListener(() -> {\n          \n          \n            \n                  try {\n          \n          \n            \n                    // check if the active version has switched successfully and update the UI\n          \n          \n            \n                    if (serviceGeodatabase.getVersionName().equals(versionName)) {\n          \n          \n            \n                      currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n          \n          \n            \n                      editFeatureVBox.setDisable(true);\n          \n          \n            \n                    }\n          \n          \n            \n                  } catch (Exception e) {\n          \n          \n            \n                    e.printStackTrace();\n          \n          \n            \n                  }\n          \n          \n            \n                });", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r500188774", "createdAt": "2020-10-06T11:05:36Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };\n+\n+    // validate version access input\n+    if (accessTypeComboBox.getSelectionModel().getSelectedItem() == null) {\n+      showAlert(\"Please select an access level\");\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(inputName);\n+    newVersionParameters.setAccess(accessTypeComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersionName = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersionName);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          showAlert(\"A version with this name already exists.\\\\nPlease enter a unique name\");\n+        } else {\n+          showAlert(\"Error creating new version\");\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersionName);\n+\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersionName)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersionName);\n+\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              showAlert(\"Error applying edits on server\");\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersionName);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            showAlert(\"Error applying edits on server\");\n+          }\n+        });\n+      }\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version.\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionFuture = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionFuture.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        showAlert(\"Error switching version\");\n+      }\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 268}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE5MjY4NA==", "bodyText": "we can directly access a failure message from a feature which has a load failure, which can be more helpful to the user:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            showAlert(\"Feature failed to load\");\n          \n          \n            \n                        showAlert(selectedFeature.getLoadError().getCause().getMessage());", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r500192684", "createdAt": "2020-10-06T11:13:06Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };\n+\n+    // validate version access input\n+    if (accessTypeComboBox.getSelectionModel().getSelectedItem() == null) {\n+      showAlert(\"Please select an access level\");\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(inputName);\n+    newVersionParameters.setAccess(accessTypeComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersionName = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersionName);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          showAlert(\"A version with this name already exists.\\\\nPlease enter a unique name\");\n+        } else {\n+          showAlert(\"Error creating new version\");\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersionName);\n+\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersionName)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersionName);\n+\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              showAlert(\"Error applying edits on server\");\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersionName);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            showAlert(\"Error applying edits on server\");\n+          }\n+        });\n+      }\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version.\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionFuture = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionFuture.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        showAlert(\"Error switching version\");\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked.\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point) {\n+    ListenableFuture<IdentifyLayerResult> identifyLayerResultFuture = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    identifyLayerResultFuture.addDoneListener(() -> {\n+      try {\n+        IdentifyLayerResult identifyLayerResult = identifyLayerResultFuture.get();\n+        List<GeoElement> identifiedElements = identifyLayerResult.getElements();\n+        if (!identifiedElements.isEmpty()) {\n+          GeoElement element = identifiedElements.get(0);\n+          if (element instanceof ArcGISFeature) {\n+\n+            // get the selected feature\n+            selectedFeature = (ArcGISFeature) element;\n+            featureLayer.selectFeature(selectedFeature);\n+            selectedFeature.addDoneLoadingListener(() -> {\n+              if (selectedFeature.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when a feature has been selected, get it's damage type value and select it in the damage combo box\n+                String selectedFeatureAttributeValue = (String) selectedFeature.getAttributes().get(\"TYPDAMAGE\");\n+\n+                if (damageTypeComboBox.getItems().contains(selectedFeatureAttributeValue)) {\n+                  damageTypeComboBox.getSelectionModel().select(selectedFeatureAttributeValue);\n+                } else {\n+                  showAlert(\"Unexpected attribute value\");\n+                }\n+\n+                // enable feature editing UI if not on the default version\n+                if (!serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+                  editFeatureVBox.setDisable(false);\n+                }\n+              } else {\n+                showAlert(\"Feature failed to load\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 306}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE5Mzg3OA==", "bodyText": "another example of where we can improve the alert by providing a meaningful message\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    showAlert(\"Failed to identify the feature\");\n          \n          \n            \n                    showAlert(\"Failed to identify the feature\" + e.getCause().getMessage());", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#discussion_r500193878", "createdAt": "2020-10-06T11:15:12Z", "author": {"login": "Rachael-E"}, "path": "editing/edit-with-branch-versioning/src/main/java/com/esri/samples/edit_with_branch_versioning/EditWithBranchVersioningController.java", "diffHunk": "@@ -0,0 +1,378 @@\n+/*\n+ * Copyright 2020 Esri.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.esri.samples.edit_with_branch_versioning;\n+\n+import java.util.List;\n+import java.util.concurrent.ExecutionException;\n+\n+import javafx.fxml.FXML;\n+import javafx.geometry.Point2D;\n+import javafx.scene.control.Alert;\n+import javafx.scene.control.Button;\n+import javafx.scene.control.ComboBox;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ProgressIndicator;\n+import javafx.scene.control.TextField;\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.layout.VBox;\n+\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionInfo;\n+import com.esri.arcgisruntime.arcgisservices.ServiceVersionParameters;\n+import com.esri.arcgisruntime.arcgisservices.VersionAccess;\n+import com.esri.arcgisruntime.concurrent.ListenableFuture;\n+import com.esri.arcgisruntime.data.ArcGISFeature;\n+import com.esri.arcgisruntime.data.FeatureTableEditResult;\n+import com.esri.arcgisruntime.data.ServiceFeatureTable;\n+import com.esri.arcgisruntime.data.ServiceGeodatabase;\n+import com.esri.arcgisruntime.geometry.Point;\n+import com.esri.arcgisruntime.layers.FeatureLayer;\n+import com.esri.arcgisruntime.loadable.LoadStatus;\n+import com.esri.arcgisruntime.mapping.ArcGISMap;\n+import com.esri.arcgisruntime.mapping.Basemap;\n+import com.esri.arcgisruntime.mapping.GeoElement;\n+import com.esri.arcgisruntime.mapping.Viewpoint;\n+import com.esri.arcgisruntime.mapping.view.IdentifyLayerResult;\n+import com.esri.arcgisruntime.mapping.view.MapView;\n+import com.esri.arcgisruntime.security.AuthenticationManager;\n+import com.esri.arcgisruntime.security.DefaultAuthenticationChallengeHandler;\n+\n+public class EditWithBranchVersioningController {\n+\n+  @FXML private Button createVersionButton;\n+  @FXML private Button switchVersionButton;\n+  @FXML private ComboBox<String> damageTypeComboBox;\n+  @FXML private ComboBox<VersionAccess> accessTypeComboBox;\n+  @FXML private Label currentVersionLabel;\n+  @FXML private MapView mapView;\n+  @FXML private ProgressIndicator progressIndicator;\n+  @FXML private TextField descriptionTextField;\n+  @FXML private TextField nameTextField;\n+  @FXML private VBox createVersionVBox;\n+  @FXML private VBox editFeatureVBox;\n+\n+  private ArcGISFeature selectedFeature;\n+  private FeatureLayer featureLayer;\n+  private ServiceFeatureTable serviceFeatureTable;\n+  private ServiceGeodatabase serviceGeodatabase; // keeps loadable in scope to avoid garbage collection\n+  private String defaultVersionName;\n+  private String userCreatedVersionName;\n+\n+  public void initialize() {\n+\n+    try {\n+      // create a map with the streets vector basemap and set it to the map view\n+      ArcGISMap map = new ArcGISMap(Basemap.createStreetsVector());\n+      mapView.setMap(map);\n+\n+      // add the version access types to the access type combo box\n+      accessTypeComboBox.getItems().addAll(VersionAccess.PUBLIC, VersionAccess.PROTECTED, VersionAccess.PRIVATE);\n+\n+      // add the damage types to the damage type combo box\n+      damageTypeComboBox.getItems().addAll(\"Destroyed\", \"Inaccessible\", \"Major\", \"Minor\", \"Affected\");\n+      // add a listener to handle damage type attribute selections and update the selected feature with the new value\n+      damageTypeComboBox.getSelectionModel().selectedItemProperty().addListener((o, p, n) -> {\n+        if (selectedFeature != null && !selectedFeature.getAttributes().get(\"TYPDAMAGE\").equals(n)) {\n+          selectedFeature.getAttributes().put(\"TYPDAMAGE\", damageTypeComboBox.getValue());\n+          updateFeature(selectedFeature);\n+        }\n+      });\n+\n+      // handle authentication for the service geodatabase\n+      AuthenticationManager.setAuthenticationChallengeHandler(new DefaultAuthenticationChallengeHandler());\n+\n+      // create and load a service geodatabase\n+      serviceGeodatabase = new ServiceGeodatabase(\"https://sampleserver7.arcgisonline\" +\n+        \".com/arcgis/rest/services/DamageAssessment/FeatureServer\");\n+      serviceGeodatabase.loadAsync();\n+      serviceGeodatabase.addDoneLoadingListener(() -> {\n+        if (serviceGeodatabase.getLoadStatus() == LoadStatus.LOADED) {\n+\n+          // when the service geodatabase has loaded get the default version\n+          defaultVersionName = serviceGeodatabase.getDefaultVersionName();\n+\n+          // get the service feature table from the service geodatabase\n+          if (serviceGeodatabase.getTable(0) != null) {\n+            serviceFeatureTable = serviceGeodatabase.getTable(0);\n+\n+            // create a feature layer from the service feature table and add it to the map\n+            featureLayer = new FeatureLayer(serviceFeatureTable);\n+            map.getOperationalLayers().add(featureLayer);\n+            featureLayer.addDoneLoadingListener(() -> {\n+              if (featureLayer.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when the feature layer has loaded set the viewpoint and update the UI\n+                mapView.setViewpointAsync(new Viewpoint(featureLayer.getFullExtent()));\n+                progressIndicator.setVisible(false);\n+                createVersionButton.setDisable(false);\n+                currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+              } else showAlert(\"Feature layer failed to load\");\n+            });\n+          } else showAlert(\"Unable to get the service feature table\");\n+        } else {\n+          progressIndicator.setVisible(false);\n+          showAlert(\"Service geodatabase failed to load\");\n+        }\n+      });\n+\n+      // listen to clicks on the map to select or move features\n+      mapView.setOnMouseClicked(event -> {\n+\n+        // create a point from where the user clicked\n+        Point2D point = new Point2D(event.getX(), event.getY());\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.PRIMARY) {\n+          // reset the UI\n+          featureLayer.clearSelection();\n+          editFeatureVBox.setDisable(true);\n+\n+          // select the clicked feature\n+          selectFeature(point);\n+        }\n+\n+        if (event.isStillSincePress() && event.getButton() == MouseButton.SECONDARY) {\n+          // if a feature is selected and the current version is not the default, update the feature's geometry\n+          if (selectedFeature != null && !serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+            Point mapPoint = mapView.screenToLocation(point);\n+            selectedFeature.setGeometry(mapPoint);\n+            updateFeature(selectedFeature);\n+          }\n+        }\n+      });\n+    } catch (Exception e) {\n+      // on any error, display the stack trace.\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  /**\n+   * Create a new branch version using user defined values.\n+   */\n+  @FXML\n+  private void handleCreateVersionButtonClicked() {\n+\n+    // validate version name input\n+    String inputName = nameTextField.getText();\n+   if (!isTextInputValid(inputName)) {\n+     return;\n+   };\n+\n+    // validate version access input\n+    if (accessTypeComboBox.getSelectionModel().getSelectedItem() == null) {\n+      showAlert(\"Please select an access level\");\n+      return;\n+    }\n+\n+    // set the user defined name, access level and description as service version parameters\n+    ServiceVersionParameters newVersionParameters = new ServiceVersionParameters();\n+    newVersionParameters.setName(inputName);\n+    newVersionParameters.setAccess(accessTypeComboBox.getSelectionModel().getSelectedItem());\n+    newVersionParameters.setDescription(descriptionTextField.getText());\n+\n+    // update the UI\n+    createVersionButton.setText(\"Creating version....\");\n+    createVersionButton.setDisable(true);\n+\n+    // create a new version with the specified parameters\n+    ListenableFuture<ServiceVersionInfo> newVersion = serviceGeodatabase.createVersionAsync(newVersionParameters);\n+    newVersion.addDoneListener(() -> {\n+      try {\n+\n+        // get the name of the created version and switch to it\n+        ServiceVersionInfo createdVersionInfo = newVersion.get();\n+        userCreatedVersionName = createdVersionInfo.getName();\n+        switchVersion(userCreatedVersionName);\n+\n+        // hide the form from the UI as the sample only allows 1 version to be created\n+        createVersionVBox.setVisible(false);\n+        switchVersionButton.setDisable(false);\n+      } catch (Exception ex) {\n+        // if there is an error creating a new version, display an alert and reset the UI\n+        if (ex.getCause().toString().contains(\"The version already exists\")) {\n+          showAlert(\"A version with this name already exists.\\\\nPlease enter a unique name\");\n+        } else {\n+          showAlert(\"Error creating new version\");\n+        }\n+        createVersionButton.setText(\"Create version\");\n+        createVersionButton.setDisable(false);\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Apply local edits to the service geodatabase and switch branch version.\n+   */\n+  @FXML\n+  private void handleSwitchVersionButtonClicked() {\n+\n+    if (serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+      // if the current version is the default version, switch to the user created version\n+      switchVersion(userCreatedVersionName);\n+\n+    } else if (serviceGeodatabase.getVersionName().equals(userCreatedVersionName)) {\n+      // if the current version is the user created version, check if there are local edits\n+      if (!serviceGeodatabase.hasLocalEdits()) {\n+        // if there are no local edits switch to the default version\n+        switchVersion(defaultVersionName);\n+\n+      } else {\n+        // if local edits exist apply the edits\n+        ListenableFuture<List<FeatureTableEditResult>> resultOfApplyEdits = serviceGeodatabase.applyEditsAsync();\n+        resultOfApplyEdits.addDoneListener(() -> {\n+          try {\n+\n+            // check if the server edit was successful\n+            List<FeatureTableEditResult> edits = resultOfApplyEdits.get();\n+            if (edits == null || edits.isEmpty()) {\n+              showAlert(\"Error applying edits on server\");\n+            } else {\n+              // if the edits were successful, switch to the default version\n+              switchVersion(defaultVersionName);\n+            }\n+          } catch (InterruptedException | ExecutionException e) {\n+            showAlert(\"Error applying edits on server\");\n+          }\n+        });\n+      }\n+    }\n+  }\n+\n+  /**\n+   * Switch the active branch version.\n+   *\n+   * @param versionName name of the version to switch to\n+   */\n+  private void switchVersion(String versionName) {\n+    ListenableFuture<Void> switchVersionFuture = serviceGeodatabase.switchVersionAsync(versionName);\n+    switchVersionFuture.addDoneListener(() -> {\n+      // check if the active version has switched successfully and update the UI\n+      if (serviceGeodatabase.getVersionName().equals(versionName)) {\n+        currentVersionLabel.setText(\"Current version: \" + serviceGeodatabase.getVersionName());\n+        editFeatureVBox.setDisable(true);\n+      } else {\n+        showAlert(\"Error switching version\");\n+      }\n+    });\n+  }\n+\n+  /**\n+   * Select a feature if one exists where the user clicked.\n+   *\n+   * @param point location where the user clicked\n+   */\n+  private void selectFeature(Point2D point) {\n+    ListenableFuture<IdentifyLayerResult> identifyLayerResultFuture = mapView.identifyLayerAsync(featureLayer, point, 1, false);\n+    identifyLayerResultFuture.addDoneListener(() -> {\n+      try {\n+        IdentifyLayerResult identifyLayerResult = identifyLayerResultFuture.get();\n+        List<GeoElement> identifiedElements = identifyLayerResult.getElements();\n+        if (!identifiedElements.isEmpty()) {\n+          GeoElement element = identifiedElements.get(0);\n+          if (element instanceof ArcGISFeature) {\n+\n+            // get the selected feature\n+            selectedFeature = (ArcGISFeature) element;\n+            featureLayer.selectFeature(selectedFeature);\n+            selectedFeature.addDoneLoadingListener(() -> {\n+              if (selectedFeature.getLoadStatus() == LoadStatus.LOADED) {\n+\n+                // when a feature has been selected, get it's damage type value and select it in the damage combo box\n+                String selectedFeatureAttributeValue = (String) selectedFeature.getAttributes().get(\"TYPDAMAGE\");\n+\n+                if (damageTypeComboBox.getItems().contains(selectedFeatureAttributeValue)) {\n+                  damageTypeComboBox.getSelectionModel().select(selectedFeatureAttributeValue);\n+                } else {\n+                  showAlert(\"Unexpected attribute value\");\n+                }\n+\n+                // enable feature editing UI if not on the default version\n+                if (!serviceGeodatabase.getVersionName().equals(defaultVersionName)) {\n+                  editFeatureVBox.setDisable(false);\n+                }\n+              } else {\n+                showAlert(\"Feature failed to load\");\n+              }\n+            });\n+          }\n+        }\n+      } catch (InterruptedException | ExecutionException e) {\n+        showAlert(\"Failed to identify the feature\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59dfd0af9a095dd0c239f4931ab3abe83df53668"}, "originalPosition": 312}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "379f1af2251ac0f556b023cbde1901f77e30b7ad", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/379f1af2251ac0f556b023cbde1901f77e30b7ad", "committedDate": "2020-10-06T15:44:50Z", "message": "tidy ups from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6218ebe3977319229df5fec91e2f6a80d719299", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/b6218ebe3977319229df5fec91e2f6a80d719299", "committedDate": "2020-10-08T09:37:00Z", "message": "amend error messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3a638bd3e1b71a47483ba53da595c794fb222c6", "author": {"user": {"login": "jenmerritt", "name": "Jen Merritt"}}, "url": "https://github.com/Esri/arcgis-runtime-samples-java/commit/f3a638bd3e1b71a47483ba53da595c794fb222c6", "committedDate": "2020-10-08T11:13:24Z", "message": "validation error messaging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NTQzNzU1", "url": "https://github.com/Esri/arcgis-runtime-samples-java/pull/553#pullrequestreview-506543755", "createdAt": "2020-10-12T11:42:29Z", "commit": {"oid": "f3a638bd3e1b71a47483ba53da595c794fb222c6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3485, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}