{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyMzQxNjM1", "number": 875, "title": "Fix application color detector", "bodyText": "", "createdAt": "2020-06-10T09:52:32Z", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875", "merged": true, "mergeCommit": {"oid": "cb9ef7cbeccacabeb73a4d0f156bdd27814eb584"}, "closed": true, "closedAt": "2020-06-10T12:02:29Z", "author": {"login": "theghost5800"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcp24u0gFqTQyNzkwMDQ1Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp4JmmgFqTQyNzk2ODk3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3OTAwNDUz", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#pullrequestreview-427900453", "createdAt": "2020-06-10T09:57:51Z", "commit": {"oid": "c6f74499df3e262df555dc5bd6a4e2a247630a97"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOTo1Nzo1MlrOGhtxiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMDoxMTowMlrOGhuORQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODAwNjE1NQ==", "bodyText": "Change to Thrown when there is no result. Don't use this method if it's possible for this query to match nothing.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#discussion_r438006155", "createdAt": "2020-06-10T09:57:52Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.core/src/main/java/com/sap/cloud/lm/sl/cf/core/persistence/query/Query.java", "diffHunk": "@@ -3,14 +3,21 @@\n import java.util.List;\n \n import javax.persistence.NoResultException;\n+import javax.persistence.NonUniqueResultException;\n \n public interface Query<R, T extends Query<?, ?>> {\n \n     T limitOnSelect(int limit);\n \n     T offsetOnSelect(int offset);\n \n-    R singleResult() throws NoResultException;\n+    /**\n+     * @return the result\n+     * @throws NoResultException Thrown when there is no result. Do not use singleResult() method in case you can expect no result", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6f74499df3e262df555dc5bd6a4e2a247630a97"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODAwODg2NQ==", "bodyText": "Change to Thrown when there are multiple results. If you want to get the first of these, use {@code limitOnSelect(1).list()} instead.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#discussion_r438008865", "createdAt": "2020-06-10T10:02:27Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.core/src/main/java/com/sap/cloud/lm/sl/cf/core/persistence/query/Query.java", "diffHunk": "@@ -3,14 +3,21 @@\n import java.util.List;\n \n import javax.persistence.NoResultException;\n+import javax.persistence.NonUniqueResultException;\n \n public interface Query<R, T extends Query<?, ?>> {\n \n     T limitOnSelect(int limit);\n \n     T offsetOnSelect(int offset);\n \n-    R singleResult() throws NoResultException;\n+    /**\n+     * @return the result\n+     * @throws NoResultException Thrown when there is no result. Do not use singleResult() method in case you can expect no result\n+     * @throws NonUniqueResultException Thrown when there is multiple results. If you would like to get single result only, you can use", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6f74499df3e262df555dc5bd6a4e2a247630a97"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODAwOTM1MA==", "bodyText": "Rename to previousProcessId.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#discussion_r438009350", "createdAt": "2020-06-10T10:03:23Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/ApplicationColorDetector.java", "diffHunk": "@@ -58,12 +57,11 @@ public ApplicationColor detectLiveApplicationColor(DeployedMta deployedMta, Stri\n                       .getState() != Operation.State.ABORTED) {\n             return olderApplicationColor;\n         }\n-        String xs2BlueGreenDeployHistoricProcessInstanceId = flowableFacade.findHistoricProcessInstanceIdByProcessDefinitionKey(operations.get(0)\n-                                                                                                                                          .getProcessId(),\n-                                                                                                                                Constants.BLUE_GREEN_DEPLOY_SERVICE_ID);\n+        String processIdOfPreviousProcess = operations.get(0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6f74499df3e262df555dc5bd6a4e2a247630a97"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODAxMzUwOQ==", "bodyText": "endedAt can be hardcoded to ZonedDateTime.now. I don't foresee anyone wanting to pass some different value.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#discussion_r438013509", "createdAt": "2020-06-10T10:11:02Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/ProcessConflictPreventer.java", "diffHunk": "@@ -66,13 +67,15 @@ private void validateNoConflictingOperationsExist(String mtaId, String spaceId)\n                                .list();\n     }\n \n-    public void releaseLock(String processInstanceId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6f74499df3e262df555dc5bd6a4e2a247630a97"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a305b0689a59625f3d8cfd6df111b1b2b20dc4f", "author": {"user": {"login": "theghost5800", "name": "Kristian Atanasov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/3a305b0689a59625f3d8cfd6df111b1b2b20dc4f", "committedDate": "2020-06-10T10:24:31Z", "message": "Add javadoc for singleResult method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1acbace393b2d45760bc1813a1b8bea21a16cd2e", "author": {"user": {"login": "theghost5800", "name": "Kristian Atanasov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/1acbace393b2d45760bc1813a1b8bea21a16cd2e", "committedDate": "2020-06-10T10:24:39Z", "message": "Use containsAll method to compare lists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e8edc5631b228bedf9f59e6c63fdccd2cb31b0f", "author": {"user": {"login": "theghost5800", "name": "Kristian Atanasov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/7e8edc5631b228bedf9f59e6c63fdccd2cb31b0f", "committedDate": "2020-06-10T10:24:39Z", "message": "Fix detection of old blue-green processes\n\nDo not search for sub processes because blue-green process is already\nparent process, set final+endedAt state in operation table when process\nis aborted\n\nJIRA:LMCROSSITXSADEPLOY-2097"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c38f6b03a79171043e59a69c2416408e5445981c", "author": {"user": {"login": "theghost5800", "name": "Kristian Atanasov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/c38f6b03a79171043e59a69c2416408e5445981c", "committedDate": "2020-06-10T11:15:51Z", "message": "Refactoring"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c6f74499df3e262df555dc5bd6a4e2a247630a97", "author": {"user": {"login": "theghost5800", "name": "Kristian Atanasov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/c6f74499df3e262df555dc5bd6a4e2a247630a97", "committedDate": "2020-06-10T09:21:03Z", "message": "Fix detection of old blue-green processes\n\nDo not search for sub processes because blue-green process is already\nparent process, set final+endedAt state in operation table when process\nis aborted\n\nJIRA:LMCROSSITXSADEPLOY-2097"}, "afterCommit": {"oid": "c38f6b03a79171043e59a69c2416408e5445981c", "author": {"user": {"login": "theghost5800", "name": "Kristian Atanasov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/c38f6b03a79171043e59a69c2416408e5445981c", "committedDate": "2020-06-10T11:15:51Z", "message": "Refactoring"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3OTUzOTcy", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#pullrequestreview-427953972", "createdAt": "2020-06-10T11:18:13Z", "commit": {"oid": "c38f6b03a79171043e59a69c2416408e5445981c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3OTY4OTc0", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/875#pullrequestreview-427968974", "createdAt": "2020-06-10T11:42:09Z", "commit": {"oid": "c38f6b03a79171043e59a69c2416408e5445981c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 935, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}