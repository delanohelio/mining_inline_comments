{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwOTQyNjk4", "number": 936, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNDo0MjowMlrOEakQYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNDo0MjozM1rOEakRSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MjkyNDQ4OnYy", "diffSide": "RIGHT", "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNDo0MjowMlrOHEE4zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNDo1OTowOVrOHEFrRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjQyOQ==", "bodyText": "I don't understand the need for this variable.\nJust pass the list (and remove the List suffix from its name) to the other method", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474036429", "createdAt": "2020-08-20T14:42:02Z", "author": {"login": "radito3"}, "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "diffHunk": "@@ -49,13 +51,28 @@ protected StepPhase executeStep(ProcessContext context) {\n         return StepPhase.DONE;\n     }\n \n-    private List<String> computeOldAppsToRename(Set<String> appsToProcess) {\n-        return appsToProcess.stream()\n-                            .filter(appName -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(appName))\n-                            .collect(Collectors.toList());\n+    private List<String> computeOldAppsToRename(DeployedMta deployedMta, List<String> selectedModulesList) {        \n+        Set<String> selectedModulesSet = new TreeSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a0252f8542a4f2b51550012b79d8fe597e01099"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA0Mzg2Mg==", "bodyText": "the set will have better performance when later making the contains check", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474043862", "createdAt": "2020-08-20T14:52:11Z", "author": {"login": "ikasarov"}, "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "diffHunk": "@@ -49,13 +51,28 @@ protected StepPhase executeStep(ProcessContext context) {\n         return StepPhase.DONE;\n     }\n \n-    private List<String> computeOldAppsToRename(Set<String> appsToProcess) {\n-        return appsToProcess.stream()\n-                            .filter(appName -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(appName))\n-                            .collect(Collectors.toList());\n+    private List<String> computeOldAppsToRename(DeployedMta deployedMta, List<String> selectedModulesList) {        \n+        Set<String> selectedModulesSet = new TreeSet<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjQyOQ=="}, "originalCommit": {"oid": "8a0252f8542a4f2b51550012b79d8fe597e01099"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA0OTM0OA==", "bodyText": "will remove in service of code clarity, performance isn't really a concern here", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474049348", "createdAt": "2020-08-20T14:59:09Z", "author": {"login": "ikasarov"}, "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "diffHunk": "@@ -49,13 +51,28 @@ protected StepPhase executeStep(ProcessContext context) {\n         return StepPhase.DONE;\n     }\n \n-    private List<String> computeOldAppsToRename(Set<String> appsToProcess) {\n-        return appsToProcess.stream()\n-                            .filter(appName -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(appName))\n-                            .collect(Collectors.toList());\n+    private List<String> computeOldAppsToRename(DeployedMta deployedMta, List<String> selectedModulesList) {        \n+        Set<String> selectedModulesSet = new TreeSet<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjQyOQ=="}, "originalCommit": {"oid": "8a0252f8542a4f2b51550012b79d8fe597e01099"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MjkyNjgxOnYy", "diffSide": "RIGHT", "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNDo0MjozM1rOHEE6Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNDo0MjozM1rOHEE6Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDAzNjc5OQ==", "bodyText": "Wouldn't isModuleSelectedForDeployment be better?\nAnd rename the first parameter to moduleName", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/936#discussion_r474036799", "createdAt": "2020-08-20T14:42:33Z", "author": {"login": "radito3"}, "path": "multiapps-controller-process/src/main/java/org/cloudfoundry/multiapps/controller/process/steps/DetectApplicationsToRenameStep.java", "diffHunk": "@@ -49,13 +51,28 @@ protected StepPhase executeStep(ProcessContext context) {\n         return StepPhase.DONE;\n     }\n \n-    private List<String> computeOldAppsToRename(Set<String> appsToProcess) {\n-        return appsToProcess.stream()\n-                            .filter(appName -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(appName))\n-                            .collect(Collectors.toList());\n+    private List<String> computeOldAppsToRename(DeployedMta deployedMta, List<String> selectedModulesList) {        \n+        Set<String> selectedModulesSet = new TreeSet<>();\n+        selectedModulesSet.addAll(CollectionUtils.emptyIfNull(selectedModulesList));\n+\n+        return deployedMta.getApplications()\n+                          .stream()\n+                          .filter(app -> !BlueGreenApplicationNameSuffix.isSuffixContainedIn(app.getName()))\n+                          .filter(app -> moduleIsSelectedForDeployment(app.getModuleName(), selectedModulesSet))\n+                          .map(DeployedMtaApplication::getName)\n+                          .collect(Collectors.toList());\n+    }\n+\n+    private boolean moduleIsSelectedForDeployment(String module, Set<String> selectedModules) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a0252f8542a4f2b51550012b79d8fe597e01099"}, "originalPosition": 47}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 401, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}