{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2NjMzMDM4", "number": 768, "title": "Update messages in new bg-deploy process", "bodyText": "Update and add messages, and change app name suffixes to -live / -idle\nfrom -old / -new respectively", "createdAt": "2020-02-18T13:59:24Z", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768", "merged": true, "mergeCommit": {"oid": "8fadadfa9b429dd3898321cf4bc0a7469af9122f"}, "closed": true, "closedAt": "2020-02-19T09:46:33Z", "author": {"login": "radito3"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFyM7ugFqTM2MDkxMzcwOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFzVfSAFqTM2MDk2NjgzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwOTEzNzA4", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#pullrequestreview-360913708", "createdAt": "2020-02-19T08:22:07Z", "commit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwODoyMjowN1rOFretvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwODoyNDo1NVrOFreyaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTEzNjMxNg==", "bodyText": "Add quotes around the names for consistency with the other progress messages.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#discussion_r381136316", "createdAt": "2020-02-19T08:22:07Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/Messages.java", "diffHunk": "@@ -262,6 +262,7 @@\n     public static final String SERVICE_BROKER_DOES_NOT_EXIST = \"Service broker with name \\\"{0}\\\" does not exist\";\r\n     public static final String EXECUTING_HOOK_0 = \"Executing hook \\\"{0}\\\"\";\r\n     public static final String WAITING_PREVIOUS_OPERATIONS_TO_FINISH = \"Waiting for previous service operations to finish...\";\r\n+    public static final String RENAMING_APPLICATION_0_TO_1 = \"Renaming application {0} to {1}...\";\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTEzNjQ3NA==", "bodyText": "Same", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#discussion_r381136474", "createdAt": "2020-02-19T08:22:31Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/Messages.java", "diffHunk": "@@ -427,9 +428,7 @@\n     public static final String NO_READ_ONLY_PARAMETERS_ARE_OVERWRITTEN = \"No read-only parameters are overwritten\";\r\n     public static final String MODULE_WITH_APPLICATION_NAME_WAS_MARKED_AS_IDLE = \"Module \\\"{0}\\\" with application name \\\"{1}\\\" was marked as idle\";\r\n     public static final String UPDATING_APP_NAMES_WITH_NEW_SUFFIX = \"Updating application names in deployment descriptor with 'new' suffix\";\r\n-    public static final String RENAMING_NEW_APPLICATIONS = \"Renaming new applications...\";\r\n-    public static final String RENAMING_OLD_APPLICATIONS = \"Renaming old applications...\";\r\n-    public static final String RENAMING_APPLICATION = \"Renaming application {0}\";\r\n+    public static final String UPDATING_CONFIGURATION_SUBSCRIPTION_0_WITH_NAME_1 = \"Updating configuration subscription {0} with name {1}\";\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTEzNjg2Mw==", "bodyText": "Extract BlueGreenApplicationNameSuffix.removeSuffix(appName) in a variable.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#discussion_r381136863", "createdAt": "2020-02-19T08:23:29Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/RemoveNewApplicationsSuffixStep.java", "diffHunk": "@@ -27,13 +27,12 @@ protected StepPhase executeStep(ExecutionWrapper execution) {\n         if (!StepsUtil.getKeepOriginalAppNamesAfterDeploy(execution.getContext())) {\n             return StepPhase.DONE;\n         }\n-        getStepLogger().info(Messages.RENAMING_NEW_APPLICATIONS);\n \n         List<String> appsToProcess = StepsUtil.getAppsToDeploy(execution.getContext());\n         CloudControllerClient client = execution.getControllerClient();\n \n         for (String appName : appsToProcess) {\n-            getStepLogger().debug(Messages.RENAMING_APPLICATION, appName);\n+            getStepLogger().info(Messages.RENAMING_APPLICATION_0_TO_1, appName, BlueGreenApplicationNameSuffix.removeSuffix(appName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTEzNzQwOA==", "bodyText": "Extract BlueGreenApplicationNameSuffix.removeSuffix(appName) in a variable and pass it to updateConfigurationSubscription. Otherwise, if you change the code in createNewSubscription you might forget to also change this message.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#discussion_r381137408", "createdAt": "2020-02-19T08:24:42Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/RemoveNewApplicationsSuffixStep.java", "diffHunk": "@@ -50,6 +49,8 @@ private void updateConfigurationSubscribers(List<String> appsToProcess, String m\n                                                                            .list();\n         for (ConfigurationSubscription subscription : subscriptions) {\n             if (appsToProcess.contains(subscription.getAppName())) {\n+                getStepLogger().debug(Messages.UPDATING_CONFIGURATION_SUBSCRIPTION_0_WITH_NAME_1, subscription.getAppName(),\n+                                      BlueGreenApplicationNameSuffix.removeSuffix(subscription.getAppName()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTEzNzUxNQ==", "bodyText": "Extract appName + BlueGreenApplicationNameSuffix.LIVE.asSuffix() in a variable.", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#discussion_r381137515", "createdAt": "2020-02-19T08:24:55Z", "author": {"login": "nictas"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/RenameApplicationsStep.java", "diffHunk": "@@ -72,15 +72,14 @@ public void execute(ExecutionWrapper execution) {\n             }\n \n             getStepLogger().debug(Messages.UPDATING_APP_NAMES_WITH_NEW_SUFFIX);\n-            updateApplicationNamesInDescriptor(context, BlueGreenApplicationNameSuffix.NEW.asSuffix());\n+            updateApplicationNamesInDescriptor(context, BlueGreenApplicationNameSuffix.IDLE.asSuffix());\n         }\n \n         private void renameOldApps(List<String> appsToRename, CloudControllerClient client) {\n-            getStepLogger().info(Messages.RENAMING_OLD_APPLICATIONS);\n-\n             for (String appName : appsToRename) {\n-                getStepLogger().debug(Messages.RENAMING_APPLICATION, appName);\n-                client.rename(appName, appName + BlueGreenApplicationNameSuffix.OLD.asSuffix());\n+                getStepLogger().info(Messages.RENAMING_APPLICATION_0_TO_1, appName,\n+                                     appName + BlueGreenApplicationNameSuffix.LIVE.asSuffix());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445", "author": {"user": {"login": "radito3", "name": "Rangel Ivanov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/d531ebbcdf4b8cb2fc7c2a2b30092a0681d4b445", "committedDate": "2020-02-18T13:42:12Z", "message": "Update messages in new bg-deploy process\n\nUpdate and add messages, and change app name suffixes to -live / -idle\nfrom -old / -new respectively"}, "afterCommit": {"oid": "01750cee5ff1cbeeffb9d7e957ad1146f61aa59b", "author": {"user": {"login": "radito3", "name": "Rangel Ivanov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/01750cee5ff1cbeeffb9d7e957ad1146f61aa59b", "committedDate": "2020-02-19T09:39:51Z", "message": "Update messages in new bg-deploy process\n\nUpdate and add messages, and change app name suffixes to -live / -idle\nfrom -old / -new respectively"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cfd972b0b9ebcb014c59e2c73a04c8b10dc2b45", "author": {"user": {"login": "radito3", "name": "Rangel Ivanov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/8cfd972b0b9ebcb014c59e2c73a04c8b10dc2b45", "committedDate": "2020-02-19T09:43:50Z", "message": "Update messages in new bg-deploy process\n\nUpdate and add messages, and change app name suffixes to -live / -idle\nfrom -old / -new respectively"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01750cee5ff1cbeeffb9d7e957ad1146f61aa59b", "author": {"user": {"login": "radito3", "name": "Rangel Ivanov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/01750cee5ff1cbeeffb9d7e957ad1146f61aa59b", "committedDate": "2020-02-19T09:39:51Z", "message": "Update messages in new bg-deploy process\n\nUpdate and add messages, and change app name suffixes to -live / -idle\nfrom -old / -new respectively"}, "afterCommit": {"oid": "8cfd972b0b9ebcb014c59e2c73a04c8b10dc2b45", "author": {"user": {"login": "radito3", "name": "Rangel Ivanov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/8cfd972b0b9ebcb014c59e2c73a04c8b10dc2b45", "committedDate": "2020-02-19T09:43:50Z", "message": "Update messages in new bg-deploy process\n\nUpdate and add messages, and change app name suffixes to -live / -idle\nfrom -old / -new respectively"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwOTY2ODM4", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/768#pullrequestreview-360966838", "createdAt": "2020-02-19T09:44:20Z", "commit": {"oid": "8cfd972b0b9ebcb014c59e2c73a04c8b10dc2b45"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1004, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}