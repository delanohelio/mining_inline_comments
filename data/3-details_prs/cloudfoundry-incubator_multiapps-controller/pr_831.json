{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMjE2MzQ5", "number": 831, "title": "Fix check for dependency satisfaction", "bodyText": "Make ModuleDependencyChecker verify that a module is either in the\ndeployed modules or in the modules not for deployment. Add a check in\nComputeNextModulesStep for possible infinite loop as safe mechanism.\nJIRA: LMCROSSITXSADEPLOY-2010", "createdAt": "2020-04-07T11:45:49Z", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/831", "merged": true, "mergeCommit": {"oid": "1d6eda53bf38c3225c3e88a77ded7389089b342b"}, "closed": true, "closedAt": "2020-04-07T13:24:04Z", "author": {"login": "radoslav-d"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVSB5HgBqjMyMDk1MTQ1Mjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVSsnfgFqTM4OTA3Nzk3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f975fe17a10cc0fdcc8783bf7a3f9a7b64a9ac94", "author": {"user": {"login": "radoslav-d", "name": "Radoslav Dimitrov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/f975fe17a10cc0fdcc8783bf7a3f9a7b64a9ac94", "committedDate": "2020-04-07T11:43:51Z", "message": "Fix check for dependency satisfaction\n\nMake ModuleDependencyChecker verify that a module is either in the\ndeployed modules or in the modules not for deployment. Add a check in\nComputeNextModulesStep for possible infinite loop as safe mechanism.\nJIRA: LMCROSSITXSADEPLOY-2010"}, "afterCommit": {"oid": "d8278e92425545f4cdcf9781200c9da1184b6856", "author": {"user": {"login": "radoslav-d", "name": "Radoslav Dimitrov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/d8278e92425545f4cdcf9781200c9da1184b6856", "committedDate": "2020-04-07T11:58:33Z", "message": "Fix check for dependency satisfaction\n\nMake ModuleDependencyChecker verify that a module is either in the\ndeployed modules or in the modules not for deployment. Add a check in\nComputeNextModulesStep for possible infinite loop as safe mechanism.\nJIRA: LMCROSSITXSADEPLOY-2010"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MDQ2MTE2", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/831#pullrequestreview-389046116", "createdAt": "2020-04-07T12:01:24Z", "commit": {"oid": "d8278e92425545f4cdcf9781200c9da1184b6856"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjowMToyNFrOGCAMcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjowNzoyOFrOGCAYgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc1MzUyMA==", "bodyText": "Rather than using the negate() method, change isProcessed() to accept a parameter and return a boolean then negate that function", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/831#discussion_r404753520", "createdAt": "2020-04-07T12:01:24Z", "author": {"login": "radito3"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/ModuleDependencyChecker.java", "diffHunk": "@@ -82,4 +83,20 @@ private boolean areAllDependenciesAlreadyPresent(List<String> deployedAfter) {\n     public Set<String> getAlreadyDeployedModules() {\n         return modulesAlreadyDeployed;\n     }\n+\n+    public Set<String> getNotProcessedModules() {\n+        return modulesForDeployment.stream()\n+                                   .filter(isProcessed().negate())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8278e92425545f4cdcf9781200c9da1184b6856"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc1Mzk2Nw==", "bodyText": "That way you can use a method reference here", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/831#discussion_r404753967", "createdAt": "2020-04-07T12:02:14Z", "author": {"login": "radito3"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/ModuleDependencyChecker.java", "diffHunk": "@@ -82,4 +83,20 @@ private boolean areAllDependenciesAlreadyPresent(List<String> deployedAfter) {\n     public Set<String> getAlreadyDeployedModules() {\n         return modulesAlreadyDeployed;\n     }\n+\n+    public Set<String> getNotProcessedModules() {\n+        return modulesForDeployment.stream()\n+                                   .filter(isProcessed().negate())\n+                                   .collect(Collectors.toSet());\n+    }\n+\n+    private boolean areDependenciesProcessed(Module module) {\n+        return module.getDeployedAfter()\n+                     .stream()\n+                     .allMatch(isProcessed());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8278e92425545f4cdcf9781200c9da1184b6856"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc1NjYxMQ==", "bodyText": "\"Dependencies can't be satisfied\" is too generic. An error message should be as descriptive as possible", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/831#discussion_r404756611", "createdAt": "2020-04-07T12:07:28Z", "author": {"login": "radito3"}, "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/Messages.java", "diffHunk": "@@ -61,6 +61,7 @@\n     public static final String APPLICATION_UNBOUND_IN_PARALLEL = \"Application {0} was bound to service {1} which was unbound in parallel\";\r\n     public static final String ABORT_OPERATION_TIMED_OUT = \"Abort operation timed out\";\r\n     public static final String FLOWABLE_JOB_RETRY_FAILED = \"Flowable job retry failed\";\r\n+    public static final String DEPENDENCIES_CANNOT_BE_SATISFIED = \"Dependencies for modules {0} cannot be satisfied\";\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8278e92425545f4cdcf9781200c9da1184b6856"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f3b3f843a3d5cb616c75a441cbe6c0208ef9d8b", "author": {"user": {"login": "radoslav-d", "name": "Radoslav Dimitrov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/0f3b3f843a3d5cb616c75a441cbe6c0208ef9d8b", "committedDate": "2020-04-07T12:32:13Z", "message": "Fix check for dependency satisfaction\n\nMake ModuleDependencyChecker verify that a module is either in the\ndeployed modules or in the modules not for deployment.\nJIRA: LMCROSSITXSADEPLOY-2010"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8278e92425545f4cdcf9781200c9da1184b6856", "author": {"user": {"login": "radoslav-d", "name": "Radoslav Dimitrov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/d8278e92425545f4cdcf9781200c9da1184b6856", "committedDate": "2020-04-07T11:58:33Z", "message": "Fix check for dependency satisfaction\n\nMake ModuleDependencyChecker verify that a module is either in the\ndeployed modules or in the modules not for deployment. Add a check in\nComputeNextModulesStep for possible infinite loop as safe mechanism.\nJIRA: LMCROSSITXSADEPLOY-2010"}, "afterCommit": {"oid": "0f3b3f843a3d5cb616c75a441cbe6c0208ef9d8b", "author": {"user": {"login": "radoslav-d", "name": "Radoslav Dimitrov"}}, "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/0f3b3f843a3d5cb616c75a441cbe6c0208ef9d8b", "committedDate": "2020-04-07T12:32:13Z", "message": "Fix check for dependency satisfaction\n\nMake ModuleDependencyChecker verify that a module is either in the\ndeployed modules or in the modules not for deployment.\nJIRA: LMCROSSITXSADEPLOY-2010"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MDc3OTc1", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/831#pullrequestreview-389077975", "createdAt": "2020-04-07T12:45:31Z", "commit": {"oid": "0f3b3f843a3d5cb616c75a441cbe6c0208ef9d8b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 888, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}