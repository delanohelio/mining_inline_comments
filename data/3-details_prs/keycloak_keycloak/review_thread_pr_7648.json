{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NDQ3NTQ0", "number": 7648, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNzowNzoyNlrOFCKKog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNzowNzoyNlrOFCKKog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3ODA4MDM0OnYy", "diffSide": "RIGHT", "path": "services/src/main/java/org/keycloak/services/managers/RealmManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNzowNzoyNlrOIBKKeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNzoxMDowN1rOIBKPWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4NjAwOQ==", "bodyText": "Prefer orElseGet, otherwise the lookup by getClientByClientId is always performed, even when client can be found by id.", "url": "https://github.com/keycloak/keycloak/pull/7648#discussion_r538086009", "createdAt": "2020-12-08T07:07:26Z", "author": {"login": "hmlnarik"}, "path": "services/src/main/java/org/keycloak/services/managers/RealmManager.java", "diffHunk": "@@ -719,7 +720,15 @@ public void setupClientServiceAccountsAndAuthorizationOnImport(RealmRepresentati\n             ClientManager clientManager = new ClientManager(this);\n \n             for (ClientRepresentation client : clients) {\n-                ClientModel clientModel = this.getRealmByName(rep.getRealm()).getClientById(client.getId());\n+                RealmModel realmModel = this.getRealmByName(rep.getRealm());\n+\n+                ClientModel clientModel = Optional.ofNullable(client.getId())\n+                        .map(realmModel::getClientById)\n+                        .orElse(realmModel.getClientByClientId(client.getClientId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea53e5fee3e03691ffc8912ce52cf4d95ee42d7b"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4NzI1OQ==", "bodyText": "@hmlnarik You're right. Thanks!", "url": "https://github.com/keycloak/keycloak/pull/7648#discussion_r538087259", "createdAt": "2020-12-08T07:10:07Z", "author": {"login": "mabartos"}, "path": "services/src/main/java/org/keycloak/services/managers/RealmManager.java", "diffHunk": "@@ -719,7 +720,15 @@ public void setupClientServiceAccountsAndAuthorizationOnImport(RealmRepresentati\n             ClientManager clientManager = new ClientManager(this);\n \n             for (ClientRepresentation client : clients) {\n-                ClientModel clientModel = this.getRealmByName(rep.getRealm()).getClientById(client.getId());\n+                RealmModel realmModel = this.getRealmByName(rep.getRealm());\n+\n+                ClientModel clientModel = Optional.ofNullable(client.getId())\n+                        .map(realmModel::getClientById)\n+                        .orElse(realmModel.getClientByClientId(client.getClientId()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4NjAwOQ=="}, "originalCommit": {"oid": "ea53e5fee3e03691ffc8912ce52cf4d95ee42d7b"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3214, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}