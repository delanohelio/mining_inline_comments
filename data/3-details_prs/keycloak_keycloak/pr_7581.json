{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1OTc2NzA2", "number": 7581, "title": "KEYCLOAK-16156 Optimize maven repo handling", "bodyText": "", "createdAt": "2020-11-05T10:59:54Z", "url": "https://github.com/keycloak/keycloak/pull/7581", "merged": true, "mergeCommit": {"oid": "f93924e782038365a232a11b2e3bf4892c1e2a6d"}, "closed": true, "closedAt": "2020-11-05T16:24:06Z", "author": {"login": "hmlnarik"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZggEgABqjM5NjE4NjgzMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZknVIgFqTUyNDQxNzIxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "462320f28cdf14867ae2d9c25c584f4d1c847957", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/462320f28cdf14867ae2d9c25c584f4d1c847957", "committedDate": "2020-11-05T10:59:32Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}, "afterCommit": {"oid": "b2f7dfdc8eeca9dd3daab54b2cf606d3383799e5", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/b2f7dfdc8eeca9dd3daab54b2cf606d3383799e5", "committedDate": "2020-11-05T11:16:38Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2f7dfdc8eeca9dd3daab54b2cf606d3383799e5", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/b2f7dfdc8eeca9dd3daab54b2cf606d3383799e5", "committedDate": "2020-11-05T11:16:38Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}, "afterCommit": {"oid": "0a3ac0e4cd4b52232ffa9afcd2f419f6b31189d9", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/0a3ac0e4cd4b52232ffa9afcd2f419f6b31189d9", "committedDate": "2020-11-05T11:21:31Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a3ac0e4cd4b52232ffa9afcd2f419f6b31189d9", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/0a3ac0e4cd4b52232ffa9afcd2f419f6b31189d9", "committedDate": "2020-11-05T11:21:31Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}, "afterCommit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/32f5246a2fdf4156c9577247acceaae69c5ff93b", "committedDate": "2020-11-05T11:35:08Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MjgxNTEy", "url": "https://github.com/keycloak/keycloak/pull/7581#pullrequestreview-524281512", "createdAt": "2020-11-05T13:54:33Z", "commit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzo1NDozNFrOHuET8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzo1NDozNFrOHuET8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA2NzE4Ng==", "bodyText": "Just cosmetic change to be consistent, somewhere the exit ${PIPESTATUS[0]} is on separate line and somewhere not\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      mvn clean install -B -Pquarkus,auth-server-quarkus -f testsuite/integration-arquillian/tests/base/pom.xml -Dtest='!org.keycloak.testsuite.adapter.**,!**.crossdc.**,!**.cluster.**' | misc/log/trimmer.sh; exit ${PIPESTATUS[0]}\n          \n          \n            \n                      mvn clean install -B -Pquarkus,auth-server-quarkus -f testsuite/integration-arquillian/tests/base/pom.xml -Dtest='!org.keycloak.testsuite.adapter.**,!**.crossdc.**,!**.cluster.**' | misc/log/trimmer.sh\n          \n          \n            \n                      exit ${PIPESTATUS[0]}", "url": "https://github.com/keycloak/keycloak/pull/7581#discussion_r518067186", "createdAt": "2020-11-05T13:54:34Z", "author": {"login": "martin-kanis"}, "path": ".github/workflows/ci-x.yml", "diffHunk": "@@ -36,23 +34,26 @@ jobs:\n       MAVEN_OPTS: -Xmx2048m\n     steps:\n       - uses: actions/checkout@v2\n+\n+      - name: Cache Maven packages\n+        uses: actions/cache@v2\n+        with:\n+          path: |\n+            ~/.m2/repository\n+            !~/.m2/repository/org/keycloak\n+          key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+          restore-keys: ${{ runner.os }}-m2\n+\n       - uses: actions/setup-java@v1\n         with:\n           java-version: 1.8\n-      - name: Download Maven Repo\n-        uses: actions/download-artifact@v1\n-        with:\n-          name: maven-repo\n-          path: .\n-      - name: Extract Maven Repo\n-        shell: bash\n-        run: tar -xzvf maven-repo.tgz -C ~\n+\n       - name: Run Quarkus unit tests\n-        run: mvn clean install -B -Pquarkus -f quarkus/pom.xml\n-      - name: Build testsuite\n-        run: mvn clean install -B -Pquarkus,auth-server-quarkus -DskipTests -f testsuite/pom.xml\n-      - name: Run base tests\n-        run: mvn clean install -B -Pquarkus,auth-server-quarkus -f testsuite/integration-arquillian/tests/base/pom.xml -Dtest='!org.keycloak.testsuite.adapter.**,!**.crossdc.**,!**.cluster.**' | misc/log/trimmer.sh; exit ${PIPESTATUS[0]}\n+        run: |\n+          mvn clean install -B -Pquarkus -f quarkus/pom.xml\n+          mvn clean install -B -Pquarkus,auth-server-quarkus -DskipTests -f testsuite/pom.xml\n+          mvn clean install -B -Pquarkus,auth-server-quarkus -f testsuite/integration-arquillian/tests/base/pom.xml -Dtest='!org.keycloak.testsuite.adapter.**,!**.crossdc.**,!**.cluster.**' | misc/log/trimmer.sh; exit ${PIPESTATUS[0]}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MjgzMjk5", "url": "https://github.com/keycloak/keycloak/pull/7581#pullrequestreview-524283299", "createdAt": "2020-11-05T13:56:23Z", "commit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzo1NjoyM1rOHuEZLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzo1NjoyM1rOHuEZLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA2ODUyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - name: Build\n          \n          \n            \n                  - name: Build cache", "url": "https://github.com/keycloak/keycloak/pull/7581#discussion_r518068524", "createdAt": "2020-11-05T13:56:23Z", "author": {"login": "martin-kanis"}, "path": ".github/workflows/ci.yml", "diffHunk": "@@ -12,25 +12,24 @@ jobs:\n         with:\n           java-version: 1.8\n       - name: Cache Maven packages\n+        id: cache\n         uses: actions/cache@v2\n         with:\n-          path: ~/.m2/repository\n+          path: |\n+            ~/.m2/repository\n+            !~/.m2/repository/org/keycloak\n           key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n           restore-keys: ${{ runner.os }}-m2\n       - name: Build", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0Mjg0MzYz", "url": "https://github.com/keycloak/keycloak/pull/7581#pullrequestreview-524284363", "createdAt": "2020-11-05T13:57:30Z", "commit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzo1NzozMFrOHuEcgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzo1NzozMFrOHuEcgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA2OTM3Nw==", "bodyText": "Also to be consistent with Quarkus yaml\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      mvn install -nsu -B -DskipTests -Pdistribution\n          \n          \n            \n                      mvn clean install -nsu -B -DskipTests -Pdistribution", "url": "https://github.com/keycloak/keycloak/pull/7581#discussion_r518069377", "createdAt": "2020-11-05T13:57:30Z", "author": {"login": "martin-kanis"}, "path": ".github/workflows/ci.yml", "diffHunk": "@@ -12,25 +12,24 @@ jobs:\n         with:\n           java-version: 1.8\n       - name: Cache Maven packages\n+        id: cache\n         uses: actions/cache@v2\n         with:\n-          path: ~/.m2/repository\n+          path: |\n+            ~/.m2/repository\n+            !~/.m2/repository/org/keycloak\n           key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n           restore-keys: ${{ runner.os }}-m2\n       - name: Build\n-        run: mvn install -B -DskipTests -Pdistribution\n-      - name: Tar Maven Repo\n-        shell: bash\n-        run: tar -czvf maven-repo.tgz -C ~ .m2/repository\n-      - name: Persist Maven Repo\n-        uses: actions/upload-artifact@v1\n-        with:\n-          name: maven-repo\n-          path: maven-repo.tgz\n+        if: steps.cache.outputs.cache-hit != 'true'\n+        run: |\n+          mvn clean install -B -e -DskipTests -Pquarkus,distribution\n+          mvn install -nsu -B -DskipTests -Pdistribution", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b"}, "originalPosition": 26}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "32f5246a2fdf4156c9577247acceaae69c5ff93b", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/32f5246a2fdf4156c9577247acceaae69c5ff93b", "committedDate": "2020-11-05T11:35:08Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}, "afterCommit": {"oid": "081ed1ff2e192cd124ffb666cc7c9baa6e1d35af", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/081ed1ff2e192cd124ffb666cc7c9baa6e1d35af", "committedDate": "2020-11-05T14:06:28Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "208f5e3805bf2a6c3119b7db000e64257c3a7aae", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/208f5e3805bf2a6c3119b7db000e64257c3a7aae", "committedDate": "2020-11-05T15:23:15Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "081ed1ff2e192cd124ffb666cc7c9baa6e1d35af", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/081ed1ff2e192cd124ffb666cc7c9baa6e1d35af", "committedDate": "2020-11-05T14:06:28Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}, "afterCommit": {"oid": "208f5e3805bf2a6c3119b7db000e64257c3a7aae", "author": {"user": {"login": "hmlnarik", "name": "Hynek Mlna\u0159\u00edk"}}, "url": "https://github.com/keycloak/keycloak/commit/208f5e3805bf2a6c3119b7db000e64257c3a7aae", "committedDate": "2020-11-05T15:23:15Z", "message": "KEYCLOAK-16156 Optimize maven repo handling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NDE3MjE2", "url": "https://github.com/keycloak/keycloak/pull/7581#pullrequestreview-524417216", "createdAt": "2020-11-05T16:04:53Z", "commit": {"oid": "208f5e3805bf2a6c3119b7db000e64257c3a7aae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3411, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}