{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NjcyMzMw", "number": 6702, "title": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering", "bodyText": "", "createdAt": "2020-01-29T17:13:16Z", "url": "https://github.com/keycloak/keycloak/pull/6702", "merged": true, "mergeCommit": {"oid": "fc514aa2567ca353b8c3dc380ff80b9af88c9295"}, "closed": true, "closedAt": "2020-02-06T12:16:03Z", "author": {"login": "pedroigor"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_ZFO5ABqjI5OTMwMTEzMzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBptmHgFqTM1NDQwNTM4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9dd694d17a1abcbe59254468883f2e6188915ef9", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/9dd694d17a1abcbe59254468883f2e6188915ef9", "committedDate": "2020-01-29T17:12:47Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}, "afterCommit": {"oid": "90583f72ab84dba7bd6509d422eb340af4fe3653", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/90583f72ab84dba7bd6509d422eb340af4fe3653", "committedDate": "2020-01-30T11:45:02Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMzIzMjUx", "url": "https://github.com/keycloak/keycloak/pull/6702#pullrequestreview-352323251", "createdAt": "2020-02-03T15:08:11Z", "commit": {"oid": "90583f72ab84dba7bd6509d422eb340af4fe3653"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxNTowODoxMVrOFk0nOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxNTowODoxMVrOFk0nOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE1NTA2Ng==", "bodyText": "Should we use https://github.com/keycloak/keycloak/blob/master/server-spi-private/src/main/java/org/keycloak/models/utils/KeycloakModelUtils.java#L81 instead of UUID? SecureRandom seems more appropriate for a nonce than an UUID", "url": "https://github.com/keycloak/keycloak/pull/6702#discussion_r374155066", "createdAt": "2020-02-03T15:08:11Z", "author": {"login": "stianst"}, "path": "services/src/main/java/org/keycloak/broker/oidc/OIDCIdentityProvider.java", "diffHunk": "@@ -715,4 +721,32 @@ protected BrokeredIdentityContext exchangeExternalImpl(EventBuilder event, Multi\n             throw new ErrorResponseException(OAuthErrorException.INVALID_TOKEN, \"invalid token type\", Response.Status.BAD_REQUEST);\n         }\n     }\n+\n+    @Override\n+    protected UriBuilder createAuthorizationUrl(AuthenticationRequest request) {\n+        UriBuilder uriBuilder = super.createAuthorizationUrl(request);\n+        String nonce = UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90583f72ab84dba7bd6509d422eb340af4fe3653"}, "originalPosition": 42}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90583f72ab84dba7bd6509d422eb340af4fe3653", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/90583f72ab84dba7bd6509d422eb340af4fe3653", "committedDate": "2020-01-30T11:45:02Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}, "afterCommit": {"oid": "dd3ced4a63bbf498cd709da64c3f758b8a8403b9", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/dd3ced4a63bbf498cd709da64c3f758b8a8403b9", "committedDate": "2020-02-04T11:18:39Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMDE4Mzcw", "url": "https://github.com/keycloak/keycloak/pull/6702#pullrequestreview-353018370", "createdAt": "2020-02-04T14:30:35Z", "commit": {"oid": "dd3ced4a63bbf498cd709da64c3f758b8a8403b9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd3ced4a63bbf498cd709da64c3f758b8a8403b9", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/dd3ced4a63bbf498cd709da64c3f758b8a8403b9", "committedDate": "2020-02-04T11:18:39Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}, "afterCommit": {"oid": "83c8ca7f0c8f7287e16f4f3f015b3eec77492b14", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/83c8ca7f0c8f7287e16f4f3f015b3eec77492b14", "committedDate": "2020-02-05T11:46:07Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83c8ca7f0c8f7287e16f4f3f015b3eec77492b14", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/83c8ca7f0c8f7287e16f4f3f015b3eec77492b14", "committedDate": "2020-02-05T11:46:07Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}, "afterCommit": {"oid": "ac504b203d962be89173681a67eee703cc8496a0", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/ac504b203d962be89173681a67eee703cc8496a0", "committedDate": "2020-02-05T14:19:51Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01df59b06bab3af1c469a1ecc9b9f71951f6c183", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/01df59b06bab3af1c469a1ecc9b9f71951f6c183", "committedDate": "2020-02-05T15:52:43Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac504b203d962be89173681a67eee703cc8496a0", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/ac504b203d962be89173681a67eee703cc8496a0", "committedDate": "2020-02-05T14:19:51Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}, "afterCommit": {"oid": "01df59b06bab3af1c469a1ecc9b9f71951f6c183", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/01df59b06bab3af1c469a1ecc9b9f71951f6c183", "committedDate": "2020-02-05T15:52:43Z", "message": "[KEYCLOAK-12792] - Invalid nonce handling in OIDC identity brokering"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NDA1Mzg2", "url": "https://github.com/keycloak/keycloak/pull/6702#pullrequestreview-354405386", "createdAt": "2020-02-06T12:15:55Z", "commit": {"oid": "01df59b06bab3af1c469a1ecc9b9f71951f6c183"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2595, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}