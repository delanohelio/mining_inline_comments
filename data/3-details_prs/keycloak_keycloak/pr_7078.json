{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5OTU1NTYy", "number": 7078, "title": "KEYCLOAK-14229 Add GitHub Actions", "bodyText": "GitHub Actions has a number of benefits to Travis, including:\n\nDoesn't kill jobs after 60 min of execution\nDoesn't have the same restriction on log size\nMore parallel jobs (15 vs 5) and less waiting time in queues\nFaster machines (I don't have evidence for this, but it seems like they are significantly faster)\nBetter caching, including ability to \"save\" artifacts from a workflow execution\nHas a whole bunch of nice actions that we can leverage, including ability to use it for more things from anything from adding automatic labels to PRs to doing the actual Keycloak release\n\nI propose we migrate from Travis to GitHub Actions in stages. In this first attempt I'm running the whole base testsuite as one single workflow. It takes a while to execute, but since GitHub Actions has a shorter waiting time in the queue it still completes in less time than Travis.\nWe may want to break the base testsuite into multiple runs, but I don't like how we are doing it in Travis. Rather, it would be good to re-organize the testsuite into groups of tests like:\n\nOIDC\nSAML\nCore\nDatabase\nFederation\n...\n\nThis would probably also make it easier for people to find the test and where to extend to add tests for new things.\nThe idea is to keep this running in parallell with Travis for a while until we are happy with it. We should also consider if we want to split the base testsuite into multiple steps, or perhaps instead use the parallell jobs for other things like admin console tests, etc.", "createdAt": "2020-05-19T08:18:40Z", "url": "https://github.com/keycloak/keycloak/pull/7078", "merged": true, "mergeCommit": {"oid": "0e952a5a9fa212e18c3b8cb3fbbc4ef0d8781868"}, "closed": true, "closedAt": "2020-06-09T06:25:48Z", "author": {"login": "stianst"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcixl4fAFqTQxNDI5NTE0Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoQhvJgBqjM0MTA3OTg1MDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0Mjk1MTQ2", "url": "https://github.com/keycloak/keycloak/pull/7078#pullrequestreview-414295146", "createdAt": "2020-05-19T10:06:13Z", "commit": {"oid": "90504b744fbe3e7144d300516d65e820ad1a3db0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDowNjoxM1rOGXZP5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDowNjoxM1rOGXZP5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE4NDEwMw==", "bodyText": "@stianst I believe we need the pull request event here. Something like:\non: [push, pull_request]", "url": "https://github.com/keycloak/keycloak/pull/7078#discussion_r427184103", "createdAt": "2020-05-19T10:06:13Z", "author": {"login": "abstractj"}, "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,61 @@\n+name: Keycloak CI\n+\n+on: [push]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90504b744fbe3e7144d300516d65e820ad1a3db0"}, "originalPosition": 3}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90504b744fbe3e7144d300516d65e820ad1a3db0", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/90504b744fbe3e7144d300516d65e820ad1a3db0", "committedDate": "2020-05-19T08:17:59Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}, "afterCommit": {"oid": "44dbfd96f4223556a4913e7dcd3c6deaa4bea34c", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/44dbfd96f4223556a4913e7dcd3c6deaa4bea34c", "committedDate": "2020-05-19T13:02:03Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDcxODYz", "url": "https://github.com/keycloak/keycloak/pull/7078#pullrequestreview-414471863", "createdAt": "2020-05-19T13:58:02Z", "commit": {"oid": "44dbfd96f4223556a4913e7dcd3c6deaa4bea34c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0ODE2MTY0", "url": "https://github.com/keycloak/keycloak/pull/7078#pullrequestreview-414816164", "createdAt": "2020-05-19T20:55:30Z", "commit": {"oid": "44dbfd96f4223556a4913e7dcd3c6deaa4bea34c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NTozMFrOGXySgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NTozMFrOGXySgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU5NDM3MQ==", "bodyText": "The GH actions documentation suggests something like:\n- name: Cache Maven packages\n    uses: actions/cache@v1\n    with:\n      path: ~/.m2\n      key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n      restore-keys: ${{ runner.os }}-m2\n\nNot sure what is the benefit of n1hility/cache@v2 but I'd assume that https://github.com/marketplace/actions/cache is the GH supported version.", "url": "https://github.com/keycloak/keycloak/pull/7078#discussion_r427594371", "createdAt": "2020-05-19T20:55:30Z", "author": {"login": "abstractj"}, "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,61 @@\n+name: Keycloak CI\n+\n+on: [push, pull_request]\n+\n+jobs:\n+  build:\n+    name: Build\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v2\n+      - uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.8\n+      - name: Compute cache restore key\n+        # Always recompute on a push so that the maven repo doesnt grow indefinitely with old versions\n+        run: |\n+          if ${{ github.event_name == 'pull_request' }}; then echo \"::set-env name=COMPUTED_RESTORE_KEY::q2maven-\"; fi\n+      - name: Cache Maven Repository\n+        id: cache-maven\n+        uses: n1hility/cache@v2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44dbfd96f4223556a4913e7dcd3c6deaa4bea34c"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MjQxMjk4", "url": "https://github.com/keycloak/keycloak/pull/7078#pullrequestreview-415241298", "createdAt": "2020-05-20T11:32:18Z", "commit": {"oid": "44dbfd96f4223556a4913e7dcd3c6deaa4bea34c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6eebfabc17eb39ed725315ae4b68ca8adb5a8f8d", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/6eebfabc17eb39ed725315ae4b68ca8adb5a8f8d", "committedDate": "2020-05-28T12:23:56Z", "message": "Tweaks"}, "afterCommit": {"oid": "7c2137ae40884821eb2e96cffed1417e3adfcca8", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/7c2137ae40884821eb2e96cffed1417e3adfcca8", "committedDate": "2020-05-28T12:26:08Z", "message": "Tweaks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa98095ff9fb3ce5bcfa449423376eac8c29b198", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/fa98095ff9fb3ce5bcfa449423376eac8c29b198", "committedDate": "2020-05-28T14:05:01Z", "message": "Update ci.yml"}, "afterCommit": {"oid": "b16283fff67c3681881d716bc79af9153e21a95d", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/b16283fff67c3681881d716bc79af9153e21a95d", "committedDate": "2020-05-29T09:39:44Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b16283fff67c3681881d716bc79af9153e21a95d", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/b16283fff67c3681881d716bc79af9153e21a95d", "committedDate": "2020-05-29T09:39:44Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}, "afterCommit": {"oid": "908c4073b59e9e0508d281b96ec16941429346c0", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/908c4073b59e9e0508d281b96ec16941429346c0", "committedDate": "2020-06-02T06:10:17Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NDMzNTYx", "url": "https://github.com/keycloak/keycloak/pull/7078#pullrequestreview-424433561", "createdAt": "2020-06-04T13:21:14Z", "commit": {"oid": "d59233205e5b87a66bc966170997019ce2dfd046"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34ca1f1d290e9c638790f5d57a39131a82a17a36", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/34ca1f1d290e9c638790f5d57a39131a82a17a36", "committedDate": "2020-06-05T10:58:11Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d59233205e5b87a66bc966170997019ce2dfd046", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/d59233205e5b87a66bc966170997019ce2dfd046", "committedDate": "2020-06-04T09:38:53Z", "message": "Update ci.yml"}, "afterCommit": {"oid": "34ca1f1d290e9c638790f5d57a39131a82a17a36", "author": {"user": {"login": "stianst", "name": "Stian Thorgersen"}}, "url": "https://github.com/keycloak/keycloak/commit/34ca1f1d290e9c638790f5d57a39131a82a17a36", "committedDate": "2020-06-05T10:58:11Z", "message": "KEYCLOAK-14229 Add GitHub Actions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3064, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}