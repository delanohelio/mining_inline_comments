{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMTQ0OTk1", "number": 7619, "title": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user\u2026", "bodyText": "\u2026 interfaces default instead of the collection-based versions.\n\nthis ensures that providing implementation for the collection-based methods is enough, which preserves\nbackwards compatibility with older custom implementations.\nalternative interfaces now allow new implementations to focus on the stream variants of the query methods.", "createdAt": "2020-11-17T05:14:00Z", "url": "https://github.com/keycloak/keycloak/pull/7619", "merged": true, "mergeCommit": {"oid": "84df008bc2173df12b6cbfa58047ebc120d1f413"}, "closed": true, "closedAt": "2020-11-18T20:07:52Z", "author": {"login": "sguilhen"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddjfQBgBqjQwMDgyMTQwOTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddzqEigFqTUzMzgyMTA0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6a018aeb148d8a5dd2b0dc911ae5c5560fd33fa7", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/6a018aeb148d8a5dd2b0dc911ae5c5560fd33fa7", "committedDate": "2020-11-17T05:00:39Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}, "afterCommit": {"oid": "9010662b5b72764beebae029a683128f84af43aa", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/9010662b5b72764beebae029a683128f84af43aa", "committedDate": "2020-11-18T01:01:06Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9010662b5b72764beebae029a683128f84af43aa", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/9010662b5b72764beebae029a683128f84af43aa", "committedDate": "2020-11-18T01:01:06Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}, "afterCommit": {"oid": "a80a19ce93fe04630f6c4f2cc6793cb8ab55117c", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/a80a19ce93fe04630f6c4f2cc6793cb8ab55117c", "committedDate": "2020-11-18T01:04:25Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMjgzMDA2", "url": "https://github.com/keycloak/keycloak/pull/7619#pullrequestreview-533283006", "createdAt": "2020-11-18T10:04:01Z", "commit": {"oid": "a80a19ce93fe04630f6c4f2cc6793cb8ab55117c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMDowNDowMVrOH1mD8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMDoxNzo1MFrOH1mn_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTk2MDE3Ng==", "bodyText": "Default implementation from the superinterface gets inherited regardless.\nPerhaps the following could be used instead:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    @Override\n          \n          \n            \n                    Stream<FederatedIdentityModel> getFederatedIdentitiesStream(UserModel user, RealmModel realm);\n          \n          \n            \n                    @Override\n          \n          \n            \n                    default Stream<FederatedIdentityModel> getFederatedIdentitiesStream(UserModel user, RealmModel realm) {\n          \n          \n            \n                        throw new UnsupportedOperationException(\"Not implemented yet.\");\n          \n          \n            \n                    }", "url": "https://github.com/keycloak/keycloak/pull/7619#discussion_r525960176", "createdAt": "2020-11-18T10:04:01Z", "author": {"login": "hmlnarik"}, "path": "server-spi/src/main/java/org/keycloak/models/UserProvider.java", "diffHunk": "@@ -168,4 +172,38 @@\n     void close();\n \n     void preRemove(RealmModel realm, ComponentModel component);\n+\n+    interface Streams extends UserProvider, UserQueryProvider.Streams {\n+        @Override\n+        default Set<FederatedIdentityModel> getFederatedIdentities(UserModel user, RealmModel realm) {\n+            return this.getFederatedIdentitiesStream(user, realm).collect(Collectors.toSet());\n+        }\n+\n+        @Override\n+        Stream<FederatedIdentityModel> getFederatedIdentitiesStream(UserModel user, RealmModel realm);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a80a19ce93fe04630f6c4f2cc6793cb8ab55117c"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTk2OTQwNg==", "bodyText": "Please return this file to the state before #7524.", "url": "https://github.com/keycloak/keycloak/pull/7619#discussion_r525969406", "createdAt": "2020-11-18T10:17:50Z", "author": {"login": "hmlnarik"}, "path": "testsuite/integration-arquillian/servers/auth-server/services/testsuite-providers/src/main/java/org/keycloak/testsuite/federation/UserPropertyFileStorage.java", "diffHunk": "@@ -43,7 +43,8 @@\n  * @author <a href=\"mailto:bill@burkecentral.com\">Bill Burke</a>\n  * @version $Revision: 1 $\n  */\n-public class UserPropertyFileStorage implements UserLookupProvider, UserStorageProvider, UserQueryProvider, CredentialInputValidator {\n+public class UserPropertyFileStorage implements UserLookupProvider, UserStorageProvider, UserQueryProvider.Streams,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a80a19ce93fe04630f6c4f2cc6793cb8ab55117c"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a80a19ce93fe04630f6c4f2cc6793cb8ab55117c", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/a80a19ce93fe04630f6c4f2cc6793cb8ab55117c", "committedDate": "2020-11-18T01:04:25Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}, "afterCommit": {"oid": "0120bf9b2d4b213edc314e9533c07b587b77ccaf", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/0120bf9b2d4b213edc314e9533c07b587b77ccaf", "committedDate": "2020-11-18T11:24:46Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6687364fbf434a8277b937a76ba53129488ebcf5", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/6687364fbf434a8277b937a76ba53129488ebcf5", "committedDate": "2020-11-18T18:12:23Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0120bf9b2d4b213edc314e9533c07b587b77ccaf", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/0120bf9b2d4b213edc314e9533c07b587b77ccaf", "committedDate": "2020-11-18T11:24:46Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}, "afterCommit": {"oid": "6687364fbf434a8277b937a76ba53129488ebcf5", "author": {"user": {"login": "sguilhen", "name": "Stefan Guilhen"}}, "url": "https://github.com/keycloak/keycloak/commit/6687364fbf434a8277b937a76ba53129488ebcf5", "committedDate": "2020-11-18T18:12:23Z", "message": "[KEYCLOAK-16341] Make the new stream-based methods in server-spi user interfaces default instead of the collection-based versions.\n - this ensures that providing implementation for the collection-based methods is enough, which preserves\n   backwards compatibility with older custom implementations.\n - alternative interfaces now allow new implementations to focus on the stream variants of the query methods."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODIxMDQ1", "url": "https://github.com/keycloak/keycloak/pull/7619#pullrequestreview-533821045", "createdAt": "2020-11-18T19:52:09Z", "commit": {"oid": "6687364fbf434a8277b937a76ba53129488ebcf5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3253, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}