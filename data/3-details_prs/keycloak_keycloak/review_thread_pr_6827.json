{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MjczMzcx", "number": 6827, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDowMzoyN1rODjZr8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDowMzo1NVrODjZsvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDQ3NjAwOnYy", "diffSide": "RIGHT", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDowMzoyN1rOFvMEAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODo1NDozN1rOFvdMOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTAyNw==", "bodyText": "Should this be userRep.getUsername()?", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385025027", "createdAt": "2020-02-27T10:03:27Z", "author": {"login": "stianst"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -458,6 +458,18 @@ public void createUserWithoutUsername() {\n         response.close();\n     }\n \n+    @Test\n+    public void createUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwNTY1Nw==", "bodyText": "Yes, fixed, thanks", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385305657", "createdAt": "2020-02-27T18:54:37Z", "author": {"login": "douglaspalmer"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -458,6 +458,18 @@ public void createUserWithoutUsername() {\n         response.close();\n     }\n \n+    @Test\n+    public void createUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTAyNw=="}, "originalCommit": {"oid": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDQ3NzgzOnYy", "diffSide": "RIGHT", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDowMzo1MVrOFvMFBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODo1NTowM1rOFvdNGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTI4Ng==", "bodyText": "Should this be userRep.getUsername()?", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385025286", "createdAt": "2020-02-27T10:03:51Z", "author": {"login": "stianst"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1458,6 +1470,25 @@ public void updateUserWithoutUsername() {\n         switchEditUsernameAllowedOn(false);\n     }\n \n+    @Test\n+    public void updateUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwNTg4Mg==", "bodyText": "Yes, fixed, thanks.", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385305882", "createdAt": "2020-02-27T18:55:03Z", "author": {"login": "douglaspalmer"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1458,6 +1470,25 @@ public void updateUserWithoutUsername() {\n         switchEditUsernameAllowedOn(false);\n     }\n \n+    @Test\n+    public void updateUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTI4Ng=="}, "originalCommit": {"oid": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDQ3ODA1OnYy", "diffSide": "RIGHT", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDowMzo1NVrOFvMFKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODo1NTowOVrOFvdNVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTMyMA==", "bodyText": "Should this be userRep.getUsername()?", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385025320", "createdAt": "2020-02-27T10:03:55Z", "author": {"login": "stianst"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1458,6 +1470,25 @@ public void updateUserWithoutUsername() {\n         switchEditUsernameAllowedOn(false);\n     }\n \n+    @Test\n+    public void updateUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());\n+\n+        userRep.setEmail(\"user11@localhost\");\n+        updateUser(user, userRep);\n+\n+        userRep = realm.users().get(id).toRepresentation();\n+        assertEquals(\"user11@localhost\", userRep.getEmail());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwNTk0MQ==", "bodyText": "Yes, fixed, thanks.", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385305941", "createdAt": "2020-02-27T18:55:09Z", "author": {"login": "douglaspalmer"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1458,6 +1470,25 @@ public void updateUserWithoutUsername() {\n         switchEditUsernameAllowedOn(false);\n     }\n \n+    @Test\n+    public void updateUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());\n+\n+        userRep.setEmail(\"user11@localhost\");\n+        updateUser(user, userRep);\n+\n+        userRep = realm.users().get(id).toRepresentation();\n+        assertEquals(\"user11@localhost\", userRep.getEmail());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTMyMA=="}, "originalCommit": {"oid": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3783, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}