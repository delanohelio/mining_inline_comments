{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MjEzMDIz", "number": 7074, "title": "KEYCLOAK-14178 Avoid erroneous HTML escaping in KeycloakServer", "bodyText": "This PR disables the Resteasy HTML Sanitizer in KeycloakServer.\nPreviously KeycloakTest server erroneously escapes html in error pages.\nSee the linked JIRA issue for details.", "createdAt": "2020-05-14T19:51:44Z", "url": "https://github.com/keycloak/keycloak/pull/7074", "merged": true, "mergeCommit": {"oid": "87dd1434520f6b6cebf17d32d769eafe2137c243"}, "closed": true, "closedAt": "2020-05-18T12:59:24Z", "author": {"login": "thomasdarimont"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchkJ53gH2gAyNDE4MjEzMDIzOjEwM2ZhZDMyZTRhODE0M2QzM2ExM2QyNTYxZmQ5ODYxM2E0NWJlNTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcifd3RgFqTQxMzU2ODcxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "103fad32e4a8143d33a13d2561fd98613a45be55", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/103fad32e4a8143d33a13d2561fd98613a45be55", "committedDate": "2020-05-15T15:52:59Z", "message": "KEYCLOAK-14178 Avoid erroneous HTML escaping in KeycloakServer\n\nThis PR disables the Resteasy HTML Sanitizer in KeycloakServer.\nPreviously KeycloakTest server erroneously escapes html in error pages.\n\nSee the linked JIRA issue for details."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "390b575480f716a05f9c358a52cec08ab198550d", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/390b575480f716a05f9c358a52cec08ab198550d", "committedDate": "2020-05-14T19:48:55Z", "message": "KEYCLOAK-14178 Avoid erroneous HTML escaping in KeycloakServer\n\nThis PR disables the Resteasy HTML Sanitizer in KeycloakServer.\nPreviously KeycloakTest server erroneously escapes html in error pages.\n\nSee the linked JIRA issue for details."}, "afterCommit": {"oid": "992f3ac5b51bd6769fcc21c59975a672f11e5f90", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/992f3ac5b51bd6769fcc21c59975a672f11e5f90", "committedDate": "2020-05-15T16:35:04Z", "message": "KEYCLOAK-14178 Disable HTML errournous escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "992f3ac5b51bd6769fcc21c59975a672f11e5f90", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/992f3ac5b51bd6769fcc21c59975a672f11e5f90", "committedDate": "2020-05-15T16:35:04Z", "message": "KEYCLOAK-14178 Disable HTML errournous escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}, "afterCommit": {"oid": "cacb5f580f7a481207d37586c3bfcd950819f8b3", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/cacb5f580f7a481207d37586c3bfcd950819f8b3", "committedDate": "2020-05-15T16:36:24Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cacb5f580f7a481207d37586c3bfcd950819f8b3", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/cacb5f580f7a481207d37586c3bfcd950819f8b3", "committedDate": "2020-05-15T16:36:24Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}, "afterCommit": {"oid": "cb5b29652b894136e0dbba93d7f0bbde8978ef03", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/cb5b29652b894136e0dbba93d7f0bbde8978ef03", "committedDate": "2020-05-15T16:37:25Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb5b29652b894136e0dbba93d7f0bbde8978ef03", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/cb5b29652b894136e0dbba93d7f0bbde8978ef03", "committedDate": "2020-05-15T16:37:25Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}, "afterCommit": {"oid": "435a9067c4fc7baaa561c6b21dc3da5b63998c16", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/435a9067c4fc7baaa561c6b21dc3da5b63998c16", "committedDate": "2020-05-15T16:41:48Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b089a3ca41702c82d60c30228dbba247a2e2e2c3", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/b089a3ca41702c82d60c30228dbba247a2e2e2c3", "committedDate": "2020-05-15T16:43:23Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "435a9067c4fc7baaa561c6b21dc3da5b63998c16", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/435a9067c4fc7baaa561c6b21dc3da5b63998c16", "committedDate": "2020-05-15T16:41:48Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}, "afterCommit": {"oid": "b089a3ca41702c82d60c30228dbba247a2e2e2c3", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/b089a3ca41702c82d60c30228dbba247a2e2e2c3", "committedDate": "2020-05-15T16:43:23Z", "message": "KEYCLOAK-14178 Disable erroneous HTML escaping in ResteasyServlet configuration in KeycloakServer\n\n- Removed duplicate servlet configuration: the HttpServlet30Dispatcher servlet is already configured by server.undertowDeployment(deployment, \"\");\n- Disabled the  HTML escaping in the ResteasyDeployment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMzA4MTc2", "url": "https://github.com/keycloak/keycloak/pull/7074#pullrequestreview-413308176", "createdAt": "2020-05-18T06:42:58Z", "commit": {"oid": "b089a3ca41702c82d60c30228dbba247a2e2e2c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMzMzOTcz", "url": "https://github.com/keycloak/keycloak/pull/7074#pullrequestreview-413333973", "createdAt": "2020-05-18T07:29:00Z", "commit": {"oid": "b089a3ca41702c82d60c30228dbba247a2e2e2c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwNzoyOTowMFrOGWqmDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwNzoyOTowMFrOGWqmDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjQxOTcyNg==", "bodyText": "@thomasdarimont Are asyncSupported and resteasy.servlet.mapping.prefix parameter maintained? Perhaps they need to be added similarly as a property of the deployment?", "url": "https://github.com/keycloak/keycloak/pull/7074#discussion_r426419726", "createdAt": "2020-05-18T07:29:00Z", "author": {"login": "hmlnarik"}, "path": "testsuite/utils/src/main/java/org/keycloak/testsuite/KeycloakServer.java", "diffHunk": "@@ -400,15 +401,11 @@ public void start() throws Throwable {\n \n             di.setDefaultServletConfig(new DefaultServletConfig(true));\n \n-            ServletInfo restEasyDispatcher = Servlets.servlet(\"Keycloak REST Interface\", HttpServlet30Dispatcher.class);\n-\n-            restEasyDispatcher.addInitParam(\"resteasy.servlet.mapping.prefix\", \"/\");\n-            restEasyDispatcher.setAsyncSupported(true);\n-\n-            di.addServlet(restEasyDispatcher);\n+            // Note that the ResteasyServlet is configured via server.undertowDeployment(...);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b089a3ca41702c82d60c30228dbba247a2e2e2c3"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNTY4NzE2", "url": "https://github.com/keycloak/keycloak/pull/7074#pullrequestreview-413568716", "createdAt": "2020-05-18T12:59:11Z", "commit": {"oid": "b089a3ca41702c82d60c30228dbba247a2e2e2c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3051, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}