{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MDQ2MzIw", "number": 7371, "title": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse", "bodyText": "This adds the ability to add custom claims to the OIDC access token response when successful using a similar API to how ProtocolMappers add claims to tokens currently.", "createdAt": "2020-08-26T17:18:59Z", "url": "https://github.com/keycloak/keycloak/pull/7371", "merged": true, "mergeCommit": {"oid": "be4c99dfe57c7237d04f8436f723fc0ecb0e40c6"}, "closed": true, "closedAt": "2020-12-03T16:28:05Z", "author": {"login": "ibacher"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFKVFMAFqTQ4MTUxNzc1NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdazMZfAFqTUyNjE2NzYwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNTE3NzU0", "url": "https://github.com/keycloak/keycloak/pull/7371#pullrequestreview-481517754", "createdAt": "2020-09-03T06:08:56Z", "commit": {"oid": "5e3ca27a239ba5f1999ccc2c79e0164fac0abcfc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNjowODo1NlrOHMXN2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNjowODo1NlrOHMXN2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcyNTMzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            includeInAccessTokenResponse.tooltip=Should the claim be added to the access token response?\n          \n          \n            \n            includeInAccessTokenResponse.tooltip=Should the claim be added to the access token response? Should only be used for informative and non-sensitive data", "url": "https://github.com/keycloak/keycloak/pull/7371#discussion_r482725336", "createdAt": "2020-09-03T06:08:56Z", "author": {"login": "stianst"}, "path": "themes/src/main/resources/theme/base/admin/messages/admin-messages_en.properties", "diffHunk": "@@ -242,6 +242,8 @@ includeInAccessToken.label=Add to access token\n includeInAccessToken.tooltip=Should the claim be added to the access token?\n includeInUserInfo.label=Add to userinfo\n includeInUserInfo.tooltip=Should the claim be added to the userinfo?\n+includeInAccessTokenResponse.label=Add to access token response\n+includeInAccessTokenResponse.tooltip=Should the claim be added to the access token response?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e3ca27a239ba5f1999ccc2c79e0164fac0abcfc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MTA0ODY1", "url": "https://github.com/keycloak/keycloak/pull/7371#pullrequestreview-484104865", "createdAt": "2020-09-08T12:57:46Z", "commit": {"oid": "5e3ca27a239ba5f1999ccc2c79e0164fac0abcfc"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MjQzNzcy", "url": "https://github.com/keycloak/keycloak/pull/7371#pullrequestreview-485243772", "createdAt": "2020-09-09T17:25:52Z", "commit": {"oid": "5e3ca27a239ba5f1999ccc2c79e0164fac0abcfc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNzoyNTo1MlrOHPScuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNzoyNTo1MlrOHPScuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5Mjk1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public AccessTokenResponse transformAccessTokenResponse(KeycloakSession session, AccessTokenResponse token,\n          \n          \n            \n                public AccessTokenResponse transformAccessTokenResponse(KeycloakSession session, AccessTokenResponse tokenResponse,\n          \n      \n    \n    \n  \n\nI think parameters and local variables referencing AccessTokenResponse should be named response or tokenResponse instead of just token which is somewhat misleading.", "url": "https://github.com/keycloak/keycloak/pull/7371#discussion_r485792952", "createdAt": "2020-09-09T17:25:52Z", "author": {"login": "thomasdarimont"}, "path": "services/src/main/java/org/keycloak/protocol/oidc/TokenManager.java", "diffHunk": "@@ -611,6 +612,20 @@ public AccessToken transformAccessToken(KeycloakSession session, AccessToken tok\n         return token;\n     }\n \n+    public AccessTokenResponse transformAccessTokenResponse(KeycloakSession session, AccessTokenResponse token,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e3ca27a239ba5f1999ccc2c79e0164fac0abcfc"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MDM0MTk5", "url": "https://github.com/keycloak/keycloak/pull/7371#pullrequestreview-486034199", "createdAt": "2020-09-10T15:05:47Z", "commit": {"oid": "5e3ca27a239ba5f1999ccc2c79e0164fac0abcfc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "048fc643053dde37ab492084585e53e3c70e3b5b", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/048fc643053dde37ab492084585e53e3c70e3b5b", "committedDate": "2020-10-19T12:59:17Z", "message": "KEYCLOAK-15287 accessToken -> accessTokenResponse\n\nPer review"}, "afterCommit": {"oid": "1acd4e6a884349d6e376bbcb47b9cd205955b33e", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/1acd4e6a884349d6e376bbcb47b9cd205955b33e", "committedDate": "2020-10-20T03:57:13Z", "message": "KEYCLOAK-15287 accessToken -> accessTokenResponse\n\nPer review"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1acd4e6a884349d6e376bbcb47b9cd205955b33e", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/1acd4e6a884349d6e376bbcb47b9cd205955b33e", "committedDate": "2020-10-20T03:57:13Z", "message": "KEYCLOAK-15287 accessToken -> accessTokenResponse\n\nPer review"}, "afterCommit": {"oid": "645dfe6af5be2380245c3eca6e836dad1fda15cb", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/645dfe6af5be2380245c3eca6e836dad1fda15cb", "committedDate": "2020-10-20T14:50:42Z", "message": "KEYCLOAK-15287 accessToken -> accessTokenResponse\n\nPer review"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "361be0fd38fee41bbe955ae21b14af8cd71e01b4", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/361be0fd38fee41bbe955ae21b14af8cd71e01b4", "committedDate": "2020-10-20T15:40:04Z", "message": "KEYCLOAK-15287 Fix script based mapper test"}, "afterCommit": {"oid": "4a9bb224746fffc221af23d7dc08bb66ea7f977a", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/4a9bb224746fffc221af23d7dc08bb66ea7f977a", "committedDate": "2020-10-26T14:11:53Z", "message": "KEYCLOAK-15287 Adds tests for AccessTokenResponse custom claim"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a9bb224746fffc221af23d7dc08bb66ea7f977a", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/4a9bb224746fffc221af23d7dc08bb66ea7f977a", "committedDate": "2020-10-26T14:11:53Z", "message": "KEYCLOAK-15287 Adds tests for AccessTokenResponse custom claim"}, "afterCommit": {"oid": "fdd580fb7bf111590591cf817e36ca5e29bc7bce", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/fdd580fb7bf111590591cf817e36ca5e29bc7bce", "committedDate": "2020-10-26T14:13:14Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fdd580fb7bf111590591cf817e36ca5e29bc7bce", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/fdd580fb7bf111590591cf817e36ca5e29bc7bce", "committedDate": "2020-10-26T14:13:14Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}, "afterCommit": {"oid": "31b25a35357b216818624f38480939b7260602a9", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/31b25a35357b216818624f38480939b7260602a9", "committedDate": "2020-11-04T20:42:09Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31b25a35357b216818624f38480939b7260602a9", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/31b25a35357b216818624f38480939b7260602a9", "committedDate": "2020-11-04T20:42:09Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}, "afterCommit": {"oid": "e77e95d2dbbf3c381810de9e6a6b4430121eed04", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/e77e95d2dbbf3c381810de9e6a6b4430121eed04", "committedDate": "2020-11-04T20:45:29Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8285caa59f88ede9b134b6619e92ec381dd9680e", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/8285caa59f88ede9b134b6619e92ec381dd9680e", "committedDate": "2020-11-04T20:45:56Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e77e95d2dbbf3c381810de9e6a6b4430121eed04", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/e77e95d2dbbf3c381810de9e6a6b4430121eed04", "committedDate": "2020-11-04T20:45:29Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}, "afterCommit": {"oid": "8285caa59f88ede9b134b6619e92ec381dd9680e", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/keycloak/keycloak/commit/8285caa59f88ede9b134b6619e92ec381dd9680e", "committedDate": "2020-11-04T20:45:56Z", "message": "KEYCLOAK-15287 Ability to add custom claims to the AccessTokenResponse"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MTY3NjAx", "url": "https://github.com/keycloak/keycloak/pull/7371#pullrequestreview-526167601", "createdAt": "2020-11-09T11:37:58Z", "commit": {"oid": "8285caa59f88ede9b134b6619e92ec381dd9680e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2771, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}