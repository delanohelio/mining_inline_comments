{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxMTA2OTQw", "number": 6728, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNjo0ODo1OVrODdOfBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToyMzozNFrODdQvYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxOTcyNjE0OnYy", "diffSide": "RIGHT", "path": "saml-core/src/main/java/org/keycloak/saml/processing/core/saml/v2/constants/X500SAMLProfileConstants.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNjo0ODo1OVrOFltReQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNjo0ODo1OVrOFltReQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA4MzM4NQ==", "bodyText": "ensure that attribute is not null to prevent NPE", "url": "https://github.com/keycloak/keycloak/pull/6728#discussion_r375083385", "createdAt": "2020-02-05T06:48:59Z", "author": {"login": "hmlnarik"}, "path": "saml-core/src/main/java/org/keycloak/saml/processing/core/saml/v2/constants/X500SAMLProfileConstants.java", "diffHunk": "@@ -147,6 +150,10 @@ public String getFriendlyName() {\n         return friendlyName;\n     }\n \n+    public boolean correspondsTo(AttributeType attribute) {\n+        return Objects.equals(this.uri, attribute.getName()) || Objects.equals(this.friendlyName, attribute.getFriendlyName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b69b5c3492cca97531301d421776330dd91426ef"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDA1ODcwOnYy", "diffSide": "RIGHT", "path": "themes/src/main/resources/theme/base/admin/messages/admin-messages_en.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToxMTo1MlrOFlwZuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToxMTo1MlrOFlwZuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTEzNDY0OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            saml.principal-type=Principal\n          \n          \n            \n            saml.principal-type=Principal Type", "url": "https://github.com/keycloak/keycloak/pull/6728#discussion_r375134648", "createdAt": "2020-02-05T09:11:52Z", "author": {"login": "hmlnarik"}, "path": "themes/src/main/resources/theme/base/admin/messages/admin-messages_en.properties", "diffHunk": "@@ -643,6 +643,10 @@ single-logout-service-url=Single Logout Service URL\n saml.single-logout-service-url.tooltip=The Url that must be used to send logout requests.\n nameid-policy-format=NameID Policy Format\n nameid-policy-format.tooltip=Specifies the URI reference corresponding to a name identifier format. Defaults to urn:oasis:names:tc:SAML:2.0:nameid-format:persistent.\n+saml.principal-type=Principal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b69b5c3492cca97531301d421776330dd91426ef"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDA3NTE5OnYy", "diffSide": "RIGHT", "path": "themes/src/main/resources/theme/base/admin/messages/admin-messages_en.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToxNzoyNVrOFlwkDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToxNzoyNVrOFlwkDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTEzNzI5Mw==", "bodyText": "No opinions please, just pure description.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            saml.principal-type.tooltip=Specifies how Keycloak should identify and track external users. Default is using Subject NameID, though it is recommended to set up identifying attribute which is more reliable.\n          \n          \n            \n            saml.principal-type.tooltip=Way to identify and track external users from the assertion. Default is using Subject NameID, alternatively you can set up identifying attribute.", "url": "https://github.com/keycloak/keycloak/pull/6728#discussion_r375137293", "createdAt": "2020-02-05T09:17:25Z", "author": {"login": "hmlnarik"}, "path": "themes/src/main/resources/theme/base/admin/messages/admin-messages_en.properties", "diffHunk": "@@ -643,6 +643,10 @@ single-logout-service-url=Single Logout Service URL\n saml.single-logout-service-url.tooltip=The Url that must be used to send logout requests.\n nameid-policy-format=NameID Policy Format\n nameid-policy-format.tooltip=Specifies the URI reference corresponding to a name identifier format. Defaults to urn:oasis:names:tc:SAML:2.0:nameid-format:persistent.\n+saml.principal-type=Principal\n+saml.principal-type.tooltip=Specifies how Keycloak should identify and track external users. Default is using Subject NameID, though it is recommended to set up identifying attribute which is more reliable.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b69b5c3492cca97531301d421776330dd91426ef"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDA3ODY5OnYy", "diffSide": "RIGHT", "path": "themes/src/main/resources-community/theme/base/admin/messages/admin-messages_ru.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToxODozMVrOFlwmQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToxODozMVrOFlwmQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTEzNzg1OQ==", "bodyText": "Please address the comments from en version in this translation as well", "url": "https://github.com/keycloak/keycloak/pull/6728#discussion_r375137859", "createdAt": "2020-02-05T09:18:31Z", "author": {"login": "hmlnarik"}, "path": "themes/src/main/resources-community/theme/base/admin/messages/admin-messages_ru.properties", "diffHunk": "@@ -527,6 +527,10 @@ single-logout-service-url=\u0410\u0434\u0440\u0435\u0441\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0435\u0434\u0438\u043d\u043e\u0433\u043e \u0432\u044b\u0445\u043e\u0434\n saml.single-logout-service-url.tooltip=Url, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043d\u0430 \u0432\u044b\u0445\u043e\u0434.\n nameid-policy-format=\u0424\u043e\u0440\u043c\u0430\u0442 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 NameID\n nameid-policy-format.tooltip=\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0441\u0441\u044b\u043b\u043a\u0443 URI, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0443\u044e \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430 \u0438\u043c\u0435\u043d\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e urn:oasis:names:tc:SAML:2.0:nameid-format:persistent.\n+saml.principal-type=\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b69b5c3492cca97531301d421776330dd91426ef"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDA5NTcwOnYy", "diffSide": "RIGHT", "path": "services/src/main/java/org/keycloak/broker/saml/SAMLEndpoint.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToyMzozNFrOFlwwZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwOToyMzozNFrOFlwwZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTE0MDQ1NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                logger.error(\"no principal in assertion; expected: \" + expectedPrincipalType());\n          \n          \n            \n                                logger.errorf(\"no principal in assertion; expected: %s\", expectedPrincipalType());", "url": "https://github.com/keycloak/keycloak/pull/6728#discussion_r375140455", "createdAt": "2020-02-05T09:23:34Z", "author": {"login": "hmlnarik"}, "path": "services/src/main/java/org/keycloak/broker/saml/SAMLEndpoint.java", "diffHunk": "@@ -414,15 +416,24 @@ protected Response handleLoginResponse(String samlResponse, SAMLDocumentHolder h\n                 SubjectType subject = assertion.getSubject();\n                 SubjectType.STSubType subType = subject.getSubType();\n                 NameIDType subjectNameID = (NameIDType) subType.getBaseID();\n+                String principal = getPrincipal(assertion);\n+\n+                if (principal == null) {\n+                    logger.error(\"no principal in assertion; expected: \" + expectedPrincipalType());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b69b5c3492cca97531301d421776330dd91426ef"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3867, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}