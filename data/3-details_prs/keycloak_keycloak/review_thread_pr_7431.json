{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5NDAyMjYx", "number": 7431, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxODo1MzowMVrOEq4PLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzoyNTozOVrOEsgUGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMzk3MDM2OnYy", "diffSide": "RIGHT", "path": "server-spi/src/main/java/org/keycloak/models/UserProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxODo1MzowMVrOHdVmXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMTo0MToxOFrOHf7JMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUyNDYzNg==", "bodyText": "With Realms, Roles, etc, we are doing the other way around - adding the stream variant and making the old list-based methods. Are we changing this?", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r500524636", "createdAt": "2020-10-06T18:53:01Z", "author": {"login": "sguilhen"}, "path": "server-spi/src/main/java/org/keycloak/models/UserProvider.java", "diffHunk": "@@ -57,6 +58,9 @@\n \n     UserModel getServiceAccount(ClientModel client);\n     List<UserModel> getUsers(RealmModel realm, boolean includeServiceAccounts);\n+    default Stream<UserModel> getUsersStream(RealmModel realm, boolean includeServiceAccounts) {\n+        return getUsers(realm, includeServiceAccounts).stream();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzNjkxMw==", "bodyText": "@sguilhen Sorry for confusion, I will remove this.\nTo explain why I did that. I wanted to make work of the streamification easier because this way all code in UserStorageManager is already using the correct method (getUsersStream()). Providing the getUsersStream method is, I would say, out of the scope of this issue. We should have all the streamification work under one issue, therefore I provided a default method for the Stream variant, expecting switching those will be part of the streamification work.", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r503236913", "createdAt": "2020-10-12T11:41:18Z", "author": {"login": "mhajas"}, "path": "server-spi/src/main/java/org/keycloak/models/UserProvider.java", "diffHunk": "@@ -57,6 +58,9 @@\n \n     UserModel getServiceAccount(ClientModel client);\n     List<UserModel> getUsers(RealmModel realm, boolean includeServiceAccounts);\n+    default Stream<UserModel> getUsersStream(RealmModel realm, boolean includeServiceAccounts) {\n+        return getUsers(realm, includeServiceAccounts).stream();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUyNDYzNg=="}, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMzk3MjUwOnYy", "diffSide": "RIGHT", "path": "server-spi/src/main/java/org/keycloak/storage/federated/UserAttributeFederatedStorage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxODo1MzozOVrOHdVnuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMTo0MToyN1rOHf7JfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUyNDk4NQ==", "bodyText": "Same... I think we should settle to a single way of doing things, this is getting confusing.", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r500524985", "createdAt": "2020-10-06T18:53:39Z", "author": {"login": "sguilhen"}, "path": "server-spi/src/main/java/org/keycloak/storage/federated/UserAttributeFederatedStorage.java", "diffHunk": "@@ -31,4 +32,7 @@\n     void removeAttribute(RealmModel realm, String userId, String name);\n     MultivaluedHashMap<String, String> getAttributes(RealmModel realm, String userId);\n     List<String> getUsersByUserAttribute(RealmModel realm, String name, String value);\n+    default Stream<String> getUsersByUserAttributeStream(RealmModel realm, String name, String value) {\n+        return getUsersByUserAttribute(realm, name, value).stream();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzNjk4OQ==", "bodyText": "I will remove this.", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r503236989", "createdAt": "2020-10-12T11:41:27Z", "author": {"login": "mhajas"}, "path": "server-spi/src/main/java/org/keycloak/storage/federated/UserAttributeFederatedStorage.java", "diffHunk": "@@ -31,4 +32,7 @@\n     void removeAttribute(RealmModel realm, String userId, String name);\n     MultivaluedHashMap<String, String> getAttributes(RealmModel realm, String userId);\n     List<String> getUsersByUserAttribute(RealmModel realm, String name, String value);\n+    default Stream<String> getUsersByUserAttributeStream(RealmModel realm, String name, String value) {\n+        return getUsersByUserAttribute(realm, name, value).stream();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUyNDk4NQ=="}, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDk4MDkxOnYy", "diffSide": "RIGHT", "path": "server-spi/src/main/java/org/keycloak/storage/user/UserQueryProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzoxMjozNFrOHfxufg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMTo0MzoyNlrOHf7NZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA4MjYyMg==", "bodyText": "Are we going to add javadoc for the default methods?", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r503082622", "createdAt": "2020-10-12T07:12:34Z", "author": {"login": "vramik"}, "path": "server-spi/src/main/java/org/keycloak/storage/user/UserQueryProvider.java", "diffHunk": "@@ -144,6 +145,10 @@ default int getUsersCount(RealmModel realm, boolean includeServiceAccount) {\n     }\n \n     List<UserModel> getUsers(RealmModel realm);\n+    default Stream<UserModel> getUsersStream(RealmModel realm) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzNzk5MQ==", "bodyText": "I will be adding all Javadocs in https://issues.redhat.com/browse/KEYCLOAK-15524. I will start working on that after the streamification is done. Anyway, I am about to remove these methods from interfaces, so that we avoid confusion.", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r503237991", "createdAt": "2020-10-12T11:43:26Z", "author": {"login": "mhajas"}, "path": "server-spi/src/main/java/org/keycloak/storage/user/UserQueryProvider.java", "diffHunk": "@@ -144,6 +145,10 @@ default int getUsersCount(RealmModel realm, boolean includeServiceAccount) {\n     }\n \n     List<UserModel> getUsers(RealmModel realm);\n+    default Stream<UserModel> getUsersStream(RealmModel realm) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA4MjYyMg=="}, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MTAyMjM0OnYy", "diffSide": "RIGHT", "path": "server-spi/src/main/java/org/keycloak/storage/federated/UserGroupMembershipFederatedStorage.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzoyNTozOVrOHfyHQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzoyNTozOVrOHfyHQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA4ODk2Mw==", "bodyText": "The same: should we add a java-doc here?", "url": "https://github.com/keycloak/keycloak/pull/7431#discussion_r503088963", "createdAt": "2020-10-12T07:25:39Z", "author": {"login": "vramik"}, "path": "server-spi/src/main/java/org/keycloak/storage/federated/UserGroupMembershipFederatedStorage.java", "diffHunk": "@@ -39,5 +39,8 @@\n     void joinGroup(RealmModel realm, String userId, GroupModel group);\n     void leaveGroup(RealmModel realm, String userId, GroupModel group);\n     List<String> getMembership(RealmModel realm, GroupModel group, int firstResult, int max);\n+    default Stream<String> getMembershipStream(RealmModel realm, GroupModel group, int firstResult, int max) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb5e9e26e5a1941a8aab4bd17ef454f2f062a1fc"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3452, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}