{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMzk2NTU4", "number": 6646, "title": "KEYCLOAK-12630 full representation param for get groups by user endpoint", "bodyText": "https://issues.redhat.com/browse/KEYCLOAK-12630\nAs already done by me in some other endpoints, I need the full representation including attributes of the object Groyp by adding an optional param to the endpoint. Here for users/{userId}/groups", "createdAt": "2020-01-08T10:52:27Z", "url": "https://github.com/keycloak/keycloak/pull/6646", "merged": true, "mergeCommit": {"oid": "789e8c70ceec8606894575beca457fee9e0428c2"}, "closed": true, "closedAt": "2020-01-15T09:14:53Z", "author": {"login": "Cracky5457"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4Ux1GgBqjI5MzEwMjg1OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6hsGDAFqTM0MzA2NDkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "349fbe3a686ef3af617e32ef00ce8354cd9ee25c", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/349fbe3a686ef3af617e32ef00ce8354cd9ee25c", "committedDate": "2020-01-08T10:50:54Z", "message": "KEYCLOAK-12630 full repreentation param for get groups by user endpoint"}, "afterCommit": {"oid": "a7e8de65157594395876d36bb58e5732bf4ff090", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/a7e8de65157594395876d36bb58e5732bf4ff090", "committedDate": "2020-01-08T12:46:51Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNzkwNjg0", "url": "https://github.com/keycloak/keycloak/pull/6646#pullrequestreview-341790684", "createdAt": "2020-01-13T11:49:41Z", "commit": {"oid": "a7e8de65157594395876d36bb58e5732bf4ff090"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNzkxNjAx", "url": "https://github.com/keycloak/keycloak/pull/6646#pullrequestreview-341791601", "createdAt": "2020-01-13T11:51:25Z", "commit": {"oid": "a7e8de65157594395876d36bb58e5732bf4ff090"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMTo1MToyNlrOFc0e-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMTo1MToyNlrOFc0e-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc2NDM0NQ==", "bodyText": "Please use parameter name briefRepresentation to keep consistent with the rest of API", "url": "https://github.com/keycloak/keycloak/pull/6646#discussion_r365764345", "createdAt": "2020-01-13T11:51:26Z", "author": {"login": "hmlnarik"}, "path": "integration/admin-client/src/main/java/org/keycloak/admin/client/resource/UserResource.java", "diffHunk": "@@ -67,6 +68,19 @@\n     List<GroupRepresentation> groups(@QueryParam(\"search\") String search,\n                                      @QueryParam(\"first\") Integer firstResult,\n                                      @QueryParam(\"max\") Integer maxResults);\n+    \n+    @Path(\"groups\")\n+    @GET\n+    List<GroupRepresentation> groups(@QueryParam(\"first\") Integer firstResult,\n+                                     @QueryParam(\"max\") Integer maxResults,\n+                                     @QueryParam(\"full\") @DefaultValue(\"false\") boolean fullRepresentation);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7e8de65157594395876d36bb58e5732bf4ff090"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a7e8de65157594395876d36bb58e5732bf4ff090", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/a7e8de65157594395876d36bb58e5732bf4ff090", "committedDate": "2020-01-08T12:46:51Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}, "afterCommit": {"oid": "de93fd0d6f00180403b0d3bb4d956fdfdc241014", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/de93fd0d6f00180403b0d3bb4d956fdfdc241014", "committedDate": "2020-01-14T13:09:23Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de93fd0d6f00180403b0d3bb4d956fdfdc241014", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/de93fd0d6f00180403b0d3bb4d956fdfdc241014", "committedDate": "2020-01-14T13:09:23Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}, "afterCommit": {"oid": "c38cfca4064e13d320d9b7fbbb753342863a9e2d", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/c38cfca4064e13d320d9b7fbbb753342863a9e2d", "committedDate": "2020-01-14T13:11:26Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3a7d77e8b14c4ef247ba0aaec51692e85d65791", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/b3a7d77e8b14c4ef247ba0aaec51692e85d65791", "committedDate": "2020-01-14T13:25:59Z", "message": "KEYCLOAK-12670 inconsistent param name full to briefRepresentation"}, "afterCommit": {"oid": "c38cfca4064e13d320d9b7fbbb753342863a9e2d", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/c38cfca4064e13d320d9b7fbbb753342863a9e2d", "committedDate": "2020-01-14T13:11:26Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyNTQzODg3", "url": "https://github.com/keycloak/keycloak/pull/6646#pullrequestreview-342543887", "createdAt": "2020-01-14T13:50:56Z", "commit": {"oid": "c38cfca4064e13d320d9b7fbbb753342863a9e2d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxMzo1MDo1NlrOFdYF3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxMzo1MDo1NlrOFdYF3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjM0Nzc0MA==", "bodyText": "It seems this user is never removed. You can use Creator.create(RealmResource, UserRepresentation) that handles cleanup automatically, see e.g. https://github.com/keycloak/keycloak/blob/master/testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/adapter/servlet/SAMLServletAdapterTest.java#L924. Feel free to use Creator.create(RealmResource, GroupRepresentation) for group similarly.", "url": "https://github.com/keycloak/keycloak/pull/6646#discussion_r366347740", "createdAt": "2020-01-14T13:50:56Z", "author": {"login": "hmlnarik"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1668,4 +1675,35 @@ public void testDeleteCredentials() {\n         user.resetPassword(credPasswd);\n         Assert.assertEquals(1, user.credentials().size());\n     }\n+    \n+    @Test\n+    public void testGetGroupsForUserFullRepresentation() {\n+       \n+        RealmResource realm = adminClient.realms().realm(\"test\");\n+        GroupsResource groups = realm.groups();\n+        \n+        String userName = \"brief-grouptest-user\";\n+        String groupName = \"groupWithAttribute\";\n+        Map<String, List<String>> attributes = new HashMap<String, List<String>>();\n+        attributes.put(\"attribute1\", Arrays.asList(\"attribute1\",\"attribute2\"));\n+        \n+        try (Response response = groups.add(GroupBuilder.create().name(groupName).attributes(attributes).build())) {\n+            String groupId = ApiUtil.getCreatedId(response);\n+            \n+            UsersResource users = realm.users();\n+\n+            UserRepresentation userRepresentation = UserBuilder.create()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c38cfca4064e13d320d9b7fbbb753342863a9e2d"}, "originalPosition": 63}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c38cfca4064e13d320d9b7fbbb753342863a9e2d", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/c38cfca4064e13d320d9b7fbbb753342863a9e2d", "committedDate": "2020-01-14T13:11:26Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}, "afterCommit": {"oid": "3c8500f16b029a4f459a76bf7b62333ef4ed2347", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/3c8500f16b029a4f459a76bf7b62333ef4ed2347", "committedDate": "2020-01-15T07:44:40Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzMDM1OTYw", "url": "https://github.com/keycloak/keycloak/pull/6646#pullrequestreview-343035960", "createdAt": "2020-01-15T07:55:00Z", "commit": {"oid": "3c8500f16b029a4f459a76bf7b62333ef4ed2347"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwNzo1ODo0NVrOFdvuvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwNzo1ODo0NVrOFdvuvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjczNTAzNg==", "bodyText": "Nit: The level of try nesting and call to get representation (lines 1690 - 1698) could be simplified to:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    try (Creator<GroupResource> g = Creator.create(realm, GroupBuilder.create().name(groupName).attributes(attributes).build())) {\n          \n          \n            \n                        UserRepresentation userRepresentation = UserBuilder\n          \n          \n            \n                                .edit(createUserRepresentation(userName, \"joe@average.com\", \"average\", \"joe\", true))\n          \n          \n            \n                                .addPassword(\"password\")\n          \n          \n            \n                                .build();\n          \n          \n            \n            \n          \n          \n            \n                            try (Creator<UserResource> u = Creator.create(realm, userRepresentation);\n          \n          \n            \n                              Creator<GroupResource> g = Creator.create(realm, GroupBuilder.create().name(groupName).attributes(attributes).build())) {\n          \n          \n            \n                        String groupId = g.id());", "url": "https://github.com/keycloak/keycloak/pull/6646#discussion_r366735036", "createdAt": "2020-01-15T07:58:45Z", "author": {"login": "hmlnarik"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1668,4 +1676,34 @@ public void testDeleteCredentials() {\n         user.resetPassword(credPasswd);\n         Assert.assertEquals(1, user.credentials().size());\n     }\n+    \n+    @Test\n+    public void testGetGroupsForUserFullRepresentation() {\n+       \n+        RealmResource realm = adminClient.realms().realm(\"test\");\n+        \n+        String userName = \"averagejoe\";\n+        String groupName = \"groupWithAttribute\";\n+        Map<String, List<String>> attributes = new HashMap<String, List<String>>();\n+        attributes.put(\"attribute1\", Arrays.asList(\"attribute1\",\"attribute2\"));\n+        \n+        try (Creator<GroupResource> g = Creator.create(realm, GroupBuilder.create().name(groupName).attributes(attributes).build())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c8500f16b029a4f459a76bf7b62333ef4ed2347"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c71f13527e0fefd77807e5f86dca6d939a08c82c", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/c71f13527e0fefd77807e5f86dca6d939a08c82c", "committedDate": "2020-01-15T08:13:27Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3c8500f16b029a4f459a76bf7b62333ef4ed2347", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/3c8500f16b029a4f459a76bf7b62333ef4ed2347", "committedDate": "2020-01-15T07:44:40Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}, "afterCommit": {"oid": "c71f13527e0fefd77807e5f86dca6d939a08c82c", "author": {"user": null}, "url": "https://github.com/keycloak/keycloak/commit/c71f13527e0fefd77807e5f86dca6d939a08c82c", "committedDate": "2020-01-15T08:13:27Z", "message": "KEYCLOAK-12630 full representation param for get groups by user endpoint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzMDY0OTM4", "url": "https://github.com/keycloak/keycloak/pull/6646#pullrequestreview-343064938", "createdAt": "2020-01-15T08:57:34Z", "commit": {"oid": "c71f13527e0fefd77807e5f86dca6d939a08c82c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2691, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}