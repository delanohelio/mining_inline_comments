{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NjI4NjQz", "number": 6810, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTo0NjozNlrODhdQOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMToxMTo1N1rODiqUSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NDA4ODkwOnYy", "diffSide": "RIGHT", "path": "adapters/oidc/js/src/main/resources/keycloak.js", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTo0NjozNlrOFsMoMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNTozMTowOFrOFsYAIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg4ODU2MA==", "bodyText": "@edewit Could you remove the unrelated whitespace changes from your commit?", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r381888560", "createdAt": "2020-02-20T09:46:36Z", "author": {"login": "jonkoops"}, "path": "adapters/oidc/js/src/main/resources/keycloak.js", "diffHunk": "@@ -18,9 +18,9 @@\n (function(root, factory) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d2023fb884bfd1aad2bc8500c7e25ed490fb670"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MDAwNA==", "bodyText": "you want to have spaces on the end of lines?", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r382050004", "createdAt": "2020-02-20T14:54:43Z", "author": {"login": "edewit"}, "path": "adapters/oidc/js/src/main/resources/keycloak.js", "diffHunk": "@@ -18,9 +18,9 @@\n (function(root, factory) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg4ODU2MA=="}, "originalCommit": {"oid": "3d2023fb884bfd1aad2bc8500c7e25ed490fb670"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MjU2NQ==", "bodyText": "No, just that the commit only includes the lines that are actually changed.", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r382052565", "createdAt": "2020-02-20T14:58:25Z", "author": {"login": "jonkoops"}, "path": "adapters/oidc/js/src/main/resources/keycloak.js", "diffHunk": "@@ -18,9 +18,9 @@\n (function(root, factory) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg4ODU2MA=="}, "originalCommit": {"oid": "3d2023fb884bfd1aad2bc8500c7e25ed490fb670"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA3NDkxNA==", "bodyText": "just add ?w=1 on the url and you'll see only the important changes", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r382074914", "createdAt": "2020-02-20T15:31:08Z", "author": {"login": "edewit"}, "path": "adapters/oidc/js/src/main/resources/keycloak.js", "diffHunk": "@@ -18,9 +18,9 @@\n (function(root, factory) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg4ODU2MA=="}, "originalCommit": {"oid": "3d2023fb884bfd1aad2bc8500c7e25ed490fb670"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjEwNDg4OnYy", "diffSide": "RIGHT", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwODoxOToxM1rOFt8Srw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMzo1NDo0NVrOFuG5aQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw==", "bodyText": "We shouldn't change testAppUrl. When this url is changed, other tests will use it as well. Could you please change the testAppUrl variable to final by using AuthServerTestEnricher.getAuthServerContextRoot method?", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383718063", "createdAt": "2020-02-25T08:19:13Z", "author": {"login": "mhajas"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg1NDU1Mg==", "bodyText": "It's done here as well. How do I set the testAppUrl by using AuthServerTestEnricher.getAuthServerContextRoot method?", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383854552", "createdAt": "2020-02-25T12:42:33Z", "author": {"login": "edewit"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw=="}, "originalCommit": {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg4OTI0OQ==", "bodyText": "I see. It is working because testAppUrl is assigned in @Before method, so it is same for each test. However it is useless to reassign it before each method since for majority of methods it is same. We can have something like this\nprivate static final String TEST_APP_URL = AuthServerTestEnricher.getAuthServerContextRoot().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html\";\n\ninstead of\nprivate String testAppUrl;\n\nand then create a new variable based on TEST_APP_URL everywhere we need to change it.\nHowever this is little bit out of this issue and the test will be working even without it, so I won't insist on changing it :-). Feel free to ignore this comment.", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383889249", "createdAt": "2020-02-25T13:50:20Z", "author": {"login": "mhajas"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw=="}, "originalCommit": {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg5MTgxNw==", "bodyText": "Right, I feel like this is a separate issue", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383891817", "createdAt": "2020-02-25T13:54:45Z", "author": {"login": "edewit"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcxODA2Mw=="}, "originalCommit": {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjEyNTM1OnYy", "diffSide": "RIGHT", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwODoyNTo1NVrOFt8e5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwODoyNTo1NVrOFt8e5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzcyMTE4OA==", "bodyText": "This is always true. You need to use driver1.getCurrentUrl() in order to find out current url in browser.", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383721188", "createdAt": "2020-02-25T08:25:55Z", "author": {"login": "mhajas"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+\n+        testAppUrl = authServerContextRootPage.toString().replace(\"localhost\", NIP_IO_URL) + JAVASCRIPT_URL + \"/index.html?test=bla=bla&super=man\";\n+        jsDriver.navigate().to(testAppUrl);\n+\n+        JSObjectBuilder arguments = defaultArguments();\n+\n+        testExecutor.init(arguments, this::assertInitNotAuth)\n+                .login(this::assertOnLoginPage)\n+                .loginForm(testUser, this::assertOnTestAppUrl)\n+                .init(arguments, (driver1, output1, events2) -> {\n+                    assertTrue(testAppUrl.contains(\"bla=bla\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjcxNDk3OnYy", "diffSide": "RIGHT", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMToxMTo1N1rOFuCIXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMToxMTo1N1rOFuCIXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzgxMzcyNw==", "bodyText": "Remove empty line", "url": "https://github.com/keycloak/keycloak/pull/6810#discussion_r383813727", "createdAt": "2020-02-25T11:11:57Z", "author": {"login": "mhajas"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/javascript/JavascriptAdapterTest.java", "diffHunk": "@@ -474,6 +474,23 @@ public void testLocationHeaderInResponse() {\n                         });\n     }\n \n+    @Test\n+    public void equalsSignInRedirectUrl() {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "303514c73fd5b8fafcb9602c73f4b6fdafc6774a"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3769, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}