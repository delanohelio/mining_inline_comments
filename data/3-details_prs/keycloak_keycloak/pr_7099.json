{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMjg3MDY5", "number": 7099, "title": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow", "bodyText": "Build on top of #5867 + added missing test", "createdAt": "2020-05-23T15:13:28Z", "url": "https://github.com/keycloak/keycloak/pull/7099", "merged": true, "mergeCommit": {"oid": "e825ec24cb35a45b13e87209abcbd2935bce2cf0"}, "closed": true, "closedAt": "2020-05-27T05:34:06Z", "author": {"login": "thomasdarimont"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckIakagFqTQxNzI4NjE1NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclSfhUAFqTQxODg2ODIxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3Mjg2MTU0", "url": "https://github.com/keycloak/keycloak/pull/7099#pullrequestreview-417286154", "createdAt": "2020-05-23T15:15:36Z", "commit": {"oid": "1d20d2ef876f4c3659d51a8f70afc00bd6c07843"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QxNToxNTozNlrOGZp6xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yM1QxNToxNTozNlrOGZp6xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU1NDM3Mw==", "bodyText": "One could optionally verify the generated hash, but I did not find a method to do that. Would be great if someone could point me to a method where the at_hash claim is checked...? :)", "url": "https://github.com/keycloak/keycloak/pull/7099#discussion_r429554373", "createdAt": "2020-05-23T15:15:36Z", "author": {"login": "thomasdarimont"}, "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/oidc/flows/AbstractOIDCResponseTypeTest.java", "diffHunk": "@@ -253,6 +253,8 @@ private void oidcFlow(String expectedAccessAlg, String expectedIdTokenAlg) throw\n         for (IDToken idt : idTokens) {\n             Assert.assertEquals(\"abcdef123456\", idt.getNonce());\n             Assert.assertEquals(authzResponse.getSessionState(), idt.getSessionState());\n+            // see KEYCLOAK-9635\n+            Assert.assertNotNull(\"claim at_hash should be present in IDToken for OIDC auth code flow requests\", idt.getAccessTokenHash());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d20d2ef876f4c3659d51a8f70afc00bd6c07843"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d20d2ef876f4c3659d51a8f70afc00bd6c07843", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/1d20d2ef876f4c3659d51a8f70afc00bd6c07843", "committedDate": "2020-05-23T15:11:30Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}, "afterCommit": {"oid": "5d8820e4cb16fd0214853622e8d8a0fe4262c442", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/5d8820e4cb16fd0214853622e8d8a0fe4262c442", "committedDate": "2020-05-23T20:42:17Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d8820e4cb16fd0214853622e8d8a0fe4262c442", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/5d8820e4cb16fd0214853622e8d8a0fe4262c442", "committedDate": "2020-05-23T20:42:17Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}, "afterCommit": {"oid": "8c739197e741b922338a39570097eebc61efd3ba", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/8c739197e741b922338a39570097eebc61efd3ba", "committedDate": "2020-05-23T20:43:21Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c739197e741b922338a39570097eebc61efd3ba", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/8c739197e741b922338a39570097eebc61efd3ba", "committedDate": "2020-05-23T20:43:21Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}, "afterCommit": {"oid": "d9d7b098b6e098bff6af0fbad7fe57300780c777", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/d9d7b098b6e098bff6af0fbad7fe57300780c777", "committedDate": "2020-05-23T21:49:32Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MzQ3MTcz", "url": "https://github.com/keycloak/keycloak/pull/7099#pullrequestreview-418347173", "createdAt": "2020-05-26T14:20:17Z", "commit": {"oid": "d9d7b098b6e098bff6af0fbad7fe57300780c777"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f950ac4bee424908f6754767aa0ef5782291e3e", "author": {"user": {"login": "yelhouti", "name": null}}, "url": "https://github.com/keycloak/keycloak/commit/4f950ac4bee424908f6754767aa0ef5782291e3e", "committedDate": "2020-05-26T21:56:24Z", "message": "add optional field at_hash to idToken when using Authorization Code flow since it improves performance and allows to follow the recommandation in RFC for clients to use hash for access_token validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ceb13b1ee6c4f97bc7ee66eaceef1447e323934", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/2ceb13b1ee6c4f97bc7ee66eaceef1447e323934", "committedDate": "2020-05-26T21:56:24Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ec2fe7229e82b7090bfaf8069d712393af5723a", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/3ec2fe7229e82b7090bfaf8069d712393af5723a", "committedDate": "2020-05-26T21:56:24Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nRevised tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9d7b098b6e098bff6af0fbad7fe57300780c777", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/d9d7b098b6e098bff6af0fbad7fe57300780c777", "committedDate": "2020-05-23T21:49:32Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nAdded missing test"}, "afterCommit": {"oid": "3ec2fe7229e82b7090bfaf8069d712393af5723a", "author": {"user": {"login": "thomasdarimont", "name": "Thomas Darimont"}}, "url": "https://github.com/keycloak/keycloak/commit/3ec2fe7229e82b7090bfaf8069d712393af5723a", "committedDate": "2020-05-26T21:56:24Z", "message": "KEYCLOAK-9635 Add AccessTokenHash to IDToken for OIDC Auth Code flow\n\nRevised tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4ODY4MjE2", "url": "https://github.com/keycloak/keycloak/pull/7099#pullrequestreview-418868216", "createdAt": "2020-05-27T05:34:00Z", "commit": {"oid": "3ec2fe7229e82b7090bfaf8069d712393af5723a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3081, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}