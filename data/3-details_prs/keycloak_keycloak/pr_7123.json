{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1MTU0NTgy", "number": 7123, "title": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones", "bodyText": "", "createdAt": "2020-05-29T14:56:02Z", "url": "https://github.com/keycloak/keycloak/pull/7123", "merged": true, "mergeCommit": {"oid": "0870041b0bf261fc062a23c46765b63b8fcb1197"}, "closed": true, "closedAt": "2020-06-02T14:31:12Z", "author": {"login": "pedroigor"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmDxTHABqjMzODc1NzYzMTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnU8BBgFqTQyMjY3ODkwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8dd2da4e4b5bca2e278dcdeb707aab5c4b8369b4", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/8dd2da4e4b5bca2e278dcdeb707aab5c4b8369b4", "committedDate": "2020-05-29T14:55:16Z", "message": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones"}, "afterCommit": {"oid": "3b64c32797a9be2bb4d5139ba363fdf0bd5265ab", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/3b64c32797a9be2bb4d5139ba363fdf0bd5265ab", "committedDate": "2020-05-29T14:57:56Z", "message": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b64c32797a9be2bb4d5139ba363fdf0bd5265ab", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/3b64c32797a9be2bb4d5139ba363fdf0bd5265ab", "committedDate": "2020-05-29T14:57:56Z", "message": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones"}, "afterCommit": {"oid": "80ecf7cdaef8653e2900bb31d13d47a913fe2078", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/80ecf7cdaef8653e2900bb31d13d47a913fe2078", "committedDate": "2020-05-29T15:32:32Z", "message": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyMzk0NDI4", "url": "https://github.com/keycloak/keycloak/pull/7123#pullrequestreview-422394428", "createdAt": "2020-06-02T07:03:13Z", "commit": {"oid": "80ecf7cdaef8653e2900bb31d13d47a913fe2078"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNzowMzoxNFrOGdkn7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNzowMzoxNFrOGdkn7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY2MTkzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String appEntityId = client !=null ? em.getReference(ClientEntity.class, client.getId()).getId() : null;\n          \n          \n            \n                    realm.setMasterAdminClient(appEntityId);\n          \n          \n            \n                    em.flush();\n          \n          \n            \n                    realm.setMasterAdminClient(client.getId());\n          \n      \n    \n    \n  \n\nI don't think we need to lookup the client here, nor do we need an em.flush here.", "url": "https://github.com/keycloak/keycloak/pull/7123#discussion_r433661932", "createdAt": "2020-06-02T07:03:14Z", "author": {"login": "stianst"}, "path": "model/jpa/src/main/java/org/keycloak/models/jpa/RealmAdapter.java", "diffHunk": "@@ -1245,8 +1249,8 @@ public ClientModel getMasterAdminClient() {\n \n     @Override\n     public void setMasterAdminClient(ClientModel client) {\n-        ClientEntity appEntity = client !=null ? em.getReference(ClientEntity.class, client.getId()) : null;\n-        realm.setMasterAdminClient(appEntity);\n+        String appEntityId = client !=null ? em.getReference(ClientEntity.class, client.getId()).getId() : null;\n+        realm.setMasterAdminClient(appEntityId);\n         em.flush();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80ecf7cdaef8653e2900bb31d13d47a913fe2078"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNDk1NDA2", "url": "https://github.com/keycloak/keycloak/pull/7123#pullrequestreview-422495406", "createdAt": "2020-06-02T09:20:27Z", "commit": {"oid": "80ecf7cdaef8653e2900bb31d13d47a913fe2078"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2b63dfde111734c9016ca5301f66c4a93a678c9", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/c2b63dfde111734c9016ca5301f66c4a93a678c9", "committedDate": "2020-06-02T13:26:07Z", "message": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones\n\nCo-authored-by: Stian Thorgersen <stian@redhat.com>\nCo-authored-by: Hynek Mlnarik <hmlnarik@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "084c7f3825cdc3050a4d50d1091aa7f9a918cda5", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/084c7f3825cdc3050a4d50d1091aa7f9a918cda5", "committedDate": "2020-06-02T11:36:09Z", "message": "Update model/jpa/src/main/java/org/keycloak/models/jpa/RealmAdapter.java\n\nCo-authored-by: Stian Thorgersen <stian@redhat.com>"}, "afterCommit": {"oid": "c2b63dfde111734c9016ca5301f66c4a93a678c9", "author": {"user": {"login": "pedroigor", "name": "Pedro Igor"}}, "url": "https://github.com/keycloak/keycloak/commit/c2b63dfde111734c9016ca5301f66c4a93a678c9", "committedDate": "2020-06-02T13:26:07Z", "message": "[KEYCLOAK-14335] - Not initializing entity associations and removing bi-directional ones\n\nCo-authored-by: Stian Thorgersen <stian@redhat.com>\nCo-authored-by: Hynek Mlnarik <hmlnarik@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjc4OTAx", "url": "https://github.com/keycloak/keycloak/pull/7123#pullrequestreview-422678901", "createdAt": "2020-06-02T13:32:47Z", "commit": {"oid": "c2b63dfde111734c9016ca5301f66c4a93a678c9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3108, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}