{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxODk3ODcz", "number": 6743, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMToyMjo0OFrODd1cNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyNToyNVrODfnI8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjEwODcwOnYy", "diffSide": "RIGHT", "path": "themes/src/main/resources/theme/keycloak-preview/account/index.ftl", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMToyMjo0OFrOFmqqWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxNDo0NjoxMlrOFm_UPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA4OTE3Nw==", "bodyText": "You also need to do this on line 199.", "url": "https://github.com/keycloak/keycloak/pull/6743#discussion_r376089177", "createdAt": "2020-02-06T21:22:48Z", "author": {"login": "ssilvert"}, "path": "themes/src/main/resources/theme/keycloak-preview/account/index.ftl", "diffHunk": "@@ -155,7 +155,7 @@\n             </div>\n             </#if>\n \n-            <#if realm.internationalizationEnabled  && supportedLocales?size gt 1>\n+            <#if false && realm.internationalizationEnabled  && supportedLocales?size gt 1>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c11c268f91474bc3316d6487f42500a0755894f"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI2OTc0Nw==", "bodyText": "Removed the lines as you suggested on chat", "url": "https://github.com/keycloak/keycloak/pull/6743#discussion_r376269747", "createdAt": "2020-02-07T08:38:00Z", "author": {"login": "stianst"}, "path": "themes/src/main/resources/theme/keycloak-preview/account/index.ftl", "diffHunk": "@@ -155,7 +155,7 @@\n             </div>\n             </#if>\n \n-            <#if realm.internationalizationEnabled  && supportedLocales?size gt 1>\n+            <#if false && realm.internationalizationEnabled  && supportedLocales?size gt 1>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA4OTE3Nw=="}, "originalCommit": {"oid": "5c11c268f91474bc3316d6487f42500a0755894f"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQyNzU4Mg==", "bodyText": "OK.\nRealized that this means we can remove a couple of functions from WelcomePageScripts.js.  I'll just do that when I refactor locale handling in https://issues.redhat.com/browse/KEYCLOAK-12936", "url": "https://github.com/keycloak/keycloak/pull/6743#discussion_r376427582", "createdAt": "2020-02-07T14:46:12Z", "author": {"login": "ssilvert"}, "path": "themes/src/main/resources/theme/keycloak-preview/account/index.ftl", "diffHunk": "@@ -155,7 +155,7 @@\n             </div>\n             </#if>\n \n-            <#if realm.internationalizationEnabled  && supportedLocales?size gt 1>\n+            <#if false && realm.internationalizationEnabled  && supportedLocales?size gt 1>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA4OTE3Nw=="}, "originalCommit": {"oid": "5c11c268f91474bc3316d6487f42500a0755894f"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NDczNzEyOnYy", "diffSide": "RIGHT", "path": "services/src/main/java/org/keycloak/authentication/requiredactions/UpdateUserLocaleAction.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyNToyNVrOFpahnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxODo0NzoxMlrOFpfZMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MDUyNA==", "bodyText": "RequiredAction is basically used here as a callback to be triggered after authentication. This works fine, on the other hand it looks to me as a workaround. It has some unneeded side-effects (EG. administrator will see \"update user locale\" as requiredAction and they will be able to set it to users. This won't have any effect and might be slightly confusing etc).\nIt may be better to have something like \"Interceptor SPI\" or possibly re-use our EventSPI. However using Event SPI in it's current form looks also as a workaround an I guess we don't have proper event yet for \"POST_REQUIRED_ACTIONS\", which is triggered after success of all required actions etc.\nIn shortcut, consider that we don't have better SPI right now, I am fine with using it as it for this PR :)", "url": "https://github.com/keycloak/keycloak/pull/6743#discussion_r378970524", "createdAt": "2020-02-13T16:25:25Z", "author": {"login": "mposolda"}, "path": "services/src/main/java/org/keycloak/authentication/requiredactions/UpdateUserLocaleAction.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.keycloak.authentication.requiredactions;\n+\n+import org.keycloak.Config;\n+import org.keycloak.authentication.RequiredActionContext;\n+import org.keycloak.authentication.RequiredActionFactory;\n+import org.keycloak.authentication.RequiredActionProvider;\n+import org.keycloak.locale.LocaleSelectorProvider;\n+import org.keycloak.models.KeycloakSession;\n+import org.keycloak.models.KeycloakSessionFactory;\n+import org.keycloak.models.UserModel;\n+\n+public class UpdateUserLocaleAction implements RequiredActionProvider, RequiredActionFactory {\n+\n+    @Override\n+    public String getDisplayText() {\n+        return \"Update User Locale\";\n+    }\n+\n+    @Override\n+    public void evaluateTriggers(RequiredActionContext context) {\n+        String userRequestedLocale = context.getAuthenticationSession().getAuthNote(LocaleSelectorProvider.USER_REQUEST_LOCALE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd727e2071c8f6b932fba07419667d281004e302"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTAzNTQ3MQ==", "bodyText": "What I want to do is make required action API into action API. Where an action can advertise how it supports being triggered (i.e. an action after auth, an required action, an aia, etc.). Think that is better than yet another API", "url": "https://github.com/keycloak/keycloak/pull/6743#discussion_r379035471", "createdAt": "2020-02-13T18:19:03Z", "author": {"login": "stianst"}, "path": "services/src/main/java/org/keycloak/authentication/requiredactions/UpdateUserLocaleAction.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.keycloak.authentication.requiredactions;\n+\n+import org.keycloak.Config;\n+import org.keycloak.authentication.RequiredActionContext;\n+import org.keycloak.authentication.RequiredActionFactory;\n+import org.keycloak.authentication.RequiredActionProvider;\n+import org.keycloak.locale.LocaleSelectorProvider;\n+import org.keycloak.models.KeycloakSession;\n+import org.keycloak.models.KeycloakSessionFactory;\n+import org.keycloak.models.UserModel;\n+\n+public class UpdateUserLocaleAction implements RequiredActionProvider, RequiredActionFactory {\n+\n+    @Override\n+    public String getDisplayText() {\n+        return \"Update User Locale\";\n+    }\n+\n+    @Override\n+    public void evaluateTriggers(RequiredActionContext context) {\n+        String userRequestedLocale = context.getAuthenticationSession().getAuthNote(LocaleSelectorProvider.USER_REQUEST_LOCALE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MDUyNA=="}, "originalCommit": {"oid": "fd727e2071c8f6b932fba07419667d281004e302"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA1MDI4OQ==", "bodyText": "Also, someone may want to remove this action and replace it with something else that prompts the user with a form.", "url": "https://github.com/keycloak/keycloak/pull/6743#discussion_r379050289", "createdAt": "2020-02-13T18:47:12Z", "author": {"login": "stianst"}, "path": "services/src/main/java/org/keycloak/authentication/requiredactions/UpdateUserLocaleAction.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package org.keycloak.authentication.requiredactions;\n+\n+import org.keycloak.Config;\n+import org.keycloak.authentication.RequiredActionContext;\n+import org.keycloak.authentication.RequiredActionFactory;\n+import org.keycloak.authentication.RequiredActionProvider;\n+import org.keycloak.locale.LocaleSelectorProvider;\n+import org.keycloak.models.KeycloakSession;\n+import org.keycloak.models.KeycloakSessionFactory;\n+import org.keycloak.models.UserModel;\n+\n+public class UpdateUserLocaleAction implements RequiredActionProvider, RequiredActionFactory {\n+\n+    @Override\n+    public String getDisplayText() {\n+        return \"Update User Locale\";\n+    }\n+\n+    @Override\n+    public void evaluateTriggers(RequiredActionContext context) {\n+        String userRequestedLocale = context.getAuthenticationSession().getAuthNote(LocaleSelectorProvider.USER_REQUEST_LOCALE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MDUyNA=="}, "originalCommit": {"oid": "fd727e2071c8f6b932fba07419667d281004e302"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3882, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}