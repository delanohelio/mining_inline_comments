{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNTg1MzYx", "number": 7435, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMjo1NDo1N1rOEmlH6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMjo1NDo1N1rOEmlH6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4ODg5NTc3OnYy", "diffSide": "RIGHT", "path": "quarkus/runtime/src/main/java/org/keycloak/connections/jpa/QuarkusJpaConnectionProviderFactory.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMjo1NDo1N1rOHWsMWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMzo0MTo1N1rOHWvESw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzU1NDc3Nw==", "bodyText": "Do we need to exit after \"import\" ?\nI see it will have some advantage as \"export\" and \"import\" are separate commands. On the other hand, it will always add some overhead (EG. admin will first need to run command for \"import\" and then separate command for \"start\"). Also will it makes sense to have this in the non-quarkus distribution as well to have consistent behaviour for non-quarkus and quarkus distributions regarding export/import?", "url": "https://github.com/keycloak/keycloak/pull/7435#discussion_r493554777", "createdAt": "2020-09-23T12:54:57Z", "author": {"login": "mposolda"}, "path": "quarkus/runtime/src/main/java/org/keycloak/connections/jpa/QuarkusJpaConnectionProviderFactory.java", "diffHunk": "@@ -395,6 +397,7 @@ protected ExportImportManager createMasterRealm(ExportImportManager exportImport\n \n         if (exportImportManager.isRunImport()) {\n             exportImportManager.runImport();\n+            Quarkus.asyncExit();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06134dcf638a58b7a220935e6e267355948a4dfd"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzU5Mjc3Mw==", "bodyText": "The reason why I'm doing that is that I thought that export/import are specific operations that don't really mean you want to run the server.\nThis is also related to what @stianst suggested around not booting the server at all when running these operations, but just accessing the storage directly to perform the export/import. Something we can't do easily right now.\nI don't have any preference though, so if you guys think we should keep consistent behavior with the main distribution, I'm fine with it. Although I think exit at the end is the best approach (maybe I'm missing some requirement here).", "url": "https://github.com/keycloak/keycloak/pull/7435#discussion_r493592773", "createdAt": "2020-09-23T13:32:59Z", "author": {"login": "pedroigor"}, "path": "quarkus/runtime/src/main/java/org/keycloak/connections/jpa/QuarkusJpaConnectionProviderFactory.java", "diffHunk": "@@ -395,6 +397,7 @@ protected ExportImportManager createMasterRealm(ExportImportManager exportImport\n \n         if (exportImportManager.isRunImport()) {\n             exportImportManager.runImport();\n+            Quarkus.asyncExit();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzU1NDc3Nw=="}, "originalCommit": {"oid": "06134dcf638a58b7a220935e6e267355948a4dfd"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYwMTg2Nw==", "bodyText": "I see. I am not sure what would be best regarding the usability etc. I am approving for now and we can re-visit later if needed. It is just something I wanted to clarify a bit..", "url": "https://github.com/keycloak/keycloak/pull/7435#discussion_r493601867", "createdAt": "2020-09-23T13:41:57Z", "author": {"login": "mposolda"}, "path": "quarkus/runtime/src/main/java/org/keycloak/connections/jpa/QuarkusJpaConnectionProviderFactory.java", "diffHunk": "@@ -395,6 +397,7 @@ protected ExportImportManager createMasterRealm(ExportImportManager exportImport\n \n         if (exportImportManager.isRunImport()) {\n             exportImportManager.runImport();\n+            Quarkus.asyncExit();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzU1NDc3Nw=="}, "originalCommit": {"oid": "06134dcf638a58b7a220935e6e267355948a4dfd"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3336, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}