{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjQ0ODIx", "number": 843, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo1ODo0MlrOD3VksA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxOTowMDozM1rOD3VnKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzUxNzI4OnYy", "diffSide": "RIGHT", "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/JooqConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo1ODo0MlrOGNig2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo1ODo0MlrOGNig2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1MDEzNg==", "bodyText": "We can use Archaius2 annotations and dynamic proxies with Spring. The dynamic wrapper is created by Archaius2Ext util.", "url": "https://github.com/Netflix/titus-control-plane/pull/843#discussion_r416850136", "createdAt": "2020-04-28T18:58:42Z", "author": {"login": "tbak"}, "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/JooqConfiguration.java", "diffHunk": "@@ -16,18 +16,33 @@\n \n package com.netflix.titus.ext.jooqflyway.jobactivity;\n \n-import com.netflix.archaius.api.annotations.Configuration;\n-import com.netflix.archaius.api.annotations.DefaultValue;\n+import javax.inject.Inject;\n \n-@Configuration(prefix = \"titus.ext.jooqflyway\")\n-public interface JooqConfiguration {\n+import com.netflix.titus.common.util.SpringConfigurationUtil;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.core.env.Environment;\n \n-    @DefaultValue(\"jdbc://localhost\")\n-    String getDatabaseUrl();\n+public class JooqConfiguration {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fbff07312837473852cca2655e7c3741803cbd0"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzUyMzYxOnYy", "diffSide": "RIGHT", "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/producer/JooqJobActivityProducerConnectorComponent.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxOTowMDozM1rOGNik6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMzoyNzoyM1rOGNqsAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1MTE3OA==", "bodyText": "What is the difference between this database connection and the other one?", "url": "https://github.com/Netflix/titus-control-plane/pull/843#discussion_r416851178", "createdAt": "2020-04-28T19:00:33Z", "author": {"login": "tbak"}, "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/producer/JooqJobActivityProducerConnectorComponent.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package com.netflix.titus.ext.jooqflyway.jobactivity.producer;\n+\n+import javax.sql.DataSource;\n+\n+import com.netflix.titus.ext.jooqflyway.jobactivity.RDSSSLSocketFactory;\n+import com.zaxxer.hikari.HikariConfig;\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.jooq.DSLContext;\n+import org.jooq.SQLDialect;\n+import org.jooq.impl.DSL;\n+import org.postgresql.PGProperty;\n+import org.springframework.beans.factory.annotation.Qualifier;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.core.env.Environment;\n+\n+@Configuration\n+public class JooqJobActivityProducerConnectorComponent {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fbff07312837473852cca2655e7c3741803cbd0"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjk4NDA2NA==", "bodyText": "It was complaining about having two data sources with one configuration, I tried separating it out but after talking to runtime, marking one as primary with correct qualifiers seems to work and is the recommended way", "url": "https://github.com/Netflix/titus-control-plane/pull/843#discussion_r416984064", "createdAt": "2020-04-28T23:27:23Z", "author": {"login": "amitaekbote"}, "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/producer/JooqJobActivityProducerConnectorComponent.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package com.netflix.titus.ext.jooqflyway.jobactivity.producer;\n+\n+import javax.sql.DataSource;\n+\n+import com.netflix.titus.ext.jooqflyway.jobactivity.RDSSSLSocketFactory;\n+import com.zaxxer.hikari.HikariConfig;\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.jooq.DSLContext;\n+import org.jooq.SQLDialect;\n+import org.jooq.impl.DSL;\n+import org.postgresql.PGProperty;\n+import org.springframework.beans.factory.annotation.Qualifier;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.core.env.Environment;\n+\n+@Configuration\n+public class JooqJobActivityProducerConnectorComponent {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1MTE3OA=="}, "originalCommit": {"oid": "2fbff07312837473852cca2655e7c3741803cbd0"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3950, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}