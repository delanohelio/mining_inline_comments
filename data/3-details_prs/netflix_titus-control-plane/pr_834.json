{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MzU3Mzcx", "number": 834, "title": "Initial jooq flyway commit to connect to job activity", "bodyText": "still a work in progress", "createdAt": "2020-04-02T05:01:53Z", "url": "https://github.com/Netflix/titus-control-plane/pull/834", "merged": true, "mergeCommit": {"oid": "1d62e931c0ddcc3e4b509a9ddc58fd57d34d4577"}, "closed": true, "closedAt": "2020-04-22T22:50:07Z", "author": {"login": "amitaekbote"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTumiPAFqTM4NjU3NTg0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaQNgmgFqTM5ODY0MDM2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NTc1ODQ5", "url": "https://github.com/Netflix/titus-control-plane/pull/834#pullrequestreview-386575849", "createdAt": "2020-04-02T16:05:58Z", "commit": {"oid": "d7b7b770770f143b765b2f0165a03106759b8097"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNTo1OFrOF_yenA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNzoxN1rOF_yiFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMTY0NA==", "bodyText": "This code is duplicated (we should call into RdsUtil added below).", "url": "https://github.com/Netflix/titus-control-plane/pull/834#discussion_r402431644", "createdAt": "2020-04-02T16:05:58Z", "author": {"login": "tbak"}, "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/RDSSSLSocketFactory.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.netflix.titus.ext.jooqflyway.jobactivity;\n+\n+import java.io.InputStream;\n+import java.security.KeyStore;\n+import javax.net.ssl.SSLContext;\n+import javax.net.ssl.TrustManagerFactory;\n+\n+import org.postgresql.ssl.WrappedFactory;\n+\n+public class RDSSSLSocketFactory extends WrappedFactory {\n+    public RDSSSLSocketFactory() {\n+        try {\n+            KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7b7b770770f143b765b2f0165a03106759b8097"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMjUzNA==", "bodyText": "For security reason, we should allow injecting the truststore file name and the password here. Thus internally we can use a different file, and a different (ideally encrypted) password.", "url": "https://github.com/Netflix/titus-control-plane/pull/834#discussion_r402432534", "createdAt": "2020-04-02T16:07:17Z", "author": {"login": "tbak"}, "path": "titus-ext/jooqflyway/src/main/java/com/netflix/titus/ext/jooqflyway/jobactivity/RdsUtils.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.netflix.titus.ext.jooqflyway.jobactivity;\n+\n+import java.io.InputStream;\n+import java.security.KeyStore;\n+import javax.net.ssl.SSLContext;\n+import javax.net.ssl.SSLSocketFactory;\n+import javax.net.ssl.TrustManagerFactory;\n+\n+public final class RdsUtils {\n+    /**\n+     * Setting as a constant as it is not critical.\n+     */\n+    private static final String TRUST_STORE_PASSWORD = \"titus123\";\n+\n+    public static SSLSocketFactory createRdsSSLSocketFactory() {\n+        try {\n+            KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());\n+            try (InputStream inputStream = RdsUtils.class.getClassLoader().getResourceAsStream(\"RDS-2019.truststore\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7b7b770770f143b765b2f0165a03106759b8097"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "385efd5a3d6bc2064394b6a810efb3816fc6f7ec", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/385efd5a3d6bc2064394b6a810efb3816fc6f7ec", "committedDate": "2020-04-16T03:52:52Z", "message": "Update api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bbc638696406c47bd0a743d23b44d1970b03ebc", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/5bbc638696406c47bd0a743d23b44d1970b03ebc", "committedDate": "2020-04-16T03:52:52Z", "message": "Connecting to db"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "065f389d85a76cee4864cca19bd488d917ead710", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/065f389d85a76cee4864cca19bd488d917ead710", "committedDate": "2020-04-16T03:52:52Z", "message": "Updating versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe985b4bf813f133be720d7c37f0ecff6deb66e7", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/fe985b4bf813f133be720d7c37f0ecff6deb66e7", "committedDate": "2020-04-16T03:52:52Z", "message": "Making db connections work"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8418f7d146c7f3262c7a48c2774cd3703de9fc15", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/8418f7d146c7f3262c7a48c2774cd3703de9fc15", "committedDate": "2020-04-16T03:52:52Z", "message": "logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc385c7b1bf089a4a46e956fd08ef40808151b63", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/dc385c7b1bf089a4a46e956fd08ef40808151b63", "committedDate": "2020-04-16T03:52:52Z", "message": "fixing errors, burnt by local cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d297ea677c304244de115434f25648950e32e29", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/5d297ea677c304244de115434f25648950e32e29", "committedDate": "2020-04-16T03:52:52Z", "message": "Fixing error with sslContext"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d7b7b770770f143b765b2f0165a03106759b8097", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/d7b7b770770f143b765b2f0165a03106759b8097", "committedDate": "2020-04-02T05:49:59Z", "message": "fixing errors, burnt by local cache"}, "afterCommit": {"oid": "5d297ea677c304244de115434f25648950e32e29", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/5d297ea677c304244de115434f25648950e32e29", "committedDate": "2020-04-16T03:52:52Z", "message": "Fixing error with sslContext"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59d4c8723c9357d8e5abf3b8b32823404e449a71", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/59d4c8723c9357d8e5abf3b8b32823404e449a71", "committedDate": "2020-04-21T04:29:30Z", "message": "Spring version conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a998abf3a418936e56245a3a3c7846613adde2b0", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/a998abf3a418936e56245a3a3c7846613adde2b0", "committedDate": "2020-04-21T05:05:45Z", "message": "fixing gradle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d983049abf6ff0b8a9a943682cec9e128605858b", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/d983049abf6ff0b8a9a943682cec9e128605858b", "committedDate": "2020-04-22T01:15:38Z", "message": "Updating postgressql versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7e46cec1b8e9e6e9a203c3e9808a702a57780e4", "author": {"user": {"login": "amitaekbote", "name": "Amita Ekbote"}}, "url": "https://github.com/Netflix/titus-control-plane/commit/f7e46cec1b8e9e6e9a203c3e9808a702a57780e4", "committedDate": "2020-04-22T01:25:17Z", "message": "Updating dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NjQwMzYy", "url": "https://github.com/Netflix/titus-control-plane/pull/834#pullrequestreview-398640362", "createdAt": "2020-04-22T22:41:21Z", "commit": {"oid": "f7e46cec1b8e9e6e9a203c3e9808a702a57780e4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 492, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}