{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxNjc1MDU1", "number": 795, "title": "Refactoring ConstraintValidators to sanitize violation message templates", "bodyText": "Description of the Change\nSanitize message string so it is not an EL expression by escaping special characters.\nThe message string in this case is a collection of user supplied values which is being used as a part of message template for message interpolation.", "createdAt": "2020-02-29T01:36:56Z", "url": "https://github.com/Netflix/titus-control-plane/pull/795", "merged": true, "mergeCommit": {"oid": "0ac45cbe0b52b9b2e9d9d2217310ddb384353227"}, "closed": true, "closedAt": "2020-03-03T20:09:14Z", "author": {"login": "joshi-keyur"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcI5v8dAH2gAyMzgxNjc1MDU1Ojk3N2JkZGM3YmZlYWVhY2MzM2QxNWI4MjE1N2FmZjk1YTZmOWI0OGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKHbKqAH2gAyMzgxNjc1MDU1OjllYjA4MjM5NGM4NGQxOTFjYzZkZTkzMTgyNjBiNTg2NmFlMGVhM2Y=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "977bddc7bfeaeacc33d15b82157aff95a6f9b48f", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/977bddc7bfeaeacc33d15b82157aff95a6f9b48f", "committedDate": "2020-02-29T00:54:26Z", "message": "Refactoring ConstraintValidators to sanitize violation message so it is not an EL expression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "committedDate": "2020-02-29T01:35:15Z", "message": "Merge pull request #3 from joshi-keyur/VUL-1981/sanitize-violation-message\n\nRefactoring ConstraintValidators to sanitize violation message templates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3MzU5MDgw", "url": "https://github.com/Netflix/titus-control-plane/pull/795#pullrequestreview-367359080", "createdAt": "2020-03-02T16:52:25Z", "commit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjo1MjoyNlrOFwnIFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjo1NzozNlrOFwnVAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxNzAxNA==", "bodyText": "protected? We want clients to call the original validator method?", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386517014", "createdAt": "2020-03-02T16:52:26Z", "author": {"login": "tbak"}, "path": "titus-api/src/main/java/com/netflix/titus/api/jobmanager/model/job/sanitizer/SchedulingConstraintSetValidator.java", "diffHunk": "@@ -53,7 +54,7 @@ public void initialize(SchedulingConstraintSet constraintAnnotation) {\n     }\n \n     @Override\n-    public boolean isValid(Container container, ConstraintValidatorContext context) {\n+    public boolean isValid(Container container, ConstraintValidatorContextWrapper context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxNzgyNA==", "bodyText": "protected?", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386517824", "createdAt": "2020-03-02T16:53:41Z", "author": {"login": "tbak"}, "path": "titus-common/src/main/java/com/netflix/titus/common/model/sanitizer/internal/AbstractConstraintValidator.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.netflix.titus.common.model.sanitizer.internal;\n+\n+import javax.validation.ConstraintValidator;\n+import javax.validation.ConstraintValidatorContext;\n+import java.lang.annotation.Annotation;\n+\n+public abstract class AbstractConstraintValidator<A extends Annotation, T> implements ConstraintValidator<A, T> {\n+\n+    @Override\n+    final public boolean isValid(T type, ConstraintValidatorContext context) {\n+        return this.isValid(type, new ConstraintValidatorContextWrapper(context));\n+    }\n+\n+    abstract public boolean isValid(T type, ConstraintValidatorContextWrapper wrapper);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUyMDMyMA==", "bodyText": "Replace this class with Function< String, ConstraintViolationBuilder >, and the default implementation as here?", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386520320", "createdAt": "2020-03-02T16:57:36Z", "author": {"login": "tbak"}, "path": "titus-common/src/main/java/com/netflix/titus/common/model/sanitizer/internal/ConstraintValidatorContextWrapper.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright 2020 Netflix, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.netflix.titus.common.model.sanitizer.internal;\n+\n+import javax.validation.ConstraintValidatorContext;\n+\n+public class ConstraintValidatorContextWrapper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NDU3NDkx", "url": "https://github.com/Netflix/titus-control-plane/pull/795#pullrequestreview-367457491", "createdAt": "2020-03-02T19:16:07Z", "commit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOToxNjowN1rOFwr5Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOToxNjowN1rOFwr5Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU5NTE1NQ==", "bodyText": "minor: weird indentation here", "url": "https://github.com/Netflix/titus-control-plane/pull/795#discussion_r386595155", "createdAt": "2020-03-02T19:16:07Z", "author": {"login": "fabiokung"}, "path": "titus-api/src/main/java/com/netflix/titus/api/jobmanager/model/job/sanitizer/SchedulingConstraintValidator.java", "diffHunk": "@@ -66,17 +65,16 @@\n \n     @Override\n     public void initialize(SchedulingConstraint constraintAnnotation) {\n-    }\n+   }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b10fc85d64c5ae72663a0de03d3d48bf916af138", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/b10fc85d64c5ae72663a0de03d3d48bf916af138", "committedDate": "2020-03-02T20:35:03Z", "message": "Replacing the Wrapper class with a Function which sanitizes the string message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NTA4MjAx", "url": "https://github.com/Netflix/titus-control-plane/pull/795#pullrequestreview-367508201", "createdAt": "2020-03-02T20:35:41Z", "commit": {"oid": "b10fc85d64c5ae72663a0de03d3d48bf916af138"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NTExNzA5", "url": "https://github.com/Netflix/titus-control-plane/pull/795#pullrequestreview-367511709", "createdAt": "2020-03-02T20:41:34Z", "commit": {"oid": "b10fc85d64c5ae72663a0de03d3d48bf916af138"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb082394c84d191cc6de9318260b5866ae0ea3f", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/9eb082394c84d191cc6de9318260b5866ae0ea3f", "committedDate": "2020-03-03T19:24:20Z", "message": "Merge remote-tracking branch 'upstream/master'"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 645, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}