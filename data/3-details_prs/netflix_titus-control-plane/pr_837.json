{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1MzU2NTEx", "number": 837, "title": "Adding schedulerName attribute to ApplicationSLA", "bodyText": "Description of the Change\nBy introducing scheduler attribute as part of ApplicationSLA, this change paves a path for moving  from default scheduler (fenzo) to kube-scheduler allowing control planes components to filter and limit processing to exclusive sets of ApplicationSLAs.", "createdAt": "2020-04-17T21:50:51Z", "url": "https://github.com/Netflix/titus-control-plane/pull/837", "merged": true, "mergeCommit": {"oid": "08430ef79110d18bf5e10b72825648c2c8ceb5a8"}, "closed": true, "closedAt": "2020-04-23T00:01:18Z", "author": {"login": "joshi-keyur"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcI5v8dAH2gAyNDA1MzU2NTExOjk3N2JkZGM3YmZlYWVhY2MzM2QxNWI4MjE1N2FmZjk1YTZmOWI0OGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaP97iAH2gAyNDA1MzU2NTExOmU3YjAyNzFlNzlkNDI3N2NkMmUzMGIxZTc0YWRmN2IxZjBhY2IxMDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "977bddc7bfeaeacc33d15b82157aff95a6f9b48f", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/977bddc7bfeaeacc33d15b82157aff95a6f9b48f", "committedDate": "2020-02-29T00:54:26Z", "message": "Refactoring ConstraintValidators to sanitize violation message so it is not an EL expression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/59b0d7d80b1dc3c194b5e7b59d2dff898514cc8c", "committedDate": "2020-02-29T01:35:15Z", "message": "Merge pull request #3 from joshi-keyur/VUL-1981/sanitize-violation-message\n\nRefactoring ConstraintValidators to sanitize violation message templates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b10fc85d64c5ae72663a0de03d3d48bf916af138", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/b10fc85d64c5ae72663a0de03d3d48bf916af138", "committedDate": "2020-03-02T20:35:03Z", "message": "Replacing the Wrapper class with a Function which sanitizes the string message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb082394c84d191cc6de9318260b5866ae0ea3f", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/9eb082394c84d191cc6de9318260b5866ae0ea3f", "committedDate": "2020-03-03T19:24:20Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eebceece71c91139503a318afc7ebeeb678ed356", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/eebceece71c91139503a318afc7ebeeb678ed356", "committedDate": "2020-03-03T22:20:36Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb750fa731641fd1538b2b8057146c114509a858", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/bb750fa731641fd1538b2b8057146c114509a858", "committedDate": "2020-03-11T00:15:42Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e88f776c66c32702286e2ad3e9b1a5888c388804", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/e88f776c66c32702286e2ad3e9b1a5888c388804", "committedDate": "2020-03-16T00:47:46Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "205853bb81846f2fa265db2570d392cdcbc54326", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/205853bb81846f2fa265db2570d392cdcbc54326", "committedDate": "2020-03-31T21:47:21Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9737864bccf7114edbb2ab78e0028f483ad613fb", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/9737864bccf7114edbb2ab78e0028f483ad613fb", "committedDate": "2020-04-10T23:31:27Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ab2af94f2e309ccae885329c53b92f7b68e724c", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/4ab2af94f2e309ccae885329c53b92f7b68e724c", "committedDate": "2020-04-14T00:45:06Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a3d0749cd9ff5ac92bebce1c49d275ace83f3d2", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/2a3d0749cd9ff5ac92bebce1c49d275ace83f3d2", "committedDate": "2020-04-14T19:45:50Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2acb17cade27bce3a36dc7d03f7ed98d831a0cf4", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/2acb17cade27bce3a36dc7d03f7ed98d831a0cf4", "committedDate": "2020-04-14T23:40:02Z", "message": "WIP: Introduce schedulerName to ApplicationSLA and use default scheduler value \"fenzo\""}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26d9906ff53d600ac8b7aeb6ff739b58be4f7f24", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/26d9906ff53d600ac8b7aeb6ff739b58be4f7f24", "committedDate": "2020-04-15T23:56:07Z", "message": "PR review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4c2f61677fbcf244420437b2a9c64dbc9a2f3ec", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/b4c2f61677fbcf244420437b2a9c64dbc9a2f3ec", "committedDate": "2020-04-16T17:03:04Z", "message": "Fixed typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa13bb987e90b423cf4ca08b20572c7b2ed64493", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/fa13bb987e90b423cf4ca08b20572c7b2ed64493", "committedDate": "2020-04-17T21:37:17Z", "message": "Handle updates by removing previous instance from the scheduler cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21fe05c2b85279e2c3943cc593a4703c5d015397", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/21fe05c2b85279e2c3943cc593a4703c5d015397", "committedDate": "2020-04-17T21:39:24Z", "message": "Additional tests for find-by-scheduler and update operations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4d1e147bb2ff7ffa077ccfa13b1a379f1966472", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/f4d1e147bb2ff7ffa077ccfa13b1a379f1966472", "committedDate": "2020-04-17T21:44:55Z", "message": "Merge pull request #4 from joshi-keyur/ApplicationSLA-model-extension\n\nAdd schedulerName attribute to ApplicationSLA and supporting API changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1ODA2NzUy", "url": "https://github.com/Netflix/titus-control-plane/pull/837#pullrequestreview-395806752", "createdAt": "2020-04-17T22:25:11Z", "commit": {"oid": "f4d1e147bb2ff7ffa077ccfa13b1a379f1966472"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1ODA4MTk5", "url": "https://github.com/Netflix/titus-control-plane/pull/837#pullrequestreview-395808199", "createdAt": "2020-04-17T22:29:43Z", "commit": {"oid": "f4d1e147bb2ff7ffa077ccfa13b1a379f1966472"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMjoyOTo0NFrOGHe6Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMjozMzoyMFrOGHe9uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ5OTYwMw==", "bodyText": "Jackson annotation are in ApplicationSlaMixIn. You should not add them here.", "url": "https://github.com/Netflix/titus-control-plane/pull/837#discussion_r410499603", "createdAt": "2020-04-17T22:29:44Z", "author": {"login": "tbak"}, "path": "titus-api/src/main/java/com/netflix/titus/api/model/ApplicationSLA.java", "diffHunk": "@@ -30,20 +38,29 @@\n \n     private final ResourceDimension resourceDimension;\n \n+    private final String schedulerName;\n+\n     /**\n      * Total number of instances required by this application. Titus will keep pre-allocated resources to always\n      * fulfill this requirement.\n      */\n     private int instanceCount;\n \n-    public ApplicationSLA(String appName,\n-                          Tier tier,\n-                          ResourceDimension resourceDimension,\n-                          int instanceCount) {\n+    @JsonCreator\n+    public ApplicationSLA(@JsonProperty(\"appName\") String appName,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4d1e147bb2ff7ffa077ccfa13b1a379f1966472"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUwMDUzNw==", "bodyText": "Does .onErrorReturn(t -> null) emit null value or  nothing at all?", "url": "https://github.com/Netflix/titus-control-plane/pull/837#discussion_r410500537", "createdAt": "2020-04-17T22:33:20Z", "author": {"login": "tbak"}, "path": "titus-server-master/src/main/java/com/netflix/titus/master/service/management/internal/DefaultApplicationSlaManagementService.java", "diffHunk": "@@ -52,6 +52,12 @@ public DefaultApplicationSlaManagementService(CapacityMonitoringService capacity\n                 .toList().toBlocking().firstOrDefault(Collections.emptyList());\n     }\n \n+    @Override\n+    public Collection<ApplicationSLA> getApplicationSLAsForScheduler(String schedulerName) {\n+        return storage.findBySchedulerName(schedulerName).onErrorReturn(t -> null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4d1e147bb2ff7ffa077ccfa13b1a379f1966472"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c667ac71a53d71d8a07884a4721d157e50e57b6e", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/c667ac71a53d71d8a07884a4721d157e50e57b6e", "committedDate": "2020-04-18T00:25:21Z", "message": "Removing Jackson annotations and moving to ApplicationSlaMixIn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "960dc44d5704b1a667bbf1e4b1a47a650ebed680", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/960dc44d5704b1a667bbf1e4b1a47a650ebed680", "committedDate": "2020-04-21T06:22:33Z", "message": "Added error logging and more integration tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c93df457a58c4cc7018e8b4f2f2fb2ca2c67182", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/5c93df457a58c4cc7018e8b4f2f2fb2ca2c67182", "committedDate": "2020-04-21T07:18:49Z", "message": "Partially reverting the change to fix broken integration tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NTIyOTE5", "url": "https://github.com/Netflix/titus-control-plane/pull/837#pullrequestreview-397522919", "createdAt": "2020-04-21T17:31:23Z", "commit": {"oid": "5c93df457a58c4cc7018e8b4f2f2fb2ca2c67182"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e97936e821c5d5ce8872eecebfbd1dd84ac08374", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/e97936e821c5d5ce8872eecebfbd1dd84ac08374", "committedDate": "2020-04-22T04:43:20Z", "message": "Removing TODO comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NjA5NzU4", "url": "https://github.com/Netflix/titus-control-plane/pull/837#pullrequestreview-398609758", "createdAt": "2020-04-22T21:39:44Z", "commit": {"oid": "e97936e821c5d5ce8872eecebfbd1dd84ac08374"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMTozOTo0NFrOGKNAUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMTo0MDowNVrOGKNA-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM1MjAxNw==", "bodyText": "there is -> there are", "url": "https://github.com/Netflix/titus-control-plane/pull/837#discussion_r413352017", "createdAt": "2020-04-22T21:39:44Z", "author": {"login": "corindwyer"}, "path": "titus-api/src/main/java/com/netflix/titus/api/store/v2/ApplicationSlaStoreCache.java", "diffHunk": "@@ -32,15 +36,17 @@\n \n /**\n  * Caching proxy for {@link ApplicationSlaStore}. It loads all data on startup in a blocking mode to fail fast,\n- * in case the is any problem with the storage.\n+ * in case there is any problem with the storage.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e97936e821c5d5ce8872eecebfbd1dd84ac08374"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM1MjE4Ng==", "bodyText": "autoformat class should move this curly up a line", "url": "https://github.com/Netflix/titus-control-plane/pull/837#discussion_r413352186", "createdAt": "2020-04-22T21:40:05Z", "author": {"login": "corindwyer"}, "path": "titus-api/src/main/java/com/netflix/titus/api/store/v2/ApplicationSlaStoreCache.java", "diffHunk": "@@ -50,12 +56,22 @@ public ApplicationSlaStoreCache(ApplicationSlaStore delegate) {\n     public Observable<Void> enterActiveMode() {\n         logger.info(\"Entering active mode\");\n         this.cache = loadCache(delegate);\n+        this.cacheBySchedulerName = loadSchedulerMapCache(this.cache);\n         return Observable.empty();\n     }\n \n     @Override\n     public Observable<Void> create(ApplicationSLA applicationSLA) {\n-        return delegate.create(applicationSLA).doOnCompleted(() -> cache.put(applicationSLA.getAppName(), applicationSLA));\n+        return delegate.create(applicationSLA).doOnCompleted(() ->\n+        {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e97936e821c5d5ce8872eecebfbd1dd84ac08374"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7b0271e79d4277cd2e30b1e74adf7b1f0acb102", "author": {"user": {"login": "joshi-keyur", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/e7b0271e79d4277cd2e30b1e74adf7b1f0acb102", "committedDate": "2020-04-22T22:24:20Z", "message": "Formatting changes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 500, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}