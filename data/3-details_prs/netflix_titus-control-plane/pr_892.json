{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNzAwOTMw", "number": 892, "title": "core task log locations populated from grpcTask", "bodyText": "Updates log location attributes for core Task type\nRemoteJobManagementClient is used by JobDataReplicator to build a local cache of running jobs and tasks. It depends on converting a grpc Task object into a core Task object. In that process, it seems to be losing information about task log location that is provided by the grpc Task. This change is needed to enable client cache layers using RemoteJobManagementClient to access task log information including ui-link, s3 bucket / key, s3 account Id etc.", "createdAt": "2020-08-05T23:48:23Z", "url": "https://github.com/Netflix/titus-control-plane/pull/892", "merged": true, "mergeCommit": {"oid": "b9eaf0835dc2526b7c6a2a691ad99858a9939620"}, "closed": true, "closedAt": "2020-08-07T21:29:31Z", "author": {"login": "amit-git"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8DbXwgH2gAyNDYzNzAwOTMwOjFlMWFjZWVlY2U1ZjliYTk0MTg1NGRmODMxYjY4YTFlYjA5NTVlMDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8pholgH2gAyNDYzNzAwOTMwOmUxZjI1NmJmMTk4YmIwODE3MjIyZTNlNWQ3ZmI1M2UwNmU5ZTYxOTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e1aceeece5f9ba941854df831b68a1eb0955e00", "author": {"user": {"login": "amit-git", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/1e1aceeece5f9ba941854df831b68a1eb0955e00", "committedDate": "2020-08-05T23:01:09Z", "message": "core task log locations populated from grpcTask"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNjM4OTYx", "url": "https://github.com/Netflix/titus-control-plane/pull/892#pullrequestreview-462638961", "createdAt": "2020-08-06T15:38:05Z", "commit": {"oid": "1e1aceeece5f9ba941854df831b68a1eb0955e00"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNTozODowNlrOG85GAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNTozODowNlrOG85GAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMzE3MQ==", "bodyText": "private?", "url": "https://github.com/Netflix/titus-control-plane/pull/892#discussion_r466503171", "createdAt": "2020-08-06T15:38:06Z", "author": {"login": "andrew-leung"}, "path": "titus-client/src/main/java/com/netflix/titus/runtime/endpoint/v3/grpc/GrpcJobManagementModelConverters.java", "diffHunk": "@@ -512,6 +518,27 @@ public static Task toCoreTask(com.netflix.titus.grpc.protogen.Task grpcTask) {\n         return builder.build();\n     }\n \n+    static Map<String, String> buildAttributesMapForCoreTask(com.netflix.titus.grpc.protogen.Task grpcTask) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e1aceeece5f9ba941854df831b68a1eb0955e00"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNjYzNDgw", "url": "https://github.com/Netflix/titus-control-plane/pull/892#pullrequestreview-462663480", "createdAt": "2020-08-06T16:06:47Z", "commit": {"oid": "1e1aceeece5f9ba941854df831b68a1eb0955e00"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNjowNjo0N1rOG86SSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNjowNjo0N1rOG86SSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUyMjY5OQ==", "bodyText": "Redundant check as we already call grpcTask.hasLogLocation() which checks for that.", "url": "https://github.com/Netflix/titus-control-plane/pull/892#discussion_r466522699", "createdAt": "2020-08-06T16:06:47Z", "author": {"login": "tbak"}, "path": "titus-client/src/main/java/com/netflix/titus/runtime/endpoint/v3/grpc/GrpcJobManagementModelConverters.java", "diffHunk": "@@ -512,6 +518,27 @@ public static Task toCoreTask(com.netflix.titus.grpc.protogen.Task grpcTask) {\n         return builder.build();\n     }\n \n+    static Map<String, String> buildAttributesMapForCoreTask(com.netflix.titus.grpc.protogen.Task grpcTask) {\n+        Map<String, String> attributes = new HashMap<>(grpcTask.getAttributesMap());\n+        if (grpcTask.hasLogLocation()) {\n+            LogLocation logLocation = grpcTask.getLogLocation();\n+            if (logLocation != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e1aceeece5f9ba941854df831b68a1eb0955e00"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNjczMTA1", "url": "https://github.com/Netflix/titus-control-plane/pull/892#pullrequestreview-462673105", "createdAt": "2020-08-06T16:18:58Z", "commit": {"oid": "1e1aceeece5f9ba941854df831b68a1eb0955e00"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1f256bf198bb0817222e3e5d7fb53e06e9e6193", "author": {"user": {"login": "amit-git", "name": null}}, "url": "https://github.com/Netflix/titus-control-plane/commit/e1f256bf198bb0817222e3e5d7fb53e06e9e6193", "committedDate": "2020-08-07T19:24:23Z", "message": "minor update"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 560, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}