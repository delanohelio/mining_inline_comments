{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NjgwMDk5", "number": 9499, "reviewThreads": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwODo1MToxMVrOE9iNqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxMDo1ODoyMlrOFCQoSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyOTU5MTQ2OnYy", "diffSide": "RIGHT", "path": "flow-server/pom.xml", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwODo1MToxMVrOH6RWeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzozMTowNFrOH8bQbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg2MzczOA==", "bodyText": "This is needed for connect only and also has to be removed from here.\nThis dep breaks things.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r530863738", "createdAt": "2020-11-26T08:51:11Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -164,51 +164,6 @@\n             <scope>test</scope>\n         </dependency>\n \n-\n-        <!--  Fusion Dependencies -->\n-        <dependency>\n-            <groupId>javax.validation</groupId>\n-            <artifactId>validation-api</artifactId>\n-            <version>${validation.api.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-web</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-webmvc</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework.boot</groupId>\n-            <artifactId>spring-boot-autoconfigure</artifactId>\n-            <version>${spring.autoconfigure.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-annotations</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-core</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-databind</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.datatype</groupId>\n-            <artifactId>jackson-datatype-jsr310</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n         <!-- Needed for security annotations -->\n         <dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "880a3a48054551d64552a58a934b1387c36ff12d"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg2NDM1NA==", "bodyText": "com.github.javaparser deps below also should be removed", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r530864354", "createdAt": "2020-11-26T08:52:17Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -164,51 +164,6 @@\n             <scope>test</scope>\n         </dependency>\n \n-\n-        <!--  Fusion Dependencies -->\n-        <dependency>\n-            <groupId>javax.validation</groupId>\n-            <artifactId>validation-api</artifactId>\n-            <version>${validation.api.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-web</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-webmvc</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework.boot</groupId>\n-            <artifactId>spring-boot-autoconfigure</artifactId>\n-            <version>${spring.autoconfigure.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-annotations</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-core</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-databind</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.datatype</groupId>\n-            <artifactId>jackson-datatype-jsr310</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n         <!-- Needed for security annotations -->\n         <dependency>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg2MzczOA=="}, "originalCommit": {"oid": "880a3a48054551d64552a58a934b1387c36ff12d"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUzNTQ3MQ==", "bodyText": "updated, does it look good now?", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r531535471", "createdAt": "2020-11-27T11:07:32Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -164,51 +164,6 @@\n             <scope>test</scope>\n         </dependency>\n \n-\n-        <!--  Fusion Dependencies -->\n-        <dependency>\n-            <groupId>javax.validation</groupId>\n-            <artifactId>validation-api</artifactId>\n-            <version>${validation.api.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-web</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-webmvc</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework.boot</groupId>\n-            <artifactId>spring-boot-autoconfigure</artifactId>\n-            <version>${spring.autoconfigure.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-annotations</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-core</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-databind</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.datatype</groupId>\n-            <artifactId>jackson-datatype-jsr310</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n         <!-- Needed for security annotations -->\n         <dependency>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg2MzczOA=="}, "originalCommit": {"oid": "880a3a48054551d64552a58a934b1387c36ff12d"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEyMzE4Mw==", "bodyText": "Looks good now", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533123183", "createdAt": "2020-12-01T07:31:04Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -164,51 +164,6 @@\n             <scope>test</scope>\n         </dependency>\n \n-\n-        <!--  Fusion Dependencies -->\n-        <dependency>\n-            <groupId>javax.validation</groupId>\n-            <artifactId>validation-api</artifactId>\n-            <version>${validation.api.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-web</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework</groupId>\n-            <artifactId>spring-webmvc</artifactId>\n-            <version>${spring.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.springframework.boot</groupId>\n-            <artifactId>spring-boot-autoconfigure</artifactId>\n-            <version>${spring.autoconfigure.version}</version>\n-            <scope>provided</scope>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-annotations</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-core</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.core</groupId>\n-            <artifactId>jackson-databind</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n-        <dependency>\n-            <groupId>com.fasterxml.jackson.datatype</groupId>\n-            <artifactId>jackson-datatype-jsr310</artifactId>\n-            <version>${jackson.version}</version>\n-        </dependency>\n         <!-- Needed for security annotations -->\n         <dependency>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg2MzczOA=="}, "originalCommit": {"oid": "880a3a48054551d64552a58a934b1387c36ff12d"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyOTY0MTIzOnYy", "diffSide": "RIGHT", "path": "fusion-server/src/test/resources/com/vaadin/flow/server/connect/generator/endpoints/collectionendpoint/expected-model-collectionendpoint.CollectionEndpoint.Collection.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwOTowMzo1NFrOH6R09g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTowNzoxMFrOH66Vuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3MTU0Mg==", "bodyText": "new line OR is it generated ?", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r530871542", "createdAt": "2020-11-26T09:03:54Z", "author": {"login": "denis-anisimov"}, "path": "fusion-server/src/test/resources/com/vaadin/flow/server/connect/generator/endpoints/collectionendpoint/expected-model-collectionendpoint.CollectionEndpoint.Collection.ts", "diffHunk": "@@ -0,0 +1,9 @@\n+/**\n+ * This module is generated from com.vaadin.flow.server.connect.generator.endpoints.collectionendpoint.CollectionEndpoint.Collection.\n+ * All changes to this file are overridden. Please consider to make changes in the corresponding Java file if necessary.\n+ */\n+export default interface Collection {\n+  author: string;\n+  collectionName: string;\n+  type: string;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "880a3a48054551d64552a58a934b1387c36ff12d"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUzNTI5MQ==", "bodyText": "generated, the same as in flow-server, I think one of them could be removed in the end", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r531535291", "createdAt": "2020-11-27T11:07:10Z", "author": {"login": "haijian-vaadin"}, "path": "fusion-server/src/test/resources/com/vaadin/flow/server/connect/generator/endpoints/collectionendpoint/expected-model-collectionendpoint.CollectionEndpoint.Collection.ts", "diffHunk": "@@ -0,0 +1,9 @@\n+/**\n+ * This module is generated from com.vaadin.flow.server.connect.generator.endpoints.collectionendpoint.CollectionEndpoint.Collection.\n+ * All changes to this file are overridden. Please consider to make changes in the corresponding Java file if necessary.\n+ */\n+export default interface Collection {\n+  author: string;\n+  collectionName: string;\n+  type: string;\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3MTU0Mg=="}, "originalCommit": {"oid": "880a3a48054551d64552a58a934b1387c36ff12d"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzNTYxMDYyOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QyMDo0MTo1NlrOH7JVwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QyMDo0MTo1NlrOH7JVwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTc4MTA1Ng==", "bodyText": "Make \"lookup\" transient or serializable.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r531781056", "createdAt": "2020-11-27T20:41:56Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -125,6 +126,8 @@\n          */\n         private URI nodeDownloadRoot = URI.create(NodeInstaller.DEFAULT_NODEJS_DOWNLOAD_ROOT);\n \n+        private Lookup lookup;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f28dab6e4f5bb0b8177f9988e52a0155123e5b53"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDY2MDMzOnYy", "diffSide": "RIGHT", "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/PrepareFrontendMojo.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNjo0NDo0N1rOH8aMgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNjoyODoxMFrOIAXwsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEwNTc5Mw==", "bodyText": "Is it possible to extract lookup creation into a method in a superclass ?\nI would even make it with no-args.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533105793", "createdAt": "2020-12-01T06:44:47Z", "author": {"login": "denis-anisimov"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/PrepareFrontendMojo.java", "diffHunk": "@@ -123,8 +126,10 @@ public void execute() throws MojoExecutionException, MojoFailureException {\n         try {\n             File flowResourcesFolder = new File(npmFolder,\n                     DEFAULT_FLOW_RESOURCES_FOLDER);\n+            ClassFinder classFinder = getClassFinder(project);\n+            Lookup lookup= new LookupImpl(classFinder);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk0Njk3Mg==", "bodyText": "Done, but couldn't make a non-args, since it depends on a private filed\n(private MavenProject project; ) to get the class finder.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533946972", "createdAt": "2020-12-02T07:25:26Z", "author": {"login": "haijian-vaadin"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/PrepareFrontendMojo.java", "diffHunk": "@@ -123,8 +126,10 @@ public void execute() throws MojoExecutionException, MojoFailureException {\n         try {\n             File flowResourcesFolder = new File(npmFolder,\n                     DEFAULT_FLOW_RESOURCES_FOLDER);\n+            ClassFinder classFinder = getClassFinder(project);\n+            Lookup lookup= new LookupImpl(classFinder);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEwNTc5Mw=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2MDIxMA==", "bodyText": "I thought the classes have( or could have) a common superclasess where the field may be used (may be as a protected field even though I don't like protected). And then it will be possible.\nBut that's minor.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r537260210", "createdAt": "2020-12-07T06:28:10Z", "author": {"login": "denis-anisimov"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/PrepareFrontendMojo.java", "diffHunk": "@@ -123,8 +126,10 @@ public void execute() throws MojoExecutionException, MojoFailureException {\n         try {\n             File flowResourcesFolder = new File(npmFolder,\n                     DEFAULT_FLOW_RESOURCES_FOLDER);\n+            ClassFinder classFinder = getClassFinder(project);\n+            Lookup lookup= new LookupImpl(classFinder);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEwNTc5Mw=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDY4ODg4OnYy", "diffSide": "LEFT", "path": "flow-maven-plugin/src/test/java/com/vaadin/flow/plugin/maven/BuildFrontendMojoTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNjo1NzowMFrOH8adIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwODowNDowNFrOH8cMgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExMDA1MQ==", "bodyText": "Is this removed without replacement / moving ?", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533110051", "createdAt": "2020-12-01T06:57:00Z", "author": {"login": "denis-anisimov"}, "path": "flow-maven-plugin/src/test/java/com/vaadin/flow/plugin/maven/BuildFrontendMojoTest.java", "diffHunk": "@@ -408,14 +408,6 @@ public void noTokenFile_noTokenFileShouldBeCreated()\n         Assert.assertFalse(tokenFile.exists());\n     }\n \n-    @Test\n-    public void mavenGoal_generateOpenApiJson_when_itIsInClientSideMode()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEzODU2Mg==", "bodyText": "It's moved to BuildFrontendMojoEndpointTest.java, the BuildFrontendMojoEndpointTest.java is currently ignored though, need some work to make it pass.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533138562", "createdAt": "2020-12-01T08:04:04Z", "author": {"login": "haijian-vaadin"}, "path": "flow-maven-plugin/src/test/java/com/vaadin/flow/plugin/maven/BuildFrontendMojoTest.java", "diffHunk": "@@ -408,14 +408,6 @@ public void noTokenFile_noTokenFileShouldBeCreated()\n         Assert.assertFalse(tokenFile.exists());\n     }\n \n-    @Test\n-    public void mavenGoal_generateOpenApiJson_when_itIsInClientSideMode()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExMDA1MQ=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDY5Mzc5OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNjo1OToyMFrOH8agMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzoyNTo0MVrOH9Ni3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExMDgzNQ==", "bodyText": "I wold move Lookup as the first arg.\nAnd this param requires javadocs", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533110835", "createdAt": "2020-12-01T06:59:20Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -133,8 +136,8 @@\n          * @param npmFolder\n          *            folder with the `package.json` file\n          */\n-        public Builder(ClassFinder classFinder, File npmFolder) {\n-            this(classFinder, npmFolder, new File(npmFolder, System\n+        public Builder(ClassFinder classFinder, File npmFolder, Lookup lookup) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk0NzEwMw==", "bodyText": "done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533947103", "createdAt": "2020-12-02T07:25:41Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -133,8 +136,8 @@\n          * @param npmFolder\n          *            folder with the `package.json` file\n          */\n-        public Builder(ClassFinder classFinder, File npmFolder) {\n-            this(classFinder, npmFolder, new File(npmFolder, System\n+        public Builder(ClassFinder classFinder, File npmFolder, Lookup lookup) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExMDgzNQ=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDcwNTkxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzowNDoyNVrOH8am3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzoyNjoxOFrOH9Nj7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExMjU0Mw==", "bodyText": "Not sure the final usage of this interface but it seems the methods with the return type should return the class and not its superclass.\nSo may be it should be\nTaskGenerateEndpointBase<T extends TaskGenerateEndpointBase> extends FallibleCommand{\n\nT withApplicationProperties(File applicationProperties);\n}", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533112543", "createdAt": "2020-12-01T07:04:25Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * Base interface for endpoint generation related tasks.\n+ */\n+public interface TaskGenerateEndpointBase extends FallibleCommand {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk0NzM3NA==", "bodyText": "I removed this unnecessary interface.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533947374", "createdAt": "2020-12-02T07:26:18Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * Base interface for endpoint generation related tasks.\n+ */\n+public interface TaskGenerateEndpointBase extends FallibleCommand {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExMjU0Mw=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDczMTM3OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzoxNDoxNFrOH8a1lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwOToyMToyOVrOH_H-GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExNjMxMQ==", "bodyText": "Another thing which I would recommend: methods withXXX are good for builders.\nThese are commands, not builders.\nI would  make factories instead which produces the command.\nFactory should accept paramer(s) and produces the command instance.\nThe only issue which I see here: there should be only one method. It means the fixed amount of parameters.\nSo factories extending has no sense.\nInstead I would may be make builder (which may extends one each other) and the builder may produce an immutable instance of configuration which will be passed to a factory.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533116311", "createdAt": "2020-12-01T07:14:14Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * Base interface for endpoint generation related tasks.\n+ */\n+public interface TaskGenerateEndpointBase extends FallibleCommand {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk0Nzg5OQ==", "bodyText": "Good point, I removed those withXXX methods, use a init() method instead, in this way, we also don't need the factory.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533947899", "createdAt": "2020-12-02T07:27:34Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * Base interface for endpoint generation related tasks.\n+ */\n+public interface TaskGenerateEndpointBase extends FallibleCommand {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExNjMxMQ=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1ODI0Mg==", "bodyText": "init method may be better than withXxx but it's also an evil.\ninit method is a weak API: public method means that the method may be called by anyone at any time.\nSo your intention with init method is to define a contract which says: this method should be called once.\nBut you don't define such contract via Java : as I said the method is public and can be called many times by anyone who has an access to the instance.\nMay be in this case since the instance is \"private\" it's not an issue.\nBut I'm pretty sure that you may replace easily init with a factory create(or whatever), it's almost the same with one significant difference: init may be called any number of times , CTOR may be called only once.\nSo it's always better to create some new instance via CTOR with arguments instead of init method with same arguments.\nThe only difference is : to be able to call CTOR you will need a factory (which can be created with a default CTOR) and then create a required instance via a factory method which instantiate an instance via CTOR instead of calling init on the required instance right away.\nSo it's better to use factories instead of ugly init method: it defines good clear contract via Java without any additional assumption.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533958242", "createdAt": "2020-12-02T07:50:05Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * Base interface for endpoint generation related tasks.\n+ */\n+public interface TaskGenerateEndpointBase extends FallibleCommand {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExNjMxMQ=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk1MjkyMQ==", "bodyText": "done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r535952921", "createdAt": "2020-12-04T09:21:29Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateEndpointBase.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * Base interface for endpoint generation related tasks.\n+ */\n+public interface TaskGenerateEndpointBase extends FallibleCommand {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExNjMxMQ=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDczMzE0OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateOpenApi.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzoxNDo0OVrOH8a2mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzoyNzo0NlrOH9NmTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExNjU3MA==", "bodyText": "same comments as above for TaskGenerateEndpointBase.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533116570", "createdAt": "2020-12-01T07:14:49Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateOpenApi.java", "diffHunk": "@@ -16,53 +16,25 @@\n package com.vaadin.flow.server.frontend;\n \n import java.io.File;\n-import java.util.Collections;\n-import java.util.Objects;\n-\n-import com.vaadin.flow.server.ExecutionFailedException;\n-import com.vaadin.flow.server.connect.Endpoint;\n-import com.vaadin.flow.server.connect.generator.OpenApiSpecGenerator;\n \n /**\n  * Generate OpenAPI json file for Vaadin Endpoints.\n  */\n-public class TaskGenerateOpenApi extends AbstractTaskConnectGenerator {\n-\n-    private final File javaSourceFolder;\n-    private final transient ClassLoader classLoader;\n-    private final File output;\n+public interface TaskGenerateOpenApi extends TaskGenerateEndpointBase {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk0Nzk4MA==", "bodyText": "done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533947980", "createdAt": "2020-12-02T07:27:46Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskGenerateOpenApi.java", "diffHunk": "@@ -16,53 +16,25 @@\n package com.vaadin.flow.server.frontend;\n \n import java.io.File;\n-import java.util.Collections;\n-import java.util.Objects;\n-\n-import com.vaadin.flow.server.ExecutionFailedException;\n-import com.vaadin.flow.server.connect.Endpoint;\n-import com.vaadin.flow.server.connect.generator.OpenApiSpecGenerator;\n \n /**\n  * Generate OpenAPI json file for Vaadin Endpoints.\n  */\n-public class TaskGenerateOpenApi extends AbstractTaskConnectGenerator {\n-\n-    private final File javaSourceFolder;\n-    private final transient ClassLoader classLoader;\n-    private final File output;\n+public interface TaskGenerateOpenApi extends TaskGenerateEndpointBase {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExNjU3MA=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NDc0Nzc1OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzoyMDoxOFrOH8a_Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzozNjozNFrOH9N2LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExODgwMw==", "bodyText": "This code and code below assumes that connect will be available and configured.\n(see withConnectApplicationProperties, etc...).\nThe proper logic should check whether a service is available and the configure it only if it's available.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533118803", "createdAt": "2020-12-01T07:20:18Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "diffHunk": "@@ -281,8 +282,9 @@ public static void initDevModeHandler(Set<Class<?>> classes,\n         File flowResourcesFolder = new File(baseDir,\n                 DEFAULT_FLOW_RESOURCES_FOLDER);\n \n+        Lookup lookup = new VaadinServletContext(context).getAttribute(Lookup.class);\n         Builder builder = new NodeTasks.Builder(new DevModeClassFinder(classes),\n-                new File(baseDir), new File(generatedDir),\n+                new File(baseDir), lookup, new File(generatedDir),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1MjA0NQ==", "bodyText": "Add logic to check if endpoint services are available before running endpoint related logic", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533952045", "createdAt": "2020-12-02T07:36:34Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "diffHunk": "@@ -281,8 +282,9 @@ public static void initDevModeHandler(Set<Class<?>> classes,\n         File flowResourcesFolder = new File(baseDir,\n                 DEFAULT_FLOW_RESOURCES_FOLDER);\n \n+        Lookup lookup = new VaadinServletContext(context).getAttribute(Lookup.class);\n         Builder builder = new NodeTasks.Builder(new DevModeClassFinder(classes),\n-                new File(baseDir), new File(generatedDir),\n+                new File(baseDir), lookup, new File(generatedDir),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzExODgwMw=="}, "originalCommit": {"oid": "a7fee518964be7a59a817dcbb8a252171f0b3e44"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MDM3NTk4OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/ReflectTools.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOTowMjoxM1rOH9Qtrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOTowMjoxM1rOH9Qtrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk5OTAyMw==", "bodyText": "Replace this if-then-else statement by a single return statement.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533999023", "createdAt": "2020-12-02T09:02:13Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/ReflectTools.java", "diffHunk": "@@ -825,6 +825,37 @@ public static Object getAnnotationMethodValue(Annotation annotation,\n         return Optional.empty();\n     }\n \n+    /**\n+     * Check if a class can be instantiated or not\n+     * \n+     * @param clazz\n+     *            the class to check\n+     * @return true if the class can be instantiated, otherwise false\n+     */\n+    public static boolean isInstantiable(Class<?> clazz) {\n+        if (clazz.isInterface()) {\n+          return false;\n+        }\n+        if (clazz.isSynthetic()) {\n+          return false;\n+        }\n+        if (Modifier.isAbstract(clazz.getModifiers())) {\n+          return false;\n+        }\n+        if (!Modifier.isPublic(clazz.getModifiers())) {\n+          return false;\n+        }\n+        Optional<Constructor<?>> constructor = Stream.of(clazz.getConstructors())\n+            .filter(ctor -> ctor.getParameterCount() == 0).findFirst();\n+        if (!constructor.isPresent() || !Modifier.isPublic(constructor.get().getModifiers())) {\n+          return false;\n+        }\n+        if (clazz.getEnclosingClass() != null && !Modifier.isStatic(clazz.getModifiers())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "475b4864a81150fc3ec4e7af0efdeb76d2ed25b4"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MDM3NjUzOnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/test/java/com/vaadin/flow/server/startup/fusion/DevModeInitializerEndpointTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOTowMjoxOFrOH9Qt7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOTowMjoxOFrOH9Qt7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk5OTA4Ng==", "bodyText": "Remove this use of \"Thread.sleep()\".", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r533999086", "createdAt": "2020-12-02T09:02:18Z", "author": {"login": "vaadin-bot"}, "path": "fusion-endpoint/src/test/java/com/vaadin/flow/server/startup/fusion/DevModeInitializerEndpointTest.java", "diffHunk": "@@ -0,0 +1,199 @@\n+package com.vaadin.flow.server.startup.fusion;\n+\n+import static com.vaadin.flow.server.Constants.CONNECT_JAVA_SOURCE_FOLDER_TOKEN;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_PRODUCTION_MODE;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_REUSE_DEV_SERVER;\n+import static com.vaadin.flow.server.frontend.FrontendUtils.DEFAULT_CONNECT_GENERATED_TS_DIR;\n+import static com.vaadin.flow.server.frontend.FrontendUtils.DEFAULT_CONNECT_JAVA_SOURCE_FOLDER;\n+import static com.vaadin.flow.server.frontend.FrontendUtils.DEFAULT_CONNECT_OPENAPI_JSON_FILE;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.io.File;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.nio.file.Paths;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.atomic.AtomicReference;\n+\n+import javax.servlet.ServletContext;\n+import javax.servlet.ServletRegistration;\n+\n+import com.vaadin.flow.di.Lookup;\n+import com.vaadin.flow.di.ResourceProvider;\n+import com.vaadin.flow.server.DevModeHandler;\n+import com.vaadin.flow.server.VaadinServlet;\n+import com.vaadin.flow.server.frontend.FrontendUtils;\n+import com.vaadin.flow.server.frontend.TaskGenerateConnect;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+import com.vaadin.flow.server.frontend.fusion.TaskGenerateConnectImpl;\n+import com.vaadin.flow.server.frontend.fusion.TaskGenerateOpenApiImpl;\n+import com.vaadin.flow.server.startup.DevModeInitializer;\n+\n+import org.apache.commons.io.FileUtils;\n+import org.junit.After;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+import org.mockito.Mockito;\n+\n+import net.jcip.annotations.NotThreadSafe;\n+\n+@NotThreadSafe\n+public class DevModeInitializerEndpointTest {\n+    private final AtomicReference<DevModeHandler> atomicHandler = new AtomicReference<>();\n+    \n+    String baseDir;\n+    ServletContext servletContext;\n+    Map<String, String> initParams;\n+    Set<Class<?>> classes;\n+    DevModeInitializer devModeInitializer;\n+\n+    private final TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+    private static class VaadinServletSubClass extends VaadinServlet {\n+\n+    }\n+\n+    @Before\n+    @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n+    public void setup() throws Exception {\n+        assertNull(getDevModeHandler());\n+\n+        temporaryFolder.create();\n+        baseDir = temporaryFolder.getRoot().getPath();\n+\n+        servletContext = Mockito.mock(ServletContext.class);\n+        ServletRegistration vaadinServletRegistration = Mockito\n+                .mock(ServletRegistration.class);\n+\n+        Lookup lookup = Mockito.mock(Lookup.class);\n+        Mockito.when(servletContext.getAttribute(Lookup.class.getName()))\n+                .thenReturn(lookup);\n+        Mockito.doReturn(new TaskGenerateConnectImpl()).when(lookup).lookup(TaskGenerateConnect.class);\n+        Mockito.doReturn(new TaskGenerateOpenApiImpl()).when(lookup).lookup(TaskGenerateOpenApi.class);\n+\n+        ResourceProvider resourceProvider = Mockito\n+                .mock(ResourceProvider.class);\n+        Mockito.when(lookup.lookup(ResourceProvider.class))\n+                .thenReturn(resourceProvider);\n+\n+        Mockito.when(vaadinServletRegistration.getClassName())\n+                .thenReturn(VaadinServletSubClass.class.getName());\n+\n+        initParams = new HashMap<>();\n+        initParams.put(FrontendUtils.PROJECT_BASEDIR, baseDir);\n+\n+        Mockito.when(vaadinServletRegistration.getInitParameters())\n+                .thenReturn(initParams);\n+\n+        classes = new HashSet<>();\n+        classes.add(this.getClass());\n+\n+        Map registry = new HashMap();\n+\n+        // Adding extra registrations to make sure that DevModeInitializer picks\n+        // the correct registration which is a VaadinServlet registration.\n+        registry.put(\"extra1\", Mockito.mock(ServletRegistration.class));\n+        registry.put(\"foo\", vaadinServletRegistration);\n+        registry.put(\"extra2\", Mockito.mock(ServletRegistration.class));\n+        Mockito.when(servletContext.getServletRegistrations())\n+                .thenReturn(registry);\n+        Mockito.when(servletContext.getInitParameterNames())\n+                .thenReturn(Collections.emptyEnumeration());\n+        Mockito.when(servletContext.getClassLoader())\n+                .thenReturn(this.getClass().getClassLoader());\n+\n+        FileUtils.forceMkdir(\n+                new File(baseDir, DEFAULT_CONNECT_JAVA_SOURCE_FOLDER));\n+\n+        devModeInitializer = new DevModeInitializer();\n+    }\n+\n+    @After\n+    public void teardown() throws Exception, SecurityException {\n+        System.clearProperty(\"vaadin.\" + SERVLET_PARAMETER_PRODUCTION_MODE);\n+        System.clearProperty(\"vaadin.\" + SERVLET_PARAMETER_REUSE_DEV_SERVER);\n+        System.clearProperty(\"vaadin.\" + CONNECT_JAVA_SOURCE_FOLDER_TOKEN);\n+\n+        temporaryFolder.delete();\n+        if (getDevModeHandler() != null) {\n+            getDevModeHandler().stop();\n+        }\n+    }\n+\n+    @Test\n+    public void should_generateOpenApi_when_EndpointPresents()\n+            throws Exception {\n+\n+        // Configure a folder that has .java classes with valid endpoints\n+        // Not using `src/test/java` because there are invalid endpoint names\n+        // in some tests\n+        File src = new File(\n+                getClass().getClassLoader().getResource(\"java\").getFile());\n+        System.setProperty(\"vaadin.\" + CONNECT_JAVA_SOURCE_FOLDER_TOKEN,\n+                src.getAbsolutePath());\n+\n+        File generatedOpenApiJson = Paths\n+                .get(baseDir, DEFAULT_CONNECT_OPENAPI_JSON_FILE).toFile();\n+\n+        Assert.assertFalse(generatedOpenApiJson.exists());\n+        DevModeInitializer devModeInitializer = new DevModeInitializer();\n+        devModeInitializer.onStartup(classes, servletContext);\n+        waitForDevModeServer();\n+        Thread.sleep(200);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "475b4864a81150fc3ec4e7af0efdeb76d2ed25b4"}, "originalPosition": 150}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzE2Nzc1OnYy", "diffSide": "RIGHT", "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/BuildFrontendMojo.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDozNzowNlrOH_K9aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNjo1ODoxN1rOIBJ5Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMTg5Nw==", "bodyText": "I would may be avoid passing ClassFinder  as a separate parameter here and everywhere.\nLookup may be created so that it may return the ClassFinder by ClassFinder.class.\nYou may implement this by yourself here or wait for #9572 where I introduced two static methods into Lookup which allows to extend it.\nBut this is not very important.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536001897", "createdAt": "2020-12-04T10:37:06Z", "author": {"login": "denis-anisimov"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/BuildFrontendMojo.java", "diffHunk": "@@ -161,8 +159,11 @@ private void runNodeUpdater() throws ExecutionFailedException, MojoExecutionExce\n         } catch (URISyntaxException e) {\n             throw new MojoExecutionException(\"Failed to parse \" + nodeDownloadRoot, e);\n         }\n+        \n+        ClassFinder classFinder = getClassFinder(project);\n+        Lookup lookup= createLookup(classFinder);\n         // @formatter:off\n-        new NodeTasks.Builder(getClassFinder(project),\n+        new NodeTasks.Builder(lookup, classFinder,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4MTYyMg==", "bodyText": "done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r538081622", "createdAt": "2020-12-08T06:58:17Z", "author": {"login": "haijian-vaadin"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/plugin/maven/BuildFrontendMojo.java", "diffHunk": "@@ -161,8 +159,11 @@ private void runNodeUpdater() throws ExecutionFailedException, MojoExecutionExce\n         } catch (URISyntaxException e) {\n             throw new MojoExecutionException(\"Failed to parse \" + nodeDownloadRoot, e);\n         }\n+        \n+        ClassFinder classFinder = getClassFinder(project);\n+        Lookup lookup= createLookup(classFinder);\n         // @formatter:off\n-        new NodeTasks.Builder(getClassFinder(project),\n+        new NodeTasks.Builder(lookup, classFinder,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMTg5Nw=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzE3MTMyOnYy", "diffSide": "RIGHT", "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDozNzo1NlrOH_K_fQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNjo1ODowN1rOIBJ48Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMjQyOQ==", "bodyText": "Here you may add directly a special case for ClassFinder.class.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536002429", "createdAt": "2020-12-04T10:37:56Z", "author": {"login": "denis-anisimov"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.utils;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Set;\n+\n+import com.vaadin.flow.di.Lookup;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.server.frontend.scanner.ClassFinder;\n+\n+/**\n+ * An implementation of Lookup, which could be used to find service(s) of a give\n+ * type.\n+ */\n+public class LookupImpl implements Lookup {\n+\n+    private ClassFinder classFinder;\n+\n+    /**\n+     * Creates an implementation of Lookup.\n+     * \n+     * @param classFinder\n+     *            for searching service implementations.\n+     */\n+    public LookupImpl(ClassFinder classFinder) {\n+        this.classFinder = classFinder;\n+    }\n+\n+    @Override\n+    public <T> T lookup(Class<T> serviceClass) {\n+        return lookupAll(serviceClass).stream().findFirst().orElse(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4MTUyMQ==", "bodyText": "didn't make it a special case, but instead using Lookup.compose() when creating the Lookup", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r538081521", "createdAt": "2020-12-08T06:58:07Z", "author": {"login": "haijian-vaadin"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.utils;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Set;\n+\n+import com.vaadin.flow.di.Lookup;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.server.frontend.scanner.ClassFinder;\n+\n+/**\n+ * An implementation of Lookup, which could be used to find service(s) of a give\n+ * type.\n+ */\n+public class LookupImpl implements Lookup {\n+\n+    private ClassFinder classFinder;\n+\n+    /**\n+     * Creates an implementation of Lookup.\n+     * \n+     * @param classFinder\n+     *            for searching service implementations.\n+     */\n+    public LookupImpl(ClassFinder classFinder) {\n+        this.classFinder = classFinder;\n+    }\n+\n+    @Override\n+    public <T> T lookup(Class<T> serviceClass) {\n+        return lookupAll(serviceClass).stream().findFirst().orElse(null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMjQyOQ=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzE3NTcyOnYy", "diffSide": "RIGHT", "path": "flow-server/pom.xml", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDozOTowNlrOH_LCIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNjoyMzo0NFrOIAXqsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMzEwNA==", "bodyText": "Have you checked that these deps don't break OSGi ?\nDo they have proper OSGi manifest ?", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536003104", "createdAt": "2020-12-04T10:39:06Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -78,6 +78,16 @@\n             <groupId>commons-io</groupId>\n             <artifactId>commons-io</artifactId>\n         </dependency>\n+        <dependency>\n+            <groupId>com.fasterxml.jackson.core</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMzM4Mg==", "bodyText": "By the way : why they are needed ?", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536003382", "createdAt": "2020-12-04T10:39:29Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -78,6 +78,16 @@\n             <groupId>commons-io</groupId>\n             <artifactId>commons-io</artifactId>\n         </dependency>\n+        <dependency>\n+            <groupId>com.fasterxml.jackson.core</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMzEwNA=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA2MTIwMg==", "bodyText": "They are used in the JsonUtils, there will be compile errors without them.\nHow do I check the OSGi manifest?", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536061202", "createdAt": "2020-12-04T12:22:23Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -78,6 +78,16 @@\n             <groupId>commons-io</groupId>\n             <artifactId>commons-io</artifactId>\n         </dependency>\n+        <dependency>\n+            <groupId>com.fasterxml.jackson.core</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMzEwNA=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA2MjUwNw==", "bodyText": "I tried to run the testing project, looks like it works fine", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536062507", "createdAt": "2020-12-04T12:24:44Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -78,6 +78,16 @@\n             <groupId>commons-io</groupId>\n             <artifactId>commons-io</artifactId>\n         </dependency>\n+        <dependency>\n+            <groupId>com.fasterxml.jackson.core</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMzEwNA=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI1ODY3Mg==", "bodyText": "The manifest should have a number of entries like\nBundle-SymbolicName: com.vaadin.flow.server\nExport-Package: com.vaadin.flow.component,\n....\nBut if everything works in OSGi container it means that manifest is correct.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r537258672", "createdAt": "2020-12-07T06:23:44Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/pom.xml", "diffHunk": "@@ -78,6 +78,16 @@\n             <groupId>commons-io</groupId>\n             <artifactId>commons-io</artifactId>\n         </dependency>\n+        <dependency>\n+            <groupId>com.fasterxml.jackson.core</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwMzEwNA=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzE5MDc3OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/ReflectTools.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0MjozOVrOH_LK2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNjo1NzoyOVrOIBJ3cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNTMzNg==", "bodyText": "Would be good to improve javadoc.\nIt should explain what the service is: this is a static check whether a class may be instantiated via its default CTOR via reflection. static check means that the CTOR may throw an exception and this is not checked but only possibility to instantiate the class based on type data", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536005336", "createdAt": "2020-12-04T10:42:39Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/ReflectTools.java", "diffHunk": "@@ -825,6 +825,37 @@ public static Object getAnnotationMethodValue(Annotation annotation,\n         return Optional.empty();\n     }\n \n+    /**\n+     * Check if a class can be instantiated as a service or not.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4MTEzNw==", "bodyText": "updated the java doc", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r538081137", "createdAt": "2020-12-08T06:57:29Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/ReflectTools.java", "diffHunk": "@@ -825,6 +825,37 @@ public static Object getAnnotationMethodValue(Annotation annotation,\n         return Optional.empty();\n     }\n \n+    /**\n+     * Check if a class can be instantiated as a service or not.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNTMzNg=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzE5NTUwOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0Mzo1NVrOH_LNtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNjo1NzoxNlrOIBJ21w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNjA3MA==", "bodyText": "I suggest to skip ClassFinder  passing as a parameter here (and everywhere).", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536006070", "createdAt": "2020-12-04T10:43:55Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -125,39 +126,47 @@\n          */\n         private URI nodeDownloadRoot = URI.create(NodeInstaller.DEFAULT_NODEJS_DOWNLOAD_ROOT);\n \n+        private Lookup lookup;\n+\n         /**\n          * Create a builder instance given an specific npm folder.\n          *\n+         * @param lookup\n+         *            a {@link Lookup} to discover services used by Flow (SPI)\n          * @param classFinder\n          *            a class finder\n          * @param npmFolder\n          *            folder with the `package.json` file\n          */\n-        public Builder(ClassFinder classFinder, File npmFolder) {\n-            this(classFinder, npmFolder, new File(npmFolder, System\n+        public Builder(Lookup lookup, ClassFinder classFinder, File npmFolder) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4MDk4Mw==", "bodyText": "Removed the ClassFinder parameter, use Lookup to look for ClassFinder", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r538080983", "createdAt": "2020-12-08T06:57:16Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -125,39 +126,47 @@\n          */\n         private URI nodeDownloadRoot = URI.create(NodeInstaller.DEFAULT_NODEJS_DOWNLOAD_ROOT);\n \n+        private Lookup lookup;\n+\n         /**\n          * Create a builder instance given an specific npm folder.\n          *\n+         * @param lookup\n+         *            a {@link Lookup} to discover services used by Flow (SPI)\n          * @param classFinder\n          *            a class finder\n          * @param npmFolder\n          *            folder with the `package.json` file\n          */\n-        public Builder(ClassFinder classFinder, File npmFolder) {\n-            this(classFinder, npmFolder, new File(npmFolder, System\n+        public Builder(Lookup lookup, ClassFinder classFinder, File npmFolder) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNjA3MA=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIwMTM4OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/EndpointGeneratorTaskFactory.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0NToyMVrOH_LRLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0NToyMVrOH_LRLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNjk1OQ==", "bodyText": "create implies that the return value won't be null  but anyway please add to the @return that it's never null", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536006959", "createdAt": "2020-12-04T10:45:21Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/EndpointGeneratorTaskFactory.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.vaadin.flow.server.frontend;\n+\n+import java.io.File;\n+\n+/**\n+ * A factory for creating Vaadin Endpoint generator tasks\n+ *\n+ * @author Vaadin Ltd.\n+ * @since 6.0\n+ */\n+public interface EndpointGeneratorTaskFactory {\n+\n+    /**\n+     * Create a task for generating TS files based.\n+     *\n+     * @param applicationProperties\n+     *            application properties file.\n+     * @param openApi\n+     *            openApi json file.\n+     * @param outputFolder\n+     *            the output folder.\n+     * @param frontendDirectory\n+     *            the frontend folder.\n+     * @return an endpoint tasks for generating TypeScript files for endpoints.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIwNDM3OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0NjowNlrOH_LS_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0NjowNlrOH_LS_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNzQyMw==", "bodyText": "This is technically extra check.\nThe lookup is never null here.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536007423", "createdAt": "2020-12-04T10:46:06Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "diffHunk": "@@ -394,13 +397,19 @@ public static void initDevModeHandler(Set<Class<?>> classes,\n         DevModeHandler.start(config, builder.npmFolder, runNodeTasks);\n     }\n \n+    private static boolean isEndpointServiceAvailable(Lookup lookup) {\n+        if (lookup == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIxNzg5OnYy", "diffSide": "LEFT", "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0OToxMFrOH_LanA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMzozNTowMFrOH_RI1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwOTM3Mg==", "bodyText": "Should these test be really removed ?\nAre they moved somewhere else ?\nShould there be some replacement ?\nE.g. now there is no need to check the functionality (integration: something is generated and so on).\nBut you may check that some methods of classes that are in the lookup are called: e.g. factory is called.\nAnd also objects produced by the factory are called somehow (doesn't matter what they do but they are called).", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536009372", "createdAt": "2020-12-04T10:49:10Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "diffHunk": "@@ -299,29 +295,6 @@ public void shouldUseFullPathScannerByDefault() throws Exception {\n                 Mockito.any(FallbackChunk.class));\n     }\n \n-    @Test\n-    public void should_generateOpenApi_when_EndpointPresents()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA3NjI2Nw==", "bodyText": "The tests were moved to DevModeInitializerEndpointTest", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536076267", "createdAt": "2020-12-04T12:49:19Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "diffHunk": "@@ -299,29 +295,6 @@ public void shouldUseFullPathScannerByDefault() throws Exception {\n                 Mockito.any(FallbackChunk.class));\n     }\n \n-    @Test\n-    public void should_generateOpenApi_when_EndpointPresents()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwOTM3Mg=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA4MTI5Nw==", "bodyText": "True, good point, I will add tests to verify that certain methods get called", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536081297", "createdAt": "2020-12-04T12:58:01Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "diffHunk": "@@ -299,29 +295,6 @@ public void shouldUseFullPathScannerByDefault() throws Exception {\n                 Mockito.any(FallbackChunk.class));\n     }\n \n-    @Test\n-    public void should_generateOpenApi_when_EndpointPresents()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwOTM3Mg=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEwMzEyNg==", "bodyText": "Done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536103126", "createdAt": "2020-12-04T13:35:00Z", "author": {"login": "haijian-vaadin"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "diffHunk": "@@ -299,29 +295,6 @@ public void shouldUseFullPathScannerByDefault() throws Exception {\n                 Mockito.any(FallbackChunk.class));\n     }\n \n-    @Test\n-    public void should_generateOpenApi_when_EndpointPresents()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwOTM3Mg=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIyNDU2OnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/EndpointGeneratorTaskFactoryImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo1MDo0NVrOH_Lekw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNjo1NTo1N1rOIBJzcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMDM4Nw==", "bodyText": "Up to you , but I would may be add checks that arguments are not null (if they should not be null ).\nAnd javadocs should be extended so it mentions which arguments are allowed to be null and which not.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536010387", "createdAt": "2020-12-04T10:50:45Z", "author": {"login": "denis-anisimov"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/EndpointGeneratorTaskFactoryImpl.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+\n+import com.vaadin.flow.server.frontend.EndpointGeneratorTaskFactory;\n+import com.vaadin.flow.server.frontend.TaskGenerateConnect;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+\n+/**\n+ * An implementation of the EndpointGeneratorTaskFactory, which creates endpoint generator tasks.\n+ */\n+public class EndpointGeneratorTaskFactoryImpl implements EndpointGeneratorTaskFactory {\n+\n+    @Override\n+    public TaskGenerateConnect createTaskGenerateConnect(File applicationProperties, File openApi, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxNTY4OQ==", "bodyText": "I see you have some checks for parameters in the CTOR.\nBut : is it enough?\nAnd anyway the javadocs doesn't say anything about that.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536015689", "createdAt": "2020-12-04T10:59:09Z", "author": {"login": "denis-anisimov"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/EndpointGeneratorTaskFactoryImpl.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+\n+import com.vaadin.flow.server.frontend.EndpointGeneratorTaskFactory;\n+import com.vaadin.flow.server.frontend.TaskGenerateConnect;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+\n+/**\n+ * An implementation of the EndpointGeneratorTaskFactory, which creates endpoint generator tasks.\n+ */\n+public class EndpointGeneratorTaskFactoryImpl implements EndpointGeneratorTaskFactory {\n+\n+    @Override\n+    public TaskGenerateConnect createTaskGenerateConnect(File applicationProperties, File openApi, ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMDM4Nw=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA4MDExNA==", "bodyText": "done, added null check, also the javadoc to indicate the fields cannot be null", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r538080114", "createdAt": "2020-12-08T06:55:57Z", "author": {"login": "haijian-vaadin"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/EndpointGeneratorTaskFactoryImpl.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+\n+import com.vaadin.flow.server.frontend.EndpointGeneratorTaskFactory;\n+import com.vaadin.flow.server.frontend.TaskGenerateConnect;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+\n+/**\n+ * An implementation of the EndpointGeneratorTaskFactory, which creates endpoint generator tasks.\n+ */\n+public class EndpointGeneratorTaskFactoryImpl implements EndpointGeneratorTaskFactory {\n+\n+    @Override\n+    public TaskGenerateConnect createTaskGenerateConnect(File applicationProperties, File openApi, ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMDM4Nw=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIyOTA2OnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateConnectImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo1MTo0MlrOH_LhJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMjo1NTo0OFrOH_PuoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMTA0NQ==", "bodyText": "I think all (or most) fields may be set final.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536011045", "createdAt": "2020-12-04T10:51:42Z", "author": {"login": "denis-anisimov"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateConnectImpl.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+import java.util.Objects;\n+\n+import com.vaadin.flow.server.ExecutionFailedException;\n+import com.vaadin.flow.server.frontend.TaskGenerateConnect;\n+import com.vaadin.flow.server.connect.generator.VaadinConnectClientGenerator;\n+import com.vaadin.flow.server.connect.generator.VaadinConnectTsGenerator;\n+\n+import static com.vaadin.flow.server.connect.generator.VaadinConnectClientGenerator.CONNECT_CLIENT_NAME;\n+import static com.vaadin.flow.server.connect.generator.VaadinConnectClientGenerator.CUSTOM_CONNECT_CLIENT_NAME;\n+\n+/**\n+ * Generate the Vaadin TS files for endpoints, and the Client API file.\n+ */\n+public class TaskGenerateConnectImpl extends AbstractTaskConnectGenerator implements TaskGenerateConnect {\n+\n+    private File outputFolder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA4MDAzMg==", "bodyText": "done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536080032", "createdAt": "2020-12-04T12:55:48Z", "author": {"login": "haijian-vaadin"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateConnectImpl.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+import java.util.Objects;\n+\n+import com.vaadin.flow.server.ExecutionFailedException;\n+import com.vaadin.flow.server.frontend.TaskGenerateConnect;\n+import com.vaadin.flow.server.connect.generator.VaadinConnectClientGenerator;\n+import com.vaadin.flow.server.connect.generator.VaadinConnectTsGenerator;\n+\n+import static com.vaadin.flow.server.connect.generator.VaadinConnectClientGenerator.CONNECT_CLIENT_NAME;\n+import static com.vaadin.flow.server.connect.generator.VaadinConnectClientGenerator.CUSTOM_CONNECT_CLIENT_NAME;\n+\n+/**\n+ * Generate the Vaadin TS files for endpoints, and the Client API file.\n+ */\n+public class TaskGenerateConnectImpl extends AbstractTaskConnectGenerator implements TaskGenerateConnect {\n+\n+    private File outputFolder;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMTA0NQ=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIzMDQxOnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateOpenApiImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo1MjowMFrOH_Lh8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMjo1NTo0M1rOH_Pufg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMTI0OA==", "bodyText": "All fields are most likely final.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536011248", "createdAt": "2020-12-04T10:52:00Z", "author": {"login": "denis-anisimov"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateOpenApiImpl.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.Objects;\n+\n+import com.vaadin.flow.server.ExecutionFailedException;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+import com.vaadin.flow.server.connect.generator.OpenApiSpecGenerator;\n+\n+/**\n+ * Generate OpenAPI json file for Vaadin Endpoints.\n+ */\n+public class TaskGenerateOpenApiImpl extends AbstractTaskConnectGenerator implements TaskGenerateOpenApi {\n+\n+    private File javaSourceFolder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA3OTk5OA==", "bodyText": "done", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536079998", "createdAt": "2020-12-04T12:55:43Z", "author": {"login": "haijian-vaadin"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateOpenApiImpl.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.Objects;\n+\n+import com.vaadin.flow.server.ExecutionFailedException;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+import com.vaadin.flow.server.connect.generator.OpenApiSpecGenerator;\n+\n+/**\n+ * Generate OpenAPI json file for Vaadin Endpoints.\n+ */\n+public class TaskGenerateOpenApiImpl extends AbstractTaskConnectGenerator implements TaskGenerateOpenApi {\n+\n+    private File javaSourceFolder;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMTI0OA=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzIzODg1OnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateOpenApiImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo1Mzo1N1rOH_Lm0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMjo1NTozNFrOH_PuGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMjQ5OQ==", "bodyText": "Do you need this class to be Serializable?\nDoes this class even implement Serializable?\nI think the class should not be Serializable : it's not stored anywhere.\nSo if the class is serializable then you should care about transient fields: they won't be restored after deseriallization.\nIf class should not be serialzable then transient is not needed here.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536012499", "createdAt": "2020-12-04T10:53:57Z", "author": {"login": "denis-anisimov"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateOpenApiImpl.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.Objects;\n+\n+import com.vaadin.flow.server.ExecutionFailedException;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+import com.vaadin.flow.server.connect.generator.OpenApiSpecGenerator;\n+\n+/**\n+ * Generate OpenAPI json file for Vaadin Endpoints.\n+ */\n+public class TaskGenerateOpenApiImpl extends AbstractTaskConnectGenerator implements TaskGenerateOpenApi {\n+\n+    private File javaSourceFolder;\n+    private transient ClassLoader classLoader;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA3OTg5OQ==", "bodyText": "Done, it was inherited from the existing code, now removed.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536079899", "createdAt": "2020-12-04T12:55:34Z", "author": {"login": "haijian-vaadin"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/frontend/fusion/TaskGenerateOpenApiImpl.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.frontend.fusion;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.Objects;\n+\n+import com.vaadin.flow.server.ExecutionFailedException;\n+import com.vaadin.flow.server.frontend.TaskGenerateOpenApi;\n+import com.vaadin.flow.server.connect.generator.OpenApiSpecGenerator;\n+\n+/**\n+ * Generate OpenAPI json file for Vaadin Endpoints.\n+ */\n+public class TaskGenerateOpenApiImpl extends AbstractTaskConnectGenerator implements TaskGenerateOpenApi {\n+\n+    private File javaSourceFolder;\n+    private transient ClassLoader classLoader;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxMjQ5OQ=="}, "originalCommit": {"oid": "b028a7da9a47dc0c51d1bbe477ed0c6688a2edd6"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NDY5NTM5OnYy", "diffSide": "RIGHT", "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNjozODoyNFrOH_Y0Kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNjozODoyNFrOH_Y0Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIyODkwNg==", "bodyText": "typo?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Class<?> loadCassFromClassFindler(Class<?> clz) {\n          \n          \n            \n                private Class<?> loadClassFromClassFindler(Class<?> clz) {", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536228906", "createdAt": "2020-12-04T16:38:24Z", "author": {"login": "platosha"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.utils;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Set;\n+\n+import com.vaadin.flow.di.Lookup;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.server.frontend.scanner.ClassFinder;\n+\n+/**\n+ * An implementation of Lookup, which could be used to find service(s) of a give\n+ * type.\n+ */\n+public class LookupImpl implements Lookup {\n+\n+    private ClassFinder classFinder;\n+\n+    /**\n+     * Creates an implementation of Lookup.\n+     * \n+     * @param classFinder\n+     *            for searching service implementations.\n+     */\n+    public LookupImpl(ClassFinder classFinder) {\n+        this.classFinder = classFinder;\n+    }\n+\n+    @Override\n+    public <T> T lookup(Class<T> serviceClass) {\n+        return lookupAll(serviceClass).stream().findFirst().orElse(null);\n+    }\n+\n+    @Override\n+    public <T> List<T> lookupAll(Class<T> serviceClass) {\n+        Set<?> subTypes = classFinder\n+                .getSubTypesOf(loadCassFromClassFindler(serviceClass));\n+        List<T> result = new ArrayList<>(subTypes.size());\n+        try {\n+            for (Object clazz : subTypes) {\n+                if (!ReflectTools.isInstantiableService((Class<?>) clazz)) {\n+                    continue;\n+                }\n+                Class<?> serviceType = serviceClass.getClassLoader()\n+                        .loadClass(((Class<?>) clazz).getName());\n+                result.add(serviceClass\n+                        .cast(ReflectTools.createInstance(serviceType)));\n+            }\n+        } catch (ClassNotFoundException e) {\n+            throw new IllegalStateException(\"Could not find service class\", e);\n+        }\n+        return result;\n+    }\n+\n+    private Class<?> loadCassFromClassFindler(Class<?> clz) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1479f707d26a1cac677a5006451b072a2ae051a"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NDcwNTA3OnYy", "diffSide": "RIGHT", "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNjo0MDo0MFrOH_Y5vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNjo0MDo0MFrOH_Y5vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzMDMzMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * An implementation of Lookup, which could be used to find service(s) of a give\n          \n          \n            \n             * type.\n          \n          \n            \n             * An implementation of Lookup, which could be used to find service(s) of a given\n          \n          \n            \n             * type.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r536230332", "createdAt": "2020-12-04T16:40:40Z", "author": {"login": "platosha"}, "path": "flow-maven-plugin/src/main/java/com/vaadin/flow/utils/LookupImpl.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.utils;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Set;\n+\n+import com.vaadin.flow.di.Lookup;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.server.frontend.scanner.ClassFinder;\n+\n+/**\n+ * An implementation of Lookup, which could be used to find service(s) of a give\n+ * type.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1479f707d26a1cac677a5006451b072a2ae051a"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3Njc0MjAyOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMzowMzo1NVrOIA-zAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMzowMzo1NVrOIA-zAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg5OTc3Nw==", "bodyText": "A \"NullPointerException\" could be thrown; \"lookup\" is nullable here.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r537899777", "createdAt": "2020-12-07T23:03:55Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DevModeInitializer.java", "diffHunk": "@@ -376,8 +381,6 @@ public static void initDevModeHandler(Set<Class<?>> classes,\n                 .withEmbeddableWebComponents(true).enablePnpm(enablePnpm)\n                 .withHomeNodeExecRequired(useHomeNodeExec).build();\n \n-        Lookup lookup = vaadinContext.getAttribute(Lookup.class);\n-\n         // Check whether executor is provided by the caller (framework)\n         Executor service = lookup.lookup(Executor.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aca21504210c30e8d51085bcb9b67fead0784819"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3OTEzOTMxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/LookupInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxMDo1ODoyMlrOIBTtTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxMDo1ODoyMlrOIBTtTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODI0MjM4MA==", "bodyText": "Remove this use of \"DeprecatedPolymerPublishedEventHandler\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9499#discussion_r538242380", "createdAt": "2020-12-08T10:58:22Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/LookupInitializer.java", "diffHunk": "@@ -58,7 +59,8 @@\n  *\n  */\n @HandlesTypes({ ResourceProvider.class, InstantiatorFactory.class,\n-        DeprecatedPolymerPublishedEventHandler.class })\n+        DeprecatedPolymerPublishedEventHandler.class,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f555a1b1fd4ea03c49a1f1159db397d4e761cde1"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2837, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}