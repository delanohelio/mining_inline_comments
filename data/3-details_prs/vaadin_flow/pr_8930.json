{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3MDM3MDQ1", "number": 8930, "title": "Live reload on frontend changes", "bodyText": "Trigger live reload when webpack recompiles frontend files\nWhen the webpack dev server finished recompilation, it notifies the Java server over\nthe watchdog connection. When the server notices the message, it sends a browser reload\nmessage over the dedicated live reload web socket connection.\nOther changes in this commit:\n\nflow-client now contains a TS build step, similar but simpler than V15+\nvaadin-devmode-gizmo is now bundled separately and managed by webpack.generated.js (so no longer added to generated-flow-imports)\nConvert VaadinDevmodeGizmo to TypeScript\nES5 compability (not complete, gizmo does not render well with devmode.transpile setting)\n\nFixes #8001. Fixes #8898.", "createdAt": "2020-09-01T12:13:59Z", "url": "https://github.com/vaadin/flow/pull/8930", "merged": true, "mergeCommit": {"oid": "379302945530627dc91a6947d6f8eb0af2c7e1da"}, "closed": true, "closedAt": "2020-09-03T08:32:43Z", "author": {"login": "joheriks"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE4x3cgBqjM3MTg4MjM4MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFLm6fgFqTQ4MTU3MzIxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f58fa7023b8ae4c5b84630ba4e69cffe70b02062", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/f58fa7023b8ae4c5b84630ba4e69cffe70b02062", "committedDate": "2020-09-02T08:22:45Z", "message": "Run prepare-frontend in test modules"}, "afterCommit": {"oid": "73666967e988eb28f446f56ca84eb00fff03881b", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/73666967e988eb28f446f56ca84eb00fff03881b", "committedDate": "2020-09-02T09:41:48Z", "message": "Run prepare-frontend in test modules"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNjgyNzA4", "url": "https://github.com/vaadin/flow/pull/8930#pullrequestreview-480682708", "createdAt": "2020-09-02T10:22:37Z", "commit": {"oid": "73666967e988eb28f446f56ca84eb00fff03881b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMDoyMjozN1rOHLoqig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMDoyMjozN1rOHLoqig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk2MjYzNA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/8930#discussion_r481962634", "createdAt": "2020-09-02T10:22:37Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/Constants.java", "diffHunk": "@@ -496,6 +496,12 @@\n     @Deprecated\n     public static final String SERVLET_PARAMETER_DEVMODE_ENABLE_LIVE_RELOAD = InitParameters.SERVLET_PARAMETER_DEVMODE_ENABLE_LIVE_RELOAD;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73666967e988eb28f446f56ca84eb00fff03881b"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b36c3b135fa59d5228acfa245544f9514db2512f", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/b36c3b135fa59d5228acfa245544f9514db2512f", "committedDate": "2020-09-02T11:22:00Z", "message": "Remove unused imports"}, "afterCommit": {"oid": "d3913dfbfffe9c08e847d3a5a66c0d0520382fa8", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/d3913dfbfffe9c08e847d3a5a66c0d0520382fa8", "committedDate": "2020-09-02T12:25:20Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNDc3NTE0", "url": "https://github.com/vaadin/flow/pull/8930#pullrequestreview-481477514", "createdAt": "2020-09-03T04:07:16Z", "commit": {"oid": "1e21ce2f6eb98a4421fec668d936176c2ae428eb"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNDowNzoxN1rOHMVHrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNTozMTozN1rOHMWffA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MDk5MQ==", "bodyText": "new line missing", "url": "https://github.com/vaadin/flow/pull/8930#discussion_r482690991", "createdAt": "2020-09-03T04:07:17Z", "author": {"login": "caalador"}, "path": "flow-client/tsconfig.json", "diffHunk": "@@ -0,0 +1,24 @@\n+{\n+  \"compilerOptions\": {\n+    \"sourceMap\": true,\n+    \"inlineSources\": true,\n+    \"module\": \"esNext\",\n+    \"target\": \"es2015\",\n+    \"moduleResolution\": \"node\",\n+    \"strict\": true,\n+    \"noFallthroughCasesInSwitch\": true,\n+    \"noImplicitReturns\": true,\n+    \"noImplicitAny\": true,\n+    \"noImplicitThis\": true,\n+    \"noUnusedLocals\": true,\n+    \"noUnusedParameters\": true,\n+    \"experimentalDecorators\": true,\n+    \"outDir\": \"target/classes/META-INF/resources/frontend\",\n+    \"declaration\": true,\n+    \"skipLibCheck\": true\n+  },\n+  \"include\": [\n+    \"src/main/resources/META-INF/resources/frontend/**/*.ts\"\n+  ],\n+  \"exclude\": []\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e21ce2f6eb98a4421fec668d936176c2ae428eb"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MjExOA==", "bodyText": "new line missing", "url": "https://github.com/vaadin/flow/pull/8930#discussion_r482692118", "createdAt": "2020-09-03T04:11:47Z", "author": {"login": "caalador"}, "path": "flow-client/tsconfig.json", "diffHunk": "@@ -0,0 +1,24 @@\n+{\n+  \"compilerOptions\": {\n+    \"sourceMap\": true,\n+    \"inlineSources\": true,\n+    \"module\": \"esNext\",\n+    \"target\": \"es2015\",\n+    \"moduleResolution\": \"node\",\n+    \"strict\": true,\n+    \"noFallthroughCasesInSwitch\": true,\n+    \"noImplicitReturns\": true,\n+    \"noImplicitAny\": true,\n+    \"noImplicitThis\": true,\n+    \"noUnusedLocals\": true,\n+    \"noUnusedParameters\": true,\n+    \"experimentalDecorators\": true,\n+    \"outDir\": \"target/classes/META-INF/resources/frontend\",\n+    \"declaration\": true,\n+    \"skipLibCheck\": true\n+  },\n+  \"include\": [\n+    \"src/main/resources/META-INF/resources/frontend/**/*.ts\"\n+  ],\n+  \"exclude\": []\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e21ce2f6eb98a4421fec668d936176c2ae428eb"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcxMzQ2OA==", "bodyText": "Could perhaps be BufferedReader in = new BufferedReader(new InputStreamReader(accept.getInputStream(), StandardCharsets.UTF_8)); so there are no suprises on the encodings.", "url": "https://github.com/vaadin/flow/pull/8930#discussion_r482713468", "createdAt": "2020-09-03T05:31:37Z", "author": {"login": "caalador"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/DevServerWatchDog.java", "diffHunk": "@@ -79,6 +82,18 @@ private Logger getLogger() {\n             return LoggerFactory.getLogger(WatchDogServer.class);\n         }\n \n+        private void enterReloadMessageReadLoop(Socket accept) throws IOException{\n+            BufferedReader in = new BufferedReader(new InputStreamReader(accept.getInputStream()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e21ce2f6eb98a4421fec668d936176c2ae428eb"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNTI3OTU5", "url": "https://github.com/vaadin/flow/pull/8930#pullrequestreview-481527959", "createdAt": "2020-09-03T06:30:23Z", "commit": {"oid": "8f226590b2d987485c5ad8357a7fa75a3e54e980"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNTMzMzg3", "url": "https://github.com/vaadin/flow/pull/8930#pullrequestreview-481533387", "createdAt": "2020-09-03T06:40:04Z", "commit": {"oid": "8f226590b2d987485c5ad8357a7fa75a3e54e980"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNjo0MDowNFrOHMYAoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNjo1OTozM1rOHMYj0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjczODMzNg==", "bodyText": "That assumes that npm  is installed globally ?\nWhat happens if this is not a case ?", "url": "https://github.com/vaadin/flow/pull/8930#discussion_r482738336", "createdAt": "2020-09-03T06:40:04Z", "author": {"login": "denis-anisimov"}, "path": "flow-client/pom.xml", "diffHunk": "@@ -228,6 +228,42 @@\n                     </execution>\n                 </executions>\n             </plugin>\n+\n+            <plugin>\n+                <groupId>org.codehaus.mojo</groupId>\n+                <artifactId>exec-maven-plugin</artifactId>\n+                <version>1.6.0</version>\n+                <executions>\n+                    <execution>\n+                        <id>npm-install</id>\n+                        <phase>validate</phase>\n+                        <goals>\n+                            <goal>exec</goal>\n+                        </goals>\n+                        <configuration>\n+                            <executable>npm</executable>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f226590b2d987485c5ad8357a7fa75a3e54e980"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc0NzM0NQ==", "bodyText": "Helper class could be final.\nAnd it should have a default private CTOR to avoid instantiation which shows that this is a class with only static methods.", "url": "https://github.com/vaadin/flow/pull/8930#discussion_r482747345", "createdAt": "2020-09-03T06:59:33Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/BootstrapHandlerHelper.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.internal;\n+\n+import java.io.Serializable;\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+\n+import com.vaadin.flow.server.BootstrapHandler;\n+import com.vaadin.flow.server.HandlerHelper;\n+import com.vaadin.flow.server.VaadinRequest;\n+import com.vaadin.flow.server.VaadinSession;\n+\n+/**\n+ * Helper methods for use in bootstrapping.\n+ *\n+ */\n+public class BootstrapHandlerHelper implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f226590b2d987485c5ad8357a7fa75a3e54e980"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8cd464c6effa0bc9fbebfdd7dc3f041c404d26e", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/f8cd464c6effa0bc9fbebfdd7dc3f041c404d26e", "committedDate": "2020-09-03T07:35:10Z", "message": "Live reload on frontend changes\n\nTrigger live reload when webpack recompiles frontend files\n\nWhen the webpack dev server finished recompilation, it notifies the Java server over\nthe watchdog connection. When the server notices the message, it sends a browser reload\nmessage over the dedicated live reload web socket connection.\n\nOther changes in this commit:\n- vaadin-devmode-gizmo is now bundled separately and managed by webpack.generated.js (so no longer added to generated-flow-imports)\n- Convert VaadinDevmodeGizmo to TypeScript"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a0e998c12cd83943432d75538d3c3eb1e71b4dc", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/2a0e998c12cd83943432d75538d3c3eb1e71b4dc", "committedDate": "2020-09-03T07:35:10Z", "message": "IE11 compatibility fixes:\n- JS color constants as CSS `var` cannot be used for dynamic styles\n- No use of findIndex"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89435963f33969957c7501c9df6ba1ad27398ccd", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/89435963f33969957c7501c9df6ba1ad27398ccd", "committedDate": "2020-09-03T07:35:10Z", "message": "Updated .gitignore and added package.json, package-lock.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "459adaf239c11e0344137d507b034e36a9b428e7", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/459adaf239c11e0344137d507b034e36a9b428e7", "committedDate": "2020-09-03T07:35:10Z", "message": "Run prepare-frontend in test modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8df7bfba7b323c13c5bad63d2f6220387565a8ba", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/8df7bfba7b323c13c5bad63d2f6220387565a8ba", "committedDate": "2020-09-03T07:35:10Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "441c880b15b3ef607929e1bcf11571fec9e8b496", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/441c880b15b3ef607929e1bcf11571fec9e8b496", "committedDate": "2020-09-03T07:35:10Z", "message": "Restored BootstrapHandler::getServiceURL for backwards compatibility"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0081f196f93ddca7c8178b26e8e6bee89b9d8a44", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/0081f196f93ddca7c8178b26e8e6bee89b9d8a44", "committedDate": "2020-09-03T07:35:10Z", "message": "Set utf8 explicitly on webpack <-> server connection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b20aec923fba2f486109a3945bbc5e1c828cab43", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/b20aec923fba2f486109a3945bbc5e1c828cab43", "committedDate": "2020-09-03T07:35:10Z", "message": "Newline at EOF"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d4c26c70608f72323f0d5961862781e1792508f", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/5d4c26c70608f72323f0d5961862781e1792508f", "committedDate": "2020-09-03T07:36:43Z", "message": "Added missing import from rebase"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f226590b2d987485c5ad8357a7fa75a3e54e980", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/8f226590b2d987485c5ad8357a7fa75a3e54e980", "committedDate": "2020-09-03T06:28:22Z", "message": "Newline at EOF"}, "afterCommit": {"oid": "5d4c26c70608f72323f0d5961862781e1792508f", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/5d4c26c70608f72323f0d5961862781e1792508f", "committedDate": "2020-09-03T07:36:43Z", "message": "Added missing import from rebase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNTczMjE5", "url": "https://github.com/vaadin/flow/pull/8930#pullrequestreview-481573219", "createdAt": "2020-09-03T07:38:19Z", "commit": {"oid": "5d4c26c70608f72323f0d5961862781e1792508f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 127, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}