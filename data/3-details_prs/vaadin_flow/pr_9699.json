{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzMTM0NTk4", "number": 9699, "title": "feat: use superclass of VadinServlet/Request if possible", "bodyText": "I cases you are not using the VaadinServletService because you ship your own own (Servlet-based) VaadinService.\nThen you are, at the moment, not able to use fundamental classes like VaadinServlet. This is because they use your VaadinServletService. But you are not using any methods of VaadinServletService because VaadinService is enough. So I suggest to use superclasses if possible.\nVaadinServletRequestneeds a VaadinServletService\n    @Override\n    public VaadinServletService getService() {\n        return vaadinService;\n    }\n\nIf you have your own VaadinService implementation you can't rely on VaadinServletRequest\nant an the moment you cant use a lot of classes like VaadinServlet, PushRequestHandler, StreamResourceHandler, WebComponentBootstrapHandler", "createdAt": "2020-12-20T21:28:02Z", "url": "https://github.com/vaadin/flow/pull/9699", "merged": true, "mergeCommit": {"oid": "c581668c894e3527e5f727d64bdc97f690d03901"}, "closed": true, "closedAt": "2021-03-04T08:55:03Z", "author": {"login": "stbischof"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdoKsiNABqjQxMzM4MzQxNDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd_xGYdgFqTYwMzgwNjE1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f19a1c41bfa6dd527927ccbc7ab979a33eb00d30", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/f19a1c41bfa6dd527927ccbc7ab979a33eb00d30", "committedDate": "2020-12-20T22:49:25Z", "message": "fixes\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "66880e60139ba51ab764b6ddce8f6e8047b80048", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/66880e60139ba51ab764b6ddce8f6e8047b80048", "committedDate": "2020-12-21T00:21:40Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "66880e60139ba51ab764b6ddce8f6e8047b80048", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/66880e60139ba51ab764b6ddce8f6e8047b80048", "committedDate": "2020-12-21T00:21:40Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "ac5a1a87a88ef236c416fbce5fd97fb96bc5b032", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/ac5a1a87a88ef236c416fbce5fd97fb96bc5b032", "committedDate": "2020-12-21T00:32:53Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac5a1a87a88ef236c416fbce5fd97fb96bc5b032", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/ac5a1a87a88ef236c416fbce5fd97fb96bc5b032", "committedDate": "2020-12-21T00:32:53Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "c076b9d4716a3170e352ac8ada2f3d2e2f1122b2", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/c076b9d4716a3170e352ac8ada2f3d2e2f1122b2", "committedDate": "2020-12-21T00:35:17Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c076b9d4716a3170e352ac8ada2f3d2e2f1122b2", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/c076b9d4716a3170e352ac8ada2f3d2e2f1122b2", "committedDate": "2020-12-21T00:35:17Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "87541294aa82b709f239575f9514c07e41bc508f", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/87541294aa82b709f239575f9514c07e41bc508f", "committedDate": "2020-12-21T01:46:02Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "87541294aa82b709f239575f9514c07e41bc508f", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/87541294aa82b709f239575f9514c07e41bc508f", "committedDate": "2020-12-21T01:46:02Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "4803667113cbc1848152f170d75af346c285e2ef", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/4803667113cbc1848152f170d75af346c285e2ef", "committedDate": "2020-12-21T02:10:07Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MDk2NTYx", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-556096561", "createdAt": "2020-12-21T02:22:27Z", "commit": {"oid": "4803667113cbc1848152f170d75af346c285e2ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwMjoyMjoyN1rOIJKX3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwMjoyMjoyN1rOIJKX3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQ3ODA0Nw==", "bodyText": "Remove this unused import 'javax.servlet.ServletRequestWrapper'.", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r546478047", "createdAt": "2020-12-21T02:22:27Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/StreamResourceHandler.java", "diffHunk": "@@ -16,6 +16,8 @@\n package com.vaadin.flow.server.communication;\n \n import javax.servlet.ServletContext;\n+import javax.servlet.ServletRequest;\n+import javax.servlet.ServletRequestWrapper;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4803667113cbc1848152f170d75af346c285e2ef"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4803667113cbc1848152f170d75af346c285e2ef", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/4803667113cbc1848152f170d75af346c285e2ef", "committedDate": "2020-12-21T02:10:07Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/ae688b9edce49530fe1ece708a911db8c3a11a03", "committedDate": "2020-12-21T12:11:44Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgzMDg0OTc5", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-583084979", "createdAt": "2021-02-04T07:01:47Z", "commit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNFQwNzowMTo0N1rOIflT4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNFQwNzowNjo0MlrOIflbCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4ODA2NA==", "bodyText": "Since this is VaadinServlet it means that there should be a servlet. I don't see a point in doing any changes for this class for \"no servlet present\". Why are there changes done here ?", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569988064", "createdAt": "2021-02-04T07:01:47Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java", "diffHunk": "@@ -51,7 +51,7 @@\n  * @since 1.0\n  */\n public class VaadinServlet extends HttpServlet {\n-    private VaadinServletService servletService;\n+    private VaadinService servletService;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4ODM3NQ==", "bodyText": "This is a servlet request, so why shouldn't it have access to servlet service ?", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569988375", "createdAt": "2021-02-04T07:02:40Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServletRequest.java", "diffHunk": "@@ -32,7 +32,7 @@\n public class VaadinServletRequest extends HttpServletRequestWrapper\n         implements VaadinRequest {\n \n-    private final VaadinServletService vaadinService;\n+    private final VaadinService vaadinService;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4ODcyOQ==", "bodyText": "Again, servlet based class and these changes seem like a waste of time, or why would these be needed ?", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569988729", "createdAt": "2021-02-04T07:03:41Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServletService.java", "diffHunk": "@@ -285,14 +285,14 @@ private InputStream getResourceInServletContextAsStream(String path) {\n \n     @Override\n     public String getContextRootRelativePath(VaadinRequest request) {\n-        assert request instanceof VaadinServletRequest;\n+        assert request instanceof HttpServletRequest;\n         // Generate location from the request by finding how many \"../\" should\n         // be added to the servlet path before we get to the context root\n \n         // Should not take pathinfo into account because the base URI refers to\n         // the servlet path\n \n-        String servletPath = ((VaadinServletRequest) request).getServletPath();\n+        String servletPath = ((HttpServletRequest) request).getServletPath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTYyNg==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989626", "createdAt": "2021-02-04T07:05:59Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/PushRequestHandler.java", "diffHunk": "@@ -239,7 +255,7 @@ public boolean handleRequest(VaadinSession session, VaadinRequest request,\n             return false;\n         }\n \n-        if (request instanceof VaadinServletRequest) {\n+        if (request instanceof HttpServletRequest) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTY2Mw==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989663", "createdAt": "2021-02-04T07:06:03Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/PushRequestHandler.java", "diffHunk": "@@ -248,16 +264,16 @@ public boolean handleRequest(VaadinSession session, VaadinRequest request,\n             try {\n                 atmosphere.doCometSupport(\n                         AtmosphereRequestImpl\n-                                .wrap((VaadinServletRequest) request),\n+                                .wrap((HttpServletRequest) request),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTY4OQ==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989689", "createdAt": "2021-02-04T07:06:08Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/PushRequestHandler.java", "diffHunk": "@@ -248,16 +264,16 @@ public boolean handleRequest(VaadinSession session, VaadinRequest request,\n             try {\n                 atmosphere.doCometSupport(\n                         AtmosphereRequestImpl\n-                                .wrap((VaadinServletRequest) request),\n+                                .wrap((HttpServletRequest) request),\n                         AtmosphereResponseImpl\n-                                .wrap((VaadinServletResponse) response));\n+                                .wrap((HttpServletResponse) response));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTc0Mw==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989743", "createdAt": "2021-02-04T07:06:14Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/PushRequestHandler.java", "diffHunk": "@@ -248,16 +264,16 @@ public boolean handleRequest(VaadinSession session, VaadinRequest request,\n             try {\n                 atmosphere.doCometSupport(\n                         AtmosphereRequestImpl\n-                                .wrap((VaadinServletRequest) request),\n+                                .wrap((HttpServletRequest) request),\n                         AtmosphereResponseImpl\n-                                .wrap((VaadinServletResponse) response));\n+                                .wrap((HttpServletResponse) response));\n             } catch (ServletException e) {\n                 // TODO PUSH decide how to handle\n                 throw new RuntimeException(e);\n             }\n         } else {\n             throw new IllegalArgumentException(\n-                    \"Only VaadinServletRequests are supported\");\n+                    \"Only HttpServletRequest are supported\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTgzMQ==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989831", "createdAt": "2021-02-04T07:06:28Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/StreamResourceHandler.java", "diffHunk": "@@ -60,7 +61,7 @@ public void handleRequest(VaadinSession session, VaadinRequest request,\n         StreamResourceWriter writer;\n         session.lock();\n         try {\n-            ServletContext context = ((VaadinServletRequest) request)\n+            ServletContext context = ((ServletRequest) request)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTg4NA==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989884", "createdAt": "2021-02-04T07:06:38Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/WebComponentBootstrapHandler.java", "diffHunk": "@@ -136,7 +138,7 @@ protected boolean canHandleRequest(VaadinRequest request) {\n      * @return Request's url.\n      */\n     protected String getRequestUrl(VaadinRequest request) {\n-        return ((VaadinServletRequest) request).getRequestURL().toString();\n+        return ((HttpServletRequest) request).getRequestURL().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTk4OTg5Ng==", "bodyText": "When would it be a case here that VaadinServletRequest is not applicable here ??", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r569989896", "createdAt": "2021-02-04T07:06:42Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/WebComponentBootstrapHandler.java", "diffHunk": "@@ -434,7 +436,7 @@ protected String getServiceUrl(VaadinRequest request,\n         String url = request.getParameter(REQ_PARAM_URL);\n         // if 'url' parameter was not available, use request url\n         if (url == null) {\n-            url = ((VaadinServletRequest) request).getRequestURL().toString();\n+            url = ((HttpServletRequestWrapper) request).getRequestURL().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg1NDA5MjQ1", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-585409245", "createdAt": "2021-02-08T11:35:42Z", "commit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOFQxMTozNTo0MlrOIhevPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOFQxMTozNTo0MlrOIhevPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTk3NzUzMw==", "bodyText": "This change doesn't really make any sense as it is a private method and the type is regardless VaadinServletContext.", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r571977533", "createdAt": "2021-02-08T11:35:42Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java", "diffHunk": "@@ -520,7 +520,7 @@ public void destroy() {\n         getService().destroy();\n     }\n \n-    private VaadinServletContext initializeContext() {\n+    private VaadinContext initializeContext() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae688b9edce49530fe1ece708a911db8c3a11a03"}, "originalPosition": 99}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28d6f58a586698e1261136f3c9cffc99fbbe369b", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/28d6f58a586698e1261136f3c9cffc99fbbe369b", "committedDate": "2021-02-17T12:25:14Z", "message": "Merge branch 'master' into ServletRequestWrapper"}, "afterCommit": {"oid": "6246f5895b5e364f9578c0b081b1c748a8522c91", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/6246f5895b5e364f9578c0b081b1c748a8522c91", "committedDate": "2021-02-18T10:56:26Z", "message": "add Test that ensures existese of Super Classes\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6246f5895b5e364f9578c0b081b1c748a8522c91", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/6246f5895b5e364f9578c0b081b1c748a8522c91", "committedDate": "2021-02-18T10:56:26Z", "message": "add Test that ensures existese of Super Classes\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "c4070f7c49e20cbfeddeb254787a5b5897e367f0", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/c4070f7c49e20cbfeddeb254787a5b5897e367f0", "committedDate": "2021-02-18T10:57:35Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTkzMTA1MDA0", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-593105004", "createdAt": "2021-02-18T11:17:44Z", "commit": {"oid": "c4070f7c49e20cbfeddeb254787a5b5897e367f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xOFQxMToxNzo0NFrOIniueQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xOFQxMToxNzo0NFrOIniueQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODMzNDMyOQ==", "bodyText": "Overall I like the idea behind this PR, I just have a problem with the explicit downcast from VaadinServletResponse to HttpServletResponse with the upcoming jakarta namespace change in mind. Totally out of scope, just my 2 cents.", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r578334329", "createdAt": "2021-02-18T11:17:44Z", "author": {"login": "knoobie"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinService.java", "diffHunk": "@@ -1706,9 +1706,10 @@ protected void handleSessionExpired(VaadinRequest request,\n             SystemMessages systemMessages = getSystemMessages(\n                     HandlerHelper.findLocale(null, request), request);\n             String sessionExpiredURL = systemMessages.getSessionExpiredURL();\n+\n             if (sessionExpiredURL != null\n-                    && (response instanceof VaadinServletResponse)) {\n-                ((VaadinServletResponse) response)\n+                    && (response instanceof HttpServletResponse)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4070f7c49e20cbfeddeb254787a5b5897e367f0"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk3NzkxOTg5", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-597791989", "createdAt": "2021-02-24T18:25:01Z", "commit": {"oid": "c4070f7c49e20cbfeddeb254787a5b5897e367f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNFQxODoyNTowMVrOIrOhRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNFQxODoyNTowMVrOIrOhRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjE5NzU3Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (request instanceof HttpServletRequest&&((HttpServletRequest)request).getRequestedSessionId() == null) {\n          \n          \n            \n                        if (request instanceof HttpServletRequest && ((HttpServletRequest) request).getRequestedSessionId() == null) {\n          \n      \n    \n    \n  \n\n@stbischof This could help with your rebuild as well ;) and makes the code a little bit easier to read.", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r582197572", "createdAt": "2021-02-24T18:25:01Z", "author": {"login": "knoobie"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java", "diffHunk": "@@ -457,13 +457,13 @@ public VaadinServletService getService() {\n      * @return false if cookies are disabled, true otherwise\n      * @throws IOException\n      */\n-    private boolean ensureCookiesEnabled(VaadinServletRequest request,\n-            VaadinServletResponse response) throws IOException {\n+    private boolean ensureCookiesEnabled(VaadinRequest request,\n+            VaadinResponse response) throws IOException {\n         if (HandlerHelper.isRequestType(request, RequestType.UIDL)) {\n             // In all other but the first UIDL request a cookie should be\n             // returned by the browser.\n             // This can be removed if cookieless mode (#3228) is supported\n-            if (request.getRequestedSessionId() == null) {\n+            if (request instanceof HttpServletRequest&&((HttpServletRequest)request).getRequestedSessionId() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4070f7c49e20cbfeddeb254787a5b5897e367f0"}, "originalPosition": 121}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d8a31a6319c5e482c39bdffe4f95305258bbca3", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/5d8a31a6319c5e482c39bdffe4f95305258bbca3", "committedDate": "2021-02-24T18:26:13Z", "message": "Update flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java\n\nCo-authored-by: Knoobie <Knoobie@gmx.de>"}, "afterCommit": {"oid": "4bf814261bd477995489588f7f50d1b3852b2bf4", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/4bf814261bd477995489588f7f50d1b3852b2bf4", "committedDate": "2021-02-25T08:01:32Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk4MzIyMDM1", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-598322035", "createdAt": "2021-02-25T08:49:25Z", "commit": {"oid": "4bf814261bd477995489588f7f50d1b3852b2bf4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNVQwODo0OToyNVrOIrp9CA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNVQwODo0OToyNVrOIrp9CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjY0NzA0OA==", "bodyText": "Remove use of this unsecured \"getRequestedSessionId()\" method", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r582647048", "createdAt": "2021-02-25T08:49:25Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java", "diffHunk": "@@ -457,13 +457,13 @@ public VaadinServletService getService() {\n      * @return false if cookies are disabled, true otherwise\n      * @throws IOException\n      */\n-    private boolean ensureCookiesEnabled(VaadinServletRequest request,\n-            VaadinServletResponse response) throws IOException {\n+    private boolean ensureCookiesEnabled(VaadinRequest request,\n+            VaadinResponse response) throws IOException {\n         if (HandlerHelper.isRequestType(request, RequestType.UIDL)) {\n             // In all other but the first UIDL request a cookie should be\n             // returned by the browser.\n             // This can be removed if cookieless mode (#3228) is supported\n-            if (request.getRequestedSessionId() == null) {\n+            if (request instanceof HttpServletRequest && ((HttpServletRequest) request).getRequestedSessionId() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf814261bd477995489588f7f50d1b3852b2bf4"}, "originalPosition": 121}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "152aace6fb4aed57f307db28e3582edfc470d431", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/152aace6fb4aed57f307db28e3582edfc470d431", "committedDate": "2021-02-25T09:47:48Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bf814261bd477995489588f7f50d1b3852b2bf4", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/4bf814261bd477995489588f7f50d1b3852b2bf4", "committedDate": "2021-02-25T08:01:32Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}, "afterCommit": {"oid": "152aace6fb4aed57f307db28e3582edfc470d431", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/152aace6fb4aed57f307db28e3582edfc470d431", "committedDate": "2021-02-25T09:47:48Z", "message": "use superclass of VadinServlet/Request if possible\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjAxNTA3NjAz", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-601507603", "createdAt": "2021-03-02T07:43:09Z", "commit": {"oid": "152aace6fb4aed57f307db28e3582edfc470d431"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wMlQwNzo0MzowOVrOIuNidA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wMlQwODowNzo1OFrOIuOXYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTMyNzIyMA==", "bodyText": "Would it make sense now to keep the original cast as an alternative that will work most of the time ? Or does it require checking for the existence of the class somehow", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r585327220", "createdAt": "2021-03-02T07:43:09Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinService.java", "diffHunk": "@@ -1706,9 +1706,10 @@ protected void handleSessionExpired(VaadinRequest request,\n             SystemMessages systemMessages = getSystemMessages(\n                     HandlerHelper.findLocale(null, request), request);\n             String sessionExpiredURL = systemMessages.getSessionExpiredURL();\n+\n             if (sessionExpiredURL != null\n-                    && (response instanceof VaadinServletResponse)) {\n-                ((VaadinServletResponse) response)\n+                    && (response instanceof HttpServletResponse)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODMzNDMyOQ=="}, "originalCommit": {"oid": "c4070f7c49e20cbfeddeb254787a5b5897e367f0"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTMzOTkwMw==", "bodyText": "non-blocking nit: typoed Vaadin here and c/p the error to other method names too ...", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r585339903", "createdAt": "2021-03-02T08:06:34Z", "author": {"login": "pleku"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/OtherImplementationsTest.java", "diffHunk": "@@ -0,0 +1,205 @@\n+package com.vaadin.flow.server;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.lang.reflect.Method;\n+import java.net.URL;\n+import java.util.ArrayList;\n+import java.util.Locale;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import com.vaadin.flow.server.communication.PushRequestHandler;\n+\n+public class OtherImplementationsTest {\n+    @Test\n+    public void StaticFileServer_Constructor_uses_VadinService()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "152aace6fb4aed57f307db28e3582edfc470d431"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTM0MDc2OA==", "bodyText": "I get the test, but at a glance probably most developers will not. Please change the name to CustomVaadinServiceImplementationTest and maybe add a comment line \"Makes sure that a custom vaadin service that is not vaadin servlet service can be used in when desired\".", "url": "https://github.com/vaadin/flow/pull/9699#discussion_r585340768", "createdAt": "2021-03-02T08:07:58Z", "author": {"login": "pleku"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/OtherImplementationsTest.java", "diffHunk": "@@ -0,0 +1,205 @@\n+package com.vaadin.flow.server;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.lang.reflect.Method;\n+import java.net.URL;\n+import java.util.ArrayList;\n+import java.util.Locale;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import com.vaadin.flow.server.communication.PushRequestHandler;\n+\n+public class OtherImplementationsTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "152aace6fb4aed57f307db28e3582edfc470d431"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f7a35c4fd6115e799c051dfc066345479dfc566", "author": {"user": {"login": "stbischof", "name": "Stefan Bischof"}}, "url": "https://github.com/vaadin/flow/commit/9f7a35c4fd6115e799c051dfc066345479dfc566", "committedDate": "2021-03-02T14:55:02Z", "message": "Review fixes\n\nSigned-off-by: Stefan Bischof <stbischof@bipolis.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjAzODA2MTUz", "url": "https://github.com/vaadin/flow/pull/9699#pullrequestreview-603806153", "createdAt": "2021-03-04T08:06:47Z", "commit": {"oid": "9f7a35c4fd6115e799c051dfc066345479dfc566"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 805, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}