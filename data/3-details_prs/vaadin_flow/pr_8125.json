{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2OTI0NDUx", "number": 8125, "title": "Push browser history state after postponed navigation proceeds", "bodyText": "Part of #3619, fix items 1 and 2 from #3619 (comment)\n\nPush browser history state after navigation is certain because in case\nof postpone the URL in the address bar is changed too early and the\nnavigation process might not proceed\nRemove adding to history state from RouterLinkHandler as the\nserver-side does the same job at the correct time\n\n\n\nThis change is\u2002", "createdAt": "2020-04-21T21:42:43Z", "url": "https://github.com/vaadin/flow/pull/8125", "merged": true, "mergeCommit": {"oid": "0077f9f61dde1cdf9eb70f58235271df72091a69"}, "closed": true, "closedAt": "2020-05-06T05:57:00Z", "author": {"login": "mehdi-vaadin"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ6pXgAH2gAyNDA2OTI0NDUxOjEwYWY2ZDM3MTgxMmIzMGE1NDM4NzdkZTZlOTIxNjMyMWUyYjk1OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceiNRqgFqTQwNjMxOTMyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "10af6d371812b30a543877de6e9216321e2b9598", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/10af6d371812b30a543877de6e9216321e2b9598", "committedDate": "2020-04-21T21:33:52Z", "message": "* Push browser history state after navigation is certain because in case\nof postpone the url in the address bar is changed too early and the\nnavigation process might not proceed\n* Remove adding to history state from RouterLinkHandler as the\nserver-side does the same job at the correct time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e7da542a1d0e14023892cfe9f6f596cab8eb870", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/5e7da542a1d0e14023892cfe9f6f596cab8eb870", "committedDate": "2020-04-21T21:34:09Z", "message": "Merge remote-tracking branch 'origin/2.1' into 2.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c3a59e21bcf72f13926275d50001231055f01f2", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/7c3a59e21bcf72f13926275d50001231055f01f2", "committedDate": "2020-04-22T15:52:33Z", "message": "Push the browser history state in ApplicationRunnerServlet.Router in\ntest-root-ui-context as it's not done in RouterLinkHandler anymore"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjYzMDY4", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-399663068", "createdAt": "2020-04-24T06:07:41Z", "commit": {"oid": "7c3a59e21bcf72f13926275d50001231055f01f2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwNjowNzo0MVrOGLH_Ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwNjowNzo0MVrOGLH_Ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDMxODM5NQ==", "bodyText": "In InternalRedirectHandler there's a replaceState. I think that should be replaced by pushState as well.", "url": "https://github.com/vaadin/flow/pull/8125#discussion_r414318395", "createdAt": "2020-04-24T06:07:41Z", "author": {"login": "bogdanudrescu"}, "path": "flow-server/src/main/java/com/vaadin/flow/router/internal/AbstractNavigationStateRenderer.java", "diffHunk": "@@ -180,6 +180,16 @@ public int handle(NavigationEvent event) {\n             }\n         }\n \n+        if (!ui.getInternals().hasLastHandledLocation()\n+                || !event.getLocation().getPathWithQueryParameters()\n+                .equals(ui.getInternals().getLastHandledLocation()\n+                        .getPathWithQueryParameters())) {\n+            // Enable navigating back\n+            ui.getPage().getHistory().pushState(null, event.getLocation());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c3a59e21bcf72f13926275d50001231055f01f2"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2844153e7baeed07fd1cb62d78ba7631fee5b2db", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/2844153e7baeed07fd1cb62d78ba7631fee5b2db", "committedDate": "2020-04-29T00:26:17Z", "message": "Call ScrollPositionHandler.afterNavigation after the navigation is done\nin server-side for RouterLinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2779255410383dee435cebe9166defddd933809", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/e2779255410383dee435cebe9166defddd933809", "committedDate": "2020-04-29T01:26:31Z", "message": "* Fix RouterTest\n* Pass the navigation state to ErrorNavigationEvent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c788979f8c8ad74fff4c10c442bc1ff23c0eae82", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/c788979f8c8ad74fff4c10c442bc1ff23c0eae82", "committedDate": "2020-04-29T06:17:55Z", "message": "Revert changes in flow-client/pom.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e618c37fb35bcaf81609b3d7629a6ee8936f7fcd", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/e618c37fb35bcaf81609b3d7629a6ee8936f7fcd", "committedDate": "2020-04-29T08:30:08Z", "message": "* Fix RouterSessionExpirationIT failure\n* Fix sonar issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92fe2fcd8e039faa98adba6439c7e6da90519cbf", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/92fe2fcd8e039faa98adba6439c7e6da90519cbf", "committedDate": "2020-04-29T10:18:59Z", "message": "Add tests for the case when there is a gap between postpone and proceed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b115c2eb2624bf08012799efaabf5b061df5f305", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/b115c2eb2624bf08012799efaabf5b061df5f305", "committedDate": "2020-04-29T10:30:52Z", "message": "Fix RouterLinksIT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMzM1NzQ4", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-403335748", "createdAt": "2020-04-30T09:05:50Z", "commit": {"oid": "b115c2eb2624bf08012799efaabf5b061df5f305"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13baac0bf32e581b734556a612abf8c7548e5c31", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/13baac0bf32e581b734556a612abf8c7548e5c31", "committedDate": "2020-04-30T12:55:50Z", "message": "Address review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNDkxODMw", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-403491830", "createdAt": "2020-04-30T12:56:37Z", "commit": {"oid": "13baac0bf32e581b734556a612abf8c7548e5c31"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d198e269faf40343de1f6a2fd55f343a1708eb0", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/0d198e269faf40343de1f6a2fd55f343a1708eb0", "committedDate": "2020-04-30T13:52:43Z", "message": "Prevent pushing history state if\nRouter::navigate(UI, Location, NavigationTrigger) is called"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNTQzMjU4", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-403543258", "createdAt": "2020-04-30T13:54:43Z", "commit": {"oid": "0d198e269faf40343de1f6a2fd55f343a1708eb0"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a97723e6f7fc124b50a2853c28ac493f07206cd", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/0a97723e6f7fc124b50a2853c28ac493f07206cd", "committedDate": "2020-05-04T06:37:12Z", "message": "Add tests to NavigationStateRendererTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NzM0Nzk3", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-404734797", "createdAt": "2020-05-04T06:37:20Z", "commit": {"oid": "0d198e269faf40343de1f6a2fd55f343a1708eb0"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODcwMzIw", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-404870320", "createdAt": "2020-05-04T10:30:46Z", "commit": {"oid": "0a97723e6f7fc124b50a2853c28ac493f07206cd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODc3MDYw", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-404877060", "createdAt": "2020-05-04T10:42:50Z", "commit": {"oid": "0a97723e6f7fc124b50a2853c28ac493f07206cd"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7393d6c6ae23c1e1e204b22e89464acc8aa99a1", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/c7393d6c6ae23c1e1e204b22e89464acc8aa99a1", "committedDate": "2020-05-05T04:35:56Z", "message": "* Add UI_NAVIGATE to NavigationTrigger enum to distinguish navigations\ntriggered from UI.navigate\n* Apply more changes after review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NTI0NzEw", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-405524710", "createdAt": "2020-05-05T06:38:31Z", "commit": {"oid": "c7393d6c6ae23c1e1e204b22e89464acc8aa99a1"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9675152309d8cfeb6ddfcea40bb336be2e55949c", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/9675152309d8cfeb6ddfcea40bb336be2e55949c", "committedDate": "2020-05-05T08:06:53Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NjU1NDE5", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-405655419", "createdAt": "2020-05-05T10:12:39Z", "commit": {"oid": "9675152309d8cfeb6ddfcea40bb336be2e55949c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NjU5NzA0", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-405659704", "createdAt": "2020-05-05T10:19:46Z", "commit": {"oid": "9675152309d8cfeb6ddfcea40bb336be2e55949c"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NjcyNjA3", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-405672607", "createdAt": "2020-05-05T10:41:15Z", "commit": {"oid": "9675152309d8cfeb6ddfcea40bb336be2e55949c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae41e6581a60adeec18802216f697e94aaf97432", "author": {"user": {"login": "mehdi-vaadin", "name": "Mehdi Javan"}}, "url": "https://github.com/vaadin/flow/commit/ae41e6581a60adeec18802216f697e94aaf97432", "committedDate": "2020-05-05T14:51:12Z", "message": "Apply changes after review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1ODY3MjAz", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-405867203", "createdAt": "2020-05-05T14:51:23Z", "commit": {"oid": "9675152309d8cfeb6ddfcea40bb336be2e55949c"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1ODY4MjIw", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-405868220", "createdAt": "2020-05-05T14:52:27Z", "commit": {"oid": "ae41e6581a60adeec18802216f697e94aaf97432"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MzEyODE3", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-406312817", "createdAt": "2020-05-06T05:32:28Z", "commit": {"oid": "ae41e6581a60adeec18802216f697e94aaf97432"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MzE5MzI0", "url": "https://github.com/vaadin/flow/pull/8125#pullrequestreview-406319324", "createdAt": "2020-05-06T05:55:05Z", "commit": {"oid": "ae41e6581a60adeec18802216f697e94aaf97432"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 573, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}