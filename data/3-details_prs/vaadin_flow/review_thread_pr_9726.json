{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1OTkwNjU3", "number": 9726, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyN1rOFJenXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMToxOToxOFrOFJgJ-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTAzOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DefaultApplicationConfigurationFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyN1rOIL1J4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyN1rOIL1J4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjEyOA==", "bodyText": "Define a constant instead of duplicating this literal \"jar!/\" 3 times.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276128", "createdAt": "2020-12-28T09:22:27Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/DefaultApplicationConfigurationFactory.java", "diffHunk": "@@ -0,0 +1,246 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.startup;\n+\n+import java.io.IOException;\n+import java.io.UncheckedIOException;\n+import java.net.URL;\n+import java.util.Collections;\n+import java.util.Enumeration;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+import org.osgi.framework.Constants;\n+import org.osgi.service.component.annotations.Component;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.di.Lookup;\n+import com.vaadin.flow.di.ResourceProvider;\n+import com.vaadin.flow.server.AbstractPropertyConfiguration;\n+import com.vaadin.flow.server.VaadinContext;\n+import com.vaadin.flow.server.frontend.FallbackChunk;\n+import com.vaadin.flow.server.frontend.FrontendUtils;\n+\n+import elemental.json.JsonObject;\n+import elemental.json.impl.JsonUtil;\n+\n+import static com.vaadin.flow.server.Constants.VAADIN_SERVLET_RESOURCES;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_PRODUCTION_MODE;\n+import static com.vaadin.flow.server.frontend.FrontendUtils.TOKEN_FILE;\n+\n+/**\n+ * Default implementation of {@link ApplicationConfigurationFactory}.\n+ * \n+ * @author Vaadin Ltd\n+ * @since\n+ *\n+ */\n+@Component(service = ApplicationConfigurationFactory.class, property = Constants.SERVICE_RANKING\n+        + \":Integer=\" + Integer.MIN_VALUE)\n+public class DefaultApplicationConfigurationFactory\n+        extends AbstractConfigurationFactory\n+        implements ApplicationConfigurationFactory {\n+\n+    protected static class ApplicationConfigurationImpl extends\n+            AbstractPropertyConfiguration implements ApplicationConfiguration {\n+\n+        private final VaadinContext context;\n+\n+        private final FallbackChunk fallbackChunk;\n+\n+        protected ApplicationConfigurationImpl(VaadinContext context,\n+                FallbackChunk fallbackChunk, Map<String, String> properties) {\n+            super(properties);\n+            this.context = context;\n+            this.fallbackChunk = fallbackChunk;\n+        }\n+\n+        @Override\n+        public boolean isProductionMode() {\n+            return getBooleanProperty(SERVLET_PARAMETER_PRODUCTION_MODE, false);\n+        }\n+\n+        @Override\n+        public Enumeration<String> getPropertyNames() {\n+            return Collections.enumeration(getProperties().keySet());\n+        }\n+\n+        @Override\n+        public VaadinContext getContext() {\n+            return context;\n+        }\n+\n+        @Override\n+        public FallbackChunk getFallbackChunk() {\n+            return fallbackChunk;\n+        }\n+\n+    }\n+\n+    @Override\n+    public ApplicationConfiguration create(VaadinContext context) {\n+        Objects.requireNonNull(context);\n+        Map<String, String> props = new HashMap<>();\n+        for (final Enumeration<String> paramNames = context\n+                .getContextParameterNames(); paramNames.hasMoreElements();) {\n+            final String name = paramNames.nextElement();\n+            props.put(name, context.getContextParameter(name));\n+        }\n+        JsonObject buildInfo = null;\n+        try {\n+            String content = getTokenFileContent(props::get);\n+            if (content == null) {\n+                content = getTokenFileFromClassloader(context);\n+            }\n+            buildInfo = content == null ? null : JsonUtil.parse(content);\n+            if (buildInfo != null) {\n+                props.putAll(getConfigParametersUsingTokenData(buildInfo));\n+            }\n+        } catch (IOException exception) {\n+            throw new UncheckedIOException(exception);\n+        }\n+        return doCreate(context, buildInfo == null ? null\n+                : FrontendUtils.readFallbackChunk(buildInfo), props);\n+    }\n+\n+    /**\n+     * Creates application configuration instance based on provided data.\n+     * \n+     * @param context\n+     *            the Vaadin context, not {@code null}\n+     * @param chunk\n+     *            the fallback chunk, may be {@code null}\n+     * @param properties\n+     *            the context parameters, not {@code null}\n+     * @return a new application configuration instance\n+     */\n+    protected ApplicationConfigurationImpl doCreate(VaadinContext context,\n+            FallbackChunk chunk, Map<String, String> properties) {\n+        Objects.requireNonNull(context);\n+        Objects.requireNonNull(properties);\n+        return new ApplicationConfigurationImpl(context, chunk, properties);\n+    }\n+\n+    /**\n+     * Gets token file from the classpath using the provided {@code context}.\n+     * <p>\n+     * The {@code contextClass} may be a class which is defined in the Web\n+     * Application module/bundle and in this case it may be used to get Web\n+     * Application resources. Also a {@link VaadinContext} {@code context}\n+     * instance may be used to get a context of the Web Application (since the\n+     * {@code contextClass} may be a class not from Web Application module). In\n+     * WAR case it doesn't matter which class is used to get the resources (Web\n+     * Application classes or e.g. \"flow-server\" classes) since they are loaded\n+     * by the same {@link ClassLoader}. But in OSGi \"flow-server\" module classes\n+     * can't be used to get Web Application resources since they are in\n+     * different bundles.\n+     * \n+     * @param context\n+     *            a VaadinContext which may provide information how to get token\n+     *            file for the web application\n+     * @return the token file content\n+     * @throws IOException\n+     *             if I/O fails during access to the token file\n+     */\n+    protected String getTokenFileFromClassloader(VaadinContext context)\n+            throws IOException {\n+        String tokenResource = VAADIN_SERVLET_RESOURCES + TOKEN_FILE;\n+\n+        Lookup lookup = context.getAttribute(Lookup.class);\n+        ResourceProvider resourceProvider = lookup\n+                .lookup(ResourceProvider.class);\n+\n+        List<URL> resources = resourceProvider\n+                .getApplicationResources(tokenResource);\n+\n+        // Accept resource that doesn't contain\n+        // 'jar!/META-INF/Vaadin/config/flow-build-info.json'\n+        URL resource = resources.stream()\n+                .filter(url -> !url.getPath().endsWith(\"jar!/\" + tokenResource))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 175}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTA4OnYy", "diffSide": "RIGHT", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/CompositeDataGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyOFrOIL1J5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyOFrOIL1J5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjEzNQ==", "bodyText": "Make \"dataGenerators\" private or transient.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276135", "createdAt": "2020-12-28T09:22:28Z", "author": {"login": "vaadin-bot"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/CompositeDataGenerator.java", "diffHunk": "@@ -39,7 +39,7 @@\n public class CompositeDataGenerator<T>\n         implements DataGenerator<T>, HasDataGenerators<T> {\n \n-    private final Set<DataGenerator<T>> dataGenerators = new HashSet<>();\n+    final Set<DataGenerator<T>> dataGenerators = new LinkedHashSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTEzOnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/connect/VaadinConnectController.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyOVrOIL1J7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjoyOVrOIL1J7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE0MA==", "bodyText": "Remove this use of \"APPLICATION_JSON_UTF8_VALUE\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276140", "createdAt": "2020-12-28T09:22:29Z", "author": {"login": "vaadin-bot"}, "path": "fusion-endpoint/src/main/java/com/vaadin/flow/server/connect/VaadinConnectController.java", "diffHunk": "@@ -249,8 +239,7 @@ void validateEndpointBean(EndpointNameChecker endpointNameChecker,\n      *            the current request which triggers the endpoint call\n      * @return execution result as a JSON string or an error message string\n      */\n-    @PostMapping(path = \"/{endpoint}/{method}\", produces =\n-            MediaType.APPLICATION_JSON_UTF8_VALUE)\n+    @PostMapping(path = \"/{endpoint}/{method}\", produces = MediaType.APPLICATION_JSON_UTF8_VALUE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 169}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTE3OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/AbstractConfigurationFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMFrOIL1J8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMFrOIL1J8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE0NQ==", "bodyText": "Refactor this method to reduce its Cognitive Complexity from 18 to the 15 allowed.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276145", "createdAt": "2020-12-28T09:22:30Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/AbstractConfigurationFactory.java", "diffHunk": "@@ -0,0 +1,238 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server.startup;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.Serializable;\n+import java.io.UncheckedIOException;\n+import java.nio.charset.StandardCharsets;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.function.Function;\n+\n+import org.apache.commons.io.FileUtils;\n+\n+import com.vaadin.flow.server.InitParameters;\n+import com.vaadin.flow.server.frontend.FrontendUtils;\n+\n+import elemental.json.JsonObject;\n+\n+import static com.vaadin.flow.server.Constants.CONNECT_APPLICATION_PROPERTIES_TOKEN;\n+import static com.vaadin.flow.server.Constants.CONNECT_GENERATED_TS_DIR_TOKEN;\n+import static com.vaadin.flow.server.Constants.CONNECT_JAVA_SOURCE_FOLDER_TOKEN;\n+import static com.vaadin.flow.server.Constants.CONNECT_OPEN_API_FILE_TOKEN;\n+import static com.vaadin.flow.server.Constants.EXTERNAL_STATS_FILE;\n+import static com.vaadin.flow.server.Constants.EXTERNAL_STATS_FILE_TOKEN;\n+import static com.vaadin.flow.server.Constants.EXTERNAL_STATS_URL;\n+import static com.vaadin.flow.server.Constants.EXTERNAL_STATS_URL_TOKEN;\n+import static com.vaadin.flow.server.Constants.FRONTEND_TOKEN;\n+import static com.vaadin.flow.server.Constants.NPM_TOKEN;\n+import static com.vaadin.flow.server.Constants.VAADIN_PREFIX;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_ENABLE_DEV_SERVER;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_INITIAL_UIDL;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_PRODUCTION_MODE;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_REUSE_DEV_SERVER;\n+import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_USE_V14_BOOTSTRAP;\n+import static com.vaadin.flow.server.frontend.FrontendUtils.PROJECT_BASEDIR;\n+\n+/**\n+ * A configuration factory base logic which reads the token file.\n+ * \n+ * @author Vaadin Ltd\n+ * @since\n+ *\n+ */\n+public class AbstractConfigurationFactory implements Serializable {\n+\n+    public static final String DEV_FOLDER_MISSING_MESSAGE = \"Running project in development mode with no access to folder '%s'.%n\"\n+            + \"Build project in production mode instead, see https://vaadin.com/docs/v15/flow/production/tutorial-production-mode-basic.html\";\n+\n+    /**\n+     * Returns the config parameters from the token file data {@code buildInfo}.\n+     * \n+     * @param buildInfo\n+     *            the token file data\n+     * @return the config parameters\n+     */\n+    protected Map<String, String> getConfigParametersUsingTokenData(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTIxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/LookupInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMFrOIL1J9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMFrOIL1J9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE0OQ==", "bodyText": "Remove this use of \"DeprecatedPolymerPublishedEventHandler\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276149", "createdAt": "2020-12-28T09:22:30Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/startup/LookupInitializer.java", "diffHunk": "@@ -58,7 +57,8 @@\n  */\n @HandlesTypes({ ResourceProvider.class, InstantiatorFactory.class,\n         DeprecatedPolymerPublishedEventHandler.class,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTI1OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMVrOIL1J-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMVrOIL1J-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE1NQ==", "bodyText": "Remove the declaration of thrown exception 'javax.servlet.ServletException', as it cannot be thrown from method's body.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276155", "createdAt": "2020-12-28T09:22:31Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/VaadinServlet.java", "diffHunk": "@@ -180,14 +181,10 @@ public static VaadinServlet getCurrent() {\n      */\n     protected DeploymentConfiguration createDeploymentConfiguration()\n             throws ServletException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTI3OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/PropertyDeploymentConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMlrOIL1J_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozMlrOIL1J_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE1OA==", "bodyText": "First sentence of Javadoc is incomplete (period is missing) or not present.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276158", "createdAt": "2020-12-28T09:22:32Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/PropertyDeploymentConfiguration.java", "diffHunk": "@@ -215,8 +244,64 @@ public Properties getInitParameters() {\n      */\n     @Override\n     public boolean isDevModeLiveReloadEnabled() {\n-        return !isProductionMode() && getBooleanProperty(\n-                SERVLET_PARAMETER_DEVMODE_ENABLE_LIVE_RELOAD, true)\n+        return !isProductionMode()\n+                && getBooleanProperty(\n+                        SERVLET_PARAMETER_DEVMODE_ENABLE_LIVE_RELOAD, true)\n                 && enableDevServer(); // gizmo excluded from prod bundle\n     }\n+\n+    /**\n+     * Checks whether the given {@code property} is the property explicitly set\n+     * in this deployment configuration (not in it's parent config).\n+     * <p>\n+     * The deployment configuration consists of properties defined in the\n+     * configuration itself and properties which are coming from the application\n+     * configuration. The properties which are defined in the deployment\n+     * configuration itself (own properties) should take precedence: their\n+     * values should override the parent config properties values.\n+     * \n+     * @param property\n+     *            a property name\n+     * @return whether the {@code property} is explicitly set in the\n+     *         configuration\n+     */\n+    protected boolean isOwnProperty(String property) {\n+        return getApplicationProperty(getProperties()::get, property) != null;\n+    }\n+\n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 224}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTMxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozM1rOIL1KAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozM1rOIL1KAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE2Mg==", "bodyText": "A \"NullPointerException\" could be thrown; \"frontendDependencies\" is nullable here.", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276162", "createdAt": "2020-12-28T09:22:33Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -605,7 +605,8 @@ private NodeTasks(Builder builder) {\n                             builder.tokenFileData, builder.enablePnpm));\n \n             commands.add(new TaskUpdateThemeImport(builder.npmFolder,\n-                frontendDependencies.getThemeDefinition()));\n+                frontendDependencies.getThemeDefinition(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDgzMTM2OnYy", "diffSide": "RIGHT", "path": "fusion-endpoint/src/test/java/com/vaadin/flow/server/startup/fusion/DevModeInitializerEndpointTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozNFrOIL1KCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwOToyMjozNFrOIL1KCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3NjE3MA==", "bodyText": "Remove this use of \"Thread.sleep()\".", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549276170", "createdAt": "2020-12-28T09:22:34Z", "author": {"login": "vaadin-bot"}, "path": "fusion-endpoint/src/test/java/com/vaadin/flow/server/startup/fusion/DevModeInitializerEndpointTest.java", "diffHunk": "@@ -128,105 +132,61 @@ public void teardown() throws Exception, SecurityException {\n     @Test\n     public void should_generateOpenApi_when_EndpointPresents()\n             throws Exception {\n-        String originalJavaSourceFolder = null;\n         File generatedOpenApiJson = Paths\n-                    .get(baseDir, DEFAULT_CONNECT_OPENAPI_JSON_FILE).toFile();\n-        try {\n-            originalJavaSourceFolder = System.getProperty(\"vaadin.\" \n-                + CONNECT_JAVA_SOURCE_FOLDER_TOKEN);\n-            // Configure a folder that has .java classes with valid endpoints\n-            // Not using `src/test/java` because there are invalid endpoint names\n-            // in some tests\n-            File src = new File(\n-                    getClass().getClassLoader().getResource(\"java\").getFile());\n-            System.setProperty(\"vaadin.\" + CONNECT_JAVA_SOURCE_FOLDER_TOKEN,\n-                    src.getAbsolutePath());\n-\n-            Assert.assertFalse(generatedOpenApiJson.exists());\n-            DevModeInitializer devModeInitializer = new DevModeInitializer();\n-            devModeInitializer.onStartup(classes, servletContext);\n-            waitForDevModeServer();\n-            Thread.sleep(200);\n-            Assert.assertTrue(\"Should generate OpenAPI spec if Endpoint is used.\",\n-                    generatedOpenApiJson.exists());\n-        } finally {\n-            if (originalJavaSourceFolder != null) {\n-                System.setProperty(\"vaadin.\" \n-                    + CONNECT_JAVA_SOURCE_FOLDER_TOKEN, originalJavaSourceFolder);\n-            } else {\n-                System.clearProperty(\"vaadin.\" \n-                    + CONNECT_JAVA_SOURCE_FOLDER_TOKEN);\n-            }\n-            generatedOpenApiJson.delete();\n-        }\n+                .get(baseDir, DEFAULT_CONNECT_OPENAPI_JSON_FILE).toFile();\n+        File src = new File(\n+                getClass().getClassLoader().getResource(\"java\").getFile());\n+        Mockito.when(appConfig.getStringProperty(\n+                Mockito.eq(CONNECT_JAVA_SOURCE_FOLDER_TOKEN),\n+                Mockito.anyString())).thenReturn(src.getAbsolutePath());\n+\n+        Assert.assertFalse(generatedOpenApiJson.exists());\n+        DevModeInitializer devModeInitializer = new DevModeInitializer();\n+        devModeInitializer.process(classes, servletContext);\n+        waitForDevModeServer();\n+        Thread.sleep(200);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 160}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NTA4MzQ2OnYy", "diffSide": "RIGHT", "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMToxOToxOFrOIL3UVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMToxOToxOFrOIL3UVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMxMTU3NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import static org.mockito.Mockito.times;;\n          \n          \n            \n            import static org.mockito.Mockito.times;", "url": "https://github.com/vaadin/flow/pull/9726#discussion_r549311574", "createdAt": "2020-12-28T11:19:18Z", "author": {"login": "mshabarov"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/startup/DevModeInitializerTest.java", "diffHunk": "@@ -43,18 +42,16 @@\n import com.vaadin.flow.server.frontend.FallbackChunk;\n import com.vaadin.flow.server.frontend.FrontendUtils;\n \n-import static com.vaadin.flow.server.Constants.CONNECT_JAVA_SOURCE_FOLDER_TOKEN;\n import static com.vaadin.flow.server.Constants.COMPATIBILITY_RESOURCES_FRONTEND_DEFAULT;\n+import static com.vaadin.flow.server.Constants.CONNECT_JAVA_SOURCE_FOLDER_TOKEN;\n import static com.vaadin.flow.server.Constants.RESOURCES_FRONTEND_DEFAULT;\n-import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_PRODUCTION_MODE;\n-import static com.vaadin.flow.server.InitParameters.SERVLET_PARAMETER_REUSE_DEV_SERVER;\n import static com.vaadin.flow.server.frontend.FrontendUtils.DEFAULT_CONNECT_OPENAPI_JSON_FILE;\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertNotNull;\n import static org.junit.Assert.assertNull;\n import static org.junit.Assert.assertTrue;\n-import static org.mockito.Mockito.times;\n-import static org.mockito.Mockito.never;;\n+import static org.mockito.Mockito.never;\n+import static org.mockito.Mockito.times;;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3d0bc992eb4c6a2f049afede248a5c51330a928"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3804, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}