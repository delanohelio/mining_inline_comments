{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1OTQ2MTE2", "number": 8111, "title": "Be aware of skinny war workaround in OSGi support", "bodyText": "Was not tested in 2.2  because OSGi is completely broken (#8109).\nFixes #8105\n\n\nThis change is\u2002", "createdAt": "2020-04-20T09:38:04Z", "url": "https://github.com/vaadin/flow/pull/8111", "merged": true, "mergeCommit": {"oid": "56a5af98bd2eed715d8b1982fcd04b6f526f9431"}, "closed": true, "closedAt": "2020-04-21T09:15:47Z", "author": {"login": "denis-anisimov"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZa0IsAH2gAyNDA1OTQ2MTE2OmJmNzExZWRhN2JlZjU0NGMwZTMzYmFiNDkzMzU2MDVmNjMyM2JiYzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZwEp7gFqTM5NzE0MTMwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bf711eda7bef544c0e33bab49335605f6323bbc5", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/bf711eda7bef544c0e33bab49335605f6323bbc5", "committedDate": "2020-04-20T08:28:40Z", "message": "Be aware of skinny war workaround in OSGi support\n\nFixes #8105"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MzAyMzI3", "url": "https://github.com/vaadin/flow/pull/8111#pullrequestreview-396302327", "createdAt": "2020-04-20T09:48:10Z", "commit": {"oid": "bf711eda7bef544c0e33bab49335605f6323bbc5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQwOTo0ODoxMFrOGIMTHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQwOTo0ODoxMFrOGIMTHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI0MzI5NA==", "bodyText": "Define and throw a dedicated exception instead of using a generic one.", "url": "https://github.com/vaadin/flow/pull/8111#discussion_r411243294", "createdAt": "2020-04-20T09:48:10Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/osgi/OSGiAccess.java", "diffHunk": "@@ -202,8 +202,17 @@ private void resetContextInitializers() {\n     private void handleTypes(ServletContainerInitializer initializer) {\n         Optional<HandlesTypes> handleTypes = AnnotationReader\n                 .getAnnotationFor(initializer.getClass(), HandlesTypes.class);\n+        /*\n+         * Every initializer should be an instance of\n+         * ClassLoaderAwareServletContainerInitializer : there is a test which\n+         * forces this. So assert should be enough here.\n+         */\n+        assert initializer instanceof ClassLoaderAwareServletContainerInitializer;\n         try {\n-            initializer.onStartup(filterClasses(handleTypes.orElse(null)),\n+            // don't use onStartup method because a fake servlet context is\n+            // passed here: no need to detect classloaders in OSGi case\n+            ((ClassLoaderAwareServletContainerInitializer) initializer).process(\n+                    filterClasses(handleTypes.orElse(null)),\n                     getOsgiServletContext());\n         } catch (ServletException e) {\n             throw new RuntimeException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf711eda7bef544c0e33bab49335605f6323bbc5"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MzQxNDQx", "url": "https://github.com/vaadin/flow/pull/8111#pullrequestreview-396341441", "createdAt": "2020-04-20T10:46:29Z", "commit": {"oid": "bf711eda7bef544c0e33bab49335605f6323bbc5"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2OTY5Mzk0", "url": "https://github.com/vaadin/flow/pull/8111#pullrequestreview-396969394", "createdAt": "2020-04-21T03:56:06Z", "commit": {"oid": "bf711eda7bef544c0e33bab49335605f6323bbc5"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2OTg4MTA0", "url": "https://github.com/vaadin/flow/pull/8111#pullrequestreview-396988104", "createdAt": "2020-04-21T05:01:23Z", "commit": {"oid": "bf711eda7bef544c0e33bab49335605f6323bbc5"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d469da0433544fc6e699dad87a6572913b55879", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/5d469da0433544fc6e699dad87a6572913b55879", "committedDate": "2020-04-21T05:40:51Z", "message": "Enable OSGi support for 2.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d0c909412a9a8c1ed1f30988c5eca977e0fe8ea", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/1d0c909412a9a8c1ed1f30988c5eca977e0fe8ea", "committedDate": "2020-04-21T07:36:15Z", "message": "Reset the code back"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "240c1b2eae5d9a6da43ec7a58bd4215baebf3dd2", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/240c1b2eae5d9a6da43ec7a58bd4215baebf3dd2", "committedDate": "2020-04-21T07:38:14Z", "message": "Format extra dependency to OSGi test module"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MDY1MzYz", "url": "https://github.com/vaadin/flow/pull/8111#pullrequestreview-397065363", "createdAt": "2020-04-21T07:38:48Z", "commit": {"oid": "240c1b2eae5d9a6da43ec7a58bd4215baebf3dd2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MTQxMzA5", "url": "https://github.com/vaadin/flow/pull/8111#pullrequestreview-397141309", "createdAt": "2020-04-21T09:14:43Z", "commit": {"oid": "240c1b2eae5d9a6da43ec7a58bd4215baebf3dd2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 572, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}