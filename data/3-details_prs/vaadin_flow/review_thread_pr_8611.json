{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MDk1NzQz", "number": 8611, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QxNzowNDoxNFrOEJXUkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToyOTozN1rOEJnTgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4MjU0NzM4OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QxNzowNDoxNFrOGp2_nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QxNzowNDoxNFrOGp2_nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU0NTgyMQ==", "bodyText": "task.nodeVersion = builder.nodeVersion;\ntask.nodeDownloadRoot = builder.nodeDownloadRoot;\n\nI think this approach is not good.\nAs I understand there is no any other usage of \"absent setters\" for nodeVersion  and nodeDownloadRoot.\nSo I don't see any reason do not use CTOR with extended parameters.\nSetters may be called at any time which mutates the state of the object. As a result it adds some additional semantic to the usage.\nParameters in the CTOR may not be changed once the instance is constructed.\nIt allow to eliminate any confusion.\nI'm pretty sure that CTOR parameters should work here better than setters.", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r446545821", "createdAt": "2020-06-27T17:04:14Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -496,8 +513,12 @@ private NodeTasks(Builder builder) {\n             commands.add(packageUpdater);\n \n             if (builder.runNpmInstall) {\n-                commands.add(new TaskRunNpmInstall(classFinder, packageUpdater,\n-                        builder.enablePnpm, builder.requireHomeNodeExec));\n+                final TaskRunNpmInstall task = new TaskRunNpmInstall(\n+                        classFinder, packageUpdater,\n+                        builder.enablePnpm, builder.requireHomeNodeExec);\n+                task.nodeVersion = builder.nodeVersion;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "205c9a30b52813dac82e6007b1999b430db527fc"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4MjU0ODQ2OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QxNzowNToxMFrOGp3AHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwNTo1NzowNVrOGqsz3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU0NTk0OA==", "bodyText": "CTOR parameters please.", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r446545948", "createdAt": "2020-06-27T17:05:10Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -306,6 +323,10 @@ private void runNpmInstall() throws ExecutionFailedException {\n \n         FrontendTools tools = new FrontendTools(baseDir,\n                 () -> FrontendUtils.getVaadinHomeDirectory().getAbsolutePath());\n+        if (nodeVersion != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "205c9a30b52813dac82e6007b1999b430db527fc"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4MjQ3MQ==", "bodyText": "Adding ctor parameters is a backward-incompatible change and will make the Gradle plugin fail to work. I propose to continue with properties, which also the benefit of having default values.", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r446882471", "createdAt": "2020-06-29T10:08:39Z", "author": {"login": "mvysny"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -306,6 +323,10 @@ private void runNpmInstall() throws ExecutionFailedException {\n \n         FrontendTools tools = new FrontendTools(baseDir,\n                 () -> FrontendUtils.getVaadinHomeDirectory().getAbsolutePath());\n+        if (nodeVersion != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU0NTk0OA=="}, "originalCommit": {"oid": "205c9a30b52813dac82e6007b1999b430db527fc"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg5Nzg2OA==", "bodyText": "I'm as a Flow developer not aware of Gradle.\nIt seems this is reversion of responsibility....\nAs a result I may imagine a situation when I decide to introduce a new parameter in any CTOR of internal class (being not aware of any third party usage).\nBackward compatibility doesn't matter for internal classes.  This is an internal class.\nI suggest to add one more CTOR in that case at least.\nMutability in this case is excessive and may introduce issues in code evolution.", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r446897868", "createdAt": "2020-06-29T11:28:12Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -306,6 +323,10 @@ private void runNpmInstall() throws ExecutionFailedException {\n \n         FrontendTools tools = new FrontendTools(baseDir,\n                 () -> FrontendUtils.getVaadinHomeDirectory().getAbsolutePath());\n+        if (nodeVersion != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU0NTk0OA=="}, "originalCommit": {"oid": "205c9a30b52813dac82e6007b1999b430db527fc"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQyNzU0OQ==", "bodyText": "The API might be internal with respect of regular Vaadin apps, but both the Maven plugin and the Gradle plugins are using the API (and the API is intended to be used by those plugins), which implies that the API is external with respect to Maven and Gradle plugins.\nI've added an overloaded constructor.", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r447427549", "createdAt": "2020-06-30T05:57:05Z", "author": {"login": "mvysny"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -306,6 +323,10 @@ private void runNpmInstall() throws ExecutionFailedException {\n \n         FrontendTools tools = new FrontendTools(baseDir,\n                 () -> FrontendUtils.getVaadinHomeDirectory().getAbsolutePath());\n+        if (nodeVersion != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU0NTk0OA=="}, "originalCommit": {"oid": "205c9a30b52813dac82e6007b1999b430db527fc"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NTE2NTgzOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToyOTozNVrOGqMhtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToyOTozNVrOGqMhtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg5ODYxNQ==", "bodyText": "public parameter", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r446898615", "createdAt": "2020-06-29T11:29:35Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -114,17 +114,16 @@\n         /**\n          * The node.js version to be used when node.js is installed\n          * automatically by Vaadin, for example <code>\"v12.16.0\"</code>.\n-         * Defaults to null which uses the default node version.\n+         * Defaults to {@value FrontendTools#DEFAULT_NODE_VERSION}.\n          */\n-        public String nodeVersion = null;\n+        public String nodeVersion = FrontendTools.DEFAULT_NODE_VERSION;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebacddee364a12fbe3b1a6e6e0bf1bdf7135ed4f"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NTE2NjExOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToyOTozN1rOGqMh2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToyOTozN1rOGqMh2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg5ODY1MA==", "bodyText": "public parameter", "url": "https://github.com/vaadin/flow/pull/8611#discussion_r446898650", "createdAt": "2020-06-29T11:29:37Z", "author": {"login": "denis-anisimov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeTasks.java", "diffHunk": "@@ -114,17 +114,16 @@\n         /**\n          * The node.js version to be used when node.js is installed\n          * automatically by Vaadin, for example <code>\"v12.16.0\"</code>.\n-         * Defaults to null which uses the default node version.\n+         * Defaults to {@value FrontendTools#DEFAULT_NODE_VERSION}.\n          */\n-        public String nodeVersion = null;\n+        public String nodeVersion = FrontendTools.DEFAULT_NODE_VERSION;\n \n         /**\n          * Download node.js from this URL. Handy in heavily firewalled corporate\n          * environments where the node.js download can be provided from an\n-         * intranet mirror. Defaults to null which will cause the downloader\n-         * to use {@link NodeInstaller#DEFAULT_NODEJS_DOWNLOAD_ROOT}.\n+         * intranet mirror. Defaults to {@link NodeInstaller#DEFAULT_NODEJS_DOWNLOAD_ROOT}.\n          */\n-        public URI nodeDownloadRoot = null;\n+        public URI nodeDownloadRoot = URI.create(NodeInstaller.DEFAULT_NODEJS_DOWNLOAD_ROOT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebacddee364a12fbe3b1a6e6e0bf1bdf7135ed4f"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3286, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}