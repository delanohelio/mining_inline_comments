{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2MTM0MjY3", "number": 9200, "title": "feat: offline stub for server-side views", "bodyText": "An information page, similar in style and content to the default offline.html, is rendered in\nwhen navigating to a server-side view in offline mode.\nFixes #9132.", "createdAt": "2020-10-19T17:10:07Z", "url": "https://github.com/vaadin/flow/pull/9200", "merged": true, "mergeCommit": {"oid": "b543aef60396a3498bf2836e0d0c401313cd9091"}, "closed": true, "closedAt": "2020-10-29T08:01:01Z", "author": {"login": "joheriks"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUdbjoAFqTUxMzAzODc3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXNZhQAFqTUxOTQwNjM2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMDM4Nzc3", "url": "https://github.com/vaadin/flow/pull/9200#pullrequestreview-513038777", "createdAt": "2020-10-20T18:53:04Z", "commit": {"oid": "93d51943b80baa2662298475f55806319b2b0c9c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMzAxNDI3", "url": "https://github.com/vaadin/flow/pull/9200#pullrequestreview-513301427", "createdAt": "2020-10-21T04:40:52Z", "commit": {"oid": "93d51943b80baa2662298475f55806319b2b0c9c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNDo0MDo1MlrOHlZ_8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNDo0MDo1MlrOHlZ_8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk4NTMzMA==", "bodyText": "Maybe we should also check if a custom offlinePath is defined. Otherwise, Anton's PR won't work.", "url": "https://github.com/vaadin/flow/pull/9200#discussion_r508985330", "createdAt": "2020-10-21T04:40:52Z", "author": {"login": "haijian-vaadin"}, "path": "flow-client/src/main/resources/META-INF/resources/frontend/Flow.ts", "diffHunk": "@@ -117,11 +117,26 @@ export class Flow {\n       // Store last action pathname so as we can check it in events\n       this.pathname = params.pathname;\n \n-      await this.flowInit();\n-      // When an action happens, navigation will be resolved `onBeforeEnter`\n-      this.container.onBeforeEnter = (ctx, cmd) => this.flowNavigate(ctx, cmd);\n-      // For covering the 'server -> client' use case\n-      this.container.onBeforeLeave = (ctx, cmd) => this.flowLeave(ctx, cmd);\n+      if (navigator.onLine) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93d51943b80baa2662298475f55806319b2b0c9c"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93d51943b80baa2662298475f55806319b2b0c9c", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/93d51943b80baa2662298475f55806319b2b0c9c", "committedDate": "2020-10-19T16:34:28Z", "message": "feat: offline stub for server-side views"}, "afterCommit": {"oid": "31e5e46e49d46acb859fe989e1bf48fbb545f9ca", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/31e5e46e49d46acb859fe989e1bf48fbb545f9ca", "committedDate": "2020-10-21T14:13:25Z", "message": "Unit test for offline stub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NTg0ODI3", "url": "https://github.com/vaadin/flow/pull/9200#pullrequestreview-515584827", "createdAt": "2020-10-23T11:36:44Z", "commit": {"oid": "e43a038429751014b6ceffe6efa4c22db07b25b8"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMTozNjo0NVrOHnKHOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMTozNjo0NVrOHnKHOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDgyMjIwMQ==", "bodyText": "onLine could be false positive, for example, if there is a network but it is not functional.\nIt would be nice to have a fallback for this use case as well. Something like:\nif (!navigator.onLine) {\n  await this.showOfflineStub();\n} else {\n  try {\n    await this.flowInit();\n  } catch(error) {\n    await this.showOfflineStub();\n  }\n}", "url": "https://github.com/vaadin/flow/pull/9200#discussion_r510822201", "createdAt": "2020-10-23T11:36:45Z", "author": {"login": "platosha"}, "path": "flow-client/src/main/resources/META-INF/resources/frontend/Flow.ts", "diffHunk": "@@ -117,7 +117,17 @@ export class Flow {\n       // Store last action pathname so as we can check it in events\n       this.pathname = params.pathname;\n \n-      await this.flowInit();\n+      if (navigator.onLine) {\n+        // @ts-ignore\n+        await this.flowInit();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e43a038429751014b6ceffe6efa4c22db07b25b8"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81465d9e236111a2972fbd0cc2a0cec27149be04", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/81465d9e236111a2972fbd0cc2a0cec27149be04", "committedDate": "2020-10-26T19:40:42Z", "message": "Hide loading indicator when showing offline stub due to XMLHttpRequest onerror"}, "afterCommit": {"oid": "da855dd70a95c73e823ebf45512dddeb76b4a27d", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/da855dd70a95c73e823ebf45512dddeb76b4a27d", "committedDate": "2020-10-26T19:42:57Z", "message": "Hide loading indicator when showing offline stub due to XMLHttpRequest onerror"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MTIxMDcy", "url": "https://github.com/vaadin/flow/pull/9200#pullrequestreview-517121072", "createdAt": "2020-10-26T19:47:28Z", "commit": {"oid": "da855dd70a95c73e823ebf45512dddeb76b4a27d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NjYwOTA5", "url": "https://github.com/vaadin/flow/pull/9200#pullrequestreview-518660909", "createdAt": "2020-10-28T13:31:15Z", "commit": {"oid": "7e9b561e5d2f2fec0172ec82bbe47dade921f5a6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27f3b34cdc0d426752f7da54523b88811411fc4a", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/27f3b34cdc0d426752f7da54523b88811411fc4a", "committedDate": "2020-10-28T15:39:57Z", "message": "feat: offline stub for server-side views"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e9b561e5d2f2fec0172ec82bbe47dade921f5a6", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/7e9b561e5d2f2fec0172ec82bbe47dade921f5a6", "committedDate": "2020-10-27T08:15:44Z", "message": "Merge branch 'feature/offline' into joheriks/9132-offline-stub-in-appshell"}, "afterCommit": {"oid": "27f3b34cdc0d426752f7da54523b88811411fc4a", "author": {"user": {"login": "joheriks", "name": "Johannes Eriksson"}}, "url": "https://github.com/vaadin/flow/commit/27f3b34cdc0d426752f7da54523b88811411fc4a", "committedDate": "2020-10-28T15:39:57Z", "message": "feat: offline stub for server-side views"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NDA2MzY0", "url": "https://github.com/vaadin/flow/pull/9200#pullrequestreview-519406364", "createdAt": "2020-10-29T07:54:08Z", "commit": {"oid": "27f3b34cdc0d426752f7da54523b88811411fc4a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4716, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}