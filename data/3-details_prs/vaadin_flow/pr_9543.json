{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NjkzNjI5", "number": 9543, "title": "feat: Enable importing CSS from node_modules", "bodyText": "Allow importing CSS files as global styles from installed node_modules by adding the importCss to theme/my-theme/theme.json.\nFixes #9410", "createdAt": "2020-11-30T17:18:49Z", "url": "https://github.com/vaadin/flow/pull/9543", "merged": true, "mergeCommit": {"oid": "cb5bc35d9abf445406f1087acaaec26aeb906263"}, "closed": true, "closedAt": "2020-12-09T08:00:52Z", "author": {"login": "tanbt"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhooJBgH2gAyNTI5NjkzNjI5OjliMjVlYThiMmIyNTMzMTlmODU0MDZlZjk4ZjI3N2RiY2JmNzI1YmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkY8aYgH2gAyNTI5NjkzNjI5OjIxMzUwMTY5YmFlMGEzMWEwMjg5YzU0YjUyZDI2YzlkNDVhN2M3NjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b25ea8b2b253319f85406ef98f277dbcbf725ba", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/9b25ea8b2b253319f85406ef98f277dbcbf725ba", "committedDate": "2020-11-30T17:16:47Z", "message": "feat: Enable importing CSS from node_modules (#9410)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxNTE1Njk2", "url": "https://github.com/vaadin/flow/pull/9543#pullrequestreview-541515696", "createdAt": "2020-12-01T06:15:30Z", "commit": {"oid": "9b25ea8b2b253319f85406ef98f277dbcbf725ba"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNjoxNTozMFrOH8ZlPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNjoxODoyNFrOH8ZovQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzA5NTc0Mg==", "bodyText": "No added param documentation for themeProperties.", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r533095742", "createdAt": "2020-12-01T06:15:30Z", "author": {"login": "caalador"}, "path": "flow-server/src/main/resources/plugins/application-theme-plugin/theme-generator.js", "diffHunk": "@@ -46,7 +46,7 @@ export const injectGlobalCss = (css, target) => {\n  * @param {string} themeName name of the handled theme", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b25ea8b2b253319f85406ef98f277dbcbf725ba"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzA5NjYzNw==", "bodyText": "Lots of unrelated formatting changes in the test file.\nCould you check the TeamWiki Code style section. indentation at least seems different", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r533096637", "createdAt": "2020-12-01T06:18:24Z", "author": {"login": "caalador"}, "path": "flow-tests/test-themes/src/test/java/com/vaadin/flow/uitest/ui/theme/ThemeIT.java", "diffHunk": "@@ -38,11 +39,11 @@\n     public void secondTheme_staticFilesNotCopied() {\n         getDriver().get(getRootURL() + \"/path/VAADIN/static/img/bg.jpg\");\n         Assert.assertFalse(\"app-theme static files should be copied\",\n-            driver.getPageSource().contains(\"HTTP ERROR 404 Not Found\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b25ea8b2b253319f85406ef98f277dbcbf725ba"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2b0d5c62bf4c83d0c6381e7e275663fec1dac07", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/c2b0d5c62bf4c83d0c6381e7e275663fec1dac07", "committedDate": "2020-12-01T07:34:49Z", "message": "Update based on comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bb8d35a1ce095c730a312711f9bdd9279d3673b", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/2bb8d35a1ce095c730a312711f9bdd9279d3673b", "committedDate": "2020-12-01T07:41:35Z", "message": "Reformat"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8474de155c1c6632a03db28ddaa43b0eca8743f", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/d8474de155c1c6632a03db28ddaa43b0eca8743f", "committedDate": "2020-12-01T07:49:04Z", "message": "Reformat"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "490533abc27b0867e66e930da09ba9bcbda09bc9", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/490533abc27b0867e66e930da09ba9bcbda09bc9", "committedDate": "2020-12-01T08:23:17Z", "message": "Allow webpack css loader to import from node_modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b286d64eb31b4f9a0649c829cd3a82b54992d2fb", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/b286d64eb31b4f9a0649c829cd3a82b54992d2fb", "committedDate": "2020-12-01T08:28:30Z", "message": "Fix the commit above - wrong config place"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f57db68ca8256b95f4058faa6cff957c38edade6", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/f57db68ca8256b95f4058faa6cff957c38edade6", "committedDate": "2020-12-01T09:23:55Z", "message": "File-loader only copies files used as imports in .js files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c4f25c0f9a0d8ad57bb058d683adbfaad1803ed", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/2c4f25c0f9a0d8ad57bb058d683adbfaad1803ed", "committedDate": "2020-12-01T10:08:28Z", "message": "Add file-loader to NodeUpdater"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "736739b299c704f28c7bc2beee37f3e1b86f2fdd", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/736739b299c704f28c7bc2beee37f3e1b86f2fdd", "committedDate": "2020-12-01T15:14:11Z", "message": "Fix test for import CSS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "953a82b99e087a080cb900743b7c2a9675c1756d", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/953a82b99e087a080cb900743b7c2a9675c1756d", "committedDate": "2020-12-01T15:34:47Z", "message": "Merge branch 'master' into issues/9410-import-css"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27777eb143aca8715060170b6e29ec4a159ae08b", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/27777eb143aca8715060170b6e29ec4a159ae08b", "committedDate": "2020-12-01T17:55:26Z", "message": "Allow importing css not only from node_modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b856802ce3473029a052060cd10eae0c42e176c1", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/b856802ce3473029a052060cd10eae0c42e176c1", "committedDate": "2020-12-01T18:35:23Z", "message": "Also allow import css from frontend/theme"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTMyNTc2", "url": "https://github.com/vaadin/flow/pull/9543#pullrequestreview-542532576", "createdAt": "2020-12-02T06:32:02Z", "commit": {"oid": "b856802ce3473029a052060cd10eae0c42e176c1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNjozMjowM1rOH9MTMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNjozMzowNlrOH9MUlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzkyNjcwNA==", "bodyText": "This has the problem that \"external\" url's are not filtered out making it fail as the files can not be found.", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r533926704", "createdAt": "2020-12-02T06:32:03Z", "author": {"login": "caalador"}, "path": "flow-server/src/main/resources/webpack.generated.js", "diffHunk": "@@ -173,7 +173,8 @@ module.exports = {\n             options: {\n               url: (url, resourcePath) => {\n                 // Only translate files from node_modules\n-                return resourcePath.includes('/node_modules/');\n+                return resourcePath.includes('/node_modules/')\n+                    || resourcePath.includes('/frontend/theme/');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b856802ce3473029a052060cd10eae0c42e176c1"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzkyNzA2Mw==", "bodyText": "This was my mistake, but the output path should be outputPath: 'static/', also I can't get this to actually copy anything.", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r533927063", "createdAt": "2020-12-02T06:33:06Z", "author": {"login": "caalador"}, "path": "flow-server/src/main/resources/webpack.generated.js", "diffHunk": "@@ -189,6 +190,17 @@ module.exports = {\n           }\n         ],\n       },\n+      {\n+        // File-loader only copies files used as imports in .js files\n+        test: /\\.(png|gif|jpg|svg|eot|woff|woff2|ttf)$/,\n+        use: [{\n+          loader: 'file-loader',\n+          options: {\n+            outputPath: '../resources/VAADIN/static/',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b856802ce3473029a052060cd10eae0c42e176c1"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed0f83de1ce77adb02b282b47c0b346d0a66ab50", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/ed0f83de1ce77adb02b282b47c0b346d0a66ab50", "committedDate": "2020-12-02T07:56:14Z", "message": "Skip translating external URLs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83edc8f9bfc42d08d0bc3466269df3bf79f08d90", "author": {"user": {"login": "tanbt", "name": "Tan Bui"}}, "url": "https://github.com/vaadin/flow/commit/83edc8f9bfc42d08d0bc3466269df3bf79f08d90", "committedDate": "2020-12-02T07:59:09Z", "message": "Merge branch 'master' into issues/9410-import-css"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cca1dc2f3d50dccef1091f11232b4c0ccd6163ba", "author": {"user": {"login": "taefi", "name": "Soroosh Taefi"}}, "url": "https://github.com/vaadin/flow/commit/cca1dc2f3d50dccef1091f11232b4c0ccd6163ba", "committedDate": "2020-12-04T10:48:42Z", "message": "correct the path for background-image"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0", "author": {"user": {"login": "taefi", "name": "Soroosh Taefi"}}, "url": "https://github.com/vaadin/flow/commit/be290d7635a2d32b3c47601adea19b18ee53dcd0", "committedDate": "2020-12-04T11:19:32Z", "message": "merged with master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1ODMwMTMz", "url": "https://github.com/vaadin/flow/pull/9543#pullrequestreview-545830133", "createdAt": "2020-12-07T04:55:11Z", "commit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNDo1NToxMVrOIAV9ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNDo1NToxMVrOIAV9ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzIzMDczMA==", "bodyText": "As this should stay unchanged the path should get path from the application as it should be requested with the application context. There is a test that ./ should match RootUrl+/path when executed in browser context.", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r537230730", "createdAt": "2020-12-07T04:55:11Z", "author": {"login": "caalador"}, "path": "flow-tests/test-themes/frontend/theme/app-theme/global.css", "diffHunk": "@@ -12,7 +12,7 @@ body {\n \n #butterfly {\n     /* This shouldn't be translated */\n-    background-image: url(\"./test/path/monarch-butterfly.jpg\");\n+    background-image: url(\"/path/test/path/monarch-butterfly.jpg\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1ODYyMjk1", "url": "https://github.com/vaadin/flow/pull/9543#pullrequestreview-545862295", "createdAt": "2020-12-07T06:34:42Z", "commit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNjozNDo0MlrOIAX51Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNjo0MDo0MlrOIAYCPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2MjU0OQ==", "bodyText": "Remove the extra file-loader as it was added from the merge in master. see 3 lines down", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r537262549", "createdAt": "2020-12-07T06:34:42Z", "author": {"login": "caalador"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/NodeUpdater.java", "diffHunk": "@@ -303,6 +303,7 @@ static void addVaadinDefaultsToJson(JsonObject json) {\n         defaults.put(\"compression-webpack-plugin\", \"4.0.1\");\n         defaults.put(\"webpack-merge\", \"4.2.2\");\n         defaults.put(\"css-loader\", \"4.2.1\");\n+        defaults.put(\"file-loader\", \"6.1.0\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NDM0OQ==", "bodyText": "Should this check for something more. Are we certain the resource is available just because the css has been applied and no exceptions are on the console?\nShould we also check the resource e.g.\n        getDriver().get(getRootURL() + \"/path/VAADIN/static/[THE_RESOURCE_THAT_IS_EXPECTED]\");\n        Assert.assertFalse(\"Font resource should be available\",\n            driver.getPageSource().contains(\"HTTP ERROR 404 Not Found\"));", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r537264349", "createdAt": "2020-12-07T06:39:41Z", "author": {"login": "caalador"}, "path": "flow-tests/test-themes/src/test/java/com/vaadin/flow/uitest/ui/theme/ThemeIT.java", "diffHunk": "@@ -79,6 +80,16 @@ public void applicationTheme_GlobalCss_isUsed() {\n             driver.getPageSource().contains(\"Could not navigate\"));\n     }\n \n+    @Test\n+    public void applicationTheme_importCSS_isUsed() {\n+        open();\n+        checkLogsForErrors();\n+\n+        Assert.assertEquals(\"Imported FontAwesome css file should be applied.\",\n+                \"\\\"Font Awesome 5 Brands\\\"\", $(SpanElement.class).id(FONTAWESOME_ID)\n+                        .getCssValue(\"font-family\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NDcwMQ==", "bodyText": "Does this give something visible or should we add a icon class name also?", "url": "https://github.com/vaadin/flow/pull/9543#discussion_r537264701", "createdAt": "2020-12-07T06:40:42Z", "author": {"login": "caalador"}, "path": "flow-tests/test-themes/src/main/java/com/vaadin/flow/uitest/ui/theme/ThemeView.java", "diffHunk": "@@ -45,12 +46,16 @@ public ThemeView() {\n         Span octopuss = new Span();\n         octopuss.setId(OCTOPUSS_ID);\n \n+        Span faText = new Span(\"This test is FontAwesome.\");\n+        faText.setClassName(\"fab\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1ODkzNjAw", "url": "https://github.com/vaadin/flow/pull/9543#pullrequestreview-545893600", "createdAt": "2020-12-07T07:45:21Z", "commit": {"oid": "be290d7635a2d32b3c47601adea19b18ee53dcd0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "786ec8c2f8d40fb094227998551f6334a32bbcef", "author": {"user": {"login": "taefi", "name": "Soroosh Taefi"}}, "url": "https://github.com/vaadin/flow/commit/786ec8c2f8d40fb094227998551f6334a32bbcef", "committedDate": "2020-12-07T18:09:16Z", "message": "omit duplicate definition of file-loader dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a06b5480711616ed24538d7d1850a9a06e8d8a6", "author": {"user": {"login": "taefi", "name": "Soroosh Taefi"}}, "url": "https://github.com/vaadin/flow/commit/3a06b5480711616ed24538d7d1850a9a06e8d8a6", "committedDate": "2020-12-08T12:46:26Z", "message": "removed the leading path in butterfly selector"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c8a22c8da0b861e1145510321f35ad66dda21eb", "author": {"user": {"login": "taefi", "name": "Soroosh Taefi"}}, "url": "https://github.com/vaadin/flow/commit/4c8a22c8da0b861e1145510321f35ad66dda21eb", "committedDate": "2020-12-08T15:02:51Z", "message": "apply review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59df29f32ceafcdb99e4ccef230f40a1fcf0a297", "author": {"user": {"login": "taefi", "name": "Soroosh Taefi"}}, "url": "https://github.com/vaadin/flow/commit/59df29f32ceafcdb99e4ccef230f40a1fcf0a297", "committedDate": "2020-12-08T22:42:14Z", "message": "increase app theme plugin version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3ODgwMTg5", "url": "https://github.com/vaadin/flow/pull/9543#pullrequestreview-547880189", "createdAt": "2020-12-09T06:41:43Z", "commit": {"oid": "59df29f32ceafcdb99e4ccef230f40a1fcf0a297"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21350169bae0a31a0289c54b52d26c9d45a7c762", "author": {"user": {"login": "caalador", "name": null}}, "url": "https://github.com/vaadin/flow/commit/21350169bae0a31a0289c54b52d26c9d45a7c762", "committedDate": "2020-12-09T06:42:13Z", "message": "Merge branch 'master' into issues/9410-import-css"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4584, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}