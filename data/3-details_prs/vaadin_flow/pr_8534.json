{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxOTc2MTc5", "number": 8534, "title": "Support undefined size for DataCommunicator", "bodyText": "Part of vaadin/vaadin-grid-flow#966\nGrid part in vaadin/vaadin-grid-flow#1022", "createdAt": "2020-06-09T18:04:07Z", "url": "https://github.com/vaadin/flow/pull/8534", "merged": true, "mergeCommit": {"oid": "c0b4c38ea5c16e0b4a3043f9e23d1ffc49776e6e"}, "closed": true, "closedAt": "2020-06-12T13:26:02Z", "author": {"login": "pleku"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcppylOAFqTQyNzQ1MzU3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqiHDvgFqTQyOTcwMzUxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NDUzNTc3", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-427453577", "createdAt": "2020-06-09T18:58:20Z", "commit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODo1ODoyMFrOGhYFxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODo1ODoyMFrOGhYFxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY1MDg4Nw==", "bodyText": "Take the required action to fix the issue indicated by this comment.", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437650887", "createdAt": "2020-06-09T18:58:20Z", "author": {"login": "vaadin-bot"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -411,16 +672,18 @@ protected Object getFilter() {\n                 inMemorySorting, filter);\n         Stream<T> stream = getDataProvider().fetch(query);\n         if (stream.isParallel()) {\n-            LoggerFactory.getLogger(DataCommunicator.class)\n-                    .debug(\"Data provider {} has returned \"\n+            getLogger(DataCommunicator.class).debug(\n+                    \"Data provider {} has returned \"\n                             + \"parallel stream on 'fetch' call\",\n-                            getDataProvider().getClass());\n+                    getDataProvider().getClass());\n             stream = stream.collect(Collectors.toList()).stream();\n             assert !stream.isParallel();\n         }\n+\n         SizeVerifier verifier = new SizeVerifier<>(limit);\n         stream = stream.peek(verifier);\n \n+        // FIXME simplify by removing these restrictions ?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 362}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NzkzMDcy", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-427793072", "createdAt": "2020-06-10T07:45:18Z", "commit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0NToxOVrOGho16A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOTowMzoxNVrOGhrxzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkyNTM1Mg==", "bodyText": "Missing new line", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437925352", "createdAt": "2020-06-10T07:45:19Z", "author": {"login": "caalador"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/SizeEstimateCallback.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.vaadin.flow.data.provider;\n+\n+import java.io.Serializable;\n+\n+/**\n+ * Callback interface for estimating the number of items in a backend based on a\n+ * query.\n+ *\n+ * @param <T>\n+ *            the type of the items\n+ * @param <F>\n+ *            the type of the optional filter in the query, <code>Void</code> if\n+ *            filtering is not supported\n+ */\n+@FunctionalInterface\n+public interface SizeEstimateCallback<T, F> extends Serializable {\n+\n+    /**\n+     * Returns the estimated size of the data set based on a query. This\n+     * callback is invoked for the initial size estimate, when reset or filter\n+     * has changed or when the previous size estimate is about to be reached.\n+     * <p>\n+     * The query provides the previous estimated size and optionally defines any\n+     * filtering to use through {@link Query#getFilter()}. The query also\n+     * contains information about paging and sorting although that information\n+     * is generally not applicable for determining the number of items.\n+     *\n+     * @param query\n+     *            the query that defines which items to count\n+     * @return the number of available items\n+     */\n+    // TODO refactor to return void and provide API to increase the size\n+    int sizeEstimate(SizeEstimateQuery<T, F> query);\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk1ODgyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                .info(\"Requested: \" + requestedRange + \" old size: \"\n          \n          \n            \n                                        + assumedSize + \" new size: \" + size);\n          \n          \n            \n                                .info(\"Requested range: {} old size: {} new size: {}\", requestedRange,\n          \n          \n            \n                                        assumedSize, size);", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437958829", "createdAt": "2020-06-10T08:40:32Z", "author": {"login": "caalador"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -376,14 +546,105 @@ public void setBackEndSorting(List<QuerySortOrder> sortOrder) {\n     }\n \n     /**\n-     * Getter method for finding the size of DataProvider. Can be overridden by\n-     * a subclass that uses a specific type of DataProvider and/or query.\n+     * Getter method for determining the initial size of the data. Can be\n+     * overridden by a subclass that uses a specific type of DataProvider and/or\n+     * query.\n      *\n      * @return the size of data provider with current filter\n      */\n     @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n     protected int getDataProviderSize() {\n-        return getDataProvider().size(new Query(getFilter()));\n+        assert definedSize : \"This method should never be called when using undefined size\";\n+        if (sizeCallback != null) {\n+            return sizeCallback.count(new Query(getFilter()));\n+        } else {\n+            return getDataProvider().size(new Query(getFilter()));\n+        }\n+    }\n+\n+    private void updateUndefinedSize() {\n+        assert !definedSize : \"This method should never be called when using defined size\";\n+        // things have reset\n+        if (resendEntireRange || sizeReset) {\n+            // 1. given size estimate\n+            int size = initialSizeEstimate;\n+            // 2. given estimate callback\n+            if (sizeEstimateCallback != null) {\n+                size = getNewSizeEstimateFromCallback(true);\n+            }\n+            // 3. default initial size\n+            if (size == -1) {\n+                size = getDefaultInitialSize();\n+            }\n+            getLogger(DataCommunicator.class)\n+                    .info(\"Requested: \" + requestedRange + \" old size: \"\n+                            + assumedSize + \" new size: \" + size);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 274}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk1OTQxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            getLogger(DataCommunicator.class).info(\"Requested: \"\n          \n          \n            \n                                    + requestedRange + \" old size: \" + previousAssumedSize\n          \n          \n            \n                                    + \" new size: \" + assumedSize);\n          \n          \n            \n                            getLogger(DataCommunicator.class).info(\"Requested range: {} old size: {} new size: {}\",\n          \n          \n            \n                                    requestedRange, previousAssumedSize, assumedSize);", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437959412", "createdAt": "2020-06-10T08:41:24Z", "author": {"login": "caalador"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -376,14 +546,105 @@ public void setBackEndSorting(List<QuerySortOrder> sortOrder) {\n     }\n \n     /**\n-     * Getter method for finding the size of DataProvider. Can be overridden by\n-     * a subclass that uses a specific type of DataProvider and/or query.\n+     * Getter method for determining the initial size of the data. Can be\n+     * overridden by a subclass that uses a specific type of DataProvider and/or\n+     * query.\n      *\n      * @return the size of data provider with current filter\n      */\n     @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n     protected int getDataProviderSize() {\n-        return getDataProvider().size(new Query(getFilter()));\n+        assert definedSize : \"This method should never be called when using undefined size\";\n+        if (sizeCallback != null) {\n+            return sizeCallback.count(new Query(getFilter()));\n+        } else {\n+            return getDataProvider().size(new Query(getFilter()));\n+        }\n+    }\n+\n+    private void updateUndefinedSize() {\n+        assert !definedSize : \"This method should never be called when using defined size\";\n+        // things have reset\n+        if (resendEntireRange || sizeReset) {\n+            // 1. given size estimate\n+            int size = initialSizeEstimate;\n+            // 2. given estimate callback\n+            if (sizeEstimateCallback != null) {\n+                size = getNewSizeEstimateFromCallback(true);\n+            }\n+            // 3. default initial size\n+            if (size == -1) {\n+                size = getDefaultInitialSize();\n+            }\n+            getLogger(DataCommunicator.class)\n+                    .info(\"Requested: \" + requestedRange + \" old size: \"\n+                            + assumedSize + \" new size: \" + size);\n+            assumedSize = size;\n+        } else {\n+            // increase size estimate if the last page is being fetched\n+            if (requestedRange.getEnd() + pageSize > assumedSize) {\n+                int previousAssumedSize = assumedSize;\n+                if (sizeEstimateCallback != null) {\n+                    assumedSize = getNewSizeEstimateFromCallback(false);\n+                } else {\n+                    // by default adjust size by multiple of page size\n+                    assumedSize += getEstimatedSizeIncrease();\n+                }\n+                getLogger(DataCommunicator.class).info(\"Requested: \"\n+                        + requestedRange + \" old size: \" + previousAssumedSize\n+                        + \" new size: \" + assumedSize);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 288}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3MzQ1NQ==", "bodyText": "Do we need to care about a sizeReset if we are in defined size mode?", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437973455", "createdAt": "2020-06-10T09:03:15Z", "author": {"login": "caalador"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -499,8 +762,13 @@ private void flush() {\n                 activeKeyOrder.size());\n \n         // Phase 1: Find all items that the client should have\n-        if (resendEntireRange) {\n+\n+        // With defined size the backend is only queried when necessary\n+        if (definedSize && (resendEntireRange || sizeReset)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 382}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODcwMjM2", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-427870236", "createdAt": "2020-06-10T09:19:33Z", "commit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToxOTozM1rOGhsWbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToyMTo0MlrOGhsbsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4MjgyOA==", "bodyText": "Constructor parameters amount is too high, should we consider use of builder here?", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437982828", "createdAt": "2020-06-10T09:19:33Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/SizeEstimateQuery.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.vaadin.flow.data.provider;\n+\n+import java.util.Comparator;\n+import java.util.List;\n+\n+/**\n+ * Immutable query object used to get the estimated size of the data set with\n+ * {@link LazyDataView}. In addition to normal query parameters, contains the\n+ * previous size estimate that was used.\n+ * \n+ * @param <T>\n+ *            the data type\n+ * @param <F>\n+ *            the filter type\n+ * @since\n+ */\n+public class SizeEstimateQuery<T, F> extends Query<T, F> {\n+\n+    private final int previousSizeEstimate;\n+    private final boolean reset;\n+\n+    /**\n+     * Constructs a size estimate query with given previous size, offset, limit,\n+     * sorting and filtering.\n+     *\n+     * @param offset\n+     *            first index to fetch\n+     * @param limit\n+     *            fetched item count\n+     * @param sortOrders\n+     *            sorting order for fetching; used for sorting backends\n+     * @param inMemorySorting\n+     *            comparator for sorting in-memory data\n+     * @param filter\n+     *            filtering for fetching; can be null\n+     * @param previousSizeEstimate\n+     *            the previous size estimate\n+     * @param reset\n+     *            whether the data set was reset\n+     */\n+    public SizeEstimateQuery(int offset, int limit,\n+            List<QuerySortOrder> sortOrders, Comparator<T> inMemorySorting,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4NDE3OQ==", "bodyText": "Would replicate this in isReset method javadoc (return true if no previous estimate)", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437984179", "createdAt": "2020-06-10T09:21:42Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/SizeEstimateQuery.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.vaadin.flow.data.provider;\n+\n+import java.util.Comparator;\n+import java.util.List;\n+\n+/**\n+ * Immutable query object used to get the estimated size of the data set with\n+ * {@link LazyDataView}. In addition to normal query parameters, contains the\n+ * previous size estimate that was used.\n+ * \n+ * @param <T>\n+ *            the data type\n+ * @param <F>\n+ *            the filter type\n+ * @since\n+ */\n+public class SizeEstimateQuery<T, F> extends Query<T, F> {\n+\n+    private final int previousSizeEstimate;\n+    private final boolean reset;\n+\n+    /**\n+     * Constructs a size estimate query with given previous size, offset, limit,\n+     * sorting and filtering.\n+     *\n+     * @param offset\n+     *            first index to fetch\n+     * @param limit\n+     *            fetched item count\n+     * @param sortOrders\n+     *            sorting order for fetching; used for sorting backends\n+     * @param inMemorySorting\n+     *            comparator for sorting in-memory data\n+     * @param filter\n+     *            filtering for fetching; can be null\n+     * @param previousSizeEstimate\n+     *            the previous size estimate\n+     * @param reset\n+     *            whether the data set was reset\n+     */\n+    public SizeEstimateQuery(int offset, int limit,\n+            List<QuerySortOrder> sortOrders, Comparator<T> inMemorySorting,\n+            F filter, int previousSizeEstimate, boolean reset) {\n+        super(offset, limit, sortOrders, inMemorySorting, filter);\n+        this.previousSizeEstimate = previousSizeEstimate;\n+        this.reset = reset;\n+    }\n+\n+    /**\n+     * Returns whether the data set was reset or not. The reset happens when the\n+     * data was updated due to addition, deleting or filter change.\n+     * \n+     * @return {@code true} for reset, {@code false} for not\n+     */\n+    public boolean isReset() {\n+        return reset;\n+    }\n+\n+    /**\n+     * Returns the previous size estimate used. If no previous size estimate was\n+     * used, returns 0 and at the same time {@link #isReset()} will return\n+     * {@code true}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODgwMzA5", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-427880309", "createdAt": "2020-06-10T09:31:45Z", "commit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOTozMTo0NlrOGhs0Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOTozMTo0NlrOGhs0Cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk5MDQxMA==", "bodyText": "for setting in memory data -> for data lazy fetching from backend", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r437990410", "createdAt": "2020-06-10T09:31:46Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/HasLazyDataView.java", "diffHunk": "@@ -18,61 +18,84 @@\n import java.io.Serializable;\n \n /**\n- * Interface that defines methods for setting in memory data.\n- * This will return a {@link LazyDataView}.\n+ * Interface that defines methods for setting in memory data. This will return a", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MDA1MTUy", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-428005152", "createdAt": "2020-06-10T12:33:59Z", "commit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMjozMzo1OVrOGhyoOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMjozOTozNlrOGhy0aQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4NTY4OQ==", "bodyText": "Do we need skipSizeCheckUntilReset = false; to be set here? it is set within reset method, just a couple lines of code ahead", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r438085689", "createdAt": "2020-06-10T12:33:59Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -241,6 +256,9 @@ public void confirmUpdate(int updateId) {\n             DataProvider<T, F> dataProvider, F initialFilter) {\n         Objects.requireNonNull(dataProvider, \"data provider cannot be null\");\n         filter = initialFilter;\n+        doSetDefinedSize(null, null, -1, true);\n+        skipSizeCheckUntilReset = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4ODgwOQ==", "bodyText": "calls to doSetDefinedSize are really hard to read. Suggestion is to create a shortcut methods for every specific use case. However, this is okay at this point and could be polished later on.", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r438088809", "createdAt": "2020-06-10T12:39:36Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -241,6 +256,9 @@ public void confirmUpdate(int updateId) {\n             DataProvider<T, F> dataProvider, F initialFilter) {\n         Objects.requireNonNull(dataProvider, \"data provider cannot be null\");\n         filter = initialFilter;\n+        doSetDefinedSize(null, null, -1, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 58}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MDkyNjA0", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-428092604", "createdAt": "2020-06-10T14:09:50Z", "commit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNDowOTo1MFrOGh2qgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNDoyMzoxOFrOGh3THw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODE1MTgxMQ==", "bodyText": "skipSizeCheckUntilReset is set to true when the fetched items are less than requested range, i.e. range end has been reached.  Then, if no callbacks/dataproviders/estimated size are set by the client it will be still true until reset(), i.e. until refreshAll(), and the size won't be updated. So, does that mean the user would be scrolling up and down with no items list update, until someone calls refreshAll?", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r438151811", "createdAt": "2020-06-10T14:09:50Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -175,6 +185,7 @@ public void setRequestedRange(int start, int length) {\n      * It effectively resends all available data.\n      */\n     public void reset() {\n+        skipSizeCheckUntilReset = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODE1MzExOQ==", "bodyText": "I expect sizeReset = true here. If anything is cleared anyway, probably we can just delete it?", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r438153119", "createdAt": "2020-06-10T14:11:29Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -241,6 +256,9 @@ public void confirmUpdate(int updateId) {\n             DataProvider<T, F> dataProvider, F initialFilter) {\n         Objects.requireNonNull(dataProvider, \"data provider cannot be null\");\n         filter = initialFilter;\n+        doSetDefinedSize(null, null, -1, true);\n+        skipSizeCheckUntilReset = false;\n+        sizeReset = false; // everything is cleared anyway", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODE2MjIwNw==", "bodyText": "This method has almost the same name as setUndefinedSize(int), but different semantics. Calling setDefinedSize(), I would expect it sets up the int parameter to internal state, but it is not the case, it sets up the mode (defined/undefined). So, I propose to think about renaming this method in the future. For example, something like setDefinedMode, setDefined, setDefinedSizeMode.", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r438162207", "createdAt": "2020-06-10T14:23:18Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/LazyDataView.java", "diffHunk": "@@ -15,64 +15,116 @@\n  */\n package com.vaadin.flow.data.provider;\n \n-import java.util.Optional;\n-\n /**\n  * DataView for lazy loaded data.\n  *\n  * @param <T>\n- *         data type\n+ *            data type\n  * @since\n  */\n public interface LazyDataView<T> extends DataView<T> {\n \n     /**\n-     * Get the item after the given item if available on the server. Server\n-     * only knows the latest set requested by the client and will be filtered\n-     * and sorted accordingly.\n+     * Sets the component to use defined size with the given callback that\n+     * provides the exact size for the dataset.\n+     * <p>\n+     * When the component has a distinct data provider set with\n+     * {@link com.vaadin.flow.data.binder.HasDataProvider#setDataProvider(DataProvider)},\n+     * the given callback will be queried for getting the dataset size instead\n+     * of the data provider {@link DataProvider#size(Query)} method.\n+     * <p>\n+     * Calling this method will clear any previously set initial size estimate\n+     * {@link #setUndefinedSize(int)} and size estimate callback\n+     * {@link #setUndefinedSize(SizeEstimateCallback)}.\n      *\n-     * @param item\n-     *         item to get next from\n-     * @return optional containing next item if available\n+     * @param callback\n+     *            the callback to use for determining dataset size, not\n+     *            {@code null}\n+     * @see #setDefinedSize(boolean)\n      */\n-    Optional<T> getNextItem(T item);\n+    void setDefinedSize(CallbackDataProvider.CountCallback<T, Void> callback);\n \n     /**\n-     * Get the item before the given item if available on the server. Server\n-     * only knows the latest set requested by the client and will be filtered\n-     * and sorted accordingly.\n+     * Sets the component to use undefined size with the given initial size\n+     * estimate of the dataset. The estimated size is used after reset occurs or\n+     * filter changes.\n+     * <p>\n+     * Calling this method will clear any previously set size estimate callback\n+     * {@link #setUndefinedSize(SizeEstimateCallback)} or defined size callback\n+     * {@link #setDefinedSize(CallbackDataProvider.CountCallback)}.\n      *\n-     * @param item\n-     *         item to get previous from\n-     * @return optional containing previous item if available\n+     * @param initialSizeEstimate\n+     *            initial size estimate for the dataset\n      */\n-    Optional<T> getPreviousItem(T item);\n-\n-    // API related supporting undefined size - it makes no sense to have these for in-memory\n+    void setUndefinedSize(int initialSizeEstimate);\n \n     /**\n-     * Add count callback for lazy data with undefined size.\n+     * Sets the component to use undefined size with the given callback for\n+     * estimating the size of the dataset. Calling this method will clear any\n+     * previously set size callback\n+     * {@link #setDefinedSize(CallbackDataProvider.CountCallback)} or initial\n+     * size estimate {@link #setUndefinedSize(int)}.\n+     * <p>\n+     * This callback is triggered:\n+     * <ol>\n+     * <li>initially after setting</li>\n+     * <li>after reset like when the filter has changed</li>\n+     * <li>when the last page of the previous size is being fetched</li>\n+     * </ol>\n+     * <p>\n+     * Once the size is known, because the backend has \"run out of items\", the\n+     * callback is not triggered until a reset occurs or filter changes.\n+     * <p>\n+     * <em>NOTE: The given callback can only return a size estimate that is less\n+     * than the {@link SizeEstimateQuery#getRequestedRangeEnd()} when there has\n+     * been a reset (see {@link SizeEstimateQuery#isReset()},as that would be\n+     * the same as using defined size.</em> An {@link IllegalStateException} is\n+     * thrown instead. For using defined size, use\n+     * {@link #setDefinedSize(CallbackDataProvider.CountCallback)} instead.\n      *\n      * @param callback\n-     *         count callback to use\n+     *            a callback that provides the estimated size of the data\n      */\n-    void withCountCallback(\n-            CallbackDataProvider.CountCallback<T, Void> callback);\n+    void setUndefinedSize(SizeEstimateCallback<T, Void> callback);\n \n     /**\n-     * Set an initial estimate for the item count.\n+     * Switches the component between defined and undefined size.\n+     * <p>\n+     * With defined size, either a size callback needs to have been provided\n+     * with the {@link #setDefinedSize(CallbackDataProvider.CountCallback)} or\n+     * the data provider in the component needs to have implemented the\n+     * {@link DataProvider#size(Query)} method.\n+     * <p>\n+     * The default undefined size depends on the component implementation. For\n+     * controlling the undefined size, use {@link #setUndefinedSize(int)} or\n+     * {@link #setUndefinedSize(SizeEstimateCallback)}. Calling this method will\n+     * clear any previously set initial size estimate or size\n      *\n-     * @param initialCountEstimate\n-     *         initial count estimate\n+     * @param definedSize\n+     *            {@code true} for defined size, {@code false} for undefined\n+     *            size\n      */\n-    void withInitialCountEstimate(int initialCountEstimate);\n+    void setDefinedSize(boolean definedSize);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2762f23ec0e92d278e4d266ee400e84935d45cfa"}, "originalPosition": 120}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTYzMTI2", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429563126", "createdAt": "2020-06-12T08:38:22Z", "commit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwODozODoyMlrOGi768g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwODozOTowNFrOGi78eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI4NjUxNA==", "bodyText": "teh -> the", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r439286514", "createdAt": "2020-06-12T08:38:22Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -301,16 +319,171 @@ public Range getRequestedRange() {\n      * Generate a data query with component sorting and filtering.\n      *\n      * @param offset\n-     *         first index to fetch\n+     *            first index to fetch\n      * @param limit\n-     *         fetched item count\n+     *            fetched item count\n      * @return {@link Query} for component state\n      */\n     public Query buildQuery(int offset, int limit) {\n         return new Query(offset, limit, getBackEndSorting(),\n                 getInMemorySorting(), getFilter());\n     }\n \n+    /**\n+     * Sets the page size that is used to fetch items. The queries to data\n+     * provider are a multiple of the page size.\n+     * \n+     * @param pageSize\n+     *            the page size to set\n+     */\n+    // TODO https://github.com/vaadin/flow/issues/8557\n+    public void setPageSize(int pageSize) {\n+        if (pageSize < 1) {\n+            throw new IllegalArgumentException(String.format(\n+                    \"Page size cannot be less than 1, got %s\", pageSize));\n+        }\n+        this.pageSize = pageSize;\n+    }\n+\n+    /**\n+     * Sets the number of pages that the component estimated size is increased\n+     * when the end has been reached with but when no\n+     * {@link #setSizeEstimateCallback(SizeEstimateCallback)} is provided. This\n+     * method is meant for component specific customizations, but not for\n+     * exposing in the component.\n+     *\n+     * @param sizeIncreasePageCount\n+     *            the count of pages to increase the size\n+     */\n+    public void setSizeIncreasePageCount(int sizeIncreasePageCount) {\n+        this.sizeIncreasePageCount = sizeIncreasePageCount;\n+    }\n+\n+    /**\n+     * Returns the number of pages that the size is increased when the estimated\n+     * end has been reached in undefined size mode.\n+     */\n+    public int getSizeIncreasePageCount() {\n+        return sizeIncreasePageCount;\n+    }\n+\n+    /**\n+     * Sets the size callback to be used and switches the component to defined\n+     * size. Any previously set callbacks or initial size are cleared. The new\n+     * size will be used after this roundtrip.\n+     * \n+     * @param sizeCallback\n+     *            the size callback to use\n+     */\n+    public void setSizeCallback(\n+            CallbackDataProvider.CountCallback<T, ?> sizeCallback) {\n+        if (sizeCallback == null) {\n+            throw new IllegalArgumentException(\n+                    \"Provided size callback cannot be null - for switching between defined and undefined size use setDefinedSize(boolean) method instead.\");\n+        }\n+        clearSizeCallbacksAndState();\n+        this.sizeCallback = sizeCallback;\n+        definedSize = true;\n+        skipSizeCheckUntilReset = false;\n+        // there is no reset but we need to get the defined size\n+        sizeReset = true;\n+        requestFlush();\n+    }\n+\n+    /**\n+     * Sets the size estimate callback to be used and switches teh component to", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI4NjkwNQ==", "bodyText": "line break", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r439286905", "createdAt": "2020-06-12T08:39:04Z", "author": {"login": "mshabarov"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -301,16 +319,171 @@ public Range getRequestedRange() {\n      * Generate a data query with component sorting and filtering.\n      *\n      * @param offset\n-     *         first index to fetch\n+     *            first index to fetch\n      * @param limit\n-     *         fetched item count\n+     *            fetched item count\n      * @return {@link Query} for component state\n      */\n     public Query buildQuery(int offset, int limit) {\n         return new Query(offset, limit, getBackEndSorting(),\n                 getInMemorySorting(), getFilter());\n     }\n \n+    /**\n+     * Sets the page size that is used to fetch items. The queries to data\n+     * provider are a multiple of the page size.\n+     * \n+     * @param pageSize\n+     *            the page size to set\n+     */\n+    // TODO https://github.com/vaadin/flow/issues/8557\n+    public void setPageSize(int pageSize) {\n+        if (pageSize < 1) {\n+            throw new IllegalArgumentException(String.format(\n+                    \"Page size cannot be less than 1, got %s\", pageSize));\n+        }\n+        this.pageSize = pageSize;\n+    }\n+\n+    /**\n+     * Sets the number of pages that the component estimated size is increased\n+     * when the end has been reached with but when no\n+     * {@link #setSizeEstimateCallback(SizeEstimateCallback)} is provided. This\n+     * method is meant for component specific customizations, but not for\n+     * exposing in the component.\n+     *\n+     * @param sizeIncreasePageCount\n+     *            the count of pages to increase the size\n+     */\n+    public void setSizeIncreasePageCount(int sizeIncreasePageCount) {\n+        this.sizeIncreasePageCount = sizeIncreasePageCount;\n+    }\n+\n+    /**\n+     * Returns the number of pages that the size is increased when the estimated\n+     * end has been reached in undefined size mode.\n+     */\n+    public int getSizeIncreasePageCount() {\n+        return sizeIncreasePageCount;\n+    }\n+\n+    /**\n+     * Sets the size callback to be used and switches the component to defined\n+     * size. Any previously set callbacks or initial size are cleared. The new\n+     * size will be used after this roundtrip.\n+     * \n+     * @param sizeCallback\n+     *            the size callback to use\n+     */\n+    public void setSizeCallback(\n+            CallbackDataProvider.CountCallback<T, ?> sizeCallback) {\n+        if (sizeCallback == null) {\n+            throw new IllegalArgumentException(\n+                    \"Provided size callback cannot be null - for switching between defined and undefined size use setDefinedSize(boolean) method instead.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "originalPosition": 130}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTY4NTI2", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429568526", "createdAt": "2020-06-12T08:46:35Z", "commit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTkyOTA2", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429592906", "createdAt": "2020-06-12T09:23:43Z", "commit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwOToyMzo0M1rOGi9Spg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwOToyMzo0M1rOGi9Spg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMwODk2Ng==", "bodyText": "Complete the task associated to this TODO comment.", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r439308966", "createdAt": "2020-06-12T09:23:43Z", "author": {"login": "vaadin-bot"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -301,16 +319,171 @@ public Range getRequestedRange() {\n      * Generate a data query with component sorting and filtering.\n      *\n      * @param offset\n-     *         first index to fetch\n+     *            first index to fetch\n      * @param limit\n-     *         fetched item count\n+     *            fetched item count\n      * @return {@link Query} for component state\n      */\n     public Query buildQuery(int offset, int limit) {\n         return new Query(offset, limit, getBackEndSorting(),\n                 getInMemorySorting(), getFilter());\n     }\n \n+    /**\n+     * Sets the page size that is used to fetch items. The queries to data\n+     * provider are a multiple of the page size.\n+     * \n+     * @param pageSize\n+     *            the page size to set\n+     */\n+    // TODO https://github.com/vaadin/flow/issues/8557", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "originalPosition": 87}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTkyOTE5", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429592919", "createdAt": "2020-06-12T09:23:44Z", "commit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwOToyMzo0NFrOGi9StA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwOToyMzo0NFrOGi9StA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMwODk4MA==", "bodyText": "Complete the task associated to this TODO comment.", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r439308980", "createdAt": "2020-06-12T09:23:44Z", "author": {"login": "vaadin-bot"}, "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/SizeEstimateCallback.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.vaadin.flow.data.provider;\n+\n+import java.io.Serializable;\n+\n+/**\n+ * Callback interface for estimating the number of items in a backend based on a\n+ * query.\n+ *\n+ * @param <T>\n+ *            the type of the items\n+ * @param <F>\n+ *            the type of the optional filter in the query, <code>Void</code> if\n+ *            filtering is not supported\n+ */\n+@FunctionalInterface\n+public interface SizeEstimateCallback<T, F> extends Serializable {\n+\n+    /**\n+     * Returns the estimated size of the data set based on a query. This\n+     * callback is invoked for the initial size estimate, when reset or filter\n+     * has changed or when the previous size estimate is about to be reached.\n+     * <p>\n+     * The query provides the previous estimated size and optionally defines any\n+     * filtering to use through {@link Query#getFilter()}. The query also\n+     * contains information about paging and sorting although that information\n+     * is generally not applicable for determining the number of items.\n+     *\n+     * @param query\n+     *            the query that defines which items to count\n+     * @return the number of available items\n+     */\n+    // TODO refactor to return void and provide API to increase the size ?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "936330cceba44d69d7101031d1317f76c4880869", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/936330cceba44d69d7101031d1317f76c4880869", "committedDate": "2020-06-12T11:57:29Z", "message": "Support undefined size for DataCommunicator\n\nPart of vaadin/vaadin-grid-flow#966"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75b36697e10a4f7aa90fe0d60569fd58449cc18f", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/75b36697e10a4f7aa90fe0d60569fd58449cc18f", "committedDate": "2020-06-12T11:57:29Z", "message": "Address review comments, add ticket #"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7162fd2f8320045b453e8821b6918298f49ef693", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/7162fd2f8320045b453e8821b6918298f49ef693", "committedDate": "2020-06-12T11:57:29Z", "message": "Renamed methods back from setXyz to withXyz\n\nAlso addressed some review comments."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "119cd6d51dfac6d9c92af3853e995728283385b9", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/119cd6d51dfac6d9c92af3853e995728283385b9", "committedDate": "2020-06-12T08:28:35Z", "message": "Address review comments, add ticket #"}, "afterCommit": {"oid": "86ff0a8cf521c72bb6d7f766315467070f301082", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/86ff0a8cf521c72bb6d7f766315467070f301082", "committedDate": "2020-06-12T12:02:42Z", "message": "Rename setDataProvider to setDataSource\n\nPart of #8189"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5Njk3NTU0", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429697554", "createdAt": "2020-06-12T12:25:19Z", "commit": {"oid": "86ff0a8cf521c72bb6d7f766315467070f301082"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxMjoyNToxOVrOGjCDow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxMjoyNToxOVrOGjCDow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM4NzA0Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    public FrontendDependenciesScanner  createScanner(\n          \n          \n            \n                    public FrontendDependenciesScanner createScanner(", "url": "https://github.com/vaadin/flow/pull/8534#discussion_r439387043", "createdAt": "2020-06-12T12:25:19Z", "author": {"login": "mshabarov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/scanner/FrontendDependenciesScanner.java", "diffHunk": "@@ -54,7 +54,7 @@\n          *            dependencies if {@code true}, doesn't check otherwise\n          * @return a scanner implementation strategy\n          */\n-        public FrontendDependenciesScanner createScanner(\n+        public FrontendDependenciesScanner  createScanner(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86ff0a8cf521c72bb6d7f766315467070f301082"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5Njk3ODg3", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429697887", "createdAt": "2020-06-12T12:25:54Z", "commit": {"oid": "86ff0a8cf521c72bb6d7f766315467070f301082"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7aaa6d110eb11914f0aa13c2de5bea1364a22355", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/7aaa6d110eb11914f0aa13c2de5bea1364a22355", "committedDate": "2020-06-12T12:28:05Z", "message": "Rename setDataProvider to setDataSource\n\nPart of #8189"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86ff0a8cf521c72bb6d7f766315467070f301082", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/86ff0a8cf521c72bb6d7f766315467070f301082", "committedDate": "2020-06-12T12:02:42Z", "message": "Rename setDataProvider to setDataSource\n\nPart of #8189"}, "afterCommit": {"oid": "7aaa6d110eb11914f0aa13c2de5bea1364a22355", "author": {"user": {"login": "pleku", "name": "Pekka Hyv\u00f6nen"}}, "url": "https://github.com/vaadin/flow/commit/7aaa6d110eb11914f0aa13c2de5bea1364a22355", "committedDate": "2020-06-12T12:28:05Z", "message": "Rename setDataProvider to setDataSource\n\nPart of #8189"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NzAzNTEw", "url": "https://github.com/vaadin/flow/pull/8534#pullrequestreview-429703510", "createdAt": "2020-06-12T12:35:23Z", "commit": {"oid": "7aaa6d110eb11914f0aa13c2de5bea1364a22355"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 476, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}