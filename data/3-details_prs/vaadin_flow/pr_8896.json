{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMTI5MTY0", "number": 8896, "title": "Only connect to devServer when it is started", "bodyText": "Do not try to connect to the dev server\nif it hasn't started yet or startup has failed.\nFixes #8858", "createdAt": "2020-08-25T11:15:35Z", "url": "https://github.com/vaadin/flow/pull/8896", "merged": true, "mergeCommit": {"oid": "dabd78cf602ce00f2e8919a23fa506e070b96c93"}, "closed": true, "closedAt": "2020-08-26T05:37:04Z", "author": {"login": "caalador"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCVyTVAH2gAyNDczMTI5MTY0OjQ2MWM5YmM0ODMyOTU1MDY4NTdmYTE5M2RiNzBmMmE5MDdmYzVhN2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdClEmqAFqTQ3NTE2MzM4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "461c9bc483295506857fa193db70f2a907fc5a7e", "author": {"user": {"login": "caalador", "name": null}}, "url": "https://github.com/vaadin/flow/commit/461c9bc483295506857fa193db70f2a907fc5a7e", "committedDate": "2020-08-25T11:48:02Z", "message": "Only connect to devServer when it is started\n\nDo not try to connect to the dev server\nif it hasn't started yet or startup has failed.\n\nFixes #8858"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "561673bc60f6b1baf861537b3962724c95db2602", "author": {"user": {"login": "caalador", "name": null}}, "url": "https://github.com/vaadin/flow/commit/561673bc60f6b1baf861537b3962724c95db2602", "committedDate": "2020-08-25T11:14:57Z", "message": "Only connect to devServer when it is started\n\nDo not try to connect to the dev server\nif it hasn't started yet or startup has failed.\n\nFixes #8858"}, "afterCommit": {"oid": "461c9bc483295506857fa193db70f2a907fc5a7e", "author": {"user": {"login": "caalador", "name": null}}, "url": "https://github.com/vaadin/flow/commit/461c9bc483295506857fa193db70f2a907fc5a7e", "committedDate": "2020-08-25T11:48:02Z", "message": "Only connect to devServer when it is started\n\nDo not try to connect to the dev server\nif it hasn't started yet or startup has failed.\n\nFixes #8858"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MTUzOTg0", "url": "https://github.com/vaadin/flow/pull/8896#pullrequestreview-475153984", "createdAt": "2020-08-26T05:08:57Z", "commit": {"oid": "461c9bc483295506857fa193db70f2a907fc5a7e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNTowODo1N1rOHG8B1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNToxMTo1MlrOHG8FAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzAzNzAxNA==", "bodyText": "Just curious and checking - what happens now when the previously errored request (for refresh?) will now return false to back to VaadinServlet ?\nWill StaticFileHandler take the request or does VaadinServlet pass it to VaadinServletService ?\nJust looking at the code and seeing that the DevModeHandler was able the return dev-mode-not-ready.html page on these occasions, so wondering what triggered the request which lead to error.", "url": "https://github.com/vaadin/flow/pull/8896#discussion_r477037014", "createdAt": "2020-08-26T05:08:57Z", "author": {"login": "pleku"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/DevModeHandler.java", "diffHunk": "@@ -298,7 +297,8 @@ public boolean isDevModeRequest(HttpServletRequest request) {\n      */\n     public boolean serveDevModeRequest(HttpServletRequest request,\n             HttpServletResponse response) throws IOException {\n-        if (isDevServerFailedToStart.get()) {\n+        // Do not serve requests if dev server starting or failed to start.\n+        if (isDevServerFailedToStart.get() || !devServerStartFuture.isDone()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "461c9bc483295506857fa193db70f2a907fc5a7e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzAzNzgyNg==", "bodyText": "Should there be a unit test which makes sure that the code is not accidentally removed again and devServerStartFuture is considered?", "url": "https://github.com/vaadin/flow/pull/8896#discussion_r477037826", "createdAt": "2020-08-26T05:11:52Z", "author": {"login": "pleku"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/DevModeHandlerTest.java", "diffHunk": "@@ -208,12 +208,12 @@ public void webpackNotInstalled_throws() throws Exception {\n \n     @Test\n     public void webpackIsNotExecutable_throws() {\n-        exception.expectCause(CoreMatchers.isA(ExecutionFailedException.class));\n         // The set executable doesn't work in Windows and will always return\n         // false\n         boolean systemImplementsExecutable = new File(baseDir, WEBPACK_SERVER)\n                 .setExecutable(false);\n         if (systemImplementsExecutable) {\n+            exception.expectCause(CoreMatchers.isA(ExecutionFailedException.class));\n             DevModeHandler.start(configuration, npmFolder,\n                     CompletableFuture.completedFuture(null)).join();\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "461c9bc483295506857fa193db70f2a907fc5a7e"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MTYzMzg0", "url": "https://github.com/vaadin/flow/pull/8896#pullrequestreview-475163384", "createdAt": "2020-08-26T05:36:36Z", "commit": {"oid": "461c9bc483295506857fa193db70f2a907fc5a7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 112, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}