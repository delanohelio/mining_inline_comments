{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4Mjk5NTA0", "number": 8507, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMDo0Mzo1MVrOEC6DVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMDo0Mzo1MVrOEC6DVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDgzNzM0OnYy", "diffSide": "RIGHT", "path": "flow-tests/test-embedding/embedding-test-assets/src/test/java/com/vaadin/flow/webcomponent/EmbeddingChromeBrowserTest.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMDo0Mzo1MVrOGfplyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMzoyODo0M1rOGfue7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MDQ1Ng==", "bodyText": "x => x.shadowRoot\n\nThat didn't work in IE.\nThough we don't run our tests in IE but still : is it possible to write this somehow cross-browser ?", "url": "https://github.com/vaadin/flow/pull/8507#discussion_r435840456", "createdAt": "2020-06-05T10:43:51Z", "author": {"login": "denis-anisimov"}, "path": "flow-tests/test-embedding/embedding-test-assets/src/test/java/com/vaadin/flow/webcomponent/EmbeddingChromeBrowserTest.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package com.vaadin.flow.webcomponent;\n+\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+\n+public abstract class EmbeddingChromeBrowserTest extends ChromeBrowserTest {\n+\n+    @Override\n+    protected void open() {\n+        super.open();\n+\n+        // Wait for at least one shadow root to appear. This is to avoid race\n+        // conditions where the test starts before the shadow root has been\n+        // attached #8329\n+        this.waitUntil((driver) -> Boolean.TRUE\n+                .equals(this.getCommandExecutor().executeScript(\n+                        \"return Array.from(document.getElementsByTagName('*')).some(x => x.shadowRoot !== null)\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27f9895b67e752eeba28e8da10e350adda0f8a8a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg4Nzk4NQ==", "bodyText": "ES5 compat JS.", "url": "https://github.com/vaadin/flow/pull/8507#discussion_r435887985", "createdAt": "2020-06-05T12:28:24Z", "author": {"login": "joheriks"}, "path": "flow-tests/test-embedding/embedding-test-assets/src/test/java/com/vaadin/flow/webcomponent/EmbeddingChromeBrowserTest.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package com.vaadin.flow.webcomponent;\n+\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+\n+public abstract class EmbeddingChromeBrowserTest extends ChromeBrowserTest {\n+\n+    @Override\n+    protected void open() {\n+        super.open();\n+\n+        // Wait for at least one shadow root to appear. This is to avoid race\n+        // conditions where the test starts before the shadow root has been\n+        // attached #8329\n+        this.waitUntil((driver) -> Boolean.TRUE\n+                .equals(this.getCommandExecutor().executeScript(\n+                        \"return Array.from(document.getElementsByTagName('*')).some(x => x.shadowRoot !== null)\")));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MDQ1Ng=="}, "originalCommit": {"oid": "27f9895b67e752eeba28e8da10e350adda0f8a8a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg5NTg0MQ==", "bodyText": "No, sorry, I meant x.shadowRoot .\nI don't know actually what's the output of the compiled production client side code.\nBut for the previous releases production code produced a code which worked in browsers which don't support web components at all .\nIn those browsers shadowRoot just don't exist at all.\nE.g. in IE11 (again: I don't know which browsers we support nowadays) TB has a specific code which checks the element directly in the parent and then tries to use shadowRoot.\nAnd IE11 of course doesn't support =>.", "url": "https://github.com/vaadin/flow/pull/8507#discussion_r435895841", "createdAt": "2020-06-05T12:43:52Z", "author": {"login": "denis-anisimov"}, "path": "flow-tests/test-embedding/embedding-test-assets/src/test/java/com/vaadin/flow/webcomponent/EmbeddingChromeBrowserTest.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package com.vaadin.flow.webcomponent;\n+\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+\n+public abstract class EmbeddingChromeBrowserTest extends ChromeBrowserTest {\n+\n+    @Override\n+    protected void open() {\n+        super.open();\n+\n+        // Wait for at least one shadow root to appear. This is to avoid race\n+        // conditions where the test starts before the shadow root has been\n+        // attached #8329\n+        this.waitUntil((driver) -> Boolean.TRUE\n+                .equals(this.getCommandExecutor().executeScript(\n+                        \"return Array.from(document.getElementsByTagName('*')).some(x => x.shadowRoot !== null)\")));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MDQ1Ng=="}, "originalCommit": {"oid": "27f9895b67e752eeba28e8da10e350adda0f8a8a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNjgyOA==", "bodyText": "I opened the test view in IE8, and the embedded web components just appear as empty tags in the DOM. I don't know if the test is designed to work in IE at all?", "url": "https://github.com/vaadin/flow/pull/8507#discussion_r435906828", "createdAt": "2020-06-05T13:04:08Z", "author": {"login": "joheriks"}, "path": "flow-tests/test-embedding/embedding-test-assets/src/test/java/com/vaadin/flow/webcomponent/EmbeddingChromeBrowserTest.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package com.vaadin.flow.webcomponent;\n+\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+\n+public abstract class EmbeddingChromeBrowserTest extends ChromeBrowserTest {\n+\n+    @Override\n+    protected void open() {\n+        super.open();\n+\n+        // Wait for at least one shadow root to appear. This is to avoid race\n+        // conditions where the test starts before the shadow root has been\n+        // attached #8329\n+        this.waitUntil((driver) -> Boolean.TRUE\n+                .equals(this.getCommandExecutor().executeScript(\n+                        \"return Array.from(document.getElementsByTagName('*')).some(x => x.shadowRoot !== null)\")));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MDQ1Ng=="}, "originalCommit": {"oid": "27f9895b67e752eeba28e8da10e350adda0f8a8a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkyMDYyMQ==", "bodyText": "IE 8 ?\nIE 8 is not supported for sure.\nIE 11 : I don't know.\nBut yeah, may be it has no sense to care about this at the moment.", "url": "https://github.com/vaadin/flow/pull/8507#discussion_r435920621", "createdAt": "2020-06-05T13:28:43Z", "author": {"login": "denis-anisimov"}, "path": "flow-tests/test-embedding/embedding-test-assets/src/test/java/com/vaadin/flow/webcomponent/EmbeddingChromeBrowserTest.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package com.vaadin.flow.webcomponent;\n+\n+import com.vaadin.flow.testutil.ChromeBrowserTest;\n+\n+public abstract class EmbeddingChromeBrowserTest extends ChromeBrowserTest {\n+\n+    @Override\n+    protected void open() {\n+        super.open();\n+\n+        // Wait for at least one shadow root to appear. This is to avoid race\n+        // conditions where the test starts before the shadow root has been\n+        // attached #8329\n+        this.waitUntil((driver) -> Boolean.TRUE\n+                .equals(this.getCommandExecutor().executeScript(\n+                        \"return Array.from(document.getElementsByTagName('*')).some(x => x.shadowRoot !== null)\")));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MDQ1Ng=="}, "originalCommit": {"oid": "27f9895b67e752eeba28e8da10e350adda0f8a8a"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3452, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}