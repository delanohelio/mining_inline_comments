{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NzM5MDc5", "number": 9084, "reviewThreads": {"totalCount": 64, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNFrOEpNWpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxNVrOEpNYDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODYwOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ClientUpdateMode.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNFrOHavxVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNFrOHavxVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzcwMw==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807703", "createdAt": "2020-09-30T21:21:14Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ClientUpdateMode.java", "diffHunk": "@@ -22,7 +22,13 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated Template model and polymer template support is deprecated - we\n+ *             recommend you to use {@code LitTemplate} instead. Read more\n+ *             details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public enum ClientUpdateMode {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODY2OnYy", "diffSide": "RIGHT", "path": "flow-server/src/test/java/com/vaadin/flow/server/DevModeHandlerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNVrOHavxYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNVrOHavxYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzcxNA==", "bodyText": "Remove this use of \"Thread.sleep()\".", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807714", "createdAt": "2020-09-30T21:21:15Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/DevModeHandlerTest.java", "diffHunk": "@@ -514,6 +519,80 @@ public void serveDevModeRequest_prepareTasksThrows_serveDevModeReturnsFalseAndDo\n         Assert.assertFalse(handler.serveDevModeRequest(request, response));\n     }\n \n+    @Test\n+    public void start_twoTimes_onlyOneHandlerInstanceIsCreated() {\n+        MockDeploymentConfiguration configuration = Mockito\n+                .spy(MockDeploymentConfiguration.class);\n+        DevModeHandler handler = DevModeHandler.start(0, configuration,\n+                npmFolder, CompletableFuture.completedFuture(null));\n+        handler.join();\n+\n+        // This is how new server handler instantiation checked:\n+        Mockito.verify(configuration).reuseDevServer();\n+\n+        // \"start\" one more time: there should not be another instance of dev\n+        // mode handler created\n+        DevModeHandler anotherHandler = DevModeHandler.start(0, configuration,\n+                npmFolder, CompletableFuture.completedFuture(null));\n+        anotherHandler.join();\n+\n+        // The handler instances are the same but there should be no attempt to\n+        // create another instance (which won't be stored anywhere), see below\n+        Assert.assertSame(handler, anotherHandler);\n+\n+        // No more \"reuseDevServer\" calls are done: see above, it has been\n+        // already called one time\n+        Mockito.verify(configuration).reuseDevServer();\n+    }\n+\n+    @Test\n+    public void start_twoInstances_secondInstanceUsesAnotherPort()\n+            throws Exception {\n+\n+        // start the first instance\n+        DevModeHandler handler = DevModeHandler.start(0, configuration,\n+                npmFolder, CompletableFuture.completedFuture(null));\n+\n+        // remove the \"singleton\" instance to be able to start another one\n+        removeDevModeHandlerInstance();\n+\n+        // since the timeout is quite big the server port still should be\n+        // available and the second instance should try to reuse it\n+\n+        DevModeHandler.start(0, configuration, npmFolder,\n+                CompletableFuture.completedFuture(null));\n+\n+        // make checks only if webpack has not yet completed\n+\n+        DevModeHandler anotherHandler = DevModeHandler.start(0, configuration,\n+                npmFolder, CompletableFuture.completedFuture(null));\n+\n+        while (handler.getPort() == 0) {\n+            Thread.sleep(100);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 138}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODcxOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ConvertedModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNlrOHavxaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxNlrOHavxaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzcyMQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807721", "createdAt": "2020-09-30T21:21:16Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ConvertedModelType.java", "diffHunk": "@@ -34,7 +34,16 @@\n  *            application type of the converter used by this class\n  * @param <M>\n  *            model type of the converter used by this class\n+ * \n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class ConvertedModelType<A, M extends Serializable>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODc1OnYy", "diffSide": "RIGHT", "path": "flow-lit-template/src/main/java/com/vaadin/flow/component/littemplate/BundleLitParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxN1rOHavxbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxN1rOHavxbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzcyNg==", "bodyText": "Remove this use of \"DEAULT_FLOW_RESOURCES_FOLDER\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807726", "createdAt": "2020-09-30T21:21:17Z", "author": {"login": "vaadin-bot"}, "path": "flow-lit-template/src/main/java/com/vaadin/flow/component/littemplate/BundleLitParser.java", "diffHunk": "@@ -0,0 +1,234 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.littemplate;\n+\n+import static com.vaadin.flow.server.frontend.FrontendUtils.DEAULT_FLOW_RESOURCES_FOLDER;\n+import static com.vaadin.flow.server.frontend.FrontendUtils.FLOW_NPM_PACKAGE_NAME;\n+import static elemental.json.JsonType.ARRAY;\n+import static elemental.json.JsonType.OBJECT;\n+import static elemental.json.JsonType.STRING;\n+\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+import org.jsoup.Jsoup;\n+import org.jsoup.nodes.Document;\n+import org.jsoup.nodes.Element;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.internal.StringUtil;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+\n+/**\n+ * Parse statistics data provided by webpack.\n+ *\n+ * @author Vaadin Ltd\n+ * @since\n+ *\n+ * @see LitTemplateParser\n+ */\n+public final class BundleLitParser {\n+\n+    private static final Logger LOGGER = LoggerFactory\n+            .getLogger(BundleLitParser.class);\n+\n+    private static final String SOURCE = \"source\";\n+    private static final String NAME = \"name\";\n+    private static final String CHUNKS = \"chunks\";\n+    private static final String MODULES = \"modules\";\n+\n+    /**\n+     * Lit template pattern matches the template getter\n+     *\n+     * <pre>\n+     *     render() {\n+     *       return html`\n+     *         &lt;style&gt;\n+     *           .response { margin-top: 10px`; }\n+     *         &lt;/style&gt;\n+     *         &lt;paper-checkbox checked=&quot;${liked}&quot;&gt;I like web components.&lt;/paper-checkbox&gt;\n+     *\n+     *         &lt;div id=&quot;test&quot; ?hidden=&quot;${liked}&quot; class=&quot;response&quot;&gt;Web components like you, too.&lt;/div&gt;\n+     *       `;\n+     *     }\n+     * </pre>\n+     *\n+     * <p>\n+     * <code>render\\(\\)[\\s]*\\{</code> finds the template getter method\n+     * <p>\n+     * <code>[\\s]*return[\\s]*html`</code> finds the return statement\n+     * <p>\n+     * </p>\n+     * <code>(([^`]|\\\\\\\\.)*)</code> captures all text until we encounter the end\n+     * character with <code>;}</code> e.g. <code>';}</code>\n+     */\n+    private static final Pattern LIT_TEMPLATE_PATTERN = Pattern.compile(\n+            \"render\\\\(\\\\)[\\\\s]*\\\\{[\\\\s]*return[\\\\s]*html`(([^`]|\\\\\\\\.)*)`;[\\\\s]*\\\\}\");\n+\n+    private static final Pattern HASH_PATTERN = Pattern\n+            .compile(\"\\\"hash\\\"\\\\s*:\\\\s*\\\"([^\\\"]+)\\\"\\\\s*,\");\n+\n+    private static final String TEMPLATE_TAG_NAME = \"template\";\n+\n+    private BundleLitParser() {\n+    }\n+\n+    /**\n+     * Gets the hash from the string content of a webpack stats file. It uses\n+     * regex to avoid parsing the entire string into a json object.\n+     *\n+     * @param fileContents\n+     *            the content of the stats file\n+     * @return the hash\n+     */\n+    public static String getHashFromStatistics(String fileContents) {\n+        Matcher matcher = HASH_PATTERN.matcher(fileContents);\n+        return matcher.find() ? matcher.group(1) : \"\" + fileContents.length();\n+    }\n+\n+    /**\n+     * Parses the content of the stats file to return a json object.\n+     *\n+     * @param fileContents\n+     *            the content of the stats file\n+     * @return a JsonObject with the stats\n+     */\n+    public static JsonObject parseJsonStatistics(String fileContents) {\n+        return Json.parse(fileContents);\n+    }\n+\n+    /**\n+     * Get a module source from the statistics Json file generated by webpack.\n+     *\n+     * @param fileName\n+     *            name of the file to get from the json\n+     * @param statistics\n+     *            statistics json as a JsonObject\n+     * @return JsonObject for the file statistic\n+     */\n+    public static String getSourceFromStatistics(String fileName,\n+            JsonObject statistics) {\n+        return getSourceFromObject(statistics, fileName);\n+    }\n+\n+    /**\n+     * Get the Lit template element for the given polymer template source.\n+     *\n+     * @param fileName\n+     *            name of the handled file\n+     * @param source\n+     *            source js to get template element from\n+     * @return template element or {code null} if not found\n+     */\n+    public static Element parseLitTemplateElement(String fileName,\n+            String source) {\n+        Document templateDocument = null;\n+        String content = StringUtil.removeComments(source);\n+        Matcher templateMatcher = LIT_TEMPLATE_PATTERN.matcher(content);\n+\n+        // GroupCount should be 2 as the first group contains `|'|\" depending\n+        // on what was in template return html' and the second is the\n+        // template contents.\n+        if (templateMatcher.find() && templateMatcher.groupCount() == 2) {\n+            String group = templateMatcher.group(1);\n+            LOGGER.trace(\"Found regular Lit template content was {}\", group);\n+\n+            templateDocument = Jsoup.parse(group);\n+            LOGGER.trace(\"The parsed template document was {}\",\n+                    templateDocument);\n+            Element template = templateDocument\n+                    .createElement(TEMPLATE_TAG_NAME);\n+            Element body = templateDocument.body();\n+            templateDocument.body().children().stream()\n+                    .filter(node -> !node.equals(body))\n+                    .forEach(template::appendChild);\n+\n+            return template;\n+        }\n+        LOGGER.warn(\"No lit template data found in {} sources.\", fileName);\n+        return null;\n+    }\n+\n+    // find the first module whose name matches the file name\n+    private static String getSourceFromObject(JsonObject module,\n+            String fileName) {\n+        String source = null;\n+        if (validKey(module, MODULES, ARRAY)) {\n+            source = getSourceFromArray(module.getArray(MODULES), fileName);\n+        }\n+        if (source == null && validKey(module, CHUNKS, ARRAY)) {\n+            source = getSourceFromArray(module.getArray(CHUNKS), fileName);\n+        }\n+        if (source == null && validKey(module, NAME, STRING)\n+                && validKey(module, SOURCE, STRING)) {\n+            String name = module.getString(NAME);\n+\n+            // append `.js` extension if not yet as webpack does\n+            fileName = fileName.replaceFirst(\"(\\\\.js|)$\", \".js\");\n+\n+            String alternativeFileName = fileName\n+                    // Replace frontend part since webpack entry-point is\n+                    // already in the frontend folder\n+                    .replaceFirst(\"^(\\\\./)frontend/\", \"$1\")\n+                    // Replace the flow frontend protocol\n+                    .replaceFirst(\"^frontend://\", \".\");\n+\n+            // For templates inside add-ons we will not find the sources\n+            // using ./ as the actual path contains\n+            // \"node_modules/@vaadin/flow-frontend/\" instead of \"./\"\n+            // \"target/flow-frontend/\" instead of \"./\"\n+            if (name.contains(FLOW_NPM_PACKAGE_NAME)\n+                    || name.contains(DEAULT_FLOW_RESOURCES_FOLDER)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 199}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODgxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/AbstractServerHandlers.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxOFrOHavxeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxOFrOHavxeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzczNg==", "bodyText": "Remove this use of \"getHandlerAnnotation\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807736", "createdAt": "2020-09-30T21:21:18Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/AbstractServerHandlers.java", "diffHunk": "@@ -205,9 +216,20 @@ protected void ensureSupportedReturnType(Method method) {\n      * Gets the annotation which is used to mark methods as handlers.\n      *\n      * @return the handler marker annotation\n+     * @deprecated Implement {@link #getHandlerAnnotationFqn()} instead\n      */\n+    @Deprecated\n     protected abstract Class<? extends Annotation> getHandlerAnnotation();\n \n+    /**\n+     * Gets the annotation FQN which is used to mark methods as handlers.\n+     *\n+     * @return the handler marker annotation\n+     */\n+    protected String getHandlerAnnotationFqn() {\n+        return getHandlerAnnotation().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODkwOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/AbstractServerHandlers.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxOVrOHavxgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToxOVrOHavxgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc0Nw==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807747", "createdAt": "2020-09-30T21:21:19Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/AbstractServerHandlers.java", "diffHunk": "@@ -205,9 +216,20 @@ protected void ensureSupportedReturnType(Method method) {\n      * Gets the annotation which is used to mark methods as handlers.\n      *\n      * @return the handler marker annotation\n+     * @deprecated Implement {@link #getHandlerAnnotationFqn()} instead\n      */\n+    @Deprecated\n     protected abstract Class<? extends Annotation> getHandlerAnnotation();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODkzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdCollector.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMFrOHavxjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMFrOHavxjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc1Ng==", "bodyText": "Rename this class. \n Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807756", "createdAt": "2020-09-30T21:21:20Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdCollector.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate;\n+\n+import org.jsoup.nodes.Element;\n+\n+import com.vaadin.flow.component.template.Id;\n+\n+/**\n+ * Collects information of {@link Id @Id} mapped fields in a template class.\n+ *\n+ * @since 2.0\n+ * @deprecated Use\n+ *             {@link com.vaadin.flow.component.template.internal.IdCollector}\n+ *             instead. Polymer template support is deprecated - we recommend\n+ *             you to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class IdCollector", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1ODk5OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdCollector.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMVrOHavxkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMVrOHavxkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc2Mw==", "bodyText": "The class name com.vaadin.flow.component.polymertemplate.IdCollector shadows the simple name of the superclass com.vaadin.flow.component.template.internal.IdCollector", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807763", "createdAt": "2020-09-30T21:21:21Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdCollector.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate;\n+\n+import org.jsoup.nodes.Element;\n+\n+import com.vaadin.flow.component.template.Id;\n+\n+/**\n+ * Collects information of {@link Id @Id} mapped fields in a template class.\n+ *\n+ * @since 2.0\n+ * @deprecated Use\n+ *             {@link com.vaadin.flow.component.template.internal.IdCollector}\n+ *             instead. Polymer template support is deprecated - we recommend\n+ *             you to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class IdCollector\n+        extends com.vaadin.flow.component.template.internal.IdCollector {\n+\n+    /**\n+     * Creates a collector the the given template.\n+     *\n+     * @param templateClass\n+     *            the template class, containing the {@code @Id} fields\n+     * @param templateFile\n+     *            The name of the file containing the template or\n+     *            <code>null</code> if not available {@code null}\n+     * @param templateRoot\n+     *            The root element of the template or <code>null</code> if not\n+     *            available\n+     */\n+    public IdCollector(Class<?> templateClass, String templateFile,\n+            Element templateRoot) {\n+        super(templateClass, templateFile, templateRoot);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTA0OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdMapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMVrOHavxnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMVrOHavxnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc3Mw==", "bodyText": "Rename this class. \n Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807773", "createdAt": "2020-09-30T21:21:21Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdMapper.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate;\n+\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.template.Id;\n+\n+/**\n+ * Creates or maps Element instances to fields mapped using {@link Id @Id}.\n+ *\n+ * @since 2.0\n+ * @deprecated Use {@link com.vaadin.flow.component.template.internal.IdMapper}\n+ *             instead.Polymer template support is deprecated - we recommend you\n+ *             to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class IdMapper", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTA1OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdMapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMlrOHavxoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyMlrOHavxoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc3Ng==", "bodyText": "The class name com.vaadin.flow.component.polymertemplate.IdMapper shadows the simple name of the superclass com.vaadin.flow.component.template.internal.IdMapper", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807776", "createdAt": "2020-09-30T21:21:22Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/IdMapper.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate;\n+\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.template.Id;\n+\n+/**\n+ * Creates or maps Element instances to fields mapped using {@link Id @Id}.\n+ *\n+ * @since 2.0\n+ * @deprecated Use {@link com.vaadin.flow.component.template.internal.IdMapper}\n+ *             instead.Polymer template support is deprecated - we recommend you\n+ *             to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class IdMapper\n+        extends com.vaadin.flow.component.template.internal.IdMapper {\n+\n+    /**\n+     * Creates a mapper for the given template.\n+     *\n+     * @param template\n+     *            a template instance\n+     */\n+    public IdMapper(Component template) {\n+        super(template);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTA5OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/Id.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyM1rOHavxpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyM1rOHavxpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc4Mg==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807782", "createdAt": "2020-09-30T21:21:23Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/Id.java", "diffHunk": "@@ -75,10 +75,16 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated Use com.vaadin.flow.component.template.Id instead. Polymer\n+ *             template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n @Retention(RetentionPolicy.RUNTIME)\n @Target(ElementType.FIELD)\n @Documented\n+@Deprecated\n public @interface Id {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTExOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/InjectablePolymerElementInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyNFrOHavxqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyNFrOHavxqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc4Nw==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807787", "createdAt": "2020-09-30T21:21:24Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/InjectablePolymerElementInitializer.java", "diffHunk": "@@ -27,8 +27,14 @@\n  * \n  * @author Vaadin Ltd\n  * @since\n- *\n+ * @deprecated {@code InjectableLitElementInitializer} should be used for Lit\n+ *             templates since polymer support is deprecated, we recommend you\n+ *             to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class InjectablePolymerElementInitializer", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTE2OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyNVrOHavxtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyNVrOHavxtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzc5OA==", "bodyText": "This block of commented-out lines of code should be removed.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807798", "createdAt": "2020-09-30T21:21:25Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "diffHunk": "@@ -48,8 +50,15 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated Use {@code LitTemplateDataAnalyzer} for {@code LitTemplate}\n+ *             components. Polymer template support is deprecated - we recommend\n+ *             you to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  *\n  */\n+@Deprecated\n public class TemplateDataAnalyzer {\n \n     // {{propertyName}} or {{propertyName::event}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTI0OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyNlrOHavxww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyNlrOHavxww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzgxMQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807811", "createdAt": "2020-09-30T21:21:26Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "diffHunk": "@@ -91,18 +100,17 @@\n          * @param tag\n          *            the element tag\n          */\n+        @Override\n         void apply(Field field, String id, String tag);\n     }\n \n     /**\n      * Immutable parser data which may be stored in cache.\n+     * \n+     * Use {@link ParserData} instead.\n      */\n-    public static class ParserData {\n-\n-        private final Map<String, String> tagById;\n-        private final Map<Field, String> idByField;\n-\n-        private final Map<String, Map<String, String>> attributesById;\n+    @Deprecated\n+    public static class PolymerParserData extends ParserData {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTI4OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyN1rOHavxyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyN1rOHavxyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzgxNw==", "bodyText": "Replace this lambda with a method reference.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807817", "createdAt": "2020-09-30T21:21:27Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "diffHunk": "@@ -141,23 +148,9 @@ public ParserData(Map<Field, String> fields, Map<String, String> tags,\n          *            the consumer to call for each mapped field\n          */\n         public void forEachInjectedField(InjectableFieldCunsumer consumer) {\n-            idByField.forEach(\n-                    (field, id) -> consumer.apply(field, id, tagById.get(id)));\n-        }\n-\n-        /**\n-         * Gets template element data (attribute values).\n-         * \n-         * @param id\n-         *            the id of the element\n-         * @return template data\n-         */\n-        public Map<String, String> getAttributes(String id) {\n-            Map<String, String> attrs = attributesById.get(id);\n-            if (attrs == null) {\n-                return Collections.emptyMap();\n-            }\n-            return attrs;\n+            InjectableFieldConsumer delegate = (field, id, tag) -> consumer", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTMzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyOFrOHavxzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyOFrOHavxzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzgyMw==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807823", "createdAt": "2020-09-30T21:21:28Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateDataAnalyzer.java", "diffHunk": "@@ -48,8 +50,15 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated Use {@code LitTemplateDataAnalyzer} for {@code LitTemplate}\n+ *             components. Polymer template support is deprecated - we recommend\n+ *             you to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  *\n  */\n+@Deprecated\n public class TemplateDataAnalyzer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTQ2OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/BeanModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyOVrOHavx3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMToyOVrOHavx3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzgzOA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807838", "createdAt": "2020-09-30T21:21:29Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/BeanModelType.java", "diffHunk": "@@ -50,7 +50,15 @@\n  * @since 1.0\n  * @param <T>\n  *            the proxy type used by this bean type\n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class BeanModelType<T> implements ComplexModelType<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTUwOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/BundleParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozMFrOHavx5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozMFrOHavx5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg0Nw==", "bodyText": "Reduce the total number of break and continue statements in this loop to use at most one.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807847", "createdAt": "2020-09-30T21:21:30Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/BundleParser.java", "diffHunk": "@@ -229,44 +206,6 @@ public static Element parseTemplateElement(String fileName, String source) {\n         return template;\n     }\n \n-    /**\n-     * Get the Lit template element for the given polymer template source.\n-     *\n-     * @param fileName\n-     *            name of the handled file\n-     * @param source\n-     *            source js to get template element from\n-     * @return template element or {code null} if not found\n-     */\n-    public static Element parseLitTemplateElement(String fileName,\n-            String source) {\n-        Document templateDocument = null;\n-        String content = StringUtil.removeComments(source);\n-        Matcher templateMatcher = LIT_TEMPLATE_PATTERN.matcher(content);\n-\n-        // GroupCount should be 2 as the first group contains `|'|\" depending\n-        // on what was in template return html' and the second is the\n-        // template contents.\n-        if (templateMatcher.find() && templateMatcher.groupCount() == 2) {\n-            String group = templateMatcher.group(1);\n-            LOGGER.trace(\"Found regular Lit template content was {}\", group);\n-\n-            templateDocument = Jsoup.parse(group);\n-            LOGGER.trace(\"The parsed template document was {}\",\n-                    templateDocument);\n-            Element template = templateDocument\n-                    .createElement(TEMPLATE_TAG_NAME);\n-            Element body = templateDocument.body();\n-            templateDocument.body().children().stream()\n-                    .filter(node -> !node.equals(body))\n-                    .forEach(template::appendChild);\n-\n-            return template;\n-        }\n-        LOGGER.warn(\"No lit template data found in {} sources.\", fileName);\n-        return null;\n-    }\n-\n     private static Element tryParsePolymer2(Document templateDocument,\n             Matcher noTemplateMatcher) {\n         while (noTemplateMatcher.find()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTUzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/BundleParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozMVrOHavx7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozMVrOHavx7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg1Mg==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807852", "createdAt": "2020-09-30T21:21:31Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/BundleParser.java", "diffHunk": "@@ -46,7 +46,13 @@\n  * @since 2.0\n  *\n  * @see NpmTemplateParser\n+ * @deprecated Use {@code BundleLitParser} to parse Lit template since polymer\n+ *             template is deprecated, we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public final class BundleParser {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTU4OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/PathLookup.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozMlrOHavx9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozMlrOHavx9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg2MQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807861", "createdAt": "2020-09-30T21:21:32Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/PathLookup.java", "diffHunk": "@@ -27,7 +27,14 @@\n  * @since 1.0\n  * @param <T>\n  *            the item type\n+ * @deprecated This functionality is internal and bound to template model which\n+ *             is not supported for lit template. Polymer template support is\n+ *             deprecated - we recommend you to use {@code LitTemplate} instead.\n+ *             Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class PathLookup<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTY2OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/BasicModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozM1rOHavx_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozM1rOHavx_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg3MA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807870", "createdAt": "2020-09-30T21:21:33Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/BasicModelType.java", "diffHunk": "@@ -25,7 +25,16 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class BasicModelType extends AbstractBasicModelType {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTc0OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ListModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozNFrOHavyBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozNFrOHavyBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg3OQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807879", "createdAt": "2020-09-30T21:21:34Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ListModelType.java", "diffHunk": "@@ -39,7 +38,16 @@\n  * @since 1.0\n  * @param <T>\n  *            the proxy type used by the bean type of this type\n+ * \n+ * @deprecated Template model and polymer template support is deprecated - we\n+ *             recommend you to use {@code LitTemplate} instead. Read more\n+ *             details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a> For lit templates, you can use {@code @Id}\n+ *             mapping and the component API or the element API with property\n+ *             synchronization instead.\n  */\n+@Deprecated\n public class ListModelType<T> implements ComplexModelType<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTgyOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ComplexModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozNVrOHavyEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozNVrOHavyEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg5MA==", "bodyText": "T is not used in the interface. \n Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807890", "createdAt": "2020-09-30T21:21:35Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ComplexModelType.java", "diffHunk": "@@ -25,7 +25,15 @@\n  *\n  * @param <T>\n  *            the proxy type used by this type\n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public interface ComplexModelType<T> extends ModelType {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTg4OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModelUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozNlrOHavyGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozNlrOHavyGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzg5OA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807898", "createdAt": "2020-09-30T21:21:36Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModelUtil.java", "diffHunk": "@@ -31,7 +31,15 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated This functionality is internal and bound to template model which\n+ *             is not supported for lit template. Polymer template support is\n+ *             deprecated - we recommend you to use {@code LitTemplate} instead.\n+ *             Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public final class TemplateModelUtil {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTk0OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozN1rOHavyIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozN1rOHavyIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzkwNA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807904", "createdAt": "2020-09-30T21:21:37Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate.rpc;\n+\n+import java.io.Serializable;\n+import java.lang.reflect.Array;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.lang.reflect.Type;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.component.ClientCallable;\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.Composite;\n+import com.vaadin.flow.component.polymertemplate.EventHandler;\n+import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n+import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.internal.StateNode;\n+import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n+import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n+import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n+import com.vaadin.flow.server.communication.rpc.DefaultRpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.RpcDecodeException;\n+import com.vaadin.flow.server.communication.rpc.RpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToEnumDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToNumberDecoder;\n+import com.vaadin.flow.shared.JsonConstants;\n+import com.vaadin.flow.templatemodel.ModelType;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+import elemental.json.JsonValue;\n+\n+/**\n+ * RPC handler for events triggered through <code>element.$server</code> or\n+ * simply <code>$server</code> in template event handlers.\n+ *\n+ * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n+ *\n+ * @author Vaadin Ltd\n+ * @since 1.0\n+ *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class PublishedServerEventHandlerRpcHandler implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ1OTk3OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozN1rOHavyJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozN1rOHavyJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzkxMA==", "bodyText": "Define and throw a dedicated exception instead of using a generic one.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807910", "createdAt": "2020-09-30T21:21:37Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate.rpc;\n+\n+import java.io.Serializable;\n+import java.lang.reflect.Array;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.lang.reflect.Type;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.component.ClientCallable;\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.Composite;\n+import com.vaadin.flow.component.polymertemplate.EventHandler;\n+import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n+import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.internal.StateNode;\n+import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n+import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n+import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n+import com.vaadin.flow.server.communication.rpc.DefaultRpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.RpcDecodeException;\n+import com.vaadin.flow.server.communication.rpc.RpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToEnumDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToNumberDecoder;\n+import com.vaadin.flow.shared.JsonConstants;\n+import com.vaadin.flow.templatemodel.ModelType;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+import elemental.json.JsonValue;\n+\n+/**\n+ * RPC handler for events triggered through <code>element.$server</code> or\n+ * simply <code>$server</code> in template event handlers.\n+ *\n+ * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n+ *\n+ * @author Vaadin Ltd\n+ * @since 1.0\n+ *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class PublishedServerEventHandlerRpcHandler implements Serializable {\n+\n+    private static final Collection<RpcDecoder> DECODERS = loadDecoders();\n+\n+    public static void handleNode(StateNode node, JsonObject invocationJson) {\n+        assert invocationJson\n+                .hasKey(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        String methodName = invocationJson\n+                .getString(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        if (methodName == null) {\n+            throw new IllegalArgumentException(\n+                    \"Event handler method name may not be null\");\n+        }\n+        JsonValue args = invocationJson\n+                .get(JsonConstants.RPC_TEMPLATE_EVENT_ARGS);\n+        if (args == null) {\n+            args = Json.createArray();\n+        }\n+        if (args.getType() != JsonType.ARRAY) {\n+            throw new IllegalArgumentException(\n+                    \"Incorrect type for method arguments: \" + args.getClass());\n+        }\n+        int promiseId;\n+        if (invocationJson.hasKey(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE)) {\n+            promiseId = (int) invocationJson\n+                    .getNumber(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE);\n+        } else {\n+            promiseId = -1;\n+        }\n+        assert node.hasFeature(ComponentMapping.class);\n+        Optional<Component> component = ComponentMapping.getComponent(node);\n+        if (!component.isPresent()) {\n+            throw new IllegalStateException(\n+                    \"Unable to handle RPC template event JSON message: \"\n+                            + \"there is no component available for the target node\");\n+        }\n+\n+        boolean execute = node.isEnabled();\n+\n+        if (!execute) {\n+            ClientCallableHandlers clientDelegate = node\n+                    .getFeature(ClientCallableHandlers.class);\n+            PolymerServerEventHandlers eventHandlers = node\n+                    .getFeature(PolymerServerEventHandlers.class);\n+            if (clientDelegate.hasHandler(methodName)) {\n+                execute = DisabledUpdateMode.ALWAYS.equals(\n+                        clientDelegate.getDisabledUpdateMode(methodName));\n+            }\n+            if (eventHandlers.hasHandler(methodName)) {\n+                execute = execute || DisabledUpdateMode.ALWAYS.equals(\n+                        eventHandlers.getDisabledUpdateMode(methodName));\n+            }\n+        }\n+\n+        if (execute) {\n+            invokeMethod(component.get(), component.get().getClass(),\n+                    methodName, (JsonArray) args, promiseId);\n+        }\n+    }\n+\n+    static void invokeMethod(Component instance, Class<?> clazz,\n+            String methodName, JsonArray args, int promiseId) {\n+        assert instance != null;\n+        Optional<Method> method = findMethod(instance, clazz, methodName);\n+        if (method.isPresent()) {\n+            invokeMethod(instance, method.get(), args, promiseId);\n+        } else if (instance instanceof Composite) {\n+            Component compositeContent = ((Composite<?>) instance).getContent();\n+            invokeMethod(compositeContent, compositeContent.getClass(),\n+                    methodName, args, promiseId);\n+        } else {\n+            String msg = String.format(\"Neither class '%s' \"\n+                    + \"nor its super classes declare event handler method '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        }\n+    }\n+\n+    private static Optional<Method> findMethod(Component instance,\n+            Class<?> clazz, String methodName) {\n+        List<Method> methods = Stream.of(clazz.getDeclaredMethods())\n+                .filter(method -> methodName.equals(method.getName()))\n+                .filter(method -> method.isAnnotationPresent(EventHandler.class)\n+                        || method.isAnnotationPresent(ClientCallable.class))\n+                .collect(Collectors.toList());\n+        if (methods.size() > 1) {\n+            String msg = String.format(\"Class '%s' contains \"\n+                    + \"several event handler method with the same name '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        } else if (methods.size() == 1) {\n+            return Optional.of(methods.get(0));\n+        } else if (!Component.class.equals(clazz)) {\n+            return findMethod(instance, clazz.getSuperclass(), methodName);\n+        } else {\n+            return Optional.empty();\n+        }\n+    }\n+\n+    private static void invokeMethod(Component instance, Method method,\n+            JsonArray args, int promiseId) {\n+        if (promiseId == -1) {\n+            invokeMethod(instance, method, args);\n+        } else {\n+            try {\n+                Serializable returnValue = (Serializable) invokeMethod(instance,\n+                        method, args);\n+\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, true, $1)\",\n+                                Integer.valueOf(promiseId), returnValue);\n+            } catch (RuntimeException e) {\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, false)\", Integer.valueOf(promiseId));\n+\n+                throw e;\n+            }\n+        }\n+    }\n+\n+    private static Object invokeMethod(Component instance, Method method,\n+            JsonArray args) {\n+        try {\n+            method.setAccessible(true);\n+            return method.invoke(instance, decodeArgs(instance, method, args));\n+        } catch (IllegalAccessException e) {\n+            throw new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 202}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDA0OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozOVrOHavyLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTozOVrOHavyLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzkxNw==", "bodyText": "Document this public method by adding an explicit description.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807917", "createdAt": "2020-09-30T21:21:39Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate.rpc;\n+\n+import java.io.Serializable;\n+import java.lang.reflect.Array;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.lang.reflect.Type;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.component.ClientCallable;\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.Composite;\n+import com.vaadin.flow.component.polymertemplate.EventHandler;\n+import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n+import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.internal.StateNode;\n+import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n+import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n+import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n+import com.vaadin.flow.server.communication.rpc.DefaultRpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.RpcDecodeException;\n+import com.vaadin.flow.server.communication.rpc.RpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToEnumDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToNumberDecoder;\n+import com.vaadin.flow.shared.JsonConstants;\n+import com.vaadin.flow.templatemodel.ModelType;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+import elemental.json.JsonValue;\n+\n+/**\n+ * RPC handler for events triggered through <code>element.$server</code> or\n+ * simply <code>$server</code> in template event handlers.\n+ *\n+ * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n+ *\n+ * @author Vaadin Ltd\n+ * @since 1.0\n+ *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class PublishedServerEventHandlerRpcHandler implements Serializable {\n+\n+    private static final Collection<RpcDecoder> DECODERS = loadDecoders();\n+\n+    public static void handleNode(StateNode node, JsonObject invocationJson) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDA4OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MFrOHavyNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MFrOHavyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzkyNg==", "bodyText": "Define and throw a dedicated exception instead of using a generic one.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807926", "createdAt": "2020-09-30T21:21:40Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate.rpc;\n+\n+import java.io.Serializable;\n+import java.lang.reflect.Array;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.lang.reflect.Type;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.component.ClientCallable;\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.Composite;\n+import com.vaadin.flow.component.polymertemplate.EventHandler;\n+import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n+import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.internal.StateNode;\n+import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n+import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n+import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n+import com.vaadin.flow.server.communication.rpc.DefaultRpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.RpcDecodeException;\n+import com.vaadin.flow.server.communication.rpc.RpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToEnumDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToNumberDecoder;\n+import com.vaadin.flow.shared.JsonConstants;\n+import com.vaadin.flow.templatemodel.ModelType;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+import elemental.json.JsonValue;\n+\n+/**\n+ * RPC handler for events triggered through <code>element.$server</code> or\n+ * simply <code>$server</code> in template event handlers.\n+ *\n+ * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n+ *\n+ * @author Vaadin Ltd\n+ * @since 1.0\n+ *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class PublishedServerEventHandlerRpcHandler implements Serializable {\n+\n+    private static final Collection<RpcDecoder> DECODERS = loadDecoders();\n+\n+    public static void handleNode(StateNode node, JsonObject invocationJson) {\n+        assert invocationJson\n+                .hasKey(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        String methodName = invocationJson\n+                .getString(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        if (methodName == null) {\n+            throw new IllegalArgumentException(\n+                    \"Event handler method name may not be null\");\n+        }\n+        JsonValue args = invocationJson\n+                .get(JsonConstants.RPC_TEMPLATE_EVENT_ARGS);\n+        if (args == null) {\n+            args = Json.createArray();\n+        }\n+        if (args.getType() != JsonType.ARRAY) {\n+            throw new IllegalArgumentException(\n+                    \"Incorrect type for method arguments: \" + args.getClass());\n+        }\n+        int promiseId;\n+        if (invocationJson.hasKey(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE)) {\n+            promiseId = (int) invocationJson\n+                    .getNumber(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE);\n+        } else {\n+            promiseId = -1;\n+        }\n+        assert node.hasFeature(ComponentMapping.class);\n+        Optional<Component> component = ComponentMapping.getComponent(node);\n+        if (!component.isPresent()) {\n+            throw new IllegalStateException(\n+                    \"Unable to handle RPC template event JSON message: \"\n+                            + \"there is no component available for the target node\");\n+        }\n+\n+        boolean execute = node.isEnabled();\n+\n+        if (!execute) {\n+            ClientCallableHandlers clientDelegate = node\n+                    .getFeature(ClientCallableHandlers.class);\n+            PolymerServerEventHandlers eventHandlers = node\n+                    .getFeature(PolymerServerEventHandlers.class);\n+            if (clientDelegate.hasHandler(methodName)) {\n+                execute = DisabledUpdateMode.ALWAYS.equals(\n+                        clientDelegate.getDisabledUpdateMode(methodName));\n+            }\n+            if (eventHandlers.hasHandler(methodName)) {\n+                execute = execute || DisabledUpdateMode.ALWAYS.equals(\n+                        eventHandlers.getDisabledUpdateMode(methodName));\n+            }\n+        }\n+\n+        if (execute) {\n+            invokeMethod(component.get(), component.get().getClass(),\n+                    methodName, (JsonArray) args, promiseId);\n+        }\n+    }\n+\n+    static void invokeMethod(Component instance, Class<?> clazz,\n+            String methodName, JsonArray args, int promiseId) {\n+        assert instance != null;\n+        Optional<Method> method = findMethod(instance, clazz, methodName);\n+        if (method.isPresent()) {\n+            invokeMethod(instance, method.get(), args, promiseId);\n+        } else if (instance instanceof Composite) {\n+            Component compositeContent = ((Composite<?>) instance).getContent();\n+            invokeMethod(compositeContent, compositeContent.getClass(),\n+                    methodName, args, promiseId);\n+        } else {\n+            String msg = String.format(\"Neither class '%s' \"\n+                    + \"nor its super classes declare event handler method '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        }\n+    }\n+\n+    private static Optional<Method> findMethod(Component instance,\n+            Class<?> clazz, String methodName) {\n+        List<Method> methods = Stream.of(clazz.getDeclaredMethods())\n+                .filter(method -> methodName.equals(method.getName()))\n+                .filter(method -> method.isAnnotationPresent(EventHandler.class)\n+                        || method.isAnnotationPresent(ClientCallable.class))\n+                .collect(Collectors.toList());\n+        if (methods.size() > 1) {\n+            String msg = String.format(\"Class '%s' contains \"\n+                    + \"several event handler method with the same name '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        } else if (methods.size() == 1) {\n+            return Optional.of(methods.get(0));\n+        } else if (!Component.class.equals(clazz)) {\n+            return findMethod(instance, clazz.getSuperclass(), methodName);\n+        } else {\n+            return Optional.empty();\n+        }\n+    }\n+\n+    private static void invokeMethod(Component instance, Method method,\n+            JsonArray args, int promiseId) {\n+        if (promiseId == -1) {\n+            invokeMethod(instance, method, args);\n+        } else {\n+            try {\n+                Serializable returnValue = (Serializable) invokeMethod(instance,\n+                        method, args);\n+\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, true, $1)\",\n+                                Integer.valueOf(promiseId), returnValue);\n+            } catch (RuntimeException e) {\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, false)\", Integer.valueOf(promiseId));\n+\n+                throw e;\n+            }\n+        }\n+    }\n+\n+    private static Object invokeMethod(Component instance, Method method,\n+            JsonArray args) {\n+        try {\n+            method.setAccessible(true);\n+            return method.invoke(instance, decodeArgs(instance, method, args));\n+        } catch (IllegalAccessException e) {\n+            throw new RuntimeException(e);\n+        } catch (InvocationTargetException e) {\n+            LoggerFactory.getLogger(\n+                    PublishedServerEventHandlerRpcHandler.class.getName())\n+                    .debug(null, e);\n+            throw new RuntimeException(e.getCause());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 207}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDEzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MFrOHavyPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MFrOHavyPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzkzMg==", "bodyText": "Merge this if statement with the enclosing one.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807932", "createdAt": "2020-09-30T21:21:40Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate.rpc;\n+\n+import java.io.Serializable;\n+import java.lang.reflect.Array;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.lang.reflect.Type;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.component.ClientCallable;\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.Composite;\n+import com.vaadin.flow.component.polymertemplate.EventHandler;\n+import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n+import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.internal.StateNode;\n+import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n+import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n+import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n+import com.vaadin.flow.server.communication.rpc.DefaultRpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.RpcDecodeException;\n+import com.vaadin.flow.server.communication.rpc.RpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToEnumDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToNumberDecoder;\n+import com.vaadin.flow.shared.JsonConstants;\n+import com.vaadin.flow.templatemodel.ModelType;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+import elemental.json.JsonValue;\n+\n+/**\n+ * RPC handler for events triggered through <code>element.$server</code> or\n+ * simply <code>$server</code> in template event handlers.\n+ *\n+ * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n+ *\n+ * @author Vaadin Ltd\n+ * @since 1.0\n+ *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class PublishedServerEventHandlerRpcHandler implements Serializable {\n+\n+    private static final Collection<RpcDecoder> DECODERS = loadDecoders();\n+\n+    public static void handleNode(StateNode node, JsonObject invocationJson) {\n+        assert invocationJson\n+                .hasKey(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        String methodName = invocationJson\n+                .getString(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        if (methodName == null) {\n+            throw new IllegalArgumentException(\n+                    \"Event handler method name may not be null\");\n+        }\n+        JsonValue args = invocationJson\n+                .get(JsonConstants.RPC_TEMPLATE_EVENT_ARGS);\n+        if (args == null) {\n+            args = Json.createArray();\n+        }\n+        if (args.getType() != JsonType.ARRAY) {\n+            throw new IllegalArgumentException(\n+                    \"Incorrect type for method arguments: \" + args.getClass());\n+        }\n+        int promiseId;\n+        if (invocationJson.hasKey(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE)) {\n+            promiseId = (int) invocationJson\n+                    .getNumber(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE);\n+        } else {\n+            promiseId = -1;\n+        }\n+        assert node.hasFeature(ComponentMapping.class);\n+        Optional<Component> component = ComponentMapping.getComponent(node);\n+        if (!component.isPresent()) {\n+            throw new IllegalStateException(\n+                    \"Unable to handle RPC template event JSON message: \"\n+                            + \"there is no component available for the target node\");\n+        }\n+\n+        boolean execute = node.isEnabled();\n+\n+        if (!execute) {\n+            ClientCallableHandlers clientDelegate = node\n+                    .getFeature(ClientCallableHandlers.class);\n+            PolymerServerEventHandlers eventHandlers = node\n+                    .getFeature(PolymerServerEventHandlers.class);\n+            if (clientDelegate.hasHandler(methodName)) {\n+                execute = DisabledUpdateMode.ALWAYS.equals(\n+                        clientDelegate.getDisabledUpdateMode(methodName));\n+            }\n+            if (eventHandlers.hasHandler(methodName)) {\n+                execute = execute || DisabledUpdateMode.ALWAYS.equals(\n+                        eventHandlers.getDisabledUpdateMode(methodName));\n+            }\n+        }\n+\n+        if (execute) {\n+            invokeMethod(component.get(), component.get().getClass(),\n+                    methodName, (JsonArray) args, promiseId);\n+        }\n+    }\n+\n+    static void invokeMethod(Component instance, Class<?> clazz,\n+            String methodName, JsonArray args, int promiseId) {\n+        assert instance != null;\n+        Optional<Method> method = findMethod(instance, clazz, methodName);\n+        if (method.isPresent()) {\n+            invokeMethod(instance, method.get(), args, promiseId);\n+        } else if (instance instanceof Composite) {\n+            Component compositeContent = ((Composite<?>) instance).getContent();\n+            invokeMethod(compositeContent, compositeContent.getClass(),\n+                    methodName, args, promiseId);\n+        } else {\n+            String msg = String.format(\"Neither class '%s' \"\n+                    + \"nor its super classes declare event handler method '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        }\n+    }\n+\n+    private static Optional<Method> findMethod(Component instance,\n+            Class<?> clazz, String methodName) {\n+        List<Method> methods = Stream.of(clazz.getDeclaredMethods())\n+                .filter(method -> methodName.equals(method.getName()))\n+                .filter(method -> method.isAnnotationPresent(EventHandler.class)\n+                        || method.isAnnotationPresent(ClientCallable.class))\n+                .collect(Collectors.toList());\n+        if (methods.size() > 1) {\n+            String msg = String.format(\"Class '%s' contains \"\n+                    + \"several event handler method with the same name '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        } else if (methods.size() == 1) {\n+            return Optional.of(methods.get(0));\n+        } else if (!Component.class.equals(clazz)) {\n+            return findMethod(instance, clazz.getSuperclass(), methodName);\n+        } else {\n+            return Optional.empty();\n+        }\n+    }\n+\n+    private static void invokeMethod(Component instance, Method method,\n+            JsonArray args, int promiseId) {\n+        if (promiseId == -1) {\n+            invokeMethod(instance, method, args);\n+        } else {\n+            try {\n+                Serializable returnValue = (Serializable) invokeMethod(instance,\n+                        method, args);\n+\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, true, $1)\",\n+                                Integer.valueOf(promiseId), returnValue);\n+            } catch (RuntimeException e) {\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, false)\", Integer.valueOf(promiseId));\n+\n+                throw e;\n+            }\n+        }\n+    }\n+\n+    private static Object invokeMethod(Component instance, Method method,\n+            JsonArray args) {\n+        try {\n+            method.setAccessible(true);\n+            return method.invoke(instance, decodeArgs(instance, method, args));\n+        } catch (IllegalAccessException e) {\n+            throw new RuntimeException(e);\n+        } catch (InvocationTargetException e) {\n+            LoggerFactory.getLogger(\n+                    PublishedServerEventHandlerRpcHandler.class.getName())\n+                    .debug(null, e);\n+            throw new RuntimeException(e.getCause());\n+        }\n+    }\n+\n+    private static Object[] decodeArgs(Component instance, Method method,\n+            JsonArray argsFromClient) {\n+        int methodArgs = method.getParameterCount();\n+        int clientValuesCount = argsFromClient.length();\n+        JsonArray argValues;\n+        if (method.isVarArgs()) {\n+            if (clientValuesCount >= methodArgs - 1) {\n+                argValues = unwrapVarArgs(argsFromClient, method);\n+            } else {\n+                String msg = String.format(\n+                        \"The number of received values (%d) is not enough \"\n+                                + \"to call the method '%s' declared in '%s' which \"\n+                                + \"has vararg parameter and the number of arguments %d\",\n+                        argsFromClient.length(), method.getName(),\n+                        method.getDeclaringClass().getName(),\n+                        method.getParameterCount());\n+                throw new IllegalArgumentException(msg);\n+            }\n+        } else {\n+            if (methodArgs == clientValuesCount) {\n+                argValues = argsFromClient;\n+            } else {\n+                String msg = String.format(\n+                        \"The number of received values (%d) is not equal \"\n+                                + \"to the number of arguments (%d) in the method '%s' \"\n+                                + \"declared in '%s'\",\n+                        argsFromClient.length(), method.getParameterCount(),\n+                        method.getName(), method.getDeclaringClass().getName());\n+                throw new IllegalArgumentException(msg);\n+            }\n+        }\n+        List<Object> decoded = new ArrayList<>(method.getParameterCount());\n+        Class<?>[] methodParameterTypes = method.getParameterTypes();\n+        for (int i = 0; i < argValues.length(); i++) {\n+            Class<?> type = methodParameterTypes[i];\n+            decoded.add(decodeArg(instance, method, type, i, argValues.get(i)));\n+        }\n+        return decoded.toArray(new Object[method.getParameterCount()]);\n+    }\n+\n+    private static JsonArray unwrapVarArgs(JsonArray argsFromClient,\n+            Method method) {\n+        int paramCount = method.getParameterCount();\n+        if (argsFromClient.length() == paramCount) {\n+            if (argsFromClient.get(paramCount - 1).getType()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 255}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDIxOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MVrOHavyRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MVrOHavyRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk0MQ==", "bodyText": "Call \"Optional#isPresent()\" before accessing the value.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807941", "createdAt": "2020-09-30T21:21:41Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.polymertemplate.rpc;\n+\n+import java.io.Serializable;\n+import java.lang.reflect.Array;\n+import java.lang.reflect.InvocationTargetException;\n+import java.lang.reflect.Method;\n+import java.lang.reflect.Type;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.slf4j.LoggerFactory;\n+\n+import com.vaadin.flow.component.ClientCallable;\n+import com.vaadin.flow.component.Component;\n+import com.vaadin.flow.component.Composite;\n+import com.vaadin.flow.component.polymertemplate.EventHandler;\n+import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n+import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n+import com.vaadin.flow.internal.StateNode;\n+import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n+import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n+import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n+import com.vaadin.flow.server.communication.rpc.DefaultRpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.RpcDecodeException;\n+import com.vaadin.flow.server.communication.rpc.RpcDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToEnumDecoder;\n+import com.vaadin.flow.server.communication.rpc.StringToNumberDecoder;\n+import com.vaadin.flow.shared.JsonConstants;\n+import com.vaadin.flow.templatemodel.ModelType;\n+\n+import elemental.json.Json;\n+import elemental.json.JsonArray;\n+import elemental.json.JsonObject;\n+import elemental.json.JsonType;\n+import elemental.json.JsonValue;\n+\n+/**\n+ * RPC handler for events triggered through <code>element.$server</code> or\n+ * simply <code>$server</code> in template event handlers.\n+ *\n+ * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n+ *\n+ * @author Vaadin Ltd\n+ * @since 1.0\n+ *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ */\n+@Deprecated\n+public class PublishedServerEventHandlerRpcHandler implements Serializable {\n+\n+    private static final Collection<RpcDecoder> DECODERS = loadDecoders();\n+\n+    public static void handleNode(StateNode node, JsonObject invocationJson) {\n+        assert invocationJson\n+                .hasKey(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        String methodName = invocationJson\n+                .getString(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n+        if (methodName == null) {\n+            throw new IllegalArgumentException(\n+                    \"Event handler method name may not be null\");\n+        }\n+        JsonValue args = invocationJson\n+                .get(JsonConstants.RPC_TEMPLATE_EVENT_ARGS);\n+        if (args == null) {\n+            args = Json.createArray();\n+        }\n+        if (args.getType() != JsonType.ARRAY) {\n+            throw new IllegalArgumentException(\n+                    \"Incorrect type for method arguments: \" + args.getClass());\n+        }\n+        int promiseId;\n+        if (invocationJson.hasKey(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE)) {\n+            promiseId = (int) invocationJson\n+                    .getNumber(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE);\n+        } else {\n+            promiseId = -1;\n+        }\n+        assert node.hasFeature(ComponentMapping.class);\n+        Optional<Component> component = ComponentMapping.getComponent(node);\n+        if (!component.isPresent()) {\n+            throw new IllegalStateException(\n+                    \"Unable to handle RPC template event JSON message: \"\n+                            + \"there is no component available for the target node\");\n+        }\n+\n+        boolean execute = node.isEnabled();\n+\n+        if (!execute) {\n+            ClientCallableHandlers clientDelegate = node\n+                    .getFeature(ClientCallableHandlers.class);\n+            PolymerServerEventHandlers eventHandlers = node\n+                    .getFeature(PolymerServerEventHandlers.class);\n+            if (clientDelegate.hasHandler(methodName)) {\n+                execute = DisabledUpdateMode.ALWAYS.equals(\n+                        clientDelegate.getDisabledUpdateMode(methodName));\n+            }\n+            if (eventHandlers.hasHandler(methodName)) {\n+                execute = execute || DisabledUpdateMode.ALWAYS.equals(\n+                        eventHandlers.getDisabledUpdateMode(methodName));\n+            }\n+        }\n+\n+        if (execute) {\n+            invokeMethod(component.get(), component.get().getClass(),\n+                    methodName, (JsonArray) args, promiseId);\n+        }\n+    }\n+\n+    static void invokeMethod(Component instance, Class<?> clazz,\n+            String methodName, JsonArray args, int promiseId) {\n+        assert instance != null;\n+        Optional<Method> method = findMethod(instance, clazz, methodName);\n+        if (method.isPresent()) {\n+            invokeMethod(instance, method.get(), args, promiseId);\n+        } else if (instance instanceof Composite) {\n+            Component compositeContent = ((Composite<?>) instance).getContent();\n+            invokeMethod(compositeContent, compositeContent.getClass(),\n+                    methodName, args, promiseId);\n+        } else {\n+            String msg = String.format(\"Neither class '%s' \"\n+                    + \"nor its super classes declare event handler method '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        }\n+    }\n+\n+    private static Optional<Method> findMethod(Component instance,\n+            Class<?> clazz, String methodName) {\n+        List<Method> methods = Stream.of(clazz.getDeclaredMethods())\n+                .filter(method -> methodName.equals(method.getName()))\n+                .filter(method -> method.isAnnotationPresent(EventHandler.class)\n+                        || method.isAnnotationPresent(ClientCallable.class))\n+                .collect(Collectors.toList());\n+        if (methods.size() > 1) {\n+            String msg = String.format(\"Class '%s' contains \"\n+                    + \"several event handler method with the same name '%s'\",\n+                    instance.getClass().getName(), methodName);\n+            throw new IllegalStateException(msg);\n+        } else if (methods.size() == 1) {\n+            return Optional.of(methods.get(0));\n+        } else if (!Component.class.equals(clazz)) {\n+            return findMethod(instance, clazz.getSuperclass(), methodName);\n+        } else {\n+            return Optional.empty();\n+        }\n+    }\n+\n+    private static void invokeMethod(Component instance, Method method,\n+            JsonArray args, int promiseId) {\n+        if (promiseId == -1) {\n+            invokeMethod(instance, method, args);\n+        } else {\n+            try {\n+                Serializable returnValue = (Serializable) invokeMethod(instance,\n+                        method, args);\n+\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, true, $1)\",\n+                                Integer.valueOf(promiseId), returnValue);\n+            } catch (RuntimeException e) {\n+                instance.getElement()\n+                        .executeJs(\"this.$server['\"\n+                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n+                                + \"']($0, false)\", Integer.valueOf(promiseId));\n+\n+                throw e;\n+            }\n+        }\n+    }\n+\n+    private static Object invokeMethod(Component instance, Method method,\n+            JsonArray args) {\n+        try {\n+            method.setAccessible(true);\n+            return method.invoke(instance, decodeArgs(instance, method, args));\n+        } catch (IllegalAccessException e) {\n+            throw new RuntimeException(e);\n+        } catch (InvocationTargetException e) {\n+            LoggerFactory.getLogger(\n+                    PublishedServerEventHandlerRpcHandler.class.getName())\n+                    .debug(null, e);\n+            throw new RuntimeException(e.getCause());\n+        }\n+    }\n+\n+    private static Object[] decodeArgs(Component instance, Method method,\n+            JsonArray argsFromClient) {\n+        int methodArgs = method.getParameterCount();\n+        int clientValuesCount = argsFromClient.length();\n+        JsonArray argValues;\n+        if (method.isVarArgs()) {\n+            if (clientValuesCount >= methodArgs - 1) {\n+                argValues = unwrapVarArgs(argsFromClient, method);\n+            } else {\n+                String msg = String.format(\n+                        \"The number of received values (%d) is not enough \"\n+                                + \"to call the method '%s' declared in '%s' which \"\n+                                + \"has vararg parameter and the number of arguments %d\",\n+                        argsFromClient.length(), method.getName(),\n+                        method.getDeclaringClass().getName(),\n+                        method.getParameterCount());\n+                throw new IllegalArgumentException(msg);\n+            }\n+        } else {\n+            if (methodArgs == clientValuesCount) {\n+                argValues = argsFromClient;\n+            } else {\n+                String msg = String.format(\n+                        \"The number of received values (%d) is not equal \"\n+                                + \"to the number of arguments (%d) in the method '%s' \"\n+                                + \"declared in '%s'\",\n+                        argsFromClient.length(), method.getParameterCount(),\n+                        method.getName(), method.getDeclaringClass().getName());\n+                throw new IllegalArgumentException(msg);\n+            }\n+        }\n+        List<Object> decoded = new ArrayList<>(method.getParameterCount());\n+        Class<?>[] methodParameterTypes = method.getParameterTypes();\n+        for (int i = 0; i < argValues.length(); i++) {\n+            Class<?> type = methodParameterTypes[i];\n+            decoded.add(decodeArg(instance, method, type, i, argValues.get(i)));\n+        }\n+        return decoded.toArray(new Object[method.getParameterCount()]);\n+    }\n+\n+    private static JsonArray unwrapVarArgs(JsonArray argsFromClient,\n+            Method method) {\n+        int paramCount = method.getParameterCount();\n+        if (argsFromClient.length() == paramCount) {\n+            if (argsFromClient.get(paramCount - 1).getType()\n+                    .equals(JsonType.ARRAY)) {\n+                return argsFromClient;\n+            }\n+        }\n+        JsonArray result = Json.createArray();\n+        JsonArray rest = Json.createArray();\n+        int newIndex = 0;\n+        for (int i = 0; i < argsFromClient.length(); i++) {\n+            JsonValue value = argsFromClient.get(i);\n+            if (i < paramCount - 1) {\n+                result.set(i, value);\n+            } else {\n+                rest.set(newIndex, value);\n+                newIndex++;\n+            }\n+        }\n+        result.set(paramCount - 1, rest);\n+        return result;\n+    }\n+\n+    private static Object decodeArg(Component instance, Method method,\n+            Class<?> type, int index, JsonValue argValue) {\n+        // come up with method to know that it's an id and should be gotten from\n+        // the model\n+        assert argValue != null;\n+        if (type.isPrimitive() && argValue.getType() == JsonType.NULL) {\n+            String msg = String.format(\n+                    \"Null values are not allowed for primitive types but \"\n+                            + \"a 'null' value was received for parameter %d \"\n+                            + \"which refers to primitive type '%s' \"\n+                            + \"in the method '%s' defined in the class '%s'\",\n+                    index, type.getName(), method.getName(),\n+                    method.getDeclaringClass().getName());\n+            throw new IllegalArgumentException(msg);\n+        } else if (type.isArray()) {\n+            return decodeArray(method, type, index, argValue);\n+        } else {\n+            Class<?> convertedType = ReflectTools.convertPrimitiveType(type);\n+\n+            if (isTemplateModelValue(instance, argValue, convertedType)) {\n+                return getTemplateItem((PolymerTemplate<?>) instance,\n+                        (JsonObject) argValue,\n+                        method.getGenericParameterTypes()[index]);\n+            }\n+\n+            Optional<RpcDecoder> decoder = getDecoder(argValue, convertedType);\n+            if (decoder.isPresent()) {\n+                try {\n+                    return decoder.get().decode(argValue, convertedType);\n+                } catch (RpcDecodeException exception) {\n+                    throw new IllegalArgumentException(exception);\n+                }\n+            }\n+            String msg = String.format(\"Class '%s' has the method '%s' \"\n+                    + \"whose parameter %d refers to unsupported type '%s'\",\n+                    method.getDeclaringClass().getName(), method.getName(),\n+                    index, type.getName());\n+            throw new IllegalArgumentException(msg);\n+        }\n+    }\n+\n+    private static Optional<RpcDecoder> getDecoder(JsonValue value,\n+            Class<?> type) {\n+        return DECODERS.stream()\n+                .filter(decoder -> decoder.isApplicable(value, type))\n+                .findFirst();\n+    }\n+\n+    private static boolean isTemplateModelValue(Component instance,\n+            JsonValue argValue, Class<?> convertedType) {\n+        return instance instanceof PolymerTemplate\n+                && argValue instanceof JsonObject\n+                && ((PolymerTemplate<?>) instance)\n+                        .isSupportedClass(convertedType)\n+                && ((JsonObject) argValue).hasKey(\"nodeId\");\n+    }\n+\n+    private static Object getTemplateItem(PolymerTemplate<?> template,\n+            JsonObject argValue, Type convertedType) {\n+        StateNode node = template.getUI().get().getInternals().getStateTree()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 335}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDIzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/InvalidTemplateModelException.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MlrOHavySw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0MlrOHavySw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk0Nw==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807947", "createdAt": "2020-09-30T21:21:42Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/InvalidTemplateModelException.java", "diffHunk": "@@ -20,11 +20,20 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated Template model and polymer template support is deprecated - we\n+ *             recommend you to use {@code LitTemplate} instead. Read more\n+ *             details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a> For lit templates, you can use {@code @Id}\n+ *             mapping and the component API or the element API with property\n+ *             synchronization instead.\n  */\n+@Deprecated\n public class InvalidTemplateModelException extends RuntimeException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDI4OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/ModelItem.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0M1rOHavyUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0M1rOHavyUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk1NA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807954", "createdAt": "2020-09-30T21:21:43Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/ModelItem.java", "diffHunk": "@@ -34,10 +34,20 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated There is no any replacement in Lit template since template model\n+ *             is not supported for lit template, but you may still use\n+ *             {@code @EventData(\"some_data\")} to receive data from the client\n+ *             side or {@code @Id} mapping and the component API or the element\n+ *             API with property synchronization instead. TPolymer template\n+ *             support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n @Retention(RetentionPolicy.RUNTIME)\n @Target({ ElementType.PARAMETER })\n @Documented\n+@Deprecated\n public @interface ModelItem {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDM2OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/PolymerTemplate.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0NFrOHavyWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0NFrOHavyWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk2Mw==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807963", "createdAt": "2020-09-30T21:21:44Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/PolymerTemplate.java", "diffHunk": "@@ -47,7 +48,12 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public abstract class PolymerTemplate<M extends TemplateModel>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDQwOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/JsoupUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0NVrOHavyYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0NVrOHavyYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk3MQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807971", "createdAt": "2020-09-30T21:21:45Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/JsoupUtils.java", "diffHunk": "@@ -26,8 +26,13 @@\n  * Utilities for JSOUP DOM manipulations.\n  *\n  * @author Vaadin Ltd\n- *\n+ * @deprecated This class is internal and used only for Polymer templates.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n final class JsoupUtils {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDQ1OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/AbstractBasicModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0NlrOHavyaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0NlrOHavyaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk3OQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807979", "createdAt": "2020-09-30T21:21:46Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/AbstractBasicModelType.java", "diffHunk": "@@ -37,8 +37,15 @@\n  *            the (basic) Java type used by this model type\n  * @author Vaadin Ltd\n  * @since 1.0\n- *\n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public abstract class AbstractBasicModelType<T> implements ModelType {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDUzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ModelEncoder.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0N1rOHavydQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0N1rOHavydQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNzk4OQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497807989", "createdAt": "2020-09-30T21:21:47Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ModelEncoder.java", "diffHunk": "@@ -33,7 +33,17 @@\n  *            the decoded type\n  * @param <E>\n  *            the encoded type\n+ * \n+ * @deprecated This functionality is bound to template model which is not\n+ *             supported for lit template. You can use {@code @Id} mapping and\n+ *             the component API or the element API with property\n+ *             synchronization instead. Polymer template support is deprecated -\n+ *             we recommend you to use {@code LitTemplate} instead. Read more\n+ *             details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public interface ModelEncoder<D, E extends Serializable> extends Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDYxOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0OFrOHavygA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0OFrOHavygA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODAwMA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808000", "createdAt": "2020-09-30T21:21:48Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateParser.java", "diffHunk": "@@ -42,8 +48,9 @@\n      *\n      * @author Vaadin Ltd\n      * @since 1.0\n-     *\n+     * @deprecated Use {@code LitTemplateParser.TemplateData} instead\n      */\n+    @Deprecated\n     class TemplateData {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDY1OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0OVrOHavyjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0OVrOHavyjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODAxMg==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808012", "createdAt": "2020-09-30T21:21:49Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateParser.java", "diffHunk": "@@ -29,8 +30,13 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n- *\n+ * @deprecated Use {@code LitTemplateParser} for {@code LitTemplate} components.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n @FunctionalInterface\n public interface TemplateParser {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDcyOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0OVrOHavykw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo0OVrOHavykw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODAxOQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808019", "createdAt": "2020-09-30T21:21:49Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ModelType.java", "diffHunk": "@@ -33,7 +33,16 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public interface ModelType extends Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDg1OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/component/AbstractSinglePropertyField.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1MFrOHavyoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1MFrOHavyoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODAzMg==", "bodyText": "Remove this call from a constructor to the overridable \"getElement\" method.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808032", "createdAt": "2020-09-30T21:21:50Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/component/AbstractSinglePropertyField.java", "diffHunk": "@@ -242,6 +241,12 @@ public AbstractSinglePropertyField(String propertyName, T defaultValue,\n         propertyReader = typeHandler.createReader(element, propertyName,\n                 presentationToModel);\n \n+        // if underlying element already has a property value then it should be\n+        // set for the component\n+        if (getElement().getPropertyRaw(propertyName) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDg2OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/AllowClientUpdates.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1MVrOHavypA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1MVrOHavypA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODAzNg==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808036", "createdAt": "2020-09-30T21:21:51Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/AllowClientUpdates.java", "diffHunk": "@@ -41,6 +49,7 @@\n @Target(ElementType.METHOD)\n @Repeatable(AllowClientUpdates.Container.class)\n @Documented\n+@Deprecated\n public @interface AllowClientUpdates {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MDkwOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1MlrOHavyqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1MlrOHavyqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODA0MQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808041", "createdAt": "2020-09-30T21:21:52Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/TemplateInitializer.java", "diffHunk": "@@ -42,17 +42,24 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * @deprecated Use {@code LitTemplateInitializer} for {@code LitTemplate}\n+ *             components. Polymer template support is deprecated - we recommend\n+ *             you to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  *\n  */\n+@Deprecated\n public class TemplateInitializer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTAxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/component/template/internal/IdCollector.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1NFrOHavyuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1NFrOHavyuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODA1OQ==", "bodyText": "Call \"tagName.isPresent()\" before accessing the value.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808059", "createdAt": "2020-09-30T21:21:54Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/component/template/internal/IdCollector.java", "diffHunk": "@@ -136,8 +152,10 @@ private boolean collectElementData(String id, Field field) {\n             Optional<String> tagName = element\n                     .map(org.jsoup.nodes.Element::tagName);\n             if (element.isPresent()) {\n+                Element domElement = element.get();\n                 tagById.put(id, tagName.get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTA2OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ElementPropertyMap.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1NlrOHavyyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1NlrOHavyyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODA3Mw==", "bodyText": "Complete the task associated to this TODO comment.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808073", "createdAt": "2020-09-30T21:21:56Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ElementPropertyMap.java", "diffHunk": "@@ -269,12 +268,14 @@ private AllowUpdate isUpdateFromClientAllowedByFilter(StateNode node,\n             ElementPropertyMap propertyMap = node\n                     .getFeature(ElementPropertyMap.class);\n             if (propertyMap.updateFromClientFilter != null) {\n+                //// TODO to be removed with polymer template support removal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTEyOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/DevModeHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1N1rOHavy1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1N1rOHavy1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODA4NQ==", "bodyText": "Remove this unused private \"checkPort\" method.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808085", "createdAt": "2020-09-30T21:21:57Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/DevModeHandler.java", "diffHunk": "@@ -569,22 +569,45 @@ private void saveRunningDevServerPort() {\n         }\n     }\n \n-    private void doStartDevModeServer(DeploymentConfiguration config,\n-            File npmFolder) throws ExecutionFailedException {\n+    private boolean checkPort() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTE1OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/PropertyMapBuilder.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1OFrOHavy3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1OFrOHavy3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODA5Mg==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808092", "createdAt": "2020-09-30T21:21:58Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/PropertyMapBuilder.java", "diffHunk": "@@ -36,7 +36,15 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0.\n+ * \n+ * @deprecated This functionality is internal and bound to template model which\n+ *             is not supported for lit template. Polymer template support is\n+ *             deprecated - we recommend you to use {@code LitTemplate} instead.\n+ *             Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n class PropertyMapBuilder {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTE5OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/component/dependency/Uses.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1OVrOHavy4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMTo1OVrOHavy4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODA5OA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808098", "createdAt": "2020-09-30T21:21:59Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/component/dependency/Uses.java", "diffHunk": "@@ -47,6 +51,7 @@\n @Retention(RUNTIME)\n @Target(TYPE)\n @Repeatable(Uses.Container.class)\n+@Deprecated\n public @interface Uses {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTIyOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/PolymerServerEventHandlers.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowMFrOHavy6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowMFrOHavy6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODEwNA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808104", "createdAt": "2020-09-30T21:22:00Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/PolymerServerEventHandlers.java", "diffHunk": "@@ -15,31 +15,43 @@\n  */\n package com.vaadin.flow.internal.nodefeature;\n \n+import java.lang.annotation.Annotation;\n import java.lang.reflect.Method;\n import java.lang.reflect.Parameter;\n+import java.util.ArrayList;\n import java.util.Collection;\n+import java.util.List;\n import java.util.Optional;\n import java.util.stream.Stream;\n \n import com.vaadin.flow.component.EventData;\n-import com.vaadin.flow.component.polymertemplate.EventHandler;\n-import com.vaadin.flow.component.polymertemplate.ModelItem;\n-import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n-import com.vaadin.flow.component.polymertemplate.RepeatIndex;\n+import com.vaadin.flow.component.template.internal.DeprecatedPolymerTemplate;\n import com.vaadin.flow.dom.DisabledUpdateMode;\n+import com.vaadin.flow.internal.ReflectTools;\n import com.vaadin.flow.internal.StateNode;\n \n /**\n  * Methods which are published as event-handlers on the client side.\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  *\n  */\n+@Deprecated\n public class PolymerServerEventHandlers", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTI1OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ModelDescriptor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowMVrOHavy7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowMVrOHavy7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODEwOQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808109", "createdAt": "2020-09-30T21:22:01Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/ModelDescriptor.java", "diffHunk": "@@ -24,7 +24,16 @@\n  * @since 1.0\n  * @param <T>\n  *            the template model type used by this descriptor\n+ * \n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class ModelDescriptor<T extends TemplateModel> extends BeanModelType<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTMzOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/BasicComplexModelType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowMlrOHavy9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowMlrOHavy9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODExOA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808118", "createdAt": "2020-09-30T21:22:02Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/BasicComplexModelType.java", "diffHunk": "@@ -36,10 +36,18 @@\n  *\n  * @param <T>\n  *            the (basic) Java type used by this model type\n+ * @deprecated Template model and model types are not supported for lit\n+ *             template, but you can use {@code @Id} mapping and the component\n+ *             API or the element API with property synchronization instead.\n+ *             Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n  */\n+@Deprecated\n public class BasicComplexModelType<T> extends AbstractBasicModelType<T>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTQyOnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModelProxyHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowM1rOHavzAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowM1rOHavzAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODEzMA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808130", "createdAt": "2020-09-30T21:22:03Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModelProxyHandler.java", "diffHunk": "@@ -45,7 +45,15 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated This functionality is internal and bound to template model which\n+ *             is not supported for lit template. Polymer template support is\n+ *             deprecated - we recommend you to use {@code LitTemplate} instead.\n+ *             Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class TemplateModelProxyHandler implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTQ3OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/NpmTemplateParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowM1rOHavzDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowM1rOHavzDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE0MA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808140", "createdAt": "2020-09-30T21:22:03Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/NpmTemplateParser.java", "diffHunk": "@@ -56,7 +56,15 @@\n  * @since 2.0\n  *\n  * @see BundleParser\n+ * \n+ * @deprecated Use {@code LitTemplateParserImpl} class for {@code LitTemplate}\n+ *             components. Polymer template support is deprecated - we recommend\n+ *             you to use {@code LitTemplate} instead. Read more details from\n+ *             <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class NpmTemplateParser implements TemplateParser {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTU0OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/PropertyFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowNFrOHavzGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowNFrOHavzGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE1Mg==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808152", "createdAt": "2020-09-30T21:22:04Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/PropertyFilter.java", "diffHunk": "@@ -22,7 +22,15 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated This functionality is internal and bound to template model which\n+ *             is not supported for lit template. Polymer template support is\n+ *             deprecated - we recommend you to use {@code LitTemplate} instead.\n+ *             Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class PropertyFilter implements Predicate<String> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTU3OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/component/template/internal/DeprecatedPolymerTemplate.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowNVrOHavzHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowNVrOHavzHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE1OA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808158", "createdAt": "2020-09-30T21:22:05Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/component/template/internal/DeprecatedPolymerTemplate.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.component.template.internal;\n+\n+import java.io.Serializable;\n+\n+/**\n+ * Marker interface for Polymer Template.\n+ * \n+ * @author Vaadin Ltd\n+ * @since\n+ * \n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n+ *\n+ */\n+@Deprecated\n+public interface DeprecatedPolymerTemplate extends Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTYwOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/component/UI.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowNlrOHavzJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowNlrOHavzJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE2NA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808164", "createdAt": "2020-09-30T21:22:06Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/component/UI.java", "diffHunk": "@@ -929,15 +940,30 @@ public void navigate(String location, QueryParameters queryParameters) {\n         Objects.requireNonNull(location, \"Location must not be null\");\n         Objects.requireNonNull(queryParameters, \"Query parameters must not be null\");\n \n-        getRouter().navigate(this, new Location(location, queryParameters),\n+        getInternals().getRouter().navigate(this,\n+                new Location(location, queryParameters),\n                 NavigationTrigger.UI_NAVIGATE);\n     }\n \n+    /**\n+     * Returns true if this UI instance supports navigation.\n+     *\n+     * @return true if this UI instance supports navigation, otherwise false.\n+     */\n+    public boolean isNavigationSupported() {\n+        // By default any UI supports navigation. Override this to return false\n+        // if navigation is not supported.\n+        return true;\n+    }\n+\n     /**\n      * Gets the router used for navigating in this UI.\n      *\n      * @return a router\n+     *\n+     * @deprecated For internal use only. Will be removed in the future.\n      */\n+    @Deprecated\n     public Router getRouter() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTY4OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/AbstractTemplate.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowN1rOHavzLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowN1rOHavzLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE3NQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808175", "createdAt": "2020-09-30T21:22:07Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/component/polymertemplate/AbstractTemplate.java", "diffHunk": "@@ -47,9 +48,14 @@\n  *\n  * @param <M>\n  *            a model class that will be used for template data propagation\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public abstract class AbstractTemplate<M extends TemplateModel>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTc1OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModel.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowOFrOHavzOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowOFrOHavzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE4NA==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808184", "createdAt": "2020-09-30T21:22:08Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModel.java", "diffHunk": "@@ -38,7 +38,14 @@\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n+ * \n+ * @deprecated Template model and polymer template support is deprecated - we\n+ *             recommend you to use {@code LitTemplate} instead. Read more\n+ *             details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public interface TemplateModel extends Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTgxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowOVrOHavzPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjowOVrOHavzPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE5MQ==", "bodyText": "Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808191", "createdAt": "2020-09-30T21:22:09Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -15,55 +15,41 @@\n  */\n package com.vaadin.flow.server.communication.rpc;\n \n-import java.io.Serializable;\n-import java.lang.reflect.Array;\n import java.lang.reflect.InvocationTargetException;\n import java.lang.reflect.Method;\n-import java.lang.reflect.Type;\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.List;\n+import java.lang.reflect.Modifier;\n import java.util.Optional;\n-import java.util.stream.Collectors;\n import java.util.stream.Stream;\n \n import org.slf4j.LoggerFactory;\n \n-import com.vaadin.flow.component.ClientCallable;\n-import com.vaadin.flow.component.Component;\n-import com.vaadin.flow.component.Composite;\n-import com.vaadin.flow.component.polymertemplate.EventHandler;\n-import com.vaadin.flow.component.polymertemplate.PolymerTemplate;\n-import com.vaadin.flow.dom.DisabledUpdateMode;\n-import com.vaadin.flow.internal.ReflectTools;\n import com.vaadin.flow.internal.StateNode;\n-import com.vaadin.flow.internal.nodefeature.ClientCallableHandlers;\n-import com.vaadin.flow.internal.nodefeature.ComponentMapping;\n-import com.vaadin.flow.internal.nodefeature.PolymerServerEventHandlers;\n import com.vaadin.flow.shared.JsonConstants;\n-import com.vaadin.flow.templatemodel.ModelType;\n \n-import elemental.json.Json;\n-import elemental.json.JsonArray;\n import elemental.json.JsonObject;\n-import elemental.json.JsonType;\n-import elemental.json.JsonValue;\n \n /**\n  * RPC handler for events triggered through <code>element.$server</code> or\n  * simply <code>$server</code> in template event handlers.\n+ * <p>\n+ * The implementation is in the flow-polymer-template module since the handler\n+ * itslef is a part of the core and can't be moved but the logic is Polymer\n+ * related.\n  *\n  * @see JsonConstants#RPC_PUBLISHED_SERVER_EVENT_HANDLER\n  *\n  * @author Vaadin Ltd\n  * @since 1.0\n  *\n+ * @deprecated Polymer template support is deprecated - we recommend you to use\n+ *             {@code LitTemplate} instead. Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n+@Deprecated\n public class PublishedServerEventHandlerRpcHandler", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTg0OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/rpc/PublishedServerEventHandlerRpcHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxMFrOHavzRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxMFrOHavzRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODE5Ng==", "bodyText": "Either log or rethrow this exception.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808196", "createdAt": "2020-09-30T21:22:10Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/rpc/PublishedServerEventHandlerRpcHandler.java", "diffHunk": "@@ -72,301 +58,28 @@ public String getRpcType() {\n     @Override\n     public Optional<Runnable> handleNode(StateNode node,\n             JsonObject invocationJson) {\n-        assert invocationJson\n-                .hasKey(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n-        String methodName = invocationJson\n-                .getString(JsonConstants.RPC_TEMPLATE_EVENT_METHOD_NAME);\n-        if (methodName == null) {\n-            throw new IllegalArgumentException(\n-                    \"Event handler method name may not be null\");\n-        }\n-        JsonValue args = invocationJson\n-                .get(JsonConstants.RPC_TEMPLATE_EVENT_ARGS);\n-        if (args == null) {\n-            args = Json.createArray();\n-        }\n-        if (args.getType() != JsonType.ARRAY) {\n-            throw new IllegalArgumentException(\n-                    \"Incorrect type for method arguments: \" + args.getClass());\n-        }\n-        int promiseId;\n-        if (invocationJson.hasKey(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE)) {\n-            promiseId = (int) invocationJson\n-                    .getNumber(JsonConstants.RPC_TEMPLATE_EVENT_PROMISE);\n-        } else {\n-            promiseId = -1;\n-        }\n-        assert node.hasFeature(ComponentMapping.class);\n-        Optional<Component> component = ComponentMapping.getComponent(node);\n-        if (!component.isPresent()) {\n-            throw new IllegalStateException(\n-                    \"Unable to handle RPC template event JSON message: \"\n-                            + \"there is no component available for the target node\");\n-        }\n-\n-        boolean execute = node.isEnabled();\n-\n-        if (!execute) {\n-            ClientCallableHandlers clientDelegate = node\n-                    .getFeature(ClientCallableHandlers.class);\n-            PolymerServerEventHandlers eventHandlers = node\n-                    .getFeature(PolymerServerEventHandlers.class);\n-            if (clientDelegate.hasHandler(methodName)) {\n-                execute = DisabledUpdateMode.ALWAYS.equals(\n-                        clientDelegate.getDisabledUpdateMode(methodName));\n-            }\n-            if (eventHandlers.hasHandler(methodName)) {\n-                execute = execute || DisabledUpdateMode.ALWAYS.equals(\n-                        eventHandlers.getDisabledUpdateMode(methodName));\n-            }\n-        }\n-\n-        if (execute) {\n-            invokeMethod(component.get(), component.get().getClass(),\n-                    methodName, (JsonArray) args, promiseId);\n-        }\n-\n-        return Optional.empty();\n-    }\n-\n-    static void invokeMethod(Component instance, Class<?> clazz,\n-            String methodName, JsonArray args, int promiseId) {\n-        assert instance != null;\n-        Optional<Method> method = findMethod(instance, clazz, methodName);\n-        if (method.isPresent()) {\n-            invokeMethod(instance, method.get(), args, promiseId);\n-        } else if (instance instanceof Composite) {\n-            Component compositeContent = ((Composite<?>) instance).getContent();\n-            invokeMethod(compositeContent, compositeContent.getClass(),\n-                    methodName, args, promiseId);\n-        } else {\n-            String msg = String.format(\"Neither class '%s' \"\n-                    + \"nor its super classes declare event handler method '%s'\",\n-                    instance.getClass().getName(), methodName);\n-            throw new IllegalStateException(msg);\n-        }\n-    }\n-\n-    private static Optional<Method> findMethod(Component instance,\n-            Class<?> clazz, String methodName) {\n-        List<Method> methods = Stream.of(clazz.getDeclaredMethods())\n-                .filter(method -> methodName.equals(method.getName()))\n-                .filter(method -> method.isAnnotationPresent(EventHandler.class)\n-                        || method.isAnnotationPresent(ClientCallable.class))\n-                .collect(Collectors.toList());\n-        if (methods.size() > 1) {\n-            String msg = String.format(\"Class '%s' contains \"\n-                    + \"several event handler method with the same name '%s'\",\n-                    instance.getClass().getName(), methodName);\n-            throw new IllegalStateException(msg);\n-        } else if (methods.size() == 1) {\n-            return Optional.of(methods.get(0));\n-        } else if (!Component.class.equals(clazz)) {\n-            return findMethod(instance, clazz.getSuperclass(), methodName);\n-        } else {\n-            return Optional.empty();\n-        }\n-    }\n-\n-    private static void invokeMethod(Component instance, Method method,\n-            JsonArray args, int promiseId) {\n-        if (promiseId == -1) {\n-            invokeMethod(instance, method, args);\n-        } else {\n-            try {\n-                Serializable returnValue = (Serializable) invokeMethod(instance,\n-                        method, args);\n-\n-                instance.getElement().executeJs(\n-                        \"this.$server['\"\n-                                + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n-                                + \"']($0, true, $1)\",\n-                        Integer.valueOf(promiseId), returnValue);\n-            } catch (RuntimeException e) {\n-                instance.getElement().executeJs(\"this.$server['\"\n-                        + JsonConstants.RPC_PROMISE_CALLBACK_NAME\n-                        + \"']($0, false)\",\n-                        Integer.valueOf(promiseId));\n-\n-                throw e;\n-            }\n-        }\n-    }\n-\n-    private static Object invokeMethod(Component instance, Method method,\n-            JsonArray args) {\n         try {\n-            method.setAccessible(true);\n-            return method.invoke(instance, decodeArgs(instance, method, args));\n+            Class<?> clazz = Class\n+                    .forName(\"com.vaadin.flow.component.polymertemplate.rpc.\"\n+                            + PublishedServerEventHandlerRpcHandler.class\n+                                    .getSimpleName());\n+            Method handleMethod = Stream.of(clazz.getDeclaredMethods())\n+                    .filter(method -> Modifier.isStatic(method.getModifiers())\n+                            && Modifier.isPublic(method.getModifiers()))\n+                    .findFirst().get();\n+            handleMethod.invoke(null, node, invocationJson);\n+        } catch (ClassNotFoundException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 205}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTg5OnYy", "diffSide": "RIGHT", "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModelListProxy.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxMVrOHavzSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxMVrOHavzSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODIwMQ==", "bodyText": "Override the \"equals\" method in this class. \n Do not forget to remove this deprecated code someday.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808201", "createdAt": "2020-09-30T21:22:11Z", "author": {"login": "vaadin-bot"}, "path": "flow-polymer-template/src/main/java/com/vaadin/flow/templatemodel/TemplateModelListProxy.java", "diffHunk": "@@ -30,8 +30,17 @@\n  * @since 1.0\n  * @param <T>\n  *            the type of items in the list\n+ * \n+ * @deprecated This functionality is internal and bound to template model which\n+ *             is not supported for lit template. Polymer template support is\n+ *             deprecated - we recommend you to use {@code LitTemplate} instead.\n+ *             Read more details from <a href=\n+ *             \"https://vaadin.com/blog/future-of-html-templates-in-vaadin\">the\n+ *             Vaadin blog.</a>\n  */\n-public class TemplateModelListProxy<T> extends AbstractList<T> implements Serializable {\n+@Deprecated\n+public class TemplateModelListProxy<T> extends AbstractList<T>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MTk1OnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxMlrOHavzUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxMlrOHavzUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODIxMA==", "bodyText": "Remove this use of \"DeprecatedPolymerTemplate\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808210", "createdAt": "2020-09-30T21:22:12Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "diffHunk": "@@ -62,10 +62,10 @@ public void setComponent(Component component) {\n             getNode().getFeature(ClientCallableHandlers.class)\n                     .componentSet(component);\n         }\n-        if (component instanceof PolymerTemplate<?>\n+        if (component instanceof DeprecatedPolymerTemplate", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MjAyOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxM1rOHavzYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxM1rOHavzYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODIyNQ==", "bodyText": "Remove this use of \"PolymerServerEventHandlers\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808225", "createdAt": "2020-09-30T21:22:13Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "diffHunk": "@@ -62,10 +62,10 @@ public void setComponent(Component component) {\n             getNode().getFeature(ClientCallableHandlers.class)\n                     .componentSet(component);\n         }\n-        if (component instanceof PolymerTemplate<?>\n+        if (component instanceof DeprecatedPolymerTemplate\n                 && getNode().hasFeature(PolymerServerEventHandlers.class)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MjEzOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxNFrOHavzcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxNFrOHavzcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODI0MA==", "bodyText": "Remove this use of \"PolymerServerEventHandlers\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808240", "createdAt": "2020-09-30T21:22:14Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "diffHunk": "@@ -62,10 +62,10 @@ public void setComponent(Component component) {\n             getNode().getFeature(ClientCallableHandlers.class)\n                     .componentSet(component);\n         }\n-        if (component instanceof PolymerTemplate<?>\n+        if (component instanceof DeprecatedPolymerTemplate\n                 && getNode().hasFeature(PolymerServerEventHandlers.class)) {\n             getNode().getFeature(PolymerServerEventHandlers.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNjQ2MjIxOnYy", "diffSide": "RIGHT", "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxNVrOHavzeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMToyMjoxNVrOHavzeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwODI0OQ==", "bodyText": "Remove this use of \"DeprecatedPolymerTemplate\"; it is deprecated.", "url": "https://github.com/vaadin/flow/pull/9084#discussion_r497808249", "createdAt": "2020-09-30T21:22:15Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/internal/nodefeature/ComponentMapping.java", "diffHunk": "@@ -62,10 +62,10 @@ public void setComponent(Component component) {\n             getNode().getFeature(ClientCallableHandlers.class)\n                     .componentSet(component);\n         }\n-        if (component instanceof PolymerTemplate<?>\n+        if (component instanceof DeprecatedPolymerTemplate\n                 && getNode().hasFeature(PolymerServerEventHandlers.class)) {\n             getNode().getFeature(PolymerServerEventHandlers.class)\n-                    .componentSet((PolymerTemplate<?>) component);\n+                    .componentSet((DeprecatedPolymerTemplate) component);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8de5f85f5ba9429c20c388522e550d64bab8d98"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3115, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}