{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNTk0ODQ0", "number": 8808, "title": "Make a workaround for Spring boot run as jar", "bodyText": "Fixes #8705", "createdAt": "2020-08-04T07:52:11Z", "url": "https://github.com/vaadin/flow/pull/8808", "merged": true, "mergeCommit": {"oid": "6f1d6a5d9fdf23bae359a8cc024536b91e7182c8"}, "closed": true, "closedAt": "2020-08-06T10:44:26Z", "author": {"login": "denis-anisimov"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7hz7YAH2gAyNDYyNTk0ODQ0OjdlNjcwOTk3MGE5Y2M5Njg3OWI2MTQzZjY5ZDdiZjhjODkzMzFiOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8NfDEgFqTQ2MjQwNjI1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e6709970a9cc96879b6143f69d7bf8c89331b90", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/7e6709970a9cc96879b6143f69d7bf8c89331b90", "committedDate": "2020-08-04T07:51:12Z", "message": "Make a workaround for Spring boot run as jar\n\nFixes #8705"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNjg2NTEz", "url": "https://github.com/vaadin/flow/pull/8808#pullrequestreview-461686513", "createdAt": "2020-08-05T13:54:03Z", "commit": {"oid": "7e6709970a9cc96879b6143f69d7bf8c89331b90"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxMzo1NDowNFrOG8Kt8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxMzo1NzoxNVrOG8K2zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc0MzM0NQ==", "bodyText": "I suggest to improve the naming a bit: getUrl -> getResourceUrl, URL logo -> resourceUrl", "url": "https://github.com/vaadin/flow/pull/8808#discussion_r465743345", "createdAt": "2020-08-05T13:54:04Z", "author": {"login": "mshabarov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/PwaRegistry.java", "diffHunk": "@@ -127,6 +132,19 @@ public PwaRegistry(PWA pwa, ServletContext servletContext)\n         }\n     }\n \n+    private URL getUrl(ServletContext context, String path)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e6709970a9cc96879b6143f69d7bf8c89331b90"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc0NTYxNA==", "bodyText": "Does it make sense to cover this by a test? Just to be sure this workaround won't be removed accidentally.", "url": "https://github.com/vaadin/flow/pull/8808#discussion_r465745614", "createdAt": "2020-08-05T13:57:15Z", "author": {"login": "mshabarov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/PwaRegistry.java", "diffHunk": "@@ -96,18 +99,20 @@ public PwaRegistry(PWA pwa, ServletContext servletContext)\n \n         // Build pwa elements only if they are enabled\n         if (pwaConfiguration.isEnabled()) {\n-            URL logo = servletContext\n-                    .getResource(pwaConfiguration.relIconPath());\n-            URL offlinePage = servletContext\n-                    .getResource(pwaConfiguration.relOfflinePath());\n+            URL logo = getUrl(servletContext, pwaConfiguration.relIconPath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e6709970a9cc96879b6143f69d7bf8c89331b90"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39dc4e0498029fb0c61fcbd67d0c2181f0941d15", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/39dc4e0498029fb0c61fcbd67d0c2181f0941d15", "committedDate": "2020-08-06T05:50:42Z", "message": "Add a unit test for implemented workaround."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3644226432deb46e4cd141f97979c9c9f13ebda4", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/3644226432deb46e4cd141f97979c9c9f13ebda4", "committedDate": "2020-08-06T06:21:48Z", "message": "Add forgotten resource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMjI2MDcx", "url": "https://github.com/vaadin/flow/pull/8808#pullrequestreview-462226071", "createdAt": "2020-08-06T06:41:25Z", "commit": {"oid": "3644226432deb46e4cd141f97979c9c9f13ebda4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwNjo0MToyNlrOG8lR0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwNzowNToyMFrOG8l67g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE3ODUxNA==", "bodyText": "Rename logo to resourceUrl", "url": "https://github.com/vaadin/flow/pull/8808#discussion_r466178514", "createdAt": "2020-08-06T06:41:26Z", "author": {"login": "mshabarov"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/PwaRegistry.java", "diffHunk": "@@ -127,6 +133,19 @@ public PwaRegistry(PWA pwa, ServletContext servletContext)\n         }\n     }\n \n+    private URL getResourceUrl(ServletContext context, String path)\n+            throws MalformedURLException {\n+        URL logo = context.getResource(path);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3644226432deb46e4cd141f97979c9c9f13ebda4"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE4OTAzOA==", "bodyText": "Add a comment that this filtered pwaIcon is the custom one, and got from META-INF/resources/icons/icon.png", "url": "https://github.com/vaadin/flow/pull/8808#discussion_r466189038", "createdAt": "2020-08-06T07:05:20Z", "author": {"login": "mshabarov"}, "path": "flow-server/src/test/java/com/vaadin/flow/server/PwaRegistryTest.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2000-2020 Vaadin Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package com.vaadin.flow.server;\n+\n+import javax.servlet.ServletContext;\n+\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.util.List;\n+\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+@PWA(name = \"foo\", shortName = \"bar\")\n+public class PwaRegistryTest {\n+\n+    @Test\n+    public void pwaIconIsGeneratedBasedOnClasspathIcon_servletContextHasNoResources()\n+            throws IOException {\n+        ServletContext context = Mockito.mock(ServletContext.class);\n+        PwaRegistry registry = new PwaRegistry(\n+                PwaRegistryTest.class.getAnnotation(PWA.class), context);\n+        List<PwaIcon> icons = registry.getIcons();\n+        PwaIcon pwaIcon = icons.stream().filter(icon -> icon.getWidth() == 32)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3644226432deb46e4cd141f97979c9c9f13ebda4"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a35c88383b9258cd4da90d66daa44171e10894e2", "author": {"user": null}, "url": "https://github.com/vaadin/flow/commit/a35c88383b9258cd4da90d66daa44171e10894e2", "committedDate": "2020-08-06T08:13:07Z", "message": "Improve variable name and add comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNDA2MjUz", "url": "https://github.com/vaadin/flow/pull/8808#pullrequestreview-462406253", "createdAt": "2020-08-06T10:44:13Z", "commit": {"oid": "a35c88383b9258cd4da90d66daa44171e10894e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 59, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}