{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NzA0NDU5", "number": 7673, "title": "prevent that MPR routes modify the hash fragment", "bodyText": "Routing based on hash fragment execute code in browser that causes client side routing to fire routing again breaking the UI.\nThis PR introspects the V7 UIDL in order to replace window.location.hash'  assignation with window.history.pushState`.\nFixes #7540\n\n\nThis change is\u2002", "createdAt": "2020-02-25T17:12:53Z", "url": "https://github.com/vaadin/flow/pull/7673", "merged": true, "mergeCommit": {"oid": "e2e57ccd1b2c7b00f6b4c3bf278befe7b2182eb5"}, "closed": true, "closedAt": "2020-02-26T11:45:31Z", "author": {"login": "manolo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH1tWHgBqjMwNzAzNjk5ODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIDw-SgFqTM2NDc2NDMyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3d149de7f3247fc0841367da611fec660d82d55", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/f3d149de7f3247fc0841367da611fec660d82d55", "committedDate": "2020-02-25T17:08:15Z", "message": "prevent MPR routes modifying the hash fragment"}, "afterCommit": {"oid": "13cf5926bcffba7be25b58e219301416eac2509e", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/13cf5926bcffba7be25b58e219301416eac2509e", "committedDate": "2020-02-25T17:37:55Z", "message": "prevent MPR routes modifying the hash fragment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MzQ4MjQ0", "url": "https://github.com/vaadin/flow/pull/7673#pullrequestreview-364348244", "createdAt": "2020-02-25T18:30:41Z", "commit": {"oid": "13cf5926bcffba7be25b58e219301416eac2509e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODozMDo0MVrOFuQSBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODozMDo0MVrOFuQSBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA0NTU3Mg==", "bodyText": "Reduce the total number of break and continue statements in this loop to use at most one.", "url": "https://github.com/vaadin/flow/pull/7673#discussion_r384045572", "createdAt": "2020-02-25T18:30:41Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/UidlRequestHandler.java", "diffHunk": "@@ -186,4 +217,92 @@ public static void commitJsonResponse(VaadinResponse response, String json)\n         // NOTE GateIn requires the buffers to be flushed to work\n         outputStream.flush();\n     }\n+\n+    private void removeOffendingMprHashFragment(JsonObject uidl) {\n+        if (!uidl.hasKey(EXECUTE)) {\n+            return;\n+        }\n+        JsonArray exec = uidl.getArray(EXECUTE);\n+        String hash = null;\n+        int idx = -1;\n+        for (int i = 0; i < exec.length(); i++) {\n+            JsonArray arr = exec.get(i);\n+            for (int j = 0; j < arr.length(); j++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13cf5926bcffba7be25b58e219301416eac2509e"}, "originalPosition": 94}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MzQ4Mjc4", "url": "https://github.com/vaadin/flow/pull/7673#pullrequestreview-364348278", "createdAt": "2020-02-25T18:30:44Z", "commit": {"oid": "13cf5926bcffba7be25b58e219301416eac2509e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODozMDo0NFrOFuQSJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODozMDo0NFrOFuQSJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA0NTYwNg==", "bodyText": "Refactor this method to reduce its Cognitive Complexity from 19 to the 15 allowed.", "url": "https://github.com/vaadin/flow/pull/7673#discussion_r384045606", "createdAt": "2020-02-25T18:30:44Z", "author": {"login": "vaadin-bot"}, "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/UidlRequestHandler.java", "diffHunk": "@@ -186,4 +217,92 @@ public static void commitJsonResponse(VaadinResponse response, String json)\n         // NOTE GateIn requires the buffers to be flushed to work\n         outputStream.flush();\n     }\n+\n+    private void removeOffendingMprHashFragment(JsonObject uidl) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13cf5926bcffba7be25b58e219301416eac2509e"}, "originalPosition": 85}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "13cf5926bcffba7be25b58e219301416eac2509e", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/13cf5926bcffba7be25b58e219301416eac2509e", "committedDate": "2020-02-25T17:37:55Z", "message": "prevent MPR routes modifying the hash fragment"}, "afterCommit": {"oid": "a359564fc639683c950d086e2ad454cc300fdd4e", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/a359564fc639683c950d086e2ad454cc300fdd4e", "committedDate": "2020-02-25T20:17:36Z", "message": "prevent MPR routes modifying the hash fragment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a359564fc639683c950d086e2ad454cc300fdd4e", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/a359564fc639683c950d086e2ad454cc300fdd4e", "committedDate": "2020-02-25T20:17:36Z", "message": "prevent MPR routes modifying the hash fragment"}, "afterCommit": {"oid": "399a2f08320484e4578b9cbfe4a1e6d4cce55fd0", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/399a2f08320484e4578b9cbfe4a1e6d4cce55fd0", "committedDate": "2020-02-26T07:55:44Z", "message": "prevent MPR routes modifying the hash fragment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "399a2f08320484e4578b9cbfe4a1e6d4cce55fd0", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/399a2f08320484e4578b9cbfe4a1e6d4cce55fd0", "committedDate": "2020-02-26T07:55:44Z", "message": "prevent MPR routes modifying the hash fragment"}, "afterCommit": {"oid": "2df9b7f6094c1dcf238d8309d49cc7ed873d8f42", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/2df9b7f6094c1dcf238d8309d49cc7ed873d8f42", "committedDate": "2020-02-26T07:58:12Z", "message": "prevent MPR routes modifying the hash fragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bf1123475151dafde6a859d657f3bc1d256d70c", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/5bf1123475151dafde6a859d657f3bc1d256d70c", "committedDate": "2020-02-26T07:58:47Z", "message": "prevent MPR routes modifying the hash fragment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2df9b7f6094c1dcf238d8309d49cc7ed873d8f42", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/2df9b7f6094c1dcf238d8309d49cc7ed873d8f42", "committedDate": "2020-02-26T07:58:12Z", "message": "prevent MPR routes modifying the hash fragment"}, "afterCommit": {"oid": "5bf1123475151dafde6a859d657f3bc1d256d70c", "author": {"user": {"login": "manolo", "name": "Manuel Carrasco Mo\u00f1ino"}}, "url": "https://github.com/vaadin/flow/commit/5bf1123475151dafde6a859d657f3bc1d256d70c", "committedDate": "2020-02-26T07:58:47Z", "message": "prevent MPR routes modifying the hash fragment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0Njk1Mjgw", "url": "https://github.com/vaadin/flow/pull/7673#pullrequestreview-364695280", "createdAt": "2020-02-26T08:23:45Z", "commit": {"oid": "5bf1123475151dafde6a859d657f3bc1d256d70c"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NzY0MzI4", "url": "https://github.com/vaadin/flow/pull/7673#pullrequestreview-364764328", "createdAt": "2020-02-26T10:00:41Z", "commit": {"oid": "5bf1123475151dafde6a859d657f3bc1d256d70c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 644, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}