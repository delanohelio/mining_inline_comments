{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NjM1MTAw", "number": 8102, "title": "[lcn] Add configuration option invertOpenClosed to binary sensor channel", "bodyText": "Added configuration option invertOpenClosed to binarysensor channel. Per default lcn binary sensor state 0 corresponds to \"closed\" while 1 corresponds to \"open\". Use this parameter to invert that logic.\ncloses #8069", "createdAt": "2020-07-10T20:40:53Z", "url": "https://github.com/openhab/openhab-addons/pull/8102", "merged": true, "mergeCommit": {"oid": "b9d13c7cc29ab79d6d14170a5d2e5de176db2a76"}, "closed": true, "closedAt": "2020-08-01T13:16:32Z", "author": {"login": "toweosp"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczqviCgFqTQ0NjcxNjE2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6oo-hgFqTQ1OTU3NzM4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NzE2MTYw", "url": "https://github.com/openhab/openhab-addons/pull/8102#pullrequestreview-446716160", "createdAt": "2020-07-10T21:42:03Z", "commit": {"oid": "629404d2abb7eb8291a9fb7221b64b3dbf5eeb44"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMTo0MjowM1rOGwGaRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMTo0Mzo0MFrOGwGcQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA4OTg2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t<description>Per default lcn binary sensor state 0 corresponds to \"closed\" while 1 corresponds to \"open\". Use this parameter to invert that logic.</description>\n          \n          \n            \n            \t\t\t\t<description>Per default a binary sensor state 0 corresponds to \"closed\" while 1 corresponds to \"open\". Use this parameter to invert that logic.</description>", "url": "https://github.com/openhab/openhab-addons/pull/8102#discussion_r453089860", "createdAt": "2020-07-10T21:42:03Z", "author": {"login": "fwolter"}, "path": "bundles/org.openhab.binding.lcn/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -277,6 +277,13 @@\n \t\t<item-type>Contact</item-type>\n \t\t<label>Binary Sensor</label>\n \t\t<autoUpdatePolicy>veto</autoUpdatePolicy>\n+\t\t<config-description>\n+\t\t\t<parameter name=\"invertOpenClosed\" type=\"boolean\">\n+\t\t\t\t<label>Invert Open/Closed</label>\n+\t\t\t\t<description>Per default lcn binary sensor state 0 corresponds to \"closed\" while 1 corresponds to \"open\". Use this parameter to invert that logic.</description>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "629404d2abb7eb8291a9fb7221b64b3dbf5eeb44"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5MDM3MQ==", "bodyText": "Can you move this into LcnModuleBinarySensorSubHandler similar to the inversion of the roller shutter up/down in LcnModuleRollershutterRelaySubHandler?", "url": "https://github.com/openhab/openhab-addons/pull/8102#discussion_r453090371", "createdAt": "2020-07-10T21:43:40Z", "author": {"login": "fwolter"}, "path": "bundles/org.openhab.binding.lcn/src/main/java/org/openhab/binding/lcn/internal/LcnModuleHandler.java", "diffHunk": "@@ -290,6 +291,22 @@ public void updateChannel(LcnChannelGroup channelGroup, String channelId, State\n         if (converter != null) {\n             convertedState = converter.onStateUpdateFromHandler(state);\n         }\n+\n+        if (channelGroup.equals(LcnChannelGroup.BINARYSENSOR)) {\n+            Channel channel = thing.getChannel(channelUid);\n+            if (channel != null) {\n+                Object invertConfig = channel.getConfiguration().get(\"invertOpenClosed\");\n+                boolean invertOpenClosed = invertConfig instanceof Boolean && (boolean) invertConfig;\n+                if (invertOpenClosed) {\n+                    if (state.equals(OpenClosedType.OPEN)) {\n+                        convertedState = OpenClosedType.CLOSED;\n+                    } else {\n+                        convertedState = OpenClosedType.OPEN;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "629404d2abb7eb8291a9fb7221b64b3dbf5eeb44"}, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fe221ccf883887ce247cc32f672605037f78d0f0", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/fe221ccf883887ce247cc32f672605037f78d0f0", "committedDate": "2020-07-11T07:23:02Z", "message": "Update bundles/org.openhab.binding.lcn/src/main/resources/ESH-INF/thing/thing-types.xml\n\nCo-authored-by: Fabian Wolter <github@fabian-wolter.de>"}, "afterCommit": {"oid": "e5eece5ebcbe03200810913e8875e682ca9f681c", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/e5eece5ebcbe03200810913e8875e682ca9f681c", "committedDate": "2020-07-21T12:16:38Z", "message": "[lcn] Add InversionConverter\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5eece5ebcbe03200810913e8875e682ca9f681c", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/e5eece5ebcbe03200810913e8875e682ca9f681c", "committedDate": "2020-07-21T12:16:38Z", "message": "[lcn] Add InversionConverter\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}, "afterCommit": {"oid": "50b01a456265d4105e6bd17cc2c5ce24a19cca49", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/50b01a456265d4105e6bd17cc2c5ce24a19cca49", "committedDate": "2020-07-21T14:34:48Z", "message": "[lcn] Add InversionConverter\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNTMzODM4", "url": "https://github.com/openhab/openhab-addons/pull/8102#pullrequestreview-452533838", "createdAt": "2020-07-21T14:46:37Z", "commit": {"oid": "50b01a456265d4105e6bd17cc2c5ce24a19cca49"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDo0NjozN1rOG07kQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDo0NjozN1rOG07kQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODE1NTA3Mw==", "bodyText": "This casting bothers me a bit. Is there an other way?", "url": "https://github.com/openhab/openhab-addons/pull/8102#discussion_r458155073", "createdAt": "2020-07-21T14:46:37Z", "author": {"login": "fwolter"}, "path": "bundles/org.openhab.binding.lcn/src/main/java/org/openhab/binding/lcn/internal/LcnModuleHandler.java", "diffHunk": "@@ -169,12 +180,23 @@ public void handleCommand(ChannelUID channelUid, Command command) {\n                 subHandler.handleCommandString((StringType) command, number.get());\n             } else if (command instanceof DecimalType) {\n                 DecimalType decimalType = (DecimalType) command;\n-                DecimalType nativeValue = getConverter(channelUid).onCommandFromItem(decimalType.doubleValue());\n-                subHandler.handleCommandDecimal(nativeValue, channelGroup, number.get());\n+                Converter valueConverter = getConverter(channelUid);\n+                if (valueConverter instanceof ValueConverter) {\n+                    DecimalType nativeValue = ((ValueConverter) valueConverter)\n+                            .onCommandFromItem(decimalType.doubleValue());\n+                    subHandler.handleCommandDecimal(nativeValue, channelGroup, number.get());\n+                }else{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50b01a456265d4105e6bd17cc2c5ce24a19cca49"}, "originalPosition": 87}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "50b01a456265d4105e6bd17cc2c5ce24a19cca49", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/50b01a456265d4105e6bd17cc2c5ce24a19cca49", "committedDate": "2020-07-21T14:34:48Z", "message": "[lcn] Add InversionConverter\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}, "afterCommit": {"oid": "d573ff014e89c030cd68f6ab3f6d0563635972cf", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/d573ff014e89c030cd68f6ab3f6d0563635972cf", "committedDate": "2020-07-21T20:08:30Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d573ff014e89c030cd68f6ab3f6d0563635972cf", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/d573ff014e89c030cd68f6ab3f6d0563635972cf", "committedDate": "2020-07-21T20:08:30Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}, "afterCommit": {"oid": "35308b4da6e027e710fe533afbe195c07bd111a2", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/35308b4da6e027e710fe533afbe195c07bd111a2", "committedDate": "2020-07-21T20:49:00Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "35308b4da6e027e710fe533afbe195c07bd111a2", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/35308b4da6e027e710fe533afbe195c07bd111a2", "committedDate": "2020-07-21T20:49:00Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}, "afterCommit": {"oid": "f91231d6efe765c1ac2a1a1f97c117316ef93a80", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/f91231d6efe765c1ac2a1a1f97c117316ef93a80", "committedDate": "2020-07-21T20:55:11Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f91231d6efe765c1ac2a1a1f97c117316ef93a80", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/f91231d6efe765c1ac2a1a1f97c117316ef93a80", "committedDate": "2020-07-21T20:55:11Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}, "afterCommit": {"oid": "23d6109ca7c5ad246167c00357c7afc4f731df21", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/23d6109ca7c5ad246167c00357c7afc4f731df21", "committedDate": "2020-07-22T20:12:06Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NTE5NDMz", "url": "https://github.com/openhab/openhab-addons/pull/8102#pullrequestreview-454519433", "createdAt": "2020-07-23T21:49:28Z", "commit": {"oid": "1aeaabe6c1921347596787d2d22e11992bd8fad9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QyMTo0OToyOFrOG2cxFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QyMTo0OToyOFrOG2cxFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc0NzYwNQ==", "bodyText": "Words in labels should be capitalized. See https://www.openhab.org/docs/developer/bindings/thing-xml.html#formatting-labels-and-descriptions", "url": "https://github.com/openhab/openhab-addons/pull/8102#discussion_r459747605", "createdAt": "2020-07-23T21:49:28Z", "author": {"login": "fwolter"}, "path": "bundles/org.openhab.binding.lcn/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -277,6 +277,14 @@\n \t\t<item-type>Contact</item-type>\n \t\t<label>Binary Sensor</label>\n \t\t<autoUpdatePolicy>veto</autoUpdatePolicy>\n+\t\t<config-description>\n+\t\t\t<parameter name=\"invertState\" type=\"boolean\">\n+\t\t\t\t<label>Invert state</label>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1aeaabe6c1921347596787d2d22e11992bd8fad9"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MzU1MDEy", "url": "https://github.com/openhab/openhab-addons/pull/8102#pullrequestreview-455355012", "createdAt": "2020-07-26T11:20:27Z", "commit": {"oid": "889620e965526ad4ce154648e2d035a924d1def0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f47203c28d64fb7ebc20f540eaa05fa3e4b470d", "author": {"user": {"login": "fwolter", "name": "Fabian Wolter"}}, "url": "https://github.com/openhab/openhab-addons/commit/4f47203c28d64fb7ebc20f540eaa05fa3e4b470d", "committedDate": "2020-07-31T14:23:53Z", "message": "Refactor Converters\n\n\nSigned-off-by: Fabian Wolter <github@fabian-wolter.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a01e9bdd7c30176bff1e2a6c7990207412dc159c", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/a01e9bdd7c30176bff1e2a6c7990207412dc159c", "committedDate": "2020-07-31T14:23:54Z", "message": "[lcn] Add configuration option invertState to binary sensor channel\n\nReferences PR #8102\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bcc5dec3a27903af0ca40973f8c6e14b570b6c7", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/0bcc5dec3a27903af0ca40973f8c6e14b570b6c7", "committedDate": "2020-07-31T14:23:55Z", "message": "[lcn] Refactor converters\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb367e12db65f9f63041ef76574ab56e4ecaba6a", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/eb367e12db65f9f63041ef76574ab56e4ecaba6a", "committedDate": "2020-07-31T14:23:56Z", "message": "[lcn] Correct label formatting\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "889620e965526ad4ce154648e2d035a924d1def0", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/889620e965526ad4ce154648e2d035a924d1def0", "committedDate": "2020-07-24T11:53:41Z", "message": "[lcn] Correct label formatting\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}, "afterCommit": {"oid": "eb367e12db65f9f63041ef76574ab56e4ecaba6a", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/eb367e12db65f9f63041ef76574ab56e4ecaba6a", "committedDate": "2020-07-31T14:23:56Z", "message": "[lcn] Correct label formatting\n\nSigned-off-by: Thomas Weiler <toweosp@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b924eeb34dac7eb774e6399209e24e99c4beb6d", "author": {"user": {"login": "toweosp", "name": "Thomas Weiler"}}, "url": "https://github.com/openhab/openhab-addons/commit/5b924eeb34dac7eb774e6399209e24e99c4beb6d", "committedDate": "2020-08-01T12:39:24Z", "message": "Merge branch '2.5.x' into invertOpenClosed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTc3Mzg2", "url": "https://github.com/openhab/openhab-addons/pull/8102#pullrequestreview-459577386", "createdAt": "2020-08-01T13:14:39Z", "commit": {"oid": "5b924eeb34dac7eb774e6399209e24e99c4beb6d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 130, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}