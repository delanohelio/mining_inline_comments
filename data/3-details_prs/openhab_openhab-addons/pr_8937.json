{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNjk3NTE1", "number": 8937, "title": "[insteon] remove all @SuppressWarnings(\"null\")", "bodyText": "", "createdAt": "2020-11-01T21:37:14Z", "url": "https://github.com/openhab/openhab-addons/pull/8937", "merged": true, "mergeCommit": {"oid": "0722bd71f5e2e7e6606653aede6bb53954947228"}, "closed": true, "closedAt": "2020-11-04T20:05:02Z", "author": {"login": "robnielsen"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYrc9ZAFqTUyMjAwNTYzMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZTb52gFqTUyMzY5NDgzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMDA1NjMz", "url": "https://github.com/openhab/openhab-addons/pull/8937#pullrequestreview-522005633", "createdAt": "2020-11-02T21:28:58Z", "commit": {"oid": "6b634cad466e48b74f5de9247de9aca35e172108"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMToyODo1OFrOHsWSsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMToyODo1OFrOHsWSsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI2NDYyNg==", "bodyText": "Now that we have EEAs there is no need for annotating the value type with @Nullable to prevent those false positives. You should only do that if you put actual null values in a map. Which usually is not the case and is also not preferable because it increases the risk of NPEs.", "url": "https://github.com/openhab/openhab-addons/pull/8937#discussion_r516264626", "createdAt": "2020-11-02T21:28:58Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -106,15 +106,14 @@\n  * @author Rob Nielsen - Port to openHAB 2 insteon binding\n  */\n @NonNullByDefault\n-@SuppressWarnings({ \"null\", \"unused\" })\n public class InsteonBinding {\n     private static final int DEAD_DEVICE_COUNT = 10;\n \n     private final Logger logger = LoggerFactory.getLogger(InsteonBinding.class);\n \n     private Driver driver;\n-    private ConcurrentHashMap<InsteonAddress, InsteonDevice> devices = new ConcurrentHashMap<>();\n-    private ConcurrentHashMap<String, InsteonChannelConfiguration> bindingConfigs = new ConcurrentHashMap<>();\n+    private Map<InsteonAddress, @Nullable InsteonDevice> devices = new ConcurrentHashMap<>();\n+    private Map<String, @Nullable InsteonChannelConfiguration> bindingConfigs = new ConcurrentHashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b634cad466e48b74f5de9247de9aca35e172108"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b634cad466e48b74f5de9247de9aca35e172108", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/6b634cad466e48b74f5de9247de9aca35e172108", "committedDate": "2020-11-01T21:36:54Z", "message": "[insteon] remove all @SuppressWarnings(\"null\")\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}, "afterCommit": {"oid": "ff35f03ddb4b27de76ed94300b3f962d9dd473cb", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/ff35f03ddb4b27de76ed94300b3f962d9dd473cb", "committedDate": "2020-11-02T21:28:48Z", "message": "[insteon] remove all @SuppressWarnings(\"null\")\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMDIxNjkw", "url": "https://github.com/openhab/openhab-addons/pull/8937#pullrequestreview-522021690", "createdAt": "2020-11-02T21:55:45Z", "commit": {"oid": "ff35f03ddb4b27de76ed94300b3f962d9dd473cb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMTo1NTo0NVrOHsXFNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMTo1NTo0NVrOHsXFNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI3NzU1Ng==", "bodyText": "The proper fix is here to remove @Nullable from the dbes value type. Then if you iterate over the entrySet instead of the keySet there will be no possible null reference and so you won't need the dbe != null check either. It results in less code, less NPEs and better performance. \ud83d\ude04", "url": "https://github.com/openhab/openhab-addons/pull/8937#discussion_r516277556", "createdAt": "2020-11-02T21:55:45Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/driver/Port.java", "diffHunk": "@@ -154,7 +152,8 @@ public void clearModemDB() {\n         logger.debug(\"clearing modem db!\");\n         Map<InsteonAddress, @Nullable ModemDBEntry> dbes = getDriver().lockModemDBEntries();\n         for (InsteonAddress addr : dbes.keySet()) {\n-            if (!dbes.get(addr).isModem()) {\n+            ModemDBEntry dbe = dbes.get(addr);\n+            if (dbe != null && !dbe.isModem()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff35f03ddb4b27de76ed94300b3f962d9dd473cb"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMDM0MjMz", "url": "https://github.com/openhab/openhab-addons/pull/8937#pullrequestreview-522034233", "createdAt": "2020-11-02T22:06:35Z", "commit": {"oid": "ff35f03ddb4b27de76ed94300b3f962d9dd473cb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMjowNjozNVrOHsXYoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMjowNjozNVrOHsXYoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI4MjUyOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private static HashMap<String, @Nullable DataType> typeMap = new HashMap<>();\n          \n          \n            \n                private static Map<String, DataType> typeMap = new HashMap<>();\n          \n      \n    \n    \n  \n\nWith the current EEAs there is only proper null analysis for the Map type. I created lastnpe/eclipse-null-eea-augments#109 because I was not happy to see the analysis missing on other common types. So that should also bring proper analysis whenever someone doesn't program against interfaces such as Map (which is still preferable) but actual implementations such as HashMap, ArrayList etc.", "url": "https://github.com/openhab/openhab-addons/pull/8937#discussion_r516282528", "createdAt": "2020-11-02T22:06:35Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/message/DataType.java", "diffHunk": "@@ -31,10 +31,10 @@\n     ADDRESS(\"address\", 3),\n     INVALID(\"INVALID\", -1);\n \n-    private static HashMap<String, DataType> typeMap = new HashMap<>();\n+    private static HashMap<String, @Nullable DataType> typeMap = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff35f03ddb4b27de76ed94300b3f962d9dd473cb"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "975331c194ee75357e3cabaa3323e391328b7079", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/975331c194ee75357e3cabaa3323e391328b7079", "committedDate": "2020-11-02T23:13:30Z", "message": "[insteon] changes recommended by wborn\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}, "afterCommit": {"oid": "6d46a45208b21590c1bb9122d65b6345d0d4da1c", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/6d46a45208b21590c1bb9122d65b6345d0d4da1c", "committedDate": "2020-11-02T23:21:10Z", "message": "[insteon] changes recommended by wborn\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0ab08427b8da179affa617b21adc89febfc2feae", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/0ab08427b8da179affa617b21adc89febfc2feae", "committedDate": "2020-11-03T20:45:33Z", "message": "[insteon] remove more instances of unnecessary @Nullable\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}, "afterCommit": {"oid": "c1cca364ab16bc4c0c306ab41ab0f9a21f7171ec", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/c1cca364ab16bc4c0c306ab41ab0f9a21f7171ec", "committedDate": "2020-11-04T00:05:36Z", "message": "[insteon] remove more instances of unnecessary @Nullable\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMzgwNTYz", "url": "https://github.com/openhab/openhab-addons/pull/8937#pullrequestreview-523380563", "createdAt": "2020-11-04T13:54:43Z", "commit": {"oid": "c1cca364ab16bc4c0c306ab41ab0f9a21f7171ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMzo1NDo0M1rOHtZENQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMzo1NDo0M1rOHtZENQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM1ODY0NQ==", "bodyText": "Perhaps this if condition can be added to if (conf.getFeature().contains(\"dimmer\")) { to simplify the code?", "url": "https://github.com/openhab/openhab-addons/pull/8937#discussion_r517358645", "createdAt": "2020-11-04T13:54:43Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/device/CommandHandler.java", "diffHunk": "@@ -114,22 +112,24 @@ protected String nm() {\n \n     protected int getMaxLightLevel(InsteonChannelConfiguration conf, int defaultLevel) {\n         Map<String, @Nullable String> params = conf.getParameters();\n-        if (conf.getFeature().contains(\"dimmer\") && params.containsKey(\"dimmermax\")) {\n-            String item = conf.getChannelName();\n+        if (conf.getFeature().contains(\"dimmer\")) {\n             String dimmerMax = params.get(\"dimmermax\");\n-            try {\n-                int i = Integer.parseInt(dimmerMax);\n-                if (i > 1 && i <= 99) {\n-                    int level = (int) Math.ceil((i * 255.0) / 100); // round up\n-                    if (level < defaultLevel) {\n-                        logger.debug(\"item {}: using dimmermax value of {}\", item, dimmerMax);\n-                        return level;\n+            if (dimmerMax != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1cca364ab16bc4c0c306ab41ab0f9a21f7171ec"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1cca364ab16bc4c0c306ab41ab0f9a21f7171ec", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/c1cca364ab16bc4c0c306ab41ab0f9a21f7171ec", "committedDate": "2020-11-04T00:05:36Z", "message": "[insteon] remove more instances of unnecessary @Nullable\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}, "afterCommit": {"oid": "30cdf0d23d1a1f0a11c2c2a960c1db282d4a83fe", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/30cdf0d23d1a1f0a11c2c2a960c1db282d4a83fe", "committedDate": "2020-11-04T14:45:24Z", "message": "[insteon] remove more instances of unnecessary @Nullable\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9309aafa1a7f0dbf02477bb359aa25c0e8b6cebf", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/9309aafa1a7f0dbf02477bb359aa25c0e8b6cebf", "committedDate": "2020-11-04T16:29:49Z", "message": "[insteon]  more cleanup\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}, "afterCommit": {"oid": "019c804950851209e32d64af952a0465d253c138", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/019c804950851209e32d64af952a0465d253c138", "committedDate": "2020-11-04T16:48:25Z", "message": "[insteon]  more cleanup\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "059a483c73f2b05c3660a42e8db942b04ea1452b", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/059a483c73f2b05c3660a42e8db942b04ea1452b", "committedDate": "2020-11-04T19:29:44Z", "message": "[insteon] remove all @SuppressWarnings(\"null\")\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "398a82f567c6797a8fe6cdb2d943f5c53e71a7e2", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/398a82f567c6797a8fe6cdb2d943f5c53e71a7e2", "committedDate": "2020-11-04T18:57:49Z", "message": "[insteon] refactor to eliminate warning during maven build\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}, "afterCommit": {"oid": "059a483c73f2b05c3660a42e8db942b04ea1452b", "author": {"user": {"login": "robnielsen", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/059a483c73f2b05c3660a42e8db942b04ea1452b", "committedDate": "2020-11-04T19:29:44Z", "message": "[insteon] remove all @SuppressWarnings(\"null\")\n\nSigned-off-by: Rob Nielsen <rob.nielsen@yahoo.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNjk0ODM3", "url": "https://github.com/openhab/openhab-addons/pull/8937#pullrequestreview-523694837", "createdAt": "2020-11-04T20:04:01Z", "commit": {"oid": "059a483c73f2b05c3660a42e8db942b04ea1452b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4235, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}