{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyODY5Mzk4", "number": 6838, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxODoyMjo1NlrODYRNzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQyMDoyMzowOFrODYTRmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2Nzc0NDc3OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/PercentageValue.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxODoyMjo1NlrOFeB9WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxODoyMjo1NlrOFeB9WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzAzMzY4OA==", "bodyText": "This is the part, which is changed against the original PR.\nUse of the DecimalType.format to do the real work.", "url": "https://github.com/openhab/openhab-addons/pull/6838#discussion_r367033688", "createdAt": "2020-01-15T18:22:56Z", "author": {"login": "jochen314"}, "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/PercentageValue.java", "diffHunk": "@@ -131,20 +134,27 @@ public void update(Command command) throws IllegalArgumentException {\n     }\n \n     @Override\n-    public String getMQTTpublishValue() {\n+    public String getMQTTpublishValue(@Nullable String pattern) {\n         if (state == UnDefType.UNDEF) {\n             return \"\";\n         }\n-        // Formular: From percentage to custom min/max: value*span/100+min\n+        // Formula: From percentage to custom min/max: value*span/100+min\n         // Calculation need to happen with big decimals to either return a straight integer or a decimal depending on\n         // the value.\n-        return ((PercentType) state).toBigDecimal().multiply(BigDecimal.valueOf(span)).divide(BigDecimal.valueOf(100))\n-                .add(BigDecimal.valueOf(min)).toString();\n+        BigDecimal value = ((PercentType) state).toBigDecimal().multiply(span).divide(DB100, MathContext.DECIMAL128)\n+                .add(min).stripTrailingZeros();\n+\n+        String formatPattern = pattern;\n+        if (formatPattern == null) {\n+            formatPattern = \"%s\";\n+        }\n+\n+        return new DecimalType(value).format(formatPattern);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92ce13ed6d9f8a04bec165a89b7aba4f2330fe81"}, "originalPosition": 131}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2ODA3NTYyOnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/PercentageValue.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQyMDoyMDo0MVrOFeFPVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQyMDoyMDo0MVrOFeFPVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA4NzQ0Ng==", "bodyText": "I think HUNDRED would make more sense and/or you turned the letters of BigDecimal around", "url": "https://github.com/openhab/openhab-addons/pull/6838#discussion_r367087446", "createdAt": "2020-01-15T20:20:41Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/PercentageValue.java", "diffHunk": "@@ -47,10 +48,11 @@\n  */\n @NonNullByDefault\n public class PercentageValue extends Value {\n-    private final double min;\n-    private final double max;\n-    private final double span;\n-    private final double step;\n+    private static final BigDecimal DB100 = BigDecimal.valueOf(100);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92ce13ed6d9f8a04bec165a89b7aba4f2330fe81"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2ODA4MjE3OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/NumberValue.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQyMDoyMzowOFrOFeFTcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxOToyNDo0OVrOFek2FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA4ODQ5Ng==", "bodyText": "Why?", "url": "https://github.com/openhab/openhab-addons/pull/6838#discussion_r367088496", "createdAt": "2020-01-15T20:23:08Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/NumberValue.java", "diffHunk": "@@ -56,7 +56,7 @@ public NumberValue(@Nullable BigDecimal min, @Nullable BigDecimal max, @Nullable\n                 .collect(Collectors.toList()));\n         this.min = min;\n         this.max = max;\n-        this.step = step == null ? BigDecimal.ONE : step;\n+        this.step = step == null ? new BigDecimal(1.0) : step;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92ce13ed6d9f8a04bec165a89b7aba4f2330fe81"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzYwNTI2OA==", "bodyText": "Good question....\nactually: bad manual merging", "url": "https://github.com/openhab/openhab-addons/pull/6838#discussion_r367605268", "createdAt": "2020-01-16T19:24:49Z", "author": {"login": "jochen314"}, "path": "bundles/org.openhab.binding.mqtt.generic/src/main/java/org/openhab/binding/mqtt/generic/values/NumberValue.java", "diffHunk": "@@ -56,7 +56,7 @@ public NumberValue(@Nullable BigDecimal min, @Nullable BigDecimal max, @Nullable\n                 .collect(Collectors.toList()));\n         this.min = min;\n         this.max = max;\n-        this.step = step == null ? BigDecimal.ONE : step;\n+        this.step = step == null ? new BigDecimal(1.0) : step;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA4ODQ5Ng=="}, "originalCommit": {"oid": "92ce13ed6d9f8a04bec165a89b7aba4f2330fe81"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1087, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}