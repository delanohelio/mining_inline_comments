{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMDc5NDU5", "number": 6786, "title": "[Logreader] Changed FileTailer to use own executor service", "bodyText": "Fixes #6784\nSigned-off-by: Pauli Anttila pauli.anttila@gmail.com", "createdAt": "2020-01-07T16:53:16Z", "url": "https://github.com/openhab/openhab-addons/pull/6786", "merged": true, "mergeCommit": {"oid": "35792c7350d3fd2a8155b0ad6a40c19d84f7cdc9"}, "closed": true, "closedAt": "2020-01-11T19:51:50Z", "author": {"login": "paulianttila"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4DlB7gH2gAyMzYwMDc5NDU5OjAwMWUwNzdiYzc1NDUyM2M0NmEwZjdjOGIxZTU2NzA3MDRhM2QxYmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb5YpD5gFqTM0MTUzODQ0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "001e077bc754523c46a0f7c8b1e5670704a3d1bd", "author": {"user": {"login": "paulianttila", "name": "pali"}}, "url": "https://github.com/openhab/openhab-addons/commit/001e077bc754523c46a0f7c8b1e5670704a3d1bd", "committedDate": "2020-01-07T16:44:51Z", "message": "[LogReader] Changed FileTailer to use own executor service\n\nSigned-off-by: Pauli Anttila <pauli.anttila@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af7d0b9b56f9393af4eb0c6876e115ae7d573889", "author": {"user": {"login": "paulianttila", "name": "pali"}}, "url": "https://github.com/openhab/openhab-addons/commit/af7d0b9b56f9393af4eb0c6876e115ae7d573889", "committedDate": "2020-01-07T16:46:53Z", "message": "Fixed Markdown\n\nSigned-off-by: Pauli Anttila <pauli.anttila@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5Mzk4ODQ0", "url": "https://github.com/openhab/openhab-addons/pull/6786#pullrequestreview-339398844", "createdAt": "2020-01-07T17:46:42Z", "commit": {"oid": "af7d0b9b56f9393af4eb0c6876e115ae7d573889"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxNzo0Njo0MlrOFbA1GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxNzo0Njo0MlrOFbA1GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg2OTQ2NQ==", "bodyText": "This threadpool is never shutdown so I expect if this class is removed it will still keep the threadpool maybe either simple start the thread itself or make sure the threadpool is shutdown when this class is removed. Probably on stop it can be this class is reused and then the executor can't be shutdown there.", "url": "https://github.com/openhab/openhab-addons/pull/6786#discussion_r363869465", "createdAt": "2020-01-07T17:46:42Z", "author": {"login": "Hilbrand"}, "path": "bundles/org.openhab.binding.logreader/src/main/java/org/openhab/binding/logreader/internal/filereader/FileTailer.java", "diffHunk": "@@ -34,6 +35,7 @@\n     private final Logger logger = LoggerFactory.getLogger(FileTailer.class);\n \n     private Tailer tailer;\n+    private final ExecutorService executor = Executors.newFixedThreadPool(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af7d0b9b56f9393af4eb0c6876e115ae7d573889"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c890ebdc35f8c5411bc8b462eb25fab79df6f087", "author": {"user": {"login": "paulianttila", "name": "pali"}}, "url": "https://github.com/openhab/openhab-addons/commit/c890ebdc35f8c5411bc8b462eb25fab79df6f087", "committedDate": "2020-01-07T18:35:11Z", "message": "Create and shutdown executor properly\n\nSigned-off-by: Pauli Anttila <pauli.anttila@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5NzIwODU1", "url": "https://github.com/openhab/openhab-addons/pull/6786#pullrequestreview-339720855", "createdAt": "2020-01-08T08:58:30Z", "commit": {"oid": "c890ebdc35f8c5411bc8b462eb25fab79df6f087"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwODo1ODozMVrOFbQQoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwODo1ODozMVrOFbQQoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDEyMjI3Mg==", "bodyText": "Are you sure this is the correct fix? If a user changes configuration dispose will be called an then the stop method here. But this class is still be used. So when start is called again in initialize it will fail as the executor is shutdown. So I think it needs a bit more thought on what is the best approach here. Also there is a newSingleThreadPool you can use instead of the fixed with 1.", "url": "https://github.com/openhab/openhab-addons/pull/6786#discussion_r364122272", "createdAt": "2020-01-08T08:58:31Z", "author": {"login": "Hilbrand"}, "path": "bundles/org.openhab.binding.logreader/src/main/java/org/openhab/binding/logreader/internal/filereader/FileTailer.java", "diffHunk": "@@ -74,9 +76,12 @@ public void start(String filePath, long refreshRate, ScheduledExecutorService sc\n     @Override\n     public void stop() {\n         logger.debug(\"Shutdown\");\n-\n         if (tailer != null) {\n             tailer.stop();\n         }\n+        if (executor != null) {\n+            executor.shutdown();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c890ebdc35f8c5411bc8b462eb25fab79df6f087"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4080ee1fc9d0981122a1fada5d639530c4297ab", "author": {"user": {"login": "paulianttila", "name": "pali"}}, "url": "https://github.com/openhab/openhab-addons/commit/d4080ee1fc9d0981122a1fada5d639530c4297ab", "committedDate": "2020-01-10T14:46:31Z", "message": "Use SingleThreadExecutor rather than FixedThreadPool(1)\n\nSigned-off-by: Pauli Anttila <pauli.anttila@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNTM4NDQ2", "url": "https://github.com/openhab/openhab-addons/pull/6786#pullrequestreview-341538446", "createdAt": "2020-01-11T19:51:11Z", "commit": {"oid": "d4080ee1fc9d0981122a1fada5d639530c4297ab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1572, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}