{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxODMyMzU1", "number": 9044, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDowNjo1MVrOE6CEMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODo1MzozMFrOE6KzHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Mjg2NzA1OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDowNjo1MVrOH02eAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxOTo1NjozM1rOH1HlsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTE4MDQxOQ==", "bodyText": "Hmm setting static fields in a constructor doesn't seem really nice... Maybe pass the providers to the bridge from the factory and than when setThingHandler is called in DSMRMeterDiscoveryService get the providers from the bridge passed and set them.", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525180419", "createdAt": "2020-11-17T14:06:51Z", "author": {"login": "Hilbrand"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;\n+\n+    @Activate\n+    public DSMRI18nProviderTracker(final @Reference TranslationProvider i18nProvider,\n+            final @Reference LocaleProvider localeProvider) {\n+        DSMRI18nProviderTracker.i18nProvider = i18nProvider;\n+        DSMRI18nProviderTracker.localeProvider = localeProvider;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQ2MDkxMg==", "bodyText": "Adding it to the bridge results in adding it to the factory too. None of them use these providers  themselves. That's why I opted for this workaround.", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525460912", "createdAt": "2020-11-17T19:56:33Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;\n+\n+    @Activate\n+    public DSMRI18nProviderTracker(final @Reference TranslationProvider i18nProvider,\n+            final @Reference LocaleProvider localeProvider) {\n+        DSMRI18nProviderTracker.i18nProvider = i18nProvider;\n+        DSMRI18nProviderTracker.localeProvider = localeProvider;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTE4MDQxOQ=="}, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5NDI5NzkwOnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODo1MzozMFrOH1ER5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMDowNDoyNlrOH1ILFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQwNjY5NQ==", "bodyText": "Surely there is a better way to implement this rather than using static fields? Can ThingServiceHandler osgi wiring support be added to the core?", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525406695", "createdAt": "2020-11-17T18:53:30Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQ1NDcyMw==", "bodyText": "What is the better way with the currently available APIs?", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525454723", "createdAt": "2020-11-17T19:51:33Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQwNjY5NQ=="}, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQ1OTI1Ng==", "bodyText": "@Hilbrand's suggestion is the only one that comes to mind.", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525459256", "createdAt": "2020-11-17T19:55:11Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQwNjY5NQ=="}, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQ2MjE4NQ==", "bodyText": "Can ThingServiceHandler osgi wiring support be added to the core?\n\nYes, please ... that will be a great enhancement. I would love to have this feature too. And I guess it should be possible because we are doing it in JavaOSGiTest:getService(...) methods too. Don't we?", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525462185", "createdAt": "2020-11-17T19:57:33Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQwNjY5NQ=="}, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQ2NjM2NQ==", "bodyText": "After looking into it I've found that you could get those osgi services by using FrameworkUtil.getBundle(...).getBundleContext().getServiceReference().\nI don't know if that is any better though, but it might be preferable to passing around the osgi services in the handlers.", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525466365", "createdAt": "2020-11-17T20:00:57Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQwNjY5NQ=="}, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQ3MDQ4Ng==", "bodyText": "I considered such trickery but it's not used in other bindings and we always try to reduce the amount of OSGi trickery in add-ons.", "url": "https://github.com/openhab/openhab-addons/pull/9044#discussion_r525470486", "createdAt": "2020-11-17T20:04:26Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.dsmr/src/main/java/org/openhab/binding/dsmr/internal/discovery/DSMRI18nProviderTracker.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.dsmr.internal.discovery;\n+\n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+import org.openhab.core.i18n.LocaleProvider;\n+import org.openhab.core.i18n.TranslationProvider;\n+import org.openhab.core.thing.binding.ThingHandlerService;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.Deactivate;\n+import org.osgi.service.component.annotations.Reference;\n+\n+/**\n+ * Tracks the i18n provider dependencies of the {@link DSMRMeterDiscoveryService}. The {@link DSMRMeterDiscoveryService}\n+ * is a {@link ThingHandlerService} so its i18n dependencies cannot be injected using service component annotations.\n+ *\n+ * @author Wouter Born - Initial contribution\n+ */\n+@Component\n+@NonNullByDefault\n+public class DSMRI18nProviderTracker {\n+\n+    static @Nullable TranslationProvider i18nProvider;\n+    static @Nullable LocaleProvider localeProvider;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQwNjY5NQ=="}, "originalCommit": {"oid": "645bcb2382905188e9bdd9259a9463e18a32ff7e"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3923, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}