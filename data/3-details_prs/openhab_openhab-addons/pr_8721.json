{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMDIyNTIy", "number": 8721, "title": "[hue] Added channel to enable / disable a motion sensor", "bodyText": "Added channel to enable / disable a motion sensor\nCloses #8389\nSigned-off-by: Christoph Weitkamp github@christophweitkamp.de", "createdAt": "2020-10-10T19:04:09Z", "url": "https://github.com/openhab/openhab-addons/pull/8721", "merged": true, "mergeCommit": {"oid": "02963b8c99f1c7e413053b6a339a691b7033dd7b"}, "closed": true, "closedAt": "2020-10-16T22:59:57Z", "author": {"login": "cweitkamp"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRbsflgFqTUwNjE1OTU2Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTCXZrABqjM4ODUyODg1MjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTU5NTYz", "url": "https://github.com/openhab/openhab-addons/pull/8721#pullrequestreview-506159563", "createdAt": "2020-10-11T09:08:51Z", "commit": {"oid": "e074c522568e341d3faa8db2660c81b036282352"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQwOTowODo1MlrOHfl3Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQwOTowOToyNlrOHfl3Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4ODIxMA==", "bodyText": "For other channels, I think you have to call the parent class (which handle few other channels).", "url": "https://github.com/openhab/openhab-addons/pull/8721#discussion_r502888210", "createdAt": "2020-10-11T09:08:52Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.hue/src/main/java/org/openhab/binding/hue/internal/handler/sensors/PresenceHandler.java", "diffHunk": "@@ -39,10 +45,38 @@\n public class PresenceHandler extends HueSensorHandler {\n     public static final Set<ThingTypeUID> SUPPORTED_THING_TYPES = Collections.singleton(THING_TYPE_PRESENCE_SENSOR);\n \n+    private final Logger logger = LoggerFactory.getLogger(PresenceHandler.class);\n+\n     public PresenceHandler(Thing thing) {\n         super(thing);\n     }\n \n+    @Override\n+    public void handleCommand(String channel, Command command) {\n+        HueClient hueBridge = getHueClient();\n+        if (hueBridge == null) {\n+            logger.warn(\"hue bridge handler not found. Cannot handle command without bridge.\");\n+            return;\n+        }\n+\n+        final FullSensor sensor = lastFullSensor;\n+        if (sensor == null) {\n+            logger.debug(\"hue sensor not known on bridge. Cannot handle command.\");\n+            updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n+                    \"@text/offline.conf-error-wrong-sensor-id\");\n+            return;\n+        }\n+\n+        SensorConfigUpdate configUpdate = new SensorConfigUpdate();\n+        switch (channel) {\n+            case CHANNEL_ENABLED:\n+                configUpdate.setOn(OnOffType.ON.equals(command));\n+                break;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e074c522568e341d3faa8db2660c81b036282352"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4ODI4Nw==", "bodyText": "It should be moved in your switch case.", "url": "https://github.com/openhab/openhab-addons/pull/8721#discussion_r502888287", "createdAt": "2020-10-11T09:09:26Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.hue/src/main/java/org/openhab/binding/hue/internal/handler/sensors/PresenceHandler.java", "diffHunk": "@@ -39,10 +45,38 @@\n public class PresenceHandler extends HueSensorHandler {\n     public static final Set<ThingTypeUID> SUPPORTED_THING_TYPES = Collections.singleton(THING_TYPE_PRESENCE_SENSOR);\n \n+    private final Logger logger = LoggerFactory.getLogger(PresenceHandler.class);\n+\n     public PresenceHandler(Thing thing) {\n         super(thing);\n     }\n \n+    @Override\n+    public void handleCommand(String channel, Command command) {\n+        HueClient hueBridge = getHueClient();\n+        if (hueBridge == null) {\n+            logger.warn(\"hue bridge handler not found. Cannot handle command without bridge.\");\n+            return;\n+        }\n+\n+        final FullSensor sensor = lastFullSensor;\n+        if (sensor == null) {\n+            logger.debug(\"hue sensor not known on bridge. Cannot handle command.\");\n+            updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n+                    \"@text/offline.conf-error-wrong-sensor-id\");\n+            return;\n+        }\n+\n+        SensorConfigUpdate configUpdate = new SensorConfigUpdate();\n+        switch (channel) {\n+            case CHANNEL_ENABLED:\n+                configUpdate.setOn(OnOffType.ON.equals(command));\n+                break;\n+        }\n+\n+        hueBridge.updateSensorConfig(sensor, configUpdate);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e074c522568e341d3faa8db2660c81b036282352"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5ODY4MDk5", "url": "https://github.com/openhab/openhab-addons/pull/8721#pullrequestreview-509868099", "createdAt": "2020-10-15T23:06:37Z", "commit": {"oid": "e074c522568e341d3faa8db2660c81b036282352"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c2af172a25b4c7ea4fe4a7ba3723facc5a925ad", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/0c2af172a25b4c7ea4fe4a7ba3723facc5a925ad", "committedDate": "2020-10-16T08:40:49Z", "message": "Added channel to activate/deactivate a motion sensor\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91370648be528d8f06c0a260dd21e0bd87490b3a", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/91370648be528d8f06c0a260dd21e0bd87490b3a", "committedDate": "2020-10-16T08:42:05Z", "message": "Applied spotless\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e074c522568e341d3faa8db2660c81b036282352", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/e074c522568e341d3faa8db2660c81b036282352", "committedDate": "2020-10-10T18:58:09Z", "message": "Added channel to activate/deactivate a motion sensor\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}, "afterCommit": {"oid": "91370648be528d8f06c0a260dd21e0bd87490b3a", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/91370648be528d8f06c0a260dd21e0bd87490b3a", "committedDate": "2020-10-16T08:42:05Z", "message": "Applied spotless\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4538, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}