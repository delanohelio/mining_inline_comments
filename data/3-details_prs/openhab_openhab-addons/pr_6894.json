{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MzIzNjU3", "number": 6894, "title": "[deconz] Added config change listener", "bodyText": "Added config change listener\n\nRelated to #6362\nAccording to deCONZ REST API - Websocket documentation the websocket emits events for state and config changes.\nTest version: org.openhab.binding.deconz-2.5.2-SNAPSHOT.zip\nSigned-off-by: Christoph Weitkamp github@christophweitkamp.de", "createdAt": "2020-01-23T11:53:38Z", "url": "https://github.com/openhab/openhab-addons/pull/6894", "merged": true, "mergeCommit": {"oid": "1b3116e25882fae6e0f659e2f666c9ebda9bf6f0"}, "closed": true, "closedAt": "2020-01-25T20:47:54Z", "author": {"login": "cweitkamp"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9I_hcAH2gAyMzY2MzIzNjU3OjU0Yzk3NmE3MzQwZmIyN2I4NzIzNjI1YmU3YzQxZDE4NTczNTEwNjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9511bAFqTM0ODM0NDY5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "54c976a7340fb27b8723625be7c41d1857351068", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/54c976a7340fb27b8723625be7c41d1857351068", "committedDate": "2020-01-23T11:52:56Z", "message": "Added config change listener\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MjgxNTgy", "url": "https://github.com/openhab/openhab-addons/pull/6894#pullrequestreview-347281582", "createdAt": "2020-01-23T13:08:53Z", "commit": {"oid": "54c976a7340fb27b8723625be7c41d1857351068"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMzowODo1M1rOFg9f5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMzowODo1M1rOFg9f5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDEwNjM0MA==", "bodyText": "Not very vital, but you can also write:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                updateState(channelUID, batteryLevel <= 10 ? OnOffType.ON : OnOffType.OFF);\n          \n          \n            \n                                updateState(channelUID, OnOffType.from(batteryLevel <= 10));", "url": "https://github.com/openhab/openhab-addons/pull/6894#discussion_r370106340", "createdAt": "2020-01-23T13:08:53Z", "author": {"login": "Hilbrand"}, "path": "bundles/org.openhab.binding.deconz/src/main/java/org/openhab/binding/deconz/internal/handler/SensorThingHandler.java", "diffHunk": "@@ -333,9 +329,30 @@ public void initialize() {\n         }\n     }\n \n-    public void valueUpdated(ChannelUID channelUID, SensorState newState, boolean initializing) {\n-        this.state = newState;\n+    public void valueUpdated(ChannelUID channelUID, SensorConfig newConfig) {\n+        Integer batteryLevel = newConfig.battery;\n+        Float temperature = newConfig.temperature;\n+\n+        switch (channelUID.getId()) {\n+            case CHANNEL_BATTERY_LEVEL:\n+                if (batteryLevel != null) {\n+                    updateState(channelUID, new DecimalType(batteryLevel.longValue()));\n+                }\n+                break;\n+            case CHANNEL_BATTERY_LOW:\n+                if (batteryLevel != null) {\n+                    updateState(channelUID, batteryLevel <= 10 ? OnOffType.ON : OnOffType.OFF);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54c976a7340fb27b8723625be7c41d1857351068"}, "originalPosition": 172}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56fa19a1630561fac1a1ce4d2864da4c21116c43", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/56fa19a1630561fac1a1ce4d2864da4c21116c43", "committedDate": "2020-01-23T19:10:17Z", "message": "Applied review comment\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ0Njk4", "url": "https://github.com/openhab/openhab-addons/pull/6894#pullrequestreview-348344698", "createdAt": "2020-01-25T20:47:42Z", "commit": {"oid": "56fa19a1630561fac1a1ce4d2864da4c21116c43"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1723, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}