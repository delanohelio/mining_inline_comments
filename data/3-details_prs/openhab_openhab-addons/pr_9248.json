{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzMDgxOTIx", "number": 9248, "title": "[caddx] Add thing actions to the binding", "bodyText": "Added missing keypad thing support\nAdded actions to the binding things", "createdAt": "2020-12-05T19:37:42Z", "url": "https://github.com/openhab/openhab-addons/pull/9248", "merged": true, "mergeCommit": {"oid": "ff40b5a632ffb061b337da58d08a84d808c123f0"}, "closed": true, "closedAt": "2020-12-12T19:57:11Z", "author": {"login": "jossuar"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjRg1VAH2gAyNTMzMDgxOTIxOmI5YjI2YjZlMmRjNWIyMGIxMWJhZDAyYTI4YTYzMGY1YjBiZDI1ZDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlgpVygFqTU1MDg1MDc3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b9b26b6e2dc5b20b11bad02a28a630f5b0bd25d9", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/b9b26b6e2dc5b20b11bad02a28a630f5b0bd25d9", "committedDate": "2020-12-05T19:28:50Z", "message": "Added keypad support and thing actions\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fbba1742769eb13056a445419b2a4a31553b76f", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/8fbba1742769eb13056a445419b2a4a31553b76f", "committedDate": "2020-12-05T19:28:57Z", "message": "Related to #8116\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a142a9ba06dca9ba7a2d0a4edad828fedc8f43f9", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/a142a9ba06dca9ba7a2d0a4edad828fedc8f43f9", "committedDate": "2020-12-05T19:29:03Z", "message": "Removed ThingActions workaround\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc779dad540e6d465a751bedb19fe1910b90a024", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/dc779dad540e6d465a751bedb19fe1910b90a024", "committedDate": "2020-12-05T19:29:08Z", "message": "Code cleanup\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ac101086fa4672435e8274ba0a3bc8753a5e000", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/1ac101086fa4672435e8274ba0a3bc8753a5e000", "committedDate": "2020-12-05T19:29:14Z", "message": "Renamed panel actions\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NjM2MTgw", "url": "https://github.com/openhab/openhab-addons/pull/9248#pullrequestreview-546636180", "createdAt": "2020-12-07T23:49:20Z", "commit": {"oid": "1ac101086fa4672435e8274ba0a3bc8753a5e000"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMzo0OToyMFrOIBAMbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMzo1MzoxM1rOIBASvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkyMjY2OA==", "bodyText": "I think you forgot to remove this.", "url": "https://github.com/openhab/openhab-addons/pull/9248#discussion_r537922668", "createdAt": "2020-12-07T23:49:20Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.caddx/src/main/java/org/openhab/binding/caddx/internal/handler/ThingHandlerKeypad.java", "diffHunk": "@@ -26,25 +38,84 @@\n  */\n @NonNullByDefault\n public class ThingHandlerKeypad extends CaddxBaseThingHandler {\n-    /**\n-     * Constructor.\n-     *\n-     * @param thing\n-     */\n+    private final Logger logger = LoggerFactory.getLogger(ThingHandlerKeypad.class);\n+\n     public ThingHandlerKeypad(Thing thing) {\n         super(thing, CaddxThingType.KEYPAD);\n     }\n \n     @Override\n     public void updateChannel(ChannelUID channelUID, String data) {\n+        if (channelUID.getId().equals(CaddxBindingConstants.KEYPAD_KEY_PRESSED)) {\n+            StringType stringType = new StringType(data);\n+            updateState(channelUID, stringType);\n+        }\n     }\n \n     @Override\n-    public void handleCommand(ChannelUID channelUID, Command command) {\n+    public void caddxEventReceived(CaddxEvent event, Thing thing) {\n+        logger.trace(\"caddxEventReceived(): Event Received - {}.\", event);\n+\n+        if (getThing().equals(thing)) {\n+            CaddxMessage message = event.getCaddxMessage();\n+            CaddxMessageType mt = message.getCaddxMessageType();\n+            ChannelUID channelUID = null;\n+\n+            // Log event messages have special handling\n+            if (CaddxMessageType.KEYPAD_MESSAGE_RECEIVED.equals(mt)) {\n+                for (CaddxProperty p : mt.properties) {\n+                    if (!(\"\".equals(p.getId()))) {\n+                        String value = message.getPropertyById(p.getId());\n+                        channelUID = new ChannelUID(getThing().getUID(), p.getId());\n+                        updateChannel(channelUID, value);\n+                    }\n+                }\n+            }\n+\n+            updateStatus(ThingStatus.ONLINE);\n+        }\n     }\n \n     @Override\n-    public void caddxEventReceived(CaddxEvent event, Thing thing) {\n+    public void bridgeStatusChanged(ThingStatusInfo bridgeStatusInfo) {\n         updateStatus(ThingStatus.ONLINE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac101086fa4672435e8274ba0a3bc8753a5e000"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkyMzIyNA==", "bodyText": "Why are you removing this channel?", "url": "https://github.com/openhab/openhab-addons/pull/9248#discussion_r537923224", "createdAt": "2020-12-07T23:50:46Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.caddx/src/main/resources/OH-INF/thing/channels.xml", "diffHunk": "@@ -110,17 +110,11 @@\n \t</channel-type>\n \n \t<!-- keypad -->\n-\t<channel-type id=\"led\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac101086fa4672435e8274ba0a3bc8753a5e000"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkyNDI4NA==", "bodyText": "I see no reason that this variable needs to be defined outside of the for loop.", "url": "https://github.com/openhab/openhab-addons/pull/9248#discussion_r537924284", "createdAt": "2020-12-07T23:53:13Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.caddx/src/main/java/org/openhab/binding/caddx/internal/handler/ThingHandlerKeypad.java", "diffHunk": "@@ -26,25 +38,84 @@\n  */\n @NonNullByDefault\n public class ThingHandlerKeypad extends CaddxBaseThingHandler {\n-    /**\n-     * Constructor.\n-     *\n-     * @param thing\n-     */\n+    private final Logger logger = LoggerFactory.getLogger(ThingHandlerKeypad.class);\n+\n     public ThingHandlerKeypad(Thing thing) {\n         super(thing, CaddxThingType.KEYPAD);\n     }\n \n     @Override\n     public void updateChannel(ChannelUID channelUID, String data) {\n+        if (channelUID.getId().equals(CaddxBindingConstants.KEYPAD_KEY_PRESSED)) {\n+            StringType stringType = new StringType(data);\n+            updateState(channelUID, stringType);\n+        }\n     }\n \n     @Override\n-    public void handleCommand(ChannelUID channelUID, Command command) {\n+    public void caddxEventReceived(CaddxEvent event, Thing thing) {\n+        logger.trace(\"caddxEventReceived(): Event Received - {}.\", event);\n+\n+        if (getThing().equals(thing)) {\n+            CaddxMessage message = event.getCaddxMessage();\n+            CaddxMessageType mt = message.getCaddxMessageType();\n+            ChannelUID channelUID = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac101086fa4672435e8274ba0a3bc8753a5e000"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a61fd7e015e647735dffed8a2236567d1db924e", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/0a61fd7e015e647735dffed8a2236567d1db924e", "committedDate": "2020-12-11T17:16:22Z", "message": "Review change. Moved a variable declaration.\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87a8a5a3ed84699eb3090ddac64a9ac9482b59f5", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/87a8a5a3ed84699eb3090ddac64a9ac9482b59f5", "committedDate": "2020-12-12T08:53:59Z", "message": "Minor correction\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwODUwNzc5", "url": "https://github.com/openhab/openhab-addons/pull/9248#pullrequestreview-550850779", "createdAt": "2020-12-12T18:14:33Z", "commit": {"oid": "87a8a5a3ed84699eb3090ddac64a9ac9482b59f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4023, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}