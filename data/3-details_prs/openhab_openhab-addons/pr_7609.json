{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NDM5ODgx", "number": 7609, "title": "[lutron] Replace gnu.io with OH serial transport", "bodyText": "This update contains changes which replace direct use of the gnu.io serial library (aka RXTX) with calls to OH serial transport. It impacts the bridge handlers for the original RadioRA system (ra-rs232), and the original HomeWorks system (hwserialbridge).\nThe need for this is discussed in issue #7573.\nNote that I have no way to test these changes so I would appreciate it if the original authors, @jjlauterbach and @andrewshilliday could review and test this code!\nA jar file containing the binding with these changes is available here:\nhttps://github.com/bobadair/openhab2-addons/releases/tag/serial-beta-1", "createdAt": "2020-05-12T02:00:19Z", "url": "https://github.com/openhab/openhab-addons/pull/7609", "merged": true, "mergeCommit": {"oid": "700c76c60a20880d5568628ddbd3d24cd48a11d5"}, "closed": true, "closedAt": "2020-05-12T20:31:09Z", "author": {"login": "bobadair"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgaAriAH2gAyNDE2NDM5ODgxOmRhZTFkY2U4ZDE5ODY4MGIyNjMzNGQxNzc1OWVmNjlmZjNjMWVmMzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgp-stgFqTQxMDM4MjExOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dae1dce8d198680b26334d17759ef69ff3c1ef35", "author": {"user": {"login": "bobadair", "name": "Bob A."}}, "url": "https://github.com/openhab/openhab-addons/commit/dae1dce8d198680b26334d17759ef69ff3c1ef35", "committedDate": "2020-05-12T01:29:56Z", "message": "[lutron] Replace gnu.io with OH serial transport\n\nSigned-off-by: Bob Adair <bob.github@att.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NzU1MzQ0", "url": "https://github.com/openhab/openhab-addons/pull/7609#pullrequestreview-409755344", "createdAt": "2020-05-12T07:08:08Z", "commit": {"oid": "dae1dce8d198680b26334d17759ef69ff3c1ef35"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwNzowODowOFrOGT45iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwNzowODowOFrOGT45iA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUwODM2MA==", "bodyText": "I would just get the identifier and check if it is null (the code below). Recently I looked into rfc2217 connections (openhab/openhab-core#1462) and these will not be returned in this list.", "url": "https://github.com/openhab/openhab-addons/pull/7609#discussion_r423508360", "createdAt": "2020-05-12T07:08:08Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.lutron/src/main/java/org/openhab/binding/lutron/internal/radiora/RS232Connection.java", "diffHunk": "@@ -42,32 +39,42 @@\n \n     private final Logger logger = LoggerFactory.getLogger(RS232Connection.class);\n \n+    protected SerialPortManager serialPortManager;\n     protected SerialPort serialPort;\n \n     protected BufferedReader inputReader;\n \n     protected RadioRAFeedbackListener listener;\n     protected RS232MessageParser parser = new RS232MessageParser();\n \n+    public RS232Connection(SerialPortManager serialPortManager) {\n+        super();\n+        this.serialPortManager = serialPortManager;\n+    }\n+\n     @Override\n     public void open(String portName, int baud) throws RadioRAConnectionException {\n-        CommPortIdentifier commPort = null;\n+        SerialPortIdentifier portIdentifier;\n \n-        try {\n-            commPort = CommPortIdentifier.getPortIdentifier(portName);\n-        } catch (NoSuchPortException e) {\n-            logAvailablePorts();\n+        // Exit if no identifiers exist to work around possible library bug. May not be needed in 3.0.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dae1dce8d198680b26334d17759ef69ff3c1ef35"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0e168013ab4daafc5bc686f38365d3f42a49941", "author": {"user": {"login": "bobadair", "name": "Bob A."}}, "url": "https://github.com/openhab/openhab-addons/commit/d0e168013ab4daafc5bc686f38365d3f42a49941", "committedDate": "2020-05-12T18:28:45Z", "message": "[lutron] Remove check for no serial ports\n\nSigned-off-by: Bob Adair <bob.github@att.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzYxMTQ4", "url": "https://github.com/openhab/openhab-addons/pull/7609#pullrequestreview-410361148", "createdAt": "2020-05-12T19:34:59Z", "commit": {"oid": "d0e168013ab4daafc5bc686f38365d3f42a49941"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxOTozNDo1OVrOGUV9Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxOTozNTo1NFrOGUV-7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk4NDQxMA==", "bodyText": "It's now possible to assign the variable where it is declared:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    portIdentifier = serialPortManager.getIdentifier(serialPortName);\n          \n          \n            \n                    SerialPortIdentifier portIdentifier = serialPortManager.getIdentifier(serialPortName);", "url": "https://github.com/openhab/openhab-addons/pull/7609#discussion_r423984410", "createdAt": "2020-05-12T19:34:59Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.lutron/src/main/java/org/openhab/binding/lutron/internal/hw/HwSerialBridgeHandler.java", "diffHunk": "@@ -99,9 +100,16 @@ public void setDiscoveryService(HwDiscoveryService discoveryService) {\n     }\n \n     private void openConnection() {\n+        SerialPortIdentifier portIdentifier;\n+\n+        portIdentifier = serialPortManager.getIdentifier(serialPortName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0e168013ab4daafc5bc686f38365d3f42a49941"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk4NDg3Nw==", "bodyText": "It's now possible to assign the variable where it is declared:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    portIdentifier = serialPortManager.getIdentifier(portName);\n          \n          \n            \n                    SerialPortIdentifier portIdentifier = serialPortManager.getIdentifier(portName);", "url": "https://github.com/openhab/openhab-addons/pull/7609#discussion_r423984877", "createdAt": "2020-05-12T19:35:54Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.lutron/src/main/java/org/openhab/binding/lutron/internal/radiora/RS232Connection.java", "diffHunk": "@@ -42,32 +38,36 @@\n \n     private final Logger logger = LoggerFactory.getLogger(RS232Connection.class);\n \n+    protected SerialPortManager serialPortManager;\n     protected SerialPort serialPort;\n \n     protected BufferedReader inputReader;\n \n     protected RadioRAFeedbackListener listener;\n     protected RS232MessageParser parser = new RS232MessageParser();\n \n+    public RS232Connection(SerialPortManager serialPortManager) {\n+        super();\n+        this.serialPortManager = serialPortManager;\n+    }\n+\n     @Override\n     public void open(String portName, int baud) throws RadioRAConnectionException {\n-        CommPortIdentifier commPort = null;\n+        SerialPortIdentifier portIdentifier;\n \n-        try {\n-            commPort = CommPortIdentifier.getPortIdentifier(portName);\n-        } catch (NoSuchPortException e) {\n-            logAvailablePorts();\n+        portIdentifier = serialPortManager.getIdentifier(portName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0e168013ab4daafc5bc686f38365d3f42a49941"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2db1fd5154a0bf31490ed5433722369fca3739f", "author": {"user": {"login": "bobadair", "name": "Bob A."}}, "url": "https://github.com/openhab/openhab-addons/commit/e2db1fd5154a0bf31490ed5433722369fca3739f", "committedDate": "2020-05-12T19:55:10Z", "message": "[lutron] Address review comments\n\nSigned-off-by: Bob Adair <bob.github@att.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzgyMTE4", "url": "https://github.com/openhab/openhab-addons/pull/7609#pullrequestreview-410382118", "createdAt": "2020-05-12T20:06:15Z", "commit": {"oid": "e2db1fd5154a0bf31490ed5433722369fca3739f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 779, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}