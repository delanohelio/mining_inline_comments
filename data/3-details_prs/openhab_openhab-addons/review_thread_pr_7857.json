{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MDQzMzUy", "number": 7857, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzoxMDowMFrOEC13Iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQwNzo0NDoxNVrOEDJvJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDE1MDc1OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.telegram/src/main/java/org/openhab/binding/telegram/internal/TelegramHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzoxMDowMFrOGfi1Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzoxMDowMFrOGfi1Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcyOTcwNw==", "bodyText": "Minor suggestion: use chatIdStr.substring(1) to remove the first character", "url": "https://github.com/openhab/openhab-addons/pull/7857#discussion_r435729707", "createdAt": "2020-06-05T07:10:00Z", "author": {"login": "ZzetT"}, "path": "bundles/org.openhab.binding.telegram/src/main/java/org/openhab/binding/telegram/internal/TelegramHandler.java", "diffHunk": "@@ -138,10 +140,23 @@ public void initialize() {\n         TelegramConfiguration config = getConfigAs(TelegramConfiguration.class);\n \n         String botToken = config.getBotToken();\n-        chatIds.clear();\n+        authorizedSenderChatId.clear();\n+        receiverChatId.clear();\n+\n         for (String chatIdStr : config.getChatIds()) {\n             try {\n-                chatIds.add(Long.valueOf(chatIdStr));\n+                if (chatIdStr.startsWith(\"<\")) {\n+                    // inbound only\n+                    authorizedSenderChatId.add(Long.valueOf(chatIdStr.replace(\"<\", \"\")));\n+                } else if (chatIdStr.startsWith(\">\")) {\n+                    // outbound only\n+                    receiverChatId.add(Long.valueOf(chatIdStr.replace(\">\", \"\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20832d776ecd381af1e938f03ac7b9b1cef21b16"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDE1MDg0OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.telegram/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzoxMDowMlrOGfi1Ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzoxMDowMlrOGfi1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcyOTcxOA==", "bodyText": "I guess you removed the tags here to not confuse the user with the send/receive characters. Could we modify this example to also show how it would look with the prefix e.g. use \">ID2\" and to update the text in parenthesis (\"... where ID2 can only receive messages\"? Then we would also avoid confusions whether a space is required or not.", "url": "https://github.com/openhab/openhab-addons/pull/7857#discussion_r435729718", "createdAt": "2020-06-05T07:10:02Z", "author": {"login": "ZzetT"}, "path": "bundles/org.openhab.binding.telegram/README.md", "diffHunk": "@@ -62,29 +62,34 @@ In order to send a message, an action must be used instead.\n | `proxyPort`             |  None   | No       | Proxy port for telegram binding.                                                             |\n | `proxyType`             |  SOCKS5 | No       | Type of proxy server for telegram binding (SOCKS5 or HTTP). Default: SOCKS5                  |\n \n+By default chat ids are bi-directionally, i.e. they can send and receive messages.\n+They can be prefixed with an access modifier:\n+- `<` restricts the chat to send only, i.e. this chat id can send messages to openHAB, but will never receive a notification.\n+- `>` restricts the chat to receive only, i.e. this chat id will receive all notifications, but messages from this chat id will be discarded. \n+To use the reply function, chat ids need to be bi-directional.\n \n telegram.thing (no proxy):\n \n ```\n-Thing telegram:telegramBot:Telegram_Bot [ chatIds=\"< ID >\", botToken=\"< TOKEN >\" ]\n+Thing telegram:telegramBot:Telegram_Bot [ chatIds=\"ID\", botToken=\"TOKEN\" ]\n ```\n \n telegram.thing (multiple chat ids and markdown format):\n \n ```\n-Thing telegram:telegramBot:Telegram_Bot [ chatIds=\"< ID1 >\",\"< ID2 >\", botToken=\"< TOKEN >\", parseMode =\"Markdown\" ]\n+Thing telegram:telegramBot:Telegram_Bot [ chatIds=\"ID1\",\"ID2\", botToken=\"TOKEN\", parseMode =\"Markdown\" ]\n ```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20832d776ecd381af1e938f03ac7b9b1cef21b16"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNzQwNzA4OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.telegram/src/main/java/org/openhab/binding/telegram/internal/TelegramHandler.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQwNzo0NDoxNVrOGgCd6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQwODowOTowM1rOGgCjsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI0ODA0Mg==", "bodyText": "If you trim() earlier it is not a good idea to use substring(1) on the not trimmed String. Maybe introduced a local variable for the `trimmedChatId and use it here and in the following lines.", "url": "https://github.com/openhab/openhab-addons/pull/7857#discussion_r436248042", "createdAt": "2020-06-06T07:44:15Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.binding.telegram/src/main/java/org/openhab/binding/telegram/internal/TelegramHandler.java", "diffHunk": "@@ -138,10 +140,23 @@ public void initialize() {\n         TelegramConfiguration config = getConfigAs(TelegramConfiguration.class);\n \n         String botToken = config.getBotToken();\n-        chatIds.clear();\n+        authorizedSenderChatId.clear();\n+        receiverChatId.clear();\n+\n         for (String chatIdStr : config.getChatIds()) {\n             try {\n-                chatIds.add(Long.valueOf(chatIdStr));\n+                if (chatIdStr.trim().startsWith(\"<\")) {\n+                    // inbound only\n+                    authorizedSenderChatId.add(Long.valueOf(chatIdStr.substring(1)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c7f7a87476a1a2508fcfbe6835ce544bcd18655"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI0OTUyMw==", "bodyText": "Good point.Done.", "url": "https://github.com/openhab/openhab-addons/pull/7857#discussion_r436249523", "createdAt": "2020-06-06T08:09:03Z", "author": {"login": "J-N-K"}, "path": "bundles/org.openhab.binding.telegram/src/main/java/org/openhab/binding/telegram/internal/TelegramHandler.java", "diffHunk": "@@ -138,10 +140,23 @@ public void initialize() {\n         TelegramConfiguration config = getConfigAs(TelegramConfiguration.class);\n \n         String botToken = config.getBotToken();\n-        chatIds.clear();\n+        authorizedSenderChatId.clear();\n+        receiverChatId.clear();\n+\n         for (String chatIdStr : config.getChatIds()) {\n             try {\n-                chatIds.add(Long.valueOf(chatIdStr));\n+                if (chatIdStr.trim().startsWith(\"<\")) {\n+                    // inbound only\n+                    authorizedSenderChatId.add(Long.valueOf(chatIdStr.substring(1)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI0ODA0Mg=="}, "originalCommit": {"oid": "4c7f7a87476a1a2508fcfbe6835ce544bcd18655"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4980, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}