{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNjExMTg1", "number": 6845, "title": "[mqtt.homie] Add Dimmer functionality", "bodyText": "This Pull Request adds the functionality of PercentageValue to the Homie Binding through which it is possible to link this Channel to a Dimmer Item.\nThis is achieved by looking at the unit value and trying to find the character %. If this character is found the value will be a PercentageValue if not the old behavior will stay.\nSigned-off-by: Sven Kr\u00f6ger svenni.kroeger@gmail.com", "createdAt": "2020-01-16T12:05:58Z", "url": "https://github.com/openhab/openhab-addons/pull/6845", "merged": true, "mergeCommit": {"oid": "641515706c2c1eb89b0755cdf88153ceb6a5b716"}, "closed": true, "closedAt": "2020-04-17T17:16:35Z", "author": {"login": "szwenni"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb65QGvgH2gAyMzYzNjExMTg1OjNkYTJlYTkxZDkxZjQ2NjgyNzc2MzQ5YzI5ZTA2ZmJjZTQzMmRkMGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYkhPIgFqTM5NTYzMTE2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3da2ea91d91f46682776349c29e06fbce432dd0f", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/3da2ea91d91f46682776349c29e06fbce432dd0f", "committedDate": "2020-01-16T12:24:43Z", "message": "added changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dc8f8ac1b2fd2e9f98132daff28f98ef7af44aa", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/6dc8f8ac1b2fd2e9f98132daff28f98ef7af44aa", "committedDate": "2020-01-16T12:25:00Z", "message": "removing whitespaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "393ec6bd56c1ba077a16457964ab37fcac739be4", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/393ec6bd56c1ba077a16457964ab37fcac739be4", "committedDate": "2020-01-16T12:25:16Z", "message": "reverting classpath files to original"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10b90f275f1c328143796769c9c521e0e8686e63", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/10b90f275f1c328143796769c9c521e0e8686e63", "committedDate": "2020-01-16T11:55:07Z", "message": "reverting classpath files to original"}, "afterCommit": {"oid": "393ec6bd56c1ba077a16457964ab37fcac739be4", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/393ec6bd56c1ba077a16457964ab37fcac739be4", "committedDate": "2020-01-16T12:25:16Z", "message": "reverting classpath files to original"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MDMzODA5", "url": "https://github.com/openhab/openhab-addons/pull/6845#pullrequestreview-344033809", "createdAt": "2020-01-16T16:12:45Z", "commit": {"oid": "393ec6bd56c1ba077a16457964ab37fcac739be4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxNjoxMjo0NlrOFefCTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxNjoxNDozNVrOFefGdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzUxMDA5NA==", "bodyText": "Why are you checking if the 'format' field contains the \"%\" sign? Shouldn't this be:\nif (attributes.unit != null && attributes.unit.contains(\"%\")) {\nHomie V4 specification defines that, for integer and float, \"format\" can only describe 'a range of payloads e.g. 10:15' (https://homieiot.github.io/specification/#property-attributes).\nPerhaps there is something I'm misssing \ud83e\udd14\nEDIT: Perhaps we should also check if the format is 0:100, so that we can ensure that the  published value is not outside the Percentage range (0-100).", "url": "https://github.com/openhab/openhab-addons/pull/6845#discussion_r367510094", "createdAt": "2020-01-16T16:12:46Z", "author": {"login": "bodiroga"}, "path": "bundles/org.openhab.binding.mqtt.homie/src/main/java/org/openhab/binding/mqtt/homie/internal/homie300/Property.java", "diffHunk": "@@ -187,13 +188,16 @@ public void createChannelFromAttribute() {\n                 BigDecimal min = s.length == 2 ? convertFromString(s[0]) : null;\n                 BigDecimal max = s.length == 2 ? convertFromString(s[1]) : null;\n                 BigDecimal step = (min != null && max != null)\n-                        ? max.subtract(min).divide(new BigDecimal(100.0), new MathContext(isDecimal ? 2 : 0))\n-                        : null;\n+                           ? max.subtract(min).divide(new BigDecimal(100.0), new MathContext(isDecimal ? 2 : 0))\n+                           : null;\n                 if (step != null && !isDecimal && step.intValue() <= 0) {\n-                    step = new BigDecimal(1);\n+                        step = new BigDecimal(1);\n+                }\n+                if(attributes.unit != null && attributes.format.contains(\"%\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "393ec6bd56c1ba077a16457964ab37fcac739be4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzUxMTE1OQ==", "bodyText": "Is there any formatting problem here? There are 3 more spaces in this lines.", "url": "https://github.com/openhab/openhab-addons/pull/6845#discussion_r367511159", "createdAt": "2020-01-16T16:14:35Z", "author": {"login": "bodiroga"}, "path": "bundles/org.openhab.binding.mqtt.homie/src/main/java/org/openhab/binding/mqtt/homie/internal/homie300/Property.java", "diffHunk": "@@ -187,13 +188,16 @@ public void createChannelFromAttribute() {\n                 BigDecimal min = s.length == 2 ? convertFromString(s[0]) : null;\n                 BigDecimal max = s.length == 2 ? convertFromString(s[1]) : null;\n                 BigDecimal step = (min != null && max != null)\n-                        ? max.subtract(min).divide(new BigDecimal(100.0), new MathContext(isDecimal ? 2 : 0))\n-                        : null;\n+                           ? max.subtract(min).divide(new BigDecimal(100.0), new MathContext(isDecimal ? 2 : 0))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "393ec6bd56c1ba077a16457964ab37fcac739be4"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "154335b61071e0d4f771b1aa285ab3c9ff2e79b1", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/154335b61071e0d4f771b1aa285ab3c9ff2e79b1", "committedDate": "2020-01-17T10:13:34Z", "message": "changed format to unit\n\nSigned-off-by: Sven Kroeger <svenni.kroeger@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a953f27fb34d633dfe0ba6c3cffe6d6d13af533", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/6a953f27fb34d633dfe0ba6c3cffe6d6d13af533", "committedDate": "2020-01-17T10:16:54Z", "message": "Fixed Formatting in Property.java\n\nSigned-off-by: Sven Kroeger <svenni.kroeger@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTQyMjk4", "url": "https://github.com/openhab/openhab-addons/pull/6845#pullrequestreview-344942298", "createdAt": "2020-01-18T12:53:20Z", "commit": {"oid": "6a953f27fb34d633dfe0ba6c3cffe6d6d13af533"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxMjo1MzoyMVrOFfKs6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxMjo1NToxNlrOFfKtOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyNTUxNA==", "bodyText": "New spacing problem? Have you applied the openHAB formatter to your Eclipse IDE?", "url": "https://github.com/openhab/openhab-addons/pull/6845#discussion_r368225514", "createdAt": "2020-01-18T12:53:21Z", "author": {"login": "bodiroga"}, "path": "bundles/org.openhab.binding.mqtt.homie/src/main/java/org/openhab/binding/mqtt/homie/internal/homie300/Property.java", "diffHunk": "@@ -190,10 +191,13 @@ public void createChannelFromAttribute() {\n                         ? max.subtract(min).divide(new BigDecimal(100.0), new MathContext(isDecimal ? 2 : 0))\n                         : null;\n                 if (step != null && !isDecimal && step.intValue() <= 0) {\n-                    step = new BigDecimal(1);\n+                        step = new BigDecimal(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a953f27fb34d633dfe0ba6c3cffe6d6d13af533"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyNTU5NQ==", "bodyText": "if (attribute.unit != null && attributes.unit.contains(\"%\")) {\nWe usually place a white space between the 'if' and the parenthesis. Let's keep this coherent across the file.", "url": "https://github.com/openhab/openhab-addons/pull/6845#discussion_r368225595", "createdAt": "2020-01-18T12:55:16Z", "author": {"login": "bodiroga"}, "path": "bundles/org.openhab.binding.mqtt.homie/src/main/java/org/openhab/binding/mqtt/homie/internal/homie300/Property.java", "diffHunk": "@@ -190,10 +191,13 @@ public void createChannelFromAttribute() {\n                         ? max.subtract(min).divide(new BigDecimal(100.0), new MathContext(isDecimal ? 2 : 0))\n                         : null;\n                 if (step != null && !isDecimal && step.intValue() <= 0) {\n-                    step = new BigDecimal(1);\n+                        step = new BigDecimal(1);\n+                }\n+                if(attributes.unit != null && attributes.unit.contains(\"%\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a953f27fb34d633dfe0ba6c3cffe6d6d13af533"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72c73048ffdaea8741f6adfbaee3ff96957a4348", "author": {"user": {"login": "szwenni", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/72c73048ffdaea8741f6adfbaee3ff96957a4348", "committedDate": "2020-01-18T13:51:11Z", "message": "Formatting\n\nSigned-off-by: Sven Kroeger <svenni.kroeger@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTY5Njk4", "url": "https://github.com/openhab/openhab-addons/pull/6845#pullrequestreview-344969698", "createdAt": "2020-01-19T00:52:48Z", "commit": {"oid": "72c73048ffdaea8741f6adfbaee3ff96957a4348"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NjMxMTY0", "url": "https://github.com/openhab/openhab-addons/pull/6845#pullrequestreview-395631164", "createdAt": "2020-04-17T17:13:09Z", "commit": {"oid": "72c73048ffdaea8741f6adfbaee3ff96957a4348"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1664, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}