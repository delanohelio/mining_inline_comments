{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4OTgxNzI1", "number": 7656, "title": "[mqtt.homeassistant] Create trigger channels for stateless sensors", "bodyText": "This PR creates trigger channels (and not state channels) for HA sensor components that send stateless information (action and button press events, mainly). The implementation is not device specific and it should be generic enough to be accepted. We can also add more objectIDs if they are used to send this type of information, but, in theory, this list should be short.\nWhat do you think? @jochen314?\nCloses: #6878\nSigned-off-by: Aitor Iturrioz riturrioz@gmail.com", "createdAt": "2020-05-16T15:18:32Z", "url": "https://github.com/openhab/openhab-addons/pull/7656", "merged": true, "mergeCommit": {"oid": "40e0079285530b2975eec76db46965e75bb53520"}, "closed": true, "closedAt": "2020-09-01T12:20:47Z", "author": {"login": "bodiroga"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchheFxgH2gAyNDE4OTgxNzI1OjQxYWQwMTVhZDBlNjFlYjZlY2I5ZjY2ZjU5MmI3NTNiZDRmZjhmNWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEmcEZgFqTQ3OTY4MjI5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "41ad015ad0e61eb6ecb9f66f592b753bd4ff8f5d", "author": {"user": {"login": "bodiroga", "name": "Aitor Iturrioz"}}, "url": "https://github.com/openhab/openhab-addons/commit/41ad015ad0e61eb6ecb9f66f592b753bd4ff8f5d", "committedDate": "2020-05-15T12:45:19Z", "message": "Create trigger channels for action and click objects\n\nSigned-off-by: Aitor Iturrioz <riturrioz@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTAzODg2", "url": "https://github.com/openhab/openhab-addons/pull/7656#pullrequestreview-413103886", "createdAt": "2020-05-16T19:51:06Z", "commit": {"oid": "41ad015ad0e61eb6ecb9f66f592b753bd4ff8f5d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxOTo1MTowNlrOGWcSEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxOTo1MToxMFrOGWcSGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE4NTIzNQ==", "bodyText": "Why do you explicitly create the String[]? The asList method has varags paramters", "url": "https://github.com/openhab/openhab-addons/pull/7656#discussion_r426185235", "createdAt": "2020-05-16T19:51:06Z", "author": {"login": "jochen314"}, "path": "bundles/org.openhab.binding.mqtt.homeassistant/src/main/java/org/openhab/binding/mqtt/homeassistant/internal/ComponentSensor.java", "diffHunk": "@@ -27,6 +30,7 @@\n @NonNullByDefault\n public class ComponentSensor extends AbstractComponent<ComponentSensor.ChannelConfiguration> {\n     public static final String sensorChannelID = \"sensor\"; // Randomly chosen channel \"ID\"\n+    private static final List<String> triggerObjectIDs = Arrays.asList(new String[] { \"click\", \"action\" });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ad015ad0e61eb6ecb9f66f592b753bd4ff8f5d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE4NTI0MQ==", "bodyText": "This is the part I am not happy with.\nThe check against 2 explicit values is not future save. I see many people wanting to have different values in the list also to make their device work.", "url": "https://github.com/openhab/openhab-addons/pull/7656#discussion_r426185241", "createdAt": "2020-05-16T19:51:10Z", "author": {"login": "jochen314"}, "path": "bundles/org.openhab.binding.mqtt.homeassistant/src/main/java/org/openhab/binding/mqtt/homeassistant/internal/ComponentSensor.java", "diffHunk": "@@ -61,8 +65,12 @@ public ComponentSensor(CFactory.ComponentConfiguration componentConfiguration) {\n             value = new TextValue();\n         }\n \n+        String objectId = componentConfiguration.getHaID().objectID;\n+\n+        boolean trigger = triggerObjectIDs.contains(objectId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ad015ad0e61eb6ecb9f66f592b753bd4ff8f5d"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fb15d53ee1ac27b659c816c0c9cceea0323a35e", "author": {"user": {"login": "bodiroga", "name": "Aitor Iturrioz"}}, "url": "https://github.com/openhab/openhab-addons/commit/0fb15d53ee1ac27b659c816c0c9cceea0323a35e", "committedDate": "2020-05-17T15:47:19Z", "message": "Create trigger channels for stateless sensors\n\nSigned-off-by: Aitor Iturrioz <riturrioz@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1Njg1ODkx", "url": "https://github.com/openhab/openhab-addons/pull/7656#pullrequestreview-475685891", "createdAt": "2020-08-26T17:01:17Z", "commit": {"oid": "0fb15d53ee1ac27b659c816c0c9cceea0323a35e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNzowMToxN1rOHHVXgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNzowMToxN1rOHHVXgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ1MjE2MQ==", "bodyText": "How about:\nPattern triggerIcons = Pattern.compile(\"^mdi:(toggle|gesture).*$\");\n\nand then\nboolean trigger = triggerIcons.matcher(icon).matches();", "url": "https://github.com/openhab/openhab-addons/pull/7656#discussion_r477452161", "createdAt": "2020-08-26T17:01:17Z", "author": {"login": "jochen314"}, "path": "bundles/org.openhab.binding.mqtt.homeassistant/src/main/java/org/openhab/binding/mqtt/homeassistant/internal/ComponentSensor.java", "diffHunk": "@@ -27,6 +30,7 @@\n @NonNullByDefault\n public class ComponentSensor extends AbstractComponent<ComponentSensor.ChannelConfiguration> {\n     public static final String sensorChannelID = \"sensor\"; // Randomly chosen channel \"ID\"\n+    private static final List<String> triggerIcons = Arrays.asList(\"mdi:toggle\", \"mdi:gesture\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fb15d53ee1ac27b659c816c0c9cceea0323a35e"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86e889421fa7dd9c4df76ed37ec5f358aacf5428", "author": {"user": {"login": "bodiroga", "name": "Aitor Iturrioz"}}, "url": "https://github.com/openhab/openhab-addons/commit/86e889421fa7dd9c4df76ed37ec5f358aacf5428", "committedDate": "2020-08-27T19:00:43Z", "message": "Address review comments\n\nSigned-off-by: Aitor Iturrioz <riturrioz@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MTA5NzAx", "url": "https://github.com/openhab/openhab-addons/pull/7656#pullrequestreview-477109701", "createdAt": "2020-08-27T21:51:51Z", "commit": {"oid": "86e889421fa7dd9c4df76ed37ec5f358aacf5428"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NjgyMjk5", "url": "https://github.com/openhab/openhab-addons/pull/7656#pullrequestreview-479682299", "createdAt": "2020-09-01T12:19:59Z", "commit": {"oid": "86e889421fa7dd9c4df76ed37ec5f358aacf5428"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 561, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}