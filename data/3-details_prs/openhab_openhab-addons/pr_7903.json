{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzNTU0Mzk1", "number": 7903, "title": "[Robonect] Use global openHAB timezone for DateTime objects", "bodyText": "Use the timezone that has been configured by the user in openHAB settings\nfor all robonect messages instead of UTC.\nFixes #7848\nSigned-off-by: Stefan Triller github@stefantriller.de", "createdAt": "2020-06-12T08:56:08Z", "url": "https://github.com/openhab/openhab-addons/pull/7903", "merged": true, "mergeCommit": {"oid": "00a2cd55daece0f194d1b3f9f30584da655ad3d7"}, "closed": true, "closedAt": "2020-06-17T17:50:58Z", "author": {"login": "t2000"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqe9uAAH2gAyNDMzNTU0Mzk1OmNlNzc4ZjcyZGNkMjQzZmZhYjMyYTYxNWMzZTg0ZTVlZTdlOGRhMjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsNnUqAFqTQzMjYzNjczOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ce778f72dcd243ffab32a615c3e84e5ee7e8da23", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/ce778f72dcd243ffab32a615c3e84e5ee7e8da23", "committedDate": "2020-06-12T08:55:28Z", "message": "[Robonect] Use global openHAB timezone for DateTime objects\n\nUse the timezone that has been configured by the user in openHAB settings\nfor all robonect messages instead of UTC.\n\nFixes #7848\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d6be63be7fd8da4a94d6ba598e21dfbcb22c99a", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/3d6be63be7fd8da4a94d6ba598e21dfbcb22c99a", "committedDate": "2020-06-12T14:03:38Z", "message": "[robonect] Provide timezone configuration parameter on thing\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ced56692ae29397b0cb8897a7fc8ffc00c48d94", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/7ced56692ae29397b0cb8897a7fc8ffc00c48d94", "committedDate": "2020-06-12T14:32:02Z", "message": "[robonect] Use openHAB timezone on error\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDcyODA3", "url": "https://github.com/openhab/openhab-addons/pull/7903#pullrequestreview-430072807", "createdAt": "2020-06-12T22:45:38Z", "commit": {"oid": "7ced56692ae29397b0cb8897a7fc8ffc00c48d94"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0NTozOVrOGjTWhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0NTozOVrOGjTWhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDQwNw==", "bodyText": "This will throw an NPE if timeZoneString is null.", "url": "https://github.com/openhab/openhab-addons/pull/7903#discussion_r439670407", "createdAt": "2020-06-12T22:45:39Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.robonect/src/main/java/org/openhab/binding/robonect/internal/handler/RobonectHandler.java", "diffHunk": "@@ -329,6 +345,16 @@ public void initialize() {\n         RobonectConfig robonectConfig = getConfigAs(RobonectConfig.class);\n         RobonectEndpoint endpoint = new RobonectEndpoint(robonectConfig.getHost(), robonectConfig.getUser(),\n                 robonectConfig.getPassword());\n+\n+        String timeZoneString = robonectConfig.getTimezone();\n+        try {\n+            timeZone = ZoneId.of(timeZoneString);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ced56692ae29397b0cb8897a7fc8ffc00c48d94"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "beb09bf852be0fb88cd2f31a92f51a5543ae2cfb", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/beb09bf852be0fb88cd2f31a92f51a5543ae2cfb", "committedDate": "2020-06-13T08:51:17Z", "message": "[robonect] Fix NPE\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTY1MjM0", "url": "https://github.com/openhab/openhab-addons/pull/7903#pullrequestreview-430165234", "createdAt": "2020-06-13T20:30:25Z", "commit": {"oid": "beb09bf852be0fb88cd2f31a92f51a5543ae2cfb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QyMDozMDoyNVrOGjZQYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QyMDozMDoyNVrOGjZQYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2NzEzOQ==", "bodyText": "I think instead of caching this value in a field, you might consider dynamically creating it every time since its value should fall back to the timeZoneProvider timezone whenever it isn't specified by the config.\nThe problem I see is that the value returned by timeZoneProvider might change over time if the user changes settings in runtime.\nSo any value returned by timeZoneProvider should never be cached since it might change at any time, without notification.", "url": "https://github.com/openhab/openhab-addons/pull/7903#discussion_r439767139", "createdAt": "2020-06-13T20:30:25Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.robonect/src/main/java/org/openhab/binding/robonect/internal/handler/RobonectHandler.java", "diffHunk": "@@ -71,12 +74,16 @@\n     private ScheduledFuture<?> pollingJob;\n \n     private HttpClient httpClient;\n+    private TimeZoneProvider timeZoneProvider;\n+\n+    private ZoneId timeZone = ZoneId.of(\"Europe/Berlin\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "beb09bf852be0fb88cd2f31a92f51a5543ae2cfb"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "82a950f1ca21460898fc29573c4972237066ea80", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/82a950f1ca21460898fc29573c4972237066ea80", "committedDate": "2020-06-14T10:07:19Z", "message": "[robonect] Get Timezone from config on each request\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}, "afterCommit": {"oid": "beb09bf852be0fb88cd2f31a92f51a5543ae2cfb", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/beb09bf852be0fb88cd2f31a92f51a5543ae2cfb", "committedDate": "2020-06-13T08:51:17Z", "message": "[robonect] Fix NPE\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75421753c9d3073c7378cb5ae4c99ecc662a8a93", "author": {"user": {"login": "t2000", "name": "Stefan Triller"}}, "url": "https://github.com/openhab/openhab-addons/commit/75421753c9d3073c7378cb5ae4c99ecc662a8a93", "committedDate": "2020-06-17T15:12:38Z", "message": "[robonect] Always get timezone from openHAB settings if not set on Thing\n\nSigned-off-by: Stefan Triller <github@stefantriller.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNjM2NzM5", "url": "https://github.com/openhab/openhab-addons/pull/7903#pullrequestreview-432636739", "createdAt": "2020-06-17T17:50:28Z", "commit": {"oid": "75421753c9d3073c7378cb5ae4c99ecc662a8a93"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 243, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}