{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MTAxNTkx", "number": 7659, "title": "[shelly] Watchdog timer, new channel updateAvailable", "bodyText": "#7275: Observe device availability, go OFFLINE when device does not respond\n#7519: New channel device#updateAvailable (indicator for new firmware)\n#7654: Fix sensor channels are not created for Shelly Sense (confirmation open)\ndon't do an early-CoAP start for Shelly Sense (it's not battery powered)", "createdAt": "2020-05-17T11:49:38Z", "url": "https://github.com/openhab/openhab-addons/pull/7659", "merged": true, "mergeCommit": {"oid": "33a23985f2be27b41e1af492ecf8871a46758b7c"}, "closed": true, "closedAt": "2020-05-18T05:37:49Z", "author": {"login": "markus7017"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciJt8RAH2gAyNDE5MTAxNTkxOmU3ZDlkMGM0YjY1ZjAyZTEwNDUwN2VhMTU2ODdmY2ZlYmEwNzg1YWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABciZI1ZgFqTQxMzI4MjUzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e7d9d0c4b65f02e104507ea15687fcfeba0785af", "author": {"user": {"login": "markus7017", "name": "Markus Michels"}}, "url": "https://github.com/openhab/openhab-addons/commit/e7d9d0c4b65f02e104507ea15687fcfeba0785af", "committedDate": "2020-05-17T11:38:50Z", "message": "#7275: Observe device availability, go OFFLINE when device does not\nrespond\n#7519: New channel device#updateAvailable (indicator for new firmware)\n#7654: Fix sensor channels are not created for Shelly Sense\n(confirmation open)\ndon't do an early-CoAP start for Shelly Sense (it's not battery powered)\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b220f88f70e1ada6cda6c7b19a920fcbb6723892", "author": {"user": {"login": "markus7017", "name": "Markus Michels"}}, "url": "https://github.com/openhab/openhab-addons/commit/b220f88f70e1ada6cda6c7b19a920fcbb6723892", "committedDate": "2020-05-17T11:47:50Z", "message": "README updated\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMjEyOTE5", "url": "https://github.com/openhab/openhab-addons/pull/7659#pullrequestreview-413212919", "createdAt": "2020-05-18T00:00:43Z", "commit": {"oid": "b220f88f70e1ada6cda6c7b19a920fcbb6723892"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMDoxNDozNFrOGWkm6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMDoxNDozNFrOGWkm6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMTY0Mw==", "bodyText": "You seem to be using this to implement some kind of timeout. I wouldn't suggest using a StopWatch to accomplish this. A watchdog is typically implemented as a scheduled or periodic task. It also seems like you are using the watchdog for multiple purposes, both as an update timeout and to track the time between updates.\nThe watchdog should be single purpose otherwise you open yourself up to a lot of potential bugs.\nAnother issue is that your watchdog doesn't actually trigger anything on it's own, if the timeout expires nothing will happen until refreshStatus is called which unknown issues may prevent from happening in a timely manner. It might be better to implement your watchdog as a ScheduledFuture instead.", "url": "https://github.com/openhab/openhab-addons/pull/7659#discussion_r426321643", "createdAt": "2020-05-18T00:14:34Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.shelly/src/main/java/org/openhab/binding/shelly/internal/handler/ShellyBaseHandler.java", "diffHunk": "@@ -90,6 +91,7 @@\n     private long lastUptime = 0;\n     private long lastAlarmTs = 0;\n     private long lastTimeoutErros = -1;\n+    private final StopWatch watchdog = new StopWatch();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b220f88f70e1ada6cda6c7b19a920fcbb6723892"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMjgyNTMy", "url": "https://github.com/openhab/openhab-addons/pull/7659#pullrequestreview-413282532", "createdAt": "2020-05-18T05:36:47Z", "commit": {"oid": "b220f88f70e1ada6cda6c7b19a920fcbb6723892"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 563, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}