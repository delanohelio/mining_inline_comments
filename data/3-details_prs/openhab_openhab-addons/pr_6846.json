{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNzIwODI4", "number": 6846, "title": "[onewiregpio] Added precision parameter to OneWireGpio Binding", "bodyText": "Upon a request from a friend of mine I've added additional parameter to the binding which allows you to lower the precision of the received temperature number from the filesystem.\nA bit of background about the binding itself - the binding reads files inside /sys/bus/w1/devices/DEVICE_ID_FOLDER/w1_slave.\nIf there is t=xxxxx, where xxxxx is integer value. Then the binding makes a BigDecimal.valueOf(xxxxx).movePointLeft(3) and returns the value. This makes tha maximum possible precision after the floating point to be total of 3 (i.e. the digits after the floating point).\nThe precision parameter allows you to reduce this number down to 0, 1, 2 or 3(the default value is the max value) with round half up rounding strategy. This allows you not to spam event bus on every small change of the sensors and disables triggering of different rules without need (with too small changes of the number).\nSaw that the original author is Anathol Ogorek but was not able to request a review from him as I couldn't find him on the Reviewers list. :(\nThe changes from the commit:\n\nAdded precision parameter which allows to lower precision of value\nread from the file system\nImplemented configuration class for easier read of configuration\nthrough the reflection method in the framework\nMoved the read of configuration parameters to initialize method\nleaving the checkConfiguration method to do only validation\nUpdated the README\n\nCheers,\nKonstantin", "createdAt": "2020-01-16T16:00:06Z", "url": "https://github.com/openhab/openhab-addons/pull/6846", "merged": true, "mergeCommit": {"oid": "1f7c2c7623aac2504752ddd56ae5212c02376756"}, "closed": true, "closedAt": "2020-01-23T17:00:47Z", "author": {"login": "theater"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb68LkygH2gAyMzYzNzIwODI4Ojc5OGVmZGZlMzUzOTQyOTVhOTU2ZDRkN2UyZWZmYWUwNjFhY2RkMGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9NX6wAFqTM0NzQ1ODk0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "798efdfe35394295a956d4d7e2effae061acdd0f", "author": {"user": {"login": "theater", "name": "Konstantin Polihronov"}}, "url": "https://github.com/openhab/openhab-addons/commit/798efdfe35394295a956d4d7e2effae061acdd0f", "committedDate": "2020-01-16T15:49:29Z", "message": "Added precision parameter to OneWire Binding\n\n* Added precision parameter which allows to lower precision of value\nread from the file system\n* Implemented configuration class for easier read of configuration\nthrough the reflection method in the framework\n* Moved the read of configuration parameters to initialize method\nleaving the checkConfiguration method to do only validation\n* Updated the README\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDM0Mjg3", "url": "https://github.com/openhab/openhab-addons/pull/6846#pullrequestreview-344434287", "createdAt": "2020-01-17T08:51:36Z", "commit": {"oid": "798efdfe35394295a956d4d7e2effae061acdd0f"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwODo1MTozNlrOFeyRig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwODo1MzozMVrOFeyUcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTI5MA==", "bodyText": "Please add the bounds also here", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367825290", "createdAt": "2020-01-17T08:51:36Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.onewiregpio/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -22,6 +22,13 @@\n \t\t\t\t<default>600</default>\n \t\t\t</parameter>\n \n+\t\t\t<parameter name=\"precision\" type=\"integer\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efdfe35394295a956d4d7e2effae061acdd0f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTM2MQ==", "bodyText": "Please capitalize the P", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367825361", "createdAt": "2020-01-17T08:51:49Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.onewiregpio/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -22,6 +22,13 @@\n \t\t\t\t<default>600</default>\n \t\t\t</parameter>\n \n+\t\t\t<parameter name=\"precision\" type=\"integer\">\n+\t\t\t\t<label>Sensor precision</label>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efdfe35394295a956d4d7e2effae061acdd0f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNjAzNA==", "bodyText": "Consider using the constant 3 as well here to keep the logging correct when the constant is changes in the future", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367826034", "createdAt": "2020-01-17T08:53:31Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.onewiregpio/src/main/java/org/openhab/binding/onewiregpio/internal/handler/OneWireGPIOHandler.java", "diffHunk": "@@ -84,21 +93,25 @@ public void initialize() {\n      * When invalid parameter is found, default value is assigned.\n      */\n     private boolean checkConfiguration() {\n-        Configuration configuration = getConfig();\n-        gpioBusFile = (String) configuration.get(GPIO_BUS_FILE);\n         if (StringUtils.isEmpty(gpioBusFile)) {\n             logger.debug(\"GPIO_BUS_FILE not set. Please check configuration, and set proper path to w1_slave file.\");\n             updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n                     \"The path to the w1_slave sensor data file is missing.\");\n             return false;\n         }\n \n-        refreshTime = ((Number) configuration.get(REFRESH_TIME)).intValue();\n-        if (refreshTime.intValue() <= 0) {\n-            logger.warn(\"Refresh time [{}] is not valid. Falling back to default value: {}.\", refreshTime,\n+        if (refreshTime <= 0) {\n+            logger.debug(\"Refresh time [{}] is not valid. Falling back to default value: {}.\", refreshTime,\n                     DEFAULT_REFRESH_TIME);\n             refreshTime = DEFAULT_REFRESH_TIME;\n         }\n+\n+        if (precision < 0 || precision > MAX_PRECISION_VALUE) {\n+            logger.debug(\"Precision value {} is outside allowed values [0 - 3]. Falling back to default value: {}.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "798efdfe35394295a956d4d7e2effae061acdd0f"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8363ed0d472d53d8da1d7533a9f9ae35061b8cfa", "author": {"user": {"login": "theater", "name": "Konstantin Polihronov"}}, "url": "https://github.com/openhab/openhab-addons/commit/8363ed0d472d53d8da1d7533a9f9ae35061b8cfa", "committedDate": "2020-01-17T14:39:19Z", "message": "Two out of three changes from Martin's review\n\n* Fixed capital letter in parameter label\n* Fixed logging by providing max value as parameter\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b83bd62ccd6db0794076f4d79a6018be937b570", "author": {"user": {"login": "theater", "name": "Konstantin Polihronov"}}, "url": "https://github.com/openhab/openhab-addons/commit/5b83bd62ccd6db0794076f4d79a6018be937b570", "committedDate": "2020-01-17T17:24:36Z", "message": "Added fixed values for precision\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTY2NDgw", "url": "https://github.com/openhab/openhab-addons/pull/6846#pullrequestreview-345166480", "createdAt": "2020-01-20T09:17:19Z", "commit": {"oid": "5b83bd62ccd6db0794076f4d79a6018be937b570"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwOToxNzoyMFrOFfXqEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwOToxNzoyMFrOFfXqEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQzNzc3Nw==", "bodyText": "Options are only meant for string parameters", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r368437777", "createdAt": "2020-01-20T09:17:20Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.onewiregpio/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -22,6 +22,20 @@\n \t\t\t\t<default>600</default>\n \t\t\t</parameter>\n \n+\t\t\t<parameter name=\"precision\" type=\"integer\">\n+\t\t\t\t<label>Sensor Precision</label>\n+\t\t\t\t<description>Sensor precision after floating point.</description>\n+\t\t\t\t<required>false</required>\n+\t\t\t\t<options>\n+\t\t\t\t\t<option value=\"0\">0</option>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b83bd62ccd6db0794076f4d79a6018be937b570"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26cc4169d91b059241393333ea31787509ee3165", "author": {"user": {"login": "theater", "name": "Konstantin Polihronov"}}, "url": "https://github.com/openhab/openhab-addons/commit/26cc4169d91b059241393333ea31787509ee3165", "committedDate": "2020-01-20T09:20:49Z", "message": "Add min/max values to precision parameter, remove options\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTY5MzUx", "url": "https://github.com/openhab/openhab-addons/pull/6846#pullrequestreview-345169351", "createdAt": "2020-01-20T09:21:52Z", "commit": {"oid": "26cc4169d91b059241393333ea31787509ee3165"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDU4OTQw", "url": "https://github.com/openhab/openhab-addons/pull/6846#pullrequestreview-347458940", "createdAt": "2020-01-23T16:59:12Z", "commit": {"oid": "26cc4169d91b059241393333ea31787509ee3165"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1667, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}