{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MzEwMTY4", "number": 7143, "title": "[goecharger] fixed access config command and parse command response", "bodyText": "Followup to #7068\nThere was an error in handling the access state command. I just tested it and noticed, that the commands were not translated correctly so i fixed it.\nI also added parsing of the response body of the POST request, as it contains the same data in the body, as a normal GET request. So by sending a command we always get the latest values without the need to query them again.\nThis is useful for example when setting the access config, as it also has side effects on other properties.\nFor example\naccessConfig \"OPEN\" will set allowCharging to true\naccessConfig \"RFID\" will set allowCharging to false\nSo when we set \"OPEN\" we will immidiately get the result for allowChargingwithout additional GET.\n@wborn, @J-N-K sorry for requesting your review again, but you already know my code, so can you please have a look? its a quite small code change.", "createdAt": "2020-03-10T18:59:55Z", "url": "https://github.com/openhab/openhab-addons/pull/7143", "merged": true, "mergeCommit": {"oid": "0130b1467aa8626b6c01f9a66d027c5a094d32f5"}, "closed": true, "closedAt": "2020-03-12T04:05:56Z", "author": {"login": "SamuelBrucksch"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMXMsHgH2gAyMzg2MzEwMTY4OjcwOThiYjk1YmVhZDlkMDI0Y2U1ODdkOTA3ODhmNWMwYzJlN2ZmMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMsVVdAFqTM3MzA2MjkzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7098bb95bead9d024ce587d90788f5c0c2e7ff2a", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/7098bb95bead9d024ce587d90788f5c0c2e7ff2a", "committedDate": "2020-03-10T18:54:51Z", "message": "fixed access state and parse command rsponse\n\nSigned-off-by: Samuel Brucksch <sasliga@freenet.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjY1OTE5", "url": "https://github.com/openhab/openhab-addons/pull/7143#pullrequestreview-372265919", "createdAt": "2020-03-10T19:40:57Z", "commit": {"oid": "7098bb95bead9d024ce587d90788f5c0c2e7ff2a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOTo0MDo1N1rOF0ePrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOTo0MDo1N1rOF0ePrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDU2NTgwNA==", "bodyText": "You can now save contentResponse.getContentAsString() to a variable and also use it in the log statement above. Since the content string is now used anyways, it also makes sense to unconditionally log it without if (logger.isDebugEnabled()) { since it won't have an additional impact on performance.", "url": "https://github.com/openhab/openhab-addons/pull/7143#discussion_r390565804", "createdAt": "2020-03-10T19:40:57Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.goecharger/src/main/java/org/openhab/binding/goecharger/internal/handler/GoEChargerHandler.java", "diffHunk": "@@ -287,7 +301,9 @@ private void sendData(String key, String value) {\n             if (logger.isDebugEnabled()) {\n                 logger.debug(\"Response: {}\", contentResponse.getContentAsString());\n             }\n-            updateStatus(ThingStatus.ONLINE, ThingStatusDetail.NONE);\n+            GoEStatusResponseDTO result = gson.fromJson(contentResponse.getContentAsString(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7098bb95bead9d024ce587d90788f5c0c2e7ff2a"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjczMjk3", "url": "https://github.com/openhab/openhab-addons/pull/7143#pullrequestreview-372273297", "createdAt": "2020-03-10T19:52:27Z", "commit": {"oid": "7098bb95bead9d024ce587d90788f5c0c2e7ff2a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOTo1MjoyN1rOF0emug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOTo1MjoyN1rOF0emug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDU3MTcwNg==", "bodyText": "I would make sure to either log the exception or include the exception message as part of the status details.\nThere is a big difference between a device not responding and the device returning erroneous data. It is beneficial for the user to know which one it is.\nAlso make sure to catch JsonSyntaxException!\nThis also applies to thegetGoEData() below.", "url": "https://github.com/openhab/openhab-addons/pull/7143#discussion_r390571706", "createdAt": "2020-03-10T19:52:27Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.goecharger/src/main/java/org/openhab/binding/goecharger/internal/handler/GoEChargerHandler.java", "diffHunk": "@@ -287,7 +301,9 @@ private void sendData(String key, String value) {\n             if (logger.isDebugEnabled()) {\n                 logger.debug(\"Response: {}\", contentResponse.getContentAsString());\n             }\n-            updateStatus(ThingStatus.ONLINE, ThingStatusDetail.NONE);\n+            GoEStatusResponseDTO result = gson.fromJson(contentResponse.getContentAsString(),\n+                    GoEStatusResponseDTO.class);\n+            updateChannelsAndStatus(result);\n         } catch (InterruptedException | TimeoutException | ExecutionException e) {\n             updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.OFFLINE.COMMUNICATION_ERROR,\n                     \"No response received on command\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7098bb95bead9d024ce587d90788f5c0c2e7ff2a"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c17a298fdbb7017c357108ccbe21bd8131273fbd", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/c17a298fdbb7017c357108ccbe21bd8131273fbd", "committedDate": "2020-03-11T05:39:43Z", "message": "used variable for response string\n\nSigned-off-by: Samuel Brucksch <sasliga@freenet.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52370aa0994c259a6d83aec2c11d35d3b775c996", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/52370aa0994c259a6d83aec2c11d35d3b775c996", "committedDate": "2020-03-11T19:14:52Z", "message": "improved error messages for offline state\n\nSigned-off-by: Samuel Brucksch <sasliga@freenet.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMDYyOTMy", "url": "https://github.com/openhab/openhab-addons/pull/7143#pullrequestreview-373062932", "createdAt": "2020-03-11T19:32:18Z", "commit": {"oid": "52370aa0994c259a6d83aec2c11d35d3b775c996"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1147, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}