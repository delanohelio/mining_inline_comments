{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMDQ2NjU2", "number": 6957, "title": "[hpprinter] Some small updates to the HP binding", "bodyText": "While traveling I noted some non-standard thing in the HP printer binding and I decided to walk through them. I did not change the flow but cleaned up some details.\n\nsome string comparisons where using ==\nthere were some issues with the null annotations, things were passed along as being null while that would be killing for the status constructing an hp-client without httpClient is useless.\nimproved formatting\nMade more fields immutable\ndo not recreate the status message map on every request\nadd braces for if statements\nUse parseInt to convert int instead of using both parsing and unboxing\nuse diamond operators\nuse method references where possible\ndo not put the device OFFLINE while starting to connect", "createdAt": "2020-02-02T19:37:11Z", "url": "https://github.com/openhab/openhab-addons/pull/6957", "merged": true, "mergeCommit": {"oid": "1be4c1d500f133d56397e371dd14376d86f698cd"}, "closed": true, "closedAt": "2020-02-11T08:09:56Z", "author": {"login": "martinvw"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAdl7AgH2gAyMzcwMDQ2NjU2OmQ5NjkxMDBiNzk2MmVlM2MyNGU0NDlkYzVjNzJiOTFhZWUyNzYzOTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCrDDZgFqTM1NTYxNzcwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d969100b7962ee3c24e449dc5c72b91aee276399", "author": {"user": {"login": "martinvw", "name": "Martin van Wingerden"}}, "url": "https://github.com/openhab/openhab-addons/commit/d969100b7962ee3c24e449dc5c72b91aee276399", "committedDate": "2020-02-02T19:34:45Z", "message": "Some small updates to the HP binding\n\n- some string comparisons where using ==\n- there were some issues with the null annotations, things were passed a long as being null while that would be killing for the status\n- improved formatting\n- Made more fields immutable\n- do not recreate the status message map on every request\n- add braces for if statments\n- Use parseInt to convert int instead of using both parsing and unboxing\n- use diamond operators\n- use method references where possible\n- do not put the device OFFLINE while starting to connect\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTY0MTQ3", "url": "https://github.com/openhab/openhab-addons/pull/6957#pullrequestreview-351964147", "createdAt": "2020-02-02T20:11:51Z", "commit": {"oid": "d969100b7962ee3c24e449dc5c72b91aee276399"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTY1NjQ0", "url": "https://github.com/openhab/openhab-addons/pull/6957#pullrequestreview-351965644", "createdAt": "2020-02-02T20:36:21Z", "commit": {"oid": "d969100b7962ee3c24e449dc5c72b91aee276399"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQyMDozNjoyMVrOFkjZvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQyMDozNjoyMVrOFkjZvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg3MzA4Ng==", "bodyText": "No, I referred to this with that remark", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r373873086", "createdAt": "2020-02-02T20:36:21Z", "author": {"login": "martinvw"}, "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -218,7 +225,7 @@ public void dynamicallyAddChannels(ThingUID thingUid) {\n      * Opens the connection to the Embedded Web Server\n      */\n     public void open() {\n-        goneOffline();\n+        runOfflineScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d969100b7962ee3c24e449dc5c72b91aee276399"}, "originalPosition": 229}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06fb6ce9d6ab95e97baa3d83f66393ec7df232a4", "author": {"user": {"login": "martinvw", "name": "Martin van Wingerden"}}, "url": "https://github.com/openhab/openhab-addons/commit/06fb6ce9d6ab95e97baa3d83f66393ec7df232a4", "committedDate": "2020-02-03T09:21:24Z", "message": "HP printer updates\n\nAdded some properties such as serial number and firmware date/version\nRemoved some duplication\nSupport some additional statuses\nShow more detailed OFFLINE status in UI\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMTU4MTQw", "url": "https://github.com/openhab/openhab-addons/pull/6957#pullrequestreview-352158140", "createdAt": "2020-02-03T10:36:17Z", "commit": {"oid": "06fb6ce9d6ab95e97baa3d83f66393ec7df232a4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "669520943c346a1a0114429013059c31cd7037e0", "author": {"user": {"login": "martinvw", "name": "Martin van Wingerden"}}, "url": "https://github.com/openhab/openhab-addons/commit/669520943c346a1a0114429013059c31cd7037e0", "committedDate": "2020-02-03T14:52:55Z", "message": "HP printer final spotless run\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTQzMzI1", "url": "https://github.com/openhab/openhab-addons/pull/6957#pullrequestreview-355543325", "createdAt": "2020-02-08T11:19:47Z", "commit": {"oid": "669520943c346a1a0114429013059c31cd7037e0"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOFQxMToxOTo0N1rOFnQNCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOFQxMToyNjoxOFrOFnQOJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNDI2NA==", "bodyText": "You can use CoreItemFactory.NUMBER to set the item type:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                            .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), \"Number\")\n          \n          \n            \n                                            .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), CoreItemFactory.NUMBER)", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r376704264", "createdAt": "2020-02-08T11:19:47Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -110,74 +121,80 @@ public void dynamicallyAddChannels(ThingUID thingUid) {\n             }\n \n             switch (data.getType()) {\n-            case SINGLECOLOR:\n-                if (data.hasCumulativeMarking()) {\n+                case SINGLECOLOR:\n+                    if (data.hasCumulativeMarking()) {\n+                        channels.add(ChannelBuilder\n+                                .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), \"Number\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "669520943c346a1a0114429013059c31cd7037e0"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNDQ2OA==", "bodyText": "You already set the status to ONLINE some lines before.", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r376704468", "createdAt": "2020-02-08T11:24:20Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -350,6 +354,9 @@ private void goneOnline() {\n             offlineScheduler = null;\n         }\n \n+        handler.binderStatus(ThingStatus.ONLINE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "669520943c346a1a0114429013059c31cd7037e0"}, "originalPosition": 321}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNDU0OA==", "bodyText": "To avoid duplicate code you can call the close() method here.", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r376704548", "createdAt": "2020-02-08T11:26:18Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -245,53 +262,40 @@ public void goneOffline() {\n             offlineScheduler.cancel(true);\n             offlineScheduler = null;\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "669520943c346a1a0114429013059c31cd7037e0"}, "originalPosition": 251}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0e8400d9d8130bba032545967e9705274b9dfbe", "author": {"user": {"login": "martinvw", "name": "Martin van Wingerden"}}, "url": "https://github.com/openhab/openhab-addons/commit/e0e8400d9d8130bba032545967e9705274b9dfbe", "committedDate": "2020-02-09T07:52:37Z", "message": "Review comments\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NjE3NzA4", "url": "https://github.com/openhab/openhab-addons/pull/6957#pullrequestreview-355617708", "createdAt": "2020-02-09T16:23:11Z", "commit": {"oid": "e0e8400d9d8130bba032545967e9705274b9dfbe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1345, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}