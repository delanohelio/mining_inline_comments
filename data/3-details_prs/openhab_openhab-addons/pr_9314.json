{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1Njk1Njkw", "number": 9314, "title": "[powermax] Improve debugging in message classes", "bodyText": "Each PowermaxBaseMessage subclass had its own toString() which added\nuseful debug info but duplicated a lot of the logic in the message\nhandler. I've moved the debug info inline and removed the duplication,\nand also added decoding for more values to the debug output.\nThis is in preparation for working on #9250.\nSigned-off-by: Ron Isaacson isaacson.ron@gmail.com", "createdAt": "2020-12-10T06:32:16Z", "url": "https://github.com/openhab/openhab-addons/pull/9314", "merged": true, "mergeCommit": {"oid": "353f7af0764c72705d3f08e7a5e897b83e6b32f9"}, "closed": true, "closedAt": "2021-01-02T19:59:58Z", "author": {"login": "ronisaacson"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdktkX7AH2gAyNTM1Njk1NjkwOjkyMDM0Y2Q3YzhkYjhiYTIzMzMzNDA4YjFmN2Y5MzdkOTkxNDVjNGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdsSuzdgH2gAyNTM1Njk1NjkwOmIzMmYzYzNkNzc2MzE5OTI1Y2QzYzRjNmEyNTQ4Y2VjNWNlYWY3ZjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "92034cd7c8db8ba23333408b1f7f937d99145c4f", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/92034cd7c8db8ba23333408b1f7f937d99145c4f", "committedDate": "2020-12-10T06:43:58Z", "message": "Improve debugging in message classes\n\nEach PowermaxBaseMessage subclass had its own toString() which added\nuseful debug info but duplicated a lot of the logic in the message\nhandler. I've moved the debug info inline and removed the duplication,\nand also added decoding for more values to the debug output.\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf52751b24391ac28674cdf5fe7fddfd000717fa", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/cf52751b24391ac28674cdf5fe7fddfd000717fa", "committedDate": "2020-12-10T06:23:28Z", "message": "Improve debugging in message classes\n\nEach PowermaxBaseMessage subclass had its own toString() which added\nuseful debug info but duplicated a lot of the logic in the message\nhandler. I've moved the debug info inline and removed the duplication,\nand also added decoding for more values to the debug output."}, "afterCommit": {"oid": "92034cd7c8db8ba23333408b1f7f937d99145c4f", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/92034cd7c8db8ba23333408b1f7f937d99145c4f", "committedDate": "2020-12-10T06:43:58Z", "message": "Improve debugging in message classes\n\nEach PowermaxBaseMessage subclass had its own toString() which added\nuseful debug info but duplicated a lot of the logic in the message\nhandler. I've moved the debug info inline and removed the duplication,\nand also added decoding for more values to the debug output.\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ec56103fbd1388efeee6574abc934031b46719e5", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/ec56103fbd1388efeee6574abc934031b46719e5", "committedDate": "2020-12-11T01:18:34Z", "message": "Fix for 0xFF byte values, which convert to int -1"}, "afterCommit": {"oid": "e4251fa0f31f830bb11f1efb6696a53cbbc6eb71", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/e4251fa0f31f830bb11f1efb6696a53cbbc6eb71", "committedDate": "2020-12-11T01:21:04Z", "message": "Fix for 0xFF byte values, which convert to int -1\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac1cdf5f397f8007949b414e7c7d5004437bbb83", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/ac1cdf5f397f8007949b414e7c7d5004437bbb83", "committedDate": "2020-12-13T05:12:30Z", "message": "Fix for 0xFF byte values, which convert to int -1\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e4251fa0f31f830bb11f1efb6696a53cbbc6eb71", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/e4251fa0f31f830bb11f1efb6696a53cbbc6eb71", "committedDate": "2020-12-11T01:21:04Z", "message": "Fix for 0xFF byte values, which convert to int -1\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}, "afterCommit": {"oid": "ac1cdf5f397f8007949b414e7c7d5004437bbb83", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/ac1cdf5f397f8007949b414e7c7d5004437bbb83", "committedDate": "2020-12-13T05:12:30Z", "message": "Fix for 0xFF byte values, which convert to int -1\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/e067938068159395970c547c0d714e9a23a6dc48", "committedDate": "2020-12-21T03:45:32Z", "message": "Merge remote-tracking branch 'upstream/main' into powermax_improve_debugging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzY2OTM2", "url": "https://github.com/openhab/openhab-addons/pull/9314#pullrequestreview-557766936", "createdAt": "2020-12-23T10:03:31Z", "commit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMDowMzozMlrOIKfx8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMToxNjo0N1rOIKhrAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3NzM2Mg==", "bodyText": "You don't need to mention String.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547877362", "createdAt": "2020-12-23T10:03:32Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -30,13 +33,15 @@\n     private int code;\n     private PowermaxSendType sendType;\n     private PowermaxReceiveType receiveType;\n+    private List<String> debugInfo;\n \n     /**\n      * Constructor.\n      *\n      * @param message the message as a buffer of bytes\n      */\n     public PowermaxBaseMessage(byte[] message) {\n+        this.debugInfo = new ArrayList<String>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3NzQxNA==", "bodyText": "You don't need to mention String.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547877414", "createdAt": "2020-12-23T10:03:39Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -57,6 +62,7 @@ public PowermaxBaseMessage(PowermaxSendType sendType) {\n      * @param param the dynamic part of a message to be sent; null if no dynamic part\n      */\n     public PowermaxBaseMessage(PowermaxSendType sendType, byte[] param) {\n+        this.debugInfo = new ArrayList<String>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3ODgyOA==", "bodyText": "Suggestion: reduce the number of parenthesis like if (decoded != null && !decoded.isBlank()) {", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547878828", "createdAt": "2020-12-23T10:06:45Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -147,17 +164,55 @@ public boolean isAckRequired() {\n         return receiveType == null || receiveType.isAckRequired();\n     }\n \n+    // Debugging helpers\n+\n+    public void addDebugInfo(String name, String info, String decoded) {\n+        StringBuilder debugLine = new StringBuilder();\n+\n+        debugLine.append(name);\n+        debugLine.append(\" = \");\n+        debugLine.append(info);\n+\n+        if ((decoded != null) && !(decoded.isBlank())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3OTY2Mw==", "bodyText": "Even if null annotation is not implemented for this  binding, could you please add @Nullable to the decoded parameter.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547879663", "createdAt": "2020-12-23T10:08:23Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -147,17 +164,55 @@ public boolean isAckRequired() {\n         return receiveType == null || receiveType.isAckRequired();\n     }\n \n+    // Debugging helpers\n+\n+    public void addDebugInfo(String name, String info, String decoded) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4MjcwMg==", "bodyText": "Please add @Nullable to the decoded parameter.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547882702", "createdAt": "2020-12-23T10:15:30Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -147,17 +164,55 @@ public boolean isAckRequired() {\n         return receiveType == null || receiveType.isAckRequired();\n     }\n \n+    // Debugging helpers\n+\n+    public void addDebugInfo(String name, String info, String decoded) {\n+        StringBuilder debugLine = new StringBuilder();\n+\n+        debugLine.append(name);\n+        debugLine.append(\" = \");\n+        debugLine.append(info);\n+\n+        if ((decoded != null) && !(decoded.isBlank())) {\n+            debugLine.append(\" - \" + decoded);\n+        }\n+\n+        debugInfo.add(debugLine.toString());\n+    }\n+\n+    public void addDebugInfo(String name, String info) {\n+        addDebugInfo(name, info, null);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data, String decoded) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4NTk4NQ==", "bodyText": "Please add @Nullable to the decoded parameter.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547885985", "createdAt": "2020-12-23T10:22:59Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -147,17 +164,55 @@ public boolean isAckRequired() {\n         return receiveType == null || receiveType.isAckRequired();\n     }\n \n+    // Debugging helpers\n+\n+    public void addDebugInfo(String name, String info, String decoded) {\n+        StringBuilder debugLine = new StringBuilder();\n+\n+        debugLine.append(name);\n+        debugLine.append(\" = \");\n+        debugLine.append(info);\n+\n+        if ((decoded != null) && !(decoded.isBlank())) {\n+            debugLine.append(\" - \" + decoded);\n+        }\n+\n+        debugInfo.add(debugLine.toString());\n+    }\n+\n+    public void addDebugInfo(String name, String info) {\n+        addDebugInfo(name, info, null);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data, String decoded) {\n+        String hex = \"0x\" + HexUtils.bytesToHex(data);\n+        addDebugInfo(name, hex, decoded);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data) {\n+        addDebugInfo(name, data, null);\n+    }\n+\n+    public void addDebugInfo(String name, int data, String decoded) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4NjczNA==", "bodyText": "Looks a little weird...", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547886734", "createdAt": "2020-12-23T10:24:30Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -147,17 +164,55 @@ public boolean isAckRequired() {\n         return receiveType == null || receiveType.isAckRequired();\n     }\n \n+    // Debugging helpers\n+\n+    public void addDebugInfo(String name, String info, String decoded) {\n+        StringBuilder debugLine = new StringBuilder();\n+\n+        debugLine.append(name);\n+        debugLine.append(\" = \");\n+        debugLine.append(info);\n+\n+        if ((decoded != null) && !(decoded.isBlank())) {\n+            debugLine.append(\" - \" + decoded);\n+        }\n+\n+        debugInfo.add(debugLine.toString());\n+    }\n+\n+    public void addDebugInfo(String name, String info) {\n+        addDebugInfo(name, info, null);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data, String decoded) {\n+        String hex = \"0x\" + HexUtils.bytesToHex(data);\n+        addDebugInfo(name, hex, decoded);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data) {\n+        addDebugInfo(name, data, null);\n+    }\n+\n+    public void addDebugInfo(String name, int data, String decoded) {\n+        String len = data <= 0xFF ? \"02\" : data <= 0xFFFF ? \"04\" : \"08\";\n+        String hex = String.format(\"0x%\" + len + \"X\", data);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg5NTQ1OA==", "bodyText": "Please add addDebugInfo with data parameter of type byte. It will be used at several places.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547895458", "createdAt": "2020-12-23T10:45:46Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxBaseMessage.java", "diffHunk": "@@ -147,17 +164,55 @@ public boolean isAckRequired() {\n         return receiveType == null || receiveType.isAckRequired();\n     }\n \n+    // Debugging helpers\n+\n+    public void addDebugInfo(String name, String info, String decoded) {\n+        StringBuilder debugLine = new StringBuilder();\n+\n+        debugLine.append(name);\n+        debugLine.append(\" = \");\n+        debugLine.append(info);\n+\n+        if ((decoded != null) && !(decoded.isBlank())) {\n+            debugLine.append(\" - \" + decoded);\n+        }\n+\n+        debugInfo.add(debugLine.toString());\n+    }\n+\n+    public void addDebugInfo(String name, String info) {\n+        addDebugInfo(name, info, null);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data, String decoded) {\n+        String hex = \"0x\" + HexUtils.bytesToHex(data);\n+        addDebugInfo(name, hex, decoded);\n+    }\n+\n+    public void addDebugInfo(String name, byte[] data) {\n+        addDebugInfo(name, data, null);\n+    }\n+\n+    public void addDebugInfo(String name, int data, String decoded) {\n+        String len = data <= 0xFF ? \"02\" : data <= 0xFFFF ? \"04\" : \"08\";\n+        String hex = String.format(\"0x%\" + len + \"X\", data);\n+        addDebugInfo(name, hex, decoded);\n+    }\n+\n+    public void addDebugInfo(String name, int data) {\n+        addDebugInfo(name, data, null);\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg5NTc0Mg==", "bodyText": "You could use your new variable panelTypeNr", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547895742", "createdAt": "2020-12-23T10:46:22Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxInfoMessage.java", "diffHunk": "@@ -37,25 +37,28 @@ public PowermaxInfoMessage(byte[] message) {\n     }\n \n     @Override\n-    public PowermaxState handleMessage(PowermaxCommManager commManager) {\n-        super.handleMessage(commManager);\n-\n+    protected PowermaxState handleMessageInternal(PowermaxCommManager commManager) {\n         if (commManager == null) {\n             return null;\n         }\n \n         PowermaxState updatedState = commManager.createNewState();\n \n         byte[] message = getRawData();\n+        byte panelTypeNr = message[7];\n+        String panelTypeStr;\n \n         PowermaxPanelType panelType = null;\n         try {\n             panelType = PowermaxPanelType.fromCode(message[7]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg5NTkxOA==", "bodyText": "Why suppressing this log ?", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547895918", "createdAt": "2020-12-23T10:46:46Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxInfoMessage.java", "diffHunk": "@@ -37,25 +37,28 @@ public PowermaxInfoMessage(byte[] message) {\n     }\n \n     @Override\n-    public PowermaxState handleMessage(PowermaxCommManager commManager) {\n-        super.handleMessage(commManager);\n-\n+    protected PowermaxState handleMessageInternal(PowermaxCommManager commManager) {\n         if (commManager == null) {\n             return null;\n         }\n \n         PowermaxState updatedState = commManager.createNewState();\n \n         byte[] message = getRawData();\n+        byte panelTypeNr = message[7];\n+        String panelTypeStr;\n \n         PowermaxPanelType panelType = null;\n         try {\n             panelType = PowermaxPanelType.fromCode(message[7]);\n+            panelTypeStr = panelType.toString();\n         } catch (IllegalArgumentException e) {\n-            logger.debug(\"Powermax alarm binding: unknwon panel type for code {}\", message[7] & 0x000000FF);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg5NjI0NQ==", "bodyText": "Put your name as author of this class.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547896245", "createdAt": "2020-12-23T10:47:24Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxMessageConstants.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.powermax.internal.message;\n+\n+/**\n+ * Constants used in Powermax messages\n+ *\n+ * @author Laurent Garnier - Initial contribution", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzkwMjEyMA==", "bodyText": "This should be moved in the next if", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547902120", "createdAt": "2020-12-23T11:01:42Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxPowerlinkMessage.java", "diffHunk": "@@ -50,37 +48,29 @@ public PowermaxState handleMessage(PowermaxCommManager commManager) {\n \n         if (subType == 0x03) {\n             // keep alive message\n+\n+            addDebugInfo(\"Subtype\", subType, \"Keep Alive\");\n+\n             commManager.sendAck(this, (byte) 0x02);\n             updatedState = commManager.createNewState();\n             updatedState.setLastKeepAlive(System.currentTimeMillis());\n-        } else if (subType == 0x0A && message[4] == 0x01) {\n-            logger.debug(\"Powermax alarm binding: Enrolling Powerlink\");\n-            commManager.enrollPowerlink();\n-            updatedState = commManager.createNewState();\n-            updatedState.setDownloadSetupRequired(true);\n-        } else {\n-            commManager.sendAck(this, (byte) 0x02);\n-        }\n-\n-        return updatedState;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        String str = super.toString();\n+        } else if (subType == 0x0A) {\n+            byte enroll = message[4];\n \n-        byte[] message = getRawData();\n-        byte subType = message[2];\n+            addDebugInfo(\"Subtype\", subType, \"Enroll\");\n+            addDebugInfo(\"Enroll\", enroll);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzkwNDA5MA==", "bodyText": "Missing else sending ACK.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547904090", "createdAt": "2020-12-23T11:06:09Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxPowerlinkMessage.java", "diffHunk": "@@ -50,37 +48,29 @@ public PowermaxState handleMessage(PowermaxCommManager commManager) {\n \n         if (subType == 0x03) {\n             // keep alive message\n+\n+            addDebugInfo(\"Subtype\", subType, \"Keep Alive\");\n+\n             commManager.sendAck(this, (byte) 0x02);\n             updatedState = commManager.createNewState();\n             updatedState.setLastKeepAlive(System.currentTimeMillis());\n-        } else if (subType == 0x0A && message[4] == 0x01) {\n-            logger.debug(\"Powermax alarm binding: Enrolling Powerlink\");\n-            commManager.enrollPowerlink();\n-            updatedState = commManager.createNewState();\n-            updatedState.setDownloadSetupRequired(true);\n-        } else {\n-            commManager.sendAck(this, (byte) 0x02);\n-        }\n-\n-        return updatedState;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        String str = super.toString();\n+        } else if (subType == 0x0A) {\n+            byte enroll = message[4];\n \n-        byte[] message = getRawData();\n-        byte subType = message[2];\n+            addDebugInfo(\"Subtype\", subType, \"Enroll\");\n+            addDebugInfo(\"Enroll\", enroll);\n \n-        if (subType == 0x03) {\n-            str += \"\\n - sub type = keep alive\";\n-        } else if (subType == 0x0A) {\n-            str += \"\\n - sub type = enroll\";\n-            str += \"\\n - enroll = \" + String.format(\"%02X\", message[4]);\n+            if (enroll == 0x01) {\n+                logger.debug(\"Powermax alarm binding: Enrolling Powerlink\");\n+                commManager.enrollPowerlink();\n+                updatedState = commManager.createNewState();\n+                updatedState.setDownloadSetupRequired(true);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzkwODM1Mw==", "bodyText": "I don't know if the result is the same as before.\nI hope you have seriously tested this code.", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r547908353", "createdAt": "2020-12-23T11:16:47Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxStatusMessage.java", "diffHunk": "@@ -24,10 +28,34 @@\n  */\n public class PowermaxStatusMessage extends PowermaxBaseMessage {\n \n-    private static final String[] EVENT_TYPE_TABLE = new String[] { \"None\", \"Tamper Alarm\", \"Tamper Restore\", \"Open\",\n-            \"Closed\", \"Violated (Motion)\", \"Panic Alarm\", \"RF Jamming\", \"Tamper Open\", \"Communication Failure\",\n-            \"Line Failure\", \"Fuse\", \"Not Active\", \"Low Battery\", \"AC Failure\", \"Fire Alarm\", \"Emergency\",\n-            \"Siren Tamper\", \"Siren Tamper Restore\", \"Siren Low Battery\", \"Siren AC Fail\" };\n+    private static byte[] zoneBytes(byte zones1, byte zones9, byte zones17, byte zones25) {\n+        return new byte[] { zones25, zones17, zones9, zones1 };\n+    }\n+\n+    private static boolean[] zoneBits(byte[] zoneBytes) {\n+        boolean[] zones = new boolean[32];\n+        char[] binary = new BigInteger(zoneBytes).toString(2).toCharArray();\n+        int len = binary.length - 1;\n+\n+        for (int i = len; i >= 0; i--) {\n+            zones[len - i + 1] = (binary[i] == '1');\n+        }\n+\n+        return zones;\n+    }\n+\n+    private static String zoneList(byte[] zoneBytes) {\n+        boolean[] zones = zoneBits(zoneBytes);\n+        List<String> names = new ArrayList<>();\n+\n+        for (int i = 1; i < zones.length; i++) {\n+            if (zones[i]) {\n+                names.add(String.format(\"Zone %d\", i));\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e067938068159395970c547c0d714e9a23a6dc48"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48d1a22a4715f869f18ada59ab2a54d8469205d2", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/48d1a22a4715f869f18ada59ab2a54d8469205d2", "committedDate": "2020-12-24T17:23:04Z", "message": "Incorporate review feedback from lolodomo\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9ebac90987cd110f57c832f78f2d743a8d60fa7", "author": {"user": {"login": "ronisaacson", "name": "Ron Isaacson"}}, "url": "https://github.com/openhab/openhab-addons/commit/a9ebac90987cd110f57c832f78f2d743a8d60fa7", "committedDate": "2020-12-26T19:32:04Z", "message": "Change to inline debug messages\n\nSigned-off-by: Ron Isaacson <isaacson.ron@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTI4NjY5", "url": "https://github.com/openhab/openhab-addons/pull/9314#pullrequestreview-558928669", "createdAt": "2020-12-27T13:17:57Z", "commit": {"oid": "a9ebac90987cd110f57c832f78f2d743a8d60fa7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjUyOTQ0", "url": "https://github.com/openhab/openhab-addons/pull/9314#pullrequestreview-560652944", "createdAt": "2021-01-02T19:58:52Z", "commit": {"oid": "a9ebac90987cd110f57c832f78f2d743a8d60fa7"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQxOTo1ODo1MlrOINZOCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQxOTo1ODo1MlrOINZOCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDkxNTU5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright (c) 2010-2020 Contributors to the openHAB project\n          \n          \n            \n             * Copyright (c) 2010-2021 Contributors to the openHAB project", "url": "https://github.com/openhab/openhab-addons/pull/9314#discussion_r550915593", "createdAt": "2021-01-02T19:58:52Z", "author": {"login": "Hilbrand"}, "path": "bundles/org.openhab.binding.powermax/src/main/java/org/openhab/binding/powermax/internal/message/PowermaxMessageConstants.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9ebac90987cd110f57c832f78f2d743a8d60fa7"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b32f3c3d776319925cd3c4c6a2548cec5ceaf7f6", "author": {"user": {"login": "Hilbrand", "name": "Hilbrand Bouwkamp"}}, "url": "https://github.com/openhab/openhab-addons/commit/b32f3c3d776319925cd3c4c6a2548cec5ceaf7f6", "committedDate": "2021-01-02T19:59:19Z", "message": "Update copyright year"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3711, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}