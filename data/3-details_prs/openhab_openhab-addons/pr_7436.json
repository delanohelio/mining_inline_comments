{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2NjI5MDI3", "number": 7436, "title": "[samsungtv] Few improvements", "bodyText": "WOL utility enhanced to work on different OS (enhancement coming form the LG webOS binding)\nExistent polling jobs in services classes replaced by one unique polling job in the thing handler. Execute UPnP actions to refresh channels only if the channel is linked.\nSigned-off-by: Laurent Garnier lg.hc@free.fr", "createdAt": "2020-04-21T12:01:01Z", "url": "https://github.com/openhab/openhab-addons/pull/7436", "merged": true, "mergeCommit": {"oid": "65eff40dba68a346845f4c69db495bed2086b05f"}, "closed": true, "closedAt": "2020-04-28T08:25:47Z", "author": {"login": "lolodomo"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ0h23AFqTM5NzM4NDk5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcb_j_VAFqTQwMTYwMzU1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3Mzg0OTkz", "url": "https://github.com/openhab/openhab-addons/pull/7436#pullrequestreview-397384993", "createdAt": "2020-04-21T14:26:13Z", "commit": {"oid": "8a8577e8e9410fb53e51be1864bb323247e006b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDoyNjoxM1rOGJIrvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDoyNjoxM1rOGJIrvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIzMjYzOQ==", "bodyText": "thingDiscovered method will be called when ever new UPnP device is discovered, so delay shouldn't be needed", "url": "https://github.com/openhab/openhab-addons/pull/7436#discussion_r412232639", "createdAt": "2020-04-21T14:26:13Z", "author": {"login": "paulianttila"}, "path": "bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/handler/SamsungTvHandler.java", "diffHunk": "@@ -330,6 +331,12 @@ public void thingDiscovered(DiscoveryService source, DiscoveryResult result) {\n              */\n             upnpThingUID = result.getThingUID();\n             logger.debug(\"thingDiscovered, thingUID={}, discoveredUID={}\", this.getThing().getUID(), upnpThingUID);\n+            // We wait a little to increase the chance to have all UPnP devices being discovered before\n+            // calling checkAndCreateServices\n+            try {\n+                Thread.sleep(2000);\n+            } catch (InterruptedException e) {\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a8577e8e9410fb53e51be1864bb323247e006b8"}, "originalPosition": 85}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b2dbc29dafaaa529c26780855e67a7e141bf993", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/3b2dbc29dafaaa529c26780855e67a7e141bf993", "committedDate": "2020-04-21T17:00:20Z", "message": "Restore the log"}, "afterCommit": {"oid": "b804254bc43d637db237a834d8791d2be1130258", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/b804254bc43d637db237a834d8791d2be1130258", "committedDate": "2020-04-22T09:31:23Z", "message": "[samsungtv] Few improvements\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bea5fac84df1d85c736ad0394f6f8651918c801c", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/bea5fac84df1d85c736ad0394f6f8651918c801c", "committedDate": "2020-04-24T10:22:04Z", "message": "Handle commands in UPnP services only if the service is started\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>"}, "afterCommit": {"oid": "0ee9701130548d72d351179560fcf96644f5f166", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/0ee9701130548d72d351179560fcf96644f5f166", "committedDate": "2020-04-27T21:00:54Z", "message": "[samsungtv] Few improvements\n\nWOL utility enhanced to work on different OS (enhancement coming from the LG webOS binding)\n\nExistent polling jobs in services classes replaced by one unique polling job in the thing handler.\nExecute UPnP actions to refresh the channels only if the channel is linked\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d682b7aa7a4425951f9aa65b7cfbfc2e89318f93", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/d682b7aa7a4425951f9aa65b7cfbfc2e89318f93", "committedDate": "2020-04-27T21:11:52Z", "message": "[samsungtv] Few improvements\n\nWOL utility enhanced to work on different OS (enhancement coming from the LG webOS binding)\n\nExistent polling jobs in services classes replaced by one unique polling job in the thing handler.\nExecute UPnP actions to refresh the channels only if the channel is linked\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0ee9701130548d72d351179560fcf96644f5f166", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/0ee9701130548d72d351179560fcf96644f5f166", "committedDate": "2020-04-27T21:00:54Z", "message": "[samsungtv] Few improvements\n\nWOL utility enhanced to work on different OS (enhancement coming from the LG webOS binding)\n\nExistent polling jobs in services classes replaced by one unique polling job in the thing handler.\nExecute UPnP actions to refresh the channels only if the channel is linked\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>"}, "afterCommit": {"oid": "d682b7aa7a4425951f9aa65b7cfbfc2e89318f93", "author": {"user": {"login": "lolodomo", "name": "lolodomo"}}, "url": "https://github.com/openhab/openhab-addons/commit/d682b7aa7a4425951f9aa65b7cfbfc2e89318f93", "committedDate": "2020-04-27T21:11:52Z", "message": "[samsungtv] Few improvements\n\nWOL utility enhanced to work on different OS (enhancement coming from the LG webOS binding)\n\nExistent polling jobs in services classes replaced by one unique polling job in the thing handler.\nExecute UPnP actions to refresh the channels only if the channel is linked\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNjAzNTU0", "url": "https://github.com/openhab/openhab-addons/pull/7436#pullrequestreview-401603554", "createdAt": "2020-04-28T08:19:30Z", "commit": {"oid": "d682b7aa7a4425951f9aa65b7cfbfc2e89318f93"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwODoxOTozMFrOGNIZwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwODoxOTozMFrOGNIZwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjQyMjMzNw==", "bodyText": "isLinked is very expensive. But since this is still an improvement over the old behaviour, I'm ok with it. The better way IMO would be to keep track of the linked channels locally.", "url": "https://github.com/openhab/openhab-addons/pull/7436#discussion_r416422337", "createdAt": "2020-04-28T08:19:30Z", "author": {"login": "J-N-K"}, "path": "bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/handler/SamsungTvHandler.java", "diffHunk": "@@ -187,6 +206,21 @@ private synchronized void putOffline() {\n         updateState(SOURCE_APP, new StringType(\"\"));\n     }\n \n+    private void poll() {\n+        for (SamsungTvService service : services) {\n+            for (String channel : service.getSupportedChannelNames()) {\n+                if (isLinked(channel)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d682b7aa7a4425951f9aa65b7cfbfc2e89318f93"}, "originalPosition": 90}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 860, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}