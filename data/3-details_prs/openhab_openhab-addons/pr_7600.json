{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MDYxMzgx", "number": 7600, "title": "[homekit] simplify HomeKit console commands", "bodyText": "simplify HomeKit console commands:\n\n\"list\" instead of \"listAccessories\"\n\"show\" instead \"printAccessory\"\n\nthe commands are new and were introduce with recent HomeKit PRs so that we dont need legacy support.", "createdAt": "2020-05-11T12:04:05Z", "url": "https://github.com/openhab/openhab-addons/pull/7600", "merged": true, "mergeCommit": {"oid": "5943cd3919fe990b1a73063857e716cf49bc524b"}, "closed": true, "closedAt": "2020-05-21T14:16:08Z", "author": {"login": "yfre"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgOaxHAH2gAyNDE2MDYxMzgxOmI4ZjhlZmFiM2M5MmM1YWI5MDM5ZDZmNWMwODJhYThlYmE2NGU4ZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjaprMgH2gAyNDE2MDYxMzgxOjc1NmQ4Y2IyZDQ1ZTNkNTkwMDdkNWRhZGE2MTkwNjg4Zjk2MzJlNzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc", "committedDate": "2020-05-11T11:59:34Z", "message": "simplify HomeKit console commands\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MjAxNTAy", "url": "https://github.com/openhab/openhab-addons/pull/7600#pullrequestreview-415201502", "createdAt": "2020-05-20T10:31:32Z", "commit": {"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDozMTozM1rOGYFW_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDozNDo1M1rOGYFdqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNjgxMw==", "bodyText": "Rather accessories ?", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427906813", "createdAt": "2020-05-20T10:31:33Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.io.homekit/README.md", "diffHunk": "@@ -402,7 +402,7 @@ openhab> log:tail io.github.hapjava\n \n ## Console commands\n \n-`smarthome:homekit listAccessories` - list all HomeKit accessory currently advertised to the HomeKit clients. the commands list the ID and name of accessories. \n+`smarthome:homekit list` - list all HomeKit accessory currently advertised to the HomeKit clients.  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNzAzMg==", "bodyText": "match", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427907032", "createdAt": "2020-05-20T10:32:00Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.io.homekit/README.md", "diffHunk": "@@ -402,7 +402,7 @@ openhab> log:tail io.github.hapjava\n \n ## Console commands\n \n-`smarthome:homekit listAccessories` - list all HomeKit accessory currently advertised to the HomeKit clients. the commands list the ID and name of accessories. \n+`smarthome:homekit list` - list all HomeKit accessory currently advertised to the HomeKit clients.  \n \n-`smarthome:homekit printAccessory <accessory_id>` - print additional details like list of characteristics for give accessory.\n+`smarthome:homekit show <accessory_id | name>` - print additional details of the accessories which matche provided IDs or name.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNzIwMA==", "bodyText": "is required", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427907200", "createdAt": "2020-05-20T10:32:20Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java", "diffHunk": "@@ -68,25 +68,27 @@ public void execute(String[] args, Console console) {\n                     break;\n                 case SUBCMD_PRINT_ACCESSORY:\n                     if (args.length > 1) {\n-                        Integer id = Integer.valueOf(args[1]);\n-                        printAccessory(id, console);\n+                        printAccessory(args[1], console);\n                     } else {\n-                        console.println(\"accessory id is required as an argument\");\n+                        console.println(\"accessory id or name are required as an argument\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwODUyMA==", "bodyText": "This is no more a full matching but now a partial matching. Maybe this has to be mentioned in the usage ?", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427908520", "createdAt": "2020-05-20T10:34:53Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java", "diffHunk": "@@ -134,10 +136,11 @@ private void listAccessories(Console console) {\n         });\n     }\n \n-    private void printAccessory(Integer accessory_id, Console console) {\n+    private void printAccessory(String id, Console console) {\n         homekit.getAccessories().forEach(v -> {\n             try {\n-                if (v.getId() == accessory_id) {\n+                if ((\"\" + v.getId()).contains(id) || ((v.getName().get() != null)\n+                        && (v.getName().get().toUpperCase().contains(id.toUpperCase())))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1237b463ec418d0918902dfb402e8dec6f846381", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/1237b463ec418d0918902dfb402e8dec6f846381", "committedDate": "2020-05-20T11:00:00Z", "message": "incorporate feedback from lolodomo\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MjMyODAx", "url": "https://github.com/openhab/openhab-addons/pull/7600#pullrequestreview-415232801", "createdAt": "2020-05-20T11:18:56Z", "commit": {"oid": "1237b463ec418d0918902dfb402e8dec6f846381"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMToxODo1NlrOGYG2fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMToxODo1NlrOGYG2fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkzMTI2Mg==", "bodyText": "Please mention the partial matching here too.", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427931262", "createdAt": "2020-05-20T11:18:56Z", "author": {"login": "lolodomo"}, "path": "bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java", "diffHunk": "@@ -68,25 +68,27 @@ public void execute(String[] args, Console console) {\n                     break;\n                 case SUBCMD_PRINT_ACCESSORY:\n                     if (args.length > 1) {\n-                        Integer id = Integer.valueOf(args[1]);\n-                        printAccessory(id, console);\n+                        printAccessory(args[1], console);\n                     } else {\n-                        console.println(\"accessory id is required as an argument\");\n+                        console.println(\"accessory id or name is required as an argument\");\n                     }\n                     break;\n                 default:\n                     console.println(\"Unknown command '\" + subCommand + \"'\");\n                     printUsage(console);\n                     break;\n             }\n+        } else {\n+            printUsage(console);\n         }\n     }\n \n     @Override\n     public List<String> getUsages() {\n         return Arrays.asList(buildCommandUsage(SUBCMD_LIST_ACCESSORIES, \"list all HomeKit accessories\"),\n-                buildCommandUsage(SUBCMD_PRINT_ACCESSORY + \" <accessory id>\", \"print accessorty details\"),\n-                buildCommandUsage(SUBCMD_CLEAR_PAIRINGS, \"removes all pairings with HomeKit clients\"),\n+                buildCommandUsage(SUBCMD_PRINT_ACCESSORY + \" <accessory id | accessory name>\",\n+                        \"search for accessories and show details. \"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1237b463ec418d0918902dfb402e8dec6f846381"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34ad8b479d1c002f9aa6f0fc16de279e169b8813", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/34ad8b479d1c002f9aa6f0fc16de279e169b8813", "committedDate": "2020-05-20T11:25:17Z", "message": "incorporate feedback from lolodomo\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MjY3NTU4", "url": "https://github.com/openhab/openhab-addons/pull/7600#pullrequestreview-415267558", "createdAt": "2020-05-20T12:11:58Z", "commit": {"oid": "34ad8b479d1c002f9aa6f0fc16de279e169b8813"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f28c3ae96d56ab162d9ce900a1850efbc2abfbc1", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/f28c3ae96d56ab162d9ce900a1850efbc2abfbc1", "committedDate": "2020-05-20T22:32:38Z", "message": "add support for old commands\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edbb19a9ae407da690f7894429349620812ea6b6", "author": {"user": null}, "url": "https://github.com/openhab/openhab-addons/commit/edbb19a9ae407da690f7894429349620812ea6b6", "committedDate": "2020-05-21T09:47:55Z", "message": "remove old commands from readme\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MDIwNjM0", "url": "https://github.com/openhab/openhab-addons/pull/7600#pullrequestreview-416020634", "createdAt": "2020-05-21T09:55:21Z", "commit": {"oid": "edbb19a9ae407da690f7894429349620812ea6b6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "756d8cb2d45e3d59007d5dada6190688f9632e74", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/756d8cb2d45e3d59007d5dada6190688f9632e74", "committedDate": "2020-05-21T09:56:29Z", "message": "Merge branch '2.5.x' into homekit_commands"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 767, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}