{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NDUzNDU3", "number": 7234, "title": "[rrd4j] use a more fine granular default configuration for persistence", "bodyText": "Signed-off-by: Kai Kreuzer kai@openhab.org", "createdAt": "2020-03-26T22:23:07Z", "url": "https://github.com/openhab/openhab-addons/pull/7234", "merged": true, "mergeCommit": {"oid": "20ac8df2c5faa5d6716be06d0ccc492c9a7f8824"}, "closed": true, "closedAt": "2020-04-04T06:14:54Z", "author": {"login": "kaikreuzer"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRjxwQgH2gAyMzk0NDUzNDU3OjVjMmI5MDQzZmJlZDU3ZDUyYWRhODYyYTM2MzhmMWM2YTFlN2RhOWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUPTchgFqTM4NzY3MjE1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5c2b9043fbed57d52ada862a3638f1c6a1e7da9a", "author": {"user": {"login": "kaikreuzer", "name": "Kai Kreuzer"}}, "url": "https://github.com/openhab/openhab-addons/commit/5c2b9043fbed57d52ada862a3638f1c6a1e7da9a", "committedDate": "2020-03-26T22:23:49Z", "message": "use a more fine granular default configuration for persistence\n\nSigned-off-by: Kai Kreuzer <kai@openhab.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "238ba2a329fcd854d8227b7acd73c9d6c5c1a678", "author": {"user": {"login": "kaikreuzer", "name": "Kai Kreuzer"}}, "url": "https://github.com/openhab/openhab-addons/commit/238ba2a329fcd854d8227b7acd73c9d6c5c1a678", "committedDate": "2020-03-26T22:22:28Z", "message": "use a more fine granular default configuration for persistence\n\nSigned-off-by: Kai Kreuzer <kai@openhab.org>"}, "afterCommit": {"oid": "5c2b9043fbed57d52ada862a3638f1c6a1e7da9a", "author": {"user": {"login": "kaikreuzer", "name": "Kai Kreuzer"}}, "url": "https://github.com/openhab/openhab-addons/commit/5c2b9043fbed57d52ada862a3638f1c6a1e7da9a", "committedDate": "2020-03-26T22:23:49Z", "message": "use a more fine granular default configuration for persistence\n\nSigned-off-by: Kai Kreuzer <kai@openhab.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyODI1ODQx", "url": "https://github.com/openhab/openhab-addons/pull/7234#pullrequestreview-382825841", "createdAt": "2020-03-27T12:48:43Z", "commit": {"oid": "5c2b9043fbed57d52ada862a3638f1c6a1e7da9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo0ODo0M1rOF8vphg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo0ODo0M1rOF8vphg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTIzOTU1OA==", "bodyText": "I would like to suggest FIRST or LAST for numerical values too.\nThe reason is, I'm contemplating aggregates series in the UI by hour/day, to make it possible to build calendar or weekly displays like these:\n\nhttps://echarts.apache.org/examples/en/editor.html?c=calendar-heatmap\nhttps://echarts.apache.org/examples/en/editor.html?c=heatmap-cartesian\nhttps://echarts.apache.org/examples/en/editor.html?c=scatter-single-axis\nhttps://echarts.apache.org/examples/en/editor.html?c=scatter-punchCard\nhttps://echarts.apache.org/examples/en/editor.html?c=scatter-polar-punchCard\n\nOne of these aggregations would be the difference to the previous period: it would itself collect points found in that hour or day slice, take the first or last one and subtract the result of the previous period to it. That way if you have for instance an energy consumption metric you could get the hourly/daily consumption more accurately than by processing averaged data.\nDoes that make sense?", "url": "https://github.com/openhab/openhab-addons/pull/7234#discussion_r399239558", "createdAt": "2020-03-27T12:48:43Z", "author": {"login": "ghys"}, "path": "bundles/org.openhab.persistence.rrd4j/src/main/java/org/openhab/persistence/rrd4j/internal/RRD4jPersistenceService.java", "diffHunk": "@@ -355,15 +355,26 @@ private static String getUserPersistenceDataFolder() {\n     public void activate(final Map<String, Object> config) {\n         // add default configurations\n         RrdDefConfig defaultNumeric = new RrdDefConfig(\"default_numeric\");\n-        defaultNumeric.setDef(\"GAUGE,60,U,U,60\");\n-        defaultNumeric.addArchives(\n-                \"AVERAGE,0.5,1,480:AVERAGE,0.5,4,360:AVERAGE,0.5,14,644:AVERAGE,0.5,60,720:AVERAGE,0.5,720,730:AVERAGE,0.5,10080,520\");\n+        // use 10 seconds as a step size for numeric values and allow a 10 minute silence between updates\n+        defaultNumeric.setDef(\"GAUGE,600,U,U,10\");\n+        // define 5 different boxes:\n+        // 1. granularity of 10s for the last hour\n+        // 2. granularity of 1m for the last week\n+        // 3. granularity of 15m for the last year\n+        // 4. granularity of 1h for the last 5 years\n+        // 5. granularity of 1d for the last 10 years\n+        defaultNumeric.addArchives(\"AVERAGE,0.5,1,360:AVERAGE,0.5,6,10080:AVERAGE,0.5,90,36500:AVERAGE,0.5,8640,3650\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c2b9043fbed57d52ada862a3638f1c6a1e7da9a"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fce14395065b690ab8496d176ec61cbeb4bb2aab", "author": {"user": {"login": "kaikreuzer", "name": "Kai Kreuzer"}}, "url": "https://github.com/openhab/openhab-addons/commit/fce14395065b690ab8496d176ec61cbeb4bb2aab", "committedDate": "2020-03-27T20:25:23Z", "message": "changed from AVERAGE to LAST\n\nSigned-off-by: Kai Kreuzer <kai@openhab.org>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a526a4c0b7cbd242dd9e5385ced803f1bb931d9", "author": {"user": {"login": "kaikreuzer", "name": "Kai Kreuzer"}}, "url": "https://github.com/openhab/openhab-addons/commit/5a526a4c0b7cbd242dd9e5385ced803f1bb931d9", "committedDate": "2020-03-29T10:27:12Z", "message": "use AVERAGE for quantifiable number items and LAST for others\n\nSigned-off-by: Kai Kreuzer <kai@openhab.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1ODI3ODc0", "url": "https://github.com/openhab/openhab-addons/pull/7234#pullrequestreview-385827874", "createdAt": "2020-04-01T18:07:35Z", "commit": {"oid": "5a526a4c0b7cbd242dd9e5385ced803f1bb931d9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxODowNzozNVrOF_MinQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxODowNzozNVrOF_MinQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgxMDA3Nw==", "bodyText": "defaultQuantifiable?", "url": "https://github.com/openhab/openhab-addons/pull/7234#discussion_r401810077", "createdAt": "2020-04-01T18:07:35Z", "author": {"login": "J-N-K"}, "path": "bundles/org.openhab.persistence.rrd4j/src/main/java/org/openhab/persistence/rrd4j/internal/RRD4jPersistenceService.java", "diffHunk": "@@ -364,9 +374,21 @@ public void activate(final Map<String, Object> config) {\n         // 4. granularity of 1h for the last 5 years\n         // 5. granularity of 1d for the last 10 years\n         defaultNumeric.addArchives(\"LAST,0.5,1,360:LAST,0.5,6,10080:LAST,0.5,90,36500:LAST,0.5,8640,3650\");\n-        rrdDefs.put(\"default_numeric\", defaultNumeric);\n+        rrdDefs.put(DEFAULT_NUMERIC, defaultNumeric);\n+\n+        RrdDefConfig defaultQuantifiable = new RrdDefConfig(DEFAULT_QUANTIFIABLE);\n+        // use 10 seconds as a step size for numeric values and allow a 10 minute silence between updates\n+        defaultNumeric.setDef(\"GAUGE,600,U,U,10\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a526a4c0b7cbd242dd9e5385ced803f1bb931d9"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5765181352d3ec1df09900774fbc41ed87657ea4", "author": {"user": {"login": "kaikreuzer", "name": "Kai Kreuzer"}}, "url": "https://github.com/openhab/openhab-addons/commit/5765181352d3ec1df09900774fbc41ed87657ea4", "committedDate": "2020-04-01T19:01:20Z", "message": "fixed variable assignment\n\nSigned-off-by: Kai Kreuzer <kai@openhab.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NjcyMTU4", "url": "https://github.com/openhab/openhab-addons/pull/7234#pullrequestreview-387672158", "createdAt": "2020-04-04T06:14:23Z", "commit": {"oid": "5765181352d3ec1df09900774fbc41ed87657ea4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 958, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}