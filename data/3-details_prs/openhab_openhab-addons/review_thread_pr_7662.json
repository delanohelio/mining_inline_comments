{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MTQ2OTY3", "number": 7662, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMDozMzo0MlrOD9Ning==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMzo1ODozN1rOD9O6xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NTExNTgyOnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "isResolved": true, "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMDozMzo0MlrOGWkvMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxODowOToxNFrOGXCN5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg==", "bodyText": "Any reason this is no longer evaluated at the end of the constructor? You should make sure not the leak any references of this until after you have finished essential configuration.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426323762", "createdAt": "2020-05-18T00:33:42Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMzNTEwMg==", "bodyText": "Driver previously didn't have a constructor and was created when driver was declared above.  This change allowed the removal of @SuppressWarnings(\"null\") from Driver by passing them in as parameters to the constructor instead of using setters.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426335102", "createdAt": "2020-05-18T01:50:42Z", "author": {"login": "robnielsen"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM0MDA5OQ==", "bodyText": "What I meant is that this new code was put at the beginning of the InsteonBinding constructor whereas the old code was at the end of the InsteonBinding constructor.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426340099", "createdAt": "2020-05-18T02:21:02Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM0NjY2Ng==", "bodyText": "Yes that's because the old code had this above:\nprivate Driver driver = new Driver();\nWhy does it matter? Where is this leaked?", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426346666", "createdAt": "2020-05-18T02:56:24Z", "author": {"login": "robnielsen"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM0ODQ2OA==", "bodyText": "this is leaked through the PortListener.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426348468", "createdAt": "2020-05-18T03:06:34Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1MDI3OQ==", "bodyText": "I still don't understand the concern, and why it matters. If it's a big deal, maybe I'll just delete this PR and stop contributing.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426350279", "createdAt": "2020-05-18T03:16:52Z", "author": {"login": "robnielsen"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1NzY3OQ==", "bodyText": "The general concern over a leak of this is that other might start calling methods on your InsteonBinding class when it hasn't even finished constructing. What would happen if PortListener starts getting call on its methods before you have finished loading devices? The instant you leak this in a constructor you put yourself at risk of bugs NPE bugs that would normally not be possible if an object was constructed completely before exposing it to other objects.\nIn this case it might not cause a problem since things shouldn't start calling PortListener until you call driver.start() but leaking the this reference is a general problem to be aware of.\nThat said leaking the this is often the most convenient way to code something so at the very least try to make sure you leak this at the very end of your constructor when you know all the other class fields have been initialized, thus this would be \"safe\" to call from outside classes.\nhttp://www.javapractices.com/topic/TopicAction.do?Id=252", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426357679", "createdAt": "2020-05-18T03:57:21Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1ODc0Nw==", "bodyText": "You might notice from the link I posted that they suggest not leaking this at ALL. While I agree with it in principle, I also think that trying to enforce that would cause a bit a code bloat so that is why I recommend just leaking this at the end of the constructor.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426358747", "createdAt": "2020-05-18T04:02:44Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjU4MTgxMw==", "bodyText": "@kaikreuzer, this is ridiculous, lot of assumptions here. I thought I was doing a good thing by removing @SuppressWarnings(\"null\") from Driver and rearranging the code, but I guess not according to @cpmeister.\nThis sort of nitpicking is what causes people to stop contributing, and I'm about to that point.  I have some other features that I was thinking about implementing, but probably won't if this continues.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426581813", "createdAt": "2020-05-18T12:16:45Z", "author": {"login": "robnielsen"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwNjc1Ng==", "bodyText": "@robnielsen I am very sure that @cpmeister is not meaning to annoy you in any way. Like you and others, he wants to help and ensure that openHAB has a proper code base.\nNobody should be felt pissed off by anyone else, when everybody is doing their best - so please consider this and try to solve any discussions in a collaborative manner. You should be aware that many developers LOVE such discussions, because they learn from each other and become better developers in the long run - it is part of the fun. If it is no fun for you, just express it or simply give in to the arguments.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426806756", "createdAt": "2020-05-18T18:09:14Z", "author": {"login": "kaikreuzer"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -125,6 +125,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n             @Nullable SerialPortManager serialPortManager) {\n         this.handler = handler;\n \n+        String port = config.getPort();\n+        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n+\n+        driver = new Driver(port, portListener, serialPortManager);\n+        driver.addMsgListener(portListener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMzc2Mg=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NTM0MTUwOnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMzo1ODozN1rOGWm0sQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNjowOToxMVrOGW-FRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1NzkzNw==", "bodyText": "This is where I would suggest to move the code.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                }\n          \n          \n            \n                    String port = config.getPort();\n          \n          \n            \n                    logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n          \n          \n            \n            \n          \n          \n            \n                    driver = new Driver(port, portListener, serialPortManager);\n          \n          \n            \n                    driver.addMsgListener(portListener);\n          \n          \n            \n                }", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426357937", "createdAt": "2020-05-18T03:58:37Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -155,34 +161,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n \n         deadDeviceTimeout = devicePollIntervalMilliseconds * DEAD_DEVICE_COUNT;\n         logger.debug(\"dead device timeout set to {} seconds\", deadDeviceTimeout / 1000);\n-\n-        String port = config.getPort();\n-        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n-        driver.addPort(\"port\", port, serialPortManager);\n-        driver.addMsgListener(portListener, port);\n-\n-        logger.debug(\"setting driver listener\");\n-        driver.setDriverListener(portListener);\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjU4MTg2MA==", "bodyText": "If you look there is code above of this that depends on driver being initialized.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426581860", "createdAt": "2020-05-18T12:16:51Z", "author": {"login": "robnielsen"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -155,34 +161,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n \n         deadDeviceTimeout = devicePollIntervalMilliseconds * DEAD_DEVICE_COUNT;\n         logger.debug(\"dead device timeout set to {} seconds\", deadDeviceTimeout / 1000);\n-\n-        String port = config.getPort();\n-        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n-        driver.addPort(\"port\", port, serialPortManager);\n-        driver.addMsgListener(portListener, port);\n-\n-        logger.debug(\"setting driver listener\");\n-        driver.setDriverListener(portListener);\n     }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1NzkzNw=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjczOTAxNQ==", "bodyText": "Ah, didn't notice that. My bad.", "url": "https://github.com/openhab/openhab-addons/pull/7662#discussion_r426739015", "createdAt": "2020-05-18T16:09:11Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.insteon/src/main/java/org/openhab/binding/insteon/internal/InsteonBinding.java", "diffHunk": "@@ -155,34 +161,12 @@ public InsteonBinding(InsteonNetworkHandler handler, @Nullable InsteonNetworkCon\n \n         deadDeviceTimeout = devicePollIntervalMilliseconds * DEAD_DEVICE_COUNT;\n         logger.debug(\"dead device timeout set to {} seconds\", deadDeviceTimeout / 1000);\n-\n-        String port = config.getPort();\n-        logger.debug(\"port = '{}'\", Utils.redactPassword(port));\n-        driver.addPort(\"port\", port, serialPortManager);\n-        driver.addMsgListener(portListener, port);\n-\n-        logger.debug(\"setting driver listener\");\n-        driver.setDriverListener(portListener);\n     }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1NzkzNw=="}, "originalCommit": {"oid": "715fb9be64ce1536a3536fc411c56be51d1e0b54"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 37, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}