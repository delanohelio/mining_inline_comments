{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyNzQyNDYz", "number": 9230, "title": "[icalendar] Fix race condition while initialization of EventFilterHandler", "bodyText": "Should fix #9029. The channels do not get updated as the known channels by the binding where only updated if Bridge was already online while initializing EventFilterHandler. Even if it does not fix the issue, the race condition is is fixed.\nAlso added a bit more output.\nSigned-off-by: Michael Wodniok michi@noorganization.org", "createdAt": "2020-12-04T19:33:55Z", "url": "https://github.com/openhab/openhab-addons/pull/9230", "merged": true, "mergeCommit": {"oid": "de390b96beb7bf4b31c6a1ae64fa5eee8125bb60"}, "closed": true, "closedAt": "2020-12-05T05:35:15Z", "author": {"login": "daMihe"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi850VgH2gAyNTMyNzQyNDYzOjM1YzA0ZGI1YTdlZGYyZjk3M2M1OWEzNWY3NWQ4NDBhMTMxM2E4M2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdjFkqGgFqTU0NTQxMzI1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "35c04db5a7edf2f973c59a35f75d840a1313a83c", "author": {"user": {"login": "daMihe", "name": "Michael Wodniok"}}, "url": "https://github.com/openhab/openhab-addons/commit/35c04db5a7edf2f973c59a35f75d840a1313a83c", "committedDate": "2020-12-04T19:28:07Z", "message": "[icalendar] Fix race condition while initialization of EventFilterHandler\n\nShould fix #9029. The channels do not get updated as the known channels by the binding where only updated if Bridge was already online while initializing EventFilterHandler.\nAlso added a bit more output.\n\nSigned-off-by: Michael Wodniok <michi@noorganization.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MzE3NzIz", "url": "https://github.com/openhab/openhab-addons/pull/9230#pullrequestreview-545317723", "createdAt": "2020-12-04T21:47:12Z", "commit": {"oid": "35c04db5a7edf2f973c59a35f75d840a1313a83c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMTo0NzoxMlrOH_jKeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMTo0Nzo1NVrOH_jL0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM5ODQ1Ng==", "bodyText": "The logger will convert it to a string automatically if it needs to be logged.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    logger.trace(\"Notifying {} about fresh calendar.\", handler.getThing().getUID().getAsString());\n          \n          \n            \n                                    logger.trace(\"Notifying {} about fresh calendar.\", handler.getThing().getUID());", "url": "https://github.com/openhab/openhab-addons/pull/9230#discussion_r536398456", "createdAt": "2020-12-04T21:47:12Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.icalendar/src/main/java/org/openhab/binding/icalendar/internal/handler/ICalendarHandler.java", "diffHunk": "@@ -183,6 +183,7 @@ public void onCalendarUpdated() {\n                 ThingHandler handler = childThing.getHandler();\n                 if (handler instanceof CalendarUpdateListener) {\n                     try {\n+                        logger.trace(\"Notifying {} about fresh calendar.\", handler.getThing().getUID().getAsString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35c04db5a7edf2f973c59a35f75d840a1313a83c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM5ODgwMQ==", "bodyText": "Shouldn't you return here?", "url": "https://github.com/openhab/openhab-addons/pull/9230#discussion_r536398801", "createdAt": "2020-12-04T21:47:55Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.icalendar/src/main/java/org/openhab/binding/icalendar/internal/handler/EventFilterHandler.java", "diffHunk": "@@ -257,6 +254,9 @@ private void updateChannelSet(EventFilterConfiguration config) {\n      * Updates all states and channels. Reschedules an update if no error occurs.\n      */\n     private void updateStates() {\n+        if (!initFinished) {\n+            logger.debug(\"Ignoring call for updating states as this instance is not initialized yet.\");\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35c04db5a7edf2f973c59a35f75d840a1313a83c"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11ed97fb457a912d49e931842bdd173cb7dc0174", "author": {"user": {"login": "daMihe", "name": "Michael Wodniok"}}, "url": "https://github.com/openhab/openhab-addons/commit/11ed97fb457a912d49e931842bdd173cb7dc0174", "committedDate": "2020-12-04T21:51:01Z", "message": "[icalendar] use implicit conversion to string for logging\r\n\r\nAs suggested by @cpmeister\r\n\r\nSigned-Off-By: Michael Wodniok <michi@noorganization.org>\n\nCo-authored-by: Connor Petty <mistercpp2000@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec5369a05bb2d03670d5939ccb25319724da8c15", "author": {"user": {"login": "daMihe", "name": "Michael Wodniok"}}, "url": "https://github.com/openhab/openhab-addons/commit/ec5369a05bb2d03670d5939ccb25319724da8c15", "committedDate": "2020-12-04T21:56:12Z", "message": "[icalendar] Skipping update of channels if not initialized as suggested by @cpmeister\n\nSigned-off-by: Michael Wodniok <michi@noorganization.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NDEzMjUz", "url": "https://github.com/openhab/openhab-addons/pull/9230#pullrequestreview-545413253", "createdAt": "2020-12-05T05:34:09Z", "commit": {"oid": "ec5369a05bb2d03670d5939ccb25319724da8c15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4006, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}