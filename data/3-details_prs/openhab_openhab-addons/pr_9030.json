{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMDU0MjYz", "number": 9030, "title": "[caddx] Fix wrongly handled discovery, off by 1 errors", "bodyText": "The classification of this PR is Bugfix.\n\n\nDiscovery process\nThe discovery process for the Zone things was based on a wrong assumption. There is no way to actually check if a zone is present or not. Therefore a new parameter has been introduced for the bridge which specifies the maximum zone number that should be instantiated.\n\n\nOff by one errors\nCorrected the logging of the zone and partition numbers. Corrected the message parsing for String values.\n\n\nRefresh handling\nChanged the way the RefreshType commands are handled. Only for the first Refresh command received is a respective command sent to the panel. For the next two seconds all other refresh commands are ignored for a thing because the panel's response updates all the channels.\n\n\nTests\nAdded message parsing unit tests.", "createdAt": "2020-11-14T20:09:23Z", "url": "https://github.com/openhab/openhab-addons/pull/9030", "merged": true, "mergeCommit": {"oid": "fa21dff364bc82fd9b305911612e1d5ca013fe8a"}, "closed": true, "closedAt": "2020-11-19T02:10:10Z", "author": {"login": "jossuar"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcenmLgH2gAyNTIxMDU0MjYzOmU5M2Q1ZmMyNDFkNGU3ZTc4YmQ0NmY5ODVlZThjNTM3Yjc3NjUxOTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdd5DyhAFqTUzNDAyNjkxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e93d5fc241d4e7e78bd46f985ee8c537b7765196", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/e93d5fc241d4e7e78bd46f985ee8c537b7765196", "committedDate": "2020-11-14T16:47:31Z", "message": "Corrected caddx discovery bug\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9713f5ce78307c2d2283ebf0570e12e225007f7e", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/9713f5ce78307c2d2283ebf0570e12e225007f7e", "committedDate": "2020-11-14T17:42:55Z", "message": "Maintenance\n\n- Changed refresh logic for the things\n- Code cleanup\n- Corrected off by one errors\n- Added initial tests for the message parsing\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cec98f1511413f4003c4c21d7c592a048c4a06a", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/9cec98f1511413f4003c4c21d7c592a048c4a06a", "committedDate": "2020-11-14T18:06:58Z", "message": "Corrected ParameterizedTest\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjc2MzU5", "url": "https://github.com/openhab/openhab-addons/pull/9030#pullrequestreview-532676359", "createdAt": "2020-11-17T18:37:41Z", "commit": {"oid": "9cec98f1511413f4003c4c21d7c592a048c4a06a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODozNzo0MVrOH1Dq2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODozNzo0MVrOH1Dq2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTM5NjY5OQ==", "bodyText": "I think it is a bit more readable if you use System.currentTimeMillis() instead of new Date().getTime()", "url": "https://github.com/openhab/openhab-addons/pull/9030#discussion_r525396699", "createdAt": "2020-11-17T18:37:41Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.caddx/src/main/java/org/openhab/binding/caddx/internal/handler/ThingHandlerZone.java", "diffHunk": "@@ -77,15 +75,17 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n         String data = null;\n \n         if (command instanceof RefreshType) {\n-            if (channelUID.getId().equals(CaddxBindingConstants.ZONE_FAULTED)) {\n+            // Refresh only if 2 seconds have passed from the last refresh\n+            if (new Date().getTime() - lastRefreshTime > 2000) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cec98f1511413f4003c4c21d7c592a048c4a06a"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61e19241c5b8506143272ec1747aff94e6c9934f", "author": {"user": {"login": "jossuar", "name": "Georgios Moutsos"}}, "url": "https://github.com/openhab/openhab-addons/commit/61e19241c5b8506143272ec1747aff94e6c9934f", "committedDate": "2020-11-18T06:52:14Z", "message": "Changed new Date().getTime to System.currentTimeMillis()\n\nSigned-off-by: Georgios Moutsos <georgios.moutsos@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MDI2OTE4", "url": "https://github.com/openhab/openhab-addons/pull/9030#pullrequestreview-534026918", "createdAt": "2020-11-19T02:09:46Z", "commit": {"oid": "61e19241c5b8506143272ec1747aff94e6c9934f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4086, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}