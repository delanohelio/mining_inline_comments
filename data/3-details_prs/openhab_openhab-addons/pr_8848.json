{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5MjA2NzE4", "number": 8848, "title": "[infrastructure] add external null-annotations", "bodyText": "This adds external null annotations and fixes all null-errors found.", "createdAt": "2020-10-23T20:40:44Z", "url": "https://github.com/openhab/openhab-addons/pull/8848", "merged": true, "mergeCommit": {"oid": "bd664ff0c89631e23a9506e0fea9d78bf5f3f419"}, "closed": true, "closedAt": "2020-10-30T23:29:04Z", "author": {"login": "J-N-K"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVs11QABqjM5MTY4NDc3MDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXpozRAFqTUyMDg1MTA3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf86c1014915618f3b862cc77529d8fed2dc3b49", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/cf86c1014915618f3b862cc77529d8fed2dc3b49", "committedDate": "2020-10-24T14:03:18Z", "message": "fix touchwand\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}, "afterCommit": {"oid": "9068f9c17ade7238be54bf4524e8c6aa3154ba18", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/9068f9c17ade7238be54bf4524e8c6aa3154ba18", "committedDate": "2020-10-24T15:23:48Z", "message": "fix null-errors\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f950394ab4e7ec8eb46bcaeaccb39b2bc1657b9c", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/f950394ab4e7ec8eb46bcaeaccb39b2bc1657b9c", "committedDate": "2020-10-28T10:26:44Z", "message": "enable external null-annotations\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2701ed64f36325a8d15ac4c431b575fd7bce61cd", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/2701ed64f36325a8d15ac4c431b575fd7bce61cd", "committedDate": "2020-10-28T10:29:10Z", "message": "fix null-errors\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dde0b79a567607ab7fc3c425b49d728a0d57027", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/3dde0b79a567607ab7fc3c425b49d728a0d57027", "committedDate": "2020-10-28T10:29:18Z", "message": "prevent eea-embedding\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "644adceda2f1c8cad8898dd2464ba023fadd6205", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/644adceda2f1c8cad8898dd2464ba023fadd6205", "committedDate": "2020-10-28T10:29:19Z", "message": "add m2e  annotationpath\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/df5c5951057e5dd55f942b969653e2df88c4c3d2", "committedDate": "2020-10-24T18:59:44Z", "message": "prevent eea-embedding\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}, "afterCommit": {"oid": "644adceda2f1c8cad8898dd2464ba023fadd6205", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/644adceda2f1c8cad8898dd2464ba023fadd6205", "committedDate": "2020-10-28T10:29:19Z", "message": "add m2e  annotationpath\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "028e5077e0ffa6e0e47b43b290ee366878e683ab", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/028e5077e0ffa6e0e47b43b290ee366878e683ab", "committedDate": "2020-10-28T18:04:09Z", "message": "fix remoteopenhab\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/b74f49afc7e34b29e4f6fbe31342cebce63e5971", "committedDate": "2020-10-28T18:32:35Z", "message": "fix snmp\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2MzE3NzE2", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-516317716", "createdAt": "2020-10-25T01:27:59Z", "commit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNVQwMToyODowMFrOHn1gnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNVQwMjowMzozM1rOHn1qWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzMzIxNQ==", "bodyText": "A class without a classloader is kinda more significant than a simple RuntimeException could provide. Something must be really wrong with the virtual machine environment if this should occur.\nI suggest elevating it to one of the VirtualMachineError classes.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        throw new IllegalStateException(\"Cannot find classloader\");\n          \n          \n            \n                        throw new UnknownError(\"Cannot find classloader\");", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511533215", "createdAt": "2020-10-25T01:28:00Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.lutron/src/main/java/org/openhab/binding/lutron/internal/xml/DbXmlInfoReader.java", "diffHunk": "@@ -50,7 +50,11 @@ public DbXmlInfoReader() {\n         xstream = new XStream(driver);\n \n         configureSecurity(xstream);\n-        setClassLoader(Project.class.getClassLoader());\n+        ClassLoader classLoader = Project.class.getClassLoader();\n+        if (classLoader == null) {\n+            throw new IllegalStateException(\"Cannot find classloader\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzMzMxNw==", "bodyText": "This isn't an equivalent comparison.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511533317", "createdAt": "2020-10-25T01:29:42Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.loxone/src/main/java/org/openhab/binding/loxone/internal/LxServerHandler.java", "diffHunk": "@@ -531,8 +531,9 @@ private void addThingChannels(List<Channel> newChannels, boolean purge) {\n             channels.addAll(getThing().getChannels());\n         }\n         channels.sort((c1, c2) -> {\n-            String label = c1.getLabel();\n-            return label == null ? 1 : label.compareTo(c2.getLabel());\n+            String label1 = c1.getLabel();\n+            String label2 = c2.getLabel();\n+            return (label1 == null || label2 == null) ? 1 : label1.compareTo(label2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzMzQxMg==", "bodyText": "wouldn't a null be more appropriate here than an empty string?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511533412", "createdAt": "2020-10-25T01:31:02Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.miio/src/main/java/org/openhab/binding/miio/internal/handler/MiIoAbstractHandler.java", "diffHunk": "@@ -276,8 +276,9 @@ protected void disconnectedNoResponse() {\n         disconnected(\"No Response from device\");\n     }\n \n-    protected void disconnected(String message) {\n-        updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.OFFLINE.COMMUNICATION_ERROR, message);\n+    protected void disconnected(@Nullable String message) {\n+        updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.OFFLINE.COMMUNICATION_ERROR,\n+                message != null ? message : \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzNDQ4OA==", "bodyText": "No @Override annotation?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511534488", "createdAt": "2020-10-25T01:46:57Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.shelly/src/main/java/org/openhab/binding/shelly/internal/api/ShellyApiException.java", "diffHunk": "@@ -58,8 +58,7 @@ public ShellyApiException(ShellyApiResult result, Exception exception) {\n         apiResult = result;\n     }\n \n-    @Override\n-    public String getMessage() {\n+    public @Nullable String getMessage() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzNTI2Nw==", "bodyText": "HttpResponse can't accept a null message?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511535267", "createdAt": "2020-10-25T01:57:20Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.io.neeo/src/main/java/org/openhab/io/neeo/internal/net/HttpRequest.java", "diffHunk": "@@ -100,7 +101,8 @@ public HttpResponse sendPostJsonCommand(String uri, String body) {\n                 content.close();\n             }\n         } catch (IOException | IllegalStateException | ProcessingException e) {\n-            return new HttpResponse(HttpStatus.SERVICE_UNAVAILABLE_503, e.getMessage());\n+            String message = e.getMessage();\n+            return new HttpResponse(HttpStatus.SERVICE_UNAVAILABLE_503, message != null ? message : \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzNTMyOA==", "bodyText": "This change isn't equivalent. Would there by any consequences from setting these values to 0?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511535328", "createdAt": "2020-10-25T01:58:10Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.io.neeo/src/main/java/org/openhab/io/neeo/internal/OpenHabToDeviceConverter.java", "diffHunk": "@@ -135,9 +135,9 @@ NeeoDevice convert(Thing thing) {\n             final String manufacturer = StringUtils.isEmpty(properties.get(\"Manufacturer\")) ? \"openHAB\"\n                     : properties.get(\"Manufacturer\");\n \n-            final Integer standbyDelay = parseInteger(properties.get(\"Standby Command Delay\"));\n-            final Integer switchDelay = parseInteger(properties.get(\"Source Switch Delay\"));\n-            final Integer shutDownDelay = parseInteger(properties.get(\"Shutdown Delay\"));\n+            final Integer standbyDelay = parseInteger(properties.getOrDefault(\"Standby Command Delay\", \"0\"));\n+            final Integer switchDelay = parseInteger(properties.getOrDefault(\"Source Switch Delay\", \"0\"));\n+            final Integer shutDownDelay = parseInteger(properties.getOrDefault(\"Shutdown Delay\", \"0\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzNTM3NA==", "bodyText": "Wouldn't it be better to change NetworkUtils.singleError to accept a null message?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511535374", "createdAt": "2020-10-25T01:58:59Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.io.hueemulation/src/main/java/org/openhab/io/hueemulation/internal/rest/Schedules.java", "diffHunk": "@@ -335,7 +337,9 @@ public Response postNewSchedule(@Context UriInfo uri,\n         try {\n             rule = createRule(uid, builder, Collections.emptyList(), Collections.emptyList(), newScheduleData, cs.ds);\n         } catch (IllegalStateException e) { // No stacktrace required, we just need the exception message\n-            return NetworkUtils.singleError(cs.gson, uri, HueResponse.ARGUMENTS_INVALID, e.getMessage());\n+            String message = e.getMessage();\n+            return NetworkUtils.singleError(cs.gson, uri, HueResponse.ARGUMENTS_INVALID,\n+                    message != null ? message : \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUzNTcwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                future.completeExceptionally(new IllegalStateException());\n          \n          \n            \n                                future.completeExceptionally(e);", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r511535707", "createdAt": "2020-10-25T02:03:33Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.spotify/src/main/java/org/openhab/binding/spotify/internal/api/SpotifyConnector.java", "diffHunk": "@@ -149,7 +149,12 @@ public Caller(Function<HttpClient, Request> requester, String authorization) {\n                     }\n                 }\n             } catch (ExecutionException e) {\n-                future.completeExceptionally(e.getCause());\n+                Throwable cause = e.getCause();\n+                if (cause != null) {\n+                    future.completeExceptionally(cause);\n+                } else {\n+                    future.completeExceptionally(new IllegalStateException());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df5c5951057e5dd55f942b969653e2df88c4c3d2"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d27fe9b3a201860022ab5bf1b90ecdfdb7bb0e5", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/2d27fe9b3a201860022ab5bf1b90ecdfdb7bb0e5", "committedDate": "2020-10-28T22:33:46Z", "message": "address review comments\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70f83b0ce24f45509fe908a681ee957db5b11b9c", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/70f83b0ce24f45509fe908a681ee957db5b11b9c", "committedDate": "2020-10-28T22:35:39Z", "message": "apply spotless\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MTMyMDYz", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-519132063", "createdAt": "2020-10-28T22:29:00Z", "commit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMjoyOTowMFrOHp_2OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMjo0MjoxOFrOHqAKKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5OTczNw==", "bodyText": "Maybe add a message for the NumberFormatException here, the catch would end up using it.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513799737", "createdAt": "2020-10-28T22:29:00Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.sonos/src/main/java/org/openhab/binding/sonos/internal/handler/ZonePlayerHandler.java", "diffHunk": "@@ -1393,7 +1393,11 @@ private Long getResultEntry(Map<String, @Nullable String> resultInput, String re\n         }\n \n         try {\n-            result = Long.valueOf(resultInput.get(requestedKey));\n+            String resultString = resultInput.get(requestedKey);\n+            if (resultString == null) {\n+                throw new NumberFormatException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwMTYyMw==", "bodyText": "System.err can be null!?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513801623", "createdAt": "2020-10-28T22:33:50Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.transform.map/src/test/java/org/openhab/transform/map/internal/MapTransformationServiceTest.java", "diffHunk": "@@ -125,7 +122,10 @@ public Void call() throws Exception {\n                 }\n             }, 10000, 100);\n         } catch (IOException e1) {\n-            e1.printStackTrace(System.err);\n+            PrintStream err = System.err;\n+            if (err != null) {\n+                e1.printStackTrace(err);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwMjA5MQ==", "bodyText": "I hope this doesn't cause problems...", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513802091", "createdAt": "2020-10-28T22:35:00Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.volvooncall/src/main/java/org/openhab/binding/volvooncall/internal/dto/TripDetail.java", "diffHunk": "@@ -74,7 +75,9 @@ public State getEndPosition() {\n     }\n \n     public long getDurationInMinutes() {\n-        return Duration.between(startTime, endTime).toMinutes();\n+        Temporal start = startTime;\n+        Temporal end = endTime;\n+        return (start == null || end == null) ? 0 : Duration.between(start, end).toMinutes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwNDE0Mw==", "bodyText": "Should probably log something here, looks like there is an expectation for the browseTarget to be logged for debugging. I'd suggest logging a message here regarding the lack of an entry for that browseTarget.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513804143", "createdAt": "2020-10-28T22:40:18Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.upnpcontrol/src/main/java/org/openhab/binding/upnpcontrol/internal/handler/UpnpServerHandler.java", "diffHunk": "@@ -207,7 +207,12 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n                                 // No parent found, so make it the root directory\n                                 browseTarget = DIRECTORY_ROOT;\n                             }\n-                            currentEntry = parentMap.get(browseTarget);\n+                            UpnpEntry entry = parentMap.get(browseTarget);\n+                            if (entry == null) {\n+                                return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwNDg0MQ==", "bodyText": "contentEquals is equivalent to equals when comparing two strings.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            } else if (value != null && \"PAUSED_PLAYBACK\".contentEquals(value)) {\n          \n          \n            \n                            } else if (\"PAUSED_PLAYBACK\".equals(value)) {", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513804841", "createdAt": "2020-10-28T22:42:18Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.upnpcontrol/src/main/java/org/openhab/binding/upnpcontrol/internal/handler/UpnpRendererHandler.java", "diffHunk": "@@ -590,7 +590,7 @@ public void onValueReceived(@Nullable String variable, @Nullable String value, @\n                     playing = true;\n                     updateState(CONTROL, PlayPauseType.PLAY);\n                     scheduleTrackPositionRefresh();\n-                } else if (\"PAUSED_PLAYBACK\".contentEquals(value)) {\n+                } else if (value != null && \"PAUSED_PLAYBACK\".contentEquals(value)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74f49afc7e34b29e4f6fbe31342cebce63e5971"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MTQzNzU3", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-519143757", "createdAt": "2020-10-28T22:55:23Z", "commit": {"oid": "70f83b0ce24f45509fe908a681ee957db5b11b9c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMjo1NToyM1rOHqAdHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMzoyMjo0NVrOHqBCZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwOTY5NA==", "bodyText": "If the logDir is not in the system properties I think it would be safer for this binding if you put the thing offline with a configuration error.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513809694", "createdAt": "2020-10-28T22:55:23Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.logreader/src/main/java/org/openhab/binding/logreader/internal/handler/LogHandler.java", "diffHunk": "@@ -81,9 +81,9 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n     @Override\n     public void initialize() {\n         configuration = getConfigAs(LogReaderConfiguration.class);\n-\n+        String logDir = System.getProperty(\"openhab.logdir\");\n         configuration.filePath = configuration.filePath.replaceFirst(\"\\\\$\\\\{OPENHAB_LOGDIR\\\\}\",\n-                System.getProperty(\"openhab.logdir\"));\n+                logDir != null ? logDir : \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70f83b0ce24f45509fe908a681ee957db5b11b9c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxMDQ4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        HeliosVariable variable = variableMap.get(channelId);\n          \n          \n            \n                                        if (variable != null) {\n          \n          \n            \n                                            updateState(variable, v);\n          \n          \n            \n                                            updateStatus(ThingStatus.ONLINE);\n          \n          \n            \n                                        }\n          \n          \n            \n                                        HeliosVariable variable = variableMap.get(channelId);\n          \n          \n            \n                                        if (variable != null) {\n          \n          \n            \n                                            updateState(variable, v);\n          \n          \n            \n                                        }\n          \n          \n            \n                                        updateStatus(ThingStatus.ONLINE);", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513810482", "createdAt": "2020-10-28T22:57:24Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.modbus.helioseasycontrols/src/main/java/org/openhab/binding/modbus/helioseasycontrols/internal/HeliosEasyControlsHandler.java", "diffHunk": "@@ -339,8 +339,11 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n                     try {\n                         writeValue(channelId, v);\n                         if (variableMap != null) {\n-                            updateState(variableMap.get(channelId), v);\n-                            updateStatus(ThingStatus.ONLINE);\n+                            HeliosVariable variable = variableMap.get(channelId);\n+                            if (variable != null) {\n+                                updateState(variable, v);\n+                                updateStatus(ThingStatus.ONLINE);\n+                            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70f83b0ce24f45509fe908a681ee957db5b11b9c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxMTYwMQ==", "bodyText": "Should you return if you find a null thingTypeUID? Is it ok to create a ThingUID with a null thingTypeUID?", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513811601", "createdAt": "2020-10-28T23:00:25Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.modbus.sunspec/src/main/java/org/openhab/binding/modbus/sunspec/internal/discovery/SunspecDiscoveryProcess.java", "diffHunk": "@@ -282,8 +283,11 @@ private void createDiscoveryResult(ModelBlock block) {\n             return;\n         }\n \n-        ThingUID thingUID = new ThingUID(SUPPORTED_THING_TYPES_UIDS.get(block.moduleID), handler.getUID(),\n-                Integer.toString(block.address));\n+        ThingTypeUID thingTypeUID = SUPPORTED_THING_TYPES_UIDS.get(block.moduleID);\n+        if (thingTypeUID == null) {\n+            logger.warn(\"Found model block but no corresponding thing type UID present: {}\", block.moduleID);\n+        }\n+        ThingUID thingUID = new ThingUID(thingTypeUID, handler.getUID(), Integer.toString(block.address));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70f83b0ce24f45509fe908a681ee957db5b11b9c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxOTIzOQ==", "bodyText": "I just tested to make sure and confirmed that this isn't an equivalent change. findFirst() will throw an NPE if the first element it encounters is a null value, so you need to filter out the null values before you can do the mapping.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r513819239", "createdAt": "2020-10-28T23:22:45Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.nikohomecontrol/src/main/java/org/openhab/binding/nikohomecontrol/internal/protocol/nhc2/NikoHomeControlCommunication2.java", "diffHunk": "@@ -507,15 +510,15 @@ private void updateThermostatState(NhcThermostat2 thermostat, List<NhcProperty>\n         Optional<Boolean> overruleActiveProperty = deviceProperties.stream().map(p -> p.overruleActive)\n                 .filter(Objects::nonNull).map(t -> Boolean.parseBoolean(t)).findFirst();\n         Optional<Integer> overruleSetpointProperty = deviceProperties.stream().map(p -> p.overruleSetpoint)\n-                .filter(s -> !((s == null) || s.isEmpty())).map(t -> Math.round(Float.parseFloat(t) * 10)).findFirst();\n+                .map(s -> (!((s == null) || s.isEmpty())) ? Math.round(Float.parseFloat(s) * 10) : null).findFirst();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70f83b0ce24f45509fe908a681ee957db5b11b9c"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b07f402611016338f48dd6237f6a13cc055094c5", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/b07f402611016338f48dd6237f6a13cc055094c5", "committedDate": "2020-10-29T07:34:04Z", "message": "address review comments\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTEyMzcy", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-519912372", "createdAt": "2020-10-29T17:32:09Z", "commit": {"oid": "b07f402611016338f48dd6237f6a13cc055094c5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNzozMjoxMFrOHqnBYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNzozMjoxMFrOHqnBYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0MTU3MA==", "bodyText": "Perhaps it's better to move this to the POMs in bundles and itests because there won't be any unpacked EEAs in other projects such as bom/features.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r514441570", "createdAt": "2020-10-29T17:32:10Z", "author": {"login": "wborn"}, "path": "pom.xml", "diffHunk": "@@ -80,6 +80,8 @@\n \n     <feature.directory>src/main/feature/feature.xml</feature.directory>\n     <spotless.version>2.0.3</spotless.version>\n+\n+    <m2e.jdt.annotationpath>target/dependency</m2e.jdt.annotationpath>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b07f402611016338f48dd6237f6a13cc055094c5"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9b180d8a4fad1b986e69ab1be19f68e6daaf621", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/b9b180d8a4fad1b986e69ab1be19f68e6daaf621", "committedDate": "2020-10-29T18:30:37Z", "message": "address review comments\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "670bf996d7221a873c66e1aa2c317581bf4f6a2b", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/670bf996d7221a873c66e1aa2c317581bf4f6a2b", "committedDate": "2020-10-29T18:36:08Z", "message": "fix POM\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f8c1867c2fa0b28d54fc70f4426a3f9313a2a7c", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/3f8c1867c2fa0b28d54fc70f4426a3f9313a2a7c", "committedDate": "2020-10-29T20:15:19Z", "message": "address review comments\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMDU1NjU3", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-520055657", "createdAt": "2020-10-29T20:29:28Z", "commit": {"oid": "3f8c1867c2fa0b28d54fc70f4426a3f9313a2a7c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNjI0NDk5", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-520624499", "createdAt": "2020-10-30T12:33:40Z", "commit": {"oid": "3f8c1867c2fa0b28d54fc70f4426a3f9313a2a7c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjozMzo0MFrOHrNHNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjozMzo0MFrOHrNHNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA2NTY1Mg==", "bodyText": "It will build better with:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                            logger.info(\"Browse target not found. Exiting.\")\n          \n          \n            \n                                            logger.info(\"Browse target not found. Exiting.\");", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r515065652", "createdAt": "2020-10-30T12:33:40Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.upnpcontrol/src/main/java/org/openhab/binding/upnpcontrol/internal/handler/UpnpServerHandler.java", "diffHunk": "@@ -207,7 +207,13 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n                                 // No parent found, so make it the root directory\n                                 browseTarget = DIRECTORY_ROOT;\n                             }\n-                            currentEntry = parentMap.get(browseTarget);\n+                            UpnpEntry entry = parentMap.get(browseTarget);\n+                            if (entry == null) {\n+                                logger.info(\"Browse target not found. Exiting.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f8c1867c2fa0b28d54fc70f4426a3f9313a2a7c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c3de9e9e9f2b4727854b390052f27e1a8b17c66", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/1c3de9e9e9f2b4727854b390052f27e1a8b17c66", "committedDate": "2020-10-30T12:47:09Z", "message": "fix build\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNjU2ODMy", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-520656832", "createdAt": "2020-10-30T13:18:31Z", "commit": {"oid": "1c3de9e9e9f2b4727854b390052f27e1a8b17c66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMzoxODozMVrOHrOjmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMzoxODozMVrOHrOjmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA4OTMwNQ==", "bodyText": "It would be so much easier to read when statically importing Map.entry and using entry( instead of all those lengthy new AbstractMap.SimpleEntry<AlertLevel, String>( constructs here. \ud83d\ude06\nprivate static final Map<AlertLevel, String> ALERT_COLORS = Map.ofEntries(\n            entry(AlertLevel.GREEN, \"00ff00\"),\n            entry(AlertLevel.YELLOW, \"ffff00\"),\n            entry(AlertLevel.ORANGE, \"ff6600\"),\n            entry(AlertLevel.RED, \"ff0000\"),\n            entry(AlertLevel.UNKNOWN, UNKNOWN_COLOR));", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r515089305", "createdAt": "2020-10-30T13:18:31Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java", "diffHunk": "@@ -63,12 +63,13 @@\n             + \"facet=etat_vent&facet=etat_pluie_inondation&facet=etat_orage&facet=etat_inondation&facet=etat_neige&facet=etat_canicule&\"\n             + \"facet=etat_grand_froid&facet=etat_avalanches&refine.nom_dept=\";\n     private static final int TIMEOUT_MS = 30000;\n+    private static final String UNKNOWN_COLOR = \"b3b3b3\";\n     private static final Map<AlertLevel, String> ALERT_COLORS = Map.ofEntries(\n             new AbstractMap.SimpleEntry<AlertLevel, String>(AlertLevel.GREEN, \"00ff00\"),\n             new AbstractMap.SimpleEntry<AlertLevel, String>(AlertLevel.YELLOW, \"ffff00\"),\n             new AbstractMap.SimpleEntry<AlertLevel, String>(AlertLevel.ORANGE, \"ff6600\"),\n             new AbstractMap.SimpleEntry<AlertLevel, String>(AlertLevel.RED, \"ff0000\"),\n-            new AbstractMap.SimpleEntry<AlertLevel, String>(AlertLevel.UNKNOWN, \"b3b3b3\"));\n+            new AbstractMap.SimpleEntry<AlertLevel, String>(AlertLevel.UNKNOWN, UNKNOWN_COLOR));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c3de9e9e9f2b4727854b390052f27e1a8b17c66"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNjc3ODgy", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-520677882", "createdAt": "2020-10-30T13:41:45Z", "commit": {"oid": "1c3de9e9e9f2b4727854b390052f27e1a8b17c66"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMzo0MTo0NVrOHrPiSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDowODoxM1rOHrQtIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEwNTM1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if (MonopriceAudioZone.VALID_ZONE_IDS.contains(zoneId) || zoneDTO != null) {\n          \n          \n            \n                                if (MonopriceAudioZone.VALID_ZONE_IDS.contains(zoneId) && zoneDTO != null) {\n          \n      \n    \n    \n  \n\nBecause of the different error/warning config in Eclipse it is already an error at L473:\nNull type mismatch: required '@NonNull MonopriceAudioZoneDTO' but the provided value is inferred as @Nullable", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r515105352", "createdAt": "2020-10-30T13:41:45Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.monopriceaudio/src/main/java/org/openhab/binding/monopriceaudio/internal/handler/MonopriceAudioHandler.java", "diffHunk": "@@ -462,12 +467,12 @@ public void onNewMessageEvent(MonopriceAudioMessageEvent evt) {\n \n                 case MonopriceAudioConnector.KEY_ZONE_UPDATE:\n                     String zoneId = updateData.substring(0, 2);\n-\n-                    if (MonopriceAudioZone.VALID_ZONE_IDS.contains(zoneId)) {\n+                    MonopriceAudioZoneDTO zoneDTO = zoneDataMap.get(zoneId);\n+                    if (MonopriceAudioZone.VALID_ZONE_IDS.contains(zoneId) || zoneDTO != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c3de9e9e9f2b4727854b390052f27e1a8b17c66"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEyNDUxNQ==", "bodyText": "Using anything else besides annotations from the org.eclipse.jdt.annotation package will likely cause runtime issues because these packages are considered to be optional:\n\n  \n    \n      openhab-addons/pom.xml\n    \n    \n         Line 142\n      in\n      9a5832a\n    \n    \n    \n    \n\n        \n          \n             org.eclipse.jdt.annotation.*;resolution:=optional,\\\\ \n        \n    \n  \n\n\nI think currently it is only safe to use the Checks class in test code.", "url": "https://github.com/openhab/openhab-addons/pull/8848#discussion_r515124515", "createdAt": "2020-10-30T14:08:13Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.binding.satel/src/main/java/org/openhab/binding/satel/internal/event/IntegraStateEvent.java", "diffHunk": "@@ -71,10 +73,10 @@ public BitSet getStateBits(StateType stateType) {\n         if (stateType.getStartByte() == 0 && bitsCount == stateBits.size()) {\n             return stateBits;\n         }\n-        return stateBitsMap.computeIfAbsent(stateType, k -> {\n+        return requireNonNull(stateBitsMap.computeIfAbsent(stateType, k -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c3de9e9e9f2b4727854b390052f27e1a8b17c66"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26fc48ec19b2aa2be7ff946604af4b87d805a58e", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/26fc48ec19b2aa2be7ff946604af4b87d805a58e", "committedDate": "2020-10-30T14:59:04Z", "message": "address review comments\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0efed7875b1baf446ddfe6ac0745d33134999168", "author": {"user": {"login": "J-N-K", "name": null}}, "url": "https://github.com/openhab/openhab-addons/commit/0efed7875b1baf446ddfe6ac0745d33134999168", "committedDate": "2020-10-30T14:59:24Z", "message": "fix potential NPE\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwODUxMDc2", "url": "https://github.com/openhab/openhab-addons/pull/8848#pullrequestreview-520851076", "createdAt": "2020-10-30T16:48:10Z", "commit": {"oid": "0efed7875b1baf446ddfe6ac0745d33134999168"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4373, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}