{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4NzQ3ODI4", "number": 7178, "title": "[opensprinkler] Add current draw channel", "bodyText": "The opensprinkler device, if it has a sensor for it, can display the\ncurrent draw of the device. This information is exposed as a read-only\nchannel with this commit.\nFixes #6386\nSigned-off-by: Florian florian.schmidt.welzow@t-online.de", "createdAt": "2020-03-15T15:51:56Z", "url": "https://github.com/openhab/openhab-addons/pull/7178", "merged": true, "mergeCommit": {"oid": "683853be5c51bebb529075096b18356b4126e8b6"}, "closed": true, "closedAt": "2020-04-25T18:50:49Z", "author": {"login": "FlorianSW"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcN7jfsAH2gAyMzg4NzQ3ODI4OjFhYjMxODc0ZTAyY2FjZGJiODlkYzlmM2RiOWFmNGVlYzU1MDkzNDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbKs20gFqTQwMDQyMTE3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ab31874e02cacdbb89dc9f3db9af4eec5509342", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/1ab31874e02cacdbb89dc9f3db9af4eec5509342", "committedDate": "2020-03-15T15:50:16Z", "message": "[opensprinkler] Add current draw channel\n\nThe opensprinkler device, if it has a sensor for it, can display the\ncurrent draw of the device. This information is exposed as a read-only\nchannel with this commit.\n\nFixes #6386\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f77b979a188eb69daf372005d4d05db85e5bd301", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/f77b979a188eb69daf372005d4d05db85e5bd301", "committedDate": "2020-03-15T15:53:53Z", "message": "Replace whitespace with tabs\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/2276d93cbeab41bcb08d747b5817cd42e36fdd5a", "committedDate": "2020-03-15T16:00:52Z", "message": "Fix logging parameter\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0ODIwMzk2", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-374820396", "createdAt": "2020-03-15T18:00:38Z", "commit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxODowMDozOFrOF2gVtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxODowMDozOFrOF2gVtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5NzI3MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Returns the current voltage draw of all connected zones of the OpenSprinkler device in milliamperes. Given the\n          \n          \n            \n                 * Returns the current draw of all connected zones of the OpenSprinkler device in milliamperes. Given the", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r392697270", "createdAt": "2020-03-15T18:00:38Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/api/OpenSprinklerApi.java", "diffHunk": "@@ -90,6 +90,15 @@ public abstract void openStation(int station, BigDecimal duration)\n      */\n     public abstract boolean isRainDetected() throws CommunicationApiException;\n \n+    /**\n+     * Returns the current voltage draw of all connected zones of the OpenSprinkler device in milliamperes. Given the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0ODIwNDk2", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-374820496", "createdAt": "2020-03-15T18:01:57Z", "commit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxODowMTo1OFrOF2gWMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxODowMTo1OFrOF2gWMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5NzM5Mw==", "bodyText": "Primitives should be automatically boxed for you.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                updateState(channel, new QuantityType<ElectricCurrent>(new Integer(getApi().currentDraw()),\n          \n          \n            \n                                updateState(channel, new QuantityType<ElectricCurrent>(getApi().currentDraw(),", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r392697393", "createdAt": "2020-03-15T18:01:58Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/handler/OpenSprinklerDeviceHandler.java", "diffHunk": "@@ -36,19 +41,24 @@ public OpenSprinklerDeviceHandler(Thing thing) {\n \n     @Override\n     protected void updateChannel(ChannelUID channel) {\n-        switch (channel.getIdWithoutGroup()) {\n-            case SENSOR_RAIN:\n-                try {\n+        try {\n+            switch (channel.getIdWithoutGroup()) {\n+                case SENSOR_RAIN:\n                     if (getApi().isRainDetected()) {\n                         updateState(channel, OnOffType.ON);\n                     } else {\n                         updateState(channel, OnOffType.OFF);\n                     }\n-                } catch (CommunicationApiException e) {\n-                    logger.debug(\"Could not update rainsensor\", e);\n-                }\n-            default:\n-                logger.debug(\"Not updating unknown channel {}\", channel);\n+                    break;\n+                case SENSOR_CURRENT_DRAW:\n+                    updateState(channel, new QuantityType<ElectricCurrent>(new Integer(getApi().currentDraw()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTQ1Nzky", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-378945792", "createdAt": "2020-03-21T19:41:43Z", "commit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxOTo0MTo0M1rOF5rTpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxOTo0MTo0M1rOF5rTpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjAyMjY5Mg==", "bodyText": "Is it possible to detect if the device has the capability?", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r396022692", "createdAt": "2020-03-21T19:41:43Z", "author": {"login": "J-N-K"}, "path": "bundles/org.openhab.binding.opensprinkler/README.md", "diffHunk": "@@ -61,9 +61,11 @@ When using the `nextDuration` channel, it is advised to setup persistence (e.g.\n \n The following is supported by the `device` thing, but only when connected using the http interface.\n \n-| Channel Type ID | Item Type |    | Description                                                           |\n-|-----------------|-----------|----|-----------------------------------------------------------------------|\n-| rainsensor      | Switch    | RO | This channel indicates whether rain is detected by the device or not. |\n+| Channel Type ID | Item Type              |    | Description                                                               |\n+|-----------------|------------------------|----|---------------------------------------------------------------------------|\n+| rainsensor      | Switch                 | RO | This channel indicates whether rain is detected by the device or not.     |\n+| currentDraw     | Number:ElectricCurrent | RO | Shows the current draw of the device. If the device does not have sensors |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2276d93cbeab41bcb08d747b5817cd42e36fdd5a"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9a6b8db75baa8d9e4db5e7c0b83276d28af0447", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/e9a6b8db75baa8d9e4db5e7c0b83276d28af0447", "committedDate": "2020-03-23T17:26:55Z", "message": "Update bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/api/OpenSprinklerApi.java\n\nCo-Authored-By: cpmeister <mistercpp2000@gmail.com>\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>\nSigned-off-by: cpmeister <mistercpp2000@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d50a5a2df0d0686b2cdd65cc9d260e615ace9ec", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/4d50a5a2df0d0686b2cdd65cc9d260e615ace9ec", "committedDate": "2020-03-23T17:28:03Z", "message": "Update bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/handler/OpenSprinklerDeviceHandler.java\n\nCo-Authored-By: cpmeister <mistercpp2000@gmail.com>\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>\nSigned-off-by: cpmeister <mistercpp2000@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d38f7760d44147758de7077022b72f87c6fa4f6", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/5d38f7760d44147758de7077022b72f87c6fa4f6", "committedDate": "2020-03-28T16:02:39Z", "message": "Conditionally add currentDraw channel\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be3f002825fadf72ee71eb2bd0166c50d0a2642b", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/be3f002825fadf72ee71eb2bd0166c50d0a2642b", "committedDate": "2020-03-28T16:13:22Z", "message": "Fix checkstyle issues\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMzM2ODUy", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-383336852", "createdAt": "2020-03-28T18:22:17Z", "commit": {"oid": "be3f002825fadf72ee71eb2bd0166c50d0a2642b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxODoyMjoxN1rOF9LVeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxODoyMjoxN1rOF9LVeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY5MzE3Nw==", "bodyText": "Exceptions should have \"Exception\" as their suffix, but I also think that you could give this a more generic name, like \"MissingSensorException\".", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r399693177", "createdAt": "2020-03-28T18:22:17Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/model/NoCurrentDrawSensor.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/**\n+ * Copyright (c) 2010-2020 Contributors to the openHAB project\n+ *\n+ * See the NOTICE file(s) distributed with this work for additional\n+ * information.\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.openhab.binding.opensprinkler.internal.model;\n+\n+/**\n+ * Indicates, that a device is missing a sensor to measure the current draw of itself.\n+ *\n+ * @author Florian Schmidt - Initial contribution\n+ */\n+public class NoCurrentDrawSensor extends Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be3f002825fadf72ee71eb2bd0166c50d0a2642b"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc40ab2725c7412426b04d360f88ba5f41a4c56f", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/dc40ab2725c7412426b04d360f88ba5f41a4c56f", "committedDate": "2020-03-28T18:34:47Z", "message": "Comply with naming convention of exceptions\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MTU4Mzk4", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-384158398", "createdAt": "2020-03-30T19:21:12Z", "commit": {"oid": "dc40ab2725c7412426b04d360f88ba5f41a4c56f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxOToyMToxMlrOF94suA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxOTozMjo1MFrOF95GRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQzNjQwOA==", "bodyText": "Please move this logic to line 86, just before you would need to use it. No reason to create this variable without knowing if you need it or not.", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r400436408", "createdAt": "2020-03-30T19:21:12Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/handler/OpenSprinklerDeviceHandler.java", "diffHunk": "@@ -57,4 +72,29 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n         // nothing to do here\n     }\n \n+    @Override\n+    public void updateChannels() {\n+        ChannelUID currentDraw = new ChannelUID(thing.getUID(), \"currentDraw\");\n+        ThingBuilder thingBuilder = editThing();\n+        Channel currentDrawChannel = ChannelBuilder.create(currentDraw, \"Number:ElectricCurrent\")\n+                .withType(new ChannelTypeUID(BINDING_ID, SENSOR_CURRENT_DRAW)).withLabel(\"Current Draw\")\n+                .withDescription(\"Provides the current draw.\").build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc40ab2725c7412426b04d360f88ba5f41a4c56f"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ0Mjk0OQ==", "bodyText": "Is the current sensor something that can be added or removed in realtime or is it something intrinsic to the device itself? If it can't be changed in realtime it would be better to add the channel during handler initialization so it gets executed only once rather than every time channel values are updated.", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r400442949", "createdAt": "2020-03-30T19:32:50Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/handler/OpenSprinklerDeviceHandler.java", "diffHunk": "@@ -57,4 +72,29 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n         // nothing to do here\n     }\n \n+    @Override\n+    public void updateChannels() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc40ab2725c7412426b04d360f88ba5f41a4c56f"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "393233e6895452f1666ea4eb3b3dcd4537e2db87", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/393233e6895452f1666ea4eb3b3dcd4537e2db87", "committedDate": "2020-04-04T10:18:06Z", "message": "Register channel in initialize\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NjkxMzg5", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-387691389", "createdAt": "2020-04-04T11:28:48Z", "commit": {"oid": "393233e6895452f1666ea4eb3b3dcd4537e2db87"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMToyODo0OFrOGAxM_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMToyODo0OFrOGAxM_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ1OTMyNg==", "bodyText": "Since you never remove the channel, you could move this to the most upper level.\nif (thing.getChannel == null) {\n   try {\n       getApi.currentDraw();\n\n       ThingBuilder thingBuilder = editThing();\n       Channel currentDrawChannel = ...\n       thingBuilder.withChannel(currentDrawChannel);\n       updateThing(thingBuilder.build());\n   } catch (...) {\n      logger.debug(...);\n   }\n}", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r403459326", "createdAt": "2020-04-04T11:28:48Z", "author": {"login": "J-N-K"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/handler/OpenSprinklerDeviceHandler.java", "diffHunk": "@@ -68,21 +68,16 @@ protected void updateChannel(ChannelUID channel) {\n     }\n \n     @Override\n-    public void handleCommand(ChannelUID channelUID, Command command) {\n-        // nothing to do here\n-    }\n-\n-    @Override\n-    public void updateChannels() {\n+    public void initialize() {\n         ChannelUID currentDraw = new ChannelUID(thing.getUID(), \"currentDraw\");\n         ThingBuilder thingBuilder = editThing();\n-        Channel currentDrawChannel = ChannelBuilder.create(currentDraw, \"Number:ElectricCurrent\")\n-                .withType(new ChannelTypeUID(BINDING_ID, SENSOR_CURRENT_DRAW)).withLabel(\"Current Draw\")\n-                .withDescription(\"Provides the current draw.\").build();\n         try {\n             getApi().currentDraw();\n \n             if (thing.getChannel(currentDraw) == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "393233e6895452f1666ea4eb3b3dcd4537e2db87"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0428474430baae7f25d8e2082ba99655dc4527c", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/a0428474430baae7f25d8e2082ba99655dc4527c", "committedDate": "2020-04-04T17:08:08Z", "message": "Implement review comment\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NzMyODg0", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-387732884", "createdAt": "2020-04-04T20:39:08Z", "commit": {"oid": "a0428474430baae7f25d8e2082ba99655dc4527c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMDozOTowOFrOGA0j9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMDozOTowOFrOGA0j9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUxNDM1Ng==", "bodyText": "No need to edit until you know you might need to.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ThingBuilder thingBuilder = editThing();\n          \n          \n            \n                    if (thing.getChannel(currentDraw) == null) {\n          \n          \n            \n                        try {\n          \n          \n            \n                    if (thing.getChannel(currentDraw) == null) {\n          \n          \n            \n                        ThingBuilder thingBuilder = editThing();\n          \n          \n            \n                        try {", "url": "https://github.com/openhab/openhab-addons/pull/7178#discussion_r403514356", "createdAt": "2020-04-04T20:39:08Z", "author": {"login": "cpmeister"}, "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/handler/OpenSprinklerDeviceHandler.java", "diffHunk": "@@ -36,20 +46,51 @@ public OpenSprinklerDeviceHandler(Thing thing) {\n \n     @Override\n     protected void updateChannel(ChannelUID channel) {\n-        switch (channel.getIdWithoutGroup()) {\n-            case SENSOR_RAIN:\n-                try {\n+        try {\n+            switch (channel.getIdWithoutGroup()) {\n+                case SENSOR_RAIN:\n                     if (getApi().isRainDetected()) {\n                         updateState(channel, OnOffType.ON);\n                     } else {\n                         updateState(channel, OnOffType.OFF);\n                     }\n-                } catch (CommunicationApiException e) {\n-                    logger.debug(\"Could not update rainsensor\", e);\n+                    break;\n+                case SENSOR_CURRENT_DRAW:\n+                    updateState(channel,\n+                            new QuantityType<ElectricCurrent>(getApi().currentDraw(), MILLI(SmartHomeUnits.AMPERE)));\n+                    break;\n+                default:\n+                    logger.debug(\"Not updating unknown channel {}\", channel);\n+            }\n+        } catch (CommunicationApiException | NoCurrentDrawSensorException e) {\n+            logger.debug(\"Could not update {}\", channel, e);\n+        }\n+    }\n+\n+    @Override\n+    public void initialize() {\n+        ChannelUID currentDraw = new ChannelUID(thing.getUID(), \"currentDraw\");\n+        ThingBuilder thingBuilder = editThing();\n+        if (thing.getChannel(currentDraw) == null) {\n+            try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0428474430baae7f25d8e2082ba99655dc4527c"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa02943c0b5e94caffc9e7bcd123a356a17ec991", "author": {"user": {"login": "FlorianSW", "name": "Florian"}}, "url": "https://github.com/openhab/openhab-addons/commit/fa02943c0b5e94caffc9e7bcd123a356a17ec991", "committedDate": "2020-04-25T16:06:37Z", "message": "IMplement review comment\n\nSigned-off-by: Florian <florian.schmidt.welzow@t-online.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDE5OTgy", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-400419982", "createdAt": "2020-04-25T18:35:41Z", "commit": {"oid": "fa02943c0b5e94caffc9e7bcd123a356a17ec991"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDIxMTcz", "url": "https://github.com/openhab/openhab-addons/pull/7178#pullrequestreview-400421173", "createdAt": "2020-04-25T18:50:05Z", "commit": {"oid": "fa02943c0b5e94caffc9e7bcd123a356a17ec991"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1182, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}