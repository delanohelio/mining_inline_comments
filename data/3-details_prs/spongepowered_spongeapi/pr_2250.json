{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2ODgzMDM0", "number": 2250, "title": "API8 DataStores", "bodyText": "SpongeAPI | SpongeCommon\nDataStores can now be built for\n\ncustom data (saved under \"ForgeData.SpongeData.CustomManipulators\") which is what plugins should use\nor\nvanilla data (saved on the root dataview corresponding the base CompoundNBT) which is used by Sponge to set data on Archetypes and Snapshots\n\nThe DataStoreBuilder features Steps forcing you to call required builder methods at least once.\nAdds convenience methods for building very simple dataregistration & datastores.\nA dataregistration for a String value on an ItemStack is now as simple as:\n        this.mySimpleDataKey = Key.of(this.plugin, \"mysimpledata\", TypeTokens.STRING_VALUE_TOKEN);\n        event.register(DataRegistration.of(this.mySimpleDataKey, ItemStack.class));", "createdAt": "2020-10-20T15:04:04Z", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2250", "merged": true, "mergeCommit": {"oid": "1d1c70a37d779570fcc239bf3b23005b9b1970c5"}, "closed": true, "closedAt": "2020-10-31T23:12:48Z", "author": {"login": "Faithcaio"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVQLa6AFqTUxNTM2NTc4NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYCTStABqjM5NDQ1MTg1NzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MzY1Nzg1", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2250#pullrequestreview-515365785", "createdAt": "2020-10-23T06:00:36Z", "commit": {"oid": "a628398dac00f405a269fe766f8159a23a696976"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjowMDozNlrOHm_FxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjowMDozNlrOHm_FxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY0MTYwNA==", "bodyText": "Are you intending to be able to call DataRegistration.of(Keys.FOO)? because the varargs can have a length of 0 by omitting the argument altogether in this case (this is why Cause historically always had an Object, Object... method signature, to ensure there's at least one argument passed in.", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2250#discussion_r510641604", "createdAt": "2020-10-23T06:00:36Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/api/data/DataRegistration.java", "diffHunk": "@@ -118,6 +120,21 @@ static Builder builder() {\n      */\n     PluginContainer getPluginContainer();\n \n+    /**\n+     * Creates a DataRegistration for a single key with a DataStore for given data-holders.\n+     *\n+     *\n+     * @param key the data key\n+     * @param dataHolders the data-holders\n+     * @param <T> the keys value type\n+     *\n+     * @return The built data registration\n+     */\n+    static <T> DataRegistration of(Key<Value<T>> key, Class<? extends DataHolder>... dataHolders) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a628398dac00f405a269fe766f8159a23a696976"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MzY2NjU5", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2250#pullrequestreview-515366659", "createdAt": "2020-10-23T06:03:03Z", "commit": {"oid": "a628398dac00f405a269fe766f8159a23a696976"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjowMzowM1rOHm_PTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjowMzowM1rOHm_PTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY0NDA0NQ==", "bodyText": "Much like the comment above, may want to mention that the varargs of types is optional to specify what types the datastore will support?", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2250#discussion_r510644045", "createdAt": "2020-10-23T06:03:03Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/api/data/persistence/DataStore.java", "diffHunk": "@@ -115,18 +117,36 @@ default DataView serialize(DataManipulator dataManipulator) {\n      * Provides a {@link DataStore} for a single {@link Key}.\n      * <p>\n      *     Note that default deserializers do not support {@link Collection}, {@link Map} or Array types!\n-     *     Use {@link Builder#key(Key, BiConsumer, Function)} for these.\n+     *     Use {@link Builder.SerializersStep#key(Key, BiConsumer, Function)} for these.\n      * </p>\n      *\n      * @param key The data key\n      * @param dataQuery The dataQuery to serialize this key under\n-     * @param typeToken The dataHolder type\n+     * @param typeTokens The dataHolder types\n      *\n      * @return The new data store\n      */\n     @SafeVarargs\n-    static <T> DataStore of(Key<Value<T>> key, DataQuery dataQuery, TypeToken<? extends DataHolder>... typeToken) {\n-        return builder().key(key, dataQuery).holder(typeToken).build();\n+    static <T> DataStore of(Key<Value<T>> key, DataQuery dataQuery, TypeToken<? extends DataHolder>... typeTokens) {\n+        return builder().pluginData(key.getKey()).holder(typeTokens).key(key, dataQuery).build();\n+    }\n+\n+    /**\n+     * Provides a {@link DataStore} for a single {@link Key}.\n+     * <p>\n+     *     Note that default deserializers do not support {@link Collection}, {@link Map} or Array types!\n+     *     Use {@link Builder.SerializersStep#key(Key, BiConsumer, Function)} for these.\n+     * </p>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a628398dac00f405a269fe766f8159a23a696976"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MzY3MDQ3", "url": "https://github.com/SpongePowered/SpongeAPI/pull/2250#pullrequestreview-515367047", "createdAt": "2020-10-23T06:04:01Z", "commit": {"oid": "a628398dac00f405a269fe766f8159a23a696976"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a628398dac00f405a269fe766f8159a23a696976", "author": {"user": {"login": "Faithcaio", "name": "Faithcaio"}}, "url": "https://github.com/SpongePowered/SpongeAPI/commit/a628398dac00f405a269fe766f8159a23a696976", "committedDate": "2020-10-20T14:57:27Z", "message": "adjust DataRegistrations for impl\nDataStore builder with Steps\nAdded convenience methods"}, "afterCommit": {"oid": "0e8cecc7cfc2751b692f053d72cb4f686aca573f", "author": {"user": {"login": "Faithcaio", "name": "Faithcaio"}}, "url": "https://github.com/SpongePowered/SpongeAPI/commit/0e8cecc7cfc2751b692f053d72cb4f686aca573f", "committedDate": "2020-10-24T11:03:28Z", "message": "adjust DataRegistrations for impl\nDataStore builder with Steps\nAdded convenience methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a2ff2b96c348a4a573c92dc99267d804137c00d", "author": {"user": {"login": "Faithcaio", "name": "Faithcaio"}}, "url": "https://github.com/SpongePowered/SpongeAPI/commit/8a2ff2b96c348a4a573c92dc99267d804137c00d", "committedDate": "2020-10-31T21:28:23Z", "message": "adjust DataRegistrations for impl\nDataStore builder with Steps\nAdded convenience methods"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0e8cecc7cfc2751b692f053d72cb4f686aca573f", "author": {"user": {"login": "Faithcaio", "name": "Faithcaio"}}, "url": "https://github.com/SpongePowered/SpongeAPI/commit/0e8cecc7cfc2751b692f053d72cb4f686aca573f", "committedDate": "2020-10-24T11:03:28Z", "message": "adjust DataRegistrations for impl\nDataStore builder with Steps\nAdded convenience methods"}, "afterCommit": {"oid": "8a2ff2b96c348a4a573c92dc99267d804137c00d", "author": {"user": {"login": "Faithcaio", "name": "Faithcaio"}}, "url": "https://github.com/SpongePowered/SpongeAPI/commit/8a2ff2b96c348a4a573c92dc99267d804137c00d", "committedDate": "2020-10-31T21:28:23Z", "message": "adjust DataRegistrations for impl\nDataStore builder with Steps\nAdded convenience methods"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 704, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}