{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0NjUyNzIz", "number": 5094, "title": "[LE] Add timing to additional endpoints", "bodyText": "Goals (and why):\nThere are two other responses that already have a leader ID as part of the response. I figured that we may as well get metrics on these endpoints too.\nImplementation Description (bullets):\n\nExtracted the leader ID from leaderTime and refreshLocks.\n\nTesting (What was existing testing like?  What have you done to improve it?):\n\nAdded tests to confirm that all methods that we intend are being timed.\n\nConcerns (what feedback would you like?):\n\nThis should not affect performance - right?\n\nWhere should we start reviewing?:\n\nLeaderElectionReportingTimelockService\n\nPriority (whenever / two weeks / yesterday):\nToday", "createdAt": "2020-11-03T10:59:00Z", "url": "https://github.com/palantir/atlasdb/pull/5094", "merged": true, "mergeCommit": {"oid": "85a0a797fe52905fbc9eda603deef0145163ae20"}, "closed": true, "closedAt": "2020-11-03T11:41:55Z", "author": {"login": "Jolyon-S"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYlaNcAH2gAyNTE0NjUyNzIzOmE5MzhiNjVmYzlkMzIyODAyNmU0OThmZDY3MGU3ZTBmMjU4NDI4NGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY3bMdAFqTUyMjQwMzYxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a938b65fc9d3228026e498fd670e7e0f2584284b", "author": {"user": {"login": "Jolyon-S", "name": "Jolyon"}}, "url": "https://github.com/palantir/atlasdb/commit/a938b65fc9d3228026e498fd670e7e0f2584284b", "committedDate": "2020-11-02T14:26:32Z", "message": "add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "462f295aa8c91499ff85d72dc52bb1d145ec0260", "author": {"user": {"login": "Jolyon-S", "name": "Jolyon"}}, "url": "https://github.com/palantir/atlasdb/commit/462f295aa8c91499ff85d72dc52bb1d145ec0260", "committedDate": "2020-11-02T14:31:41Z", "message": "temp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d9e7abc1520b8b7a0ba9e87b63c55c3b3323d1b", "author": {"user": {"login": "Jolyon-S", "name": "Jolyon"}}, "url": "https://github.com/palantir/atlasdb/commit/0d9e7abc1520b8b7a0ba9e87b63c55c3b3323d1b", "committedDate": "2020-11-03T10:55:50Z", "message": "spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5748c09c6acc474cd38c4a0ea5d835254217b5d2", "author": {"user": {"login": "Jolyon-S", "name": "Jolyon"}}, "url": "https://github.com/palantir/atlasdb/commit/5748c09c6acc474cd38c4a0ea5d835254217b5d2", "committedDate": "2020-11-03T10:58:28Z", "message": "Merge branch 'develop' into le/extra-timing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5d7783a25fb03d844e00fce3fb6e71e92a11755", "author": {"user": {"login": "Jolyon-S", "name": "Jolyon"}}, "url": "https://github.com/palantir/atlasdb/commit/b5d7783a25fb03d844e00fce3fb6e71e92a11755", "committedDate": "2020-11-03T10:58:28Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMzg3MjAx", "url": "https://github.com/palantir/atlasdb/pull/5094#pullrequestreview-522387201", "createdAt": "2020-11-03T11:01:55Z", "commit": {"oid": "b5d7783a25fb03d844e00fce3fb6e71e92a11755"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMTowMTo1NVrOHspxxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMTowMTo1NVrOHspxxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU4Mzg3Ng==", "bodyText": "the method to create from a UUID is not public.", "url": "https://github.com/palantir/atlasdb/pull/5094#discussion_r516583876", "createdAt": "2020-11-03T11:01:55Z", "author": {"login": "Jolyon-S"}, "path": "lock-api/src/test/java/com/palantir/lock/client/LeaderElectionReportingTimelockServiceTest.java", "diffHunk": "@@ -49,13 +55,17 @@\n import org.mockito.stubbing.OngoingStubbing;\n \n public class LeaderElectionReportingTimelockServiceTest {\n-    private static final UUID LEADER_1 = UUID.randomUUID();\n+    private static final LeaderTime LEADER_1_TIME = LeaderTime.of(LeadershipId.random(), NanoTime.createForTests(999L));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5d7783a25fb03d844e00fce3fb6e71e92a11755"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNDAzNjE3", "url": "https://github.com/palantir/atlasdb/pull/5094#pullrequestreview-522403617", "createdAt": "2020-11-03T11:25:41Z", "commit": {"oid": "b5d7783a25fb03d844e00fce3fb6e71e92a11755"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMToyNTo0MVrOHsqkRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMToyNTo0MVrOHsqkRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5NjgwNQ==", "bodyText": "a bit leaky, but I don't really have a better suggestion.", "url": "https://github.com/palantir/atlasdb/pull/5094#discussion_r516596805", "createdAt": "2020-11-03T11:25:41Z", "author": {"login": "jeremyk-91"}, "path": "lock-api/src/test/java/com/palantir/lock/client/LeaderElectionReportingTimelockServiceTest.java", "diffHunk": "@@ -302,6 +335,11 @@ public void detectWhenOldLeaderBecomesLongTerm() {\n         assertExpectedDuration(Instant.ofEpochMilli(3L), Instant.ofEpochMilli(15L));\n     }\n \n+    private void verifyEndpointRunsWithTiming(Runnable endpointCall) {\n+        endpointCall.run();\n+        verify(mockedClock, times(2)).instant();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5d7783a25fb03d844e00fce3fb6e71e92a11755"}, "originalPosition": 87}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2470, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}