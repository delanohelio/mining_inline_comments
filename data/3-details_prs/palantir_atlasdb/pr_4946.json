{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3OTg3NjQx", "number": 4946, "title": "Make PingResult java serializable", "bodyText": "Goals (and why):\nMake PingResult java serializable\nImplementation Description (bullets):\nN/A\nTesting (What was existing testing like?  What have you done to improve it?):\nN/A\nConcerns (what feedback would you like?):\nN/A\nWhere should we start reviewing?:\nSmall\nPriority (whenever / two weeks / yesterday):\nToday", "createdAt": "2020-08-14T13:34:33Z", "url": "https://github.com/palantir/atlasdb/pull/4946", "merged": true, "mergeCommit": {"oid": "9bd2c878f4b9c56598c2c300ac6d3ee9e87f0d05"}, "closed": true, "closedAt": "2020-08-17T10:40:45Z", "author": {"login": "sudiksha27"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-0sqZAH2gAyNDY3OTg3NjQxOjBiYzZmNzg0ZGMxZmNjYjY1N2QzYjEwM2QxZWZlY2RlMjZiODM5MTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-3RzugH2gAyNDY3OTg3NjQxOjllNjE5MDJlNWYxZmJkMWIwNzc0YWE1ZDczMjQ3YTk2ZGVlYTk0OGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0bc6f784dc1fccb657d3b103d1efecde26b83916", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/0bc6f784dc1fccb657d3b103d1efecde26b83916", "committedDate": "2020-08-14T13:33:14Z", "message": "Make PingResult java serializable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92bfde3a2f0537972bf8da1f2296d7b91cc2598d", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/92bfde3a2f0537972bf8da1f2296d7b91cc2598d", "committedDate": "2020-08-14T13:33:14Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3NjAxNzAz", "url": "https://github.com/palantir/atlasdb/pull/4946#pullrequestreview-467601703", "createdAt": "2020-08-14T14:04:54Z", "commit": {"oid": "92bfde3a2f0537972bf8da1f2296d7b91cc2598d"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "511af06b8752dedaaa5f73deac6cdc2673ebb848", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/511af06b8752dedaaa5f73deac6cdc2673ebb848", "committedDate": "2020-08-14T15:10:36Z", "message": "Test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/afaec9a96d2b78d230b8ac38e0335b397cb1cb73", "committedDate": "2020-08-14T15:11:29Z", "message": "Merge branch 'pingv2_fix' of github.com:palantir/atlasdb into pingv2_fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3NzA1MDg0", "url": "https://github.com/palantir/atlasdb/pull/4946#pullrequestreview-467705084", "createdAt": "2020-08-14T16:19:38Z", "commit": {"oid": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQxNjoxOTozOFrOHA6t-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQxNjoxOTo1M1rOHA6uYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDcyNDA5MA==", "bodyText": "Please use try-with-resources:\ntry (FileOutputStream fileOut = new FileOutputStream(...); \n        <same for ObjectOutputStream>) {\n   ...\n}", "url": "https://github.com/palantir/atlasdb/pull/4946#discussion_r470724090", "createdAt": "2020-08-14T16:19:38Z", "author": {"login": "jeremyk-91"}, "path": "leader-election-impl/src/test/java/com/palantir/leader/PingResultTest.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.leader;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n+import java.util.Optional;\n+\n+import org.junit.Test;\n+\n+import com.palantir.sls.versions.OrderableSlsVersion;\n+\n+public class PingResultTest {\n+    @Test\n+    public void pingResultIsJavaSerializable() throws IOException, ClassNotFoundException {\n+        OrderableSlsVersion timeLockVersion = OrderableSlsVersion.valueOf(\"0.0.0\");\n+        PingResult pr = PingResult.builder().timeLockVersion(timeLockVersion)\n+                .isLeader(true).build();\n+        FileOutputStream fileOut = new FileOutputStream(\"test.ser\");\n+        ObjectOutputStream out = new ObjectOutputStream(fileOut);\n+        out.writeObject(pr);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDcyNDE5Mg==", "bodyText": "nit: Can we use a temporary folder so the file isn't lying around?", "url": "https://github.com/palantir/atlasdb/pull/4946#discussion_r470724192", "createdAt": "2020-08-14T16:19:53Z", "author": {"login": "jeremyk-91"}, "path": "leader-election-impl/src/test/java/com/palantir/leader/PingResultTest.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.leader;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n+import java.util.Optional;\n+\n+import org.junit.Test;\n+\n+import com.palantir.sls.versions.OrderableSlsVersion;\n+\n+public class PingResultTest {\n+    @Test\n+    public void pingResultIsJavaSerializable() throws IOException, ClassNotFoundException {\n+        OrderableSlsVersion timeLockVersion = OrderableSlsVersion.valueOf(\"0.0.0\");\n+        PingResult pr = PingResult.builder().timeLockVersion(timeLockVersion)\n+                .isLeader(true).build();\n+        FileOutputStream fileOut = new FileOutputStream(\"test.ser\");\n+        ObjectOutputStream out = new ObjectOutputStream(fileOut);\n+        out.writeObject(pr);\n+        out.close();\n+        fileOut.close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1465c0a86cfde87289fe98b83b29bf952005463", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/a1465c0a86cfde87289fe98b83b29bf952005463", "committedDate": "2020-08-14T16:27:47Z", "message": "Fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ca294ac70696c25efe96616f52b9bfa71f2365d", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/0ca294ac70696c25efe96616f52b9bfa71f2365d", "committedDate": "2020-08-14T16:30:04Z", "message": "clean"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3NzEzMjk4", "url": "https://github.com/palantir/atlasdb/pull/4946#pullrequestreview-467713298", "createdAt": "2020-08-14T16:32:28Z", "commit": {"oid": "0ca294ac70696c25efe96616f52b9bfa71f2365d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQxNjozMjoyOFrOHA7HgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQxNjozMjoyOFrOHA7HgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDczMDYyNA==", "bodyText": "note: if this was production code, you'd probably want to minimise the scopes of out and in. I'm fine with this for tests.", "url": "https://github.com/palantir/atlasdb/pull/4946#discussion_r470730624", "createdAt": "2020-08-14T16:32:28Z", "author": {"login": "jeremyk-91"}, "path": "leader-election-impl/src/test/java/com/palantir/leader/PingResultTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.leader;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n+import java.util.Optional;\n+\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+\n+import com.palantir.sls.versions.OrderableSlsVersion;\n+\n+public class PingResultTest {\n+\n+    @Rule\n+    public TemporaryFolder tempFolder = new TemporaryFolder();\n+\n+    @Test\n+    public void pingResultIsJavaSerializable() throws IOException, ClassNotFoundException {\n+        OrderableSlsVersion timeLockVersion = OrderableSlsVersion.valueOf(\"0.27.0\");\n+        PingResult pr = PingResult.builder().timeLockVersion(timeLockVersion)\n+                .isLeader(true).build();\n+\n+        File file = tempFolder.newFile();\n+        try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(file));\n+                ObjectInputStream in = new ObjectInputStream(new FileInputStream(file))) {\n+            out.writeObject(pr);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca294ac70696c25efe96616f52b9bfa71f2365d"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e61902e5f1fbd1b0774aa5d73247a96deea948b", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/9e61902e5f1fbd1b0774aa5d73247a96deea948b", "committedDate": "2020-08-14T16:33:37Z", "message": "clean"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2796, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}