{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MjUyNDc4", "number": 4583, "title": "Remove targeted sweep rate limiting from Timelock.", "bodyText": "Goals (and why):\nWe introduced targeted sweep lock rate limiting in timelock to stem the bleeding from a bad configuration change. #4096 #4110 and #4115. Now that we've remediated, we should get rid of it, especially as it can consume resources (albeit not very much) but the point still stands.\nImplementation Description (bullets):\nToo many conflicts when reverting, so I just deleted all references to anything TargetedSweepAsyncLock etc.\nTesting (What was existing testing like?  What have you done to improve it?):\nThis should be covered by existing tests.\nConcerns (what feedback would you like?):\nHave I fundamentally changed how locks work?\nWhere should we start reviewing?:\nAnywhere, mostly deletes.\nPriority (whenever / two weeks / yesterday):\nAt some point this week.", "createdAt": "2020-02-17T17:38:14Z", "url": "https://github.com/palantir/atlasdb/pull/4583", "merged": true, "mergeCommit": {"oid": "5e472fb540fec3d7740b2d9ead49277d099e8805"}, "closed": true, "closedAt": "2020-02-17T17:55:21Z", "author": {"login": "felixdesouza"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFQ3CZAH2gAyMzc2MjUyNDc4OmMwZjA0MjQ3YTdmY2ZlNDlkMzFiMTllZjFkOGZkYTQ1MzUwY2IzM2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFRJvqAFqTM1OTg5ODU0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c0f04247a7fcfe49d31b19ef1d8fda45350cb33b", "author": {"user": {"login": "felixdesouza", "name": "Felix de Souza"}}, "url": "https://github.com/palantir/atlasdb/commit/c0f04247a7fcfe49d31b19ef1d8fda45350cb33b", "committedDate": "2020-02-17T17:34:18Z", "message": "Remove targeted sweep rate limiting from Timelock."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88a8f9d3d7f2b8e2340beda9a09fb867315a7b65", "author": {"user": {"login": "felixdesouza", "name": "Felix de Souza"}}, "url": "https://github.com/palantir/atlasdb/commit/88a8f9d3d7f2b8e2340beda9a09fb867315a7b65", "committedDate": "2020-02-17T17:34:18Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5ODk4NTQ1", "url": "https://github.com/palantir/atlasdb/pull/4583#pullrequestreview-359898545", "createdAt": "2020-02-17T17:52:59Z", "commit": {"oid": "88a8f9d3d7f2b8e2340beda9a09fb867315a7b65"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNzo1Mjo1OVrOFqsX4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNzo1NDozMFrOFqsZzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDMxMTUyMQ==", "bodyText": "\ud83d\udcaf", "url": "https://github.com/palantir/atlasdb/pull/4583#discussion_r380311521", "createdAt": "2020-02-17T17:52:59Z", "author": {"login": "jeremyk-91"}, "path": "timelock-agent/src/main/java/com/palantir/timelock/config/TimeLockRuntimeConfiguration.java", "diffHunk": "@@ -30,6 +30,7 @@\n @JsonDeserialize(as = ImmutableTimeLockRuntimeConfiguration.class)\n @JsonSerialize(as = ImmutableTimeLockRuntimeConfiguration.class)\n @Value.Immutable\n+@JsonIgnoreProperties(\"targeted-sweep-locks\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88a8f9d3d7f2b8e2340beda9a09fb867315a7b65"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDMxMjAxMw==", "bodyText": "sanity checked this matches the world before #4096", "url": "https://github.com/palantir/atlasdb/pull/4583#discussion_r380312013", "createdAt": "2020-02-17T17:54:30Z", "author": {"login": "jeremyk-91"}, "path": "timelock-impl/src/main/java/com/palantir/atlasdb/timelock/lock/LockCollection.java", "diffHunk": "@@ -45,7 +43,7 @@ public OrderedLocks getAll(Set<LockDescriptor> descriptors) {\n             locks.add(getLock(descriptor));\n         }\n \n-        return locksDecorator.decorate(orderedDescriptors, locks);\n+        return OrderedLocks.fromOrderedList(locks);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88a8f9d3d7f2b8e2340beda9a09fb867315a7b65"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2262, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}