{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5NTQyNjQz", "number": 4737, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNjozNzo0OFrOD2yGlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNjo0MDoyNlrOD2yLxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NzcwNTgwOnYy", "diffSide": "RIGHT", "path": "leader-election-api/src/main/java/com/palantir/paxos/PaxosStateLog.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNjozNzo0OFrOGMsyvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNjozNzo0OFrOGMsyvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk2OTk4Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                default void writeBatchOfRounds(Iterable<PaxosRound<V>> rounds) {\n          \n          \n            \n                /**\n          \n          \n            \n                 * Implementations of this method MUST obey the following:\n          \n          \n            \n                 * 1) The end state of the log should be equivalent to applying the operations in \n          \n          \n            \n                 *    iteration order.\n          \n          \n            \n                 * 2) Implementations need not be atomic. However, if they fail, they should apply only\n          \n          \n            \n                 *    prefixes of the input iterable.\n          \n          \n            \n                 */\n          \n          \n            \n                default void writeBatchOfRounds(Iterable<PaxosRound<V>> rounds) {", "url": "https://github.com/palantir/atlasdb/pull/4737#discussion_r415969983", "createdAt": "2020-04-27T16:37:48Z", "author": {"login": "jeremyk-91"}, "path": "leader-election-api/src/main/java/com/palantir/paxos/PaxosStateLog.java", "diffHunk": "@@ -33,6 +33,10 @@\n      */\n     void writeRound(long seq, V round);\n \n+    default void writeBatchOfRounds(Iterable<PaxosRound<V>> rounds) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bba27db26f00241b1714126bb42a190768c94e53"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NzcxOTA5OnYy", "diffSide": "RIGHT", "path": "leader-election-impl/src/main/java/com/palantir/paxos/SqlitePaxosStateLog.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNjo0MDoyNlrOGMs6cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNjo0MDoyNlrOGMs6cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk3MTk1Mw==", "bodyText": "Discussed why this must be boolean[] offline: required because of the signature of execute()", "url": "https://github.com/palantir/atlasdb/pull/4737#discussion_r415971953", "createdAt": "2020-04-27T16:40:26Z", "author": {"login": "jeremyk-91"}, "path": "leader-election-impl/src/main/java/com/palantir/paxos/SqlitePaxosStateLog.java", "diffHunk": "@@ -100,5 +109,9 @@ public void truncate(long toDeleteInclusive) {\n \n         @SqlUpdate(\"DELETE FROM <table> WHERE seq <= :seq\")\n         boolean truncate(@Define(\"table\") String table, @Bind(\"seq\") long seq);\n+\n+        @SqlBatch(\"INSERT OR REPLACE INTO <table> (seq, val) VALUES (:round.sequence, :round.valueBytes)\")\n+        <V extends Persistable & Versionable> boolean[] writeBatchOfRounds(@Define(\"table\") String table,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bba27db26f00241b1714126bb42a190768c94e53"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3093, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}