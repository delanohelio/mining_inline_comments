{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MTY5MTQ2", "number": 4863, "title": "Local and remote health pinger", "bodyText": "Goals (and why):\nThe TimeLock client feedback resource should only process feedback for clients for which it is the leader.\nImplementation Description (bullets):\n\nSegregate health check pingers into local and remote components.\n\nTesting (What was existing testing like?  What have you done to improve it?):\nExisting tests should suffice\nConcerns (what feedback would you like?):\nIs the wiring correct?\nWhere should we start reviewing?:\nTimeLockAgent\nPriority (whenever / two weeks / yesterday):\nToday", "createdAt": "2020-06-24T12:16:37Z", "url": "https://github.com/palantir/atlasdb/pull/4863", "merged": true, "mergeCommit": {"oid": "1a9ce282741c8f5c1e592170f72bc11d2978d8d3"}, "closed": true, "closedAt": "2020-06-24T19:15:44Z", "author": {"login": "sudiksha27"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuY4FpgH2gAyNDM5MTY5MTQ2OmZjNDJiNDYwZTExN2U4ZDAzMTMzNWRlYTc2MmIxZDljZWUyNjIzZGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcud59QgH2gAyNDM5MTY5MTQ2OmFlOWUxMjMzMTA0NjhmMmUzMGNjZjU1ZDBlN2JjOGZhOGMyN2E2OTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc42b460e117e8d031335dea762b1d9cee2623de", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/fc42b460e117e8d031335dea762b1d9cee2623de", "committedDate": "2020-06-24T12:05:35Z", "message": "Local and remote health pinger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "357284a838caa9ad91860b442e975fdf73f08a70", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/357284a838caa9ad91860b442e975fdf73f08a70", "committedDate": "2020-06-24T12:16:23Z", "message": "clean up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d659b413653ade6c83ba0615a3d050c3799824b", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/3d659b413653ade6c83ba0615a3d050c3799824b", "committedDate": "2020-06-24T12:33:12Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a1caf4c6ec0914565a688e337d8e60f966401ed", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/7a1caf4c6ec0914565a688e337d8e60f966401ed", "committedDate": "2020-06-24T12:45:57Z", "message": "minor refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e6fb7e76c079acd1e1179e45004cbb1a6385dda", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/5e6fb7e76c079acd1e1179e45004cbb1a6385dda", "committedDate": "2020-06-24T14:50:08Z", "message": "Minor refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74820aacaa40c6e66957cb2348567fb2f36eb1c4", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/74820aacaa40c6e66957cb2348567fb2f36eb1c4", "committedDate": "2020-06-24T14:51:13Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebd6a87e8971518b2134b08bd2eeb41c9ef85a3f", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/ebd6a87e8971518b2134b08bd2eeb41c9ef85a3f", "committedDate": "2020-06-24T14:51:13Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6a3282082e0281307153ce7f00fda9ca2204a69", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/a6a3282082e0281307153ce7f00fda9ca2204a69", "committedDate": "2020-06-24T14:51:13Z", "message": "remove todo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75456992f854af9e98c40c84b9acaf7568f2adb8", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/75456992f854af9e98c40c84b9acaf7568f2adb8", "committedDate": "2020-06-24T14:51:13Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2ODQ0MjEw", "url": "https://github.com/palantir/atlasdb/pull/4863#pullrequestreview-436844210", "createdAt": "2020-06-24T17:08:43Z", "commit": {"oid": "75456992f854af9e98c40c84b9acaf7568f2adb8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNzowODo0NFrOGobY7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNzowODo0NFrOGobY7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0NDk3Mw==", "bodyText": "nit: Predicate<Client> avoids boxing/generics overheads, and I'd argue is more descriptive here", "url": "https://github.com/palantir/atlasdb/pull/4863#discussion_r445044973", "createdAt": "2020-06-24T17:08:44Z", "author": {"login": "jeremyk-91"}, "path": "timelock-impl/src/main/java/com/palantir/atlasdb/timelock/adjudicate/TimeLockClientFeedbackResource.java", "diffHunk": "@@ -16,35 +16,42 @@\n \n package com.palantir.atlasdb.timelock.adjudicate;\n \n+import java.util.function.Function;\n+\n import com.google.common.util.concurrent.Futures;\n import com.google.common.util.concurrent.ListenableFuture;\n import com.palantir.atlasdb.timelock.adjudicate.feedback.TimeLockClientFeedbackService;\n import com.palantir.atlasdb.timelock.adjudicate.feedback.TimeLockClientFeedbackServiceEndpoints;\n import com.palantir.atlasdb.timelock.adjudicate.feedback.UndertowTimeLockClientFeedbackService;\n import com.palantir.conjure.java.undertow.lib.UndertowService;\n+import com.palantir.paxos.Client;\n import com.palantir.timelock.feedback.ConjureTimeLockClientFeedback;\n import com.palantir.tokens.auth.AuthHeader;\n \n public class TimeLockClientFeedbackResource implements UndertowTimeLockClientFeedbackService {\n+    private Function<Client, Boolean> leadershipCheck;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75456992f854af9e98c40c84b9acaf7568f2adb8"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4deaf60ac9e5ec9882acced5b8d2af04a84749d5", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/4deaf60ac9e5ec9882acced5b8d2af04a84749d5", "committedDate": "2020-06-24T17:26:28Z", "message": "Remove comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a614634297b751737d1ce91b3b8c767646382b2", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/0a614634297b751737d1ce91b3b8c767646382b2", "committedDate": "2020-06-24T17:26:45Z", "message": "Merge branch 'feedback_sink_leadership' of github.com:palantir/atlasdb into feedback_sink_leadership"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae9e123310468f2e30ccf55d0e7bc8fa8c27a698", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/ae9e123310468f2e30ccf55d0e7bc8fa8c27a698", "committedDate": "2020-06-24T17:57:09Z", "message": "Address comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2695, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}