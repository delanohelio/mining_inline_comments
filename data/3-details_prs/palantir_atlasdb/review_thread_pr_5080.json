{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwMTA4Njk4", "number": 5080, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNzo0MzowMVrOEyBCAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDozNDozOFrOEyYlBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwODgxMTUyOnYy", "diffSide": "RIGHT", "path": "lock-api-objects/src/main/java/com/palantir/lock/LockRequest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNzo0MzowMVrOHobOtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxODo1ODo1MVrOHoeFpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1MTIyMA==", "bodyText": "I was a bit worried about this one because it could lead to fun times (if you deserialize something from the old version that has a different way of calculating the hash code and shove it into a set you have fun times), but think it's safe given that you can only create this through the serialization proxy, meaning that hash codes are always computed with the current JVM. I'd appreciate a double-check though.", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512151220", "createdAt": "2020-10-26T17:43:01Z", "author": {"login": "jeremyk-91"}, "path": "lock-api-objects/src/main/java/com/palantir/lock/LockRequest.java", "diffHunk": "@@ -200,15 +200,14 @@ public boolean equals(@Nullable Object obj) {\n                 && lockTimeout.equals(other.lockTimeout)\n                 && (lockGroupBehavior == other.lockGroupBehavior)\n                 && (blockingMode == other.blockingMode)\n-                && Objects.equal(blockingDuration, other.blockingDuration)\n-                && Objects.equal(versionId, other.versionId);\n+                && Objects.equals(blockingDuration, other.blockingDuration)\n+                && Objects.equals(versionId, other.versionId);\n     }\n \n     @Override\n     public int hashCode() {\n         if (hashCode == null) {\n-            hashCode = Objects.hashCode(\n-                    lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);\n+            hashCode = Objects.hash(lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2MzM5Nw==", "bodyText": "I don\u2019t think we support java serialization across versions", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512163397", "createdAt": "2020-10-26T18:01:36Z", "author": {"login": "carterkozak"}, "path": "lock-api-objects/src/main/java/com/palantir/lock/LockRequest.java", "diffHunk": "@@ -200,15 +200,14 @@ public boolean equals(@Nullable Object obj) {\n                 && lockTimeout.equals(other.lockTimeout)\n                 && (lockGroupBehavior == other.lockGroupBehavior)\n                 && (blockingMode == other.blockingMode)\n-                && Objects.equal(blockingDuration, other.blockingDuration)\n-                && Objects.equal(versionId, other.versionId);\n+                && Objects.equals(blockingDuration, other.blockingDuration)\n+                && Objects.equals(versionId, other.versionId);\n     }\n \n     @Override\n     public int hashCode() {\n         if (hashCode == null) {\n-            hashCode = Objects.hashCode(\n-                    lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);\n+            hashCode = Objects.hash(lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1MTIyMA=="}, "originalCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE5NjE4NA==", "bodyText": "That said, the hashCode field on serializable objects should be transient, and there's no reason for it to be volatile.", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512196184", "createdAt": "2020-10-26T18:55:37Z", "author": {"login": "carterkozak"}, "path": "lock-api-objects/src/main/java/com/palantir/lock/LockRequest.java", "diffHunk": "@@ -200,15 +200,14 @@ public boolean equals(@Nullable Object obj) {\n                 && lockTimeout.equals(other.lockTimeout)\n                 && (lockGroupBehavior == other.lockGroupBehavior)\n                 && (blockingMode == other.blockingMode)\n-                && Objects.equal(blockingDuration, other.blockingDuration)\n-                && Objects.equal(versionId, other.versionId);\n+                && Objects.equals(blockingDuration, other.blockingDuration)\n+                && Objects.equals(versionId, other.versionId);\n     }\n \n     @Override\n     public int hashCode() {\n         if (hashCode == null) {\n-            hashCode = Objects.hashCode(\n-                    lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);\n+            hashCode = Objects.hash(lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1MTIyMA=="}, "originalCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE5ODA1NQ==", "bodyText": "Not sure why we're doing all this boxing/unboxing either. We should use an int with a sentinel value (zero) for the uninitialized case. Some objects may be unlucky, however the hashcode is relatively inexpensive to recompute.", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512198055", "createdAt": "2020-10-26T18:58:51Z", "author": {"login": "carterkozak"}, "path": "lock-api-objects/src/main/java/com/palantir/lock/LockRequest.java", "diffHunk": "@@ -200,15 +200,14 @@ public boolean equals(@Nullable Object obj) {\n                 && lockTimeout.equals(other.lockTimeout)\n                 && (lockGroupBehavior == other.lockGroupBehavior)\n                 && (blockingMode == other.blockingMode)\n-                && Objects.equal(blockingDuration, other.blockingDuration)\n-                && Objects.equal(versionId, other.versionId);\n+                && Objects.equals(blockingDuration, other.blockingDuration)\n+                && Objects.equals(versionId, other.versionId);\n     }\n \n     @Override\n     public int hashCode() {\n         if (hashCode == null) {\n-            hashCode = Objects.hashCode(\n-                    lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);\n+            hashCode = Objects.hash(lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1MTIyMA=="}, "originalCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMjY2OTUxOnYy", "diffSide": "RIGHT", "path": "atlasdb-api/src/main/java/com/palantir/atlasdb/keyvalue/api/Namespace.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDozNDozOFrOHo_fRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDo0MzoyOVrOHo_8aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc0NTI4Nw==", "bodyText": "This produces the same result as the previous implementation, which was effectively return Arrays.hashCode(new Object[] { name });", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512745287", "createdAt": "2020-10-27T14:34:38Z", "author": {"login": "carterkozak"}, "path": "atlasdb-api/src/main/java/com/palantir/atlasdb/keyvalue/api/Namespace.java", "diffHunk": "@@ -78,7 +78,7 @@ public String getName() {\n \n     @Override\n     public int hashCode() {\n-        return Objects.hashCode(name);\n+        return 31 + Objects.hashCode(name);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc1Mjc0NA==", "bodyText": "sigh. I don't know where we rely on this, of all things, but it looks like it actually makes the tests pass.", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512752744", "createdAt": "2020-10-27T14:43:29Z", "author": {"login": "jeremyk-91"}, "path": "atlasdb-api/src/main/java/com/palantir/atlasdb/keyvalue/api/Namespace.java", "diffHunk": "@@ -78,7 +78,7 @@ public String getName() {\n \n     @Override\n     public int hashCode() {\n-        return Objects.hashCode(name);\n+        return 31 + Objects.hashCode(name);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc0NTI4Nw=="}, "originalCommit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2444, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}