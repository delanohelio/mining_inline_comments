{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwNzE5NzI2", "number": 4955, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0NToxNFrOEacN2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0NToxNFrOEacN2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MTYwNzI4OnYy", "diffSide": "RIGHT", "path": "atlasdb-cassandra/src/main/java/com/palantir/atlasdb/keyvalue/cassandra/CassandraClientFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0NToxNVrOHD3-iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0NToxNVrOHD3-iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyNDkwNQ==", "bodyText": "Nice. I checked that we retain a reference to the SSL socket factory if you're using a TM with Cassandra. So we do actually want to clear this out quickly once unreferenced", "url": "https://github.com/palantir/atlasdb/pull/4955#discussion_r473824905", "createdAt": "2020-08-20T09:45:15Z", "author": {"login": "jeremyk-91"}, "path": "atlasdb-cassandra/src/main/java/com/palantir/atlasdb/keyvalue/cassandra/CassandraClientFactory.java", "diffHunk": "@@ -41,18 +39,24 @@\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n+import com.github.benmanes.caffeine.cache.Caffeine;\n+import com.github.benmanes.caffeine.cache.LoadingCache;\n import com.google.common.collect.Maps;\n import com.palantir.atlasdb.cassandra.CassandraCredentialsConfig;\n import com.palantir.atlasdb.cassandra.CassandraKeyValueServiceConfig;\n import com.palantir.atlasdb.util.AtlasDbMetrics;\n import com.palantir.atlasdb.util.MetricsManager;\n import com.palantir.common.exception.AtlasDbDependencyException;\n+import com.palantir.conjure.java.api.config.ssl.SslConfiguration;\n import com.palantir.conjure.java.config.ssl.SslSocketFactories;\n import com.palantir.logsafe.SafeArg;\n import com.palantir.logsafe.UnsafeArg;\n \n public class CassandraClientFactory extends BasePooledObjectFactory<CassandraClient> {\n     private static final Logger log = LoggerFactory.getLogger(CassandraClientFactory.class);\n+    private static final LoadingCache<SslConfiguration, SSLSocketFactory> sslSocketFactoryCache = Caffeine.newBuilder()\n+            .weakValues()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b6cbc77243b3a7281f47ecf66549883f91be99"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2806, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}