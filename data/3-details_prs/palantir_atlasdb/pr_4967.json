{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NTM0Mjgw", "number": 4967, "title": "B g fix", "bodyText": "Goals (and why):\nRate limit greening node's attempts to gain leadership.\nImplementation Description (bullets):\nAdded a rate limiter for above.\nTesting (What was existing testing like?  What have you done to improve it?):\nN/A\nConcerns (what feedback would you like?):\nIs there too much computation around ping endpoint?\nWhere should we start reviewing?:\nSmall\nPriority (whenever / two weeks / yesterday):\nAs soon as possible", "createdAt": "2020-08-28T17:11:07Z", "url": "https://github.com/palantir/atlasdb/pull/4967", "merged": true, "mergeCommit": {"oid": "5e0dda7d932782f7c84c3979e1e718ca1cbb208d"}, "closed": true, "closedAt": "2020-09-03T16:33:39Z", "author": {"login": "sudiksha27"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDYH-9gH2gAyNDc1NTM0MjgwOjBmY2NjNThjNGE0ZGQ2NDE2OTk0MmU0NThiZjJlMmIwMTY5YzU1NGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFShGTAFqTQ4MTk2ODE5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0fccc58c4a4dd64169942e458bf2e2b0169c554a", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/0fccc58c4a4dd64169942e458bf2e2b0169c554a", "committedDate": "2020-08-28T17:05:27Z", "message": "Rate limit greening node's attempts to become leader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "566b6afab8366e48b0d783cf04a49d4b1132b370", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/566b6afab8366e48b0d783cf04a49d4b1132b370", "committedDate": "2020-08-28T17:07:22Z", "message": "Remove"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "997ee85cddb4f434bd8105a59c5b927d4940ed08", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/997ee85cddb4f434bd8105a59c5b927d4940ed08", "committedDate": "2020-08-28T17:07:22Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e4c7b53ef0ed12dfd74cb93d3d92f6f52ec8919", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/4e4c7b53ef0ed12dfd74cb93d3d92f6f52ec8919", "committedDate": "2020-09-03T15:33:35Z", "message": "Fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e20c68b177127b1cfaf3bcbe0edc960f9267ca86", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/e20c68b177127b1cfaf3bcbe0edc960f9267ca86", "committedDate": "2020-09-03T15:33:51Z", "message": "Merge branch 'b-g-fix' of github.com:palantir/atlasdb into b-g-fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxOTYyNTI4", "url": "https://github.com/palantir/atlasdb/pull/4967#pullrequestreview-481962528", "createdAt": "2020-09-03T15:35:02Z", "commit": {"oid": "e20c68b177127b1cfaf3bcbe0edc960f9267ca86"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNTozNTowMlrOHMsU-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNTozNTowMlrOHMsU-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3MTIyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                () -> greeningNodeShouldBecomeLeaderRateLimiter.tryAcquire());\n          \n          \n            \n                                greeningNodeShouldBecomeLeaderRateLimiter::tryAcquire);", "url": "https://github.com/palantir/atlasdb/pull/4967#discussion_r483071225", "createdAt": "2020-09-03T15:35:02Z", "author": {"login": "jeremyk-91"}, "path": "leader-election-impl/src/main/java/com/palantir/paxos/SingleLeaderPinger.java", "diffHunk": "@@ -139,7 +142,10 @@ private LeaderPingResult actuallyPingLeaderWithUuid(\n             multiplexingCompletionService.submit(leader, pingEndpoint);\n             Future<Map.Entry<LeaderPingerContext<PingableLeader>, PingResult>> pingFuture\n                     = multiplexingCompletionService.poll(leaderPingResponseWait.toMillis(), TimeUnit.MILLISECONDS);\n-            return getLeaderPingResult(uuid, pingFuture, timeLockVersion);\n+            return getLeaderPingResult(uuid,\n+                    pingFuture,\n+                    timeLockVersion,\n+                    () -> greeningNodeShouldBecomeLeaderRateLimiter.tryAcquire());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e20c68b177127b1cfaf3bcbe0edc960f9267ca86"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a44cadd701a560fa80ff944ed907d72c757e09a", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/7a44cadd701a560fa80ff944ed907d72c757e09a", "committedDate": "2020-09-03T15:36:37Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa5cc6aae86429789ff531d3eaa0c9a80bfb5b1f", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/fa5cc6aae86429789ff531d3eaa0c9a80bfb5b1f", "committedDate": "2020-09-03T15:36:37Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85bd65eea25e94d530456bd1e7c864f046178892", "author": {"user": {"login": "sudiksha27", "name": "sudiksha nanda"}}, "url": "https://github.com/palantir/atlasdb/commit/85bd65eea25e94d530456bd1e7c864f046178892", "committedDate": "2020-09-03T15:36:37Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxOTY4MTk2", "url": "https://github.com/palantir/atlasdb/pull/4967#pullrequestreview-481968196", "createdAt": "2020-09-03T15:41:15Z", "commit": {"oid": "7a44cadd701a560fa80ff944ed907d72c757e09a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNTo0MToxNVrOHMsljQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNTo0MToxNVrOHMsljQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3NTQ2OQ==", "bodyText": "nit: I'd add why this was previously bad", "url": "https://github.com/palantir/atlasdb/pull/4967#discussion_r483075469", "createdAt": "2020-09-03T15:41:15Z", "author": {"login": "jeremyk-91"}, "path": "changelog/@unreleased/pr-4967.v2.yml", "diffHunk": "@@ -0,0 +1,5 @@\n+type: improvement\n+improvement:\n+  description: A greening node's attempts to gain leadership are now rate limited.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a44cadd701a560fa80ff944ed907d72c757e09a"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2549, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}