{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExNTg5ODg3", "number": 4745, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNzo1MVrOD4_NRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxNDowMzo0N1rOD5APFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDgyNDM5OnYy", "diffSide": "RIGHT", "path": "atlasdb-impl-shared/src/test/java/com/palantir/atlasdb/transaction/impl/SnapshotTransactionManagerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNzo1MVrOGQARjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzoyNzo1MVrOGQARjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQzNDg5NQ==", "bodyText": "nit: Could we rename this executor service to deleteExecutor (if that's what it's used for)?", "url": "https://github.com/palantir/atlasdb/pull/4745#discussion_r419434895", "createdAt": "2020-05-04T13:27:51Z", "author": {"login": "jeremyk-91"}, "path": "atlasdb-impl-shared/src/test/java/com/palantir/atlasdb/transaction/impl/SnapshotTransactionManagerTest.java", "diffHunk": "@@ -118,6 +118,12 @@ public void closesCloseableLockServiceOnClosingTransactionManager() throws IOExc\n         verify(closeableLockService, times(1)).close();\n     }\n \n+    @Test\n+    public void closesDeleteExecutorOnClosingTransactionManager() {\n+        snapshotTransactionManager.close();\n+        assertThat(executorService.isTerminated()).isTrue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4fb9257a483a96e3640e99ec4dbb15ca8bd01da"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDk5Mjg0OnYy", "diffSide": "RIGHT", "path": "atlasdb-impl-shared/src/main/java/com/palantir/atlasdb/transaction/impl/SnapshotTransactionManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxNDowMzo0N1rOGQB13A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwODoyNjo1OVrOGQfTGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQ2MDU3Mg==", "bodyText": "non-actionable: Your concern is valid, I'm not really sure what I would do if I saw this. Though it could be useful in identifying what might have happened in the context of a broader investigation.", "url": "https://github.com/palantir/atlasdb/pull/4745#discussion_r419460572", "createdAt": "2020-05-04T14:03:47Z", "author": {"login": "jeremyk-91"}, "path": "atlasdb-impl-shared/src/main/java/com/palantir/atlasdb/transaction/impl/SnapshotTransactionManager.java", "diffHunk": "@@ -353,7 +353,9 @@ public void close() {\n     private static void shutdownExecutor(ExecutorService executor) {\n         executor.shutdown();\n         try {\n-            executor.awaitTermination(10, TimeUnit.SECONDS);\n+            if (!executor.awaitTermination(10, TimeUnit.SECONDS)) {\n+                log.error(\"Failed to shutdown the executor after 10 seconds.\");\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4fb9257a483a96e3640e99ec4dbb15ca8bd01da"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk0MzE5Mw==", "bodyText": "That's the purpose - main aim here is just to help narrow down thread leaks or executor services failing to close.", "url": "https://github.com/palantir/atlasdb/pull/4745#discussion_r419943193", "createdAt": "2020-05-05T08:26:59Z", "author": {"login": "Jolyon-S"}, "path": "atlasdb-impl-shared/src/main/java/com/palantir/atlasdb/transaction/impl/SnapshotTransactionManager.java", "diffHunk": "@@ -353,7 +353,9 @@ public void close() {\n     private static void shutdownExecutor(ExecutorService executor) {\n         executor.shutdown();\n         try {\n-            executor.awaitTermination(10, TimeUnit.SECONDS);\n+            if (!executor.awaitTermination(10, TimeUnit.SECONDS)) {\n+                log.error(\"Failed to shutdown the executor after 10 seconds.\");\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQ2MDU3Mg=="}, "originalCommit": {"oid": "f4fb9257a483a96e3640e99ec4dbb15ca8bd01da"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3101, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}