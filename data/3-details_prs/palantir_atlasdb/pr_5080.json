{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwMTA4Njk4", "number": 5080, "title": "Fix hashCode related error-prone checks", "bodyText": "Goals (and why):\nfollow baseline best practices\nImplementation Description (bullets):\ncommits with automated code changes include the commands used to generate them.\nTesting (What was existing testing like?  What have you done to improve it?):\nn/a\nConcerns (what feedback would you like?):\nn/a\nWhere should we start reviewing?:\nAnywhere is fine, all code changes outside of build.gradle are automated.\nPriority (whenever / two weeks / yesterday):\nideally before more failures are introduced", "createdAt": "2020-10-26T15:23:27Z", "url": "https://github.com/palantir/atlasdb/pull/5080", "merged": true, "mergeCommit": {"oid": "727e95bfd7c52fa6726a5f500c19e2c1f94e49ba"}, "closed": true, "closedAt": "2020-10-27T14:49:13Z", "author": {"login": "carterkozak"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWWJGMgBqjM5MjEzNjY4MDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWqDvWAFqTUxNzc4NDY3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "823557e3dae5af1b5099bd0c3593c1f12b31139b", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/823557e3dae5af1b5099bd0c3593c1f12b31139b", "committedDate": "2020-10-26T15:28:13Z", "message": "fix enforcement"}, "afterCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/5325143d715f12324283f01b63f955644eccf153", "committedDate": "2020-10-26T15:31:02Z", "message": "Apply ObjectsHashCodePrimitive fixes\n\n```\n./gradlew compileJava compileTestJava -PerrorProneApply=ObjectsHashCodePrimitive --rerun-tasks --no-build-cache\n./gradlew format --rerun-tasks --no-build-cache\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MDI3Mzkx", "url": "https://github.com/palantir/atlasdb/pull/5080#pullrequestreview-517027391", "createdAt": "2020-10-26T17:43:01Z", "commit": {"oid": "5325143d715f12324283f01b63f955644eccf153"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNzo0MzowMVrOHobOtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNzo0MzowMVrOHobOtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1MTIyMA==", "bodyText": "I was a bit worried about this one because it could lead to fun times (if you deserialize something from the old version that has a different way of calculating the hash code and shove it into a set you have fun times), but think it's safe given that you can only create this through the serialization proxy, meaning that hash codes are always computed with the current JVM. I'd appreciate a double-check though.", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512151220", "createdAt": "2020-10-26T17:43:01Z", "author": {"login": "jeremyk-91"}, "path": "lock-api-objects/src/main/java/com/palantir/lock/LockRequest.java", "diffHunk": "@@ -200,15 +200,14 @@ public boolean equals(@Nullable Object obj) {\n                 && lockTimeout.equals(other.lockTimeout)\n                 && (lockGroupBehavior == other.lockGroupBehavior)\n                 && (blockingMode == other.blockingMode)\n-                && Objects.equal(blockingDuration, other.blockingDuration)\n-                && Objects.equal(versionId, other.versionId);\n+                && Objects.equals(blockingDuration, other.blockingDuration)\n+                && Objects.equals(versionId, other.versionId);\n     }\n \n     @Override\n     public int hashCode() {\n         if (hashCode == null) {\n-            hashCode = Objects.hashCode(\n-                    lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);\n+            hashCode = Objects.hash(lockMap, lockTimeout, lockGroupBehavior, blockingMode, blockingDuration, versionId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5325143d715f12324283f01b63f955644eccf153", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/5325143d715f12324283f01b63f955644eccf153", "committedDate": "2020-10-26T15:31:02Z", "message": "Apply ObjectsHashCodePrimitive fixes\n\n```\n./gradlew compileJava compileTestJava -PerrorProneApply=ObjectsHashCodePrimitive --rerun-tasks --no-build-cache\n./gradlew format --rerun-tasks --no-build-cache\n```"}, "afterCommit": {"oid": "015d7456f03870e3b799db9c833c296934891446", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/015d7456f03870e3b799db9c833c296934891446", "committedDate": "2020-10-26T18:57:37Z", "message": "LockRequest cached hashCode is a transient non-volatile int"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "579cf55cb4cbe9058b5dc7b46ebf83c0307899df", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/579cf55cb4cbe9058b5dc7b46ebf83c0307899df", "committedDate": "2020-10-27T13:41:46Z", "message": "Upgrade gradle-baseline to 3.44.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3146cf94f94ce47a415309a4a6676c84679cd87", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/f3146cf94f94ce47a415309a4a6676c84679cd87", "committedDate": "2020-10-27T13:41:46Z", "message": "Fix baseline DeprecatedGuavaObjects\n\n```\n./gradlew compileJava compileTestJava -PerrorProneApply=DeprecatedGuavaObjects --rerun-tasks --no-build-cache\n./gradlew format --rerun-tasks --no-build-cache\n```"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcfb247afd67385435f9325d9de8630df201bbaf", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/dcfb247afd67385435f9325d9de8630df201bbaf", "committedDate": "2020-10-27T13:41:46Z", "message": "Apply ObjectsHashCodeUnnecessaryVarargs\n\n```\n./gradlew compileJava compileTestJava -PerrorProneApply=ObjectsHashCodeUnnecessaryVarargs --rerun-tasks --no-build-cache\n./gradlew format\n```"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d3c0f50ed8c3f7c9210bde12b7360b194380e9", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/c7d3c0f50ed8c3f7c9210bde12b7360b194380e9", "committedDate": "2020-10-27T13:41:46Z", "message": "Apply ObjectsHashCodePrimitive fixes\n\n```\n./gradlew compileJava compileTestJava -PerrorProneApply=ObjectsHashCodePrimitive --rerun-tasks --no-build-cache\n./gradlew format --rerun-tasks --no-build-cache\n```"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bdaf6e2ee5214a8445a380f4f36fbe95ea2bcaf", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/3bdaf6e2ee5214a8445a380f4f36fbe95ea2bcaf", "committedDate": "2020-10-27T13:41:46Z", "message": "LockRequest cached hashCode is a transient non-volatile int"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/395e95194ba48dcb238be3cdd4f73efb67f6aaa0", "committedDate": "2020-10-27T14:32:34Z", "message": "Retain Namespace hashCode values"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "015d7456f03870e3b799db9c833c296934891446", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/015d7456f03870e3b799db9c833c296934891446", "committedDate": "2020-10-26T18:57:37Z", "message": "LockRequest cached hashCode is a transient non-volatile int"}, "afterCommit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0", "author": {"user": {"login": "carterkozak", "name": "Carter Kozak"}}, "url": "https://github.com/palantir/atlasdb/commit/395e95194ba48dcb238be3cdd4f73efb67f6aaa0", "committedDate": "2020-10-27T14:32:34Z", "message": "Retain Namespace hashCode values"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3Nzc0Mjkz", "url": "https://github.com/palantir/atlasdb/pull/5080#pullrequestreview-517774293", "createdAt": "2020-10-27T14:34:38Z", "commit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDozNDozOFrOHo_fRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDozNDozOFrOHo_fRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc0NTI4Nw==", "bodyText": "This produces the same result as the previous implementation, which was effectively return Arrays.hashCode(new Object[] { name });", "url": "https://github.com/palantir/atlasdb/pull/5080#discussion_r512745287", "createdAt": "2020-10-27T14:34:38Z", "author": {"login": "carterkozak"}, "path": "atlasdb-api/src/main/java/com/palantir/atlasdb/keyvalue/api/Namespace.java", "diffHunk": "@@ -78,7 +78,7 @@ public String getName() {\n \n     @Override\n     public int hashCode() {\n-        return Objects.hashCode(name);\n+        return 31 + Objects.hashCode(name);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3Nzg0Njc5", "url": "https://github.com/palantir/atlasdb/pull/5080#pullrequestreview-517784679", "createdAt": "2020-10-27T14:43:40Z", "commit": {"oid": "395e95194ba48dcb238be3cdd4f73efb67f6aaa0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2432, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}