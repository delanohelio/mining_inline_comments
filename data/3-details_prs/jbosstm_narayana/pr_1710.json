{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNTEzMjAz", "number": 1710, "title": "[JBTM-3379] make participant timeout configurable", "bodyText": "https://issues.redhat.com/browse/JBTM-3379\nLRA\n!MAIN !CORE !QA_JTA !QA_JTS_JDKORB !QA_JTS_OPENJDKORB !QA_JTS_JACORB !BLACKTIE !XTS !PERF NO_WIN !RTS !AS_TESTS !TOMCAT !JACOCO", "createdAt": "2020-10-29T19:34:02Z", "url": "https://github.com/jbosstm/narayana/pull/1710", "merged": true, "mergeCommit": {"oid": "8fed0de47835a5338d59cd5ae8478761ffe73711"}, "closed": true, "closedAt": "2020-11-10T16:35:21Z", "author": {"login": "ochaloup"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXlYT0AFqTUyMDU4Nzg5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbKtGRAFqTUyNzI5MjE4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNTg3ODk2", "url": "https://github.com/jbosstm/narayana/pull/1710#pullrequestreview-520587896", "createdAt": "2020-10-30T11:37:46Z", "commit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMTozNzo0NlrOHrLVkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMTo0ODoyMFrOHrLrQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTAzNjU2MA==", "bodyText": "This method was added in a later revision of the JAX-RS spec (and was the reason I chose async). Will you research whether or not we need to support any of the earlier versions?", "url": "https://github.com/jbosstm/narayana/pull/1710#discussion_r515036560", "createdAt": "2020-10-30T11:37:46Z", "author": {"login": "mmusgrov"}, "path": "rts/lra/coordinator/src/main/java/io/narayana/lra/coordinator/domain/model/LRARecord.java", "diffHunk": "@@ -424,7 +424,9 @@ private boolean afterLRARequest(URI target, String payload) {\n         Client client = null;\n \n         try {\n-            client = ClientBuilder.newClient();\n+            client = ClientBuilder.newBuilder()\n+                    .readTimeout(PARTICIPANT_TIMEOUT, TimeUnit.SECONDS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTAzODkzNQ==", "bodyText": "Should we prefix these properties with narayana to avoid any potential conflicts with future LRA spec versions.\nAlso participants/compensators are referred to as participants or compensators so it would be more consistent to call this property lra.participant.timeout (also participant is a well understood noun in the IT community whereas participation may not be for non English speakers).", "url": "https://github.com/jbosstm/narayana/pull/1710#discussion_r515038935", "createdAt": "2020-10-30T11:42:07Z", "author": {"login": "mmusgrov"}, "path": "rts/lra/service-base/src/main/java/io/narayana/lra/LRAConstants.java", "diffHunk": "@@ -42,7 +42,14 @@\n     public static final String RECOVERY_PARAM = \"recoveryCount\";\n     public static final String HTTP_METHOD_NAME = \"method\"; // the name of the HTTP method used to invoke participants\n \n-    public static final long PARTICIPANT_TIMEOUT = 2; // number of seconds to wait for requests\n+    /**\n+     * System property name which defines the connection read timeout which is used\n+     * by LRA Coordinator and its friends when connecting remote participants and other coordinators.\n+     * The value is in seconds. The default value is {@value LRAConstants#PARTICIPANT_DEFAULT_TIMEOUT_S}.\n+     */\n+    public static final String PARTICIPANT_TIMEOUT_PARAM = \"lra.participation.timeout\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA0MjExMg==", "bodyText": "It seems odd to declare a private constant that is only used once and then only on the next line. The less code in an application the easier it is to understand and maintain.", "url": "https://github.com/jbosstm/narayana/pull/1710#discussion_r515042112", "createdAt": "2020-10-30T11:48:20Z", "author": {"login": "mmusgrov"}, "path": "rts/lra/service-base/src/main/java/io/narayana/lra/LRAConstants.java", "diffHunk": "@@ -42,7 +42,14 @@\n     public static final String RECOVERY_PARAM = \"recoveryCount\";\n     public static final String HTTP_METHOD_NAME = \"method\"; // the name of the HTTP method used to invoke participants\n \n-    public static final long PARTICIPANT_TIMEOUT = 2; // number of seconds to wait for requests\n+    /**\n+     * System property name which defines the connection read timeout which is used\n+     * by LRA Coordinator and its friends when connecting remote participants and other coordinators.\n+     * The value is in seconds. The default value is {@value LRAConstants#PARTICIPANT_DEFAULT_TIMEOUT_S}.\n+     */\n+    public static final String PARTICIPANT_TIMEOUT_PARAM = \"lra.participation.timeout\";\n+    private static final long PARTICIPANT_DEFAULT_TIMEOUT_S = 2; // number of seconds to wait for requests", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4", "author": {"user": {"login": "ochaloup", "name": "chalda"}}, "url": "https://github.com/jbosstm/narayana/commit/3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4", "committedDate": "2020-10-29T19:33:51Z", "message": "[JBTM-3379] make participant timouet configurable and without async calls"}, "afterCommit": {"oid": "ec93ec4b3f0775feb3b31b68aed0a0701762e745", "author": {"user": {"login": "ochaloup", "name": "chalda"}}, "url": "https://github.com/jbosstm/narayana/commit/ec93ec4b3f0775feb3b31b68aed0a0701762e745", "committedDate": "2020-10-30T15:12:16Z", "message": "[JBTM-3379] make participant timouet configurable and without async calls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNzM2NDY0", "url": "https://github.com/jbosstm/narayana/pull/1710#pullrequestreview-520736464", "createdAt": "2020-10-30T14:44:22Z", "commit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDo0NDoyMlrOHrSLsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNToxODowM1rOHrTuUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE0ODcyMA==", "bodyText": "I don't agree with this statement but I don't want to dispute about it.\nFixed.", "url": "https://github.com/jbosstm/narayana/pull/1710#discussion_r515148720", "createdAt": "2020-10-30T14:44:22Z", "author": {"login": "ochaloup"}, "path": "rts/lra/service-base/src/main/java/io/narayana/lra/LRAConstants.java", "diffHunk": "@@ -42,7 +42,14 @@\n     public static final String RECOVERY_PARAM = \"recoveryCount\";\n     public static final String HTTP_METHOD_NAME = \"method\"; // the name of the HTTP method used to invoke participants\n \n-    public static final long PARTICIPANT_TIMEOUT = 2; // number of seconds to wait for requests\n+    /**\n+     * System property name which defines the connection read timeout which is used\n+     * by LRA Coordinator and its friends when connecting remote participants and other coordinators.\n+     * The value is in seconds. The default value is {@value LRAConstants#PARTICIPANT_DEFAULT_TIMEOUT_S}.\n+     */\n+    public static final String PARTICIPANT_TIMEOUT_PARAM = \"lra.participation.timeout\";\n+    private static final long PARTICIPANT_DEFAULT_TIMEOUT_S = 2; // number of seconds to wait for requests", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA0MjExMg=="}, "originalCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE0ODkyMg==", "bodyText": "Yes, agree, really good points. Thank you.", "url": "https://github.com/jbosstm/narayana/pull/1710#discussion_r515148922", "createdAt": "2020-10-30T14:44:38Z", "author": {"login": "ochaloup"}, "path": "rts/lra/service-base/src/main/java/io/narayana/lra/LRAConstants.java", "diffHunk": "@@ -42,7 +42,14 @@\n     public static final String RECOVERY_PARAM = \"recoveryCount\";\n     public static final String HTTP_METHOD_NAME = \"method\"; // the name of the HTTP method used to invoke participants\n \n-    public static final long PARTICIPANT_TIMEOUT = 2; // number of seconds to wait for requests\n+    /**\n+     * System property name which defines the connection read timeout which is used\n+     * by LRA Coordinator and its friends when connecting remote participants and other coordinators.\n+     * The value is in seconds. The default value is {@value LRAConstants#PARTICIPANT_DEFAULT_TIMEOUT_S}.\n+     */\n+    public static final String PARTICIPANT_TIMEOUT_PARAM = \"lra.participation.timeout\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTAzODkzNQ=="}, "originalCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE3Mzk2OQ==", "bodyText": "Hm... I thought that we are fine to use the JAX-RS 2.1 when we defined it in dependencies.\nRegarding the need of  support of the earlier versions. I can't see any need for the support or earlier versions. The Quarkus uses the 2.1 from start, for WildFly there will be for sure no support with older versions (at least for the reason that for integration there will be created an extension and WildFly supports extensions only in new versions).", "url": "https://github.com/jbosstm/narayana/pull/1710#discussion_r515173969", "createdAt": "2020-10-30T15:18:03Z", "author": {"login": "ochaloup"}, "path": "rts/lra/coordinator/src/main/java/io/narayana/lra/coordinator/domain/model/LRARecord.java", "diffHunk": "@@ -424,7 +424,9 @@ private boolean afterLRARequest(URI target, String payload) {\n         Client client = null;\n \n         try {\n-            client = ClientBuilder.newClient();\n+            client = ClientBuilder.newBuilder()\n+                    .readTimeout(PARTICIPANT_TIMEOUT, TimeUnit.SECONDS)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTAzNjU2MA=="}, "originalCommit": {"oid": "3d06a0cd9e6652c536bdb56cfb24d7d5c96584b4"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNDgyMzY4", "url": "https://github.com/jbosstm/narayana/pull/1710#pullrequestreview-521482368", "createdAt": "2020-11-02T09:59:05Z", "commit": {"oid": "ec93ec4b3f0775feb3b31b68aed0a0701762e745"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7beb5ea7bdac85a1301c94d5bb1b57d239d12b14", "author": {"user": {"login": "ochaloup", "name": "chalda"}}, "url": "https://github.com/jbosstm/narayana/commit/7beb5ea7bdac85a1301c94d5bb1b57d239d12b14", "committedDate": "2020-11-09T08:43:27Z", "message": "[JBTM-3379] make participant timeout configurable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ec93ec4b3f0775feb3b31b68aed0a0701762e745", "author": {"user": {"login": "ochaloup", "name": "chalda"}}, "url": "https://github.com/jbosstm/narayana/commit/ec93ec4b3f0775feb3b31b68aed0a0701762e745", "committedDate": "2020-10-30T15:12:16Z", "message": "[JBTM-3379] make participant timouet configurable and without async calls"}, "afterCommit": {"oid": "7beb5ea7bdac85a1301c94d5bb1b57d239d12b14", "author": {"user": {"login": "ochaloup", "name": "chalda"}}, "url": "https://github.com/jbosstm/narayana/commit/7beb5ea7bdac85a1301c94d5bb1b57d239d12b14", "committedDate": "2020-11-09T08:43:27Z", "message": "[JBTM-3379] make participant timeout configurable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjAyNjMz", "url": "https://github.com/jbosstm/narayana/pull/1710#pullrequestreview-527202633", "createdAt": "2020-11-10T13:32:15Z", "commit": {"oid": "7beb5ea7bdac85a1301c94d5bb1b57d239d12b14"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjkyMTgw", "url": "https://github.com/jbosstm/narayana/pull/1710#pullrequestreview-527292180", "createdAt": "2020-11-10T15:01:30Z", "commit": {"oid": "7beb5ea7bdac85a1301c94d5bb1b57d239d12b14"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4493, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}