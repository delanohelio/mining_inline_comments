{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0NTI4ODU3", "number": 1740, "title": "JBTM-3402 Stop creating unnamed thread pools", "bodyText": "Added thread name to transaction manager thread pool.\nhttps://issues.redhat.com/browse/JBTM-3402\nMAIN QA_JTA PERF XTS AS_TESTS\n!QA_JTS_JDKORB !QA_JTS_OPENJDKORB !QA_JTS_JACORB !BLACKTIE !RTS !TOMCAT !JACOCO !LRA", "createdAt": "2020-12-08T15:28:35Z", "url": "https://github.com/jbosstm/narayana/pull/1740", "merged": true, "mergeCommit": {"oid": "860ada37c0ef9370d04e6d2f6319ffd9d2df4b22"}, "closed": true, "closedAt": "2021-01-27T16:29:48Z", "author": {"login": "krosenvold"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkbT-lAFqTU0Nzk4OTI4Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdz5x_hAFqTU3NjI1Nzg0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3OTg5Mjgz", "url": "https://github.com/jbosstm/narayana/pull/1740#pullrequestreview-547989283", "createdAt": "2020-12-09T09:27:45Z", "commit": {"oid": "3d32a763c0062b103b939fac843ce08ce0b907d2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwOToyNzo0NlrOICKyLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwOToyNzo0NlrOICKyLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE0NDc1MQ==", "bodyText": "@mmusgrov - if we go ahead with this kind of change then I think maybe the threads would be prefixed with something like \"Narayana\" instead", "url": "https://github.com/jbosstm/narayana/pull/1740#discussion_r539144751", "createdAt": "2020-12-09T09:27:46Z", "author": {"login": "tomjenkinson"}, "path": "ArjunaJTA/jta/classes/com/arjuna/ats/internal/jta/transaction/arjunacore/BaseTransaction.java", "diffHunk": "@@ -308,6 +310,21 @@ public Void call() throws InvalidTransactionException,\n \n \tprivate static final int _asyncCommitPoolSize = jtaPropertyManager.getJTAEnvironmentBean().getAsyncCommitPoolSize();\n \n-\tprivate static final ThreadPoolExecutor tpe = new ThreadPoolExecutor(1, _asyncCommitPoolSize, 10, TimeUnit.SECONDS, new ArrayBlockingQueue<Runnable>(3));\n+\tstatic class NamedThreadFactory implements ThreadFactory {\n+\t\tprivate final String name;\n+\t\tprivate final AtomicInteger counter = new AtomicInteger();\n+\n+\t\tNamedThreadFactory(String name) {\n+\t\t\tthis.name = name;\n+\t\t}\n+\n+\t\tpublic Thread newThread(Runnable r) {\n+\t\t\treturn new Thread(r, name + \"-Thread_\" + counter.incrementAndGet());\n+\t\t}\n+\t}\n+\n+\tprivate static final ThreadFactory transactionThreadFactory = new NamedThreadFactory(\"Arjuna-Transaction\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d32a763c0062b103b939fac843ce08ce0b907d2"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMzczNzg2", "url": "https://github.com/jbosstm/narayana/pull/1740#pullrequestreview-551373786", "createdAt": "2020-12-14T13:40:13Z", "commit": {"oid": "3d32a763c0062b103b939fac843ce08ce0b907d2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxMzo0MDoxM1rOIFQ5CQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxMzo0MDoxM1rOIFQ5CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjM5MDUzNw==", "bodyText": "@krosenvold can you please use as the prefix just word Narayana?", "url": "https://github.com/jbosstm/narayana/pull/1740#discussion_r542390537", "createdAt": "2020-12-14T13:40:13Z", "author": {"login": "ochaloup"}, "path": "ArjunaJTA/jta/classes/com/arjuna/ats/internal/jta/transaction/arjunacore/BaseTransaction.java", "diffHunk": "@@ -308,6 +310,21 @@ public Void call() throws InvalidTransactionException,\n \n \tprivate static final int _asyncCommitPoolSize = jtaPropertyManager.getJTAEnvironmentBean().getAsyncCommitPoolSize();\n \n-\tprivate static final ThreadPoolExecutor tpe = new ThreadPoolExecutor(1, _asyncCommitPoolSize, 10, TimeUnit.SECONDS, new ArrayBlockingQueue<Runnable>(3));\n+\tstatic class NamedThreadFactory implements ThreadFactory {\n+\t\tprivate final String name;\n+\t\tprivate final AtomicInteger counter = new AtomicInteger();\n+\n+\t\tNamedThreadFactory(String name) {\n+\t\t\tthis.name = name;\n+\t\t}\n+\n+\t\tpublic Thread newThread(Runnable r) {\n+\t\t\treturn new Thread(r, name + \"-Thread_\" + counter.incrementAndGet());\n+\t\t}\n+\t}\n+\n+\tprivate static final ThreadFactory transactionThreadFactory = new NamedThreadFactory(\"Arjuna-Transaction\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE0NDc1MQ=="}, "originalCommit": {"oid": "3d32a763c0062b103b939fac843ce08ce0b907d2"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc1NDgxOTk5", "url": "https://github.com/jbosstm/narayana/pull/1740#pullrequestreview-575481999", "createdAt": "2021-01-25T15:00:36Z", "commit": {"oid": "4637d337236e72f04438732355bd14919ea763d5"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f20bd2b53eedb89a44f7568f5b0700e9bc331eb5", "author": {"user": {"login": "krosenvold", "name": "Kristian Rosenvold"}}, "url": "https://github.com/jbosstm/narayana/commit/f20bd2b53eedb89a44f7568f5b0700e9bc331eb5", "committedDate": "2021-01-26T06:15:17Z", "message": "JBTM-3402 Stop creating unnamed thread pools\n\nAdded thread name to transaction manager thread pool."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4637d337236e72f04438732355bd14919ea763d5", "author": {"user": {"login": "krosenvold", "name": "Kristian Rosenvold"}}, "url": "https://github.com/jbosstm/narayana/commit/4637d337236e72f04438732355bd14919ea763d5", "committedDate": "2021-01-25T07:59:27Z", "message": "Changed name to Narayana"}, "afterCommit": {"oid": "f20bd2b53eedb89a44f7568f5b0700e9bc331eb5", "author": {"user": {"login": "krosenvold", "name": "Kristian Rosenvold"}}, "url": "https://github.com/jbosstm/narayana/commit/f20bd2b53eedb89a44f7568f5b0700e9bc331eb5", "committedDate": "2021-01-26T06:15:17Z", "message": "JBTM-3402 Stop creating unnamed thread pools\n\nAdded thread name to transaction manager thread pool."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc2MjU3ODQz", "url": "https://github.com/jbosstm/narayana/pull/1740#pullrequestreview-576257843", "createdAt": "2021-01-26T11:26:34Z", "commit": {"oid": "f20bd2b53eedb89a44f7568f5b0700e9bc331eb5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4409, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}