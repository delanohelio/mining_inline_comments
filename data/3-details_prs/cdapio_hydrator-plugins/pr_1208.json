{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NDM3NDU5", "number": 1208, "title": "Fixed: decimal type handled correctly", "bodyText": "JIRA ticket: https://issues.cask.co/browse/PLUGIN-180", "createdAt": "2020-08-28T14:25:46Z", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208", "merged": true, "mergeCommit": {"oid": "d0d9426ff9bcba85058e42d3fd40249775723e84"}, "closed": true, "closedAt": "2020-10-21T19:02:28Z", "author": {"login": "vjosadika"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOrHg5AFqTUwMTM5MzAyMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUtsdygBqjM5MDQwMTMyNzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMzkzMDIz", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208#pullrequestreview-501393023", "createdAt": "2020-10-02T19:26:18Z", "commit": {"oid": "c26b97560d880a7b451355f7dcd96c9279908ad9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxOToyNjoxOFrOHb5KoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxOToyNjoxOFrOHb5KoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTAxMDIwOA==", "bodyText": "why the precision is 2?", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208#discussion_r499010208", "createdAt": "2020-10-02T19:26:18Z", "author": {"login": "CuriousVini"}, "path": "database-plugins/src/main/java/io/cdap/plugin/DBUtils.java", "diffHunk": "@@ -233,11 +233,7 @@ private static Schema getSchema(String typeName, int sqlType, int precision, int\n \n       case Types.NUMERIC:\n       case Types.DECIMAL:\n-        // if there are no digits after the point, use integer types\n-        type = scale != 0 ? Schema.Type.DOUBLE :\n-          // with 10 digits we can represent 2^32 and LONG is required\n-          precision > 9 ? Schema.Type.LONG : Schema.Type.INT;\n-        break;\n+        return  Schema.decimalOf(2,scale);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c26b97560d880a7b451355f7dcd96c9279908ad9"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMzkzNTk3", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208#pullrequestreview-501393597", "createdAt": "2020-10-02T19:27:25Z", "commit": {"oid": "c26b97560d880a7b451355f7dcd96c9279908ad9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxOToyNzoyNVrOHb5MPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxOToyNzoyNVrOHb5MPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTAxMDYyMg==", "bodyText": "Has this been tested with any database? Please add a unit test", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208#discussion_r499010622", "createdAt": "2020-10-02T19:27:25Z", "author": {"login": "CuriousVini"}, "path": "database-plugins/src/main/java/io/cdap/plugin/DBUtils.java", "diffHunk": "@@ -233,11 +233,7 @@ private static Schema getSchema(String typeName, int sqlType, int precision, int\n \n       case Types.NUMERIC:\n       case Types.DECIMAL:\n-        // if there are no digits after the point, use integer types\n-        type = scale != 0 ? Schema.Type.DOUBLE :\n-          // with 10 digits we can represent 2^32 and LONG is required\n-          precision > 9 ? Schema.Type.LONG : Schema.Type.INT;\n-        break;\n+        return  Schema.decimalOf(2,scale);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTAxMDIwOA=="}, "originalCommit": {"oid": "c26b97560d880a7b451355f7dcd96c9279908ad9"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f2a13f5f219731b017079a3dd25bfcf42a6c16fd", "author": {"user": null}, "url": "https://github.com/cdapio/hydrator-plugins/commit/f2a13f5f219731b017079a3dd25bfcf42a6c16fd", "committedDate": "2020-10-16T11:55:10Z", "message": "Merge branch 'bugfix/PLUGIN-180' of https://github.com/AdaptiveScale/hydrator-plugins into bugfix/PLUGIN-180\n\n# Conflicts:\n#\tdatabase-plugins/src/main/java/io/cdap/plugin/DBUtils.java"}, "afterCommit": {"oid": "a90cdc730338aca0359e2600cd7b532e39f493ce", "author": {"user": null}, "url": "https://github.com/cdapio/hydrator-plugins/commit/a90cdc730338aca0359e2600cd7b532e39f493ce", "committedDate": "2020-10-16T11:51:28Z", "message": "Fixed: decimal type handled correctly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNDI1MDkz", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208#pullrequestreview-511425093", "createdAt": "2020-10-19T05:42:50Z", "commit": {"oid": "a90cdc730338aca0359e2600cd7b532e39f493ce"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwNTo0Mjo1MFrOHj-KXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwNTo0Mjo1MFrOHj-KXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQ4MDY2OA==", "bodyText": "Please move this logic here:\nhttps://github.com/cdapio/hydrator-plugins/blob/develop/database-plugins/src/main/java/io/cdap/plugin/DBRecord.java#L137", "url": "https://github.com/cdapio/hydrator-plugins/pull/1208#discussion_r507480668", "createdAt": "2020-10-19T05:42:50Z", "author": {"login": "CuriousVini"}, "path": "database-plugins/src/main/java/io/cdap/plugin/DBUtils.java", "diffHunk": "@@ -284,15 +280,7 @@ public static Object transformValue(int sqlType, int precision, int scale,\n         case Types.NUMERIC:\n         case Types.DECIMAL:\n           BigDecimal decimal = (BigDecimal) original;\n-          if (scale != 0) {\n-            // if there are digits after the point, use double types\n-            return decimal.doubleValue();\n-          } else if (precision > 9) {\n-            // with 10 digits we can represent 2^32 and LONG is required\n-            return decimal.longValue();\n-          } else {\n-            return decimal.intValue();\n-          }\n+          return decimal.unscaledValue().toByteArray();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a90cdc730338aca0359e2600cd7b532e39f493ce"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90c934f7416d6e42c023163440d36dc9b15455a0", "author": {"user": null}, "url": "https://github.com/cdapio/hydrator-plugins/commit/90c934f7416d6e42c023163440d36dc9b15455a0", "committedDate": "2020-10-21T13:49:32Z", "message": "Fixed: decimal type handled correctly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d8cc80a040599365d0cf4b9c980d667db1662be", "author": {"user": null}, "url": "https://github.com/cdapio/hydrator-plugins/commit/5d8cc80a040599365d0cf4b9c980d667db1662be", "committedDate": "2020-10-21T13:48:21Z", "message": "PR review"}, "afterCommit": {"oid": "90c934f7416d6e42c023163440d36dc9b15455a0", "author": {"user": null}, "url": "https://github.com/cdapio/hydrator-plugins/commit/90c934f7416d6e42c023163440d36dc9b15455a0", "committedDate": "2020-10-21T13:49:32Z", "message": "Fixed: decimal type handled correctly"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1492, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}