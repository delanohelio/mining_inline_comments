{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMDI4MTQy", "number": 1157, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMjoxOTo1NFrOEVMB5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMjoyMjozMFrOEVMEmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNjUyNjQ1OnYy", "diffSide": "RIGHT", "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMjoxOTo1NFrOG7zeRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMzoxNDo0MlrOG70ndw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM2MjUwMA==", "bodyText": "style: should have something on the previous line besides just return. Also, indentation for a new line should be 2 spaces and not 4.", "url": "https://github.com/cdapio/hydrator-plugins/pull/1157#discussion_r465362500", "createdAt": "2020-08-04T22:19:54Z", "author": {"login": "albertshau"}, "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "diffHunk": "@@ -88,32 +88,24 @@ public void configurePipeline(PipelineConfigurer pipelineConfigurer) {\n     }\n \n     FileFormat format = config.getFormat();\n-    ValidatingOutputFormat validatingOutputFormat =\n-      pipelineConfigurer.usePlugin(ValidatingOutputFormat.PLUGIN_TYPE, format.name().toLowerCase(),\n-                                   format.name().toLowerCase(), config.getRawProperties());\n+    ValidatingOutputFormat validatingOutputFormat = getValidatingOutputFormat(pipelineConfigurer);\n     FormatContext context = new FormatContext(collector, pipelineConfigurer.getStageConfigurer().getInputSchema());\n     validateOutputFormatProvider(context, format, validatingOutputFormat);\n   }\n \n+  public ValidatingOutputFormat getValidatingOutputFormat(PipelineConfigurer pipelineConfigurer) {\n+    FileFormat format = config.getFormat();\n+    return\n+        pipelineConfigurer.usePlugin(ValidatingOutputFormat.PLUGIN_TYPE, format.name().toLowerCase(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "274ee44e3c9ac8b8523abb9a26615cb0ab7811de"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM4MTIzOQ==", "bodyText": "Fixed.", "url": "https://github.com/cdapio/hydrator-plugins/pull/1157#discussion_r465381239", "createdAt": "2020-08-04T23:14:42Z", "author": {"login": "greeshmaswaminathan"}, "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "diffHunk": "@@ -88,32 +88,24 @@ public void configurePipeline(PipelineConfigurer pipelineConfigurer) {\n     }\n \n     FileFormat format = config.getFormat();\n-    ValidatingOutputFormat validatingOutputFormat =\n-      pipelineConfigurer.usePlugin(ValidatingOutputFormat.PLUGIN_TYPE, format.name().toLowerCase(),\n-                                   format.name().toLowerCase(), config.getRawProperties());\n+    ValidatingOutputFormat validatingOutputFormat = getValidatingOutputFormat(pipelineConfigurer);\n     FormatContext context = new FormatContext(collector, pipelineConfigurer.getStageConfigurer().getInputSchema());\n     validateOutputFormatProvider(context, format, validatingOutputFormat);\n   }\n \n+  public ValidatingOutputFormat getValidatingOutputFormat(PipelineConfigurer pipelineConfigurer) {\n+    FileFormat format = config.getFormat();\n+    return\n+        pipelineConfigurer.usePlugin(ValidatingOutputFormat.PLUGIN_TYPE, format.name().toLowerCase(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM2MjUwMA=="}, "originalCommit": {"oid": "274ee44e3c9ac8b8523abb9a26615cb0ab7811de"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNjUyOTk0OnYy", "diffSide": "RIGHT", "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMjoyMToxMVrOG7zgTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMzoxNTowNVrOG70oAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM2MzAyMA==", "bodyText": "I assume this is pulled into its own method so subclasses can use it? If that's the case, can this be protected instead of public?", "url": "https://github.com/cdapio/hydrator-plugins/pull/1157#discussion_r465363020", "createdAt": "2020-08-04T22:21:11Z", "author": {"login": "albertshau"}, "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "diffHunk": "@@ -135,12 +127,28 @@ public void prepareRun(BatchSinkContext context) throws Exception {\n     Map<String, String> outputProperties = new HashMap<>(validatingOutputFormat.getOutputFormatConfiguration());\n     outputProperties.putAll(getFileSystemProperties(context));\n     outputProperties.put(FileOutputFormat.OUTDIR, getOutputDir(context.getLogicalStartTime()));\n-\n     context.addOutput(Output.of(config.getReferenceName(),\n                                 new SinkOutputFormatProvider(validatingOutputFormat.getOutputFormatClassName(),\n                                                              outputProperties)));\n   }\n \n+  public ValidatingOutputFormat getOutputFormatForRun(BatchSinkContext context) throws InstantiationException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "274ee44e3c9ac8b8523abb9a26615cb0ab7811de"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM4MTM3Ng==", "bodyText": "Yes, protected is enough. Fixed.", "url": "https://github.com/cdapio/hydrator-plugins/pull/1157#discussion_r465381376", "createdAt": "2020-08-04T23:15:05Z", "author": {"login": "greeshmaswaminathan"}, "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "diffHunk": "@@ -135,12 +127,28 @@ public void prepareRun(BatchSinkContext context) throws Exception {\n     Map<String, String> outputProperties = new HashMap<>(validatingOutputFormat.getOutputFormatConfiguration());\n     outputProperties.putAll(getFileSystemProperties(context));\n     outputProperties.put(FileOutputFormat.OUTDIR, getOutputDir(context.getLogicalStartTime()));\n-\n     context.addOutput(Output.of(config.getReferenceName(),\n                                 new SinkOutputFormatProvider(validatingOutputFormat.getOutputFormatClassName(),\n                                                              outputProperties)));\n   }\n \n+  public ValidatingOutputFormat getOutputFormatForRun(BatchSinkContext context) throws InstantiationException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM2MzAyMA=="}, "originalCommit": {"oid": "274ee44e3c9ac8b8523abb9a26615cb0ab7811de"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNjUzMzM5OnYy", "diffSide": "RIGHT", "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMjoyMjozMFrOG7ziUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMzoxNToxNVrOG70oSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM2MzUzOA==", "bodyText": "can this be protected instead of public?", "url": "https://github.com/cdapio/hydrator-plugins/pull/1157#discussion_r465363538", "createdAt": "2020-08-04T22:22:30Z", "author": {"login": "albertshau"}, "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "diffHunk": "@@ -88,32 +88,24 @@ public void configurePipeline(PipelineConfigurer pipelineConfigurer) {\n     }\n \n     FileFormat format = config.getFormat();\n-    ValidatingOutputFormat validatingOutputFormat =\n-      pipelineConfigurer.usePlugin(ValidatingOutputFormat.PLUGIN_TYPE, format.name().toLowerCase(),\n-                                   format.name().toLowerCase(), config.getRawProperties());\n+    ValidatingOutputFormat validatingOutputFormat = getValidatingOutputFormat(pipelineConfigurer);\n     FormatContext context = new FormatContext(collector, pipelineConfigurer.getStageConfigurer().getInputSchema());\n     validateOutputFormatProvider(context, format, validatingOutputFormat);\n   }\n \n+  public ValidatingOutputFormat getValidatingOutputFormat(PipelineConfigurer pipelineConfigurer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "274ee44e3c9ac8b8523abb9a26615cb0ab7811de"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM4MTQ0OA==", "bodyText": "Done.", "url": "https://github.com/cdapio/hydrator-plugins/pull/1157#discussion_r465381448", "createdAt": "2020-08-04T23:15:15Z", "author": {"login": "greeshmaswaminathan"}, "path": "format-common/src/main/java/io/cdap/plugin/format/plugin/AbstractFileSink.java", "diffHunk": "@@ -88,32 +88,24 @@ public void configurePipeline(PipelineConfigurer pipelineConfigurer) {\n     }\n \n     FileFormat format = config.getFormat();\n-    ValidatingOutputFormat validatingOutputFormat =\n-      pipelineConfigurer.usePlugin(ValidatingOutputFormat.PLUGIN_TYPE, format.name().toLowerCase(),\n-                                   format.name().toLowerCase(), config.getRawProperties());\n+    ValidatingOutputFormat validatingOutputFormat = getValidatingOutputFormat(pipelineConfigurer);\n     FormatContext context = new FormatContext(collector, pipelineConfigurer.getStageConfigurer().getInputSchema());\n     validateOutputFormatProvider(context, format, validatingOutputFormat);\n   }\n \n+  public ValidatingOutputFormat getValidatingOutputFormat(PipelineConfigurer pipelineConfigurer) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM2MzUzOA=="}, "originalCommit": {"oid": "274ee44e3c9ac8b8523abb9a26615cb0ab7811de"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2471, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}