{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NDAyNzg5", "number": 10641, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMzoyNzo1NlrOEx5lIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNTozNDoxMlrOE1Rwqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwNzU5MDc0OnYy", "diffSide": "RIGHT", "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxMzoyNzo1NlrOHoPazw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxMjowNDozMFrOHqYrkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ==", "bodyText": "honestly I think thats a very bad idea... a method with get in its name should not modify the headers that are passed in. This is just super unexpected.", "url": "https://github.com/netty/netty/pull/10641#discussion_r511957711", "createdAt": "2020-10-26T13:27:56Z", "author": {"login": "normanmaurer"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1OTQyOA==", "bodyText": "Agree. Should I move into the write method?", "url": "https://github.com/netty/netty/pull/10641#discussion_r511959428", "createdAt": "2020-10-26T13:30:08Z", "author": {"login": "hyperxpro"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, "originalCommit": {"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk2MTQwNA==", "bodyText": "yes", "url": "https://github.com/netty/netty/pull/10641#discussion_r511961404", "createdAt": "2020-10-26T13:33:00Z", "author": {"login": "normanmaurer"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, "originalCommit": {"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk2MTUxMA==", "bodyText": "Also please add a test case", "url": "https://github.com/netty/netty/pull/10641#discussion_r511961510", "createdAt": "2020-10-26T13:33:10Z", "author": {"login": "normanmaurer"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, "originalCommit": {"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDEyNTc5Mw==", "bodyText": "@hyperxpro please ping me once done", "url": "https://github.com/netty/netty/pull/10641#discussion_r514125793", "createdAt": "2020-10-29T09:41:56Z", "author": {"login": "normanmaurer"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, "originalCommit": {"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIwNjYxMQ==", "bodyText": "Sorry for the delay. Been really busy. I made changes as you told and also added a test case.", "url": "https://github.com/netty/netty/pull/10641#discussion_r514206611", "createdAt": "2020-10-29T12:04:30Z", "author": {"login": "hyperxpro"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/HttpToHttp2ConnectionHandler.java", "diffHunk": "@@ -60,6 +70,9 @@ protected HttpToHttp2ConnectionHandler(Http2ConnectionDecoder decoder, Http2Conn\n      * @throws Exception If the {@code httpHeaders} object specifies an invalid stream id\n      */\n     private int getStreamId(HttpHeaders httpHeaders) throws Exception {\n+        if (httpScheme != null && !httpHeaders.contains(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text())) {\n+            httpHeaders.set(HttpConversionUtil.ExtensionHeaderNames.SCHEME.text(), httpScheme.name());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk1NzcxMQ=="}, "originalCommit": {"oid": "4a40db3b08dc13a3ac447e6a439e379aad9d5f53"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0MzAwOTcwOnYy", "diffSide": "RIGHT", "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/AbstractHttp2ConnectionHandlerBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNTozNDoxM1rOHtdhEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNTozNjoyOVrOHtdngg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQzMTU2OA==", "bodyText": "revert ?", "url": "https://github.com/netty/netty/pull/10641#discussion_r517431568", "createdAt": "2020-11-04T15:34:13Z", "author": {"login": "normanmaurer"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/AbstractHttp2ConnectionHandlerBuilder.java", "diffHunk": "@@ -17,6 +17,7 @@\n package io.netty.handler.codec.http2;\n \n import io.netty.channel.Channel;\n+import io.netty.handler.codec.http.HttpScheme;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32e1e873f51ced0501e38c9dd50b1b4228167d54"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQzMzIxOA==", "bodyText": "Done", "url": "https://github.com/netty/netty/pull/10641#discussion_r517433218", "createdAt": "2020-11-04T15:36:29Z", "author": {"login": "hyperxpro"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/AbstractHttp2ConnectionHandlerBuilder.java", "diffHunk": "@@ -17,6 +17,7 @@\n package io.netty.handler.codec.http2;\n \n import io.netty.channel.Channel;\n+import io.netty.handler.codec.http.HttpScheme;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQzMTU2OA=="}, "originalCommit": {"oid": "32e1e873f51ced0501e38c9dd50b1b4228167d54"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3588, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}