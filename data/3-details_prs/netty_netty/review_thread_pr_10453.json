{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyOTc2NzAz", "number": 10453, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMDozNzoyNlrOEVKMyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToyOTozOFrOEV_86A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNjIyNjY0OnYy", "diffSide": "RIGHT", "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "isResolved": false, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMDozNzoyNlrOG7wnWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNTowNjoxOFrOG83vIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw==", "bodyText": "I think this may actually need to be a loop since it's not guaranteed to write all of the bytes in a single invocation", "url": "https://github.com/netty/netty/pull/10453#discussion_r465315673", "createdAt": "2020-08-04T20:37:26Z", "author": {"login": "njhill"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTUwMjIwOA==", "bodyText": "@amizurov I think @njhill is right here... can you adjust this please ?", "url": "https://github.com/netty/netty/pull/10453#discussion_r465502208", "createdAt": "2020-08-05T06:30:28Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTUxNDg0OQ==", "bodyText": "Sure, according java docs it depends on implementation.", "url": "https://github.com/netty/netty/pull/10453#discussion_r465514849", "createdAt": "2020-08-05T07:00:34Z", "author": {"login": "amizurov"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTYwMzQzOQ==", "bodyText": "instead of if (written > 0), you might better inverse the test to if (written < 0) which stands for end of file/channel, therefore giving a break of the while loop ?", "url": "https://github.com/netty/netty/pull/10453#discussion_r465603439", "createdAt": "2020-08-05T09:41:57Z", "author": {"login": "fredericBregier"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTYxMTAxNw==", "bodyText": "or if (written <= 0) since the javadoc does not specify negative result (as in standard Java interaction with file or stream). The idea is to have a clear \"break\" code, and therefore to not rely only on while condition.", "url": "https://github.com/netty/netty/pull/10453#discussion_r465611017", "createdAt": "2020-08-05T09:55:36Z", "author": {"login": "fredericBregier"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkzNzUwOA==", "bodyText": "@amizurov ^^", "url": "https://github.com/netty/netty/pull/10453#discussion_r465937508", "createdAt": "2020-08-05T18:58:03Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk4NjM0OQ==", "bodyText": "I changed code according suggestion but i'm not sure is it ok if we break from loop but possible not all data is written or maybe i'm confused :)", "url": "https://github.com/netty/netty/pull/10453#discussion_r465986349", "createdAt": "2020-08-05T20:31:43Z", "author": {"login": "amizurov"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE3NTI1Ng==", "bodyText": "@amizurov I think we should only break on < 0 as 0 is valid.", "url": "https://github.com/netty/netty/pull/10453#discussion_r466175256", "createdAt": "2020-08-06T06:33:03Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQ4MDkzMQ==", "bodyText": "Ok, also moved change position and buffer reader index from loop", "url": "https://github.com/netty/netty/pull/10453#discussion_r466480931", "createdAt": "2020-08-06T15:06:18Z", "author": {"login": "amizurov"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,20 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                long currentPosition = fileChannel.position();\n+                int written = buffer.getBytes(buffer.readerIndex(), fileChannel, currentPosition, localsize);\n+                if (written > 0) {\n+                    fileChannel.position(currentPosition + written);\n+                    buffer.readerIndex(buffer.readerIndex() + written);\n+                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMxNTY3Mw=="}, "originalCommit": {"oid": "f14d41f13165ca5026a43cb27bf38cfe437325b3"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNTAzMzM2OnYy", "diffSide": "RIGHT", "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToyOTozOFrOG9E6Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwOToyMjoyNVrOG-HM1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5NjcwNg==", "bodyText": "nit: would be tiny bit simpler to do decrement remaining instead", "url": "https://github.com/netty/netty/pull/10453#discussion_r466696706", "createdAt": "2020-08-06T21:29:38Z", "author": {"login": "njhill"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,28 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                int totalWritten = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dca3becd3fb962eca8f797eb74b8012ce1ffdab7"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg1MzA1MA==", "bodyText": "@njhill sorry do you mean decrement localsize variable or something like this:\nint remaining = localsize;\nlong position = fileChannel.position();\nint index = buffer.readerIndex();\nwhile (remaining > 0) {\n   int written = buffer.getBytes(index, fileChannel, position, remaining);\n   if (written < 0) {\n      break;\n   }\n   remaining -= written;\n   position += written;\n   index += written;\n}\nfileChannel.position(position);\nbuffer.readerIndex(index);\nsize += localsize - remaining;", "url": "https://github.com/netty/netty/pull/10453#discussion_r466853050", "createdAt": "2020-08-07T06:46:54Z", "author": {"login": "amizurov"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,28 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                int totalWritten = 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5NjcwNg=="}, "originalCommit": {"oid": "dca3becd3fb962eca8f797eb74b8012ce1ffdab7"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA4Njk4Nw==", "bodyText": "@amizurov yes exactly, except to match the current logic the last line would still be just\nsize += localsize;\nBut noticing that, it looks like this current (now merged) logic is actually slightly wrong and that (ignoring the remaining suggestion) this would be more correct:\nsize += totalWritten;\ni.e. to keep state consistent in the case where we exit prematurely due to written < 0 (not sure it's realistic case but since we're handling it, should be done correctly)\nWDYT? (cc @normanmaurer)", "url": "https://github.com/netty/netty/pull/10453#discussion_r467086987", "createdAt": "2020-08-07T14:45:59Z", "author": {"login": "njhill"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,28 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                int totalWritten = 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5NjcwNg=="}, "originalCommit": {"oid": "dca3becd3fb962eca8f797eb74b8012ce1ffdab7"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA4NzU5Mw==", "bodyText": "@njhill yeah... Want to do a PR ?", "url": "https://github.com/netty/netty/pull/10453#discussion_r467087593", "createdAt": "2020-08-07T14:46:53Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,28 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                int totalWritten = 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5NjcwNg=="}, "originalCommit": {"oid": "dca3becd3fb962eca8f797eb74b8012ce1ffdab7"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzc4Mjg3MQ==", "bodyText": "@njhill, @normanmaurer  I'll create separate PR with code above if you don't mind", "url": "https://github.com/netty/netty/pull/10453#discussion_r467782871", "createdAt": "2020-08-10T09:22:25Z", "author": {"login": "amizurov"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java", "diffHunk": "@@ -156,17 +156,28 @@ public void addContent(ByteBuf buffer, boolean last)\n                     throw new IOException(\"Out of size: \" + (size + localsize) +\n                             \" > \" + definedSize);\n                 }\n-                int written = 0;\n                 if (file == null) {\n                     file = tempFile();\n                 }\n                 if (fileChannel == null) {\n                     RandomAccessFile accessFile = new RandomAccessFile(file, \"rw\");\n                     fileChannel = accessFile.getChannel();\n                 }\n-                buffer.getBytes(buffer.readerIndex(), fileChannel, fileChannel.position(), localsize);\n+                int totalWritten = 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5NjcwNg=="}, "originalCommit": {"oid": "dca3becd3fb962eca8f797eb74b8012ce1ffdab7"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3861, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}