{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NjI2MTE4", "number": 10646, "title": "Provide new client and server websocket handshake exceptions", "bodyText": "Motivation:\nAt the moment we have only one base WebSocketHandshakeException for handling WebSocket upgrade issues.\nUnfortunately, this message contains only a string message about the cause of the failure, which is inconvenient in handling.\nModification:\nProvide new WebSocketClientHandshakeException with HttpResponse field  and WebSocketServerHandshakeException with HttpRequest field both of them without content for avoid reference counting\nproblems.\nResult:\nMore information for more flexible handling.\nFixes #10277 #4528 #10639.", "createdAt": "2020-10-06T15:13:06Z", "url": "https://github.com/netty/netty/pull/10646", "merged": true, "mergeCommit": {"oid": "33de96f4487c594c243cfc138be4592a51651451"}, "closed": true, "closedAt": "2020-10-24T12:41:11Z", "author": {"login": "amizurov"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQCp_fAFqTUwMzQ2NDE3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTGSFngH2gAyNDk4NjI2MTE4OmRiMTE3ZTAxMjA3YzhhNWJhZmMwMDY5YzBiOWMyY2Y3OTNhZDY1ZGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNDY0MTc3", "url": "https://github.com/netty/netty/pull/10646#pullrequestreview-503464177", "createdAt": "2020-10-07T01:25:41Z", "commit": {"oid": "5cf96782b5039ae00b510b5ba11ac7a1456a9642"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwMToyNTo0MVrOHdfVfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwMToyNTo0MVrOHdfVfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY4NDE1OQ==", "bodyText": "IMHO, I don't think the extra allow*HandshakeException flags are necessary, since both WebSocketClientHandshakeException and WebSocketServerHandshakeException extend WebSocketHandshakeException. I mean, catch (WebSocketHandshakeException e) and e instanceof WebSocketHandshakeException will still work. I hope no one is using e.getClass() == WebSocketHandshakeException.class. I think the extra flags just complicate the code without much benefit.", "url": "https://github.com/netty/netty/pull/10646#discussion_r500684159", "createdAt": "2020-10-07T01:25:41Z", "author": {"login": "philsttr"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshaker.java", "diffHunk": "@@ -144,13 +146,44 @@ protected WebSocketClientHandshaker(URI uri, WebSocketVersion version, String su\n     protected WebSocketClientHandshaker(URI uri, WebSocketVersion version, String subprotocol,\n                                         HttpHeaders customHeaders, int maxFramePayloadLength,\n                                         long forceCloseTimeoutMillis, boolean absoluteUpgradeUrl) {\n+        this(uri, version, subprotocol, customHeaders, maxFramePayloadLength, forceCloseTimeoutMillis,\n+             false, false);\n+    }\n+\n+    /**\n+     * Base constructor\n+     *\n+     * @param uri\n+     *            URL for web socket communications. e.g \"ws://myhost.com/mypath\". Subsequent web socket frames will be\n+     *            sent to this URL.\n+     * @param version\n+     *            Version of web socket specification to use to connect to the server\n+     * @param subprotocol\n+     *            Sub protocol request sent to the server.\n+     * @param customHeaders\n+     *            Map of custom headers to add to the client request\n+     * @param maxFramePayloadLength\n+     *            Maximum length of a frame's payload\n+     * @param forceCloseTimeoutMillis\n+     *            Close the connection if it was not closed by the server after timeout specified\n+     * @param  absoluteUpgradeUrl\n+     *            Use an absolute url for the Upgrade request, typically when connecting through an HTTP proxy over\n+     *            clear HTTP\n+     * @param  allowClientHandshakeException\n+     *             Whether to return a basic {@link WebSocketHandshakeException}\n+     *             or client {@link WebSocketClientHandshakeException} that contains a http response", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cf96782b5039ae00b510b5ba11ac7a1456a9642"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNDY0MzI4", "url": "https://github.com/netty/netty/pull/10646#pullrequestreview-503464328", "createdAt": "2020-10-07T01:26:12Z", "commit": {"oid": "5cf96782b5039ae00b510b5ba11ac7a1456a9642"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwMToyNjoxMlrOHdfWCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwMToyNjoxMlrOHdfWCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY4NDI5Ng==", "bodyText": "probably not desired", "url": "https://github.com/netty/netty/pull/10646#discussion_r500684296", "createdAt": "2020-10-07T01:26:12Z", "author": {"login": "philsttr"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshaker00.java", "diffHunk": "@@ -27,6 +27,7 @@\n import io.netty.handler.codec.http.HttpResponseStatus;\n import io.netty.handler.codec.http.HttpVersion;\n import io.netty.util.AsciiString;\n+import sun.security.provider.certpath.OCSPResponse.ResponseStatus;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cf96782b5039ae00b510b5ba11ac7a1456a9642"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NzUzOTkx", "url": "https://github.com/netty/netty/pull/10646#pullrequestreview-504753991", "createdAt": "2020-10-08T12:58:58Z", "commit": {"oid": "7346a0ce68cca23301689e23209c0d3c88eb5e1c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMjo1ODo1OVrOHedTfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMzoyMzo1MlrOHeeXvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTY5OTQ1Mg==", "bodyText": "You forgot to include the field value here.", "url": "https://github.com/netty/netty/pull/10646#discussion_r501699452", "createdAt": "2020-10-08T12:58:59Z", "author": {"login": "chrisvest"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolConfig.java", "diffHunk": "@@ -107,7 +114,8 @@ public String toString() {\n             \", sendCloseFrame=\" + sendCloseFrame +\n             \", dropPongFrames=\" + dropPongFrames +\n             \", decoderConfig=\" + decoderConfig +\n-            \"}\";\n+            \", allowServerHandshakeException=\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7346a0ce68cca23301689e23209c0d3c88eb5e1c"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcxNjkyNw==", "bodyText": "I agree, people should not rely on the concrete exception type such that we cannot throw a sub-class instead.", "url": "https://github.com/netty/netty/pull/10646#discussion_r501716927", "createdAt": "2020-10-08T13:23:52Z", "author": {"login": "chrisvest"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshaker.java", "diffHunk": "@@ -144,13 +146,44 @@ protected WebSocketClientHandshaker(URI uri, WebSocketVersion version, String su\n     protected WebSocketClientHandshaker(URI uri, WebSocketVersion version, String subprotocol,\n                                         HttpHeaders customHeaders, int maxFramePayloadLength,\n                                         long forceCloseTimeoutMillis, boolean absoluteUpgradeUrl) {\n+        this(uri, version, subprotocol, customHeaders, maxFramePayloadLength, forceCloseTimeoutMillis,\n+             false, false);\n+    }\n+\n+    /**\n+     * Base constructor\n+     *\n+     * @param uri\n+     *            URL for web socket communications. e.g \"ws://myhost.com/mypath\". Subsequent web socket frames will be\n+     *            sent to this URL.\n+     * @param version\n+     *            Version of web socket specification to use to connect to the server\n+     * @param subprotocol\n+     *            Sub protocol request sent to the server.\n+     * @param customHeaders\n+     *            Map of custom headers to add to the client request\n+     * @param maxFramePayloadLength\n+     *            Maximum length of a frame's payload\n+     * @param forceCloseTimeoutMillis\n+     *            Close the connection if it was not closed by the server after timeout specified\n+     * @param  absoluteUpgradeUrl\n+     *            Use an absolute url for the Upgrade request, typically when connecting through an HTTP proxy over\n+     *            clear HTTP\n+     * @param  allowClientHandshakeException\n+     *             Whether to return a basic {@link WebSocketHandshakeException}\n+     *             or client {@link WebSocketClientHandshakeException} that contains a http response", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY4NDE1OQ=="}, "originalCommit": {"oid": "5cf96782b5039ae00b510b5ba11ac7a1456a9642"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29", "author": {"user": {"login": "amizurov", "name": "Andrey Mizurov"}}, "url": "https://github.com/netty/netty/commit/ea2d75e2b9c98a1f05cceed770dec4535d06af29", "committedDate": "2020-10-09T14:09:59Z", "message": "Provide new client and server websocket handshake exceptions for handling upgrade issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7346a0ce68cca23301689e23209c0d3c88eb5e1c", "author": {"user": {"login": "amizurov", "name": "Andrey Mizurov"}}, "url": "https://github.com/netty/netty/commit/7346a0ce68cca23301689e23209c0d3c88eb5e1c", "committedDate": "2020-10-07T07:05:19Z", "message": "Fix redundant import"}, "afterCommit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29", "author": {"user": {"login": "amizurov", "name": "Andrey Mizurov"}}, "url": "https://github.com/netty/netty/commit/ea2d75e2b9c98a1f05cceed770dec4535d06af29", "committedDate": "2020-10-09T14:09:59Z", "message": "Provide new client and server websocket handshake exceptions for handling upgrade issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MzU3Njk1", "url": "https://github.com/netty/netty/pull/10646#pullrequestreview-506357695", "createdAt": "2020-10-12T07:29:20Z", "commit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzoyOToyMFrOHfyOFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNzozMDo0MlrOHfyQ3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA5MDcwOQ==", "bodyText": "I wonder if it would be better to expose the protocol, status and headers directly here. This would make it clear that this HttpResponse is never a FullHttpResponse and so not needs to be released. WDYT ?", "url": "https://github.com/netty/netty/pull/10646#discussion_r503090709", "createdAt": "2020-10-12T07:29:20Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshakeException.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpResponse;\n+import io.netty.handler.codec.http.HttpResponse;\n+\n+/**\n+ * Client exception during handshaking process.\n+ */\n+public class WebSocketClientHandshakeException extends WebSocketHandshakeException {\n+\n+    private static final long serialVersionUID = 1L;\n+\n+    private final HttpResponse response;\n+\n+    public WebSocketClientHandshakeException(String message) {\n+        this(message, null);\n+    }\n+\n+    public WebSocketClientHandshakeException(String message, HttpResponse httpResponse) {\n+        super(message);\n+        if (httpResponse != null) {\n+            response = new DefaultHttpResponse(httpResponse.protocolVersion(),\n+                                               httpResponse.status(), httpResponse.headers());\n+        } else {\n+            response = null;\n+        }\n+    }\n+\n+    /**\n+     * Returns a {@link HttpResponse response} if exception occurs during response validation otherwise {@code null}.\n+     */\n+    public HttpResponse response() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA5MDg0OA==", "bodyText": "final", "url": "https://github.com/netty/netty/pull/10646#discussion_r503090848", "createdAt": "2020-10-12T07:29:38Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshakeException.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpResponse;\n+import io.netty.handler.codec.http.HttpResponse;\n+\n+/**\n+ * Client exception during handshaking process.\n+ */\n+public class WebSocketClientHandshakeException extends WebSocketHandshakeException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA5MTMzNQ==", "bodyText": "final", "url": "https://github.com/netty/netty/pull/10646#discussion_r503091335", "createdAt": "2020-10-12T07:30:32Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerHandshakeException.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpRequest;\n+import io.netty.handler.codec.http.HttpRequest;\n+\n+/**\n+ * Server exception during handshaking process\n+ */\n+public class WebSocketServerHandshakeException extends WebSocketHandshakeException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA5MTQyMw==", "bodyText": "Same comment as above", "url": "https://github.com/netty/netty/pull/10646#discussion_r503091423", "createdAt": "2020-10-12T07:30:42Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerHandshakeException.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpRequest;\n+import io.netty.handler.codec.http.HttpRequest;\n+\n+/**\n+ * Server exception during handshaking process\n+ */\n+public class WebSocketServerHandshakeException extends WebSocketHandshakeException {\n+\n+    private static final long serialVersionUID = 1L;\n+\n+    private final HttpRequest request;\n+\n+    public WebSocketServerHandshakeException(String message) {\n+        this(message, null);\n+    }\n+\n+    public WebSocketServerHandshakeException(String message, HttpRequest httpRequest) {\n+        super(message);\n+        if (httpRequest != null) {\n+            request = new DefaultHttpRequest(httpRequest.protocolVersion(), httpRequest.method(),\n+                                             httpRequest.uri(), httpRequest.headers());\n+        } else {\n+            request = null;\n+        }\n+    }\n+\n+    /**\n+     * Returns a {@link HttpRequest request} if exception occurs during request validation otherwise {@code null}.\n+     */\n+    public HttpRequest request() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea2d75e2b9c98a1f05cceed770dec4535d06af29"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50e06ec690f4e91667f197962c70dc6c6abb8cd6", "author": {"user": {"login": "amizurov", "name": "Andrey Mizurov"}}, "url": "https://github.com/netty/netty/commit/50e06ec690f4e91667f197962c70dc6c6abb8cd6", "committedDate": "2020-10-12T08:52:10Z", "message": "Fix PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d48a1004a99c31e983815277d31314477935a31", "author": {"user": {"login": "amizurov", "name": "Andrey Mizurov"}}, "url": "https://github.com/netty/netty/commit/9d48a1004a99c31e983815277d31314477935a31", "committedDate": "2020-10-12T09:24:26Z", "message": "Added summary to exceptions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzcyMjQ3", "url": "https://github.com/netty/netty/pull/10646#pullrequestreview-510372247", "createdAt": "2020-10-16T11:09:35Z", "commit": {"oid": "9d48a1004a99c31e983815277d31314477935a31"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMTowOTozNVrOHi2QRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMToxMTozNlrOHi2W0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjMwMjUzMg==", "bodyText": "This exception does not contain ....", "url": "https://github.com/netty/netty/pull/10646#discussion_r506302532", "createdAt": "2020-10-16T11:09:35Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshakeException.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpResponse;\n+import io.netty.handler.codec.http.FullHttpResponse;\n+import io.netty.handler.codec.http.HttpResponse;\n+import io.netty.util.ReferenceCounted;\n+\n+/**\n+ * Client exception during handshaking process.\n+ *\n+ *  <p><b>IMPORTANT</b>: This exception should not contains any {@link ReferenceCounted} fields", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d48a1004a99c31e983815277d31314477935a31"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjMwMzI3OQ==", "bodyText": "This exception does not contain any", "url": "https://github.com/netty/netty/pull/10646#discussion_r506303279", "createdAt": "2020-10-16T11:10:26Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerHandshakeException.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpRequest;\n+import io.netty.handler.codec.http.FullHttpRequest;\n+import io.netty.handler.codec.http.HttpRequest;\n+import io.netty.util.ReferenceCounted;\n+\n+/**\n+ * Server exception during handshaking process.\n+ *\n+ * <p><b>IMPORTANT</b>: This exception should not contains any {@link ReferenceCounted} fields", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d48a1004a99c31e983815277d31314477935a31"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjMwNDAzOA==", "bodyText": "let's make the constructors package-private and add:\nassert !(httpRequest instanceof ReferenceCounted);", "url": "https://github.com/netty/netty/pull/10646#discussion_r506304038", "createdAt": "2020-10-16T11:11:24Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerHandshakeException.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpRequest;\n+import io.netty.handler.codec.http.FullHttpRequest;\n+import io.netty.handler.codec.http.HttpRequest;\n+import io.netty.util.ReferenceCounted;\n+\n+/**\n+ * Server exception during handshaking process.\n+ *\n+ * <p><b>IMPORTANT</b>: This exception should not contains any {@link ReferenceCounted} fields\n+ * e.g. {@link FullHttpRequest}, so no special treatment is needed.\n+ */\n+public final class WebSocketServerHandshakeException extends WebSocketHandshakeException {\n+\n+    private static final long serialVersionUID = 1L;\n+\n+    private final HttpRequest request;\n+\n+    public WebSocketServerHandshakeException(String message) {\n+        this(message, null);\n+    }\n+\n+    public WebSocketServerHandshakeException(String message, HttpRequest httpRequest) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d48a1004a99c31e983815277d31314477935a31"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjMwNDIxMA==", "bodyText": "assert !(httpRequest instanceof ReferenceCounted); and make constructors package private for now", "url": "https://github.com/netty/netty/pull/10646#discussion_r506304210", "createdAt": "2020-10-16T11:11:36Z", "author": {"login": "normanmaurer"}, "path": "codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshakeException.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 The Netty Project\n+ *\n+ * The Netty Project licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package io.netty.handler.codec.http.websocketx;\n+\n+import io.netty.handler.codec.http.DefaultHttpResponse;\n+import io.netty.handler.codec.http.FullHttpResponse;\n+import io.netty.handler.codec.http.HttpResponse;\n+import io.netty.util.ReferenceCounted;\n+\n+/**\n+ * Client exception during handshaking process.\n+ *\n+ *  <p><b>IMPORTANT</b>: This exception should not contains any {@link ReferenceCounted} fields\n+ *  e.g. {@link FullHttpResponse}, so no special treatment is needed.\n+ */\n+public final class WebSocketClientHandshakeException extends WebSocketHandshakeException {\n+\n+    private static final long serialVersionUID = 1L;\n+\n+    private final HttpResponse response;\n+\n+    public WebSocketClientHandshakeException(String message) {\n+        this(message, null);\n+    }\n+\n+    public WebSocketClientHandshakeException(String message, HttpResponse httpResponse) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d48a1004a99c31e983815277d31314477935a31"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db117e01207c8a5bafc0069c0b9c2cf793ad65dd", "author": {"user": {"login": "amizurov", "name": "Andrey Mizurov"}}, "url": "https://github.com/netty/netty/commit/db117e01207c8a5bafc0069c0b9c2cf793ad65dd", "committedDate": "2020-10-16T13:20:59Z", "message": "Fix summary text"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4901, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}