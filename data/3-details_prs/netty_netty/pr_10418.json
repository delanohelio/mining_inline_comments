{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMzUxMDUx", "number": 10418, "title": "Making AES_128_GCM_SHA256 have a higher priority over CHACHA20_POLY1305_SHA256 on HTTP2", "bodyText": "Motivation:\nFrom the recent benchmark using gRPC-Java based on Netty's HTTP2, it appears that it prefers ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 over ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 since it uses the Netty HTTPS Cipher list as is. Both are considered safe but ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 has a good chance to get more optimized implementation. (e.g. AES-NI) When running both on GCP Intel Haswell VM, TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 spent 3x CPU time than TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256. (Note that this VM supports AES-NI)\nFrom the cipher suites listed on Intermediate compatibility (recommended) of Security/Server Side TLS, they have a cipher preference which is aligned with this PR.\n0x13,0x01  -  TLS_AES_128_GCM_SHA256         TLSv1.3  Kx=any   Au=any    Enc=AESGCM(128)             Mac=AEAD\n0x13,0x02  -  TLS_AES_256_GCM_SHA384         TLSv1.3  Kx=any   Au=any    Enc=AESGCM(256)             Mac=AEAD\n0x13,0x03  -  TLS_CHACHA20_POLY1305_SHA256   TLSv1.3  Kx=any   Au=any    Enc=CHACHA20/POLY1305(256)  Mac=AEAD\n0xC0,0x2B  -  ECDHE-ECDSA-AES128-GCM-SHA256  TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=AESGCM(128)             Mac=AEAD\n0xC0,0x2F  -  ECDHE-RSA-AES128-GCM-SHA256    TLSv1.2  Kx=ECDH  Au=RSA    Enc=AESGCM(128)             Mac=AEAD\n0xC0,0x2C  -  ECDHE-ECDSA-AES256-GCM-SHA384  TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=AESGCM(256)             Mac=AEAD\n0xC0,0x30  -  ECDHE-RSA-AES256-GCM-SHA384    TLSv1.2  Kx=ECDH  Au=RSA    Enc=AESGCM(256)             Mac=AEAD\n0xCC,0xA9  -  ECDHE-ECDSA-CHACHA20-POLY1305  TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=CHACHA20/POLY1305(256)  Mac=AEAD\n0xCC,0xA8  -  ECDHE-RSA-CHACHA20-POLY1305    TLSv1.2  Kx=ECDH  Au=RSA    Enc=CHACHA20/POLY1305(256)  Mac=AEAD\n0x00,0x9E  -  DHE-RSA-AES128-GCM-SHA256      TLSv1.2  Kx=DH    Au=RSA    Enc=AESGCM(128)             Mac=AEAD\n0x00,0x9F  -  DHE-RSA-AES256-GCM-SHA384      TLSv1.2  Kx=DH    Au=RSA    Enc=AESGCM(256)             Mac=AEAD\n\nModification:\nMoving up AES_128_GCM_SHA256 in the CIPHERS of HTTPS so that it gets priority.\nResult:\nWhen connecting to the server supporting both ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 and ECDSA_WITH_CHACHA20_POLY1305_SHA256 and respecting the client priority of cipher suites, it will be able to save significant cpu time when running it on machines with AES-NI support.", "createdAt": "2020-07-17T18:37:13Z", "url": "https://github.com/netty/netty/pull/10418", "merged": true, "mergeCommit": {"oid": "573ff0a33eeb574a12bc1bcee0579f7f0969c669"}, "closed": true, "closedAt": "2020-08-03T05:49:55Z", "author": {"login": "veblush"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc13uEbAH2gAyNDUxMzUxMDUxOjNhNzE1MjQ3OTVjZmQzMDE0NzRjODVmMmEyZThkYjM0NjUyNTRhY2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc16Rx9gFqTQ1MDk1MzQ1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3a71524795cfd301474c85f2a2e8db3465254acb", "author": {"user": {"login": "veblush", "name": "Esun Kim"}}, "url": "https://github.com/netty/netty/commit/3a71524795cfd301474c85f2a2e8db3465254acb", "committedDate": "2020-07-17T17:59:10Z", "message": "Adjust the order or ciphersuites for HTTP2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwODgzMjgw", "url": "https://github.com/netty/netty/pull/10418#pullrequestreview-450883280", "createdAt": "2020-07-17T18:47:14Z", "commit": {"oid": "3a71524795cfd301474c85f2a2e8db3465254acb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODo0NzoxNFrOGzdnCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxODo0NzoxNFrOGzdnCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYxNTY5MA==", "bodyText": "It seems we should keep the REQUIRED BY HTTP/2 SPEC comment.", "url": "https://github.com/netty/netty/pull/10418#discussion_r456615690", "createdAt": "2020-07-17T18:47:14Z", "author": {"login": "ejona86"}, "path": "codec-http2/src/main/java/io/netty/handler/codec/http2/Http2SecurityUtil.java", "diffHunk": "@@ -49,21 +49,18 @@\n      */\n     private static final List<String> CIPHERS_JAVA_MOZILLA_MODERN_SECURITY = Collections.unmodifiableList(Arrays\n             .asList(\n+            /* openssl = ECDHE-ECDSA-AES128-GCM-SHA256 */\n+            \"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\n+            /* openssl = ECDHE-RSA-AES128-GCM-SHA256 */\n+            \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a71524795cfd301474c85f2a2e8db3465254acb"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d8b7bee6120e2e27ec04246bb2ef1e3df040e41", "author": {"user": {"login": "veblush", "name": "Esun Kim"}}, "url": "https://github.com/netty/netty/commit/1d8b7bee6120e2e27ec04246bb2ef1e3df040e41", "committedDate": "2020-07-17T20:48:00Z", "message": "Update by review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwOTUzNDUx", "url": "https://github.com/netty/netty/pull/10418#pullrequestreview-450953451", "createdAt": "2020-07-17T20:57:59Z", "commit": {"oid": "1d8b7bee6120e2e27ec04246bb2ef1e3df040e41"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 160, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}