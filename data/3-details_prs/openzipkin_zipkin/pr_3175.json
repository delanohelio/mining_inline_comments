{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4Mzg5MjIz", "number": 3175, "title": "Uses prepared statements for all Cassandra Queries", "bodyText": "In #3156, we stopped using prepared statements for simple queries for\nreasons including a bug in logging, which is now fixed. This restores\nuse of prepared statements for all Cassandra queries and backfills\nrationale of why this helps.", "createdAt": "2020-08-16T02:55:02Z", "url": "https://github.com/openzipkin/zipkin/pull/3175", "merged": true, "mergeCommit": {"oid": "73bd8652480faea803aafcda4ea4e6efc10f5f4c"}, "closed": true, "closedAt": "2020-08-17T03:53:41Z", "author": {"login": "codefromthecrypt"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_UxnEAFqTQ2ODAyOTcyOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc_owLMAH2gAyNDY4Mzg5MjIzOjNmZmIyMzM2MjEzMjI2YzA3NjU4YjY4ZDNhOGY4NTI1ZDVhYTg1NzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDI5NzI5", "url": "https://github.com/openzipkin/zipkin/pull/3175#pullrequestreview-468029729", "createdAt": "2020-08-16T02:55:36Z", "commit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1NTozNlrOHBPEQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1NTozNlrOHBPEQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTA1NzQ3Mg==", "bodyText": "as I was updating anyway, I bumped other versions rather than a mosquito-bite pull request later.", "url": "https://github.com/openzipkin/zipkin/pull/3175#discussion_r471057472", "createdAt": "2020-08-16T02:55:36Z", "author": {"login": "codefromthecrypt"}, "path": "pom.xml", "diffHunk": "@@ -60,17 +60,16 @@\n     <wire.version>3.0.2</wire.version>\n     <unpack-proto.directory>${project.build.directory}/test/proto</unpack-proto.directory>\n \n-    <cassandra-driver-core.version>3.10.0</cassandra-driver-core.version>\n+    <cassandra-driver-core.version>3.10.1</cassandra-driver-core.version>\n     <jooq.version>3.13.4</jooq.version>\n-    <micrometer.version>1.5.3</micrometer.version>\n-    <spring-boot.version>2.3.2.RELEASE</spring-boot.version>\n+    <micrometer.version>1.5.4</micrometer.version>\n+    <spring-boot.version>2.3.3.RELEASE</spring-boot.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDI5NzQ2", "url": "https://github.com/openzipkin/zipkin/pull/3175#pullrequestreview-468029746", "createdAt": "2020-08-16T02:56:01Z", "commit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1NjowMlrOHBPEYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1NjowMlrOHBPEYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTA1NzUwNg==", "bodyText": "this comment is no longer valid as only zipkin core lib has a <1.8 requirement", "url": "https://github.com/openzipkin/zipkin/pull/3175#discussion_r471057506", "createdAt": "2020-08-16T02:56:02Z", "author": {"login": "codefromthecrypt"}, "path": "pom.xml", "diffHunk": "@@ -60,17 +60,16 @@\n     <wire.version>3.0.2</wire.version>\n     <unpack-proto.directory>${project.build.directory}/test/proto</unpack-proto.directory>\n \n-    <cassandra-driver-core.version>3.10.0</cassandra-driver-core.version>\n+    <cassandra-driver-core.version>3.10.1</cassandra-driver-core.version>\n     <jooq.version>3.13.4</jooq.version>\n-    <micrometer.version>1.5.3</micrometer.version>\n-    <spring-boot.version>2.3.2.RELEASE</spring-boot.version>\n+    <micrometer.version>1.5.4</micrometer.version>\n+    <spring-boot.version>2.3.3.RELEASE</spring-boot.version>\n     <!-- MySQL connector is GPL, even if it has an OSS exception.\n          https://www.mysql.com/about/legal/licensing/foss-exception/\n \n          MariaDB has a friendlier license, LGPL, which is less scary in audits.\n     -->\n     <mariadb-java-client.version>2.6.2</mariadb-java-client.version>\n-    <!-- Java 8 dep, which is ok as zipkin-mysql is Java 8 anyway -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDI5Nzc4", "url": "https://github.com/openzipkin/zipkin/pull/3175#pullrequestreview-468029778", "createdAt": "2020-08-16T02:57:04Z", "commit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1NzowNFrOHBPEnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1NzowNFrOHBPEnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTA1NzU2Nw==", "bodyText": "I noticed we never used references for the main table! This allows reference search when you are trying to figure out impact of a table. Using text is less precise as the word \"traces\" is too common", "url": "https://github.com/openzipkin/zipkin/pull/3175#discussion_r471057567", "createdAt": "2020-08-16T02:57:04Z", "author": {"login": "codefromthecrypt"}, "path": "zipkin-storage/cassandra-v1/src/main/java/zipkin2/storage/cassandra/v1/InsertTrace.java", "diffHunk": "@@ -51,7 +53,7 @@\n       this.session = session;\n       this.timestampCodec = new TimestampCodec(session);\n       Insert insertQuery =\n-          QueryBuilder.insertInto(\"traces\")\n+          QueryBuilder.insertInto(TRACES)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDI5ODE2", "url": "https://github.com/openzipkin/zipkin/pull/3175#pullrequestreview-468029816", "createdAt": "2020-08-16T02:58:43Z", "commit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1ODo0M1rOHBPE7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNlQwMjo1ODo0M1rOHBPE7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTA1NzY0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * supports {@link SelectFromTraces}.\n          \n          \n            \n               * {@link SelectFromTraces}.", "url": "https://github.com/openzipkin/zipkin/pull/3175#discussion_r471057647", "createdAt": "2020-08-16T02:58:43Z", "author": {"login": "codefromthecrypt"}, "path": "zipkin-storage/cassandra-v1/src/main/java/zipkin2/storage/cassandra/v1/Tables.java", "diffHunk": "@@ -14,11 +14,17 @@\n package zipkin2.storage.cassandra.v1;\n \n import zipkin2.Span;\n+import zipkin2.internal.V1ThriftSpanWriter;\n import zipkin2.storage.AutocompleteTags;\n import zipkin2.storage.QueryRequest;\n import zipkin2.storage.ServiceAndSpanNames;\n \n final class Tables {\n+  /**\n+   * This table includes {@linkplain V1ThriftSpanWriter thrift-encoded} spans, supporting\n+   * supports {@link SelectFromTraces}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13f9a4e5834310538e7bd2f6ac071cb44a75b4bb"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDMxMDg2", "url": "https://github.com/openzipkin/zipkin/pull/3175#pullrequestreview-468031086", "createdAt": "2020-08-16T03:41:49Z", "commit": {"oid": "8d774611c6c84e3df77f930c04bbd52a28a6188f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDYwMDg3", "url": "https://github.com/openzipkin/zipkin/pull/3175#pullrequestreview-468060087", "createdAt": "2020-08-16T12:24:51Z", "commit": {"oid": "f3a2d275cf1fe7562348a018170c14b603ccbb28"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d93ffd0e197c2d207f2b3de92424182218d6e288", "author": {"user": null}, "url": "https://github.com/openzipkin/zipkin/commit/d93ffd0e197c2d207f2b3de92424182218d6e288", "committedDate": "2020-08-17T01:58:08Z", "message": "Uses prepared statements for all Cassandra Queries\n\nIn #3156, we stopped using prepared statements for simple queries for\nreasons including a bug in logging, which is now fixed. This restores\nuse of prepared statements for all Cassandra queries and backfills\nrationale of why this helps."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3a2d275cf1fe7562348a018170c14b603ccbb28", "author": {"user": null}, "url": "https://github.com/openzipkin/zipkin/commit/f3a2d275cf1fe7562348a018170c14b603ccbb28", "committedDate": "2020-08-16T12:22:54Z", "message": "tidies and rolls back spring boot things temporarily"}, "afterCommit": {"oid": "d93ffd0e197c2d207f2b3de92424182218d6e288", "author": {"user": null}, "url": "https://github.com/openzipkin/zipkin/commit/d93ffd0e197c2d207f2b3de92424182218d6e288", "committedDate": "2020-08-17T01:58:08Z", "message": "Uses prepared statements for all Cassandra Queries\n\nIn #3156, we stopped using prepared statements for simple queries for\nreasons including a bug in logging, which is now fixed. This restores\nuse of prepared statements for all Cassandra queries and backfills\nrationale of why this helps."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ffb2336213226c07658b68d3a8f8525d5aa8572", "author": {"user": null}, "url": "https://github.com/openzipkin/zipkin/commit/3ffb2336213226c07658b68d3a8f8525d5aa8572", "committedDate": "2020-08-17T02:12:08Z", "message": "test drift"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1503, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}