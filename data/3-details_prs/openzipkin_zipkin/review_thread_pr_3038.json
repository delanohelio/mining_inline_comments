{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NzAyMjMz", "number": 3038, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0Nzo0N1rODooQbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0Nzo0N1rODooQbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTI5MTk5OnYy", "diffSide": "RIGHT", "path": "zipkin-lens/src/util/locale.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0Nzo0N1rOF3SqPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0Nzo0N1rOF3SqPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMTcyNQ==", "bodyText": "guessing this is the key", "url": "https://github.com/openzipkin/zipkin/pull/3038#discussion_r393521725", "createdAt": "2020-03-17T08:47:47Z", "author": {"login": "codefromthecrypt"}, "path": "zipkin-lens/src/util/locale.ts", "diffHunk": "@@ -12,25 +12,49 @@\n  * the License.\n  */\n \n+import { Catalogs, setupI18n } from '@lingui/core';\n+\n+import enMessages from '../translations/en/messages';\n+import esMessages from '../translations/es/messages';\n+import zhCnMessages from '../translations/zh-cn/messages';\n+\n const localeStorageKey = 'localeOverride';\n \n+const catalogs = {\n+  en: enMessages,\n+  es: esMessages,\n+  'zh-cn': zhCnMessages,\n+};\n+\n export function getLocale(): string {\n   const override = localStorage.getItem(localeStorageKey);\n   if (override) {\n     return override;\n   }\n+\n   const browserLanguage = navigator.language.toLowerCase();\n-  // Strip browser language to what we support.\n-  if (browserLanguage === 'en' || browserLanguage.startsWith('en-')) {\n-    return 'en';\n+\n+  if (catalogs.hasOwnProperty(browserLanguage)) {\n+    return browserLanguage;\n   }\n-  if (browserLanguage === 'zh-cn') {\n-    return 'zh-cn';\n+\n+  const hyphenIndex = browserLanguage.indexOf('-');\n+  if (hyphenIndex >= 0) {\n+    const stripped = browserLanguage.substring(0, hyphenIndex);\n+    if (catalogs.hasOwnProperty(stripped)) {\n+      return stripped;\n+    }\n   }\n \n-  return browserLanguage;\n+  // Default to English if we don't support the current browser language.\n+  return 'en';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec21b7589a536d2aebc22f57e55be5b413d462cc"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1332, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}