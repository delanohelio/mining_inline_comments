{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMjYxMzAx", "number": 1561, "title": "[SCB-1748] support colon in path value", "bodyText": "Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Make sure there is a JIRA issue filed for the change (usually before you start working on it).  Trivial changes like typos do not require a JIRA issue.  Your pull request should address just this issue, without pulling in other changes.\n Each commit in the pull request should have a meaningful subject line and body.\n Format the pull request title like [SCB-XXX] Fixes bug in ApproximateQuantiles, where you replace SCB-XXX with the appropriate JIRA issue.\n Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n Run mvn clean install -Pit to make sure basic checks pass. A more thorough check will be performed on your pull request automatically.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.", "createdAt": "2020-02-07T06:50:13Z", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561", "merged": true, "mergeCommit": {"oid": "bdeb9237f7da133fc4c6ed8806b6c5b53fdc3e0d"}, "closed": true, "closedAt": "2020-02-17T00:53:48Z", "author": {"login": "GuoYL123"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcB5-TlgH2gAyMzcyMjYxMzAxOjVjMTczMzczM2ZhY2ZmZTRhNGM3OGQwZDkwZTI5ZDRiYjQzZjBhZTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFCi6jgFqTM1OTQ0NjE3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5c1733733facffe4a4c78d0d90e29d4bb43f0ae7", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/5c1733733facffe4a4c78d0d90e29d4bb43f0ae7", "committedDate": "2020-02-07T07:12:39Z", "message": "[SCB-1748] support colon"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf3842114cfbb46483e36ee140c9675c6612951b", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/bf3842114cfbb46483e36ee140c9675c6612951b", "committedDate": "2020-02-07T06:49:42Z", "message": "[SCB-1748] support colon"}, "afterCommit": {"oid": "5c1733733facffe4a4c78d0d90e29d4bb43f0ae7", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/5c1733733facffe4a4c78d0d90e29d4bb43f0ae7", "committedDate": "2020-02-07T07:12:39Z", "message": "[SCB-1748] support colon"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTk2NTcw", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#pullrequestreview-354996570", "createdAt": "2020-02-07T08:33:07Z", "commit": {"oid": "5c1733733facffe4a4c78d0d90e29d4bb43f0ae7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODozMzowN1rOFm1kZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODozMzowN1rOFm1kZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI2Nzg3OA==", "bodyText": "I think this modification is not correct. You can add a test case for HttpUtils, like\n  @Test\n  public void uriEncode_sss() {\n    String encoded = HttpUtils.uriEncodePath(\"a:b\");\n    Assert.assertEquals(\"a:b\", encoded);\n    Assert.assertEquals(\"a:b\", HttpUtils.uriDecodePath(encoded));\n  }\n\n\nAnd make this case pass.", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#discussion_r376267878", "createdAt": "2020-02-07T08:33:07Z", "author": {"login": "liubao68"}, "path": "common/common-rest/src/main/java/org/apache/servicecomb/common/rest/codec/param/PathProcessorCreator.java", "diffHunk": "@@ -52,6 +54,9 @@ public Object getValue(HttpServletRequest request) {\n       if (value == null) {\n         return null;\n       }\n+      if (value.contains(\":\")) {\n+        return convertValue(URLDecoder.decode(value, \"UTF-8\"), targetType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c1733733facffe4a4c78d0d90e29d4bb43f0ae7"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MTM3MzAy", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#pullrequestreview-357137302", "createdAt": "2020-02-12T01:35:19Z", "commit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMTozNToxOVrOFofHlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMTozNToxOVrOFofHlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk5NzIwNQ==", "bodyText": "remove unused import", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#discussion_r377997205", "createdAt": "2020-02-12T01:35:19Z", "author": {"login": "liubao68"}, "path": "common/common-rest/src/main/java/org/apache/servicecomb/common/rest/codec/param/PathProcessorCreator.java", "diffHunk": "@@ -17,7 +17,9 @@\n \n package org.apache.servicecomb.common.rest.codec.param;\n \n+import java.io.UnsupportedEncodingException;\n import java.lang.reflect.Type;\n+import java.net.URLDecoder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MTM5MDU4", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#pullrequestreview-357139058", "createdAt": "2020-02-12T01:41:01Z", "commit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMTo0MTowMVrOFofNhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMTo0MTowMVrOFofNhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk5ODcyNg==", "bodyText": "Is  URLDecoder.decode(pathParam, \"UTF-8\"); is enough?  I think it is enough to use URLEncoder and URLDecoder to encode/decode path segments, and use URI to encode/decode path.", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#discussion_r377998726", "createdAt": "2020-02-12T01:41:01Z", "author": {"login": "liubao68"}, "path": "foundations/foundation-common/src/main/java/org/apache/servicecomb/foundation/common/http/HttpUtils.java", "diffHunk": "@@ -94,6 +97,14 @@ public static String encodePathParam(String pathParam) {\n     return UrlEscapers.urlPathSegmentEscaper().escape(pathParam);\n   }\n \n+  public static String decodePathParam(String pathParam) throws UnsupportedEncodingException {\n+    String res = uriDecodePath(pathParam);\n+    if (StringUtils.isEmpty(res)) {\n+      return URLDecoder.decode(pathParam, \"UTF-8\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MTM5NDQ4", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#pullrequestreview-357139448", "createdAt": "2020-02-12T01:42:16Z", "commit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMTo0MjoxNlrOFofOuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMTo0MjoxNlrOFofOuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk5OTAzMw==", "bodyText": "This function seems not correct. According to the java docs, URL(path) will not parse the path, users should use\nnew URI(null, null, path, null); to parse the parse", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#discussion_r377999033", "createdAt": "2020-02-12T01:42:16Z", "author": {"login": "liubao68"}, "path": "foundations/foundation-common/src/main/java/org/apache/servicecomb/foundation/common/http/HttpUtils.java", "diffHunk": "@@ -94,6 +97,14 @@ public static String encodePathParam(String pathParam) {\n     return UrlEscapers.urlPathSegmentEscaper().escape(pathParam);\n   }\n \n+  public static String decodePathParam(String pathParam) throws UnsupportedEncodingException {\n+    String res = uriDecodePath(pathParam);\n+    if (StringUtils.isEmpty(res)) {\n+      return URLDecoder.decode(pathParam, \"UTF-8\");\n+    }\n+    return res;\n+  }\n+\n   public static String uriDecodePath(String path) {\n     if (path == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6940be2bd887d55f2b3520587cc6410840f43a76", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/6940be2bd887d55f2b3520587cc6410840f43a76", "committedDate": "2020-02-12T04:26:23Z", "message": "[SCB-1748] modify as comment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bcdbfc4668ca42addfba988bde611a8efc67d752", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/bcdbfc4668ca42addfba988bde611a8efc67d752", "committedDate": "2020-02-10T02:24:02Z", "message": "[SCB-1748] modify as comment"}, "afterCommit": {"oid": "6940be2bd887d55f2b3520587cc6410840f43a76", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/6940be2bd887d55f2b3520587cc6410840f43a76", "committedDate": "2020-02-12T04:26:23Z", "message": "[SCB-1748] modify as comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90a0e38dee162ce7c491f73c33d67e031eee24d0", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/90a0e38dee162ce7c491f73c33d67e031eee24d0", "committedDate": "2020-02-12T06:25:58Z", "message": "Merge remote-tracking branch 'remotes/origin/master' into maohao"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f324478374a65502ee4280efe0fdb77f14e20dc2", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/f324478374a65502ee4280efe0fdb77f14e20dc2", "committedDate": "2020-02-12T08:33:13Z", "message": "test IT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d12e34122c0e8723df67c802eaf618360cdf7760", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/d12e34122c0e8723df67c802eaf618360cdf7760", "committedDate": "2020-02-12T10:40:28Z", "message": "use spring way"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e9a3e928af96a90cded4406a8ea4495bd42373cc", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/e9a3e928af96a90cded4406a8ea4495bd42373cc", "committedDate": "2020-02-12T10:39:56Z", "message": "use spring way"}, "afterCommit": {"oid": "d12e34122c0e8723df67c802eaf618360cdf7760", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/d12e34122c0e8723df67c802eaf618360cdf7760", "committedDate": "2020-02-12T10:40:28Z", "message": "use spring way"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NDQ2MTcw", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1561#pullrequestreview-359446170", "createdAt": "2020-02-17T00:53:39Z", "commit": {"oid": "d12e34122c0e8723df67c802eaf618360cdf7760"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4471, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}