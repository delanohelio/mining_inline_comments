{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwMTI0NTY2", "number": 1885, "title": "[SCB-2043] flow control support leak bucket and token bucket", "bodyText": "Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Make sure there is a JIRA issue filed for the change (usually before you start working on it).  Trivial changes like typos do not require a JIRA issue.  Your pull request should address just this issue, without pulling in other changes.\n Each commit in the pull request should have a meaningful subject line and body.\n Format the pull request title like [SCB-XXX] Fixes bug in ApproximateQuantiles, where you replace SCB-XXX with the appropriate JIRA issue.\n Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n Run mvn clean install -Pit to make sure basic checks pass. A more thorough check will be performed on your pull request automatically.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.", "createdAt": "2020-07-16T11:34:30Z", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885", "merged": true, "mergeCommit": {"oid": "88c24e95746cb143edf2405696004d9946aa04f0"}, "closed": true, "closedAt": "2020-07-20T06:21:13Z", "author": {"login": "GuoYL123"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1eiSIABqjM1NTI5OTcwNTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc2rh5UAFqTQ1MTMyMzIyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f7a485dcd3302266b06e9616f6d3c94245e756f", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/6f7a485dcd3302266b06e9616f6d3c94245e756f", "committedDate": "2020-07-16T11:33:44Z", "message": "[SCB-2043] flow control support leak bucket and token bucket"}, "afterCommit": {"oid": "ff6413195969c618219accad125528090d0550bc", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/ff6413195969c618219accad125528090d0550bc", "committedDate": "2020-07-16T12:38:27Z", "message": "[SCB-2043] flow control support leak bucket and token bucket"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMzk2Mzk3", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#pullrequestreview-450396397", "createdAt": "2020-07-17T06:12:39Z", "commit": {"oid": "ff6413195969c618219accad125528090d0550bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxMjozOVrOGzGm0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxMjozOVrOGzGm0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzODgwMQ==", "bodyText": "wrong", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#discussion_r456238801", "createdAt": "2020-07-17T06:12:39Z", "author": {"login": "liubao68"}, "path": "handlers/handler-router/src/main/java/org/apache/servicecomb/router/custom/RouterInvokeFilter.java", "diffHunk": "@@ -109,7 +109,7 @@ private boolean loadHeaders() {\n   private boolean isHaveHeadersRule() {\n     DynamicStringProperty headerStr = DynamicPropertyFactory.getInstance()\n         .getStringProperty(SERVICECOMB_ROUTER_HEADER, null);\n-    return !StringUtils.isEmpty(headerStr.get());\n+    return !StringUtils.isNotEmpty(headerStr.get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff6413195969c618219accad125528090d0550bc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2ec877a026fcbce90edd68e7578d20f14098b36", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/d2ec877a026fcbce90edd68e7578d20f14098b36", "committedDate": "2020-07-17T06:19:09Z", "message": "[SCB-2043] flow control support leak bucket and token bucket"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff6413195969c618219accad125528090d0550bc", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/ff6413195969c618219accad125528090d0550bc", "committedDate": "2020-07-16T12:38:27Z", "message": "[SCB-2043] flow control support leak bucket and token bucket"}, "afterCommit": {"oid": "d2ec877a026fcbce90edd68e7578d20f14098b36", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/d2ec877a026fcbce90edd68e7578d20f14098b36", "committedDate": "2020-07-17T06:19:09Z", "message": "[SCB-2043] flow control support leak bucket and token bucket"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNDE0MTgw", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#pullrequestreview-450414180", "createdAt": "2020-07-17T06:54:02Z", "commit": {"oid": "d2ec877a026fcbce90edd68e7578d20f14098b36"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjo1NDowMlrOGzHgcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjo1NDowMlrOGzHgcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI1MzU1Mw==", "bodyText": "@Date seems no use, can be removed.", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#discussion_r456253553", "createdAt": "2020-07-17T06:54:02Z", "author": {"login": "liubao68"}, "path": "handlers/handler-flowcontrol-qps/src/main/java/org/apache/servicecomb/qps/strategy/FixedWindowStrategy.java", "diffHunk": "@@ -14,15 +14,14 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-\n-package org.apache.servicecomb.qps;\n+package org.apache.servicecomb.qps.strategy;\n \n import java.util.concurrent.atomic.AtomicLong;\n \n-public class QpsController {\n-  private String key;\n-\n-  private Integer qpsLimit;\n+/**\n+ * @Date 2020/7/8", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2ec877a026fcbce90edd68e7578d20f14098b36"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNDE3ODM4", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#pullrequestreview-450417838", "createdAt": "2020-07-17T07:01:29Z", "commit": {"oid": "d2ec877a026fcbce90edd68e7578d20f14098b36"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNzowMToyOVrOGzHrrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNzowMToyOVrOGzHrrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI1NjQzMA==", "bodyText": "Seems no used.", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#discussion_r456256430", "createdAt": "2020-07-17T07:01:29Z", "author": {"login": "liubao68"}, "path": "handlers/handler-flowcontrol-qps/src/main/java/org/apache/servicecomb/qps/strategy/SlidingWindowStrategy.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.servicecomb.qps.strategy;\n+\n+\n+/**\n+ * @Date 2020/7/8\n+ **/\n+public class SlidingWindowStrategy extends AbstractQpsStrategy {\n+\n+  public SlidingWindowStrategy(long qpsLimit, String key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2ec877a026fcbce90edd68e7578d20f14098b36"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b5ebd2057c157374352d28a8b7f598d01e887cb", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/apache/servicecomb-java-chassis/commit/3b5ebd2057c157374352d28a8b7f598d01e887cb", "committedDate": "2020-07-17T08:27:03Z", "message": "[SCB-2043] modify as comment, change strategy when strategy change."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMzIzMjI3", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1885#pullrequestreview-451323227", "createdAt": "2020-07-20T06:20:56Z", "commit": {"oid": "3b5ebd2057c157374352d28a8b7f598d01e887cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4465, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}