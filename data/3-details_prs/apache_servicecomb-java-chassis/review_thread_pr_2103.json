{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyNDA0ODA5", "number": 2103, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMjo0Mzo0MFrOFBDjFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMjo1MDozMFrOFBDnGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NjUxMDMxOnYy", "diffSide": "RIGHT", "path": "service-registry/registry-local/src/main/java/org/apache/servicecomb/localregistry/LocalRegistryStore.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMjo0Mzo0MFrOH_omqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMjo0Mzo0MFrOH_omqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ4NzU5NQ==", "bodyText": "try (InputStream is = url.openStream()) {\n    if (is != null) {\n      beans.addAll(initFromData(is));\n    }\n  }", "url": "https://github.com/apache/servicecomb-java-chassis/pull/2103#discussion_r536487595", "createdAt": "2020-12-05T02:43:40Z", "author": {"login": "wujimin"}, "path": "service-registry/registry-local/src/main/java/org/apache/servicecomb/localregistry/LocalRegistryStore.java", "diffHunk": "@@ -111,37 +111,38 @@ public MicroserviceInstance getSelfMicroserviceInstance() {\n   private List<RegistryBean> loadYamlBeans() {\n     List<RegistryBean> beans = new ArrayList<>();\n \n-    InputStream is = null;\n-\n     try {\n       ClassLoader loader = JvmUtils.findClassLoader();\n       Enumeration<URL> urls = loader.getResources(REGISTRY_FILE_NAME);\n+\n       while (urls.hasMoreElements()) {\n         URL url = urls.nextElement();\n-        is = url.openStream();\n-        if (is != null) {\n-          beans.addAll(initFromData(is));\n+\n+        InputStream is = null;\n+        try {\n+          is = url.openStream();\n+          if (is != null) {\n+            beans.addAll(initFromData(is));\n+          }\n+        } finally {\n+          if (is != null) {\n+            try {\n+              is.close();\n+            } catch (IOException e) {\n+              // nothing to do\n+            }\n+          }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd50a97c7686e13d71bb4200dc76b76050b38dfc"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NjUyMDU4OnYy", "diffSide": "RIGHT", "path": "service-registry/registry-service-center/src/test/java/org/apache/servicecomb/serviceregistry/client/LocalServiceRegistryClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMjo1MDozMFrOH_orHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMjo1MDozMFrOH_orHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ4ODczNQ==", "bodyText": "\u521b\u5efastream\u7684\u5730\u65b9\u7528try-with-resource\uff0c\u5e94\u8be5\u66f4\u5408\u9002", "url": "https://github.com/apache/servicecomb-java-chassis/pull/2103#discussion_r536488735", "createdAt": "2020-12-05T02:50:30Z", "author": {"login": "wujimin"}, "path": "service-registry/registry-service-center/src/test/java/org/apache/servicecomb/serviceregistry/client/LocalServiceRegistryClientImpl.java", "diffHunk": "@@ -94,10 +95,16 @@ public LocalServiceRegistryClientImpl(Map<String, Object> data) {\n   }\n \n   private void initFromData(InputStream is) {\n-    Yaml yaml = new Yaml();\n-    @SuppressWarnings(\"unchecked\")\n-    Map<String, Object> data = yaml.loadAs(is, Map.class);\n-    initFromData(data);\n+    try {\n+      Map<String, Object> data = YAMLUtil.yaml2Properties(is);\n+      initFromData(data);\n+    } finally {\n+      try {\n+        is.close();\n+      } catch (IOException e) {\n+        LOGGER.error(\"\", e);\n+      }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd50a97c7686e13d71bb4200dc76b76050b38dfc"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1250, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}