{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1NzYyNDgw", "number": 11728, "title": "Resolve null value for Glue fields", "bodyText": "Add null value check for glue fields.", "createdAt": "2020-07-07T23:27:13Z", "url": "https://github.com/Alluxio/alluxio/pull/11728", "merged": true, "mergeCommit": {"oid": "35e8a9dd8476f1994c3f895664ac6a03b68cef5e"}, "closed": true, "closedAt": "2020-07-08T02:09:48Z", "author": {"login": "HelloHorizon"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyuX9fAH2gAyNDQ1NzYyNDgwOjVhYjJiYmIwMDZjZmU3NDBmMDk2YjY1MDEwZDczYTBjYzE0ZWNiNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcywvISgFqTQ0NDM2NDg2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a", "author": {"user": {"login": "HelloHorizon", "name": "Shouwei Chen"}}, "url": "https://github.com/Alluxio/alluxio/commit/5ab2bbb006cfe740f096b65010d73a0cc14ecb5a", "committedDate": "2020-07-07T23:24:06Z", "message": "NPE resolving"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MzIwMTE5", "url": "https://github.com/Alluxio/alluxio/pull/11728#pullrequestreview-444320119", "createdAt": "2020-07-07T23:38:56Z", "commit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMzozODo1NlrOGuTMrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMzo0MjowNFrOGuTQPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIwMjIyMA==", "bodyText": "Instead of creating a new object, we can use Collections.emptyMap()", "url": "https://github.com/Alluxio/alluxio/pull/11728#discussion_r451202220", "createdAt": "2020-07-07T23:38:56Z", "author": {"login": "gpang"}, "path": "table/server/underdb/glue/src/main/java/alluxio/table/under/glue/GlueDatabase.java", "diffHunk": "@@ -305,6 +308,7 @@ public UdbTable getTable(String tableName) throws IOException {\n     // Glue doesn't support column statistics infomation\n     Map<String, List<ColumnStatisticsInfo>> statsMap = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIwMjY5MA==", "bodyText": "Why is this defined so far from when it is used?", "url": "https://github.com/Alluxio/alluxio/pull/11728#discussion_r451202690", "createdAt": "2020-07-07T23:40:32Z", "author": {"login": "gpang"}, "path": "table/server/underdb/glue/src/main/java/alluxio/table/under/glue/GlueDatabase.java", "diffHunk": "@@ -305,6 +308,7 @@ public UdbTable getTable(String tableName) throws IOException {\n     // Glue doesn't support column statistics infomation\n     Map<String, List<ColumnStatisticsInfo>> statsMap = new HashMap<>();\n     try {\n+      List<Column> partitionColumns;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIwMjc3OQ==", "bodyText": "Instead of creating a new object, we can just use Collections.emptyList().", "url": "https://github.com/Alluxio/alluxio/pull/11728#discussion_r451202779", "createdAt": "2020-07-07T23:40:54Z", "author": {"login": "gpang"}, "path": "table/server/underdb/glue/src/main/java/alluxio/table/under/glue/GlueDatabase.java", "diffHunk": "@@ -316,26 +320,33 @@ public UdbTable getTable(String tableName) throws IOException {\n \n       // Glue does not provide column statistic information\n       List<ColumnStatisticsInfo> columnStatisticsData = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIwMjk3Ng==", "bodyText": "If tableParameters does not need to be mutable, then we can just use Collections.emptyMap()", "url": "https://github.com/Alluxio/alluxio/pull/11728#discussion_r451202976", "createdAt": "2020-07-07T23:41:34Z", "author": {"login": "gpang"}, "path": "table/server/underdb/glue/src/main/java/alluxio/table/under/glue/GlueDatabase.java", "diffHunk": "@@ -316,26 +320,33 @@ public UdbTable getTable(String tableName) throws IOException {\n \n       // Glue does not provide column statistic information\n       List<ColumnStatisticsInfo> columnStatisticsData = new ArrayList<>();\n+      Map<String, String> tableParameters = table.getParameters() == null\n+          ? new HashMap<>() : table.getParameters();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTIwMzEzNA==", "bodyText": "Instead of creating a new instance, we can use Collections.emptyList()", "url": "https://github.com/Alluxio/alluxio/pull/11728#discussion_r451203134", "createdAt": "2020-07-07T23:42:04Z", "author": {"login": "gpang"}, "path": "table/server/underdb/glue/src/main/java/alluxio/table/under/glue/GlueDatabase.java", "diffHunk": "@@ -316,26 +320,33 @@ public UdbTable getTable(String tableName) throws IOException {\n \n       // Glue does not provide column statistic information\n       List<ColumnStatisticsInfo> columnStatisticsData = new ArrayList<>();\n+      Map<String, String> tableParameters = table.getParameters() == null\n+          ? new HashMap<>() : table.getParameters();\n \n       PartitionInfo partitionInfo = PartitionInfo.newBuilder()\n+          // Database name is not required for glue table, use mGlueDbName\n           .setDbName(mGlueDbName)\n           .setTableName(tableName)\n           .addAllDataCols(GlueUtils.toProto(table.getStorageDescriptor().getColumns()))\n           .setStorage(GlueUtils.toProto(table.getStorageDescriptor(), pathTranslator))\n-          .putAllParameters(table.getParameters())\n+          .putAllParameters(tableParameters)\n           .build();\n \n       Layout layout = Layout.newBuilder()\n           .setLayoutType(HiveLayout.TYPE)\n           .setLayoutData(partitionInfo.toByteString())\n           .build();\n \n-      List<Column> partitionColumns = table.getPartitionKeys();\n+      if (table.getPartitionKeys() == null) {\n+        partitionColumns = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ab2bbb006cfe740f096b65010d73a0cc14ecb5a"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28bbadd3e1d8419edd6e515b96714d1854d4f219", "author": {"user": {"login": "HelloHorizon", "name": "Shouwei Chen"}}, "url": "https://github.com/Alluxio/alluxio/commit/28bbadd3e1d8419edd6e515b96714d1854d4f219", "committedDate": "2020-07-08T01:21:53Z", "message": "Fix styles"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MzY0ODY1", "url": "https://github.com/Alluxio/alluxio/pull/11728#pullrequestreview-444364865", "createdAt": "2020-07-08T02:09:13Z", "commit": {"oid": "28bbadd3e1d8419edd6e515b96714d1854d4f219"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4255, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}