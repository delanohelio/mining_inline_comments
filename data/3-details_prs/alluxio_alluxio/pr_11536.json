{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyMTA2NDM2", "number": 11536, "title": "Implement stress worker test", "bodyText": "", "createdAt": "2020-06-09T22:54:55Z", "url": "https://github.com/Alluxio/alluxio/pull/11536", "merged": true, "mergeCommit": {"oid": "21445a93afb3d6830c4caf721145654e3cb5904f"}, "closed": true, "closedAt": "2020-06-11T01:00:27Z", "author": {"login": "gpang"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcptIHPAH2gAyNDMyMTA2NDM2OjMwNmEwYzY1MTc1M2NiYjU1Y2I0MTU2ZWU4N2EzNDA1YzZiNDljMWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp9Q-wAFqTQyNzc0MzIwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "306a0c651753cbb55cb4156ee87a3405c6b49c1b", "author": {"user": {"login": "gpang", "name": "Gene Pang"}}, "url": "https://github.com/Alluxio/alluxio/commit/306a0c651753cbb55cb4156ee87a3405c6b49c1b", "committedDate": "2020-06-09T22:51:34Z", "message": "[WIP] Add Stress worker test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NjA1MTg4", "url": "https://github.com/Alluxio/alluxio/pull/11536#pullrequestreview-427605188", "createdAt": "2020-06-09T23:08:01Z", "commit": {"oid": "306a0c651753cbb55cb4156ee87a3405c6b49c1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMzowODowMVrOGhfaBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMzowODowMVrOGhfaBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3MDc1Ng==", "bodyText": "This is a bit odd what's the use case for this?", "url": "https://github.com/Alluxio/alluxio/pull/11536#discussion_r437770756", "createdAt": "2020-06-09T23:08:01Z", "author": {"login": "bradyoo"}, "path": "job/server/src/main/java/alluxio/job/plan/stress/StressBenchDefinition.java", "diffHunk": "@@ -66,12 +67,17 @@ public StressBenchDefinition() {\n \n     // sort copy of workers by hashcode\n     List<WorkerInfo> workerList = Lists.newArrayList(jobWorkerInfoList);\n-    workerList.sort(Comparator.comparingInt(w -> w.getAddress().hashCode()));\n+    workerList.sort(Comparator.comparing(w -> w.getAddress().getHost()));\n     // take the first subset, according to cluster limit\n     int clusterLimit = config.getClusterLimit();\n-    if (clusterLimit <= 0) {\n+    if (clusterLimit == 0) {\n       clusterLimit = workerList.size();\n     }\n+    if (clusterLimit < 0) {\n+      // if negative, reverse the list\n+      clusterLimit = -clusterLimit;\n+      Collections.reverse(workerList);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "306a0c651753cbb55cb4156ee87a3405c6b49c1b"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NzQzMjA2", "url": "https://github.com/Alluxio/alluxio/pull/11536#pullrequestreview-427743206", "createdAt": "2020-06-10T06:25:49Z", "commit": {"oid": "306a0c651753cbb55cb4156ee87a3405c6b49c1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNjoyNTo0OVrOGhmdzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNjoyNTo0OVrOGhmdzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg4NjQxMg==", "bodyText": "Is there a reason we don't use the default of 64m?", "url": "https://github.com/Alluxio/alluxio/pull/11536#discussion_r437886412", "createdAt": "2020-06-10T06:25:49Z", "author": {"login": "ZacBlanco"}, "path": "stress/common/src/main/java/alluxio/stress/worker/WorkerBenchParameters.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * The Alluxio Open Foundation licenses this work under the Apache License, version 2.0\n+ * (the \"License\"). You may not use this work except in compliance with the License, which is\n+ * available at www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * This software is distributed on an \"AS IS\" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,\n+ * either express or implied, as more fully set forth in the License.\n+ *\n+ * See the NOTICE file distributed with this work for information regarding copyright ownership.\n+ */\n+\n+package alluxio.stress.worker;\n+\n+import alluxio.stress.Parameters;\n+\n+import com.beust.jcommander.DynamicParameter;\n+import com.beust.jcommander.Parameter;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+/**\n+ * This holds all the parameters. All fields are public for easier json ser/de without all the\n+ * getters and setters.\n+ */\n+public final class WorkerBenchParameters extends Parameters {\n+  @Parameter(names = {\"--base\"},\n+      description = \"The base directory path URI to perform operations in\")\n+  @Parameters.PathDescription(aliasFieldName = \"mBaseAlias\")\n+  public String mBasePath = \"alluxio://localhost:19998/stress-worker-base\";\n+\n+  @Parameter(names = {\"--base-alias\"}, description = \"The alias for the base path, unused if empty\")\n+  @Parameters.KeylessDescription\n+  public String mBaseAlias = \"\";\n+\n+  @Parameter(names = {\"--tag\"}, description = \"A string to identify this run\")\n+  @Parameters.KeylessDescription\n+  public String mTag = \"\";\n+\n+  @Parameter(names = {\"--clients\"}, description = \"the number of fs clients to use\")\n+  public int mClients = 1;\n+\n+  @Parameter(names = {\"--threads\"}, description = \"the number of threads to use\")\n+  public int mThreads = 256;\n+\n+  @Parameter(names = {\"--duration\"},\n+      description = \"The length of time to run the benchmark. (1m, 10m, 60s, 10000ms, etc.)\")\n+  public String mDuration = \"30s\";\n+\n+  @Parameter(names = {\"--warmup\"},\n+      description = \"The length of time to warmup before recording measurements. (1m, 10m, 60s, \"\n+          + \"10000ms, etc.)\")\n+  public String mWarmup = \"30s\";\n+\n+  @Parameter(names = {\"--file-size\"},\n+      description = \"The files size for IO operations. (1g, 4g, etc.)\")\n+  public String mFileSize = \"128m\";\n+\n+  @Parameter(names = {\"--buffer-size\"},\n+      description = \"The buffer size for IO operations. (1k, 16k, etc.)\")\n+  public String mBufferSize = \"4k\";\n+\n+  @Parameter(names = {\"--block-size\"},\n+      description = \"The size of the file block. (16k, 64m, etc.)\")\n+  public String mBlockSize = \"32m\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "306a0c651753cbb55cb4156ee87a3405c6b49c1b"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4487, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}