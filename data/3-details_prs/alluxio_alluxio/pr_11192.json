{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMjg5NzU4", "number": 11192, "title": "Fix categoryList parsing in docs check", "bodyText": "moved go code in dev/scripts alongside tarball go code and vendored gopkg.in/yaml.v3\nusers can rerun the doc check the same way as jenkins, execute ./dev/scripts/check-docs.sh\ni decided against adding a binary into the dockerfile because it would be clunky to run locally. i don't want to require users to install yq to revalidate the check or require them to run go get that would write files wherever their GOPATH happens to be.", "createdAt": "2020-03-19T23:50:53Z", "url": "https://github.com/Alluxio/alluxio/pull/11192", "merged": true, "mergeCommit": {"oid": "08e6793303d5bb84bac77ad8e9a5461556f969cf"}, "closed": true, "closedAt": "2020-03-31T08:28:32Z", "author": {"login": "Xenorith"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPU-SegFqTM3ODE3MTI1Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcS-bkqgFqTM4NDQ4OTAyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTcxMjUy", "url": "https://github.com/Alluxio/alluxio/pull/11192#pullrequestreview-378171252", "createdAt": "2020-03-20T00:00:57Z", "commit": {"oid": "c91c41712c900352b3f07cd196434204791a282f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMDowMDo1N1rOF5ET9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMDowMDo1N1rOF5ET9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ==", "bodyText": "would it just be easier to add a yaml parsing command line tool in the CI container, and then use that to query for this?\nex:  https://kislyuk.github.io/yq/", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395383799", "createdAt": "2020-03-20T00:00:57Z", "author": {"login": "ZacBlanco"}, "path": "docs/check.go", "diffHunk": "@@ -145,11 +145,16 @@ func parseCategoryNames(configPath string) (StringSet, error) {\n \t\t\tcontinue\n \t\t}\n \t\tif found {\n-\t\t\tif !strings.HasPrefix(l, categoryPrefix) {\n-\t\t\t\tfound = false\n+\t\t\tif strings.HasPrefix(l, commentPrefix) {\n+\t\t\t\t// skip commented lines\n \t\t\t\tcontinue\n \t\t\t}\n-\t\t\tcategoryNames.Add(strings.TrimPrefix(l, categoryPrefix))\n+\t\t\tif strings.HasPrefix(l, categoryPrefix) {\n+\t\t\t\tcategoryNames.Add(strings.TrimPrefix(l, categoryPrefix))\n+\t\t\t\tcontinue\n+\t\t\t}\n+\t\t\t// stop parsing if line is neither comment or category\n+\t\t\tfound = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c91c41712c900352b3f07cd196434204791a282f"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "034bf3e285c719dd989a276a25709be2c92db14c", "author": {"user": {"login": "Xenorith", "name": "Rico Chiu"}}, "url": "https://github.com/Alluxio/alluxio/commit/034bf3e285c719dd989a276a25709be2c92db14c", "committedDate": "2020-03-30T23:07:30Z", "message": "Update docs check with yaml library"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c91c41712c900352b3f07cd196434204791a282f", "author": {"user": {"login": "Xenorith", "name": "Rico Chiu"}}, "url": "https://github.com/Alluxio/alluxio/commit/c91c41712c900352b3f07cd196434204791a282f", "committedDate": "2020-03-19T23:50:02Z", "message": "Fix categoryList parsing in docs check\n\nallow for comments to be ignored in parse"}, "afterCommit": {"oid": "034bf3e285c719dd989a276a25709be2c92db14c", "author": {"user": {"login": "Xenorith", "name": "Rico Chiu"}}, "url": "https://github.com/Alluxio/alluxio/commit/034bf3e285c719dd989a276a25709be2c92db14c", "committedDate": "2020-03-30T23:07:30Z", "message": "Update docs check with yaml library"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a8cf5eec702ddaf410072416c9ddac87e5c0855", "author": {"user": {"login": "Xenorith", "name": "Rico Chiu"}}, "url": "https://github.com/Alluxio/alluxio/commit/5a8cf5eec702ddaf410072416c9ddac87e5c0855", "committedDate": "2020-03-30T23:26:32Z", "message": "move vendored libs into alluxio.org/vendor and update license exclusions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b1684276c31561ca8ac2d004dd5d3f2ad733940", "author": {"user": {"login": "Xenorith", "name": "Rico Chiu"}}, "url": "https://github.com/Alluxio/alluxio/commit/1b1684276c31561ca8ac2d004dd5d3f2ad733940", "committedDate": "2020-03-30T23:37:56Z", "message": "add license headers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b7259e513836fe74dfbfe4948584ac6f3d815d5", "author": {"user": {"login": "Xenorith", "name": "Rico Chiu"}}, "url": "https://github.com/Alluxio/alluxio/commit/0b7259e513836fe74dfbfe4948584ac6f3d815d5", "committedDate": "2020-03-30T23:45:24Z", "message": "remove test files from vendored yaml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDg5MDI2", "url": "https://github.com/Alluxio/alluxio/pull/11192#pullrequestreview-384489026", "createdAt": "2020-03-31T08:00:57Z", "commit": {"oid": "0b7259e513836fe74dfbfe4948584ac6f3d815d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4682, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}