{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM3MzYyNTEy", "number": 12628, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMzo0MDoxMVrOFFYOjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNDowODoyNFrOFFYoMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxMTg0MTQxOnYy", "diffSide": "RIGHT", "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMzo0MDoxMVrOIF3baw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMzo0MDoxMVrOIF3baw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAyMTkzMQ==", "bodyText": "This line resyncs the database.. that's why the test is passing without your change. @hycsam", "url": "https://github.com/Alluxio/alluxio/pull/12628#discussion_r543021931", "createdAt": "2020-12-15T03:40:11Z", "author": {"login": "yuzhu"}, "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "diffHunk": "@@ -117,7 +122,7 @@ public void journalSync() throws Exception {\n     checkDb(tableMasterRestart, DB_NAME, oldInfo);\n     tableMasterRestart.syncDatabase(DB_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0639144efe56cc6137a0c6cc47ed1730ffafa49"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxMTkwNzA3OnYy", "diffSide": "RIGHT", "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNDowODoyNFrOIF3-EQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNzo1Nzo0NlrOIGYeRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzMDgwMQ==", "bodyText": "@yuzhu I was expecting the old code to throw an exception (Unrecognized journal entry something) during restart, which doesn't happen. Does it run asynchronously?", "url": "https://github.com/Alluxio/alluxio/pull/12628#discussion_r543030801", "createdAt": "2020-12-15T04:08:24Z", "author": {"login": "hycsam"}, "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "diffHunk": "@@ -109,6 +109,11 @@ public void journalSync() throws Exception {\n     tableMaster.syncDatabase(DB_NAME);\n     checkTable(tableMaster, DB_NAME, 2, 3);\n \n+    // Drop a table to create a 'remove_table' entry\n+    genTable(1, 3, true);\n+    tableMaster.syncDatabase(DB_NAME);\n+    checkTable(tableMaster, DB_NAME, 1, 3);\n+\n     restartMaster();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0639144efe56cc6137a0c6cc47ed1730ffafa49"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzOTE2Nw==", "bodyText": "I remember seeing an exception being shown when running in intellij.  I am guessing it is a server side exception, which might not cause the test (client) to fail.. it might also get masked somehow.", "url": "https://github.com/Alluxio/alluxio/pull/12628#discussion_r543039167", "createdAt": "2020-12-15T04:34:10Z", "author": {"login": "yuzhu"}, "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "diffHunk": "@@ -109,6 +109,11 @@ public void journalSync() throws Exception {\n     tableMaster.syncDatabase(DB_NAME);\n     checkTable(tableMaster, DB_NAME, 2, 3);\n \n+    // Drop a table to create a 'remove_table' entry\n+    genTable(1, 3, true);\n+    tableMaster.syncDatabase(DB_NAME);\n+    checkTable(tableMaster, DB_NAME, 1, 3);\n+\n     restartMaster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzMDgwMQ=="}, "originalCommit": {"oid": "f0639144efe56cc6137a0c6cc47ed1730ffafa49"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA5MzgyNg==", "bodyText": "I see, thanks! I guess that means the PR is ready to merge?", "url": "https://github.com/Alluxio/alluxio/pull/12628#discussion_r543093826", "createdAt": "2020-12-15T07:01:01Z", "author": {"login": "hycsam"}, "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "diffHunk": "@@ -109,6 +109,11 @@ public void journalSync() throws Exception {\n     tableMaster.syncDatabase(DB_NAME);\n     checkTable(tableMaster, DB_NAME, 2, 3);\n \n+    // Drop a table to create a 'remove_table' entry\n+    genTable(1, 3, true);\n+    tableMaster.syncDatabase(DB_NAME);\n+    checkTable(tableMaster, DB_NAME, 1, 3);\n+\n     restartMaster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzMDgwMQ=="}, "originalCommit": {"oid": "f0639144efe56cc6137a0c6cc47ed1730ffafa49"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU0OTQ4NA==", "bodyText": "i am ok with this PR. @gpang do you want to take another look? also, do you know why a Journal replay error does not fail the test?  I don't want this issue to happen else where and not be caught.", "url": "https://github.com/Alluxio/alluxio/pull/12628#discussion_r543549484", "createdAt": "2020-12-15T17:38:52Z", "author": {"login": "yuzhu"}, "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "diffHunk": "@@ -109,6 +109,11 @@ public void journalSync() throws Exception {\n     tableMaster.syncDatabase(DB_NAME);\n     checkTable(tableMaster, DB_NAME, 2, 3);\n \n+    // Drop a table to create a 'remove_table' entry\n+    genTable(1, 3, true);\n+    tableMaster.syncDatabase(DB_NAME);\n+    checkTable(tableMaster, DB_NAME, 1, 3);\n+\n     restartMaster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzMDgwMQ=="}, "originalCommit": {"oid": "f0639144efe56cc6137a0c6cc47ed1730ffafa49"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU2MzMzMg==", "bodyText": "Yeah, that is strange. I don't know why that error doesn't fail the test. In any case, we can change that part of it in a different PR.", "url": "https://github.com/Alluxio/alluxio/pull/12628#discussion_r543563332", "createdAt": "2020-12-15T17:57:46Z", "author": {"login": "gpang"}, "path": "tests/src/test/java/alluxio/server/ft/journal/TableMasterJournalIntegrationTest.java", "diffHunk": "@@ -109,6 +109,11 @@ public void journalSync() throws Exception {\n     tableMaster.syncDatabase(DB_NAME);\n     checkTable(tableMaster, DB_NAME, 2, 3);\n \n+    // Drop a table to create a 'remove_table' entry\n+    genTable(1, 3, true);\n+    tableMaster.syncDatabase(DB_NAME);\n+    checkTable(tableMaster, DB_NAME, 1, 3);\n+\n     restartMaster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzMDgwMQ=="}, "originalCommit": {"oid": "f0639144efe56cc6137a0c6cc47ed1730ffafa49"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 949, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}