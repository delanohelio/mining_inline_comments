{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMTE4MzU3", "number": 11270, "title": "Improve Journal Operation doc", "bodyText": "This important property alluxio.master.journal.type was not mentioned at all in doc\nAddress #11213\nStating embedded journal is now the default\nExplain more on UFS journal and embedded journal", "createdAt": "2020-04-11T01:08:43Z", "url": "https://github.com/Alluxio/alluxio/pull/11270", "merged": true, "mergeCommit": {"oid": "92fdd84b0440f8471f233076165ebd061c9c0b13"}, "closed": true, "closedAt": "2020-04-13T22:22:44Z", "author": {"login": "apc999"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWbVXBgH2gAyNDAyMTE4MzU3OjgwYWMzMDYzOTNmZWE5MmE2OTY2YzE5MjkzNmI0NGI5Y2EzNTQzMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXU2IXABqjMyMjg0NDA3Njc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "80ac306393fea92a6966c192936b44b9ca35431d", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/80ac306393fea92a6966c192936b44b9ca35431d", "committedDate": "2020-04-11T01:23:11Z", "message": "Add alluxio.master.journal.type to Journal doc"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "43f4cbd96d6ea1f12fbb866f6c239001159d1f69", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/43f4cbd96d6ea1f12fbb866f6c239001159d1f69", "committedDate": "2020-04-11T01:07:49Z", "message": "Add alluxio.master.journal.type to Journal doc"}, "afterCommit": {"oid": "80ac306393fea92a6966c192936b44b9ca35431d", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/80ac306393fea92a6966c192936b44b9ca35431d", "committedDate": "2020-04-11T01:23:11Z", "message": "Add alluxio.master.journal.type to Journal doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzIzMDQx", "url": "https://github.com/Alluxio/alluxio/pull/11270#pullrequestreview-391723041", "createdAt": "2020-04-11T01:27:08Z", "commit": {"oid": "80ac306393fea92a6966c192936b44b9ca35431d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMToyNzowOFrOGEJSsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMTozMDozOVrOGEJUTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjk5OTcyOA==", "bodyText": "only the leading master writes edit logs? since we're talking about fault tolerance, we should make it clear which master type, the leading master vs the backup masters", "url": "https://github.com/Alluxio/alluxio/pull/11270#discussion_r406999728", "createdAt": "2020-04-11T01:27:08Z", "author": {"login": "Xenorith"}, "path": "docs/en/operation/Journal.md", "diffHunk": "@@ -9,29 +9,38 @@ priority: 5\n * Table of Contents\n {:toc}\n \n-Alluxio is fault-tolerant: force-killing the system will not lose metadata. To achieve\n-this, the master writes edit logs of all metadata changes. On startup,\n-a recovering master will read the edit logs to restore itself back to its previous state.\n+Alluxio is fault-tolerant: force-killing the system will not lose metadata.\n+To achieve this, the master writes edit logs of all metadata changes (e.g., creating files,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80ac306393fea92a6966c192936b44b9ca35431d"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwMDEwMg==", "bodyText": "There are two types of journals that Alluxio is able to use, EMBEDDED or UFS.\nStarting from 2.2, the default journal type is EMBEDDED.\nThis can be changed by setting the property \"alluxio.master.journal.type\" to \"UFS\" instead of \"EMBEDDED\".", "url": "https://github.com/Alluxio/alluxio/pull/11270#discussion_r407000102", "createdAt": "2020-04-11T01:30:11Z", "author": {"login": "Xenorith"}, "path": "docs/en/operation/Journal.md", "diffHunk": "@@ -9,29 +9,38 @@ priority: 5\n * Table of Contents\n {:toc}\n \n-Alluxio is fault-tolerant: force-killing the system will not lose metadata. To achieve\n-this, the master writes edit logs of all metadata changes. On startup,\n-a recovering master will read the edit logs to restore itself back to its previous state.\n+Alluxio is fault-tolerant: force-killing the system will not lose metadata.\n+To achieve this, the master writes edit logs of all metadata changes (e.g., creating files,\n+renaming directories).\n+On startup, a recovering master will read the edit logs to restore itself back to its previous state.\n We use the term \"journal\" to refer to the system of edit logs used to support fault-tolerance.\n The purpose of this documentation is to help Alluxio administrators understand and manage the Alluxio journal.\n \n ## UFS Journal vs Embedded Journal\n \n-The UFS journal simplifies certain aspects of Alluxio operation, but it relies on \n-an external Zookeeper cluster for coordination, and relies on a UFS for persistent storage. \n-To get reasonable performance, the UFS journal requires a UFS that supports fast streaming writes, \n-such as HDFS or NFS.\n-\n-The embedded journal does its own coordination and persistent storage, which comes with a limitation on fault tolerance.\n-`n` masters using the embedded journal can tolerate only `floor(n/2)` master failures, \n-compared to `n-1` for UFS journal. For example, With `3` masters, UFS journal can tolerate `2` failures, \n-while embedded journal can only tolerate `1`. However, UFS journal depends on Zookeeper, \n+By setting property \"`alluxio.master.journal.type`\" to \"`UFS`\" or \"`EMBEDDED`\" (default since 2.2),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80ac306393fea92a6966c192936b44b9ca35431d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwMDE0Mw==", "bodyText": "switch order of the two types, since embedded is the default", "url": "https://github.com/Alluxio/alluxio/pull/11270#discussion_r407000143", "createdAt": "2020-04-11T01:30:39Z", "author": {"login": "Xenorith"}, "path": "docs/en/operation/Journal.md", "diffHunk": "@@ -9,29 +9,38 @@ priority: 5\n * Table of Contents\n {:toc}\n \n-Alluxio is fault-tolerant: force-killing the system will not lose metadata. To achieve\n-this, the master writes edit logs of all metadata changes. On startup,\n-a recovering master will read the edit logs to restore itself back to its previous state.\n+Alluxio is fault-tolerant: force-killing the system will not lose metadata.\n+To achieve this, the master writes edit logs of all metadata changes (e.g., creating files,\n+renaming directories).\n+On startup, a recovering master will read the edit logs to restore itself back to its previous state.\n We use the term \"journal\" to refer to the system of edit logs used to support fault-tolerance.\n The purpose of this documentation is to help Alluxio administrators understand and manage the Alluxio journal.\n \n ## UFS Journal vs Embedded Journal\n \n-The UFS journal simplifies certain aspects of Alluxio operation, but it relies on \n-an external Zookeeper cluster for coordination, and relies on a UFS for persistent storage. \n-To get reasonable performance, the UFS journal requires a UFS that supports fast streaming writes, \n-such as HDFS or NFS.\n-\n-The embedded journal does its own coordination and persistent storage, which comes with a limitation on fault tolerance.\n-`n` masters using the embedded journal can tolerate only `floor(n/2)` master failures, \n-compared to `n-1` for UFS journal. For example, With `3` masters, UFS journal can tolerate `2` failures, \n-while embedded journal can only tolerate `1`. However, UFS journal depends on Zookeeper, \n+By setting property \"`alluxio.master.journal.type`\" to \"`UFS`\" or \"`EMBEDDED`\" (default since 2.2),\n+Alluxio can switch between using UFS journal and using embedded journal as explained below.\n+\n+- The **UFS journal** stores edit logs in a UFS storage.\n+When using a single Alluxio master, this UFS can be a local storage;\n+when using multiple Alluxio masters for high availablity (HA mode),\n+this UFS storage must be shared among masters for read and write access.\n+UFS journal simplifies certain aspects of Alluxio operation, but it relies on\n+an external Zookeeper cluster for coordination (for HA mode), and relies on a UFS for persistent storage.\n+To get reasonable performance, the UFS journal requires a UFS that supports fast streaming writes,\n+such as HDFS or NFS. In contrast, S3 is not recommended to be used for UFS journal.\n+\n+- The **embedded journal** stores edit logs on each master's local persistent storage with its own", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80ac306393fea92a6966c192936b44b9ca35431d"}, "originalPosition": 37}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17870457bfda968724a07e941cc6ea55641d1e8b", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/17870457bfda968724a07e941cc6ea55641d1e8b", "committedDate": "2020-04-13T19:57:32Z", "message": "address comments"}, "afterCommit": {"oid": "9c637b689b1f1333db1d5ab075eca49dd4c1c1f9", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/9c637b689b1f1333db1d5ab075eca49dd4c1c1f9", "committedDate": "2020-04-13T20:15:17Z", "message": "address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDA5MjYz", "url": "https://github.com/Alluxio/alluxio/pull/11270#pullrequestreview-392409263", "createdAt": "2020-04-13T20:18:51Z", "commit": {"oid": "9c637b689b1f1333db1d5ab075eca49dd4c1c1f9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fceeaf02152b97516443c92b3e8fc1992ca14f6e", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/fceeaf02152b97516443c92b3e8fc1992ca14f6e", "committedDate": "2020-04-13T20:23:22Z", "message": "address comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c637b689b1f1333db1d5ab075eca49dd4c1c1f9", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/9c637b689b1f1333db1d5ab075eca49dd4c1c1f9", "committedDate": "2020-04-13T20:15:17Z", "message": "address comments"}, "afterCommit": {"oid": "fceeaf02152b97516443c92b3e8fc1992ca14f6e", "author": {"user": {"login": "apc999", "name": "Bin Fan"}}, "url": "https://github.com/Alluxio/alluxio/commit/fceeaf02152b97516443c92b3e8fc1992ca14f6e", "committedDate": "2020-04-13T20:23:22Z", "message": "address comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4747, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}