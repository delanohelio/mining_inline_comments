{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1MDMxMjcx", "number": 10768, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwMDowNDozOFrODZWHQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwMDowNDozOFrODZWHQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3OTAzMjk2OnYy", "diffSide": "RIGHT", "path": "core/client/fs/src/main/java/alluxio/client/file/FileSystemContext.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwMDowNDozOFrOFfrgPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo1NTowOVrOFgFGQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc2Mjk0Mg==", "bodyText": "Should we only do this if metrics are enabled?", "url": "https://github.com/Alluxio/alluxio/pull/10768#discussion_r368762942", "createdAt": "2020-01-21T00:04:38Z", "author": {"login": "calvinjia"}, "path": "core/client/fs/src/main/java/alluxio/client/file/FileSystemContext.java", "diffHunk": "@@ -229,6 +229,15 @@ private synchronized void initContext(ClientContext ctx,\n     mClosed.set(false);\n     mMasterClientContext = MasterClientContext.newBuilder(ctx)\n         .setMasterInquireClient(masterInquireClient).build();\n+    try {\n+      InetSocketAddress masterAddr = masterInquireClient.getPrimaryRpcAddress();\n+      mMasterClientContext.loadConf(masterAddr, true, true);\n+    } catch (UnavailableException e) {\n+      LOG.error(\"Failed to get master address during initialization\", e);\n+    } catch (AlluxioStatusException ae) {\n+      LOG.error(\"Failed to load configuration from \"\n+          + \"meta master during initialization\", ae);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a1b72198b1017868663dcef06227a24c4ce056f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc3MjYzOQ==", "bodyText": "For the safest change, we should only do this if metrics are enabled.\nUpdate client configuration beforehand in all cases may help acquire and work with block worker client and file system master client.", "url": "https://github.com/Alluxio/alluxio/pull/10768#discussion_r368772639", "createdAt": "2020-01-21T01:08:01Z", "author": {"login": "LuQQiu"}, "path": "core/client/fs/src/main/java/alluxio/client/file/FileSystemContext.java", "diffHunk": "@@ -229,6 +229,15 @@ private synchronized void initContext(ClientContext ctx,\n     mClosed.set(false);\n     mMasterClientContext = MasterClientContext.newBuilder(ctx)\n         .setMasterInquireClient(masterInquireClient).build();\n+    try {\n+      InetSocketAddress masterAddr = masterInquireClient.getPrimaryRpcAddress();\n+      mMasterClientContext.loadConf(masterAddr, true, true);\n+    } catch (UnavailableException e) {\n+      LOG.error(\"Failed to get master address during initialization\", e);\n+    } catch (AlluxioStatusException ae) {\n+      LOG.error(\"Failed to load configuration from \"\n+          + \"meta master during initialization\", ae);\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc2Mjk0Mg=="}, "originalCommit": {"oid": "7a1b72198b1017868663dcef06227a24c4ce056f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4MjI3NA==", "bodyText": "Change to only do it when client metrics is enabled.", "url": "https://github.com/Alluxio/alluxio/pull/10768#discussion_r369182274", "createdAt": "2020-01-21T18:55:09Z", "author": {"login": "LuQQiu"}, "path": "core/client/fs/src/main/java/alluxio/client/file/FileSystemContext.java", "diffHunk": "@@ -229,6 +229,15 @@ private synchronized void initContext(ClientContext ctx,\n     mClosed.set(false);\n     mMasterClientContext = MasterClientContext.newBuilder(ctx)\n         .setMasterInquireClient(masterInquireClient).build();\n+    try {\n+      InetSocketAddress masterAddr = masterInquireClient.getPrimaryRpcAddress();\n+      mMasterClientContext.loadConf(masterAddr, true, true);\n+    } catch (UnavailableException e) {\n+      LOG.error(\"Failed to get master address during initialization\", e);\n+    } catch (AlluxioStatusException ae) {\n+      LOG.error(\"Failed to load configuration from \"\n+          + \"meta master during initialization\", ae);\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc2Mjk0Mg=="}, "originalCommit": {"oid": "7a1b72198b1017868663dcef06227a24c4ce056f"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2075, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}