{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MzE5NzM5", "number": 11593, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNToxMjowNVrOEGy7kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjowMDoyOVrOEHKj0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NTYxMzYyOnYy", "diffSide": "RIGHT", "path": "integration/kubernetes/helm-chart/alluxio/CHANGELOG.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNToxMjowNVrOGlz9ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMjo1NDoyNFrOGmCuNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMwMTg5MQ==", "bodyText": "I suggest changing this line to \"Change master service to headless from NodePort\"", "url": "https://github.com/Alluxio/alluxio/pull/11593#discussion_r442301891", "createdAt": "2020-06-18T15:12:05Z", "author": {"login": "jiacheliu3"}, "path": "integration/kubernetes/helm-chart/alluxio/CHANGELOG.md", "diffHunk": "@@ -99,4 +99,6 @@\n - Moved metastore configuration properties to the root level, to be the same as journal\n - Removed inferring hostNetwork, dnsPolicy and domain socket from whether user is root\n - Added inferring dnsPolicy from hostNetwork\n-- Fixed one typo in ALLUXIO_CLIENT_JAVA_OPTS for FUSE   \n+- Fixed one typo in ALLUXIO_CLIENT_JAVA_OPTS for FUSE\n+- Fixed Fuse crash issue\n+- Fixed the pod can't access itself through service", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbf16e23d9a34430ee8580f3cfc83d8fd447962f"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MzY2OA==", "bodyText": "Done", "url": "https://github.com/Alluxio/alluxio/pull/11593#discussion_r442543668", "createdAt": "2020-06-18T22:54:24Z", "author": {"login": "cheyang"}, "path": "integration/kubernetes/helm-chart/alluxio/CHANGELOG.md", "diffHunk": "@@ -99,4 +99,6 @@\n - Moved metastore configuration properties to the root level, to be the same as journal\n - Removed inferring hostNetwork, dnsPolicy and domain socket from whether user is root\n - Added inferring dnsPolicy from hostNetwork\n-- Fixed one typo in ALLUXIO_CLIENT_JAVA_OPTS for FUSE   \n+- Fixed one typo in ALLUXIO_CLIENT_JAVA_OPTS for FUSE\n+- Fixed Fuse crash issue\n+- Fixed the pod can't access itself through service", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMwMTg5MQ=="}, "originalCommit": {"oid": "cbf16e23d9a34430ee8580f3cfc83d8fd447962f"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NTY0MTE1OnYy", "diffSide": "RIGHT", "path": "integration/kubernetes/helm-chart/alluxio/templates/config/alluxio-conf.yaml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNToxODo0MFrOGl0Pag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMzowMzowMVrOGmC4QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMwNjQxMA==", "bodyText": "@madanadit I'm not too sure about what java opts Fuse wants. But it can be related to this ALLUXIO_CLIENT_JAVA_OPTS not being used \n  \n    \n      alluxio/integration/kubernetes/helm-chart/alluxio/templates/fuse/daemonset.yaml\n    \n    \n         Line 96\n      in\n      db1418e\n    \n    \n    \n    \n\n        \n          \n           - name: ALLUXIO_CLIENT_JAVA_OPTS \n        \n    \n  \n\n\nLooking at \n  \n    \n      alluxio/integration/docker/entrypoint.sh\n    \n    \n         Line 30\n      in\n      db1418e\n    \n    \n    \n    \n\n        \n          \n           ALLUXIO_USER_JAVA_OPTS \n        \n    \n  \n\n, I think it should be ALLUXIO_USER_JAVA_OPTS instead of ALLUXIO_CLIENT_JAVA_OPTS? So by changing \n  \n    \n      alluxio/integration/kubernetes/helm-chart/alluxio/templates/fuse/daemonset.yaml\n    \n    \n         Line 96\n      in\n      db1418e\n    \n    \n    \n    \n\n        \n          \n           - name: ALLUXIO_CLIENT_JAVA_OPTS \n        \n    \n  \n\n from ALLUXIO_CLIENT_JAVA_OPTS to ALLUXIO_USER_JAVA_OPTS, we can fix this issue without adding \"-Dalluxio.worker.hostname=${ALLUXIO_CLIENT_HOSTNAME}\"", "url": "https://github.com/Alluxio/alluxio/pull/11593#discussion_r442306410", "createdAt": "2020-06-18T15:18:40Z", "author": {"login": "jiacheliu3"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/config/alluxio-conf.yaml", "diffHunk": "@@ -26,6 +26,10 @@\n {{- if $isSingleMaster }}\n   {{- $alluxioJavaOpts = printf \"-Dalluxio.master.hostname=%v-%v\" $fullName $defaultMasterName | append $alluxioJavaOpts }}\n {{- end }}\n+{{ if .Values.fuse.enabled -}}\n+{{- $alluxioJavaOpts = print \"-Dalluxio.user.hostname=${ALLUXIO_CLIENT_HOSTNAME}\" | append $alluxioJavaOpts }}\n+{{- $alluxioJavaOpts = printf \"-Dalluxio.worker.hostname=${ALLUXIO_CLIENT_HOSTNAME}\" | append $alluxioJavaOpts }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbf16e23d9a34430ee8580f3cfc83d8fd447962f"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0NjI0MQ==", "bodyText": "We put it in alluxioJavaOpts for a long time, and it was always working fine. I suggest you should test it when making code reconstruction.", "url": "https://github.com/Alluxio/alluxio/pull/11593#discussion_r442546241", "createdAt": "2020-06-18T23:03:01Z", "author": {"login": "cheyang"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/config/alluxio-conf.yaml", "diffHunk": "@@ -26,6 +26,10 @@\n {{- if $isSingleMaster }}\n   {{- $alluxioJavaOpts = printf \"-Dalluxio.master.hostname=%v-%v\" $fullName $defaultMasterName | append $alluxioJavaOpts }}\n {{- end }}\n+{{ if .Values.fuse.enabled -}}\n+{{- $alluxioJavaOpts = print \"-Dalluxio.user.hostname=${ALLUXIO_CLIENT_HOSTNAME}\" | append $alluxioJavaOpts }}\n+{{- $alluxioJavaOpts = printf \"-Dalluxio.worker.hostname=${ALLUXIO_CLIENT_HOSTNAME}\" | append $alluxioJavaOpts }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMwNjQxMA=="}, "originalCommit": {"oid": "cbf16e23d9a34430ee8580f3cfc83d8fd447962f"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1OTQ4NDk2OnYy", "diffSide": "RIGHT", "path": "integration/kubernetes/helm-chart/alluxio/templates/master/statefulset.yaml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjowMDoyOVrOGmZ1pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjowMDoyOVrOGmZ1pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjkyMjQwNg==", "bodyText": "Please add this to the change log.", "url": "https://github.com/Alluxio/alluxio/pull/11593#discussion_r442922406", "createdAt": "2020-06-19T16:00:29Z", "author": {"login": "jiacheliu3"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/master/statefulset.yaml", "diffHunk": "@@ -92,6 +92,12 @@ spec:\n             valueFrom:\n               fieldRef:\n                 fieldPath: metadata.name\n+          {{- else if $isSingleMaster }}\n+          env:\n+          - name: ALLUXIO_MASTER_HOSTNAME\n+            valueFrom:\n+              fieldRef:\n+                fieldPath: status.podIP", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14fc0adf0250a1fee46c8bef6b061e7bf65391eb"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1482, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}