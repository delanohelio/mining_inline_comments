{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMzg4MTE1", "number": 11529, "title": "Prevent TTL from being set on synced inodes", "bodyText": "", "createdAt": "2020-06-08T20:47:01Z", "url": "https://github.com/Alluxio/alluxio/pull/11529", "merged": true, "mergeCommit": {"oid": "4a31941239f6962acef11d56ebdfad7b476918be"}, "closed": true, "closedAt": "2020-06-11T02:15:26Z", "author": {"login": "ZacBlanco"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpW3qMgH2gAyNDMxMzg4MTE1OjlmODc5ZGQ2NjA5ZTRlZTUxYWU4OGIyMGU1MjMyOWRlZDdkNjhiMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp-epdAFqTQyNjc3NzA5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25", "author": {"user": {"login": "ZacBlanco", "name": "Zac Blanco"}}, "url": "https://github.com/Alluxio/alluxio/commit/9f879dd6609e4ee51ae88b20e52329ded7d68b25", "committedDate": "2020-06-08T20:55:41Z", "message": "Prevent TTL from being set on synced inodes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ee3789ab34eb88c0dcd89d33dce2ae7872cfb8aa", "author": {"user": {"login": "ZacBlanco", "name": "Zac Blanco"}}, "url": "https://github.com/Alluxio/alluxio/commit/ee3789ab34eb88c0dcd89d33dce2ae7872cfb8aa", "committedDate": "2020-06-08T20:37:39Z", "message": "Prevent TTL from being set on synced inodes"}, "afterCommit": {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25", "author": {"user": {"login": "ZacBlanco", "name": "Zac Blanco"}}, "url": "https://github.com/Alluxio/alluxio/commit/9f879dd6609e4ee51ae88b20e52329ded7d68b25", "committedDate": "2020-06-08T20:55:41Z", "message": "Prevent TTL from being set on synced inodes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NjY1ODg3", "url": "https://github.com/Alluxio/alluxio/pull/11529#pullrequestreview-426665887", "createdAt": "2020-06-08T22:30:20Z", "commit": {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQyMjozMDoyMVrOGgymww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQyMjozMDoyMVrOGgymww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAzNjczOQ==", "bodyText": "Do we have to set this explicitly? If so, why isn't it set in the other method above?\nAlso, can we have a constant for this \"no ttl\" common option. instead of building each time?", "url": "https://github.com/Alluxio/alluxio/pull/11529#discussion_r437036739", "createdAt": "2020-06-08T22:30:21Z", "author": {"login": "gpang"}, "path": "core/server/master/src/main/java/alluxio/master/file/InodeSyncStream.java", "diffHunk": "@@ -645,6 +650,11 @@ private void loadMetadata(LockedInodePath inodePath, LoadMetadataContext context\n             LoadMetadataContext loadMetadataContext =\n                 LoadMetadataContext.mergeFrom(LoadMetadataPOptions.newBuilder()\n                     .setLoadDescendantType(LoadDescendantPType.NONE)\n+                    // No Ttl on loaded files\n+                    .setCommonOptions(FileSystemMasterCommonPOptions.newBuilder()\n+                        .setTtl(-1)\n+                        .setTtlAction(TtlAction.DELETE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7825653177138ae30132b6b358314f037114277", "author": {"user": {"login": "ZacBlanco", "name": "Zac Blanco"}}, "url": "https://github.com/Alluxio/alluxio/commit/d7825653177138ae30132b6b358314f037114277", "committedDate": "2020-06-10T18:21:33Z", "message": "Use common no_ttl option"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2Nzc3MDkx", "url": "https://github.com/Alluxio/alluxio/pull/11529#pullrequestreview-426777091", "createdAt": "2020-06-09T04:17:02Z", "commit": {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNDoxNzowMlrOGg4LuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNDoxNzowMlrOGg4LuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEyODEyMA==", "bodyText": "I see 2 setCommonOptions() calls in this file. This one and the one earlier. They are slightly different because this one sets the action, and the other one doesn't.", "url": "https://github.com/Alluxio/alluxio/pull/11529#discussion_r437128120", "createdAt": "2020-06-09T04:17:02Z", "author": {"login": "gpang"}, "path": "core/server/master/src/main/java/alluxio/master/file/InodeSyncStream.java", "diffHunk": "@@ -645,6 +650,11 @@ private void loadMetadata(LockedInodePath inodePath, LoadMetadataContext context\n             LoadMetadataContext loadMetadataContext =\n                 LoadMetadataContext.mergeFrom(LoadMetadataPOptions.newBuilder()\n                     .setLoadDescendantType(LoadDescendantPType.NONE)\n+                    // No Ttl on loaded files\n+                    .setCommonOptions(FileSystemMasterCommonPOptions.newBuilder()\n+                        .setTtl(-1)\n+                        .setTtlAction(TtlAction.DELETE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAzNjczOQ=="}, "originalCommit": {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4481, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}