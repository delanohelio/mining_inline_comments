{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNDE4ODM2", "number": 11890, "title": "[DOCFIX] Update Chinese Docker Doc", "bodyText": "Fixed issues with past PR", "createdAt": "2020-08-03T22:02:38Z", "url": "https://github.com/Alluxio/alluxio/pull/11890", "merged": true, "mergeCommit": {"oid": "7efb862fa04db8d81a222a14239e3ba84f555e99"}, "closed": true, "closedAt": "2020-08-03T23:12:43Z", "author": {"login": "thanosaw"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6gc0oAH2gAyNDYyNDE4ODM2OjZkOTBiZDI3YWZkZWYxZmE3OTc1YmIyMDRkMmE4ZTA1Zjk4OGEyZTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7ZqnHgH2gAyNDYyNDE4ODM2OjQxMWNlZmM2OThiOGZkMDMyM2EzMWU5Y2M5NWI2Y2NlMGU5Yjc0YmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6d90bd27afdef1fa7975bb204d2a8e05f988a2e9", "author": {"user": {"login": "thanosaw", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/6d90bd27afdef1fa7975bb204d2a8e05f988a2e9", "committedDate": "2020-08-01T03:42:08Z", "message": "Test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e4897f07103c938747260edb4ba50315c604fd3", "author": {"user": {"login": "thanosaw", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/3e4897f07103c938747260edb4ba50315c604fd3", "committedDate": "2020-08-01T03:42:08Z", "message": "Update Architecture.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24f086a6e161b014ac37c33d36b48bb464672d42", "author": {"user": {"login": "thanosaw", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/24f086a6e161b014ac37c33d36b48bb464672d42", "committedDate": "2020-08-03T22:01:11Z", "message": "fix docker PR issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzc1ODA2", "url": "https://github.com/Alluxio/alluxio/pull/11890#pullrequestreview-460375806", "createdAt": "2020-08-03T22:17:05Z", "commit": {"oid": "24f086a6e161b014ac37c33d36b48bb464672d42"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjoxNzowNVrOG7KfEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjoxOToyNVrOG7Kifw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY5MDk2Mw==", "bodyText": "will it be better to change to \u4f7f\u7528\u5355\u5f15\u53f7\u6765\u5c06\u5e26\u7a7a\u683c\u7684\u5b57\u7b26\u4e32\u8003\u8651\u4e3a\u4e00\u4e2a\u503c\uff1f", "url": "https://github.com/Alluxio/alluxio/pull/11890#discussion_r464690963", "createdAt": "2020-08-03T22:17:05Z", "author": {"login": "LuQQiu"}, "path": "docs/cn/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -1,232 +1,318 @@\n ---\n layout: global\n-title: \u5728Docker\u4e0a\u8fd0\u884cAlluxio\n-nickname: \u5728Docker\u4e0a\u8fd0\u884cAlluxio\n+title: \u5728\u96c6\u7fa4\u4e0a\u72ec\u7acb\u8fd0\u884cAlluxio\n+nickname: \u5728\u96c6\u7fa4\u4e0a\u72ec\u7acb\u8fd0\u884cAlluxio\n group: Install Alluxio\n priority: 3\n ---\n \n-* \u5185\u5bb9\u5217\u8868\n-{:toc}\n-\n-Alluxio\u53ef\u4ee5\u8fd0\u884c\u5728\u4e00\u4e2aDocker\u5bb9\u5668\u4e2d\uff0c\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528Alluxio Github\u4ed3\u5e93\u63d0\u4f9b\u7684Dockerfile\u6765\u5c06Alluxio\u8fd0\u884c\u5728Docker\u4e4b\u4e2d\u3002\n+Docker\u53ef\u7528\u4e8e\u7b80\u5316Alluxio\u670d\u52a1\u5668\u7684\u90e8\u7f72\u548c\u7ba1\u7406\u3002\u4f7f\u7528 Dockerhub\u4e0a\u7684[alluxio/alluxio](https://hub.docker.com/r/alluxio/alluxio/)Docker\u955c\u50cf\uff0c\u53ea\u8981\u8fd0\u884c\u51e0\u4e2a`docker run`\u547d\u4ee4\u5c31\u53ef\u4ee5\u4ece\u96f6\u5230\u8fd0\u884cAlluxio\u96c6\u7fa4\u3002\u672c\u6587\u6863\u63d0\u4f9b\u4e86\u4ee5\u672c\u5730\u78c1\u76d8\u4f5c\u4e3a\u5e95\u5c42\u5b58\u50a8\u7684\u5355\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884cDockerized Alluxio\u7684\u6559\u7a0b\u3002\u6211\u4eec\u4e5f\u8fd8\u5c06\u8ba8\u8bba\u66f4\u9ad8\u7ea7\u7684\u4e3b\u9898\u4ee5\u53ca\u5982\u4f55\u89e3\u51b3\u9047\u5230\u7684\u95ee\u9898\u3002\n \n-# \u57fa\u7840\u6559\u7a0b\n-\n-\u8fd9\u7bc7\u6559\u7a0b\u4e3b\u8981\u4ecb\u7ecd\u5982\u4f55\u5728\u5355\u8282\u70b9\u4e0a\u4f7f\u7528Docker\u8fd0\u884cAlluxio\u3002\n+* Table of Contents\n+{:toc}\n \n-# \u524d\u671f\u51c6\u5907\n+## \u524d\u63d0\u6761\u4ef6\n \n-\u4e00\u53f0Linux\u4e3b\u673a\u3002\u5728\u8be5\u6307\u5357\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4e00\u53f0\u5168\u65b0\u7684\u8fd0\u884c\u7740Amazon Linux\u7684EC2\u4e3b\u673a\u3002\u4e3b\u673a\u5bb9\u91cf\u4e0d\u9700\u8981\u592a\u5927\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528t2.small\u3002\u5f53\u4e3a\u5b9e\u4f8b\u8bbe\u7f6e\u7f51\u7edc\u5b89\u5168\u65f6\uff0c\u5141\u8bb8\u7aef\u53e319998-19999\u548c29998-30000\u901a\u4fe1\u3002\n+- \u4e00\u53f0\u5b89\u88c5\u4e86Docker\u4e3b\u673a\u3002\n+- \u5f00\u653e\u7aef\u53e319998\u300119999\u300129998\u300129999\u548c30000\n \n-# \u542f\u52a8\u4e00\u4e2a\u72ec\u7acb\u6a21\u5f0f\u96c6\u7fa4\n+\u5982\u679c\u81ea\u5df1\u6ca1\u6709\u5b89\u88c5\u4e86Docker\u7684\u4e3b\u673a\uff0c\u5219\u53ef\u4ee5\u5728AWS\u4e0a\u521b\u5efa\u4e00\u4e2a\u5c0fAWS EC2\u8ba1\u7b97\u5b9e\u4f8b(\u4f8b\u5982t2.small)\uff0c\u4ee5\u4fbf\u968f\u672c\u6559\u7a0b\u4e00\u8d77\u5b66\u4e60\u3002\u5bf9EC2\u7684security group\u505a\u51fa\u4ee5\u4e0b\u8bbe\u7f6e\uff0c\u4ee5\u4fbf\u4ee5\u4e0b\u7aef\u53e3\u5bf9\u4f60\u7684IP\u5730\u5740\u548cAlluxio\u5ba2\u6237\u7aef(\u4f8b\u5982\uff0c\u8fdc\u7a0bSpark\u96c6\u7fa4)CIDR\u8303\u56f4\u5185\u5730\u5740\u65f6\u5f00\u653e\u7684:\n \n-\u4f60\u9700\u8981\u5728\u4f60\u7684Linux\u4e3b\u673a\u4e0a\u6267\u884c\u4ee5\u4e0b\u7684\u6240\u6709\u6b65\u9aa4\u3002\n++ \u5bf9\u4e8eAlluxio\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aefCIDR\u5730\u5740\u8303\u56f4\u5185\u7aef\u53e319998:\u5141\u8bb8\u5ba2\u6237\u7aef\u548cworkers\u4e0eAlluxio Master RPC\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u3002\n++ \u4f60\u7684\u6d4f\u89c8\u5668\u7684IP\u5730\u5740\u7aef\u53e319999:\u5141\u8bb8\u60a8\u8bbf\u95eeAlluxio master Web UI\u3002\n++ Alluxio\u548c\u5ba2\u6237\u7aef\u7684CIDR\u8303\u56f4\u5185\u7aef\u53e329999:\u5141\u8bb8\u5ba2\u6237\u7aef\u4e0eAlluxio Worker RPC\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u3002\n++ \u4f60\u7684\u6d4f\u89c8\u5668\u7684IP\u5730\u5740\u7aef\u53e330000:\u5141\u8bb8\u60a8\u8bbf\u95eeAlluxio worker Web UI\u3002\n \n-## \u5b89\u88c5Docker\n+\u5728\u53d1\u653e\u5b9e\u4f8b\u540e(\u540e\u7eed\u79f0\u4e3aDocker Host)\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u8bbe\u7f6eDocker\n \n ```console\n-$ sudo yum install -y docker git\n+$ sudo yum install -y docker\n $ sudo service docker start\n # Add the current user to the docker group\n $ sudo usermod -a -G docker $(id -u -n)\n # Log out and log back in again to pick up the group changes\n $ exit\n ```\n \n-## \u590d\u5236Alluxio\u4ed3\u5e93\n+## \u51c6\u5907Docker Volume\u5b58\u50a8\u6570\u636e\n \n-```console\n-$ git clone https://github.com/Alluxio/alluxio.git\n-```\n+\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5bb9\u5668\u5185\u521b\u5efa\u7684\u6240\u6709\u6587\u4ef6\u90fd\u5b58\u5728\u53ef\u5199\u7684\u5bb9\u5668layer\u3002\u5f53\u8be5\u5bb9\u5668\u4e0d\u518d\u5b58\u5728\u65f6\uff0c\u6570\u636e\u4e0d\u4f1a\u4fdd\u7559\u3002[Docker volumes](https://docs.docker.com/storage/volumes/)\u662f\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u5bb9\u5668\u5916\u90e8\u7684\u65b9\u6cd5\u3002\u6700\u5e38\u4f7f\u7528\u7684\u4ee5\u4e0b\u4e24\u79cd\u7684Docker volumes:\n+\n++ **Host Volume**:\u4f60\u6765\u51b3\u5b9a\u548c\u7ba1\u7406\u5728Docker \u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5728\u54ea\u91cc\u5b58\u50a8\u548c\u5171\u4eab\u5bb9\u5668\u6570\u636e\u3002\u521b\u5efahost volume\uff0c\u8fd0\u884c:\n+\n+  ```console\n+  $ docker run -v /path/on/host:/path/in/container ...\n+  ```\n+  \u6587\u4ef6\u6216\u76ee\u5f55\u901a\u8fc7Docker\u4e3b\u673a\u4e0a\u7684\u5b8c\u6574\u8def\u5f84\u5f15\u7528\u3002\u53ef\u4ee5\u662f\u5df2\u7ecf\u5b58\u5728\u4e8eDocker\u4e3b\u673a\u4e0a\u7684\uff0c\u5982\u679c\u5c1a\u4e0d\u5b58\u5728\u5219\u4f1a\u81ea\u52a8\u521b\u5efa\u3002\n+\n++ **Named Volume**:Docker\u6765\u7ba1\u7406\u5176\u4f4d\u7f6e\u3002\u7528\u7279\u5b9a\u540d\u79f0\u6765\u6307\u4ee3\u5373\u53ef\u3002\u521b\u5efa\u547d\u540d\u5377\uff0c\u8fd0\u884c:\n+\n+  ```console\n+  $ docker volume create volumeName\n+  $ docker run -v  volumeName:/path/in/container ...\n+  ```\n+\n+Alluxio\u5bb9\u5668\u7528host volume\u6216named volume\u90fd\u53ef\u4ee5\u3002\u51fa\u4e8e\u6d4b\u8bd5\u76ee\u7684\u8bdd\uff0c\u5efa\u8bae\u4f7f\u7528host volume\uff0c\u56e0\u4e3a\u5b83\u662f\u6700\u5bb9\u6613\u4f7f\u7528\u7684volume\uff0c\u5e76\u4e14\u6027\u80fd\u975e\u5e38\u597d\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u4f60\u77e5\u9053\u5728\u4e3b\u673a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6240\u5f15\u7528\u6570\u636e\u7684\u4f4d\u7f6e\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u5bb9\u5668\u5916\u90e8\u76f4\u63a5\u548c\u5f88\u5bb9\u6613\u7684\u505a\u9488\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u3002\n+\n+\u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u4f7f\u7528host volume\u5e76\u5c06host\u76ee\u5f55 `/alluxio_ufs`\u6302\u8f7d\u5230\u5bb9\u5668\u8def\u5f84 `/opt/alluxio/underFSStorage`\uff0c\u8fd9\u662fAlluxio docker\u955c\u50cf\u4e2dAlluxio UFS root\u6302\u8f7d\u70b9\u7684\u9ed8\u8ba4\u8bbe\u7f6e:\n+  ```console\n+  $ docker run -v /alluxio_ufs:/opt/alluxio/underFSStorage   ...\n+  ```\n+\u5f53\u7136\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u5b89\u88c5\u5230\u5176\u4ed6\u8def\u5f84\u6765\u4ee3\u66ff`/alluxio_ufs`\u3002\u4ece2.1\u7248\u672c\u5f00\u59cb\uff0cAlluxio Docker\u955c\u50cf\u9ed8\u8ba4\u4ee5`alluxio`\u7528\u6237\u8fd0\u884c\u3002UID\u4e3a1000\u548cGID1000\u3002\u786e\u4fdd\u8fd0\u884cDocker\u955c\u50cf\u7684\u7528\u6237\u53ef\u5199\u8be5\u6587\u4ef6\u3002\n+\n+## \u542f\u52a8Alluxio Master\u548cWorker\u5bb9\u5668\n \n-## \u6784\u5efaAlluxio Docker\u955c\u50cf\n+Alluxio\u5ba2\u6237\u7aef(\u672c\u5730\u6216\u8fdc\u7a0b)\u9700\u8981\u4e0eAlluxio master\u548cworker\u901a\u4fe1\u3002\u56e0\u6b64\uff0c\u786e\u4fdd\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u4ee5\u4e0b\u4e24\u9879\u670d\u52a1\u975e\u5e38\u91cd\u8981:\n+\n++ Master RPC \u7aef\u53e319998\n++ Worker RPC \u7aef\u53e329999\n+\n+Alluxio\u96c6\u7fa4\u4e2d\uff0c\u540c\u65f6\u8981\u786e\u4fddmaster\u548cworker\u5bb9\u5668\u53ef\u4ee5\u5728[\u4e0b\u9762\u5b9a\u4e49\u7684\u7aef\u53e3\u4e92\u8bbf]({{ '/en/deploy/Requirements.html#general-requirements' | relativize_url}})\u3002\n+\n+\u6211\u4eec\u5c06\u5728\u540c\u4e00\u53f0Docker\u4e3b\u673a\u4e0a\u542f\u52a8Alluxio master\u5bb9\u5668\u548cworker\u5bb9\u5668\u3002\u4e3a\u4e86\u786e\u4fdd\u6b64\u65b9\u6cd5\u9002\u7528\u4e8e\u672c\u5730\u6216\u8fdc\u7a0b\u5ba2\u6237\u7aef\uff0c\u5fc5\u987b\u8bbe\u7f6eDocker\u7f51\u7edc\u51c6\u786e\u5f00\u653e\u901a\u4fe1\u6240\u9700\u7aef\u53e3\u3002\n+\n+\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5728Docker\u4e3b\u673a\u4e0a\u542f\u52a8Alluxio Docker\u5bb9\u5668:\n++ A: \u4f7f\u7528[\u4e3b\u673a\u7f51\u7edc](https://docs.docker.com/network/host/) \u6216\n++ B: \u4f7f\u7528[\u7528\u6237\u81ea\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc](https://docs.docker.com/network/bridge/)\u3002\n+\n+\u4e3b\u673a\u7f51\u7edc\u5728\u5bb9\u5668\u548cDocker\u4e3b\u673a\u4e4b\u95f4\u5171\u4eabip\u5730\u5740\u548c\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u3002\u7528\u6237\u81ea\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc\u5141\u8bb8\u5728\u6865\u63a5\u7f51\u7edc\u5185\u7684\u5bb9\u5668\u4e92\u76f8\u901a\u4fe1\uff0c\u540c\u65f6\u4e0e\u672a\u8fde\u63a5\u5230\u8be5\u6865\u63a5\u7f51\u7edc\u7684\u5bb9\u5668\u9694\u79bb\u3002\u5efa\u8bae\u4f7f\u7528\u4e3b\u673a\u7f51\u7edc(\u9009\u9879A)\u8fdb\u884c\u6d4b\u8bd5\u3002\n+\n+### \u9009\u9879A:\u542f\u52a8\u4f7f\u7528\u4e3b\u673a\u7f51\u7edcDocker Alluxio\u5bb9\u5668\n \n ```console\n-$ cd alluxio/integration/docker\n-$ docker build -t alluxio .\n+# Launch the Alluxio Master\n+$ docker run -d --rm \\\n+    --net=host \\\n+    --name=alluxio-master \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.master.hostname=$(hostname -i) \\\n+       -Dalluxio.master.mount.table.root.ufs=/opt/alluxio/underFSStorage\" \\\n+    alluxio/alluxio master\n+\n+#Launch the Alluxio Worker\n+$ docker run -d --rm \\\n+    --net=host \\\n+    --name=alluxio-worker \\\n+    --shm-size=1G \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.worker.memory.size=1G \\\n+       -Dalluxio.master.hostname=$(hostname -i)\" \\\n+    alluxio/alluxio worker\n ```\n+\u6ce8\u610f:\n+\n+  1. \u53c2\u6570`net=host`\u544a\u8bc9Docker\u4f7f\u7528\u4e3b\u673a\u7f51\u7edc\u3002\u5728\u8fd9\u79cd\u8bbe\u7f6e\u4e0b\uff0c\u5bb9\u5668\u76f4\u63a5\u4f7f\u7528\u4e3b\u673a\u7684\u7f51\u7edc\u9002\u914d\u5668\u3002\n+\u6240\u6709\u5bb9\u5668\u90fd\u5c06\u5177\u6709\u4e0eDocker\u4e3b\u673a\u76f8\u540c\u7684\u4e3b\u673a\u540d\u548cIP\u5730\u5740\uff0c\u5e76\u4e14\u6240\u6709\u4e3b\u673a\u7684\u7aef\u53e3\u4e5f\u90fd\u76f4\u63a5\u6620\u5c04\u5230\u5bb9\u5668\u3002\u56e0\u6b64\uff0c\u6240\u6709\u5fc5\u9700\u7684\u5bb9\u5668\u7aef\u53e3 `19999\u300119998\u300129999\u300130000` \u90fd\u901a\u8fc7Docker\u4e3b\u673a\u5141\u8bb8\u5ba2\u6237\u7aef\u8bbf\u95ee\u3002[\u5728\u6b64\u5904](https://docs.docker.com/network/host/)\u53ef\u4ee5\u627e\u5230\u6709\u5173\u6b64\u8bbe\u7f6e\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002\n+  1. \u53c2\u6570`-e ALLUXIO_JAVA_OPTS =\u201c-Dalluxio.worker.memory.size = 1G -Dalluxio.master.hostname = $(hostname -I)\u201d` \u5206\u914dworker\u7684\u5185\u5b58\u5bb9\u91cf\u5e76\u7ed1\u5b9amaster\u5730\u5740\u3002\u4f7f\u7528`host`\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4e0d\u80fd\u901a\u8fc7master\u5bb9\u5668\u540d\u6765\u5f15\u7528`alluxio-master`\uff0c\u5426\u5219\u5c06\u62a5 \u201cNo Alluxio worker available\u201d \u9519\u8bef\u3002\u800c\u662f\u5e94\u901a\u8fc7\u4e3b\u673aIP\u5730\u5740\u5f15\u7528\u5b83\u3002`$(hostname -i` \u8981\u6539\u7528Docker\u4e3b\u673a\u7684\u540d\u79f0\u3002\n+  1. \u53c2\u6570`--shm-size = 1G`\u5c06\u4e3aworkers\u5206\u914d `1G` tmpfs\u5b58\u50a8Alluxio\u6570\u636e\u3002\n+  1. \u53c2\u6570`-v /alluxio_ufs:/opt/alluxio/underFSStorage` \u6307\u5f15Docker\u4f7f\u7528host volume\u5e76\u5c06Alluxio UFS\u6839\u6570\u636e\u4fdd\u7559\u5728\u4e3b\u673a\u76ee\u5f55 `/alluxio_ufs`\u4e2d\uff0c\u5982\u4e0a\u6587\u5728Docker volume\u90e8\u5206\u6240\u8ff0\u3002\n \n-\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4f1a\u4e3a\u6700\u65b0\u7248\u672c\u7684Alluxio\u6784\u5efa\u955c\u50cf\u3002\u82e5\u8981\u6839\u636e\u672c\u5730\u7684Alluxio\u538b\u7f29\u5305\u6216\u8005\u53e6\u5916\u4e00\u4e2a\u53ef\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u6784\u5efa\uff0c\u53ef\u4ee5\u4f7f\u7528`--build-arg`\u53c2\u6570\u3002\n+### \u9009\u9879B:\u542f\u52a8\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u7edcDocker Alluxio\u5bb9\u5668\n \n-### \u8bbe\u7f6e\u5e95\u5c42\u5b58\u50a8\u7cfb\u7edf\n+\u4f7f\u7528\u4e3b\u673a\u7f51\u7edc\u5f88\u7b80\u5355\uff0c\u4f46\u662f\u6709\u7f3a\u70b9\u3002\u4f8b\u5982\n+\n++ \u5728\u5bb9\u5668\u5185\u8fd0\u884c\u7684\u670d\u52a1\u53ef\u80fd\u4e0e\u4f7f\u7528\u540c\u4e00\u7aef\u53e3\u4e0a\u8fd0\u884c\u7684\u5176\u4ed6\u5bb9\u5668\u4e2d\u7684\u5176\u4ed6\u670d\u52a1\u51b2\u7a81\u3002\n++ \u5bb9\u5668\u53ef\u4ee5\u8bbf\u95ee\u4e3b\u673a\u7684\u6574\u4e2a\u7f51\u7edc\u5806\u6808\u5e26\u6765\u6f5c\u5728\u7684\u5b89\u5168\u98ce\u9669\u3002\n+\n+\u66f4\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u7edc\uff0c\u4f46\u6211\u4eec\u9700\u8981\u660e\u786e\u5f00\u653e\u6240\u9700\u7684\u7aef\u53e3\uff0c\u4ee5\u4fbf\u5916\u90e8\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u5bb9\u5668\u7684\u670d\u52a1:\n \n-\u5728\u4e3b\u673a\u4e0a\u521b\u5efa\u4e00\u4e2a\u5e95\u5c42\u5b58\u50a8\u6587\u4ef6\u76ee\u5f55\n ```console\n-$ mkdir underStorage\n+# Prepare the network\n+$ docker network create alluxio_network\n+\n+# Launch the Alluxio master\n+$ docker run -d  --rm \\\n+    -p 19999:19999 \\\n+    -p 19998:19998 \\\n+    --net=alluxio_network \\\n+    --name=alluxio-master \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.master.hostname=alluxio-master \\\n+       -Dalluxio.master.mount.table.root.ufs=/opt/alluxio/underFSStorage\" \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    alluxio/alluxio master\n+\n+# Launch the Alluxio worker\n+$ docker run -d --rm \\\n+    -p 29999:29999 \\\n+    -p 30000:30000 \\\n+    --net=alluxio_network \\\n+    --name=alluxio-worker \\\n+    --shm-size=1G \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.worker.memory.size=1G \\\n+       -Dalluxio.master.hostname=alluxio-master \\\n+       -Dalluxio.worker.hostname=alluxio-worker\" \\\n+    alluxio/alluxio worker\n ```\n \n-### \u8bbe\u7f6e\u865a\u62df\u5185\u5b58\u5141\u8bb8\u5feb\u901f\u77ed\u8def\u8bfb\u53d6\n+Notes:\n+  1. \u53c2\u6570 `net=alluxio_network`\u544a\u8bc9Docker\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc`alluxio_network`\u3002\u6240\u6709\u5bb9\u5668\u90fd\u5c06\u4f7f\u7528\u5176\u81ea\u5df1\u7684\u5bb9\u5668ID\u4f5c\u4e3a\u5176\u4e3b\u673a\u540d\uff0c\u6bcf\u4e2a\u5bb9\u5668\u5728\u7f51\u7edcsubnet\u4e2d\u5177\u6709\u4e0d\u540c\u7684IP\u5730\u5740\u3002\u9664\u975e\u5b9a\u4e49\u4e86\u9632\u706b\u5899\u7b56\u7565\uff0c\u5426\u5219\u8fde\u63a5\u5230\u76f8\u540c\u7528\u6237\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc\u7684\u5bb9\u5668\u53ef\u4ee5\u6709\u6548\u5730\u5c06\u6240\u6709\u7aef\u53e3\u5bf9\u5f7c\u6b64\u5f00\u653e\u3002\u53ef\u4ee5[\u5728\u6b64\u5904](https://docs.docker.com/network/bridge/)\u627e\u5230\u6709\u5173\u6865\u63a5\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f \u3002 \n+  1. \u4ec5\u6307\u5b9a\u7684\u7aef\u53e3(`-p`\u9009\u9879)\u516c\u5f00\u7ed9\u5ba2\u6237\u7aef\u6240\u5728\u5916\u90e8\u7f51\u7edc\u3002\u547d\u4ee4 `-p <host-port>:<container-port>` \u4f1a\u5c06\u5bb9\u5668\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u7aef\u53e3\u3002\u56e0\u6b64\uff0c\u5fc5\u987b\u660e\u786e\u5f00\u653emaster\u5bb9\u5668\u4e24\u4e2a\u7aef\u53e319999\u548c19998\u548cworker\u5bb9\u5668\u7aef\u53e329999\u548c30000\u3002\u5426\u5219\uff0c\u5ba2\u6237\u7aef\u5c06\u65e0\u6cd5\u4e0emaster\u548cworker\u8fdb\u884c\u901a\u4fe1\u3002\n+  1. \u5982\u679c\u6240\u6709\u901a\u4fe1\u90fd\u5728docker\u7f51\u7edc\u5185\u90e8(\u4f8b\u5982\uff0c\u6ca1\u6709\u5728docker\u7f51\u7edc\u5916\u90e8\u5ba2\u6237\u7aef)\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bb9\u5668\u540d\u79f0(`alluxio-master` for master\u5bb9\u5668\uff0c `alluxio-worker` for worker\u5bb9\u5668)\u6216\u901a\u8fc7Docker\u4e3b\u673a\u7684IP\u5730\u5740$ {`hostname -i`)\u4e3b\u673a\u6765\u5f15\u7528\u5bb9\u5668 \u3002\u5426\u5219\uff0c\u5c31\u5fc5\u987b\u6307\u5b9a\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u7684master\u548cworker\u7684docker\u4e3b\u673aIP(\u4f8b\u5982, \u901a\u8fc7`-Dalluxio.worker.hostname = $(hostname -I`))\u3002\u8fd9\u662fdocker\u7f51\u7edc\u5916\u90e8\u5ba2\u6237\u7aef\u4e0emaster/worker\u901a\u4fe1\u6240\u5fc5\u9700\u7684\u3002\u5426\u5219\uff0c\u5ba2\u6237\u7aef\u5c06\u65e0\u6cd5\u8fde\u63a5\u5230worker\uff0c\u56e0\u4e3a\u5b83\u4eec\u65e0\u6cd5\u8bc6\u522bworker\u7684\u5bb9\u5668ID\u3002\u5c06\u89e6\u53d1\u4ee5\u4e0b\u9519\u8bef:\n+     ```\n+     Target: 5a1a840d2a98:29999, Error: alluxio.exception.status.UnavailableException: Unable to resolve host 5a1a840d2a98\n+     ```\n \n-\u4ece\u4e3b\u673a\uff1a\n+## \u9a8c\u8bc1\u96c6\u7fa4\n \n+\u8981\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u5df2\u542f\u52a8\uff0c\u8fd0\u884c `docker ps`\u3002\u5e94\u8be5\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u4fe1\u606f\n ```console\n-$ sudo mkdir /mnt/ramdisk\n-$ sudo mount -t ramfs -o size=1G ramfs /mnt/ramdisk\n-$ sudo chmod a+w /mnt/ramdisk\n+$ docker ps\n+CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                      NAMES\n+1fef7c714d25        alluxio/alluxio     \"/entrypoint.sh work\u2026\"   39 seconds ago      Up 38 seconds                                  alluxio-worker\n+27f92f702ac2        alluxio/alluxio     \"/entrypoint.sh mast\u2026\"   44 seconds ago      Up 43 seconds       0.0.0.0:19999->19999/tcp   alluxio-master\n ```\n \n-\u91cd\u542fDocker\uff0c\u4f7f\u5f97Docker\u53ef\u4ee5\u68c0\u6d4b\u5230\u65b0\u7684\u6302\u8f7d\u70b9\u3002\n+\u5982\u679c\u4f60\u770b\u4e0d\u5230\u5bb9\u5668\uff0c\u9488\u5bf9\u5bb9\u5668ids\u8fd0\u884c`docker logs`\u67e5\u770b\u53d1\u751f\u4e86\u4ec0\u4e48\u3002\u5bb9\u5668ID\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c`docker run`\u547d\u4ee4\u6765\u627e\u5230\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7`docker ps -a`\u547d\u4ee4\u3002\n+\n+\u8bbf\u95ee`instance-hostname`:19999 \u67e5\u770bAlluxio Web UI\u3002\u5e94\u8be5\u770b\u5230\u4e00\u4e2aworker\u5df2\u8fde\u63a5\u5e76\u63d0\u4f9b`1024MB`\u7684\u7a7a\u95f4\u3002\n+\n+\u5982\u8981\u8fd0\u884c\u6d4b\u8bd5\uff0c\u5148\u8fdb\u5165worker\u5bb9\u5668\u6267\u884c\n \n ```console\n-$ sudo service docker restart\n+$ docker exec -it alluxio-worker /bin/bash\n ```\n \n-## \u8fd0\u884cAlluxio master\n+\u7136\u540e\u8fd0\u884c\u6d4b\u8bd5\n \n ```console\n-$ docker run -d --net=host alluxio master\n+$ cd /opt/alluxio\n+$ ./bin/alluxio runTests\n ```\n \n-### \u8fd0\u884cAlluxio master\n+\u8981\u6d4b\u8bd5\u8fdc\u7a0b\u5ba2\u6237\u7aef\u8bbf\u95ee\uff0c\u4f8b\u5982\uff0c\u4eceSpark\u96c6\u7fa4 (Python 3)\n \n-```console\n-# This gets the public ip of the current EC2 instance\n-$ export INSTANCE_PUBLIC_IP=$(curl http://169.254.169.254/latest/meta-data/public-ipv4)\n-$ docker run -d --net=host \\\n-             -v $PWD/underStorage:/underStorage \\\n-             -e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP} \\\n-             -e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage \\\n-             alluxio master\n+```scala\n+textFile_alluxio_path = \"alluxio://{docker_host-ip}:19998/path_to_the_file\"\n+textFile_RDD = sc.textFile (textFile_alluxio_path)\n+\n+for line in textFile_RDD.collect():\n+  print (line)\n ```\n-\u8be6\u7ec6\u8bf4\u660e:\n-- `-e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP}`: \u6307\u5b9a Alluxio master \u7684\u76d1\u542c IP \u5730\u5740.\n-- `-v $PWD/underStorage:/underStorage`:\u548cDocker\u5bb9\u5668\u5171\u4eab\u5e95\u5c42\u5b58\u50a8\u5c42\u6587\u4ef6\u5939\u3002\n-- `-e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage`:\u901a\u77e5worker\u5e94\u7528 /underStorage\u4e3a\u5e95\u5c42\u6587\u4ef6\u5b58\u50a8\u5c42\u3002\n \n+\u606d\u559c\uff0c\u60a8\u5df2\u7ecf\u90e8\u7f72\u4e86\u4e00\u4e2a\u57fa\u672c\u7684Dockerized\u5bb9\u5668\u5316 Alluxio\u96c6\u7fa4\uff01\u8bf7\u7ee7\u7eed\u9605\u8bfb\u4ee5\u4e86\u89e3\u66f4\u591a\u6709\u5173\u5982\u4f55\u7ba1\u7406\u96c6\u7fa4\u5e76\u4f7f\u4e4b\u6295\u5165\u751f\u4ea7\u7684\u4fe1\u606f\u3002\n \n-## \u8fd0\u884cAlluxio worker\n+## \u64cd\u4f5c\u4ecb\u7ecd\n \n-```console\n-# Launch an Alluxio worker container and save the container ID for later\n-$ ALLUXIO_WORKER_CONTAINER_ID=$(docker run -d --net=host \\\n-             -v /mnt/ramdisk:/opt/ramdisk \\\n-             -v $PWD/underStorage:/underStorage \\\n-             -e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP} \\\n-             -e ALLUXIO_RAM_FOLDER=/opt/ramdisk \\\n-             -e ALLUXIO_WORKER_MEMORY_SIZE=1GB \\\n-             -e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage \\\n-             alluxio worker)\n-```\n-Details:\n-- `-v /mnt/ramdisk:/opt/ramdisk`: \u548cDocker\u5bb9\u5668\u5171\u4eab\u4e3b\u673a\u7684ramdisk\u3002\n-- `-v $PWD/underStorage:/underStorage`: \u548cDocker\u5bb9\u5668\u5171\u4eab\u5e95\u5c42\u6587\u4ef6\u7cfb\u7edf\u7684\u6587\u4ef6\u5939\u3002\n-- `-e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP}`: \u901a\u77e5worker\u5982\u4f55\u8fde\u63a5Master\u3002\n-- `-e ALLUXIO_RAM_FOLDER=/opt/ramdisk`: \u901a\u77e5worker\u5982\u4f55\u5b9a\u4f4dramdisk\u3002\n-- `-e ALLUXIO_WORKER_MEMORY_SIZE=1GB`: \u901a\u77e5worker\u8282\u70b9ramdisk\u53ef\u7528\u7a7a\u95f4\u3002\n-- `-e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage`: \u901a\u77e5worker\u5c06/underStorage\u4f5c\u4e3a\u5e95\u5c42\u6587\u4ef6\u7cfb\u7edf\u3002\n-\n-### \u6d4b\u8bd5\u96c6\u7fa4\n-\n-\u8981\u6d4b\u8bd5\u8be5\u96c6\u7fa4\u662f\u5426\u5b89\u88c5\u6210\u529f\uff0c\u9996\u5148\u8fdb\u5165worker Docker\u5bb9\u5668\u3002\n+### \u670d\u52a1\u5668\u914d\u7f6e\n \n-```console\n-$ docker exec -it ${ALLUXIO_WORKER_CONTAINER_ID} /bin/sh\n-```\n+\u914d\u7f6e\u66f4\u6539\u9700\u8981\u505c\u6b62Alluxio Docker\u955c\u50cf\uff0c\u7136\u540e\u4f7f\u7528\u65b0\u914d\u7f6e\u91cd\u65b0\u542f\u52a8\u5b83\u4eec\u3002\n \n-\u63a5\u7740\u8fd0\u884cAlluxio\u6d4b\u8bd5\n+\u8981\u6b63\u786e\u8bbe\u7f6eAlluxio\u914d\u7f6e\u5c5e\u6027\uff0c\u8bf7\u5c06\u5176\u6dfb\u52a0\u5230Alluxio java\u9009\u9879\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\n \n-```console\n-$ cd opt/alluxio\n-$ ./bin/alluxio runTests\n ```\n-# \u901a\u8fc7\u5177\u4f53\u7684Alluxio\u5206\u5e03\u5f0f\u73af\u5883\u642d\u5efaDocker\u955c\u50cf\n+-e ALLUXIO_JAVA_OPTS=\"-Dalluxio.property.name=value\"\n+```\n \n-\u901a\u8fc7 `--build-arg`\uff0c\u5c06\u672c\u5730\u6216\u8fdc\u7a0b\u7684Alluxio\u538b\u7f29\u5305\u642d\u5efaAlluxio Docker\u955c\u50cf\n+\u591a\u4e2a\u5c5e\u6027\u5e94\u4ee5\u7a7a\u683c\u5206\u9694\u3002\n \n-\u672c\u5730\u538b\u7f29\u5305:\n-```console\n-$ docker build -t alluxio --build-arg ALLUXIO_TARBALL=alluxio-snapshot.tar.gz .\n+\u5982\u679c\u5c5e\u6027\u503c\u5305\u542b\u7a7a\u683c\uff0c\u5219\u5fc5\u987b\u4f7f\u7528\u5355\u5f15\u53f7\u5c06\u5176\u8f6c\u4e49\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24f086a6e161b014ac37c33d36b48bb464672d42"}, "originalPosition": 296}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY5MTgzOQ==", "bodyText": "\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c docker logs $container_id \u6765\u8bbf\u95eeAlluxio \u670d\u52a1\u5668\u65e5\u5fd7\u3002\nthe docker logs $ contianer_id is a single command with backticks, so we can keep them the same when translating other texts", "url": "https://github.com/Alluxio/alluxio/pull/11890#discussion_r464691839", "createdAt": "2020-08-03T22:19:25Z", "author": {"login": "LuQQiu"}, "path": "docs/cn/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -1,232 +1,318 @@\n ---\n layout: global\n-title: \u5728Docker\u4e0a\u8fd0\u884cAlluxio\n-nickname: \u5728Docker\u4e0a\u8fd0\u884cAlluxio\n+title: \u5728\u96c6\u7fa4\u4e0a\u72ec\u7acb\u8fd0\u884cAlluxio\n+nickname: \u5728\u96c6\u7fa4\u4e0a\u72ec\u7acb\u8fd0\u884cAlluxio\n group: Install Alluxio\n priority: 3\n ---\n \n-* \u5185\u5bb9\u5217\u8868\n-{:toc}\n-\n-Alluxio\u53ef\u4ee5\u8fd0\u884c\u5728\u4e00\u4e2aDocker\u5bb9\u5668\u4e2d\uff0c\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528Alluxio Github\u4ed3\u5e93\u63d0\u4f9b\u7684Dockerfile\u6765\u5c06Alluxio\u8fd0\u884c\u5728Docker\u4e4b\u4e2d\u3002\n+Docker\u53ef\u7528\u4e8e\u7b80\u5316Alluxio\u670d\u52a1\u5668\u7684\u90e8\u7f72\u548c\u7ba1\u7406\u3002\u4f7f\u7528 Dockerhub\u4e0a\u7684[alluxio/alluxio](https://hub.docker.com/r/alluxio/alluxio/)Docker\u955c\u50cf\uff0c\u53ea\u8981\u8fd0\u884c\u51e0\u4e2a`docker run`\u547d\u4ee4\u5c31\u53ef\u4ee5\u4ece\u96f6\u5230\u8fd0\u884cAlluxio\u96c6\u7fa4\u3002\u672c\u6587\u6863\u63d0\u4f9b\u4e86\u4ee5\u672c\u5730\u78c1\u76d8\u4f5c\u4e3a\u5e95\u5c42\u5b58\u50a8\u7684\u5355\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884cDockerized Alluxio\u7684\u6559\u7a0b\u3002\u6211\u4eec\u4e5f\u8fd8\u5c06\u8ba8\u8bba\u66f4\u9ad8\u7ea7\u7684\u4e3b\u9898\u4ee5\u53ca\u5982\u4f55\u89e3\u51b3\u9047\u5230\u7684\u95ee\u9898\u3002\n \n-# \u57fa\u7840\u6559\u7a0b\n-\n-\u8fd9\u7bc7\u6559\u7a0b\u4e3b\u8981\u4ecb\u7ecd\u5982\u4f55\u5728\u5355\u8282\u70b9\u4e0a\u4f7f\u7528Docker\u8fd0\u884cAlluxio\u3002\n+* Table of Contents\n+{:toc}\n \n-# \u524d\u671f\u51c6\u5907\n+## \u524d\u63d0\u6761\u4ef6\n \n-\u4e00\u53f0Linux\u4e3b\u673a\u3002\u5728\u8be5\u6307\u5357\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4e00\u53f0\u5168\u65b0\u7684\u8fd0\u884c\u7740Amazon Linux\u7684EC2\u4e3b\u673a\u3002\u4e3b\u673a\u5bb9\u91cf\u4e0d\u9700\u8981\u592a\u5927\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528t2.small\u3002\u5f53\u4e3a\u5b9e\u4f8b\u8bbe\u7f6e\u7f51\u7edc\u5b89\u5168\u65f6\uff0c\u5141\u8bb8\u7aef\u53e319998-19999\u548c29998-30000\u901a\u4fe1\u3002\n+- \u4e00\u53f0\u5b89\u88c5\u4e86Docker\u4e3b\u673a\u3002\n+- \u5f00\u653e\u7aef\u53e319998\u300119999\u300129998\u300129999\u548c30000\n \n-# \u542f\u52a8\u4e00\u4e2a\u72ec\u7acb\u6a21\u5f0f\u96c6\u7fa4\n+\u5982\u679c\u81ea\u5df1\u6ca1\u6709\u5b89\u88c5\u4e86Docker\u7684\u4e3b\u673a\uff0c\u5219\u53ef\u4ee5\u5728AWS\u4e0a\u521b\u5efa\u4e00\u4e2a\u5c0fAWS EC2\u8ba1\u7b97\u5b9e\u4f8b(\u4f8b\u5982t2.small)\uff0c\u4ee5\u4fbf\u968f\u672c\u6559\u7a0b\u4e00\u8d77\u5b66\u4e60\u3002\u5bf9EC2\u7684security group\u505a\u51fa\u4ee5\u4e0b\u8bbe\u7f6e\uff0c\u4ee5\u4fbf\u4ee5\u4e0b\u7aef\u53e3\u5bf9\u4f60\u7684IP\u5730\u5740\u548cAlluxio\u5ba2\u6237\u7aef(\u4f8b\u5982\uff0c\u8fdc\u7a0bSpark\u96c6\u7fa4)CIDR\u8303\u56f4\u5185\u5730\u5740\u65f6\u5f00\u653e\u7684:\n \n-\u4f60\u9700\u8981\u5728\u4f60\u7684Linux\u4e3b\u673a\u4e0a\u6267\u884c\u4ee5\u4e0b\u7684\u6240\u6709\u6b65\u9aa4\u3002\n++ \u5bf9\u4e8eAlluxio\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aefCIDR\u5730\u5740\u8303\u56f4\u5185\u7aef\u53e319998:\u5141\u8bb8\u5ba2\u6237\u7aef\u548cworkers\u4e0eAlluxio Master RPC\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u3002\n++ \u4f60\u7684\u6d4f\u89c8\u5668\u7684IP\u5730\u5740\u7aef\u53e319999:\u5141\u8bb8\u60a8\u8bbf\u95eeAlluxio master Web UI\u3002\n++ Alluxio\u548c\u5ba2\u6237\u7aef\u7684CIDR\u8303\u56f4\u5185\u7aef\u53e329999:\u5141\u8bb8\u5ba2\u6237\u7aef\u4e0eAlluxio Worker RPC\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u3002\n++ \u4f60\u7684\u6d4f\u89c8\u5668\u7684IP\u5730\u5740\u7aef\u53e330000:\u5141\u8bb8\u60a8\u8bbf\u95eeAlluxio worker Web UI\u3002\n \n-## \u5b89\u88c5Docker\n+\u5728\u53d1\u653e\u5b9e\u4f8b\u540e(\u540e\u7eed\u79f0\u4e3aDocker Host)\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u8bbe\u7f6eDocker\n \n ```console\n-$ sudo yum install -y docker git\n+$ sudo yum install -y docker\n $ sudo service docker start\n # Add the current user to the docker group\n $ sudo usermod -a -G docker $(id -u -n)\n # Log out and log back in again to pick up the group changes\n $ exit\n ```\n \n-## \u590d\u5236Alluxio\u4ed3\u5e93\n+## \u51c6\u5907Docker Volume\u5b58\u50a8\u6570\u636e\n \n-```console\n-$ git clone https://github.com/Alluxio/alluxio.git\n-```\n+\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5bb9\u5668\u5185\u521b\u5efa\u7684\u6240\u6709\u6587\u4ef6\u90fd\u5b58\u5728\u53ef\u5199\u7684\u5bb9\u5668layer\u3002\u5f53\u8be5\u5bb9\u5668\u4e0d\u518d\u5b58\u5728\u65f6\uff0c\u6570\u636e\u4e0d\u4f1a\u4fdd\u7559\u3002[Docker volumes](https://docs.docker.com/storage/volumes/)\u662f\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u5bb9\u5668\u5916\u90e8\u7684\u65b9\u6cd5\u3002\u6700\u5e38\u4f7f\u7528\u7684\u4ee5\u4e0b\u4e24\u79cd\u7684Docker volumes:\n+\n++ **Host Volume**:\u4f60\u6765\u51b3\u5b9a\u548c\u7ba1\u7406\u5728Docker \u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5728\u54ea\u91cc\u5b58\u50a8\u548c\u5171\u4eab\u5bb9\u5668\u6570\u636e\u3002\u521b\u5efahost volume\uff0c\u8fd0\u884c:\n+\n+  ```console\n+  $ docker run -v /path/on/host:/path/in/container ...\n+  ```\n+  \u6587\u4ef6\u6216\u76ee\u5f55\u901a\u8fc7Docker\u4e3b\u673a\u4e0a\u7684\u5b8c\u6574\u8def\u5f84\u5f15\u7528\u3002\u53ef\u4ee5\u662f\u5df2\u7ecf\u5b58\u5728\u4e8eDocker\u4e3b\u673a\u4e0a\u7684\uff0c\u5982\u679c\u5c1a\u4e0d\u5b58\u5728\u5219\u4f1a\u81ea\u52a8\u521b\u5efa\u3002\n+\n++ **Named Volume**:Docker\u6765\u7ba1\u7406\u5176\u4f4d\u7f6e\u3002\u7528\u7279\u5b9a\u540d\u79f0\u6765\u6307\u4ee3\u5373\u53ef\u3002\u521b\u5efa\u547d\u540d\u5377\uff0c\u8fd0\u884c:\n+\n+  ```console\n+  $ docker volume create volumeName\n+  $ docker run -v  volumeName:/path/in/container ...\n+  ```\n+\n+Alluxio\u5bb9\u5668\u7528host volume\u6216named volume\u90fd\u53ef\u4ee5\u3002\u51fa\u4e8e\u6d4b\u8bd5\u76ee\u7684\u8bdd\uff0c\u5efa\u8bae\u4f7f\u7528host volume\uff0c\u56e0\u4e3a\u5b83\u662f\u6700\u5bb9\u6613\u4f7f\u7528\u7684volume\uff0c\u5e76\u4e14\u6027\u80fd\u975e\u5e38\u597d\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u4f60\u77e5\u9053\u5728\u4e3b\u673a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6240\u5f15\u7528\u6570\u636e\u7684\u4f4d\u7f6e\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u5bb9\u5668\u5916\u90e8\u76f4\u63a5\u548c\u5f88\u5bb9\u6613\u7684\u505a\u9488\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u3002\n+\n+\u56e0\u6b64\uff0c\u6211\u4eec\u5c06\u4f7f\u7528host volume\u5e76\u5c06host\u76ee\u5f55 `/alluxio_ufs`\u6302\u8f7d\u5230\u5bb9\u5668\u8def\u5f84 `/opt/alluxio/underFSStorage`\uff0c\u8fd9\u662fAlluxio docker\u955c\u50cf\u4e2dAlluxio UFS root\u6302\u8f7d\u70b9\u7684\u9ed8\u8ba4\u8bbe\u7f6e:\n+  ```console\n+  $ docker run -v /alluxio_ufs:/opt/alluxio/underFSStorage   ...\n+  ```\n+\u5f53\u7136\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u5b89\u88c5\u5230\u5176\u4ed6\u8def\u5f84\u6765\u4ee3\u66ff`/alluxio_ufs`\u3002\u4ece2.1\u7248\u672c\u5f00\u59cb\uff0cAlluxio Docker\u955c\u50cf\u9ed8\u8ba4\u4ee5`alluxio`\u7528\u6237\u8fd0\u884c\u3002UID\u4e3a1000\u548cGID1000\u3002\u786e\u4fdd\u8fd0\u884cDocker\u955c\u50cf\u7684\u7528\u6237\u53ef\u5199\u8be5\u6587\u4ef6\u3002\n+\n+## \u542f\u52a8Alluxio Master\u548cWorker\u5bb9\u5668\n \n-## \u6784\u5efaAlluxio Docker\u955c\u50cf\n+Alluxio\u5ba2\u6237\u7aef(\u672c\u5730\u6216\u8fdc\u7a0b)\u9700\u8981\u4e0eAlluxio master\u548cworker\u901a\u4fe1\u3002\u56e0\u6b64\uff0c\u786e\u4fdd\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u4ee5\u4e0b\u4e24\u9879\u670d\u52a1\u975e\u5e38\u91cd\u8981:\n+\n++ Master RPC \u7aef\u53e319998\n++ Worker RPC \u7aef\u53e329999\n+\n+Alluxio\u96c6\u7fa4\u4e2d\uff0c\u540c\u65f6\u8981\u786e\u4fddmaster\u548cworker\u5bb9\u5668\u53ef\u4ee5\u5728[\u4e0b\u9762\u5b9a\u4e49\u7684\u7aef\u53e3\u4e92\u8bbf]({{ '/en/deploy/Requirements.html#general-requirements' | relativize_url}})\u3002\n+\n+\u6211\u4eec\u5c06\u5728\u540c\u4e00\u53f0Docker\u4e3b\u673a\u4e0a\u542f\u52a8Alluxio master\u5bb9\u5668\u548cworker\u5bb9\u5668\u3002\u4e3a\u4e86\u786e\u4fdd\u6b64\u65b9\u6cd5\u9002\u7528\u4e8e\u672c\u5730\u6216\u8fdc\u7a0b\u5ba2\u6237\u7aef\uff0c\u5fc5\u987b\u8bbe\u7f6eDocker\u7f51\u7edc\u51c6\u786e\u5f00\u653e\u901a\u4fe1\u6240\u9700\u7aef\u53e3\u3002\n+\n+\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5728Docker\u4e3b\u673a\u4e0a\u542f\u52a8Alluxio Docker\u5bb9\u5668:\n++ A: \u4f7f\u7528[\u4e3b\u673a\u7f51\u7edc](https://docs.docker.com/network/host/) \u6216\n++ B: \u4f7f\u7528[\u7528\u6237\u81ea\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc](https://docs.docker.com/network/bridge/)\u3002\n+\n+\u4e3b\u673a\u7f51\u7edc\u5728\u5bb9\u5668\u548cDocker\u4e3b\u673a\u4e4b\u95f4\u5171\u4eabip\u5730\u5740\u548c\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u3002\u7528\u6237\u81ea\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc\u5141\u8bb8\u5728\u6865\u63a5\u7f51\u7edc\u5185\u7684\u5bb9\u5668\u4e92\u76f8\u901a\u4fe1\uff0c\u540c\u65f6\u4e0e\u672a\u8fde\u63a5\u5230\u8be5\u6865\u63a5\u7f51\u7edc\u7684\u5bb9\u5668\u9694\u79bb\u3002\u5efa\u8bae\u4f7f\u7528\u4e3b\u673a\u7f51\u7edc(\u9009\u9879A)\u8fdb\u884c\u6d4b\u8bd5\u3002\n+\n+### \u9009\u9879A:\u542f\u52a8\u4f7f\u7528\u4e3b\u673a\u7f51\u7edcDocker Alluxio\u5bb9\u5668\n \n ```console\n-$ cd alluxio/integration/docker\n-$ docker build -t alluxio .\n+# Launch the Alluxio Master\n+$ docker run -d --rm \\\n+    --net=host \\\n+    --name=alluxio-master \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.master.hostname=$(hostname -i) \\\n+       -Dalluxio.master.mount.table.root.ufs=/opt/alluxio/underFSStorage\" \\\n+    alluxio/alluxio master\n+\n+#Launch the Alluxio Worker\n+$ docker run -d --rm \\\n+    --net=host \\\n+    --name=alluxio-worker \\\n+    --shm-size=1G \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.worker.memory.size=1G \\\n+       -Dalluxio.master.hostname=$(hostname -i)\" \\\n+    alluxio/alluxio worker\n ```\n+\u6ce8\u610f:\n+\n+  1. \u53c2\u6570`net=host`\u544a\u8bc9Docker\u4f7f\u7528\u4e3b\u673a\u7f51\u7edc\u3002\u5728\u8fd9\u79cd\u8bbe\u7f6e\u4e0b\uff0c\u5bb9\u5668\u76f4\u63a5\u4f7f\u7528\u4e3b\u673a\u7684\u7f51\u7edc\u9002\u914d\u5668\u3002\n+\u6240\u6709\u5bb9\u5668\u90fd\u5c06\u5177\u6709\u4e0eDocker\u4e3b\u673a\u76f8\u540c\u7684\u4e3b\u673a\u540d\u548cIP\u5730\u5740\uff0c\u5e76\u4e14\u6240\u6709\u4e3b\u673a\u7684\u7aef\u53e3\u4e5f\u90fd\u76f4\u63a5\u6620\u5c04\u5230\u5bb9\u5668\u3002\u56e0\u6b64\uff0c\u6240\u6709\u5fc5\u9700\u7684\u5bb9\u5668\u7aef\u53e3 `19999\u300119998\u300129999\u300130000` \u90fd\u901a\u8fc7Docker\u4e3b\u673a\u5141\u8bb8\u5ba2\u6237\u7aef\u8bbf\u95ee\u3002[\u5728\u6b64\u5904](https://docs.docker.com/network/host/)\u53ef\u4ee5\u627e\u5230\u6709\u5173\u6b64\u8bbe\u7f6e\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002\n+  1. \u53c2\u6570`-e ALLUXIO_JAVA_OPTS =\u201c-Dalluxio.worker.memory.size = 1G -Dalluxio.master.hostname = $(hostname -I)\u201d` \u5206\u914dworker\u7684\u5185\u5b58\u5bb9\u91cf\u5e76\u7ed1\u5b9amaster\u5730\u5740\u3002\u4f7f\u7528`host`\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0c\u4e0d\u80fd\u901a\u8fc7master\u5bb9\u5668\u540d\u6765\u5f15\u7528`alluxio-master`\uff0c\u5426\u5219\u5c06\u62a5 \u201cNo Alluxio worker available\u201d \u9519\u8bef\u3002\u800c\u662f\u5e94\u901a\u8fc7\u4e3b\u673aIP\u5730\u5740\u5f15\u7528\u5b83\u3002`$(hostname -i` \u8981\u6539\u7528Docker\u4e3b\u673a\u7684\u540d\u79f0\u3002\n+  1. \u53c2\u6570`--shm-size = 1G`\u5c06\u4e3aworkers\u5206\u914d `1G` tmpfs\u5b58\u50a8Alluxio\u6570\u636e\u3002\n+  1. \u53c2\u6570`-v /alluxio_ufs:/opt/alluxio/underFSStorage` \u6307\u5f15Docker\u4f7f\u7528host volume\u5e76\u5c06Alluxio UFS\u6839\u6570\u636e\u4fdd\u7559\u5728\u4e3b\u673a\u76ee\u5f55 `/alluxio_ufs`\u4e2d\uff0c\u5982\u4e0a\u6587\u5728Docker volume\u90e8\u5206\u6240\u8ff0\u3002\n \n-\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4f1a\u4e3a\u6700\u65b0\u7248\u672c\u7684Alluxio\u6784\u5efa\u955c\u50cf\u3002\u82e5\u8981\u6839\u636e\u672c\u5730\u7684Alluxio\u538b\u7f29\u5305\u6216\u8005\u53e6\u5916\u4e00\u4e2a\u53ef\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u6784\u5efa\uff0c\u53ef\u4ee5\u4f7f\u7528`--build-arg`\u53c2\u6570\u3002\n+### \u9009\u9879B:\u542f\u52a8\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u7edcDocker Alluxio\u5bb9\u5668\n \n-### \u8bbe\u7f6e\u5e95\u5c42\u5b58\u50a8\u7cfb\u7edf\n+\u4f7f\u7528\u4e3b\u673a\u7f51\u7edc\u5f88\u7b80\u5355\uff0c\u4f46\u662f\u6709\u7f3a\u70b9\u3002\u4f8b\u5982\n+\n++ \u5728\u5bb9\u5668\u5185\u8fd0\u884c\u7684\u670d\u52a1\u53ef\u80fd\u4e0e\u4f7f\u7528\u540c\u4e00\u7aef\u53e3\u4e0a\u8fd0\u884c\u7684\u5176\u4ed6\u5bb9\u5668\u4e2d\u7684\u5176\u4ed6\u670d\u52a1\u51b2\u7a81\u3002\n++ \u5bb9\u5668\u53ef\u4ee5\u8bbf\u95ee\u4e3b\u673a\u7684\u6574\u4e2a\u7f51\u7edc\u5806\u6808\u5e26\u6765\u6f5c\u5728\u7684\u5b89\u5168\u98ce\u9669\u3002\n+\n+\u66f4\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u7edc\uff0c\u4f46\u6211\u4eec\u9700\u8981\u660e\u786e\u5f00\u653e\u6240\u9700\u7684\u7aef\u53e3\uff0c\u4ee5\u4fbf\u5916\u90e8\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u5bb9\u5668\u7684\u670d\u52a1:\n \n-\u5728\u4e3b\u673a\u4e0a\u521b\u5efa\u4e00\u4e2a\u5e95\u5c42\u5b58\u50a8\u6587\u4ef6\u76ee\u5f55\n ```console\n-$ mkdir underStorage\n+# Prepare the network\n+$ docker network create alluxio_network\n+\n+# Launch the Alluxio master\n+$ docker run -d  --rm \\\n+    -p 19999:19999 \\\n+    -p 19998:19998 \\\n+    --net=alluxio_network \\\n+    --name=alluxio-master \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.master.hostname=alluxio-master \\\n+       -Dalluxio.master.mount.table.root.ufs=/opt/alluxio/underFSStorage\" \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    alluxio/alluxio master\n+\n+# Launch the Alluxio worker\n+$ docker run -d --rm \\\n+    -p 29999:29999 \\\n+    -p 30000:30000 \\\n+    --net=alluxio_network \\\n+    --name=alluxio-worker \\\n+    --shm-size=1G \\\n+    -v /alluxio_ufs:/opt/alluxio/underFSStorage \\\n+    -e ALLUXIO_JAVA_OPTS=\" \\\n+       -Dalluxio.worker.memory.size=1G \\\n+       -Dalluxio.master.hostname=alluxio-master \\\n+       -Dalluxio.worker.hostname=alluxio-worker\" \\\n+    alluxio/alluxio worker\n ```\n \n-### \u8bbe\u7f6e\u865a\u62df\u5185\u5b58\u5141\u8bb8\u5feb\u901f\u77ed\u8def\u8bfb\u53d6\n+Notes:\n+  1. \u53c2\u6570 `net=alluxio_network`\u544a\u8bc9Docker\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc`alluxio_network`\u3002\u6240\u6709\u5bb9\u5668\u90fd\u5c06\u4f7f\u7528\u5176\u81ea\u5df1\u7684\u5bb9\u5668ID\u4f5c\u4e3a\u5176\u4e3b\u673a\u540d\uff0c\u6bcf\u4e2a\u5bb9\u5668\u5728\u7f51\u7edcsubnet\u4e2d\u5177\u6709\u4e0d\u540c\u7684IP\u5730\u5740\u3002\u9664\u975e\u5b9a\u4e49\u4e86\u9632\u706b\u5899\u7b56\u7565\uff0c\u5426\u5219\u8fde\u63a5\u5230\u76f8\u540c\u7528\u6237\u5b9a\u4e49\u6865\u63a5\u7f51\u7edc\u7684\u5bb9\u5668\u53ef\u4ee5\u6709\u6548\u5730\u5c06\u6240\u6709\u7aef\u53e3\u5bf9\u5f7c\u6b64\u5f00\u653e\u3002\u53ef\u4ee5[\u5728\u6b64\u5904](https://docs.docker.com/network/bridge/)\u627e\u5230\u6709\u5173\u6865\u63a5\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f \u3002 \n+  1. \u4ec5\u6307\u5b9a\u7684\u7aef\u53e3(`-p`\u9009\u9879)\u516c\u5f00\u7ed9\u5ba2\u6237\u7aef\u6240\u5728\u5916\u90e8\u7f51\u7edc\u3002\u547d\u4ee4 `-p <host-port>:<container-port>` \u4f1a\u5c06\u5bb9\u5668\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u7aef\u53e3\u3002\u56e0\u6b64\uff0c\u5fc5\u987b\u660e\u786e\u5f00\u653emaster\u5bb9\u5668\u4e24\u4e2a\u7aef\u53e319999\u548c19998\u548cworker\u5bb9\u5668\u7aef\u53e329999\u548c30000\u3002\u5426\u5219\uff0c\u5ba2\u6237\u7aef\u5c06\u65e0\u6cd5\u4e0emaster\u548cworker\u8fdb\u884c\u901a\u4fe1\u3002\n+  1. \u5982\u679c\u6240\u6709\u901a\u4fe1\u90fd\u5728docker\u7f51\u7edc\u5185\u90e8(\u4f8b\u5982\uff0c\u6ca1\u6709\u5728docker\u7f51\u7edc\u5916\u90e8\u5ba2\u6237\u7aef)\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bb9\u5668\u540d\u79f0(`alluxio-master` for master\u5bb9\u5668\uff0c `alluxio-worker` for worker\u5bb9\u5668)\u6216\u901a\u8fc7Docker\u4e3b\u673a\u7684IP\u5730\u5740$ {`hostname -i`)\u4e3b\u673a\u6765\u5f15\u7528\u5bb9\u5668 \u3002\u5426\u5219\uff0c\u5c31\u5fc5\u987b\u6307\u5b9a\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u7684master\u548cworker\u7684docker\u4e3b\u673aIP(\u4f8b\u5982, \u901a\u8fc7`-Dalluxio.worker.hostname = $(hostname -I`))\u3002\u8fd9\u662fdocker\u7f51\u7edc\u5916\u90e8\u5ba2\u6237\u7aef\u4e0emaster/worker\u901a\u4fe1\u6240\u5fc5\u9700\u7684\u3002\u5426\u5219\uff0c\u5ba2\u6237\u7aef\u5c06\u65e0\u6cd5\u8fde\u63a5\u5230worker\uff0c\u56e0\u4e3a\u5b83\u4eec\u65e0\u6cd5\u8bc6\u522bworker\u7684\u5bb9\u5668ID\u3002\u5c06\u89e6\u53d1\u4ee5\u4e0b\u9519\u8bef:\n+     ```\n+     Target: 5a1a840d2a98:29999, Error: alluxio.exception.status.UnavailableException: Unable to resolve host 5a1a840d2a98\n+     ```\n \n-\u4ece\u4e3b\u673a\uff1a\n+## \u9a8c\u8bc1\u96c6\u7fa4\n \n+\u8981\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u5df2\u542f\u52a8\uff0c\u8fd0\u884c `docker ps`\u3002\u5e94\u8be5\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u4fe1\u606f\n ```console\n-$ sudo mkdir /mnt/ramdisk\n-$ sudo mount -t ramfs -o size=1G ramfs /mnt/ramdisk\n-$ sudo chmod a+w /mnt/ramdisk\n+$ docker ps\n+CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                      NAMES\n+1fef7c714d25        alluxio/alluxio     \"/entrypoint.sh work\u2026\"   39 seconds ago      Up 38 seconds                                  alluxio-worker\n+27f92f702ac2        alluxio/alluxio     \"/entrypoint.sh mast\u2026\"   44 seconds ago      Up 43 seconds       0.0.0.0:19999->19999/tcp   alluxio-master\n ```\n \n-\u91cd\u542fDocker\uff0c\u4f7f\u5f97Docker\u53ef\u4ee5\u68c0\u6d4b\u5230\u65b0\u7684\u6302\u8f7d\u70b9\u3002\n+\u5982\u679c\u4f60\u770b\u4e0d\u5230\u5bb9\u5668\uff0c\u9488\u5bf9\u5bb9\u5668ids\u8fd0\u884c`docker logs`\u67e5\u770b\u53d1\u751f\u4e86\u4ec0\u4e48\u3002\u5bb9\u5668ID\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c`docker run`\u547d\u4ee4\u6765\u627e\u5230\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7`docker ps -a`\u547d\u4ee4\u3002\n+\n+\u8bbf\u95ee`instance-hostname`:19999 \u67e5\u770bAlluxio Web UI\u3002\u5e94\u8be5\u770b\u5230\u4e00\u4e2aworker\u5df2\u8fde\u63a5\u5e76\u63d0\u4f9b`1024MB`\u7684\u7a7a\u95f4\u3002\n+\n+\u5982\u8981\u8fd0\u884c\u6d4b\u8bd5\uff0c\u5148\u8fdb\u5165worker\u5bb9\u5668\u6267\u884c\n \n ```console\n-$ sudo service docker restart\n+$ docker exec -it alluxio-worker /bin/bash\n ```\n \n-## \u8fd0\u884cAlluxio master\n+\u7136\u540e\u8fd0\u884c\u6d4b\u8bd5\n \n ```console\n-$ docker run -d --net=host alluxio master\n+$ cd /opt/alluxio\n+$ ./bin/alluxio runTests\n ```\n \n-### \u8fd0\u884cAlluxio master\n+\u8981\u6d4b\u8bd5\u8fdc\u7a0b\u5ba2\u6237\u7aef\u8bbf\u95ee\uff0c\u4f8b\u5982\uff0c\u4eceSpark\u96c6\u7fa4 (Python 3)\n \n-```console\n-# This gets the public ip of the current EC2 instance\n-$ export INSTANCE_PUBLIC_IP=$(curl http://169.254.169.254/latest/meta-data/public-ipv4)\n-$ docker run -d --net=host \\\n-             -v $PWD/underStorage:/underStorage \\\n-             -e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP} \\\n-             -e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage \\\n-             alluxio master\n+```scala\n+textFile_alluxio_path = \"alluxio://{docker_host-ip}:19998/path_to_the_file\"\n+textFile_RDD = sc.textFile (textFile_alluxio_path)\n+\n+for line in textFile_RDD.collect():\n+  print (line)\n ```\n-\u8be6\u7ec6\u8bf4\u660e:\n-- `-e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP}`: \u6307\u5b9a Alluxio master \u7684\u76d1\u542c IP \u5730\u5740.\n-- `-v $PWD/underStorage:/underStorage`:\u548cDocker\u5bb9\u5668\u5171\u4eab\u5e95\u5c42\u5b58\u50a8\u5c42\u6587\u4ef6\u5939\u3002\n-- `-e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage`:\u901a\u77e5worker\u5e94\u7528 /underStorage\u4e3a\u5e95\u5c42\u6587\u4ef6\u5b58\u50a8\u5c42\u3002\n \n+\u606d\u559c\uff0c\u60a8\u5df2\u7ecf\u90e8\u7f72\u4e86\u4e00\u4e2a\u57fa\u672c\u7684Dockerized\u5bb9\u5668\u5316 Alluxio\u96c6\u7fa4\uff01\u8bf7\u7ee7\u7eed\u9605\u8bfb\u4ee5\u4e86\u89e3\u66f4\u591a\u6709\u5173\u5982\u4f55\u7ba1\u7406\u96c6\u7fa4\u5e76\u4f7f\u4e4b\u6295\u5165\u751f\u4ea7\u7684\u4fe1\u606f\u3002\n \n-## \u8fd0\u884cAlluxio worker\n+## \u64cd\u4f5c\u4ecb\u7ecd\n \n-```console\n-# Launch an Alluxio worker container and save the container ID for later\n-$ ALLUXIO_WORKER_CONTAINER_ID=$(docker run -d --net=host \\\n-             -v /mnt/ramdisk:/opt/ramdisk \\\n-             -v $PWD/underStorage:/underStorage \\\n-             -e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP} \\\n-             -e ALLUXIO_RAM_FOLDER=/opt/ramdisk \\\n-             -e ALLUXIO_WORKER_MEMORY_SIZE=1GB \\\n-             -e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage \\\n-             alluxio worker)\n-```\n-Details:\n-- `-v /mnt/ramdisk:/opt/ramdisk`: \u548cDocker\u5bb9\u5668\u5171\u4eab\u4e3b\u673a\u7684ramdisk\u3002\n-- `-v $PWD/underStorage:/underStorage`: \u548cDocker\u5bb9\u5668\u5171\u4eab\u5e95\u5c42\u6587\u4ef6\u7cfb\u7edf\u7684\u6587\u4ef6\u5939\u3002\n-- `-e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP}`: \u901a\u77e5worker\u5982\u4f55\u8fde\u63a5Master\u3002\n-- `-e ALLUXIO_RAM_FOLDER=/opt/ramdisk`: \u901a\u77e5worker\u5982\u4f55\u5b9a\u4f4dramdisk\u3002\n-- `-e ALLUXIO_WORKER_MEMORY_SIZE=1GB`: \u901a\u77e5worker\u8282\u70b9ramdisk\u53ef\u7528\u7a7a\u95f4\u3002\n-- `-e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage`: \u901a\u77e5worker\u5c06/underStorage\u4f5c\u4e3a\u5e95\u5c42\u6587\u4ef6\u7cfb\u7edf\u3002\n-\n-### \u6d4b\u8bd5\u96c6\u7fa4\n-\n-\u8981\u6d4b\u8bd5\u8be5\u96c6\u7fa4\u662f\u5426\u5b89\u88c5\u6210\u529f\uff0c\u9996\u5148\u8fdb\u5165worker Docker\u5bb9\u5668\u3002\n+### \u670d\u52a1\u5668\u914d\u7f6e\n \n-```console\n-$ docker exec -it ${ALLUXIO_WORKER_CONTAINER_ID} /bin/sh\n-```\n+\u914d\u7f6e\u66f4\u6539\u9700\u8981\u505c\u6b62Alluxio Docker\u955c\u50cf\uff0c\u7136\u540e\u4f7f\u7528\u65b0\u914d\u7f6e\u91cd\u65b0\u542f\u52a8\u5b83\u4eec\u3002\n \n-\u63a5\u7740\u8fd0\u884cAlluxio\u6d4b\u8bd5\n+\u8981\u6b63\u786e\u8bbe\u7f6eAlluxio\u914d\u7f6e\u5c5e\u6027\uff0c\u8bf7\u5c06\u5176\u6dfb\u52a0\u5230Alluxio java\u9009\u9879\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\n \n-```console\n-$ cd opt/alluxio\n-$ ./bin/alluxio runTests\n ```\n-# \u901a\u8fc7\u5177\u4f53\u7684Alluxio\u5206\u5e03\u5f0f\u73af\u5883\u642d\u5efaDocker\u955c\u50cf\n+-e ALLUXIO_JAVA_OPTS=\"-Dalluxio.property.name=value\"\n+```\n \n-\u901a\u8fc7 `--build-arg`\uff0c\u5c06\u672c\u5730\u6216\u8fdc\u7a0b\u7684Alluxio\u538b\u7f29\u5305\u642d\u5efaAlluxio Docker\u955c\u50cf\n+\u591a\u4e2a\u5c5e\u6027\u5e94\u4ee5\u7a7a\u683c\u5206\u9694\u3002\n \n-\u672c\u5730\u538b\u7f29\u5305:\n-```console\n-$ docker build -t alluxio --build-arg ALLUXIO_TARBALL=alluxio-snapshot.tar.gz .\n+\u5982\u679c\u5c5e\u6027\u503c\u5305\u542b\u7a7a\u683c\uff0c\u5219\u5fc5\u987b\u4f7f\u7528\u5355\u5f15\u53f7\u5c06\u5176\u8f6c\u4e49\u3002\n+\n+```\n+-e ALLUXIO_JAVA_OPTS=\"-Dalluxio.property1=value1 -Dalluxio.property2=`value2 with spaces`\"\n ```\n \n-\u8fdc\u7a0b\u538b\u7f29\u5305:\n+\u955c\u50cf\u542f\u52a8\u65f6Alluxio\u73af\u5883\u53d8\u91cf\u5c06\u88ab\u590d\u5236\u5230`conf/alluxio-env.sh`\u3002\u5982\u679c\u4f60\u6ca1\u6709\u770b\u5230\u67d0\u4e2a\u5c5e\u6027\u751f\u6548\uff0c\u8bf7\u786e\u4fdd\u5bb9\u5668`conf/alluxio-env.sh`\u6587\u4ef6\u4e2d\u6b64\u7279\u6027\u62fc\u5199\u6b63\u786e\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u68c0\u67e5\u6b64\u6587\u4ef6\u5185\u5bb9\u3002\n+\n ```console\n-$ docker build -t alluxio --build-arg ALLUXIO_TARBALL=http://downloads.alluxio.io/downloads/files/{{site.ALLUXIO_VERSION_STRING}}/alluxio-{{site.ALLUXIO_VERSION_STRING}}-bin.tar.gz .\n+$ docker exec ${container_id} cat /opt/alluxio/conf/alluxio-env.sh\n ```\n \n-# Alluxio\u914d\u7f6e\u5c5e\u6027\n+### \u5728\u9ad8\u53ef\u7528\u6027\u6a21\u5f0f\u4e0b\u8fd0\u884c\n \n-\u8981\u914d\u7f6e\u4e00\u4e2aAlluxio\u914d\u7f6e\u9879\uff0c\u5c06\u6240\u6709\u5b57\u6bcd\u53d8\u6210\u5927\u5199\uff0c\u5e76\u5c06\u53e5\u70b9\u66ff\u6362\u4e3a\u4e0b\u5212\u7ebf\u4ece\u800c\u5c06\u5b83\u8f6c\u6362\u4e3a\u73af\u5883\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u5c06`alluxio.master.hostname`\u8f6c\u6362\u4e3a`ALLUXIO_MASTER_HOSTNAME`\u3002\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528`-e PROPERTY=value`\u5728\u955c\u50cf\u4e0a\u8bbe\u7f6e\u8be5\u73af\u5883\u53d8\u91cf\u3002\u5f53\u8be5\u955c\u50cf\u542f\u52a8\u65f6\uff0c\u76f8\u5e94\u7684Alluxio\u914d\u7f6e\u9879\u4f1a\u88ab\u62f7\u8d1d\u5230`conf/alluxio-site.properties`\u3002\n+\u5355\u4e2aAlluxio master\u4f1a\u5bfc\u81f4\u5355\u70b9\u6545\u969c\u3002\u4e3a\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\uff0c\u751f\u4ea7\u96c6\u7fa4\u5e94\u5728[\u9ad8\u53ef\u7528\u6027\u6a21\u5f0f]({{ '/en/deploy/Running-Alluxio-On-a-HA-Cluster.html' | relativize_url}})\u4e0b\u8fd0\u884c\u591a\u4e2aAlluxio master\u3002\n \n-\u672c\u6559\u7a0b\u4f7f\u7528ramdisk \u4ee5\u5141\u8bb8\u5feb\u901f\u77ed\u8def\u8bfb\u53d6\u3002\u53e6\u4e00\u4e2a\u9009\u62e9\u662f\u4f7f\u7528Docker\u5bb9\u5668\u9644\u5e26\u7684tmpfs\u3002 \u540e\u8005\u66f4\u6613\u4e8e\u8bbe\u7f6e\uff0c\u540c\u65f6\u63d0\u9ad8\u9694\u79bb\u6027\uff0c\u4f46\u4ee3\u4ef7\u662f\u65e0\u6cd5\u4ece\u672c\u5730\u5ba2\u6237\u7aef\u83b7\u5f97\u5185\u5b58\u7ea7\u522b\u7684\u5feb\u901f\u77ed\u8def\u8bfb\u53d6\u3002 \u672c\u5730\u5ba2\u6237\u7aef\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u4eceAlluxio workers\u83b7\u53d6\u6570\u636e\u3002\n+#### \u9009\u9879A:\u5185\u90e8Leader\u9009\u4e3e\n \n-## \u4f7f\u7528Docker tmpfs\n+Alluxio\u9ed8\u8ba4\u4f7f\u7528\u5185\u90e8Leader\u9009\u4e3e\u3002\n \n-\u5f53\u672a\u6307\u5b9a`ALLUXIO_RAM_FOLDER`\u65f6\uff0cworker Docker\u5bb9\u5668\u4f1a\u4f7f\u7528\u6302\u8f7d\u5728`/dev/shm`\u4e0a\u7684tmpfs\u3002\u82e5\u8981\u914d\u7f6eworker\u7684\u5185\u5b58\u5927\u5c0f\u4e3a`1GB`\uff0c\u53ef\u4ee5\u5728\u542f\u52a8\u65f6\u6307\u5b9a`--shm-size 1G`\uff0c\u5e76\u4e14\u914d\u7f6eAlluxio worker\u5185\u5b58\u5927\u5c0f\u4e3a`1GB`\u3002\n+\u63d0\u4f9bmaster embedded \u65e5\u5fd7\u5730\u5740\u548c\u628ahostname\u8bbe\u7f6e\u4e3a\u5f53\u524dmaster:\n \n ```console\n-$ docker run -d --net=host --shm-size=1G \\\n-           -v $PWD/underStorage:/underStorage \\\n-           -e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP} \\\n-           -e ALLUXIO_WORKER_MEMORY_SIZE=1GB \\\n-           -e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage \\\n-           alluxio worker\n+$ docker run -d \\\n+  ...\n+  -e ALLUXIO_JAVA_OPTS=\"-Dalluxio.master.embedded.journal.addresses=master-hostname-1:19200,master-hostname-2:19200,master-hostname-3:19200 -Dalluxio.master.hostname=master-hostname-1\" \\\n+  alluxio master\n ```\n \n+\u4e3a\u6240\u6709worker\u8bbe\u7f6emaster rpc\u5730\u5740\uff0c\u4ee5\u4fbf\u4ed6\u4eec\u53ef\u4ee5\u67e5\u8be2master\u8282\u70b9\u627e\u5230leader master\u3002\n+\n+```console\n+$ docker run -d \\\n+  ...\n+  -e ALLUXIO_JAVA_OPTS=\"-Dalluxio.master.rpc.addresses=master_hostname_1:19998,master_hostname_2:19998,master_hostname_3:19998\" \\\n+  alluxio worker\n+```\n \n-\u4e3a\u4e86\u9632\u6b62\u5ba2\u6237\u7aef\u5c1d\u8bd5\u77ed\u8def\u8bfb\u53d6\u5931\u8d25\uff0c\u5ba2\u6237\u7aef\u4e3b\u673a\u540d\u5fc5\u987b\u4e0eworker\u4e3b\u673a\u540d\u4e0d\u540c\u3002 \u5728\u5ba2\u6237\u7aef\u4e0a\uff0c\u914d\u7f6e\u201calluxio.user.hostname = dummy\u201d\u3002\n+\u4f60\u53ef\u4ee5\u5728[\u6b64\u5904]({{ '/en/deploy/Running-Alluxio-On-a-HA-Cluster.html#option1-raft-based-embedded-journal' | relativize_url}})\u627e\u5230\u66f4\u591aEmbedded Journal\u914d\u7f6e\u4fe1\u606f\u3002\n \n-# \u5feb\u901f\u77ed\u8def\u64cd\u4f5c\n+#### \u9009\u9879B:Zookeeper\u548c\u5171\u4eab\u65e5\u5fd7\u5b58\u50a8\n \n-\u5728\u8fd9\u7bc7\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5728\u4e3b\u673a\u7cfb\u7edf\u548cworker\u5bb9\u5668\u4e4b\u95f4\u542f\u52a8\u4e86\u4e00\u4e2a\u5171\u4eab\u7684ramdisk\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728ramdisk\u4e0a\u76f4\u63a5\u6267\u884c\u8bfb\u5199\u64cd\u4f5c\uff0c\u4e0d\u7528\u901a\u8fc7worker\u8fdb\u7a0b\u6267\u884c\n-\u6b64\u65b9\u6cd5\u7684\u5c40\u9650\u662f\u96be\u4e8e\u8bbe\u7f6eworker\u5bb9\u5668\u7684\u5185\u5b58\u9650\u989d\uff0c\u5c3d\u7ba1ramdisk\u6302\u8f7d\u5728\u4e3b\u673a\u4e0a\uff0c\u4eceworker\u5bb9\u5668\u5411ramdisk\u5199\u5c06\u4f1a\u8ba1\u5165\u5bb9\u5668\u7684\u5185\u5b58\u9650\u989d\uff0c\u4e3a\u4e86\u907f\u514d\u8fd9\u4e00\u7f3a\u9677\uff0c\n-\u4f60\u53ef\u4ee5\u5171\u4eab\u4e00\u4efd\u57df\u5957\u63a5\u5b57\u6765\u4ee3\u66fframdisk\u672c\u8eab\u3002\u4f7f\u7528\u57df\u5957\u63a5\u5b57\u7684\u7f3a\u9677\u662f\u8ba1\u7b97\u5f00\u9500\u5927\uff0c\u5e76\u53d7\u9650\u4e8e\u66f4\u4f4e\u7684\u5199\u64cd\u4f5c\u541e\u5410\u91cf\u3002\n+\u8981\u5728Zookeeper HA\u6a21\u5f0f\u4e0b\u8fd0\u884c\uff0cAlluxio\u9700\u8981\u4e00\u4e2a\u6240\u6709master\u90fd\u80fd\u8bbf\u95ee\u5171\u4eab\u65e5\u5fd7\u76ee\u5f55\uff0c\u901a\u5e38\u662fNFS\u6216HDFS\u3002\n \n-## \u57df\u5957\u63a5\u5b57\n+\u5c06\u4ed6\u4eec\u6307\u5411\u5171\u4eab\u65e5\u5fd7\u5e76\u8bbe\u7f6e\u5176Zookeeper\u914d\u7f6e\u3002\n \n-\u5728\u4e3b\u673a\u4e0a\u4e3a\u57df\u5957\u63a5\u5b57\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\u3002\n ```console\n-$ mkdir /tmp/domain\n-$ chmod a+w /tmp/domain\n+$ docker run -d \\\n+  ...:\n+  -e ALLUXIO_JAVA_OPTS=\"-Dalluxio.master.journal.type=UFS -Dalluxio.master.journal.folder=hdfs://[namenodeserver]:[namenodeport]/alluxio_journal -Dalluxio.zookeeper.enabled=true -Dalluxio.zookeeper.address=zkhost1:2181,zkhost2:2181,zkhost3:2181\" \\\n+  alluxio master\n ```\n \n-\u5f53\u901a\u8fc7worker\u548c\u5ba2\u6237\u7aef\u7684docker\u5bb9\u5668\u542f\u52a8\u5b83\u4eec\u65f6\uff0c\u901a\u8fc7`-v /tmp/domain:/opt/domain`\u5171\u4eab\u57df\u5957\u63a5\u5b57\u6587\u4ef6\u5939\u3002\u540c\u65f6\u5728\u542f\u52a8\u5bb9\u5668\u65f6\uff0c\u901a\u8fc7\u6dfb\u52a0`-e ALLUXIO_WORKER_DATA_SERVER_DOMAIN_SOCKET_ADDRESS=/opt/domain/d`\n-\u5728worker\u8bbe\u7f6e\u5c5e\u6027\u503c`alluxio.worker.data.server.domain.socket.address`\u3002\n+\u4e3aworkers\u8bbe\u7f6e\u76f8\u540c\u7684Zookeeper\u914d\u7f6e\uff0c\u4ee5\u4fbf\u4ed6\u4eec\u53ef\u4ee5\u67e5\u8be2Zookeeper\u53d1\u73b0\u5f53\u524dleader\u3002\n \n ```console\n-# This gets the public ip of the current EC2 instance\n-$ export INSTANCE_PUBLIC_IP=$(curl http://169.254.169.254/latest/meta-data/public-ipv4)\n-$ ALLUXIO_WORKER_CONTAINER_ID=$(docker run -d --net=host --shm-size=1G \\\n-             -v /tmp/domain:/opt/domain \\\n-             -v $PWD/underStorage:/underStorage \\\n-             -e ALLUXIO_MASTER_HOSTNAME=${INSTANCE_PUBLIC_IP} \\\n-             -e ALLUXIO_WORKER_MEMORY_SIZE=1GB \\\n-             -e ALLUXIO_WORKER_DATA_SERVER_DOMAIN_SOCKET_ADDRESS=/opt/domain/d \\\n-             -e ALLUXIO_MASTER_MOUNT_TABLE_ROOT_UFS=/underStorage \\\n-             alluxio worker)\n+$ docker run -d \\\n+  ...\n+  -e ALLUXIO_JAVA_OPTS=\"-Dalluxio.zookeeper.enabled=true -Dalluxio.zookeeper.address=zkhost1:2181,zkhost2:2181,zkhost3:2181\" \\\n+  alluxio worker\n ```\n \n-\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679cAlluxio\u5ba2\u6237\u7aef\u548c\u5de5\u4f5c\u8282\u70b9\u7684\u4e3b\u673a\u540d\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u5b83\u4eec\u4e4b\u95f4\u7684\u77ed\u8def\u64cd\u4f5c\u662f\u5141\u8bb8\u7684\u3002\u4f46\u5982\u679c\u5ba2\u6237\u7aef\u4f9d\u9760\u865a\u62df\u7f51\u7edc\u4f5c\u4e3a\u5bb9\u5668\u7684\u4e00\u90e8\u5206\u6765\u8fd0\u884c\u90a3\u5c31\u4e0d\u4e00\u5b9a\u5141\u8bb8\u3002\n-\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53\u4f60\u542f\u52a8\u5de5\u4f5c\u8282\u70b9\u7684\u65f6\u5019\uff0c\u8bbe\u7f6e\u4ee5\u4e0b\u5c5e\u6027\u6765\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6821\u9a8c\uff1a`ALLUXIO_WORKER_DATA_SERVER_DOMAIN_SOCKET_ADDRESS=/opt/domain`\u548c`ALLUXIO_WORKER_DATA_SERVER_DOMAIN_SOCKET_AS_UUID=true`\u3002\n-\u77ed\u8def\u5199\u64cd\u4f5c\u5c31\u542f\u7528\u4e86\uff0c\u53ea\u8981\u5de5\u4f5c\u8282\u70b9\u7684UUID\u4f4d\u4e8e\u5ba2\u6237\u7aef\u6587\u4ef6\u7cfb\u7edf\u4e0a\u3002\n+\u60a8\u53ef\u4ee5\u5728[\u6b64\u5904]({{ '/en/deploy/Running-Alluxio-On-a-HA-Cluster.html#option2-zookeeper-and-shared-journal-storage' | relativize_url}})\u627e\u5230\u66f4\u591a\u5173\u4e8eZooKeeper\u548c\u5171\u4eab\u65e5\u5fd7\u914d\u7f6e\u4fe1\u606f\u3002\n+\n+### \u542f\u7528\u77ed\u8def\u8bfb\u5199\n \n-# FUSE\n-\u4e3a\u4e86\u4f7f\u7528FUSE,\u4f60\u9700\u8981\u5728FUSE\u6fc0\u6d3b\u72b6\u6001\u4e0b\u521b\u5efa\u4e00\u4e2adocker\u955c\u50cf\u3002\n+\u5982\u679c\u4f60\u7684\u8ba1\u7b97\u5e94\u7528\u7a0b\u5e8f\u5c06\u4e0eAlluxio workers\u5728\u540c\u4e00\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u77ed\u8def\u8bfb\u5199\u6765\u63d0\u9ad8\u6027\u80fd\u3002\u8fd9\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0d\u901a\u8fc7loopback\u7f51\u7edc\u7684\u60c5\u51b5\u4e0b\u8bfb\u5199\u5176\u672c\u5730Alluxio worker\u3002\u800c\u662f\u901a\u8fc7[domain sockets](https://en.wikipedia.org/wiki/Unix_domain_socket)\u6765\u8bfb\u5199\u3002 \n+\n+\u5728worker\u4e3b\u673a\u4e0a\uff0c\u4e3a\u5171\u4eabdomain socket\u521b\u5efa\u76ee\u5f55\u3002\n \n ```console\n-$ docker build -f Dockerfile.fuse -t alluxio-fuse .\n+$ mkdir /tmp/domain\n+$ chmod a+w /tmp/domain\n ```\n \n-\u8fd0\u884c\u652f\u6301FUSE\u7684docker\u955c\u50cf\u8fd8\u9700\u8981\u4e00\u5bf9\u989d\u5916\u7684\u53c2\u6570\u3002\n-\u4f8b\u5982\uff1a\n+\u5f53\u542f\u52a8workers\u548c\u5ba2\u6237\u7aef\u65f6\uff0c\u589e\u52a0\u4ee5\u4e0b\u53c2\u6570\u8fd0\u884cdocker\u5bb9\u5668`-v /tmp/domain:/opt/domain`\u4ee5\u5171\u4eabdomain socket\u76ee\u5f55\u3002\u540c\u65f6\u5728\u542f\u52a8worker\u5bb9\u5668\u65f6\u901a\u8fc7\u4f20\u9012\u4ee5\u4e0b\u8bbe\u7f6e\u6765\u914d\u7f6e`domain socket`\u5c5e\u6027 `alluxio.worker.data.server.domain.socket.address=/opt/domain`\u548c`alluxio.worker.data.server.domain.socket.as.uuid=true`\u3002\n \n ```console\n-$ docker run -e ALLUXIO_MASTER_HOSTNAME=alluxio-master --cap-add SYS_ADMIN --device /dev/fuse alluxio-fuse [master|worker|proxy]\n+$ docker run -d \\\n+  ...\n+  -v /tmp/domain:/opt/domain \\\n+  -e ALLUXIO_JAVA_OPTS=\"-Dalluxio.worker.data.server.domain.socket.address=/opt/domain -Dalluxio.worker.data.server.domain.socket.as.uuid=true\" \\\n+  alluxio worker\n ```\n \n-\u6ce8\u610f\uff1a\u5728docker\u4e0a\u8fd0\u884cFUSE\u9700\u8981\u589e\u52a0[SYS_ADMIN capability](http://man7.org/linux/man-pages/man7/capabilities.7.html)\n-\u5230\u5bb9\u5668\u4e2d\u3002\u8fd9\u6d88\u9664\u4e86\u5bb9\u5668\u7684\u72ec\u7acb\u6027\uff0c\u5e94\u8be5\u8c28\u614e\u4f7f\u7528\u3002\n+### \u91cd\u65b0\u542f\u52a8Alluxio\u670d\u52a1\u5668\n \n-\u91cd\u8981\u7684\u662f\uff0c\u4e3a\u4e86\u4f7f\u5e94\u7528\u8bbf\u95ee\u88c5\u6709FUSE\u7684Alluxio\u5b58\u50a8\u6570\u636e\uff0c\u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u5bb9\u5668\u4e2d\u8fd0\u884cAlluxio\u3002\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6269\u5c55docker\u955c\u50cf\u6765\u5305\u542b\u8fd0\u884c\u5728Alluxio\u4e4b\u4e0a\u7684\u5e94\u7528\u3002\u4f8b\u5982\uff0c\u4e3a\u4e86\u5728\u4e00\u4e2adocker\u5bb9\u5668\u4e2d\u7528Alluxio\u8fd0\u884cTensorFlow,\u53ea\u9700\u8981\u4fee\u6539Dockerfile.fuse\u5e76\u4e14\u7528\n+\u91cd\u65b0\u542f\u52a8Alluxio master\u65f6\uff0c\u8bf7\u4f7f\u7528 `--no-format` \u6807\u5fd7\u4ee5\u907f\u514d\u91cd\u65b0\u683c\u5f0f\u5316\u65e5\u5fd7\u3002\u65e5\u5fd7\u4ec5\u5e94\u5728\u7b2c\u4e00\u6b21\u8fd0\u884c\u955c\u50cf\u65f6\u8fdb\u884c\u683c\u5f0f\u5316\u3002\u683c\u5f0f\u5316\u65e5\u5fd7\u4f1a\u5220\u9664\u6240\u6709Alluxio\u5143\u6570\u636e\uff0c\u5e76\u4ee5\u5168\u7a7a\u767d\u72b6\u6001\u542f\u52a8\u96c6\u7fa4\u3002\n \n-```\n-FROM tensorflow/tensorflow:1.3.0\n-```\n+### \u6fc0\u6d3bPOSIX API\u8bbf\u95ee\n \n-\u6765\u4ee3\u66ff\n+\u4f7f\u7528 [alluxio/alluxio-fuse](https://hub.docker.com/r/alluxio/alluxio-fuse/)\uff0c\u60a8\u53ef\u4ee5\u6fc0\u6d3b\u4f7f\u7528POSIX API\u5bf9Alluxio\u7684\u8bbf\u95ee\u3002\n \n+\u542f\u52a8\u5177\u6709[SYS_ADMIN](http://man7.org/linux/man-pages/man7/capabilities.7.html) \u6743\u9650\u529f\u80fd\u7684\u5bb9\u5668\u3002\u4ee5\u4e0b\u547d\u4ee4\u5728\u4e00\u4e2a\u9700\u8981\u901a\u8fc7POSIX API\u8bbf\u95eeAlluxio\u7684\u5ba2\u6237\u7aef\u4e0a\u542f\u52a8FUSE daemon\u7a0b\u5e8f\uff0c \u6302\u8f7d\u8bbf\u95ee\u8def\u5f84\u4e3a`/alluxio-fuse`\u3002\n+\n+```console\n+$ docker run -e \\\n+  ... \\\n+  --cap-add SYS_ADMIN \\\n+  --device /dev/fuse \\\n+  alluxio-fuse fuse \\\n ```\n-FROM ubuntu:16.04\n-```\n \n-\u7136\u540e\u4f60\u53ef\u4ee5\u7528\u548c\u521b\u5efa\u652f\u6301FUSE\u7684\u955c\u50cf\u4e00\u6837\u7684\u547d\u4ee4\u6765\u521b\u5efa\u955c\u50cf\u5e76\u4e14\u8fd0\u884c\u5b83\u3002[\u8fd9\u91cc](https://hub.docker.com/r/alluxio/alluxio-tensorflow/)\u6709\u4e00\u4e2a\u9884\u5148\u521b\u5efa\u597d\u7684\u5e26\u6709TersorFlow\u7684docker\u955c\u50cf\u3002\n+## \u6545\u969c\u6392\u9664\n+\n+\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884cdocker\u8bbf\u95eeAlluxio\u670d\u52a1\u5668\u65e5\u5fd7 logs $ container_id\u3002\u901a\u5e38\uff0c\u65e5\u5fd7\u53ef\u4ee5\u5f88\u597d\u5730\u6307\u51fa\u4ec0\u4e48\u5730\u65b9\u51fa\u4e86\u95ee\u9898\u3002\u5982\u679c\u5b83\u4eec\u4e0d\u8db3\u4ee5\u8bca\u65ad\u60a8\u7684\u95ee\u9898\uff0c\u5219\u53ef\u4ee5\u5728[\u7528\u6237\u90ae\u4ef6\u5217\u8868](https://groups.google.com/forum/#!forum/alluxio-users).\u4e0a\u83b7\u5f97\u5e2e\u52a9 \u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24f086a6e161b014ac37c33d36b48bb464672d42"}, "originalPosition": 454}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "411cefc698b8fd0323a31e9cc95b6cce0e9b74bf", "author": {"user": {"login": "thanosaw", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/411cefc698b8fd0323a31e9cc95b6cce0e9b74bf", "committedDate": "2020-08-03T22:21:47Z", "message": "Update Running-Alluxio-On-Docker.md"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4206, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}