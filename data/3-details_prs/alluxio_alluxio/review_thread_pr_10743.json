{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyNDY0MDk2", "number": 10743, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwODowMjoxNFrODXwmIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwODowMjo0NVrODXwmcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MjQwMDMyOnYy", "diffSide": "RIGHT", "path": "core/client/fs/src/main/java/alluxio/client/file/cache/store/LocalPageStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwODowMjoxNVrOFdOwEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxOToxODowMlrOFdi4YQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE5NDcwNA==", "bodyText": "nit: for src code readability & more explicit error message\nPreconditions.checkNotNull(p.getParent(), \"Path for page %s can not be root\", pageId);\nFiles.createDirectories(p.getParent());", "url": "https://github.com/Alluxio/alluxio/pull/10743#discussion_r366194704", "createdAt": "2020-01-14T08:02:15Z", "author": {"login": "apc999"}, "path": "core/client/fs/src/main/java/alluxio/client/file/cache/store/LocalPageStore.java", "diffHunk": "@@ -55,7 +57,7 @@ public LocalPageStore(LocalPageStoreOptions options) {\n   public void put(PageId pageId, byte[] page) throws IOException {\n     Path p = getFilePath(pageId);\n     if (!Files.exists(p)) {\n-      Files.createDirectories(p.getParent());\n+      Files.createDirectories(Preconditions.checkNotNull(p.getParent(), \"parent\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7182ed9196267ea3d65e7dfa262009d799e3a6d5"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUyNDUxMw==", "bodyText": "Done.", "url": "https://github.com/Alluxio/alluxio/pull/10743#discussion_r366524513", "createdAt": "2020-01-14T19:18:02Z", "author": {"login": "bf8086"}, "path": "core/client/fs/src/main/java/alluxio/client/file/cache/store/LocalPageStore.java", "diffHunk": "@@ -55,7 +57,7 @@ public LocalPageStore(LocalPageStoreOptions options) {\n   public void put(PageId pageId, byte[] page) throws IOException {\n     Path p = getFilePath(pageId);\n     if (!Files.exists(p)) {\n-      Files.createDirectories(p.getParent());\n+      Files.createDirectories(Preconditions.checkNotNull(p.getParent(), \"parent\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE5NDcwNA=="}, "originalCommit": {"oid": "7182ed9196267ea3d65e7dfa262009d799e3a6d5"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MjQwMTEyOnYy", "diffSide": "RIGHT", "path": "core/client/fs/src/main/java/alluxio/client/file/cache/store/LocalPageStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwODowMjo0NVrOFdOwjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxOToxODowN1rOFdi4kA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE5NDgzMA==", "bodyText": "please make the error message more explicit.", "url": "https://github.com/Alluxio/alluxio/pull/10743#discussion_r366194830", "createdAt": "2020-01-14T08:02:45Z", "author": {"login": "apc999"}, "path": "core/client/fs/src/main/java/alluxio/client/file/cache/store/LocalPageStore.java", "diffHunk": "@@ -82,8 +84,11 @@ public void delete(PageId pageId) throws IOException, PageNotFoundException {\n     }\n     Files.delete(p);\n     mSize.decrementAndGet();\n-    if (!Files.newDirectoryStream(p.getParent()).iterator().hasNext()) {\n-      Files.delete(p.getParent());\n+    Path parent = Preconditions.checkNotNull(p.getParent(), \"parent\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7182ed9196267ea3d65e7dfa262009d799e3a6d5"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUyNDU2MA==", "bodyText": "Done.", "url": "https://github.com/Alluxio/alluxio/pull/10743#discussion_r366524560", "createdAt": "2020-01-14T19:18:07Z", "author": {"login": "bf8086"}, "path": "core/client/fs/src/main/java/alluxio/client/file/cache/store/LocalPageStore.java", "diffHunk": "@@ -82,8 +84,11 @@ public void delete(PageId pageId) throws IOException, PageNotFoundException {\n     }\n     Files.delete(p);\n     mSize.decrementAndGet();\n-    if (!Files.newDirectoryStream(p.getParent()).iterator().hasNext()) {\n-      Files.delete(p.getParent());\n+    Path parent = Preconditions.checkNotNull(p.getParent(), \"parent\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE5NDgzMA=="}, "originalCommit": {"oid": "7182ed9196267ea3d65e7dfa262009d799e3a6d5"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2235, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}