{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1OTgwMjEw", "number": 11814, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzozMToyMVrOEVGThA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMDo1ODowN1rOEVKmow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTU4ODUyOnYy", "diffSide": "RIGHT", "path": "core/common/src/main/java/alluxio/util/JvmPauseMonitor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzozMToyMVrOG7qcQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODoyNDo1NVrOG7sSJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIxNDUyOQ==", "bodyText": "Why is this also not final?", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465214529", "createdAt": "2020-08-04T17:31:21Z", "author": {"login": "gpang"}, "path": "core/common/src/main/java/alluxio/util/JvmPauseMonitor.java", "diffHunk": "@@ -48,11 +50,11 @@\n   private final long mInfoThresholdMs;\n \n   /** Times extra sleep time exceed WARN. */\n-  private long mWarnTimeExceeded = 0;\n+  private final AtomicLong mWarnTimeExceeded = new AtomicLong();\n   /** Times extra sleep time exceed INFO. */\n-  private long mInfoTimeExceeded = 0;\n+  private final AtomicLong mInfoTimeExceeded = new AtomicLong();\n   /** Total extra sleep time. */\n-  private long mTotalExtraTimeMs = 0;\n+  private AtomicLong mTotalExtraTimeMs = new AtomicLong();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94b7bfd6e9bb50762de3b241ad9907a413b3c15e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI0NDcwOQ==", "bodyText": "fixed", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465244709", "createdAt": "2020-08-04T18:24:55Z", "author": {"login": "ZacBlanco"}, "path": "core/common/src/main/java/alluxio/util/JvmPauseMonitor.java", "diffHunk": "@@ -48,11 +50,11 @@\n   private final long mInfoThresholdMs;\n \n   /** Times extra sleep time exceed WARN. */\n-  private long mWarnTimeExceeded = 0;\n+  private final AtomicLong mWarnTimeExceeded = new AtomicLong();\n   /** Times extra sleep time exceed INFO. */\n-  private long mInfoTimeExceeded = 0;\n+  private final AtomicLong mInfoTimeExceeded = new AtomicLong();\n   /** Total extra sleep time. */\n-  private long mTotalExtraTimeMs = 0;\n+  private AtomicLong mTotalExtraTimeMs = new AtomicLong();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIxNDUyOQ=="}, "originalCommit": {"oid": "94b7bfd6e9bb50762de3b241ad9907a413b3c15e"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNjI5MjgzOnYy", "diffSide": "RIGHT", "path": "core/server/master/src/test/java/alluxio/master/AlluxioMasterProcessTest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQyMDo1ODowN1rOG7xQ5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMDozNDoyNFrOG72Csg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA==", "bodyText": "what was this change for?", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465326310", "createdAt": "2020-08-04T20:58:07Z", "author": {"login": "gpang"}, "path": "core/server/master/src/test/java/alluxio/master/AlluxioMasterProcessTest.java", "diffHunk": "@@ -156,7 +158,7 @@ private void waitForServing(ServiceType service) throws TimeoutException, Interr\n       } catch (IOException e) {\n         throw new RuntimeException(e);\n       }\n-    });\n+    }, WaitForOptions.defaults().setTimeoutMs(5 * Constants.MINUTE_MS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03d3fcc55eba5ec7ca497b5c4b3000f77931c06d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzODc1Nw==", "bodyText": "Previously, this test would hang for multiple hours if the master/worker failed to come up. Now, it will time out.", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465338757", "createdAt": "2020-08-04T21:24:07Z", "author": {"login": "ZacBlanco"}, "path": "core/server/master/src/test/java/alluxio/master/AlluxioMasterProcessTest.java", "diffHunk": "@@ -156,7 +158,7 @@ private void waitForServing(ServiceType service) throws TimeoutException, Interr\n       } catch (IOException e) {\n         throw new RuntimeException(e);\n       }\n-    });\n+    }, WaitForOptions.defaults().setTimeoutMs(5 * Constants.MINUTE_MS));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA=="}, "originalCommit": {"oid": "03d3fcc55eba5ec7ca497b5c4b3000f77931c06d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM5NDYwOQ==", "bodyText": "But, is this unrelated to jvm pause monitor tests? If so, I think this should be its own PR/commit.", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465394609", "createdAt": "2020-08-04T23:58:26Z", "author": {"login": "gpang"}, "path": "core/server/master/src/test/java/alluxio/master/AlluxioMasterProcessTest.java", "diffHunk": "@@ -156,7 +158,7 @@ private void waitForServing(ServiceType service) throws TimeoutException, Interr\n       } catch (IOException e) {\n         throw new RuntimeException(e);\n       }\n-    });\n+    }, WaitForOptions.defaults().setTimeoutMs(5 * Constants.MINUTE_MS));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA=="}, "originalCommit": {"oid": "03d3fcc55eba5ec7ca497b5c4b3000f77931c06d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQwNDU5NA==", "bodyText": "This was kind-of related. A bug in the monitor usage caused this test to fail (hang) for 2+ hours. It was very hard to track down with jenkins because I couldn't tell which tests are running when jenkins aborts the job. It would have been easier to find had this test contained a timeout.", "url": "https://github.com/Alluxio/alluxio/pull/11814#discussion_r465404594", "createdAt": "2020-08-05T00:34:24Z", "author": {"login": "ZacBlanco"}, "path": "core/server/master/src/test/java/alluxio/master/AlluxioMasterProcessTest.java", "diffHunk": "@@ -156,7 +158,7 @@ private void waitForServing(ServiceType service) throws TimeoutException, Interr\n       } catch (IOException e) {\n         throw new RuntimeException(e);\n       }\n-    });\n+    }, WaitForOptions.defaults().setTimeoutMs(5 * Constants.MINUTE_MS));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyNjMxMA=="}, "originalCommit": {"oid": "03d3fcc55eba5ec7ca497b5c4b3000f77931c06d"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1467, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}