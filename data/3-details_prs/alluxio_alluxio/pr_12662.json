{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyMzM1MDY3", "number": 12662, "title": "Enable remote logging in k8s", "bodyText": "This change enables the Alluxio logserver to run in k8s. Alluxio services like masters and workers on k8s will be able to log to the logserver.", "createdAt": "2020-12-18T07:07:05Z", "url": "https://github.com/Alluxio/alluxio/pull/12662", "merged": true, "mergeCommit": {"oid": "bf06be11b4537c47407c9e4abf42345c82b52161"}, "closed": true, "closedAt": "2021-01-14T02:30:10Z", "author": {"login": "jiacheliu3"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnVTVCAFqTU1NTI5NDc3NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvqqlSAFqTU2Njk1Mzc0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1Mjk0Nzc0", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-555294774", "createdAt": "2020-12-18T08:37:17Z", "commit": {"oid": "eee923d98ca45932f33f34727daafccd7cf73989"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwODozNzoxOFrOIIYP2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwODozNzoxOFrOIIYP2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTY1Njc5NA==", "bodyText": "If this function is not in use anywhere else, then it can be removed and code can be simplified\n        resources:\n{{ toYaml .Values.logserver.resources | indent 10 }}", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r545656794", "createdAt": "2020-12-18T08:37:18Z", "author": {"login": "nirav-chotai"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/logging/deployment.yaml", "diffHunk": "@@ -0,0 +1,101 @@\n+#\n+# The Alluxio Open Foundation licenses this work under the Apache License, version 2.0\n+# (the \"License\"). You may not use this work except in compliance with the License, which is\n+# available at www.apache.org/licenses/LICENSE-2.0\n+#\n+# This software is distributed on an \"AS IS\" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,\n+# either express or implied, as more fully set forth in the License.\n+#\n+# See the NOTICE file distributed with this work for information regarding copyright ownership.\n+#\n+\n+{{ if .Values.logserver.enabled -}}\n+{{- $name := include \"alluxio.name\" . }}\n+{{- $fullName := include \"alluxio.fullname\" . }}\n+{{- $chart := include \"alluxio.chart\" . }}\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: {{ $fullName }}-logserver\n+  labels:\n+    name: {{ $fullName }}-logserver\n+    app: {{ $name }}\n+    chart: {{ $chart }}\n+    release: {{ .Release.Name }}\n+    heritage: {{ .Release.Service }}\n+    role: alluxio-logserver\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: {{ $name }}\n+      role: alluxio-logserver\n+      name: {{ $fullName }}-logserver\n+  template:\n+    metadata:\n+      labels:\n+        name: {{ $fullName }}-logserver\n+        app: {{ $name }}\n+        chart: {{ $chart }}\n+        release: {{ .Release.Name }}\n+        heritage: {{ .Release.Service }}\n+        role: alluxio-logserver\n+    spec:\n+      containers:\n+        - name: alluxio-logserver\n+          image: {{ .Values.image }}:{{ .Values.imageTag }}\n+          imagePullPolicy: {{ .Values.imagePullPolicy }}\n+          securityContext:\n+            runAsUser: {{ .Values.user }}\n+            runAsGroup: {{ .Values.group }}\n+          {{- if .Values.logserver.resources  }}\n+{{ include \"alluxio.logserver.resources\" . | indent 10 }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eee923d98ca45932f33f34727daafccd7cf73989"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MzU4MzI4", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-555358328", "createdAt": "2020-12-18T10:10:38Z", "commit": {"oid": "e1a13e944a47e2c2e491a61e10f0c3e79e87c690"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMDoxMDozOFrOIIcz-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMDoxNDozN1rOIIc8TQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTczMTU3Nw==", "bodyText": "This function is really not needed.", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r545731577", "createdAt": "2020-12-18T10:10:38Z", "author": {"login": "nirav-chotai"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/_helpers.tpl", "diffHunk": "@@ -119,6 +119,28 @@ resources:\n     {{- end }}\n {{- end -}}\n \n+{{- define \"alluxio.logserver.resources\" -}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1a13e944a47e2c2e491a61e10f0c3e79e87c690"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTczMzcwOQ==", "bodyText": "What if I do not want to use any additional volume for logging as my ephermal storage is enough for my requirement, then I do not see any option here. I just want to run a remote logging server without any additional volume.", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r545733709", "createdAt": "2020-12-18T10:14:37Z", "author": {"login": "nirav-chotai"}, "path": "integration/kubernetes/helm-chart/alluxio/values.yaml", "diffHunk": "@@ -310,3 +310,47 @@ fuse:\n #     alluxio-hdfs-config: hdfsConfig\n #   worker: # Shared by worker and jobWorker containers\n #     alluxio-hdfs-config: hdfsConfig\n+\n+# Remote logging server\n+logserver:\n+  enabled: true\n+  replicas: 1\n+  env:\n+  # Extra environment variables for the logserver pod\n+  # Example:\n+  # JAVA_HOME: /opt/java\n+  args: # Arguments to Docker entrypoint\n+    - logserver\n+  # Properties for the logserver component\n+  properties:\n+  resources:\n+    # The default xmx is 8G\n+    limits:\n+      cpu: \"4\"\n+      memory: \"8G\"\n+    requests:\n+      cpu: \"1\"\n+      memory: \"1G\"\n+  ports:\n+    logging: 45600\n+  hostPID: false\n+  hostNetwork: false\n+  # dnsPolicy will be ClusterFirstWithHostNet if hostNetwork: true\n+  # and ClusterFirst if hostNetwork: false\n+  # You can specify dnsPolicy here to override this inference\n+  # dnsPolicy: ClusterFirst\n+  # JVM options specific to the logserver container\n+  jvmOptions:\n+  nodeSelector: {}\n+  # volumeType controls the type of log volume.\n+  # It can be \"persistentVolumeClaim\" or \"hostPath\"\n+  volumeType: persistentVolumeClaim\n+  size: 4Gi\n+  # Attributes to use if the log volume is PVC\n+  pvcName: alluxio-logserver-logs\n+  accessModes:\n+    - ReadWriteOnce\n+  storageClass: standard\n+  # Attributes to use if the log volume is hostPath\n+  hostPath: \"/tmp/alluxio-logs\" # The hostPath directory to use", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1a13e944a47e2c2e491a61e10f0c3e79e87c690"}, "originalPosition": 46}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9357a26405829a703e3bb9090efb739ff8fa0d5f", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/9357a26405829a703e3bb9090efb739ff8fa0d5f", "committedDate": "2020-12-18T10:19:18Z", "message": "format license"}, "afterCommit": {"oid": "6b953a6f40576b3205607547df89c8f3cc0ec284", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/6b953a6f40576b3205607547df89c8f3cc0ec284", "committedDate": "2020-12-31T12:27:05Z", "message": "format license"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjIxNjg2", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-560621686", "createdAt": "2021-01-02T05:30:12Z", "commit": {"oid": "272b55423681ed11bd64ed3ecd3991c9f00b333e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwNTozMDoxMlrOINU-Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwNTozMDoxMlrOINU-Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDg0NTk2Mw==", "bodyText": "Comment is stale. And why are there 2 logserver commands?", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r550845963", "createdAt": "2021-01-02T05:30:12Z", "author": {"login": "madanadit"}, "path": "integration/docker/entrypoint.sh", "diffHunk": "@@ -51,6 +51,7 @@ function printUsage {\n   echo -e \" proxy                        \\t Start Alluxio proxy\"\n   echo -e \" fuse [--fuse-opts=opt1,...]  \\t Start Alluxio FUSE file system, option --fuse-opts expects a list of fuse options separated by comma\"\n   echo -e \" logserver                    \\t Start Alluxio log server\"\n+  echo -e \" logserver [--fuse-opts=opt1,...]  \\t Start Alluxio FUSE file system, option --fuse-opts expects a list of fuse options separated by comma\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "272b55423681ed11bd64ed3ecd3991c9f00b333e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyNDg2Mzk0", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-562486394", "createdAt": "2021-01-06T09:56:09Z", "commit": {"oid": "0bda83eface068b4f3fc6225d0f5b03a48afa5da"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwOTo1NjowOVrOIO4hYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwOTo1NjowOVrOIO4hYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQ3NzAyNw==", "bodyText": "Where this is going to be used in the worker daemonset?", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r552477027", "createdAt": "2021-01-06T09:56:09Z", "author": {"login": "nirav-chotai"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/worker/daemonset.yaml", "diffHunk": "@@ -14,7 +14,7 @@\n {{- $hostNetwork := .Values.worker.hostNetwork }}\n {{- $hostPID := .Values.worker.hostPID }}\n {{- $fullName := include \"alluxio.fullname\" . }}\n-\n+{{- $logServerEnabled := .Values.logserver.enabled }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0bda83eface068b4f3fc6225d0f5b03a48afa5da"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyNDk0NzAx", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-562494701", "createdAt": "2021-01-06T10:01:56Z", "commit": {"oid": "0bda83eface068b4f3fc6225d0f5b03a48afa5da"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxMDowMTo1NlrOIO4sYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxMDowMTo1NlrOIO4sYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQ3OTg0Mg==", "bodyText": "How this will work in the case of dynamic provisioning of distributed storage?\nWith Ceph, I do not provision PV as it will automatically be created. And if that automatically created PV does not have these labels, then it will not be bound to the PVC, right?", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r552479842", "createdAt": "2021-01-06T10:01:56Z", "author": {"login": "nirav-chotai"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/logserver/log-pvc.yaml", "diffHunk": "@@ -0,0 +1,39 @@\n+#\n+# The Alluxio Open Foundation licenses this work under the Apache License, version 2.0\n+# (the \"License\"). You may not use this work except in compliance with the License, which is\n+# available at www.apache.org/licenses/LICENSE-2.0\n+#\n+# This software is distributed on an \"AS IS\" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,\n+# either express or implied, as more fully set forth in the License.\n+#\n+# See the NOTICE file distributed with this work for information regarding copyright ownership.\n+#\n+\n+{{ $enabled := .Values.logserver.enabled -}}\n+{{ $needPVC := eq .Values.logserver.volumeType \"persistentVolumeClaim\" -}}\n+{{ if and .Values.logserver.enabled $needPVC -}}\n+apiVersion: v1\n+kind: PersistentVolumeClaim\n+metadata:\n+  name: {{ .Values.logserver.pvcName }}\n+  labels:\n+    app: {{ template \"alluxio.name\" . }}\n+    chart: {{ template \"alluxio.chart\" . }}\n+    release: {{ .Release.Name }}\n+    heritage: {{ .Release.Service }}\n+    role: alluxio-logserver\n+spec:\n+  volumeMode: Filesystem\n+  resources:\n+    requests:\n+      storage: {{ .Values.logserver.size }}\n+  storageClassName: {{ .Values.logserver.storageClass }}\n+  accessModes:\n+  {{ toYaml .Values.logserver.accessModes | trim | indent 4 }}\n+selector:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0bda83eface068b4f3fc6225d0f5b03a48afa5da"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "242821e0d428dfc2fff0d35ed2fd1ecd2476bdc0", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/242821e0d428dfc2fff0d35ed2fd1ecd2476bdc0", "committedDate": "2021-01-12T03:24:43Z", "message": "enabled logserver in k8s"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9af3d5d6849b1e55080326d6d94a7bbebf53165f", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/9af3d5d6849b1e55080326d6d94a7bbebf53165f", "committedDate": "2021-01-12T03:24:44Z", "message": "add volume for logserver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e99ff6b196a5d67e64517e18304caf15784123f", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/0e99ff6b196a5d67e64517e18304caf15784123f", "committedDate": "2021-01-12T03:24:44Z", "message": "missed pvc template"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cb4b947a6fe288b447d02bb30e7bab55ac64b63", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/0cb4b947a6fe288b447d02bb30e7bab55ac64b63", "committedDate": "2021-01-12T03:24:44Z", "message": "format license"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bc52878496081f2e1853ba26f8036f95e12e723", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/8bc52878496081f2e1853ba26f8036f95e12e723", "committedDate": "2021-01-12T03:24:44Z", "message": "enabled not using volume"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3a4ae20147a3962d892b17f0734d0829038448d", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/d3a4ae20147a3962d892b17f0734d0829038448d", "committedDate": "2021-01-12T03:24:44Z", "message": "add emptyDir option"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9590a0e666045d456d71bc657a9eb93a0190a39f", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/9590a0e666045d456d71bc657a9eb93a0190a39f", "committedDate": "2021-01-12T03:25:56Z", "message": "bump up version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfab304e9fcfbdb5e6de203b58f6d492dd849485", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/cfab304e9fcfbdb5e6de203b58f6d492dd849485", "committedDate": "2021-01-12T03:25:56Z", "message": "small changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d61a8997656325d3cfc56c63dcd1c3c1e7f3792", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/8d61a8997656325d3cfc56c63dcd1c3c1e7f3792", "committedDate": "2021-01-12T03:25:56Z", "message": "resolved some comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "262fc8587a91864677e4301ca02e8707b2618b69", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/262fc8587a91864677e4301ca02e8707b2618b69", "committedDate": "2021-01-12T03:26:33Z", "message": "enable more flexible labeling on the PVC"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec", "committedDate": "2021-01-12T03:26:33Z", "message": "add env vars in the confimap"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7500314c99bfc3e5347cae0f2f2418f12230a594", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/7500314c99bfc3e5347cae0f2f2418f12230a594", "committedDate": "2021-01-12T02:26:48Z", "message": "add env vars in the confimap"}, "afterCommit": {"oid": "abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec", "committedDate": "2021-01-12T03:26:33Z", "message": "add env vars in the confimap"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1OTQ4MzM4", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-565948338", "createdAt": "2021-01-12T05:27:56Z", "commit": {"oid": "abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQwNToyNzo1NlrOIRyYHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQwNToyNzo1NlrOIRyYHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTUyMjA3OQ==", "bodyText": "why does the logserver need master secrets?", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r555522079", "createdAt": "2021-01-12T05:27:56Z", "author": {"login": "madanadit"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/logserver/deployment.yaml", "diffHunk": "@@ -0,0 +1,106 @@\n+#\n+# The Alluxio Open Foundation licenses this work under the Apache License, version 2.0\n+# (the \"License\"). You may not use this work except in compliance with the License, which is\n+# available at www.apache.org/licenses/LICENSE-2.0\n+#\n+# This software is distributed on an \"AS IS\" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,\n+# either express or implied, as more fully set forth in the License.\n+#\n+# See the NOTICE file distributed with this work for information regarding copyright ownership.\n+#\n+\n+{{ if .Values.logserver.enabled -}}\n+{{- $name := include \"alluxio.name\" . }}\n+{{- $fullName := include \"alluxio.fullname\" . }}\n+{{- $chart := include \"alluxio.chart\" . }}\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: {{ $fullName }}-logserver\n+  labels:\n+    name: {{ $fullName }}-logserver\n+    app: {{ $name }}\n+    chart: {{ $chart }}\n+    release: {{ .Release.Name }}\n+    heritage: {{ .Release.Service }}\n+    role: alluxio-logserver\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: {{ $name }}\n+      role: alluxio-logserver\n+      name: {{ $fullName }}-logserver\n+  template:\n+    metadata:\n+      labels:\n+        name: {{ $fullName }}-logserver\n+        app: {{ $name }}\n+        chart: {{ $chart }}\n+        release: {{ .Release.Name }}\n+        heritage: {{ .Release.Service }}\n+        role: alluxio-logserver\n+    spec:\n+      containers:\n+        - name: alluxio-logserver\n+          image: {{ .Values.image }}:{{ .Values.imageTag }}\n+          imagePullPolicy: {{ .Values.imagePullPolicy }}\n+          securityContext:\n+            runAsUser: {{ .Values.user }}\n+            runAsGroup: {{ .Values.group }}\n+          {{- if .Values.logserver.resources  }}\n+{{ include \"alluxio.logserver.resources\" . | indent 10 }}\n+          {{- end }}\n+          command: [\"tini\", \"--\", \"/entrypoint.sh\"]\n+            {{- if .Values.logserver.args }}\n+          args:\n+{{ toYaml .Values.logserver.args | trim | indent 12 }}\n+            {{- end }}\n+          env:\n+            {{- range $key, $value := .Values.logserver.env }}\n+          - name: \"{{ $key }}\"\n+            value: \"{{ $value }}\"\n+            {{- end }}\n+          envFrom:\n+          - configMapRef:\n+              name: {{ $fullName }}-config\n+          ports:\n+          - containerPort: {{ .Values.logserver.ports.logging }}\n+            name: logging\n+          volumeMounts:\n+            {{- if not (eq .Values.logserver.volumeType \"none\") }}\n+          - name: alluxio-logs\n+            mountPath: /opt/alluxio/logs\n+            {{- end }}\n+            {{- if .Values.secrets }}\n+              {{- if .Values.secrets.logserver }}\n+            {{- include \"alluxio.master.secretVolumeMounts\" . }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1OTg1NzU1", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-565985755", "createdAt": "2021-01-12T07:06:16Z", "commit": {"oid": "abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQwNzowNjoxNlrOIR0QzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQwNzowNjoxNlrOIR0QzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU1Mjk3Mw==", "bodyText": "Where this is being used?", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r555552973", "createdAt": "2021-01-12T07:06:16Z", "author": {"login": "nirav-chotai"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/_helpers.tpl", "diffHunk": "@@ -333,3 +355,34 @@ livenessProbe:\n   timeoutSeconds: 5\n   failureThreshold: 2\n {{- end -}}\n+\n+{{- define \"alluxio.logserver.log.volume\" -}}\n+{{- if eq .Values.logserver.volumeType \"hostPath\" }}\n+- name: alluxio-logs\n+  hostPath:\n+    path: {{ .Values.logserver.hostPath }}\n+    type: DirectoryOrCreate\n+{{- else if eq .Values.logserver.volumeType \"emptyDir\" }}\n+- name: alluxio-logs\n+  emptyDir:\n+    medium: {{ .Values.logserver.medium }}\n+    sizeLimit: {{ .Values.logserver.size | quote }}\n+{{- else }}\n+- name: alluxio-logs\n+  persistentVolumeClaim:\n+    claimName: \"{{ .Values.logserver.pvcName }}\"\n+{{- end }}\n+{{- end -}}\n+\n+{{- define \"alluxio.logserver.pvc.selector\" -}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abbf34c62ba2cd25d8f8b40e9501ef6f2d3f36ec"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8560855f710c05074ad0e31a723135e75bc4be1b", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/8560855f710c05074ad0e31a723135e75bc4be1b", "committedDate": "2021-01-13T01:44:08Z", "message": "resolve comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd0092105fb59c77d6e2b4c62258d68e08d0a46d", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/cd0092105fb59c77d6e2b4c62258d68e08d0a46d", "committedDate": "2021-01-13T01:45:57Z", "message": "better comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9662051cc8f8675b92e1af5c32424de756d5deff", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/9662051cc8f8675b92e1af5c32424de756d5deff", "committedDate": "2021-01-13T03:23:01Z", "message": "update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b4c6dd0731ac972257c1b2c2029f56e432347b6", "author": {"user": {"login": "jiacheliu3", "name": "Jiacheng Liu"}}, "url": "https://github.com/Alluxio/alluxio/commit/7b4c6dd0731ac972257c1b2c2029f56e432347b6", "committedDate": "2021-01-13T03:25:36Z", "message": "add the directory to path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2ODY4MjIx", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-566868221", "createdAt": "2021-01-13T03:26:57Z", "commit": {"oid": "9662051cc8f8675b92e1af5c32424de756d5deff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QwMzoyNjo1N1rOISeLlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QwMzoyNjo1N1rOISeLlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjIzOTc2NQ==", "bodyText": "Not sure if there's a better example", "url": "https://github.com/Alluxio/alluxio/pull/12662#discussion_r556239765", "createdAt": "2021-01-13T03:26:57Z", "author": {"login": "jiacheliu3"}, "path": "integration/kubernetes/helm-chart/alluxio/values.yaml", "diffHunk": "@@ -313,6 +313,8 @@ fuse:\n #     alluxio-hdfs-config: hdfsConfig\n #   worker: # Shared by worker and jobWorker containers\n #     alluxio-hdfs-config: hdfsConfig\n+#   logserver: # Used by the logserver container\n+#     alluxio-hdfs-config: hdfsConfig", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9662051cc8f8675b92e1af5c32424de756d5deff"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2OTUzNzQ1", "url": "https://github.com/Alluxio/alluxio/pull/12662#pullrequestreview-566953745", "createdAt": "2021-01-13T07:34:12Z", "commit": {"oid": "7b4c6dd0731ac972257c1b2c2029f56e432347b6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3370, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}