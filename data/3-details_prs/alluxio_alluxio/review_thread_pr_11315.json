{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1NDgxMTI1", "number": 11315, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjowMTozNVrODz8UhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjowMjo0MVrODz8VqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NzkyMjYxOnYy", "diffSide": "RIGHT", "path": "integration/kubernetes/helm-chart/alluxio/templates/config/alluxio-conf.yaml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjowMTozNVrOGIpgKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMzowNDozOFrOGKoO0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcyMTc3MA==", "bodyText": "this seems like a redundant pattern, can we have a builder for java opts?", "url": "https://github.com/Alluxio/alluxio/pull/11315#discussion_r411721770", "createdAt": "2020-04-20T22:01:35Z", "author": {"login": "madanadit"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/config/alluxio-conf.yaml", "diffHunk": "@@ -32,15 +32,141 @@ metadata:\n     heritage: {{ .Release.Service }}\n data:\n   ALLUXIO_JAVA_OPTS: |-\n-    {{if $isSingleMaster}}-Dalluxio.master.hostname={{ $fullName }}-{{ $defaultMasterName }}{{end}} -Dalluxio.master.journal.type={{ .Values.journal.type }} -Dalluxio.master.journal.folder={{ .Values.journal.folder }} {{if $isHaEmbedded}}-Dalluxio.master.embedded.journal.addresses={{range $i := until $masterCount}}{{ $fullName }}-master-{{$i}}:19200,{{end}}{{end}} {{ .Values.jvmOptions }} {{- range $key, $val := .Values.properties }} -D{{ $key }}={{ $val }} {{ end }}\n+    {{- $alluxioJavaOpts := list }}\n+\n+    {{- /* Specify master hostname if single master */}}\n+    {{- if $isSingleMaster }}\n+      {{- $alluxioJavaOpts = printf \"-Dalluxio.master.hostname=%v-%v\" $fullName $defaultMasterName | append $alluxioJavaOpts }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "832c4d5f0e8fa5b56de4313ce83a6e2555a05241"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc5ODA5Nw==", "bodyText": "Sadly Helm doesn't have good support of customized functions other than what's provided in http://masterminds.github.io/sprig/.\nThis can't be easily done :(", "url": "https://github.com/Alluxio/alluxio/pull/11315#discussion_r413798097", "createdAt": "2020-04-23T13:04:38Z", "author": {"login": "jiacheliu3"}, "path": "integration/kubernetes/helm-chart/alluxio/templates/config/alluxio-conf.yaml", "diffHunk": "@@ -32,15 +32,141 @@ metadata:\n     heritage: {{ .Release.Service }}\n data:\n   ALLUXIO_JAVA_OPTS: |-\n-    {{if $isSingleMaster}}-Dalluxio.master.hostname={{ $fullName }}-{{ $defaultMasterName }}{{end}} -Dalluxio.master.journal.type={{ .Values.journal.type }} -Dalluxio.master.journal.folder={{ .Values.journal.folder }} {{if $isHaEmbedded}}-Dalluxio.master.embedded.journal.addresses={{range $i := until $masterCount}}{{ $fullName }}-master-{{$i}}:19200,{{end}}{{end}} {{ .Values.jvmOptions }} {{- range $key, $val := .Values.properties }} -D{{ $key }}={{ $val }} {{ end }}\n+    {{- $alluxioJavaOpts := list }}\n+\n+    {{- /* Specify master hostname if single master */}}\n+    {{- if $isSingleMaster }}\n+      {{- $alluxioJavaOpts = printf \"-Dalluxio.master.hostname=%v-%v\" $fullName $defaultMasterName | append $alluxioJavaOpts }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcyMTc3MA=="}, "originalCommit": {"oid": "832c4d5f0e8fa5b56de4313ce83a6e2555a05241"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NzkyNTUzOnYy", "diffSide": "LEFT", "path": "integration/kubernetes/multiMaster-embeddedJournal/alluxio-configmap.yaml.template", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjowMjo0MVrOGIph8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNDowOTowOFrOGKqAtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcyMjIyNw==", "bodyText": "we might still need the leading / trailing space, until we fix the issue with appending common java opts in libexec. alternatively, you could fix that issue", "url": "https://github.com/Alluxio/alluxio/pull/11315#discussion_r411722227", "createdAt": "2020-04-20T22:02:41Z", "author": {"login": "madanadit"}, "path": "integration/kubernetes/multiMaster-embeddedJournal/alluxio-configmap.yaml.template", "diffHunk": "@@ -28,16 +28,16 @@ metadata:\n     heritage: Tiller\n data:\n   ALLUXIO_JAVA_OPTS: |-\n-     -Dalluxio.master.journal.type=EMBEDDED -Dalluxio.master.journal.folder=/journal -Dalluxio.master.embedded.journal.addresses=alluxio-master-0:19200,alluxio-master-1:19200,alluxio-master-2:19200,  -Dalluxio.security.stale.channel.purge.interval=365d ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "832c4d5f0e8fa5b56de4313ce83a6e2555a05241"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzgyNzI1Mg==", "bodyText": "There was an extra space and is now removed. The leading/trailing spaces are still aligned. I ran through the tests and they are all good.", "url": "https://github.com/Alluxio/alluxio/pull/11315#discussion_r413827252", "createdAt": "2020-04-23T14:09:08Z", "author": {"login": "jiacheliu3"}, "path": "integration/kubernetes/multiMaster-embeddedJournal/alluxio-configmap.yaml.template", "diffHunk": "@@ -28,16 +28,16 @@ metadata:\n     heritage: Tiller\n data:\n   ALLUXIO_JAVA_OPTS: |-\n-     -Dalluxio.master.journal.type=EMBEDDED -Dalluxio.master.journal.folder=/journal -Dalluxio.master.embedded.journal.addresses=alluxio-master-0:19200,alluxio-master-1:19200,alluxio-master-2:19200,  -Dalluxio.security.stale.channel.purge.interval=365d ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcyMjIyNw=="}, "originalCommit": {"oid": "832c4d5f0e8fa5b56de4313ce83a6e2555a05241"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1862, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}