{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2MTA3Njgx", "number": 12574, "title": "Get a chunk of PartitionColumnStatistics at a time from Hive", "bodyText": "This submits requests for the partition statistics in batches of partitions, to avoid overflowing the HMS when requesting for tables with a large number of partitions.", "createdAt": "2020-11-24T01:20:21Z", "url": "https://github.com/Alluxio/alluxio/pull/12574", "merged": true, "mergeCommit": {"oid": "5dfa1c3fc7a4f66067a23c0d0fad4a7a85b7a874"}, "closed": true, "closedAt": "2020-11-25T19:58:24Z", "author": {"login": "bradyoo"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfuWhLgFqTUzNzgwOTQ2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgD8DJgFqTUzODgxMDAzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3ODA5NDYw", "url": "https://github.com/Alluxio/alluxio/pull/12574#pullrequestreview-537809460", "createdAt": "2020-11-24T18:48:57Z", "commit": {"oid": "deb4aaf16997702ee31c3c78f67d21742529ddfb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODo0ODo1OFrOH5Qmxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODo0ODo1OFrOH5Qmxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTgwMjk1MA==", "bodyText": "HiveDatabase.java:231: error: Line is longer than 100 characters (found 103).", "url": "https://github.com/Alluxio/alluxio/pull/12574#discussion_r529802950", "createdAt": "2020-11-24T18:48:58Z", "author": {"login": "gpang"}, "path": "table/server/underdb/hive/src/main/java/alluxio/table/under/hive/HiveDatabase.java", "diffHunk": "@@ -220,11 +224,15 @@ public UdbTable getTable(String tableName) throws IOException {\n         List<String> partitionNames = partitions.stream()\n             .map(partition -> FileUtils.makePartName(partitionColumns, partition.getValues()))\n             .collect(Collectors.toList());\n-        statsMap = client.get()\n-            .getPartitionColumnStatistics(mHiveDbName, tableName, partitionNames, dataColumns)\n-            .entrySet().stream().collect(Collectors.toMap(Map.Entry::getKey,\n-                e -> e.getValue().stream().map(HiveUtils::toProto).collect(Collectors.toList()),\n-                (e1, e2) -> e2));\n+\n+        for (List<String> partialPartitionNames :\n+            Lists.partition(partitionNames, MAX_PARTITION_COLUMN_STATISTICS)) {\n+          statsMap.putAll(client.get()\n+              .getPartitionColumnStatistics(mHiveDbName, tableName, partialPartitionNames, dataColumns)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deb4aaf16997702ee31c3c78f67d21742529ddfb"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bee92808d15790499edfeb80d7c927d3655784e0", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/bee92808d15790499edfeb80d7c927d3655784e0", "committedDate": "2020-11-24T19:24:07Z", "message": "Get only a chunk of PartitionColumnStatistics at a time from HiveMetastore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4979fe563a0234c58e33490b5a4cb866c156da9c", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/4979fe563a0234c58e33490b5a4cb866c156da9c", "committedDate": "2020-11-24T19:24:07Z", "message": "checkstyle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4be4cd0ecf3d5103e606330a88355dc1c4c405e4", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/4be4cd0ecf3d5103e606330a88355dc1c4c405e4", "committedDate": "2020-11-24T19:04:03Z", "message": "checkstyle"}, "afterCommit": {"oid": "4979fe563a0234c58e33490b5a4cb866c156da9c", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/4979fe563a0234c58e33490b5a4cb866c156da9c", "committedDate": "2020-11-24T19:24:07Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1eda4146b26018e61f048cd896fac66bb1821b1", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/a1eda4146b26018e61f048cd896fac66bb1821b1", "committedDate": "2020-11-25T07:47:21Z", "message": "Temporarily reduce a lot for testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc89e089514530d9e1d3a6c01f09e3a6032ff96f", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/fc89e089514530d9e1d3a6c01f09e3a6032ff96f", "committedDate": "2020-11-25T16:02:24Z", "message": "lower even more temporarily"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbaeded655fd5c65a2095786ab9ecdd958a4122a", "author": {"user": {"login": "bradyoo", "name": "Bradley Yoo"}}, "url": "https://github.com/Alluxio/alluxio/commit/dbaeded655fd5c65a2095786ab9ecdd958a4122a", "committedDate": "2020-11-25T17:09:25Z", "message": "go back to larger"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4ODEwMDM2", "url": "https://github.com/Alluxio/alluxio/pull/12574#pullrequestreview-538810036", "createdAt": "2020-11-25T19:58:07Z", "commit": {"oid": "dbaeded655fd5c65a2095786ab9ecdd958a4122a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3313, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}