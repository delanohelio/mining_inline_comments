{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4Njc5OTQ0", "number": 12482, "title": "Simplify journal writer response", "bodyText": "Ratis by default echo the journal message back after it is applied. This wastes a lot of memory and CPU time. This change makes the state machine explicitly return empty message since the journal write doesn't really care about the response content.", "createdAt": "2020-11-10T18:24:52Z", "url": "https://github.com/Alluxio/alluxio/pull/12482", "merged": true, "mergeCommit": {"oid": "bbac411c029a51c97e4a643bf63cc3ab6274e2ca"}, "closed": true, "closedAt": "2020-11-12T01:21:43Z", "author": {"login": "bf8086"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABda-tsAgH2gAyNTE4Njc5OTQ0OjI5ZmE1MmZmNzZlM2VkMjk0NGQ4MDYxOWJjNWMwMjRjMzExNmMyNDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdblNR7gFqTUyODU2MjgxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "29fa52ff76e3ed2944d80619bc5c024c3116c249", "author": {"user": {"login": "bf8086", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/29fa52ff76e3ed2944d80619bc5c024c3116c249", "committedDate": "2020-11-10T01:03:17Z", "message": "Explicitly respond empty message to journal writer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NTEyMzg4", "url": "https://github.com/Alluxio/alluxio/pull/12482#pullrequestreview-527512388", "createdAt": "2020-11-10T18:53:27Z", "commit": {"oid": "29fa52ff76e3ed2944d80619bc5c024c3116c249"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODo1MzoyN1rOHwq54g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODo1MzoyN1rOHwq54g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc5NjY0Mg==", "bodyText": "Can you add more context/details to this comment?\nAlso, is there a way to add a simple unit test for this behavior?", "url": "https://github.com/Alluxio/alluxio/pull/12482#discussion_r520796642", "createdAt": "2020-11-10T18:53:27Z", "author": {"login": "gpang"}, "path": "core/server/common/src/main/java/alluxio/master/journal/raft/JournalStateMachine.java", "diffHunk": "@@ -242,7 +246,10 @@ public void close() {\n   public CompletableFuture<Message> applyTransaction(TransactionContext trx) {\n     try {\n       applyJournalEntryCommand(trx);\n-      return super.applyTransaction(trx);\n+      RaftProtos.LogEntryProto entry = Objects.requireNonNull(trx.getLogEntry());\n+      updateLastAppliedTermIndex(entry.getTerm(), entry.getIndex());\n+      // no response message is expected", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29fa52ff76e3ed2944d80619bc5c024c3116c249"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b640491828ef83ff85a5b6bf192cbe4f0970a72d", "author": {"user": {"login": "bf8086", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/b640491828ef83ff85a5b6bf192cbe4f0970a72d", "committedDate": "2020-11-10T22:41:12Z", "message": "Add test and more comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NTYyODEw", "url": "https://github.com/Alluxio/alluxio/pull/12482#pullrequestreview-528562810", "createdAt": "2020-11-11T21:54:11Z", "commit": {"oid": "b640491828ef83ff85a5b6bf192cbe4f0970a72d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3414, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}