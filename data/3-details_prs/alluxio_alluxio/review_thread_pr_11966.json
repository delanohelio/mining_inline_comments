{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2MjI1NjM4", "number": 11966, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NToyNVrOEXS5Vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NjoxNlrOEXS6lA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyODYyMjk1OnYy", "diffSide": "RIGHT", "path": "core/common/src/test/resources/mockito-extensions/org.mockito.plugins.MockMaker", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NToyNVrOG_Aa-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNVQwMDoxNDowNVrOHBGMMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyMDM3Ng==", "bodyText": "In reference to why this is needed: https://github.com/mockito/mockito/wiki/What%27s-new-in-Mockito-2#mock-the-unmockable-opt-in-mocking-of-final-classesmethods", "url": "https://github.com/Alluxio/alluxio/pull/11966#discussion_r468720376", "createdAt": "2020-08-11T16:45:25Z", "author": {"login": "ZacBlanco"}, "path": "core/common/src/test/resources/mockito-extensions/org.mockito.plugins.MockMaker", "diffHunk": "@@ -0,0 +1 @@\n+mock-maker-inline", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5ef69e35db571caf1e7f1dc1a90349539b67f35"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODczMDQ5Ng==", "bodyText": "does this affect other tests? i saw several other tests failed. Could you take a look?", "url": "https://github.com/Alluxio/alluxio/pull/11966#discussion_r468730496", "createdAt": "2020-08-11T17:01:50Z", "author": {"login": "yuzhu"}, "path": "core/common/src/test/resources/mockito-extensions/org.mockito.plugins.MockMaker", "diffHunk": "@@ -0,0 +1 @@\n+mock-maker-inline", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyMDM3Ng=="}, "originalCommit": {"oid": "a5ef69e35db571caf1e7f1dc1a90349539b67f35"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwODA4OQ==", "bodyText": "Took a look. Latest commits should fix. I make use of the new Mockito#mockStatic methods in 3.4.x and above", "url": "https://github.com/Alluxio/alluxio/pull/11966#discussion_r468908089", "createdAt": "2020-08-11T22:51:10Z", "author": {"login": "ZacBlanco"}, "path": "core/common/src/test/resources/mockito-extensions/org.mockito.plugins.MockMaker", "diffHunk": "@@ -0,0 +1 @@\n+mock-maker-inline", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyMDM3Ng=="}, "originalCommit": {"oid": "a5ef69e35db571caf1e7f1dc1a90349539b67f35"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMjA0OA==", "bodyText": "ok..well.. more issues arose. Latest commit fixes the failures of the last build", "url": "https://github.com/Alluxio/alluxio/pull/11966#discussion_r470912048", "createdAt": "2020-08-15T00:14:05Z", "author": {"login": "ZacBlanco"}, "path": "core/common/src/test/resources/mockito-extensions/org.mockito.plugins.MockMaker", "diffHunk": "@@ -0,0 +1 @@\n+mock-maker-inline", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyMDM3Ng=="}, "originalCommit": {"oid": "a5ef69e35db571caf1e7f1dc1a90349539b67f35"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyODYyMzY0OnYy", "diffSide": "RIGHT", "path": "core/common/src/test/java/alluxio/util/JvmPauseMonitorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NTozNVrOG_AbWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NTozNVrOG_AbWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyMDQ3Mg==", "bodyText": "Thread#join is final", "url": "https://github.com/Alluxio/alluxio/pull/11966#discussion_r468720472", "createdAt": "2020-08-11T16:45:35Z", "author": {"login": "ZacBlanco"}, "path": "core/common/src/test/java/alluxio/util/JvmPauseMonitorTest.java", "diffHunk": "@@ -49,28 +49,16 @@ public void pauseMonitorStartStopTest() {\n \n   @Test\n   public void interruptOnStop() throws Exception {\n-    JvmPauseMonitor mon = Mockito.spy(new JvmPauseMonitor(10000, 900000, 90000));\n-    CyclicBarrier barrier = new CyclicBarrier(2);\n-    doAnswer((Answer<Void>) invocation -> {\n-      barrier.await();\n-      invocation.callRealMethod();\n-      return null;\n-    }).when(mon).sleepMillis(any(Long.class));\n-    Thread current = Thread.currentThread();\n-    Thread t1 = new Thread(() -> {\n-      try {\n-        barrier.await();\n-        current.interrupt();\n-      } catch (InterruptedException | BrokenBarrierException e) {\n-        fail(\"Failed to await on barrier\");\n-      }\n-    });\n-    t1.start();\n+    JvmPauseMonitor mon = Mockito.spy(new JvmPauseMonitor(1000, 900000, 90000));\n     mon.start();\n-    barrier.await();\n+    Thread pmThread = Whitebox.getInternalState(mon, \"mJvmMonitorThread\");\n+    Thread spied = Mockito.spy(pmThread);\n+    doThrow(InterruptedException.class).when(spied).join();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5ef69e35db571caf1e7f1dc1a90349539b67f35"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyODYyNjEyOnYy", "diffSide": "RIGHT", "path": "core/common/src/test/java/alluxio/util/JvmPauseMonitorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NjoxNlrOG_AdDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjo0NjoxNlrOG_AdDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyMDkwOQ==", "bodyText": "org.mockito.Matchers is now deprecated, so I moved to the newer class", "url": "https://github.com/Alluxio/alluxio/pull/11966#discussion_r468720909", "createdAt": "2020-08-11T16:46:16Z", "author": {"login": "ZacBlanco"}, "path": "core/common/src/test/java/alluxio/util/JvmPauseMonitorTest.java", "diffHunk": "@@ -14,9 +14,9 @@\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertFalse;\n import static org.junit.Assert.assertTrue;\n-import static org.junit.Assert.fail;\n-import static org.mockito.Matchers.any;\n+import static org.mockito.ArgumentMatchers.any;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5ef69e35db571caf1e7f1dc1a90349539b67f35"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1296, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}