{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1MDMxMjcx", "number": 10768, "title": "Add client config load before initializing metrics heartbeat", "bodyText": "When client-side configuration is wrong or missing, client heartbeat may have connection issues (ie due to security settings).  This PR adds client side load configuration before initializign metrics heartbeat to solve the issue.", "createdAt": "2020-01-20T23:04:45Z", "url": "https://github.com/Alluxio/alluxio/pull/10768", "merged": true, "mergeCommit": {"oid": "0ccc259403610bc3f5b37bcee7ffffcaade1ca7a"}, "closed": true, "closedAt": "2020-01-21T21:41:28Z", "author": {"login": "LuQQiu"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8UwXhgH2gAyMzY1MDMxMjcxOjdhMWI3MjE5OGIxMDE3ODY4NjYzZGNlZjA2MjI3YTI0YzRjZTA1NmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8oNZKgFqTM0NjIxMTA0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7a1b72198b1017868663dcef06227a24c4ce056f", "author": {"user": {"login": "LuQQiu", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/7a1b72198b1017868663dcef06227a24c4ce056f", "committedDate": "2020-01-20T23:01:19Z", "message": "Load conf before initializing metrics heartbeat"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NTc3NTkw", "url": "https://github.com/Alluxio/alluxio/pull/10768#pullrequestreview-345577590", "createdAt": "2020-01-21T00:04:38Z", "commit": {"oid": "7a1b72198b1017868663dcef06227a24c4ce056f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwMDowNDozOFrOFfrgPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwMDowNDozOFrOFfrgPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc2Mjk0Mg==", "bodyText": "Should we only do this if metrics are enabled?", "url": "https://github.com/Alluxio/alluxio/pull/10768#discussion_r368762942", "createdAt": "2020-01-21T00:04:38Z", "author": {"login": "calvinjia"}, "path": "core/client/fs/src/main/java/alluxio/client/file/FileSystemContext.java", "diffHunk": "@@ -229,6 +229,15 @@ private synchronized void initContext(ClientContext ctx,\n     mClosed.set(false);\n     mMasterClientContext = MasterClientContext.newBuilder(ctx)\n         .setMasterInquireClient(masterInquireClient).build();\n+    try {\n+      InetSocketAddress masterAddr = masterInquireClient.getPrimaryRpcAddress();\n+      mMasterClientContext.loadConf(masterAddr, true, true);\n+    } catch (UnavailableException e) {\n+      LOG.error(\"Failed to get master address during initialization\", e);\n+    } catch (AlluxioStatusException ae) {\n+      LOG.error(\"Failed to load configuration from \"\n+          + \"meta master during initialization\", ae);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a1b72198b1017868663dcef06227a24c4ce056f"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d08fd43b2469557dbdeffda52d551d929a57298a", "author": {"user": {"login": "LuQQiu", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/d08fd43b2469557dbdeffda52d551d929a57298a", "committedDate": "2020-01-21T02:37:18Z", "message": "Move metrics enabled get conf"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MjExMDQx", "url": "https://github.com/Alluxio/alluxio/pull/10768#pullrequestreview-346211041", "createdAt": "2020-01-21T21:41:13Z", "commit": {"oid": "d08fd43b2469557dbdeffda52d551d929a57298a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3110, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}