{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNTk1MTEw", "number": 10835, "title": "Refactor for local cache", "bodyText": "Better division for the file system configuration and constructors.", "createdAt": "2020-02-04T00:55:45Z", "url": "https://github.com/Alluxio/alluxio/pull/10835", "merged": true, "mergeCommit": {"oid": "2c0cdc7134422c823deeb9fd50f785816c8d8c3a"}, "closed": true, "closedAt": "2020-02-04T22:26:26Z", "author": {"login": "calvinjia"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcA2wt1AH2gAyMzcwNTk1MTEwOjkwOWZiY2QwZmEzNDEyN2ZhYzI2ZjM5YmI1M2EyMzc5NGU5YjkxY2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBJOpYgFqTM1MzM0NjE1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "909fbcd0fa34127fac26f39bb53a23794e9b91cc", "author": {"user": {"login": "calvinjia", "name": "Calvin Jia"}}, "url": "https://github.com/Alluxio/alluxio/commit/909fbcd0fa34127fac26f39bb53a23794e9b91cc", "committedDate": "2020-02-04T00:54:10Z", "message": "Refactor for local cache."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1a5568c4d3fe9a309f606fed7508c40b27c58b4", "author": {"user": {"login": "calvinjia", "name": "Calvin Jia"}}, "url": "https://github.com/Alluxio/alluxio/commit/c1a5568c4d3fe9a309f606fed7508c40b27c58b4", "committedDate": "2020-02-04T19:42:36Z", "message": "Checkstyle."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dca43512f9788565f4984870c4bfd0247a412129", "author": {"user": {"login": "calvinjia", "name": "Calvin Jia"}}, "url": "https://github.com/Alluxio/alluxio/commit/dca43512f9788565f4984870c4bfd0247a412129", "committedDate": "2020-02-04T21:10:32Z", "message": "Suppress findbugs warning."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzIyMTYz", "url": "https://github.com/Alluxio/alluxio/pull/10835#pullrequestreview-353322163", "createdAt": "2020-02-04T21:42:22Z", "commit": {"oid": "dca43512f9788565f4984870c4bfd0247a412129"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMTo0MjoyMlrOFlkeJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMTo0MjoyMlrOFlkeJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDkzOTE3Mw==", "bodyText": "Would it be okay now that the file system client does not have the client user subject?", "url": "https://github.com/Alluxio/alluxio/pull/10835#discussion_r374939173", "createdAt": "2020-02-04T21:42:22Z", "author": {"login": "bf8086"}, "path": "core/client/hdfs/src/main/java/alluxio/hadoop/AbstractFileSystem.java", "diffHunk": "@@ -491,9 +491,13 @@ public synchronized void initialize(URI uri, org.apache.hadoop.conf.Configuratio\n     // Create FileSystem for accessing Alluxio.\n     // Disable URI validation for non-Alluxio schemes.\n     boolean disableUriValidation =\n-        (uri.getScheme() != null) ? uri.getScheme().equals(Constants.SCHEME) : true;\n-    mFileSystem = FileSystem.Factory.create(\n-        ClientContext.create(subject, alluxioConf).setUriValidationEnabled(disableUriValidation));\n+        (uri.getScheme() == null) || uri.getScheme().equals(Constants.SCHEME);\n+    if (alluxioConf.getBoolean(PropertyKey.USER_LOCAL_CACHE_LIBRARY)) {\n+      mFileSystem = FileSystem.Factory.create(null, alluxioConf);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dca43512f9788565f4984870c4bfd0247a412129"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzIzNjA3", "url": "https://github.com/Alluxio/alluxio/pull/10835#pullrequestreview-353323607", "createdAt": "2020-02-04T21:44:46Z", "commit": {"oid": "dca43512f9788565f4984870c4bfd0247a412129"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMTo0NDo0NlrOFlkicg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMTo0NDo0NlrOFlkicg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk0MDI3NA==", "bodyText": "Would it be cleaner if we just have a subclass of FileSystemContext that override getClusterConf to return the client side configuration instead?", "url": "https://github.com/Alluxio/alluxio/pull/10835#discussion_r374940274", "createdAt": "2020-02-04T21:44:46Z", "author": {"login": "bf8086"}, "path": "core/client/fs/src/main/java/alluxio/client/file/FileSystem.java", "diffHunk": "@@ -130,9 +130,17 @@ public static FileSystem create(ClientContext ctx) {\n      * @return a new FileSystem instance\n      */\n     public static FileSystem create(FileSystemContext context) {\n+      return create(context, context.getClusterConf());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dca43512f9788565f4984870c4bfd0247a412129"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzQ2MTUz", "url": "https://github.com/Alluxio/alluxio/pull/10835#pullrequestreview-353346153", "createdAt": "2020-02-04T22:25:09Z", "commit": {"oid": "dca43512f9788565f4984870c4bfd0247a412129"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3171, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}