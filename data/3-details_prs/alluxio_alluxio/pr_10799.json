{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3MDY0Mzcy", "number": 10799, "title": "Fix directory index after disk failure", "bodyText": "Worker uses directory index to find a directory in a tier. When a disk goes down we detect that and remove the dir, which mess up the index. To avoid the confusion, this fix makes the index absolute in the tier so removing any dir does not alter its index. As a side effect, getDir(index) can return null if the corresponding directory is removed. Evictors and Allocators have been updated to handle the null values.", "createdAt": "2020-01-25T00:20:05Z", "url": "https://github.com/Alluxio/alluxio/pull/10799", "merged": true, "mergeCommit": {"oid": "0b9681b9ac4b66bb96548f1bf607acd3cd522de1"}, "closed": true, "closedAt": "2020-01-28T22:48:24Z", "author": {"login": "bf8086"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9oLZxAH2gAyMzY3MDY0MzcyOjc4MTY4NDU4ZGRmN2E4YTc0Yjg0N2M2NGFjMTdiMjUzMDY1NmQ2Yjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-qZusgFqTM0OTEzNTgxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "78168458ddf7a8a74b847c64ac17b2530656d6b9", "author": {"user": {"login": "bf8086", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/78168458ddf7a8a74b847c64ac17b2530656d6b9", "committedDate": "2020-01-25T00:12:58Z", "message": "Fix tier index after deletion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbbd74049fb1911223c99c1646654dced721bb31", "author": {"user": {"login": "bf8086", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/dbbd74049fb1911223c99c1646654dced721bb31", "committedDate": "2020-01-25T01:20:15Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cbde21ad4dbf3bfac8ff2a8a98fb0122cde5540", "author": {"user": {"login": "bf8086", "name": null}}, "url": "https://github.com/Alluxio/alluxio/commit/5cbde21ad4dbf3bfac8ff2a8a98fb0122cde5540", "committedDate": "2020-01-27T22:04:44Z", "message": "fix index issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MDU3MTYw", "url": "https://github.com/Alluxio/alluxio/pull/10799#pullrequestreview-349057160", "createdAt": "2020-01-27T23:57:54Z", "commit": {"oid": "5cbde21ad4dbf3bfac8ff2a8a98fb0122cde5540"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MDY4MzQ4", "url": "https://github.com/Alluxio/alluxio/pull/10799#pullrequestreview-349068348", "createdAt": "2020-01-28T00:31:59Z", "commit": {"oid": "5cbde21ad4dbf3bfac8ff2a8a98fb0122cde5540"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwMDozMTo1OVrOFiWFpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwMDozMTo1OVrOFiWFpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTU1Nzc5Nw==", "bodyText": "Does this List need to be modifiable now?", "url": "https://github.com/Alluxio/alluxio/pull/10799#discussion_r371557797", "createdAt": "2020-01-28T00:31:59Z", "author": {"login": "yuzhu"}, "path": "core/server/worker/src/main/java/alluxio/worker/block/meta/StorageTierView.java", "diffHunk": "@@ -41,7 +42,7 @@ public StorageTierView(StorageTier tier) {\n    * @return a list of directory views in this storage tier view\n    */\n   public List<StorageDirView> getDirViews() {\n-    return Collections.unmodifiableList(mDirViews);\n+    return new ArrayList<>(mDirViews.values());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cbde21ad4dbf3bfac8ff2a8a98fb0122cde5540"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTM1ODE2", "url": "https://github.com/Alluxio/alluxio/pull/10799#pullrequestreview-349135816", "createdAt": "2020-01-28T05:22:22Z", "commit": {"oid": "5cbde21ad4dbf3bfac8ff2a8a98fb0122cde5540"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3141, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}