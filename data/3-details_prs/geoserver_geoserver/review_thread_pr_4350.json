{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNjY1MDA5", "number": 4350, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNDowMzo0N1rOEMgPQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNDowMzo0N1rOEMgPQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxNTQ2NTYyOnYy", "diffSide": "RIGHT", "path": "src/wms/src/main/java/org/geoserver/wms/map/GetMapKvpRequestReader.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNDowMzo0N1rOGuppbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxNDowMzo0N1rOGuppbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU3MDAzMQ==", "bodyText": "Was about to merge but wondered about one thing... if the parameter is present but empty does everything still work even in CITE compliant mode?\nFrom the spec:\n\nA client may request the default Style using a null value (as in \"STYLES=\"). If several layers are requested with a mixture of named and default styles, the STYLES parameter shall include null values between commas (as in \"STYLES=style1,,style2,,\"). If all layers are to be shown using the default style, either the form \"STYLES=\" or \"STYLES=,,,\" is valid.", "url": "https://github.com/geoserver/geoserver/pull/4350#discussion_r451570031", "createdAt": "2020-07-08T14:03:47Z", "author": {"login": "aaime"}, "path": "src/wms/src/main/java/org/geoserver/wms/map/GetMapKvpRequestReader.java", "diffHunk": "@@ -288,13 +301,27 @@ public GetMapRequest read(Object request, Map kvp, Map rawKvp) throws Exception\n         if (layerParam != null) {\n             List<String> layerNames = KvpUtils.readFlat(layerParam);\n             requestedLayerInfos.addAll(parseLayers(layerNames, remoteOwsUrl, remoteOwsType));\n+        } else if (citeCompliant && getMap.getSldBody() == null && getMap.getSld() == null) {\n+            // The SLD extensions to WMS allow a request not to have layers, as long as a full SLD\n+            // is specified either using &sld or &sld_body. The error must not be thrown in these\n+            // conditions (which are probably not what INSPIRE had in mind, but nonetheless a OGC\n+            // specification.\n+            throw new ServiceException(\n+                    \"GetMap LAYERS parameter is mandatory if SLD nor SLD_BODY are not specified\");\n         }\n \n         // raw styles parameter\n         String stylesParam = (String) kvp.get(\"STYLES\");\n         List<String> styleNameList = new ArrayList<String>();\n         if (stylesParam != null) {\n             styleNameList.addAll(KvpUtils.readFlat(stylesParam));\n+        } else if (citeCompliant && getMap.getSldBody() == null && getMap.getSld() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c355b2f91710dd5c6e314d97dd819999147a52c0"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3947, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}