{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5NTcxNTY2", "number": 4547, "title": "[GEOS-9779][GEOS-9780] Upgrade OSHI from 3.13.3 to 5.3.3", "bodyText": "Upgrade OSHI from 3.13.3 to 5.3.3\n mark all OSHI class members in OSHISystemInfoCollector transient are they are not serializable\n fix API changes and deprecations\n\nResolves:\n\nGEOS-9779 Upgrade OSHI libraries to 5.3.3\nGEOS-9780 status page shows (read-only) loopback partitions\n\nChecklist\n\nReviewing is a process done by project maintainers, mostly on a volunteer basis. We try to keep the overhead as small as possible and appreciate if you help us to do so by completing the following items. Feel free to ask in a comment if you have troubles with any of them.\n\nSubmitting the PR does not require you to check all items, but by the time it gets merged, they should be either satisfied or inapplicable.\nFor all pull requests:\n\n Confirm you have read the contribution guidelines\n You have sent a Contribution Licence Agreement (CLA) as necessary (not required for small changes, e.g., fixing typos in documentation)\n Make sure the first PR targets the master branch, eventual backports will be managed later. This can be ignored if the PR is fixing an issue that only happens in a specific branch, but not in newer ones.\n\nThe following are required only for core and extension modules (they are welcomed, but not required, for community modules):\n\n There is a ticket in Jira describing the issue/improvement/feature (a notable exemptions is, changes not visible to end users)\n PR for bug fixes and small new features are presented as a single commit\n Commit message must be in the form \"[GEOS-XYZW] Title of the Jira ticket\" (export to XML in Jira generates the message in this exact form)\n The pull request contains changes related to a single objective. If multiple focuses cannot be avoided, each one is in its own commit and has a separate ticket describing it.\n New unit tests have been added covering the changes\n This PR passes all existing unit tests (test results will be reported by travis-ci after opening this PR)\n This PR passes the QA checks (QA checks results will be reported by travis-ci after opening this PR)\n Commits changing the UI, existing user workflows, or adding new functionality, need to include documentation updates (screenshots, text)\n Commits changing the REST API, or any configuration object, should check if the REST API docs (Swagger YAML files and classic documentation) need to be updated.", "createdAt": "2020-10-25T10:45:07Z", "url": "https://github.com/geoserver/geoserver/pull/4547", "merged": true, "mergeCommit": {"oid": "8c2d61ff931711bb59a24c4d69a21fd2b6cd91bf"}, "closed": true, "closedAt": "2020-10-30T14:55:39Z", "author": {"login": "mprins"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdV-JFggBqjM5MTc3MjA1NTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXN3HyAH2gAyNTA5NTcxNTY2OjgxNGE5Y2ZhZmMxZTRjMzhlYmE0YjZjMDA5MTczNTFjOWFkYzY1MDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef223963c3a677abf88fa93efd0baea21746ebc9", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/ef223963c3a677abf88fa93efd0baea21746ebc9", "committedDate": "2020-10-25T10:37:44Z", "message": "WIP upgrade OSHI from 3.13.3 to 5.3.x"}, "afterCommit": {"oid": "482aa88b0d189063bf9213cfa868e0f7663570cd", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/482aa88b0d189063bf9213cfa868e0f7663570cd", "committedDate": "2020-10-25T11:27:53Z", "message": "WIP upgrade OSHI from 3.13.3 to 5.3.x"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "daacd0fbe5aea4982dba3f0e484004cca344af57", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/daacd0fbe5aea4982dba3f0e484004cca344af57", "committedDate": "2020-10-26T13:03:34Z", "message": "keep track of cpu ticks for processorload"}, "afterCommit": {"oid": "95d9487bc4b987d82b01deece5ac4d11992f0002", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/95d9487bc4b987d82b01deece5ac4d11992f0002", "committedDate": "2020-10-26T13:51:32Z", "message": "keep track of cpu ticks for processorload"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2OTg3NTg5", "url": "https://github.com/geoserver/geoserver/pull/4547#pullrequestreview-516987589", "createdAt": "2020-10-26T16:57:57Z", "commit": {"oid": "b74175830e6e96273690e8bece86a8be6f4fb76a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNjo1Nzo1N1rOHoZXcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNjo1Nzo1N1rOHoZXcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMDY4OA==", "bodyText": "should this just be removed from the enum?", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512120688", "createdAt": "2020-10-26T16:57:57Z", "author": {"login": "mprins"}, "path": "src/main/src/main/java/org/geoserver/system/status/MetricInfo.java", "diffHunk": "@@ -18,7 +18,7 @@\n     LOGICAL_CPUS(\"CPU\", 101, \"Number of logical CPUs\"),\n     RUNNING_PROCESS(\"CPU\", 102, \"Number of running process\"),\n     RUNNING_THREADS(\"CPU\", 103, \"Number of running threads\"),\n-    CPU_LOAD(\"CPU\", 104, \"CPU average load\", \"%\"),\n+    // removed from OSHI    CPU_LOAD(\"CPU\", 104, \"CPU average load\", \"%\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74175830e6e96273690e8bece86a8be6f4fb76a"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "686496882335e53b41baf4679cb0e8971ad15d7b", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/686496882335e53b41baf4679cb0e8971ad15d7b", "committedDate": "2020-10-26T17:03:06Z", "message": "remove CPU_LOAD from the code"}, "afterCommit": {"oid": "7025a5011f58e6b5a59724383a493632667b649c", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/7025a5011f58e6b5a59724383a493632667b649c", "committedDate": "2020-10-26T17:06:08Z", "message": "[GEOS-9779] Upgrade OSHI from 3.13.3 to 5.3.2\n\n- keep track of cpu ticks for processorload\n- mark all OSHI class members transient as these are not serializable and were throwing errors like\n- remove CPU_LOAD from the code as it is no longer available through OSHI"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MDM2NDQ1", "url": "https://github.com/geoserver/geoserver/pull/4547#pullrequestreview-517036445", "createdAt": "2020-10-26T17:53:47Z", "commit": {"oid": "7025a5011f58e6b5a59724383a493632667b649c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNzo1Mzo0N1rOHobqlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNzo1Njo1MVrOHobyUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1ODM1OQ==", "bodyText": "What was removed was OSHI tracking its own ticks here. You could keep track of the ticks yourself imilar to how you do for PER_CPU_LOAD and keep this.", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512158359", "createdAt": "2020-10-26T17:53:47Z", "author": {"login": "dbwiddis"}, "path": "src/main/src/main/java/org/geoserver/system/status/MetricInfo.java", "diffHunk": "@@ -18,7 +18,7 @@\n     LOGICAL_CPUS(\"CPU\", 101, \"Number of logical CPUs\"),\n     RUNNING_PROCESS(\"CPU\", 102, \"Number of running process\"),\n     RUNNING_THREADS(\"CPU\", 103, \"Number of running threads\"),\n-    CPU_LOAD(\"CPU\", 104, \"CPU average load\", \"%\"),\n+    // 104 removed from OSHI", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7025a5011f58e6b5a59724383a493632667b649c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2MDMzNw==", "bodyText": "Rather than removing this entirely you could use an oldTicks value (like you do below on line 194 for per-CPU) and pass to the getSystemCpuLoadBetweenTicks() method.  Alternately you could duplicate the per-cpu logic and sum up the arrays to get a system average.", "url": "https://github.com/geoserver/geoserver/pull/4547#discussion_r512160337", "createdAt": "2020-10-26T17:56:51Z", "author": {"login": "dbwiddis"}, "path": "src/main/src/main/java/org/geoserver/system/status/OSHISystemInfoCollector.java", "diffHunk": "@@ -184,22 +187,11 @@ public OSHISystemInfoCollector() {\n                         si = Collections.singletonList(mv);\n                         break;\n                     }\n-                case CPU_LOAD:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7025a5011f58e6b5a59724383a493632667b649c"}, "originalPosition": 79}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8064599519d3e9a785a4124bced3579df1c10a3c", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/8064599519d3e9a785a4124bced3579df1c10a3c", "committedDate": "2020-10-26T18:56:17Z", "message": "[GEOS-9779] Upgrade OSHI from 3.13.3 to 5.3.2\n\n- keep track of cpu ticks for processorload\n- mark all OSHI class members transient as these are not serializable and were throwing errors like\n- OSHI is available wunder MIT license, no need for exemptions in our license file"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "20dcf5af65704585b13c19ba000ffe37d9ae7274", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/20dcf5af65704585b13c19ba000ffe37d9ae7274", "committedDate": "2020-10-26T18:14:59Z", "message": "OSHI is available wunder MIT license, no need for exemptions"}, "afterCommit": {"oid": "8064599519d3e9a785a4124bced3579df1c10a3c", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/8064599519d3e9a785a4124bced3579df1c10a3c", "committedDate": "2020-10-26T18:56:17Z", "message": "[GEOS-9779] Upgrade OSHI from 3.13.3 to 5.3.2\n\n- keep track of cpu ticks for processorload\n- mark all OSHI class members transient as these are not serializable and were throwing errors like\n- OSHI is available wunder MIT license, no need for exemptions in our license file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "814a9cfafc1e4c38eba4b6c00917351c9adc6508", "author": {"user": {"login": "mprins", "name": "Mark Prins"}}, "url": "https://github.com/geoserver/geoserver/commit/814a9cfafc1e4c38eba4b6c00917351c9adc6508", "committedDate": "2020-10-29T08:26:28Z", "message": "[GEOS-9780] Bump oshi-core 5.3.2 -> 5.3.3 to resolve status page shows (read-only) loopback partitions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1508, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}