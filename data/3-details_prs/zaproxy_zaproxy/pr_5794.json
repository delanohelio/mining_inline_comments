{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxNjgxNDgy", "number": 5794, "title": "Correct MailTo pattern for RegexAutoTagScanner", "bodyText": "config.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it. (Added a ZAP comment.)\nSigned-off-by: kingthorin kingthorin@users.noreply.github.com", "createdAt": "2020-01-11T01:48:06Z", "url": "https://github.com/zaproxy/zaproxy/pull/5794", "merged": true, "mergeCommit": {"oid": "257d46ddf19ece3c00bb0bf49e557bfaee0ff5b4"}, "closed": true, "closedAt": "2020-01-13T09:19:31Z", "author": {"login": "kingthorin"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb5JL8MABqjI5NDAzMTA5OTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb54zYUgFqTM0MTcxMDEyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b54d96de102516524732b3a228ab45e974b7f19", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/2b54d96de102516524732b3a228ab45e974b7f19", "committedDate": "2020-01-11T01:47:05Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/4af577ccb357517c8091a1b59fcee7db266fd5ee", "committedDate": "2020-01-11T01:50:26Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDk2MTY3", "url": "https://github.com/zaproxy/zaproxy/pull/5794#pullrequestreview-341496167", "createdAt": "2020-01-11T01:58:46Z", "commit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMVQwMTo1ODo0N1rOFcjv5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMVQwMTo1ODo0N1rOFcjv5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ5MDE0OQ==", "bodyText": "I've probably overlooked something, but this seemed necessary to make it stick.", "url": "https://github.com/zaproxy/zaproxy/pull/5794#discussion_r365490149", "createdAt": "2020-01-11T01:58:47Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/parosproxy/paros/Constant.java", "diffHunk": "@@ -1092,6 +1095,29 @@ private static void upgradeFrom2_8_0(XMLConfiguration config) {\n         // Update to a newer default user agent\n         config.setProperty(\n                 ConnectionParam.DEFAULT_USER_AGENT, ConnectionParam.DEFAULT_DEFAULT_USER_AGENT);\n+        updatePscanTagMailtoPattern(config);\n+    }\n+\n+    private static void updatePscanTagMailtoPattern(XMLConfiguration config) {\n+        String autoTagScannersKey = \"pscans.autoTagScanners.scanner\";\n+        List<HierarchicalConfiguration> tagScanners = config.configurationsAt(autoTagScannersKey);\n+        String badPattern = \"<.*href\\\\s*['\\\"]?mailto:\";\n+        String goodPattern = \"<.*href\\\\s*=['\\\"]?mailto:\";\n+\n+        for (int i = 0, size = tagScanners.size(); i < size; ++i) {\n+            String elementBaseKey = autoTagScannersKey + \"(\" + i + \").\";\n+            String currentKeyResBodyRegex = elementBaseKey + \"resBodyRegex\";\n+            if (config.getProperty(currentKeyResBodyRegex).equals(badPattern)) {\n+                config.setProperty(currentKeyResBodyRegex, goodPattern);\n+                break;\n+            }\n+        }\n+\n+        try {\n+            config.save();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNTgyMjQw", "url": "https://github.com/zaproxy/zaproxy/pull/5794#pullrequestreview-341582240", "createdAt": "2020-01-12T15:32:08Z", "commit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMlQxNTozMjowOFrOFcp51A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMlQxNTozMjowOFrOFcp51A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MDk5Ng==", "bodyText": "Worth adding \\\\s* after the equals.", "url": "https://github.com/zaproxy/zaproxy/pull/5794#discussion_r365590996", "createdAt": "2020-01-12T15:32:08Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/Constant.java", "diffHunk": "@@ -1092,6 +1095,29 @@ private static void upgradeFrom2_8_0(XMLConfiguration config) {\n         // Update to a newer default user agent\n         config.setProperty(\n                 ConnectionParam.DEFAULT_USER_AGENT, ConnectionParam.DEFAULT_DEFAULT_USER_AGENT);\n+        updatePscanTagMailtoPattern(config);\n+    }\n+\n+    private static void updatePscanTagMailtoPattern(XMLConfiguration config) {\n+        String autoTagScannersKey = \"pscans.autoTagScanners.scanner\";\n+        List<HierarchicalConfiguration> tagScanners = config.configurationsAt(autoTagScannersKey);\n+        String badPattern = \"<.*href\\\\s*['\\\"]?mailto:\";\n+        String goodPattern = \"<.*href\\\\s*=['\\\"]?mailto:\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNTgyNTky", "url": "https://github.com/zaproxy/zaproxy/pull/5794#pullrequestreview-341582592", "createdAt": "2020-01-12T15:38:49Z", "commit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMlQxNTozODo0OVrOFcp7Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMlQxNTozODo0OVrOFcp7Yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU5MTM5NA==", "bodyText": "String currentKeyResBodyRegex = autoTagScannersKey + \"(\" + i + \").resBodyRegex\";", "url": "https://github.com/zaproxy/zaproxy/pull/5794#discussion_r365591394", "createdAt": "2020-01-12T15:38:49Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/Constant.java", "diffHunk": "@@ -1092,6 +1095,29 @@ private static void upgradeFrom2_8_0(XMLConfiguration config) {\n         // Update to a newer default user agent\n         config.setProperty(\n                 ConnectionParam.DEFAULT_USER_AGENT, ConnectionParam.DEFAULT_DEFAULT_USER_AGENT);\n+        updatePscanTagMailtoPattern(config);\n+    }\n+\n+    private static void updatePscanTagMailtoPattern(XMLConfiguration config) {\n+        String autoTagScannersKey = \"pscans.autoTagScanners.scanner\";\n+        List<HierarchicalConfiguration> tagScanners = config.configurationsAt(autoTagScannersKey);\n+        String badPattern = \"<.*href\\\\s*['\\\"]?mailto:\";\n+        String goodPattern = \"<.*href\\\\s*=['\\\"]?mailto:\";\n+\n+        for (int i = 0, size = tagScanners.size(); i < size; ++i) {\n+            String elementBaseKey = autoTagScannersKey + \"(\" + i + \").\";\n+            String currentKeyResBodyRegex = elementBaseKey + \"resBodyRegex\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee"}, "originalPosition": 32}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4af577ccb357517c8091a1b59fcee7db266fd5ee", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/4af577ccb357517c8091a1b59fcee7db266fd5ee", "committedDate": "2020-01-11T01:50:26Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "843dc87cb65ed6ad6502d56b885af16a8e0cef27", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/843dc87cb65ed6ad6502d56b885af16a8e0cef27", "committedDate": "2020-01-12T15:56:04Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "843dc87cb65ed6ad6502d56b885af16a8e0cef27", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/843dc87cb65ed6ad6502d56b885af16a8e0cef27", "committedDate": "2020-01-12T15:56:04Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "bac74a33aadddcfe7a8bdf808269e7576634ffbc", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/bac74a33aadddcfe7a8bdf808269e7576634ffbc", "committedDate": "2020-01-12T15:58:32Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bac74a33aadddcfe7a8bdf808269e7576634ffbc", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/bac74a33aadddcfe7a8bdf808269e7576634ffbc", "committedDate": "2020-01-12T15:58:32Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "5cdfb192212b1f5b975d9b406affdb5354434eb8", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/5cdfb192212b1f5b975d9b406affdb5354434eb8", "committedDate": "2020-01-12T16:02:41Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin kingthorin@users.noreply.github.com"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5cdfb192212b1f5b975d9b406affdb5354434eb8", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/5cdfb192212b1f5b975d9b406affdb5354434eb8", "committedDate": "2020-01-12T16:02:41Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin kingthorin@users.noreply.github.com"}, "afterCommit": {"oid": "a6667f31a88b83d3d2dd3a6b619f7c24cd83a6e9", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/a6667f31a88b83d3d2dd3a6b619f7c24cd83a6e9", "committedDate": "2020-01-12T16:03:43Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a6667f31a88b83d3d2dd3a6b619f7c24cd83a6e9", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/a6667f31a88b83d3d2dd3a6b619f7c24cd83a6e9", "committedDate": "2020-01-12T16:03:43Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "4bb2884af2a37c5d967eb0be48240713c029a724", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/4bb2884af2a37c5d967eb0be48240713c029a724", "committedDate": "2020-01-12T16:13:05Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f78dbeb10d8afd99ff608f13b6727d3dda9a7e8f", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/f78dbeb10d8afd99ff608f13b6727d3dda9a7e8f", "committedDate": "2020-01-12T18:09:34Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bb2884af2a37c5d967eb0be48240713c029a724", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/4bb2884af2a37c5d967eb0be48240713c029a724", "committedDate": "2020-01-12T16:13:05Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}, "afterCommit": {"oid": "f78dbeb10d8afd99ff608f13b6727d3dda9a7e8f", "author": {"user": {"login": "kingthorin", "name": "Rick M"}}, "url": "https://github.com/zaproxy/zaproxy/commit/f78dbeb10d8afd99ff608f13b6727d3dda9a7e8f", "committedDate": "2020-01-12T18:09:34Z", "message": "Correct MailTo pattern for RegexAutoTagScanner\n\nconfig.xml > Correct default.\nConstant.java > Add method to look for the incorrect pattern and fix it.\n(Added a ZAP comment.)\n\nSigned-off-by: kingthorin <kingthorin@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNTkwODQ0", "url": "https://github.com/zaproxy/zaproxy/pull/5794#pullrequestreview-341590844", "createdAt": "2020-01-12T18:21:36Z", "commit": {"oid": "f78dbeb10d8afd99ff608f13b6727d3dda9a7e8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNzEwMTI5", "url": "https://github.com/zaproxy/zaproxy/pull/5794#pullrequestreview-341710129", "createdAt": "2020-01-13T09:19:25Z", "commit": {"oid": "f78dbeb10d8afd99ff608f13b6727d3dda9a7e8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 222, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}