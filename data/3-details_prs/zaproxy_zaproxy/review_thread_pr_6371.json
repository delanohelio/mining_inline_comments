{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzNjk1NDgy", "number": 6371, "reviewThreads": {"totalCount": 46, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQyMDoxNDo1OFrOFH65Mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xOVQxMjozMToxNVrOGXmWgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzODQ5MjY2OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "isResolved": true, "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQyMDoxNDo1OFrOIJkshw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0wN1QxMDoxNToyOVrOJW_zkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ==", "bodyText": "@thc202 @kingthorin was planning to have another base class for usecases where scanrule wants to modify multiple name value pairs which is a use case for FileUpload scan rule. WDYT ?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r546909319", "createdAt": "2020-12-21T20:14:58Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkzNDQ3MA==", "bodyText": "Wouldn\u2019t file upload use the multipart variant which can already handle manipulation of various elements? (File name, disposition, content type)", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r546934470", "createdAt": "2020-12-21T21:19:05Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzA0NTE5Mw==", "bodyText": "No no, Variant handles the manipulation but AbstractAppParamPlugin calls the scan method for one field at a time hence this new class gives the access to entire variant so that child can manipulate fields as per there need.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r547045193", "createdAt": "2020-12-22T03:21:04Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzA0NTU4Mw==", "bodyText": "Ah okay, I see what you're after.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r547045583", "createdAt": "2020-12-22T03:22:42Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE4MjE4MQ==", "bodyText": "Why not change AbstractAppParamPlugin to just expose all parameters if that's what's needed?\ne.g. scan(HttpMessage, List<NameValuePair>)\nThose interested in all parameters just need to override the method.\nWorth noting that variants do not support changing multiple parameters at the same time.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r547182181", "createdAt": "2020-12-22T09:59:50Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI4NTM3NA==", "bodyText": "@thc202\nActually if we expose List<NameValuePair> then setParameter/setEscapedParameter method becomes irrelevant as it considers nameValuePair as class variable. Also param plugin was written for some other purpose and having default implementation seems hacky. WDYT ?\nOh variants don't support changing multiple parameters ? because of start index and end index of value getting changed after setparameter is invoked ?\nHow should be proceed on this ? shall we create a new setParameter method that re-initialise the variant with new message after setting parameter ?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r547285374", "createdAt": "2020-12-22T13:44:56Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzMwNjAyNw==", "bodyText": "The NameValuePairs are already being exposed through scan(HttpMessage, NameValuePair) (and there are scan rules that make use of it), the only difference is that we would be exposing all of them at once. Those methods would not be irrelevant, they are used by scan rules that scan just one parameter at the same time.\nThe variants don't keep track of what changes were already done to a given message, the parameters would have to be set at the same time for properly construct the payload.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r547306027", "createdAt": "2020-12-22T14:25:05Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM2MDY1OQ==", "bodyText": "@thc202\nno no, my point is that for the method that will expose list of name value pairs how are we going to call setParameter/setEscapedParameter methods?  we need to create 2 new methods which takes original nameValuePair as input and hence for someone who is implementing abstractAppParamPlugin it is tough to understand which method to invoke. I think new class creation is a clear demarcation between the 2 usecases.\n\n    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n\n        StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n        int idx = originalPair.getPosition() - 1;\n        MultipartFormParameter mpPart = multiPartParams.get(idx);\n        if (LOGGER.isDebugEnabled()) {\n            LOGGER.debug(\n                    \"i: \"\n                            + idx\n                            + \" pos: \"\n                            + originalPair.getPosition()\n                            + \" S: \"\n                            + mpPart.getStart()\n                            + \" E: \"\n                            + mpPart.getEnd());\n        }\n        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n\n        String newBody = newBodyBuilder.toString();\n        msg.getRequestBody().setBody(newBody);\n        return newBody;\n    }\nWhat i was refering is that, the above method takes the start and end index from the already set HttpMessage (Original) in variant and if we set one value in the httpmessage (input to the method), original start and end index will start pointing to some other location and if we add another value to the same httpmessage (input to the method) it will update the httpmessage incorrectly and hence it will break the httpmessage.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r547360659", "createdAt": "2020-12-22T16:02:45Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDk3NDgzNw==", "bodyText": "I'm not sure it is, e.g. a list allows to add one element or multiple at the same time. If you have multiple parameters you call the method that accepts multiple, if you have one parameter you call the method that accepts one.\nYes, that's what I said in the previous comment, variants don't currently keep track of what changes were done to a given message, the parameters need to be set at the same time.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r554974837", "createdAt": "2021-01-11T11:13:57Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTY1MjEyMw==", "bodyText": "So my point was that:\nAbstractAppParamPlugin currently has following methods\n    protected String setParameter(HttpMessage message, String param, String value) {\n        return variant.setParameter(message, originalPair, param, value);\n    }\n\n    protected String setEscapedParameter(HttpMessage message, String param, String value) {\n        return variant.setEscapedParameter(message, originalPair, param, value);\n    }\nNow we need to add 2 new methods and final structure will be:\n protected String setParameter(HttpMessage message, String param, String value) {\n        return variant.setParameter(message, originalPair, param, value);\n    }\n\n    protected String setEscapedParameter(HttpMessage message, String param, String value) {\n        return variant.setEscapedParameter(message, originalPair, param, value);\n    }\n protected String setParameter(HttpMessage message, String param, String value, NameValuePair nameValuePair) {\n        return variant.setParameter(message, nameValuePair, param, value);\n    }\n\n    protected String setEscapedParameter(HttpMessage message, String param, String value, NameValuePair nameValuePair) {\n        return variant.setEscapedParameter(message, nameValuePair, param, value);\n    }\nI was thinking there is some difficulty in understanding and implementation where if child has called the original methods (old one) then it will cause issues, may be null pointer due to originalPair. Also from implementation the class variable originalPair is some times null and other times not which is some wrong design i feel.\nwhy to cause all this confusion.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r555652123", "createdAt": "2021-01-12T10:05:30Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTY5NzkyOQ==", "bodyText": "The proposed methods do not support changing multiple parameters. Probably better to discuss how the variant will support changing multiple parameters instead, that's what actually will define how the plugin will expose that.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r555697929", "createdAt": "2021-01-12T11:20:32Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODA5Mzg0MA==", "bodyText": "There's still no proposal on how to change the parameters at the same time #6371 (comment).\n\n@thc202  Now this PR handles changing multiple parameters. Please look at PR: https://github.com/zaproxy/zaproxy/pull/6371/files#diff-9dfdfe7aed90f3b927955bcfb81a1c9ae34e745c7b5b4e04d79b5b0130cfb12aR241", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r628093840", "createdAt": "2021-05-07T10:15:29Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppVariantPlugin.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.List;\n+import org.apache.log4j.Logger;\n+import org.parosproxy.paros.Constant;\n+import org.parosproxy.paros.model.Model;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.zaproxy.zap.extension.ascan.VariantFactory;\n+\n+/**\n+ * {@code AbstractAppVariantPlugin} is the abstract base class which is used to run per variant to\n+ * modify multiple name value pairs of the {@code HttpMessage} per variant.\n+ *\n+ * @author KSASAN preetkaran20@gmail.com\n+ */\n+public abstract class AbstractAppVariantPlugin extends AbstractAppPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwOTMxOQ=="}, "originalCommit": {"oid": "bc491cfb8dc3159f7ced7533ccd54f9897e1e9cb"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ5ODE5MDI4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxMDoxNjo1NlrOIR6wRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxMTozMToxMVrOIR9cwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTY1OTMzMg==", "bodyText": "@thc202  @kingthorin my initial thought is to call setMessage again after setting the message for parsing the message again. This can be done from the setParameter api or by exposing a new api which can handle multiple updates and hence the new Api will not impact the performance of existing setparameter api.\nWDYT ?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r555659332", "createdAt": "2021-01-12T10:16:56Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -55,10 +55,11 @@\n     // insensitive & DOTALL, and hit \"test\")\n \n     private List<NameValuePair> params = Collections.emptyList();\n-    private List<MultipartFormParameter> multiPartParams = new ArrayList<MultipartFormParameter>();\n+    private List<MultipartFormParameter> multiPartParams;\n \n     @Override\n     public void setMessage(HttpMessage msg) {\n+        multiPartParams = new ArrayList<MultipartFormParameter>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31d4efaf62837eacac9417d8e546425d076cbeaa"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTY5OTUwMw==", "bodyText": "It's not necessary to re-parse the message to be able to set multiple parameters.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r555699503", "createdAt": "2021-01-12T11:23:28Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -55,10 +55,11 @@\n     // insensitive & DOTALL, and hit \"test\")\n \n     private List<NameValuePair> params = Collections.emptyList();\n-    private List<MultipartFormParameter> multiPartParams = new ArrayList<MultipartFormParameter>();\n+    private List<MultipartFormParameter> multiPartParams;\n \n     @Override\n     public void setMessage(HttpMessage msg) {\n+        multiPartParams = new ArrayList<MultipartFormParameter>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTY1OTMzMg=="}, "originalCommit": {"oid": "31d4efaf62837eacac9417d8e546425d076cbeaa"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTcwMzQ4OA==", "bodyText": "sure will think more on this.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r555703488", "createdAt": "2021-01-12T11:31:11Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -55,10 +55,11 @@\n     // insensitive & DOTALL, and hit \"test\")\n \n     private List<NameValuePair> params = Collections.emptyList();\n-    private List<MultipartFormParameter> multiPartParams = new ArrayList<MultipartFormParameter>();\n+    private List<MultipartFormParameter> multiPartParams;\n \n     @Override\n     public void setMessage(HttpMessage msg) {\n+        multiPartParams = new ArrayList<MultipartFormParameter>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTY1OTMzMg=="}, "originalCommit": {"oid": "31d4efaf62837eacac9417d8e546425d076cbeaa"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUxNzg0NDA3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNlQwMjo0NDo1M1rOIU5NiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNlQwMjo0NDo1M1rOIU5NiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODc3OTc4NA==", "bodyText": "need to validate... not corect loginc if value is 0 length", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r558779784", "createdAt": "2021-01-16T02:44:53Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -235,6 +236,15 @@ private String setParameter(HttpMessage msg, NameValuePair originalPair, String\n                             + mpPart.getEnd());\n         }\n         newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        int offset = value.length() - mpPart.getEnd() + mpPart.getStart() - 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14459c833532cb3239436fe78accc42d76545a4f"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUxNzkxNjg4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNlQwMzoxMTo1MVrOIU5_Xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNlQwMzoxMTo1MVrOIU5_Xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODc5MjU0Mg==", "bodyText": "need to write unittest cases", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r558792542", "createdAt": "2021-01-16T03:11:51Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -235,6 +236,15 @@ private String setParameter(HttpMessage msg, NameValuePair originalPair, String\n                             + mpPart.getEnd());\n         }\n         newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        int offset = value.length() - mpPart.getEnd() + mpPart.getStart();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d67dce2f7b12278d0a83735a4cc3d6dd5be77e4f"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDE0MTM5NzQ5OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNi0xNlQwNjozMDo1MlrOJuKm3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzowODoxNlrOJ7ULDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4ODA2MA==", "bodyText": "@thc202 I have made the condition on the position, considering it is unique and also param can be null too.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r652388060", "createdAt": "2021-06-16T06:30:52Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, AppParamValueType operation) {\n+        if (!nameValuePairPositions.contains(nameValuePair.getPosition())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MzIzNQ==", "bodyText": "Sounds good.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665973235", "createdAt": "2021-07-08T08:16:35Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, AppParamValueType operation) {\n+        if (!nameValuePairPositions.contains(nameValuePair.getPosition())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4ODA2MA=="}, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3NDA3OA==", "bodyText": "But it should allow to replace, that way the scan rules can reuse the builder to craft another message with slightly changes.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665974078", "createdAt": "2021-07-08T08:17:47Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, AppParamValueType operation) {\n+        if (!nameValuePairPositions.contains(nameValuePair.getPosition())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4ODA2MA=="}, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE3NjI2OA==", "bodyText": "hmm sure.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666176268", "createdAt": "2021-07-08T13:08:16Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, AppParamValueType operation) {\n+        if (!nameValuePairPositions.contains(nameValuePair.getPosition())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4ODA2MA=="}, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDE0MTQwMTcwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNi0xNlQwNjozMjoxMFrOJuKpXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxODo0OVrOJ7H38g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4ODcwMQ==", "bodyText": "The return types are quite conflicting, like for multipart it is returning body of HttMessage where as for cookie it returns something else and for some variants it is returning the passed values.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r652388701", "createdAt": "2021-06-16T06:32:10Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +47,17 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     * @return the parameter values set to HttpMessage\n+     */\n+    default List<String> setParameters(HttpMessage message, List<AppParameter> appParams) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3NDc3MA==", "bodyText": "Fine returning void.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665974770", "createdAt": "2021-07-08T08:18:49Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +47,17 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     * @return the parameter values set to HttpMessage\n+     */\n+    default List<String> setParameters(HttpMessage message, List<AppParameter> appParams) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4ODcwMQ=="}, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDE0MTQwNzY4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNi0xNlQwNjozMzo1N1rOJuKs4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoyMDoxNlrOJ7H77Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4OTYwMw==", "bodyText": "As for single parameter setParameter method is returning HTTP message's body so returned the same(by adding to list). @thc202  WDYT? I think setParameter should not return anything, not sure what was the reason for returning it.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r652389603", "createdAt": "2021-06-16T06:33:57Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +211,66 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public List<String> setParameters(HttpMessage msg, List<AppParameter> appParameters) {\n+        return Arrays.asList(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3NTc4OQ==", "bodyText": "Well, that allows to provide evidence of what was injected for instance. Although for multiple parameters it would be harder to provide a more precise evidence I guess.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665975789", "createdAt": "2021-07-08T08:20:16Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +211,66 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public List<String> setParameters(HttpMessage msg, List<AppParameter> appParameters) {\n+        return Arrays.asList(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjM4OTYwMw=="}, "originalCommit": {"oid": "afc56e5d0bf6686b03875a21ada748457867133d"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTcxMzkwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParamValueType.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODowOToyOFrOJ7HeEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzoyNzoyMFrOJ7VILw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk2ODE0Nw==", "bodyText": "Better move to AppParameter, this also applies to the name not just the value.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665968147", "createdAt": "2021-07-08T08:09:28Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParamValueType.java", "diffHunk": "@@ -0,0 +1,13 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParamValueType} represents the type of AppParameter's value. This is useful for the\n+ * use-cases like say there is a parameter which is a URL then caller can itself encode/escape it so\n+ * that it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public enum AppParamValueType {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4MzgxMg==", "bodyText": "ok, with the comment this also applies to name, you are suggesting for javadoc?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666183812", "createdAt": "2021-07-08T13:17:33Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParamValueType.java", "diffHunk": "@@ -0,0 +1,13 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParamValueType} represents the type of AppParameter's value. This is useful for the\n+ * use-cases like say there is a parameter which is a URL then caller can itself encode/escape it so\n+ * that it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public enum AppParamValueType {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk2ODE0Nw=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4ODg1MA==", "bodyText": "Was about the name of the enum (though JavaDoc should be updated accordingly), e.g. PayloadFormat?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666188850", "createdAt": "2021-07-08T13:23:39Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParamValueType.java", "diffHunk": "@@ -0,0 +1,13 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParamValueType} represents the type of AppParameter's value. This is useful for the\n+ * use-cases like say there is a parameter which is a URL then caller can itself encode/escape it so\n+ * that it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public enum AppParamValueType {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk2ODE0Nw=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5MTkxOQ==", "bodyText": "ok", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666191919", "createdAt": "2021-07-08T13:27:20Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParamValueType.java", "diffHunk": "@@ -0,0 +1,13 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParamValueType} represents the type of AppParameter's value. This is useful for the\n+ * use-cases like say there is a parameter which is a URL then caller can itself encode/escape it so\n+ * that it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public enum AppParamValueType {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk2ODE0Nw=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTcyNDc0OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxMTo0OFrOJ7Hkpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxMTo0OFrOJ7Hkpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk2OTgzMQ==", "bodyText": "AppParameter is misleading, not just about the target app. InputVector would be closer to what it is.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665969831", "createdAt": "2021-07-08T08:11:48Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTcyNTk4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxMjowM1rOJ7HlXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzozNzo0NFrOJ7Vriw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDAxMg==", "bodyText": "I'm not sure this needs to be passed around, the variants will have them already (this just needs to provide the position).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665970012", "createdAt": "2021-07-08T08:12:03Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4OTcwOQ==", "bodyText": "shouldn't we align with the existing APIs because for a single call we are passing NameValuePair? Also, I think there is no need for the caller to know these internal things?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666189709", "createdAt": "2021-07-08T13:24:40Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDAxMg=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5NjgxNA==", "bodyText": "The only user of the constructor is the builder and the consumers are the variants, for the builder it doesn't matter if it passes the position or the whole NameValuePair, the variants just need to know about the position.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666196814", "createdAt": "2021-07-08T13:32:50Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDAxMg=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjIwMDk3MQ==", "bodyText": "hmm right, i think same reason like getName api.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666200971", "createdAt": "2021-07-08T13:37:44Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDAxMg=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTcyNjMxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxMjowNlrOJ7HljQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzoyODo0NlrOJ7VNRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDA2MQ==", "bodyText": "getName()", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665970061", "createdAt": "2021-07-08T08:12:06Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            AppParamValueType appParamValueType) {\n+        this.nameValuePair = nameValuePair;\n+        this.param = param;\n+        this.value = value;\n+        this.appParamValueType = appParamValueType;\n+    }\n+\n+    public NameValuePair getNameValuePair() {\n+        return nameValuePair;\n+    }\n+\n+    public String getParam() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4NTA5NQ==", "bodyText": "I think that these method names should align with earlier Api's parameter names. Else it will confuse users. WDYT?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666185095", "createdAt": "2021-07-08T13:19:11Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            AppParamValueType appParamValueType) {\n+        this.nameValuePair = nameValuePair;\n+        this.param = param;\n+        this.value = value;\n+        this.appParamValueType = appParamValueType;\n+    }\n+\n+    public NameValuePair getNameValuePair() {\n+        return nameValuePair;\n+    }\n+\n+    public String getParam() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDA2MQ=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5MTY2OA==", "bodyText": "The main consumers of this API would be the variants, which know about the name (NameValuePair#getName()).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666191668", "createdAt": "2021-07-08T13:27:03Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            AppParamValueType appParamValueType) {\n+        this.nameValuePair = nameValuePair;\n+        this.param = param;\n+        this.value = value;\n+        this.appParamValueType = appParamValueType;\n+    }\n+\n+    public NameValuePair getNameValuePair() {\n+        return nameValuePair;\n+    }\n+\n+    public String getParam() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDA2MQ=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5MzIyMg==", "bodyText": "hmm right as a consumer will be using the builder. Make sense.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666193222", "createdAt": "2021-07-08T13:28:46Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParameter.java", "diffHunk": "@@ -0,0 +1,41 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+/**\n+ * {@code AppParameter} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParameter {\n+    private NameValuePair nameValuePair;\n+    private String param;\n+    private String value;\n+    private AppParamValueType appParamValueType;\n+\n+    AppParameter(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            AppParamValueType appParamValueType) {\n+        this.nameValuePair = nameValuePair;\n+        this.param = param;\n+        this.value = value;\n+        this.appParamValueType = appParamValueType;\n+    }\n+\n+    public NameValuePair getNameValuePair() {\n+        return nameValuePair;\n+    }\n+\n+    public String getParam() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDA2MQ=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTczMDY4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxMzoxMVrOJ7HoUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzozNToyNlrOJ7VjxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDc2OA==", "bodyText": "It should be possible to set the name/value separately.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665970768", "createdAt": "2021-07-08T08:13:11Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4NzExMw==", "bodyText": "Didn't get you, Can you please explain more?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666187113", "createdAt": "2021-07-08T13:21:38Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDc2OA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5MjkxNg==", "bodyText": "The name can be an input vector as well and should be possible to change it without changing the value.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666192916", "createdAt": "2021-07-08T13:28:27Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDc2OA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5NTE2OA==", "bodyText": "ok, so you are suggesting the addition of one more method with just name. Right?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666195168", "createdAt": "2021-07-08T13:30:52Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDc2OA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE5ODk4MQ==", "bodyText": "Yeah, one method for the value and another for the name (I guess we could still provide this one for the cases both name/value are changed).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666198981", "createdAt": "2021-07-08T13:35:26Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AppParametersBuilder.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.parosproxy.paros.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+/**\n+ * {@code AppParametersBuilder} provides an easy way to build {@code AppParameters} and validates\n+ * the provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class AppParametersBuilder {\n+\n+    private List<AppParameter> appParameters = new ArrayList<>();\n+    private Set<Integer> nameValuePairPositions = new HashSet<>();\n+    private final Logger logger = LogManager.getLogger(this.getClass());\n+\n+    public AppParametersBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MDc2OA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTczNDM0OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/MultipartFormParameter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxNDowMlrOJ7Hqlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzowNzo1NlrOJ7UJ-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MTM1MA==", "bodyText": "The changes to this class should be reverted, the variant should adjust the position based on the data injected.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665971350", "createdAt": "2021-07-08T08:14:02Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/MultipartFormParameter.java", "diffHunk": "@@ -44,6 +44,16 @@ public MultipartFormParameter(\n         this.type = type;\n     }\n \n+    public MultipartFormParameter(MultipartFormParameter multipartFormParameter) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE3NTk5NQ==", "bodyText": "yeah sure.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666175995", "createdAt": "2021-07-08T13:07:56Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/MultipartFormParameter.java", "diffHunk": "@@ -44,6 +44,16 @@ public MultipartFormParameter(\n         this.type = type;\n     }\n \n+    public MultipartFormParameter(MultipartFormParameter multipartFormParameter) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MTM1MA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTczNjMyOnYy", "diffSide": "RIGHT", "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxNDoyN1rOJ7Hrxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoxNDoyN1rOJ7Hrxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3MTY1NQ==", "bodyText": "Remove the public modifiers.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665971655", "createdAt": "2021-07-08T08:14:27Z", "author": {"login": "thc202"}, "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "diffHunk": "@@ -228,7 +228,293 @@ void shouldInjectParamValueModificationInFileNameParam() {\n     }\n \n     @Test\n-    void shouldInjectParamValueModificationInFileContentTypeParam() {\n+    public void shouldInjectSmallerParamValueModificationInFileNameParam() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDIzMTc4NDMzOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQwODoyNDo0OFrOJ7IJjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0wOFQxMzoxNzoxOVrOJ7UnpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3OTI3OA==", "bodyText": "Should also provide a method that returns the builder and both methods should mention each other, to make it clear how the API is supposed to be used.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r665979278", "createdAt": "2021-07-08T08:24:48Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "diffHunk": "@@ -218,4 +219,15 @@ protected String setParameter(HttpMessage message, String param, String value) {\n     protected String setEscapedParameter(HttpMessage message, String param, String value) {\n         return variant.setEscapedParameter(message, originalPair, param, value);\n     }\n+\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of the parameters\n+     * @return the parameter values which are added to the HttpMesage\n+     */\n+    protected List<String> setParameters(HttpMessage message, List<AppParameter> appParams) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4MjIwMg==", "bodyText": "ok, mention meaning java doc mention?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666182202", "createdAt": "2021-07-08T13:15:40Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "diffHunk": "@@ -218,4 +219,15 @@ protected String setParameter(HttpMessage message, String param, String value) {\n     protected String setEscapedParameter(HttpMessage message, String param, String value) {\n         return variant.setEscapedParameter(message, originalPair, param, value);\n     }\n+\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of the parameters\n+     * @return the parameter values which are added to the HttpMesage\n+     */\n+    protected List<String> setParameters(HttpMessage message, List<AppParameter> appParams) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3OTI3OA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjE4MzU4OQ==", "bodyText": "Right.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r666183589", "createdAt": "2021-07-08T13:17:19Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "diffHunk": "@@ -218,4 +219,15 @@ protected String setParameter(HttpMessage message, String param, String value) {\n     protected String setEscapedParameter(HttpMessage message, String param, String value) {\n         return variant.setEscapedParameter(message, originalPair, param, value);\n     }\n+\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of the parameters\n+     * @return the parameter values which are added to the HttpMesage\n+     */\n+    protected List<String> setParameters(HttpMessage message, List<AppParameter> appParams) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTk3OTI3OA=="}, "originalCommit": {"oid": "40c38694d5ec0e2cd63bbb69cc7acc9772bc9998"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTE4Mzk3OnYy", "diffSide": "RIGHT", "path": "zap/zap.gradle.kts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODozNTo1NVrOJ9lAFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMTozNDo0OFrOJ9s4LA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU0OTE0MA==", "bodyText": "Please, suppress the incompatibility instead.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668549140", "createdAt": "2021-07-13T08:35:55Z", "author": {"login": "thc202"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -163,6 +164,7 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n         reportName = \"japi.html\"\n         isAddDefaultRules = true\n         addRule(JApiChangeStatus.MODIFIED, AcceptMethodAbstractNowDefaultRule::class.java)\n+        addRule(JApiChangeStatus.MODIFIED, AcceptMethodNewDefaultRule::class.java)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODYyNjEyNg==", "bodyText": "didn't get you, can you please elaborate?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668626126", "createdAt": "2021-07-13T10:14:30Z", "author": {"login": "preetkaran20"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -163,6 +164,7 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n         reportName = \"japi.html\"\n         isAddDefaultRules = true\n         addRule(JApiChangeStatus.MODIFIED, AcceptMethodAbstractNowDefaultRule::class.java)\n+        addRule(JApiChangeStatus.MODIFIED, AcceptMethodNewDefaultRule::class.java)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU0OTE0MA=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODY3ODE4OA==", "bodyText": "got it, please review now.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668678188", "createdAt": "2021-07-13T11:34:48Z", "author": {"login": "preetkaran20"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -163,6 +164,7 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n         reportName = \"japi.html\"\n         isAddDefaultRules = true\n         addRule(JApiChangeStatus.MODIFIED, AcceptMethodAbstractNowDefaultRule::class.java)\n+        addRule(JApiChangeStatus.MODIFIED, AcceptMethodNewDefaultRule::class.java)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU0OTE0MA=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTE5Njk3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODozODoyOFrOJ9lIQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQxMTowMzo0NVrOKAESDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ==", "bodyText": "It just needs to keep the offset and sum to existing positions. No need to copy the parameters again.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668551235", "createdAt": "2021-07-13T08:38:28Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODYyNzkxMw==", "bodyText": "in the for loop? actually, the setter changes are reverted because of earlier review comments. Hence i cannot set the values inside the multipartformparameter hence need to create a new instance with newer values.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668627913", "createdAt": "2021-07-13T10:17:06Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODY1MTQyOQ==", "bodyText": "can you please elaborate?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668651429", "createdAt": "2021-07-13T10:52:37Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc2OTExNg==", "bodyText": "Calculate the difference of the values injected to the ones already present then you can just offset (i.e. sum) the start/end of the following parameters when replacing.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668769116", "createdAt": "2021-07-13T13:34:37Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwNDYyNw==", "bodyText": "but to do that we don't have setters, we need to create again the object.\nI think we should add the setters as that will make it easier to modify the values.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668804627", "createdAt": "2021-07-13T14:13:27Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg1NDI2NA==", "bodyText": "@thc202 can you please help with this.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668854264", "createdAt": "2021-07-13T15:04:52Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg2ODU3OQ==", "bodyText": "are you suggesting to add a Map of position vs offset? in the start i will have offset as 0 then once i start modifying, i find the offset in the map and then while replacing use the offset.\ncannot we create a setter with package private visibility?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668868579", "createdAt": "2021-07-13T15:20:02Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg4NTgwMQ==", "bodyText": "I tried map thing and it is making the logic complex. we can easily do this with setters. @thc202", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668885801", "createdAt": "2021-07-13T15:39:39Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkyNTM4MA==", "bodyText": "It just needs an int for the offset, I'll get to you later.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668925380", "createdAt": "2021-07-13T16:27:11Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTQ4MzkzMw==", "bodyText": "This will need #6690.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669483933", "createdAt": "2021-07-14T10:21:07Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY0NzMyMQ==", "bodyText": "With the changes in place this can now be:\n-        List<MultipartFormParameter> multiPartParamsClone =\n-                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        int offset = 0;\n         for (int index = 0; index < nameValuePairPositions.size(); index++) {\n             int originalPosition = nameValuePairPositions.get(index);\n             String value = values.get(index);\n             int idx = originalPosition - 1;\n \n-            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            MultipartFormParameter mpPart = multiPartParams.get(idx);\n             if (LOGGER.isDebugEnabled()) {\n                 LOGGER.debug(\n                         \"i: \"\n@@ -268,34 +269,8 @@ public class VariantMultipartFormParameters implements Variant {\n                                 + \" E: \"\n                                 + mpPart.getEnd());\n             }\n-            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n-            int originalStart = mpPart.getStart();\n-            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n-            mpPart =\n-                    new MultipartFormParameter(\n-                            mpPart.getName(),\n-                            mpPart.getValue(),\n-                            originalStart,\n-                            mpPart.getEnd() + offset,\n-                            mpPart.getPosition(),\n-                            mpPart.getType());\n-            multiPartParamsClone.set(idx, mpPart);\n-            // As we have updated one value and this can impact other multipart params\n-            // Hence this logic is to update the other multipart params\n-            for (idx = 0; idx < multiPartParamsClone.size(); idx++) {\n-                mpPart = multiPartParamsClone.get(idx);\n-                if (mpPart.getStart() > originalStart) {\n-                    mpPart =\n-                            new MultipartFormParameter(\n-                                    mpPart.getName(),\n-                                    mpPart.getValue(),\n-                                    mpPart.getStart() + offset,\n-                                    mpPart.getEnd() + offset,\n-                                    mpPart.getPosition(),\n-                                    mpPart.getType());\n-                    multiPartParamsClone.set(idx, mpPart);\n-                }\n-            }\n+            newBodyBuilder.replace(mpPart.getStart() + offset, mpPart.getEnd() + offset, value);\n+            offset += value.length() - (mpPart.getEnd() - mpPart.getStart());", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669647321", "createdAt": "2021-07-14T14:05:25Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MDE1Nw==", "bodyText": "Note that some tests will need to update the position of the NameValuePairs.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669650157", "createdAt": "2021-07-14T14:08:40Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTA2MDAxNg==", "bodyText": "This one was not addressed yet.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671060016", "createdAt": "2021-07-16T08:21:28Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTEzOTY0NQ==", "bodyText": "Oh missed your comment. Will address", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671139645", "createdAt": "2021-07-16T10:27:51Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTE1ODc5OQ==", "bodyText": "I think this code is working because of sorting by position. Actually, I didn't do this earlier and used ArrayList to store the offset because of the unordering thing.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671158799", "createdAt": "2021-07-16T11:03:45Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,78 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };\n \n+    private String setParameter(\n+            HttpMessage msg, List<Integer> nameValuePairPositions, List<String> values) {\n         StringBuilder newBodyBuilder = new StringBuilder(msg.getRequestBody().toString());\n-        int idx = originalPair.getPosition() - 1;\n-        MultipartFormParameter mpPart = multiPartParams.get(idx);\n-        if (LOGGER.isDebugEnabled()) {\n-            LOGGER.debug(\n-                    \"i: \"\n-                            + idx\n-                            + \" pos: \"\n-                            + originalPair.getPosition()\n-                            + \" S: \"\n-                            + mpPart.getStart()\n-                            + \" E: \"\n-                            + mpPart.getEnd());\n-        }\n-        newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+        List<MultipartFormParameter> multiPartParamsClone =\n+                new ArrayList<MultipartFormParameter>(this.multiPartParams);\n+        for (int index = 0; index < nameValuePairPositions.size(); index++) {\n+            int originalPosition = nameValuePairPositions.get(index);\n+            String value = values.get(index);\n+            int idx = originalPosition - 1;\n \n+            MultipartFormParameter mpPart = multiPartParamsClone.get(idx);\n+            if (LOGGER.isDebugEnabled()) {\n+                LOGGER.debug(\n+                        \"i: \"\n+                                + idx\n+                                + \" pos: \"\n+                                + originalPosition\n+                                + \" S: \"\n+                                + mpPart.getStart()\n+                                + \" E: \"\n+                                + mpPart.getEnd());\n+            }\n+            newBodyBuilder.replace(mpPart.getStart(), mpPart.getEnd(), value);\n+            int originalStart = mpPart.getStart();\n+            int offset = value.length() - mpPart.getEnd() + mpPart.getStart();\n+            mpPart =\n+                    new MultipartFormParameter(\n+                            mpPart.getName(),\n+                            mpPart.getValue(),\n+                            originalStart,\n+                            mpPart.getEnd() + offset,\n+                            mpPart.getPosition(),\n+                            mpPart.getType());\n+            multiPartParamsClone.set(idx, mpPart);\n+            // As we have updated one value and this can impact other multipart params\n+            // Hence this logic is to update the other multipart params", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTIzNQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTE5OTE2OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODozOTowMFrOJ9lJtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODozOTowMFrOJ9lJtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MTYwNw==", "bodyText": "final", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668551607", "createdAt": "2021-07-13T08:39:00Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+    private int position;\n+    private String name;\n+    private String value;\n+    private PayloadFormat payloadFormat;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIwNjY0OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MDoxN1rOJ9lOOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MDoxN1rOJ9lOOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1Mjc2MA==", "bodyText": "represents the format of the payload.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668552760", "createdAt": "2021-07-13T08:40:17Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+    private int position;\n+    private String name;\n+    private String value;\n+    private PayloadFormat payloadFormat;\n+\n+    InputVector(int position, String name, String value, PayloadFormat payloadFormat) {\n+        this.position = position;\n+        this.name = name;\n+        this.value = value;\n+        this.payloadFormat = payloadFormat;\n+    }\n+\n+    public int getPosition() {\n+        return position;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+\n+    public String getValue() {\n+        return value;\n+    }\n+\n+    public PayloadFormat getPayloadFormat() {\n+        return payloadFormat;\n+    }\n+\n+    /**\n+     * {@code PayloadFormat} represents the type of InputVectors's name and value. This is useful", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIwOTIxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MDo0OFrOJ9lP0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMDoyNzo0NVrOJ9qQYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MzE2OQ==", "bodyText": "Remove static.\nNormally this would be declared above, before the instance variables.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668553169", "createdAt": "2021-07-13T08:40:48Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+    private int position;\n+    private String name;\n+    private String value;\n+    private PayloadFormat payloadFormat;\n+\n+    InputVector(int position, String name, String value, PayloadFormat payloadFormat) {\n+        this.position = position;\n+        this.name = name;\n+        this.value = value;\n+        this.payloadFormat = payloadFormat;\n+    }\n+\n+    public int getPosition() {\n+        return position;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+\n+    public String getValue() {\n+        return value;\n+    }\n+\n+    public PayloadFormat getPayloadFormat() {\n+        return payloadFormat;\n+    }\n+\n+    /**\n+     * {@code PayloadFormat} represents the type of InputVectors's name and value. This is useful\n+     * for the use-cases like say there is a parameter which is a URL then caller can itself\n+     * encode/escape it so that it can be directly used to modify {@code HttpMessage} or {@code\n+     * Variant} has to escape it.\n+     */\n+    public static enum PayloadFormat {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODYzNTIzNA==", "bodyText": "thanks for mentioning this. I was unaware that the nested enums are imlicitly static.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668635234", "createdAt": "2021-07-13T10:27:45Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+    private int position;\n+    private String name;\n+    private String value;\n+    private PayloadFormat payloadFormat;\n+\n+    InputVector(int position, String name, String value, PayloadFormat payloadFormat) {\n+        this.position = position;\n+        this.name = name;\n+        this.value = value;\n+        this.payloadFormat = payloadFormat;\n+    }\n+\n+    public int getPosition() {\n+        return position;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+\n+    public String getValue() {\n+        return value;\n+    }\n+\n+    public PayloadFormat getPayloadFormat() {\n+        return payloadFormat;\n+    }\n+\n+    /**\n+     * {@code PayloadFormat} represents the type of InputVectors's name and value. This is useful\n+     * for the use-cases like say there is a parameter which is a URL then caller can itself\n+     * encode/escape it so that it can be directly used to modify {@code HttpMessage} or {@code\n+     * Variant} has to escape it.\n+     */\n+    public static enum PayloadFormat {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MzE2OQ=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIxMTcxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MToxOVrOJ9lRUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MToxOVrOJ9lRUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MzU1NQ==", "bodyText": "setNameAndValue", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668553555", "createdAt": "2021-07-13T08:41:19Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIxMTg4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MToyMVrOJ9lRag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MToyMVrOJ9lRag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MzU3OA==", "bodyText": "setValue", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668553578", "createdAt": "2021-07-13T08:41:21Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, PayloadFormat payloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(nameValuePair.getPosition(), param, value, payloadFormat));\n+        return this;\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutParam(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIxMjgzOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MTozMlrOJ9lR9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MTozMlrOJ9lR9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1MzcxNw==", "bodyText": "setName", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668553717", "createdAt": "2021-07-13T08:41:32Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, PayloadFormat payloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(nameValuePair.getPosition(), param, value, payloadFormat));\n+        return this;\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutParam(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.addAppParameter(nameValuePair, null, value, payloadFormat);\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutValue(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIyMDIyOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MzowMFrOJ9lWfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0MzowMFrOJ9lWfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1NDg3OQ==", "bodyText": "null has special meaning (e.g. remove the IV), it should use the original values of the NameValuePair.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668554879", "createdAt": "2021-07-13T08:43:00Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, PayloadFormat payloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(nameValuePair.getPosition(), param, value, payloadFormat));\n+        return this;\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutParam(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.addAppParameter(nameValuePair, null, value, payloadFormat);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIyNjM1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0NDoxMlrOJ9laPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMDoyODozN1rOJ9qStQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1NTgzOA==", "bodyText": "If it's creating a new list it does not need to return an unmodifiable one.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668555838", "createdAt": "2021-07-13T08:44:12Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, PayloadFormat payloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(nameValuePair.getPosition(), param, value, payloadFormat));\n+        return this;\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutParam(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.addAppParameter(nameValuePair, null, value, payloadFormat);\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutValue(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.addAppParameter(nameValuePair, param, null, payloadFormat);\n+    }\n+\n+    public List<InputVector> build() {\n+        return Collections.unmodifiableList(new ArrayList<>(inputVectorsMap.values()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODYzNTgyOQ==", "bodyText": "yeah .... should not have done this mistake. thanks", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668635829", "createdAt": "2021-07-13T10:28:37Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(\n+            NameValuePair nameValuePair, String param, String value, PayloadFormat payloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(nameValuePair.getPosition(), param, value, payloadFormat));\n+        return this;\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutParam(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.addAppParameter(nameValuePair, null, value, payloadFormat);\n+    }\n+\n+    public InputVectorBuilder addAppParameterWithoutValue(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.addAppParameter(nameValuePair, param, null, payloadFormat);\n+    }\n+\n+    public List<InputVector> build() {\n+        return Collections.unmodifiableList(new ArrayList<>(inputVectorsMap.values()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1NTgzOA=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTIzMjE1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0NToxOVrOJ9ld0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo0NToxOVrOJ9ld0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU1Njc1NA==", "bodyText": "Add a see to the other method.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668556754", "createdAt": "2021-07-13T08:45:19Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "diffHunk": "@@ -218,4 +221,20 @@ protected String setParameter(HttpMessage message, String param, String value) {\n     protected String setEscapedParameter(HttpMessage message, String param, String value) {\n         return variant.setEscapedParameter(message, originalPair, param, value);\n     }\n+\n+    /** @return {@code InputVectorBuilder} which is used to build the {@code InputVector} */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTI4ODUxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo1NTo1N1rOJ9l_bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMDozNzo1OVrOJ9qqDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU2NTM1OA==", "bodyText": "It needs to have the format for name and value, since they can be set raw/escaped separately.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668565358", "createdAt": "2021-07-13T08:55:57Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+    private int position;\n+    private String name;\n+    private String value;\n+    private PayloadFormat payloadFormat;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODY0MTgwNA==", "bodyText": "so are you suggesting to have 2 payloadformat parameters?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668641804", "createdAt": "2021-07-13T10:37:59Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+    private int position;\n+    private String name;\n+    private String value;\n+    private PayloadFormat payloadFormat;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU2NTM1OA=="}, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI0OTI5OTM2OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo1ODowNFrOJ9mGBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QwODo1ODowNFrOJ9mGBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODU2NzA0NA==", "bodyText": "Worth noting/doc the caveat that calling these methods replaces the IV (so previous changes are lost).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668567044", "createdAt": "2021-07-13T08:58:04Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    public InputVectorBuilder addAppParameter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e9018130d9a1dff22ecf4fd7de1f00c76b947a"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY1MTAxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0MDozNVrOJ9yvpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0MDozNVrOJ9yvpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NDMwOQ==", "bodyText": "Since you added a link the see is not needed.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668774309", "createdAt": "2021-07-13T13:40:35Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "diffHunk": "@@ -218,4 +221,24 @@ protected String setParameter(HttpMessage message, String param, String value) {\n     protected String setEscapedParameter(HttpMessage message, String param, String value) {\n         return variant.setEscapedParameter(message, originalPair, param, value);\n     }\n+\n+    /**\n+     * @return {@code InputVectorBuilder} which is used to build the {@code InputVector} which is\n+     *     used by {@link #setParameters(HttpMessage, List)}\n+     * @see #setParameters(HttpMessage, List)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY1NjA3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0MTozMFrOJ9yysQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNDoyMzoxNFrOJ91Lmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NTA4OQ==", "bodyText": "Add since tag, same for the new methods in the implementation.\nappParams needs to be renamed.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668775089", "createdAt": "2021-07-13T13:41:30Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,14 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> appParams) {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc5OTczNQ==", "bodyText": "but every other method is set*.  Also why addParams not addParameters when we have named them parameters in other method.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668799735", "createdAt": "2021-07-13T14:08:31Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,14 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> appParams) {};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NTA4OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwMDYzNw==", "bodyText": "will add since tag", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668800637", "createdAt": "2021-07-13T14:09:25Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,14 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> appParams) {};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NTA4OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwMTIzMg==", "bodyText": "Sorry, is that referring to which comment?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668801232", "createdAt": "2021-07-13T14:10:01Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,14 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> appParams) {};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NTA4OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwMzQ1MA==", "bodyText": "Ok, I see the edit, as mentioned earlier they might not be \"app\" parameters. (I'm talking about the name of the method parameter not the method itself.)", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668803450", "createdAt": "2021-07-13T14:12:17Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,14 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> appParams) {};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NTA4OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgxNDIzNA==", "bodyText": "oh sorry for the confusion.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668814234", "createdAt": "2021-07-13T14:23:14Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,14 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param appParams list of name of the parameter\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> appParams) {};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NTA4OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY2MjYwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0Mjo0M1rOJ9y2uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQxMDo0NzoyMFrOKADwvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NjEyMA==", "bodyText": "Move up to keep it closer to the variable that it applies to (same in other places, e.g. parameters).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668776120", "createdAt": "2021-07-13T13:42:43Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+\n+    /**\n+     * {@code PayloadFormat} represents the format of the payload. This is useful for the use-cases\n+     * like say there is a parameter which is a URL then caller can itself encode/escape it so that\n+     * it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+     */\n+    public enum PayloadFormat {\n+        REQUIRES_ESCAPING,\n+        ALREADY_ESCAPED\n+    }\n+\n+    private final int position;\n+    private final String name;\n+    private final String value;\n+    private final PayloadFormat namePayloadFormat;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwNTE3Mg==", "bodyText": "oh ok", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668805172", "createdAt": "2021-07-13T14:14:02Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+\n+    /**\n+     * {@code PayloadFormat} represents the format of the payload. This is useful for the use-cases\n+     * like say there is a parameter which is a URL then caller can itself encode/escape it so that\n+     * it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+     */\n+    public enum PayloadFormat {\n+        REQUIRES_ESCAPING,\n+        ALREADY_ESCAPED\n+    }\n+\n+    private final int position;\n+    private final String name;\n+    private final String value;\n+    private final PayloadFormat namePayloadFormat;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NjEyMA=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTA1ODkxOQ==", "bodyText": "Parameters and methods should be updated accordingly for consistency.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671058919", "createdAt": "2021-07-16T08:19:51Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+\n+    /**\n+     * {@code PayloadFormat} represents the format of the payload. This is useful for the use-cases\n+     * like say there is a parameter which is a URL then caller can itself encode/escape it so that\n+     * it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+     */\n+    public enum PayloadFormat {\n+        REQUIRES_ESCAPING,\n+        ALREADY_ESCAPED\n+    }\n+\n+    private final int position;\n+    private final String name;\n+    private final String value;\n+    private final PayloadFormat namePayloadFormat;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NjEyMA=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTE1MDI2OA==", "bodyText": "sure", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671150268", "createdAt": "2021-07-16T10:47:20Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVector.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+/**\n+ * {@code InputVector} class wraps the parameters which are used to modify the {@code HttpMessage}.\n+ * It is specifically used for updating multiple parameters of {@code HttpMessage}\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVector {\n+\n+    /**\n+     * {@code PayloadFormat} represents the format of the payload. This is useful for the use-cases\n+     * like say there is a parameter which is a URL then caller can itself encode/escape it so that\n+     * it can be directly used to modify {@code HttpMessage} or {@code Variant} has to escape it.\n+     */\n+    public enum PayloadFormat {\n+        REQUIRES_ESCAPING,\n+        ALREADY_ESCAPED\n+    }\n+\n+    private final int position;\n+    private final String name;\n+    private final String value;\n+    private final PayloadFormat namePayloadFormat;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NjEyMA=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY2NzM3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0MzozM1rOJ9y5sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNDo1MzoyNlrOJ929Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3Njg4Mw==", "bodyText": "This applies to all three methods.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668776883", "createdAt": "2021-07-13T13:43:33Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwNTU4NA==", "bodyText": "already added in all three.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668805584", "createdAt": "2021-07-13T14:14:29Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3Njg4Mw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg0MzM0Nw==", "bodyText": "I meant it should be this description for all three, in all cases the name/value is replaced.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668843347", "createdAt": "2021-07-13T14:53:26Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3Njg4Mw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY3MDA3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0NDowMVrOJ9y7UA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNDo1Mzo0NVrOJ92-mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NzI5Ng==", "bodyText": "payloadFormat", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668777296", "createdAt": "2021-07-13T13:44:01Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier value with the\n+     * newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat valuePayloadFormat) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwNTkxNg==", "bodyText": "ok will change the variable name", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668805916", "createdAt": "2021-07-13T14:14:49Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier value with the\n+     * newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat valuePayloadFormat) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NzI5Ng=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg0MzY3NA==", "bodyText": "Same for the name method.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668843674", "createdAt": "2021-07-13T14:53:45Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier value with the\n+     * newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat valuePayloadFormat) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3NzI5Ng=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY3NTIxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0NTowM1rOJ9y-ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNDo1NDo0MlrOJ93CNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODE3OQ==", "bodyText": "This needs to be reviewed, I think some of the variants create the NameValuePairs with unescaped name/value.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668778179", "createdAt": "2021-07-13T13:45:03Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier value with the\n+     * newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat valuePayloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgwNjg4OA==", "bodyText": "Does it matters? I think we can go with AlreadyEscaped parameter as default as this Api is not used till now.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668806888", "createdAt": "2021-07-13T14:15:47Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier value with the\n+     * newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat valuePayloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODE3OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg0NDU5OQ==", "bodyText": "It does because it might change the meaning of the name/value, but not a \"blocker\" (we can tweak as needed later).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668844599", "createdAt": "2021-07-13T14:54:42Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier value with the\n+     * newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat valuePayloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODE3OQ=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MDY3NzY0OnYy", "diffSide": "RIGHT", "path": "zap/zap.gradle.kts", "isResolved": false, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxMzo0NTozMVrOJ9zARw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNTo0NjoxM1rOJ955Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw==", "bodyText": "I'd expect this to be in the method excludes.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668778567", "createdAt": "2021-07-13T13:45:31Z", "author": {"login": "thc202"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODgzMjQzMQ==", "bodyText": "I am not able to exclude this method with following string: org.parosproxy.paros.core.scanner.Variant#setParameters(org.parosproxy.paros.network.HttpMessage,java.util.List)\ncan you please help with this?", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668832431", "createdAt": "2021-07-13T14:42:08Z", "author": {"login": "preetkaran20"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg0OTcxNA==", "bodyText": "got it.please ignore.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668849714", "createdAt": "2021-07-13T14:59:56Z", "author": {"login": "preetkaran20"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg2NDY0OQ==", "bodyText": "There's a classpath issue that prevents the check from working when added to the method excludes, add just the class. Not worth keeping this waiting for that.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668864649", "createdAt": "2021-07-13T15:15:46Z", "author": {"login": "thc202"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg2OTc0Mg==", "bodyText": "I fixed it for now.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668869742", "createdAt": "2021-07-13T15:21:19Z", "author": {"login": "preetkaran20"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg4Mzk0Nw==", "bodyText": "It's preferable not to add that in this PR, it might break other plugins.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668883947", "createdAt": "2021-07-13T15:37:28Z", "author": {"login": "thc202"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODg5MTQzNQ==", "bodyText": "oh ... ok", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668891435", "createdAt": "2021-07-13T15:46:13Z", "author": {"login": "preetkaran20"}, "path": "zap/zap.gradle.kts", "diffHunk": "@@ -154,7 +154,8 @@ val japicmp by tasks.registering(JapicmpTask::class) {\n     fieldExcludes = listOf()\n \n     classExcludes = listOf(\n-        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\")\n+        \"org.zaproxy.zap.extension.custompages.ContextCustomPagePanel\\$CustomPagesMultipleOptionsPanel\",\n+        \"org.parosproxy.paros.core.scanner.Variant#setParameters(HttpMessage, List)\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODc3ODU2Nw=="}, "originalCommit": {"oid": "f53102591d4f2424086c45c897ff1e858f7b8657"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MTQ1Mjc3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNTo1NjoyM1rOJ96bjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNTo1OTowMFrOJ96j1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkwMDIzNg==", "bodyText": "Can be 2.11.0, the methods added in AbstractAppParamPlugin should have the tag as well. Also worth adding to the new classes.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668900236", "createdAt": "2021-07-13T15:56:23Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,15 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since TODO add version\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> inputVectors) {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07ddd9549712b98929bf2a6e73dadb445321702b"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkwMjM1OQ==", "bodyText": "ok", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668902359", "createdAt": "2021-07-13T15:59:00Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,15 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since TODO add version\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> inputVectors) {};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkwMDIzNg=="}, "originalCommit": {"oid": "07ddd9549712b98929bf2a6e73dadb445321702b"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1MTYxMjA1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNjoyNjo0M1rOJ978Sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xM1QxNjoyODo1MlrOJ98DEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkyNTAwMg==", "bodyText": "Needs update.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668925002", "createdAt": "2021-07-13T16:26:43Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,85 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param msg the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since TODO add version", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5b0abf6ba09dad2beee4c861e9ae1b8a42dcf63"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkyNjczNg==", "bodyText": "done", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r668926736", "createdAt": "2021-07-13T16:28:52Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,85 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param msg the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since TODO add version", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2ODkyNTAwMg=="}, "originalCommit": {"oid": "e5b0abf6ba09dad2beee4c861e9ae1b8a42dcf63"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1NjM0MTYwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDowOTowNVrOJ-oOiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDowOTowNVrOJ-oOiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MDU3MQ==", "bodyText": "Remove semicolon.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669650571", "createdAt": "2021-07-14T14:09:05Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/Variant.java", "diffHunk": "@@ -47,6 +48,15 @@ public String setParameter(\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String param, String value);\n \n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param message the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since 2.11.0\n+     */\n+    default void setParameters(HttpMessage message, List<InputVector> inputVectors) {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1NjM0NzMxOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDoxMDowMlrOJ-oR0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDoxMDowMlrOJ-oR0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MTQxMQ==", "bodyText": "Use method references here and following.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669651411", "createdAt": "2021-07-14T14:10:02Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,85 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param msg the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since 2.11.0\n+     */\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1NjM0NzU1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDoxMDowNVrOJ-oR-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDoxMDowNVrOJ-oR-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MTQ0OA==", "bodyText": "Remove semicolon.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669651448", "createdAt": "2021-07-14T14:10:05Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -209,33 +212,85 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param msg the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since 2.11.0\n+     */\n+    @Override\n+    public void setParameters(HttpMessage msg, List<InputVector> inputVectors) {\n+        this.setParameter(\n+                msg,\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getPosition())\n+                        .collect(Collectors.toList()),\n+                inputVectors.stream()\n+                        .map(inputVector -> inputVector.getValue())\n+                        .collect(Collectors.toList()));\n+    };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1NjM1ODI1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDoxMjowMFrOJ-oYfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDo1NToyMFrOJ-q24w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MzExOA==", "bodyText": "Better if we return a consistent order, most of the variants would benefit of that, e.g.:\nreturn inputVectorsMap.values().stream().sorted(Comparator.comparingInt(InputVector::getPosition)).collect(Collectors.toList());", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669653118", "createdAt": "2021-07-14T14:12:00Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ * @since 2.11.0\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,\n+                payloadFormat);\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setName(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                param,\n+                nameValuePair.getValue(),\n+                payloadFormat,\n+                PayloadFormat.ALREADY_ESCAPED);\n+    }\n+\n+    public List<InputVector> build() {\n+        return new ArrayList<>(inputVectorsMap.values());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY2NTEyOA==", "bodyText": "as we are using HashMap with key position, hence it becomes somehow consistent order but will do.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669665128", "createdAt": "2021-07-14T14:25:06Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ * @since 2.11.0\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,\n+                payloadFormat);\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setName(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                param,\n+                nameValuePair.getValue(),\n+                payloadFormat,\n+                PayloadFormat.ALREADY_ESCAPED);\n+    }\n+\n+    public List<InputVector> build() {\n+        return new ArrayList<>(inputVectorsMap.values());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MzExOA=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY4MDY5NA==", "bodyText": "done", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669680694", "createdAt": "2021-07-14T14:41:33Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ * @since 2.11.0\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,\n+                payloadFormat);\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setName(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                param,\n+                nameValuePair.getValue(),\n+                payloadFormat,\n+                PayloadFormat.ALREADY_ESCAPED);\n+    }\n+\n+    public List<InputVector> build() {\n+        return new ArrayList<>(inputVectorsMap.values());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MzExOA=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY4OTgxMw==", "bodyText": "HashMap is not a SortedMap though.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669689813", "createdAt": "2021-07-14T14:51:20Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ * @since 2.11.0\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,\n+                payloadFormat);\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setName(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                param,\n+                nameValuePair.getValue(),\n+                payloadFormat,\n+                PayloadFormat.ALREADY_ESCAPED);\n+    }\n+\n+    public List<InputVector> build() {\n+        return new ArrayList<>(inputVectorsMap.values());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MzExOA=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY5MzY2Nw==", "bodyText": "yeah, may be if size is more than 12, then i think hashcode will not give increasing order.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669693667", "createdAt": "2021-07-14T14:55:20Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/zaproxy/zap/core/scanner/InputVectorBuilder.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2021 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.core.scanner;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import org.parosproxy.paros.core.scanner.NameValuePair;\n+import org.zaproxy.zap.core.scanner.InputVector.PayloadFormat;\n+\n+/**\n+ * {@code InputVectorBuilder} provides an easy way to build {@code InputVectors} and validates the\n+ * provided inputs.\n+ *\n+ * @author preetkaran20@gmail.com KSASAN\n+ * @since 2.11.0\n+ */\n+public class InputVectorBuilder {\n+\n+    private Map<Integer, InputVector> inputVectorsMap = new HashMap<>();\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param value\n+     * @param namePayloadFormat\n+     * @param valuePayloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setNameAndValue(\n+            NameValuePair nameValuePair,\n+            String param,\n+            String value,\n+            PayloadFormat namePayloadFormat,\n+            PayloadFormat valuePayloadFormat) {\n+        inputVectorsMap.put(\n+                nameValuePair.getPosition(),\n+                new InputVector(\n+                        nameValuePair.getPosition(),\n+                        param,\n+                        value,\n+                        namePayloadFormat,\n+                        valuePayloadFormat));\n+        return this;\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param value\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setValue(\n+            NameValuePair nameValuePair, String value, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                nameValuePair.getName(),\n+                value,\n+                PayloadFormat.ALREADY_ESCAPED,\n+                payloadFormat);\n+    }\n+\n+    /**\n+     * Note: calling this method with same NameValuePair will overwrite the earlier name and value\n+     * with the newer one.\n+     *\n+     * @param nameValuePair\n+     * @param param\n+     * @param payloadFormat\n+     * @return {@code InputVectorBuilder}\n+     */\n+    public InputVectorBuilder setName(\n+            NameValuePair nameValuePair, String param, PayloadFormat payloadFormat) {\n+        return this.setNameAndValue(\n+                nameValuePair,\n+                param,\n+                nameValuePair.getValue(),\n+                payloadFormat,\n+                PayloadFormat.ALREADY_ESCAPED);\n+    }\n+\n+    public List<InputVector> build() {\n+        return new ArrayList<>(inputVectorsMap.values());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1MzExOA=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 107}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI1NjM2NDYwOnYy", "diffSide": "RIGHT", "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNDoxMzowMlrOJ-ocJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNFQxNjoxMTozOVrOJ-u2ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1NDA1NQ==", "bodyText": "Can be parameterized, it's just testing different values (same for some of the following tests).", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669654055", "createdAt": "2021-07-14T14:13:02Z", "author": {"login": "thc202"}, "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "diffHunk": "@@ -227,6 +229,305 @@ void shouldInjectParamValueModificationInFileNameParam() {\n                 message.getRequestBody().toString(), equalTo(newMsg.getRequestBody().toString()));\n     }\n \n+    @Test\n+    void shouldInjectSmallerParamValueModificationInFileNameParam() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY3MzEzMg==", "bodyText": "yeah", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669673132", "createdAt": "2021-07-14T14:33:39Z", "author": {"login": "preetkaran20"}, "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "diffHunk": "@@ -227,6 +229,305 @@ void shouldInjectParamValueModificationInFileNameParam() {\n                 message.getRequestBody().toString(), equalTo(newMsg.getRequestBody().toString()));\n     }\n \n+    @Test\n+    void shouldInjectSmallerParamValueModificationInFileNameParam() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1NDA1NQ=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY5ODA1NQ==", "bodyText": "I meant JUnit test parameterization (e.g. VariantJSONQueryUnitTest). The tests shouldInjectParamValueMultipleTimesModificationsWith* can also be parameterized.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669698055", "createdAt": "2021-07-14T14:59:52Z", "author": {"login": "thc202"}, "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "diffHunk": "@@ -227,6 +229,305 @@ void shouldInjectParamValueModificationInFileNameParam() {\n                 message.getRequestBody().toString(), equalTo(newMsg.getRequestBody().toString()));\n     }\n \n+    @Test\n+    void shouldInjectSmallerParamValueModificationInFileNameParam() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1NDA1NQ=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTc1OTExNA==", "bodyText": "oh ok. I have done the changes as suggested. Please have a look.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r669759114", "createdAt": "2021-07-14T16:11:39Z", "author": {"login": "preetkaran20"}, "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "diffHunk": "@@ -227,6 +229,305 @@ void shouldInjectParamValueModificationInFileNameParam() {\n                 message.getRequestBody().toString(), equalTo(newMsg.getRequestBody().toString()));\n     }\n \n+    @Test\n+    void shouldInjectSmallerParamValueModificationInFileNameParam() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2OTY1NDA1NQ=="}, "originalCommit": {"oid": "55df57ad9c8af2f8366bca952f25eddeff2f97bd"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI2NTU4MDk5OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQwODozMzoyNlrOJ_-vmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQwODozMzoyNlrOJ_-vmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTA2ODA1Ng==", "bodyText": "Maybe remove this one, is exactly the same as the interface.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671068056", "createdAt": "2021-07-16T08:33:26Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -215,33 +218,61 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n-    private String setParameter(HttpMessage msg, NameValuePair originalPair, String value) {\n+    /**\n+     * Sets the parameters into the given {@code message}.\n+     *\n+     * @param msg the message that will be changed\n+     * @param inputVectors list of name of the parameter\n+     * @since 2.11.0\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2385ec92a1f44c52e03fc91feb9fb3f2c858facb"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI2NTU4MzIwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQwODozMzo1MlrOJ_-w3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQxMDo0NTo0MFrOKADtiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTA2ODM4Mg==", "bodyText": "Could use Collections.singletonList instead.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671068382", "createdAt": "2021-07-16T08:33:52Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -215,33 +218,61 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2385ec92a1f44c52e03fc91feb9fb3f2c858facb"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTE0OTQ1MQ==", "bodyText": "thanks for mentioning it.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671149451", "createdAt": "2021-07-16T10:45:40Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParameters.java", "diffHunk": "@@ -215,33 +218,61 @@ public void setMessage(HttpMessage msg) {\n     @Override\n     public String setParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));\n     }\n \n     @Override\n     public String setEscapedParameter(\n             HttpMessage msg, NameValuePair originalPair, String name, String value) {\n-        return setParameter(msg, originalPair, value);\n+        return setParameter(msg, Arrays.asList(originalPair.getPosition()), Arrays.asList(value));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTA2ODM4Mg=="}, "originalCommit": {"oid": "2385ec92a1f44c52e03fc91feb9fb3f2c858facb"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI2NTU4NTY2OnYy", "diffSide": "RIGHT", "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQwODozNDoyMlrOJ_-yOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xNlQwODozNDoyMlrOJ_-yOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTA2ODczMA==", "bodyText": "Remove Empty.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r671068730", "createdAt": "2021-07-16T08:34:22Z", "author": {"login": "thc202"}, "path": "zap/src/test/java/org/parosproxy/paros/core/scanner/VariantMultipartFormParametersUnitTest.java", "diffHunk": "@@ -206,13 +213,13 @@ void shouldInjectParamValueModificationInFileParam() {\n                 message.getRequestBody().toString(), equalTo(newMsg.getRequestBody().toString()));\n     }\n \n-    @Test\n-    void shouldInjectParamValueModificationInFileNameParam() {\n+    @ParameterizedTest\n+    @ValueSource(strings = {\"injected\", \"inj\", \"injectedFileName\", \"\"})\n+    void shouldInjectEmptyParamValueModificationInFileNameParam(String newValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2385ec92a1f44c52e03fc91feb9fb3f2c858facb"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNDI3Mzk4Nzg3OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xOVQxMjozMToxNVrOKBHIlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNy0xOVQxMjozMToxNVrOKBHIlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MjI1NDEwMA==", "bodyText": "hmm yeah, we didn't need the message. thanks.", "url": "https://github.com/zaproxy/zaproxy/pull/6371#discussion_r672254100", "createdAt": "2021-07-19T12:31:15Z", "author": {"login": "preetkaran20"}, "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractAppParamPlugin.java", "diffHunk": "@@ -97,11 +99,22 @@ public void scan() {\n         }\n     }\n \n-    /** Scan the current message using the current Variant */\n-    private void scanVariant() {\n-        for (int i = 0; i < variant.getParamList().size() && !isStop(); i++) {\n+    /**\n+     * Scans the current message using the list of {@code NameValuePair}s handled by the current\n+     * variant. This method should be overridden for the use-cases of manipulating multiple\n+     * parameters in a {@code HttpMessage}.\n+     *\n+     * <p>By default this method calls {@link #scan(HttpMessage, NameValuePair)} for each {@code\n+     * NameValuePair}.\n+     *\n+     * @param nameValuePairs list of parameters handled by the current variant\n+     * @since 2.11.0\n+     * @see #setParameters(HttpMessage, List)\n+     */\n+    protected void scan(List<NameValuePair> nameValuePairs) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e74ef1f114aa024b155f6fe12272d0838ef3978"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 613, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}