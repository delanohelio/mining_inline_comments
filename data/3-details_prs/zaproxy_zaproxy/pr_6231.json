{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NDAwNzA1", "number": 6231, "title": "#6098: Allowing to pass request headers from a spider parser to the spider task", "bodyText": "Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\nSimplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\nIntroduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer vladislav.dexheimer@sap.com", "createdAt": "2020-10-07T17:17:17Z", "url": "https://github.com/zaproxy/zaproxy/pull/6231", "merged": true, "mergeCommit": {"oid": "c8afeb8a79283430f89063b12f7bc350d50e15d1"}, "closed": true, "closedAt": "2021-09-13T12:22:39Z", "author": {"login": "vladidx"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmwRZQABqjQxMjAxNTQyNjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABe98DG4AFqTc1MjY1MTAwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "679b03e09a325eec7889d9201d411a162f58837f", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/679b03e09a325eec7889d9201d411a162f58837f", "committedDate": "2020-12-16T14:48:55Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "90c4d799b8566e6b35b427fe1645e799ad756717", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/90c4d799b8566e6b35b427fe1645e799ad756717", "committedDate": "2020-12-16T15:00:24Z", "message": "Allowing to add request headers from a spider parser incl. refactoring \u2026\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90c4d799b8566e6b35b427fe1645e799ad756717", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/90c4d799b8566e6b35b427fe1645e799ad756717", "committedDate": "2020-12-16T15:00:24Z", "message": "Allowing to add request headers from a spider parser incl. refactoring \u2026\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "17f7c64e194d20dac4955a52657730f84348ecee", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/17f7c64e194d20dac4955a52657730f84348ecee", "committedDate": "2020-12-16T15:34:53Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "323252d05f57bfbd96a2b179432e1ab937fbea25", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/323252d05f57bfbd96a2b179432e1ab937fbea25", "committedDate": "2020-12-16T15:41:18Z", "message": "Merge branch 'develop' into customer-headers-for-spider"}, "afterCommit": {"oid": "40bf8d868a7fe9f2dd8192443546f3ba1866269e", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/40bf8d868a7fe9f2dd8192443546f3ba1866269e", "committedDate": "2020-12-16T16:18:04Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a34d5ee770848a4590961d4f62d85edeec4867e1", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/a34d5ee770848a4590961d4f62d85edeec4867e1", "committedDate": "2020-12-16T16:21:03Z", "message": "Merge branch 'develop' into customer-headers-for-spider"}, "afterCommit": {"oid": "3e60de713d9b2048d3daeb759c80d24696977a7a", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/3e60de713d9b2048d3daeb759c80d24696977a7a", "committedDate": "2020-12-16T16:22:21Z", "message": "Merge branch 'develop' into customer-headers-for-spider\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e60de713d9b2048d3daeb759c80d24696977a7a", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/3e60de713d9b2048d3daeb759c80d24696977a7a", "committedDate": "2020-12-16T16:22:21Z", "message": "Merge branch 'develop' into customer-headers-for-spider\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "05e937591c470fe95c5b586b9c745cc3bae0a2eb", "author": {"user": {"login": "psiinon", "name": "Simon Bennetts"}}, "url": "https://github.com/zaproxy/zaproxy/commit/05e937591c470fe95c5b586b9c745cc3bae0a2eb", "committedDate": "2020-12-16T15:04:14Z", "message": "Merge pull request #6360 from psiinon/2.10/addons\n\nUpdate for 2.10 add-ons"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef68f307d61409a509f0dd4b77d396606a6ca25e", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/ef68f307d61409a509f0dd4b77d396606a6ca25e", "committedDate": "2020-12-16T17:05:36Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "086fbbadc66f477055f93af3ff216bb12a0633c5", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/086fbbadc66f477055f93af3ff216bb12a0633c5", "committedDate": "2020-12-18T16:00:57Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "086fbbadc66f477055f93af3ff216bb12a0633c5", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/086fbbadc66f477055f93af3ff216bb12a0633c5", "committedDate": "2020-12-18T16:00:57Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/31bed36cbef65f17be031e9e40d109fc778b96ec", "committedDate": "2020-12-18T17:20:27Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Introduction of new unit tests in class\n'SpiderParserAdditionalHeadersUnitTest' which create a custom test\nspider parser + controller (incl. spider) and cover header-related\nhandling in the spider controller\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MzE5MDE1", "url": "https://github.com/zaproxy/zaproxy/pull/6231#pullrequestreview-556319015", "createdAt": "2020-12-21T11:40:58Z", "commit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "state": "COMMENTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQxMTo0MDo1OFrOIJVd2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQxMTo1MTo1NlrOIJVvMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY1OTgwMA==", "bodyText": "Should be reverted.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546659800", "createdAt": "2020-12-21T11:40:58Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderParser.java", "diffHunk": "@@ -40,7 +42,7 @@\n     /**\n      * The Constant log.\n      *\n-     * @deprecated (2.10.0) Use {@link #getLogger()} instead.\n+     * @deprecated (TODO add version) Use {@link #getLogger()} instead.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY1OTgxNw==", "bodyText": "Should be reverted.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546659817", "createdAt": "2020-12-21T11:41:00Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderParser.java", "diffHunk": "@@ -52,7 +54,7 @@\n      * Gets the logger.\n      *\n      * @return the logger, never {@code null}.\n-     * @since 2.10.0\n+     * @since TODO add version", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY1OTg0Mw==", "bodyText": "This should be the only method being added, older methods should be deprecated.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546659843", "createdAt": "2020-12-21T11:41:04Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderParser.java", "diffHunk": "@@ -76,6 +78,18 @@ public void removeSpiderParserListener(SpiderParserListener listener) {\n         this.listeners.remove(listener);\n     }\n \n+    /**\n+     * Notify the listeners that a resource was found.\n+     *\n+     * @param resourceFound the http message containing the response.\n+     * @since 2.11.0\n+     */\n+    protected void notifyListenersResourceFound(SpiderResourceFound resourceFound) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY1OTk4NQ==", "bodyText": "Better provide a builder, can be immutable.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546659985", "createdAt": "2020-12-21T11:41:24Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderResourceFound.java", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.spider.parser;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Objects;\n+import org.parosproxy.paros.network.HttpHeaderField;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpRequestHeader;\n+\n+/**\n+ * Class SpiderResourceFound is used to store information about found resources by spider parsers.\n+ *\n+ * @since 2.11.0\n+ */\n+public class SpiderResourceFound {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2MDAwNQ==", "bodyText": "The default should be Collections.emptyList(), otherwise it will create a lot of garbage.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546660005", "createdAt": "2020-12-21T11:41:26Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderResourceFound.java", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.spider.parser;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Objects;\n+import org.parosproxy.paros.network.HttpHeaderField;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpRequestHeader;\n+\n+/**\n+ * Class SpiderResourceFound is used to store information about found resources by spider parsers.\n+ *\n+ * @since 2.11.0\n+ */\n+public class SpiderResourceFound {\n+    /** Original response message. */\n+    private HttpMessage responseMessage;\n+    /** Spider depth for resource. */\n+    private int depth;\n+    /** HTTP method for resource. */\n+    private String method;\n+    /** Uniform resource identifier of resource. */\n+    private String uri;\n+    /** Body for the resource. */\n+    private String body = \"\";\n+    /** Defines resource as useful or not useful in the fetching process. */\n+    private boolean shouldIgnore = false;\n+    /** Additional request headers to be passed for the resource. */\n+    private List<HttpHeaderField> requestHeaders = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2MDI1Mw==", "bodyText": "Typo in resource.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546660253", "createdAt": "2020-12-21T11:42:02Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/SpiderTask.java", "diffHunk": "@@ -76,73 +78,20 @@\n \n     /**\n      * Instantiates a new spider task using the target URI. The purpose of this task is to crawl the\n-     * given uri, using the provided method, find any other uris in the fetched resource and create\n-     * other tasks.\n-     *\n-     * @param parent the spider controlling the crawling process\n-     * @param uri the uri that this task should process\n-     * @param depth the depth where this uri is located in the spidering process\n-     * @param method the HTTP method that should be used to fetch the resource\n-     */\n-    public SpiderTask(Spider parent, URI uri, int depth, String method) {\n-        this(parent, null, uri, depth, method, null);\n-    }\n-\n-    /**\n-     * Instantiates a new spider task using the target URI. The purpose of this task is to crawl the\n-     * given uri, using the provided method, find any other uris in the fetched resource and create\n-     * other tasks.\n-     *\n-     * @param parent the spider controlling the crawling process\n-     * @param sourceUri the URI where the given {@code uri} was found\n-     * @param uri the uri that this task should process\n-     * @param depth the depth where this uri is located in the spidering process\n-     * @param method the HTTP method that should be used to fetch the resource\n-     * @since 2.4.0\n-     */\n-    public SpiderTask(Spider parent, URI sourceUri, URI uri, int depth, String method) {\n-        this(parent, sourceUri, uri, depth, method, null);\n-    }\n-\n-    /**\n-     * Instantiates a new spider task using the target URI. The purpose of this task is to crawl the\n-     * given uri, using the provided method, find any other uris in the fetched resource and create\n-     * other tasks.\n-     *\n-     * <p>The body of the request message is also provided in the {@literal requestBody} parameter\n-     * and will be used when fetching the resource from the specified uri.\n-     *\n-     * @param parent the spider controlling the crawling process\n-     * @param uri the uri that this task should process\n-     * @param depth the depth where this uri is located in the spidering process\n-     * @param method the HTTP method that should be used to fetch the resource\n-     * @param requestBody the body of the request\n-     */\n-    public SpiderTask(Spider parent, URI uri, int depth, String method, String requestBody) {\n-        this(parent, null, uri, depth, method, requestBody);\n-    }\n-\n-    /**\n-     * Instantiates a new spider task using the target URI. The purpose of this task is to crawl the\n-     * given uri, using the provided method, find any other uris in the fetched resource and create\n-     * other tasks.\n+     * given uri, using the provided method and supplied request headers, find any other uris in the\n+     * fetched resource and create other tasks.\n      *\n      * <p>The body of the request message is also provided in the {@literal requestBody} parameter\n      * and will be used when fetching the resource from the specified uri.\n      *\n      * @param parent the spider controlling the crawling process\n-     * @param sourceUri the URI where the given {@code uri} was found\n+     * @param resoureFound information about found resource\n      * @param uri the uri that this task should process\n-     * @param depth the depth where this uri is located in the spidering process\n-     * @param method the HTTP method that should be used to fetch the resource\n-     * @param requestBody the body of the request\n-     * @since 2.4.0\n+     * @since 2.11.0\n      */\n-    public SpiderTask(\n-            Spider parent, URI sourceUri, URI uri, int depth, String method, String requestBody) {\n+    public SpiderTask(Spider parent, SpiderResourceFound resoureFound, URI uri) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2Mjk3OA==", "bodyText": "The message where the resource was found.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546662978", "createdAt": "2020-12-21T11:48:33Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderResourceFound.java", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.spider.parser;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Objects;\n+import org.parosproxy.paros.network.HttpHeaderField;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpRequestHeader;\n+\n+/**\n+ * Class SpiderResourceFound is used to store information about found resources by spider parsers.\n+ *\n+ * @since 2.11.0\n+ */\n+public class SpiderResourceFound {\n+    /** Original response message. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2Mjk5NA==", "bodyText": "message.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546662994", "createdAt": "2020-12-21T11:48:36Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/parser/SpiderResourceFound.java", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.spider.parser;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Objects;\n+import org.parosproxy.paros.network.HttpHeaderField;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpRequestHeader;\n+\n+/**\n+ * Class SpiderResourceFound is used to store information about found resources by spider parsers.\n+ *\n+ * @since 2.11.0\n+ */\n+public class SpiderResourceFound {\n+    /** Original response message. */\n+    private HttpMessage responseMessage;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2MzIwMA==", "bodyText": "The request header is never null.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546663200", "createdAt": "2020-12-21T11:49:06Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/SpiderTask.java", "diffHunk": "@@ -153,14 +102,29 @@ public SpiderTask(\n         // using\n         // HistoryReference\n         try {\n-            HttpRequestHeader requestHeader = new HttpRequestHeader(method, uri, HttpHeader.HTTP11);\n-            if (sourceUri != null && parent.getSpiderParam().isSendRefererHeader()) {\n-                requestHeader.setHeader(HttpRequestHeader.REFERER, sourceUri.toString());\n+            HttpRequestHeader requestHeader =\n+                    new HttpRequestHeader(resoureFound.getMethod(), uri, HttpHeader.HTTP11);\n+            if (resoureFound.getRequestHeaders() != null) {\n+                // Intentionally adding supplied request headers before the referer header\n+                // to prioritize \"send referer header\" option\n+                for (HttpHeaderField header : resoureFound.getRequestHeaders()) {\n+                    if (header != null && header.getName() != null && header.getValue() != null) {\n+                        requestHeader.addHeader(header.getName(), header.getValue());\n+                    }\n+                }\n+            }\n+            if (resoureFound.getResponseMessage() != null\n+                    && resoureFound.getResponseMessage().getRequestHeader() != null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2NDE0Mg==", "bodyText": "Is this needed?", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546664142", "createdAt": "2020-12-21T11:51:41Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/SpiderController.java", "diffHunk": "@@ -251,46 +248,71 @@ public void init() {\n \n     /** Clears the previous process. */\n     public void reset() {\n-        visitedGet.clear();\n-        visitedPost.clear();\n+        visitedResources.clear();\n \n         for (SpiderParser parser : parsers) {\n             parser.removeSpiderParserListener(this);\n         }\n     }\n \n-    @Override\n-    public void resourceURIFound(\n-            HttpMessage responseMessage, int depth, String uri, boolean shouldIgnore) {\n-        log.debug(\"New resource found: \" + uri);\n+    /**\n+     * Builds a canonical identifier for found resources considering the method, URI, headers, and\n+     * body.\n+     *\n+     * @param uri uniform resource identifier for resource\n+     * @param resourceFound resource found\n+     * @return identifier as a string representation usable for equality checks\n+     */\n+    private String buildCanonicalResourceIdentifier(URI uri, SpiderResourceFound resourceFound)\n+            throws URIException {\n+        StringBuilder identifierBuilder = new StringBuilder(50);\n+        if (resourceFound != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 141}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2NDE3NQ==", "bodyText": "Better do these validations when the resource is created, here it should just be used.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546664175", "createdAt": "2020-12-21T11:51:45Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/SpiderController.java", "diffHunk": "@@ -251,46 +248,71 @@ public void init() {\n \n     /** Clears the previous process. */\n     public void reset() {\n-        visitedGet.clear();\n-        visitedPost.clear();\n+        visitedResources.clear();\n \n         for (SpiderParser parser : parsers) {\n             parser.removeSpiderParserListener(this);\n         }\n     }\n \n-    @Override\n-    public void resourceURIFound(\n-            HttpMessage responseMessage, int depth, String uri, boolean shouldIgnore) {\n-        log.debug(\"New resource found: \" + uri);\n+    /**\n+     * Builds a canonical identifier for found resources considering the method, URI, headers, and\n+     * body.\n+     *\n+     * @param uri uniform resource identifier for resource\n+     * @param resourceFound resource found\n+     * @return identifier as a string representation usable for equality checks\n+     */\n+    private String buildCanonicalResourceIdentifier(URI uri, SpiderResourceFound resourceFound)\n+            throws URIException {\n+        StringBuilder identifierBuilder = new StringBuilder(50);\n+        if (resourceFound != null) {\n+            String visitedURI =\n+                    URLCanonicalizer.buildCleanedParametersURIRepresentation(\n+                            uri,\n+                            spider.getSpiderParam().getHandleParameters(),\n+                            spider.getSpiderParam().isHandleODataParametersVisited());\n+            identifierBuilder.append(resourceFound.getMethod());\n+            identifierBuilder.append(\" \");\n+            identifierBuilder.append(visitedURI);\n+            identifierBuilder.append(\"\\n\");\n+            String canonicalHeaderRepresentation =\n+                    getCanonicalHeadersString(resourceFound.getRequestHeaders());\n+            identifierBuilder.append(\"\\n\");\n+            identifierBuilder.append(resourceFound.getBody());\n+        }\n+        return identifierBuilder.toString();\n+    }\n \n-        if (uri == null) {\n+    @Override\n+    public void resourceFound(SpiderResourceFound resourceFound) {\n+        if (resourceFound == null\n+                || resourceFound.getUri() == null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 163}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2NDE4Nw==", "bodyText": "log.debug(\"New {} resource found: {}\", resourceFound.getMethod(),resourceFound.getUri())", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546664187", "createdAt": "2020-12-21T11:51:47Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/SpiderController.java", "diffHunk": "@@ -251,46 +248,71 @@ public void init() {\n \n     /** Clears the previous process. */\n     public void reset() {\n-        visitedGet.clear();\n-        visitedPost.clear();\n+        visitedResources.clear();\n \n         for (SpiderParser parser : parsers) {\n             parser.removeSpiderParserListener(this);\n         }\n     }\n \n-    @Override\n-    public void resourceURIFound(\n-            HttpMessage responseMessage, int depth, String uri, boolean shouldIgnore) {\n-        log.debug(\"New resource found: \" + uri);\n+    /**\n+     * Builds a canonical identifier for found resources considering the method, URI, headers, and\n+     * body.\n+     *\n+     * @param uri uniform resource identifier for resource\n+     * @param resourceFound resource found\n+     * @return identifier as a string representation usable for equality checks\n+     */\n+    private String buildCanonicalResourceIdentifier(URI uri, SpiderResourceFound resourceFound)\n+            throws URIException {\n+        StringBuilder identifierBuilder = new StringBuilder(50);\n+        if (resourceFound != null) {\n+            String visitedURI =\n+                    URLCanonicalizer.buildCleanedParametersURIRepresentation(\n+                            uri,\n+                            spider.getSpiderParam().getHandleParameters(),\n+                            spider.getSpiderParam().isHandleODataParametersVisited());\n+            identifierBuilder.append(resourceFound.getMethod());\n+            identifierBuilder.append(\" \");\n+            identifierBuilder.append(visitedURI);\n+            identifierBuilder.append(\"\\n\");\n+            String canonicalHeaderRepresentation =\n+                    getCanonicalHeadersString(resourceFound.getRequestHeaders());\n+            identifierBuilder.append(\"\\n\");\n+            identifierBuilder.append(resourceFound.getBody());\n+        }\n+        return identifierBuilder.toString();\n+    }\n \n-        if (uri == null) {\n+    @Override\n+    public void resourceFound(SpiderResourceFound resourceFound) {\n+        if (resourceFound == null\n+                || resourceFound.getUri() == null\n+                || resourceFound.getMethod() == null) {\n             return;\n         }\n \n+        log.debug(\"New \" + resourceFound.getMethod() + \"resource found: \" + resourceFound.getUri());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 168}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY2NDI0MA==", "bodyText": "Better do these validations when the resource is created, here it should just be used.", "url": "https://github.com/zaproxy/zaproxy/pull/6231#discussion_r546664240", "createdAt": "2020-12-21T11:51:56Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/spider/SpiderController.java", "diffHunk": "@@ -299,107 +321,51 @@ public void resourceURIFound(\n             FetchStatus s = f.checkFilter(uriV);\n             if (s != FetchStatus.VALID) {\n                 log.debug(\"URI: \" + uriV + \" was filtered by a filter with reason: \" + s);\n-                spider.notifyListenersFoundURI(uri, HttpRequestHeader.GET, s);\n+                spider.notifyListenersFoundURI(\n+                        resourceFound.getUri(), resourceFound.getMethod(), s);\n                 return;\n             }\n         }\n \n-        // Check if should be ignored and not fetched\n-        if (shouldIgnore) {\n+        // Check if resource should be ignored and not fetched\n+        if (resourceFound.isShouldIgnore()) {\n             log.debug(\n                     \"URI: \"\n                             + uriV\n                             + \" is valid, but will not be fetched, by parser recommendation.\");\n-            spider.notifyListenersFoundURI(uri, HttpRequestHeader.GET, FetchStatus.VALID);\n+            spider.notifyListenersFoundURI(\n+                    resourceFound.getUri(), resourceFound.getMethod(), FetchStatus.VALID);\n             return;\n         }\n \n-        spider.notifyListenersFoundURI(uri, HttpRequestHeader.GET, FetchStatus.VALID);\n+        spider.notifyListenersFoundURI(\n+                resourceFound.getUri(), resourceFound.getMethod(), FetchStatus.VALID);\n \n         // Submit the task\n-        SpiderTask task =\n-                new SpiderTask(\n-                        spider,\n-                        responseMessage.getRequestHeader().getURI(),\n-                        uriV,\n-                        depth,\n-                        HttpRequestHeader.GET);\n-        spider.submitTask(task);\n-    }\n-\n-    @Override\n-    public void resourceURIFound(HttpMessage responseMessage, int depth, String uri) {\n-        resourceURIFound(responseMessage, depth, uri, false);\n-    }\n-\n-    @Override\n-    public void resourcePostURIFound(\n-            HttpMessage responseMessage, int depth, String uri, String requestBody) {\n-        log.debug(\"New POST resource found: \" + uri);\n-\n-        // Check if the uri was processed already\n-        synchronized (visitedPost) {\n-            if (arrayKeyValueExists(uri, requestBody)) {\n-                log.debug(\"URI already visited: \" + uri);\n-                return;\n-            } else {\n-                if (visitedPost.containsKey(uri)) {\n-                    visitedPost.get(uri).add(requestBody);\n-                } else {\n-                    ArrayList<String> l = new ArrayList<String>();\n-                    l.add(requestBody);\n-                    visitedPost.put(uri, l);\n-                }\n-            }\n-        }\n-\n-        // Create the uri\n-        URI uriV = createURI(uri);\n-        if (uriV == null) {\n-            return;\n-        }\n-\n-        // Check if any of the filters disallows this uri\n-        for (FetchFilter f : fetchFilters) {\n-            FetchStatus s = f.checkFilter(uriV);\n-            if (s != FetchStatus.VALID) {\n-                log.debug(\"URI: \" + uriV + \" was filtered by a filter with reason: \" + s);\n-                spider.notifyListenersFoundURI(uri, HttpRequestHeader.POST, s);\n-                return;\n-            }\n-        }\n-\n-        spider.notifyListenersFoundURI(uri, HttpRequestHeader.POST, FetchStatus.VALID);\n-\n-        // Submit the task\n-        SpiderTask task =\n-                new SpiderTask(\n-                        spider,\n-                        responseMessage.getRequestHeader().getURI(),\n-                        uriV,\n-                        depth,\n-                        HttpRequestHeader.POST,\n-                        requestBody);\n+        SpiderTask task = new SpiderTask(spider, resourceFound, uriV);\n         spider.submitTask(task);\n     }\n \n     /**\n      * Checks whether the value exists in an ArrayList of certain key.\n      *\n-     * @param key the string of the uri\n-     * @param value the request body of the uri\n-     * @return true or false depending whether the uri and request body have already been processed\n+     * @param headers list of HTTP headers\n+     * @return canonical string representation of headers\n      */\n-    private boolean arrayKeyValueExists(String key, String value) {\n-        if (visitedPost.containsKey(key)) {\n-            for (String s : visitedPost.get(key)) {\n-                if (s.equals(value)) {\n-                    return true;\n-                }\n-            }\n+    private String getCanonicalHeadersString(List<HttpHeaderField> headers) {\n+        if (headers != null && !headers.isEmpty()) {\n+            headers.removeIf(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bed36cbef65f17be031e9e40d109fc778b96ec"}, "originalPosition": 318}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "11666a4e5f97b5b40bc88414f3a1709c964fcb89", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/11666a4e5f97b5b40bc88414f3a1709c964fcb89", "committedDate": "2020-12-23T13:28:37Z", "message": "Further adaptations for spider resource handling\n\n- Removed \"TODO\" version references for logger\n- SpiderParser now offers only a single notifyListenersResourceFound\nmethod using SpiderResourceFound, other notification methods are\ndeprecated\n- Added a builder for SpiderResourceFound instances used by the\nSpiderController and SpiderParser (incl. SpiderHtmlFormParser)\n- Removed validation routines from spider controller (now part of\nbuilder)\n- Replaced \"depth\" attribute of SpiderTask with the SpiderResourceFound\ninstance\n- Minor adjustments in docs, logging, and comments\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "005720f9b9a3b5d7efa0844b6413026f90857201", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/005720f9b9a3b5d7efa0844b6413026f90857201", "committedDate": "2020-12-23T13:41:39Z", "message": "Further adaptations for spider resource handling\n\n- Removed \"TODO\" version references for logger\n- SpiderParser now offers only a single notifyListenersResourceFound\nmethod using SpiderResourceFound, other notification methods are\ndeprecated\n- Added a builder for SpiderResourceFound instances used by the\nSpiderController and SpiderParser (incl. SpiderHtmlFormParser)\n- Removed validation routines from spider controller (now part of\nbuilder)\n- Replaced \"depth\" attribute of SpiderTask with the SpiderResourceFound\ninstance\n- Minor adjustments in docs, logging, and comments\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90af244d8d33268bf6d58f70ed93ee9119461523", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/90af244d8d33268bf6d58f70ed93ee9119461523", "committedDate": "2021-05-31T10:00:33Z", "message": "Split \"SpiderParserAdditionalHeadersUnitTest\" in two specific unit tests\n\n- SpiderParserGenericWithBuilderUnitTest: Tests the SpiderResourceFound\nbuilder and handling within a generic spider parser\n- SpiderControllerResourcesFoundUnitTest: Tests the found resource\nhandling within a test spider control with regards to the resource\ncanonicalization\n\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "fc25ceced5949bbc23485249c37e4381a331d76a", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/fc25ceced5949bbc23485249c37e4381a331d76a", "committedDate": "2021-08-31T16:35:00Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Added tests.\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc25ceced5949bbc23485249c37e4381a331d76a", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/fc25ceced5949bbc23485249c37e4381a331d76a", "committedDate": "2021-08-31T16:35:00Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Added tests.\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}, "afterCommit": {"oid": "b156f19f3d619cb5e86c3b1cd5243bf86ecfe9f7", "author": {"user": {"login": "thc202", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/b156f19f3d619cb5e86c3b1cd5243bf86ecfe9f7", "committedDate": "2021-09-12T14:21:31Z", "message": "Revert accessibility change in SpiderController\n\nThe tests no longer require it.\n\nSigned-off-by: thc202 <thc202@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzUyNTgyMzE1", "url": "https://github.com/zaproxy/zaproxy/pull/6231#pullrequestreview-752582315", "createdAt": "2021-09-13T10:36:03Z", "commit": {"oid": "b156f19f3d619cb5e86c3b1cd5243bf86ecfe9f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzUyNjEzMjg2", "url": "https://github.com/zaproxy/zaproxy/pull/6231#pullrequestreview-752613286", "createdAt": "2021-09-13T11:12:04Z", "commit": {"oid": "b156f19f3d619cb5e86c3b1cd5243bf86ecfe9f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6fe4392b271af7e03357c7f454b48bf4cca6d3b", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/a6fe4392b271af7e03357c7f454b48bf4cca6d3b", "committedDate": "2021-09-13T11:47:06Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Added tests.\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b156f19f3d619cb5e86c3b1cd5243bf86ecfe9f7", "author": {"user": {"login": "thc202", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/b156f19f3d619cb5e86c3b1cd5243bf86ecfe9f7", "committedDate": "2021-09-12T14:21:31Z", "message": "Revert accessibility change in SpiderController\n\nThe tests no longer require it.\n\nSigned-off-by: thc202 <thc202@gmail.com>"}, "afterCommit": {"oid": "a6fe4392b271af7e03357c7f454b48bf4cca6d3b", "author": {"user": {"login": "vladidx", "name": "VladiDX"}}, "url": "https://github.com/zaproxy/zaproxy/commit/a6fe4392b271af7e03357c7f454b48bf4cca6d3b", "committedDate": "2021-09-13T11:47:06Z", "message": "Allowing to add request headers from a spider parser incl. refactoring\n\n- Introduction of a new class 'SpiderResourceFound' storing resource\ndetails used within SpiderParser, SpiderParserListener,\nSpiderController, SpiderTask, and SpiderParserTestUtils\n- Simplified canonicalization of visited resources (incl. supplied\nheaders) using one hash set\n- Added tests.\n- Added binary incompatible methods to \"japicmp\" task in\n\"zap.gradle.kts\"\n\nSigned-off-by: Vladislav Dexheimer <vladislav.dexheimer@sap.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzUyNjUxMDA1", "url": "https://github.com/zaproxy/zaproxy/pull/6231#pullrequestreview-752651005", "createdAt": "2021-09-13T11:55:28Z", "commit": {"oid": "a6fe4392b271af7e03357c7f454b48bf4cca6d3b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 127, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}