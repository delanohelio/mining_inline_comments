{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwNjg5ODk1", "number": 6296, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODozNjoyM1rOE5UUTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNjoxNzoyNVrOE5kFCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NTM3MTY2OnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/extension/authentication/HttpSenderAuthHeaderListener.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODozNjoyM1rOHzsr0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODozNjoyM1rOHzsr0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzk3MTUzNg==", "bodyText": "or empty?", "url": "https://github.com/zaproxy/zaproxy/pull/6296#discussion_r523971536", "createdAt": "2020-11-16T08:36:23Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/extension/authentication/HttpSenderAuthHeaderListener.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.extension.authentication;\n+\n+import org.parosproxy.paros.network.HttpHeader;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpSender;\n+import org.zaproxy.zap.network.HttpSenderListener;\n+\n+class HttpSenderAuthHeaderListener implements HttpSenderListener {\n+\n+    private final String authHeaderValue;\n+    private final String authHeader;\n+    private final String authHeaderSite;\n+\n+    public HttpSenderAuthHeaderListener() {\n+        authHeaderValue = System.getenv(\"ZAP_AUTH_HEADER_VALUE\");\n+        String authHeaderVar = System.getenv(\"ZAP_AUTH_HEADER\");\n+        if (authHeaderVar == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d886e8a7d5625e4dd9e599cbe54311daacc76515"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4Nzk1NDAwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/java/org/zaproxy/zap/extension/authentication/HttpSenderAuthHeaderListener.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNjoxNzoyNVrOH0GSFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNjoxNzoyNVrOH0GSFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM5MDkzMg==", "bodyText": "Wow, I was not aware we could pass functions as parameters, that's so cool!", "url": "https://github.com/zaproxy/zaproxy/pull/6296#discussion_r524390932", "createdAt": "2020-11-16T16:17:25Z", "author": {"login": "ricekot"}, "path": "zap/src/main/java/org/zaproxy/zap/extension/authentication/HttpSenderAuthHeaderListener.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+ * Zed Attack Proxy (ZAP) and its related class files.\n+ *\n+ * ZAP is an HTTP/HTTPS proxy for assessing web application security.\n+ *\n+ * Copyright 2020 The ZAP Development Team\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.zaproxy.zap.extension.authentication;\n+\n+import java.util.function.Function;\n+import org.parosproxy.paros.network.HttpHeader;\n+import org.parosproxy.paros.network.HttpMessage;\n+import org.parosproxy.paros.network.HttpSender;\n+import org.zaproxy.zap.network.HttpSenderListener;\n+\n+class HttpSenderAuthHeaderListener implements HttpSenderListener {\n+\n+    public static final String ZAP_AUTH_HEADER_VALUE = \"ZAP_AUTH_HEADER_VALUE\";\n+    public static final String ZAP_AUTH_HEADER = \"ZAP_AUTH_HEADER\";\n+    public static final String ZAP_AUTH_HEADER_SITE = \"ZAP_AUTH_HEADER_SITE\";\n+\n+    private final String authHeaderValue;\n+    private final String authHeader;\n+    private final String authHeaderSite;\n+\n+    public HttpSenderAuthHeaderListener(Function<String, String> propertyProvider) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2556e722a3d9146519ab3fde0282f1ff40ffa96e"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 610, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}