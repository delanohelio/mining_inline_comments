{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1MjY2OTY1", "number": 5814, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODoxOTo0N1rODZlx4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxNToxODoyNlrODcRJrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTU5OTY4OnYy", "diffSide": "RIGHT", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.md.xsl", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODoxOTo0N1rOFgEAoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjowNjo1M1rOFgRYuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE2NDQ0OA==", "bodyText": "This (and following line) can be added before the loop (if there are no rows it's rendered as an empty table).", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r369164448", "createdAt": "2020-01-21T18:19:47Z", "author": {"login": "thc202"}, "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.md.xsl", "diffHunk": "@@ -24,6 +24,17 @@\n | Low | <xsl:value-of select=\"count(descendant::alertitem[riskcode='1'])\"/> |\n | Informational | <xsl:value-of select=\"count(descendant::alertitem[riskcode='0'])\"/> |\n \n+## Alerts\n+\n+<xsl:for-each select=\"descendant::alertitem\">\n+  <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+  <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+  <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+  <xsl:if test=\"position()=1\">\n+| Name | Number of Alerts |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f29587fbcee7352468abe9b7aba27c2a09220e67"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MzYwOA==", "bodyText": "Okay, I'll do that.", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r369383608", "createdAt": "2020-01-22T06:06:53Z", "author": {"login": "ricekot"}, "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.md.xsl", "diffHunk": "@@ -24,6 +24,17 @@\n | Low | <xsl:value-of select=\"count(descendant::alertitem[riskcode='1'])\"/> |\n | Informational | <xsl:value-of select=\"count(descendant::alertitem[riskcode='0'])\"/> |\n \n+## Alerts\n+\n+<xsl:for-each select=\"descendant::alertitem\">\n+  <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+  <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+  <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+  <xsl:if test=\"position()=1\">\n+| Name | Number of Alerts |", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE2NDQ0OA=="}, "originalCommit": {"oid": "f29587fbcee7352468abe9b7aba27c2a09220e67"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MzUwMTUwOnYy", "diffSide": "RIGHT", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNlQxNToyNzowOFrOFh0gTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNlQxNToyNzowOFrOFh0gTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAwNzU2Ng==", "bodyText": "Could use choose to avoid repeating the (negated) condition\nI'd suggest \"name\" (or \"type\") instead of \"kind\".", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r371007566", "createdAt": "2020-01-26T15:27:08Z", "author": {"login": "thc202"}, "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,42 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk (Confidence)</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskdesc)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskdesc))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+    <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+    <tr bgcolor=\"#e8e8e8\"> \n+      <td>\n+        <xsl:value-of select=\"name\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:value-of select=\"riskdesc\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:variable name=\"alerts-of-a-kind\" select=\"key('alerts-by-name-risk', concat(name, ' ', riskdesc))\"/>\n+        <!-- Add <count>s when merge is on -->\n+        <xsl:if test=\"$alerts-of-a-kind/count\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e620c4ff48c5516efa89d398d6a30201f7ed4d2"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwOTM2NTE1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMzo0MDo0OVrOFkLnPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxNDo0NDo0MFrOFkNhGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ4MzMyNA==", "bodyText": "I'd suggest removing this since the confidence is no longer shown (otherwise it's not obvious what the order is).", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r373483324", "createdAt": "2020-01-31T13:40:49Z", "author": {"login": "thc202"}, "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,44 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk Level</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskcode)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskcode))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "896ecb05230b60a8bdfc9fbaf781e233412cff9a"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxNDUyMg==", "bodyText": "Okay, I'll do that.", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r373514522", "createdAt": "2020-01-31T14:44:40Z", "author": {"login": "ricekot"}, "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,44 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk Level</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskcode)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskcode))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ4MzMyNA=="}, "originalCommit": {"oid": "896ecb05230b60a8bdfc9fbaf781e233412cff9a"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwOTY3NzI1OnYy", "diffSide": "RIGHT", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxNToxODoyNlrOFkOnpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxNToxODoyNlrOFkOnpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUzMjU4MQ==", "bodyText": "Re: @thc202's followup comment the issue does actually mention:\n\nIt would certainly be useful if the alerts were sorted by kind (currently, I'm not sure what their sort order is).\n\nWe discussed this via IRC and believe that risk-name-confidence is likely best.", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r373532581", "createdAt": "2020-01-31T15:18:26Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,44 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk Level</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskcode)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskcode))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+    <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+    <tr bgcolor=\"#e8e8e8\"> \n+      <td>\n+        <xsl:value-of select=\"name\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:value-of select=\"substring-before(riskdesc, ' ')\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:variable name=\"same-name-alerts\" select=\"key('alerts-by-name-risk', concat(name, ' ', riskcode))\"/>\n+        <xsl:choose>\n+          <!-- Add <count>s when merge is on -->\n+          <xsl:when test=\"$same-name-alerts/count\">\n+            <xsl:value-of select=\"sum($same-name-alerts/count)\"/>\n+          </xsl:when>\n+          <!-- Count alerts when merge is off -->\n+          <xsl:otherwise>\n+            <xsl:value-of select=\"count($same-name-alerts)\"/>\n+          </xsl:otherwise>\n+        </xsl:choose>\n+      </td>\n+    </tr>\n+  </xsl:for-each>\n+</table>\n+<div class=\"spacer-lg\"></div>\n+\n <h3>Alert Detail</h3>\n \n <xsl:apply-templates select=\"descendant::alertitem\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "896ecb05230b60a8bdfc9fbaf781e233412cff9a"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 642, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}