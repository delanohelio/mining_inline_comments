{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMjAwNzE4", "number": 6236, "title": "#5898 added import from file button to regular expression panels", "bodyText": "Added an import button to \"Include in Context\" which allows adding all regex patterns of a file. There must be one regex per line.", "createdAt": "2020-10-11T20:21:25Z", "url": "https://github.com/zaproxy/zaproxy/pull/6236", "merged": true, "mergeCommit": {"oid": "9ede365caca56bc15b7b88b941e36e8711373e0b"}, "closed": true, "closedAt": "2020-10-28T10:24:16Z", "author": {"login": "ckoidl"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRlbgogBqjM4NjQwNjE0NDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdW68YegFqTUxODUxNDM2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dacbcb540b5b0996d7a17018a2246ea374d68acf", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/dacbcb540b5b0996d7a17018a2246ea374d68acf", "committedDate": "2020-10-11T19:59:55Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/a9e516543a73ad60793b0751a789ba1240240cf3", "committedDate": "2020-10-11T20:30:11Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjM2Njkz", "url": "https://github.com/zaproxy/zaproxy/pull/6236#pullrequestreview-506236693", "createdAt": "2020-10-12T00:44:07Z", "commit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwMDo0NDowN1rOHfsDew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwMDo1NDoxN1rOHfsJJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk4OTY5MQ==", "bodyText": "There doesn't seem to be any need for this intermediate storage and it isn't a CONSTANT.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n          \n          \n            \n                    JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n          \n          \n            \n                    JButton importButton = new JButton(Constant.messages.getString(\"context.include.import.label\"));", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502989691", "createdAt": "2020-10-12T00:44:07Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDMyMA==", "bodyText": "The ActionListener creation could be extracted to a new private method (getImportActionListener or something like that, create it if null, just return it if not). Then, the addition of the listener could be done with a lambda importButton.addActionListener(e -> getImportActionListener());.\nOr something like that, hopefully that gives you enough to work with. Feel free to ask questions if I haven't been clear enough.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502990320", "createdAt": "2020-10-12T00:48:17Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                                        regexes.add(trimmedRegex);\n+                                    }\n+                                }\n+                            } catch (IOException | PatternSyntaxException e) {\n+                                View.getSingleton()\n+                                        .showWarningDialog(\n+                                                Constant.messages.getString(\n+                                                        \"context.include.import.error\",\n+                                                        e.getLocalizedMessage()));\n+                                return;\n+                            }\n+                            regexesPanel.setRegexes(regexes);\n+                        }\n+                    }\n+                });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDcyOQ==", "bodyText": "Hmmmm I'm not sure about assuming case insensitive. Users can always designate (?i) at the start of their pattern if they wish. Unless you've checked and this behavior is assumed elsewhere in context handling.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502990729", "createdAt": "2020-10-12T00:51:04Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MDg1Nw==", "bodyText": "This has bitten us before. I'd suggest including two substitutions. One that is specifically the failed pattern string, and one that's the message or localizedMessage.\nEdit: To be more specific, localizedMessage doesn't always exist, or can sometimes be null (I forget precisely if we hit null or simply empty in the past).", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502990857", "createdAt": "2020-10-12T00:51:58Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                                        regexes.add(trimmedRegex);\n+                                    }\n+                                }\n+                            } catch (IOException | PatternSyntaxException e) {\n+                                View.getSingleton()\n+                                        .showWarningDialog(\n+                                                Constant.messages.getString(\n+                                                        \"context.include.import.error\",\n+                                                        e.getLocalizedMessage()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MTE0Mw==", "bodyText": "Note: I haven't tested.\nWon't this replace what is already specified? If the user has already set something or imported another file first.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r502991143", "createdAt": "2020-10-12T00:54:17Z", "author": {"login": "kingthorin"}, "path": "zap/src/main/java/org/zaproxy/zap/view/ContextIncludePanel.java", "diffHunk": "@@ -64,6 +75,56 @@ public static String getPanelName(Context context) {\n         return getPanelName(context.getId());\n     }\n \n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());\n+        if (rc == JFileChooser.APPROVE_OPTION) {\n+            file = chooser.getSelectedFile();\n+            if (file == null || !file.exists()) {\n+                return null;\n+            }\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private void addImportButton() {\n+        String IMPORT_BUTTON_LABEL = Constant.messages.getString(\"context.include.import.label\");\n+        JButton importButton = new JButton(IMPORT_BUTTON_LABEL);\n+        importButton.addActionListener(\n+                new ActionListener() {\n+                    @Override\n+                    public void actionPerformed(ActionEvent evt) {\n+                        File file = selectImportFile();\n+                        if (file != null) {\n+                            List<String> regexes = regexesPanel.getRegexes();\n+\n+                            String line = null;\n+                            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                                while ((line = br.readLine()) != null) {\n+                                    String trimmedRegex = line.trim();\n+                                    if (!regexes.contains(trimmedRegex)) {\n+                                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                                        regexes.add(trimmedRegex);\n+                                    }\n+                                }\n+                            } catch (IOException | PatternSyntaxException e) {\n+                                View.getSingleton()\n+                                        .showWarningDialog(\n+                                                Constant.messages.getString(\n+                                                        \"context.include.import.error\",\n+                                                        e.getLocalizedMessage()));\n+                                return;\n+                            }\n+                            regexesPanel.setRegexes(regexes);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3"}, "originalPosition": 65}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9e516543a73ad60793b0751a789ba1240240cf3", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/a9e516543a73ad60793b0751a789ba1240240cf3", "committedDate": "2020-10-11T20:30:11Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "b7995aecad133be208a28ca596088d2229532af6", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/b7995aecad133be208a28ca596088d2229532af6", "committedDate": "2020-10-12T20:58:03Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7995aecad133be208a28ca596088d2229532af6", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/b7995aecad133be208a28ca596088d2229532af6", "committedDate": "2020-10-12T20:58:03Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "7e258ebe240dda9e8c11e0659a24df1363ee39c9", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/7e258ebe240dda9e8c11e0659a24df1363ee39c9", "committedDate": "2020-10-12T21:01:08Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e258ebe240dda9e8c11e0659a24df1363ee39c9", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/7e258ebe240dda9e8c11e0659a24df1363ee39c9", "committedDate": "2020-10-12T21:01:08Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "48659304c38aa9638022e8438c92a9921f6581dc", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/48659304c38aa9638022e8438c92a9921f6581dc", "committedDate": "2020-10-12T21:12:46Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "48659304c38aa9638022e8438c92a9921f6581dc", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/48659304c38aa9638022e8438c92a9921f6581dc", "committedDate": "2020-10-12T21:12:46Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/39ac49103748e03e66d5f0ac4a90e80c0a516a76", "committedDate": "2020-10-16T20:57:08Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwODA1NDcz", "url": "https://github.com/zaproxy/zaproxy/pull/6236#pullrequestreview-510805473", "createdAt": "2020-10-16T21:21:43Z", "commit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNTczNTU3", "url": "https://github.com/zaproxy/zaproxy/pull/6236#pullrequestreview-511573557", "createdAt": "2020-10-19T09:27:29Z", "commit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOToyNzoyOVrOHkFlmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTozMDo1OVrOHkFuZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjMyOA==", "bodyText": "Should be at most protected, the argument could be removed.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602328", "createdAt": "2020-10-19T09:27:29Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjQwMg==", "bodyText": "This is not a copy, this will lead to partial imports in case of failure (which causes other issues as the changes to the model are not notified to the view).", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602402", "createdAt": "2020-10-19T09:27:38Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjUwMA==", "bodyText": "Can be declared later.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602500", "createdAt": "2020-10-19T09:27:47Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU0MA==", "bodyText": "Should use a specific charset (e.g. UTF-8).", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602540", "createdAt": "2020-10-19T09:27:51Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMjU5MA==", "bodyText": "This should be extracted to use when importing and adding.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507602590", "createdAt": "2020-10-19T09:27:57Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMzAyNw==", "bodyText": "Can be declared later.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507603027", "createdAt": "2020-10-19T09:28:35Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                        regexes.add(trimmedRegex);\n+                    }\n+                }\n+            } catch (IOException | PatternSyntaxException e) {\n+                View.getSingleton()\n+                        .showWarningDialog(\n+                                Constant.messages.getString(\n+                                        \"context.include.import.error\", e.getLocalizedMessage()));\n+                return;\n+            }\n+            setRegexes(regexes);\n+        }\n+    }\n+\n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwMzM0Ng==", "bodyText": "Should use owner as parent.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507603346", "createdAt": "2020-10-19T09:29:04Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                        regexes.add(trimmedRegex);\n+                    }\n+                }\n+            } catch (IOException | PatternSyntaxException e) {\n+                View.getSingleton()\n+                        .showWarningDialog(\n+                                Constant.messages.getString(\n+                                        \"context.include.import.error\", e.getLocalizedMessage()));\n+                return;\n+            }\n+            setRegexes(regexes);\n+        }\n+    }\n+\n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());\n+        File file = null;\n+\n+        int rc = chooser.showOpenDialog(View.getSingleton().getMainFrame());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwNDU4Mg==", "bodyText": "Not sure the contexts dir is the most appropriate, that's used for the whole contexts. Don't specify any?", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r507604582", "createdAt": "2020-10-19T09:30:59Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +83,50 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked(e));\n+        addButton(importButton);\n+    }\n+\n+    public void importButtonClicked(ActionEvent event) {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = getRegexes();\n+\n+            String line = null;\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedRegex = line.trim();\n+                    if (!regexes.contains(trimmedRegex)) {\n+                        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                        regexes.add(trimmedRegex);\n+                    }\n+                }\n+            } catch (IOException | PatternSyntaxException e) {\n+                View.getSingleton()\n+                        .showWarningDialog(\n+                                Constant.messages.getString(\n+                                        \"context.include.import.error\", e.getLocalizedMessage()));\n+                return;\n+            }\n+            setRegexes(regexes);\n+        }\n+    }\n+\n+    private File selectImportFile() {\n+        JFileChooser chooser = new JFileChooser(Constant.getContextsDir());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76"}, "originalPosition": 57}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "39ac49103748e03e66d5f0ac4a90e80c0a516a76", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/39ac49103748e03e66d5f0ac4a90e80c0a516a76", "committedDate": "2020-10-16T20:57:08Z", "message": "5898 added import from file button to \"Include in Context\"\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "7f7b505a889965c734f7a08aaf86f281c6671f00", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/7f7b505a889965c734f7a08aaf86f281c6671f00", "committedDate": "2020-10-19T19:21:14Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f7b505a889965c734f7a08aaf86f281c6671f00", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/7f7b505a889965c734f7a08aaf86f281c6671f00", "committedDate": "2020-10-19T19:21:14Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "c8649801cfdb8b39700d4ed4d1c6029afe116b14", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/c8649801cfdb8b39700d4ed4d1c6029afe116b14", "committedDate": "2020-10-19T19:34:25Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8649801cfdb8b39700d4ed4d1c6029afe116b14", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/c8649801cfdb8b39700d4ed4d1c6029afe116b14", "committedDate": "2020-10-19T19:34:25Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "479fa05df8845ab24665f437953993d90f07758d", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/479fa05df8845ab24665f437953993d90f07758d", "committedDate": "2020-10-19T20:05:06Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "479fa05df8845ab24665f437953993d90f07758d", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/479fa05df8845ab24665f437953993d90f07758d", "committedDate": "2020-10-19T20:05:06Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "a53c05b6db0969b0d94d89e914a4866a5e0566c8", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/a53c05b6db0969b0d94d89e914a4866a5e0566c8", "committedDate": "2020-10-20T08:22:06Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b9971674a60ff4b20e872a2e03dc5ced11e10a0", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/3b9971674a60ff4b20e872a2e03dc5ced11e10a0", "committedDate": "2020-10-23T13:00:20Z", "message": "Update MultipleRegexesOptionsPanel.java"}, "afterCommit": {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/f1ccd09d846c0beae90f8f212461e093f81c9dcf", "committedDate": "2020-10-23T13:08:51Z", "message": "Update MultipleRegexesOptionsPanel.java\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NzUzMzg0", "url": "https://github.com/zaproxy/zaproxy/pull/6236#pullrequestreview-515753384", "createdAt": "2020-10-23T15:04:06Z", "commit": {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTowNDowNlrOHnRykA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTowNDozOVrOHnRz7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0Nzk4NA==", "bodyText": "regex \u2192 trimmedRegex, or rename the parameter to regex (which has more occurrences).", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510947984", "createdAt": "2020-10-23T15:04:06Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +82,67 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked());\n+        addButton(importButton);\n+    }\n+\n+    /**\n+     * Checks if {@code regex} is contained in {@code regexes} and if it is a valid regex pattern.\n+     * If {@code regexes} is null, then the duplication check is omitted\n+     *\n+     * @param regex A regex as string", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODI1OQ==", "bodyText": "The call does not need to be qualified with the class name.\nIt would be better to add the braces to the if statement, for consistency.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510948259", "createdAt": "2020-10-23T15:04:33Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -76,6 +82,67 @@ public MultipleRegexesOptionsPanel(Dialog owner, RegexesTableModel model) {\n \n         this.owner = owner;\n         getTable().setSortOrder(0, SortOrder.ASCENDING);\n+        JButton importButton =\n+                new JButton(Constant.messages.getString(\"context.include.import.label\"));\n+        importButton.addActionListener(e -> importButtonClicked());\n+        addButton(importButton);\n+    }\n+\n+    /**\n+     * Checks if {@code regex} is contained in {@code regexes} and if it is a valid regex pattern.\n+     * If {@code regexes} is null, then the duplication check is omitted\n+     *\n+     * @param regex A regex as string\n+     * @param regexes List of regex strings\n+     * @return True if {@code regex} is not a duplicate and the pattern is valid.\n+     * @throws PatternSyntaxException If {@code regex} is not a valid regex pattern\n+     */\n+    private static boolean validateRegexAndCheckForDuplicates(\n+            String trimmedRegex, List<String> regexes) throws PatternSyntaxException {\n+        if (trimmedRegex == null\n+                || trimmedRegex.isEmpty()\n+                || regexes != null && regexes.contains(trimmedRegex)) {\n+            return false;\n+        }\n+        Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+        return true;\n+    }\n+\n+    private void importButtonClicked() {\n+        File file = selectImportFile();\n+        if (file != null) {\n+            List<String> regexes = new ArrayList<String>(getRegexes());\n+\n+            try (BufferedReader br = new BufferedReader(new FileReader(file))) {\n+                String line = null;\n+                while ((line = br.readLine()) != null) {\n+                    String trimmedLine = line.trim();\n+                    if (MultipleRegexesOptionsPanel.validateRegexAndCheckForDuplicates(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk0ODMzNA==", "bodyText": "The else is not necessary.", "url": "https://github.com/zaproxy/zaproxy/pull/6236#discussion_r510948334", "createdAt": "2020-10-23T15:04:39Z", "author": {"login": "thc202"}, "path": "zap/src/main/java/org/zaproxy/zap/view/MultipleRegexesOptionsPanel.java", "diffHunk": "@@ -224,17 +291,19 @@ protected void init() {\n         @Override\n         protected boolean validateFields() {\n             String trimmedRegex = getRegexTextField().getText().trim();\n-            if (regexes != null && regexes.contains(trimmedRegex)) {\n-                JOptionPane.showMessageDialog(\n-                        this,\n-                        TEXT_ALREADY_EXIST_INVALID_REGEX_DIALOG,\n-                        TITLE_ALREADY_EXIST_INVALID_REGEX_DIALOG,\n-                        JOptionPane.INFORMATION_MESSAGE);\n-                getRegexTextField().requestFocusInWindow();\n-                return false;\n-            }\n             try {\n-                Pattern.compile(trimmedRegex, Pattern.CASE_INSENSITIVE);\n+                if (MultipleRegexesOptionsPanel.validateRegexAndCheckForDuplicates(\n+                        trimmedRegex, regexes)) {\n+                    return true;\n+                } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf"}, "originalPosition": 106}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1ccd09d846c0beae90f8f212461e093f81c9dcf", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/f1ccd09d846c0beae90f8f212461e093f81c9dcf", "committedDate": "2020-10-23T13:08:51Z", "message": "Update MultipleRegexesOptionsPanel.java\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "2e4ef6d163cb417ba00c47f7e23e1ea3c5580c21", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/2e4ef6d163cb417ba00c47f7e23e1ea3c5580c21", "committedDate": "2020-10-23T20:29:41Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e4ef6d163cb417ba00c47f7e23e1ea3c5580c21", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/2e4ef6d163cb417ba00c47f7e23e1ea3c5580c21", "committedDate": "2020-10-23T20:29:41Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "b276f1652ec951d6ca29783cefd84dee4e008c03", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/b276f1652ec951d6ca29783cefd84dee4e008c03", "committedDate": "2020-10-26T19:11:01Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ac5ae194f2f54874d66e731dac949213f15d704", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/8ac5ae194f2f54874d66e731dac949213f15d704", "committedDate": "2020-10-27T20:10:21Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b276f1652ec951d6ca29783cefd84dee4e008c03", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/b276f1652ec951d6ca29783cefd84dee4e008c03", "committedDate": "2020-10-26T19:11:01Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}, "afterCommit": {"oid": "8ac5ae194f2f54874d66e731dac949213f15d704", "author": {"user": {"login": "ckoidl", "name": null}}, "url": "https://github.com/zaproxy/zaproxy/commit/8ac5ae194f2f54874d66e731dac949213f15d704", "committedDate": "2020-10-27T20:10:21Z", "message": "5898 added import from file button to regular expression panels\n\nSigned-off-by: Christian Koidl <christian@koidl.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTA5NTIy", "url": "https://github.com/zaproxy/zaproxy/pull/6236#pullrequestreview-518509522", "createdAt": "2020-10-28T10:17:51Z", "commit": {"oid": "8ac5ae194f2f54874d66e731dac949213f15d704"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NTE0MzY4", "url": "https://github.com/zaproxy/zaproxy/pull/6236#pullrequestreview-518514368", "createdAt": "2020-10-28T10:24:01Z", "commit": {"oid": "8ac5ae194f2f54874d66e731dac949213f15d704"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 131, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}