{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDY0NzE1", "number": 204, "title": "Make CORS origin configurable ", "bodyText": "", "createdAt": "2020-07-13T20:12:49Z", "url": "https://github.com/cryostatio/cryostat/pull/204", "merged": true, "mergeCommit": {"oid": "e2622e2ae222a0a22fadfca17ce7647bbbd9a1d6"}, "closed": true, "closedAt": "2020-07-16T15:27:05Z", "author": {"login": "Alexjsenn"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0nNzTgH2gAyNDQ4NDY0NzE1OmM1MTU3Mzg3YmIyYTM3ODlhNjE4ZGRmMDU0NjhiOGE4ZGZmODRlMWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1g8WegFqTQ0OTk2MTQ0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c5157387bb2a3789a618ddf05468b8a8dff84e1c", "author": {"user": {"login": "Alexjsenn", "name": "Alex Senn"}}, "url": "https://github.com/cryostatio/cryostat/commit/c5157387bb2a3789a618ddf05468b8a8dff84e1c", "committedDate": "2020-07-13T20:11:31Z", "message": "use address specified in cors var"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "755d60cb12b788f1d126337cebe918ddaf0c48e5", "author": {"user": {"login": "Alexjsenn", "name": "Alex Senn"}}, "url": "https://github.com/cryostatio/cryostat/commit/755d60cb12b788f1d126337cebe918ddaf0c48e5", "committedDate": "2020-07-15T19:50:13Z", "message": "modify tests with configurable origin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5Mjg2NjQ5", "url": "https://github.com/cryostatio/cryostat/pull/204#pullrequestreview-449286649", "createdAt": "2020-07-15T20:00:18Z", "commit": {"oid": "755d60cb12b788f1d126337cebe918ddaf0c48e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDowMDoxOFrOGyNw4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDowMDoxOFrOGyNw4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMwNzQ4OA==", "bodyText": "This just tests that the utility method getOrigin returns the expected value, but not that the CORS origin header is actually set. If you look at the HandlingTests lower down in this same file, ex. shouldAddHeadersToCORS, you could copy how that test works and assert that the CORS origin header is actually added to the HTTP response with the expected origin.", "url": "https://github.com/cryostatio/cryostat/pull/204#discussion_r455307488", "createdAt": "2020-07-15T20:00:18Z", "author": {"login": "andrewazores"}, "path": "src/test/java/com/redhat/rhjmc/containerjfr/net/web/handlers/CorsEnablingHandlerTest.java", "diffHunk": "@@ -93,6 +98,16 @@ void availabilityShouldDependOnEnvVar(boolean available) {\n         MatcherAssert.assertThat(handler.isAvailable(), Matchers.equalTo(available));\n     }\n \n+    @Test\n+    void shouldSetCustomOrigin() {\n+        Mockito.when(\n+                        env.getEnv(\n+                                CorsEnablingHandler.ENABLE_CORS_ENV,\n+                                CorsEnablingHandler.DEV_ORIGIN))\n+                .thenReturn(\"http://localhost:9065\");\n+        MatcherAssert.assertThat(handler.getOrigin(), Matchers.equalTo(\"http://localhost:9065\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "755d60cb12b788f1d126337cebe918ddaf0c48e5"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5Mjg3MzE0", "url": "https://github.com/cryostatio/cryostat/pull/204#pullrequestreview-449287314", "createdAt": "2020-07-15T20:01:13Z", "commit": {"oid": "755d60cb12b788f1d126337cebe918ddaf0c48e5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dfca0526f9f7a5fd359764e42852848b7d61bbd", "author": {"user": {"login": "Alexjsenn", "name": "Alex Senn"}}, "url": "https://github.com/cryostatio/cryostat/commit/2dfca0526f9f7a5fd359764e42852848b7d61bbd", "committedDate": "2020-07-15T21:09:33Z", "message": "modify tests, change env var to CONTAINER_JFR_CORS_ORIGIN"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fd942f9c2e403c2d54c93773033313d35c6cbca", "author": {"user": {"login": "Alexjsenn", "name": "Alex Senn"}}, "url": "https://github.com/cryostatio/cryostat/commit/6fd942f9c2e403c2d54c93773033313d35c6cbca", "committedDate": "2020-07-15T21:49:36Z", "message": "fix test issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35b2338452b6bd196e376cbd362f8ea523b1566f", "author": {"user": {"login": "Alexjsenn", "name": "Alex Senn"}}, "url": "https://github.com/cryostatio/cryostat/commit/35b2338452b6bd196e376cbd362f8ea523b1566f", "committedDate": "2020-07-16T14:20:03Z", "message": "add cors env var to README"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTQwNzY5", "url": "https://github.com/cryostatio/cryostat/pull/204#pullrequestreview-449940769", "createdAt": "2020-07-16T15:05:32Z", "commit": {"oid": "35b2338452b6bd196e376cbd362f8ea523b1566f"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0c21a1aabdf4d737b7f07df54d781c5d70b1c7d", "author": {"user": {"login": "Alexjsenn", "name": "Alex Senn"}}, "url": "https://github.com/cryostatio/cryostat/commit/b0c21a1aabdf4d737b7f07df54d781c5d70b1c7d", "committedDate": "2020-07-16T15:24:57Z", "message": "update run.sh with new env var"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTYxNDQw", "url": "https://github.com/cryostatio/cryostat/pull/204#pullrequestreview-449961440", "createdAt": "2020-07-16T15:26:57Z", "commit": {"oid": "b0c21a1aabdf4d737b7f07df54d781c5d70b1c7d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3168, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}