{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNjAzNjM2", "number": 199, "title": "Custom Templates", "bodyText": "Fixes #143\nSee also cryostatio/cryostat-core#40 - -core dependency changes\nThis adds HTTP API endpoints to list available event templates, retrieve XML definitions of specific templates, and to add new templates (by XML file POST upload) to container-jfr's local filesystem storage. These templates can then be used when creating new flight recordings using the pre-existing template=Foo syntax.", "createdAt": "2020-07-02T15:47:20Z", "url": "https://github.com/cryostatio/cryostat/pull/199", "merged": true, "mergeCommit": {"oid": "c04a078d9486fa91d977b96519f5f47ac0aed05f"}, "closed": true, "closedAt": "2020-07-14T21:00:24Z", "author": {"login": "andrewazores"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxDMqXgH2gAyNDQzNjAzNjM2OjgxYjk5OGNkN2EzMmU4Y2UwNDk3ZTY5NTMzMDMxZWY4MTM5ZjMxOTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc08bOTgH2gAyNDQzNjAzNjM2OjdhZTAwZTUzM2M4ODkwMDhjNTlkMDA5N2Y0ZDU4ODQwNWMzNjVlMGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "81b998cd7a32e8ce0497e69533031ef8139f3191", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/81b998cd7a32e8ce0497e69533031ef8139f3191", "committedDate": "2020-07-02T18:31:55Z", "message": "Implement GET and POST for templates\n\nGET /api/v1/targets/:targetId/templates/:templateName handler will be\nused by clients to download template XML definitions.\n\nPOST /api/v1/templates will be used by clients to upload custom template\nXML definitions to ContainerJFR local storage.."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3caac5c92de3189db3b8f3b63305c89d20ae93a5", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/3caac5c92de3189db3b8f3b63305c89d20ae93a5", "committedDate": "2020-07-02T18:31:55Z", "message": "Implement DELETE for templates\n\nDELETE /api/v1/templates/:templateName will be used by clients to delete\ntheir custom templates from the ContainerJFR backend"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc6753293f68f5ecae365c3cb305dfb305a9523c", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/fc6753293f68f5ecae365c3cb305dfb305a9523c", "committedDate": "2020-07-02T15:46:37Z", "message": "Implement DELETE for templates\n\nDELETE /api/v1/templates/:templateName will be used by clients to delete\ntheir custom templates from the ContainerJFR backend"}, "afterCommit": {"oid": "3caac5c92de3189db3b8f3b63305c89d20ae93a5", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/3caac5c92de3189db3b8f3b63305c89d20ae93a5", "committedDate": "2020-07-02T18:31:55Z", "message": "Implement DELETE for templates\n\nDELETE /api/v1/templates/:templateName will be used by clients to delete\ntheir custom templates from the ContainerJFR backend"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01683cf55fd0b8562330becd880dfb3e1f2a0628", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/01683cf55fd0b8562330becd880dfb3e1f2a0628", "committedDate": "2020-07-02T21:09:34Z", "message": "Handle TemplateType property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "881cda22361ecd7041554da37d6bef125affa39b", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/881cda22361ecd7041554da37d6bef125affa39b", "committedDate": "2020-07-02T21:09:45Z", "message": "Allow DELETE requests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8617b6005a4605129033d194f9926ebc5f351475", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/8617b6005a4605129033d194f9926ebc5f351475", "committedDate": "2020-07-06T20:08:54Z", "message": "Include relevant exception cause message in HTTP error response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a236ac229167a5072553f0a4f265c1e1787f7c8c", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/a236ac229167a5072553f0a4f265c1e1787f7c8c", "committedDate": "2020-07-07T18:49:15Z", "message": "GET template must include type param to resolve name overlaps"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77d2eaaf9eb98d7896c529b8e9c6618c4dce4c33", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/77d2eaaf9eb98d7896c529b8e9c6618c4dce4c33", "committedDate": "2020-07-07T20:14:39Z", "message": "When creating a recording from template, try custom first, then target template"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af66402267e417829223b85315de61e17236824c", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/af66402267e417829223b85315de61e17236824c", "committedDate": "2020-07-08T18:12:01Z", "message": "Add configuration for template path in tmpfs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/a91c5df2242178e0713c448048ca0bd0a1ad17b5", "committedDate": "2020-07-08T18:43:44Z", "message": "Add README note about (custom) templates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1OTE2Mzk4", "url": "https://github.com/cryostatio/cryostat/pull/199#pullrequestreview-445916398", "createdAt": "2020-07-09T19:43:37Z", "commit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo0MzozOFrOGvfTdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo0MzozOFrOGvfTdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ0OTE0MA==", "bodyText": "I'd prefer to be more concise, e.g.\nJDK Flight Recorder event templates (.jfc files) are...\nSo things like \"has a concept of...\" or \"are a sort of...\" should be removed.", "url": "https://github.com/cryostatio/cryostat/pull/199#discussion_r452449140", "createdAt": "2020-07-09T19:43:38Z", "author": {"login": "jiekang"}, "path": "README.md", "diffHunk": "@@ -175,18 +175,28 @@ number and the deployment network configuration allows connections on the\n configured port. As noted above, the final caveat is that in non-Kube\n deployments, port 9091 is expected for automatic port-scanning target discovery.\n \n+## EVENT TEMPLATES\n+\n+JDK Flight Recorder has a concept of \"event templates\", which are a sort of", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1OTE2OTc5", "url": "https://github.com/cryostatio/cryostat/pull/199#pullrequestreview-445916979", "createdAt": "2020-07-09T19:44:31Z", "commit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo0NDozMlrOGvfVSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo0NDozMlrOGvfVSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ0OTYxMA==", "bodyText": "Extra line can be removed.", "url": "https://github.com/cryostatio/cryostat/pull/199#discussion_r452449610", "createdAt": "2020-07-09T19:44:32Z", "author": {"login": "jiekang"}, "path": "run.sh", "diffHunk": "@@ -41,10 +41,12 @@ if [ -z \"$CONTAINER_JFR_AUTH_MANAGER\" ]; then\n     CONTAINER_JFR_AUTH_MANAGER=\"com.redhat.rhjmc.containerjfr.net.NoopAuthManager\"\n fi\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1OTI0NDI0", "url": "https://github.com/cryostatio/cryostat/pull/199#pullrequestreview-445924424", "createdAt": "2020-07-09T19:55:49Z", "commit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo1NTo1MFrOGvfrsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo1NTo1MFrOGvfrsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ1NTM0Nw==", "bodyText": "I guess a side-effect here to keep in mind for the c-jfr-web UI listing of profiles is if a custom profile has the same name as a JVM one, it will make the JVM one no longer accessible with this API.", "url": "https://github.com/cryostatio/cryostat/pull/199#discussion_r452455347", "createdAt": "2020-07-09T19:55:50Z", "author": {"login": "jiekang"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/AbstractRecordingCommand.java", "diffHunk": "@@ -90,7 +94,24 @@ protected AbstractRecordingCommand(\n             if (ALL_EVENTS_TEMPLATE.getName().equals(templateName)) {\n                 return enableAllEvents(connection);\n             }\n-            return connection.getTemplateService().getEventsByTemplateName(templateName);\n+            // if a template name is specified, try to find a Custom template by that name. If none,\n+            // fall back on finding a target built-in template by that name. If not, throw an\n+            // exception and bail out.\n+            return connection", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a91c5df2242178e0713c448048ca0bd0a1ad17b5"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "261ff0c519929ed8510fd05c8aaec238c0b15614", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/261ff0c519929ed8510fd05c8aaec238c0b15614", "committedDate": "2020-07-09T20:18:46Z", "message": "More concise templates description"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a67c86173c0323e7bb4ba18ab819d0ff5902fe99", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/a67c86173c0323e7bb4ba18ab819d0ff5902fe99", "committedDate": "2020-07-09T20:19:16Z", "message": "Remove extra whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ec1c9cf4091079bd56bb7b6a18d98858343a660", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/9ec1c9cf4091079bd56bb7b6a18d98858343a660", "committedDate": "2020-07-09T21:27:04Z", "message": "Add syntax for specifying event template type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MjAxMjUz", "url": "https://github.com/cryostatio/cryostat/pull/199#pullrequestreview-448201253", "createdAt": "2020-07-14T15:10:07Z", "commit": {"oid": "9ec1c9cf4091079bd56bb7b6a18d98858343a660"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "840695e73a3050c9d69ed92d9dfa4c267e14007d", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/840695e73a3050c9d69ed92d9dfa4c267e14007d", "committedDate": "2020-07-14T20:53:39Z", "message": "Bump required container-jfr-core version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ae00e533c889008c59d0097f4d588405c365e0f", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/7ae00e533c889008c59d0097f4d588405c365e0f", "committedDate": "2020-07-14T20:54:11Z", "message": "Move JSoup dependency from test scope to compile\n\nRequired for -core local template service, which exposes the JSoup Document type as a return type"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3165, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}