{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MjIwMTQ0", "number": 253, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMDoxODo1NlrOEedW3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMDoxODo1NlrOEedW3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMzczNzI2OnYy", "diffSide": "RIGHT", "path": "src/main/extras/app/entrypoint.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMDoxODo1NlrOHKH0zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMDo0NDoyMFrOHKIlkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3NjAxMg==", "bodyText": "Should these be set to KEYSTORE_PATH and KEYSTORE_PASS?", "url": "https://github.com/cryostatio/cryostat/pull/253#discussion_r480376012", "createdAt": "2020-08-31T20:18:56Z", "author": {"login": "ebaron"}, "path": "src/main/extras/app/entrypoint.sh", "diffHunk": "@@ -108,35 +117,45 @@ FLAGS=(\n     \"-Dcom.sun.management.jmxremote.rmi.port=$CONTAINER_JFR_RMI_PORT\"\n     \"-Djavax.net.ssl.trustStore=$SSL_TRUSTSTORE\"\n     \"-Djavax.net.ssl.trustStorePassword=$SSL_TRUSTSTORE_PASS\"\n-    \"-Djavax.net.ssl.keyStore=$SSL_KEYSTORE\"\n-    \"-Djavax.net.ssl.keyStorePassword=$SSL_KEY_PASS\"\n )\n \n-if [ -z \"$CONTAINER_JFR_RJMX_AUTH\" ]; then\n-    # default to true. This should never be disabled in production deployments\n-    CONTAINER_JFR_RJMX_AUTH=true\n-fi\n-\n createSslStores\n importTrustStores\n-generateSslCert\n-if [ \"$CONTAINER_JFR_RJMX_AUTH\" = \"true\" ] || [ -n \"$CONTAINER_JFR_RJMX_USER\" ] ||\n-    [ -n \"$CONTAINER_JFR_RJMX_PASS\" ]; then\n-    createJmxCredentials\n \n+if [ \"$CONTAINER_JFR_DISABLE_JMX_AUTH\" = \"true\" ]; then\n+    banner \"JMX Auth Disabled\"\n+    FLAGS+=(\"-Dcom.sun.management.jmxremote.authenticate=false\")\n+else\n+    createJmxCredentials\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.authenticate=true\")\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.password.file=$PWFILE\")\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.access.file=$USRFILE\")\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl=true\")\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.registry.ssl=true\")\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl.need.client.auth=true\")\n-else\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.authenticate=false\")\n+fi\n+\n+if [ \"$CONTAINER_JFR_DISABLE_SSL\" = \"true\" ]; then\n+    banner \"SSL Disabled\"\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl=false\")\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.registry.ssl=false\")\n+else\n+    FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl.need.client.auth=true\")\n+\n+    if [ -z \"$KEYSTORE_PATH\" ] || [ -z \"$KEYSTORE_PASS\" ]; then\n+        generateSslCert\n+        banner \"Using self-signed SSL certificate\"\n+\n+        KEYSTORE_PATH=\"$SSL_KEYSTORE\"\n+        KEYSTORE_PASS=\"$SSL_KEY_PASS\"\n+    fi\n+\n+    FLAGS+=(\"-Djavax.net.ssl.keyStore=$SSL_KEYSTORE\")\n+    FLAGS+=(\"-Djavax.net.ssl.keyStorePassword=$SSL_KEY_PASS\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07d975adf0d445e48388f86327ebc7770fbc4de3"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM4ODQ5OQ==", "bodyText": "I think you're right. Fixed, thanks", "url": "https://github.com/cryostatio/cryostat/pull/253#discussion_r480388499", "createdAt": "2020-08-31T20:44:20Z", "author": {"login": "andrewazores"}, "path": "src/main/extras/app/entrypoint.sh", "diffHunk": "@@ -108,35 +117,45 @@ FLAGS=(\n     \"-Dcom.sun.management.jmxremote.rmi.port=$CONTAINER_JFR_RMI_PORT\"\n     \"-Djavax.net.ssl.trustStore=$SSL_TRUSTSTORE\"\n     \"-Djavax.net.ssl.trustStorePassword=$SSL_TRUSTSTORE_PASS\"\n-    \"-Djavax.net.ssl.keyStore=$SSL_KEYSTORE\"\n-    \"-Djavax.net.ssl.keyStorePassword=$SSL_KEY_PASS\"\n )\n \n-if [ -z \"$CONTAINER_JFR_RJMX_AUTH\" ]; then\n-    # default to true. This should never be disabled in production deployments\n-    CONTAINER_JFR_RJMX_AUTH=true\n-fi\n-\n createSslStores\n importTrustStores\n-generateSslCert\n-if [ \"$CONTAINER_JFR_RJMX_AUTH\" = \"true\" ] || [ -n \"$CONTAINER_JFR_RJMX_USER\" ] ||\n-    [ -n \"$CONTAINER_JFR_RJMX_PASS\" ]; then\n-    createJmxCredentials\n \n+if [ \"$CONTAINER_JFR_DISABLE_JMX_AUTH\" = \"true\" ]; then\n+    banner \"JMX Auth Disabled\"\n+    FLAGS+=(\"-Dcom.sun.management.jmxremote.authenticate=false\")\n+else\n+    createJmxCredentials\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.authenticate=true\")\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.password.file=$PWFILE\")\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.access.file=$USRFILE\")\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl=true\")\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.registry.ssl=true\")\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl.need.client.auth=true\")\n-else\n-    FLAGS+=(\"-Dcom.sun.management.jmxremote.authenticate=false\")\n+fi\n+\n+if [ \"$CONTAINER_JFR_DISABLE_SSL\" = \"true\" ]; then\n+    banner \"SSL Disabled\"\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl=false\")\n     FLAGS+=(\"-Dcom.sun.management.jmxremote.registry.ssl=false\")\n+else\n+    FLAGS+=(\"-Dcom.sun.management.jmxremote.ssl.need.client.auth=true\")\n+\n+    if [ -z \"$KEYSTORE_PATH\" ] || [ -z \"$KEYSTORE_PASS\" ]; then\n+        generateSslCert\n+        banner \"Using self-signed SSL certificate\"\n+\n+        KEYSTORE_PATH=\"$SSL_KEYSTORE\"\n+        KEYSTORE_PASS=\"$SSL_KEY_PASS\"\n+    fi\n+\n+    FLAGS+=(\"-Djavax.net.ssl.keyStore=$SSL_KEYSTORE\")\n+    FLAGS+=(\"-Djavax.net.ssl.keyStorePassword=$SSL_KEY_PASS\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3NjAxMg=="}, "originalCommit": {"oid": "07d975adf0d445e48388f86327ebc7770fbc4de3"}, "originalPosition": 109}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 866, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}