{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NDY5Mjk1", "number": 131, "title": "Use frontend plugin to build web-client", "bodyText": "The \"frontend\" plugin is a nice improvement over directly using the exec plugin\nto invoke \"npm\" for building the web-client. For one thing, the intent is more\nclear. But the real advantage is that the frontend plugin will automatically\ndownload and install Node and npm binaries into the bin directory, removing\nthe need for developers (or CI servers) to install Node and npm in order to\nbuild container-jfr. This also keeps versions consistent and makes builds more\nreproducible. These additional binaries will be removed on mvn clean, and\nare also cached in .m2, so the build time impact is very minimal after the first\nrun.", "createdAt": "2020-03-05T19:53:19Z", "url": "https://github.com/cryostatio/cryostat/pull/131", "merged": true, "mergeCommit": {"oid": "6d613dde7eaed7fa1990c648cb4e57486f2c5c28"}, "closed": true, "closedAt": "2020-03-10T15:29:47Z", "author": {"login": "andrewazores"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLBJt1ABqjMxMDU2MDQ4NTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMUKnOAFqTM3MjA1NzE3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e3790ba15ed12f181e2cce156efaf35c192df4d", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/8e3790ba15ed12f181e2cce156efaf35c192df4d", "committedDate": "2020-03-05T19:48:48Z", "message": "Use frontend plugin to build web-client\n\nUse specific \"frontend\" plugin for building -web submodule, rather than\ninvoking \"exec\" plugin directly"}, "afterCommit": {"oid": "360f57c142a41c69a976e622ec28cbc359fa687c", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/360f57c142a41c69a976e622ec28cbc359fa687c", "committedDate": "2020-03-06T14:39:40Z", "message": "Use frontend plugin to build web-client\n\nUse specific \"frontend\" plugin for building -web submodule, rather than\ninvoking \"exec\" plugin directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d1ba683bec0546090afc2ac0101999c794787722", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/d1ba683bec0546090afc2ac0101999c794787722", "committedDate": "2020-03-06T15:19:56Z", "message": "Ignore .factorypath"}, "afterCommit": {"oid": "54f1b71e1e16b95189201a09ff29fe7f092fa0bd", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/54f1b71e1e16b95189201a09ff29fe7f092fa0bd", "committedDate": "2020-03-09T19:53:30Z", "message": "Ignore .factorypath"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa31b1607843ff6ef1d035a844ea4a426aa41cc7", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/fa31b1607843ff6ef1d035a844ea4a426aa41cc7", "committedDate": "2020-03-09T20:06:20Z", "message": "Use frontend plugin to build web-client\n\nUse specific \"frontend\" plugin for building -web submodule, rather than\ninvoking \"exec\" plugin directly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "committedDate": "2020-03-09T20:06:20Z", "message": "Ignore .factorypath"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "54f1b71e1e16b95189201a09ff29fe7f092fa0bd", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/54f1b71e1e16b95189201a09ff29fe7f092fa0bd", "committedDate": "2020-03-09T19:53:30Z", "message": "Ignore .factorypath"}, "afterCommit": {"oid": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "committedDate": "2020-03-09T20:06:20Z", "message": "Ignore .factorypath"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNTk1MDQz", "url": "https://github.com/cryostatio/cryostat/pull/131#pullrequestreview-371595043", "createdAt": "2020-03-09T23:34:52Z", "commit": {"oid": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQyMzozNDo1MlrOFz8zYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQyMzozNDo1MlrOFz8zYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAxNzg5MA==", "bodyText": "Should we use ${containerjfr.imageVersion} instead of latest here? Also I had this task hang for me, but couldn't reproduce it. Not sure why.\nINFO] --- jib-maven-plugin:2.1.0:dockerBuild (build-oci-image) @ container-jfr ---\n[WARNING] Setting image creation time to current time; your image may not be reproducible.\n[INFO] \n[INFO] Containerizing application to Docker daemon as quay.io/rh-jmc-team/container-jfr, quay.io/rh-jmc-team/container-jfr:0.16.0...\n[WARNING] Base image 'gcr.io/distroless/java:11' does not use a specific image digest - build may not be reproducible\n[INFO] Using base image with digest: sha256:c94feda039172152495b5cd60a350a03162fce4f8986b560ea555de4d276ce19\n[INFO] \n[INFO] Container entrypoint set to [java, -XX:+CrashOnOutOfMemoryError, -Dcom.sun.management.jmxremote.port=9091, -Dcom.sun.management.jmxremote.ssl=false, -Dcom.sun.management.jmxremote.authenticate=false, -cp, /app/resources:/app/classes:/app/libs/*, com.redhat.rhjmc.containerjfr.ContainerJfr]\n[INFO] \n[INFO] Built image to Docker daemon as quay.io/rh-jmc-team/container-jfr, quay.io/rh-jmc-team/container-jfr:0.16.0\n[INFO] Executing tasks:\n[INFO] [==============================] 100.0% complete\n[INFO] \n[INFO] \n[INFO] --- exec-maven-plugin:1.6.0:exec (start-container) @ container-jfr ---\n^C", "url": "https://github.com/cryostatio/cryostat/pull/131#discussion_r390017890", "createdAt": "2020-03-09T23:34:52Z", "author": {"login": "ebaron"}, "path": "pom.xml", "diffHunk": "@@ -163,6 +166,65 @@\n         </annotationProcessorPaths>\n       </configuration>\n     </plugin>\n+    <plugin>\n+      <groupId>org.codehaus.mojo</groupId>\n+      <artifactId>exec-maven-plugin</artifactId>\n+      <version>${org.codehaus.mojo.exec.plugin.version}</version>\n+      <configuration>\n+        <mainClass>com.redhat.rhjmc.containerjfr.ContainerJfr</mainClass>\n+        <additionalClasspathElements>\n+          <additionalClasspathElement>${project.build.directory}/assets/app/resources</additionalClasspathElement>\n+        </additionalClasspathElements>\n+      </configuration>\n+      <executions>\n+        <execution>\n+          <id>start-container</id>\n+          <phase>pre-integration-test</phase>\n+          <goals>\n+            <goal>exec</goal>\n+          </goals>\n+          <configuration>\n+            <executable>${imageBuilder}</executable>\n+            <arguments>\n+              <argument>run</argument>\n+              <argument>--hostname=container-jfr</argument>\n+              <argument>--name=container-jfr-itest</argument>\n+              <argument>--publish</argument>\n+              <argument>9091:9091</argument>\n+              <argument>--publish</argument>\n+              <argument>${containerjfr.itest.webPort}:${containerjfr.itest.webPort}</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_LOG_LEVEL=ALL</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_WEB_HOST=0.0.0.0</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_LISTEN_HOST=0.0.0.0</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_WEB_PORT=${containerjfr.itest.webPort}</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_EXT_WEB_PORT=${containerjfr.itest.webPort}</argument>\n+              <argument>--detach</argument>\n+              <argument>--rm</argument>\n+              <argument>${containerjfr.imageStream}:latest</argument>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dd26ed21d79230d0e37003ae3b84f6afe5250c3", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/6dd26ed21d79230d0e37003ae3b84f6afe5250c3", "committedDate": "2020-03-10T14:57:54Z", "message": "Integration tests use tagged image version, not latest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMDU3MTc0", "url": "https://github.com/cryostatio/cryostat/pull/131#pullrequestreview-372057174", "createdAt": "2020-03-10T15:22:52Z", "commit": {"oid": "6dd26ed21d79230d0e37003ae3b84f6afe5250c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3127, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}