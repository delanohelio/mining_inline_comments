{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2NTU5NTA0", "number": 107, "title": "Basic authmanager", "bodyText": "Fixes #103\nBased on top of currently open PR #105", "createdAt": "2020-01-23T20:45:41Z", "url": "https://github.com/cryostatio/cryostat/pull/107", "merged": true, "mergeCommit": {"oid": "aebc881fe947a9a720c8cf158d897fa6aeaa278d"}, "closed": true, "closedAt": "2020-01-24T22:30:47Z", "author": {"login": "andrewazores"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9RIRkAFqTM0NzYxNTgzOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9mic-AFqTM0ODI1NjkxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NjE1ODM5", "url": "https://github.com/cryostatio/cryostat/pull/107#pullrequestreview-347615839", "createdAt": "2020-01-23T21:21:43Z", "commit": {"oid": "e0c7dba13ad1e4ec84ef3cdfd87026e5e0c71045"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QyMToyMTo0NFrOFhNCJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QyMToyMTo0NFrOFhNCJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2MDg3MA==", "bodyText": "Would it be overkill to operate on character arrays for anything dealing with the incoming credentials and nulling out the password characters immediately after use?", "url": "https://github.com/cryostatio/cryostat/pull/107#discussion_r370360870", "createdAt": "2020-01-23T21:21:44Z", "author": {"login": "jiekang"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/net/BasicAuthManager.java", "diffHunk": "@@ -0,0 +1,121 @@\n+package com.redhat.rhjmc.containerjfr.net;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Path;\n+import java.util.Base64;\n+import java.util.Objects;\n+import java.util.Properties;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.Future;\n+import java.util.function.Supplier;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+import com.redhat.rhjmc.containerjfr.core.log.Logger;\n+import com.redhat.rhjmc.containerjfr.core.sys.FileSystem;\n+\n+import org.apache.commons.codec.digest.DigestUtils;\n+import org.apache.commons.lang3.StringUtils;\n+\n+class BasicAuthManager extends AbstractAuthManager {\n+\n+    static final String USER_PROPERTIES_FILENAME = \"container-jfr-users.properties\";\n+\n+    private final FileSystem fs;\n+    private final Properties users;\n+    private volatile boolean configLoaded = false;\n+\n+    // TODO salted hashes\n+    BasicAuthManager(Logger logger, FileSystem fs) {\n+        super(logger);\n+        this.fs = fs;\n+        this.users = new Properties();\n+    }\n+\n+    @Override\n+    public Future<Boolean> validateToken(Supplier<String> tokenProvider) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0c7dba13ad1e4ec84ef3cdfd87026e5e0c71045"}, "originalPosition": 38}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e0b0741b18bdf38c644b52dec4107c141a992f25", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/e0b0741b18bdf38c644b52dec4107c141a992f25", "committedDate": "2020-01-23T22:09:01Z", "message": "Remove unnecessary String trims"}, "afterCommit": {"oid": "52c3da7d204bf410247d3738a555452481c7bce1", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/52c3da7d204bf410247d3738a555452481c7bce1", "committedDate": "2020-01-23T22:02:03Z", "message": "Use named constant for Authorization header name"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5885ffca740b8423d4febb0ed3cd9a6568ecb22a", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/5885ffca740b8423d4febb0ed3cd9a6568ecb22a", "committedDate": "2020-01-24T17:56:09Z", "message": "Instruct users to user npm ci, not npm install"}, "afterCommit": {"oid": "7ebb312ac4c896f2a56bd24ab555cc1e00c74691", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/7ebb312ac4c896f2a56bd24ab555cc1e00c74691", "committedDate": "2020-01-24T17:57:27Z", "message": "Use named constant for Authorization header name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MjUxNjI2", "url": "https://github.com/cryostatio/cryostat/pull/107#pullrequestreview-348251626", "createdAt": "2020-01-24T22:05:16Z", "commit": {"oid": "0ed7db3486d411ae6d110bcbd0561682d1752fb9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91992b40e744b6afcbbdaaff593f194f229e0185", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/91992b40e744b6afcbbdaaff593f194f229e0185", "committedDate": "2020-01-24T22:12:01Z", "message": "Modify AuthManager interface for specific WebSocket/HTTP handling\n\nRather than validating generic and contextless tokens, methods are added\ncorresponding to WebSocket SubProtocol and HTTP Header processing as\nwell, so that AuthManager implementations can also directly perform auth\non these types of requests without AuthManager consumers (ex.\nMessagingServer and WebServer) needing to massage the request first to\nextract the token to provide to the AuthManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d65befba7d77cb52cef25b72603f69bbb5646c3d", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/d65befba7d77cb52cef25b72603f69bbb5646c3d", "committedDate": "2020-01-24T22:12:01Z", "message": "Implement first-pass Basic AuthManager\n\nAuthManager which uses a standard Java Properties file as backing for\nHTTP Basic authorization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d95e91bcbcfddc98d75561c979125ec4117b107", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/1d95e91bcbcfddc98d75561c979125ec4117b107", "committedDate": "2020-01-24T22:12:01Z", "message": "Allow more lenient whitespace in Authorization header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0da738aeece611ea0738b999f54e7cc4a8f4e75", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/b0da738aeece611ea0738b999f54e7cc4a8f4e75", "committedDate": "2020-01-24T22:12:01Z", "message": "Expect WebSocket subprotocol token to be base64 encoded"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "160265ce1c4b21e3392d70abeefc9ac487542697", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/160265ce1c4b21e3392d70abeefc9ac487542697", "committedDate": "2020-01-24T22:12:01Z", "message": "Gracefully handle malformed/invalid base64 inputs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07d27fdeeaab429236bb822d1da8619299c0015e", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/07d27fdeeaab429236bb822d1da8619299c0015e", "committedDate": "2020-01-24T22:12:01Z", "message": "Return false futures rather than null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74767a6fed65365d56cdeac3b8efbc6ddca86b9b", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/74767a6fed65365d56cdeac3b8efbc6ddca86b9b", "committedDate": "2020-01-24T22:12:01Z", "message": "Guard against blank strings, not just nulls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4168bbafd530af0de05e382056e0ee4679c165bb", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/4168bbafd530af0de05e382056e0ee4679c165bb", "committedDate": "2020-01-24T22:12:01Z", "message": "Update web-client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2e5a31399f08c269bc8bb174362f3db5e724874", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/a2e5a31399f08c269bc8bb174362f3db5e724874", "committedDate": "2020-01-24T22:12:01Z", "message": "Expect user properties to contain sha256 password hashes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1e5b3d55e5257479f66ee029e94460a06192389", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/f1e5b3d55e5257479f66ee029e94460a06192389", "committedDate": "2020-01-24T22:12:01Z", "message": "Update auth manager documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e57770556a8a526b6fd3de2cba910590841f69f", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/4e57770556a8a526b6fd3de2cba910590841f69f", "committedDate": "2020-01-24T22:12:01Z", "message": "Add FileSystem to AuthManager reflective construction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b50d8abbc86d026f9293b4cec164e254ef898290", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/b50d8abbc86d026f9293b4cec164e254ef898290", "committedDate": "2020-01-24T22:12:01Z", "message": "Update container-jfr-core version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15b97de14dc9b47272979607fc9c3419e06e1e4e", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/15b97de14dc9b47272979607fc9c3419e06e1e4e", "committedDate": "2020-01-24T22:12:01Z", "message": "Use FileSystem abstraction rather than direct nio Files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3da1a9ad75c370bd5f4dab085a067c8655778b15", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/3da1a9ad75c370bd5f4dab085a067c8655778b15", "committedDate": "2020-01-24T22:12:01Z", "message": "Fix Spotbugs charset violations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b4a793dcfdddfe6afe91da2fab03d78ce277f6a", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/1b4a793dcfdddfe6afe91da2fab03d78ce277f6a", "committedDate": "2020-01-24T22:12:01Z", "message": "Lazily load properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cf96773d6313eb7fbaa5b199d5e779c1ae25e72", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/8cf96773d6313eb7fbaa5b199d5e779c1ae25e72", "committedDate": "2020-01-24T22:12:01Z", "message": "Add BasicAuthManagerTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72e63b2e14068da45f729e5518f59b22aec37432", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/72e63b2e14068da45f729e5518f59b22aec37432", "committedDate": "2020-01-24T22:12:01Z", "message": "Remove outdated TODO"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3507a003b8d260b54d1a141125f85f17f2636be", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/a3507a003b8d260b54d1a141125f85f17f2636be", "committedDate": "2020-01-24T22:12:01Z", "message": "Use named constant for Authorization header name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "234859476998a585aaeb03ca42c84f6bf18eaadd", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/234859476998a585aaeb03ca42c84f6bf18eaadd", "committedDate": "2020-01-24T22:12:01Z", "message": "Add test for malformed basic auth properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58f16541a2390c3183757e97b0efb6f26d4ad91d", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/58f16541a2390c3183757e97b0efb6f26d4ad91d", "committedDate": "2020-01-24T22:12:01Z", "message": "Use BufferedReader for efficient properties loading"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0ed7db3486d411ae6d110bcbd0561682d1752fb9", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/0ed7db3486d411ae6d110bcbd0561682d1752fb9", "committedDate": "2020-01-24T21:11:36Z", "message": "Use BufferedReader for efficient properties loading"}, "afterCommit": {"oid": "58f16541a2390c3183757e97b0efb6f26d4ad91d", "author": {"user": {"login": "andrewazores", "name": "Andrew Azores"}}, "url": "https://github.com/cryostatio/cryostat/commit/58f16541a2390c3183757e97b0efb6f26d4ad91d", "committedDate": "2020-01-24T22:12:01Z", "message": "Use BufferedReader for efficient properties loading"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MjU2OTE2", "url": "https://github.com/cryostatio/cryostat/pull/107#pullrequestreview-348256916", "createdAt": "2020-01-24T22:18:20Z", "commit": {"oid": "58f16541a2390c3183757e97b0efb6f26d4ad91d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3114, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}