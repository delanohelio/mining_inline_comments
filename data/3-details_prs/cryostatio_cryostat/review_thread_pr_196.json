{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNTg3MTUy", "number": 196, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QyMTo0NDozN1rOESkbYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QyMTo0NDozN1rOESkbYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3OTA2NjU2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/UploadRecordingCommand.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QyMTo0NDozN1rOG30tZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QyMjoyNjoxNlrOG31wtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE4ODQ1Mg==", "bodyText": "Does this work if the user sets the env var to ex. http://localhost:8080/, with a trailing slash?", "url": "https://github.com/cryostatio/cryostat/pull/196#discussion_r461188452", "createdAt": "2020-07-27T21:44:37Z", "author": {"login": "andrewazores"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/UploadRecordingCommand.java", "diffHunk": "@@ -110,7 +110,7 @@ public String getName() {\n     public void execute(String[] args) throws Exception {\n         String targetId = args[0];\n         String recordingName = args[1];\n-        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV);\n+        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV).concat(\"/load\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d9064a84bca02c91904aa2a14ad0e99a504041a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE5Nzk3Mg==", "bodyText": "Yes, tested just now and it works.", "url": "https://github.com/cryostatio/cryostat/pull/196#discussion_r461197972", "createdAt": "2020-07-27T22:06:36Z", "author": {"login": "vic-ma"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/UploadRecordingCommand.java", "diffHunk": "@@ -110,7 +110,7 @@ public String getName() {\n     public void execute(String[] args) throws Exception {\n         String targetId = args[0];\n         String recordingName = args[1];\n-        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV);\n+        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV).concat(\"/load\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE4ODQ1Mg=="}, "originalCommit": {"oid": "9d9064a84bca02c91904aa2a14ad0e99a504041a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE5ODg3Ng==", "bodyText": "Cool. I thought a double-slash might break things, since it could be interpreted as a null or empty string as the first path segment. If the Vertx webclient and the jfr-datasource both accept this then no worries.", "url": "https://github.com/cryostatio/cryostat/pull/196#discussion_r461198876", "createdAt": "2020-07-27T22:09:00Z", "author": {"login": "andrewazores"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/UploadRecordingCommand.java", "diffHunk": "@@ -110,7 +110,7 @@ public String getName() {\n     public void execute(String[] args) throws Exception {\n         String targetId = args[0];\n         String recordingName = args[1];\n-        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV);\n+        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV).concat(\"/load\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE4ODQ1Mg=="}, "originalCommit": {"oid": "9d9064a84bca02c91904aa2a14ad0e99a504041a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTIwNDY1MA==", "bodyText": "Yeah, when I was working on the web client I had a trailing slash at first and I noticed that even though the logs said it was uploading to http://localhost:8080//load which seemed like it'd break for sure, it was working. I guess it's cool that that works; makes stuff like this a lot easier.", "url": "https://github.com/cryostatio/cryostat/pull/196#discussion_r461204650", "createdAt": "2020-07-27T22:23:53Z", "author": {"login": "vic-ma"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/UploadRecordingCommand.java", "diffHunk": "@@ -110,7 +110,7 @@ public String getName() {\n     public void execute(String[] args) throws Exception {\n         String targetId = args[0];\n         String recordingName = args[1];\n-        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV);\n+        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV).concat(\"/load\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE4ODQ1Mg=="}, "originalCommit": {"oid": "9d9064a84bca02c91904aa2a14ad0e99a504041a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTIwNTY4NA==", "bodyText": "It isn't too hard to clean it up anyway. There are cleaner ways using URIBuilder and such, but with just plain JDK (and ContainerJFR) classes:\nnew URL(env.getEnv(GRAFANA_DATASOURCE_ENV)).toURI().resolve(\"/load\").normalize().toString()\nshould do it.", "url": "https://github.com/cryostatio/cryostat/pull/196#discussion_r461205684", "createdAt": "2020-07-27T22:26:16Z", "author": {"login": "andrewazores"}, "path": "src/main/java/com/redhat/rhjmc/containerjfr/commands/internal/UploadRecordingCommand.java", "diffHunk": "@@ -110,7 +110,7 @@ public String getName() {\n     public void execute(String[] args) throws Exception {\n         String targetId = args[0];\n         String recordingName = args[1];\n-        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV);\n+        String datasourceUrl = env.getEnv(GRAFANA_DATASOURCE_ENV).concat(\"/load\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTE4ODQ1Mg=="}, "originalCommit": {"oid": "9d9064a84bca02c91904aa2a14ad0e99a504041a"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 836, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}