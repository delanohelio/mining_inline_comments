{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1MzcxMTU3", "number": 678, "reviewThreads": {"totalCount": 55, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NVrOEMDFPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOEMIvrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODYzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NVrOGt7pkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NVrOGt7pkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQwMg==", "bodyText": "[PMD Java] Rather than using a lot of String arguments, consider using a container object for those values. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nUseObjectForClearerAPI\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816402", "createdAt": "2020-07-07T12:10:55Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,38 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n-        generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODY3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQwOQ==", "bodyText": "[PMD Java] A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidUncheckedExceptionsInSignatures\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816409", "createdAt": "2020-07-07T12:10:56Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,38 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n-        generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODcwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQxMQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816411", "createdAt": "2020-07-07T12:10:56Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -140,48 +165,57 @@ void generateJavaFiles(\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 128}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODcyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQxMw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816413", "createdAt": "2020-07-07T12:10:56Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 186}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODc1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQxOQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816419", "createdAt": "2020-07-07T12:10:56Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 191}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODc2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7ppQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7ppQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyMQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816421", "createdAt": "2020-07-07T12:10:56Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 198}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODc3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1NlrOGt7pqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyNA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816424", "createdAt": "2020-07-07T12:10:56Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 200}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODgwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7prA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7prA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyOA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816428", "createdAt": "2020-07-07T12:10:57Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 202}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODgxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7prQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7prQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyOQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816429", "createdAt": "2020-07-07T12:10:57Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +289,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n-\n-            String item = abiContent.substring(offset, offset + length);\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 226}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODgyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7prg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7prg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzMA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816430", "createdAt": "2020-07-07T12:10:57Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +289,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n-\n-            String item = abiContent.substring(offset, offset + length);\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 237}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODg1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7psQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7psQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzMw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816433", "createdAt": "2020-07-07T12:10:57Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +289,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n-\n-            String item = abiContent.substring(offset, offset + length);\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));\n \n         return FieldSpec.builder(String[].class, \"ABI_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", abiArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", abiArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 242}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODg4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7ptA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7ptA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzNg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816436", "createdAt": "2020-07-07T12:10:57Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -465,6 +509,27 @@ private static MethodSpec buildReturnTransactionDecoder() {\n         return toReturn.build();\n     }\n \n+    private static MethodSpec buildBinaryMethod(String smBin) {\n+\n+        MethodSpec.Builder toReturn =\n+                MethodSpec.methodBuilder(\"getBinary\")\n+                        .addModifiers(Modifier.PUBLIC, Modifier.STATIC)\n+                        .returns(String.class);\n+\n+        if (smBin.equals(Contract.BIN_NOT_PROVIDED)) {\n+            toReturn.addStatement(\"return $N\", BINARY);\n+        } else {\n+            toReturn.addStatement(\n+                    \"return ($T.encryptType == $T.ECDSA_TYPE ? $N : $N)\",\n+                    EncryptType.class,\n+                    EncryptType.class,\n+                    BINARY,\n+                    SM_BINARY);\n+        }\n+\n+        return toReturn.build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 282}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODg5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7ptQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1N1rOGt7ptQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzNw==", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816437", "createdAt": "2020-07-07T12:10:57Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -41,6 +43,7 @@\n      */\n \n     private final File binFile;\n+    private final File smBinFile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODkyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7puA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7puA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0MA==", "bodyText": "[PMD Java] Found 'DD'-anomaly for variable 'smBinary' (lines '80'-'88'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816440", "createdAt": "2020-07-07T12:10:58Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -63,11 +77,17 @@ private SolidityFunctionWrapperGenerator(\n \n     private void generate() throws IOException, ClassNotFoundException {\n         String binary = Contract.BIN_NOT_PROVIDED;\n+        String smBinary = Contract.BIN_NOT_PROVIDED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODk0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0Mg==", "bodyText": "[PMD Java] Found 'DU'-anomaly for variable 'smBinary' (lines '80'-'109'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816442", "createdAt": "2020-07-07T12:10:58Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -63,11 +77,17 @@ private SolidityFunctionWrapperGenerator(\n \n     private void generate() throws IOException, ClassNotFoundException {\n         String binary = Contract.BIN_NOT_PROVIDED;\n+        String smBinary = Contract.BIN_NOT_PROVIDED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODk1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0NA==", "bodyText": "[PMD Java] Found 'DU'-anomaly for variable 'smBinary' (lines '88'-'109'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816444", "createdAt": "2020-07-07T12:10:58Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -63,11 +77,17 @@ private SolidityFunctionWrapperGenerator(\n \n     private void generate() throws IOException, ClassNotFoundException {\n         String binary = Contract.BIN_NOT_PROVIDED;\n+        String smBinary = Contract.BIN_NOT_PROVIDED;\n         if (binFile != null) {\n             byte[] bytes = Files.readBytes(binFile);\n             binary = new String(bytes);\n         }\n \n+        if (smBinFile != null) {\n+            byte[] bytes = Files.readBytes(smBinFile);\n+            smBinary = new String(bytes);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODk2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0Ng==", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816446", "createdAt": "2020-07-07T12:10:58Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -119,6 +140,14 @@ public static void main(String[] args) {\n                 required = false)\n         private File binFile;\n \n+        @Option(\n+                names = {\"-s\", \"--smBinFile\"},\n+                description =\n+                        \"sm bin file with contract compiled code \"\n+                                + \"in order to generate deploy methods.\",\n+                required = false)\n+        private File smBinFile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4ODk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/TruffleJsonFunctionWrapperGenerator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OFrOGt7pwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0OA==", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816448", "createdAt": "2020-07-07T12:10:58Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/TruffleJsonFunctionWrapperGenerator.java", "diffHunk": "@@ -161,7 +160,7 @@ private void generate() throws IOException, ClassNotFoundException {\n         public String contractName;\n \n         @JsonProperty(value = \"abi\", required = true)\n-        public List<AbiDefinition> abi;\n+        public String abi;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTAyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ1Mw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816453", "createdAt": "2020-07-07T12:10:59Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "diffHunk": "@@ -64,11 +64,11 @@ private static TransactionDecoder compileContract(String contractName, File solF\n                 continue;\n             }\n             SolidityCompiler.Result res =\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\n-            if (\"\".equals(res.output)) {\n-                throw new CompileSolidityException(\"Compile error: \" + res.errors);\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\n+            if (\"\".equals(res.getOutput())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTA1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ1NQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816455", "createdAt": "2020-07-07T12:10:59Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "diffHunk": "@@ -64,11 +64,11 @@ private static TransactionDecoder compileContract(String contractName, File solF\n                 continue;\n             }\n             SolidityCompiler.Result res =\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\n-            if (\"\".equals(res.output)) {\n-                throw new CompileSolidityException(\"Compile error: \" + res.errors);\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\n+            if (\"\".equals(res.getOutput())) {\n+                throw new CompileSolidityException(\"Compile error: \" + res.getErrors());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTA2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ1Ng==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816456", "createdAt": "2020-07-07T12:10:59Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "diffHunk": "@@ -64,11 +64,11 @@ private static TransactionDecoder compileContract(String contractName, File solF\n                 continue;\n             }\n             SolidityCompiler.Result res =\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\n-            if (\"\".equals(res.output)) {\n-                throw new CompileSolidityException(\"Compile error: \" + res.errors);\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\n+            if (\"\".equals(res.getOutput())) {\n+                throw new CompileSolidityException(\"Compile error: \" + res.getErrors());\n             }\n-            CompilationResult result = CompilationResult.parse(res.output);\n+            CompilationResult result = CompilationResult.parse(res.getOutput());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTA4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ2MA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816460", "createdAt": "2020-07-07T12:10:59Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTEwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDo1OVrOGt7pzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ2Mg==", "bodyText": "[PMD Java] System.out.println is used (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSystemPrintln\nBest Practices\n2\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816462", "createdAt": "2020-07-07T12:10:59Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTEzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ2Nw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816467", "createdAt": "2020-07-07T12:11:00Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTE4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3MQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816471", "createdAt": "2020-07-07T12:11:00Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTIwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3Mw==", "bodyText": "[PMD Java] Avoid using Literals in Conditional Statements (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidLiteralsInIfCondition\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#avoidliteralsinifcondition\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816473", "createdAt": "2020-07-07T12:11:00Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTIzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3Nw==", "bodyText": "[PMD Java] System.out.println is used (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSystemPrintln\nBest Practices\n2\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816477", "createdAt": "2020-07-07T12:11:00Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTI0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3OQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816479", "createdAt": "2020-07-07T12:11:00Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTI1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMFrOGt7p4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ4Mg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816482", "createdAt": "2020-07-07T12:11:00Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r\n+                return;\r\n+            }\r\n+\r\n+            CompilationResult result = CompilationResult.parse(res.getOutput());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDY4OTI4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMVrOGt7p5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMTowMVrOGt7p5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ4NA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816484", "createdAt": "2020-07-07T12:11:01Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r\n+                return;\r\n+            }\r\n+\r\n+            CompilationResult result = CompilationResult.parse(res.getOutput());\r\n+            CompilationResult smResult = CompilationResult.parse(smRes.getOutput());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDM1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDc5OQ==", "bodyText": "[PMD Java] Rather than using a lot of String arguments, consider using a container object for those values. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nUseObjectForClearerAPI\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854799", "createdAt": "2020-07-07T13:15:33Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,39 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDM5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_lA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgwNA==", "bodyText": "[PMD Java] A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidUncheckedExceptionsInSignatures\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854804", "createdAt": "2020-07-07T13:15:33Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,39 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n     }\n \n     void generateJavaFiles(\n             String contractName,\n             String bin,\n-            List<AbiDefinition> abi,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDQxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgwOQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854809", "createdAt": "2020-07-07T13:15:33Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -140,48 +166,59 @@ void generateJavaFiles(\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 128}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDQzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozM1rOGt9_nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxMw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854813", "createdAt": "2020-07-07T13:15:33Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -140,48 +166,59 @@ void generateJavaFiles(\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)\n+                                        .addMember(\"value\", \"$S\", \"unchecked\")\n+                                        .build())\n+                        // binary fields\n+                        .addField(createBinaryArrayDefinition(binary))\n+                        .addField(createBinaryDefinition())\n+                        // abi fields\n+                        .addField(createABIArrayDefinition(abi))\n+                        .addField(createABIDefinition())\n+                        .addField(createTransactionDecoderDefinition());\n \n-        return TypeSpec.classBuilder(className)\n-                .addModifiers(Modifier.PUBLIC)\n-                .addJavadoc(javadoc)\n-                .superclass(Contract.class)\n-                .addAnnotation(\n-                        AnnotationSpec.builder(SuppressWarnings.class)\n-                                .addMember(\"value\", \"$S\", \"unchecked\")\n-                                .build())\n-                .addField(createBinaryArrayDefinition(binary))\n-                .addField(createBinaryDefinition())\n-                .addField(createABIArrayDefinition())\n-                .addField(createABIDefinition())\n-                .addField(createTransactionDecoderDefinition());\n+        if (!smBinary.equalsIgnoreCase(Contract.BIN_NOT_PROVIDED)) {\n+            builder.addField(createSMBinaryArrayDefinition(smBinary))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 153}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDQ4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_oA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_oA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxNg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854816", "createdAt": "2020-07-07T13:15:34Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 188}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxNw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854817", "createdAt": "2020-07-07T13:15:34Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 193}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDUwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxOQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854819", "createdAt": "2020-07-07T13:15:34Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 200}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDUxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgyMg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854822", "createdAt": "2020-07-07T13:15:34Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 202}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDU0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_qQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNFrOGt9_qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgyNQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854825", "createdAt": "2020-07-07T13:15:34Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 204}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDU1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgyNw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854827", "createdAt": "2020-07-07T13:15:35Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +292,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 226}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDU5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgzMg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854832", "createdAt": "2020-07-07T13:15:35Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +292,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 239}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDYwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgzNw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854837", "createdAt": "2020-07-07T13:15:35Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +292,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));\n \n         return FieldSpec.builder(String[].class, \"ABI_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", abiArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", abiArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 244}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDkzNDYzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMzoxNTozNVrOGt9_ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDg0Mg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854842", "createdAt": "2020-07-07T13:15:35Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -465,6 +512,27 @@ private static MethodSpec buildReturnTransactionDecoder() {\n         return toReturn.build();\n     }\n \n+    private static MethodSpec buildBinaryMethod(String smBin) {\n+\n+        MethodSpec.Builder toReturn =\n+                MethodSpec.methodBuilder(\"getBinary\")\n+                        .addModifiers(Modifier.PUBLIC, Modifier.STATIC)\n+                        .returns(String.class);\n+\n+        if (smBin.equals(Contract.BIN_NOT_PROVIDED)) {\n+            toReturn.addStatement(\"return $N\", BINARY);\n+        } else {\n+            toReturn.addStatement(\n+                    \"return ($T.encryptType == $T.ECDSA_TYPE ? $N : $N)\",\n+                    EncryptType.class,\n+                    EncryptType.class,\n+                    BINARY,\n+                    SM_BINARY);\n+        }\n+\n+        return toReturn.build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601"}, "originalPosition": 284}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjIwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyN1rOGuErfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyN1rOGuErfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM1MA==", "bodyText": "[PMD Java] A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidUncheckedExceptionsInSignatures\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964350", "createdAt": "2020-07-07T15:45:27Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,74 +121,107 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjI0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyN1rOGuErgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyN1rOGuErgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM1NQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964355", "createdAt": "2020-07-07T15:45:27Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,74 +121,107 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName, addresses);\n     }\n \n     void generateJavaFiles(\n             String contractName,\n             String bin,\n-            List<AbiDefinition> abi,\n+            String smBin,\n+            String abi,\n             String destinationDir,\n             String basePackageName,\n             Map<String, String> addresses)\n             throws IOException, ClassNotFoundException, UnsupportedOperationException {\n         String className = Strings.capitaliseFirstLetter(contractName);\n \n+        logger.info(\"bin: {}\", bin);\n+        logger.info(\"smBin: {}\", smBin);\n+\n         if (bin.length() > maxSolidityBinSize) {\n             throw new UnsupportedOperationException(\n                     \" contract binary too long, max support is 256k, now is \"\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 136}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjI1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM1Nw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964357", "createdAt": "2020-07-07T15:45:28Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,74 +121,107 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName, addresses);\n     }\n \n     void generateJavaFiles(\n             String contractName,\n             String bin,\n-            List<AbiDefinition> abi,\n+            String smBin,\n+            String abi,\n             String destinationDir,\n             String basePackageName,\n             Map<String, String> addresses)\n             throws IOException, ClassNotFoundException, UnsupportedOperationException {\n         String className = Strings.capitaliseFirstLetter(contractName);\n \n+        logger.info(\"bin: {}\", bin);\n+        logger.info(\"smBin: {}\", smBin);\n+\n         if (bin.length() > maxSolidityBinSize) {\n             throw new UnsupportedOperationException(\n                     \" contract binary too long, max support is 256k, now is \"\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)\n+                                        .addMember(\"value\", \"$S\", \"unchecked\")\n+                                        .build())\n+                        // binary fields\n+                        .addField(createBinaryArrayDefinition(binary))\n+                        .addField(createBinaryDefinition())\n+                        // abi fields\n+                        .addField(createABIArrayDefinition(abi))\n+                        .addField(createABIDefinition())\n+                        .addField(createTransactionDecoderDefinition());\n \n-        return TypeSpec.classBuilder(className)\n-                .addModifiers(Modifier.PUBLIC)\n-                .addJavadoc(javadoc)\n-                .superclass(Contract.class)\n-                .addAnnotation(\n-                        AnnotationSpec.builder(SuppressWarnings.class)\n-                                .addMember(\"value\", \"$S\", \"unchecked\")\n-                                .build())\n-                .addField(createBinaryArrayDefinition(binary))\n-                .addField(createBinaryDefinition())\n-                .addField(createABIArrayDefinition())\n-                .addField(createABIDefinition())\n-                .addField(createTransactionDecoderDefinition());\n+        if (!smBinary.equalsIgnoreCase(Contract.BIN_NOT_PROVIDED)) {\n+            builder.addField(createSMBinaryArrayDefinition(smBinary))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 161}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjMwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM2Mg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964362", "createdAt": "2020-07-07T15:45:28Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 196}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjMyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM2Nw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964367", "createdAt": "2020-07-07T15:45:28Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 201}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjM0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOFrOGuErkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM3MA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964370", "createdAt": "2020-07-07T15:45:28Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 208}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjM3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM3NQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964375", "createdAt": "2020-07-07T15:45:29Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 210}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjM4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM3OA==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964378", "createdAt": "2020-07-07T15:45:29Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 212}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjQxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4Mg==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964382", "createdAt": "2020-07-07T15:45:29Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +295,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 234}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjQyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4Mw==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964383", "createdAt": "2020-07-07T15:45:29Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +295,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 247}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjQzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuEroQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuEroQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4NQ==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964385", "createdAt": "2020-07-07T15:45:29Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +295,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));\n \n         return FieldSpec.builder(String[].class, \"ABI_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", abiArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", abiArray.toArray())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 252}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMTYxNjQ0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNTo0NToyOVrOGuErog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4Ng==", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964386", "createdAt": "2020-07-07T15:45:29Z", "author": {"login": "sider"}, "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -465,6 +515,27 @@ private static MethodSpec buildReturnTransactionDecoder() {\n         return toReturn.build();\n     }\n \n+    private static MethodSpec buildBinaryMethod(String smBin) {\n+\n+        MethodSpec.Builder toReturn =\n+                MethodSpec.methodBuilder(\"getBinary\")\n+                        .addModifiers(Modifier.PUBLIC, Modifier.STATIC)\n+                        .returns(String.class);\n+\n+        if (smBin.equals(Contract.BIN_NOT_PROVIDED)) {\n+            toReturn.addStatement(\"return $N\", BINARY);\n+        } else {\n+            toReturn.addStatement(\n+                    \"return ($T.encryptType == $T.ECDSA_TYPE ? $N : $N)\",\n+                    EncryptType.class,\n+                    EncryptType.class,\n+                    BINARY,\n+                    SM_BINARY);\n+        }\n+\n+        return toReturn.build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948"}, "originalPosition": 292}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 575, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}