{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNDE0Nzcy", "number": 652, "title": "Cleanup XFunctionTypeRefs", "bodyText": "Signed-off-by: nbhusare neerajbhusare@gmail.com", "createdAt": "2020-10-12T08:30:48Z", "url": "https://github.com/eclipse/xtext-extras/pull/652", "merged": true, "mergeCommit": {"oid": "dabd2705b7f2ec21e99dcdcbcb5897f0473179f9"}, "closed": true, "closedAt": "2020-10-13T17:28:45Z", "author": {"login": "nbhusare"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRwSs0gFqTUwNjQzMDExMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSK2d-gFqTUwNzYwMTMzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NDMwMTEw", "url": "https://github.com/eclipse/xtext-extras/pull/652#pullrequestreview-506430110", "createdAt": "2020-10-12T09:04:10Z", "commit": {"oid": "ab46955889b1c79c8eae31494e3701cf38b73e5b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwOTowNDoxMVrOHf1qAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwOTowODozNVrOHf10hw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzE0NzAwOA==", "bodyText": "I'm not sure that converting this to a URI and subsequently calling toString again is a good tradeoff.\nYou may want to replace the literal \"java:/Objects/\" by a concatenation from URIHelperConstants, though.\nSince buildURI is only used from within this class, it could also be an option to overhaul the flow and do something based on Class.forName instead or even keep an immutable list of the 2x6 allowed combinations such that we can return the URI in constant time without any string / URI manipulation.", "url": "https://github.com/eclipse/xtext-extras/pull/652#discussion_r503147008", "createdAt": "2020-10-12T09:04:11Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.xbase/src/org/eclipse/xtext/xtype/util/XFunctionTypeRefs.java", "diffHunk": "@@ -19,25 +19,29 @@\n import org.eclipse.xtext.common.types.JvmVoid;\n import org.eclipse.xtext.common.types.TypesFactory;\n import org.eclipse.xtext.common.types.access.impl.ClassURIHelper;\n+import org.eclipse.xtext.common.types.util.Primitives;\n import org.eclipse.xtext.xbase.lib.Functions;\n import org.eclipse.xtext.xbase.lib.Procedures;\n \n /**\n  * @author Anton Kosyakov - Initial contribution and API\n  */\n public class XFunctionTypeRefs {\n+\t\n+\tprivate static final Primitives primitives = new Primitives();\n+\n+\tprivate static final ClassURIHelper classURIHelper = new ClassURIHelper();\n+\t\n \tpublic static URI computeTypeUri(boolean procedure, int functionParamCount) {\n \t\treturn URI.createURI(buildUri(procedure, functionParamCount));\n \t}\n \n \tpublic static String buildUri(boolean procedure, int functionParamCount) {\n \t\tint paramCount = Math.min(6, functionParamCount);\n \t\tif (procedure) {\n-\t\t\treturn \"java:/Objects/\" + Procedures.class.getCanonicalName() + \"#\" + Procedures.class.getCanonicalName()\n-\t\t\t\t\t+ \"$Procedure\" + Integer.valueOf(paramCount);\n+\t\t\treturn classURIHelper.getFullURI(Procedures.class).toString() + \"$Procedure\" + paramCount;\n \t\t}\n-\t\treturn \"java:/Objects/\" + Functions.class.getCanonicalName() + \"#\" + Functions.class.getCanonicalName()\n-\t\t\t\t+ \"$Function\" + Integer.valueOf(paramCount);\n+\t\treturn classURIHelper.getFullURI(Functions.class).toString() + \"$Function\" + paramCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab46955889b1c79c8eae31494e3701cf38b73e5b"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzE0OTcwMw==", "bodyText": "You may want to use this classURIHelper in computeTypeUri, too.", "url": "https://github.com/eclipse/xtext-extras/pull/652#discussion_r503149703", "createdAt": "2020-10-12T09:08:35Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.xbase/src/org/eclipse/xtext/xtype/util/XFunctionTypeRefs.java", "diffHunk": "@@ -19,25 +19,29 @@\n import org.eclipse.xtext.common.types.JvmVoid;\n import org.eclipse.xtext.common.types.TypesFactory;\n import org.eclipse.xtext.common.types.access.impl.ClassURIHelper;\n+import org.eclipse.xtext.common.types.util.Primitives;\n import org.eclipse.xtext.xbase.lib.Functions;\n import org.eclipse.xtext.xbase.lib.Procedures;\n \n /**\n  * @author Anton Kosyakov - Initial contribution and API\n  */\n public class XFunctionTypeRefs {\n+\t\n+\tprivate static final Primitives primitives = new Primitives();\n+\n+\tprivate static final ClassURIHelper classURIHelper = new ClassURIHelper();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab46955889b1c79c8eae31494e3701cf38b73e5b"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d08a4459ff9d4d64d5cfcaf51c9deb28d3cf4bc", "author": {"user": {"login": "nbhusare", "name": "Neeraj Bhusare"}}, "url": "https://github.com/eclipse/xtext-extras/commit/5d08a4459ff9d4d64d5cfcaf51c9deb28d3cf4bc", "committedDate": "2020-10-12T11:04:44Z", "message": "Code cleanup\n\nSigned-off-by: nbhusare <neerajbhusare@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab46955889b1c79c8eae31494e3701cf38b73e5b", "author": {"user": {"login": "nbhusare", "name": "Neeraj Bhusare"}}, "url": "https://github.com/eclipse/xtext-extras/commit/ab46955889b1c79c8eae31494e3701cf38b73e5b", "committedDate": "2020-10-12T07:51:15Z", "message": "Calling Primitives#getWrapperType() from within the getWrappedType() method\nReplaced the hand-coded URI building logic in the method buildUri() with ClassURIHelper#getFullURI\n\nSigned-off-by: nbhusare <neerajbhusare@gmail.com>"}, "afterCommit": {"oid": "5d08a4459ff9d4d64d5cfcaf51c9deb28d3cf4bc", "author": {"user": {"login": "nbhusare", "name": "Neeraj Bhusare"}}, "url": "https://github.com/eclipse/xtext-extras/commit/5d08a4459ff9d4d64d5cfcaf51c9deb28d3cf4bc", "committedDate": "2020-10-12T11:04:44Z", "message": "Code cleanup\n\nSigned-off-by: nbhusare <neerajbhusare@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NjAxMzM4", "url": "https://github.com/eclipse/xtext-extras/pull/652#pullrequestreview-507601338", "createdAt": "2020-10-13T16:06:26Z", "commit": {"oid": "5d08a4459ff9d4d64d5cfcaf51c9deb28d3cf4bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4289, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}