{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMDE3OTYy", "number": 26894, "title": "Port docerina to syntax,semantic,project apis", "bodyText": "Purpose\n\n\nChange docerina to use project, syntax, semantic apis to generate docs.\nRemove old docerina code\n\n\nFixes #26733\nFixes #25176\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-11-12T16:51:40Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894", "merged": true, "mergeCommit": {"oid": "5fc1231f9a7ee8829ca4f800375457d2cd216815"}, "closed": true, "closedAt": "2020-11-17T06:36:06Z", "author": {"login": "shehan360"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdb24dcAFqTUyOTM3MzI5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddS6DCABqjQwMDM2NzU2MjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MzczMjkw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-529373290", "createdAt": "2020-11-12T18:29:43Z", "commit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODoyOTo0M1rOHyILNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODoyOTo0M1rOHyILNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjMyNDc4OQ==", "bodyText": "We should use ProjectConstants class. You can create a constant there if it is not present.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#discussion_r522324789", "createdAt": "2020-11-12T18:29:43Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-cli/src/main/java/io/ballerina/cli/task/CreateDocsTask.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package io.ballerina.cli.task;\n+\n+import io.ballerina.projects.Project;\n+import org.ballerinalang.docgen.docs.BallerinaDocGenerator;\n+import org.wso2.ballerinalang.compiler.util.ProjectDirConstants;\n+\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+\n+import static org.ballerinalang.tool.LauncherUtils.createLauncherException;\n+\n+/**\n+ * Task for generating docs using docerina.\n+ *\n+ * @since 2.0.0\n+ */\n+public class CreateDocsTask implements Task {\n+\n+    private boolean excludeIndex;\n+    private final transient PrintStream out;\n+\n+    public CreateDocsTask(boolean excludeIndex, PrintStream out) {\n+        this.excludeIndex = excludeIndex;\n+        this.out = out;\n+    }\n+\n+    @Override\n+    public void execute(Project project) {\n+        Path sourceRootPath = project.sourceRoot();\n+        Path targetDir = project.sourceRoot().resolve(ProjectDirConstants.TARGET_DIR_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5Mzc0NTQ5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-529374549", "createdAt": "2020-11-12T18:31:23Z", "commit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODozMToyM1rOHyIPDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODozMToyM1rOHyIPDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjMyNTc3NQ==", "bodyText": "@hevayo should we use the Target model here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#discussion_r522325775", "createdAt": "2020-11-12T18:31:23Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-cli/src/main/java/io/ballerina/cli/task/CreateDocsTask.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package io.ballerina.cli.task;\n+\n+import io.ballerina.projects.Project;\n+import org.ballerinalang.docgen.docs.BallerinaDocGenerator;\n+import org.wso2.ballerinalang.compiler.util.ProjectDirConstants;\n+\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+\n+import static org.ballerinalang.tool.LauncherUtils.createLauncherException;\n+\n+/**\n+ * Task for generating docs using docerina.\n+ *\n+ * @since 2.0.0\n+ */\n+public class CreateDocsTask implements Task {\n+\n+    private boolean excludeIndex;\n+    private final transient PrintStream out;\n+\n+    public CreateDocsTask(boolean excludeIndex, PrintStream out) {\n+        this.excludeIndex = excludeIndex;\n+        this.out = out;\n+    }\n+\n+    @Override\n+    public void execute(Project project) {\n+        Path sourceRootPath = project.sourceRoot();\n+        Path targetDir = project.sourceRoot().resolve(ProjectDirConstants.TARGET_DIR_NAME);\n+        Path outputPath = targetDir.resolve(ProjectDirConstants.TARGET_API_DOC_DIRECTORY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5Mzc1NjA2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-529375606", "createdAt": "2020-11-12T18:32:49Z", "commit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODozMjo0OVrOHyIS5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODozMjo0OVrOHyIS5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjMyNjc1OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        throw createLauncherException(\"Unable to generate API Documentation.\");\n          \n          \n            \n                        throw createLauncherException(\"Unable to generate API Documentation.\", e.getCause());", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#discussion_r522326758", "createdAt": "2020-11-12T18:32:49Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-cli/src/main/java/io/ballerina/cli/task/CreateDocsTask.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package io.ballerina.cli.task;\n+\n+import io.ballerina.projects.Project;\n+import org.ballerinalang.docgen.docs.BallerinaDocGenerator;\n+import org.wso2.ballerinalang.compiler.util.ProjectDirConstants;\n+\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+\n+import static org.ballerinalang.tool.LauncherUtils.createLauncherException;\n+\n+/**\n+ * Task for generating docs using docerina.\n+ *\n+ * @since 2.0.0\n+ */\n+public class CreateDocsTask implements Task {\n+\n+    private boolean excludeIndex;\n+    private final transient PrintStream out;\n+\n+    public CreateDocsTask(boolean excludeIndex, PrintStream out) {\n+        this.excludeIndex = excludeIndex;\n+        this.out = out;\n+    }\n+\n+    @Override\n+    public void execute(Project project) {\n+        Path sourceRootPath = project.sourceRoot();\n+        Path targetDir = project.sourceRoot().resolve(ProjectDirConstants.TARGET_DIR_NAME);\n+        Path outputPath = targetDir.resolve(ProjectDirConstants.TARGET_API_DOC_DIRECTORY);\n+        this.out.println(\"Generating API Documentation\");\n+        try {\n+            Files.createDirectories(outputPath);\n+            BallerinaDocGenerator.generateAPIDocs(project, outputPath.toString(), excludeIndex);\n+            this.out.println(\"\\t\" + sourceRootPath.relativize(outputPath).toString());\n+\n+        } catch (IOException e) {\n+            throw createLauncherException(\"Unable to generate API Documentation.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284"}, "originalPosition": 58}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d60cda86a9f018bba3404f8b32eb71594947284", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5d60cda86a9f018bba3404f8b32eb71594947284", "committedDate": "2020-11-12T16:46:39Z", "message": "Port docerina to syntax,semantic,project apis"}, "afterCommit": {"oid": "4021c6a077c243a423f3553664eb29750fd0eea6", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4021c6a077c243a423f3553664eb29750fd0eea6", "committedDate": "2020-11-13T09:36:19Z", "message": "Docerina port to Project API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMTQ5Mzc0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-530149374", "createdAt": "2020-11-13T15:19:02Z", "commit": {"oid": "4021c6a077c243a423f3553664eb29750fd0eea6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4021c6a077c243a423f3553664eb29750fd0eea6", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4021c6a077c243a423f3553664eb29750fd0eea6", "committedDate": "2020-11-13T09:36:19Z", "message": "Docerina port to Project API"}, "afterCommit": {"oid": "7d58a119f20315fe92d246ddd46e5e99e2126f77", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7d58a119f20315fe92d246ddd46e5e99e2126f77", "committedDate": "2020-11-14T06:04:51Z", "message": "use Target Model"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNTU5Mjk3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-530559297", "createdAt": "2020-11-14T06:48:06Z", "commit": {"oid": "7d58a119f20315fe92d246ddd46e5e99e2126f77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7d58a119f20315fe92d246ddd46e5e99e2126f77", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7d58a119f20315fe92d246ddd46e5e99e2126f77", "committedDate": "2020-11-14T06:04:51Z", "message": "use Target Model"}, "afterCommit": {"oid": "a1712a14b22fba66781bf4c360c8511b42373c8b", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a1712a14b22fba66781bf4c360c8511b42373c8b", "committedDate": "2020-11-16T07:05:37Z", "message": "fix type category resolving"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMDczMTU0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-531073154", "createdAt": "2020-11-16T08:27:21Z", "commit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODoyNzoyMlrOHzsX6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODoyNzoyMlrOHzsX6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzk2NjQ0MQ==", "bodyText": "We dont support this flag now. The command should be run as ballerina doc [<project-path>]", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#discussion_r523966441", "createdAt": "2020-11-16T08:27:22Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-cli/src/main/java/io/ballerina/cli/cmd/DocCommand.java", "diffHunk": "@@ -0,0 +1,217 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package io.ballerina.cli.cmd;\n+\n+import io.ballerina.cli.TaskExecutor;\n+import io.ballerina.cli.task.CompileTask;\n+import io.ballerina.cli.task.CreateDocsTask;\n+import io.ballerina.cli.task.CreateTargetDirTask;\n+import io.ballerina.projects.Project;\n+import io.ballerina.projects.directory.BuildProject;\n+import io.ballerina.projects.util.ProjectConstants;\n+import org.ballerinalang.compiler.CompilerPhase;\n+import org.ballerinalang.docgen.docs.BallerinaDocGenerator;\n+import org.ballerinalang.tool.BLauncherCmd;\n+import org.wso2.ballerinalang.compiler.util.CompilerContext;\n+import org.wso2.ballerinalang.compiler.util.CompilerOptions;\n+import org.wso2.ballerinalang.compiler.util.ProjectDirs;\n+import picocli.CommandLine;\n+\n+import java.io.PrintStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+\n+import static io.ballerina.cli.cmd.Constants.DOC_COMMAND;\n+import static org.ballerinalang.compiler.CompilerOptionName.COMPILER_PHASE;\n+import static org.ballerinalang.compiler.CompilerOptionName.EXPERIMENTAL_FEATURES_ENABLED;\n+import static org.ballerinalang.compiler.CompilerOptionName.LOCK_ENABLED;\n+import static org.ballerinalang.compiler.CompilerOptionName.OFFLINE;\n+import static org.ballerinalang.compiler.CompilerOptionName.PRESERVE_WHITESPACE;\n+import static org.ballerinalang.compiler.CompilerOptionName.SKIP_TESTS;\n+import static org.ballerinalang.compiler.CompilerOptionName.TEST_ENABLED;\n+\n+/**\n+ * This class represents the \"ballerina doc\" command.\n+ *\n+ * @since 2.0.0\n+ */\n+@CommandLine.Command(name = DOC_COMMAND, description = \"Ballerina doc - Generates API Documentation\")\n+public class DocCommand implements BLauncherCmd {\n+\n+    private final PrintStream outStream;\n+    private final PrintStream errStream;\n+    private Path projectPath;\n+    private boolean exitWhenFinish;\n+\n+    public DocCommand() {\n+        this.projectPath = Paths.get(System.getProperty(\"user.dir\"));\n+        this.outStream = System.out;\n+        this.errStream = System.err;\n+        this.exitWhenFinish = true;\n+    }\n+\n+    public DocCommand(PrintStream outStream, PrintStream errStream, boolean exitWhenFinish) {\n+        this.projectPath = Paths.get(System.getProperty(\"user.dir\"));\n+        this.outStream = outStream;\n+        this.errStream = errStream;\n+        this.exitWhenFinish = exitWhenFinish;\n+    }\n+\n+    @CommandLine.Option(names = {\"--sourceroot\"},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMDc1ODk2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-531075896", "createdAt": "2020-11-16T08:28:42Z", "commit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODoyODo0MlrOHzsayA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODoyODo0MlrOHzsayA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzk2NzE3Ng==", "bodyText": "We dont need this validation", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#discussion_r523967176", "createdAt": "2020-11-16T08:28:42Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-cli/src/main/java/io/ballerina/cli/cmd/DocCommand.java", "diffHunk": "@@ -0,0 +1,217 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package io.ballerina.cli.cmd;\n+\n+import io.ballerina.cli.TaskExecutor;\n+import io.ballerina.cli.task.CompileTask;\n+import io.ballerina.cli.task.CreateDocsTask;\n+import io.ballerina.cli.task.CreateTargetDirTask;\n+import io.ballerina.projects.Project;\n+import io.ballerina.projects.directory.BuildProject;\n+import io.ballerina.projects.util.ProjectConstants;\n+import org.ballerinalang.compiler.CompilerPhase;\n+import org.ballerinalang.docgen.docs.BallerinaDocGenerator;\n+import org.ballerinalang.tool.BLauncherCmd;\n+import org.wso2.ballerinalang.compiler.util.CompilerContext;\n+import org.wso2.ballerinalang.compiler.util.CompilerOptions;\n+import org.wso2.ballerinalang.compiler.util.ProjectDirs;\n+import picocli.CommandLine;\n+\n+import java.io.PrintStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+\n+import static io.ballerina.cli.cmd.Constants.DOC_COMMAND;\n+import static org.ballerinalang.compiler.CompilerOptionName.COMPILER_PHASE;\n+import static org.ballerinalang.compiler.CompilerOptionName.EXPERIMENTAL_FEATURES_ENABLED;\n+import static org.ballerinalang.compiler.CompilerOptionName.LOCK_ENABLED;\n+import static org.ballerinalang.compiler.CompilerOptionName.OFFLINE;\n+import static org.ballerinalang.compiler.CompilerOptionName.PRESERVE_WHITESPACE;\n+import static org.ballerinalang.compiler.CompilerOptionName.SKIP_TESTS;\n+import static org.ballerinalang.compiler.CompilerOptionName.TEST_ENABLED;\n+\n+/**\n+ * This class represents the \"ballerina doc\" command.\n+ *\n+ * @since 2.0.0\n+ */\n+@CommandLine.Command(name = DOC_COMMAND, description = \"Ballerina doc - Generates API Documentation\")\n+public class DocCommand implements BLauncherCmd {\n+\n+    private final PrintStream outStream;\n+    private final PrintStream errStream;\n+    private Path projectPath;\n+    private boolean exitWhenFinish;\n+\n+    public DocCommand() {\n+        this.projectPath = Paths.get(System.getProperty(\"user.dir\"));\n+        this.outStream = System.out;\n+        this.errStream = System.err;\n+        this.exitWhenFinish = true;\n+    }\n+\n+    public DocCommand(PrintStream outStream, PrintStream errStream, boolean exitWhenFinish) {\n+        this.projectPath = Paths.get(System.getProperty(\"user.dir\"));\n+        this.outStream = outStream;\n+        this.errStream = errStream;\n+        this.exitWhenFinish = exitWhenFinish;\n+    }\n+\n+    @CommandLine.Option(names = {\"--sourceroot\"},\n+            description = \"Path to the directory containing source files and modules.\")\n+    private String sourceRoot;\n+\n+    @CommandLine.Option(names = {\"--o\", \"-o\"}, description = \"Location to save API Docs.\")\n+    private String outputLoc;\n+\n+    @CommandLine.Option(names = {\"--excludeIndex\", \"-excludeIndex\"}, description = \"Prevents project index from \" +\n+            \"being generated.\")\n+    private boolean excludeIndex;\n+\n+    @CommandLine.Option(names = {\"--combine\", \"-combine\"}, description = \"Creates index using modules.\")\n+    private boolean combine;\n+\n+    @CommandLine.Option(names = {\"--offline\"}, description = \"Compiles offline without downloading \" +\n+            \"dependencies.\")\n+    private boolean offline;\n+\n+    @CommandLine.Option(names = \"--old-parser\", description = \"Enable old parser.\", hidden = true)\n+    private boolean useOldParser;\n+\n+    @CommandLine.Parameters\n+    private List<String> argList;\n+\n+    @CommandLine.Option(names = {\"--exclude\", \"-e\"}, description = \"List of modules to be excluded.\")\n+    private String[] excludes;\n+\n+    @CommandLine.Option(names = {\"--help\", \"-h\"}, hidden = true)\n+    private boolean helpFlag;\n+\n+    @CommandLine.Option(names = \"--experimental\", description = \"Enable experimental language features.\")\n+    private boolean experimentalFlag;\n+\n+    public void execute() {\n+        if (this.helpFlag) {\n+            String commandUsageInfo = BLauncherCmd.getCommandUsageInfo(DOC_COMMAND);\n+            this.errStream.println(commandUsageInfo);\n+            return;\n+        }\n+        // combine docs\n+        if (this.combine) {\n+            outStream.println(\"Combining Docs\");\n+            BallerinaDocGenerator.mergeApiDocs(this.projectPath.toString());\n+            if (this.exitWhenFinish) {\n+                Runtime.getRuntime().exit(0);\n+            }\n+        }\n+\n+        if (this.argList != null && this.argList.get(0).endsWith(ProjectConstants.BLANG_SOURCE_EXT)) {\n+            CommandUtil.printError(this.errStream,\n+                    \"generating API Documentation is not supported for a single Ballerina file.\",\n+                    null,\n+                    false);\n+            CommandUtil.exitError(true);\n+            return;\n+        }\n+\n+        // check if there are too many arguments.\n+        if (this.argList != null && this.argList.size() > 1) {\n+            CommandUtil.printError(this.errStream,\n+                    \"too many arguments.\",\n+                    \"ballerina doc [--sourceroot] [--offline]\\n\",\n+                    false);\n+            CommandUtil.exitError(true);\n+            return;\n+        }\n+\n+        // validation and decide source root and source full path\n+        this.projectPath = null != this.sourceRoot ?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20"}, "originalPosition": 144}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMDc2NDM5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#pullrequestreview-531076439", "createdAt": "2020-11-16T08:28:59Z", "commit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODoyOTowMFrOHzsbXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwODoyOTowMFrOHzsbXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzk2NzMyNQ==", "bodyText": "We can remove this validation as well", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26894#discussion_r523967325", "createdAt": "2020-11-16T08:29:00Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-cli/src/main/java/io/ballerina/cli/cmd/DocCommand.java", "diffHunk": "@@ -0,0 +1,217 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package io.ballerina.cli.cmd;\n+\n+import io.ballerina.cli.TaskExecutor;\n+import io.ballerina.cli.task.CompileTask;\n+import io.ballerina.cli.task.CreateDocsTask;\n+import io.ballerina.cli.task.CreateTargetDirTask;\n+import io.ballerina.projects.Project;\n+import io.ballerina.projects.directory.BuildProject;\n+import io.ballerina.projects.util.ProjectConstants;\n+import org.ballerinalang.compiler.CompilerPhase;\n+import org.ballerinalang.docgen.docs.BallerinaDocGenerator;\n+import org.ballerinalang.tool.BLauncherCmd;\n+import org.wso2.ballerinalang.compiler.util.CompilerContext;\n+import org.wso2.ballerinalang.compiler.util.CompilerOptions;\n+import org.wso2.ballerinalang.compiler.util.ProjectDirs;\n+import picocli.CommandLine;\n+\n+import java.io.PrintStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+\n+import static io.ballerina.cli.cmd.Constants.DOC_COMMAND;\n+import static org.ballerinalang.compiler.CompilerOptionName.COMPILER_PHASE;\n+import static org.ballerinalang.compiler.CompilerOptionName.EXPERIMENTAL_FEATURES_ENABLED;\n+import static org.ballerinalang.compiler.CompilerOptionName.LOCK_ENABLED;\n+import static org.ballerinalang.compiler.CompilerOptionName.OFFLINE;\n+import static org.ballerinalang.compiler.CompilerOptionName.PRESERVE_WHITESPACE;\n+import static org.ballerinalang.compiler.CompilerOptionName.SKIP_TESTS;\n+import static org.ballerinalang.compiler.CompilerOptionName.TEST_ENABLED;\n+\n+/**\n+ * This class represents the \"ballerina doc\" command.\n+ *\n+ * @since 2.0.0\n+ */\n+@CommandLine.Command(name = DOC_COMMAND, description = \"Ballerina doc - Generates API Documentation\")\n+public class DocCommand implements BLauncherCmd {\n+\n+    private final PrintStream outStream;\n+    private final PrintStream errStream;\n+    private Path projectPath;\n+    private boolean exitWhenFinish;\n+\n+    public DocCommand() {\n+        this.projectPath = Paths.get(System.getProperty(\"user.dir\"));\n+        this.outStream = System.out;\n+        this.errStream = System.err;\n+        this.exitWhenFinish = true;\n+    }\n+\n+    public DocCommand(PrintStream outStream, PrintStream errStream, boolean exitWhenFinish) {\n+        this.projectPath = Paths.get(System.getProperty(\"user.dir\"));\n+        this.outStream = outStream;\n+        this.errStream = errStream;\n+        this.exitWhenFinish = exitWhenFinish;\n+    }\n+\n+    @CommandLine.Option(names = {\"--sourceroot\"},\n+            description = \"Path to the directory containing source files and modules.\")\n+    private String sourceRoot;\n+\n+    @CommandLine.Option(names = {\"--o\", \"-o\"}, description = \"Location to save API Docs.\")\n+    private String outputLoc;\n+\n+    @CommandLine.Option(names = {\"--excludeIndex\", \"-excludeIndex\"}, description = \"Prevents project index from \" +\n+            \"being generated.\")\n+    private boolean excludeIndex;\n+\n+    @CommandLine.Option(names = {\"--combine\", \"-combine\"}, description = \"Creates index using modules.\")\n+    private boolean combine;\n+\n+    @CommandLine.Option(names = {\"--offline\"}, description = \"Compiles offline without downloading \" +\n+            \"dependencies.\")\n+    private boolean offline;\n+\n+    @CommandLine.Option(names = \"--old-parser\", description = \"Enable old parser.\", hidden = true)\n+    private boolean useOldParser;\n+\n+    @CommandLine.Parameters\n+    private List<String> argList;\n+\n+    @CommandLine.Option(names = {\"--exclude\", \"-e\"}, description = \"List of modules to be excluded.\")\n+    private String[] excludes;\n+\n+    @CommandLine.Option(names = {\"--help\", \"-h\"}, hidden = true)\n+    private boolean helpFlag;\n+\n+    @CommandLine.Option(names = \"--experimental\", description = \"Enable experimental language features.\")\n+    private boolean experimentalFlag;\n+\n+    public void execute() {\n+        if (this.helpFlag) {\n+            String commandUsageInfo = BLauncherCmd.getCommandUsageInfo(DOC_COMMAND);\n+            this.errStream.println(commandUsageInfo);\n+            return;\n+        }\n+        // combine docs\n+        if (this.combine) {\n+            outStream.println(\"Combining Docs\");\n+            BallerinaDocGenerator.mergeApiDocs(this.projectPath.toString());\n+            if (this.exitWhenFinish) {\n+                Runtime.getRuntime().exit(0);\n+            }\n+        }\n+\n+        if (this.argList != null && this.argList.get(0).endsWith(ProjectConstants.BLANG_SOURCE_EXT)) {\n+            CommandUtil.printError(this.errStream,\n+                    \"generating API Documentation is not supported for a single Ballerina file.\",\n+                    null,\n+                    false);\n+            CommandUtil.exitError(true);\n+            return;\n+        }\n+\n+        // check if there are too many arguments.\n+        if (this.argList != null && this.argList.size() > 1) {\n+            CommandUtil.printError(this.errStream,\n+                    \"too many arguments.\",\n+                    \"ballerina doc [--sourceroot] [--offline]\\n\",\n+                    false);\n+            CommandUtil.exitError(true);\n+            return;\n+        }\n+\n+        // validation and decide source root and source full path\n+        this.projectPath = null != this.sourceRoot ?\n+                Paths.get(this.sourceRoot).toAbsolutePath() : this.projectPath;\n+\n+        // validate and set source root path\n+        if (!ProjectDirs.isProject(this.projectPath)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20"}, "originalPosition": 148}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f4908fc78daecaad056b0307b429dba51e317f20", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f4908fc78daecaad056b0307b429dba51e317f20", "committedDate": "2020-11-16T07:29:17Z", "message": "fix qualifiednamereference category resolving"}, "afterCommit": {"oid": "ea0802356ac08fd3f1342805ce98d1b06e3f409d", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ea0802356ac08fd3f1342805ce98d1b06e3f409d", "committedDate": "2020-11-16T11:31:57Z", "message": "Add Package.md support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea0802356ac08fd3f1342805ce98d1b06e3f409d", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ea0802356ac08fd3f1342805ce98d1b06e3f409d", "committedDate": "2020-11-16T11:31:57Z", "message": "Add Package.md support"}, "afterCommit": {"oid": "1bbe138e5677c71e6241d724d1577628a83eb312", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1bbe138e5677c71e6241d724d1577628a83eb312", "committedDate": "2020-11-16T13:52:54Z", "message": "Add Package.md support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1bbe138e5677c71e6241d724d1577628a83eb312", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1bbe138e5677c71e6241d724d1577628a83eb312", "committedDate": "2020-11-16T13:52:54Z", "message": "Add Package.md support"}, "afterCommit": {"oid": "e72c8b595964b38ee7842b36b763327f7b52d8b6", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e72c8b595964b38ee7842b36b763327f7b52d8b6", "committedDate": "2020-11-16T19:06:10Z", "message": "Add Package.md support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e634ce30d10a8fd46dfd666f8ec6ae4da4652538", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e634ce30d10a8fd46dfd666f8ec6ae4da4652538", "committedDate": "2020-11-17T05:16:07Z", "message": "Port docerina to syntax,semantic,project apis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e91147d9f143ee034b5d35aa572ff0f75490c637", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e91147d9f143ee034b5d35aa572ff0f75490c637", "committedDate": "2020-11-17T05:24:45Z", "message": "Docerina port to Project API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8fc813f04bbcc4cdaa69d9236aae1522ee290d1", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f8fc813f04bbcc4cdaa69d9236aae1522ee290d1", "committedDate": "2020-11-17T05:24:45Z", "message": "use Target Model"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a64ad2ebf13fc261c7e09c35b1949e2771ec379", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1a64ad2ebf13fc261c7e09c35b1949e2771ec379", "committedDate": "2020-11-17T05:24:45Z", "message": "fix type category resolving"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b05f303fa74443c2622d36429744548b09c35c5", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0b05f303fa74443c2622d36429744548b09c35c5", "committedDate": "2020-11-17T05:24:45Z", "message": "fix qualifiednamereference category resolving"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "835167a769de85a4e3470a5798b69c17fdffe0bc", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/835167a769de85a4e3470a5798b69c17fdffe0bc", "committedDate": "2020-11-17T05:24:45Z", "message": "Add intersection type\nRename unionTypes,finitetypes to BTypes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3ff48521cc36c6c920f9c5588e35ad0eee4a0bb", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b3ff48521cc36c6c920f9c5588e35ad0eee4a0bb", "committedDate": "2020-11-17T05:24:45Z", "message": "Remove sourceroot flag\nFix -o output flag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76cc613fd375f18e244b752911151a3a068c3f2b", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/76cc613fd375f18e244b752911151a3a068c3f2b", "committedDate": "2020-11-17T05:24:45Z", "message": "Add Package.md support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a84cbd85c2e5cab2178fccfd1a4b12671fce592", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6a84cbd85c2e5cab2178fccfd1a4b12671fce592", "committedDate": "2020-11-17T05:41:49Z", "message": "Update gradle scripts"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e72c8b595964b38ee7842b36b763327f7b52d8b6", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e72c8b595964b38ee7842b36b763327f7b52d8b6", "committedDate": "2020-11-16T19:06:10Z", "message": "Add Package.md support"}, "afterCommit": {"oid": "6a84cbd85c2e5cab2178fccfd1a4b12671fce592", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6a84cbd85c2e5cab2178fccfd1a4b12671fce592", "committedDate": "2020-11-17T05:41:49Z", "message": "Update gradle scripts"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3273, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}