{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MTQ1NzMz", "number": 24652, "title": "Fix few issues in diagnostics related to `readonly` and mapping/list constructor expressions", "bodyText": "Purpose\n$title.\nThese changes have been introduced on top of the changes in #24484. Need to merge that first.\nFixes #24564 - Additional error when there are issues with the applicable CET for a constructor expression\nFixes #23816 - Issues in diagnostics for T & readonly\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-07-08T10:26:24Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24652", "merged": true, "mergeCommit": {"oid": "84c9152f57fe140e56029e58eac4fd504fd96bb5"}, "closed": true, "closedAt": "2020-07-16T15:34:07Z", "author": {"login": "MaryamZi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcygK15AH2gAyNDQ2MTQ1NzMzOjJjNWE3YThjMDEwYWJjNmM3NzI1M2UwOWY0MjEyMjIzOWY0YzI1MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1gtWhAFqTQ0OTk0NTczMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2c5a7a8c010abc6c77253e09f42122239f4c2500", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2c5a7a8c010abc6c77253e09f42122239f4c2500", "committedDate": "2020-07-07T06:51:06Z", "message": "Avoid logging incompatible types error for constructor exprs with invalid CETs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4591f0d4f3693debfcde17173566743c3d2001d5", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4591f0d4f3693debfcde17173566743c3d2001d5", "committedDate": "2020-07-07T16:47:12Z", "message": "Fix anon type name getting printed for immutable records/objects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "032313d6369891d73cd4db91d91b2099adf1e85d", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/032313d6369891d73cd4db91d91b2099adf1e85d", "committedDate": "2020-07-08T09:28:38Z", "message": "Avoid logging errors for errored constrs/union CETs and add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96b50367e3ee24eec4dc9fa9347bee55ec234af7", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/96b50367e3ee24eec4dc9fa9347bee55ec234af7", "committedDate": "2020-07-08T17:29:06Z", "message": "Fix gRPC StubGeneratorTestCase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29ffb803df71216442828a113cfe1493d41d9b7c", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/29ffb803df71216442828a113cfe1493d41d9b7c", "committedDate": "2020-07-16T06:51:59Z", "message": "Resolve conflicts and merge master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NjE2NTA2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24652#pullrequestreview-449616506", "createdAt": "2020-07-16T08:09:46Z", "commit": {"oid": "29ffb803df71216442828a113cfe1493d41d9b7c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwODowOTo0NlrOGyfoKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwODowOTo0NlrOGyfoKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYwMDE3MQ==", "bodyText": "Just curious what this check does? \"($\"", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24652#discussion_r455600171", "createdAt": "2020-07-16T08:09:46Z", "author": {"login": "KRVPerera"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/model/types/BStructureType.java", "diffHunk": "@@ -49,4 +54,22 @@ public BStructureType(int tag, BTypeSymbol tSymbol, int flags) {\n     public void accept(TypeVisitor visitor) {\n         visitor.visit(this);\n     }\n+\n+    protected boolean shouldPrintShape(Name name) {\n+        if (name == null) {\n+            return false;\n+        }\n+\n+        String value = name.value;\n+\n+        if (value.isEmpty() || value.startsWith(DOLLAR)) {\n+            return true;\n+        }\n+\n+        if (!(Symbols.isFlagOn(this.tsymbol.flags, Flags.READONLY))) {\n+            return false;\n+        }\n+\n+        return value.startsWith(\"($\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29ffb803df71216442828a113cfe1493d41d9b7c"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTM1Nzc0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24652#pullrequestreview-449935774", "createdAt": "2020-07-16T15:00:14Z", "commit": {"oid": "29ffb803df71216442828a113cfe1493d41d9b7c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTowMDoxNFrOGyvHeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTowMDoxNFrOGyvHeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg1Mzk0Ng==", "bodyText": "How can there be a semantic error in a union type?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24652#discussion_r455853946", "createdAt": "2020-07-16T15:00:14Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -1280,7 +1280,16 @@ private BType checkListConstructorCompatibility(BType bType, BLangListConstructo\n             this.dlog.setNonConsoleDLog();\n \n             List<BType> compatibleTypes = new ArrayList<>();\n+            boolean erroredExpType = false;\n             for (BType memberType : ((BUnionType) bType).getMemberTypes()) {\n+                if (memberType == symTable.semanticError) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29ffb803df71216442828a113cfe1493d41d9b7c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTQ1NzMw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24652#pullrequestreview-449945730", "createdAt": "2020-07-16T15:10:34Z", "commit": {"oid": "29ffb803df71216442828a113cfe1493d41d9b7c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4165, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}