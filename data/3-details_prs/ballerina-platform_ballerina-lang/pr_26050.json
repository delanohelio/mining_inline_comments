{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMTczMDUx", "number": 26050, "title": "Fix debugger for BString related runtime changes", "bodyText": "Purpose\nFixes #26020 - Error when invoking functions/object methods with string args.\nRemarks\nPlease merge after #26018\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-24T04:22:43Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26050", "merged": true, "mergeCommit": {"oid": "03b3871bc7d9b4e7308735d784aa58911ab951ce"}, "closed": true, "closedAt": "2020-09-25T06:49:41Z", "author": {"login": "NipunaRanasinghe"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKXpOBgH2gAyNDkyMTczMDUxOmUwMTM5MWJiNTI3NGIyZDhjMzhjZTE3Yjg5MmU0YTEwYzI2ZTNjNWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMP6PZgFqTQ5NjE0NTEwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e01391bb5274b2d8c38ce17b892e4a10c26e3c5b", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e01391bb5274b2d8c38ce17b892e4a10c26e3c5b", "committedDate": "2020-09-19T10:29:19Z", "message": "Update debug variable implementation to support quoted identifiers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7a6b4ae230c0581ba630b3a08819531cf67c77f", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c7a6b4ae230c0581ba630b3a08819531cf67c77f", "committedDate": "2020-09-22T06:01:27Z", "message": "Refactor identifier utils in order to be accessible from the debugger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fafc4ef1a714c3c68ca55923c51f7f0c807946e", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5fafc4ef1a714c3c68ca55923c51f7f0c807946e", "committedDate": "2020-09-22T07:51:29Z", "message": "Refactor debug expression evaluation impl to support quoted identifiers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f8aa8c894eea2ba2ff7289af5143824789eed00", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9f8aa8c894eea2ba2ff7289af5143824789eed00", "committedDate": "2020-09-22T12:20:35Z", "message": "Fix records and objects representation to support quoted identifiers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65c8e84ee68ef03819d8554f69264369417888a7", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/65c8e84ee68ef03819d8554f69264369417888a7", "committedDate": "2020-09-23T04:31:54Z", "message": "Resolve conflicts with master\n\n# Conflicts:\n#\tcompiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/diagnostic/BLangDiagnosticLog.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f6ed2272934316fd4fa5e0e11b55551bcec7716", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5f6ed2272934316fd4fa5e0e11b55551bcec7716", "committedDate": "2020-09-23T06:13:24Z", "message": "Add minor fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71c4fbbd17f3180aa8c22d33016dbce8f25f90e6", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/71c4fbbd17f3180aa8c22d33016dbce8f25f90e6", "committedDate": "2020-09-23T07:30:05Z", "message": "Update evaluation engine to convert all the string literals into BString instances"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "433d89166688de40052598a40fa1e47dfcda1e0d", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/433d89166688de40052598a40fa1e47dfcda1e0d", "committedDate": "2020-09-23T08:18:52Z", "message": "Fix string concatenation in debug expression evaluation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df715d57d89c04f8bdcd4fa1c95506a47125534d", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/df715d57d89c04f8bdcd4fa1c95506a47125534d", "committedDate": "2020-09-24T11:52:07Z", "message": "Add tests for function invocation evaluation with string args"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3c0f5ef6ab6d29f23a5fb0f3e098c9aec9a135f6", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3c0f5ef6ab6d29f23a5fb0f3e098c9aec9a135f6", "committedDate": "2020-09-23T09:57:53Z", "message": "Add tests for function invocation evaluation with string args"}, "afterCommit": {"oid": "df715d57d89c04f8bdcd4fa1c95506a47125534d", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/df715d57d89c04f8bdcd4fa1c95506a47125534d", "committedDate": "2020-09-24T11:52:07Z", "message": "Add tests for function invocation evaluation with string args"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTI0NDgz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26050#pullrequestreview-496124483", "createdAt": "2020-09-25T05:44:33Z", "commit": {"oid": "df715d57d89c04f8bdcd4fa1c95506a47125534d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNTo0NDozM1rOHX1u0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNTo0NDozM1rOHX1u0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc1OTYzNA==", "bodyText": "We can use the FROM_STRING_METHOD constant here too.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26050#discussion_r494759634", "createdAt": "2020-09-25T05:44:33Z", "author": {"login": "Dilhasha"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/EvaluationUtils.java", "diffHunk": "@@ -105,7 +109,31 @@ public static BExpressionValue make(SuspendedContext context, double val) {\n         return new BExpressionValue(context, context.getAttachedVm().mirrorOf(val));\n     }\n \n-    public static BExpressionValue make(SuspendedContext context, String val) {\n-        return new BExpressionValue(context, context.getAttachedVm().mirrorOf(val));\n+    public static BExpressionValue make(SuspendedContext context, String val) throws EvaluationException {\n+        val = removeRedundantQuotes(val);\n+        Value bStringVal = getAsBString(context, val);\n+        return new BExpressionValue(context, bStringVal);\n+    }\n+\n+    /**\n+     * Converts the user given string literal into an {@link org.ballerinalang.jvm.api.values.BString} instance.\n+     *\n+     * @param context suspended debug context\n+     * @param val     string value\n+     * @return {@link org.ballerinalang.jvm.api.values.BString} instance\n+     */\n+    private static Value getAsBString(SuspendedContext context, String val) throws EvaluationException {\n+        List<ReferenceType> cls = context.getAttachedVm().classesByName(B_STRING_UTILS_CLASS);\n+        if (cls.isEmpty()) {\n+            cls = Collections.singletonList(loadClass(context, B_STRING_UTILS_CLASS, \"fromString\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df715d57d89c04f8bdcd4fa1c95506a47125534d"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTI1Mjc3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26050#pullrequestreview-496125277", "createdAt": "2020-09-25T05:46:54Z", "commit": {"oid": "df715d57d89c04f8bdcd4fa1c95506a47125534d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNTo0Njo1NVrOHX1xkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNTo0Njo1NVrOHX1xkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2MDMzNg==", "bodyText": "is there a small formatting issue?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26050#discussion_r494760336", "createdAt": "2020-09-25T05:46:55Z", "author": {"login": "Dilhasha"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/variable/VariableUtils.java", "diffHunk": "@@ -203,10 +203,10 @@ static boolean isJson(Value value) {\n         return Optional.of(methods.get(0));\n     }\n \n-    private static String removeRedundantQuotes(String str) {\n+     public static String removeRedundantQuotes(String str) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df715d57d89c04f8bdcd4fa1c95506a47125534d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32fbe2ec4c6d0b5ef068996df00abd3b4c245a61", "author": {"user": {"login": "NipunaRanasinghe", "name": "Nipuna Ransinghe "}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/32fbe2ec4c6d0b5ef068996df00abd3b4c245a61", "committedDate": "2020-09-25T06:01:46Z", "message": "Add review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTQ1MTAx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26050#pullrequestreview-496145101", "createdAt": "2020-09-25T06:36:31Z", "commit": {"oid": "32fbe2ec4c6d0b5ef068996df00abd3b4c245a61"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4657, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}