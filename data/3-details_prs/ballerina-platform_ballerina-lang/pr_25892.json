{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4NzAzMjMz", "number": 25892, "title": "Add support for class related formatting and remove superfluous newlines at the end of assertion files", "bodyText": "Purpose\n\nEnables the formatting support for classes introduced in #25637\n\nFixes #25903\nFixes #25858\nApproach\n\nImplemented the public ClassDefinitionNode transform(ClassDefinitionNode classDefinitionNode) method in the FormattingTreeModifier.java and added new test cases to add support for class related formatting.\n\n\nUsed the following python script to match and reformat each of the ballerina files used for assertion in formatter related test cases.\n\nimport re\nimport os\nrootdir = \"/path/to/repo/ballerina-lang/misc/formatter/modules/formatter-core/src/test/resources/\"\nregex = re.compile('(^/path/to/repo/ballerina-lang/misc/formatter/modules/formatter-core/src/test/resources/*/checking/assert/*\\.bal$)')\nfor root, dirs, files in os.walk(rootdir):\n\tfor file in files:\n\t\tpath = root + \"/\"+file\n\t\tif(regex.match(path)):\n\t\t\tf = open(path, \"r\")\n\t\t\tcontent = f.read().strip()+os.linesep\n\t\t\tf.close()\n\t\t\tf = open(path, \"w\")\n\t\t\tf.write(content)\n\t\t\tf.close()\n\t\t\tprint(\"path: \", path)\n\nSamples\n\n\nclass Foo {\n}\nclient readonly distinct class Bar {\n    string name;\n}\n\n\nRemarks\n\n\n\n\nAdd formatting support for having anonymous objects within a class\n\n\nAdd formatting support for following kind of syntax\n\n\nclass Foo {\n    int[] & readonly x = [1, 2];\n    readonly & int[] y = [1, 2];\n}\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-17T14:17:10Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892", "merged": true, "mergeCommit": {"oid": "0363c9a5f1c173ab3b21324dda580e87282680f4"}, "closed": true, "closedAt": "2020-09-18T06:03:49Z", "author": {"login": "sanjana"}, "timelineItems": {"totalCount": 34, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJIfwkgH2gAyNDg4NzAzMjMzOmU5NDliMTc2ZDRhM2M0ZDZhZjA2Y2Y2M2VmNzRmZWQ1MGNlMWM2NWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ_M_rAFqTQ5MTE3MTY0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e949b176d4a3c4d6af06cf63ef74fed50ce1c65f", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e949b176d4a3c4d6af06cf63ef74fed50ce1c65f", "committedDate": "2020-09-15T14:16:29Z", "message": "Add support for classes in formatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c93574c6286685889231ee0eb7287adfff58aae8", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c93574c6286685889231ee0eb7287adfff58aae8", "committedDate": "2020-09-16T10:08:09Z", "message": "Expand test case scenarios for class related formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36c38d8a9dcfcab06a04967ca07fad7ad6752bfa", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/36c38d8a9dcfcab06a04967ca07fad7ad6752bfa", "committedDate": "2020-09-17T05:29:30Z", "message": "Merge branch 'master' into formatter-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4e540382b7dbdf20cd62b5e91249224b9412c7e", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b4e540382b7dbdf20cd62b5e91249224b9412c7e", "committedDate": "2020-09-17T13:59:41Z", "message": "Expand the testing scope of class related formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8675e90090bf6a52fb501b9cc185942fdeecb70", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f8675e90090bf6a52fb501b9cc185942fdeecb70", "committedDate": "2020-09-17T14:00:49Z", "message": "Merge branch 'master' into formatter-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f6b3c7d89ef748e55790d84a78e7af0a11e1abc7", "committedDate": "2020-09-17T14:33:19Z", "message": "Fix checkstyle failing issue in FormattingTreeModifier.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed6a6ebf1deba2f73c9b7c92acf65be3d34a9d7e", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ed6a6ebf1deba2f73c9b7c92acf65be3d34a9d7e", "committedDate": "2020-09-17T15:13:18Z", "message": "Add missing Javadoc comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzg1ODY5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490785869", "createdAt": "2020-09-17T16:32:18Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjozMjoxOFrOHTrp5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjozMjoxOFrOHTrp5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQwMDIzMQ==", "bodyText": "shall we use isEmpty instead of checking size equals to zero", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490400231", "createdAt": "2020-09-17T16:32:18Z", "author": {"login": "nadeeshaan"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -360,8 +361,11 @@ public FunctionDefinitionNode transform(FunctionDefinitionNode functionDefinitio\n             functionDefinitionNode = functionDefinitionNode.modify()\n                     .withMetadata(metadata).apply();\n         }\n+\n+        int startColumn = qualifierList.size() == 0 ? getStartColumn(functionDefinitionNode, true) : 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzg5OTUw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490789950", "createdAt": "2020-09-17T16:37:21Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjozNzoyMlrOHTr2Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjozNzoyMlrOHTr2Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQwMzQyMw==", "bodyText": "since we return within each of the clauses, shall we use if clauses", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490403423", "createdAt": "2020-09-17T16:37:22Z", "author": {"login": "nadeeshaan"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -3687,12 +3697,51 @@ public OrderKeyNode transform(OrderKeyNode orderKeyNode) {\n                 .apply();\n     }\n \n+    @Override\n+    public ClassDefinitionNode transform(ClassDefinitionNode classDefinitionNode) {\n+        if (!isInLineRange(classDefinitionNode, lineRange)) {\n+            return classDefinitionNode;\n+        }\n+\n+        Token visibilityQualifier = getToken(classDefinitionNode.visibilityQualifier().orElse(null));\n+        MetadataNode metadata = this.modifyNode(classDefinitionNode.metadata().orElse(null));\n+        NodeList<Token> qualifierList = this.modifyNodeList(classDefinitionNode.classTypeQualifiers());\n+        Token classKeyword = getToken(classDefinitionNode.classKeyword());\n+        Token className = getToken(classDefinitionNode.className());\n+        NodeList<Node> members = this.modifyNodeList(classDefinitionNode.members());\n+        Token openBrace = getToken(classDefinitionNode.openBrace());\n+        Token closeBrace = getToken(classDefinitionNode.closeBrace());\n+        int startColumn = getStartColumn(classDefinitionNode, true);\n+\n+        if (metadata != null) {\n+            classDefinitionNode = classDefinitionNode.modify()\n+                    .withMetadata(metadata).apply();\n+        }\n+\n+        if (visibilityQualifier != null && !visibilityQualifier.isMissing()) {\n+            classDefinitionNode = classDefinitionNode.modify()\n+                    .withVisibilityQualifier(formatToken(visibilityQualifier, startColumn, 1, 0, 0))\n+                    .apply();\n+            startColumn = 0;\n+        }\n+\n+        return classDefinitionNode.modify()\n+                .withClassKeyword(formatToken(classKeyword, startColumn, 0, 0, 0))\n+                .withClassName(formatToken(className, 1, 0, 0, 0))\n+                .withOpenBrace(formatToken(openBrace, 1, 0, 0, 1))\n+                .withCloseBrace(formatToken(closeBrace, 0, 0, 0, 1))\n+                .withClassTypeQualifiers(qualifierList)\n+                .withMembers(members)\n+                .apply();\n+    }\n+\n     @Override\n     public Token transform(Token token) {\n         int startColumn = getStartColumn(token, true);\n         if (token.kind() == (SyntaxKind.COMMA_TOKEN)) {\n             return formatToken(token, 0, 1, 0, 0);\n-        } else if (token.kind() == (SyntaxKind.PUBLIC_KEYWORD) || token.kind() == (SyntaxKind.ABSTRACT_KEYWORD)) {\n+        } else if (token.kind() == (SyntaxKind.PUBLIC_KEYWORD) || token.kind() == (SyntaxKind.ABSTRACT_KEYWORD) ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 110}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODAxNDA1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490801405", "createdAt": "2020-09-17T16:51:38Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjo1MTozOFrOHTsaxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjo1MTozOFrOHTsaxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQxMjc0Mw==", "bodyText": "Might need a doc comment here to pass the check style.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490412743", "createdAt": "2020-09-17T16:51:38Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/java/org/ballerinalang/formatter/core/declarations/ClassDefinitionDeclarationsTest.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.ballerinalang.formatter.core.declarations;\n+\n+import org.ballerinalang.formatter.core.FormatterTest;\n+import org.testng.annotations.DataProvider;\n+import org.testng.annotations.Test;\n+\n+import java.io.IOException;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class ClassDefinitionDeclarationsTest extends FormatterTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODAzNDkz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490803493", "createdAt": "2020-09-17T16:54:18Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjo1NDoxOFrOHTsheQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjo1NDoxOFrOHTsheQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQxNDQ1Nw==", "bodyText": "Latest changes keeps a blank link in between empty blocks.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490414457", "createdAt": "2020-09-17T16:54:18Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/resources/declarations/class-definition/assert/class_definition_declaration_17.bal", "diffHunk": "@@ -0,0 +1,11 @@\n+class Foo {\n+    public function init() {\n+    }\n+\n+    function getName() {\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODA0OTI0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490804924", "createdAt": "2020-09-17T16:56:07Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjo1NjowN1rOHTsl1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjo1NjowN1rOHTsl1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQxNTU3Mg==", "bodyText": "Shouldn't we disorganize the formatting here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490415572", "createdAt": "2020-09-17T16:56:07Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/resources/declarations/class-definition/source/class_definition_declaration_2.bal", "diffHunk": "@@ -0,0 +1,17 @@\n+class Person {\n+    *A;\n+    public int age = 10;\n+    function foo() returns int {\n+        int a = 12345;\n+        return a;\n+    }\n+\n+    public string name = \"sample name\";\n+    int year = 50;\n+    function bar() returns string {\n+        string b = \"bar\";\n+        return b;\n+    }\n+\n+    string month = \"february\";\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODA4NDA2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490808406", "createdAt": "2020-09-17T17:00:25Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzowMDoyNlrOHTswOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzowMDoyNlrOHTswOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQxODIzNQ==", "bodyText": "Missing new line", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490418235", "createdAt": "2020-09-17T17:00:26Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/resources/declarations/class-definition/source/class_definition_declaration_10.bal", "diffHunk": "@@ -0,0 +1,6 @@\n+    readonly\n+                 class\n+          Foo\n+                      {\n+       string             name\n+     ;        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODA4OTUz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490808953", "createdAt": "2020-09-17T17:01:03Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzowMTowM1rOHTsxzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzowMTowM1rOHTsxzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQxODYzNg==", "bodyText": "Missing new line", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490418636", "createdAt": "2020-09-17T17:01:03Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/resources/declarations/class-definition/source/class_definition_declaration_11.bal", "diffHunk": "@@ -0,0 +1,6 @@\n+distinct\n+  class\n+    Foo\n+        {\n+    string      name\n+ ;            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODA5MDQx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490809041", "createdAt": "2020-09-17T17:01:09Z", "commit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzowMTowOVrOHTsyEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzowMTowOVrOHTsyEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQxODcwNg==", "bodyText": "Missing new line", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490418706", "createdAt": "2020-09-17T17:01:09Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/resources/declarations/class-definition/source/class_definition_declaration_13.bal", "diffHunk": "@@ -0,0 +1,13 @@\n+readonly\n+ distinct\n+    class\n+        Foo\n+      {\n+    string  name ;\n+\n+\n+}\n+\n+distinct           readonly\n+         class           Foo          {\n+    string      name   ;     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b3c7d89ef748e55790d84a78e7af0a11e1abc7"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8be917d69a8feabf5a8de86bdde22f211f6800c", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b8be917d69a8feabf5a8de86bdde22f211f6800c", "committedDate": "2020-09-17T17:20:28Z", "message": "Merge branch 'master' into formatter-fixes-resolve-conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f80b02cf06ad4bae3b662fedfb7f01e9b779e9d7", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f80b02cf06ad4bae3b662fedfb7f01e9b779e9d7", "committedDate": "2020-09-17T18:04:13Z", "message": "Resolve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebd2ae03fc1958b9c277dbe0baaa58421cc0325b", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ebd2ae03fc1958b9c277dbe0baaa58421cc0325b", "committedDate": "2020-09-17T18:05:27Z", "message": "Merge branch 'master' into formatter-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3484c4e2c164f51d33cb9a4fd6336f550cb435a", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b3484c4e2c164f51d33cb9a4fd6336f550cb435a", "committedDate": "2020-09-17T18:32:21Z", "message": "Reformat the code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "961c0978f422d0fc6ab1b358cdef863e67b41174", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/961c0978f422d0fc6ab1b358cdef863e67b41174", "committedDate": "2020-09-17T18:33:16Z", "message": "Merge branch 'master' into formatter-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20b6415e12c5b0220fde94dbdd76b5fa6197d5ce", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/20b6415e12c5b0220fde94dbdd76b5fa6197d5ce", "committedDate": "2020-09-17T18:50:58Z", "message": "Reformat the code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd2aec6775d30e7a4f9fb16c4132e0db8dfa1700", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dd2aec6775d30e7a4f9fb16c4132e0db8dfa1700", "committedDate": "2020-09-17T19:04:32Z", "message": "Add missing newline character"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwOTA0NTkw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-490904590", "createdAt": "2020-09-17T19:09:59Z", "commit": {"oid": "dd2aec6775d30e7a4f9fb16c4132e0db8dfa1700"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28cb87295a1453b5aa7cbc65421455f475674560", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/28cb87295a1453b5aa7cbc65421455f475674560", "committedDate": "2020-09-17T19:30:42Z", "message": "Add extra newline at the end of each class definition declaration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "882c5d894f19f8063bfdb90fd8d9ecaacaaca1e4", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/882c5d894f19f8063bfdb90fd8d9ecaacaaca1e4", "committedDate": "2020-09-17T20:32:14Z", "message": "Remove superfluous spaces and newlines at the end of each file and leave only with a newline character"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c128d13051ada7ad8530e40b051dde6f982a3fd", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5c128d13051ada7ad8530e40b051dde6f982a3fd", "committedDate": "2020-09-17T21:25:16Z", "message": "Add blank line between empty class blocks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTI2MzQ2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-491126346", "createdAt": "2020-09-18T03:33:46Z", "commit": {"oid": "5c128d13051ada7ad8530e40b051dde6f982a3fd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMzozMzo0NlrOHT8wpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMzozMzo0NlrOHT8wpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY4MDQ4Nw==", "bodyText": "Shall we add this method inside the formatter without altering the parser? Since this new line is something added by the formatter itself?\nWe could move this to the FormatterUtils class.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490680487", "createdAt": "2020-09-18T03:33:46Z", "author": {"login": "IrushiL"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/syntax/tree/SyntaxTree.java", "diffHunk": "@@ -124,6 +124,17 @@ public String toSourceCode() {\n         return rootNode.toSourceCode();\n     }\n \n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c128d13051ada7ad8530e40b051dde6f982a3fd"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTMzMDMy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-491133032", "createdAt": "2020-09-18T03:50:22Z", "commit": {"oid": "5c128d13051ada7ad8530e40b051dde6f982a3fd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMzo1MDoyMlrOHT9HXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMzo1MDoyMlrOHT9HXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY4NjMwMg==", "bodyText": "Shall we change the actual formatter API (inside the Formatter class) output also? Since that would be what is returned to someone calling the formatter.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490686302", "createdAt": "2020-09-18T03:50:22Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/test/java/org/ballerinalang/formatter/core/FormatterTest.java", "diffHunk": "@@ -61,7 +61,7 @@ public void test(String source, String sourcePath) throws IOException {\n         SyntaxTree syntaxTree = SyntaxTree.from(textDocument);\n         SyntaxTree newSyntaxTree = Formatter.format(syntaxTree);\n         Assert.assertFalse(newSyntaxTree.hasDiagnostics());\n-        Assert.assertEquals(newSyntaxTree.toSourceCode(), getSourceText(assertFilePath));\n+        Assert.assertEquals(newSyntaxTree.toFormatterSourceCode(), getSourceText(assertFilePath));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c128d13051ada7ad8530e40b051dde6f982a3fd"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f5c9c03c6e14566d5a43cddd5955b6d4c8457b4", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0f5c9c03c6e14566d5a43cddd5955b6d4c8457b4", "committedDate": "2020-09-18T04:53:15Z", "message": "Move toFormattedSourceCode() method into FormatterUtils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "240a2fd428109572bc82061ab351ffefd598ecae", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/240a2fd428109572bc82061ab351ffefd598ecae", "committedDate": "2020-09-18T04:54:17Z", "message": "Merge branch 'master' into formatter-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39113ce725b968750cf8654a7d372f0502f6cc63", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/39113ce725b968750cf8654a7d372f0502f6cc63", "committedDate": "2020-09-18T05:13:57Z", "message": "Update Formatter API to use toFormattedSourceCode() when returning a formatted string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc7df351f9ffe107ff07fa0fad6236451a5b6c9b", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bc7df351f9ffe107ff07fa0fad6236451a5b6c9b", "committedDate": "2020-09-18T05:14:55Z", "message": "Merge branch 'master' into formatter-fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTY2OTU5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-491166959", "createdAt": "2020-09-18T05:47:49Z", "commit": {"oid": "bc7df351f9ffe107ff07fa0fad6236451a5b6c9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNTo0Nzo0OVrOHT-7NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNTo0Nzo0OVrOHT-7NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDcxNTk1Nw==", "bodyText": "There are multiple places we call System.getProperty(LINE_SEPARATOR), instead of keeping just the LINE_SEPARATOR as a static field, let's keep the actual return value.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#discussion_r490715957", "createdAt": "2020-09-18T05:47:49Z", "author": {"login": "nadeeshaan"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormatterUtils.java", "diffHunk": "@@ -551,6 +554,18 @@ static boolean addNewTrailingLine(NonTerminalNode parent, NonTerminalNode node)\n         return true;\n     }\n \n+    /**\n+     * Converts the syntax tree into source code, remove superfluous spaces and newlines at the ending and returns it\n+     * as a string.\n+     *\n+     * @param syntaxTree       syntaxTree\n+     * @return source code as a string\n+     */\n+    public static String toFormattedSourceCode(SyntaxTree syntaxTree) {\n+        return syntaxTree.toSourceCode().trim() +\n+                System.getProperty(LINE_SEPARATOR);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc7df351f9ffe107ff07fa0fad6236451a5b6c9b"}, "originalPosition": 104}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTcxNjQ4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25892#pullrequestreview-491171648", "createdAt": "2020-09-18T06:00:46Z", "commit": {"oid": "bc7df351f9ffe107ff07fa0fad6236451a5b6c9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4607, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}