{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1Njc3OTAy", "number": 20695, "title": "Fix build and run commands with relative path", "bodyText": "Purpose\n\nTo enable build and run commands to work with relative path.\n\nFixes\n\n#18786\n#20339\n#20454\n#20648\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-01-22T05:53:49Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695", "merged": true, "mergeCommit": {"oid": "b8990e38fd167a3ea7ef6c88b8bf387c7bfcde66"}, "closed": true, "closedAt": "2020-01-29T11:28:54Z", "author": {"login": "parkavi11"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8vY0fAFqTM0NjM2MDMwMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_CZzSgFqTM0OTk1ODU3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzYwMzAy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#pullrequestreview-346360302", "createdAt": "2020-01-22T05:59:51Z", "commit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNTo1OTo1MVrOFgRStA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjowMjo1MVrOFgRVcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MjA2OA==", "bodyText": "Shall we keep as 2017 since it was added in 2017.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369382068", "createdAt": "2020-01-22T05:59:51Z", "author": {"login": "warunalakshitha"}, "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/BuildCommand.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*\n- *  Copyright (c) 2017, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MjA5OQ==", "bodyText": "Year of the copy right should be the year that we commit the file. Since we add this file in 2019 we can keep as it is.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369382099", "createdAt": "2020-01-22T05:59:57Z", "author": {"login": "warunalakshitha"}, "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/RunCommand.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*\n- * Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MjE5Ng==", "bodyText": "This change no needed.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369382196", "createdAt": "2020-01-22T06:00:22Z", "author": {"login": "warunalakshitha"}, "path": "cli/ballerina-packerina/src/test/java/org/ballerinalang/packerina/cmd/BuildCommandTest.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*\n- *  Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MjcwMA==", "bodyText": "Shall we revert adding all package-lock.json files. We do not need those.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369382700", "createdAt": "2020-01-22T06:02:32Z", "author": {"login": "warunalakshitha"}, "path": "composer/packages/api-designer/package-lock.json", "diffHunk": "@@ -1,6 +1,6 @@\n {\n \t\"name\": \"@ballerina/api-designer\",\n-\t\"version\": \"1.1.0\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4Mjc2OA==", "bodyText": "We do not need this change.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369382768", "createdAt": "2020-01-22T06:02:51Z", "author": {"login": "warunalakshitha"}, "path": "tests/jballerina-integration-test/src/test/java/org/ballerinalang/test/packaging/SingleBalFileTestCase.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*\n- * Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzcxODg4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#pullrequestreview-346371888", "createdAt": "2020-01-22T06:42:25Z", "commit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0MjoyNVrOFgR38g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0MjoyNVrOFgR38g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MTYwMg==", "bodyText": "This wont give a relative path right ? validBalFilePath.resolve(\"valid-relative-path-bal-file/hello_world_relative.bal\")\nAlso we cannot have the file separate as /. Wont it break in Windows ?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369391602", "createdAt": "2020-01-22T06:42:25Z", "author": {"login": "hemikak"}, "path": "cli/ballerina-packerina/src/test/java/org/ballerinalang/packerina/cmd/BuildCommandTest.java", "diffHunk": "@@ -287,6 +287,22 @@ public void testBuildAllWithArg() throws IOException {\n         Assert.assertTrue(buildLog.contains(\"too many arguments.\\n\"));\n     }\n \n+    @Test(description = \"Build .bal files with the relative path\")\n+    public void testBuildWithRelativePath() throws IOException {\n+        // valid source root path\n+        Path validBalFilePath = this.testResources.resolve(\"valid-bal-file\");\n+        BuildCommand buildCommand = new BuildCommand(validBalFilePath, printStream, printStream, false, true);\n+        new CommandLine(buildCommand).parse(String.valueOf(validBalFilePath.resolve\n+                (\"valid-relative-path-bal-file/hello_world_relative.bal\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzcyMjk4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#pullrequestreview-346372298", "createdAt": "2020-01-22T06:43:46Z", "commit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0Mzo0N1rOFgR5pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0Mzo0N1rOFgR5pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MjAzOA==", "bodyText": "Do we need an integration test as well ?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369392038", "createdAt": "2020-01-22T06:43:47Z", "author": {"login": "hemikak"}, "path": "tests/jballerina-integration-test/src/test/java/org/ballerinalang/test/packaging/SingleBalFileTestCase.java", "diffHunk": "@@ -94,6 +94,19 @@ public void testSingleBalFileWithJDBCUsage() throws BallerinaTestException {\n         fooRunLeecher.waitForText(10000);\n     }\n \n+    @Test(description = \"Test running bal with relative path\")\n+    public void testRunWithRelativePath() throws BallerinaTestException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzcyMzkz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#pullrequestreview-346372393", "createdAt": "2020-01-22T06:44:06Z", "commit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0NDowNlrOFgR6Bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0NDowNlrOFgR6Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MjEzNA==", "bodyText": "I dont think we can hardcode the file separator.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r369392134", "createdAt": "2020-01-22T06:44:06Z", "author": {"login": "hemikak"}, "path": "tests/jballerina-integration-test/src/test/java/org/ballerinalang/test/packaging/SingleBalFileTestCase.java", "diffHunk": "@@ -94,6 +94,19 @@ public void testSingleBalFileWithJDBCUsage() throws BallerinaTestException {\n         fooRunLeecher.waitForText(10000);\n     }\n \n+    @Test(description = \"Test running bal with relative path\")\n+    public void testRunWithRelativePath() throws BallerinaTestException {\n+        String testBalFile = \"hello_world.bal\";\n+        Path testRelativeFilePath = Paths.get(\"src\", \"test\", \"resources\", \"packaging\", \"singleBalFile\",\n+                \"relative\", \"testDir\");\n+        // Run and see output\n+        String msg = \"Hello, World!\";\n+        LogLeecher fooRunLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"run\", new String[]{\"../testBal/hello_world.bal\"}, new HashMap<>(), new String[0],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10c12ae658066345b83d20a31cb10e84c9091fdb"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eeafbc66aed05665e81a522cffcf2c8ee7abda20", "author": {"user": {"login": "parkavi11", "name": "Parkavi"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eeafbc66aed05665e81a522cffcf2c8ee7abda20", "committedDate": "2020-01-27T10:16:39Z", "message": "Modify test on build command that support all OS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97603bdad18874c180699912de66d7fa7c6350c5", "author": {"user": {"login": "parkavi11", "name": "Parkavi"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/97603bdad18874c180699912de66d7fa7c6350c5", "committedDate": "2020-01-27T11:55:53Z", "message": "Remove unnecessary lines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "071a69eaf71dd414b43b0131006cdcbd4d6f7137", "author": {"user": {"login": "parkavi11", "name": "Parkavi"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/071a69eaf71dd414b43b0131006cdcbd4d6f7137", "committedDate": "2020-01-28T01:25:50Z", "message": "Modify unit test with correct path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "581c379c728844b8853efffbda8b672c05dff74e", "author": {"user": {"login": "parkavi11", "name": "Parkavi"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/581c379c728844b8853efffbda8b672c05dff74e", "committedDate": "2020-01-28T09:02:18Z", "message": "Fix ballerina-packerina test failure"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5ODg0Mjgx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#pullrequestreview-349884281", "createdAt": "2020-01-29T06:27:10Z", "commit": {"oid": "581c379c728844b8853efffbda8b672c05dff74e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5OTU4NTc1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#pullrequestreview-349958575", "createdAt": "2020-01-29T09:20:09Z", "commit": {"oid": "581c379c728844b8853efffbda8b672c05dff74e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwOToyMDowOVrOFjBZbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwOToyMDowOVrOFjBZbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI2NzM3Mg==", "bodyText": "Did you check java.nio.file.Path.relativize ?\nhttps://stackoverflow.com/questions/37747896/understanding-java-nio-file-path-relativizepath-other", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20695#discussion_r372267372", "createdAt": "2020-01-29T09:20:09Z", "author": {"login": "hemikak"}, "path": "cli/ballerina-packerina/src/test/java/org/ballerinalang/packerina/cmd/BuildCommandTest.java", "diffHunk": "@@ -459,6 +459,18 @@ public void testBuildCommand() throws IOException {\n         readOutput(true);\n     }\n \n+    @Test(description = \"Build a valid ballerina file with relative path\")\n+    public void testBuildWithRelativePath() throws IOException {\n+        String buildPath = \"relative\" + File.separator + \"testDir\" + File.separator + \"..\" + File.separator + \"testBal\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "581c379c728844b8853efffbda8b672c05dff74e"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4347, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}