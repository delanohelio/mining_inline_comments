{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2ODEyNDQz", "number": 22374, "title": "Fix unwanted listener endpoint creation and record creation failure for multiple services", "bodyText": "Purpose\n\nFixes #21088\nFixes #22361\n\nApproach\n\nChange messageList -> messageMap\nUse flag to check the endpoint already created or not.\n\nSamples\nGenerate service files using the following protobuf file.\nsyntax = \"proto3\";\n\nimport \"google/protobuf/wrappers.proto\";\nservice Register {\n\trpc registerPerson (Person) returns (google.protobuf.BoolValue);\n}\n\nservice Provider {\n\trpc fetchPerson (google.protobuf.StringValue) returns (Person);\n}\n\nmessage Person {\n    string name = 1;\n}\nIt will generate two service files that share a common endpoint.\nimport ballerina/grpc;\n\nlistener grpc:Listener ep = new (9090);\n\nservice Register on ep {\n\n    resource function registerPerson(grpc:Caller caller, Person value) {\n        // Implementation goes here.\n\n        // You should return a boolean\n    }\n}\nimport ballerina/grpc;\n\nservice Provider on ep {\n\n    resource function fetchPerson(grpc:Caller caller, string value) {\n        // Implementation goes here.\n\n        // You should return a Person\n    }\n}\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-04-01T07:33:56Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22374", "merged": true, "mergeCommit": {"oid": "1e3c75691174759ac562ffe9fd6ea25aa39299a2"}, "closed": true, "closedAt": "2020-04-01T17:17:36Z", "author": {"login": "BuddhiWathsala"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTSn8lAH2gAyMzk2ODEyNDQzOjM1MDVkMmIwZDYzNjcwODM4N2Q4NDY0NTIyMmQ5YmUzNjUzYjhmZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTUabugH2gAyMzk2ODEyNDQzOjc5Y2Q1OTIyMjhiZjIzMzZiZjQ5NDg4YTgxMGFkNmI1MmQ2MDM5MmE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3505d2b0d636708387d84645222d9be3653b8fdf", "author": {"user": {"login": "BuddhiWathsala", "name": "Buddhi Kothalawala"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3505d2b0d636708387d84645222d9be3653b8fdf", "committedDate": "2020-04-01T07:32:34Z", "message": "change messageList->messageMap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38e0a32296fd2ec27edca0067918f21aa6b3d2c7", "author": {"user": {"login": "BuddhiWathsala", "name": "Buddhi Kothalawala"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/38e0a32296fd2ec27edca0067918f21aa6b3d2c7", "committedDate": "2020-04-01T07:32:34Z", "message": "disable unwanted endpoint listener creation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2d5b4ea7e095416315ce393e6722e44d48187cf", "author": {"user": {"login": "BuddhiWathsala", "name": "Buddhi Kothalawala"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a2d5b4ea7e095416315ce393e6722e44d48187cf", "committedDate": "2020-04-01T07:32:34Z", "message": "test to check multiple service creation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQ5MzQw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22374#pullrequestreview-385349340", "createdAt": "2020-04-01T08:02:44Z", "commit": {"oid": "a2d5b4ea7e095416315ce393e6722e44d48187cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODowMjo0NFrOF-1JBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODowMjo0NFrOF-1JBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQyNjY5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            }\n          \n          \n            \n            }", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22374#discussion_r401426695", "createdAt": "2020-04-01T08:02:44Z", "author": {"login": "daneshk"}, "path": "tests/jballerina-integration-test/src/test/resources/grpc/src/tool/multipleServices.proto", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+\n+syntax = \"proto3\";\n+\n+import \"google/protobuf/wrappers.proto\";\n+service Register {\n+    rpc registerPerson (Person) returns (google.protobuf.BoolValue);\n+}\n+\n+service Provider {\n+    rpc fetchPerson (google.protobuf.StringValue) returns (Person);\n+}\n+\n+message Person {\n+    string name = 1;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2d5b4ea7e095416315ce393e6722e44d48187cf"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzUxODU3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22374#pullrequestreview-385351857", "createdAt": "2020-04-01T08:06:24Z", "commit": {"oid": "a2d5b4ea7e095416315ce393e6722e44d48187cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0506a4eb32906e2ebac269d7c895ca5e318b99ee", "author": {"user": {"login": "BuddhiWathsala", "name": "Buddhi Kothalawala"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0506a4eb32906e2ebac269d7c895ca5e318b99ee", "committedDate": "2020-04-01T08:23:23Z", "message": "add tailed line\n\nCo-Authored-By: Danesh Kuruppu <daneshk@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b60bead9042cb60ace9c74c9830748c24ef6797", "author": {"user": {"login": "BuddhiWathsala", "name": "Buddhi Kothalawala"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b60bead9042cb60ace9c74c9830748c24ef6797", "committedDate": "2020-04-01T09:36:12Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79cd592228bf2336bf49488a810ad6b52d60392a", "author": {"user": {"login": "BuddhiWathsala", "name": "Buddhi Kothalawala"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/79cd592228bf2336bf49488a810ad6b52d60392a", "committedDate": "2020-04-01T09:37:37Z", "message": "Merge branch 'root-desc' of https://github.com/BuddhiWathsala/ballerina-lang into root-desc"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4130, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}