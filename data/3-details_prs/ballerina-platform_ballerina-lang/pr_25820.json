{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MjQ0NDY0", "number": 25820, "title": "Add doc support for classes and abstract objects", "bodyText": "Purpose\n\n\nAdds docerina support for classes and abstract objects.\nAnonymous objects are now shown inline\n\n\nFixes #25536\nFixes #24915\nFixes #22715\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-15T11:56:16Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820", "merged": true, "mergeCommit": {"oid": "53da418d3f6ace15e54cf4ee72d1e47e16445002"}, "closed": true, "closedAt": "2020-09-17T04:40:55Z", "author": {"login": "shehan360"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJGXUJgH2gAyNDg3MjQ0NDY0OjhkZGY5M2EyNjQ2MDdjYzlmMjEzNGM1NjVhYTYyMzk2NWJjMzNlNWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJpdZLAFqTQ5MDIzNzg4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8ddf93a264607cc9f2134c565aa623965bc33e5e", "committedDate": "2020-09-15T11:47:27Z", "message": "Change objects to class, add abstract objects"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4Nzg0Njk5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488784699", "createdAt": "2020-09-15T15:06:56Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTowNjo1NlrOHSGi5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTowNjo1NlrOHSGi5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0MzY1Mg==", "bodyText": "@shehan360 do we need check? Below for each won't execute if there are 0 entries?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488743652", "createdAt": "2020-09-15T15:06:56Z", "author": {"login": "keizer619"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/Generator.java", "diffHunk": "@@ -417,28 +391,48 @@ private static void addDocForObjectType(BLangObjectTypeNode objectType,\n                 }\n             }\n         }\n+        module.abstractObjects.add(new BAbstractObject(name, description, isDeprecated, fields, functions));\n+    }\n+\n+    private static void addDocForClassType(BLangClassDefinition classDefinition, Module module) {\n+        List<Function> functions = new ArrayList<>();\n+        String name = classDefinition.getName().getValue();\n+        String description = description(classDefinition);\n+        boolean isDeprecated = isDeprecated(classDefinition.getAnnotationAttachments());\n+\n+        List<DefaultableVariable> fields = getFields(classDefinition, classDefinition.fields,\n+                classDefinition.getMarkdownDocumentationAttachment(), module);\n+\n+        // Iterate through the functions\n+        if (classDefinition.getFunctions().size() > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 171}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NzkxMDUx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488791051", "createdAt": "2020-09-15T15:13:26Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODE0NzMw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488814730", "createdAt": "2020-09-15T15:37:37Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTozNzozN1rOHSH8gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTozNzozN1rOHSH8gQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2NjU5Mw==", "bodyText": "isAnonymous is never used", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488766593", "createdAt": "2020-09-15T15:37:37Z", "author": {"login": "pramodya1994"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/Generator.java", "diffHunk": "@@ -391,9 +365,9 @@ private static String findDescFromList(String name, BLangMarkdownDocumentation d\n         }\n     }\n \n-    private static void addDocForObjectType(BLangObjectTypeNode objectType,\n-                                            BLangTypeDefinition parent,\n-                                            Module module) {\n+    private static void addDocForAbstractObjectType(BLangObjectTypeNode objectType,\n+                                                    BLangTypeDefinition parent,\n+                                                    Module module) {\n         List<Function> functions = new ArrayList<>();\n         String name = parent.getName().getValue();\n         boolean isAnonymous = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 153}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODE4NDQ2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488818446", "createdAt": "2020-09-15T15:41:38Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo0MTozOFrOHSIH4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo0MTozOFrOHSIH4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2OTUwNQ==", "bodyText": "handlebars.registerHelper(\"addColon\",\n                    (Helper<PageContext>) (page, options) -> page.getClass() == ClassPageContext.class\n                            || page.getClass() == RecordPageContext.class || page.getClass() == ClientPageContext.class\n                            || page.getClass() == ListenerPageContext.class);\nCan't we simplify L152 - 160 like this?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488769505", "createdAt": "2020-09-15T15:41:38Z", "author": {"login": "pramodya1994"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/Writer.java", "diffHunk": "@@ -168,7 +150,7 @@ public static void writeHtmlDocument(Object object, String packageTemplateName,\n             });\n \n             handlebars.registerHelper(\"addColon\", (Helper<PageContext>) (page, options) -> {\n-                if (page.getClass() == ObjectPageContext.class || page.getClass() == RecordPageContext.class ||\n+                if (page.getClass() == ClassPageContext.class || page.getClass() == RecordPageContext.class ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 58}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODIwNDU5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488820459", "createdAt": "2020-09-15T15:43:42Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo0Mzo0M1rOHSIOFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo0Mzo0M1rOHSIOFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3MTA5NQ==", "bodyText": "Access can be package-private for both consts", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488771095", "createdAt": "2020-09-15T15:43:43Z", "author": {"login": "pramodya1994"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/docs/BallerinaDocConstants.java", "diffHunk": "@@ -34,7 +34,8 @@\n     public static final String ORG_NAME = \"org-name\";\n     public static final String VERSION = \"version\";\n     public static final String RECORD_TEMPLATE_NAME_KEY = \"record.template.name\";\n-    public static final String OBJECT_TEMPLATE_NAME_KEY = \"object.template.name\";\n+    public static final String CLASS_TEMPLATE_NAME_KEY = \"class.template.name\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODI0NDQx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488824441", "createdAt": "2020-09-15T15:48:05Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo0ODowNlrOHSIaSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo0ODowNlrOHSIaSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NDIxOA==", "bodyText": "make this a static final constant or private & provide getters if need to access", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488774218", "createdAt": "2020-09-15T15:48:06Z", "author": {"login": "pramodya1994"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/generator/model/AbstractObjectPageContext.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://wso2.com) All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.ballerinalang.docgen.generator.model;\n+\n+/**\n+ * Page context for the Abstract Object page.\n+ *\n+ * @since 2.0\n+ */\n+public class AbstractObjectPageContext extends ModulePageContext {\n+    public BAbstractObject abstractObject;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODI4MTcw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488828170", "createdAt": "2020-09-15T15:52:08Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo1MjowOFrOHSIluQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo1MjowOFrOHSIluQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NzE0NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public BClass bClass;\n          \n          \n            \n                private BClass bClass;\n          \n      \n    \n    \n  \n\nAccess ca be private", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488777145", "createdAt": "2020-09-15T15:52:08Z", "author": {"login": "pramodya1994"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/generator/model/ClassPageContext.java", "diffHunk": "@@ -16,13 +16,15 @@\n package org.ballerinalang.docgen.generator.model;\n \n /**\n- * Page context for the object page.\n+ * Page context for the bClass page.\n+ *\n+ * @since 2.0\n  */\n-public class ObjectPageContext extends ModulePageContext {\n-    public Object object;\n-    public ObjectPageContext(Object object, Module module, Project project, String rootPath, String title,\n-                             boolean excludeIndex) {\n+public class ClassPageContext extends ModulePageContext {\n+    public BClass bClass;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODMwNzEz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488830713", "createdAt": "2020-09-15T15:54:55Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo1NDo1NVrOHSItYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo1NDo1NVrOHSItYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3OTEwNw==", "bodyText": "// if anonymous empty record can remove one, since the same comment duplicated.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488779107", "createdAt": "2020-09-15T15:54:55Z", "author": {"login": "pramodya1994"}, "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/generator/model/Type.java", "diffHunk": "@@ -216,12 +217,14 @@ public static Type fromTypeNode(BLangType type, String currentModule) {\n         // If anonymous type substitute the name\n         if (typeModel.name != null && typeModel.name.contains(\"$anonType$\")) {\n             // if anonymous empty record\n-            if (type.type instanceof BRecordType && ((BRecordType) type.type).fields.isEmpty()) {\n-                    typeModel.name = type.type.toString();\n-                    typeModel.generateUserDefinedTypeLink = false;\n+            // if anonymous empty record", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODMzNTgz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-488833583", "createdAt": "2020-09-15T15:58:05Z", "commit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo1ODowNlrOHSI2Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTo1ODowNlrOHSI2Ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc4MTMzMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                List<BClass> bClasses;\n          \n          \n            \n                priavte List<BClass> bClasses;", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488781331", "createdAt": "2020-09-15T15:58:06Z", "author": {"login": "pramodya1994"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/documentation/ObjectFieldDefaultValueTest.java", "diffHunk": "@@ -41,12 +41,12 @@\n import java.util.Map;\n \n /**\n- * Test cases to check default value initialization for objects in docs.\n+ * Test cases to check default value initialization for bClasses in docs.\n  */\n @Test(groups = \"brokenOnClassChange\")\n public class ObjectFieldDefaultValueTest {\n     private Module testModule;\n-    List<Object> objects;\n+    List<BClass> bClasses;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afa27d7930815775437f813447b62264d2210e2b", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/afa27d7930815775437f813447b62264d2210e2b", "committedDate": "2020-09-16T06:26:55Z", "message": "Change objects to class, add abstract objects"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MzYwMjYx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-489360261", "createdAt": "2020-09-16T07:47:14Z", "commit": {"oid": "afa27d7930815775437f813447b62264d2210e2b"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55b7839c23c20cdd0037e0d87d9cad6b451456b9", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/55b7839c23c20cdd0037e0d87d9cad6b451456b9", "committedDate": "2020-09-16T08:31:48Z", "message": "Change objects to class, add abstract objects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9c3ef73f8ad82ad7d41b319cf014cdc532e8493", "author": {"user": {"login": "shehan360", "name": "Shehan Panditharatne"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c9c3ef73f8ad82ad7d41b319cf014cdc532e8493", "committedDate": "2020-09-16T08:45:05Z", "message": "Change objects to class, add abstract objects"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMjM3ODgx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#pullrequestreview-490237881", "createdAt": "2020-09-17T04:40:46Z", "commit": {"oid": "c9c3ef73f8ad82ad7d41b319cf014cdc532e8493"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4748, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}