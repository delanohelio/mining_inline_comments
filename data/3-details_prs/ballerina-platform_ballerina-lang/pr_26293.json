{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwNDY0Mzgy", "number": 26293, "title": "Add package level compilation to ProjectAPI", "bodyText": "Purpose\n$subject.\nRelated to #26262\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-10-09T09:27:21Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26293", "merged": true, "mergeCommit": {"oid": "1ad27443a5d58de3b9689bcb9fe2c691ac238da5"}, "closed": true, "closedAt": "2020-10-09T13:22:02Z", "author": {"login": "Kishanthan"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQwZjvgH2gAyNTAwNDY0MzgyOjc2ODg1YmViMzNmMTk2ODUzODdjZjY5ZDI3MTdhZGE3YjI0Zjg1MDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQ2GcSAFqTUwNTY2Njc2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "76885beb33f19685387cf69d2717ada7b24f8501", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/76885beb33f19685387cf69d2717ada7b24f8501", "committedDate": "2020-10-09T06:43:23Z", "message": "Use correct packageId for module load response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e60da94f067304bdf867e482ff3c370cee92e1ff", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e60da94f067304bdf867e482ff3c370cee92e1ff", "committedDate": "2020-10-09T06:44:57Z", "message": "Add package level compilation to PorjectAPI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff244a5ea4667a452f229c2294b74f2f0e43d463", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff244a5ea4667a452f229c2294b74f2f0e43d463", "committedDate": "2020-10-09T09:09:07Z", "message": "Include transitive dependencies for module dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "782746f62c6f97552413c74f20b727d8ddf564b6", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/782746f62c6f97552413c74f20b727d8ddf564b6", "committedDate": "2020-10-09T09:09:45Z", "message": "Add test to verify package compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b1017574c8e1f3e10805b50682066e3a480227e", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b1017574c8e1f3e10805b50682066e3a480227e", "committedDate": "2020-10-09T09:15:05Z", "message": "Merge with remote"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9024e2c01a78a158dacb70eea7576cbb19ef114d", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9024e2c01a78a158dacb70eea7576cbb19ef114d", "committedDate": "2020-10-09T09:22:33Z", "message": "Include transitive dependencies for module dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NTUxMDUw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26293#pullrequestreview-505551050", "createdAt": "2020-10-09T10:28:36Z", "commit": {"oid": "b0ebc6185a51aa808d112e1649e9a94ac2cb534a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMDoyODozN1rOHfEJlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMDoyODozN1rOHfEJlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjMzNTg5NQ==", "bodyText": "moduleContext hides the class level field defined in L41. Can we use other name for this?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26293#discussion_r502335895", "createdAt": "2020-10-09T10:28:37Z", "author": {"login": "pramodya1994"}, "path": "compiler/ballerina-lang/src/main/java/io/ballerina/build/ModuleCompilation.java", "diffHunk": "@@ -66,9 +66,21 @@\n         return new DependencyGraph<>(dependencyIdMap);\n     }\n \n-    void addModuleDependencies(ModuleId moduleId, Map<ModuleId, Set<ModuleId>> dependencyIdMap) {\n+    private void addModuleDependencies(ModuleId moduleId, Map<ModuleId, Set<ModuleId>> dependencyIdMap) {\n         Package pkg = packageResolver.getPackage(moduleId.packageId());\n         Collection<ModuleId> directDependencies = pkg.moduleDependencyGraph().getDirectDependencies(moduleId);\n+\n+        ModuleContext moduleContext = pkg.packageContext().moduleContext(moduleId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0ebc6185a51aa808d112e1649e9a94ac2cb534a"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b0ebc6185a51aa808d112e1649e9a94ac2cb534a", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b0ebc6185a51aa808d112e1649e9a94ac2cb534a", "committedDate": "2020-10-09T09:23:08Z", "message": "Add package level compilation to ProjectAPI"}, "afterCommit": {"oid": "edd05e26187f1ab55ca52110c2118e5151d51bdb", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/edd05e26187f1ab55ca52110c2118e5151d51bdb", "committedDate": "2020-10-09T10:29:08Z", "message": "Add package level compilation to ProjectAPI"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "edd05e26187f1ab55ca52110c2118e5151d51bdb", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/edd05e26187f1ab55ca52110c2118e5151d51bdb", "committedDate": "2020-10-09T10:29:08Z", "message": "Add package level compilation to ProjectAPI"}, "afterCommit": {"oid": "2791bc671d8896ec2860023d85303b92aa4fd4c1", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2791bc671d8896ec2860023d85303b92aa4fd4c1", "committedDate": "2020-10-09T10:31:49Z", "message": "Add package level compilation to ProjectAPI"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2791bc671d8896ec2860023d85303b92aa4fd4c1", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2791bc671d8896ec2860023d85303b92aa4fd4c1", "committedDate": "2020-10-09T10:31:49Z", "message": "Add package level compilation to ProjectAPI"}, "afterCommit": {"oid": "daad2e90982019a66eb86e841f2f1c0d759719bb", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/daad2e90982019a66eb86e841f2f1c0d759719bb", "committedDate": "2020-10-09T10:33:06Z", "message": "Add package level compilation to ProjectAPI"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NTYyNzgy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26293#pullrequestreview-505562782", "createdAt": "2020-10-09T10:46:07Z", "commit": {"oid": "daad2e90982019a66eb86e841f2f1c0d759719bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMDo0NjowN1rOHfEp0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMDo0NjowN1rOHfEp0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM0NDE0NA==", "bodyText": "@sameerajayasoma , using currentPkg.packageId() seems to be a bug here which was the issue for package dependencies becoming empty (which we saw during the debug session)", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26293#discussion_r502344144", "createdAt": "2020-10-09T10:46:07Z", "author": {"login": "Kishanthan"}, "path": "project-api/ballerina-projects/src/main/java/io/ballerina/projects/env/CustomPackageResolver.java", "diffHunk": "@@ -65,7 +65,8 @@ public CustomPackageResolver(Project project) {\n                 // TODO load the module from the custom_project_dir\n                 module = loadFromCustomProjectDir(modLoadRequest);\n             }\n-            modLoadResponses.add(new ModuleLoadResponse(currentPkg.packageId(), module.moduleId(), modLoadRequest));\n+            modLoadResponses.add(new ModuleLoadResponse(module.packageInstance().packageId(), module.moduleId(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "daad2e90982019a66eb86e841f2f1c0d759719bb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90b2e8bd5ad285882e104f6992a12fc191155fbb", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/90b2e8bd5ad285882e104f6992a12fc191155fbb", "committedDate": "2020-10-09T10:51:43Z", "message": "Add package level compilation to ProjectAPI"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "daad2e90982019a66eb86e841f2f1c0d759719bb", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/daad2e90982019a66eb86e841f2f1c0d759719bb", "committedDate": "2020-10-09T10:33:06Z", "message": "Add package level compilation to ProjectAPI"}, "afterCommit": {"oid": "90b2e8bd5ad285882e104f6992a12fc191155fbb", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/90b2e8bd5ad285882e104f6992a12fc191155fbb", "committedDate": "2020-10-09T10:51:43Z", "message": "Add package level compilation to ProjectAPI"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NjY2NzYx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26293#pullrequestreview-505666761", "createdAt": "2020-10-09T13:21:56Z", "commit": {"oid": "90b2e8bd5ad285882e104f6992a12fc191155fbb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4551, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}