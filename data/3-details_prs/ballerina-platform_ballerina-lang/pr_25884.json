{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4NjM3NzYx", "number": 25884, "title": "Fix issue in recognizing overloaded instance method", "bodyText": "Purpose\n\nFailure is when there's an overloaded instance and static methods with parameters differing by one.\nResolve #22858\n\nApproach\n\nMandates having paramTypes specified in such cases and allows having an empty array for paramTypes to indicate no parameters.\n\nSamples\n\nN/A\n\nRemarks\n\nN/A\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-17T12:37:38Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884", "merged": true, "mergeCommit": {"oid": "df3fdb8b33c7b76449d60fb516ee3aebc5c71cb9"}, "closed": true, "closedAt": "2020-09-18T08:37:01Z", "author": {"login": "riyafa"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJzJ-8gFqTQ5MDc1MDU3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKA0dvgFqTQ5MTIzMTU5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzUwNTc3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#pullrequestreview-490750577", "createdAt": "2020-09-17T15:58:37Z", "commit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTo1ODozN1rOHTpfuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTo1ODozN1rOHTpfuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM2NDg1Ng==", "bodyText": "2019?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#discussion_r490364856", "createdAt": "2020-09-17T15:58:37Z", "author": {"login": "Kishanthan"}, "path": "tests/jballerina-unit-test/src/test/resources/test-src/javainterop/negative/method_resolve_error.bal", "diffHunk": "@@ -0,0 +1,28 @@\n+// Copyright (c) 2019 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzUwNzQ3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#pullrequestreview-490750747", "createdAt": "2020-09-17T15:58:44Z", "commit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTo1ODo0NFrOHTpgBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTo1ODo0NFrOHTpgBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM2NDkzNA==", "bodyText": "2019?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#discussion_r490364934", "createdAt": "2020-09-17T15:58:44Z", "author": {"login": "Kishanthan"}, "path": "tests/jballerina-unit-test/src/test/resources/test-src/javainterop/basic/static_method_tests.bal", "diffHunk": "@@ -1,6 +1,23 @@\n+// Copyright (c) 2019 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzUxMDc4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#pullrequestreview-490751078", "createdAt": "2020-09-17T15:58:53Z", "commit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTo1ODo1M1rOHTpgYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTo1ODo1M1rOHTpgYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM2NTAyNw==", "bodyText": "2019?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#discussion_r490365027", "createdAt": "2020-09-17T15:58:53Z", "author": {"login": "Kishanthan"}, "path": "tests/jballerina-unit-test/src/test/resources/test-src/javainterop/basic/instance_method_tests.bal", "diffHunk": "@@ -1,4 +1,21 @@\n+// Copyright (c) 2019 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9a44bd5aafff24bce8fb1ff8b125785b1a40a5b3", "committedDate": "2020-09-17T12:23:42Z", "message": "Fix issue in recognizing overloaded instance method\n\nFailure is when there's an overloaded instance and static methods with parameters differing by one.\nResolve https://github.com/ballerina-platform/ballerina-lang/issues/22858"}, "afterCommit": {"oid": "271e240d2b8a619f2a7fc01d614afe512efa56a3", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/271e240d2b8a619f2a7fc01d614afe512efa56a3", "committedDate": "2020-09-17T16:53:01Z", "message": "Fix issue in recognizing overloaded instance method\n\nFailure is when there's an overloaded instance and static methods with parameters differing by one.\nResolve https://github.com/ballerina-platform/ballerina-lang/issues/22858"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTY1MDA4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#pullrequestreview-491165008", "createdAt": "2020-09-18T05:42:02Z", "commit": {"oid": "271e240d2b8a619f2a7fc01d614afe512efa56a3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNTo0MjowM1rOHT-1Dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNTo0MjowM1rOHT-1Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDcxNDM4Mw==", "bodyText": "do we have to check for static here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#discussion_r490714383", "createdAt": "2020-09-18T05:42:03Z", "author": {"login": "Kishanthan"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/bir/codegen/interop/JMethodResolver.java", "diffHunk": "@@ -138,29 +137,30 @@ JMethod resolve(JMethodRequest jMethodRequest) {\n                 .collect(Collectors.toList());\n     }\n \n-    private List<JMethod> resolveByParamCount(List<JMethod> jMethods, int expectedCount, BType receiverType) {\n-        return jMethods.stream().filter(jMethod -> {\n-            int count = jMethod.getParamTypes().length;\n-            if (count == expectedCount) {\n+    private List<JMethod> resolveByParamCount(List<JMethod> jMethods, JMethodRequest jMethodRequest) {\n+        return jMethods.stream()\n+                .filter(jMethod -> hasEqualParamCounts(jMethodRequest, jMethod))\n+                .collect(Collectors.toList());\n+    }\n+\n+    private boolean hasEqualParamCounts(JMethodRequest jMethodRequest, JMethod jMethod) {\n+        int expectedCount = getBFuncParamCount(jMethodRequest, jMethod);\n+        int count = jMethod.getParamTypes().length;\n+        if (count == expectedCount) {\n+            return true;\n+        } else if (count == expectedCount + 1) {\n+            // This is for object interop functions when self is passed as a parameter\n+            if (jMethodRequest.receiverType != null) {\n+                jMethod.setReceiverType(jMethodRequest.receiverType);\n                 return true;\n-            } else {\n-                boolean hasOneExtraParam = count == expectedCount + 1;\n-                if (hasOneExtraParam) {\n-                    boolean hasReceiver = receiverType != null;\n-                    if (hasReceiver) {\n-                        jMethod.setReceiverType(receiverType);\n-                        return true;\n-                    } else if (jMethod.isBalEnvAcceptingMethod()) {\n-                        return true;\n-                    }\n-                }\n+            } else if (jMethod.isStatic()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "271e240d2b8a619f2a7fc01d614afe512efa56a3"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTg4MjQ3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#pullrequestreview-491188247", "createdAt": "2020-09-18T06:40:08Z", "commit": {"oid": "271e240d2b8a619f2a7fc01d614afe512efa56a3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNjo0MDowOFrOHT__rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNjo0MDowOFrOHT__rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDczMzQ4Nw==", "bodyText": "Shall we include the message \"more than one method found\" or something related here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#discussion_r490733487", "createdAt": "2020-09-18T06:40:08Z", "author": {"login": "Kishanthan"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/bir/codegen/interop/JMethodResolver.java", "diffHunk": "@@ -184,18 +184,22 @@ private JMethod resolve(JMethodRequest jMethodRequest, List<JMethod> jMethods) {\n     }\n \n     private Optional<JMethod> findCovariantReturnTypeMethod(List<JMethod> jMethods) {\n-\n         for (int i = 0; i < jMethods.size(); i++) {\n-            for (int k = i; k < jMethods.size(); k++) {\n-                if (i == k) {\n-                    continue;\n-                }\n-\n+            for (int k = i + 1; k < jMethods.size(); k++) {\n                 JMethod ithMethod = jMethods.get(i);\n                 JMethod kthMethod = jMethods.get(k);\n \n                 if (ithMethod.getReturnType().isAssignableFrom(kthMethod.getReturnType()) ||\n                         kthMethod.getReturnType().isAssignableFrom(ithMethod.getReturnType())) {\n+                    if (ithMethod.getParamTypes().length != kthMethod.getParamTypes().length) {\n+                        // This occurs when there are static methods and instance methods and the static method\n+                        // has one more parameter than the instance method. Also this occurs when an interop\n+                        // method in an object maps to instance methods of which one accepting self and another\n+                        // that doesn't.\n+                        throw new JInteropException(OVERLOADED_METHODS,\n+                                                    \"Please specify the parameterTypes for each parameter in \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "271e240d2b8a619f2a7fc01d614afe512efa56a3"}, "originalPosition": 88}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "271e240d2b8a619f2a7fc01d614afe512efa56a3", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/271e240d2b8a619f2a7fc01d614afe512efa56a3", "committedDate": "2020-09-17T16:53:01Z", "message": "Fix issue in recognizing overloaded instance method\n\nFailure is when there's an overloaded instance and static methods with parameters differing by one.\nResolve https://github.com/ballerina-platform/ballerina-lang/issues/22858"}, "afterCommit": {"oid": "657bff158bc5f86aa1f0b03fc847b41d9418270a", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/657bff158bc5f86aa1f0b03fc847b41d9418270a", "committedDate": "2020-09-18T06:50:32Z", "message": "Fix failing javaDoc task"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c31428427045544709d7e0599d7cb74791528b5c", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c31428427045544709d7e0599d7cb74791528b5c", "committedDate": "2020-09-18T06:59:09Z", "message": "Fix issue in recognizing overloaded instance method\n\nFailure is when there's an overloaded instance and static methods with parameters differing by one.\nResolve https://github.com/ballerina-platform/ballerina-lang/issues/22858"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03f318e733df3a9e358d17d86b9b356e8dd788cb", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/03f318e733df3a9e358d17d86b9b356e8dd788cb", "committedDate": "2020-09-18T06:59:24Z", "message": "Fix failing javaDoc task"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "657bff158bc5f86aa1f0b03fc847b41d9418270a", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/657bff158bc5f86aa1f0b03fc847b41d9418270a", "committedDate": "2020-09-18T06:50:32Z", "message": "Fix failing javaDoc task"}, "afterCommit": {"oid": "03f318e733df3a9e358d17d86b9b356e8dd788cb", "author": {"user": {"login": "riyafa", "name": "Riyafa Abdul Hameed"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/03f318e733df3a9e358d17d86b9b356e8dd788cb", "committedDate": "2020-09-18T06:59:24Z", "message": "Fix failing javaDoc task"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMjMxNTk1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25884#pullrequestreview-491231595", "createdAt": "2020-09-18T07:53:47Z", "commit": {"oid": "03f318e733df3a9e358d17d86b9b356e8dd788cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4601, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}