{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNzAzNTQ1", "number": 20874, "title": "Implement test functionality for single test files", "bodyText": "Purpose\nThe functionality to test single test files needed to be implemented.\nFixes #20885\nApproach\nRemoved restrictions on running single test files. The implementation for testing single files exists partially in the codebase. The functionality was re-implemented with some small changes.\nWith this implementation, a test file can be individually run without it having to be inside a Tests folder in a ballerina project.\nThis implementation is aimed at running tests outside of a Ballerina project. Running of individual test files within the test folder of a Ballerina project is restricted.\nSamples\nUpdated the test report to display only the tested file.\nballerina test main_test.bal\nCompiling source\n        main_test.bal\n[BTestRunner] [buildSuites] Running build suites\n\nRunning tests\n        main_test.bal\n\n        [fail] testAssertStringEquals:\n            string values not equal: expected 'JohnDoe' but found 'JaneDoe' \n                at ballerina.test:createBallerinaError(assert.bal:41)\n                ballerina.test:assertEquals(assert.bal:82)\n                main_test:testAssertStringEquals(main_test.bal:29)\n\n        [fail] testAssertFloatEquals:\n            float values not equal: expected '30.05' but found '30.0' \n                at ballerina.test:createBallerinaError(assert.bal:41)\n                ballerina.test:assertEquals(assert.bal:82)\n                main_test:testAssertFloatEquals(main_test.bal:20)\n\n        [pass] testAssertFail\n        [pass] testAssertFalse\n        [pass] testAssertTrue\n        [pass] testAssertNotEqualsJson\n        [pass] testAssertNotEqualsString\n        [pass] testAssertFloatArrayEquals\n        [pass] testAssertIntArrayEquals\n        [pass] testAssertStringArrayEquals\n        [pass] testAssertBooleanEquals\n        [pass] testAssertJsonEquals\n        [pass] testAssertIntEquals\n\n        11 passing\n        2 failing\n        0 skipped\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-02-06T04:34:37Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874", "merged": true, "mergeCommit": {"oid": "e9be81f40548dd1f214f5087436825aa29933e82"}, "closed": true, "closedAt": "2020-02-11T05:17:38Z", "author": {"login": "Ibaqu"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBjQOEABqjMwMTI0ODk4MTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDKt8GgFqTM1NjQyMTIxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "689835e21e295a67e4bd8da78b0150e87e90a623", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/689835e21e295a67e4bd8da78b0150e87e90a623", "committedDate": "2020-02-03T09:42:55Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "2a79b089a5e9d0e443dddbd4ad857769ce975ee0", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2a79b089a5e9d0e443dddbd4ad857769ce975ee0", "committedDate": "2020-02-03T11:15:24Z", "message": "Implement test functionality for single test files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a79b089a5e9d0e443dddbd4ad857769ce975ee0", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2a79b089a5e9d0e443dddbd4ad857769ce975ee0", "committedDate": "2020-02-03T11:15:24Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "50736dd48777fa7e73e5e0a205f774ca26955a20", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/50736dd48777fa7e73e5e0a205f774ca26955a20", "committedDate": "2020-02-06T04:59:36Z", "message": "Implement test functionality for single test files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "50736dd48777fa7e73e5e0a205f774ca26955a20", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/50736dd48777fa7e73e5e0a205f774ca26955a20", "committedDate": "2020-02-06T04:59:36Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "38a84d634b599159262b1b4e14a87a4f4230700b", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/38a84d634b599159262b1b4e14a87a4f4230700b", "committedDate": "2020-02-06T08:39:06Z", "message": "Implement test functionality for single test files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38a84d634b599159262b1b4e14a87a4f4230700b", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/38a84d634b599159262b1b4e14a87a4f4230700b", "committedDate": "2020-02-06T08:39:06Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "90e05a425322fb8760cdaafda9d2d69667e2f37d", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/90e05a425322fb8760cdaafda9d2d69667e2f37d", "committedDate": "2020-02-06T11:21:36Z", "message": "Implement test functionality for single test files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90e05a425322fb8760cdaafda9d2d69667e2f37d", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/90e05a425322fb8760cdaafda9d2d69667e2f37d", "committedDate": "2020-02-06T11:21:36Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "a3d071805bc89836c1bf24bc2cfcb11c73901df1", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a3d071805bc89836c1bf24bc2cfcb11c73901df1", "committedDate": "2020-02-07T05:32:24Z", "message": "Implement test functionality for single test files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3d071805bc89836c1bf24bc2cfcb11c73901df1", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a3d071805bc89836c1bf24bc2cfcb11c73901df1", "committedDate": "2020-02-07T05:32:24Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "21aee960c95f272b55c4165a8736ad17a062b8d5", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/21aee960c95f272b55c4165a8736ad17a062b8d5", "committedDate": "2020-02-07T07:01:49Z", "message": "Implement test functionality for single test files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTg0MTAy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#pullrequestreview-355584102", "createdAt": "2020-02-09T05:06:21Z", "commit": {"oid": "21aee960c95f272b55c4165a8736ad17a062b8d5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwNTowNjoyMVrOFnTVOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwNTowNjoyMVrOFnTVOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1NTUxMg==", "bodyText": "If the code is not required shall we remove ?\nWhat will be the behavior if you run ballerina test moduleName if the module do not have tests.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376755512", "createdAt": "2020-02-09T05:06:21Z", "author": {"login": "hevayo"}, "path": "misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/BTestRunner.java", "diffHunk": "@@ -331,9 +336,9 @@ public void packageProcessed(BLangPackage bLangPackage, TestarinaClassLoader cla\n         // TODO the below line is required since this method is currently getting explicitly called from BTestRunner\n         TestSuite suite = TesterinaRegistry.getInstance().getTestSuites().get(bLangPackage.packageID.toString());\n \n-        if (!bLangPackage.hasTestablePackage()) {\n-            return;\n-        }\n+//        if (!bLangPackage.hasTestablePackage()) {\n+//            return;\n+//        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21aee960c95f272b55c4165a8736ad17a062b8d5"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "21aee960c95f272b55c4165a8736ad17a062b8d5", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/21aee960c95f272b55c4165a8736ad17a062b8d5", "committedDate": "2020-02-07T07:01:49Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "3ec489a531fc3dded26138e7aba00c83bbb6812f", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3ec489a531fc3dded26138e7aba00c83bbb6812f", "committedDate": "2020-02-10T03:19:31Z", "message": "Implement test functionality for single test files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NzAyMDc5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#pullrequestreview-355702079", "createdAt": "2020-02-10T05:50:30Z", "commit": {"oid": "3ec489a531fc3dded26138e7aba00c83bbb6812f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNTo1MDozMFrOFnayZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwNTo1MDozMFrOFnayZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg3NzY3MA==", "bodyText": "@Ibaqu Shall we get rid of the unnecessary new lines that are introduced?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#discussion_r376877670", "createdAt": "2020-02-10T05:50:30Z", "author": {"login": "Dilhasha"}, "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java", "diffHunk": "@@ -181,13 +183,57 @@ public void execute() {\n \n                 this.sourceRootPath = findRoot;\n             }\n+\n         } else if (this.argList.get(0).endsWith(BLangConstants.BLANG_SRC_FILE_SUFFIX)) {\n-            // when a single bal file is provided.\n-            CommandUtil.printError(this.errStream,\n-                    \"test command is only supported inside a Ballerina project\",\n-                    null,\n-                    false);\n-            CommandUtil.exitError(this.exitWhenFinish);\n+            // when a single bal file is provided\n+            // Check if path given is an absolute path. Update the root accordingly\n+            if (Paths.get(this.argList.get(0)).isAbsolute()) {\n+                sourcePath = Paths.get(this.argList.get(0));\n+            } else {\n+                sourcePath = sourceRootPath.resolve(this.argList.get(0));\n+            }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ec489a531fc3dded26138e7aba00c83bbb6812f"}, "originalPosition": 35}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ec489a531fc3dded26138e7aba00c83bbb6812f", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3ec489a531fc3dded26138e7aba00c83bbb6812f", "committedDate": "2020-02-10T03:19:31Z", "message": "Implement test functionality for single test files"}, "afterCommit": {"oid": "57a341581a477d433ce93119d502ef3bf8a47e15", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/57a341581a477d433ce93119d502ef3bf8a47e15", "committedDate": "2020-02-10T06:35:22Z", "message": "Implement test functionality for single test files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17a88a9178c60f110392cfe8145b7676674a66ce", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/17a88a9178c60f110392cfe8145b7676674a66ce", "committedDate": "2020-02-10T08:56:52Z", "message": "Implement test functionality for single test files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "committedDate": "2020-02-10T08:56:52Z", "message": "Change help instructions for test command and output for test examples"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "631ee243cee02d67645683817b5ff8073c7ee8fe", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/631ee243cee02d67645683817b5ff8073c7ee8fe", "committedDate": "2020-02-10T07:44:37Z", "message": "Change help instructions for test command and output for test examples"}, "afterCommit": {"oid": "a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "author": {"user": {"login": "Ibaqu", "name": "Aquib Zulfikar"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd", "committedDate": "2020-02-10T08:56:52Z", "message": "Change help instructions for test command and output for test examples"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDIxMjE0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20874#pullrequestreview-356421214", "createdAt": "2020-02-11T05:17:05Z", "commit": {"oid": "a13bea3fd22ed5c6abd2e23f322c3ddeacd31ecd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4305, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}