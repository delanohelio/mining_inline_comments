{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MDkyOTQ4", "number": 24958, "title": "Fix parser error recovery", "bodyText": "Purpose\nFix error recovery as some rules are not implemented in the errorhandler hence throw illegal state exception.\nFixes #24891\nFixes #24890\nApproach\nAdd rules for tuple-type-desc-or-list-cont-member and\nlist-bp-or-list-cons-member contexts, also added missing positions in\nBLangNodeTransformer for ListBindingPatternNode and TupleDestructureStatement.\nSamples\n\nn/a\n\nRemarks\n\nn/a\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-07-27T11:11:59Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24958", "merged": true, "mergeCommit": {"oid": "4775f551b5880ac4d65d7ebe9bd7a8b743b3e472"}, "closed": true, "closedAt": "2020-07-28T10:41:32Z", "author": {"login": "m36dot"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4_0oigH2gAyNDU3MDkyOTQ4OjZjYjhmYjBjYmY5NDQ3ZDhmNWQzZjgwYWY2NDFhMjIyMjMxZDhkOGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5UDPCAFqTQ1NjUxMTY3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6cb8fb0cbf9447d8f5d3f80af641a222231d8d8e", "author": {"user": {"login": "m36dot", "name": "Saif Abdul Cassim"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6cb8fb0cbf9447d8f5d3f80af641a222231d8d8e", "committedDate": "2020-07-27T11:07:21Z", "message": "Fix parser error recovery\n\nAdd rules for tuple-type-desc-or-list-cont-member and\nlist-bp-or-list-cons-member contexts, also added missing positions in\nBLangNodeTransformer for ListBindingPatternNode and TupleDestructureStatement."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc8f8e6faab2e9b255f828d18e0d2a007ef41e79", "author": {"user": {"login": "m36dot", "name": "Saif Abdul Cassim"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cc8f8e6faab2e9b255f828d18e0d2a007ef41e79", "committedDate": "2020-07-27T11:42:48Z", "message": "Add parser unit tests\n\nAdd tests to check the issues fixed, 24891 and 24890"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2Mjc4NzA3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24958#pullrequestreview-456278707", "createdAt": "2020-07-28T03:34:09Z", "commit": {"oid": "cc8f8e6faab2e9b255f828d18e0d2a007ef41e79"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMzozNDowOVrOG37VNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMzozNjo1NlrOG37X3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI5Njk1MQ==", "bodyText": "we haven't used peek() inside the resumeParsing method. Let's stick to a single pattern.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24958#discussion_r461296951", "createdAt": "2020-07-28T03:34:09Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -618,12 +618,15 @@ public STNode resumeParsing(ParserRuleContext context, Object... args) {\n                 return parseArgsBindingPatternEnd();\n             case TABLE_ROW_END:\n                 return parseTableRowEnd();\n+            case LIST_BP_OR_LIST_CONSTRUCTOR_MEMBER:\n+                return parseListBindingPatternOrListConstructorMember(peek().kind);\n+            case TUPLE_TYPE_DESC_OR_LIST_CONST_MEMBER:\n+                return parseTupleTypeDescOrListConstructorMember(peek().kind, (STNode) args[0]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc8f8e6faab2e9b255f828d18e0d2a007ef41e79"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI5NzYzMA==", "bodyText": "Not related to your PR.. the method-called for re-parse the same rule after inserting a token seems wrong.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24958#discussion_r461297630", "createdAt": "2020-07-28T03:36:56Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -15671,7 +15674,8 @@ private STNode parseTupleTypeDescOrListConstructorMember(SyntaxKind nextTokenKin\n                     return parseTypeDescriptor(ParserRuleContext.TYPE_DESC_IN_TUPLE);\n                 }\n \n-                Solution solution = recover(peek(), ParserRuleContext.TUPLE_TYPE_DESC_OR_LIST_CONST_MEMBER);\n+                Solution solution = recover(peek(), ParserRuleContext.TUPLE_TYPE_DESC_OR_LIST_CONST_MEMBER,\n+                        annots);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc8f8e6faab2e9b255f828d18e0d2a007ef41e79"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82cec27646687e8123709eb1e6772bd1ce8b759e", "author": {"user": {"login": "m36dot", "name": "Saif Abdul Cassim"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/82cec27646687e8123709eb1e6772bd1ce8b759e", "committedDate": "2020-07-28T05:41:54Z", "message": "Fix using peek inside resumeParsing\n\nRefactor the code to not use peek inside resumeparsing\nby introducing an intermediate method to do the peek."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8003e1ae37f9bbb26d29d4012e4eb239b7cb3501", "author": {"user": {"login": "m36dot", "name": "Saif Abdul Cassim"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8003e1ae37f9bbb26d29d4012e4eb239b7cb3501", "committedDate": "2020-07-28T09:37:01Z", "message": "Fix how parseTupleTypeDescOrListConstructorMember is recovered"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NTExNjc5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24958#pullrequestreview-456511679", "createdAt": "2020-07-28T10:41:24Z", "commit": {"oid": "8003e1ae37f9bbb26d29d4012e4eb239b7cb3501"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3722, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}