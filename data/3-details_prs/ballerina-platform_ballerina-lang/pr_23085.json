{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyOTU4NTI1", "number": 23085, "title": "Add error type support to the new parser.", "bodyText": "Purpose\nAdd error type support to the new parser with test cases and recovery logic.\nFixes #23053\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-05-04T13:40:03Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23085", "merged": true, "mergeCommit": {"oid": "5acfcd43add5113d40e4d13f880f23eeaac332cc"}, "closed": true, "closedAt": "2020-05-06T02:54:00Z", "author": {"login": "rdulmina"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcd50muAH2gAyNDEyOTU4NTI1OmE1OTZlNzk3MGNkODRiNTAzZWEzMDNhMzg2OTgwNzM1ZTllYmQzNjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcefnUkgFqTQwNjI3NjQ5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a596e7970cd84b503ea303a386980735e9ebd363", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a596e7970cd84b503ea303a386980735e9ebd363", "committedDate": "2020-05-04T06:51:56Z", "message": "Error type desc support."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c2c3823da439961777e83cfc5542773a7db6269", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1c2c3823da439961777e83cfc5542773a7db6269", "committedDate": "2020-05-04T07:38:48Z", "message": "Recovery logic for error type desc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "605fde639b4d2d25a6e28076efa2febb41a20404", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/605fde639b4d2d25a6e28076efa2febb41a20404", "committedDate": "2020-05-04T13:00:02Z", "message": "Changed the structure of error type desc.\n\nChanged the structure of error type desc and commented conflicting test case of ParameterizedTypeTest with error type descriptor recovery."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41150c543110c8ed8f1f6e993037ce3492d02f27", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/41150c543110c8ed8f1f6e993037ce3492d02f27", "committedDate": "2020-05-04T13:34:04Z", "message": "Test cases for error type test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68c0c2fa16aeae3d1729dbd11a44950cc56567ec", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/68c0c2fa16aeae3d1729dbd11a44950cc56567ec", "committedDate": "2020-05-04T13:46:09Z", "message": "Removed unwanted node."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7726a85e4ee26c13b3dcde8ed3f7ae73f5393d74", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7726a85e4ee26c13b3dcde8ed3f7ae73f5393d74", "committedDate": "2020-05-05T07:20:50Z", "message": "Changed the tag value of ERROR_TYPE_DESC syntaxkind."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NTQ5MjA3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23085#pullrequestreview-405549207", "createdAt": "2020-05-05T07:28:27Z", "commit": {"oid": "7726a85e4ee26c13b3dcde8ed3f7ae73f5393d74"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzoyODoyOFrOGQdeFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzo0Mzo1NlrOGQd7fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxMzIzOQ==", "bodyText": "Since it is either possible to have all three tokens, or non-of the three tokens (all-or-none situation), shall we group the three tokens  <T> together and have it as a separate node?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23085#discussion_r419913239", "createdAt": "2020-05-05T07:28:28Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -7228,4 +7235,55 @@ private boolean isEndOfFieldNamesList(SyntaxKind tokenKind) {\n                 return true;\n         }\n     }\n+\n+    /**\n+     * Parse error type descriptor.\n+     * <p>\n+     * error-type-descriptor := error [error-type-param]\n+     * error-type-param := < (detail-type-descriptor | inferred-type-descriptor) >\n+     * detail-type-descriptor := type-descriptor\n+     * inferred-type-descriptor := *\n+     * </p>\n+     *\n+     * @return Parsed node\n+     */\n+    private STNode parseErrorTypeDescriptor() {\n+        startContext(ParserRuleContext.ERROR_TYPE_DESCRIPTOR);\n+\n+        STNode errorKeywordToken = parseErrorKeyWord();\n+        STNode errorTypeParamsNode, ltToken, gtToken;\n+        STToken nextToken = peek();\n+        STToken nextNextToken = peek(2);\n+        if (nextToken.kind == SyntaxKind.LT_TOKEN || nextNextToken.kind == SyntaxKind.GT_TOKEN) {\n+            ltToken = parseLTToken();\n+            nextToken = peek();\n+            if (nextToken.kind == SyntaxKind.ASTERISK_TOKEN) {\n+                errorTypeParamsNode = consume();\n+            } else {\n+                errorTypeParamsNode = parseTypeDescriptor();\n+            }\n+            gtToken = parseGTToken();\n+        } else {\n+            ltToken = STNodeFactory.createEmptyNode();\n+            errorTypeParamsNode = STNodeFactory.createEmptyNode();\n+            gtToken = STNodeFactory.createEmptyNode();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7726a85e4ee26c13b3dcde8ed3f7ae73f5393d74"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxODY2MA==", "bodyText": "IIUC, though error-type-desc context is started here, it is ended only in one-of the paths. i.e: context will not be ended in the error case (without type-param).", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23085#discussion_r419918660", "createdAt": "2020-05-05T07:39:46Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParserErrorHandler.java", "diffHunk": "@@ -1644,6 +1664,7 @@ private ParserRuleContext getNextRule(ParserRuleContext currentCtx, int nextLook\n             case TYPE_CAST_EXPRESSION:\n             case TABLE_CONSTRUCTOR:\n             case KEY_SPECIFIER:\n+            case ERROR_TYPE_DESCRIPTOR:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7726a85e4ee26c13b3dcde8ed3f7ae73f5393d74"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkyMDc2Ng==", "bodyText": "This test is not needed?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23085#discussion_r419920766", "createdAt": "2020-05-05T07:43:56Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/test/java/io/ballerinalang/compiler/parser/test/syntax/types/ParameterizedTypeTest.java", "diffHunk": "@@ -91,8 +91,8 @@ public void testInValidModuleLevelMapTypeWithInvalidTokenInside() {\n         test(\"map<%> a;\", \"parameterized-type/parameterized_type_assert_10.json\");\n     }\n \n-    @Test\n-    public void testInValidModuleLevelParameterizedTypeMissingType() {\n-        test(\"<int> a;\", \"parameterized-type/parameterized_type_assert_12.json\");\n-    }\n+//    @Test\n+//    public void testInValidModuleLevelParameterizedTypeMissingType() {\n+//        test(\"<int> a;\", \"parameterized-type/parameterized_type_assert_12.json\");\n+//    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7726a85e4ee26c13b3dcde8ed3f7ae73f5393d74"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b77a5438bd62dec9ded9ce1c575f75d530a6d821", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b77a5438bd62dec9ded9ce1c575f75d530a6d821", "committedDate": "2020-05-05T13:18:24Z", "message": "Added a separate node for error type params.\n\nAdded a separate node for error type params. Uncommented a test case of parameterized type descriptor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed392e1d4120fa7bc5c6c6789b3129c5b8531621", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ed392e1d4120fa7bc5c6c6789b3129c5b8531621", "committedDate": "2020-05-05T13:20:44Z", "message": "Undo unwanted files changed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2Mjc2NDk0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23085#pullrequestreview-406276494", "createdAt": "2020-05-06T02:53:49Z", "commit": {"oid": "ed392e1d4120fa7bc5c6c6789b3129c5b8531621"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3371, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}