{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMzIxMTQ4", "number": 22949, "title": "Support custom SMTP properties for Email Connector", "bodyText": "Purpose\nAdd custom SMTP Properties to SMTP Client via its config.\nFixes #22948\nApproach\nAdd each of the property to properties map.\nSamples\nA sample is give below where a single property, mail.smtp.port is added to the config, overriding the default properties.\nemail:SmtpConfig smtpConfig = {\n    port: 30250, // This is an incorrect value. Later the correct value, 3025 will be set via a property.\n    enableSsl: false,\n    properties: {\"mail.smtp.port\":\"3025\"}\n};\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-04-28T19:43:27Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949", "merged": true, "mergeCommit": {"oid": "101feeec96f3faaa0523bce828b9342926f6df6e"}, "closed": true, "closedAt": "2020-04-29T12:10:02Z", "author": {"login": "Maninda"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccI9BJgH2gAyNDEwMzIxMTQ4OjBjM2ZhNTc2MDBkMmVkOGFjMjMxYmVkN2QwZTY5Zjc2MGRkNmU4YTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccTOcWAFqTQwMjQxNjMwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0c3fa57600d2ed8ac231bed7d0e69f760dd6e8a7", "author": {"user": {"login": "Maninda", "name": "Maninda Edirisooriya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0c3fa57600d2ed8ac231bed7d0e69f760dd6e8a7", "committedDate": "2020-04-28T19:21:51Z", "message": "Fix https://github.com/ballerina-platform/ballerina-lang/issues/22948"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c79e1b593d66b7dae8d2933f3fa2ca828399127", "author": {"user": {"login": "Maninda", "name": "Maninda Edirisooriya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5c79e1b593d66b7dae8d2933f3fa2ca828399127", "committedDate": "2020-04-28T19:36:24Z", "message": "Resolve branch related conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdc1c8fd43a06f1074fb7073a95e57745fe00cf6", "author": {"user": {"login": "Maninda", "name": "Maninda Edirisooriya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fdc1c8fd43a06f1074fb7073a95e57745fe00cf6", "committedDate": "2020-04-28T19:45:30Z", "message": "Add a new line at the end of the file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd32527abda6ce6f714ac9f9c4671c382370c116", "author": {"user": {"login": "Maninda", "name": "Maninda Edirisooriya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fd32527abda6ce6f714ac9f9c4671c382370c116", "committedDate": "2020-04-28T19:53:43Z", "message": "Add API docs to a method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a23cf6a43539d7278fd3087909f5135e100bc9e6", "author": {"user": {"login": "Maninda", "name": "Maninda Edirisooriya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a23cf6a43539d7278fd3087909f5135e100bc9e6", "committedDate": "2020-04-28T19:55:25Z", "message": "Remove an unwanted line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMzQxMzUw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#pullrequestreview-402341350", "createdAt": "2020-04-29T03:14:26Z", "commit": {"oid": "a23cf6a43539d7278fd3087909f5135e100bc9e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMzoxNDoyNlrOGNuXQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMzoxNDoyNlrOGNuXQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NDI4OQ==", "bodyText": "Is it possible to make it as properties map like\nmap<string>? properties = ();\nAs we are converting the value to a string, I think we can restrict to string only\nWDYT?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#discussion_r417044289", "createdAt": "2020-04-29T03:14:26Z", "author": {"login": "daneshk"}, "path": "stdlib/email/src/main/ballerina/src/email/smtp_client_endpoint.bal", "diffHunk": "@@ -59,8 +59,10 @@ function send(SmtpClient clientEndpoint, Email email) returns Error? = @java:Met\n #\n # + port - Port number of the SMTP server\n # + enableSsl - If set to true, use SSL to connect and use the SSL port by default.\n-#               The default value is true for the \"smtps\" protocol and false for the \"smtp\" protocol.\n+#               The default value is true for the \"smtps\" protocol and false for the \"smtp\" protocol\n+# + properties - SMTP properties to override the existing configuration\n public type SmtpConfig record {|\n     int port = 465;\n     boolean enableSsl = true;\n+    Property[]? properties = ();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23cf6a43539d7278fd3087909f5135e100bc9e6"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMzQyMjk2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#pullrequestreview-402342296", "createdAt": "2020-04-29T03:18:53Z", "commit": {"oid": "a23cf6a43539d7278fd3087909f5135e100bc9e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMzoxODo1M1rOGNubSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMzoxODo1M1rOGNubSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NTMyMg==", "bodyText": "I think we need to give priority to the predefined fields? shall we first add custom properties and then add field values.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#discussion_r417045322", "createdAt": "2020-04-29T03:18:53Z", "author": {"login": "daneshk"}, "path": "stdlib/email/src/main/java/org/ballerinalang/stdlib/email/util/SmtpUtil.java", "diffHunk": "@@ -74,6 +75,15 @@ public static Properties getProperties(MapValue smtpConfig, String host) {\n         properties.put(EmailConstants.PROPS_SMTP_AUTH, \"true\");\n         properties.put(EmailConstants.PROPS_SMTP_STARTTLS, \"true\");\n         properties.put(EmailConstants.PROPS_ENABLE_SSL, smtpConfig.getBooleanValue(EmailConstants.PROPS_SSL));\n+        CommonUtil.addCustomProperties(smtpConfig.getArrayValue(EmailConstants.PROPS_PROPERTIES), properties);\n+        if (log.isDebugEnabled()) {\n+            Set<String> propertySet = properties.stringPropertyNames();\n+            log.debug(\"SMTP Properties set are as follows.\");\n+            for (Object propertyObj : propertySet) {\n+                log.debug(\"Property Name: \" + propertyObj + \", Value: \" + properties.get(propertyObj).toString()\n+                        + \" ValueType: \" + properties.get(propertyObj).getClass().getName());\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23cf6a43539d7278fd3087909f5135e100bc9e6"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bba9caa4ebd234be91c40a3f7602b46a95ed75f4", "author": {"user": {"login": "Maninda", "name": "Maninda Edirisooriya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bba9caa4ebd234be91c40a3f7602b46a95ed75f4", "committedDate": "2020-04-29T06:31:13Z", "message": "Implement the suggestions given in the PR review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNDE2MzA5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#pullrequestreview-402416309", "createdAt": "2020-04-29T07:19:56Z", "commit": {"oid": "bba9caa4ebd234be91c40a3f7602b46a95ed75f4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3518, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}