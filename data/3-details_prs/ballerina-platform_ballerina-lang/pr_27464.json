{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2ODQ1OTM3", "number": 27464, "title": "Duplicate object type for object constructor at object init site", "bodyText": "$title\nAlso rename ObjectType.getAttacheddFunctions() to ObjectType.getMemberFunctions()\nAlso allow decimal type to be in resource path params.\nFixes #27453\nWe need to align this PR so that we copy parameter names in ResourceFunctions after merging #27443\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-12-11T12:06:36Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464", "merged": true, "mergeCommit": {"oid": "bdac417e21caf9bd3e7313f8e41d131b6139c965"}, "closed": true, "closedAt": "2021-01-06T18:37:12Z", "author": {"login": "rdhananjaya"}, "timelineItems": {"totalCount": 34, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlFzVpAH2gAyNTM2ODQ1OTM3OjU4MjdjM2VjNTBmMjNhMjcwNmQ2NDY1N2RmZjE1NjNmYTI4NTJiZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdthZiHgFqTU2MjgwNTQ0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5827c3ec50f23a2706d64657dff1563fa2852bd0", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5827c3ec50f23a2706d64657dff1563fa2852bd0", "committedDate": "2020-12-11T10:58:02Z", "message": "Rename getAttachefuncs to getMemberFunctionTypes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "600ff77144242f1e5c6815d540d0425b64623d46", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/600ff77144242f1e5c6815d540d0425b64623d46", "committedDate": "2020-12-11T11:06:39Z", "message": "Duplicate object ctor type at object init\n\nThis is done so that we can keep on attaching new annot\nvalues to obj type, as same object ctor can be used to\ncreate different obj instances."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1443bc59884d84e119036175256938eecaeb9483", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1443bc59884d84e119036175256938eecaeb9483", "committedDate": "2020-12-11T12:02:35Z", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into service-typing-dhananjaya\n\n\u0001 Conflicts:\n\u0001\ttests/observability-test-utils/src/main/java/org/ballerina/testobserve/listenerendpoint/Service.java\n\u0001\ttests/observability-test-utils/src/main/java/org/ballerina/testobserve/listenerendpoint/WebServer.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d379aae5a89fdc34f9c6e6fdbec3d6e5ca4ce27a", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d379aae5a89fdc34f9c6e6fdbec3d6e5ca4ce27a", "committedDate": "2020-12-11T14:19:13Z", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into service-typing-dhananjaya"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e40d575a89defc4535d75ea4bdd5803272c3e8fc", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e40d575a89defc4535d75ea4bdd5803272c3e8fc", "committedDate": "2020-12-15T12:05:30Z", "message": "Duplicate function types when attaching annot\n\nto object ctors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "650d3f13414300eb4b0b2c7453fa8748510f4cbd", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/650d3f13414300eb4b0b2c7453fa8748510f4cbd", "committedDate": "2020-12-15T12:10:18Z", "message": "Allow decimal to be in path params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4ab53e410a83d2bb8db059c54f2080165131d125", "committedDate": "2020-12-15T13:48:07Z", "message": "Fix checkStyle issue"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ebfa64a6490b779b0345c840d0e51a06782e7b6f", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ebfa64a6490b779b0345c840d0e51a06782e7b6f", "committedDate": "2020-12-15T13:35:24Z", "message": "Fix checkStyle issue"}, "afterCommit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4ab53e410a83d2bb8db059c54f2080165131d125", "committedDate": "2020-12-15T13:48:07Z", "message": "Fix checkStyle issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNjgyMDQ2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#pullrequestreview-552682046", "createdAt": "2020-12-15T17:11:31Z", "commit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNzoxMTozMVrOIGWYVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNzoxNzowN1rOIGWpBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyOTA0Nw==", "bodyText": "Do we need a separate variable here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r543529047", "createdAt": "2020-12-15T17:11:31Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BMemberFunctionType.java", "diffHunk": "@@ -74,4 +74,9 @@ public ObjectType getParentObjectType() {\n     public FunctionType getType() {\n         return type;\n     }\n+\n+    public <T extends MemberFunctionType> MemberFunctionType duplicate() {\n+        MemberFunctionType t = new BMemberFunctionType(funcName, parentObjectType, type, flags);\n+        return t;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyOTU4NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public BObjectType duplicateTypeAndprocessObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n          \n          \n            \n                public BObjectType duplicateTypeAndProcessObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r543529585", "createdAt": "2020-12-15T17:12:15Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BObjectType.java", "diffHunk": "@@ -136,8 +137,30 @@ public void setTypeIdSet(BTypeIdSet typeIdSet) {\n         this.typeIdSet = typeIdSet;\n     }\n \n-    public void processObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n-        AnnotationUtils.processObjectCtorAnnotations(globalAnnotationMap, this, strand);\n+    public BObjectType duplicateTypeAndprocessObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUzMDU4Mw==", "bodyText": "Does this method belong here? Wouldn't it be better to have this in AnnotationUtils?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r543530583", "createdAt": "2020-12-15T17:13:30Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BObjectType.java", "diffHunk": "@@ -136,8 +137,30 @@ public void setTypeIdSet(BTypeIdSet typeIdSet) {\n         this.typeIdSet = typeIdSet;\n     }\n \n-    public void processObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n-        AnnotationUtils.processObjectCtorAnnotations(globalAnnotationMap, this, strand);\n+    public BObjectType duplicateTypeAndprocessObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyOTU4NQ=="}, "originalCommit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUzMzMxNw==", "bodyText": "Doesn't cloneThis and duplicate do pretty much the same thing? Shouldn't we use one of the two as the name?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r543533317", "createdAt": "2020-12-15T17:17:07Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BObjectType.java", "diffHunk": "@@ -136,8 +137,30 @@ public void setTypeIdSet(BTypeIdSet typeIdSet) {\n         this.typeIdSet = typeIdSet;\n     }\n \n-    public void processObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n-        AnnotationUtils.processObjectCtorAnnotations(globalAnnotationMap, this, strand);\n+    public BObjectType duplicateTypeAndprocessObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n+        BObjectType clone = cloneThis();\n+        AnnotationUtils.processObjectCtorAnnotations(globalAnnotationMap, clone, strand);\n+        return clone;\n+    }\n+\n+    BObjectType cloneThis() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "846db7c22ed5827379c0b7bc0e3b6abbfe115a2c", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/846db7c22ed5827379c0b7bc0e3b6abbfe115a2c", "committedDate": "2020-12-16T06:47:47Z", "message": "Add test case for resource returning service obj"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4bce3759092c39e033f889755055834f5c850e1", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e4bce3759092c39e033f889755055834f5c850e1", "committedDate": "2020-12-16T10:50:00Z", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into service-typing-dhananjaya"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a771575cc242daf7744f34b2ceedc4ee9db4d353", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a771575cc242daf7744f34b2ceedc4ee9db4d353", "committedDate": "2020-12-16T11:10:56Z", "message": "Addback mistakenly overwritten service annot test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6f7b555636e1345eaae7bc074da31970ce875fb", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d6f7b555636e1345eaae7bc074da31970ce875fb", "committedDate": "2020-12-16T11:34:49Z", "message": "Add service ctor annot test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b23b306204864038e84dcbbc5f9b5612df756633", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b23b306204864038e84dcbbc5f9b5612df756633", "committedDate": "2020-12-16T12:18:54Z", "message": "Add review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNjk0MjAx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#pullrequestreview-553694201", "createdAt": "2020-12-16T13:40:46Z", "commit": {"oid": "b23b306204864038e84dcbbc5f9b5612df756633"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxMzo0MDo0N1rOIHFzBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxMzo1ODo0MVrOIHGlfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDMwNTkyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public BObjectType duplicateTypeAndprocessAnnots(MapValue globalAnnotationMap, Strand strand) {\n          \n          \n            \n                public BObjectType duplicateTypeAndProcessAnnots(MapValue globalAnnotationMap, Strand strand) {", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r544305927", "createdAt": "2020-12-16T13:40:47Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BObjectType.java", "diffHunk": "@@ -136,8 +137,30 @@ public void setTypeIdSet(BTypeIdSet typeIdSet) {\n         this.typeIdSet = typeIdSet;\n     }\n \n-    public void processObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n-        AnnotationUtils.processObjectCtorAnnotations(globalAnnotationMap, this, strand);\n+    public BObjectType duplicateTypeAndprocessAnnots(MapValue globalAnnotationMap, Strand strand) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b23b306204864038e84dcbbc5f9b5612df756633"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDMxODg0Ng==", "bodyText": "IMO, even though annotations are part of the type, this duplication and reprocessing the annotations is an approach we're adopting to address a particular scenario.\nI believe the BObjectType does not have to know about processing annotations, instead we can address this via AnnotationUtils which handles all of the annotation processing and setting it to the types - i.e., AnnotationUtils calls duplicate() on the BObjectType and sets the annotations to the new type. The only exception to this seems to be io.ballerina.runtime.internal.types.BObjectType#processObjectCtorAnnots which I think could also happen via AnnotationUtils.\nI think the eventual approach to this should be to codegen the creation of a new BObjectType for each new (service) object constructor, and let the annotation processing happen as for a class/normal object via AnnotationUtils.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r544318846", "createdAt": "2020-12-16T13:58:41Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BObjectType.java", "diffHunk": "@@ -136,8 +137,30 @@ public void setTypeIdSet(BTypeIdSet typeIdSet) {\n         this.typeIdSet = typeIdSet;\n     }\n \n-    public void processObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {\n-        AnnotationUtils.processObjectCtorAnnotations(globalAnnotationMap, this, strand);\n+    public BObjectType duplicateTypeAndprocessObjectCtorAnnots(MapValue globalAnnotationMap, Strand strand) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyOTU4NQ=="}, "originalCommit": {"oid": "4ab53e410a83d2bb8db059c54f2080165131d125"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5df83341ec774aed58e442edf870e799af10790d", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5df83341ec774aed58e442edf870e799af10790d", "committedDate": "2020-12-17T04:20:04Z", "message": "Refactor obj type duplication logic"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "349396e19ffc0370e5d1c3a4009cded2cbe43ebc", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/349396e19ffc0370e5d1c3a4009cded2cbe43ebc", "committedDate": "2020-12-17T03:55:48Z", "message": "Refactor obj type duplication logic"}, "afterCommit": {"oid": "5df83341ec774aed58e442edf870e799af10790d", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5df83341ec774aed58e442edf870e799af10790d", "committedDate": "2020-12-17T04:20:04Z", "message": "Refactor obj type duplication logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480", "committedDate": "2020-12-17T05:44:01Z", "message": "Re-enable LocalAnnotationTest\n\nby re-using test helper util ServiceValue"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8aec62c8446477c8f6e98656442ce746b8e26b2c", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8aec62c8446477c8f6e98656442ce746b8e26b2c", "committedDate": "2020-12-17T05:40:58Z", "message": "Re-enable LocalAnnotationTest\n\nby re-using test helper util ServiceValue"}, "afterCommit": {"oid": "d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480", "committedDate": "2020-12-17T05:44:01Z", "message": "Re-enable LocalAnnotationTest\n\nby re-using test helper util ServiceValue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MDQwMTA5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#pullrequestreview-556040109", "createdAt": "2020-12-20T18:21:12Z", "commit": {"oid": "d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQxODoyMToxM1rOIJGTiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQxODo0MDoyNFrOIJGbTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQxMTQwMA==", "bodyText": "Shall we rename the parameter too?\nAlso, should we rename the methods to xxxMemberMethodTypes instead of xxxMemberFunctionTypes?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r546411400", "createdAt": "2020-12-20T18:21:13Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-core/src/main/java/org/ballerinalang/core/model/types/BStructureType.java", "diffHunk": "@@ -64,11 +64,11 @@ public void setFieldTypeCount(int[] fieldCount) {\n         this.fieldTypeCount = fieldCount;\n     }\n \n-    public BAttachedFunction[] getAttachedFunctions() {\n+    public BAttachedFunction[] getMemberFunctionTypes() {\n         return attachedFunctions;\n     }\n \n-    public void setAttachedFunctions(BAttachedFunction[] attachedFunctions) {\n+    public void setMemberFunctionTypes(BAttachedFunction[] attachedFunctions) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQxMjE2MQ==", "bodyText": "Is the name correct here? The annotation may not be a map, right?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r546412161", "createdAt": "2020-12-20T18:28:27Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/nativeimpl/jvm/servicetests/ServiceValue.java", "diffHunk": "@@ -165,4 +176,15 @@ public static BArray getServicePath() {\n     public static BMap getAnnotationsAtServiceAttach() {\n         return ServiceValue.annotationMap;\n     }\n+\n+    public static BValue getAnnotMap(BObject service, BString method, ArrayValue path, BString annotName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQxMzM5MA==", "bodyText": "This method seems to be used only in tests? I'm not sure if we should be introducing a method just for tests. Can't we extract this information using getResourceAnnotation?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r546413390", "createdAt": "2020-12-20T18:40:24Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/nativeimpl/jvm/servicetests/ServiceValue.java", "diffHunk": "@@ -165,4 +176,15 @@ public static BArray getServicePath() {\n     public static BMap getAnnotationsAtServiceAttach() {\n         return ServiceValue.annotationMap;\n     }\n+\n+    public static BValue getAnnotMap(BObject service, BString method, ArrayValue path, BString annotName) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQxMjE2MQ=="}, "originalCommit": {"oid": "d22b7abcc63c4c1ae8cb6b78f585282ed2ad3480"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac4de240bfacdb1c6afb531efabe073433151004", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ac4de240bfacdb1c6afb531efabe073433151004", "committedDate": "2020-12-22T04:34:31Z", "message": "Align method names with the names from the spec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c608589b9e09949c7b0a87b0c1265320d4242fe2", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c608589b9e09949c7b0a87b0c1265320d4242fe2", "committedDate": "2021-01-04T11:54:17Z", "message": "Merge remote-tracking branch 'upstream/master' into service-typing-dhananjaya"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5dc61b7746c5968cf7cbec4cf983314a95d93b9", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e5dc61b7746c5968cf7cbec4cf983314a95d93b9", "committedDate": "2021-01-04T12:04:16Z", "message": "Rename getter methods"}, "afterCommit": {"oid": "47e4208ef1412477434089a0200ef6d99796f038", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/47e4208ef1412477434089a0200ef6d99796f038", "committedDate": "2021-01-04T12:37:25Z", "message": "Rename getter methods"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47e4208ef1412477434089a0200ef6d99796f038", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/47e4208ef1412477434089a0200ef6d99796f038", "committedDate": "2021-01-04T12:37:25Z", "message": "Rename getter methods"}, "afterCommit": {"oid": "18fb8d8b1459fb87e90157a4eb5db770eca9cbce", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/18fb8d8b1459fb87e90157a4eb5db770eca9cbce", "committedDate": "2021-01-04T12:38:45Z", "message": "Rename getter methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1", "committedDate": "2021-01-04T13:01:29Z", "message": "Rename getter methods"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18fb8d8b1459fb87e90157a4eb5db770eca9cbce", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/18fb8d8b1459fb87e90157a4eb5db770eca9cbce", "committedDate": "2021-01-04T12:38:45Z", "message": "Rename getter methods"}, "afterCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1", "committedDate": "2021-01-04T13:01:29Z", "message": "Rename getter methods"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTA1MDk2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#pullrequestreview-561505096", "createdAt": "2021-01-05T04:20:57Z", "commit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "state": "COMMENTED", "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDoyMDo1N1rOIOJnwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNTowOTozNFrOIOKTHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcwODYwOQ==", "bodyText": "Should we rename these as getMethods and setMethods similar to the runtime ObjectType or rename them to getMethodTypes and setMethodTypes, for consistency?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551708609", "createdAt": "2021-01-05T04:20:57Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-core/src/main/java/org/ballerinalang/core/model/types/BStructureType.java", "diffHunk": "@@ -64,12 +64,12 @@ public void setFieldTypeCount(int[] fieldCount) {\n         this.fieldTypeCount = fieldCount;\n     }\n \n-    public BAttachedFunction[] getAttachedFunctions() {\n+    public BAttachedFunction[] getMethodTypes() {\n         return attachedFunctions;\n     }\n \n-    public void setAttachedFunctions(BAttachedFunction[] attachedFunctions) {\n-        this.attachedFunctions = attachedFunctions;\n+    public void setMethodTypes(BAttachedFunction[] methodTypes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxMDE5OA==", "bodyText": "Should the return type here be RemoteMethodType[]?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551710198", "createdAt": "2021-01-05T04:28:13Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/api/types/ServiceType.java", "diffHunk": "@@ -23,7 +23,7 @@\n  */\n public interface ServiceType extends ObjectType {\n \n-    MemberFunctionType[] getRemoteFunctions();\n+    MethodType[] getRemoteMethods();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNTQxNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              only int, string, float, boolean, decimal types are supported as path params, found ''{0}''\n          \n          \n            \n              only ''int'', ''string'', ''float'', ''boolean'', and ''decimal'' types are supported as path parameters, found ''{0}''", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551715415", "createdAt": "2021-01-05T04:51:13Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -752,10 +752,10 @@ error.remote.function.in.non.network.object=\\\n   remote qualifier only allowed in client and service objects\n \n error.unsupported.path.param.type=\\\n-  only int, string, float, boolean types are supported as path params, found ''{0}''\n+  only int, string, float, boolean, decimal types are supported as path params, found ''{0}''", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNTUyMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              only int, string, float, boolean, decimal types are supported as rest path param, found ''{0}''\n          \n          \n            \n              only ''int'', ''string'', ''float'', ''boolean'', and ''decimal'' types are supported as rest path parameter, found ''{0}''", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551715522", "createdAt": "2021-01-05T04:51:40Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -752,10 +752,10 @@ error.remote.function.in.non.network.object=\\\n   remote qualifier only allowed in client and service objects\n \n error.unsupported.path.param.type=\\\n-  only int, string, float, boolean types are supported as path params, found ''{0}''\n+  only int, string, float, boolean, decimal types are supported as path params, found ''{0}''\n \n error.unsupported.rest.path.param.type=\\\n-  only int, string, float, boolean types are supported as rest path param, found ''{0}''\n+  only int, string, float, boolean, decimal types are supported as rest path param, found ''{0}''", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzQ1MA==", "bodyText": "Shouldn't this be calling the getter? These probably don't run right, or would have failed?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717450", "createdAt": "2021-01-05T04:59:46Z", "author": {"login": "MaryamZi"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/HttpService.java", "diffHunk": "@@ -258,7 +258,7 @@ public void setUpgradeToWebSocketResources(\n     private static void processResources(HttpService httpService) {\n         List<HttpResource> httpResources = new ArrayList<>();\n         List<HttpResource> upgradeToWebSocketResources = new ArrayList<>();\n-        for (AttachedFunctionType resource : httpService.getBalService().getType().getAttachedFunctions()) {\n+        for (AttachedFunctionType resource : httpService.getBalService().getType().setMethodTypes()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzUyNg==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717526", "createdAt": "2021-01-05T05:00:10Z", "author": {"login": "MaryamZi"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/serviceendpoint/Detach.java", "diffHunk": "@@ -38,7 +38,7 @@ public static Object detach(BObject serviceEndpoint, BObject serviceObj) {\n         HTTPServicesRegistry httpServicesRegistry = getHttpServicesRegistry(serviceEndpoint);\n         WebSocketServicesRegistry webSocketServicesRegistry = getWebSocketServicesRegistry(serviceEndpoint);\n         Type param;\n-        AttachedFunctionType[] resourceList = serviceObj.getType().getAttachedFunctions();\n+        AttachedFunctionType[] resourceList = serviceObj.getType().setMethodTypes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzU0MA==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717540", "createdAt": "2021-01-05T05:00:15Z", "author": {"login": "MaryamZi"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/serviceendpoint/Register.java", "diffHunk": "@@ -45,7 +45,7 @@ public static Object register(BalEnv env, BObject serviceEndpoint, BObject servi\n         httpServicesRegistry.setRuntime(env.getRuntime());\n \n         Type param;\n-        AttachedFunctionType[] resourceList = service.getType().getAttachedFunctions();\n+        AttachedFunctionType[] resourceList = service.getType().setMethodTypes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzU2OA==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717568", "createdAt": "2021-01-05T05:00:19Z", "author": {"login": "MaryamZi"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/websocket/WebSocketService.java", "diffHunk": "@@ -46,7 +46,7 @@ public WebSocketService(BObject service, BRuntime runtime) {\n     }\n \n     private void populateResourcesMap(BObject service) {\n-        for (AttachedFunctionType resource : service.getType().getAttachedFunctions()) {\n+        for (AttachedFunctionType resource : service.getType().setMethodTypes()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzU4MQ==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717581", "createdAt": "2021-01-05T05:00:25Z", "author": {"login": "MaryamZi"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/websocket/WebSocketUtil.java", "diffHunk": "@@ -550,7 +550,7 @@ public static WebSocketService validateAndCreateWebSocketService(BRuntime runtim\n                                                                      BMap<BString, Object> clientEndpointConfig) {\n         Object clientService = clientEndpointConfig.get(WebSocketConstants.CLIENT_SERVICE_CONFIG);\n         if (clientService != null) {\n-            Type param = ((BObject) clientService).getType().getAttachedFunctions()[0].getParameterType()[0];\n+            Type param = ((BObject) clientService).getType().setMethodTypes()[0].getParameterType()[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzU5Ng==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717596", "createdAt": "2021-01-05T05:00:32Z", "author": {"login": "MaryamZi"}, "path": "stdlib/reflect/src/main/java/org/ballerinalang/stdlib/reflect/AnnotationUtils.java", "diffHunk": "@@ -39,9 +39,9 @@\n      * @return annotation value object.\n      */\n     public static Object externGetResourceAnnotations(BObject service, BString resourceName, BString annot) {\n-        MemberFunctionType[] functions = service.getType().getAttachedFunctions();\n+        MethodTypes[] functions = service.getType().setMethodTypes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzYzMQ==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717631", "createdAt": "2021-01-05T05:00:41Z", "author": {"login": "MaryamZi"}, "path": "stdlib/task/src/main/java/org/ballerinalang/stdlib/task/objects/ServiceInformation.java", "diffHunk": "@@ -48,8 +48,8 @@ public String getServiceName() {\n         return this.service.getType().getName().split(\"\\\\$\\\\$\")[0];\n     }\n \n-    public MemberFunctionType getOnTriggerFunction() {\n-        for (MemberFunctionType resource : service.getType().getAttachedFunctions()) {\n+    public MethodTypes getOnTriggerFunction() {\n+        for (MethodTypes resource : service.getType().setMethodTypes()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzY2OQ==", "bodyText": "Getter?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717669", "createdAt": "2021-01-05T05:00:53Z", "author": {"login": "MaryamZi"}, "path": "stdlib/task/src/main/java/org/ballerinalang/stdlib/task/utils/Utils.java", "diffHunk": "@@ -114,13 +114,13 @@ private static String getStringFieldValue(BMap<BString, Object> record, BString\n      *       Issue: https://github.com/ballerina-platform/ballerina-lang/issues/14148\n      */\n     public static void validateService(ServiceInformation serviceInformation) throws SchedulingException {\n-        MemberFunctionType[] resources = serviceInformation.getService().getType().getAttachedFunctions();\n+        MethodTypes[] resources = serviceInformation.getService().getType().setMethodTypes();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzc4OQ==", "bodyText": "Shall we rename the variable?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717789", "createdAt": "2021-01-05T05:01:23Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/nativeimpl/jvm/servicetests/ServiceValue.java", "diffHunk": "@@ -148,15 +148,26 @@ public static BObject getService() {\n         return ServiceValue.service;\n     }\n \n-    public static BValue getResourceAnnotation(BString resourceName, BString annotName) {\n-        for (var r : ((ServiceType) ServiceValue.service.getType()).getResourceFunctions()) {\n-            if (r.getName().equals(resourceName.getValue())) {\n+    public static BValue getResourceAnnotation(BString methodName, ArrayValue path, BString annotName) {\n+        String funcName = generateMethodName(methodName, path);\n+\n+        for (var r : ((ServiceType) ServiceValue.service.getType()).getResourceMethods()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNzg0Mg==", "bodyText": "Shall we rename the variable?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551717842", "createdAt": "2021-01-05T05:01:39Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/nativeimpl/jvm/servicetests/ServiceValue.java", "diffHunk": "@@ -165,4 +176,16 @@ public static BArray getServicePath() {\n     public static BMap getAnnotationsAtServiceAttach() {\n         return ServiceValue.annotationMap;\n     }\n+\n+    public static BValue getResourceMethodAnnotations(BObject service, BString method, ArrayValue resourcePath,\n+                                                      BString annotName) {\n+        String methodName = generateMethodName(method, resourcePath);\n+\n+        for (var r : ((ServiceType) service.getType()).getResourceMethods()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxOTcwOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            return { output: \"Hello\" };\n          \n          \n            \n                            return {output: \"Hello\"};", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r551719709", "createdAt": "2021-01-05T05:09:34Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-unit-test/src/test/resources/test-src/services/service_decl.bal", "diffHunk": "@@ -109,6 +118,24 @@ service S / on lsn {\n     function createError() returns @tainted error? {\n         return ();\n     }\n+\n+    resource function get foo() returns service object {} {\n+        return service object {\n+            resource function get foo() returns string {\n+                return \"foo/foo\";\n+            }\n+        };\n+    }\n+}\n+\n+int i = 0;\n+function returnServiceObj() returns service object {} {\n+    i = i + 1;\n+    return service object {\n+        @RAnnot { val: \"anot-val: \" + i.toString() }  resource function get processRequest() returns json {\n+                return { output: \"Hello\" };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "425eb75d279efdd9ddf56ee0a50cd7eff9d0fda1"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9120ca11c7e284bb2c28eba82d5a8eb24c6ae6c9", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9120ca11c7e284bb2c28eba82d5a8eb24c6ae6c9", "committedDate": "2021-01-05T12:27:59Z", "message": "Apply review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21b6a48338b617c59fb035c5ebd21a38bf1e5e9b", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/21b6a48338b617c59fb035c5ebd21a38bf1e5e9b", "committedDate": "2021-01-06T12:40:36Z", "message": "Merge branch 'lang-sl-alpha' of github.com:ballerina-platform/ballerina-lang into service-typing-dhananjaya\n\n\u0001 Conflicts:\n\u0001\tcompiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/model/SymbolTable.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1319c9c415b8c17f60e993b8863833f7a8ee66ea", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1319c9c415b8c17f60e993b8863833f7a8ee66ea", "committedDate": "2021-01-06T13:24:54Z", "message": "Fix failing test case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyNzM1MDI3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#pullrequestreview-562735027", "createdAt": "2021-01-06T14:09:46Z", "commit": {"oid": "1319c9c415b8c17f60e993b8863833f7a8ee66ea"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxNDowOTo0NlrOIPC1Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxNDoxNDoyOFrOIPDFQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjY0NTkzOQ==", "bodyText": "Shouldn't we change the method name?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r552645939", "createdAt": "2021-01-06T14:09:46Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-core/src/main/java/org/ballerinalang/core/model/types/BStructureType.java", "diffHunk": "@@ -68,8 +68,8 @@ public void setFieldTypeCount(int[] fieldCount) {\n         return attachedFunctions;\n     }\n \n-    public void setAttachedFunctions(BAttachedFunction[] attachedFunctions) {\n-        this.attachedFunctions = attachedFunctions;\n+    public void setAttachedFunctions(BAttachedFunction[] methodTypes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1319c9c415b8c17f60e993b8863833f7a8ee66ea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjY0NzE0MA==", "bodyText": "Shouldn't this be setResourceMethods?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void setResourceFunctions(ResourceMethodType[] resourceFunctions) {\n          \n          \n            \n                public void setResourceMethods(ResourceMethodType[] resourceMethods) {", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r552647140", "createdAt": "2021-01-06T14:10:50Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BServiceType.java", "diffHunk": "@@ -32,14 +33,14 @@\n  */\n public class BServiceType extends BObjectType implements ServiceType {\n \n-    private ResourceFunctionType[] resourceFunctions;\n-    private volatile MemberFunctionType[] remoteFunctions;\n+    private ResourceMethodType[] resourceFunctions;\n+    private volatile RemoteMethodType[] remoteFunctions;\n \n     public BServiceType(String typeName, Module pkg, long flags) {\n         super(typeName, pkg, flags);\n     }\n \n-    public void setResourceFunctions(ResourceFunctionType[] resourceFunctions) {\n+    public void setResourceFunctions(ResourceMethodType[] resourceFunctions) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1319c9c415b8c17f60e993b8863833f7a8ee66ea"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjY0ODE0OA==", "bodyText": "Do we need this change?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r552648148", "createdAt": "2021-01-06T14:12:12Z", "author": {"login": "MaryamZi"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/HttpService.java", "diffHunk": "@@ -258,7 +258,7 @@ public void setUpgradeToWebSocketResources(\n     private static void processResources(HttpService httpService) {\n         List<HttpResource> httpResources = new ArrayList<>();\n         List<HttpResource> upgradeToWebSocketResources = new ArrayList<>();\n-        for (AttachedFunctionType resource : httpService.getBalService().getType().getAttachedFunctions()) {\n+        for (AttachedFunctionType resource : httpService.getBalService().getType().getAttachedFunctions()()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1319c9c415b8c17f60e993b8863833f7a8ee66ea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjY1MDA1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import io.ballerina.runtime.api.types.MethodTypes;\n          \n          \n            \n            import io.ballerina.runtime.api.types.MethodType;\n          \n      \n    \n    \n  \n\nThere seem to be several places with this change.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r552650051", "createdAt": "2021-01-06T14:14:28Z", "author": {"login": "MaryamZi"}, "path": "stdlib/task/src/main/java/org/ballerinalang/stdlib/task/utils/TaskExecutor.java", "diffHunk": "@@ -19,7 +19,7 @@\n \n import io.ballerina.runtime.api.Runtime;\n import io.ballerina.runtime.api.async.StrandMetadata;\n-import io.ballerina.runtime.api.types.MemberFunctionType;\n+import io.ballerina.runtime.api.types.MethodTypes;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1319c9c415b8c17f60e993b8863833f7a8ee66ea"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94059582748af0ee0fabee4ce156c9312336b578", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/94059582748af0ee0fabee4ce156c9312336b578", "committedDate": "2021-01-06T14:28:42Z", "message": "Apply review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d8b750f57a50846cdabb0c561331521fe7498b8", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9d8b750f57a50846cdabb0c561331521fe7498b8", "committedDate": "2021-01-06T14:55:28Z", "message": "Reset file changes in stdlib directory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyODA1NDQy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#pullrequestreview-562805442", "createdAt": "2021-01-06T15:35:14Z", "commit": {"oid": "9d8b750f57a50846cdabb0c561331521fe7498b8"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxNTozNToxNFrOIPHYaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxNTozNjowOVrOIPHbeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjcyMDQ4OA==", "bodyText": "Not related to this PR, but can't we do this when setting the methods itself, by overriding setAttachedFunctions maybe? We can probably remove the synchronized block and make remoteMethods a non-volatile variable then, right?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r552720488", "createdAt": "2021-01-06T15:35:14Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BServiceType.java", "diffHunk": "@@ -49,26 +50,26 @@ public void setResourceFunctions(ResourceFunctionType[] resourceFunctions) {\n      * @return array of remote functions\n      */\n     @Override\n-    public MemberFunctionType[] getRemoteFunctions() {\n-        if (remoteFunctions == null) {\n-            MemberFunctionType[] funcs = getRemoteFunctions(getAttachedFunctions());\n+    public RemoteMethodType[] getRemoteMethods() {\n+        if (remoteMethods == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d8b750f57a50846cdabb0c561331521fe7498b8"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjcyMTI3NA==", "bodyText": "Shall we rename this to getRemoteMethods and maybe change the param name too?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27464#discussion_r552721274", "createdAt": "2021-01-06T15:36:09Z", "author": {"login": "MaryamZi"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/internal/types/BServiceType.java", "diffHunk": "@@ -49,26 +50,26 @@ public void setResourceFunctions(ResourceFunctionType[] resourceFunctions) {\n      * @return array of remote functions\n      */\n     @Override\n-    public MemberFunctionType[] getRemoteFunctions() {\n-        if (remoteFunctions == null) {\n-            MemberFunctionType[] funcs = getRemoteFunctions(getAttachedFunctions());\n+    public RemoteMethodType[] getRemoteMethods() {\n+        if (remoteMethods == null) {\n+            RemoteMethodType[] funcs = getRemoteFunctions(getMethods());\n             synchronized (this) {\n-                if (remoteFunctions == null) {\n-                    remoteFunctions = funcs;\n+                if (remoteMethods == null) {\n+                    remoteMethods = funcs;\n                 }\n             }\n         }\n-        return remoteFunctions;\n+        return remoteMethods;\n     }\n \n-    private MemberFunctionType[] getRemoteFunctions(MemberFunctionType[] attachedFunctions) {\n-        ArrayList<MemberFunctionType> functions = new ArrayList<>();\n-        for (MemberFunctionType funcType : attachedFunctions) {\n-            if (SymbolFlags.isFlagOn(((BMemberFunctionType) funcType).flags, SymbolFlags.REMOTE)) {\n+    private RemoteMethodType[] getRemoteFunctions(MethodType[] attachedFunctions) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d8b750f57a50846cdabb0c561331521fe7498b8"}, "originalPosition": 58}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4591, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}