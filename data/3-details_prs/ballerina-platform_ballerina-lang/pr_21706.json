{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3MDk3OTcz", "number": 21706, "title": "Fix lang-server breaks for --std-libs param for old SDKs", "bodyText": "Purpose\n\nFix lang-server breaks for --std-libs param  for old SDKs\n\nFixes #21705\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-03-12T08:08:33Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21706", "merged": true, "mergeCommit": {"oid": "b651bf02366942c16b02de7b77016c89ec52e217"}, "closed": true, "closedAt": "2020-03-12T12:10:32Z", "author": {"login": "rasika"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM3L5mgFqTM3MzM0NTcyMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcM4b5uAH2gAyMzg3MDk3OTczOjEzNTZjMDczZTE1OWU5OWM2Njk2MTYwYTQyNzhkM2RiNGMyMzk1NDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMzQ1NzIx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21706#pullrequestreview-373345721", "createdAt": "2020-03-12T08:10:57Z", "commit": {"oid": "598cb6fe2e4d44e4b9f4dd1a12b5a44057b113bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5a60d39fd3fd5635e7158a49d9b7a68e24409bf", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e5a60d39fd3fd5635e7158a49d9b7a68e24409bf", "committedDate": "2020-03-12T08:15:12Z", "message": "Fix lang-server breaks for --std-libs param"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "598cb6fe2e4d44e4b9f4dd1a12b5a44057b113bc", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/598cb6fe2e4d44e4b9f4dd1a12b5a44057b113bc", "committedDate": "2020-03-12T08:04:14Z", "message": "Fix lang-server breaks for --std-libs param"}, "afterCommit": {"oid": "e5a60d39fd3fd5635e7158a49d9b7a68e24409bf", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e5a60d39fd3fd5635e7158a49d9b7a68e24409bf", "committedDate": "2020-03-12T08:15:12Z", "message": "Fix lang-server breaks for --std-libs param"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0c736de8142d42b036a23f9b2dd12743c5a981b", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c0c736de8142d42b036a23f9b2dd12743c5a981b", "committedDate": "2020-03-12T09:03:40Z", "message": "Fix configs are not getting parsed through system params\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a61f076335bbe9effdb1756c7da2565648abf6a", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5a61f076335bbe9effdb1756c7da2565648abf6a", "committedDate": "2020-03-12T09:05:53Z", "message": "Support config updates from old plugins\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffe30e340549e835d718379ac0576ae81c8b2a3a", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ffe30e340549e835d718379ac0576ae81c8b2a3a", "committedDate": "2020-03-12T09:29:39Z", "message": "Add backward compatibility for the older SDKs\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMzk4MDM3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21706#pullrequestreview-373398037", "createdAt": "2020-03-12T09:35:05Z", "commit": {"oid": "ffe30e340549e835d718379ac0576ae81c8b2a3a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwOTozNTowNVrOF1XGqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwOTozNTowNVrOF1XGqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ5NzM4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (((JsonObject) params.getSettings()).get(\"ballerina\") != null) {\n          \n          \n            \n                        configHolder.updateConfig(GSON.fromJson(((JsonObject) params.getSettings()).get(\"ballerina\"),\n          \n          \n            \n                                                                LSClientConfig.class));\n          \n          \n            \n                    } else {\n          \n          \n            \n                        // To support old plugins versions\n          \n          \n            \n                        configHolder.updateConfig(GSON.fromJson(((JsonObject) params.getSettings()), LSClientConfig.class));\n          \n          \n            \n                    }\n          \n          \n            \n                    JsonObject settings = (JsonObject) params.getSettings();\n          \n          \n            \n                    if (settings.get(\"ballerina\") != null) {\n          \n          \n            \n                        configHolder.updateConfig(GSON.fromJson(settings.get(\"ballerina\"), LSClientConfig.class));\n          \n          \n            \n                    } else {\n          \n          \n            \n                        // To support old plugins versions\n          \n          \n            \n                        configHolder.updateConfig(GSON.fromJson(settings, LSClientConfig.class));\n          \n          \n            \n                    }", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21706#discussion_r391497387", "createdAt": "2020-03-12T09:35:05Z", "author": {"login": "NipunaRanasinghe"}, "path": "language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/BallerinaWorkspaceService.java", "diffHunk": "@@ -131,8 +131,13 @@ public void didChangeConfiguration(DidChangeConfigurationParams params) {\n         if (!(params.getSettings() instanceof JsonObject)) {\n             return;\n         }\n-        configHolder.updateConfig(GSON.fromJson(((JsonObject) params.getSettings()).get(\"ballerina\"),\n-                                                LSClientConfig.class));\n+        if (((JsonObject) params.getSettings()).get(\"ballerina\") != null) {\n+            configHolder.updateConfig(GSON.fromJson(((JsonObject) params.getSettings()).get(\"ballerina\"),\n+                                                    LSClientConfig.class));\n+        } else {\n+            // To support old plugins versions\n+            configHolder.updateConfig(GSON.fromJson(((JsonObject) params.getSettings()), LSClientConfig.class));\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffe30e340549e835d718379ac0576ae81c8b2a3a"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1356c073e159e99c6696160a4278d3db4c239540", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1356c073e159e99c6696160a4278d3db4c239540", "committedDate": "2020-03-12T09:38:20Z", "message": "Move settings json into a local variable\n\nCo-Authored-By: Nipuna Ransinghe  <nipunaranasinghe93@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3902, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}