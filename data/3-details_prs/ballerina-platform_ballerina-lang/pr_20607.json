{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyNTQ2MDY2", "number": 20607, "title": "Implement cache for OAuth2 inbound authentication - [1.1.x]", "bodyText": "Purpose\nThis PR implement cache for OAuth2 inbound authentication. Please refer to mail [1] for more information.\n[1] https://groups.google.com/d/topic/ballerina-dev/4VkPqATJ1tI/discussion\nFixes #19707\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-01-14T10:03:18Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20607", "merged": true, "mergeCommit": {"oid": "f38e659031874dc4ecc8fbabdb2d4fea7872fdce"}, "closed": true, "closedAt": "2020-01-24T08:08:25Z", "author": {"login": "ldclakmal"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6N95xgH2gAyMzYyNTQ2MDY2OjhlMTc3NDgxZDk4ODc3ODczZWZmYjgxZGE1ZjllYmY4YTdjNDJjMzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9Y1aHAFqTM0Nzc2Njk4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e177481d98877873effb81da5f9ebf8a7c42c36", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8e177481d98877873effb81da5f9ebf8a7c42c36", "committedDate": "2020-01-14T09:58:55Z", "message": "Implement cache for oauth2 inbound auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9540c728d2c96a822a39bd35f6632f8d08975ee0", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9540c728d2c96a822a39bd35f6632f8d08975ee0", "committedDate": "2020-01-14T10:04:07Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3e4051e457667798a0fea5808d6138008184f85", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d3e4051e457667798a0fea5808d6138008184f85", "committedDate": "2020-01-14T10:06:45Z", "message": "Fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12c03189aaad86e30f227b2a85e2a443db44b0cd", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/12c03189aaad86e30f227b2a85e2a443db44b0cd", "committedDate": "2020-01-16T11:14:29Z", "message": "Fix few bugs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c813f8722fbd0610b581d593b13a41ae569c9b82", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c813f8722fbd0610b581d593b13a41ae569c9b82", "committedDate": "2020-01-14T11:12:42Z", "message": "Fix few bugs"}, "afterCommit": {"oid": "12c03189aaad86e30f227b2a85e2a443db44b0cd", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/12c03189aaad86e30f227b2a85e2a443db44b0cd", "committedDate": "2020-01-16T11:14:29Z", "message": "Fix few bugs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9a1f2aeabe7c44199122fa32b39749df0ed5ee4", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d9a1f2aeabe7c44199122fa32b39749df0ed5ee4", "committedDate": "2020-01-21T05:16:28Z", "message": "Add debug logs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38e806f8bafde40759e7531642409b9e09a121bf", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/38e806f8bafde40759e7531642409b9e09a121bf", "committedDate": "2020-01-22T10:57:13Z", "message": "Replace custom cache config with ballerina cache"}, "afterCommit": {"oid": "34c5c73434dd568edd94c96b8daa5a96e3fcfd6e", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/34c5c73434dd568edd94c96b8daa5a96e3fcfd6e", "committedDate": "2020-01-22T12:01:40Z", "message": "Replace custom cache config with ballerina cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a88b83788b0bd06d42852f074ca5580643e6335c", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a88b83788b0bd06d42852f074ca5580643e6335c", "committedDate": "2020-01-23T04:20:13Z", "message": "Replace custom cache config with ballerina cache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "227da29031a8caa42197265e84687acb98dd713c", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/227da29031a8caa42197265e84687acb98dd713c", "committedDate": "2020-01-23T00:07:39Z", "message": "Fix a bug"}, "afterCommit": {"oid": "a88b83788b0bd06d42852f074ca5580643e6335c", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a88b83788b0bd06d42852f074ca5580643e6335c", "committedDate": "2020-01-23T04:20:13Z", "message": "Replace custom cache config with ballerina cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac2e33994b83d3fe692cde951572b14345838ea9", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ac2e33994b83d3fe692cde951572b14345838ea9", "committedDate": "2020-01-23T08:35:27Z", "message": "Fix checkstyle of line length"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MTI3MDM2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20607#pullrequestreview-347127036", "createdAt": "2020-01-23T08:36:16Z", "commit": {"oid": "a88b83788b0bd06d42852f074ca5580643e6335c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwODozNjoxNlrOFg2KUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwODozNjoxNlrOFg2KUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4NjEyOA==", "bodyText": "Let's break this line to accommodate 120 line break.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20607#discussion_r369986128", "createdAt": "2020-01-23T08:36:16Z", "author": {"login": "wggihan"}, "path": "stdlib/oauth2/src/main/ballerina/src/oauth2/inbound_oauth2_provider.bal", "diffHunk": "@@ -43,9 +50,16 @@ public type InboundOAuth2Provider object {\n         if (credential == \"\") {\n             return false;\n         }\n-        boolean authenticated = false;\n-        string username = \"\";\n-        string scopes = \"\";\n+\n+        var oauth2Cache = self.oauth2Cache;\n+        if (oauth2Cache is cache:Cache && oauth2Cache.hasKey(credential)) {\n+            var oauth2CacheEntry = authenticateFromCache(oauth2Cache, credential);\n+            if (oauth2CacheEntry is InboundOAuth2CacheEntry) {\n+                auth:setAuthenticationContext(\"oauth2\", credential);\n+                auth:setPrincipal(oauth2CacheEntry.username, oauth2CacheEntry.username, getScopes(oauth2CacheEntry.scopes));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a88b83788b0bd06d42852f074ca5580643e6335c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NzY2OTg0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20607#pullrequestreview-347766984", "createdAt": "2020-01-24T06:20:22Z", "commit": {"oid": "ac2e33994b83d3fe692cde951572b14345838ea9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4309, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}