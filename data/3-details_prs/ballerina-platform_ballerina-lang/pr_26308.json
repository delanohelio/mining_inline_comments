{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMzc2MDc2", "number": 26308, "title": "Add Distinct type support object constructor", "bodyText": "Purpose\n\nDescribe the problems, issues, or needs driving this feature/fix and include links to related issues.\n\nFixes #23283\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-10-12T07:22:38Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308", "merged": true, "mergeCommit": {"oid": "38d1290cbcf13ff4072bfd8231c7bcc51e7babfc"}, "closed": true, "closedAt": "2020-11-03T12:21:34Z", "author": {"login": "KRVPerera"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRuyGNABqjM4NjUxNDU4OTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY4ODVgFqTUyMjQ0MTkxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "743a289806df7ac594f11d82e0731447e1f024be", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/743a289806df7ac594f11d82e0731447e1f024be", "committedDate": "2020-10-12T07:06:18Z", "message": "Support distinct type ids for object ctor"}, "afterCommit": {"oid": "c1eafb0a1995244514bdcfe1ff83cdc43e344253", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c1eafb0a1995244514bdcfe1ff83cdc43e344253", "committedDate": "2020-10-12T07:24:06Z", "message": "Support distinct type ids for object ctor"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c7a8b34c233e4d21beea08bdf542e8e45eb0f1f", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4c7a8b34c233e4d21beea08bdf542e8e45eb0f1f", "committedDate": "2020-10-12T09:11:40Z", "message": "Fix test case style"}, "afterCommit": {"oid": "0e460523bd7f36f1044b71e166d28e82ab319305", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0e460523bd7f36f1044b71e166d28e82ab319305", "committedDate": "2020-10-12T09:52:44Z", "message": "Fix test case style"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "472a37d3be5df2d2fc1e2c45b9620c13fb8aa8d8", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/472a37d3be5df2d2fc1e2c45b9620c13fb8aa8d8", "committedDate": "2020-10-13T02:14:16Z", "message": "Merge branch 'master' into krv_add_type_id_for_object_ctor"}, "afterCommit": {"oid": "d0f12195cd60ab3927a6fd2659fa3348d5953420", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d0f12195cd60ab3927a6fd2659fa3348d5953420", "committedDate": "2020-10-13T04:53:57Z", "message": "Fix deprecation test case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNDQ2NTQ3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308#pullrequestreview-513446547", "createdAt": "2020-10-21T08:48:10Z", "commit": {"oid": "d0f12195cd60ab3927a6fd2659fa3348d5953420"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwODo0ODoxMVrOHlhF4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwODo0ODoxMVrOHlhF4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEwMTUzNg==", "bodyText": "With this[1] change, I don't think we need this check and this flag\n[1] - https://github.com/ballerina-platform/ballerina-lang/pull/26098/files#diff-fa94fe90a875c08eaf806f89f6ceb7eec7205acaf75c88a41e3f7103abfa5a52L410", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308#discussion_r509101536", "createdAt": "2020-10-21T08:48:11Z", "author": {"login": "rdhananjaya"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/SymbolEnter.java", "diffHunk": "@@ -611,7 +611,7 @@ public void visit(BLangClassDefinition classDefinition) {\n             objectType = isReadOnly ? new BObjectType(tSymbol, Flags.READONLY) : new BObjectType(tSymbol);\n         }\n \n-        if (flags.contains(Flag.DISTINCT)) {\n+        if (flags.contains(Flag.DISTINCT) || classDefinition.induceTypeIds) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0f12195cd60ab3927a6fd2659fa3348d5953420"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNDgzMDIz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308#pullrequestreview-513483023", "createdAt": "2020-10-21T09:29:57Z", "commit": {"oid": "7c6b982da803bdb5e5da55d003ed310e32de0951"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwOToyOTo1OFrOHli28w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwOToyOTo1OFrOHli28w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEzMDQ4Mw==", "bodyText": "class K {\n    int i = 0;\n    int j = 0;\n}\n\nclass J {\n    int i = 0;\n}\n\nDistinctFoo | DistinctFooA | K | J distinctObject = object {\n                                        int i;\n                                        function init() {\n                                            self.i = 20;\n                                        }\n                                    };\nThe above should not be allowed right, as the union is not definite.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308#discussion_r509130483", "createdAt": "2020-10-21T09:29:58Z", "author": {"login": "rdhananjaya"}, "path": "tests/jballerina-unit-test/src/test/resources/test-src/expressions/object/object_constructor_expression.bal", "diffHunk": "@@ -125,6 +125,51 @@ function testObjectConstructorIncludedMethod() {\n     assertTrue(objWithIncludedMethod.n == 100);\n }\n \n+// test distinct id support\n+\n+distinct class DistinctFoo {\n+    int i = 0;\n+}\n+\n+distinct class DistinctFooA {\n+    int i = 0;\n+}\n+\n+distinct class DistinctFooB {\n+    int i = 0;\n+}\n+\n+function testObjectConstructorWithDistintExpectedType() {\n+    DistinctFoo distinctObject = object {\n+                                        int i;\n+                                        function init() {\n+                                            self.i = 20;\n+                                        }\n+                                    };\n+    assertValueEquality(20, distinctObject.i);\n+}\n+\n+function testObjectConstructorWithDistintTypeReference() {\n+    DistinctFooA distinctObject = object DistinctFooA {\n+                                            int i;\n+                                            function init() {\n+                                                self.i = 30;\n+                                            }\n+                                         };\n+    assertValueEquality(30, distinctObject.i);\n+}\n+\n+function testObjectConstructorWithDistintTypeReferenceVar() {\n+    var distinctObject = object DistinctFooB {\n+                                            int i;\n+                                            function init() {\n+                                                self.i = 25;\n+                                            }\n+                                         };\n+    DistinctFooB newDistinctRef = distinctObject;\n+    assertValueEquality(25, newDistinctRef.i);\n+}\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c6b982da803bdb5e5da55d003ed310e32de0951"}, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c34f7ff9a925a8acdea0e9fc994d6d4f6540350d", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c34f7ff9a925a8acdea0e9fc994d6d4f6540350d", "committedDate": "2020-10-21T10:42:33Z", "message": "Merge branch 'master' into krv_add_type_id_for_object_ctor"}, "afterCommit": {"oid": "d52fe16f61f03d3a5ced48a175b13a357c70780d", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d52fe16f61f03d3a5ced48a175b13a357c70780d", "committedDate": "2020-10-21T16:09:25Z", "message": "Resolve conflicts with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd1788f393d17f66a87d9c13cbe09a4cadd9d023", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bd1788f393d17f66a87d9c13cbe09a4cadd9d023", "committedDate": "2020-10-22T01:11:34Z", "message": "Add distinct support for object type def"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f19be09e183b6afb13fc0fa35b8c7ca6c12efa25", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f19be09e183b6afb13fc0fa35b8c7ca6c12efa25", "committedDate": "2020-10-22T01:11:34Z", "message": "Fix failing test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8558da2d785f65c6af552474138262de5d160f7", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f8558da2d785f65c6af552474138262de5d160f7", "committedDate": "2020-10-22T01:11:34Z", "message": "Apply review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b5b0d80ea95df12ee23f992cef1444dcdc6d6a8", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b5b0d80ea95df12ee23f992cef1444dcdc6d6a8", "committedDate": "2020-10-22T01:11:34Z", "message": "Add parent type-ids to child classes\n\neven when the child is not specified as distinct"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87141b1da9865d1ebfe2f2a75b4d4cb6666bd5a5", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/87141b1da9865d1ebfe2f2a75b4d4cb6666bd5a5", "committedDate": "2020-10-22T01:12:28Z", "message": "Refactor node transformer for BlangObjectCtor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6019be24ef66530ba42178272447962959c1117", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d6019be24ef66530ba42178272447962959c1117", "committedDate": "2020-10-22T01:12:29Z", "message": "Support distinct type ids for object ctor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb9a63758ff13ce40d6fb3e4aa254ce11a73c4c1", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cb9a63758ff13ce40d6fb3e4aa254ce11a73c4c1", "committedDate": "2020-10-22T01:12:29Z", "message": "Test distinct type ids for object ctor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c5994c51818fbe69da3e93aaa925cbf436d3d0f", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6c5994c51818fbe69da3e93aaa925cbf436d3d0f", "committedDate": "2020-10-22T01:12:29Z", "message": "Refactor type ids for object ctor\n\nRemoved duplicate checks. Add negative test case."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ffa83b81882e190914dcca0c0230c9aadba3cf6", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0ffa83b81882e190914dcca0c0230c9aadba3cf6", "committedDate": "2020-10-22T01:12:29Z", "message": "Fix test case style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "064fd5215dff2c50bf97d590168fe849d68adfd3", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/064fd5215dff2c50bf97d590168fe849d68adfd3", "committedDate": "2020-10-22T01:12:29Z", "message": "Add relevant visitors for object ctor expression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bcce2f48fb4d9df4b5b19c48c39e7e6b1319d9a", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9bcce2f48fb4d9df4b5b19c48c39e7e6b1319d9a", "committedDate": "2020-10-22T01:12:29Z", "message": "Test code analyzer on object ctor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2517908caffabcd377f3d618e8e4be8cb0e8a214", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2517908caffabcd377f3d618e8e4be8cb0e8a214", "committedDate": "2020-10-22T01:12:29Z", "message": "Fix deprecation test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c911f29c9ce86dc6ff7501cf563ccfe2ce2d2fb0", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c911f29c9ce86dc6ff7501cf563ccfe2ce2d2fb0", "committedDate": "2020-10-22T01:13:54Z", "message": "Resolve conflicts with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "529f4a2f206330e309add582d1d4da2f283dc042", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/529f4a2f206330e309add582d1d4da2f283dc042", "committedDate": "2020-10-22T01:13:54Z", "message": "Fix definite object type check for unions in obj ctor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78f870419c39f666264f574f75500582ae272c28", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/78f870419c39f666264f574f75500582ae272c28", "committedDate": "2020-10-22T01:13:54Z", "message": "Fix code style in ObjectConstructorTest.java"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8f1d579030f3baf97291842ed00fcf175cf3bd0", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d8f1d579030f3baf97291842ed00fcf175cf3bd0", "committedDate": "2020-10-21T20:17:27Z", "message": "Fix code style in ObjectConstructorTest.java"}, "afterCommit": {"oid": "78f870419c39f666264f574f75500582ae272c28", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/78f870419c39f666264f574f75500582ae272c28", "committedDate": "2020-10-22T01:13:54Z", "message": "Fix code style in ObjectConstructorTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47ce7d083e4b31910caea5363ac00db84df48192", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/47ce7d083e4b31910caea5363ac00db84df48192", "committedDate": "2020-10-22T01:18:57Z", "message": "Merge remote-tracking branch 'origin/distinct_object_type_m2' into krv_add_type_id_for_object_ctor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d4070c0660fc3c450b088289bffdaece3d0e5d4", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8d4070c0660fc3c450b088289bffdaece3d0e5d4", "committedDate": "2020-10-22T01:22:52Z", "message": "Merge branch 'master' into cyclic_type_definition_done_right"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dce80e73a1bd0719e0d3239a476f9a3e6dfbf94", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8dce80e73a1bd0719e0d3239a476f9a3e6dfbf94", "committedDate": "2020-10-22T01:36:16Z", "message": "Fix test case ObjectConstructorTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dca05233cbd6b9b7edee78854f54253735bf0d0", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3dca05233cbd6b9b7edee78854f54253735bf0d0", "committedDate": "2020-10-22T02:24:25Z", "message": "Remove `induceTypeIds` from BLangClassDefinition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e85f92152384c61750c9daa919a4df18df821744", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e85f92152384c61750c9daa919a4df18df821744", "committedDate": "2020-10-22T03:10:33Z", "message": "Fix IsolatedObjectTest for object constructor"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f44e1bd37e0557dd3b9413bd9645f35604de4cd0", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f44e1bd37e0557dd3b9413bd9645f35604de4cd0", "committedDate": "2020-10-22T02:59:29Z", "message": "Fix IsolatedObjectTest for object constructor"}, "afterCommit": {"oid": "e85f92152384c61750c9daa919a4df18df821744", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e85f92152384c61750c9daa919a4df18df821744", "committedDate": "2020-10-22T03:10:33Z", "message": "Fix IsolatedObjectTest for object constructor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MzcwODAz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308#pullrequestreview-519370803", "createdAt": "2020-10-29T06:41:37Z", "commit": {"oid": "e85f92152384c61750c9daa919a4df18df821744"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e380dee4b10cea60407391d13b11e1bf81f9ddae", "author": {"user": {"login": "KRVPerera", "name": "Rukshan Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e380dee4b10cea60407391d13b11e1bf81f9ddae", "committedDate": "2020-11-03T10:39:49Z", "message": "Merge branch 'master' into krv_add_type_id_for_object_ctor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNDQxOTEy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26308#pullrequestreview-522441912", "createdAt": "2020-11-03T12:21:27Z", "commit": {"oid": "e380dee4b10cea60407391d13b11e1bf81f9ddae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4570, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}