{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMzMwOTgz", "number": 26902, "title": "Add support to collect AST from single files for Observability", "bodyText": "Purpose\n\nAdd support to collect AST from single files for Observability\n\nApproach\n\nThe tasks for collecting the AST had been enabled for single files & the relevant problems related to it had been fixed.\n\nSamples\n\nN/A\n\nRemarks\n\nN/A\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-11-13T04:43:35Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26902", "merged": true, "mergeCommit": {"oid": "be7c145fb0dd78941de9fef0ad3f499a009ef08f"}, "closed": true, "closedAt": "2020-11-15T11:19:14Z", "author": {"login": "nadundesilva"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdb_8IEgBqjM5OTE4MTU1NzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdct8LBAFqTUzMDc4NjE1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a01c01b3a939dc74c071b6a7d03ab36da2bcb2f7", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a01c01b3a939dc74c071b6a7d03ab36da2bcb2f7", "committedDate": "2020-11-13T04:10:21Z", "message": "Make the Observability instrumentation the first task in Compiler BE"}, "afterCommit": {"oid": "b60565dc9397dac0a2793f75101870299e520999", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b60565dc9397dac0a2793f75101870299e520999", "committedDate": "2020-11-13T05:02:35Z", "message": "Make the Observability instrumentation the first task in Compiler BE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66797631268c1c5d12a2953108d6fed4b8790411", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/66797631268c1c5d12a2953108d6fed4b8790411", "committedDate": "2020-11-13T10:05:44Z", "message": "Minor fix for handling single files in Observability\n\n# Single bal files are at the root of the Jar unlike modules which are within Java packages. This needs be properly handled when inferring the ballerina package from the Java Package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cf6042f06659da1bf190aae4ea2f7abb9ddf13d", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3cf6042f06659da1bf190aae4ea2f7abb9ddf13d", "committedDate": "2020-11-13T10:05:44Z", "message": "Enable capturing AST for single files without modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5545bc3811bc9035ba2d7d5b89654a04c5503b95", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5545bc3811bc9035ba2d7d5b89654a04c5503b95", "committedDate": "2020-11-13T10:05:44Z", "message": "Minor bug fix to anonymous service names in Observability data\n\n# The name of the anonymous services in the captured AST and the Observability data seemed to have deviated due to a change in the ballerina core. This had to be fixed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2204ed96ea109a6cda56f9b0a5843754ea0ebd55", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2204ed96ea109a6cda56f9b0a5843754ea0ebd55", "committedDate": "2020-11-13T10:05:45Z", "message": "Add test case for programmatically start service Observability\n\n# This also tests anonymous services related observability as it is considered anonymous"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd5f9b014b54552226507df0b550517999bf2376", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bd5f9b014b54552226507df0b550517999bf2376", "committedDate": "2020-11-13T10:24:23Z", "message": "Make the Observability instrumentation the first task in Compiler BE"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b60565dc9397dac0a2793f75101870299e520999", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b60565dc9397dac0a2793f75101870299e520999", "committedDate": "2020-11-13T05:02:35Z", "message": "Make the Observability instrumentation the first task in Compiler BE"}, "afterCommit": {"oid": "bd5f9b014b54552226507df0b550517999bf2376", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bd5f9b014b54552226507df0b550517999bf2376", "committedDate": "2020-11-13T10:24:23Z", "message": "Make the Observability instrumentation the first task in Compiler BE"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNTc3Mzk1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26902#pullrequestreview-530577395", "createdAt": "2020-11-14T13:16:27Z", "commit": {"oid": "bd5f9b014b54552226507df0b550517999bf2376"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQxMzoxNjoyN1rOHzK86A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQxMzoxNjoyN1rOHzK86A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQxODg1Ng==", "bodyText": "is it possible to use ,  typeDef.getType().getPackage() it might be more accurate because names can be encoded.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26902#discussion_r523418856", "createdAt": "2020-11-14T13:16:27Z", "author": {"login": "manuranga"}, "path": "bvm/ballerina-runtime/src/main/java/io/ballerina/runtime/observability/ObserveUtils.java", "diffHunk": "@@ -195,9 +195,14 @@ public static void startCallableObservation(Environment env, boolean isRemote, b\n         } else {\n             String className = typeDef.getClass().getCanonicalName();\n             String[] classNameSplit = className.split(\"\\\\.\");\n-            int lastIndexOfDollar = classNameSplit[3].lastIndexOf('$');\n-            newObContext.setObjectName(classNameSplit[0] + \"/\" + classNameSplit[1] + \"/\"\n-                    + classNameSplit[3].substring(lastIndexOfDollar + 1));\n+            if (classNameSplit.length == 4) {   // Object from a project module", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd5f9b014b54552226507df0b550517999bf2376"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcd995921055c7108137082ab30f492f64f93996", "author": {"user": {"login": "nadundesilva", "name": "Nadun De Silva"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dcd995921055c7108137082ab30f492f64f93996", "committedDate": "2020-11-15T08:19:54Z", "message": "Update object type inferring to use BObject properties"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzg2MTU1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26902#pullrequestreview-530786155", "createdAt": "2020-11-15T10:38:34Z", "commit": {"oid": "dcd995921055c7108137082ab30f492f64f93996"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3276, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}