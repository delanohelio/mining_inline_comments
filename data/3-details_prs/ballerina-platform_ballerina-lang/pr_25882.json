{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4NTg0NTMz", "number": 25882, "title": "Add support for value:toBalString()", "bodyText": "Purpose\n\n$title to convert a value to a string that describes the value in Ballerina syntax(expression style). For more information please refer https://ballerina.io/spec/lang/master/#ToString and https://github.com/ballerina-platform/ballerina-spec/blob/master/lang/lib/value.bal#L106\n\nFixes #25765\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nThe following examples provide the result of value:toBalString() for basic types.\n\nxml argXML1 = xml `<TITLE>Empire Burlesque</TITLE>`;\nargXML1.toBalString() \\\\xml`<TITLE>Empire Burlesque</TITLE>`\n\nfloat?[] arr = [1.25, (0.0/0.0), (1.0/0.0), ()];\narr.toBalString() \\\\[1.25,float:NaN,float:Infinity,()]\n\ndecimal decimalVal = 1.20;\ndecimalVal.toBalString() \\\\1.20d\n\ntype Employee record {\n    readonly int id;\n    int age;\n    decimal salary;\n    readonly string name;\n    boolean married;\n};\n\ntable<Employee> employeeTable = table key(id, name) [\n     { id: 1, age: 30,  salary: 300.5, name: \"Mary\", married: true },\n     { id: 2, age: 20,  salary: 200, name: \"John\", married: true }\n];\nemployeeTable.toBalString() \\\\table key(id,name) [{\"id\":1,\"age\":30,\"salary\":300.5d,\"name\":\"Mary\",\"married\":true},{\"id\":2,\"age\":20,\"salary\":200d,\"name\":\"John\",\"married\":true}]\n\npublic type FirstError distinct error;\n\nerror cause = error(\"Account not found\", accountID = 123, name=\"someVal\", oop = (), val=(0.0/0.0));\nFirstError e = FirstError(REASON_1, cause, message = \"Test union of errors with type test\");\ncause.toBalString() \\\\error error (\"Account not found\",accountID=123,name=\"someVal\",oop=(),val=float:NaN)\ne.toBalString() \\\\error FirstError (\"Reason1\",error error (\"Account not found\",accountID=123,name=\"someVal\",oop=(),val=float:NaN),message=\"Test union of errors with type test\")\n\nobject with toString method\npublic class Teacher {\n\n    string name;\n    string school;\n\n    public function init(string name, string school) {\n        self.name = name;\n        self.school = school;\n    }\n\n    public function getDetails() returns string {\n        return self.name + \" from \" + self.school;\n    }\n\n    public function toString() returns string {\n        return self.getDetails();\n    }\n}\n\nTeacher varObj = new(\"Rola\", \"MMV\");\nvarObj.toBalString() \\\\object Rola from MMV\n\nobject without toString method\nclass Person {\n    public int age = 0;\n    public string name = \"\";\n}\n\nPerson p1 = new;\np1.toBalString() \\\\ object Person1 986212188\n\nEmployee e1 =  { id: 1, age: 30,  salary: 300.5, name: \"Mary\", married: true };\ne1.toBalString() \\\\{\"id\":1,\"age\":30,\"salary\":300.5d,\"name\":\"Mary\",\"married\":true}\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-17T11:00:16Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25882", "merged": true, "mergeCommit": {"oid": "e57672783b1c07fca02527abe0330d736e5cb976"}, "closed": true, "closedAt": "2020-10-02T04:04:37Z", "author": {"login": "lasinicl"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJB44HgH2gAyNDg4NTg0NTMzOjgwZTVjODcxY2U3ZDlkMjg5MjA0YmRmZDhlMTNlOTRmYmMzMDAwMDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmDbsHgFqTU1MTI0ODUxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "80e5c871ce7d9d289204bdfd8e13e94fbc300007", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/80e5c871ce7d9d289204bdfd8e13e94fbc300007", "committedDate": "2020-09-15T06:34:35Z", "message": "Add toBalString() support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08eb77efe16a6937969cf5c3cf48fb921304b271", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/08eb77efe16a6937969cf5c3cf48fb921304b271", "committedDate": "2020-09-15T12:21:30Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19968de2b22001604820f103baeda99c302e65bc", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/19968de2b22001604820f103baeda99c302e65bc", "committedDate": "2020-09-16T02:36:10Z", "message": "Add toBalString() for cycle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85f4bddab4dba2685aa8e4fa2c811aa459eafa91", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/85f4bddab4dba2685aa8e4fa2c811aa459eafa91", "committedDate": "2020-09-16T09:01:03Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765\n\n\u0001 Conflicts:\n\u0001\tbvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/values/ErrorValue.java\n\u0001\tbvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/values/TableValueImpl.java\n\u0001\tbvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/values/utils/StringUtils.java\n\u0001\tlanglib/lang.error/src/main/java/org/ballerinalang/langlib/error/StackTrace.java\n\u0001\tlanglib/lang.value/src/main/ballerina/src/lang.value/value.bal\n\u0001\tmisc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/natives/mock/GenericMockObjectValue.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9702395288a3d52b896fed4b1aaecfb471fae9c", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d9702395288a3d52b896fed4b1aaecfb471fae9c", "committedDate": "2020-09-16T12:40:37Z", "message": "Add support for toBalString()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8373336799866c9efff75cc44035d96bdfbe6234", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8373336799866c9efff75cc44035d96bdfbe6234", "committedDate": "2020-09-16T15:08:05Z", "message": "Refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b73b373a4dd50faefc94af34ae1fb37cb96ae24", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8b73b373a4dd50faefc94af34ae1fb37cb96ae24", "committedDate": "2020-09-17T06:00:34Z", "message": "Refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec372022c4085b72bd542fa578e23ffa9517f526", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ec372022c4085b72bd542fa578e23ffa9517f526", "committedDate": "2020-09-17T07:25:37Z", "message": "Add tests and refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8afccb44e3884345d1ebdb7230aa24d3307e1b5", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b8afccb44e3884345d1ebdb7230aa24d3307e1b5", "committedDate": "2020-09-17T08:24:59Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea9d6d55b35555e8b739d7b3817de2f41caed3b9", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ea9d6d55b35555e8b739d7b3817de2f41caed3b9", "committedDate": "2020-09-17T10:13:30Z", "message": "Add tests and refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35de59f722703d6f575c77f8dbb0825cb92f3c86", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/35de59f722703d6f575c77f8dbb0825cb92f3c86", "committedDate": "2020-09-17T10:22:11Z", "message": "Remove unnecessary new lines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e81a409d184156a972c9688ede0d432e60903ceb", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e81a409d184156a972c9688ede0d432e60903ceb", "committedDate": "2020-09-17T12:09:56Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7be3acb3bd60ef00a7741a0016890eaf8c0963f5", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7be3acb3bd60ef00a7741a0016890eaf8c0963f5", "committedDate": "2020-09-17T13:13:54Z", "message": "Refactor code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNTk5Njgy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25882#pullrequestreview-490599682", "createdAt": "2020-09-17T13:33:53Z", "commit": {"oid": "7be3acb3bd60ef00a7741a0016890eaf8c0963f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMzozMzo1M1rOHTieOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMzozMzo1M1rOHTieOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI0OTc4Ng==", "bodyText": "i think this should be this.index = this.parent.index + 1; ?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25882#discussion_r490249786", "createdAt": "2020-09-17T13:33:53Z", "author": {"login": "gimantha"}, "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/CycleUtils.java", "diffHunk": "@@ -33,10 +33,12 @@\n     public static class Node implements BLink {\n         Object obj;\n         BLink parent;\n+        int index = 0;\n \n         public Node(Object obj, BLink parent) {\n             this.obj = obj;\n             this.parent = parent;\n+            this.index++;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7be3acb3bd60ef00a7741a0016890eaf8c0963f5"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45160c831e708685c9a3395e817cba610d436418", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/45160c831e708685c9a3395e817cba610d436418", "committedDate": "2020-09-17T13:47:58Z", "message": "Fix review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1011f1ea93d9d92ca04311382653cd291f43fe2", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c1011f1ea93d9d92ca04311382653cd291f43fe2", "committedDate": "2020-09-17T14:06:17Z", "message": "Fix review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80d83849029b6ba7d373701fc04b220bfc093055", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/80d83849029b6ba7d373701fc04b220bfc093055", "committedDate": "2020-09-17T14:06:29Z", "message": "Fix review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93aa9c36c86a00ea1a260bcaa53f0fd613e37335", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/93aa9c36c86a00ea1a260bcaa53f0fd613e37335", "committedDate": "2020-09-18T04:02:25Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8935529ad6c82a9dd25c4c5f7406f31ac59ea61", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e8935529ad6c82a9dd25c4c5f7406f31ac59ea61", "committedDate": "2020-09-18T05:30:39Z", "message": "Fix test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5e21f048943c73d02a19746928da3b63cb1c518", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e5e21f048943c73d02a19746928da3b63cb1c518", "committedDate": "2020-09-18T06:45:20Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0189cf8f57d55b49428d6b50c41a42154a7506f0", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0189cf8f57d55b49428d6b50c41a42154a7506f0", "committedDate": "2020-09-18T06:45:27Z", "message": "Refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f3621bb8272a4ee0ec16b8d15f4a5ffcf77d115", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4f3621bb8272a4ee0ec16b8d15f4a5ffcf77d115", "committedDate": "2020-09-18T07:00:42Z", "message": "Refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09452cbee8da6fe961db58a56163f1cef4fbc63f", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/09452cbee8da6fe961db58a56163f1cef4fbc63f", "committedDate": "2020-09-18T07:12:30Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d71afc0c66dbcc4790aced270fa7a6b04aa28385", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d71afc0c66dbcc4790aced270fa7a6b04aa28385", "committedDate": "2020-09-18T08:38:47Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3ea9d230208f0fa8ccd8dcc2c63aef992757353", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b3ea9d230208f0fa8ccd8dcc2c63aef992757353", "committedDate": "2020-09-18T08:38:57Z", "message": "Add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f920d0c535ddd70b06495ff8dee2b877ab055fe8", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f920d0c535ddd70b06495ff8dee2b877ab055fe8", "committedDate": "2020-09-18T12:50:01Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "832b5f79cc02ee8aaf4e8bd92658ce1b2721f171", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/832b5f79cc02ee8aaf4e8bd92658ce1b2721f171", "committedDate": "2020-09-18T13:12:30Z", "message": "Fix lang-server tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e724dae775f733bb2574c1bcdfebbaf274185bab", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e724dae775f733bb2574c1bcdfebbaf274185bab", "committedDate": "2020-09-29T09:36:00Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-25765"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9027d8bd55b893e27f46447e45b0e08f1ad28819", "author": {"user": {"login": "lasinicl", "name": "Lasini Liyange"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9027d8bd55b893e27f46447e45b0e08f1ad28819", "committedDate": "2020-09-29T13:11:00Z", "message": "Add suggested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwODQ5NjU3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25882#pullrequestreview-500849657", "createdAt": "2020-10-02T04:04:30Z", "commit": {"oid": "9027d8bd55b893e27f46447e45b0e08f1ad28819"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMjQ4NTE4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25882#pullrequestreview-551248518", "createdAt": "2020-12-14T10:46:19Z", "commit": {"oid": "9027d8bd55b893e27f46447e45b0e08f1ad28819"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxMDo0NjoxOVrOIFKh5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxMDo0NjoxOVrOIFKh5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjI4NjMxMA==", "bodyText": "Lets do this change if not done yet", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25882#discussion_r542286310", "createdAt": "2020-12-14T10:46:19Z", "author": {"login": "gimantha"}, "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/api/BStringUtils.java", "diffHunk": "@@ -244,6 +245,83 @@ public static String getStringValue(Object value, BLink parent) {\n         return refValue.stringValue(parent);\n     }\n \n+    /**\n+     * Returns the string value of Ballerina values in expression style.\n+     *\n+     * @param value The value on which the function is invoked\n+     * @param parent The link to the parent node\n+     * @return String value of the value in expression style\n+     */\n+    public static String getExpressionStringValue(Object value, BLink parent) {\n+        if (value == null) {\n+            return \"()\";\n+        }\n+\n+        BType type = TypeChecker.getType(value);\n+\n+        //TODO: bstring - change to type tag check", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9027d8bd55b893e27f46447e45b0e08f1ad28819"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4598, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}