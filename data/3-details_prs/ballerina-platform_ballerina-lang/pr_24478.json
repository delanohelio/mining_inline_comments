{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMTYxMjI1", "number": 24478, "title": "Replace Ballerina map usages in Ballerina Cache with Java ConcurrentHashMap  [master] ", "bodyText": "Purpose\nThis PR replaces the Ballerina map usages in Ballerina Cache with java.util.ConcurrentHashMap.\nThis improves the TPS dropped due to enabling of HTTP caching.\nAlso, removes the error count introduced in performance tests due to locks usage in Ballerina cache, in order to solve the concurrency issues.\nPlease refer to the below issue for more details on the approach in detail.\nFixes #24363\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-06-29T02:32:07Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24478", "merged": true, "mergeCommit": {"oid": "4aeac41e33de9e416add97d08182b9fb99f8d399"}, "closed": true, "closedAt": "2020-07-01T12:14:47Z", "author": {"login": "ldclakmal"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuuIdIAH2gAyNDQxMTYxMjI1OmQ3MWQ1MGFhMGNlMTJkYmZhNDZlZDE2ZmVmYzc0MDU5YmQ2ZWEzYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwpC9LgFqTQ0MDgwNTgyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d71d50aa0ce12dbfa46ed16fefc74059bd6ea3b5", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d71d50aa0ce12dbfa46ed16fefc74059bd6ea3b5", "committedDate": "2020-06-25T12:51:28Z", "message": "Update cache internals to java ConcurrentHashMap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be4ea8d234690d3c602e739dd24e6bb20bc2418e", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/be4ea8d234690d3c602e739dd24e6bb20bc2418e", "committedDate": "2020-06-25T12:52:05Z", "message": "Fix http-cache invalidating non existing key"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37851a53a1247949508f17be370bdffcc3e1debe", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/37851a53a1247949508f17be370bdffcc3e1debe", "committedDate": "2020-06-25T12:52:18Z", "message": "Update cache key string concatenation with string template"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c819c90f39446abf458eda54a933c67aa106b545", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c819c90f39446abf458eda54a933c67aa106b545", "committedDate": "2020-06-29T01:40:58Z", "message": "Update remove API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6d84f0681161433f2854d418f74c566ac65cf90", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e6d84f0681161433f2854d418f74c566ac65cf90", "committedDate": "2020-06-29T01:56:06Z", "message": "Update internal cache error functions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "826844e013718dca27e94ed782a9f4b3e92fa82c", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/826844e013718dca27e94ed782a9f4b3e92fa82c", "committedDate": "2020-06-30T16:25:47Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fix-performance"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNTQ5Mzky", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24478#pullrequestreview-440549392", "createdAt": "2020-07-01T05:09:09Z", "commit": {"oid": "826844e013718dca27e94ed782a9f4b3e92fa82c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNTowOToxMFrOGrW9Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNTowOToxMFrOGrW9Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODExODA5MQ==", "bodyText": "Shall we use a constant for \"DEBUG\" as it has been used in multiple places?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24478#discussion_r448118091", "createdAt": "2020-07-01T05:09:10Z", "author": {"login": "chamil321"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -23,29 +23,18 @@ public type CacheError distinct error;\n # Represents Cache related errors.\n public type Error CacheError;\n \n-# Prepare the `error` as a `cache:Error` after printing an error log.\n+# Prepare the `error` as a `cache:Error` after printing an log with provided log level.\n #\n # + message - Error message\n # + err - `error` instance\n+# + logLevel - Log level of the error message\n # + return - Prepared `Error` instance\n-function prepareError(string message, error? err = ()) returns Error {\n-    log:printError(message, err);\n-    Error cacheError;\n-    if (err is error) {\n-        cacheError = CacheError(message, err);\n-    } else {\n-        cacheError = CacheError(message);\n+function prepareError(string message, error? err = (), public string logLevel = \"ERROR\") returns Error {\n+    if (logLevel == \"ERROR\") {\n+        log:printError(message, err);\n+    } else if (logLevel == \"DEBUG\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "826844e013718dca27e94ed782a9f4b3e92fa82c"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "988b8d5aaa46c193076276888037bb73de8db93a", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/988b8d5aaa46c193076276888037bb73de8db93a", "committedDate": "2020-07-01T05:52:39Z", "message": "Fix cache error log level with constants"}, "afterCommit": {"oid": "eadc9bc3e8b4c0cc725d5ab3fb1435706ec63066", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eadc9bc3e8b4c0cc725d5ab3fb1435706ec63066", "committedDate": "2020-07-01T06:55:57Z", "message": "Fix cache error log level with constants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab5abed4bd4fdd6fb12b726e2058f0df1bb22bbb", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ab5abed4bd4fdd6fb12b726e2058f0df1bb22bbb", "committedDate": "2020-07-01T06:57:53Z", "message": "Fix cache error log level with constants"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eadc9bc3e8b4c0cc725d5ab3fb1435706ec63066", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eadc9bc3e8b4c0cc725d5ab3fb1435706ec63066", "committedDate": "2020-07-01T06:55:57Z", "message": "Fix cache error log level with constants"}, "afterCommit": {"oid": "ab5abed4bd4fdd6fb12b726e2058f0df1bb22bbb", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ab5abed4bd4fdd6fb12b726e2058f0df1bb22bbb", "committedDate": "2020-07-01T06:57:53Z", "message": "Fix cache error log level with constants"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwODA1ODI2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24478#pullrequestreview-440805826", "createdAt": "2020-07-01T12:03:47Z", "commit": {"oid": "ab5abed4bd4fdd6fb12b726e2058f0df1bb22bbb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4230, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}