{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4OTU5NTM4", "number": 22899, "title": "Add support for complex types as sql params", "bodyText": "Purpose\nAdd support for struct, ref cursor, xml, json. Add test for these types and for all supported types for mysql, h2 and hsql with SQL connector, jdbc2 and mysql connector.\nFixes #22682\nFixed #22416\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-04-25T19:37:55Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899", "merged": true, "mergeCommit": {"oid": "d0eb0b1c8cd1c9ab5b604cafa73080c0d3051d40"}, "closed": true, "closedAt": "2020-04-30T05:50:54Z", "author": {"login": "sinthuja"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYdwTIAH2gAyNDA4OTU5NTM4Ojk0ZTA0ZGY0YjMyOWM0YmEyODc2Y2QzZjVmOTM0YjA3YTdjNjM4YmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccZPGggH2gAyNDA4OTU5NTM4Ojk4Y2UwYzAxMDI5NWIwODExYjVhMjc1Mzk4YjFkZDBmZmEyNTA1OTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "94e04df4b329c4ba2876cd3f5f934b07a7c638bb", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/94e04df4b329c4ba2876cd3f5f934b07a7c638bb", "committedDate": "2020-04-17T09:20:16Z", "message": "Add missing complex types"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82645078fa58d5b316769b05b23455d8f9fade11", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/82645078fa58d5b316769b05b23455d8f9fade11", "committedDate": "2020-04-21T05:24:20Z", "message": "Merge branch 'upstream-master' into sql-connector-params-support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b06fb4cd44a8171b9dfe00424ccde884e160c335", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b06fb4cd44a8171b9dfe00424ccde884e160c335", "committedDate": "2020-04-22T18:09:23Z", "message": "Add ref, row and xml type support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e", "committedDate": "2020-04-25T19:34:20Z", "message": "Add test cases for jdbc2 and mysql connectors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11b1fc96010268e9ce933a0ea7419663642a7706", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/11b1fc96010268e9ce933a0ea7419663642a7706", "committedDate": "2020-04-25T19:40:16Z", "message": "Merge branch 'upstream-master' into sql-connector-params-support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODI2MTUy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#pullrequestreview-400826152", "createdAt": "2020-04-27T10:32:46Z", "commit": {"oid": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDozMjo0N1rOGMcO1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDozMjo0N1rOGMcO1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY5ODY0NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            function queryJdbcClient(string url, string user, string password,@untainted string|sql:ParameterizedString sqlQuery,\n          \n          \n            \n            function queryJdbcClient(string url, string user, string password, @untainted string|sql:ParameterizedString sqlQuery,", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#discussion_r415698645", "createdAt": "2020-04-27T10:32:47Z", "author": {"login": "daneshk"}, "path": "stdlib/database/jdbc2/src/test/resources/test-src/query/simple-params-query-test.bal", "diffHunk": "@@ -839,10 +900,11 @@ function getClobColumnChannel() returns @untainted io:ReadableCharacterChannel|e\n     return sourceChannel;\n }\n \n-function queryJdbcClient(string url, string user, string password,@untainted string|sql:ParameterizedString sqlQuery)\n+function queryJdbcClient(string url, string user, string password,@untainted string|sql:ParameterizedString sqlQuery,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e"}, "originalPosition": 627}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODU1ODEw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#pullrequestreview-400855810", "createdAt": "2020-04-27T11:18:38Z", "commit": {"oid": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMToxODozOFrOGMd7sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMToxODozOFrOGMd7sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcyNjUxNA==", "bodyText": "Is it possible to avoid setting an empty array for insertions, If insertions not required?\nMay be setting a default value", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#discussion_r415726514", "createdAt": "2020-04-27T11:18:38Z", "author": {"login": "daneshk"}, "path": "stdlib/database/mysql/src/test/resources/test-src/query/simple-params-query-test.bal", "diffHunk": "@@ -656,6 +710,80 @@ function queryTimestampStringInvalidParam() returns @tainted record {}|error? {\n     return queryMysqlClient(sqlQuery);\n }\n \n+function queryEnumStringParam() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT * from ENUMTable where enum_type=\", \"\"],\n+            insertions: [\"doctor\"]\n+     };\n+    return queryMysqlClient(sqlQuery);\n+}\n+\n+type EnumResult record {|\n+    int id;\n+    string enum_type;\n+|};\n+\n+function queryEnumStringParam2() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT * from ENUMTable where enum_type=\", \"\"],\n+            insertions: [\"doctor\"]\n+     };\n+    return queryMysqlClient(sqlQuery, resultType=EnumResult);\n+}\n+\n+function querySetStringParam() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT * from SetTable where set_type=\", \"\"],\n+            insertions: [\"a,d\"]\n+     };\n+    return queryMysqlClient(sqlQuery);\n+}\n+\n+function queryGeoParam() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT id, ST_AsText(geom) as geomText from GEOTable\"],\n+            insertions: []", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e"}, "originalPosition": 554}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15cd9cda73d99373af9a50e774f2ec41d5c63e34", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/15cd9cda73d99373af9a50e774f2ec41d5c63e34", "committedDate": "2020-04-27T11:27:52Z", "message": "Update stdlib/database/jdbc2/src/test/resources/test-src/query/simple-params-query-test.bal\n\nCo-Authored-By: Danesh Kuruppu <daneshk@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTgwNzk2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#pullrequestreview-400980796", "createdAt": "2020-04-27T14:00:44Z", "commit": {"oid": "15cd9cda73d99373af9a50e774f2ec41d5c63e34"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4356e33f1b6dc1d0659896ce74a37da882b6cc99", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4356e33f1b6dc1d0659896ce74a37da882b6cc99", "committedDate": "2020-04-28T14:10:19Z", "message": "Add some test cases for execute operation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "806a6b9d68e4e19f68022f181aeae8847fabd998", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/806a6b9d68e4e19f68022f181aeae8847fabd998", "committedDate": "2020-04-28T14:11:17Z", "message": "Merge branch 'upstream-master' into sql-connector-params-support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "960ed7507d76a526803f0ebcda60954b9f49d719", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/960ed7507d76a526803f0ebcda60954b9f49d719", "committedDate": "2020-04-28T14:33:54Z", "message": "Add formatting fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1743af08193b48ec27fd567011d6846c664dd31b", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1743af08193b48ec27fd567011d6846c664dd31b", "committedDate": "2020-04-28T14:36:16Z", "message": "Merge remote-tracking branch 'origin/sql-connector-params-support' into sql-connector-params-support\n\n# Conflicts:\n#\tstdlib/database/jdbc2/src/test/resources/test-src/query/simple-params-query-test.bal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6be498e9155d7c786566b88081084edca7a1fbf7", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6be498e9155d7c786566b88081084edca7a1fbf7", "committedDate": "2020-04-28T16:55:18Z", "message": "Merge branch 'upstream-master' into sql-connector-params-support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "148ac1255da89dd6c50d35c7cdde5d8ee78963d2", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/148ac1255da89dd6c50d35c7cdde5d8ee78963d2", "committedDate": "2020-04-28T17:26:06Z", "message": "Add formatting fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d870660a3ffeb78bedb87e6886095179b9aaaf5", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7d870660a3ffeb78bedb87e6886095179b9aaaf5", "committedDate": "2020-04-29T06:30:08Z", "message": "Merge branch 'sql-connector-params-support' into sql-params-execute\n\n# Conflicts:\n#\tstdlib/database/sql/src/test/resources/test-module/mock-sql/src/query/simple-params-query-test.bal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "654c3e1c45043219ff9a392c6d0c81551dbfa10c", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/654c3e1c45043219ff9a392c6d0c81551dbfa10c", "committedDate": "2020-04-29T13:10:11Z", "message": "Add test cases for sql connector regarding the execute operation with params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4560d4f90c09b6eca52ad3b92e92beacf1135399", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4560d4f90c09b6eca52ad3b92e92beacf1135399", "committedDate": "2020-04-29T13:40:25Z", "message": "Add jdbc test cases for jdbc connector regarding the execute operation with params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98ce0c010295b0811b5a275398b1dd0ffa250592", "author": {"user": {"login": "sinthuja", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/98ce0c010295b0811b5a275398b1dd0ffa250592", "committedDate": "2020-04-29T14:20:05Z", "message": "Add mysql test cases"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3470, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}