{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwODUxOTAw", "number": 27291, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMDowN1rOE_hRcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMTo1MFrOE_hUmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MDQwODgyOnYy", "diffSide": "RIGHT", "path": "stdlib/cache/src/main/ballerina/src/cache/linked_list.bal", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMDowN1rOH9RB3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMDowN1rOH9RB3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAwNDE4OQ==", "bodyText": "We need to have tryLock() here instead of having it in removeLast function.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27291#discussion_r534004189", "createdAt": "2020-12-02T09:10:07Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/linked_list.bal", "diffHunk": "@@ -43,77 +43,94 @@ public type LinkedList object {\n     #\n     # + node - The node, which should be added to the provided linked list\n     public function addLast(Node node) {\n-        if (self.tail is ()) {\n-            self.head = node;\n-            self.tail = self.head;\n-            return;\n+        if (tryLock()) {\n+            if (self.tail is ()) {\n+                self.head = node;\n+                self.tail = self.head;\n+                releaseLock();\n+                return;\n+            }\n+            Node tempNode = node;\n+            Node tailNode = <Node>self.tail;\n+            tempNode.prev = tailNode;\n+            tailNode.next = tempNode;\n+            self.tail = tempNode;\n+            releaseLock();\n         }\n-        Node tempNode = node;\n-        Node tailNode = <Node>self.tail;\n-        tempNode.prev = tailNode;\n-        tailNode.next = tempNode;\n-        self.tail = tempNode;\n     }\n \n     # Adds a node to the start of the provided linked list.\n     #\n     # + node - The node, which should be added to the provided linked list\n     public function addFirst(Node node) {\n-        if (self.head is ()) {\n-            self.head = node;\n-            self.tail = self.head;\n-            return;\n+        if (tryLock()) {\n+            if (self.head is ()) {\n+                self.head = node;\n+                self.tail = self.head;\n+                releaseLock();\n+                return;\n+            }\n+            Node tempNode = node;\n+            Node headNode = <Node>self.head;\n+            tempNode.next = headNode;\n+            headNode.prev = tempNode;\n+            self.head = tempNode;\n+            releaseLock();\n         }\n-        Node tempNode = node;\n-        Node headNode = <Node>self.head;\n-        tempNode.next = headNode;\n-        headNode.prev = tempNode;\n-        self.head = tempNode;\n     }\n \n     # Removes a node from the provided linked list.\n     #\n     # + node - The node, which should be removed from the provided linked list\n     public function remove(Node node) {\n-        if (tryLock()) {\n-            if (node.prev is ()) {\n-                self.head = node.next;\n-            } else {\n-                Node prev = <Node>node.prev;\n-                prev.next = node.next;\n-            }\n-            if (node.next is ()) {\n-                self.tail = node.prev;\n-            } else {\n-                Node next = <Node>node.next;\n-                next.prev = node.prev;\n-            }\n-            node.next = ();\n-            node.prev = ();\n-            releaseLock();\n+        if (node.prev is ()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "001747315f1c2f6abad8cba1b51ac3bb4bf505ed"}, "originalPosition": 78}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MDQxMzI5OnYy", "diffSide": "RIGHT", "path": "stdlib/cache/src/main/ballerina/src/cache/lru_eviction_policy.bal", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMDo1OVrOH9REXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMDo1OVrOH9REXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAwNDgzMQ==", "bodyText": "This shouldn't be changed. This should be kept as it is. Applies to following 2 changes as well.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27291#discussion_r534004831", "createdAt": "2020-12-02T09:10:59Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/lru_eviction_policy.bal", "diffHunk": "@@ -30,7 +30,7 @@ public type LruEvictionPolicy object {\n     #\n     # + node - Node of the linked list, which is retrieved\n     public function get(Node node) {\n-        self.linkedList.remove(node);\n+        var output = self.linkedList.removeLast(node);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "001747315f1c2f6abad8cba1b51ac3bb4bf505ed"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MDQxNjkxOnYy", "diffSide": "RIGHT", "path": "stdlib/cache/src/main/ballerina/src/cache/linked_list.bal", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMTo1MFrOH9RGeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwOToxMTo1MFrOH9RGeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAwNTM2OQ==", "bodyText": "We don't need to tryLock() here. We need to call remove function inside of this function.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27291#discussion_r534005369", "createdAt": "2020-12-02T09:11:50Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/linked_list.bal", "diffHunk": "@@ -43,77 +43,94 @@ public type LinkedList object {\n     #\n     # + node - The node, which should be added to the provided linked list\n     public function addLast(Node node) {\n-        if (self.tail is ()) {\n-            self.head = node;\n-            self.tail = self.head;\n-            return;\n+        if (tryLock()) {\n+            if (self.tail is ()) {\n+                self.head = node;\n+                self.tail = self.head;\n+                releaseLock();\n+                return;\n+            }\n+            Node tempNode = node;\n+            Node tailNode = <Node>self.tail;\n+            tempNode.prev = tailNode;\n+            tailNode.next = tempNode;\n+            self.tail = tempNode;\n+            releaseLock();\n         }\n-        Node tempNode = node;\n-        Node tailNode = <Node>self.tail;\n-        tempNode.prev = tailNode;\n-        tailNode.next = tempNode;\n-        self.tail = tempNode;\n     }\n \n     # Adds a node to the start of the provided linked list.\n     #\n     # + node - The node, which should be added to the provided linked list\n     public function addFirst(Node node) {\n-        if (self.head is ()) {\n-            self.head = node;\n-            self.tail = self.head;\n-            return;\n+        if (tryLock()) {\n+            if (self.head is ()) {\n+                self.head = node;\n+                self.tail = self.head;\n+                releaseLock();\n+                return;\n+            }\n+            Node tempNode = node;\n+            Node headNode = <Node>self.head;\n+            tempNode.next = headNode;\n+            headNode.prev = tempNode;\n+            self.head = tempNode;\n+            releaseLock();\n         }\n-        Node tempNode = node;\n-        Node headNode = <Node>self.head;\n-        tempNode.next = headNode;\n-        headNode.prev = tempNode;\n-        self.head = tempNode;\n     }\n \n     # Removes a node from the provided linked list.\n     #\n     # + node - The node, which should be removed from the provided linked list\n     public function remove(Node node) {\n-        if (tryLock()) {\n-            if (node.prev is ()) {\n-                self.head = node.next;\n-            } else {\n-                Node prev = <Node>node.prev;\n-                prev.next = node.next;\n-            }\n-            if (node.next is ()) {\n-                self.tail = node.prev;\n-            } else {\n-                Node next = <Node>node.next;\n-                next.prev = node.prev;\n-            }\n-            node.next = ();\n-            node.prev = ();\n-            releaseLock();\n+        if (node.prev is ()) {\n+            self.head = node.next;\n+        } else {\n+            Node prev = <Node>node.prev;\n+            prev.next = node.next;\n+        }\n+        if (node.next is ()) {\n+            self.tail = node.prev;\n+        } else {\n+            Node next = <Node>node.next;\n+            next.prev = node.prev;\n         }\n+        node.next = ();\n+        node.prev = ();\n     }\n \n     # Removes the last node from the provided linked list.\n     #\n+    # + node - The node, which should be removed from the provided linked list\n     # + return - Last node of the provided linked list or `()` if the last node is empty\n-    public function removeLast() returns Node? {\n-        if (self.tail is ()) {\n-            return ();\n+    public function removeLast(Node? node = ()) returns Node? {\n+        if (tryLock()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "001747315f1c2f6abad8cba1b51ac3bb4bf505ed"}, "originalPosition": 102}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2833, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}