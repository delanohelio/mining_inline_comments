{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNTIzMzUw", "number": 23829, "title": "Add annotation validation to typeconversion expr", "bodyText": "Purpose\n$subject\nFixes #23548\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-06-09T04:10:03Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829", "merged": true, "mergeCommit": {"oid": "346892a5e665969f188ebfd273a337e90586e4ae"}, "closed": true, "closedAt": "2020-06-10T14:51:06Z", "author": {"login": "rdhananjaya"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpd-zGgFqTQyNjc5MzE4MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp6z2HAFqTQyODEzMzE0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzkzMTgw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#pullrequestreview-426793180", "createdAt": "2020-06-09T05:12:49Z", "commit": {"oid": "3874dacb47e020ea5a2d110eb549a63ea2a4cde2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNToxMjo0OVrOGg4_1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNToxMjo0OVrOGg4_1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE0MTQ2Mw==", "bodyText": "I'm not sure if this belongs here. Why are we moving this from SemanticAnalyzer, given that BLangAnnotationAttachment itself is not an expression, and only the expr part is?\nWe already seem to be doing the relevant semantic/constant analyzer based analysis in SemanticAnalyzer, and only seem to be calling into TypeChecker for the expression https://github.com/ballerina-platform/ballerina-lang/pull/23829/files#diff-7123076514bbb67aa85076709d29ee0fL2880.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#discussion_r437141463", "createdAt": "2020-06-09T05:12:49Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -3224,10 +3229,113 @@ public void visit(BLangUnaryExpr unaryExpr) {\n         resultType = types.checkType(unaryExpr, actualType, expType);\n     }\n \n+    public void visit(BLangAnnotationAttachment annAttachmentNode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3874dacb47e020ea5a2d110eb549a63ea2a4cde2"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba2f9551893ed385c5896debff9d4f1e253f10f2", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ba2f9551893ed385c5896debff9d4f1e253f10f2", "committedDate": "2020-06-09T11:48:23Z", "message": "Validate annotations within typeconversion expr"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3874dacb47e020ea5a2d110eb549a63ea2a4cde2", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3874dacb47e020ea5a2d110eb549a63ea2a4cde2", "committedDate": "2020-06-09T04:05:50Z", "message": "Add unit test for annotation in type-conv expr"}, "afterCommit": {"oid": "31523c5d2a23c2cc17612ba6d456259be7deb641", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/31523c5d2a23c2cc17612ba6d456259be7deb641", "committedDate": "2020-06-09T11:48:23Z", "message": "Add unit test for annotation in type-conv expr"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53b98ed5318a66ebef43dd944bbabe325e703bd9", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/53b98ed5318a66ebef43dd944bbabe325e703bd9", "committedDate": "2020-06-09T12:35:32Z", "message": "Add unit test for annotation in type-conv expr"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31523c5d2a23c2cc17612ba6d456259be7deb641", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/31523c5d2a23c2cc17612ba6d456259be7deb641", "committedDate": "2020-06-09T11:48:23Z", "message": "Add unit test for annotation in type-conv expr"}, "afterCommit": {"oid": "53b98ed5318a66ebef43dd944bbabe325e703bd9", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/53b98ed5318a66ebef43dd944bbabe325e703bd9", "committedDate": "2020-06-09T12:35:32Z", "message": "Add unit test for annotation in type-conv expr"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a45815e7fdb08c9339f78e9ce9ca9fcb7d122997", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a45815e7fdb08c9339f78e9ce9ca9fcb7d122997", "committedDate": "2020-06-09T16:34:19Z", "message": "Fix syntax error in websub module"}, "afterCommit": {"oid": "9463a59cdb67ba5e206aedbf4c913d4d5a2f5fb3", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9463a59cdb67ba5e206aedbf4c913d4d5a2f5fb3", "committedDate": "2020-06-09T16:59:48Z", "message": "Fix syntax error in websub module"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9463a59cdb67ba5e206aedbf4c913d4d5a2f5fb3", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9463a59cdb67ba5e206aedbf4c913d4d5a2f5fb3", "committedDate": "2020-06-09T16:59:48Z", "message": "Fix syntax error in websub module"}, "afterCommit": {"oid": "d124b96fe7d8c5a64fe6caa89cd97e321af1a745", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d124b96fe7d8c5a64fe6caa89cd97e321af1a745", "committedDate": "2020-06-10T03:51:18Z", "message": "Fix syntax error in stdlib modules"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d124b96fe7d8c5a64fe6caa89cd97e321af1a745", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d124b96fe7d8c5a64fe6caa89cd97e321af1a745", "committedDate": "2020-06-10T03:51:18Z", "message": "Fix syntax error in stdlib modules"}, "afterCommit": {"oid": "487f91f4a658e2e9faf504ec6a982056924c022d", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/487f91f4a658e2e9faf504ec6a982056924c022d", "committedDate": "2020-06-10T06:08:33Z", "message": "Fix syntax error in stdlib modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f", "committedDate": "2020-06-10T06:58:02Z", "message": "Fix syntax error in stdlib modules"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "487f91f4a658e2e9faf504ec6a982056924c022d", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/487f91f4a658e2e9faf504ec6a982056924c022d", "committedDate": "2020-06-10T06:08:33Z", "message": "Fix syntax error in stdlib modules"}, "afterCommit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f", "committedDate": "2020-06-10T06:58:02Z", "message": "Fix syntax error in stdlib modules"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NzkyMDQ0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#pullrequestreview-427792044", "createdAt": "2020-06-10T07:43:51Z", "commit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0Mzo1MlrOGhoy2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0Mzo1MlrOGhoy2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkyNDU3MQ==", "bodyText": "Unused?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#discussion_r437924571", "createdAt": "2020-06-10T07:43:52Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -6478,6 +6485,19 @@ private void logUndefinedSymbolError(DiagnosticPos pos, String name) {\n         }\n     }\n \n+    public void checkAnnot(BLangAnnotationAttachment annAttachmentNode, SymbolEnv env) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NzkyMjIy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#pullrequestreview-427792222", "createdAt": "2020-06-10T07:44:08Z", "commit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0NDowOFrOGhozWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0NDowOFrOGhozWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkyNDY5OQ==", "bodyText": "Do we need this change?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#discussion_r437924699", "createdAt": "2020-06-10T07:44:08Z", "author": {"login": "MaryamZi"}, "path": "misc/testerina/modules/report-tools/package.json", "diffHunk": "@@ -1,6 +1,6 @@\n {\n     \"name\": \"@ballerina/testerina-report\",\n-    \"version\": \"2.0.0-Preview1-M3\",\n+    \"version\": \"2.0.0-SNAPSHOT\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3Nzk0NTQz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#pullrequestreview-427794543", "createdAt": "2020-06-10T07:47:20Z", "commit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0NzoyMFrOGho6kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwNzo0NzoyMFrOGho6kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkyNjU0Ng==", "bodyText": "Shouldn't this fail?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    var resultSentToInitClient = caller->respond(<@untaianted> response);\n          \n          \n            \n                    var resultSentToInitClient = caller->respond(<@untainted> response);", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#discussion_r437926546", "createdAt": "2020-06-10T07:47:20Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-integration-test/src/test/resources/http2/src/http2services/10_http_2.0_forwarded_header.bal", "diffHunk": "@@ -37,6 +37,6 @@ service forwardedBackend on new http:Listener(9106, {httpVersion: \"2.0\"}) {\n         http:Response response = new();\n         response.setHeader(\"forwarded\", header);\n         response.setPayload(\"forward is working\");\n-        var resultSentToInitClient = caller->respond(<@untianted> response);\n+        var resultSentToInitClient = caller->respond(<@untaianted> response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c19f1cb12777db9a2e97dfd1cb14a6a62aeb5d7f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e62edb24c32010140b49b379b67d36606233f09c", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e62edb24c32010140b49b379b67d36606233f09c", "committedDate": "2020-06-10T07:58:33Z", "message": "Apply reivew suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODE4MjEz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#pullrequestreview-427818213", "createdAt": "2020-06-10T08:16:54Z", "commit": {"oid": "e62edb24c32010140b49b379b67d36606233f09c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODoxNjo1NFrOGhp_MQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODoxNjo1NFrOGhp_MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk0NDExMw==", "bodyText": "This will allow using <@tainted> too right? I hope that's intentional? Do we have tests for that flow?\nSomething like\npublic function main() {\n    int x = 1;\n    foo(<@tainted> x);\n}\n\nfunction foo(@untainted int i) {\n    \n}", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#discussion_r437944113", "createdAt": "2020-06-10T08:16:54Z", "author": {"login": "MaryamZi"}, "path": "langlib/lang.annotations/src/main/ballerina/src/lang.annotations/annotations.bal", "diffHunk": "@@ -15,7 +15,7 @@\n // under the License.\n \n # Denote that the return value is tainted.\n-public const annotation tainted on parameter, return, source listener, source var;\n+public const annotation tainted on parameter, return, source listener, source var, source type;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e62edb24c32010140b49b379b67d36606233f09c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3bb4814852c6a2c1c9cfb44dfde495b44fa1ced", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e3bb4814852c6a2c1c9cfb44dfde495b44fa1ced", "committedDate": "2020-06-10T11:17:48Z", "message": "Add test case for <@taint>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MTMzMTQ5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23829#pullrequestreview-428133149", "createdAt": "2020-06-10T14:48:06Z", "commit": {"oid": "e3bb4814852c6a2c1c9cfb44dfde495b44fa1ced"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4433, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}