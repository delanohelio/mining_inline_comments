{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyMDgzOTU0", "number": 20581, "title": "Add support reading array of values via config API", "bodyText": "Fixes #10633\nPurpose\n\n$title\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-01-13T12:08:10Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581", "merged": true, "mergeCommit": {"oid": "9b3139a5f3becce53a95d7a145a93567f0a4ed32"}, "closed": true, "closedAt": "2020-01-20T08:07:15Z", "author": {"login": "aashikam"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6AgMXAFqTM0MjA0MTE4OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8GdRHgH2gAyMzYyMDgzOTU0OjllNjAzZDEzMzEyNWEzOWE2NWIzM2U0NTlmYWRmYTFiMzdjMzE0MTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMDQxMTg5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-342041189", "createdAt": "2020-01-13T18:17:42Z", "commit": {"oid": "101ce540437e05b7a65ec93f90b87e9a49fe9261"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxODoxNzo0MlrOFdAAfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxODoxNzo0MlrOFdAAfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk1MzE1MQ==", "bodyText": "Shall we refrain from placing \"array\" within quotes? The other types were quoted because those are actual types + keywords.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#discussion_r365953151", "createdAt": "2020-01-13T18:17:42Z", "author": {"login": "pubudu91"}, "path": "bvm/ballerina-config/src/main/java/org/ballerinalang/config/ConfigRegistry.java", "diffHunk": "@@ -330,6 +331,34 @@ public double getAsFloat(String sectionHeader, String field) {\n         return getAsMap(getConfigKey(sectionHeader, field));\n     }\n \n+    /**\n+     * Retrieves the config value specified by the key as a List.\n+     *\n+     * @param key The key of the config entry\n+     * @return The associated config value\n+     */\n+    public List getAsArray(String key) {\n+        if (key == null) {\n+            return null;\n+        }\n+        Object value = configEntries.get(key);\n+        if (value instanceof List) {\n+            return (List) value;\n+        }\n+        throw new IllegalArgumentException(\"config key '\" + key + \"' does not map to a valid 'array'\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "101ce540437e05b7a65ec93f90b87e9a49fe9261"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMDQyMDg0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-342042084", "createdAt": "2020-01-13T18:19:12Z", "commit": {"oid": "101ce540437e05b7a65ec93f90b87e9a49fe9261"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxODoxOToxMlrOFdADDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxODoxOToxMlrOFdADDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk1MzgwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    error err = error(\"Invalid value. Expected a 'any[]'.\");\n          \n          \n            \n                    error err = error(\"Invalid value. Expected an 'any[]'.\");", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#discussion_r365953806", "createdAt": "2020-01-13T18:19:12Z", "author": {"login": "pubudu91"}, "path": "stdlib/config-api/src/main/ballerina/src/config/config.bal", "diffHunk": "@@ -149,6 +149,21 @@ public function getAsMap(@untainted string key) returns map<any> {\n     }\n }\n \n+// TODO: If there is no mapping?\n+# Retrieves the specified configuration value as an array. If there is no mapping, an empty array will be returned.\n+#\n+# + key - The configuration to be retrieved\n+# + return - Configuration value mapped by the key\n+public function getAsArray(@untainted string key) returns any[] {\n+    var value = get(key, ARRAY);\n+    if (value is any[]) {\n+        return value;\n+    } else {\n+        error err = error(\"Invalid value. Expected a 'any[]'.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "101ce540437e05b7a65ec93f90b87e9a49fe9261"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "101ce540437e05b7a65ec93f90b87e9a49fe9261", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/101ce540437e05b7a65ec93f90b87e9a49fe9261", "committedDate": "2020-01-13T12:06:08Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}, "afterCommit": {"oid": "3c293bd3ca7f13544709fba6d3a4a1b0287cf927", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3c293bd3ca7f13544709fba6d3a4a1b0287cf927", "committedDate": "2020-01-14T08:44:51Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3c293bd3ca7f13544709fba6d3a4a1b0287cf927", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3c293bd3ca7f13544709fba6d3a4a1b0287cf927", "committedDate": "2020-01-14T08:44:51Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}, "afterCommit": {"oid": "bba74d637f94a098cec22277d543637c6d7c47e4", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bba74d637f94a098cec22277d543637c6d7c47e4", "committedDate": "2020-01-14T09:13:09Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyNDA1NDY5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-342405469", "createdAt": "2020-01-14T09:51:57Z", "commit": {"oid": "bba74d637f94a098cec22277d543637c6d7c47e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwOTo1MTo1N1rOFdRnWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwOTo1MTo1N1rOFdRnWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI0MTYyNg==", "bodyText": "Is there any way to improve this message like 'Expect 1111 got 2222' format?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#discussion_r366241626", "createdAt": "2020-01-14T09:51:57Z", "author": {"login": "wggihan"}, "path": "stdlib/config-api/src/main/ballerina/src/config/config.bal", "diffHunk": "@@ -149,6 +149,20 @@ public function getAsMap(@untainted string key) returns map<any> {\n     }\n }\n \n+# Retrieves the specified configuration value as an array. If there is no mapping, an empty array will be returned.\n+#\n+# + key - The configuration to be retrieved\n+# + return - Configuration value mapped by the key\n+public function getAsArray(@untainted string key) returns any[] {\n+    var value = get(key, ARRAY);\n+    if (value is any[]) {\n+        return value;\n+    } else {\n+        error err = error(\"Invalid value. Expected an 'any[]'.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bba74d637f94a098cec22277d543637c6d7c47e4"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfe64f26f67f04607d8e81afbdc74e6e724202d4", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dfe64f26f67f04607d8e81afbdc74e6e724202d4", "committedDate": "2020-01-16T06:04:50Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bba74d637f94a098cec22277d543637c6d7c47e4", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bba74d637f94a098cec22277d543637c6d7c47e4", "committedDate": "2020-01-14T09:13:09Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}, "afterCommit": {"oid": "dfe64f26f67f04607d8e81afbdc74e6e724202d4", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dfe64f26f67f04607d8e81afbdc74e6e724202d4", "committedDate": "2020-01-16T06:04:50Z", "message": "Add support reading array of values via config API\n\nFixes https://github.com/ballerina-platform/ballerina-lang/issues/10633"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a43902b2a1ac3dd03f60f06cfbc1ff574c1a6a7", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7a43902b2a1ac3dd03f60f06cfbc1ff574c1a6a7", "committedDate": "2020-01-16T06:54:41Z", "message": "Fix test failures"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNzIzODM0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-343723834", "createdAt": "2020-01-16T07:51:45Z", "commit": {"oid": "7a43902b2a1ac3dd03f60f06cfbc1ff574c1a6a7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fee5535d3654f0577169c2a81c258935503c0fa3", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fee5535d3654f0577169c2a81c258935503c0fa3", "committedDate": "2020-01-17T04:21:52Z", "message": "Merge branch 'ballerina-1.1.x' of https://github.com/ballerina-platform/ballerina-lang into config-api"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDM5ODky", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-344439892", "createdAt": "2020-01-17T09:02:33Z", "commit": {"oid": "fee5535d3654f0577169c2a81c258935503c0fa3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwOTowMjozM1rOFeyiLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwOTowMjozM1rOFeyiLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyOTU0OA==", "bodyText": "On second thoughts, shall we make this anydata[] instead of any[]? I just tested this and with an any[], you can't really do anything useful easily; you have to cast each of the array element to its required type. With anydata[], you can do the following:\nimport ballerina/config;\nimport ballerina/io;\n\npublic function main() {\n\tint[]|error ports = int[].constructFrom(config:getAsArray(\"ports\"));\n\tif (ports is int[]) {\n\t\tio:println(ports); \n\t}\n}", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#discussion_r367829548", "createdAt": "2020-01-17T09:02:33Z", "author": {"login": "pubudu91"}, "path": "stdlib/config-api/src/main/ballerina/src/config/config.bal", "diffHunk": "@@ -149,6 +149,14 @@ public function getAsMap(@untainted string key) returns map<any> {\n     }\n }\n \n+# Retrieves the specified configuration value as an array. If there is no mapping, an empty array will be returned.\n+#\n+# + key - The configuration to be retrieved\n+# + return - Configuration value mapped by the key\n+public function getAsArray(@untainted string key) returns any[] {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fee5535d3654f0577169c2a81c258935503c0fa3"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91dce9a970344c437ca6058e10f25ba7641179a2", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/91dce9a970344c437ca6058e10f25ba7641179a2", "committedDate": "2020-01-17T09:22:13Z", "message": "Add changes from code review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NTE5ODQz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-344519843", "createdAt": "2020-01-17T11:29:38Z", "commit": {"oid": "91dce9a970344c437ca6058e10f25ba7641179a2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3953d1ce151070483a82ede299cb501c45a9d2a", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e3953d1ce151070483a82ede299cb501c45a9d2a", "committedDate": "2020-01-17T12:12:23Z", "message": "Add more tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "711809c4c0cc1346e58e06987bd47f3ac488a729", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/711809c4c0cc1346e58e06987bd47f3ac488a729", "committedDate": "2020-01-17T12:05:54Z", "message": "Add more tests"}, "afterCommit": {"oid": "e3953d1ce151070483a82ede299cb501c45a9d2a", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e3953d1ce151070483a82ede299cb501c45a9d2a", "committedDate": "2020-01-17T12:12:23Z", "message": "Add more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd22b650ba860c9bd3bec154f3c1d97928af0029", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fd22b650ba860c9bd3bec154f3c1d97928af0029", "committedDate": "2020-01-20T01:17:25Z", "message": "Merge branch 'ballerina-1.1.x' of https://github.com/ballerina-platform/ballerina-lang into config-api"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDkzMTI2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20581#pullrequestreview-345093126", "createdAt": "2020-01-20T06:04:21Z", "commit": {"oid": "fd22b650ba860c9bd3bec154f3c1d97928af0029"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e603d133125a39a65b33e459fadfa1b37c31416", "author": {"user": {"login": "aashikam", "name": "Arshika Mohottige"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9e603d133125a39a65b33e459fadfa1b37c31416", "committedDate": "2020-01-20T06:21:47Z", "message": "Fix test failures"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4468, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}