{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MDQ1Mzgx", "number": 26703, "title": "Add support for Class symbols", "bodyText": "Purpose\nThis PR adds a separate symbol for classes.\nFix #26265\nFix #26071\nFix #26251\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-11-02T13:05:16Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703", "merged": true, "mergeCommit": {"oid": "82a50851e7a28d34254c604a7b3c231392358540"}, "closed": true, "closedAt": "2020-11-05T11:13:04Z", "author": {"login": "pubudu91"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYkaSngBqjM5NDgwNDc1NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZgb_wgFqTUyNDE1NzIwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ded81559d2125fcf67cb440c53551006349b91fe", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ded81559d2125fcf67cb440c53551006349b91fe", "committedDate": "2020-11-02T13:03:33Z", "message": "Remove initMethod() from object type"}, "afterCommit": {"oid": "549ad49353ca295f37afe5705eecea5f0089198b", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/549ad49353ca295f37afe5705eecea5f0089198b", "committedDate": "2020-11-02T13:16:26Z", "message": "Remove initMethod() from object type"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17d2159ed879e6018cea6a70ddefe5801f704fee", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/17d2159ed879e6018cea6a70ddefe5801f704fee", "committedDate": "2020-11-03T09:09:55Z", "message": "Modify lang server to use new class symbols"}, "afterCommit": {"oid": "ef4e621c614b6001ac578e04debc8fe70d764e69", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ef4e621c614b6001ac578e04debc8fe70d764e69", "committedDate": "2020-11-03T12:46:09Z", "message": "Add test cases for class symbols"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMDEwMjMz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#pullrequestreview-523010233", "createdAt": "2020-11-04T02:50:20Z", "commit": {"oid": "77d182f244c5d6a0ed2d26935f121de16ef20b86"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwMjo1MDoyMFrOHtHZDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwMjo1ODo1NlrOHtHhQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA2OTA3MQ==", "bodyText": "Shall we minimize the two returns to a single return statement?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#discussion_r517069071", "createdAt": "2020-11-04T02:50:20Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/io/ballerina/compiler/api/impl/types/BallerinaFieldSymbol.java", "diffHunk": "@@ -71,7 +73,12 @@ public boolean hasDefaultValue() {\n      */\n     @Override\n     public TypeSymbol typeDescriptor() {\n-        return TypesFactory.getTypeDescriptor(this.bField.getType());\n+        if (this.typeDescriptor != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77d182f244c5d6a0ed2d26935f121de16ef20b86"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA3MTE3MQ==", "bodyText": "Shall we merge this with the wrapping if condition?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#discussion_r517071171", "createdAt": "2020-11-04T02:58:56Z", "author": {"login": "nadeeshaan"}, "path": "language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/completions/builder/FunctionCompletionItemBuilder.java", "diffHunk": "@@ -94,7 +96,12 @@ public static CompletionItem build(FunctionSymbol functionSymbol, LSContext cont\n     }\n \n     public static CompletionItem build(ObjectTypeSymbol typeDesc, InitializerBuildMode mode, LSContext ctx) {\n-        MethodSymbol initMethod = typeDesc.initMethod().isEmpty() ? null : typeDesc.initMethod().get();\n+        MethodSymbol initMethod = null;\n+        if (typeDesc.kind() == SymbolKind.CLASS) {\n+            ClassSymbol classSymbol = (ClassSymbol) typeDesc;\n+            initMethod = classSymbol.initMethod().isPresent() ? classSymbol.initMethod().get() : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77d182f244c5d6a0ed2d26935f121de16ef20b86"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMDE3Mzcw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#pullrequestreview-523017370", "createdAt": "2020-11-04T03:14:29Z", "commit": {"oid": "77d182f244c5d6a0ed2d26935f121de16ef20b86"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwMzoxNDoyOVrOHtHwNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjoxNjo1NVrOHtKWqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA3NDk5Ng==", "bodyText": "Should this be a part of the SymbolFinder?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#discussion_r517074996", "createdAt": "2020-11-04T03:14:29Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-lang/src/main/java/io/ballerina/compiler/api/impl/BallerinaSemanticModel.java", "diffHunk": "@@ -111,7 +115,14 @@ public BallerinaSemanticModel(BLangPackage bLangPackage, CompilerContext context\n             return Optional.empty();\n         }\n \n+        if (isTypeSymbol(symbolAtCursor) && !PositionUtil.withinBlock(position, symbolAtCursor.pos)) {\n+            ModuleID moduleID = new BallerinaModuleID(symbolAtCursor.pkgID);\n+            return Optional.of(new BallerinaTypeReferenceTypeSymbol(moduleID, symbolAtCursor.type,\n+                                                                    symbolAtCursor.getName().getValue()));\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77d182f244c5d6a0ed2d26935f121de16ef20b86"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzExNzYxMQ==", "bodyText": "Missing eof", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#discussion_r517117611", "createdAt": "2020-11-04T06:16:55Z", "author": {"login": "SupunS"}, "path": "tests/ballerina-compiler-api-test/src/test/resources/test-src/class_symbols_test.bal", "diffHunk": "@@ -0,0 +1,44 @@\n+// Copyright (c) 2020 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+//\n+// WSO2 Inc. licenses this file to you under the Apache License,\n+// Version 2.0 (the \"License\"); you may not use this file except\n+// in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+class Person1 {\n+    string fname;\n+    string lname;\n+\n+    public function init(string fname, string lname) {\n+        self.fname = fname;\n+        self.lname = lname;\n+    }\n+\n+    public function getFullName() returns string {\n+        return self.fname + \" \" + self.lname;\n+    }\n+}\n+\n+class Person2 {\n+    string fname = \"John\";\n+    string lname = \"Doe\";\n+\n+    public function getFullName() returns string {\n+        return self.fname + \" \" + self.lname;\n+    }\n+}\n+\n+function test() {\n+    Person1 p1 = new(\"Pubudu\", \"Fernando\");\n+    Person2 p2 = new;\n+    p2 = new Person2();\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc0f7ad7f69f247850f52045ff7161a81e26a86e"}, "originalPosition": 44}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc0f7ad7f69f247850f52045ff7161a81e26a86e", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fc0f7ad7f69f247850f52045ff7161a81e26a86e", "committedDate": "2020-11-04T05:27:44Z", "message": "Address review suggestions"}, "afterCommit": {"oid": "33cf44f48f36dcc75a2d85d70a1cb41966f8adbd", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/33cf44f48f36dcc75a2d85d70a1cb41966f8adbd", "committedDate": "2020-11-04T07:09:29Z", "message": "Address review suggestions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33cf44f48f36dcc75a2d85d70a1cb41966f8adbd", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/33cf44f48f36dcc75a2d85d70a1cb41966f8adbd", "committedDate": "2020-11-04T07:09:29Z", "message": "Address review suggestions"}, "afterCommit": {"oid": "81b20c67088bfee4aed24f8bb95914c8ebdbb219", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/81b20c67088bfee4aed24f8bb95914c8ebdbb219", "committedDate": "2020-11-04T12:30:16Z", "message": "Resolve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58b72974ffa2a5e6897af4a7823c8feb757fde44", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/58b72974ffa2a5e6897af4a7823c8feb757fde44", "committedDate": "2020-11-05T09:13:48Z", "message": "Introduce class symbols for classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7fd792d683e3bc22a352859268158518d7e8667", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d7fd792d683e3bc22a352859268158518d7e8667", "committedDate": "2020-11-05T09:14:46Z", "message": "Remove initMethod() from object type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dc876c5a8d4d573cef3251ae07bba2e1317ea8b", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9dc876c5a8d4d573cef3251ae07bba2e1317ea8b", "committedDate": "2020-11-05T09:14:46Z", "message": "Fix initMethod() usages in lang server"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3535efe0cd55b3f51431ae68639aee5256d32067", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3535efe0cd55b3f51431ae68639aee5256d32067", "committedDate": "2020-11-05T09:14:46Z", "message": "Add an API to get classes from module symbol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a841096d5810fc4f23e6ab06b137faecb977c03", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9a841096d5810fc4f23e6ab06b137faecb977c03", "committedDate": "2020-11-05T09:14:47Z", "message": "Create class type symbols for classes when coming from BIR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee99f499b449980155f9aa2b0b90bc697294bbfc", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ee99f499b449980155f9aa2b0b90bc697294bbfc", "committedDate": "2020-11-05T09:14:47Z", "message": "Set origin of classes of services to VIRTUAL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4b4fe3de70411762bc3bbcb7e5a1549f8530bd1", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c4b4fe3de70411762bc3bbcb7e5a1549f8530bd1", "committedDate": "2020-11-05T09:14:47Z", "message": "Fix completions for type init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e0f732f43de1b7108273d19a615b2a0ea823b24", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2e0f732f43de1b7108273d19a615b2a0ea823b24", "committedDate": "2020-11-05T09:17:50Z", "message": "Avoid setting ref type in class symbol's type desc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18cd7a54a01b60b6e3a226c7eeb39b8759abe9cb", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/18cd7a54a01b60b6e3a226c7eeb39b8759abe9cb", "committedDate": "2020-11-05T09:17:51Z", "message": "Print the shape for anon types"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "173bf3070b86ee218fc85da51942bafa1fd59684", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/173bf3070b86ee218fc85da51942bafa1fd59684", "committedDate": "2020-11-05T09:17:51Z", "message": "Change new expr ctx tests to use classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "427f3c3abc9850044e66dd6c3d69ad34bb450dbb", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/427f3c3abc9850044e66dd6c3d69ad34bb450dbb", "committedDate": "2020-11-05T09:17:51Z", "message": "Modify lang server to use new class symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0ea46b0ef0de5ba4ee7974ba62516069d035009", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b0ea46b0ef0de5ba4ee7974ba62516069d035009", "committedDate": "2020-11-05T09:25:57Z", "message": "Extend field symbol from Symbol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3502d8f2b33fb96e9f07061d7c27d3733894e842", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3502d8f2b33fb96e9f07061d7c27d3733894e842", "committedDate": "2020-11-05T09:27:09Z", "message": "Return a type reference symbol for type references"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b19d00c383a13228b9e6a2a9bcc59946a5c92cc", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b19d00c383a13228b9e6a2a9bcc59946a5c92cc", "committedDate": "2020-11-05T09:27:10Z", "message": "Add test cases for class symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e4ca53aa40a5e83b68503b473bbec3e239e4aa8", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9e4ca53aa40a5e83b68503b473bbec3e239e4aa8", "committedDate": "2020-11-05T09:27:10Z", "message": "Improve symbol at cursor behaviour for type init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "084711ed87d9e3f829d2720341c2718c5270df3e", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/084711ed87d9e3f829d2720341c2718c5270df3e", "committedDate": "2020-11-05T09:28:13Z", "message": "Address review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bd65f94fbe065a0ca8de2e764c57e0e2ef29d00", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7bd65f94fbe065a0ca8de2e764c57e0e2ef29d00", "committedDate": "2020-11-05T09:28:14Z", "message": "Resolve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eff28e30e23af8d87e6a9bf27fa1a4bf581954eb", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eff28e30e23af8d87e6a9bf27fa1a4bf581954eb", "committedDate": "2020-11-05T10:03:50Z", "message": "Refactor class symbol to accept a compiler context"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81b20c67088bfee4aed24f8bb95914c8ebdbb219", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/81b20c67088bfee4aed24f8bb95914c8ebdbb219", "committedDate": "2020-11-04T12:30:16Z", "message": "Resolve conflicts"}, "afterCommit": {"oid": "eff28e30e23af8d87e6a9bf27fa1a4bf581954eb", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/eff28e30e23af8d87e6a9bf27fa1a4bf581954eb", "committedDate": "2020-11-05T10:03:50Z", "message": "Refactor class symbol to accept a compiler context"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTU2MjY3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#pullrequestreview-524156267", "createdAt": "2020-11-05T11:11:36Z", "commit": {"oid": "eff28e30e23af8d87e6a9bf27fa1a4bf581954eb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTU3MjAy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26703#pullrequestreview-524157202", "createdAt": "2020-11-05T11:12:53Z", "commit": {"oid": "eff28e30e23af8d87e6a9bf27fa1a4bf581954eb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4336, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}