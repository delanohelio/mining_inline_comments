{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0MjMxMDgw", "number": 21499, "title": "Fix several issues with mapping and list constructor expression type checking", "bodyText": "Purpose\n$title.\nCompile Time\n\nFixes #21222 - Fix inferred type for mapping and list constructors when there is no contextually expected type\nFixes #21338 - Creating a tuple by specifying less members than the expected type is not allowed even when FillMember is applicable\nFixes #21345 - Issues in type-checking for mapping and list constructors\nFixes #20773 - Issue in inferred type for list constructor with any, anydata, etc.\nFixes  #21282 - Ambiguous type error when using a mapping constructor expression with a union of maps expected type\nFixes #21281 Issue with tuples with union-typed tuple rest descriptors\nFixes #21247 Array length validation does not happen for union expected types\n\nRuntime\n\nFixes #21413 - Runtime fill member check does not consider closed array types with element types that have a filler value as fillable\n\nApproach\nCompile time type checking for list and mapping constructor expressions, where the contextually expected type (CET) is a union, has been updated in a way that type checking against the different candidate types happens in the same path as when a single type is the CET.\nThis is done by switching the diagnostic log to one that does not log to the console, when type checking is done for a union, just to check compatibility.\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-03-05T11:50:39Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21499", "merged": true, "mergeCommit": {"oid": "02b2ec6c18ce25569748d7f904055a2ab03f85a4"}, "closed": true, "closedAt": "2020-03-08T05:48:35Z", "author": {"login": "MaryamZi"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH2nQLAH2gAyMzg0MjMxMDgwOjQyMDU0MTgwN2ZhMWMzNmMyMzhiOTI4OGQ3OTA4NjJkYmQwN2I4Y2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLiuD-AFqTM3MDgwNjI5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "420541807fa1c36c238b9288d790862dbd07b8cb", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/420541807fa1c36c238b9288d790862dbd07b8cb", "committedDate": "2020-02-25T18:41:18Z", "message": "Infer a record type for mapping-constr-expr when there is no CET"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14bb263d6eceef299ebcd945876aaf5671d7eaaf", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/14bb263d6eceef299ebcd945876aaf5671d7eaaf", "committedDate": "2020-02-26T13:51:09Z", "message": "Merge branch 'allow-spread-op-in-map-constr' of https://github.com/MaryamZi/ballerina into fix-structure-type-for-no-cet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b818ea86f2cb0afaa7e09b791a1a30bf88cdd904", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b818ea86f2cb0afaa7e09b791a1a30bf88cdd904", "committedDate": "2020-02-29T06:32:32Z", "message": "Merge branch 'allow-spread-op-in-map-constr' of https://github.com/MaryamZi/ballerina into fix-structure-type-for-no-cet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b71cd538f71942a9f4e85692a1ddb053aa99d84", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1b71cd538f71942a9f4e85692a1ddb053aa99d84", "committedDate": "2020-02-29T08:44:05Z", "message": "Initial rewrite of list constructor type-checking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30cb3ef5c17ecdbd5a6b72779cb1ff938531f731", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/30cb3ef5c17ecdbd5a6b72779cb1ff938531f731", "committedDate": "2020-03-01T08:15:08Z", "message": "Fix recursive compatibilty check and tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52493665313e7429bebe07b031bd54a9aec859bb", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/52493665313e7429bebe07b031bd54a9aec859bb", "committedDate": "2020-03-03T02:46:19Z", "message": "Implement fill member on tuple value creation\nand fix the runtime filler value check for closed arrays."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f1e1eb977ba5ebbe2d8a7e51bd750d265070db3", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9f1e1eb977ba5ebbe2d8a7e51bd750d265070db3", "committedDate": "2020-03-03T06:02:07Z", "message": "Add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbde0011c1394fa97f1ce0821e0ba25e4bee78d3", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dbde0011c1394fa97f1ce0821e0ba25e4bee78d3", "committedDate": "2020-03-05T04:33:01Z", "message": "Rewrite mapping constructor type-checking for unions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "499ba8595b8dc5f5749b554ec7e96676419e24e4", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/499ba8595b8dc5f5749b554ec7e96676419e24e4", "committedDate": "2020-03-05T09:05:55Z", "message": "Refactor dlog resetting logic for union type-checking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "960ef56608a10f0cdb7a6728e1e1f9cb22705a8e", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/960ef56608a10f0cdb7a6728e1e1f9cb22705a8e", "committedDate": "2020-03-05T09:59:26Z", "message": "Resolve conflicts and merge branch 'master' of https://github.com/ballerina-lang/ballerina into fix-structure-type-for-no-cet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c49755965db02f2d27a05ae6f2cc3c81cee87264", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c49755965db02f2d27a05ae6f2cc3c81cee87264", "committedDate": "2020-03-05T11:36:06Z", "message": "Add tests for non-ambiguous map union CET"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec597c04b8d22f08e31fcc372fa566c866e66700", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ec597c04b8d22f08e31fcc372fa566c866e66700", "committedDate": "2020-03-05T17:56:41Z", "message": "Add more spread op tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bda3c5df9147bb2462d9afc1bbc84e203aa9e43", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1bda3c5df9147bb2462d9afc1bbc84e203aa9e43", "committedDate": "2020-03-06T08:11:28Z", "message": "Fix type checking for mapping constr fields when the CET is undefined\nand temporary disable a failing language server test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b9cb2488e41c0826c864bba2946aaf5925b1ee4", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2b9cb2488e41c0826c864bba2946aaf5925b1ee4", "committedDate": "2020-03-07T03:19:38Z", "message": "Use BLangDiagnosticLogHelper in all visitors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7", "committedDate": "2020-03-07T03:54:07Z", "message": "Merge branch 'master' of https://github.com/ballerina-lang/ballerina into fix-structure-type-for-no-cet"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a6c419c21451f5939113ced382d767bebc72da81", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a6c419c21451f5939113ced382d767bebc72da81", "committedDate": "2020-03-07T03:25:33Z", "message": "Merge branch 'master' of https://github.com/ballerina-lang/ballerina into fix-structure-type-for-no-cet"}, "afterCommit": {"oid": "f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7", "committedDate": "2020-03-07T03:54:07Z", "message": "Merge branch 'master' of https://github.com/ballerina-lang/ballerina into fix-structure-type-for-no-cet"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwODA2MTIy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21499#pullrequestreview-370806122", "createdAt": "2020-03-08T05:40:55Z", "commit": {"oid": "f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwNTo0MDo1NVrOFzTSGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwNTo0MDo1NVrOFzTSGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMzNzYyNg==", "bodyText": "Please create an issue for this and assign @nadeeshaan", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21499#discussion_r389337626", "createdAt": "2020-03-08T05:40:55Z", "author": {"login": "hasithaa"}, "path": "language-server/modules/langserver-core/src/test/java/org/ballerinalang/langserver/codeaction/CodeActionTest.java", "diffHunk": "@@ -238,7 +238,7 @@ public void testCodeActionWithQuickFixes(String config, String source)\n         log.info(\"Test textDocument/codeAction QuickFixes\");\n         return new Object[][]{\n                 {\"fixReturnType1.json\", \"fixReturnType.bal\"},\n-                {\"fixReturnType2.json\", \"fixReturnType.bal\"},\n+//                {\"fixReturnType2.json\", \"fixReturnType.bal\"},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwODA2Mjkw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21499#pullrequestreview-370806290", "createdAt": "2020-03-08T05:46:20Z", "commit": {"oid": "f5a1fd0c11e9b58593e7cc7abf422b0b3698e6d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3974, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}