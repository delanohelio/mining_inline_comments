{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4NjA2NjI0", "number": 20508, "title": "Move the changes in PR #20241 to 1.1.x", "bodyText": "Purpose\n$subject. Please refer #20241.\nFixes ##20241\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-01-02T10:03:33Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508", "merged": true, "mergeCommit": {"oid": "bd7125cd4fac31048628f8f89689888b108461da"}, "closed": true, "closedAt": "2020-01-17T05:59:56Z", "author": {"login": "KavinduZoysa"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4Qr8XAH2gAyMzU4NjA2NjI0OjRkZmQwYzc3MTRjZjA5ZTdkOTI2MTJlMDZmYTMzYmU1MzQ5MDRlNDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6-38CgFqTM0NDE0MTQ5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4dfd0c7714cf09e7d92612e06fa33be534904e46", "committedDate": "2020-01-08T08:01:10Z", "message": "Add generated init function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28ec1160c1ee74f53b351dde1c1d9a3df8bd697a", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/28ec1160c1ee74f53b351dde1c1d9a3df8bd697a", "committedDate": "2020-01-02T09:49:19Z", "message": "Add generated init function"}, "afterCommit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4dfd0c7714cf09e7d92612e06fa33be534904e46", "committedDate": "2020-01-08T08:01:10Z", "message": "Add generated init function"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjQzNTc2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-341643576", "createdAt": "2020-01-13T05:28:50Z", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwNToyODo1MVrOFctjlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwNToyODo1MVrOFctjlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY1MDgzNw==", "bodyText": "With this change, the initializers are not added to attached functions list. Is that intentional?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#discussion_r365650837", "createdAt": "2020-01-13T05:28:51Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/BIRPackageSymbolEnter.java", "diffHunk": "@@ -363,10 +363,13 @@ private void defineFunction(DataInputStream dataInStream) throws IOException {\n                 BAttachedFunction attachedFunc =\n                         new BAttachedFunction(names.fromString(funcName), invokableSymbol, funcType);\n                 BStructureTypeSymbol structureTypeSymbol = (BStructureTypeSymbol) attachedType.tsymbol;\n-                structureTypeSymbol.attachedFuncs.add(attachedFunc);\n                 if (Names.USER_DEFINED_INIT_SUFFIX.value.equals(funcName)\n                         || funcName.equals(Names.INIT_FUNCTION_SUFFIX.value)) {\n                     structureTypeSymbol.initializerFunc = attachedFunc;\n+                } else if (funcName.equals(Names.GENERATED_INIT_SUFFIX.value)) {\n+                    ((BObjectTypeSymbol) structureTypeSymbol).generatedInitializerFunc = attachedFunc;\n+                } else {\n+                    structureTypeSymbol.attachedFuncs.add(attachedFunc);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjkxMDI5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-341691029", "createdAt": "2020-01-13T08:39:46Z", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODozOTo0N1rOFcvyBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODozOTo0N1rOFcvyBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NzMwMw==", "bodyText": "Unused var here. Let's remove this.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#discussion_r365687303", "createdAt": "2020-01-13T08:39:47Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/desugar/Desugar.java", "diffHunk": "@@ -348,17 +348,18 @@ private void addAttachedFunctionsToPackageLevel(BLangPackage pkgNode, SymbolEnv\n                     continue;\n                 }\n \n-                if (objectTypeNode.initFunction == null) {\n-                    objectTypeNode.initFunction = createInitFunctionForStructureType(objectTypeNode, env,\n-                                                                                     Names.USER_DEFINED_INIT_SUFFIX);\n-                }\n-\n-                // Add init function to the attached function list\n+                objectTypeNode.generatedInitFunction = createGeneratedInitializerFunction(objectTypeNode, env);\n                 BObjectTypeSymbol objectSymbol = ((BObjectTypeSymbol) objectTypeNode.type.tsymbol);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjkxMjg1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-341691285", "createdAt": "2020-01-13T08:40:16Z", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODo0MDoxN1rOFcvyvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODo0MDoxN1rOFcvyvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NzQ4NQ==", "bodyText": "Suggested change", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#discussion_r365687485", "createdAt": "2020-01-13T08:40:17Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/desugar/Desugar.java", "diffHunk": "@@ -367,6 +368,65 @@ private void addAttachedFunctionsToPackageLevel(BLangPackage pkgNode, SymbolEnv\n         }\n     }\n \n+    private BLangFunction createGeneratedInitializerFunction(BLangObjectTypeNode objectTypeNode, SymbolEnv env) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjkxNDM1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-341691435", "createdAt": "2020-01-13T08:40:35Z", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODo0MDozNlrOFcvzKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODo0MDozNlrOFcvzKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NzU5NA==", "bodyText": "Suggested change", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#discussion_r365687594", "createdAt": "2020-01-13T08:40:36Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/desugar/Desugar.java", "diffHunk": "@@ -367,6 +368,65 @@ private void addAttachedFunctionsToPackageLevel(BLangPackage pkgNode, SymbolEnv\n         }\n     }\n \n+    private BLangFunction createGeneratedInitializerFunction(BLangObjectTypeNode objectTypeNode, SymbolEnv env) {\n+\n+        BLangFunction generatedInitFunc = createInitFunctionForObjectType(objectTypeNode, env);\n+        if (objectTypeNode.initFunction == null) {\n+            return generatedInitFunc;\n+        }\n+\n+        BAttachedFunction initializerFunc = ((BObjectTypeSymbol) objectTypeNode.symbol).initializerFunc;\n+        BAttachedFunction generatedInitializerFunc =\n+                ((BObjectTypeSymbol) objectTypeNode.symbol).generatedInitializerFunc;\n+        addRequiredParamsToGeneratedInitFunction(objectTypeNode.initFunction, generatedInitFunc,\n+                generatedInitializerFunc);\n+        addRestParamsToGeneratedInitFunction(objectTypeNode.initFunction, generatedInitFunc, generatedInitializerFunc);\n+\n+        generatedInitFunc.returnTypeNode = objectTypeNode.initFunction.returnTypeNode;\n+        generatedInitializerFunc.symbol.retType = generatedInitFunc.returnTypeNode.type;\n+\n+        ((BInvokableType) generatedInitFunc.symbol.type).paramTypes = initializerFunc.type.paramTypes;\n+        ((BInvokableType) generatedInitFunc.symbol.type).retType = initializerFunc.type.retType;\n+        ((BInvokableType) generatedInitFunc.symbol.type).restType = initializerFunc.type.restType;\n+\n+        generatedInitializerFunc.type = initializerFunc.type;\n+        generatedInitFunc.desugared = false;\n+        return generatedInitFunc;\n+    }\n+\n+    private void addRequiredParamsToGeneratedInitFunction(BLangFunction initFunction, BLangFunction generatedInitFunc,\n+                                                          BAttachedFunction generatedInitializerFunc) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjkxNTUx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-341691551", "createdAt": "2020-01-13T08:40:48Z", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODo0MDo0OVrOFcvzhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODo0MDo0OVrOFcvzhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NzY4NQ==", "bodyText": "Suggested change", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#discussion_r365687685", "createdAt": "2020-01-13T08:40:49Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/desugar/Desugar.java", "diffHunk": "@@ -367,6 +368,65 @@ private void addAttachedFunctionsToPackageLevel(BLangPackage pkgNode, SymbolEnv\n         }\n     }\n \n+    private BLangFunction createGeneratedInitializerFunction(BLangObjectTypeNode objectTypeNode, SymbolEnv env) {\n+\n+        BLangFunction generatedInitFunc = createInitFunctionForObjectType(objectTypeNode, env);\n+        if (objectTypeNode.initFunction == null) {\n+            return generatedInitFunc;\n+        }\n+\n+        BAttachedFunction initializerFunc = ((BObjectTypeSymbol) objectTypeNode.symbol).initializerFunc;\n+        BAttachedFunction generatedInitializerFunc =\n+                ((BObjectTypeSymbol) objectTypeNode.symbol).generatedInitializerFunc;\n+        addRequiredParamsToGeneratedInitFunction(objectTypeNode.initFunction, generatedInitFunc,\n+                generatedInitializerFunc);\n+        addRestParamsToGeneratedInitFunction(objectTypeNode.initFunction, generatedInitFunc, generatedInitializerFunc);\n+\n+        generatedInitFunc.returnTypeNode = objectTypeNode.initFunction.returnTypeNode;\n+        generatedInitializerFunc.symbol.retType = generatedInitFunc.returnTypeNode.type;\n+\n+        ((BInvokableType) generatedInitFunc.symbol.type).paramTypes = initializerFunc.type.paramTypes;\n+        ((BInvokableType) generatedInitFunc.symbol.type).retType = initializerFunc.type.retType;\n+        ((BInvokableType) generatedInitFunc.symbol.type).restType = initializerFunc.type.restType;\n+\n+        generatedInitializerFunc.type = initializerFunc.type;\n+        generatedInitFunc.desugared = false;\n+        return generatedInitFunc;\n+    }\n+\n+    private void addRequiredParamsToGeneratedInitFunction(BLangFunction initFunction, BLangFunction generatedInitFunc,\n+                                                          BAttachedFunction generatedInitializerFunc) {\n+\n+        if (initFunction.requiredParams.isEmpty()) {\n+            return;\n+        }\n+        for (BLangSimpleVariable requiredParameter : initFunction.requiredParams) {\n+            BLangSimpleVariable var =\n+                    ASTBuilderUtil.createVariable(initFunction.pos,\n+                            requiredParameter.name.getValue(), requiredParameter.type, requiredParameter.expr,\n+                            new BVarSymbol(0, names.fromString(requiredParameter.name.getValue()),\n+                                    requiredParameter.symbol.pkgID,\n+                                    requiredParameter.type, requiredParameter.symbol.owner));\n+            generatedInitFunc.requiredParams.add(var);\n+            generatedInitializerFunc.symbol.params.add(var.symbol);\n+        }\n+    }\n+\n+    private void addRestParamsToGeneratedInitFunction(BLangFunction initFunction, BLangFunction generatedInitFunc,\n+                                                      BAttachedFunction generatedInitializerFunc) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjk4MTEw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-341698110", "createdAt": "2020-01-13T08:54:49Z", "commit": {"oid": "4dfd0c7714cf09e7d92612e06fa33be534904e46"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d43568f3e685f9c5edafce494dee4190e4affaa", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4d43568f3e685f9c5edafce494dee4190e4affaa", "committedDate": "2020-01-16T06:34:50Z", "message": "Change the test cases"}, "afterCommit": {"oid": "88587a7011ef0906710a5fcd1f8c9304419cd142", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/88587a7011ef0906710a5fcd1f8c9304419cd142", "committedDate": "2020-01-16T06:37:36Z", "message": "Change the test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a496e459aa3ec5962d6a6a1208862b3008ffb6e2", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a496e459aa3ec5962d6a6a1208862b3008ffb6e2", "committedDate": "2020-01-16T07:24:48Z", "message": "Change the test cases"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88587a7011ef0906710a5fcd1f8c9304419cd142", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/88587a7011ef0906710a5fcd1f8c9304419cd142", "committedDate": "2020-01-16T06:37:36Z", "message": "Change the test cases"}, "afterCommit": {"oid": "a496e459aa3ec5962d6a6a1208862b3008ffb6e2", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a496e459aa3ec5962d6a6a1208862b3008ffb6e2", "committedDate": "2020-01-16T07:24:48Z", "message": "Change the test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MTQxNDk4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20508#pullrequestreview-344141498", "createdAt": "2020-01-16T18:57:45Z", "commit": {"oid": "a496e459aa3ec5962d6a6a1208862b3008ffb6e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4431, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}