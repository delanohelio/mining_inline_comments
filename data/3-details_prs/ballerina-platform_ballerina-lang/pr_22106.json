{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMzM3MzA4", "number": 22106, "title": "Improve xml index expr type checking", "bodyText": "Purpose\nThis is the master branch PR of #22088\nThis PR limit the index access expression on xml to just int type.\nThis means previously allowed xml child access using xml index expressions are no longer supported. And this also fixes the BAD-SAD error when index is not a int or string.\nFixes #22052\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-03-23T11:50:10Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106", "merged": true, "mergeCommit": {"oid": "289780299b529a07eb7b396fb31a65a6b561cfe6"}, "closed": true, "closedAt": "2020-03-27T14:41:04Z", "author": {"login": "rdhananjaya"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQc2AUAH2gAyMzkyMzM3MzA4OjVhNGM1MDQ1ZWZiN2ExOGZmMjdmNTIyYjQ2ZTE3ZmJmMDU5ZDBiMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRxtqSgFqTM4MjkxNjAzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5a4c5045efb7a18ff27f522b46e17fbf059d0b01", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5a4c5045efb7a18ff27f522b46e17fbf059d0b01", "committedDate": "2020-03-23T11:45:12Z", "message": "Improve xml index expr type checking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c253c9c550063d99d1889676db2feea40d7d31d1", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c253c9c550063d99d1889676db2feea40d7d31d1", "committedDate": "2020-03-23T17:03:17Z", "message": "Fix langlib test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be3040a9322a9c5a353b4485b75100985e67ec0b", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/be3040a9322a9c5a353b4485b75100985e67ec0b", "committedDate": "2020-03-24T04:01:27Z", "message": "Merge branch 'master' of github.com:ballerina-platform/ballerina-lang into xml-disallow-child-index-access"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f42f931736a07505aed9911907e65b5b665381d6", "committedDate": "2020-03-24T08:33:55Z", "message": "Improve BRunUtil xml support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5cc9fd86b2779a4c2adc55769f6cad31f315e962", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5cc9fd86b2779a4c2adc55769f6cad31f315e962", "committedDate": "2020-03-24T07:30:51Z", "message": "Improve BRunUtil xml support"}, "afterCommit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f42f931736a07505aed9911907e65b5b665381d6", "committedDate": "2020-03-24T08:33:55Z", "message": "Improve BRunUtil xml support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTYxNjM1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#pullrequestreview-382161635", "createdAt": "2020-03-26T16:04:23Z", "commit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTYzNjc0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#pullrequestreview-382163674", "createdAt": "2020-03-26T16:06:30Z", "commit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjowNjozMFrOF8OX-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjowNjozMFrOF8OX-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY5NDM5NQ==", "bodyText": "Can we remove this since it is not used?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#discussion_r398694395", "createdAt": "2020-03-26T16:06:30Z", "author": {"login": "irshadnilam"}, "path": "compiler/ballerina-lang/src/main/java/org/ballerinalang/util/diagnostic/DiagnosticCode.java", "diffHunk": "@@ -318,6 +318,7 @@\n     UNSUPPORTED_METHOD_INVOCATION_XML_NAV(\"method.invocation.in.xml.navigation.expressions.not.supported\"),\n     DEPRECATED_XML_ATTRIBUTE_ACCESS(\"deprecated.xml.attribute.access.expression\"),\n     UNSUPPORTED_INDEX_IN_XML_NAVIGATION(\"indexing.within.xml.navigation.expression.not.supported\"),\n+    DEPRECATED_XML_CHILD_ACCESS(\"deprecated.xml.child.access\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTYzODU4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#pullrequestreview-382163858", "createdAt": "2020-03-26T16:06:40Z", "commit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjowNjo0MVrOF8OYkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjowNjo0MVrOF8OYkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY5NDU0NQ==", "bodyText": "Also this.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#discussion_r398694545", "createdAt": "2020-03-26T16:06:41Z", "author": {"login": "irshadnilam"}, "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -1121,6 +1121,10 @@ warning.usage.of.deprecated.construct=\\\n warning.non.module.qualified.error.reason=\\\n   error reason ''{0}'' is not module qualified\n \n+warning.deprecated.xml.child.access=\\\n+  xml child access using index expression is deprecated and will be removed in next minor release, please \\\n+  use xml step expressions\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f931736a07505aed9911907e65b5b665381d6"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b25327afc3299bc739f9cdbebd21c82d61a3feb6", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b25327afc3299bc739f9cdbebd21c82d61a3feb6", "committedDate": "2020-03-26T16:50:26Z", "message": "Remove unused warning message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTE2MDM4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#pullrequestreview-382916038", "createdAt": "2020-03-27T14:37:42Z", "commit": {"oid": "b25327afc3299bc739f9cdbebd21c82d61a3feb6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNDozNzo0M1rOF80A6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNDozNzo0M1rOF80A6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMxMTA4Mg==", "bodyText": "Not related to this PR I guess, but shouldn't L13 result in only one error? Only \"invalid assignment in variable 'x1/*'\" maybe?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22106#discussion_r399311082", "createdAt": "2020-03-27T14:37:43Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/types/xml/XMLAccessTest.java", "diffHunk": "@@ -213,9 +213,15 @@ public void testXMLNavigationExpressionWithQuotedIdentifiers() {\n \n     @Test\n     public void testInvalidXMLAccessWithIndex() {\n-        BAssertUtil.validateError(negativeResult, 0, \"cannot update an xml sequence\", 5, 5);\n+        int i = 0;\n+        BAssertUtil.validateError(negativeResult, i++, \"cannot update an xml sequence\", 5, 5);\n+        BAssertUtil.validateError(negativeResult, i++, \"cannot update an xml sequence\", 13, 5);\n+        BAssertUtil.validateError(negativeResult, i++, \"invalid assignment in variable 'x1/*'\", 13, 5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b25327afc3299bc739f9cdbebd21c82d61a3feb6"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3772, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}