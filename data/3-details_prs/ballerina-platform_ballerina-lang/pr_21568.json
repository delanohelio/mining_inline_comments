{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1OTkzNzcw", "number": 21568, "title": "Disallow method invocation directly after xml navigation access expression.", "bodyText": "Purpose\nThis is because according to the spec, method invocations after XML navigation expression (xmlVal/.method()) should be associated with the navigation expression.\nThis means when we add the method invocation support to XML navigation expressions, method invocation directly after the nav-expression will change the semantic. Hence this PR is disallowing it. If the user want to invoke a method on the result of an XML navigation expression they can use grouping expressions to group the navigation expression and invoke the method on the group.\nAlso related to #21567\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-03-10T08:17:23Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568", "merged": true, "mergeCommit": {"oid": "3e0ffb3963b51197a0a664df72c406dc85591dda"}, "closed": true, "closedAt": "2020-03-11T09:39:55Z", "author": {"login": "rdhananjaya"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMMi3ZgH2gAyMzg1OTkzNzcwOmFlMGVmZTQxNTdkNGY3NmVhOThhOWE4NjkyMTRhZGRjOTcwMmZkMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMjaD7gFqTM3MjU3Nzc2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ae0efe4157d4f76ea98a9a869214addc9702fd25", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ae0efe4157d4f76ea98a9a869214addc9702fd25", "committedDate": "2020-03-10T06:30:07Z", "message": "Disallow method invocations on xml navigation exp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "296f39f714c1a334ecc8af161dd193b150c3a818", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/296f39f714c1a334ecc8af161dd193b150c3a818", "committedDate": "2020-03-10T07:54:51Z", "message": "Fix unit-test failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "committedDate": "2020-03-10T08:08:17Z", "message": "Improve error message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNzgxMTU5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#pullrequestreview-371781159", "createdAt": "2020-03-10T09:14:27Z", "commit": {"oid": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwOToxNDoyN1rOF0GkRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwOTo0ODo1N1rOF0Hxcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE3Nzg2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              method invocations are not supported within XML navigation expressions yet, use grouping expression (parenthesis) \\\n          \n          \n            \n              method invocations are not yet supported within XML navigation expressions, use a grouping expression (parenthesis) \\", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390177860", "createdAt": "2020-03-10T09:14:27Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -488,6 +488,10 @@ error.invalid.xml.ns.interpolation=\\\n error.cannot.find.xml.namespace.prefix=\\\n   cannot find xml namespace prefix ''{0}''\n \n+error.method.invocation.in.xml.navigation.expressions.not.supported=\\\n+  method invocations are not supported within XML navigation expressions yet, use grouping expression (parenthesis) \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE3ODA1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              if you intent to invoke the method in the result of navigation expression.\n          \n          \n            \n              if you intend to invoke the method on the result of the navigation expression.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390178056", "createdAt": "2020-03-10T09:14:47Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -488,6 +488,10 @@ error.invalid.xml.ns.interpolation=\\\n error.cannot.find.xml.namespace.prefix=\\\n   cannot find xml namespace prefix ''{0}''\n \n+error.method.invocation.in.xml.navigation.expressions.not.supported=\\\n+  method invocations are not supported within XML navigation expressions yet, use grouping expression (parenthesis) \\\n+  if you intent to invoke the method in the result of navigation expression.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE5NzYxOA==", "bodyText": "Can't we use\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        dlog.error(((BLangInvocation) expression.parent).name.pos,\n          \n          \n            \n                        dlog.error(((BLangInvocation) expression.parent).pos,\n          \n      \n    \n    \n  \n\ninstead?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390197618", "createdAt": "2020-03-10T09:48:57Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/CodeAnalyzer.java", "diffHunk": "@@ -2102,6 +2102,15 @@ public void visit(BLangXMLNavigationAccess xmlNavigation) {\n         if (xmlNavigation.childIndex != null) {\n             analyzeExpr(xmlNavigation.childIndex);\n         }\n+        validateMethodInvocationsInXMLNavigationExpression(xmlNavigation);\n+    }\n+\n+    private void validateMethodInvocationsInXMLNavigationExpression(BLangXMLNavigationAccess expression) {\n+        if (!expression.methodInvocationAnalyzed && expression.parent.getKind() == NodeKind.INVOCATION) {\n+            dlog.error(((BLangInvocation) expression.parent).name.pos,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3794f583ef3f9c2491f8034035765b46b91cc44", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f3794f583ef3f9c2491f8034035765b46b91cc44", "committedDate": "2020-03-10T14:56:03Z", "message": "Apply review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6c609b53ed79ddc2b35b211a76acd898b639d57", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c6c609b53ed79ddc2b35b211a76acd898b639d57", "committedDate": "2020-03-10T15:21:51Z", "message": "Allow navigation expression as func argument"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83f67bde878fac9c6e6e1dc055a6f38782be86fd", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/83f67bde878fac9c6e6e1dc055a6f38782be86fd", "committedDate": "2020-03-11T00:39:44Z", "message": "Fix failing langlib test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNDg0NTQ2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#pullrequestreview-372484546", "createdAt": "2020-03-11T05:31:51Z", "commit": {"oid": "83f67bde878fac9c6e6e1dc055a6f38782be86fd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQwNTozMTo1MVrOF0ps0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQwNTozMTo1MVrOF0ps0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDc1MzQ5MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              method invocations are not yet supported within XML navigation expressions yet, use a grouping expression \\\n          \n          \n            \n              method invocations are not yet supported within XML navigation expressions, use a grouping expression \\", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390753490", "createdAt": "2020-03-11T05:31:51Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -488,6 +488,10 @@ error.invalid.xml.ns.interpolation=\\\n error.cannot.find.xml.namespace.prefix=\\\n   cannot find xml namespace prefix ''{0}''\n \n+error.method.invocation.in.xml.navigation.expressions.not.supported=\\\n+  method invocations are not yet supported within XML navigation expressions yet, use a grouping expression \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83f67bde878fac9c6e6e1dc055a6f38782be86fd"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c84f89aec60630e0e35a260b363d761bb501271", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3c84f89aec60630e0e35a260b363d761bb501271", "committedDate": "2020-03-11T07:18:51Z", "message": "Fix error message grammar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNTc3NzYz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#pullrequestreview-372577763", "createdAt": "2020-03-11T09:08:19Z", "commit": {"oid": "3c84f89aec60630e0e35a260b363d761bb501271"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4013, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}