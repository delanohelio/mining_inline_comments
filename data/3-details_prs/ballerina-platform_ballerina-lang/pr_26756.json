{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NTk5Nzc4", "number": 26756, "title": "Fix incorrect public type creation issue for inferred record types", "bodyText": "Purpose\nThis fixes the incorrect public type creation issue for record literals with inferred types.\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-11-04T19:40:31Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26756", "merged": true, "mergeCommit": {"oid": "7e00f9250191ec5e8abcf1bbb5e1d802c63222ed"}, "closed": true, "closedAt": "2020-11-06T18:48:06Z", "author": {"login": "pubudu91"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZTq-sgBqjM5NTkzMjc4ODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZ6iHdAFqTUyNTM2MDUwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "822ca80e1e3155e356ec1ff8a71d5b7e9101c416", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/822ca80e1e3155e356ec1ff8a71d5b7e9101c416", "committedDate": "2020-11-04T19:37:01Z", "message": "Fix incorrect public type creation issue for inferred record types"}, "afterCommit": {"oid": "05bc0b2cd5facc151d9a76ff8545cee853bb2c0d", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/05bc0b2cd5facc151d9a76ff8545cee853bb2c0d", "committedDate": "2020-11-04T20:19:53Z", "message": "Fix incorrect public type creation issue for inferred record types"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzOTIwMjU5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26756#pullrequestreview-523920259", "createdAt": "2020-11-05T04:38:33Z", "commit": {"oid": "05bc0b2cd5facc151d9a76ff8545cee853bb2c0d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwNDozODozM1rOHtzRxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwNDo0NDoyNVrOHtzXUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc4ODEwMA==", "bodyText": "Should we use the BRecordType constructor that accepts flags also at L1670, instead? org.wso2.ballerinalang.compiler.semantics.model.types.BRecordType#BRecordType(org.wso2.ballerinalang.compiler.semantics.model.symbols.BTypeSymbol, int)", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26756#discussion_r517788100", "createdAt": "2020-11-05T04:38:33Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -1708,6 +1708,7 @@ private BType getEffectiveMappingType(BLangRecordLiteral recordLiteral, BType ap\n         }\n \n         recordType.fields = newFields;\n+        recordType.flags = recordSymbol.flags;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05bc0b2cd5facc151d9a76ff8545cee853bb2c0d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc4OTUyMw==", "bodyText": "Looking at the usage of org.wso2.ballerinalang.compiler.semantics.model.symbols.Symbols#createRecordSymbol, there seem to be some other places where we create the symbol without the Flags.ANONYMOUS flag. Don't we have to change them too?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26756#discussion_r517789523", "createdAt": "2020-11-05T04:44:25Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -7245,7 +7246,8 @@ private BType defineInferredRecordType(BLangRecordLiteral recordLiteral, BType e\n     private BRecordTypeSymbol createRecordTypeSymbol(PackageID pkgID, Location location,\n                                                      SymbolOrigin origin) {\n         BRecordTypeSymbol recordSymbol =\n-                Symbols.createRecordSymbol(0, names.fromString(anonymousModelHelper.getNextAnonymousTypeKey(pkgID)),\n+                Symbols.createRecordSymbol(Flags.ANONYMOUS,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05bc0b2cd5facc151d9a76ff8545cee853bb2c0d"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b4710b157d17149caa59c965bebc65b4e226a32e", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b4710b157d17149caa59c965bebc65b4e226a32e", "committedDate": "2020-11-05T06:31:53Z", "message": "Add anon flag to usages of createRecordSymbol() which creates anon records"}, "afterCommit": {"oid": "3e3f41a2cd537110c91b3687f0d1b9c696d630a3", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3e3f41a2cd537110c91b3687f0d1b9c696d630a3", "committedDate": "2020-11-05T06:35:08Z", "message": "Add anon flag to usages of createRecordSymbol() which creates anon records"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34f974c0e7daa641f71054a91cc75746ec0e7d82", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/34f974c0e7daa641f71054a91cc75746ec0e7d82", "committedDate": "2020-11-05T08:51:10Z", "message": "Fix incorrect public type creation issue for inferred record types"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "345847b9c8c73f7c646d40bf156de1da6b08adda", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/345847b9c8c73f7c646d40bf156de1da6b08adda", "committedDate": "2020-11-05T08:51:14Z", "message": "Add anon flag to usages of createRecordSymbol() which creates anon records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e3f41a2cd537110c91b3687f0d1b9c696d630a3", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3e3f41a2cd537110c91b3687f0d1b9c696d630a3", "committedDate": "2020-11-05T06:35:08Z", "message": "Add anon flag to usages of createRecordSymbol() which creates anon records"}, "afterCommit": {"oid": "345847b9c8c73f7c646d40bf156de1da6b08adda", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/345847b9c8c73f7c646d40bf156de1da6b08adda", "committedDate": "2020-11-05T08:51:14Z", "message": "Add anon flag to usages of createRecordSymbol() which creates anon records"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MzYwNTAz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26756#pullrequestreview-525360503", "createdAt": "2020-11-06T17:37:06Z", "commit": {"oid": "345847b9c8c73f7c646d40bf156de1da6b08adda"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4963, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}