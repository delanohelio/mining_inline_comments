{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxOTcwMDQ4", "number": 26322, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwOTo1MDowOVrOEt6l7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMDo1OTo0NVrOEt8Kcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NTgxMzU2OnYy", "diffSide": "RIGHT", "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/EvaluationUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwOTo1MDowOVrOHh_1lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMToxODo1OFrOHiC7zQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQxMDk2Ng==", "bodyText": "Can these be private? These are used only within the EvaluationUtils class right?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505410966", "createdAt": "2020-10-15T09:50:09Z", "author": {"login": "Ibaqu"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/EvaluationUtils.java", "diffHunk": "@@ -36,13 +41,57 @@\n  */\n public class EvaluationUtils {\n \n-    private static final String JAVA_LANG_CLASS = \"java.lang.Class\";\n+    // Helper classes\n+    public static final String B_TYPE_CHECKER_CLASS = \"org.ballerinalang.jvm.TypeChecker\";\n     private static final String B_STRING_UTILS_CLASS = \"org.ballerinalang.jvm.api.BStringUtils\";\n+    public static final String JAVA_BOOLEAN_CLASS = \"java.lang.Boolean\";\n+    public static final String JAVA_LONG_CLASS = \"java.lang.Long\";\n+    public static final String JAVA_DOUBLE_CLASS = \"java.lang.Double\";\n+    public static final String JAVA_LANG_CLASS = \"java.lang.Class\";\n+    public static final String JAVA_OBJECT_CLASS = \"java.lang.Object\";\n+    // Helper methods\n+    public static final String GET_TYPEDESC_METHOD = \"getTypedesc\";\n+    public static final String VALUE_OF_METHOD = \"valueOf\";\n+    public static final String REF_EQUAL_METHOD = \"isReferenceEqual\";\n+    public static final String VALUE_EQUAL_METHOD = \"isEqual\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2MTcwOQ==", "bodyText": "@Ibaqu These are being used outside of the class (inside the debugger evaluation engine implementation). FROM_STRING_METHOD and FOR_NAME_METHOD constants are used only inside the class and hence declared as private.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505461709", "createdAt": "2020-10-15T11:18:58Z", "author": {"login": "NipunaRanasinghe"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/EvaluationUtils.java", "diffHunk": "@@ -36,13 +41,57 @@\n  */\n public class EvaluationUtils {\n \n-    private static final String JAVA_LANG_CLASS = \"java.lang.Class\";\n+    // Helper classes\n+    public static final String B_TYPE_CHECKER_CLASS = \"org.ballerinalang.jvm.TypeChecker\";\n     private static final String B_STRING_UTILS_CLASS = \"org.ballerinalang.jvm.api.BStringUtils\";\n+    public static final String JAVA_BOOLEAN_CLASS = \"java.lang.Boolean\";\n+    public static final String JAVA_LONG_CLASS = \"java.lang.Long\";\n+    public static final String JAVA_DOUBLE_CLASS = \"java.lang.Double\";\n+    public static final String JAVA_LANG_CLASS = \"java.lang.Class\";\n+    public static final String JAVA_OBJECT_CLASS = \"java.lang.Object\";\n+    // Helper methods\n+    public static final String GET_TYPEDESC_METHOD = \"getTypedesc\";\n+    public static final String VALUE_OF_METHOD = \"valueOf\";\n+    public static final String REF_EQUAL_METHOD = \"isReferenceEqual\";\n+    public static final String VALUE_EQUAL_METHOD = \"isEqual\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQxMDk2Ng=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NTk3ODk0OnYy", "diffSide": "RIGHT", "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMDozMzoxOFrOHiBcdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNTozNDozMFrOHiN4RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQzNzMwMg==", "bodyText": "What is the relevant action if the operatorType is DOUBLE_EQUAL_TOKEN and TRIPPLE_EQUAL_TOKEN?\nAre we planning to implement these in future?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505437302", "createdAt": "2020-10-15T10:33:18Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -104,6 +114,12 @@ private BExpressionValue performOperation(BExpressionValue lhs, BExpressionValue\n                 return logicalOR(lVar, rVar);\n             case ELVIS_TOKEN:\n                 return conditionalReturn(lVar, rVar);\n+            case DOUBLE_EQUAL_TOKEN:\n+            case NOT_EQUAL_TOKEN:\n+                return checkValueEquality(lVar, rVar, operatorType);\n+            case TRIPPLE_EQUAL_TOKEN:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2Mzc4Nw==", "bodyText": "@praveennadarajah You might have missed that both of DOUBLE_EQUAL_TOKEN and NOT_EQUAL_TOKEN cases fall into checkValueEquality method.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505463787", "createdAt": "2020-10-15T11:22:49Z", "author": {"login": "NipunaRanasinghe"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -104,6 +114,12 @@ private BExpressionValue performOperation(BExpressionValue lhs, BExpressionValue\n                 return logicalOR(lVar, rVar);\n             case ELVIS_TOKEN:\n                 return conditionalReturn(lVar, rVar);\n+            case DOUBLE_EQUAL_TOKEN:\n+            case NOT_EQUAL_TOKEN:\n+                return checkValueEquality(lVar, rVar, operatorType);\n+            case TRIPPLE_EQUAL_TOKEN:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQzNzMwMg=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY0MTAyOQ==", "bodyText": "Okay, Noted.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505641029", "createdAt": "2020-10-15T15:34:30Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -104,6 +114,12 @@ private BExpressionValue performOperation(BExpressionValue lhs, BExpressionValue\n                 return logicalOR(lVar, rVar);\n             case ELVIS_TOKEN:\n                 return conditionalReturn(lVar, rVar);\n+            case DOUBLE_EQUAL_TOKEN:\n+            case NOT_EQUAL_TOKEN:\n+                return checkValueEquality(lVar, rVar, operatorType);\n+            case TRIPPLE_EQUAL_TOKEN:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQzNzMwMg=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjAwMzUyOnYy", "diffSide": "RIGHT", "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMDo0MDoxMlrOHiBrYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMToyNDozMlrOHiDHQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ0MTEyMA==", "bodyText": "Seems like you are adding the JAVA_OBJECT_CLASS twice. This is redundant.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505441120", "createdAt": "2020-10-15T10:40:12Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -387,6 +403,50 @@ private BExpressionValue conditionalReturn(BVariable lVar, BVariable rVar) {\n         }\n     }\n \n+    /**\n+     * Checks for deep value equality.\n+     */\n+    private BExpressionValue checkValueEquality(BVariable lVar, BVariable rVar, SyntaxKind operatorType)\n+            throws EvaluationException {\n+        List<Value> argList = new ArrayList<>();\n+        argList.add(getValueAsObject(context, lVar));\n+        argList.add(getValueAsObject(context, rVar));\n+\n+        List<String> argTypeNames = new ArrayList<>();\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        argTypeNames.add(JAVA_OBJECT_CLASS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2NDY0MQ==", "bodyText": "This is intentional. This relevant method accepts two java.lang.Object instances as its arguments.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505464641", "createdAt": "2020-10-15T11:24:32Z", "author": {"login": "NipunaRanasinghe"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -387,6 +403,50 @@ private BExpressionValue conditionalReturn(BVariable lVar, BVariable rVar) {\n         }\n     }\n \n+    /**\n+     * Checks for deep value equality.\n+     */\n+    private BExpressionValue checkValueEquality(BVariable lVar, BVariable rVar, SyntaxKind operatorType)\n+            throws EvaluationException {\n+        List<Value> argList = new ArrayList<>();\n+        argList.add(getValueAsObject(context, lVar));\n+        argList.add(getValueAsObject(context, rVar));\n+\n+        List<String> argTypeNames = new ArrayList<>();\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        argTypeNames.add(JAVA_OBJECT_CLASS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ0MTEyMA=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjAxMzc5OnYy", "diffSide": "RIGHT", "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMDo0MzoxMFrOHiBx7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMToyNTowNVrOHiDIZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ0Mjc5Nw==", "bodyText": "Same here as well. Is there any specific reason for this?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505442797", "createdAt": "2020-10-15T10:43:10Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -387,6 +403,50 @@ private BExpressionValue conditionalReturn(BVariable lVar, BVariable rVar) {\n         }\n     }\n \n+    /**\n+     * Checks for deep value equality.\n+     */\n+    private BExpressionValue checkValueEquality(BVariable lVar, BVariable rVar, SyntaxKind operatorType)\n+            throws EvaluationException {\n+        List<Value> argList = new ArrayList<>();\n+        argList.add(getValueAsObject(context, lVar));\n+        argList.add(getValueAsObject(context, rVar));\n+\n+        List<String> argTypeNames = new ArrayList<>();\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        RuntimeStaticMethod runtimeMethod = getRuntimeMethod(context, B_TYPE_CHECKER_CLASS, VALUE_EQUAL_METHOD,\n+                argTypeNames);\n+        runtimeMethod.setArgValues(argList);\n+        Value result = runtimeMethod.invoke();\n+        BVariable variable = VariableFactory.getVariable(context, result);\n+        boolean booleanValue = Boolean.parseBoolean(variable.getDapVariable().getValue());\n+        booleanValue = operatorType == SyntaxKind.DOUBLE_EQUAL_TOKEN ? booleanValue : !booleanValue;\n+        return EvaluationUtils.make(context, booleanValue);\n+    }\n+\n+    /**\n+     * Checks for reference equality.\n+     */\n+    private BExpressionValue checkReferenceEquality(BVariable lVar, BVariable rVar, SyntaxKind operatorType)\n+            throws EvaluationException {\n+        List<Value> argList = new ArrayList<>();\n+        argList.add(getValueAsObject(context, lVar));\n+        argList.add(getValueAsObject(context, rVar));\n+\n+        List<String> argTypeNames = new ArrayList<>();\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        argTypeNames.add(JAVA_OBJECT_CLASS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2NDkzNA==", "bodyText": "#26322 (comment)", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505464934", "createdAt": "2020-10-15T11:25:05Z", "author": {"login": "NipunaRanasinghe"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/BinaryExpressionEvaluator.java", "diffHunk": "@@ -387,6 +403,50 @@ private BExpressionValue conditionalReturn(BVariable lVar, BVariable rVar) {\n         }\n     }\n \n+    /**\n+     * Checks for deep value equality.\n+     */\n+    private BExpressionValue checkValueEquality(BVariable lVar, BVariable rVar, SyntaxKind operatorType)\n+            throws EvaluationException {\n+        List<Value> argList = new ArrayList<>();\n+        argList.add(getValueAsObject(context, lVar));\n+        argList.add(getValueAsObject(context, rVar));\n+\n+        List<String> argTypeNames = new ArrayList<>();\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        RuntimeStaticMethod runtimeMethod = getRuntimeMethod(context, B_TYPE_CHECKER_CLASS, VALUE_EQUAL_METHOD,\n+                argTypeNames);\n+        runtimeMethod.setArgValues(argList);\n+        Value result = runtimeMethod.invoke();\n+        BVariable variable = VariableFactory.getVariable(context, result);\n+        boolean booleanValue = Boolean.parseBoolean(variable.getDapVariable().getValue());\n+        booleanValue = operatorType == SyntaxKind.DOUBLE_EQUAL_TOKEN ? booleanValue : !booleanValue;\n+        return EvaluationUtils.make(context, booleanValue);\n+    }\n+\n+    /**\n+     * Checks for reference equality.\n+     */\n+    private BExpressionValue checkReferenceEquality(BVariable lVar, BVariable rVar, SyntaxKind operatorType)\n+            throws EvaluationException {\n+        List<Value> argList = new ArrayList<>();\n+        argList.add(getValueAsObject(context, lVar));\n+        argList.add(getValueAsObject(context, rVar));\n+\n+        List<String> argTypeNames = new ArrayList<>();\n+        argTypeNames.add(JAVA_OBJECT_CLASS);\n+        argTypeNames.add(JAVA_OBJECT_CLASS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ0Mjc5Nw=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjA2Nzg1OnYy", "diffSide": "RIGHT", "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmInstanceMethod.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMDo1ODo0OFrOHiCTNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNTozODo1NlrOHiOE3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ1MTMxOQ==", "bodyText": "getMethodArgs(JvmMethod method) method is almost repeated in JvmStaticMethod and JvmInstanceMethod. Shall we add them to a Util class and use it from there?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505451319", "createdAt": "2020-10-15T10:58:48Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmInstanceMethod.java", "diffHunk": "@@ -57,8 +65,44 @@ public Value invoke() throws EvaluationException {\n         } catch (EvaluationException e) {\n             throw e;\n         } catch (Exception e) {\n-            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR\n-                    .getString(), methodRef.name()));\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));\n+        }\n+    }\n+\n+    @Override\n+    protected List<Value> getMethodArgs(JvmMethod method) throws EvaluationException {\n+        try {\n+            if (argValues == null && argEvaluators == null) {\n+                throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR\n+                        .getString(), methodRef.name()));\n+            }\n+            if (argValues != null) {\n+                return argValues;\n+            }\n+            List<Value> argValueList = new ArrayList<>();\n+            // Evaluates all function argument expressions at first.\n+            for (Evaluator argEvaluator : argEvaluators) {\n+                argValueList.add(argEvaluator.evaluate().getJdiValue());\n+                // Assuming all the arguments are positional args.\n+                argValueList.add(EvaluationUtils.make(context, true).getJdiValue());\n+            }\n+\n+            List<Type> types = method.methodRef.argumentTypes();\n+            // Removes injected arguments added during the jvm method gen phase.\n+            for (int index = types.size() - 1; index >= 0; index -= 2) {\n+                types.remove(index);\n+            }\n+\n+            // Todo - IMPORTANT: Add remaining steps to validate and match named, defaultable and rest args\n+            // Todo - verify\n+            // Here we use the parent strand instance to execute the function invocation expression.\n+            Value parentStrand = getParentStrand();\n+            argValueList.add(0, parentStrand);\n+            return argValueList;\n+        } catch (ClassNotLoadedException e) {\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2OTUxNA==", "bodyText": "What happens inside the getMethodArgs() depends on the method type and therefore I've declared it as abstract in the parent class(org.ballerinalang.debugadapter.evaluation.engine.JvmMethod). WDYT?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505469514", "createdAt": "2020-10-15T11:33:31Z", "author": {"login": "NipunaRanasinghe"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmInstanceMethod.java", "diffHunk": "@@ -57,8 +65,44 @@ public Value invoke() throws EvaluationException {\n         } catch (EvaluationException e) {\n             throw e;\n         } catch (Exception e) {\n-            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR\n-                    .getString(), methodRef.name()));\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));\n+        }\n+    }\n+\n+    @Override\n+    protected List<Value> getMethodArgs(JvmMethod method) throws EvaluationException {\n+        try {\n+            if (argValues == null && argEvaluators == null) {\n+                throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR\n+                        .getString(), methodRef.name()));\n+            }\n+            if (argValues != null) {\n+                return argValues;\n+            }\n+            List<Value> argValueList = new ArrayList<>();\n+            // Evaluates all function argument expressions at first.\n+            for (Evaluator argEvaluator : argEvaluators) {\n+                argValueList.add(argEvaluator.evaluate().getJdiValue());\n+                // Assuming all the arguments are positional args.\n+                argValueList.add(EvaluationUtils.make(context, true).getJdiValue());\n+            }\n+\n+            List<Type> types = method.methodRef.argumentTypes();\n+            // Removes injected arguments added during the jvm method gen phase.\n+            for (int index = types.size() - 1; index >= 0; index -= 2) {\n+                types.remove(index);\n+            }\n+\n+            // Todo - IMPORTANT: Add remaining steps to validate and match named, defaultable and rest args\n+            // Todo - verify\n+            // Here we use the parent strand instance to execute the function invocation expression.\n+            Value parentStrand = getParentStrand();\n+            argValueList.add(0, parentStrand);\n+            return argValueList;\n+        } catch (ClassNotLoadedException e) {\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ1MTMxOQ=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY0NDI1NA==", "bodyText": "+1 for declaring it as abstract in the parent class.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505644254", "createdAt": "2020-10-15T15:38:56Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmInstanceMethod.java", "diffHunk": "@@ -57,8 +65,44 @@ public Value invoke() throws EvaluationException {\n         } catch (EvaluationException e) {\n             throw e;\n         } catch (Exception e) {\n-            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR\n-                    .getString(), methodRef.name()));\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));\n+        }\n+    }\n+\n+    @Override\n+    protected List<Value> getMethodArgs(JvmMethod method) throws EvaluationException {\n+        try {\n+            if (argValues == null && argEvaluators == null) {\n+                throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR\n+                        .getString(), methodRef.name()));\n+            }\n+            if (argValues != null) {\n+                return argValues;\n+            }\n+            List<Value> argValueList = new ArrayList<>();\n+            // Evaluates all function argument expressions at first.\n+            for (Evaluator argEvaluator : argEvaluators) {\n+                argValueList.add(argEvaluator.evaluate().getJdiValue());\n+                // Assuming all the arguments are positional args.\n+                argValueList.add(EvaluationUtils.make(context, true).getJdiValue());\n+            }\n+\n+            List<Type> types = method.methodRef.argumentTypes();\n+            // Removes injected arguments added during the jvm method gen phase.\n+            for (int index = types.size() - 1; index >= 0; index -= 2) {\n+                types.remove(index);\n+            }\n+\n+            // Todo - IMPORTANT: Add remaining steps to validate and match named, defaultable and rest args\n+            // Todo - verify\n+            // Here we use the parent strand instance to execute the function invocation expression.\n+            Value parentStrand = getParentStrand();\n+            argValueList.add(0, parentStrand);\n+            return argValueList;\n+        } catch (ClassNotLoadedException e) {\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ1MTMxOQ=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjA3MDkwOnYy", "diffSide": "RIGHT", "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmStaticMethod.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMDo1OTo0NlrOHiCVMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTozMzo0NFrOHiDatg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ1MTgyNA==", "bodyText": "Repeated method mentioned in here", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505451824", "createdAt": "2020-10-15T10:59:46Z", "author": {"login": "praveennadarajah"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmStaticMethod.java", "diffHunk": "@@ -63,4 +71,40 @@ public Value invoke() throws EvaluationException {\n                     .getString(), methodRef.name()));\n         }\n     }\n+\n+    @Override\n+    protected List<Value> getMethodArgs(JvmMethod method) throws EvaluationException {\n+        try {\n+            if (argValues == null && argEvaluators == null) {\n+                throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString()\n+                        , methodRef.name()));\n+            }\n+            if (argValues != null) {\n+                return argValues;\n+            }\n+            List<Value> argValueList = new ArrayList<>();\n+            // Evaluates all function argument expressions at first.\n+            for (Evaluator argEvaluator : argEvaluators) {\n+                argValueList.add(argEvaluator.evaluate().getJdiValue());\n+                // Assuming all the arguments are positional args.\n+                argValueList.add(EvaluationUtils.make(context, true).getJdiValue());\n+            }\n+\n+            List<Type> types = method.methodRef.argumentTypes();\n+            // Removes injected arguments added during the jvm method gen phase.\n+            for (int index = types.size() - 1; index >= 0; index -= 2) {\n+                types.remove(index);\n+            }\n+\n+            // Todo - IMPORTANT: Add remaining steps to validate and match named, defaultable and rest args\n+            // Todo - verify\n+            // Here we use the parent strand instance to execute the function invocation expression.\n+            Value parentStrand = getParentStrand();\n+            argValueList.add(0, parentStrand);\n+            return argValueList;\n+        } catch (ClassNotLoadedException e) {\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2OTYyMg==", "bodyText": "#26322 (comment)", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26322#discussion_r505469622", "createdAt": "2020-10-15T11:33:44Z", "author": {"login": "NipunaRanasinghe"}, "path": "misc/debug-adapter/modules/debug-adapter-core/src/main/java/org/ballerinalang/debugadapter/evaluation/engine/JvmStaticMethod.java", "diffHunk": "@@ -63,4 +71,40 @@ public Value invoke() throws EvaluationException {\n                     .getString(), methodRef.name()));\n         }\n     }\n+\n+    @Override\n+    protected List<Value> getMethodArgs(JvmMethod method) throws EvaluationException {\n+        try {\n+            if (argValues == null && argEvaluators == null) {\n+                throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString()\n+                        , methodRef.name()));\n+            }\n+            if (argValues != null) {\n+                return argValues;\n+            }\n+            List<Value> argValueList = new ArrayList<>();\n+            // Evaluates all function argument expressions at first.\n+            for (Evaluator argEvaluator : argEvaluators) {\n+                argValueList.add(argEvaluator.evaluate().getJdiValue());\n+                // Assuming all the arguments are positional args.\n+                argValueList.add(EvaluationUtils.make(context, true).getJdiValue());\n+            }\n+\n+            List<Type> types = method.methodRef.argumentTypes();\n+            // Removes injected arguments added during the jvm method gen phase.\n+            for (int index = types.size() - 1; index >= 0; index -= 2) {\n+                types.remove(index);\n+            }\n+\n+            // Todo - IMPORTANT: Add remaining steps to validate and match named, defaultable and rest args\n+            // Todo - verify\n+            // Here we use the parent strand instance to execute the function invocation expression.\n+            Value parentStrand = getParentStrand();\n+            argValueList.add(0, parentStrand);\n+            return argValueList;\n+        } catch (ClassNotLoadedException e) {\n+            throw new EvaluationException(String.format(EvaluationExceptionKind.FUNCTION_EXECUTION_ERROR.getString(),\n+                    methodRef.name()));\n+        }\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ1MTgyNA=="}, "originalCommit": {"oid": "7d9ee1ba3f08f3c5043f3cdf21ec66f601e472a2"}, "originalPosition": 80}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4714, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}