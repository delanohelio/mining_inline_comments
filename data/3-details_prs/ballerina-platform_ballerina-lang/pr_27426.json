{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NjMzNzU3", "number": 27426, "title": "[Formatter] Align Formatter with Service Changes", "bodyText": "Purpose\n\n\n\nFix the formatting tree modifier nodes for the newly introduced service changes at: #27305\nEnable and fix all minor changes in the class definition declaration formatting test cases\n\nFixes #27133\nApproach\n\nFix the transform methods in the formatting tree modifier\n\nSamples\nRemarks\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-12-10T04:42:11Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426", "merged": true, "mergeCommit": {"oid": "36f41fb437cb1ab2c761e41bfed907c0157cc63b"}, "closed": true, "closedAt": "2020-12-15T16:15:49Z", "author": {"login": "sanjana"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiwoWzgH2gAyNTM1NjMzNzU3OjAyMTczYWVkZjAxNmQ3YjBjOGVlNTJhMDU3YzFmZTIyMzI1YjA2ZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmcvRcAFqTU1MjYyNjg5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "02173aedf016d7b0c8ee52a057c1fe22325b06d2", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/02173aedf016d7b0c8ee52a057c1fe22325b06d2", "committedDate": "2020-12-04T05:10:11Z", "message": "Fix ServiceDeclarationNode in formatting tree modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ae32a92374417c6b7b0d68b151dab0c2612de2a", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0ae32a92374417c6b7b0d68b151dab0c2612de2a", "committedDate": "2020-12-04T05:15:05Z", "message": "Merge remote-tracking branch 'upstream/service-typing' into service-typing-anjanasi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "238f70dcc1e50b04a0fd59950a278a20e68484e6", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/238f70dcc1e50b04a0fd59950a278a20e68484e6", "committedDate": "2020-12-04T05:21:49Z", "message": "Enable Service listener declarations test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa97c6a016246f017627074cb01f5e98b9f28089", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fa97c6a016246f017627074cb01f5e98b9f28089", "committedDate": "2020-12-09T11:02:29Z", "message": "Fix ObjectFieldNode formatting tree modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57d2d76d7b1facfb37028ecc17920af0e65a06b6", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/57d2d76d7b1facfb37028ecc17920af0e65a06b6", "committedDate": "2020-12-10T00:37:01Z", "message": "Merge remote-tracking branch 'upstream/master' into service-typing-anjanasi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0d7215eaa0c4c1492a44fc6b1d96c52759ce130", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e0d7215eaa0c4c1492a44fc6b1d96c52759ce130", "committedDate": "2020-12-10T01:17:47Z", "message": "Fix AnnotationAttachPointNode in formatting tree modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce16b32b671d0911077c6dd9b8df91df740179e9", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ce16b32b671d0911077c6dd9b8df91df740179e9", "committedDate": "2020-12-10T04:26:17Z", "message": "Remove public keyword form class remote function formatter test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "230106045dfab81f5ff7892c5c85d0ee9fd09539", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/230106045dfab81f5ff7892c5c85d0ee9fd09539", "committedDate": "2020-12-10T04:29:11Z", "message": "Merge remote-tracking branch 'upstream/master' into service-typing-anjanasi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fa2a6713f6e5f2c7b5ed571d34b7bd6d82ad106", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6fa2a6713f6e5f2c7b5ed571d34b7bd6d82ad106", "committedDate": "2020-12-10T04:37:37Z", "message": "Fix and enable class definition declaration formatter tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c24a332e68e9d37b250bdf2262004ad365c09458", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c24a332e68e9d37b250bdf2262004ad365c09458", "committedDate": "2020-12-10T14:54:44Z", "message": "Implent the ResourcePathParameterNode in formatting tree modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1087bdaba11e12a7715173eab75a6155c9074f91", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1087bdaba11e12a7715173eab75a6155c9074f91", "committedDate": "2020-12-11T02:20:41Z", "message": "Skip service related recovery test cases in parser formatting tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99eed9906d3f321902a4b487b696850e31fedc03", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/99eed9906d3f321902a4b487b696850e31fedc03", "committedDate": "2020-12-11T02:21:33Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into service-typing-anjanasi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b2f80d2adb1a384e322a2de04e04a190f30546a2", "committedDate": "2020-12-11T02:31:38Z", "message": "Fix checkstyle issue in FormattingTreeModifier"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDIzNDgy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-551023482", "createdAt": "2020-12-14T03:37:17Z", "commit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwMzozNzoxN1rOIE-ipg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwMzo1NToyMlrOIE-16A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA4OTg5NA==", "bodyText": "Do we need to check the empty-ness?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542089894", "createdAt": "2020-12-14T03:37:17Z", "author": {"login": "SupunS"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -596,19 +630,30 @@ public ImportPrefixNode transform(ImportPrefixNode importPrefixNode) {\n     public ServiceDeclarationNode transform(ServiceDeclarationNode serviceDeclarationNode) {\n         MetadataNode metadata = formatNode(serviceDeclarationNode.metadata().orElse(null), 0, 1);\n         Token serviceKeyword = formatToken(serviceDeclarationNode.serviceKeyword(), 1, 0);\n-        //IdentifierToken serviceName = formatToken(serviceDeclarationNode.serviceName().orElse(null), 1, 0);\n+        TypeDescriptorNode typeDescriptor = formatNode(serviceDeclarationNode.typeDescriptor().orElse(null), 1, 0);\n+        NodeList<Node> absoluteResourcePath = formatNodeList(serviceDeclarationNode.absoluteResourcePath(), 0, 0, 1, 0);\n         Token onKeyword = formatToken(serviceDeclarationNode.onKeyword(), 1, 0);\n         SeparatedNodeList<ExpressionNode> expressions =\n                 formatSeparatedNodeList(serviceDeclarationNode.expressions(), 0, 0, 1, 0);\n-        //Node serviceBody = formatNode(serviceDeclarationNode.serviceBody(), env.trailingWS, env.trailingNL);\n+        Token openBrace = formatToken(serviceDeclarationNode.openBraceToken(), 0, 1);\n+        indent(); // increase the indentation of the following statements.\n+        NodeList<Node> members = formatNodeList(serviceDeclarationNode.members(), 0, 1, 0, 1, true);\n+        unindent(); // reset the indentation.\n+        if (serviceDeclarationNode.members().isEmpty()) {\n+            env.preserveNewlines = true;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA5MjM3OQ==", "bodyText": "No changes required to the MethodDeclarationNode?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542092379", "createdAt": "2020-12-14T03:47:00Z", "author": {"login": "SupunS"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -281,7 +282,14 @@ public FunctionDefinitionNode transform(FunctionDefinitionNode functionDefinitio\n         MetadataNode metadata = formatNode(functionDefinitionNode.metadata().orElse(null), 0, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA5Mjc5NA==", "bodyText": "Why are we not keeping a space for func-name, if the first component of relative path is missing?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542092794", "createdAt": "2020-12-14T03:48:30Z", "author": {"login": "SupunS"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -281,7 +282,14 @@ public FunctionDefinitionNode transform(FunctionDefinitionNode functionDefinitio\n         MetadataNode metadata = formatNode(functionDefinitionNode.metadata().orElse(null), 0, 1);\n         NodeList<Token> qualifierList = formatNodeList(functionDefinitionNode.qualifierList(), 1, 0, 1, 0);\n         Token functionKeyword = formatToken(functionDefinitionNode.functionKeyword(), 1, 0);\n-        IdentifierToken functionName = formatToken(functionDefinitionNode.functionName(), 0, 0);\n+        IdentifierToken functionName;\n+        if (functionDefinitionNode.relativeResourcePath().isEmpty() ||\n+                functionDefinitionNode.relativeResourcePath().get(0).isMissing()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA5NDgyNA==", "bodyText": "Why do we have to skip these tests?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542094824", "createdAt": "2020-12-14T03:55:22Z", "author": {"login": "SupunS"}, "path": "misc/formatter/modules/formatter-core/src/test/java/org/ballerinalang/formatter/core/ParserTestFormatter.java", "diffHunk": "@@ -88,6 +88,8 @@ public void test(String fileName, String path) throws IOException {\n                 \"typed_binding_patterns_source_16.bal\", // parser issue for binding patterns #26421\n                 \"error_binding_pattern_source_02.bal\", // issue #26376\n \n+                \"service_decl_source_02.bal\", \"service_decl_source_05.bal\", \"service_decl_source_17.bal\",\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDQwNDg0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-551040484", "createdAt": "2020-12-14T04:46:19Z", "commit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNDo0NjoxOVrOIE_skg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNDo0NjoxOVrOIE_skg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODgxOA==", "bodyText": "The qualifiers [1] need to be formatted here as well right?\n[1] \n  \n    \n      ballerina-lang/compiler/ballerina-parser/src/main/java/io/ballerina/compiler/syntax/tree/TreeModifier.java\n    \n    \n         Line 157\n      in\n      f919b1d\n    \n    \n    \n    \n\n        \n          \n           NodeList<Token> qualifiers =", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542108818", "createdAt": "2020-12-14T04:46:19Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -596,19 +630,30 @@ public ImportPrefixNode transform(ImportPrefixNode importPrefixNode) {\n     public ServiceDeclarationNode transform(ServiceDeclarationNode serviceDeclarationNode) {\n         MetadataNode metadata = formatNode(serviceDeclarationNode.metadata().orElse(null), 0, 1);\n         Token serviceKeyword = formatToken(serviceDeclarationNode.serviceKeyword(), 1, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDQ4MjY3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-551048267", "createdAt": "2020-12-14T05:14:37Z", "commit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNToxNDozN1rOIFALrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNToxNDozN1rOIFALrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjExNjc4Mg==", "bodyText": "Shall we implement the RequiredExpressionNode [1] as well in this PR? Seems to be a new node.\n[1] \n  \n    \n      ballerina-lang/compiler/ballerina-parser/src/main/java/io/ballerina/compiler/syntax/tree/TreeModifier.java\n    \n    \n         Line 3157\n      in\n      f919b1d\n    \n    \n    \n    \n\n        \n          \n           public RequiredExpressionNode transform(", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542116782", "createdAt": "2020-12-14T05:14:37Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -160,6 +160,7 @@\n import io.ballerina.compiler.syntax.tree.RecordTypeDescriptorNode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDUyNzM3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-551052737", "createdAt": "2020-12-14T05:28:48Z", "commit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNToyODo0OFrOIFAc6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNToyODo0OFrOIFAc6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEyMTE5NA==", "bodyText": "Can we change this to the following?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    NodeList<Token> identifiers = formatNodeList(annotationAttachPointNode.identifiers(), 1, 0, 0, 0);\n          \n          \n            \n                    NodeList<Token> identifiers = formatNodeList(annotationAttachPointNode.identifiers(), 1, 0, env.trailingWS, env.trailingNL);", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r542121194", "createdAt": "2020-12-14T05:28:48Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -2307,19 +2352,10 @@ public AnnotationDeclarationNode transform(AnnotationDeclarationNode annotationD\n     @Override\n     public AnnotationAttachPointNode transform(AnnotationAttachPointNode annotationAttachPointNode) {\n         Token sourceKeyword = formatToken(annotationAttachPointNode.sourceKeyword().orElse(null), 1, 0);\n-//        Token firstIdent;\n-//        if (annotationAttachPointNode.secondIdent().isPresent()) {\n-//            firstIdent = formatToken(annotationAttachPointNode.firstIdent(), 1, 0);\n-//        } else {\n-//            firstIdent = formatToken(annotationAttachPointNode.firstIdent(), env.trailingWS, env.trailingNL);\n-//        }\n-//\n-//        Token secondIdent = formatToken(annotationAttachPointNode.secondIdent().orElse(null), env.trailingWS,\n-//                env.trailingNL);\n+        NodeList<Token> identifiers = formatNodeList(annotationAttachPointNode.identifiers(), 1, 0, 0, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f80d2adb1a384e322a2de04e04a190f30546a2"}, "originalPosition": 146}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed17e1dc573311bec9438ed6f95de353477a6c9b", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ed17e1dc573311bec9438ed6f95de353477a6c9b", "committedDate": "2020-12-14T05:43:14Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into service-typing-anjanasi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28c7bcab80ae1b8988019c7beee6053d04290524", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/28c7bcab80ae1b8988019c7beee6053d04290524", "committedDate": "2020-12-14T06:24:01Z", "message": "Format relativeResourcePath in MethodDeclarationNode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27418faa6f61ad9de98bad8412892deda2311bcd", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/27418faa6f61ad9de98bad8412892deda2311bcd", "committedDate": "2020-12-14T11:50:23Z", "message": "Preserve newlines in block statements of formatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ff022ab14c7af4c60baac1f57304f37b5deaa0a", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7ff022ab14c7af4c60baac1f57304f37b5deaa0a", "committedDate": "2020-12-14T12:06:11Z", "message": "Fix service listener resource function test case formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46c9be62880d57e3a0e4ae3f2e1fd033a43a800d", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/46c9be62880d57e3a0e4ae3f2e1fd033a43a800d", "committedDate": "2020-12-15T12:12:12Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into service-typing-anjanasi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a891c9dc5d35f413ee626f222edda1d5cbcb436", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7a891c9dc5d35f413ee626f222edda1d5cbcb436", "committedDate": "2020-12-15T08:43:13Z", "message": "Implement RequiredExpressionNode in formatter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNDE0ODUx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-552414851", "createdAt": "2020-12-15T12:48:36Z", "commit": {"oid": "7a891c9dc5d35f413ee626f222edda1d5cbcb436"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjo0ODozNlrOIGJODw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjo0ODozNlrOIGJODw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzMxMzQyMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Token questionMarkToken = formatToken(requiredExpressionNode.questionMarkToken(), 0, 0);\n          \n          \n            \n                    Token questionMarkToken = formatToken(requiredExpressionNode.questionMarkToken(), env.trailingWS, env.trailingNL);", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#discussion_r543313423", "createdAt": "2020-12-15T12:48:36Z", "author": {"login": "IrushiL"}, "path": "misc/formatter/modules/formatter-core/src/main/java/org/ballerinalang/formatter/core/FormattingTreeModifier.java", "diffHunk": "@@ -595,20 +626,39 @@ public ImportPrefixNode transform(ImportPrefixNode importPrefixNode) {\n     @Override\n     public ServiceDeclarationNode transform(ServiceDeclarationNode serviceDeclarationNode) {\n         MetadataNode metadata = formatNode(serviceDeclarationNode.metadata().orElse(null), 0, 1);\n+        NodeList<Token> qualifiers = formatNodeList(serviceDeclarationNode.qualifiers(), 1, 0, 1, 0);\n         Token serviceKeyword = formatToken(serviceDeclarationNode.serviceKeyword(), 1, 0);\n-        //IdentifierToken serviceName = formatToken(serviceDeclarationNode.serviceName().orElse(null), 1, 0);\n+        TypeDescriptorNode typeDescriptor = formatNode(serviceDeclarationNode.typeDescriptor().orElse(null), 1, 0);\n+        NodeList<Node> absoluteResourcePath = formatNodeList(serviceDeclarationNode.absoluteResourcePath(), 0, 0, 1, 0);\n         Token onKeyword = formatToken(serviceDeclarationNode.onKeyword(), 1, 0);\n         SeparatedNodeList<ExpressionNode> expressions =\n                 formatSeparatedNodeList(serviceDeclarationNode.expressions(), 0, 0, 1, 0);\n-        //Node serviceBody = formatNode(serviceDeclarationNode.serviceBody(), env.trailingWS, env.trailingNL);\n+        Token openBrace = formatToken(serviceDeclarationNode.openBraceToken(), 0, 1);\n+        indent(); // increase the indentation of the following statements.\n+        NodeList<Node> members = formatNodeList(serviceDeclarationNode.members(), 0, 1, 0, 1, true);\n+        unindent(); // reset the indentation.\n+        env.preserveNewlines = true;\n+        Token closeBrace = formatToken(serviceDeclarationNode.closeBraceToken(), env.trailingWS, env.trailingNL);\n \n         return serviceDeclarationNode.modify()\n                 .withMetadata(metadata)\n+                .withQualifiers(qualifiers)\n                 .withServiceKeyword(serviceKeyword)\n-                //.withServiceName(serviceName)\n+                .withTypeDescriptor(typeDescriptor)\n+                .withAbsoluteResourcePath(absoluteResourcePath)\n                 .withOnKeyword(onKeyword)\n                 .withExpressions(expressions)\n-                //.withServiceBody(serviceBody)\n+                .withOpenBraceToken(openBrace)\n+                .withMembers(members)\n+                .withCloseBraceToken(closeBrace)\n+                .apply();\n+    }\n+\n+    @Override\n+    public RequiredExpressionNode transform(RequiredExpressionNode requiredExpressionNode) {\n+        Token questionMarkToken = formatToken(requiredExpressionNode.questionMarkToken(), 0, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a891c9dc5d35f413ee626f222edda1d5cbcb436"}, "originalPosition": 119}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfa094895c2e599af95eb7de406aab231bc7b891", "author": {"user": {"login": "sanjana", "name": "Sivanandan Anjana"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bfa094895c2e599af95eb7de406aab231bc7b891", "committedDate": "2020-12-15T12:55:47Z", "message": "Use env newlines and whitespaces in RequiredExpressionNode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNDI4NDcz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-552428473", "createdAt": "2020-12-15T13:05:29Z", "commit": {"oid": "bfa094895c2e599af95eb7de406aab231bc7b891"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNjI2ODk0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27426#pullrequestreview-552626894", "createdAt": "2020-12-15T16:15:20Z", "commit": {"oid": "bfa094895c2e599af95eb7de406aab231bc7b891"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4788, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}