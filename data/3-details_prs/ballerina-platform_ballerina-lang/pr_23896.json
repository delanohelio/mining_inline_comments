{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyNTc5ODkw", "number": 23896, "title": "Fix webSocket test errrors", "bodyText": "Purpose\n$Subject\nFixes #23634\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-06-10T16:48:07Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23896", "merged": true, "mergeCommit": {"oid": "202fc98c4101b539eda93bb72e9288b582b9b47f"}, "closed": true, "closedAt": "2020-06-11T15:27:02Z", "author": {"login": "kalaiyarasiganeshalingam"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpxHmzAH2gAyNDMyNTc5ODkwOjdmZGJhMzk2YzMzZWFiOWQ1NzM0ZWIyNjVjMzZlMjc4OTJmN2ZlZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqP9f5gFqTQyOTAyNzc3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7fdba396c33eab9d5734eb265c36e27892f7fefc", "author": {"user": {"login": "kalaiyarasiganeshalingam", "name": "Kalaiyarasi Ganeshalingam"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7fdba396c33eab9d5734eb265c36e27892f7fefc", "committedDate": "2020-06-10T03:30:38Z", "message": "Merge branch 'http-mod' of https://github.com/chamil321/ballerina into grpc_error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bbee377da34cd56b4989a2981d82bfb8e24ea74", "author": {"user": {"login": "kalaiyarasiganeshalingam", "name": "Kalaiyarasi Ganeshalingam"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9bbee377da34cd56b4989a2981d82bfb8e24ea74", "committedDate": "2020-06-10T14:39:36Z", "message": "Fix webSocket test errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a79186ca882841d5cb09ff6fb690afee2cd73867", "author": {"user": {"login": "kalaiyarasiganeshalingam", "name": "Kalaiyarasi Ganeshalingam"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a79186ca882841d5cb09ff6fb690afee2cd73867", "committedDate": "2020-06-10T16:43:52Z", "message": "Remove printStream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5671532b7ff8346307914ac251e082bfe502a3c9", "author": {"user": {"login": "kalaiyarasiganeshalingam", "name": "Kalaiyarasi Ganeshalingam"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5671532b7ff8346307914ac251e082bfe502a3c9", "committedDate": "2020-06-11T06:06:17Z", "message": "Merge branch '23283-add-distinct-type' of https://github.com/ballerina-platform/ballerina-lang into grpc_error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjA5OTIz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23896#pullrequestreview-428609923", "createdAt": "2020-06-11T05:52:04Z", "commit": {"oid": "a79186ca882841d5cb09ff6fb690afee2cd73867"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNTo1MjowNVrOGiPYyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNTo1MjowNVrOGiPYyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU1Njg3Mw==", "bodyText": "Did you check this with lang team? Why do we need the typeId?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23896#discussion_r438556873", "createdAt": "2020-06-11T05:52:05Z", "author": {"login": "chamil321"}, "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/BallerinaErrors.java", "diffHunk": "@@ -121,7 +121,7 @@ public static ErrorValue createDistinctError(String typeIdName, BPackage typeIdP\n         return error;\n     }\n \n-    private static void setTypeId(String typeIdName, BPackage typeIdPkg, ErrorValue error) {\n+    public static void setTypeId(String typeIdName, BPackage typeIdPkg, ErrorValue error) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79186ca882841d5cb09ff6fb690afee2cd73867"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjMyMDQz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23896#pullrequestreview-428632043", "createdAt": "2020-06-11T06:43:32Z", "commit": {"oid": "a79186ca882841d5cb09ff6fb690afee2cd73867"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo0MzozMlrOGiQdSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo0MzozMlrOGiQdSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU3NDQxMQ==", "bodyText": "Unless we trap this error in Ballerina and convert to a error value, I don't think we need to do this here.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23896#discussion_r438574411", "createdAt": "2020-06-11T06:43:32Z", "author": {"login": "rdhananjaya"}, "path": "stdlib/http/src/main/java/org/ballerinalang/net/http/websocket/WebSocketUtil.java", "diffHunk": "@@ -575,6 +576,28 @@ public static void countDownForHandshake(ObjectValue webSocketClient) {\n         }\n     }\n \n+    public static WebSocketException getWebSocketException(String msg, Throwable error, String errorCode,\n+                                                           ErrorValue cause) {\n+        WebSocketException exception;\n+        String message = errorCode.substring(2) + \": \" + msg;\n+        if (!msg.isEmpty()) {\n+            exception = new WebSocketException(message);\n+        } else if (error != null) {\n+            exception = new WebSocketException(error);\n+        } else {\n+            exception = new WebSocketException(message, cause);\n+        }\n+        BallerinaErrors.setTypeId(errorCode, WebSocketConstants.PROTOCOL_HTTP_PKG_ID, exception);\n+        return exception;\n+    }\n+\n+    public static void setNotifyFailure(String msg, NonBlockingCallback callback) {\n+        WebSocketException exception = new WebSocketException(msg);\n+        BallerinaErrors.setTypeId(WebSocketConstants.ErrorCode.WsInvalidHandshakeError.toString(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79186ca882841d5cb09ff6fb690afee2cd73867"}, "originalPosition": 132}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ab9f00960e4839d18cff8de0417472e5d6371ee", "author": {"user": {"login": "kalaiyarasiganeshalingam", "name": "Kalaiyarasi Ganeshalingam"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5ab9f00960e4839d18cff8de0417472e5d6371ee", "committedDate": "2020-06-11T14:19:17Z", "message": "Improve the implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MDI3Nzc3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23896#pullrequestreview-429027777", "createdAt": "2020-06-11T15:26:39Z", "commit": {"oid": "5ab9f00960e4839d18cff8de0417472e5d6371ee"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4351, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}