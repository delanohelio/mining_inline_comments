{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1Mjk2NTEz", "number": 25511, "title": "Align parser for swan lake object changes", "bodyText": "Purpose\n\nAlign parser with new parser rules for object type\nAdd error recovery support for object constructor expression\nSupport parsing class annotation declarations\nFix bugs in  class definition error recovery\n\nFixes #25312, #25284, #25187, #25038\nApproach\nN/A\nSamples\nN/A\nRemarks\nN/A\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-08-28T09:31:51Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511", "merged": true, "mergeCommit": {"oid": "7a26256254d80aedb15f3d351c4aaf40dd373c64"}, "closed": true, "closedAt": "2020-09-03T12:49:33Z", "author": {"login": "lochana-chathura"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCV2UKgH2gAyNDc1Mjk2NTEzOmYyMTI3MmY0MGJiZjBjMWI5Y2MwNWJmNDY1YTBmN2FjMzIxMDc3Yjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFQDnMgFqTQ4MTgwMzgwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f21272f40bbf0c1b9cc05bf465a0f7ac321077b8", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f21272f40bbf0c1b9cc05bf465a0f7ac321077b8", "committedDate": "2020-08-25T11:52:25Z", "message": "Support 'class' attach-point for annotation declarations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b915b7896f823177d7272acb3fc161dfcb8b5ef8", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b915b7896f823177d7272acb3fc161dfcb8b5ef8", "committedDate": "2020-08-25T11:58:34Z", "message": "Fix DiagnosticErrorCode for class keyword"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78c8b226c51f9a7f7cbbc6d73d1cc29914acada2", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/78c8b226c51f9a7f7cbbc6d73d1cc29914acada2", "committedDate": "2020-08-26T03:47:52Z", "message": "Merge branch 'class-change' of https://github.com/ballerina-platform/ballerina-lang into obect-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81596f1de1e52c3fb6bd28f988ed3dd2020c943d", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/81596f1de1e52c3fb6bd28f988ed3dd2020c943d", "committedDate": "2020-08-26T13:20:55Z", "message": "Merge branch 'class-change' of https://github.com/ballerina-platform/ballerina-lang into obect-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a8d9817f85b9dc1c07b64080fc0e6513ed2937e", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6a8d9817f85b9dc1c07b64080fc0e6513ed2937e", "committedDate": "2020-08-27T15:00:27Z", "message": "Align parser with new parser rules for object type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NjUyNDY3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#pullrequestreview-477652467", "createdAt": "2020-08-28T11:27:58Z", "commit": {"oid": "b441b6393a8b48d8f67d174d397bbbae2d5ff975"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMToyNzo1OFrOHI9n5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMToyNzo1OFrOHI9n5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTE2MDI5NA==", "bodyText": "getErrorCode(Syntaxkind expectedKind) will be removed soon. There is a new method introduced getErrorCode(ParserRuleContext currentCtx) Please add all new contexts which u introduce to that method as u add in getExpectedToken in ErrorHandler.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#discussion_r479160294", "createdAt": "2020-08-28T11:27:58Z", "author": {"login": "rdulmina"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/SyntaxErrors.java", "diffHunk": "@@ -240,6 +240,8 @@ private static DiagnosticCode getErrorCode(SyntaxKind expectedKind) {\n                 return DiagnosticErrorCode.ERROR_MISSING_JOIN_KEYWORD;\n             case OUTER_KEYWORD:\n                 return DiagnosticErrorCode.ERROR_MISSING_OUTER_KEYWORD;\n+            case CLASS_KEYWORD:\n+                return DiagnosticErrorCode.ERROR_MISSING_CLASS_KEYWORD;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b441b6393a8b48d8f67d174d397bbbae2d5ff975"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "483bd4ca1adfb18899200edced327049c7c4ac35", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/483bd4ca1adfb18899200edced327049c7c4ac35", "committedDate": "2020-08-31T20:00:27Z", "message": "Align valid syntax tests for new object type rules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4a3fd96ec6c0a1f41ef287f03d43686244c512c", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b4a3fd96ec6c0a1f41ef287f03d43686244c512c", "committedDate": "2020-08-31T20:00:28Z", "message": "Add object-constructor-expr error recovery support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c7443bdba8e10ddde53da7bcf654eccd7ee58a0", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2c7443bdba8e10ddde53da7bcf654eccd7ee58a0", "committedDate": "2020-08-31T20:00:28Z", "message": "Add object-constructor-expr error recovery test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd2979e1eb5d5936e58c8a10c17bc6b349c961c0", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cd2979e1eb5d5936e58c8a10c17bc6b349c961c0", "committedDate": "2020-08-31T20:00:28Z", "message": "Fix nested object-type-desc parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6bdd6e8a01e9dae45668b3908a1be93e6196a4", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1e6bdd6e8a01e9dae45668b3908a1be93e6196a4", "committedDate": "2020-08-31T20:00:28Z", "message": "Align recovery tests for new error recovery rules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f06a452a40255f46882014ce29fdaeaac1a88460", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f06a452a40255f46882014ce29fdaeaac1a88460", "committedDate": "2020-08-31T20:00:28Z", "message": "Improve object-constructor recovery for type-inclusion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45f468eff9eb32339926f1e01cab5d6956defc9f", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/45f468eff9eb32339926f1e01cab5d6956defc9f", "committedDate": "2020-08-31T20:00:28Z", "message": "Fix class definition name clash"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7933ed9dac26142ecc967e6b927b36c095227c34", "author": {"user": {"login": "rdhananjaya", "name": "Dhananjaya [Danje]"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7933ed9dac26142ecc967e6b927b36c095227c34", "committedDate": "2020-08-31T20:00:28Z", "message": "migrate annon objects to classes/obj ctor\n\nIf we did support object closures then we would have\nmigrated all of this to object constructor expressions."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2abe19f44968ee15f1031f289916d94aec0344a6", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2abe19f44968ee15f1031f289916d94aec0344a6", "committedDate": "2020-08-31T20:00:28Z", "message": "Update createBalo bal files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61fd5beda10b7962583dc25ef350c402b51503a0", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/61fd5beda10b7962583dc25ef350c402b51503a0", "committedDate": "2020-08-28T12:03:45Z", "message": "Improve object-constructor recovery when a type-inclusion is defined inside"}, "afterCommit": {"oid": "2abe19f44968ee15f1031f289916d94aec0344a6", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2abe19f44968ee15f1031f289916d94aec0344a6", "committedDate": "2020-08-31T20:00:28Z", "message": "Update createBalo bal files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1061dbd95a4edcb00de6505d423182364c68896a", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1061dbd95a4edcb00de6505d423182364c68896a", "committedDate": "2020-08-31T20:06:49Z", "message": "Merge branch 'class-change' of https://github.com/ballerina-platform/ballerina-lang into obect-parsing\n\n\u0001 Conflicts:\n\u0001\tlanglib/lang.annotations/src/main/ballerina/src/lang.annotations/annotations.bal\n\u0001\tstdlib/http/src/main/ballerina/src/http/websocket/websocket_client.bal"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNDgxNDkw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#pullrequestreview-481481490", "createdAt": "2020-09-03T04:21:14Z", "commit": {"oid": "1061dbd95a4edcb00de6505d423182364c68896a"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNDoyMToxNVrOHMVVBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNDoyNDozNVrOHMVYUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5NDQwNw==", "bodyText": "Should we rename this to ERROR_DUPLICATE_CLASS_TYPE_QUALIFIER? it seems consistent with the rest.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#discussion_r482694407", "createdAt": "2020-09-03T04:21:15Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/diagnostics/DiagnosticErrorCode.java", "diffHunk": "@@ -239,7 +240,7 @@\n     // Expression followed by the start keyword must be a func-call, a method-call or a remote-method-call\n     ERROR_INVALID_EXPRESSION_IN_START_ACTION(\"BCE207\", \"error.invalid.expression.in.start.action\"),\n     // Cannot have the  same qualifier twice\n-    ERROR_SAME_OBJECT_TYPE_QUALIFIER(\"BCE208\", \"error.same.object.type.qualifier\"),\n+    ERROR_SAME_CLASS_TYPE_QUALIFIER(\"BCE208\", \"error.same.class.type.qualifier\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1061dbd95a4edcb00de6505d423182364c68896a"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5NDUxNA==", "bodyText": "Lets see if we can remove this", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#discussion_r482694514", "createdAt": "2020-09-03T04:21:38Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/AbstractParserErrorHandler.java", "diffHunk": "@@ -225,6 +225,15 @@ protected ParserRuleContext getGrandParentContext() {\n         return grandParent;\n     }\n \n+    protected ParserRuleContext getGreatGrandParentContext() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1061dbd95a4edcb00de6505d423182364c68896a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5NTA3MA==", "bodyText": "@rdulmina Shall we remove that getErrorCode(Syntaxkind expectedKind) soon?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#discussion_r482695070", "createdAt": "2020-09-03T04:23:55Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/SyntaxErrors.java", "diffHunk": "@@ -240,6 +240,8 @@ private static DiagnosticCode getErrorCode(SyntaxKind expectedKind) {\n                 return DiagnosticErrorCode.ERROR_MISSING_JOIN_KEYWORD;\n             case OUTER_KEYWORD:\n                 return DiagnosticErrorCode.ERROR_MISSING_OUTER_KEYWORD;\n+            case CLASS_KEYWORD:\n+                return DiagnosticErrorCode.ERROR_MISSING_CLASS_KEYWORD;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTE2MDI5NA=="}, "originalCommit": {"oid": "b441b6393a8b48d8f67d174d397bbbae2d5ff975"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5NTI1MA==", "bodyText": "Lets remove these invalid tests. May be we can keep one or two as negative test cases.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#discussion_r482695250", "createdAt": "2020-09-03T04:24:35Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/test/java/io/ballerinalang/compiler/parser/test/syntax/declarations/ObjectTypeDefinitionTest.java", "diffHunk": "@@ -79,72 +79,72 @@ public void testClientQualifierOnly() {\n         test(\"object-type-def/object_type_def_source_14.bal\", \"object-type-def/object_type_def_assert_14.json\");\n     }\n \n-    @Test\n+    @Test(enabled = false) // no longer valid, due to spec deviation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1061dbd95a4edcb00de6505d423182364c68896a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e387887e0504b789e49fc2ed1d19eef90e9b1713", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e387887e0504b789e49fc2ed1d19eef90e9b1713", "committedDate": "2020-09-03T10:17:42Z", "message": "Add code review suggestions\n\nUse aliasing for object-member context\nUse context when parsing object members instead of two flags\nAllow parsing type inclusion and then log an error\nAllow parsing old object type qualifiers and then log an error\nRemove invalid object type parser tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e97810b95466106e3e651c5bfdcadda5145b99eb", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e97810b95466106e3e651c5bfdcadda5145b99eb", "committedDate": "2020-09-03T12:33:20Z", "message": "Fix client object type parsing at top level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "422c9abd04b4ba4b1b33abf72784c3e06eaebc87", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/422c9abd04b4ba4b1b33abf72784c3e06eaebc87", "committedDate": "2020-09-03T12:41:29Z", "message": "Merge branch 'class-change' of https://github.com/ballerina-platform/ballerina-lang into obect-parsing\n\n\u0001 Conflicts:\n\u0001\tmisc/testerina/modules/testerina-core/src/main/ballerina/src/test/mock.bal\n\u0001\tobservelib/observe/src/main/ballerina/src/observe/natives.bal"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxODAzODAw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25511#pullrequestreview-481803800", "createdAt": "2020-09-03T12:49:17Z", "commit": {"oid": "422c9abd04b4ba4b1b33abf72784c3e06eaebc87"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4766, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}