{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNjc4MjYz", "number": 22640, "title": "Fix issue of initializing hex literals to decimal type", "bodyText": "Purpose\n\nHex floating point literals are always float.\n\nFixes #14775\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-04-15T10:35:22Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640", "merged": true, "mergeCommit": {"oid": "d1fca4984e60cb8bf3a538ded46b7bac32e6e138"}, "closed": true, "closedAt": "2020-04-21T19:20:55Z", "author": {"login": "chiranSachintha"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcX6BCXABqjMyMzYwOTY3MzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZ37P8gFqTM5NzU2MzQ1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c1c639f136bd006ac56dcf6f260be3682c3e7de", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1c1c639f136bd006ac56dcf6f260be3682c3e7de", "committedDate": "2020-04-15T10:24:45Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "4ba9b5600ad107352076477ff0d88b533446623f", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4ba9b5600ad107352076477ff0d88b533446623f", "committedDate": "2020-04-15T15:40:52Z", "message": "Check for hex indicator in integers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ba9b5600ad107352076477ff0d88b533446623f", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4ba9b5600ad107352076477ff0d88b533446623f", "committedDate": "2020-04-15T15:40:52Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "38f19c4931ef07fcca041e24900f6311f9bff966", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/38f19c4931ef07fcca041e24900f6311f9bff966", "committedDate": "2020-04-15T20:22:17Z", "message": "Check for hex indicator in integers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73c139492365328ffa780e134f8c9cb6b1462189", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/73c139492365328ffa780e134f8c9cb6b1462189", "committedDate": "2020-04-16T03:03:59Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into issue-14775"}, "afterCommit": {"oid": "2ba13875c483925ee31ce95672e5a85272a6d534", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2ba13875c483925ee31ce95672e5a85272a6d534", "committedDate": "2020-04-16T07:16:39Z", "message": "Check for hex indicator in integers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ba13875c483925ee31ce95672e5a85272a6d534", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2ba13875c483925ee31ce95672e5a85272a6d534", "committedDate": "2020-04-16T07:16:39Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "be5e58b6a383c175ae4e00aaa54ef7dc3a59f5fc", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/be5e58b6a383c175ae4e00aaa54ef7dc3a59f5fc", "committedDate": "2020-04-16T14:46:32Z", "message": "Check for hex indicator in integers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "be5e58b6a383c175ae4e00aaa54ef7dc3a59f5fc", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/be5e58b6a383c175ae4e00aaa54ef7dc3a59f5fc", "committedDate": "2020-04-16T14:46:32Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "d6b305fe0773899aee543dc6324c74f236d144bb", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d6b305fe0773899aee543dc6324c74f236d144bb", "committedDate": "2020-04-16T17:18:05Z", "message": "Check for hex indicator in integers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6b305fe0773899aee543dc6324c74f236d144bb", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d6b305fe0773899aee543dc6324c74f236d144bb", "committedDate": "2020-04-16T17:18:05Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "c7177b7d1f2058e5445124d50b09bb4a75c547a6", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c7177b7d1f2058e5445124d50b09bb4a75c547a6", "committedDate": "2020-04-17T03:30:41Z", "message": "Check for hex indicator in integers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6313e808d3fe2118631ada921ae793619d26a1d8", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6313e808d3fe2118631ada921ae793619d26a1d8", "committedDate": "2020-04-17T03:46:52Z", "message": "Fix bstring unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2659c65bf88d9a80ba3d51a6f0d62886f5f197eb", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2659c65bf88d9a80ba3d51a6f0d62886f5f197eb", "committedDate": "2020-04-17T03:47:19Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ae3786b7a44caf6e0b1e3b9ce154afb2b6283580", "committedDate": "2020-04-17T03:46:52Z", "message": "Check for hex indicator in integers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c7177b7d1f2058e5445124d50b09bb4a75c547a6", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c7177b7d1f2058e5445124d50b09bb4a75c547a6", "committedDate": "2020-04-17T03:30:41Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ae3786b7a44caf6e0b1e3b9ce154afb2b6283580", "committedDate": "2020-04-17T03:46:52Z", "message": "Check for hex indicator in integers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1Njc1ODYz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#pullrequestreview-395675863", "createdAt": "2020-04-17T18:20:00Z", "commit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxODoyMDowMFrOGHYdGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxODoyODoxNlrOGHYuJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM5Mzg4MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        } else if ((expType.tag == TypeTags.DECIMAL) && !NumericLiteralSupport\n          \n          \n            \n                                .isHexIndicator(literalExpr.originalValue)) {\n          \n          \n            \n                        } else if (expType.tag == TypeTags.DECIMAL && \n          \n          \n            \n                                !NumericLiteralSupport.isHexIndicator(literalExpr.originalValue)) {", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#discussion_r410393881", "createdAt": "2020-04-17T18:20:00Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -344,7 +344,8 @@ private BType setLiteralValueAndGetType(BLangLiteral literalExpr, BType expType)\n             if (expType.tag == TypeTags.FLOAT) {\n                 literalType = symTable.floatType;\n                 literalExpr.value = ((Long) literalValue).doubleValue();\n-            } else if (expType.tag == TypeTags.DECIMAL) {\n+            } else if ((expType.tag == TypeTags.DECIMAL) && !NumericLiteralSupport\n+                    .isHexIndicator(literalExpr.originalValue)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM5Njg5NA==", "bodyText": "Shall we rename this to\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static boolean isHexIndicator(String literalValue) {\n          \n          \n            \n                public static boolean hasHexIndicator(String literalValue) {", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#discussion_r410396894", "createdAt": "2020-04-17T18:25:46Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/util/NumericLiteralSupport.java", "diffHunk": "@@ -68,6 +68,24 @@ public static boolean isHexLiteral(String numericLiteral) {\n         return false;\n     }\n \n+    /**\n+     * Check input for decimal indicator.\n+     *\n+     * @param literalValue literal to check\n+     * @return true if Hex prefix is present, false otherwise\n+     */\n+    public static boolean isHexIndicator(String literalValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM5ODI0NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return (firstChar == 'x' || secondChar == 'x' || firstChar == 'X' || secondChar == 'X');\n          \n          \n            \n                    return firstChar == 'x' || secondChar == 'x' || firstChar == 'X' || secondChar == 'X';\n          \n      \n    \n    \n  \n\nShall we add a comment to say why we are checking both 2nd and 3rd chars?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#discussion_r410398245", "createdAt": "2020-04-17T18:28:16Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/util/NumericLiteralSupport.java", "diffHunk": "@@ -68,6 +68,24 @@ public static boolean isHexLiteral(String numericLiteral) {\n         return false;\n     }\n \n+    /**\n+     * Check input for decimal indicator.\n+     *\n+     * @param literalValue literal to check\n+     * @return true if Hex prefix is present, false otherwise\n+     */\n+    public static boolean isHexIndicator(String literalValue) {\n+        int length = literalValue.length();\n+        // There should be at least 3 characters to form hex literal.\n+        if (length < 3) {\n+            return false;\n+        }\n+        char firstChar = literalValue.charAt(1);\n+        char secondChar = literalValue.charAt(2);\n+        return (firstChar == 'x' || secondChar == 'x' || firstChar == 'X' || secondChar == 'X');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae3786b7a44caf6e0b1e3b9ce154afb2b6283580", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ae3786b7a44caf6e0b1e3b9ce154afb2b6283580", "committedDate": "2020-04-17T03:46:52Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "fbb91df2b77473a885cad5e25bac6b4d6f4bf97a", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fbb91df2b77473a885cad5e25bac6b4d6f4bf97a", "committedDate": "2020-04-18T04:12:22Z", "message": "Check for hex indicator in integers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e4c1d7d28047fe0a934873617c99d759e4a97ef", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7e4c1d7d28047fe0a934873617c99d759e4a97ef", "committedDate": "2020-04-18T04:45:54Z", "message": "Fix review suggestions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fbb91df2b77473a885cad5e25bac6b4d6f4bf97a", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fbb91df2b77473a885cad5e25bac6b4d6f4bf97a", "committedDate": "2020-04-18T04:12:22Z", "message": "Check for hex indicator in integers"}, "afterCommit": {"oid": "7e4c1d7d28047fe0a934873617c99d759e4a97ef", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7e4c1d7d28047fe0a934873617c99d759e4a97ef", "committedDate": "2020-04-18T04:45:54Z", "message": "Fix review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MTM4MjA3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#pullrequestreview-397138207", "createdAt": "2020-04-21T09:10:44Z", "commit": {"oid": "7e4c1d7d28047fe0a934873617c99d759e4a97ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxMDo0NFrOGI7RlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxMDo0NFrOGI7RlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAxMjk0OQ==", "bodyText": "Shall we add tests for 0X and -0X too?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#discussion_r412012949", "createdAt": "2020-04-21T09:10:44Z", "author": {"login": "MaryamZi"}, "path": "tests/jballerina-bstring-unit-test/src/test/resources/test-src/types/decimal/decimal_value_negative_literal.bal", "diffHunk": "@@ -19,6 +19,8 @@ function testInvlaidDecimalValue() {\n     // This is to test a syntax issue.\n     decimal a = 12.3f;\n     decimal b = 0x4fp1;\n+    decimal c = 0x12bc;\n+    decimal d = -0x12b;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e4c1d7d28047fe0a934873617c99d759e4a97ef"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04ddcdac8ed4b455f8ea1d445ff13657a48c8289", "author": {"user": {"login": "chiranSachintha", "name": "Chiran Sachintha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/04ddcdac8ed4b455f8ea1d445ff13657a48c8289", "committedDate": "2020-04-21T17:24:49Z", "message": "Fix review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NTYzNDU4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22640#pullrequestreview-397563458", "createdAt": "2020-04-21T18:23:41Z", "commit": {"oid": "04ddcdac8ed4b455f8ea1d445ff13657a48c8289"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3547, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}