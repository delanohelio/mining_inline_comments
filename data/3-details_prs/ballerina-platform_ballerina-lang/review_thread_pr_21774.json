{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4OTYyODk2", "number": 21774, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwMzozODo1NVrODoLc2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNDoyNzoxMVrODoLyXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDU3MjQzOnYy", "diffSide": "RIGHT", "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwMzozODo1NVrOF2ktcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwMzo0NjowMlrOF2kyVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc2ODg4Mg==", "bodyText": "Don't we need to check whether the debug has enabled or not?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392768882", "createdAt": "2020-03-16T03:38:55Z", "author": {"login": "chamil321"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,19 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(message, err);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7de44a55430de6aef90c85a8dfdf331af6bb1a6"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3MDEzMw==", "bodyText": "Fixed with d318ea7", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392770133", "createdAt": "2020-03-16T03:46:02Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,19 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(message, err);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc2ODg4Mg=="}, "originalCommit": {"oid": "c7de44a55430de6aef90c85a8dfdf331af6bb1a6"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDU3MjY0OnYy", "diffSide": "RIGHT", "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwMzozOToxMlrOF2ktmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwMzo0NjowOVrOF2kyXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc2ODkyMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            }\n          \n          \n            \n            }", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392768920", "createdAt": "2020-03-16T03:39:12Z", "author": {"login": "chamil321"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,19 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(message, err);\n+    Error cacheError;\n+    if (err is error) {\n+        cacheError = error(CACHE_ERROR, message = message, cause = err);\n+    } else {\n+        cacheError = error(CACHE_ERROR, message = message);\n+    }\n+    return cacheError;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7de44a55430de6aef90c85a8dfdf331af6bb1a6"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3MDE0Mg==", "bodyText": "Fixed with d318ea7", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392770142", "createdAt": "2020-03-16T03:46:09Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,19 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(message, err);\n+    Error cacheError;\n+    if (err is error) {\n+        cacheError = error(CACHE_ERROR, message = message, cause = err);\n+    } else {\n+        cacheError = error(CACHE_ERROR, message = message);\n+    }\n+    return cacheError;\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc2ODkyMA=="}, "originalCommit": {"oid": "c7de44a55430de6aef90c85a8dfdf331af6bb1a6"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDYyNzUwOnYy", "diffSide": "RIGHT", "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNDoyNzoxMVrOF2lNqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwODo1NzozN1rOF2qo5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3NzEzMQ==", "bodyText": "Do we need to make the log statement a part of this function? Doing so defeats the purpose of using the log function which takes a function pointer. The purpose of it is to delay the evaluation of any parameters passed to the log function. Using it like this doesn't achieve that objective. You might as well use the log function which takes a string param.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392777131", "createdAt": "2020-03-16T04:27:11Z", "author": {"login": "pubudu91"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,21 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(function() returns string {\n+        return message;\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d318ea7f0a283342354a9095c6d44c18fdbc1753"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc4MDUyMg==", "bodyText": "Added this function in order to separate out the logging and creating the particular error type of the module. That was the convention we followed most of the stdlib modules. Added the log statement as a part of this function, in order to remove code duplicates all over the places where we need to create an error.\nI just wanted to evaluate the debug function iff the debug log level is enabled. That's why I used the log function which takes a function pointer. Otherwise there is no any alternative as per the BBE [1]. Also, there is nothing to evaluate since the message parameter is already constructed, since I need to create the error message despite of the log level is enabled or not.\nPlease suggest the if there is any alternative or suggestion to change.\n[1] https://ballerina.io/v1-1/learn/by-example/log-api.html", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392780522", "createdAt": "2020-03-16T04:45:32Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,21 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(function() returns string {\n+        return message;\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3NzEzMQ=="}, "originalCommit": {"oid": "d318ea7f0a283342354a9095c6d44c18fdbc1753"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgwOTU0NQ==", "bodyText": "Then you can simply use the string param instead of the function pointer. You only need to use the function pointer if you want to avoid evaluating any expression you may want to pass as a param to the log function. The log level check is done irrespective of whether it is a function pointer param or a string param.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392809545", "createdAt": "2020-03-16T06:49:37Z", "author": {"login": "pubudu91"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,21 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(function() returns string {\n+        return message;\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3NzEzMQ=="}, "originalCommit": {"oid": "d318ea7f0a283342354a9095c6d44c18fdbc1753"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg0NzkyNA==", "bodyText": "Got it. Then the @chamil321 's concern [1] become invalid. Actually, I also had the same concern. :) Thanks for the explanation.\n[1] #21774 (comment)", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392847924", "createdAt": "2020-03-16T08:21:25Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,21 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(function() returns string {\n+        return message;\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3NzEzMQ=="}, "originalCommit": {"oid": "d318ea7f0a283342354a9095c6d44c18fdbc1753"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1ODkzNQ==", "bodyText": "Fixed with 1a43013", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392858935", "createdAt": "2020-03-16T08:43:45Z", "author": {"login": "ldclakmal"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,21 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(function() returns string {\n+        return message;\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3NzEzMQ=="}, "originalCommit": {"oid": "d318ea7f0a283342354a9095c6d44c18fdbc1753"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NjAyMA==", "bodyText": "My bad, I saw it as an expression inside the log function. \ud83e\udd26\u200d\u2642\ufe0f", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21774#discussion_r392866020", "createdAt": "2020-03-16T08:57:37Z", "author": {"login": "chamil321"}, "path": "stdlib/cache/src/main/ballerina/src/cache/cache_errors.bal", "diffHunk": "@@ -47,3 +47,21 @@ function prepareError(string message, error? err = ()) returns Error {\n     }\n     return cacheError;\n }\n+\n+# Prepare the `error` as an `Error`.\n+#\n+# + message - Error message\n+# + err - `error` instance\n+# + return - Prepared `Error` instance\n+function prepareErrorWithDebugLog(string message, error? err = ()) returns Error {\n+    log:printDebug(function() returns string {\n+        return message;\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3NzEzMQ=="}, "originalCommit": {"oid": "d318ea7f0a283342354a9095c6d44c18fdbc1753"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 885, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}