{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NzAzODIz", "number": 21185, "title": "Add \"Optimize All Imports\" code action", "bodyText": "Purpose\n\nAdd \"Optimize All Imports\" code action.\n\nFixes #21130\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-02-20T11:32:28Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185", "merged": true, "mergeCommit": {"oid": "7ca2edd8b9745ad7e7e99f3e6f6702f036e3d18d"}, "closed": true, "closedAt": "2020-02-27T04:51:08Z", "author": {"login": "rasika"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHtqh4ABqjMwNjgzODU2MDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcITtgvgFqTM2NTQwOTc1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "833d0e2e9a6ff4fbb6cbc0ee1b0ac221d409a924", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/833d0e2e9a6ff4fbb6cbc0ee1b0ac221d409a924", "committedDate": "2020-02-25T08:09:24Z", "message": "Fix test failure\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}, "afterCommit": {"oid": "7ff2f7f299b17edbf4761a7798a70da14312710a", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7ff2f7f299b17edbf4761a7798a70da14312710a", "committedDate": "2020-02-25T08:14:55Z", "message": "Fix test failure\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7ff2f7f299b17edbf4761a7798a70da14312710a", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7ff2f7f299b17edbf4761a7798a70da14312710a", "committedDate": "2020-02-25T08:14:55Z", "message": "Fix test failure\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}, "afterCommit": {"oid": "ff2da98299332b544ab3864e2e5ef416c2f9c2e1", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff2da98299332b544ab3864e2e5ef416c2f9c2e1", "committedDate": "2020-02-26T09:04:53Z", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37f620f286d9540ed47c2c7b506d793f73b3238b", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/37f620f286d9540ed47c2c7b506d793f73b3238b", "committedDate": "2020-02-26T09:10:23Z", "message": "Make compile once for the diagnostics\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ecf67397a4fd229ef0bf49991e98a686ce8ee7a", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3ecf67397a4fd229ef0bf49991e98a686ce8ee7a", "committedDate": "2020-02-26T09:10:23Z", "message": "Remove redundant keys DOCUMENT_MANAGER_KEY, FILE_URI_KEY\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e05007852ad2d04e726649339fc145043c81e687", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e05007852ad2d04e726649339fc145043c81e687", "committedDate": "2020-02-26T09:11:26Z", "message": "Fix NPE when running language server tests\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fbb4777c35e67ac686e87526403bcb974d8e0f4", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1fbb4777c35e67ac686e87526403bcb974d8e0f4", "committedDate": "2020-02-26T09:11:27Z", "message": "Add \"IMPORTS\" top-level node\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7385ccbb22343ff5c5be4398c517932ee8cb4bc8", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7385ccbb22343ff5c5be4398c517932ee8cb4bc8", "committedDate": "2020-02-26T09:11:28Z", "message": "Move getLSDiagnostics of the CodeActionTest into CodeActionUtil\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "180b3649c6e212171aa9e0bcc05c5e644dce96f9", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/180b3649c6e212171aa9e0bcc05c5e644dce96f9", "committedDate": "2020-02-26T09:11:29Z", "message": "Revamp code action context builder\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec7777aa8e95ea7799ca2a83d8b5d21f9c5ef784", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ec7777aa8e95ea7799ca2a83d8b5d21f9c5ef784", "committedDate": "2020-02-26T09:14:11Z", "message": "Revamp code actions\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8831e40b25231f1ac5d9743ea28d1993b0f9a995", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8831e40b25231f1ac5d9743ea28d1993b0f9a995", "committedDate": "2020-02-26T09:14:12Z", "message": "Add \"Optimize All Imports\" code action\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3236ebbbd0747d6645b99c5d66d92488b153a308", "committedDate": "2020-02-26T09:14:12Z", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff2da98299332b544ab3864e2e5ef416c2f9c2e1", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff2da98299332b544ab3864e2e5ef416c2f9c2e1", "committedDate": "2020-02-26T09:04:53Z", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}, "afterCommit": {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308", "author": {"user": {"login": "rasika", "name": "Rasika Perera"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3236ebbbd0747d6645b99c5d66d92488b153a308", "committedDate": "2020-02-26T09:14:12Z", "message": "Fix test failures\n\nSigned-off-by: Rasika <info.rasika@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDA5NjU2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185#pullrequestreview-365409656", "createdAt": "2020-02-27T04:34:59Z", "commit": {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDozNDo1OVrOFvE_Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDozNDo1OVrOFvE_Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwOTA3NA==", "bodyText": "Can we use https://github.com/ballerina-platform/ballerina-lang/blob/master/language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/common/utils/CommonUtil.java#L186 to convert the diagnostic position to zero-based positioning?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185#discussion_r384909074", "createdAt": "2020-02-27T04:34:59Z", "author": {"login": "nadeeshaan"}, "path": "language-server/modules/langserver-core/src/main/java/org/ballerinalang/langserver/codeaction/CodeActionUtil.java", "diffHunk": "@@ -140,4 +156,42 @@ public static CodeActionNodeType topLevelNodeInLine(TextDocumentIdentifier ident\n             return null;\n         }\n     }\n+\n+    /**\n+     * Translates ballerina diagnostics into lsp4j diagnostics.\n+     *\n+     * @param ballerinaDiags a list of {@link org.ballerinalang.util.diagnostic.Diagnostic}\n+     * @return a list of {@link Diagnostic}\n+     */\n+    public static List<org.eclipse.lsp4j.Diagnostic> toDiagnostics(\n+            List<org.ballerinalang.util.diagnostic.Diagnostic> ballerinaDiags) {\n+        List<org.eclipse.lsp4j.Diagnostic> lsDiagnostics = new ArrayList<>();\n+        ballerinaDiags.forEach(diagnostic -> {\n+            org.eclipse.lsp4j.Diagnostic lsDiagnostic = new org.eclipse.lsp4j.Diagnostic();\n+            lsDiagnostic.setSeverity(DiagnosticSeverity.Error);\n+            lsDiagnostic.setMessage(diagnostic.getMessage());\n+            Range r = new Range();\n+\n+            int startLine = diagnostic.getPosition().getStartLine() - 1; // LSP diagnostics range is 0 based\n+            int startChar = diagnostic.getPosition().getStartColumn() - 1;\n+            int endLine = diagnostic.getPosition().getEndLine() - 1;\n+            int endChar = diagnostic.getPosition().getEndColumn() - 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308"}, "originalPosition": 145}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDA5NzU4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21185#pullrequestreview-365409758", "createdAt": "2020-02-27T04:35:23Z", "commit": {"oid": "3236ebbbd0747d6645b99c5d66d92488b153a308"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4127, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}