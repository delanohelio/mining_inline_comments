{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NjE0NDE0", "number": 26148, "title": "Modify New and Init Command in accordant with the latest layout", "bodyText": "Purpose\n\nModify New and Init Command according to the latest layout\n\nFixes #26067\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-29T07:19:36Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148", "merged": true, "mergeCommit": {"oid": "16811293b238922dd5e0038bc5c2c9694fad0a70"}, "closed": true, "closedAt": "2020-10-05T14:46:16Z", "author": {"login": "suganyasuven"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNg78KgH2gAyNDk0NjE0NDE0Ojc3NDU4MGNhMDI3N2NiNGVhZDI2MDNmMmViOTBiMzY4YWFiMGE0MDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPeizeAH2gAyNDk0NjE0NDE0OmFiNWU1ZmUyZGQ4YWM2M2RiMmY2MTc0Y2I3ZDI2YzRjM2E2ZjdlMjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "774580ca0277cb4ead2603f2eb90b368aab0a403", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/774580ca0277cb4ead2603f2eb90b368aab0a403", "committedDate": "2020-09-29T05:00:41Z", "message": "Modify new and init command in accordant with latest layout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18663e540ed6cf3635122a52120d3a8b8cbdac56", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/18663e540ed6cf3635122a52120d3a8b8cbdac56", "committedDate": "2020-09-29T05:54:03Z", "message": "Disable AddCommand unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fee944b0c305feca8f784ab4352ba442709402fb", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fee944b0c305feca8f784ab4352ba442709402fb", "committedDate": "2020-09-29T07:00:13Z", "message": "Modify cli-help texts for init and new command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fda8b1c96c4f7e75d5d72b20fbe2ae694f76b25c", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fda8b1c96c4f7e75d5d72b20fbe2ae694f76b25c", "committedDate": "2020-09-29T07:05:46Z", "message": "Fix and add tests for new command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a0b4df17da10c671e68f25c1c4ccbe5c4360219", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5a0b4df17da10c671e68f25c1c4ccbe5c4360219", "committedDate": "2020-09-29T07:06:38Z", "message": "Add unit tests for init command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85eeb8dd999d94321ae29bea3598a5e2f6dfa461", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/85eeb8dd999d94321ae29bea3598a5e2f6dfa461", "committedDate": "2020-09-29T07:14:43Z", "message": "Refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10633a8d8ac4fdf6b799c43e405836ad95c2c4d0", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/10633a8d8ac4fdf6b799c43e405836ad95c2c4d0", "committedDate": "2020-09-29T08:13:17Z", "message": "Fix test failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8", "committedDate": "2020-09-30T06:20:21Z", "message": "Disable failing test case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjYzMDg0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148#pullrequestreview-499663084", "createdAt": "2020-09-30T17:34:10Z", "commit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNzozNDoxMFrOHaoUYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNzozNDoxMFrOHaoUYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY4NTYwMQ==", "bodyText": "Lets get rid of this exclusion using java.util.Optional", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148#discussion_r497685601", "createdAt": "2020-09-30T17:34:10Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-packerina/spotbugs-exclude.xml", "diffHunk": "@@ -25,6 +25,14 @@\n         <Class name=\"org.ballerinalang.packerina.model.BaloToml\"/>\n         <Bug pattern=\"NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE\"/>\n     </Match>\n+    <Match>\n+        <Class name=\"org.ballerinalang.packerina.cmd.InitCommand\"/>\n+        <Bug pattern=\"NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjY0OTY2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148#pullrequestreview-499664966", "createdAt": "2020-09-30T17:36:41Z", "commit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNzozNjo0MVrOHaoZ2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNzozNjo0MVrOHaoZ2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY4NzAwMQ==", "bodyText": "Should this be removed once the AddCommand is implemented? If so please add comment to #26148 referring the PR.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148#discussion_r497687001", "createdAt": "2020-09-30T17:36:41Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-packerina/spotbugs-exclude.xml", "diffHunk": "@@ -25,6 +25,14 @@\n         <Class name=\"org.ballerinalang.packerina.model.BaloToml\"/>\n         <Bug pattern=\"NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE\"/>\n     </Match>\n+    <Match>\n+        <Class name=\"org.ballerinalang.packerina.cmd.InitCommand\"/>\n+        <Bug pattern=\"NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE\"/>\n+    </Match>\n+    <Match>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjY2MTU0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148#pullrequestreview-499666154", "createdAt": "2020-09-30T17:38:15Z", "commit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNzozODoxNVrOHaodjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNzozODoxNVrOHaodjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY4Nzk1MA==", "bodyText": "Let's append the e.getMessage() to the error message.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26148#discussion_r497687950", "createdAt": "2020-09-30T17:38:15Z", "author": {"login": "azinneera"}, "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/NewCommand.java", "diffHunk": "@@ -97,21 +115,42 @@ public void execute() {\n         }\n \n         // Check if the command is executed inside a ballerina project\n-        Path projectRoot = ProjectDirs.findProjectRoot(path);\n+        Path projectRoot = ProjectUtils.findProjectRoot(path);\n         if (projectRoot != null) {\n             CommandUtil.printError(errStream,\n-            \"Directory is already within a Ballerina project :\" + projectRoot.toString(),\n+                    \"Directory is already within a Ballerina project :\" +\n+                            projectRoot.resolve(ProjectConstants.BALLERINA_TOML).toString(),\n+                    null,\n+                    false);\n+            return;\n+        }\n+\n+        if (!ProjectUtils.validatePkgName(packageName)) {\n+            CommandUtil.printError(errStream,\n+                    \"Invalid project name : '\" + packageName + \"' :\\n\" +\n+                            \"Project name can only contain alphanumerics, underscores and periods \" +\n+                            \"and the maximum length is 256 characters\",\n+                    null,\n+                    false);\n+            return;\n+        }\n+\n+        // Check if the template exists\n+        if (!CommandUtil.getTemplates().contains(template)) {\n+            CommandUtil.printError(errStream,\n+                    \"Template not found, use `ballerina new --help` to view available templates.\",\n                     null,\n                     false);\n             return;\n         }\n \n         try {\n             Files.createDirectories(path);\n-            CommandUtil.initProject(path);\n+            CommandUtil.initProjectByTemplate(path, packageName, template);\n         } catch (AccessDeniedException e) {\n             errStream.println(\"error: Error occurred while creating project : \" + \"Insufficient Permission\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94d5cccbf912ebc0c87dbbf0cfe33686ea2802f8"}, "originalPosition": 106}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22495161246c8e614cea45d062494d1262c44677", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/22495161246c8e614cea45d062494d1262c44677", "committedDate": "2020-10-01T08:10:04Z", "message": "Address review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab5e5fe2dd8ac63db2f6174cb7d26c4c3a6f7e28", "author": {"user": {"login": "suganyasuven", "name": "Suganya"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ab5e5fe2dd8ac63db2f6174cb7d26c4c3a6f7e28", "committedDate": "2020-10-05T07:21:16Z", "message": "Merge branch 'prj_api_module_refactor' into cmd_changes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4490, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}