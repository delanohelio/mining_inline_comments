{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyODU3MTM1", "number": 24531, "title": "Fix interop for intersection types", "bodyText": "Purpose\n$title.\nFixes #24529\nApproach\nSince the value that will be returned or passed as an argument for an intersection type will be a value of the effective type, we directly use the effective type in JMethodResolver.\nSamples\nfunction getValues(map<int> & readonly intMap, map<string> & readonly stringMap) \n   returns (int|string)[] & readonly = @java:Method {\n        class: \"org/ballerinalang/nativeimpl/jvm/tests/StaticMethods\"\n} external;\npublic static ArrayValue getValues(MapValue<BString, Long> intMap, MapValue<BString, BString> stringMap) {\n   // ....\n}\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-07-01T18:02:22Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24531", "merged": true, "mergeCommit": {"oid": "944e3babf29d488297c6b875464b6a74978c478b"}, "closed": true, "closedAt": "2020-07-15T13:07:18Z", "author": {"login": "MaryamZi"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwtisOAH2gAyNDQyODU3MTM1OjliOTg2MWFjZjU1YjhlZDNjZWI1ZThmYWFlZGU1NGZmNDVhNWRjY2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1GYlUgFqTQ0ODczOTQ0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b9861acf55b8ed3ceb5e8faaede54ff45a5dcce", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9b9861acf55b8ed3ceb5e8faaede54ff45a5dcce", "committedDate": "2020-07-01T17:18:04Z", "message": "Fix interop for intersection types"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MDc0MjM0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24531#pullrequestreview-447074234", "createdAt": "2020-07-13T09:16:52Z", "commit": {"oid": "9b9861acf55b8ed3ceb5e8faaede54ff45a5dcce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwOToxNjo1MlrOGwgEqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwOToxNjo1MlrOGwgEqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUxMDMxNA==", "bodyText": "Can't we avoid creating this array type each time this is called?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24531#discussion_r453510314", "createdAt": "2020-07-13T09:16:52Z", "author": {"login": "pubudu91"}, "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/nativeimpl/jvm/tests/StaticMethods.java", "diffHunk": "@@ -392,4 +395,36 @@ public static BFuture getFutureOnly(BFuture future) {\n     public static BTypedesc getTypeDescOnly(BTypedesc typeDesc) {\n         return typeDesc;\n     }\n+\n+    public static ArrayValue getValues(MapValue<BString, Long> intMap, MapValue<BString, BString> stringMap) {\n+        int length = intMap.size() + stringMap.size();\n+        ListInitialValueEntry[] entries = new ListInitialValueEntry[length];\n+\n+        int index = 0;\n+\n+        for (Map.Entry<BString, Long> intEntry : intMap.entrySet()) {\n+            entries[index++] = new ListInitialValueEntry.ExpressionEntry(intEntry.getValue());\n+        }\n+\n+        for (Map.Entry<BString, BString> stringEntry : stringMap.entrySet()) {\n+            entries[index++] = new ListInitialValueEntry.ExpressionEntry(stringEntry.getValue());\n+        }\n+\n+        return new ArrayValueImpl(new BArrayType(new BUnionType(new ArrayList(2) {{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b9861acf55b8ed3ceb5e8faaede54ff45a5dcce"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b752f55bd2a3c86ea0878f5089324418109d623", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1b752f55bd2a3c86ea0878f5089324418109d623", "committedDate": "2020-07-14T19:30:18Z", "message": "Merge branch 'master' of https://github.com/ballerina-lang/ballerina into fix-intersecn-interop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NzM5NDQ2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24531#pullrequestreview-448739446", "createdAt": "2020-07-15T08:30:21Z", "commit": {"oid": "1b752f55bd2a3c86ea0878f5089324418109d623"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4139, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}