{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0ODgxMjYz", "number": 25739, "title": "Fix identifying module level arrow expression with closure vars", "bodyText": "Purpose\nThis PR fixes the issue where module level arrow expressions with closure vars are failing to compile.\nFixes #25288\nApproach\n\nDescribe how you are implementing the solutions along with the design details.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nList any other known issues, related PRs, TODO items, or any other notes related to the PR.\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-11T09:50:13Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25739", "merged": true, "mergeCommit": {"oid": "056f53fa776caf9a0619d06cae42b6569f9784b6"}, "closed": true, "closedAt": "2020-09-16T14:35:36Z", "author": {"login": "Kishanthan"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHyN-CgH2gAyNDg0ODgxMjYzOjIyZWY0YWE4Yjg1YjhlN2ViZWFjMzgzYjg0NGI2NmU5MDhhMzZlYWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJdXf4AFqTQ4OTY5MjM3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "22ef4aa8b85b8e7ebeac383b844b66e908a36eab", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/22ef4aa8b85b8e7ebeac383b844b66e908a36eab", "committedDate": "2020-09-11T09:45:13Z", "message": "Include pkg level arrow expr with closure analysis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad4c9b9afcdad3256415995029dfaa825403420c", "author": {"user": {"login": "Kishanthan", "name": "Kishanthan Thangarajah"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ad4c9b9afcdad3256415995029dfaa825403420c", "committedDate": "2020-09-11T09:46:36Z", "message": "Add tests to cover issue#25288 with arrow and lambdas"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NDI1MTEw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25739#pullrequestreview-487425110", "createdAt": "2020-09-14T05:30:26Z", "commit": {"oid": "ad4c9b9afcdad3256415995029dfaa825403420c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNTozMDoyNlrOHREZTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNTozMDoyNlrOHREZTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1OTg1NQ==", "bodyText": "I'm guessing the issue here is that in F1 f1 = a => b => a + b;, a's owner is the module? If that's the case, this should ideally be fixed by properly setting the owner of a to the symbol for the arrow function.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25739#discussion_r487659855", "createdAt": "2020-09-14T05:30:26Z", "author": {"login": "pubudu91"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/TypeChecker.java", "diffHunk": "@@ -4773,7 +4773,7 @@ private void checkFunctionInvocationExpr(BLangInvocation iExpr) {\n \n     private void markAndRegisterClosureVariable(BSymbol symbol, DiagnosticPos pos) {\n         BLangInvokableNode encInvokable = env.enclInvokable;\n-        if (symbol.owner instanceof BPackageSymbol) {\n+        if (symbol.owner instanceof BPackageSymbol && env.node.getKind() != NodeKind.ARROW_EXPR) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad4c9b9afcdad3256415995029dfaa825403420c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NjkyMzcw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25739#pullrequestreview-489692370", "createdAt": "2020-09-16T14:35:28Z", "commit": {"oid": "ad4c9b9afcdad3256415995029dfaa825403420c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4717, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}