{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNjU0Mjgy", "number": 23390, "title": "Add tuple type descriptor support to new parser", "bodyText": "Purpose\nAdd tuple type descriptor support to new parser with recovery logic and test cases.\nFixes #23316\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-05-20T10:20:18Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23390", "merged": true, "mergeCommit": {"oid": "ca041d7912ac65687e2e81e3c53522ac5f6d1a31"}, "closed": true, "closedAt": "2020-05-21T11:11:26Z", "author": {"login": "rdulmina"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjDWX1gH2gAyNDIwNjU0MjgyOmVmZTRhMjliYmM0YzY4ZWY0MmFkYzU2ODA3MGY4ZGFkOTkxOTQ0Zjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjaIC2gH2gAyNDIwNjU0MjgyOmNjZmNiOTgwZDg1YjYzNDZlY2I2ZTRhNGRjYmI5YjI0M2M3MzMzMDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "efe4a29bbc4c68ef42adc568070f8dad991944f9", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/efe4a29bbc4c68ef42adc568070f8dad991944f9", "committedDate": "2020-05-20T06:47:35Z", "message": "Rest parameter support to tuple type desc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18db2d82c3806f8d8cd0995454f2d8a2884cb112", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/18db2d82c3806f8d8cd0995454f2d8a2884cb112", "committedDate": "2020-05-20T10:15:25Z", "message": "Added test cases for the tuple type desc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a56c504715239a37db8adfe491eba46faf8eda9", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1a56c504715239a37db8adfe491eba46faf8eda9", "committedDate": "2020-05-20T10:16:01Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into tuple-type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d00e33b1aabc0f9113dfa6cc13d4aa97c9ee69d", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6d00e33b1aabc0f9113dfa6cc13d4aa97c9ee69d", "committedDate": "2020-05-20T10:16:44Z", "message": "Added some missing files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "930c9a226032996f2c8e043f41bbdf609e7592e7", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/930c9a226032996f2c8e043f41bbdf609e7592e7", "committedDate": "2020-05-20T10:38:00Z", "message": "Changed the type of memberTypeDescriptors to Node."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10d6f65cb6e5368dd5ca511bfc1f16cdccaa6614", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/10d6f65cb6e5368dd5ca511bfc1f16cdccaa6614", "committedDate": "2020-05-20T13:05:55Z", "message": "Revert \"Changed the type of memberTypeDescriptors to Node.\"\n\nThis reverts commit 930c9a226032996f2c8e043f41bbdf609e7592e7."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df17215e815d85b1c10d4a9b025e3ba8360d6ded", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/df17215e815d85b1c10d4a9b025e3ba8360d6ded", "committedDate": "2020-05-20T12:29:23Z", "message": "Removed rest param type."}, "afterCommit": {"oid": "10d6f65cb6e5368dd5ca511bfc1f16cdccaa6614", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/10d6f65cb6e5368dd5ca511bfc1f16cdccaa6614", "committedDate": "2020-05-20T13:05:55Z", "message": "Revert \"Changed the type of memberTypeDescriptors to Node.\"\n\nThis reverts commit 930c9a226032996f2c8e043f41bbdf609e7592e7."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b386a7e5827ed8420a24560873c3692ad0721dd", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b386a7e5827ed8420a24560873c3692ad0721dd", "committedDate": "2020-05-20T13:15:42Z", "message": "Changed tye type of memberTypeDesc to Node."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a56b8a7cfc7e70143494fe3defe372b7af7d36d1", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a56b8a7cfc7e70143494fe3defe372b7af7d36d1", "committedDate": "2020-05-20T14:40:59Z", "message": "Changed restParam of tuple type."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d24e3e1a9970b14126a35f2538f4af53010d193", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5d24e3e1a9970b14126a35f2538f4af53010d193", "committedDate": "2020-05-20T15:26:22Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into tuple-type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1ODM4Mzk2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23390#pullrequestreview-415838396", "createdAt": "2020-05-21T02:28:32Z", "commit": {"oid": "5d24e3e1a9970b14126a35f2538f4af53010d193"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMjoyODozMlrOGYkJew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMjozNDowM1rOGYkOQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQxMTI1OQ==", "bodyText": "Here types.get(i) will give you a RestDescriptorNode.I think you'l have to get the typeDescriptor field of it, to pass to createTypeNode() method.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23390#discussion_r428411259", "createdAt": "2020-05-21T02:28:32Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/parser/BLangNodeTransformer.java", "diffHunk": "@@ -393,9 +392,14 @@ public BLangNode transform(ParenthesisedTypeDescriptorNode parenthesisedTypeDesc\n     public BLangNode transform(TupleTypeDescriptorNode tupleTypeDescriptorNode) {\n         // TODO: Fully implement after tuple-type-desc is completed.\n         BLangTupleTypeNode tupleTypeNode = (BLangTupleTypeNode) TreeBuilder.createTupleTypeNode();\n-        SeparatedNodeList<TypeDescriptorNode> types = tupleTypeDescriptorNode.memberTypeDesc();\n+        SeparatedNodeList<Node> types = tupleTypeDescriptorNode.memberTypeDesc();\n         for (int i = 0; i < types.size(); i++) {\n-            tupleTypeNode.memberTypeNodes.add(createTypeNode(types.get(i)));\n+            Node node = types.get(i);\n+            if (node.kind() == SyntaxKind.REST_TYPE) {\n+                tupleTypeNode.restParamType = createTypeNode(types.get(i));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d24e3e1a9970b14126a35f2538f4af53010d193"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQxMTYzMg==", "bodyText": "can replace types.get(i) with node.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23390#discussion_r428411632", "createdAt": "2020-05-21T02:30:15Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/parser/BLangNodeTransformer.java", "diffHunk": "@@ -393,9 +392,14 @@ public BLangNode transform(ParenthesisedTypeDescriptorNode parenthesisedTypeDesc\n     public BLangNode transform(TupleTypeDescriptorNode tupleTypeDescriptorNode) {\n         // TODO: Fully implement after tuple-type-desc is completed.\n         BLangTupleTypeNode tupleTypeNode = (BLangTupleTypeNode) TreeBuilder.createTupleTypeNode();\n-        SeparatedNodeList<TypeDescriptorNode> types = tupleTypeDescriptorNode.memberTypeDesc();\n+        SeparatedNodeList<Node> types = tupleTypeDescriptorNode.memberTypeDesc();\n         for (int i = 0; i < types.size(); i++) {\n-            tupleTypeNode.memberTypeNodes.add(createTypeNode(types.get(i)));\n+            Node node = types.get(i);\n+            if (node.kind() == SyntaxKind.REST_TYPE) {\n+                tupleTypeNode.restParamType = createTypeNode(types.get(i));\n+            } else {\n+                tupleTypeNode.memberTypeNodes.add(createTypeNode(types.get(i)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d24e3e1a9970b14126a35f2538f4af53010d193"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQxMjQ4MA==", "bodyText": "Without removing and adding, can we do this check and create the RestDescriptorNode, before add it to the list.\nMay be introduce a new method like parseTupleMember() and do it inside that method. Then here instead of calling parseTypeDescriptorInternalwe can call that method. WDYT?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23390#discussion_r428412480", "createdAt": "2020-05-21T02:34:03Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerinalang/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -9050,7 +9049,12 @@ private STNode parseTupleMemberTypeDescList() {\n             if (tupleMemberRhs == null) {\n                 break;\n             }\n-\n+            if (tupleMemberRhs.kind == SyntaxKind.ELLIPSIS_TOKEN) {\n+                typeDesc = typeDescList.remove(typeDescList.size() - 1);\n+                typeDesc = STNodeFactory.createRestDescriptorNode(typeDesc, tupleMemberRhs);\n+                typeDescList.add(typeDesc);\n+                break;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d24e3e1a9970b14126a35f2538f4af53010d193"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aec4d1d9602a780940c01d60cd10261b9bba80b3", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/aec4d1d9602a780940c01d60cd10261b9bba80b3", "committedDate": "2020-05-21T06:53:52Z", "message": "Changed the parsing logic of tuple type."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72665d63f3e5dbb424c96224a888d1a8f2ab76c3", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/72665d63f3e5dbb424c96224a888d1a8f2ab76c3", "committedDate": "2020-05-21T06:56:02Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into tuple-type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1OTk5MDI4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23390#pullrequestreview-415999028", "createdAt": "2020-05-21T09:18:45Z", "commit": {"oid": "72665d63f3e5dbb424c96224a888d1a8f2ab76c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccfcb980d85b6346ecb6e4a4dcbb9b243c733305", "author": {"user": {"login": "rdulmina", "name": "Dulmina Renuke"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ccfcb980d85b6346ecb6e4a4dcbb9b243c733305", "committedDate": "2020-05-21T09:19:45Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into tuple-type"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4511, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}