{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyOTI1NjY2", "number": 22143, "title": "[1.2.x] Fix several type-checking issues for langlib functions", "bodyText": "Purpose\n$title.\nFixes #19486 Compilation error when using int literals with byte[] langlib methods\nFixes #20439 Type checking issue with push() method for tuple arrays\nFixes #22120 Incorrect type-checking for vararg in langlib invocation\nFixes #22129 Invalid push on a union-typed array results in a bad, sad error at runtime\nFixes #22117 Bad, sad error with array:unshift for byte[]\nFixes #20192 No tests for lang.array:push()\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-03-24T11:11:15Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22143", "merged": true, "mergeCommit": {"oid": "f9a2f36d2cefdd7d7de8aaeec9224c8e52474bee"}, "closed": true, "closedAt": "2020-03-31T06:24:00Z", "author": {"login": "MaryamZi"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQDps0AH2gAyMzkyOTI1NjY2OmViYmZiN2MyOGNmMWZmYTE1NmUyMTJkYmYxODE4MDA2YzA1YmI3YmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcS9CrNgFqTM4NDQzMTY3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ebbfb7c28cf1ffa156e212dbf1818006c05bb7bd", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ebbfb7c28cf1ffa156e212dbf1818006c05bb7bd", "committedDate": "2020-03-22T06:24:08Z", "message": "Fix langlib method type-checking for rest param/numeric literals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "776d8fd9e4996ea7dea54306f1e26dcec803c20c", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/776d8fd9e4996ea7dea54306f1e26dcec803c20c", "committedDate": "2020-03-23T14:22:12Z", "message": "Require type inference for numeric literal only for langlib invocn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e016ba5af6b2753058828c837c88430d55d5912f", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e016ba5af6b2753058828c837c88430d55d5912f", "committedDate": "2020-03-23T16:55:50Z", "message": "Fix unshift for byte[]"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a771d545234503b8b922b0b5e5077a8840c3dd0", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1a771d545234503b8b922b0b5e5077a8840c3dd0", "committedDate": "2020-03-23T20:05:59Z", "message": "Fix cast for langlib func invocation and add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07d4da091dd9f14192eb881dfc459f28edca395d", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/07d4da091dd9f14192eb881dfc459f28edca395d", "committedDate": "2020-03-24T05:34:48Z", "message": "Fix pos for invalid vararg and add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96b47faea1fde8020558cf952c6be56e91d0e19e", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/96b47faea1fde8020558cf952c6be56e91d0e19e", "committedDate": "2020-03-24T11:05:28Z", "message": "Fix inherent type check for list updating langlib funcs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69dff14b20e819a71bf7e08b96e57dff5bd2ed46", "author": {"user": {"login": "MaryamZi", "name": "Maryam Ziyad"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/69dff14b20e819a71bf7e08b96e57dff5bd2ed46", "committedDate": "2020-03-24T15:29:10Z", "message": "Fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTc1Njc2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22143#pullrequestreview-382975676", "createdAt": "2020-03-27T15:42:59Z", "commit": {"oid": "e016ba5af6b2753058828c837c88430d55d5912f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNTo0Mjo1OVrOF825Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNTo0NDoyMVrOF829CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM1ODIyNg==", "bodyText": "getByte is doing a range check every time we call it. I suggest keeping the code as it is.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22143#discussion_r399358226", "createdAt": "2020-03-27T15:42:59Z", "author": {"login": "KRVPerera"}, "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/values/ArrayValueImpl.java", "diffHunk": "@@ -1069,9 +1069,8 @@ private void addToStringArray(ArrayValue vals, int startIndex) {\n \n     private void addToByteArray(ArrayValue vals, int startIndex) {\n         int endIndex = startIndex + vals.size();\n-        byte[] bytes = vals.getBytes();\n         for (int i = startIndex, j = 0; i < endIndex; i++, j++) {\n-            this.byteValues[i] = bytes[j];\n+            add(i, vals.getByte(j));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e016ba5af6b2753058828c837c88430d55d5912f"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM1OTI0MA==", "bodyText": "Do we need a cast to \"Integer\" here and back to byte again?\nI wonder whether we miss an overflow error somewhere ?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22143#discussion_r399359240", "createdAt": "2020-03-27T15:44:21Z", "author": {"login": "KRVPerera"}, "path": "bvm/ballerina-runtime/src/main/java/org/ballerinalang/jvm/values/ArrayValueImpl.java", "diffHunk": "@@ -300,7 +300,7 @@ public byte getByte(long index) {\n         if (byteValues != null) {\n             return byteValues[(int) index];\n         }\n-        return (Byte) refValues[(int) index];\n+        return ((Integer) refValues[(int) index]).byteValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e016ba5af6b2753058828c837c88430d55d5912f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTg3NDcx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22143#pullrequestreview-383187471", "createdAt": "2020-03-27T20:43:57Z", "commit": {"oid": "69dff14b20e819a71bf7e08b96e57dff5bd2ed46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDMxNjcz", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22143#pullrequestreview-384431673", "createdAt": "2020-03-31T06:23:51Z", "commit": {"oid": "69dff14b20e819a71bf7e08b96e57dff5bd2ed46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3781, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}