{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNTcyMjk2", "number": 27319, "title": "Fix context stack of complex type descriptor", "bodyText": "Purpose\n$subject.\nFixes #26105\nApproach\nN/A\nSamples\nN/A\nRemarks\nN/A\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-12-03T07:30:28Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319", "merged": true, "mergeCommit": {"oid": "88091e682e36fd5f7ed0bbed27708cdd1a26caf5"}, "closed": true, "closedAt": "2021-01-05T14:42:54Z", "author": {"login": "lochana-chathura"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdieEK3ABqjQwNjU5NjEyOTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtL_9xgFqTU2MTg0NDQ3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a796798edd6d766c50954a8473a5d972f5f6389", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2a796798edd6d766c50954a8473a5d972f5f6389", "committedDate": "2020-12-03T07:19:24Z", "message": "Fix extra wrapper being inserted to parser-ctx-stack with complex-type"}, "afterCommit": {"oid": "5d7a48912bb362d67c386b41d286982ae6ad85e0", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5d7a48912bb362d67c386b41d286982ae6ad85e0", "committedDate": "2020-12-03T07:32:06Z", "message": "Fix extra wrapper being inserted to parser-ctx-stack with complex-type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNDE0MjYw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#pullrequestreview-552414260", "createdAt": "2020-12-15T12:47:44Z", "commit": {"oid": "5d7a48912bb362d67c386b41d286982ae6ad85e0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjo0Nzo0NFrOIGJMKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjo0Nzo0NFrOIGJMKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzMxMjkzOQ==", "bodyText": "Should we add a test for the union scenario too?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#discussion_r543312939", "createdAt": "2020-12-15T12:47:44Z", "author": {"login": "MaryamZi"}, "path": "compiler/ballerina-parser/src/test/resources/declarations/record-type-def/record_type_def_source_26.bal", "diffHunk": "@@ -0,0 +1,3 @@\n+type Foo3 record {|\n+    *int&;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d7a48912bb362d67c386b41d286982ae6ad85e0"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaaded8ed108fc3859ff80b3384a1c107fb1f8d1", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/aaaded8ed108fc3859ff80b3384a1c107fb1f8d1", "committedDate": "2020-12-17T08:06:37Z", "message": "Fix context stack of complex type descriptor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b747452f77b0892794cfdd7b96585cf5a0945518", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b747452f77b0892794cfdd7b96585cf5a0945518", "committedDate": "2020-12-17T08:08:09Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fixes-2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d7a48912bb362d67c386b41d286982ae6ad85e0", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5d7a48912bb362d67c386b41d286982ae6ad85e0", "committedDate": "2020-12-03T07:32:06Z", "message": "Fix extra wrapper being inserted to parser-ctx-stack with complex-type"}, "afterCommit": {"oid": "b747452f77b0892794cfdd7b96585cf5a0945518", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b747452f77b0892794cfdd7b96585cf5a0945518", "committedDate": "2020-12-17T08:08:09Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fixes-2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzYxMjI5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#pullrequestreview-557761229", "createdAt": "2020-12-23T09:53:23Z", "commit": {"oid": "b747452f77b0892794cfdd7b96585cf5a0945518"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1MzoyM1rOIKffmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMDo0Nzo1N1rOIKg8YA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3MjY2Nw==", "bodyText": "Why we remove early return?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#discussion_r547872667", "createdAt": "2020-12-23T09:53:23Z", "author": {"login": "rdulmina"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerina/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -2212,17 +2206,20 @@ private STNode parseTypeDescriptorInternal(List<STNode> qualifiers, ParserRuleCo\n             typeDesc = STNodeFactory.createSimpleNameReferenceNode(missingToken);\n         }\n \n-        return parseComplexTypeDescriptor(typeDesc, context, isTypedBindingPattern);\n+        typeDesc = parseComplexTypeDescriptor(typeDesc, context, isTypedBindingPattern);\n+        return typeDesc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b747452f77b0892794cfdd7b96585cf5a0945518"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg5NjQxNg==", "bodyText": "We will lose the original context if we end the context before we complete parsing the complete type descriptor.\neg type myint int[5; error handler will look for expression after recovering ] where it should look for the semicolon.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#discussion_r547896416", "createdAt": "2020-12-23T10:47:57Z", "author": {"login": "rdulmina"}, "path": "compiler/ballerina-parser/src/main/java/io/ballerina/compiler/internal/parser/BallerinaParser.java", "diffHunk": "@@ -2193,14 +2193,8 @@ private STNode parseTypeDescriptor(ParserRuleContext context, boolean isTypedBin\n     private STNode parseTypeDescriptor(List<STNode> qualifiers, ParserRuleContext context,\n                                        boolean isTypedBindingPattern, boolean isInConditionalExpr) {\n         startContext(context);\n-        STNode typeDesc = parseTypeDescriptorInternal(qualifiers, context, isTypedBindingPattern, isInConditionalExpr);\n-        endContext();\n-        return typeDesc;\n-    }\n-\n-    private STNode parseTypeDescriptorInternal(List<STNode> qualifiers, ParserRuleContext context,\n-                                               boolean isTypedBindingPattern, boolean isInConditionalExpr) {\n         STNode typeDesc = parseTypeDescriptorInternal(qualifiers, context, isInConditionalExpr);\n+        endContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b747452f77b0892794cfdd7b96585cf5a0945518"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba4aa0ad66971cd55e9bf46aa211c4fc467bd077", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ba4aa0ad66971cd55e9bf46aa211c4fc467bd077", "committedDate": "2021-01-04T05:57:08Z", "message": "Fix complex type context stack"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTc2NDg3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#pullrequestreview-561576487", "createdAt": "2021-01-05T07:55:15Z", "commit": {"oid": "ba4aa0ad66971cd55e9bf46aa211c4fc467bd077"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNzo1NToxNVrOIONP2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNzo1NToxNVrOIONP2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTc2ODAyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    testTopLevelNode(\"array-type/array_type_assert_05.bal\", \"array-type/array_type_assert_20.json\");\n          \n          \n            \n                    testTopLevelNode(\"array-type/array_type_assert_20.bal\", \"array-type/array_type_assert_20.json\");\n          \n          \n            \n                  \n          \n      \n    \n    \n  \n\nCan we sync bal file and assert file. It would be better if we can change the existing ones as well.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#discussion_r551768026", "createdAt": "2021-01-05T07:55:15Z", "author": {"login": "rdulmina"}, "path": "compiler/ballerina-parser/src/test/java/io/ballerinalang/compiler/parser/test/syntax/types/ArrayTypeTest.java", "diffHunk": "@@ -104,6 +104,11 @@ public void testInvalidArrayTypeWithArrayLengthMissingCloseBracket() {\n         test(\"int[5 a;\", \"array-type/array_type_assert_11.json\");\n     }\n \n+    @Test\n+    public void testTopLevelArrayTypeWithMissingCloseBracket() {\n+        testTopLevelNode(\"array-type/array_type_assert_05.bal\", \"array-type/array_type_assert_20.json\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba4aa0ad66971cd55e9bf46aa211c4fc467bd077"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3903174012d0df14a044559e37cfc7b892474033", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3903174012d0df14a044559e37cfc7b892474033", "committedDate": "2021-01-05T08:38:13Z", "message": "Fix ArrayTypeTest file names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf896643e53c74463302a9790151f1f2a0cec1fc", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cf896643e53c74463302a9790151f1f2a0cec1fc", "committedDate": "2021-01-05T10:35:57Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fixes-2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae29951f895020f1ecedb35fa3654e2677972b78", "author": {"user": {"login": "lochana-chathura", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ae29951f895020f1ecedb35fa3654e2677972b78", "committedDate": "2021-01-05T12:07:31Z", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fixes-2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxODQ0NDc1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27319#pullrequestreview-561844475", "createdAt": "2021-01-05T14:42:39Z", "commit": {"oid": "ae29951f895020f1ecedb35fa3654e2677972b78"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4719, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}