{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyOTAyOTEz", "number": 23934, "title": "Add API to check resource is secured or not [master]", "bodyText": "Purpose\nThis PR introduces a new API to check resource is secured or not.\nFixes #18356\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-06-11T07:52:30Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934", "merged": true, "mergeCommit": {"oid": "b2058fd51a490b6a4a31e52882f732a1d136e710"}, "closed": true, "closedAt": "2020-06-13T07:02:24Z", "author": {"login": "ldclakmal"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqHg5RAH2gAyNDMyOTAyOTEzOjZhYWE5YmE1YTNmNzUwYjU2N2Y0MmUzNGM1YzgwZThjMWNjOTA5ZDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqwaV3gFqTQzMDExNDc2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6aaa9ba5a3f750b567f42e34c5c80e8c1cc909d9", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6aaa9ba5a3f750b567f42e34c5c80e8c1cc909d9", "committedDate": "2020-06-11T05:36:10Z", "message": "Add API to check resource is secured or not"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9bac88e1410eec60f90ec2a66693cf660b4ab62", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b9bac88e1410eec60f90ec2a66693cf660b4ab62", "committedDate": "2020-06-12T02:27:29Z", "message": "Fix langserver test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NDc0NTM3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934#pullrequestreview-429474537", "createdAt": "2020-06-12T05:43:44Z", "commit": {"oid": "b9bac88e1410eec60f90ec2a66693cf660b4ab62"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNTo0Mzo0NFrOGi3usQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNTo0Mzo0NFrOGi3usQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIxNzg0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (resourceSecured is boolean) {\n          \n          \n            \n                    if (!resourceSecured) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                } else {\n          \n          \n            \n                    if (!serviceSecured) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                }\n          \n          \n            \n                return true;\n          \n          \n            \n                if (resourceSecured is boolean) {\n          \n          \n            \n                    return resourceSecured;\n          \n          \n            \n                } else {\n          \n          \n            \n                    return serviceSecured;\n          \n          \n            \n                }", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934#discussion_r439217841", "createdAt": "2020-06-12T05:43:44Z", "author": {"login": "daneshk"}, "path": "stdlib/http/src/main/ballerina/src/http/auth/utils.bal", "diffHunk": "@@ -57,6 +57,29 @@ public function extractAuthorizationHeaderValue(Request req) returns @tainted st\n     return req.getHeader(AUTH_HEADER);\n }\n \n+# Checks whether the calling resource is secured by evaluating the authentication hierarchy.\n+#\n+# + context - The `FilterContext` instance\n+# + return - The status of calling resource is secured or not\n+public function isResourceSecured(FilterContext context) returns boolean {\n+    ResourceAuth? resourceLevelAuthAnn = getResourceAuthConfig(context);\n+    ServiceAuth? serviceLevelAuthAnn = getServiceAuthConfig(context);\n+\n+    boolean? resourceSecured = isResourceAuthEnabled(resourceLevelAuthAnn);\n+    boolean serviceSecured = isServiceAuthEnabled(serviceLevelAuthAnn);\n+\n+    if (resourceSecured is boolean) {\n+        if (!resourceSecured) {\n+            return false;\n+        }\n+    } else {\n+        if (!serviceSecured) {\n+            return false;\n+        }\n+    }\n+    return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9bac88e1410eec60f90ec2a66693cf660b4ab62"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a73d24e2440e71d0b0e6cf0b300ed4bb95338ca4", "author": {"user": {"login": "ldclakmal", "name": "Chanaka Lakmal"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a73d24e2440e71d0b0e6cf0b300ed4bb95338ca4", "committedDate": "2020-06-12T15:01:52Z", "message": "Update stdlib/http/src/main/ballerina/src/http/auth/utils.bal\n\nCo-authored-by: Danesh Kuruppu <daneshk@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTE0NzYw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934#pullrequestreview-430114760", "createdAt": "2020-06-13T05:15:07Z", "commit": {"oid": "a73d24e2440e71d0b0e6cf0b300ed4bb95338ca4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4363, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}