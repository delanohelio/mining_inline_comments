{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNDg2NzAy", "number": 26315, "title": "Change the NodeResolver to return the symbol", "bodyText": "Purpose\nThis PR changes the behaviour of the visitor used earlier to find the enclosing node for a given position to return the symbol itself.\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-10-12T10:36:51Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315", "merged": true, "mergeCommit": {"oid": "847fc13a95d4d3df0f2766b326b8089f7cadc82e"}, "closed": true, "closedAt": "2020-10-13T04:12:38Z", "author": {"login": "pubudu91"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRyOnfAH2gAyNTAxNDg2NzAyOjIzZTk5NTNjOTVjYmViMzIyZTRkZjUwNjBiYTRjNjcxMjUwYTE5Y2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSAozBAFqTUwNzA1NjMxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "23e9953c95cbeb322e4df5060ba4c671250a19ce", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/23e9953c95cbeb322e4df5060ba4c671250a19ce", "committedDate": "2020-10-12T11:25:10Z", "message": "Rename NodeResolver -> SymbolFinder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22d23f68cf7c965ad98d51c483a2ff98585e0d0d", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/22d23f68cf7c965ad98d51c483a2ff98585e0d0d", "committedDate": "2020-10-12T11:25:14Z", "message": "Refactor symbol finder to return the symbol itself"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2d14405fc56a110217b4f79fd7e7df92acb2c92c", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2d14405fc56a110217b4f79fd7e7df92acb2c92c", "committedDate": "2020-10-12T10:34:52Z", "message": "Refactor symbol finder to return the symbol itself"}, "afterCommit": {"oid": "22d23f68cf7c965ad98d51c483a2ff98585e0d0d", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/22d23f68cf7c965ad98d51c483a2ff98585e0d0d", "committedDate": "2020-10-12T11:25:14Z", "message": "Refactor symbol finder to return the symbol itself"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NTQzMzYw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315#pullrequestreview-506543360", "createdAt": "2020-10-12T11:41:49Z", "commit": {"oid": "22d23f68cf7c965ad98d51c483a2ff98585e0d0d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMTo0MTo0OVrOHf7KOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMTo0MTo0OVrOHf7KOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzNzE3OQ==", "bodyText": "Can we return an Optional<BSymbol> omitting the null check. Later in L113; we can use  a ternary for the return of SymbolFactory.getBCompiledSymbol(...) or Optional.empty(). As a further improvement we can return optional Symbol from the SymbolFactory.getBCompiledSymbol(...) as well.", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315#discussion_r503237179", "createdAt": "2020-10-12T11:41:49Z", "author": {"login": "rasika"}, "path": "compiler/ballerina-lang/src/main/java/io/ballerina/compiler/api/impl/BallerinaSemanticModel.java", "diffHunk": "@@ -107,23 +103,14 @@ public BallerinaSemanticModel(BLangPackage bLangPackage, CompilerContext context\n     @Override\n     public Optional<Symbol> symbol(String srcFile, LinePosition position) {\n         BLangCompilationUnit compilationUnit = getCompilationUnit(srcFile);\n-        NodeResolver nodeResolver = new NodeResolver();\n-        BLangNode node = nodeResolver.lookup(compilationUnit, position);\n-\n-        if (node instanceof IdentifiableNode) {\n-            BSymbol symbol = (BSymbol) ((IdentifiableNode) node).getSymbol();\n-            return Optional.ofNullable(SymbolFactory.getBCompiledSymbol(symbol, symbol.name.value));\n-        } else if (node != null && (node.getKind() == USER_DEFINED_TYPE\n-                || node.getKind() == NodeKind.UNION_TYPE_NODE\n-                || node.getKind() == NodeKind.INTERSECTION_TYPE_NODE\n-                || node.getKind() == NodeKind.VALUE_TYPE\n-                || node.getKind() == NodeKind.BUILT_IN_REF_TYPE\n-                || node.getKind() == NodeKind.CONSTRAINED_TYPE)) {\n-            return Optional.ofNullable(\n-                    SymbolFactory.createTypeDefinition(node.type.tsymbol, node.type.tsymbol.name.value));\n+        SymbolFinder symbolFinder = new SymbolFinder();\n+        BSymbol symbolAtCursor = symbolFinder.lookup(compilationUnit, position);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22d23f68cf7c965ad98d51c483a2ff98585e0d0d"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84b790c8dd5f621e901fdadb7a42719e5a518d4b", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/84b790c8dd5f621e901fdadb7a42719e5a518d4b", "committedDate": "2020-10-12T11:54:52Z", "message": "Remove the IdentifiableNode interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a71c50aa671e5eb1861ab1fa5b95866593aa2c7d", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a71c50aa671e5eb1861ab1fa5b95866593aa2c7d", "committedDate": "2020-10-12T11:41:25Z", "message": "Remove the IdentifiableNode interface"}, "afterCommit": {"oid": "84b790c8dd5f621e901fdadb7a42719e5a518d4b", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/84b790c8dd5f621e901fdadb7a42719e5a518d4b", "committedDate": "2020-10-12T11:54:52Z", "message": "Remove the IdentifiableNode interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d7a1b4329faf2d8355b33b4e0e40e6837a90869", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3d7a1b4329faf2d8355b33b4e0e40e6837a90869", "committedDate": "2020-10-12T12:30:07Z", "message": "Validate symbol arg passed to symbol factory method"}, "afterCommit": {"oid": "fa8857023fa9ede8e74ef2326f14cc6e7c577581", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fa8857023fa9ede8e74ef2326f14cc6e7c577581", "committedDate": "2020-10-12T12:34:16Z", "message": "Validate symbol arg passed to symbol factory method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NjIxODUy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315#pullrequestreview-506621852", "createdAt": "2020-10-12T13:31:41Z", "commit": {"oid": "fa8857023fa9ede8e74ef2326f14cc6e7c577581"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMzozMTo0MlrOHf-34g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMzozMTo0MlrOHf-34g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI5ODAxOA==", "bodyText": "Error message tells invalid kind, instead we show the class name. Shall we modify either the message or the input arg", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315#discussion_r503298018", "createdAt": "2020-10-12T13:31:42Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/io/ballerina/compiler/api/impl/symbols/SymbolFactory.java", "diffHunk": "@@ -92,7 +92,11 @@ public static Symbol getBCompiledSymbol(BSymbol symbol, String name) {\n             return createTypeDefinition((BTypeSymbol) symbol, name);\n         }\n \n-        return null;\n+        if (symbol == null) {\n+            throw new IllegalArgumentException(\"Symbol is 'null'\");\n+        }\n+\n+        throw new IllegalArgumentException(\"Unsupported symbol kind: \" + symbol.getClass().getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa8857023fa9ede8e74ef2326f14cc6e7c577581"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d26c6548fc5104c499d6499063aa6a7cb6b826e", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3d26c6548fc5104c499d6499063aa6a7cb6b826e", "committedDate": "2020-10-12T19:33:48Z", "message": "Validate symbol arg passed to symbol factory method"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa8857023fa9ede8e74ef2326f14cc6e7c577581", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fa8857023fa9ede8e74ef2326f14cc6e7c577581", "committedDate": "2020-10-12T12:34:16Z", "message": "Validate symbol arg passed to symbol factory method"}, "afterCommit": {"oid": "3d26c6548fc5104c499d6499063aa6a7cb6b826e", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3d26c6548fc5104c499d6499063aa6a7cb6b826e", "committedDate": "2020-10-12T19:33:48Z", "message": "Validate symbol arg passed to symbol factory method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MDIyOTA0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315#pullrequestreview-507022904", "createdAt": "2020-10-13T02:14:36Z", "commit": {"oid": "3d26c6548fc5104c499d6499063aa6a7cb6b826e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MDU2MzEx", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26315#pullrequestreview-507056311", "createdAt": "2020-10-13T04:12:26Z", "commit": {"oid": "3d26c6548fc5104c499d6499063aa6a7cb6b826e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4577, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}