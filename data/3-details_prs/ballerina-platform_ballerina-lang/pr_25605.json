{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4Nzg2NjU4", "number": 25605, "title": "Implement API for retrieving the symbol at a given position", "bodyText": "Purpose\n\nGiven a position, this API will look up the symbol at the position or return null if there isn't a symbol there.\n\nSamples\n\nProvide high-level details about the samples related to this feature.\n\nRemarks\n\nDepends on PR #25524\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-03T17:43:27Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605", "merged": true, "mergeCommit": {"oid": "3e9b4ae85953397914d5d20c463192b5fec0dcb3"}, "closed": true, "closedAt": "2020-09-12T05:03:24Z", "author": {"login": "pubudu91"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFU1-ngBqjM3MjYwMTc2OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdICyJmgFqTQ4NzIwNDAwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7c6f6a8d54c6301a6cab99181c70c922df0bbb2", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b7c6f6a8d54c6301a6cab99181c70c922df0bbb2", "committedDate": "2020-09-03T17:31:24Z", "message": "Implement API for retrieving the symbol at a given position"}, "afterCommit": {"oid": "d2513ba3d5e46460b70ebf72a946e20cef816d3c", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d2513ba3d5e46460b70ebf72a946e20cef816d3c", "committedDate": "2020-09-03T18:23:40Z", "message": "Implement API for retrieving the symbol at a given position"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2513ba3d5e46460b70ebf72a946e20cef816d3c", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d2513ba3d5e46460b70ebf72a946e20cef816d3c", "committedDate": "2020-09-03T18:23:40Z", "message": "Implement API for retrieving the symbol at a given position"}, "afterCommit": {"oid": "ff9509024e14681c3beebbaf5d186f99a99a2971", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff9509024e14681c3beebbaf5d186f99a99a2971", "committedDate": "2020-09-03T18:27:44Z", "message": "Implement API for retrieving the symbol at a given position"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff9509024e14681c3beebbaf5d186f99a99a2971", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ff9509024e14681c3beebbaf5d186f99a99a2971", "committedDate": "2020-09-03T18:27:44Z", "message": "Implement API for retrieving the symbol at a given position"}, "afterCommit": {"oid": "099d672eeb139711e14c66c1d38913364d9086ef", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/099d672eeb139711e14c66c1d38913364d9086ef", "committedDate": "2020-09-04T04:29:08Z", "message": "Implement API for retrieving the symbol at a given position"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMzU1NjE4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#pullrequestreview-482355618", "createdAt": "2020-09-04T04:49:49Z", "commit": {"oid": "099d672eeb139711e14c66c1d38913364d9086ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNDo0OTo0OVrOHM_b9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNDo0OTo0OVrOHM_b9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM4NDMxMQ==", "bodyText": "Shall we mention what needs to be improved? otherwise we might forget these over time", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#discussion_r483384311", "createdAt": "2020-09-04T04:49:49Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-compiler-api/src/main/java/org/ballerina/compiler/impl/BallerinaModuleID.java", "diffHunk": "@@ -66,4 +66,24 @@ public String toString() {\n         }\n         return this.orgName() + \"/\" + this.moduleName() + \":\" + this.version();\n     }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (this == obj) {\n+            return true;\n+        }\n+\n+        if (obj == null || getClass() != obj.getClass()) {\n+            return false;\n+        }\n+\n+        // TODO: Improve this", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "099d672eeb139711e14c66c1d38913364d9086ef"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMzY5NDc5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#pullrequestreview-482369479", "createdAt": "2020-09-04T05:34:47Z", "commit": {"oid": "099d672eeb139711e14c66c1d38913364d9086ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNTozNDo0N1rOHNAL0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNTozNDo0N1rOHNAL0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM5NjU2Mg==", "bodyText": "Is it possible to get this logic to a common place? Since the same is implemented in https://github.com/ballerina-platform/ballerina-lang/pull/25605/files#diff-3bb78fa9a4bfafbf27ec61bfdea79e93R1059 as well?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#discussion_r483396562", "createdAt": "2020-09-04T05:34:47Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-compiler-api/src/main/java/org/ballerina/compiler/impl/BallerinaSemanticModel.java", "diffHunk": "@@ -99,4 +129,31 @@ public BallerinaSemanticModel(BLangCompilationUnit compilationUnit, BLangPackage\n     public List<Diagnostic> diagnostics(TextRange range) {\n         return new ArrayList<>();\n     }\n+\n+    private boolean isSymbolInUserProject(BSymbol symbol, DiagnosticPos cursorPos) {\n+        return symbol.origin == SOURCE &&\n+                (cursorPos.compareTo(symbol.pos) > SYMBOL_POSITION ||\n+                        symbol.owner instanceof BPackageSymbol ||\n+                        Symbols.isFlagOn(symbol.flags, Flags.WORKER));\n+    }\n+\n+    private boolean isImportedSymbol(BSymbol symbol) {\n+        return symbol.origin == COMPILED_SOURCE &&\n+                (Symbols.isFlagOn(symbol.flags, Flags.PUBLIC) || symbol.getKind() == SymbolKind.PACKAGE);\n+    }\n+\n+    private boolean isWithinSymbol(LinePosition cursorPos, DiagnosticPos symbolPos) {\n+        int symbolStartLine = symbolPos.getStartLine();\n+        int symbolEndLine = symbolPos.getEndLine();\n+        int symbolStartCol = symbolPos.getStartColumn();\n+        int symbolEndCol = symbolPos.getEndColumn();\n+        int cursorLine = cursorPos.line();\n+        int cursorCol = cursorPos.offset();\n+\n+        return (symbolStartLine < cursorLine && symbolEndLine > cursorLine)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "099d672eeb139711e14c66c1d38913364d9086ef"}, "originalPosition": 133}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "099d672eeb139711e14c66c1d38913364d9086ef", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/099d672eeb139711e14c66c1d38913364d9086ef", "committedDate": "2020-09-04T04:29:08Z", "message": "Implement API for retrieving the symbol at a given position"}, "afterCommit": {"oid": "960310c2274e2f355f54a5e021e3a73d64805155", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/960310c2274e2f355f54a5e021e3a73d64805155", "committedDate": "2020-09-07T09:47:43Z", "message": "Refactor exact symbol lookup API to accept the file name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e2950f4721626f174177bb06bba5d3475f11d53", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5e2950f4721626f174177bb06bba5d3475f11d53", "committedDate": "2020-09-10T06:49:56Z", "message": "Sync API changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08d8875dd6d9f6158dd346c672a7f80b63cf9f12", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/08d8875dd6d9f6158dd346c672a7f80b63cf9f12", "committedDate": "2020-09-10T06:50:00Z", "message": "Fix symbol visibility issue in let expr"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42a0fa14c2420ea8bf4aced65807eeffd16e7362", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/42a0fa14c2420ea8bf4aced65807eeffd16e7362", "committedDate": "2020-09-10T06:50:01Z", "message": "Refactor symbol lookup API to accept file name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b2acdad0ad526e58f108054573d919246773197", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4b2acdad0ad526e58f108054573d919246773197", "committedDate": "2020-09-10T06:50:01Z", "message": "Sync with API changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c231b59186cd0f6cd3d2b16d941403e39c2cffc", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9c231b59186cd0f6cd3d2b16d941403e39c2cffc", "committedDate": "2020-09-10T06:50:01Z", "message": "Implement API for retrieving the symbol at a given position"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b529e53b789a7d3b3deb55f2086ee3e39d606b5", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5b529e53b789a7d3b3deb55f2086ee3e39d606b5", "committedDate": "2020-09-10T06:50:01Z", "message": "Refactor exact symbol lookup API to accept the file name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab925c1aed0661527dbe20bb25203ead7054f8a1", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ab925c1aed0661527dbe20bb25203ead7054f8a1", "committedDate": "2020-09-10T06:50:02Z", "message": "Sync with API changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "960310c2274e2f355f54a5e021e3a73d64805155", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/960310c2274e2f355f54a5e021e3a73d64805155", "committedDate": "2020-09-07T09:47:43Z", "message": "Refactor exact symbol lookup API to accept the file name"}, "afterCommit": {"oid": "ab925c1aed0661527dbe20bb25203ead7054f8a1", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ab925c1aed0661527dbe20bb25203ead7054f8a1", "committedDate": "2020-09-10T06:50:02Z", "message": "Sync with API changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MjAzOTk3", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#pullrequestreview-487203997", "createdAt": "2020-09-12T05:03:06Z", "commit": {"oid": "ab925c1aed0661527dbe20bb25203ead7054f8a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNTowMzowNlrOHQyoxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNTowMzowNlrOHQyoxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM2ODkwMQ==", "bodyText": "Do we still need this?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#discussion_r487368901", "createdAt": "2020-09-12T05:03:06Z", "author": {"login": "SupunS"}, "path": "compiler/ballerina-compiler-api/build.gradle", "diffHunk": "@@ -27,6 +27,9 @@ dependencies {\n \n     testCompile 'org.testng:testng'\n     testCompile project(path: ':ballerina-test-utils', configuration: 'shadow')\n+    testCompile project(':ballerina-io')\n+\n+    baloTestImplementation project(path: ':ballerina-io', configuration: 'baloImplementation')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab925c1aed0661527dbe20bb25203ead7054f8a1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MjA0MDAy", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25605#pullrequestreview-487204002", "createdAt": "2020-09-12T05:03:13Z", "commit": {"oid": "ab925c1aed0661527dbe20bb25203ead7054f8a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4805, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}