{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyODkzMjM5", "number": 26095, "title": "Add string diff to the error message when equality assertion fails", "bodyText": "Purpose\nAdds string diff to the error message when equality assertion fails.\nFixes part 2 of #12892\nApproach\nNote: Add \"java-diff-utils-4.5.jar\"(54KB) to \"ballerina-lang/distribution/zip/jballerina-tools/lib/\"\nWhen \"assertEquals\" fails and the types of the compared values are the same, a string difference will be shown as in the below samples.\nSamples\n> test:assertEquals(\"hello dilhassha\", \"hello dilhasha\");\n\n            Assertion Failed!\n                expected: 'hello dilhasha'\n                actual  : 'hello dilhassha'\n                Diff    :\n                --- expected\n                +++ actual\n                @@ -1,1 +1,1 @@\n                -hello dilhassha\n                +hello dilhasha\n\n>\nstring value1 = \"Ballerina is an open source programming language and platform for cloud-era application programmers.\\nSequence diagrams have been everyone\u2019s favorite tool to describe how distributed & conccurrent programs work.\";\nstring value2 = \"Ballerina is an open source programming language and platform for cloud-era application programmersss.\\nSequence diagrams have been everyone\u2019s favorite tool to describe how distributed & concurrent programs work.\";\ntest:assertEquals(value1,value2);\n\n       Assertion Failed!\n               expected: 'Ballerina is an open source programming language and platform for cloud-era appl'\n               actual  : 'Ballerina is an open source programming language and platform for cloud-era appl'\n               Diff    :\n               --- expected\n               +++ actual\n               @@ -1,4 +1,4 @@\n               Ballerina is an open source programming language and platform for cloud-era appl\n               -ication programmers.\n               +ication programmersss.\n               Sequence diagrams have been everyone\u2019s favorite tool to describe how distributed\n               - & conccurrent programs work.\n               + & concurrent programs work.\n\nRemarks\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-09-25T07:35:15Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095", "merged": true, "mergeCommit": {"oid": "4bc93d23d0dd766e4002af02228c215d1d8a5f47"}, "closed": true, "closedAt": "2020-10-09T11:42:12Z", "author": {"login": "Dilhasha"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNXC_YABqjM4MTU2ODE3MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQ0q-xAFqTUwNTU5NTc2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "579d8925a6935dec1571e499448b96a3c6fe4b4d", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/579d8925a6935dec1571e499448b96a3c6fe4b4d", "committedDate": "2020-09-28T16:35:13Z", "message": "Show assertion diff in unified format"}, "afterCommit": {"oid": "70b87d89b52d5c8fdc50335f9a8110513ec7b3bd", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/70b87d89b52d5c8fdc50335f9a8110513ec7b3bd", "committedDate": "2020-09-28T17:28:17Z", "message": "Show assertion diff in unified format"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70b87d89b52d5c8fdc50335f9a8110513ec7b3bd", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/70b87d89b52d5c8fdc50335f9a8110513ec7b3bd", "committedDate": "2020-09-28T17:28:17Z", "message": "Show assertion diff in unified format"}, "afterCommit": {"oid": "aad6c2c052f91025cece319fd36cbbee1bebf951", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/aad6c2c052f91025cece319fd36cbbee1bebf951", "committedDate": "2020-09-28T17:45:43Z", "message": "Show assertion diff in unified format"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aad6c2c052f91025cece319fd36cbbee1bebf951", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/aad6c2c052f91025cece319fd36cbbee1bebf951", "committedDate": "2020-09-28T17:45:43Z", "message": "Show assertion diff in unified format"}, "afterCommit": {"oid": "8fddd8586d4cd78735e1eacd6c66ccc22b3b2b86", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8fddd8586d4cd78735e1eacd6c66ccc22b3b2b86", "committedDate": "2020-09-28T20:00:14Z", "message": "Show assertion diff in unified format"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68ca05cb4c88cefdb1ee2350bb9c1674796c8bee", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/68ca05cb4c88cefdb1ee2350bb9c1674796c8bee", "committedDate": "2020-10-05T08:51:48Z", "message": "Improve assertion diff implementation"}, "afterCommit": {"oid": "4fe41400c87a5d3c8b28858983fbfe7599f84e7b", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4fe41400c87a5d3c8b28858983fbfe7599f84e7b", "committedDate": "2020-10-08T06:48:59Z", "message": "Improve assertion diff implementation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0112be593ed3ad06f3dda109368cb945da9b5198", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0112be593ed3ad06f3dda109368cb945da9b5198", "committedDate": "2020-10-08T07:09:22Z", "message": "Add java-diff-utils"}, "afterCommit": {"oid": "4b0e13411014ecb63e82de2c0ea224ad8c9253d4", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4b0e13411014ecb63e82de2c0ea224ad8c9253d4", "committedDate": "2020-10-08T07:10:09Z", "message": "Add java-diff-utils"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NTk4MzQ5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#pullrequestreview-504598349", "createdAt": "2020-10-08T09:33:09Z", "commit": {"oid": "0b5e58a60e1636f085585996787740ed6cfe1538"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwOTozMzowOVrOHeWA_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwOTozMzowOVrOHeWA_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTU4MDAyOQ==", "bodyText": "End of line is missing", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#discussion_r501580029", "createdAt": "2020-10-08T09:33:09Z", "author": {"login": "parkavi11"}, "path": "misc/testerina/modules/testerina-core/src/main/java/module-info.java", "diffHunk": "@@ -4,4 +4,5 @@\n     requires io.ballerina.core;\n     requires io.ballerina.testerina.runtime;\n     requires io.ballerina.jvm;\n+    requires io.github.javadiffutils;\n }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b5e58a60e1636f085585996787740ed6cfe1538"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26383a82ef5138b9703f169a7822329622662a30", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/26383a82ef5138b9703f169a7822329622662a30", "committedDate": "2020-10-08T09:38:21Z", "message": "Add string diff for failed assertions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a07f997a4005b85b2a6c0b65619d8e7a80de60f8", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a07f997a4005b85b2a6c0b65619d8e7a80de60f8", "committedDate": "2020-10-08T09:38:22Z", "message": "Show assertion diff in unified format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1655268601d83b16833f86b390aa4d12d4dceb9a", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1655268601d83b16833f86b390aa4d12d4dceb9a", "committedDate": "2020-10-08T09:38:22Z", "message": "Add line based assertion diff"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5669b1b8e100d9598080e84fb653467c121dab3f", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5669b1b8e100d9598080e84fb653467c121dab3f", "committedDate": "2020-10-08T09:38:22Z", "message": "Improve assertion diff implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7138085241d4b654c4a62b7ae0dfcc2acf32da1", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c7138085241d4b654c4a62b7ae0dfcc2acf32da1", "committedDate": "2020-10-08T09:38:22Z", "message": "Add java-diff-utils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "839a2913cd43ffdbb4b9de6832359af75270bcdb", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/839a2913cd43ffdbb4b9de6832359af75270bcdb", "committedDate": "2020-10-08T09:38:22Z", "message": "Add dependency to module-info"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81cb8799d4d1b70cdcac6b764c9a4f36d7430b6e", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/81cb8799d4d1b70cdcac6b764c9a4f36d7430b6e", "committedDate": "2020-10-08T09:38:22Z", "message": "Improve long string error message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b1c0ee9221a1df5eddd5a7325b5688936f21a70", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b1c0ee9221a1df5eddd5a7325b5688936f21a70", "committedDate": "2020-10-08T09:53:02Z", "message": "Update test cases for error messages"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aef0c327f20e4ce0b85c3fb586391c0e041af3fc", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/aef0c327f20e4ce0b85c3fb586391c0e041af3fc", "committedDate": "2020-10-08T09:36:44Z", "message": "Improve long string error message"}, "afterCommit": {"oid": "6b1c0ee9221a1df5eddd5a7325b5688936f21a70", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b1c0ee9221a1df5eddd5a7325b5688936f21a70", "committedDate": "2020-10-08T09:53:02Z", "message": "Update test cases for error messages"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NjMzNjk1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#pullrequestreview-504633695", "createdAt": "2020-10-08T10:16:58Z", "commit": {"oid": "16a3a5d6b6967ea6ee960bf3bdff4986d38e75c4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDoxNjo1OVrOHeXs7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDoxNjo1OVrOHeXs7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYwNzY2MA==", "bodyText": "Why don't we add license header for this file?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#discussion_r501607660", "createdAt": "2020-10-08T10:16:59Z", "author": {"login": "parkavi11"}, "path": "misc/testerina/modules/testerina-core/src/main/java/org/ballerinalang/testerina/core/AssertionDiffEvaluator.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package org.ballerinalang.testerina.core;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16a3a5d6b6967ea6ee960bf3bdff4986d38e75c4"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NjM1NTMw", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#pullrequestreview-504635530", "createdAt": "2020-10-08T10:19:17Z", "commit": {"oid": "16a3a5d6b6967ea6ee960bf3bdff4986d38e75c4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDoxOToxN1rOHeXyiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDoxOToxN1rOHeXyiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYwOTA5Ng==", "bodyText": "Isn't this line exceeds 120 character limit?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#discussion_r501609096", "createdAt": "2020-10-08T10:19:17Z", "author": {"login": "parkavi11"}, "path": "tests/testerina-integration-test/src/test/resources/project-based-tests/basic-tests/src/assertions-error-messages/tests/assertions-error-messages.bal", "diffHunk": "@@ -88,7 +88,7 @@ function testAssertTableAndString() {\n     string customerTabString = \"table [{id: 1, name: \\\"John\\\", salary: 300.50},{id: 2, name: \\\"Bella\\\", salary: 500.50}]\";\n     error? err = trap test:assertEquals(customerTab, customerTabString);\n     error result = <error>err;\n-    test:assertEquals(result.message().toString(), \"Assertion Failed!\\nexpected: <string> 'table [{id: 1, name: \\\"John\\\", salary: 300.50},{id: 2, name: \\\"Bella\\\", salary: 500.'\\nactual\\t: <table> '[{\\\"id\\\":1,\\\"name\\\":\\\"John\\\",\\\"salary\\\":300.5},{\\\"id\\\":2,\\\"name\\\":\\\"Bella\\\",\\\"salary\\\":500.5}]'\");\n+    test:assertEquals(result.message().toString(), \"Assertion Failed!\\nexpected: <string> 'table [{id: 1, name: \\\"John\\\", salary: 300.50},{id: 2, name: \\\"Bella\\\", salary: 500....'\\nactual\\t: <table> '[{\\\"id\\\":1,\\\"name\\\":\\\"John\\\",\\\"salary\\\":300.5},{\\\"id\\\":2,\\\"name\\\":\\\"Bella\\\",\\\"salary\\\":500.5}]'\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16a3a5d6b6967ea6ee960bf3bdff4986d38e75c4"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e61395794953ad4e063af419e4ce35995e8c41fa", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e61395794953ad4e063af419e4ce35995e8c41fa", "committedDate": "2020-10-08T11:12:16Z", "message": "Fix PR siggestions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16a3a5d6b6967ea6ee960bf3bdff4986d38e75c4", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/16a3a5d6b6967ea6ee960bf3bdff4986d38e75c4", "committedDate": "2020-10-08T10:02:52Z", "message": "Add new line"}, "afterCommit": {"oid": "e61395794953ad4e063af419e4ce35995e8c41fa", "author": {"user": {"login": "Dilhasha", "name": "Fathima Dilhasha"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e61395794953ad4e063af419e4ce35995e8c41fa", "committedDate": "2020-10-08T11:12:16Z", "message": "Fix PR siggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NTk1NzY4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26095#pullrequestreview-505595768", "createdAt": "2020-10-09T11:42:02Z", "commit": {"oid": "e61395794953ad4e063af419e4ce35995e8c41fa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4662, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}