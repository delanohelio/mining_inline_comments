{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NDIzMjQy", "number": 27423, "title": "Add an API to get the symbols of the attached annotations", "bodyText": "Purpose\nThis PR adds an API to retrieve the symbols of the annotations attached to constructs.\nFix #27012\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-12-09T19:48:16Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423", "merged": true, "mergeCommit": {"oid": "22e2a932347ddd2677b6c5215812f6da7038dd3c"}, "closed": true, "closedAt": "2020-12-15T10:05:24Z", "author": {"login": "pubudu91"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdks-n6ABqjQwOTMzMjc5NjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmXFGugFqTU1MjI2NjU2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "979a382ea83acb14cc68686373238bb723442803", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/979a382ea83acb14cc68686373238bb723442803", "committedDate": "2020-12-09T19:46:01Z", "message": "Add tests for annotations()"}, "afterCommit": {"oid": "66221c9bcca4858fa1ee905280e7f09efa506592", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/66221c9bcca4858fa1ee905280e7f09efa506592", "committedDate": "2020-12-10T06:02:26Z", "message": "Add tests for annotations()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "66221c9bcca4858fa1ee905280e7f09efa506592", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/66221c9bcca4858fa1ee905280e7f09efa506592", "committedDate": "2020-12-10T06:02:26Z", "message": "Add tests for annotations()"}, "afterCommit": {"oid": "4dfe2103f08455d7b2974991e81530289e889f40", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4dfe2103f08455d7b2974991e81530289e889f40", "committedDate": "2020-12-11T11:41:36Z", "message": "Disable tests for unsupported symbols"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47e332484b217e8b30923dc77324f6197638d1c7", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/47e332484b217e8b30923dc77324f6197638d1c7", "committedDate": "2020-12-11T13:10:40Z", "message": "Add tests for annotations in enum symbol"}, "afterCommit": {"oid": "6b7b05d205facb317bd3743b16ef17ddc55f4df0", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b7b05d205facb317bd3743b16ef17ddc55f4df0", "committedDate": "2020-12-11T13:47:33Z", "message": "Add tests for annotations in enum symbol"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b7b05d205facb317bd3743b16ef17ddc55f4df0", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b7b05d205facb317bd3743b16ef17ddc55f4df0", "committedDate": "2020-12-11T13:47:33Z", "message": "Add tests for annotations in enum symbol"}, "afterCommit": {"oid": "53097beb788d4fb205a225d6084a5befbd19b30c", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/53097beb788d4fb205a225d6084a5befbd19b30c", "committedDate": "2020-12-14T04:58:47Z", "message": "Add tests for annotations in enum symbol"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTM4OTk1", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#pullrequestreview-552138995", "createdAt": "2020-12-15T06:26:23Z", "commit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f"}, "state": "DISMISSED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNjoyNjoyNFrOIF66rA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNjoyODo1OVrOIF6-nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA3OTA4NA==", "bodyText": "Maybe we can use Collections.emptyList() here", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#discussion_r543079084", "createdAt": "2020-12-15T06:26:24Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/io/ballerina/compiler/api/impl/symbols/BallerinaTypeDefinitionSymbol.java", "diffHunk": "@@ -79,6 +80,11 @@ public boolean readonly() {\n         return this.readonly;\n     }\n \n+    @Override\n+    public List<AnnotationSymbol> annotations() {\n+        return Collections.unmodifiableList(new ArrayList<>());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA3OTc1MQ==", "bodyText": "Shall we do an early return here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#discussion_r543079751", "createdAt": "2020-12-15T06:28:02Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/model/symbols/BAnnotationSymbol.java", "diffHunk": "@@ -41,12 +43,26 @@\n     public BTypeSymbol attachedType;\n     public Set<AttachPoint> points;\n     public int maskedPoints;\n+    private List<BAnnotationSymbol> annots;\n \n     public BAnnotationSymbol(Name name, long flags, Set<AttachPoint> points, PackageID pkgID,\n                              BType type, BSymbol owner, Location pos, SymbolOrigin origin) {\n         super(ANNOTATION, flags, name, pkgID, type, owner, pos, origin);\n         this.points = points;\n         this.maskedPoints = getMaskedPoints(points);\n+        this.annots = new ArrayList<>();\n+    }\n+\n+    @Override\n+    public void addAnnotation(AnnotationSymbol symbol) {\n+        if (symbol != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA3OTg4Mg==", "bodyText": "Shall we do an early return here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#discussion_r543079882", "createdAt": "2020-12-15T06:28:23Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/model/symbols/BClassSymbol.java", "diffHunk": "@@ -19,32 +19,49 @@\n \n import io.ballerina.tools.diagnostics.Location;\n import org.ballerinalang.model.elements.PackageID;\n+import org.ballerinalang.model.symbols.Annotatable;\n+import org.ballerinalang.model.symbols.AnnotationSymbol;\n import org.ballerinalang.model.symbols.SymbolOrigin;\n import org.wso2.ballerinalang.compiler.semantics.model.types.BType;\n import org.wso2.ballerinalang.compiler.util.Name;\n import org.wso2.ballerinalang.compiler.util.Names;\n \n import java.util.ArrayList;\n+import java.util.List;\n \n /**\n  * {@code BClassSymbol} represents a class symbol in a scope.\n  *\n  * @since 2.0\n  */\n-public class BClassSymbol extends BObjectTypeSymbol {\n+public class BClassSymbol extends BObjectTypeSymbol implements Annotatable {\n \n     public boolean isServiceDecl;\n+    private List<BAnnotationSymbol> annots;\n \n     public BClassSymbol(int symTag, long flags, Name name, PackageID pkgID, BType type,\n                         BSymbol owner, Location pos, SymbolOrigin origin) {\n         super(symTag, flags, name, pkgID, type, owner, pos, origin);\n         this.referencedFunctions = new ArrayList<>();\n+        this.annots = new ArrayList<>();\n+    }\n+\n+    @Override\n+    public void addAnnotation(AnnotationSymbol symbol) {\n+        if (symbol != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA4MDA1Mw==", "bodyText": "Shall we do an early return here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#discussion_r543080053", "createdAt": "2020-12-15T06:28:51Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/model/symbols/BEnumSymbol.java", "diffHunk": "@@ -20,26 +20,49 @@\n \n import io.ballerina.tools.diagnostics.Location;\n import org.ballerinalang.model.elements.PackageID;\n+import org.ballerinalang.model.symbols.Annotatable;\n+import org.ballerinalang.model.symbols.AnnotationSymbol;\n import org.ballerinalang.model.symbols.SymbolKind;\n import org.ballerinalang.model.symbols.SymbolOrigin;\n import org.wso2.ballerinalang.compiler.semantics.model.types.BType;\n import org.wso2.ballerinalang.compiler.util.Name;\n \n+import java.util.ArrayList;\n import java.util.List;\n \n /**\n  * Represents an enum.\n  *\n  * @since 2.0.0\n  */\n-public class BEnumSymbol extends BTypeSymbol {\n+public class BEnumSymbol extends BTypeSymbol implements Annotatable {\n \n     public List<BConstantSymbol> members;\n+    private List<BAnnotationSymbol> annots;\n \n     public BEnumSymbol(List<BConstantSymbol> members, long flags, Name name, PackageID pkgID, BType type,\n                        BSymbol owner, Location pos, SymbolOrigin origin) {\n         super(SymTag.ENUM, flags, name, pkgID, type, owner, pos, origin);\n         this.members = members;\n         this.kind = SymbolKind.ENUM;\n+        this.annots = new ArrayList<>();\n+    }\n+\n+    @Override\n+    public void addAnnotation(AnnotationSymbol symbol) {\n+        if (symbol != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA4MDA5NQ==", "bodyText": "Shall we do an early return here?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#discussion_r543080095", "createdAt": "2020-12-15T06:28:59Z", "author": {"login": "nadeeshaan"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/model/symbols/BVarSymbol.java", "diffHunk": "@@ -44,6 +50,19 @@\n     public BVarSymbol(long flags, Name name, PackageID pkgID, BType type, BSymbol owner, Location pos,\n                       SymbolOrigin origin) {\n         super(VARIABLE, flags, name, pkgID, type, owner, pos, origin);\n+        this.annots = new ArrayList<>();\n+    }\n+\n+    @Override\n+    public void addAnnotation(AnnotationSymbol symbol) {\n+        if (symbol != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "438307feed2f418009ccffdd5dd2b02aee81a75f", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/438307feed2f418009ccffdd5dd2b02aee81a75f", "committedDate": "2020-12-15T08:44:25Z", "message": "Introduce an API for getting the annot attachements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07af9fc4d239cbc6a7bfa05fa439d13175c8a586", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/07af9fc4d239cbc6a7bfa05fa439d13175c8a586", "committedDate": "2020-12-15T08:44:26Z", "message": "Add a default implementation for annotations()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc43cce0d6fd71709d19fcc1ea4c770cfc7b85cf", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cc43cce0d6fd71709d19fcc1ea4c770cfc7b85cf", "committedDate": "2020-12-15T08:44:26Z", "message": "Add annotation info to internal symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c71f74f92ac373375f93ecfdbd70116ccc2c12be", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c71f74f92ac373375f93ecfdbd70116ccc2c12be", "committedDate": "2020-12-15T08:44:26Z", "message": "Implement annotations() for annotation symbol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed7dcd2a030d71cafb56345fd404bf040bdd2ccf", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ed7dcd2a030d71cafb56345fd404bf040bdd2ccf", "committedDate": "2020-12-15T08:44:26Z", "message": "Implement annotations() for class symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daba939e285d19d73ca45a420e2ca67c3231a824", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/daba939e285d19d73ca45a420e2ca67c3231a824", "committedDate": "2020-12-15T08:44:27Z", "message": "Implement annotations() for var and constant symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cea74032d20e4d691d287fc0b65f3e634858b266", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/cea74032d20e4d691d287fc0b65f3e634858b266", "committedDate": "2020-12-15T08:44:27Z", "message": "Implement annotations() for field symbol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "261b41c491cddce9e0dc2ec1a07df7d41f968ee8", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/261b41c491cddce9e0dc2ec1a07df7d41f968ee8", "committedDate": "2020-12-15T08:44:27Z", "message": "Implment annotations() for function and related symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "891c4c3331831a17ef9925a5df2a2ab8814edaf4", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/891c4c3331831a17ef9925a5df2a2ab8814edaf4", "committedDate": "2020-12-15T08:44:27Z", "message": "Fix annotation symbol collection issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ad14a88c760c8c3b4410ff9f90d0632cb42360f", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2ad14a88c760c8c3b4410ff9f90d0632cb42360f", "committedDate": "2020-12-15T08:44:28Z", "message": "Add tests for annotations()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c33286eede830cf1a5a7b2f510d4aed0659ea06", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8c33286eede830cf1a5a7b2f510d4aed0659ea06", "committedDate": "2020-12-15T08:44:28Z", "message": "Disable tests for unsupported symbols"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "affbc3eabc35e8fee46b2975451bb47267cc715e", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/affbc3eabc35e8fee46b2975451bb47267cc715e", "committedDate": "2020-12-15T08:44:28Z", "message": "Add annotations to enum symbol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "140d364c7d25c200c5c610d122e7cb0a6bf9ff1a", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/140d364c7d25c200c5c610d122e7cb0a6bf9ff1a", "committedDate": "2020-12-15T08:44:28Z", "message": "Add metadata to enum in AST"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26230c1db8735bfc480fba43bad93a03ff839efe", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/26230c1db8735bfc480fba43bad93a03ff839efe", "committedDate": "2020-12-15T08:44:28Z", "message": "Add tests for annotations in enum symbol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef593729644558b36fe257a99f249ab305ee6499", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ef593729644558b36fe257a99f249ab305ee6499", "committedDate": "2020-12-15T08:44:29Z", "message": "Prevent null annotation symbols from being added to annot list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f64e0281c8debbfbc4b4a2c2fb2f2cd7f8fb4cb4", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f64e0281c8debbfbc4b4a2c2fb2f2cd7f8fb4cb4", "committedDate": "2020-12-15T08:44:29Z", "message": "Fix review suggestions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51dd3bfe4efe5adcf66115a22b72346fd411183f", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/51dd3bfe4efe5adcf66115a22b72346fd411183f", "committedDate": "2020-12-14T11:39:26Z", "message": "Prevent null annotation symbols from being added to annot list"}, "afterCommit": {"oid": "f64e0281c8debbfbc4b4a2c2fb2f2cd7f8fb4cb4", "author": {"user": {"login": "pubudu91", "name": "Pubudu Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f64e0281c8debbfbc4b4a2c2fb2f2cd7f8fb4cb4", "committedDate": "2020-12-15T08:44:29Z", "message": "Fix review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMjY2NTY0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27423#pullrequestreview-552266564", "createdAt": "2020-12-15T09:39:45Z", "commit": {"oid": "f64e0281c8debbfbc4b4a2c2fb2f2cd7f8fb4cb4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4783, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}