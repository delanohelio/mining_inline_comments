{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNDU0MjM3", "number": 21477, "title": "Add let clause to query expressions", "bodyText": "Purpose\n\nThe let clause binds variables within query expressions\nFixes #20811\n\nApproach\n\nn/a\n\nSamples\nvar x =\n  from var person in personList\n  let string c = person.country\n  where c == \"UK\"\n  select {\n      firstName: person.firstName,\n      lastName: person.lastName\n      country: c\n  };\nRemarks\n\nn/a\n\nCheck List\n\n Read the Contributing Guide\n Updated Change Log\n Checked Tooling Support (#)\n Added necessary tests\n\n Unit Tests\n Spec Conformance Tests\n Integration Tests\n Ballerina By Example Tests\n\n\n Increased Test Coverage\n Added necessary documentation\n\n API documentation\n Module documentation in Module.md files\n Ballerina By Examples", "createdAt": "2020-03-04T10:09:25Z", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477", "merged": true, "mergeCommit": {"oid": "e67a0e8e726aa93dfd05535648d4e764dd08f83e"}, "closed": true, "closedAt": "2020-03-05T05:20:38Z", "author": {"login": "pcnfernando"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKT2suAH2gAyMzgzNDU0MjM3OjdjYjM0MDY5NWY0ODVmYjA2MjUxNDEyZjY0ZTFjOGZkZmY5MDk3MjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKjItfgH2gAyMzgzNDU0MjM3OmFjODA2ZDhkZDBmYzZlZDgyZGYyNzFiZGIyOGM4ODkxMTBhNGYzZDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7cb340695f485fb06251412f64e1c8fdff909720", "author": {"user": {"login": "KavinduZoysa", "name": null}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7cb340695f485fb06251412f64e1c8fdff909720", "committedDate": "2020-03-04T09:53:16Z", "message": "Create relevant nodes for let expression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ceb124789668cc2f1363b30088b9232e7c7eb32", "author": {"user": {"login": "irshadnilam", "name": "Irshad Nilam"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0ceb124789668cc2f1363b30088b9232e7c7eb32", "committedDate": "2020-03-04T09:53:16Z", "message": "Resolve grammar file conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e719aceb7b4190d97a1a3e9fcaea955c85f7bacd", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e719aceb7b4190d97a1a3e9fcaea955c85f7bacd", "committedDate": "2020-03-04T09:53:16Z", "message": "Introduce let clause to query expression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "202cc45680f84357e9383ddb264406730a3f21e5", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/202cc45680f84357e9383ddb264406730a3f21e5", "committedDate": "2020-03-04T09:53:16Z", "message": "Add multiple let clause tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "325c469c8214c6ca7363f9e15ac86544ada8e2a0", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/325c469c8214c6ca7363f9e15ac86544ada8e2a0", "committedDate": "2020-03-04T09:53:16Z", "message": "Add let clause tests for mutiple from claused queries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "318fc006fdc45d55e7f25304c4c04d12b518ee94", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/318fc006fdc45d55e7f25304c4c04d12b518ee94", "committedDate": "2020-03-04T09:53:16Z", "message": "Support using let variable declarations within where clause"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e36e4d9b7f659671c2db9ba8ed80ae7baf530a12", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e36e4d9b7f659671c2db9ba8ed80ae7baf530a12", "committedDate": "2020-03-04T09:53:16Z", "message": "Support let var declarations be used within query action"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b634a775cbac808b02773063dbb7794c220c75d4", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b634a775cbac808b02773063dbb7794c220c75d4", "committedDate": "2020-03-04T09:53:16Z", "message": "Use the same variable definition in letVarDeclaration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "586db2c6315097a72fa170e52abcf48b8797199d", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/586db2c6315097a72fa170e52abcf48b8797199d", "committedDate": "2020-03-04T11:04:57Z", "message": "Remove unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NzUzMjc5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#pullrequestreview-368753279", "createdAt": "2020-03-04T12:56:12Z", "commit": {"oid": "586db2c6315097a72fa170e52abcf48b8797199d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c9a8aab694ff77a240294ba74cb305626a4080a1", "committedDate": "2020-03-04T13:13:08Z", "message": "Add multiple from clause test under query action tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODE5MTY0", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#pullrequestreview-368819164", "createdAt": "2020-03-04T14:24:58Z", "commit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDoyNDo1OFrOFxvO1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDoyNDo1OFrOFxvO1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY5ODM4OQ==", "bodyText": "Shall we remove the\n/home/chiran/Desktop/WSO2/Ballerina/ballerina-lang/compiler/ballerina-lang/src/main/resources/grammar/\npart?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#discussion_r387698389", "createdAt": "2020-03-04T14:24:58Z", "author": {"login": "irshadnilam"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/parser/antlr4/BallerinaParserBaseListener.java", "diffHunk": "@@ -1,4 +1,4 @@\n-// Generated from BallerinaParser.g4 by ANTLR 4.5.3\n+// Generated from /home/chiran/Desktop/WSO2/Ballerina/ballerina-lang/compiler/ballerina-lang/src/main/resources/grammar/BallerinaParser.g4 by ANTLR 4.5.3", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODI3ODY5", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#pullrequestreview-368827869", "createdAt": "2020-03-04T14:34:49Z", "commit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDozNDo0OVrOFxvo8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDozNDo0OVrOFxvo8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcwNTA3NA==", "bodyText": "Do we need this? Is this visited?\nIf so, shall we visit letdeclarations and expressions with env of letexpression?\nIE:\n   public void visit(BLangLetExpression letExpression) {\n        for (BLangLetVariable letVarDeclaration : letExpression.letVarDeclarations) {\n            analyzeDef((BLangNode) letVarDeclaration.definitionNode, letExpression.env);\n        }\n        analyzeDef(letExpression.expr, letExpression.env);\n    }", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#discussion_r387705074", "createdAt": "2020-03-04T14:34:49Z", "author": {"login": "irshadnilam"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/SemanticAnalyzer.java", "diffHunk": "@@ -1621,6 +1624,10 @@ public void visit(BLangSimpleVariableDef varDefNode) {\n         analyzeDef(varDefNode.var, env);\n     }\n \n+    public void visit(BLangLetExpression letExpression) {\n+        analyzeDef(letExpression, env);\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODMxMDQ2", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#pullrequestreview-368831046", "createdAt": "2020-03-04T14:38:39Z", "commit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDozODozOVrOFxvyoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDozODozOVrOFxvyoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcwNzU1Mw==", "bodyText": "Shall we rename the NodeKind.LET to something more descriptive (NodeKind.LET_CLAUSE ?) since we have let declarations, let expressions, let clause etc?", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#discussion_r387707553", "createdAt": "2020-03-04T14:38:39Z", "author": {"login": "irshadnilam"}, "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/tree/clauses/BLangLetClause.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.ballerinalang.compiler.tree.clauses;\n+\n+import org.ballerinalang.model.clauses.LetClauseNode;\n+import org.ballerinalang.model.tree.NodeKind;\n+import org.wso2.ballerinalang.compiler.tree.BLangNode;\n+import org.wso2.ballerinalang.compiler.tree.BLangNodeVisitor;\n+import org.wso2.ballerinalang.compiler.tree.types.BLangLetVariable;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.StringJoiner;\n+\n+/**\n+ * Implementation of \"let\" clause statement.\n+ *\n+ * @since 1.2.0\n+ */\n+public class BLangLetClause extends BLangNode implements LetClauseNode {\n+\n+    public List<BLangLetVariable> getLetVarDeclarations() {\n+        return letVarDeclarations;\n+    }\n+\n+    public void addLetVarDeclarations(List<BLangLetVariable> letVarDeclarations) {\n+        this.letVarDeclarations = letVarDeclarations;\n+    }\n+\n+    public List<BLangLetVariable> letVarDeclarations = new ArrayList<>();\n+\n+    public BLangLetClause() {\n+    }\n+\n+    @Override\n+    public NodeKind getKind() {\n+        return NodeKind.LET;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9a8aab694ff77a240294ba74cb305626a4080a1"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddd76c93e5f49c0519b93302baa4b649c98465ac", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ddd76c93e5f49c0519b93302baa4b649c98465ac", "committedDate": "2020-03-04T14:54:41Z", "message": "Update auto generated comments to its standards"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "615bdc75e2806b2faa0b40dbf09289795b6fdd34", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/615bdc75e2806b2faa0b40dbf09289795b6fdd34", "committedDate": "2020-03-04T15:03:24Z", "message": "Rename NodeKind.LET to NodeKind.LET_CLAUSE to differentiate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODU0OTU4", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21477#pullrequestreview-368854958", "createdAt": "2020-03-04T15:05:59Z", "commit": {"oid": "615bdc75e2806b2faa0b40dbf09289795b6fdd34"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac806d8dd0fc6ed82df271bdb28c889110a4f3d1", "author": {"user": {"login": "pcnfernando", "name": "Chiran Fernando"}}, "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ac806d8dd0fc6ed82df271bdb28c889110a4f3d1", "committedDate": "2020-03-05T03:41:31Z", "message": "Remove unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3955, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}