{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MjExMDg4", "number": 1492, "title": "Add arguments for inputs and output to the ConvertSequencingArtifactToOxoG command", "bodyText": "Description\nThe ConvertSequencingArtifactToOxoG command uses the INPUT_BASE argument to infer the paths of its input and output files. This reliance on inferring path locations makes it harder to integrate this tool with other tools that don't follow the same convention.\nThis change adds additional arguments for the two inputs and the command's output file. The new arguments are optional and the original command syntax will continue to work as before.\nChecklist\nContent\n\n Added or modified tests to cover changes and any new functionality\n Edited the README / documentation (if applicable)\n All tests passing on Travis\n\nReview\n\n Final thumbs-up from reviewer\n Rebase, squash and reword as applicable\n\nFor more detailed guidelines, see https://github.com/broadinstitute/picard/wiki/Guidelines-for-pull-requests", "createdAt": "2020-04-01T20:18:13Z", "url": "https://github.com/broadinstitute/picard/pull/1492", "merged": true, "mergeCommit": {"oid": "375169ff44f455ec45cd7078e745017990d17e7d"}, "closed": true, "closedAt": "2020-04-06T19:37:45Z", "author": {"login": "pshapiro4broad"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTZzMLgH2gAyMzk3MjExMDg4OjNhODdmOGEzYTUzMDQ4MDAyZDNkZmFhZDM4ODcxNWM0YzI1MzZmMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVC5doAH2gAyMzk3MjExMDg4OjM0NjQ2MjlmYWNhYjNhNDQ4N2I0MDUwMmNmNzk3OGIxMjYxYWQ4YmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3a87f8a3a53048002d3dfaad388715c4c2536f1a", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/3a87f8a3a53048002d3dfaad388715c4c2536f1a", "committedDate": "2020-04-01T15:54:11Z", "message": "Add explicit command line arguments for input and output files to ConvertSequencingArtifactToOxoG. Deriving input and output locations based on INPUT_BASE is still supported."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3201a421cc0a2bb56946b5190942106ce0a04e64", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/3201a421cc0a2bb56946b5190942106ce0a04e64", "committedDate": "2020-04-01T18:44:22Z", "message": "Fix bugs and add a test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf296ef910ba90b59002a85e07aa4e40699e486b", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/cf296ef910ba90b59002a85e07aa4e40699e486b", "committedDate": "2020-04-03T17:27:00Z", "message": "Merge branch 'master' into ps_add_input_args_CSATOG"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NDA3MzI4", "url": "https://github.com/broadinstitute/picard/pull/1492#pullrequestreview-387407328", "createdAt": "2020-04-03T16:29:45Z", "commit": {"oid": "3201a421cc0a2bb56946b5190942106ce0a04e64"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjoyOTo0NlrOGAdDSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTowMjowNFrOGAkadg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzEyOTE2MQ==", "bodyText": "Not sure we need a separate file output specification, this bypasses the addition of the standardized file extension", "url": "https://github.com/broadinstitute/picard/pull/1492#discussion_r403129161", "createdAt": "2020-04-03T16:29:46Z", "author": {"login": "jessicaway"}, "path": "src/main/java/picard/analysis/artifacts/ConvertSequencingArtifactToOxoG.java", "diffHunk": "@@ -26,48 +29,90 @@\n \n @DocumentedFeature\n public class ConvertSequencingArtifactToOxoG extends CommandLineProgram {\n-static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n-static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n-\"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n-\"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n-\"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n-\"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \"+\n-\"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \"+\n-\"for additional information on these tools.</p>.\" +\n-\n-\"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \"+\n-\"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \"+\n-\"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n-\"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \"+\n-\"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.</p>\"+\n-\"<h4>Usage example:</h4>\" +\n-\"<pre>\" +\n-\"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n-\"     I=artifact_metrics \\\\<br />\" +\n-\"     R=reference.fasta\" +\n-\"</pre>\" +\n-\"Please see the metrics definitions page at \" +\n-\"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \"+\n-\"for detailed descriptions of the output metrics produced by this tool.\"+\n-\"<hr />\"\n-;\n+\n+    static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n+    static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n+            \"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n+            \"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n+            \"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n+            \"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \" +\n+            \"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \" +\n+            \"for additional information on these tools.</p>.\" +\n+\n+            \"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \" +\n+            \"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \" +\n+            \"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n+            \"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \" +\n+            \"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.</p>\" +\n+            \"<h4>Usage example:</h4>\" +\n+            \"<pre>\" +\n+            \"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n+            \"     I=artifact_metrics \\\\<br />\" +\n+            \"     R=reference.fasta\" +\n+            \"</pre>\" +\n+            \"Please see the metrics definitions page at \" +\n+            \"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \" +\n+            \"for detailed descriptions of the output metrics produced by this tool.\" +\n+            \"<hr />\";\n+\n+    public static final String OXOG_METRICS_EXT = \".oxog_metrics\";\n+\n     @Argument(shortName = StandardOptionDefinitions.INPUT_SHORT_NAME,\n-            doc = \"Basename of the input artifact metrics file (output by CollectSequencingArtifactMetrics)\")\n+            doc = \"Basename of the input artifact metrics file (output by CollectSequencingArtifactMetrics). If this is not \" +\n+                    \" specified, you must specifcy PRE_ADAPTER_IN and BAIT_BIAS_IN\",\n+            optional = true)\n     public File INPUT_BASE;\n \n+    @Argument(doc = \"The pre adapter details input file. Defaults to a filename based on the input basename\",\n+            optional = true)\n+    public File PRE_ADAPTER_IN;\n+\n+    @Argument(doc = \"The bait bias input file. Defaults to a filename based on the input basename\",\n+            optional = true)\n+    public File BAIT_BIAS_IN;\n+\n     @Argument(shortName = StandardOptionDefinitions.OUTPUT_SHORT_NAME,\n             doc = \"Basename for output OxoG metrics. Defaults to same basename as input metrics\",\n             optional = true)\n     public File OUTPUT_BASE;\n \n+    @Argument(doc = \"File for the output OxoG metrics. Defaults to same basename as input metrics\",\n+            optional = true)\n+    public File OXOG_OUT;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3201a421cc0a2bb56946b5190942106ce0a04e64"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzIzNjQ4OA==", "bodyText": "Update the doc to include the new optional inputs", "url": "https://github.com/broadinstitute/picard/pull/1492#discussion_r403236488", "createdAt": "2020-04-03T18:42:49Z", "author": {"login": "jessicaway"}, "path": "src/main/java/picard/analysis/artifacts/ConvertSequencingArtifactToOxoG.java", "diffHunk": "@@ -26,48 +29,90 @@\n \n @DocumentedFeature\n public class ConvertSequencingArtifactToOxoG extends CommandLineProgram {\n-static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n-static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n-\"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n-\"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n-\"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n-\"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \"+\n-\"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \"+\n-\"for additional information on these tools.</p>.\" +\n-\n-\"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \"+\n-\"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \"+\n-\"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n-\"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \"+\n-\"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.</p>\"+\n-\"<h4>Usage example:</h4>\" +\n-\"<pre>\" +\n-\"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n-\"     I=artifact_metrics \\\\<br />\" +\n-\"     R=reference.fasta\" +\n-\"</pre>\" +\n-\"Please see the metrics definitions page at \" +\n-\"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \"+\n-\"for detailed descriptions of the output metrics produced by this tool.\"+\n-\"<hr />\"\n-;\n+\n+    static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n+    static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n+            \"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n+            \"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n+            \"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n+            \"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \" +\n+            \"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \" +\n+            \"for additional information on these tools.</p>.\" +\n+\n+            \"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf296ef910ba90b59002a85e07aa4e40699e486b"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI0OTc4Mg==", "bodyText": "A combination new and old style should also be supported", "url": "https://github.com/broadinstitute/picard/pull/1492#discussion_r403249782", "createdAt": "2020-04-03T19:02:04Z", "author": {"login": "jessicaway"}, "path": "src/test/java/picard/analysis/artifacts/ConvertSequencingArtifactToOxoGTest.java", "diffHunk": "@@ -60,74 +77,78 @@ public void testEquivalence() throws IOException, NoSuchFieldException {\n         args.add(\"REFERENCE_SEQUENCE=\" + REFERENCE_SEQUENCE.getAbsolutePath());\n \n         CollectSequencingArtifactMetrics collectArtifactMetrics = new CollectSequencingArtifactMetrics();\n-        Assert.assertEquals(collectArtifactMetrics.instanceMain(args.toArray(new String[args.size()])), 0,\n+        Assert.assertEquals(collectArtifactMetrics.instanceMain(args.toArray(new String[0])), 0,\n                 \"CollectSequencingArtifactMetrics can't process \" + SAM_FILE.getAbsolutePath() + \" correctly\");\n \n         args.clear();\n-        args.add(\"OUTPUT_BASE=\" + convertedArtifacts.getAbsolutePath());\n-        args.add(\"INPUT_BASE=\" + outputFileArtifacts.getAbsolutePath());\n-\n+        if (newArgStyle) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf296ef910ba90b59002a85e07aa4e40699e486b"}, "originalPosition": 87}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2a066c43eb5a3739272d6280741a4aaac81a5f2", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/e2a066c43eb5a3739272d6280741a4aaac81a5f2", "committedDate": "2020-04-03T19:38:17Z", "message": "Add new parameters to documentation string for command"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTMyODI4", "url": "https://github.com/broadinstitute/picard/pull/1492#pullrequestreview-387532828", "createdAt": "2020-04-03T19:41:48Z", "commit": {"oid": "e2a066c43eb5a3739272d6280741a4aaac81a5f2"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTo0MTo0OFrOGAl5MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTo0NTowOVrOGAmDNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI3NDAzMg==", "bodyText": "\"specify\"", "url": "https://github.com/broadinstitute/picard/pull/1492#discussion_r403274032", "createdAt": "2020-04-03T19:41:48Z", "author": {"login": "gbggrant"}, "path": "src/main/java/picard/analysis/artifacts/ConvertSequencingArtifactToOxoG.java", "diffHunk": "@@ -26,48 +29,94 @@\n \n @DocumentedFeature\n public class ConvertSequencingArtifactToOxoG extends CommandLineProgram {\n-static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n-static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n-\"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n-\"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n-\"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n-\"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \"+\n-\"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \"+\n-\"for additional information on these tools.</p>.\" +\n-\n-\"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \"+\n-\"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \"+\n-\"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n-\"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \"+\n-\"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.</p>\"+\n-\"<h4>Usage example:</h4>\" +\n-\"<pre>\" +\n-\"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n-\"     I=artifact_metrics \\\\<br />\" +\n-\"     R=reference.fasta\" +\n-\"</pre>\" +\n-\"Please see the metrics definitions page at \" +\n-\"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \"+\n-\"for detailed descriptions of the output metrics produced by this tool.\"+\n-\"<hr />\"\n-;\n+\n+    static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n+    static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n+            \"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n+            \"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n+            \"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n+            \"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \" +\n+            \"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \" +\n+            \"for additional information on these tools. \" +\n+\n+            \"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \" +\n+            \"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \" +\n+            \"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n+            \"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \" +\n+            \"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.\" +\n+            \"<p>This command also lets you specify the detail metrics files by name, if files are not in the usual location \" +\n+            \"or have different names. For example, the arguments PRE_ADAPTER_IN and BAIT_BIAS_IN specify the file location of the  \" +\n+            \"pre adapter detail metrics and the bait bias detail metrics respectively. If these arguments are provided then the \" +\n+            \"value of INPUT_BASE is ignored. \" +\n+            \"<h4>Usage example:</h4>\" +\n+            \"<pre>\" +\n+            \"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n+            \"     I=artifact_metrics \\\\<br />\" +\n+            \"     R=reference.fasta\" +\n+            \"</pre>\" +\n+            \"Please see the metrics definitions page at \" +\n+            \"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \" +\n+            \"for detailed descriptions of the output metrics produced by this tool.\" +\n+            \"<hr />\";\n+\n+    public static final String OXOG_METRICS_EXT = \".oxog_metrics\";\n+\n     @Argument(shortName = StandardOptionDefinitions.INPUT_SHORT_NAME,\n-            doc = \"Basename of the input artifact metrics file (output by CollectSequencingArtifactMetrics)\")\n+            doc = \"Basename of the input artifact metrics file (output by CollectSequencingArtifactMetrics). If this is not \" +\n+                    \" specified, you must specifcy PRE_ADAPTER_IN and BAIT_BIAS_IN\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a066c43eb5a3739272d6280741a4aaac81a5f2"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI3NTAyNA==", "bodyText": "final", "url": "https://github.com/broadinstitute/picard/pull/1492#discussion_r403275024", "createdAt": "2020-04-03T19:43:10Z", "author": {"login": "gbggrant"}, "path": "src/main/java/picard/analysis/artifacts/ConvertSequencingArtifactToOxoG.java", "diffHunk": "@@ -26,48 +29,94 @@\n \n @DocumentedFeature\n public class ConvertSequencingArtifactToOxoG extends CommandLineProgram {\n-static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n-static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n-\"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n-\"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n-\"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n-\"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \"+\n-\"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \"+\n-\"for additional information on these tools.</p>.\" +\n-\n-\"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \"+\n-\"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \"+\n-\"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n-\"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \"+\n-\"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.</p>\"+\n-\"<h4>Usage example:</h4>\" +\n-\"<pre>\" +\n-\"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n-\"     I=artifact_metrics \\\\<br />\" +\n-\"     R=reference.fasta\" +\n-\"</pre>\" +\n-\"Please see the metrics definitions page at \" +\n-\"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \"+\n-\"for detailed descriptions of the output metrics produced by this tool.\"+\n-\"<hr />\"\n-;\n+\n+    static final String USAGE_SUMMARY = \"Extract OxoG metrics from generalized artifacts metrics.  \";\n+    static final String USAGE_DETAILS = \"<p>This tool extracts 8-oxoguanine (OxoG) artifact metrics from the output of \" +\n+            \"CollectSequencingArtifactsMetrics (a tool that provides detailed information on a variety of artifacts found in sequencing \" +\n+            \"libraries) and converts them to the CollectOxoGMetrics tool's output format. This conveniently eliminates the need to run \" +\n+            \"CollectOxoGMetrics if we already ran CollectSequencingArtifactsMetrics in our pipeline. See the documentation for \" +\n+            \"<a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectSequencingArtifactsMetrics'>CollectSequencingArtifactsMetrics</a> \" +\n+            \"and <a href='http://broadinstitute.github.io/picard/command-line-overview.html#CollectOxoGMetrics'>CollectOxoGMetrics</a> \" +\n+            \"for additional information on these tools. \" +\n+\n+            \"<p>Note that only the base of the CollectSequencingArtifactsMetrics output file name is required for the (INPUT_BASE) \" +\n+            \"parameter. For example, if the file name is artifact_metrics.txt.bait_bias_detail_metrics or \" +\n+            \"artifact_metrics.txt.pre_adapter_detail_metrics, only the file name base 'artifact_metrics' is \" +\n+            \"required on the command line for this parameter.  An output file called 'artifact_metrics.oxog_metrics' will be generated \" +\n+            \"automatically.  Finally, to run this tool successfully, the REFERENCE_SEQUENCE must be provided.\" +\n+            \"<p>This command also lets you specify the detail metrics files by name, if files are not in the usual location \" +\n+            \"or have different names. For example, the arguments PRE_ADAPTER_IN and BAIT_BIAS_IN specify the file location of the  \" +\n+            \"pre adapter detail metrics and the bait bias detail metrics respectively. If these arguments are provided then the \" +\n+            \"value of INPUT_BASE is ignored. \" +\n+            \"<h4>Usage example:</h4>\" +\n+            \"<pre>\" +\n+            \"java -jar picard.jar ConvertSequencingArtifactToOxoG \\\\<br />\" +\n+            \"     I=artifact_metrics \\\\<br />\" +\n+            \"     R=reference.fasta\" +\n+            \"</pre>\" +\n+            \"Please see the metrics definitions page at \" +\n+            \"<a href='http://broadinstitute.github.io/picard/picard-metric-definitions.html#CollectOxoGMetrics.CpcgMetrics'>ConvertSequencingArtifactToOxoG</a> \" +\n+            \"for detailed descriptions of the output metrics produced by this tool.\" +\n+            \"<hr />\";\n+\n+    public static final String OXOG_METRICS_EXT = \".oxog_metrics\";\n+\n     @Argument(shortName = StandardOptionDefinitions.INPUT_SHORT_NAME,\n-            doc = \"Basename of the input artifact metrics file (output by CollectSequencingArtifactMetrics)\")\n+            doc = \"Basename of the input artifact metrics file (output by CollectSequencingArtifactMetrics). If this is not \" +\n+                    \" specified, you must specifcy PRE_ADAPTER_IN and BAIT_BIAS_IN\",\n+            optional = true)\n     public File INPUT_BASE;\n \n+    @Argument(doc = \"The pre adapter details input file. Defaults to a filename based on the input basename\",\n+            optional = true)\n+    public File PRE_ADAPTER_IN;\n+\n+    @Argument(doc = \"The bait bias input file. Defaults to a filename based on the input basename\",\n+            optional = true)\n+    public File BAIT_BIAS_IN;\n+\n     @Argument(shortName = StandardOptionDefinitions.OUTPUT_SHORT_NAME,\n             doc = \"Basename for output OxoG metrics. Defaults to same basename as input metrics\",\n             optional = true)\n     public File OUTPUT_BASE;\n \n+    @Argument(doc = \"File for the output OxoG metrics. Defaults to a filename based on the output basename\",\n+            optional = true)\n+    public File OXOG_OUT;\n+\n     @Override\n-    protected int doWork() {\n-        if (OUTPUT_BASE == null) { OUTPUT_BASE = INPUT_BASE; }\n+    protected String[] customCommandLineValidation() {\n+        List<String> errors = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a066c43eb5a3739272d6280741a4aaac81a5f2"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI3NjU5OA==", "bodyText": "final, final", "url": "https://github.com/broadinstitute/picard/pull/1492#discussion_r403276598", "createdAt": "2020-04-03T19:45:09Z", "author": {"login": "gbggrant"}, "path": "src/test/java/picard/analysis/artifacts/ConvertSequencingArtifactToOxoGTest.java", "diffHunk": "@@ -60,74 +77,78 @@ public void testEquivalence() throws IOException, NoSuchFieldException {\n         args.add(\"REFERENCE_SEQUENCE=\" + REFERENCE_SEQUENCE.getAbsolutePath());\n \n         CollectSequencingArtifactMetrics collectArtifactMetrics = new CollectSequencingArtifactMetrics();\n-        Assert.assertEquals(collectArtifactMetrics.instanceMain(args.toArray(new String[args.size()])), 0,\n+        Assert.assertEquals(collectArtifactMetrics.instanceMain(args.toArray(new String[0])), 0,\n                 \"CollectSequencingArtifactMetrics can't process \" + SAM_FILE.getAbsolutePath() + \" correctly\");\n \n         args.clear();\n-        args.add(\"OUTPUT_BASE=\" + convertedArtifacts.getAbsolutePath());\n-        args.add(\"INPUT_BASE=\" + outputFileArtifacts.getAbsolutePath());\n-\n+        if (newArgStyle) {\n+            args.add(\"OXOG_OUT=\" + oxogMetricsOutput);\n+            args.add(\"BAIT_BIAS_IN=\" + baitBiasDetails);\n+            args.add(\"PRE_ADAPTER_IN=\" + preAdapterDetails);\n+        } else {\n+            args.add(\"OUTPUT_BASE=\" + convertedArtifacts.getAbsolutePath());\n+            args.add(\"INPUT_BASE=\" + outputFileArtifacts.getAbsolutePath());\n+        }\n         ConvertSequencingArtifactToOxoG convertSequencingArtifactToOxoG = new ConvertSequencingArtifactToOxoG();\n-        Assert.assertEquals(convertSequencingArtifactToOxoG.instanceMain(args.toArray(new String[args.size()])), 0,\n+        Assert.assertEquals(convertSequencingArtifactToOxoG.instanceMain(args.toArray(new String[0])), 0,\n                 \"ConvertSequencingArtifactToOxoG can't process base input\" + outputFileArtifacts.getAbsolutePath() + \" correctly\");\n \n-        String[] columnToCompare=new String[]{\n-                \"SAMPLE_ALIAS\", \"LIBRARY\", \"CONTEXT\", \"TOTAL_BASES\", \"REF_NONOXO_BASES\", \"REF_OXO_BASES\", \"REF_TOTAL_BASES\", \"ALT_NONOXO_BASES\", \"ALT_OXO_BASES\", \"OXIDATION_ERROR_RATE\", \"OXIDATION_Q\", \"C_REF_REF_BASES\", \"G_REF_REF_BASES\", \"C_REF_ALT_BASES\", \"G_REF_ALT_BASES\", \"C_REF_OXO_ERROR_RATE\", \"C_REF_OXO_Q\", \"G_REF_OXO_ERROR_RATE\", \"G_REF_OXO_Q\"};\n-\n-        Assert.assertTrue(areMetricsEqual(outputFileOxoG, new File(convertedArtifacts + \".oxog_metrics\"), columnToCompare), \"Metrics differ\");\n+        Assert.assertTrue(areMetricsEqual(outputFileOxoG, oxogMetricsOutput, COLUMNS_TO_COMPARE), \"Metrics differ\");\n     }\n \n     /**\n      * Compare the metrics in two files, ignoring headers and histograms.\n      */\n     public static boolean areMetricsEqual(final File file1, final File file2, final String[] columnsToCompare) throws NoSuchFieldException {\n-        try {\n+        try (Reader reader1 = new FileReader(file1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2a066c43eb5a3739272d6280741a4aaac81a5f2"}, "originalPosition": 112}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "520090679e10c27efdd964dd23ae61d4648a2664", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/520090679e10c27efdd964dd23ae61d4648a2664", "committedDate": "2020-04-06T14:43:05Z", "message": "typos and missing `final`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35b5d33eb3a8e90f909368c5938944d1f26ebddd", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/35b5d33eb3a8e90f909368c5938944d1f26ebddd", "committedDate": "2020-04-06T14:45:08Z", "message": "Merge branch 'master' into ps_add_input_args_CSATOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29431062a2ff7a84da71e9ce10751b43e0361ca3", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/29431062a2ff7a84da71e9ce10751b43e0361ca3", "committedDate": "2020-04-06T18:06:56Z", "message": "Merge branch 'master' into ps_add_input_args_CSATOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3464629facab3a4487b40502cf7978b1261ad8be", "author": {"user": {"login": "pshapiro4broad", "name": "Phil Shapiro"}}, "url": "https://github.com/broadinstitute/picard/commit/3464629facab3a4487b40502cf7978b1261ad8be", "committedDate": "2020-04-06T18:21:04Z", "message": "Merge branch 'master' into ps_add_input_args_CSATOG"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2427, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}