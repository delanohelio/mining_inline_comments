{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNDg0Nzgw", "number": 1461, "title": "Fix for corrupted CO tag issue", "bodyText": "Someone on the forum reported an issue with a bam tag that was a long string instead of 2 characters.  This is a fix, but not a test because i'm not sure how to build a bam that triggers isContaminant.\n\n\nChecklist (never delete this)\nNever delete this, it is our record that procedure was followed. If you find that for whatever reason one of the checklist points doesn't apply to your PR, you can leave it unchecked but please add an explanation below.\nContent\n\n Added or modified tests to cover changes and any new functionality\n Edited the README / documentation (if applicable)\n All tests passing on Travis\n\nReview\n\n Final thumbs-up from reviewer\n Rebase, squash and reword as applicable\n\nFor more detailed guidelines, see https://github.com/broadinstitute/picard/wiki/Guidelines-for-pull-requests", "createdAt": "2020-02-03T19:33:07Z", "url": "https://github.com/broadinstitute/picard/pull/1461", "merged": true, "mergeCommit": {"oid": "2cd1aac828a792f214ac516b67f6f555dc8c7586"}, "closed": true, "closedAt": "2020-05-14T02:42:46Z", "author": {"login": "lbergelson"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcX4oeZAFqTM5MzgwNjU5Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcg_vsFABqjMzMzM5NzU5MjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzODA2NTk3", "url": "https://github.com/broadinstitute/picard/pull/1461#pullrequestreview-393806597", "createdAt": "2020-04-15T14:05:05Z", "commit": {"oid": "25b72dba46034b578b98c188b05fbc1f2e4b32e1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNDowNTowNVrOGF7WHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNDowNTowNVrOGF7WHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODg2ODM4Mw==", "bodyText": "The fix looks good to me. It's a shame the API isn't setAttribute(SAMTag, Object).\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        unaligned.setAttribute( SAMTag.CO.name(), optionalComment.map(s -> s + \" | \").orElse(\"\")  + \"Cross-species contamination\");\n          \n          \n            \n                        unaligned.setAttribute(SAMTag.CO.name(), optionalComment.map(s -> s + \" | \").orElse(\"\")  + \"Cross-species contamination\");", "url": "https://github.com/broadinstitute/picard/pull/1461#discussion_r408868383", "createdAt": "2020-04-15T14:05:05Z", "author": {"login": "pshapiro4broad"}, "path": "src/main/java/picard/sam/AbstractAlignmentMerger.java", "diffHunk": "@@ -694,8 +694,7 @@ private void transferAlignmentInfoToFragment(final SAMRecord unaligned, final SA\n \n             // if there already is a comment, add second comment with a | separator:\n             Optional<String> optionalComment = Optional.ofNullable(unaligned.getStringAttribute(SAMTag.CO.name()));\n-            unaligned.setAttribute(optionalComment.map(s -> s + \" | \").orElse(\"\") +\n-                    SAMTag.CO.name(), \"Cross-species contamination\");\n+            unaligned.setAttribute( SAMTag.CO.name(), optionalComment.map(s -> s + \" | \").orElse(\"\")  + \"Cross-species contamination\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25b72dba46034b578b98c188b05fbc1f2e4b32e1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0553344ca5116e7da6ee93501912ebf448e4f447", "author": {"user": {"login": "lbergelson", "name": "Louis Bergelson"}}, "url": "https://github.com/broadinstitute/picard/commit/0553344ca5116e7da6ee93501912ebf448e4f447", "committedDate": "2020-05-13T21:27:24Z", "message": "Fix for duplicate CO tag issue\n\n* Someone on the forum reported an issue with a bam tag that was a long string instead of 2 characters.  This is a fix, but not a test because i'm not sure how to build a bam that triggers isContaminant."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "affbf46749fbe458c782ea9201e2fe72bea1a2e2", "author": {"user": {"login": "lbergelson", "name": "Louis Bergelson"}}, "url": "https://github.com/broadinstitute/picard/commit/affbf46749fbe458c782ea9201e2fe72bea1a2e2", "committedDate": "2020-05-13T21:27:24Z", "message": "Update src/main/java/picard/sam/AbstractAlignmentMerger.java\n\nCo-authored-by: Phil Shapiro <pshapiro@broadinstitute.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d492ef666b946bd76bc28e5187ba2835d1d14172", "author": {"user": {"login": "lbergelson", "name": "Louis Bergelson"}}, "url": "https://github.com/broadinstitute/picard/commit/d492ef666b946bd76bc28e5187ba2835d1d14172", "committedDate": "2020-05-13T20:21:27Z", "message": "Merge branch 'master' into lb_fix_for_CO_tag"}, "afterCommit": {"oid": "affbf46749fbe458c782ea9201e2fe72bea1a2e2", "author": {"user": {"login": "lbergelson", "name": "Louis Bergelson"}}, "url": "https://github.com/broadinstitute/picard/commit/affbf46749fbe458c782ea9201e2fe72bea1a2e2", "committedDate": "2020-05-13T21:27:24Z", "message": "Update src/main/java/picard/sam/AbstractAlignmentMerger.java\n\nCo-authored-by: Phil Shapiro <pshapiro@broadinstitute.org>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2382, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}