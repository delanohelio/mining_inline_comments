{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3MTc1NDIx", "number": 1571, "title": "Adjust MBA read overhang clipping to be consistent with past behavior", "bodyText": "It has been noted in #1569 that #1484 changed the behavior of MBA when soft clipping overhanging reads.  This PR reverts the behavior when soft clipping so that it is the same as \"old\" (pre #1484) MBA.  The behavior when hard clipping is also adjusted slightly.  The behavior implemented here is as follows:\n\noverlapping reads are soft clipped so that the 3' aligned end does not extend past the 5' aligned end of the mate. This reverts to the \"old\" MBA behavior when soft clipping\nif using hard clipping, reads are additionally hard clipped so that the 3' unclipped end of the read does not extend past the 5' unclipped end of the mate. This implements the \"new\" MBA behavior when hard clipping.\n\nThe result of this behavior is that:\n\nWhen running in soft clipping mode, the results are identical to the \"old\" MBA\nWhen running in hard clipping mode, the hard clipped bases are the same as in the \"new\" MBA.  Additionally, any bases which would have been clipped by the \"old\" MBA but not by the \"new\" MBA are soft clipped.\nConsistency between TLEN and the cigar is maintained for both situations, ie. we won't have reads with longer matches than the 5'-5' TLEN.\n\nChecklist (never delete this)\nNever delete this, it is our record that procedure was followed. If you find that for whatever reason one of the checklist points doesn't apply to your PR, you can leave it unchecked but please add an explanation below.\nContent\n\n Added or modified tests to cover changes and any new functionality\n Edited the README / documentation (if applicable)\n All tests passing on Travis\n\nReview\n\n Final thumbs-up from reviewer\n Rebase, squash and reword as applicable\n\nFor more detailed guidelines, see https://github.com/broadinstitute/picard/wiki/Guidelines-for-pull-requests", "createdAt": "2020-09-01T15:49:04Z", "url": "https://github.com/broadinstitute/picard/pull/1571", "merged": true, "mergeCommit": {"oid": "571ec3a20c6d805d1e3d1d5c41d44a6cfc530f5e"}, "closed": true, "closedAt": "2020-09-02T12:05:28Z", "author": {"login": "kachulis"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEqcwIgFqTQ3OTk0NjQwNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdExULLgBqjM3MTczOTAzNjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTQ2NDA1", "url": "https://github.com/broadinstitute/picard/pull/1571#pullrequestreview-479946405", "createdAt": "2020-09-01T17:00:21Z", "commit": {"oid": "68993d51cc3743b6894486a7e58ac245d264773f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTE5NzA1", "url": "https://github.com/broadinstitute/picard/pull/1571#pullrequestreview-480119705", "createdAt": "2020-09-01T21:13:07Z", "commit": {"oid": "7000bee6c3ab478b2925e9b262ecb222bafe6b88"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMzowN1rOHLIc3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMzowN1rOHLIc3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNDg0NQ==", "bodyText": "huh?", "url": "https://github.com/broadinstitute/picard/pull/1571#discussion_r481434845", "createdAt": "2020-09-01T21:13:07Z", "author": {"login": "yfarjoun"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -104,6 +138,67 @@\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n \n+                /*\n+                                SSSSSSSSSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM->\n+                                     <-MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSS\n+\n+                                soft clipping becomes:\n+                                SSSSSSSSSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSS->\n+                                     <-SSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSS\n+\n+                                hard clipping leaves as from soft clipping", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7000bee6c3ab478b2925e9b262ecb222bafe6b88"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTIxMjgx", "url": "https://github.com/broadinstitute/picard/pull/1571#pullrequestreview-480121281", "createdAt": "2020-09-01T21:15:30Z", "commit": {"oid": "7000bee6c3ab478b2925e9b262ecb222bafe6b88"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxNTozMFrOHLIh0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxNTozMFrOHLIh0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNjExMg==", "bodyText": "same", "url": "https://github.com/broadinstitute/picard/pull/1571#discussion_r481436112", "createdAt": "2020-09-01T21:15:30Z", "author": {"login": "yfarjoun"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -104,6 +138,67 @@\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n \n+                /*\n+                                SSSSSSSSSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM->\n+                                     <-MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSS\n+\n+                                soft clipping becomes:\n+                                SSSSSSSSSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSS->\n+                                     <-SSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSS\n+\n+                                hard clipping leaves as from soft clipping\n+\n+                 */\n+\n+                {110, 105, 100, \"10S100M\", \"103M7S\", false, true, 105, 105, \"10S98M2S\", \"5S98M7S\", false,\n+                        default110LongR1Bases, default110LongR2Bases, default110LongR1Bases, default110LongR2Bases, null, null,\n+                        default110LongR1BaseQualities, default110LongR2BaseQualities, default110LongR1BaseQualities, default110LongR2BaseQualities, null, null},\n+\n+                {110, 105, 100, \"10S100M\", \"103M7S\", false, true, 105, 105, \"10S98M2S\", \"5S98M7S\", false,\n+                        default110LongR1Bases, default110LongR2Bases, default110LongR1Bases, default110LongR2Bases, null, null,\n+                        default110LongR1BaseQualities, default110LongR2BaseQualities, default110LongR1BaseQualities, default110LongR2BaseQualities, null, null},\n+\n+                /*\n+                                SSSSSSSSSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSS->\n+                                     <-MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSSSSSSSSSSSSSSS\n+\n+                                soft clipping becomes:\n+                                SSSSSSSSSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSSSSSSS->\n+                                     <-SSSSMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSSSSSSSSSSSSSSS\n+\n+                                hard clipping leaves as from soft clipping", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7000bee6c3ab478b2925e9b262ecb222bafe6b88"}, "originalPosition": 86}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe16c719a570b797f61f5c830e5b5f79074524f0", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/fe16c719a570b797f61f5c830e5b5f79074524f0", "committedDate": "2020-09-02T00:59:31Z", "message": "revert behavior when soft clipping, adjust hardclipping behavior to softclip to aligned position"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fed4bd41b61865e1a3048ebb6e80f9df87da8283", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/fed4bd41b61865e1a3048ebb6e80f9df87da8283", "committedDate": "2020-09-02T00:59:31Z", "message": "documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74bf9f959b9b65335d4368d2921562d5c65cf3c4", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/74bf9f959b9b65335d4368d2921562d5c65cf3c4", "committedDate": "2020-09-02T00:59:31Z", "message": "refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd7d485784feebf3f3f5cee0950c67f340a9db98", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/dd7d485784feebf3f3f5cee0950c67f340a9db98", "committedDate": "2020-09-02T00:59:31Z", "message": "outie test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2812e25fbb909ffed320d1612ed83614e9304a3", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/c2812e25fbb909ffed320d1612ed83614e9304a3", "committedDate": "2020-09-02T00:59:31Z", "message": "more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0787a6e18d7a2f59a8a81333e5e1e07db9443509", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/0787a6e18d7a2f59a8a81333e5e1e07db9443509", "committedDate": "2020-09-02T00:59:31Z", "message": "comment rewording"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f991d4a5144749eda2703552f9885173b9b4f10", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/8f991d4a5144749eda2703552f9885173b9b4f10", "committedDate": "2020-09-01T21:18:16Z", "message": "comment rewording"}, "afterCommit": {"oid": "0787a6e18d7a2f59a8a81333e5e1e07db9443509", "author": {"user": {"login": "kachulis", "name": null}}, "url": "https://github.com/broadinstitute/picard/commit/0787a6e18d7a2f59a8a81333e5e1e07db9443509", "committedDate": "2020-09-02T00:59:31Z", "message": "comment rewording"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2303, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}