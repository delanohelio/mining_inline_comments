{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1OTUxMTQ0", "number": 1455, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTo1MDo1NFrODZ9K8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NzowNFrODhjoXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4NTQzMjE3OnYy", "diffSide": "RIGHT", "path": "src/main/java/picard/fingerprint/HaplotypeProbabilities.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTo1MDo1NFrOFgo6VA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTo1MDo1NFrOFgo6VA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc2OTA0NA==", "bodyText": "For the reviewer, this is the bug fix....most of everything else is window dressing.", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r369769044", "createdAt": "2020-01-22T19:50:54Z", "author": {"login": "yfarjoun"}, "path": "src/main/java/picard/fingerprint/HaplotypeProbabilities.java", "diffHunk": "@@ -213,16 +220,16 @@ public double shiftedLogEvidenceProbabilityGivenOtherEvidence(final HaplotypePro\n         if (!this.haplotypeBlock.equals(otherHp.getHaplotype())) {\n             throw new IllegalArgumentException(\"Haplotypes are from different HaplotypeBlocks!\");\n         }\n-        /** Get the posterior from the other otherHp. Use this posterior as the prior to calculate probability.\n-         *\n-         *   P(hap|x,y) = P(x|hap,y) P(hap|y) / P(x|y)\n-         *              = P(x | hap) * P(hap | y) / P(x)\n-         *                likelihood * other.posterior\n-         *\n-         *              = P(x|hap) P(y|hap) P(hap)/P(x)P(y)\n-         *              = A P(x| hap) P(y| hap) P(hap)  # where A is an unknown scaling factor\n+        /* Get the posterior from the other otherHp. Use this posterior as the prior to calculate probability.\n+\n+            P(hap|x,y) = P(x|hap,y) P(hap|y) / P(x|y)\n+                       = P(x | hap) * P(hap | y) / P(x)\n+                         likelihood * other.posterior\n+\n+                       = P(x|hap) P(y|hap) P(hap)/P(x)P(y)\n+                       = A P(x| hap) P(y| hap) P(hap)  # where A is an unknown scaling factor\n          */\n-        return shiftedLogEvidenceProbabilityUsingGenotypeFrequencies(otherHp.getPosteriorProbabilities());\n+        return shiftedLogEvidenceProbabilityUsingGenotypeFrequencies(otherHp.getPosteriorLikelihoods());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "643e9015af71fdec20063ec1a13f8875561d8771"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NjkwNzI4OnYy", "diffSide": "RIGHT", "path": "src/main/java/picard/util/MathUtil.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo0OToxOVrOFrKL7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo0OToxOVrOFrKL7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc5OTk4MQ==", "bodyText": "New public APIs should have tests.", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r380799981", "createdAt": "2020-02-18T16:49:19Z", "author": {"login": "pshapiro4broad"}, "path": "src/main/java/picard/util/MathUtil.java", "diffHunk": "@@ -285,6 +324,38 @@ public static int indexOfMin(final double[] nums) {\n         return pNormalizeLogProbability(likelihoods);\n     }\n \n+    /**\n+     * Takes a complete set of mutually exclusive logLikelihoods and converts them to probabilities\n+     * with no rescaling. Will throw if underflow is detected (if all the likelihoods are less than -300)\n+     */\n+    public static double[] getProbabilityFromLog(final double[] lLikelihood) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b0d9a90d42deedbad2a89349ffd05dda04d595"}, "originalPosition": 253}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NjkyMTQ3OnYy", "diffSide": "RIGHT", "path": "src/main/java/picard/util/MathUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo1Mjo1OVrOFrKUsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo1Mjo1OVrOFrKUsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMjIyNg==", "bodyText": "Would be nice to reformat this too", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r380802226", "createdAt": "2020-02-18T16:52:59Z", "author": {"login": "pshapiro4broad"}, "path": "src/main/java/picard/util/MathUtil.java", "diffHunk": "@@ -441,7 +556,34 @@ public static double klDivergance(double[] measured, double[] distribution) {\n         return retVal;\n     }\n \n-    /** \n+    /**\n+     * A small utility function to choose n random elements (un-shuffled) from a list\n+     *\n+     * @param list A list of elements\n+     * @param n    a number of elements requested from list\n+     * @return a list of n randomly chosen (but in the original order) elements from list.\n+     * If the list has less than n elements it is returned in its entirety.\n+     */\n+    public static <T> List<T> randomSublist(final List<T> list, final int n) {\n+        int availableElements = list.size();\n+        if (availableElements <= n) return list;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b0d9a90d42deedbad2a89349ffd05dda04d595"}, "originalPosition": 454}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NjkyNjE2OnYy", "diffSide": "RIGHT", "path": "src/main/java/picard/util/MathUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo1Mzo1OVrOFrKXbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo1Mzo1OVrOFrKXbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMjkyNA==", "bodyText": "Any reason to not use Math.random() here?", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r380802924", "createdAt": "2020-02-18T16:53:59Z", "author": {"login": "pshapiro4broad"}, "path": "src/main/java/picard/util/MathUtil.java", "diffHunk": "@@ -441,7 +556,34 @@ public static double klDivergance(double[] measured, double[] distribution) {\n         return retVal;\n     }\n \n-    /** \n+    /**\n+     * A small utility function to choose n random elements (un-shuffled) from a list\n+     *\n+     * @param list A list of elements\n+     * @param n    a number of elements requested from list\n+     * @return a list of n randomly chosen (but in the original order) elements from list.\n+     * If the list has less than n elements it is returned in its entirety.\n+     */\n+    public static <T> List<T> randomSublist(final List<T> list, final int n) {\n+        int availableElements = list.size();\n+        if (availableElements <= n) return list;\n+\n+        int stillNeeded = n;\n+        final Random rg = new Random();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b0d9a90d42deedbad2a89349ffd05dda04d595"}, "originalPosition": 457}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTExMDI3OnYy", "diffSide": "RIGHT", "path": "src/main/java/picard/fingerprint/FingerprintChecker.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1MTozNVrOFsWWcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1MTozNVrOFsWWcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA0Nzg1Ng==", "bodyText": "Unless there's a need to use it elsewhere, I would make this private.", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382047856", "createdAt": "2020-02-20T14:51:35Z", "author": {"login": "pshapiro4broad"}, "path": "src/main/java/picard/fingerprint/FingerprintChecker.java", "diffHunk": "@@ -88,6 +89,8 @@\n     public static final int DEFAULT_MINIMUM_MAPPING_QUALITY = 10;\n     public static final int DEFAULT_MINIMUM_BASE_QUALITY = 20;\n     public static final int DEFAULT_MAXIMAL_PL_DIFFERENCE = 30;\n+    // used sometimes to subset loci. Fix the random seed so that the results are deterministic\n+    public static final Random random = new Random(42);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTExMjMxOnYy", "diffSide": "RIGHT", "path": "src/main/java/picard/fingerprint/FingerprintChecker.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1MTo1NVrOFsWXoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1MTo1NVrOFsWXoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA0ODE2MA==", "bodyText": "whitespace\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            final List<SamLocusIterator.RecordAndOffset> recordAndOffsetList = MathUtil.randomSublist(info.getRecordAndOffsets(), locusMaxReads,random);\n          \n          \n            \n                            final List<SamLocusIterator.RecordAndOffset> recordAndOffsetList = MathUtil.randomSublist(info.getRecordAndOffsets(), locusMaxReads, random);", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382048160", "createdAt": "2020-02-20T14:51:55Z", "author": {"login": "pshapiro4broad"}, "path": "src/main/java/picard/fingerprint/FingerprintChecker.java", "diffHunk": "@@ -633,7 +634,7 @@ private FingerprintIdDetails createUnknownFP(final Path samFile, final SAMRecord\n                 final Snp snp = this.haplotypes.getSnp(info.getSequenceName(), info.getPosition());\n \n                 // randomly select locusMaxReads elements from the list\n-                final List<SamLocusIterator.RecordAndOffset> recordAndOffsetList = randomSublist(info.getRecordAndPositions(), locusMaxReads);\n+                final List<SamLocusIterator.RecordAndOffset> recordAndOffsetList = MathUtil.randomSublist(info.getRecordAndOffsets(), locusMaxReads,random);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTEyNDU4OnYy", "diffSide": "RIGHT", "path": "src/test/java/picard/util/MathUtilTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NDo1MlrOFsWfNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NDo1MlrOFsWfNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MDEwMA==", "bodyText": "Could write this as\n        final List<Integer> list = Arrays.asList(1, 2, 3);", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382050100", "createdAt": "2020-02-20T14:54:52Z", "author": {"login": "pshapiro4broad"}, "path": "src/test/java/picard/util/MathUtilTest.java", "diffHunk": "@@ -84,6 +88,19 @@ private void assertEquals(final double[] actual, final double[] expected) {\n         }\n     }\n \n+    @Test\n+    public void testRandomSublist() {\n+        final Random random = new Random();\n+        final List<Integer> list = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTEyNzc0OnYy", "diffSide": "RIGHT", "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NTo0NFrOFsWhTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NTo0NFrOFsWhTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MDYzNw==", "bodyText": "whitespace\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    final File metricsFile = File.createTempFile(\"crosscheck\",\".crosscheck_metrics\");\n          \n          \n            \n                    final File metricsFile = File.createTempFile(\"crosscheck\", \".crosscheck_metrics\");", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382050637", "createdAt": "2020-02-20T14:55:44Z", "author": {"login": "pshapiro4broad"}, "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "diffHunk": "@@ -143,27 +160,30 @@ public void testTerminateOnBadFile() {\n         final File na12891_r1 = new File(TEST_DATA_DIR, \"NA12891.over.fingerprints.r1.sam\");\n         final File na12891_r2 = new File(TEST_DATA_DIR, \"NA12891.over.fingerprints.r2.sam\");\n         final File na12892_r1 = new File(TEST_DATA_DIR, \"NA12892.over.fingerprints.r1.sam\");\n-        final File na12892_r2 = new File(TEST_DATA_DIR, \"NA12892.over.fingerprints.r1.sam\");\n+        final File na12892_r2 = new File(TEST_DATA_DIR, \"NA12892.over.fingerprints.r2.sam\");\n \n         final File na12891_noRg = new File(TEST_DATA_DIR, \"NA12891.over.fingerprints.noRgTag.sam\");\n \n         return new Object[][]{\n                 {na12891_r1, na12891_r2, true, true},\n                 {na12892_r1, na12892_r2, true, true},\n                 {na12892_r1, na12891_r2, false, true},\n-                {na12892_r1, na12891_noRg, false, true},\n                 {na12891_r1, na12891_noRg, true, true},\n+                {na12892_r1, na12891_noRg, false, true},\n \n-                {na12891_r1, na12891_r2, true, false},\n-                {na12892_r1, na12892_r2, true, false},\n-                {na12892_r1, na12891_r2, false, false},\n-                {na12892_r1, na12891_noRg, false, false},\n-                {na12891_r1, na12891_noRg, true, false}\n+                {na12891_r2, na12891_r2, true, false},\n+                {na12892_r2, na12892_r2, true, false},\n+                {na12892_r2, na12891_r2, false, false},\n+                {na12891_r2, na12891_noRg, true, false},\n+                {na12892_r2, na12891_noRg, false, false},\n         };\n     }\n \n     @Test(dataProvider = \"checkFingerprintsSamDataProvider\")\n-    public void testCheckFingerprintsSam(final File samFile1, final File samFile2, final boolean expectedMatch, final boolean silent) {\n+    public void testCheckFingerprintsSam(final File samFile1, final File samFile2, final boolean expectedMatch, final boolean silent) throws IOException {\n+\n+        final File metricsFile = File.createTempFile(\"crosscheck\",\".crosscheck_metrics\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 137}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTEyOTAxOnYy", "diffSide": "RIGHT", "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NTo1OVrOFsWiBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NTo1OVrOFsWiBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MDgyMQ==", "bodyText": "whitespace\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"OUTPUT=\"+metricsFile.getAbsolutePath()\n          \n          \n            \n                            \"OUTPUT=\" + metricsFile.getAbsolutePath()", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382050821", "createdAt": "2020-02-20T14:55:59Z", "author": {"login": "pshapiro4broad"}, "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "diffHunk": "@@ -173,9 +193,29 @@ public void testCheckFingerprintsSam(final File samFile1, final File samFile2, f\n                 \"I=\" + samFile2.getAbsolutePath(),\n                 \"VALIDATION_STRINGENCY=\" + (silent ? \"SILENT\" : \"LENIENT\"),\n                 \"CROSSCHECK_BY=FILE\",\n+                \"OUTPUT=\"+metricsFile.getAbsolutePath()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 146}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTEzMjM4OnYy", "diffSide": "RIGHT", "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1Njo0NlrOFsWkJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1Njo0NlrOFsWkJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MTM2Nw==", "bodyText": "whitespace\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    for(Fingerprint fp1:fp1Map.values()){\n          \n          \n            \n                    for (Fingerprint fp1 : fp1Map.values()) {", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382051367", "createdAt": "2020-02-20T14:56:46Z", "author": {"login": "pshapiro4broad"}, "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "diffHunk": "@@ -124,13 +124,30 @@ public void testCheckFingerprintsVcf(final File vcfFile, final File genotypesFil\n \n     @Test(dataProvider = \"checkFingerprintsVcfDataProvider\")\n     public void testFingerprintVcf(final File vcfFile, final File genotypesFile, final String observedSampleAlias, final String expectedSampleAlias,\n-                                   final double llExpectedSample, final double llRandomSample, final double lodExpectedSample) throws IOException {\n+                                   final double llExpectedSample, final double llRandomSample, final double lodExpectedSample) {\n         final FingerprintChecker fpChecker = new FingerprintChecker(SUBSETTED_HAPLOTYPE_DATABASE_FOR_TESTING);\n         final Map<FingerprintIdDetails, Fingerprint> fp1 = fpChecker.fingerprintVcf(vcfFile.toPath());\n \n         Assert.assertFalse(fp1.isEmpty());\n     }\n \n+\n+    @Test(dataProvider = \"checkFingerprintsVcfDataProvider\")\n+    public void testFingerprintSwapEqual(final File vcfFile, final File genotypesFile, final String observedSampleAlias, final String expectedSampleAlias,\n+                                   final double llExpectedSample, final double llRandomSample, final double lodExpectedSample) {\n+        final FingerprintChecker fpChecker = new FingerprintChecker(SUBSETTED_HAPLOTYPE_DATABASE_FOR_TESTING);\n+        final Map<FingerprintIdDetails, Fingerprint> fp1Map = fpChecker.fingerprintVcf(vcfFile.toPath());\n+        final Map<FingerprintIdDetails, Fingerprint> fp2Map = fpChecker.fingerprintVcf(genotypesFile.toPath());\n+\n+        for(Fingerprint fp1:fp1Map.values()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2NTEzMzc0OnYy", "diffSide": "RIGHT", "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NzowNFrOFsWk_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDo1NzowNFrOFsWk_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MTU4Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            compareDoubleWithAccuracy(matchResults12.getLOD(),matchResults21.getLOD(),1e-10);\n          \n          \n            \n                            compareDoubleWithAccuracy(matchResults12.getLOD(),matchResults21.getLOD(), 1e-10);", "url": "https://github.com/broadinstitute/picard/pull/1455#discussion_r382051582", "createdAt": "2020-02-20T14:57:04Z", "author": {"login": "pshapiro4broad"}, "path": "src/test/java/picard/fingerprint/FingerprintCheckerTest.java", "diffHunk": "@@ -124,13 +124,30 @@ public void testCheckFingerprintsVcf(final File vcfFile, final File genotypesFil\n \n     @Test(dataProvider = \"checkFingerprintsVcfDataProvider\")\n     public void testFingerprintVcf(final File vcfFile, final File genotypesFile, final String observedSampleAlias, final String expectedSampleAlias,\n-                                   final double llExpectedSample, final double llRandomSample, final double lodExpectedSample) throws IOException {\n+                                   final double llExpectedSample, final double llRandomSample, final double lodExpectedSample) {\n         final FingerprintChecker fpChecker = new FingerprintChecker(SUBSETTED_HAPLOTYPE_DATABASE_FOR_TESTING);\n         final Map<FingerprintIdDetails, Fingerprint> fp1 = fpChecker.fingerprintVcf(vcfFile.toPath());\n \n         Assert.assertFalse(fp1.isEmpty());\n     }\n \n+\n+    @Test(dataProvider = \"checkFingerprintsVcfDataProvider\")\n+    public void testFingerprintSwapEqual(final File vcfFile, final File genotypesFile, final String observedSampleAlias, final String expectedSampleAlias,\n+                                   final double llExpectedSample, final double llRandomSample, final double lodExpectedSample) {\n+        final FingerprintChecker fpChecker = new FingerprintChecker(SUBSETTED_HAPLOTYPE_DATABASE_FOR_TESTING);\n+        final Map<FingerprintIdDetails, Fingerprint> fp1Map = fpChecker.fingerprintVcf(vcfFile.toPath());\n+        final Map<FingerprintIdDetails, Fingerprint> fp2Map = fpChecker.fingerprintVcf(genotypesFile.toPath());\n+\n+        for(Fingerprint fp1:fp1Map.values()){\n+            for(Fingerprint fp2:fp2Map.values()) {\n+                final MatchResults matchResults12 = FingerprintChecker.calculateMatchResults(fp1, fp2);\n+                final MatchResults matchResults21 = FingerprintChecker.calculateMatchResults(fp2, fp1);\n+                compareDoubleWithAccuracy(matchResults12.getLOD(),matchResults21.getLOD(),1e-10);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3826ca5eef0fd1a72ba63b233ac44dc24559168d"}, "originalPosition": 95}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 687, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}