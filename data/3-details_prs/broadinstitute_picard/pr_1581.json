{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMDUxMjc0", "number": 1581, "title": "Fixed a bug in MergeBamAlignment", "bodyText": "When there's a deletion in the base just beyond the 5' end of the mate, the code for clipping overhanging reads got confused and didn't clip anything. This commit fixes that.\nAdded tests that specifically cover this case.", "createdAt": "2020-09-23T21:30:42Z", "url": "https://github.com/broadinstitute/picard/pull/1581", "merged": true, "mergeCommit": {"oid": "9f0ec0024aa3c541c1764067cabb38f4c94716a5"}, "closed": true, "closedAt": "2020-09-29T21:27:50Z", "author": {"login": "yfarjoun"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLzedlAH2gAyNDkyMDUxMjc0OmVkM2IxOTgxODI3YTMxZTliOTI5ZGNkYWFlNGI2ZGE3ZDFmN2IzNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNunQrAH2gAyNDkyMDUxMjc0OmMzNTViZDIyN2E3OTQxYTgyYTVjY2RjMzFjM2Q4YTNiYzhiNWU3NGU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ed3b1981827a31e9b929dcdaae4b6da7d1f7b372", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/ed3b1981827a31e9b929dcdaae4b6da7d1f7b372", "committedDate": "2020-09-23T21:28:50Z", "message": "Fixed yet another bug in MergeBamAlignment: when there's a deletion in the base just beyond the 5' end of the mate, the code for clipping overhanging reads got confused and didn't clip anything. This commit fixes that.\n\nAdded tests that specifically cover this case."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MDY2NjYw", "url": "https://github.com/broadinstitute/picard/pull/1581#pullrequestreview-495066660", "createdAt": "2020-09-23T21:37:10Z", "commit": {"oid": "ed3b1981827a31e9b929dcdaae4b6da7d1f7b372"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMTozNzoxMFrOHXB21A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMTozNzoxMFrOHXB21A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwOTcxNg==", "bodyText": "this is to protect from a stupidly aligned read that has a deletion at the end somehow, so there are no bases following that base.", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r493909716", "createdAt": "2020-09-23T21:37:10Z", "author": {"login": "yfarjoun"}, "path": "src/main/java/picard/sam/AbstractAlignmentMerger.java", "diffHunk": "@@ -861,10 +860,21 @@ static int getReadPositionAtReferencePositionIgnoreSoftClips(final SAMRecord rec\n         rec.setCigar(newCigar);\n         // Since the read effectively got shifted forward by turning the clips into matches, the query position needs\n         // also to be moved forward bye posShift so that it's still querying the same base.\n-        readPosition = SAMRecord.getReadPositionAtReferencePosition(rec, pos + posShift, false);\n+        final int readPosition = SAMRecord.getReadPositionAtReferencePosition(rec, pos + posShift, true);\n+\n         rec.setCigar(oldCigar);\n \n-        return readPosition;\n+        // if this returns zero, it means that there's a deletion at the position of the desired base,\n+        // if the read is on the positive strand readPosition should be incremented by one to get the\n+        // base __following__ the deletion rather than the one preceding it (which is what returnLastBaseIfDeleted argument in\n+        // getReadPositionAtReferencePosition will do)\n+        final int readPositionZeroOnDeletion = SAMRecord.getReadPositionAtReferencePosition(rec, pos + posShift, false);\n+        final boolean increamentReadPosition = readPositionZeroOnDeletion == 0 &&\n+                !rec.getReadNegativeStrandFlag() &&\n+                readPosition < rec.getReadLength() - 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed3b1981827a31e9b929dcdaae4b6da7d1f7b372"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/cba7e24ba46eed6e57c6aef082910b887bb30356", "committedDate": "2020-09-24T16:22:08Z", "message": "- fix last minute bug\n- many more tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1ODc5Mzkx", "url": "https://github.com/broadinstitute/picard/pull/1581#pullrequestreview-495879391", "createdAt": "2020-09-24T19:15:42Z", "commit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "state": "APPROVED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxOToxNTo0MlrOHXpKqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDozMjo1MlrOHXrmuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU1Mzc3MA==", "bodyText": "These are super helpful figures.\nThe \"-\" at the end of MMMMMMMMMMMMMMMMMMsssssssss-> should be removed because it looks like a deletion, and for the reverse reads you use \"<\".\nThis occurs in a few other places.", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494553770", "createdAt": "2020-09-24T19:15:42Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU3MjEwNg==", "bodyText": "I suggest adding another test:\n// 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n//                  MMMMMMMMMMMMMMMMMMsssssssss->\n//     <ssssssssMMM--MMMMMMMMMMMMMMMM\n//          should become\n// 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n//                  MMMMMMMMMMMMMMMMMSsssssssss->\n//       <ssssssssSSSMMMMMMMMMMMMMMMM\n            {27, 18, 14, \"18M9S\", \"8S3M2D16M\", false, true, 18, 19, \"17M10S\", \"11S1D16M\", false,\n                    default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n                    default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities, null, null},", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494572106", "createdAt": "2020-09-24T19:50:54Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4NDA1MQ==", "bodyText": "MMMMMMMMMMMMMMMMMssssssssss>\nshould be:\nMMMMMMMMMMMMMMMMMSsssssssss>", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494584051", "createdAt": "2020-09-24T20:14:13Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4ODMxNg==", "bodyText": "The cigar for the second read is 16M2I2M7S so there should be two \"i\"s in the second read.", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494588316", "createdAt": "2020-09-24T20:22:29Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>\n+                //                          <sssssSSSSSMMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 15, \"18M9S\", \"5S2M2I18M\", false, true, 18, 18, \"17M10S\", \"10S17M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiiMsssssss>\n+                //                                         /\\\n+                //         with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"17M2I1M7S\", true, false, 18, 18,\"11S16M\",\"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiiMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"16M2I2M7S\", true, false, 18, 18, \"11S16M\", \"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities, default27LongR1Qualities, default27LongR2Qualities, null, null},\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiMMMsssssss>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 154}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4OTMwMA==", "bodyText": "<ssssssSSSSSMMMMMMMMMMMMMMMM\nshould be\n<sssssssSSSSMMMMMMMMMMMMMMMM", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494589300", "createdAt": "2020-09-24T20:24:31Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>\n+                //                          <sssssSSSSSMMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 15, \"18M9S\", \"5S2M2I18M\", false, true, 18, 18, \"17M10S\", \"10S17M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiiMsssssss>\n+                //                                         /\\\n+                //         with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"17M2I1M7S\", true, false, 18, 18,\"11S16M\",\"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiiMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"16M2I2M7S\", true, false, 18, 18, \"11S16M\", \"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities, default27LongR1Qualities, default27LongR2Qualities, null, null},\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiMMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of one bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"16M1I3M7S\", true, false, 18, 18, \"11S16M\", \"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities, default27LongR1Qualities, default27LongR2Qualities, null, null},\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiMMsssssss>\n+                //                                         /\\\n+                //         with an insertion of one bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 172}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU5MDU1NQ==", "bodyText": "123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\nshould be\n123456789.123456789.123456789.1234-56789.123456789.123456789.123456789.123456789", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494590555", "createdAt": "2020-09-24T20:27:01Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>\n+                //                          <sssssSSSSSMMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 15, \"18M9S\", \"5S2M2I18M\", false, true, 18, 18, \"17M10S\", \"10S17M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiiMsssssss>\n+                //                                         /\\\n+                //         with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"17M2I1M7S\", true, false, 18, 18,\"11S16M\",\"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiiMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"16M2I2M7S\", true, false, 18, 18, \"11S16M\", \"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities, default27LongR1Qualities, default27LongR2Qualities, null, null},\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiMMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of one bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"16M1I3M7S\", true, false, 18, 18, \"11S16M\", \"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities, default27LongR1Qualities, default27LongR2Qualities, null, null},\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 166}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU5MTAxNA==", "bodyText": "123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\nshould be\n123456789.123456789.123456789.1234-56789.123456789.123456789.123456789.123456789", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494591014", "createdAt": "2020-09-24T20:27:51Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>\n+                //                          <sssssSSSSSMMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 15, \"18M9S\", \"5S2M2I18M\", false, true, 18, 18, \"17M10S\", \"10S17M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiiMsssssss>\n+                //                                         /\\\n+                //         with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"17M2I1M7S\", true, false, 18, 18,\"11S16M\",\"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiiMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"16M2I2M7S\", true, false, 18, 18, \"11S16M\", \"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities, default27LongR1Qualities, default27LongR2Qualities, null, null},\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 152}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU5MTc3OQ==", "bodyText": "//            <ssssssSSSSSMMMMMMMMMMMMMMMM\n\nshould be\n//            <sssssssSSSSMMMMMMMMMMMMMMMM", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494591779", "createdAt": "2020-09-24T20:29:18Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>\n+                //                          <sssssSSSSSMMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 15, \"18M9S\", \"5S2M2I18M\", false, true, 18, 18, \"17M10S\", \"10S17M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiiMsssssss>\n+                //                                         /\\\n+                //         with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMSSSSsssssss>\n+\n+\n+                {27, 14, 18, \"7S20M\", \"17M2I1M7S\", true, false, 18, 18,\"11S16M\",\"16M11S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMiiMMsssssss>\n+                //                                        /\\\n+                //        with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 143}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU5MjI1OQ==", "bodyText": "//            <ssssssSSSSSMMMMMMMMMMMMMMMM\n\nshould be\n//            <sssssssSSSSMMMMMMMMMMMMMMMM", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494592259", "createdAt": "2020-09-24T20:30:14Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //   <ssssssssMMM---MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 12, \"18M9S\", \"8S3M3D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM-MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M1D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssMMMMMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMM---MMMsssssssss>\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //     <ssssssssSSSSMMMMMMMMMMMMMMM\n+                //                  MMMMMMMMMMMMMMMSSSsssssssss>\n+\n+\n+                {27, 14, 18, \"8S19M\", \"15M3D3M9S\", true, false, 18, 18, \"12S15M\", \"15M12S\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+\n+                //                  123456789.123456--789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMMsssssssss>\n+                //                          <sssssMMiiMMMMMMMMMMMMMMMMMM\n+                //                                  /\\\n+                //   with an insertion of two bases here should become\n+                //                    123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                                     MMMMMMMMMMMMMMMMMssssssssss>\n+                //                          <sssssSSSSSMMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 15, \"18M9S\", \"5S2M2I18M\", false, true, 18, 18, \"17M10S\", \"10S17M\", false,\n+                        default27LongR1Bases, default27LongR2Bases, default27LongR1Bases, default27LongR2Bases, null, null,\n+                        default27LongR1Qualities, default27LongR2Qualities,default27LongR1Qualities, default27LongR2Qualities , null,null },\n+\n+\n+                //       123456789.123456789.123456789.1234--56789.123456789.123456789.123456789.123456789\n+                //            <sssssssMMMMMMMMMMMMMMMMMMMM\n+                //                        MMMMMMMMMMMMMMMMMiiMsssssss>\n+                //                                         /\\\n+                //         with an insertion of two bases here should become\n+                //       123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //            <ssssssSSSSSMMMMMMMMMMMMMMMM", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 128}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU5MzcyMQ==", "bodyText": "could you also add a similar test with an insertion that spans the region to be clipped?", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r494593721", "createdAt": "2020-09-24T20:32:52Z", "author": {"login": "fleharty"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -199,6 +200,136 @@\n                 {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss->\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss->\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\", false,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU3MjEwNg=="}, "originalCommit": {"oid": "cba7e24ba46eed6e57c6aef082910b887bb30356"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba1cf02743400a78571e4d24d20ce20ca4789d3e", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/ba1cf02743400a78571e4d24d20ce20ca4789d3e", "committedDate": "2020-09-24T20:59:35Z", "message": "- clarify some comments\n- more tests!"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fac6395c6cf8ffa2f8d06c3b0cc3f6253f194f4", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/5fac6395c6cf8ffa2f8d06c3b0cc3f6253f194f4", "committedDate": "2020-09-24T21:09:12Z", "message": "-comment fixups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac9d9d976473be423d9b7ca022a7ae9bde179f93", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/ac9d9d976473be423d9b7ca022a7ae9bde179f93", "committedDate": "2020-09-24T21:11:44Z", "message": "optimize imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "091ae8c06009ffd903932bbade53ba6bc0e25959", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/091ae8c06009ffd903932bbade53ba6bc0e25959", "committedDate": "2020-09-24T21:15:14Z", "message": "- fixup comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0173e89a693e5412a35ba9eafcaa915d07822aae", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/0173e89a693e5412a35ba9eafcaa915d07822aae", "committedDate": "2020-09-25T19:31:19Z", "message": "- refactored test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e43f3f760fb0717616025279726504af64b9fd0d", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/e43f3f760fb0717616025279726504af64b9fd0d", "committedDate": "2020-09-25T19:57:13Z", "message": "- removed comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3ODk2NzQx", "url": "https://github.com/broadinstitute/picard/pull/1581#pullrequestreview-497896741", "createdAt": "2020-09-28T21:07:41Z", "commit": {"oid": "e43f3f760fb0717616025279726504af64b9fd0d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQyMTowNzo0MlrOHZPq1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQyMTowNzo0MlrOHZPq1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjIzMzE3NQ==", "bodyText": "Could you add tests for the hardclipping case for these examples involving insertions and deletions as well?  Based on following the code and a simple test I tried out it seems to give an answer that I would considered \"correct\", but it gets there in a pretty unsafe round-about sort of way.  I suspect if it's not well tested the harclipping behavior in these cases could easily be unintentionally and unknowingly changed as a side effect of some future pr.", "url": "https://github.com/broadinstitute/picard/pull/1581#discussion_r496233175", "createdAt": "2020-09-28T21:07:42Z", "author": {"login": "kachulis"}, "path": "src/test/java/picard/sam/AbstractAlignmentMergerTest.java", "diffHunk": "@@ -192,24 +228,198 @@\n \n                  */\n \n-                {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M18S\", \"22S88M\", false,\n+                {110, false, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M18S\", \"22S88M\",\n                         default110LongR1Bases, default110LongR2Bases, default110LongR1Bases, default110LongR2Bases, null, null,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, default110LongR1BaseQualities, default110LongR2BaseQualities, null, null},\n \n-                {110, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\", true,\n+                {110, true, 105, 96, \"12S80M18S\", \"13S97M\", false, true, 105, 105, \"12S80M8S10H\", \"10H12S88M\",\n                         default110LongR1Bases, default110LongR2Bases, sharedBases, sharedBases, default110LongR1ClippedBases, default110LongR2ClippedBases,\n                         default110LongR1BaseQualities, default110LongR2BaseQualities, sharedQualities, sharedQualities, r1ClippedQualities10, r2ClippedQualities10},\n+\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMMMsssssssss>\n+                //     <ssssssssMMM-MMMMMMMMMMMMMMMM\n+                //          should become\n+                // 123456789.123456789.123456789.123456789.123456789.123456789.123456789.123456789\n+                //                  MMMMMMMMMMMMMMMMSSsssssssss>\n+                //      <ssssssssSSSMMMMMMMMMMMMMMMM\n+\n+\n+                {27, false, 18, 14, \"18M9S\", \"8S3M1D16M\", false, true, 18, 18, \"16M11S\", \"11S16M\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e43f3f760fb0717616025279726504af64b9fd0d"}, "originalPosition": 235}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a61000a5b0ab4bc6aea3aaf2c957d6094cac80fa", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/a61000a5b0ab4bc6aea3aaf2c957d6094cac80fa", "committedDate": "2020-09-29T18:43:01Z", "message": "- added MOAR tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODQ0NTg1", "url": "https://github.com/broadinstitute/picard/pull/1581#pullrequestreview-498844585", "createdAt": "2020-09-29T20:15:24Z", "commit": {"oid": "a61000a5b0ab4bc6aea3aaf2c957d6094cac80fa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c355bd227a7941a82a5ccdc31c3d8a3bc8b5e74e", "author": {"user": {"login": "yfarjoun", "name": "Yossi Farjoun"}}, "url": "https://github.com/broadinstitute/picard/commit/c355bd227a7941a82a5ccdc31c3d8a3bc8b5e74e", "committedDate": "2020-09-29T20:56:46Z", "message": "Merge branch 'master' into yf_add_MBA_test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2311, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}