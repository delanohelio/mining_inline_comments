{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwNzA0MDg3", "number": 859, "title": "Improve log management", "bodyText": "", "createdAt": "2020-10-09T16:37:42Z", "url": "https://github.com/senx/warp10-platform/pull/859", "merged": true, "mergeCommit": {"oid": "6084218975af37de8c1fbd5ab86b8192158da6c3"}, "closed": true, "closedAt": "2020-11-03T11:18:01Z", "author": {"login": "steven-gueguen"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQ44WBgH2gAyNTAwNzA0MDg3OjU3ODM4YmFjMDdkMDY0ZWU0ZTUzZDc4ZTU3MzRkMmYwMjE2NWExNjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY3SKVAFqTUyMjM5NzIyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "57838bac07d064ee4e53d78e5734d2f02165a167", "author": {"user": {"login": "steven-gueguen", "name": "Steven GUEGUEN"}}, "url": "https://github.com/senx/warp10-platform/commit/57838bac07d064ee4e53d78e5734d2f02165a167", "committedDate": "2020-10-09T16:36:15Z", "message": "Improve log management"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTU1MTU2", "url": "https://github.com/senx/warp10-platform/pull/859#pullrequestreview-506155156", "createdAt": "2020-10-11T08:13:46Z", "commit": {"oid": "57838bac07d064ee4e53d78e5734d2f02165a167"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQwODoxMzo0NlrOHflg0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQwODoxOTowNFrOHfliwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MjUxMw==", "bodyText": "Not sure this is a good idea, there might be many failures which could clog the logs.", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r502882513", "createdAt": "2020-10-11T08:13:46Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/standalone/StandaloneScriptRunner.java", "diffHunk": "@@ -226,7 +226,8 @@ public void run() {\n             m.appendTail(mc2WithReplacement);\n               \n             stack.execMulti(mc2WithReplacement.toString());\n-          } catch (Exception e) {                \n+          } catch (Exception e) {\n+            e.printStackTrace(System.err);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57838bac07d064ee4e53d78e5734d2f02165a167"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MjkyOA==", "bodyText": "indent should be 2 not 4", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r502882928", "createdAt": "2020-10-11T08:17:55Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/standalone/Warp.java", "diffHunk": "@@ -76,81 +76,80 @@\n \n public class Warp extends WarpDist implements Runnable {\n \n+  private static final Logger LOG = LoggerFactory.getLogger(Warp.class);\n+\n   private static final String DEFAULT_THREADPOOL_SIZE = \"200\";\n-  \n+\n   private static final String DEFAULT_HTTP_ACCEPTORS = \"2\";\n   private static final String DEFAULT_HTTP_SELECTORS = \"4\";\n-  \n+\n   private static final String NULL = \"null\";\n-        \n+\n   private static WarpDB db;\n-  \n+\n   private static boolean standaloneMode = false;\n-  \n+\n   private static int port;\n-  \n+\n   private static String host;\n-  \n-  private static Set<Path> datalogSrcDirs = Collections.unmodifiableSet(new HashSet<Path>()); \n-  \n+\n+  private static Set<Path> datalogSrcDirs = Collections.unmodifiableSet(new HashSet<Path>());\n+\n   private static final String[] REQUIRED_PROPERTIES = {\n-    Configuration.INGRESS_WEBSOCKET_MAXMESSAGESIZE,\n-    Configuration.PLASMA_FRONTEND_WEBSOCKET_MAXMESSAGESIZE,\n-    Configuration.WARP_HASH_CLASS,\n-    Configuration.WARP_HASH_LABELS,\n-    Configuration.WARP_HASH_TOKEN,\n-    Configuration.WARP_HASH_APP,\n-    Configuration.WARP_AES_TOKEN,\n-    Configuration.WARP_AES_SCRIPTS,\n-    Configuration.CONFIG_WARPSCRIPT_UPDATE_ENDPOINT,\n-    Configuration.CONFIG_WARPSCRIPT_META_ENDPOINT,\n-    Configuration.WARP_TIME_UNITS,\n+      Configuration.INGRESS_WEBSOCKET_MAXMESSAGESIZE,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57838bac07d064ee4e53d78e5734d2f02165a167"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MzAxMA==", "bodyText": "The banner is not intended to be a log message, it should be output to stdout no matter what. Add an info message with the revision and a simple text.", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r502883010", "createdAt": "2020-10-11T08:19:04Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/standalone/Warp.java", "diffHunk": "@@ -76,81 +76,80 @@\n \n public class Warp extends WarpDist implements Runnable {\n \n+  private static final Logger LOG = LoggerFactory.getLogger(Warp.class);\n+\n   private static final String DEFAULT_THREADPOOL_SIZE = \"200\";\n-  \n+\n   private static final String DEFAULT_HTTP_ACCEPTORS = \"2\";\n   private static final String DEFAULT_HTTP_SELECTORS = \"4\";\n-  \n+\n   private static final String NULL = \"null\";\n-        \n+\n   private static WarpDB db;\n-  \n+\n   private static boolean standaloneMode = false;\n-  \n+\n   private static int port;\n-  \n+\n   private static String host;\n-  \n-  private static Set<Path> datalogSrcDirs = Collections.unmodifiableSet(new HashSet<Path>()); \n-  \n+\n+  private static Set<Path> datalogSrcDirs = Collections.unmodifiableSet(new HashSet<Path>());\n+\n   private static final String[] REQUIRED_PROPERTIES = {\n-    Configuration.INGRESS_WEBSOCKET_MAXMESSAGESIZE,\n-    Configuration.PLASMA_FRONTEND_WEBSOCKET_MAXMESSAGESIZE,\n-    Configuration.WARP_HASH_CLASS,\n-    Configuration.WARP_HASH_LABELS,\n-    Configuration.WARP_HASH_TOKEN,\n-    Configuration.WARP_HASH_APP,\n-    Configuration.WARP_AES_TOKEN,\n-    Configuration.WARP_AES_SCRIPTS,\n-    Configuration.CONFIG_WARPSCRIPT_UPDATE_ENDPOINT,\n-    Configuration.CONFIG_WARPSCRIPT_META_ENDPOINT,\n-    Configuration.WARP_TIME_UNITS,\n+      Configuration.INGRESS_WEBSOCKET_MAXMESSAGESIZE,\n+      Configuration.PLASMA_FRONTEND_WEBSOCKET_MAXMESSAGESIZE,\n+      Configuration.WARP_HASH_CLASS,\n+      Configuration.WARP_HASH_LABELS,\n+      Configuration.WARP_HASH_TOKEN,\n+      Configuration.WARP_HASH_APP,\n+      Configuration.WARP_AES_TOKEN,\n+      Configuration.WARP_AES_SCRIPTS,\n+      Configuration.CONFIG_WARPSCRIPT_UPDATE_ENDPOINT,\n+      Configuration.CONFIG_WARPSCRIPT_META_ENDPOINT,\n+      Configuration.WARP_TIME_UNITS,\n   };\n-  \n+\n   public Warp() {\n     // TODO Auto-generated constructor stub\n   }\n-  \n+\n   public static void main(String[] args) throws Exception {\n     // Indicate standalone mode is on\n     standaloneMode = true;\n \n     System.setProperty(\"java.awt.headless\", \"true\");\n-    \n-    System.out.println();\n-    System.out.println(Constants.WARP10_BANNER);\n-    System.out.println(\"  Revision \" + Revision.REVISION);\n-    System.out.println();\n+\n+    LOG.info(\"\\n\" + Constants.WARP10_BANNER + \"\\n\" + \"  Revision \" + Revision.REVISION + \"\\n\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57838bac07d064ee4e53d78e5734d2f02165a167"}, "originalPosition": 109}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f", "author": {"user": {"login": "steven-gueguen", "name": "Steven GUEGUEN"}}, "url": "https://github.com/senx/warp10-platform/commit/d3b84c7ad1c8bf78113ae131d1b95c2905e1696f", "committedDate": "2020-10-13T08:57:39Z", "message": "Address PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDY0ODMx", "url": "https://github.com/senx/warp10-platform/pull/859#pullrequestreview-508064831", "createdAt": "2020-10-14T07:28:12Z", "commit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNzoyODoxMlrOHhFvOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNzoyODoxMlrOHhFvOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ1OTA2NQ==", "bodyText": "Why is this in this PR?", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r504459065", "createdAt": "2020-10-14T07:28:12Z", "author": {"login": "hbs"}, "path": "token/src/test/java/io/warp10/token/test/TestWriteToken.java", "diffHunk": "@@ -115,7 +115,7 @@ public void testTokenExpired() throws TException, InterruptedException {\n \n     final QuasarTokenFilter tokenFilter = new QuasarTokenFilter(getConfig(), getKeyStore());\n \n-    Thread.sleep(1);\n+    Thread.sleep(2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDY1NDEy", "url": "https://github.com/senx/warp10-platform/pull/859#pullrequestreview-508065412", "createdAt": "2020-10-14T07:28:59Z", "commit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNzoyODo1OVrOHhFxFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNzozMDoxM1rOHhFz9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ1OTU0MA==", "bodyText": "Change copyright notice to 2018-2020", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r504459540", "createdAt": "2020-10-14T07:28:59Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/plugins/tcp/TCPWarp10Plugin.java", "diffHunk": "@@ -175,7 +175,7 @@ public void init(Properties properties) {\n       @Override\n       public void run() {\n         done = true;\n-        System.out.println(\"TCP Plugin shutting down all managers.\");\n+        LOG.info(\"TCP Plugin shutting down all managers.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ1OTY4Mg==", "bodyText": "Change copyright notice to 2018-2020", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r504459682", "createdAt": "2020-10-14T07:29:13Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/plugins/udp/UDPWarp10Plugin.java", "diffHunk": "@@ -16,6 +16,7 @@\n package io.warp10.plugins.udp;\n \n import io.warp10.warp.sdk.AbstractWarp10Plugin;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ2MDI3Ng==", "bodyText": "Change copyright notice to 2018-2020", "url": "https://github.com/senx/warp10-platform/pull/859#discussion_r504460276", "createdAt": "2020-10-14T07:30:13Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/standalone/StandaloneScriptRunner.java", "diffHunk": "@@ -25,14 +25,14 @@\n import java.util.HashMap;\n import java.util.Map;\n import java.util.Properties;\n-import java.util.Random;\n import java.util.UUID;\n import java.util.concurrent.RejectedExecutionException;\n import java.util.concurrent.atomic.AtomicLong;\n import java.util.regex.Matcher;\n import java.util.regex.Pattern;\n \n import com.geoxp.oss.CryptoHelper;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3b84c7ad1c8bf78113ae131d1b95c2905e1696f"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "198b072fbf1f3851e6bd3ce34a80f0cfc09c0ab5", "author": {"user": {"login": "steven-gueguen", "name": "Steven GUEGUEN"}}, "url": "https://github.com/senx/warp10-platform/commit/198b072fbf1f3851e6bd3ce34a80f0cfc09c0ab5", "committedDate": "2020-10-14T08:48:24Z", "message": "Merge branch 'master' of github.com:senx/warp10-platform into manage-logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2abd63237baa19ec614949630565400e0f1c988d", "author": {"user": {"login": "steven-gueguen", "name": "Steven GUEGUEN"}}, "url": "https://github.com/senx/warp10-platform/commit/2abd63237baa19ec614949630565400e0f1c988d", "committedDate": "2020-10-14T09:03:12Z", "message": "Change copyright"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMzk3MjI4", "url": "https://github.com/senx/warp10-platform/pull/859#pullrequestreview-522397228", "createdAt": "2020-11-03T11:16:02Z", "commit": {"oid": "2abd63237baa19ec614949630565400e0f1c988d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3240, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}