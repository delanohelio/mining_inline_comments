{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MDIxMjg1", "number": 690, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxMjo0OTowN1rODmqe1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo1NDozOFrODp4H7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxODY4NTAwOnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/continuum/store/Constants.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxMjo0OTowN1rOF0NUdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoyOTozN1rOF0W96A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDI4ODUwMA==", "bodyText": "I would propose deletemeta as HTTP parameter here instead of \"nodata\". IMO, this would made more sence for a user", "url": "https://github.com/senx/warp10-platform/pull/690#discussion_r390288500", "createdAt": "2020-03-10T12:49:07Z", "author": {"login": "aurrelhebert"}, "path": "warp10/src/main/java/io/warp10/continuum/store/Constants.java", "diffHunk": "@@ -376,6 +376,7 @@\n   public static final String HTTP_PARAM_SAMPLE = \"sample\";\n   public static final String HTTP_PARAM_PREBOUNDARY = \"boundary.pre\";\n   public static final String HTTP_PARAM_POSTBOUNDARY = \"boundary.post\";\n+  public static final String HTTP_PARAM_NODATA = \"nodata\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "628e0237367f3e7e32d072d099fc96e5e2f54ff8"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ0NjU2OA==", "bodyText": "Renamed 'metaonly', 'deletemeta' could incorrectly lead users to think that 'deleteall' is related.", "url": "https://github.com/senx/warp10-platform/pull/690#discussion_r390446568", "createdAt": "2020-03-10T16:29:37Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/continuum/store/Constants.java", "diffHunk": "@@ -376,6 +376,7 @@\n   public static final String HTTP_PARAM_SAMPLE = \"sample\";\n   public static final String HTTP_PARAM_PREBOUNDARY = \"boundary.pre\";\n   public static final String HTTP_PARAM_POSTBOUNDARY = \"boundary.post\";\n+  public static final String HTTP_PARAM_NODATA = \"nodata\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDI4ODUwMA=="}, "originalCommit": {"oid": "628e0237367f3e7e32d072d099fc96e5e2f54ff8"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxODY5NDI2OnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/continuum/ingress/Ingress.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxMjo1MTo0NFrOF0NaPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxMjo1MTo0NFrOF0NaPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDI4OTk4MQ==", "bodyText": "When the nodata (or deletemeta) option is set, we should consider it's correspond to a deleteallcall and not throw this error.", "url": "https://github.com/senx/warp10-platform/pull/690#discussion_r390289981", "createdAt": "2020-03-10T12:51:44Z", "author": {"login": "aurrelhebert"}, "path": "warp10/src/main/java/io/warp10/continuum/ingress/Ingress.java", "diffHunk": "@@ -1545,6 +1545,22 @@ public void handleDelete(String target, Request baseRequest, HttpServletRequest\n         throw new IOException(\"Parameter \" + Constants.HTTP_PARAM_DELETEALL + \" should be set when deleting a full range.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "628e0237367f3e7e32d072d099fc96e5e2f54ff8"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MjM3NzQwOnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/continuum/ingress/Ingress.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzo1NDozOFrOF5UppA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNDozNzo1MVrOF5WXkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY1MTQ5Mg==", "bodyText": "Not related to these lines but does the same test has to be applied in the finally?\nAlso in the finally, if metaonly, completeDeletion should not be checked.", "url": "https://github.com/senx/warp10-platform/pull/690#discussion_r395651492", "createdAt": "2020-03-20T13:54:38Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/continuum/ingress/Ingress.java", "diffHunk": "@@ -1772,7 +1807,10 @@ public void close() throws Exception {\n                   continue;\n                 }\n               }\n-              pushDeleteMessage(start, end, minage, metadata);\n+              \n+              if (!metaonly) {\n+                pushDeleteMessage(start, end, minage, metadata);\n+              }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "437de51fcd1bfe57c27d344106f1e1aa9da9d582"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY3OTYzNQ==", "bodyText": "It does not change much as the pushDeleteMessages in the finally clause simply flushes unsent messages, but I added a conditional. For completeDeletion, it will be set to true when metaonly is specified so the code within the conditional will be called.", "url": "https://github.com/senx/warp10-platform/pull/690#discussion_r395679635", "createdAt": "2020-03-20T14:37:51Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/continuum/ingress/Ingress.java", "diffHunk": "@@ -1772,7 +1807,10 @@ public void close() throws Exception {\n                   continue;\n                 }\n               }\n-              pushDeleteMessage(start, end, minage, metadata);\n+              \n+              if (!metaonly) {\n+                pushDeleteMessage(start, end, minage, metadata);\n+              }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY1MTQ5Mg=="}, "originalCommit": {"oid": "437de51fcd1bfe57c27d344106f1e1aa9da9d582"}, "originalPosition": 63}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1321, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}