{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNzgxMDYy", "number": 676, "title": "fix #635", "bodyText": "Add more tolerance to empty GTS in all operators.\nNEWGTS 'foo' RENAME 0.1 *\n\nnow valid.\nNEWGTS 'dodo' RENAME \n0 NaN NaN NaN 8 ADDVALUE\nNEWGTS 'fuu' RENAME\n0 NaN NaN NaN 1 ADDVALUE\n[ SWAP 5 mapper.gt 0 0 0 ] MAP 0 GET // non typed gts\n*\n\nnow valid\nNEWGTS NEWGTS *\n\nnow valid.\nSame for + / - operators.\nAlso fix a bug in comparison operators, when comparing an empty gts to a number.", "createdAt": "2020-02-27T11:09:40Z", "url": "https://github.com/senx/warp10-platform/pull/676", "merged": true, "mergeCommit": {"oid": "1bb22c8e9796093ed3ffdb1816a683d7a4978555"}, "closed": true, "closedAt": "2020-03-20T10:34:00Z", "author": {"login": "pi-r-p"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIZNzngH2gAyMzgwNzgxMDYyOmE4NmVmMGM1NjQ2MjczMWQzYWE5MjZlOTVlMjdkNThjYTJlYjA4MjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPdtaqAFqTM3ODM1OTI4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a86ef0c56462731d3aa926e95e27d58ca2eb0823", "author": {"user": {"login": "pi-r-p", "name": "Pierre Papin"}}, "url": "https://github.com/senx/warp10-platform/commit/a86ef0c56462731d3aa926e95e27d58ca2eb0823", "committedDate": "2020-02-27T11:00:11Z", "message": "fix #635"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de", "author": {"user": {"login": "pi-r-p", "name": "Pierre Papin"}}, "url": "https://github.com/senx/warp10-platform/commit/2c666129b9321d62052a840c4430c16c093af2de", "committedDate": "2020-02-27T11:17:21Z", "message": "fix copyright notice"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MTcxNzc5", "url": "https://github.com/senx/warp10-platform/pull/676#pullrequestreview-376171779", "createdAt": "2020-03-17T15:56:48Z", "commit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo1Njo0OFrOF3izOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo1ODowMVrOF3i28A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjE3MQ==", "bodyText": "Until now I think all empty GTSs are of type UNDEFINED. I understand the logic but are you sure it does not break anything?\nWhat is your opinion @hbs?", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786171", "createdAt": "2020-03-17T15:56:48Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/binary/DIV.java", "diffHunk": "@@ -55,6 +55,14 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie gts1 = (GeoTimeSerie) op1;\n       GeoTimeSerie gts2 = (GeoTimeSerie) op2;\n \n+      // Returns immediately a new gts if both inputs are empty\n+      if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n+        GeoTimeSerie result = new GeoTimeSerie();\n+        result.setType(TYPE.DOUBLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjI2Nw==", "bodyText": "Ditto.", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786267", "createdAt": "2020-03-17T15:56:55Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/binary/DIV.java", "diffHunk": "@@ -152,6 +160,13 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie result = op1gts ? ((GeoTimeSerie) op1).cloneEmpty(n) : ((GeoTimeSerie) op2).cloneEmpty();\n       GeoTimeSerie gts = op1gts ? (GeoTimeSerie) op1 : (GeoTimeSerie) op2;\n \n+      // Returns immediately a new clone if gts is empty.\n+      if (0 == n) {\n+        result.setType(TYPE.DOUBLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjQxMA==", "bodyText": "Ditto.", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786410", "createdAt": "2020-03-17T15:57:07Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/binary/MUL.java", "diffHunk": "@@ -68,6 +68,14 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie gts1 = (GeoTimeSerie) op1;\n       GeoTimeSerie gts2 = (GeoTimeSerie) op2;\n \n+      // Returns immediately a new gts if both inputs are empty\n+      if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n+        GeoTimeSerie result = new GeoTimeSerie();\n+        result.setType(TYPE.DOUBLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjU3NA==", "bodyText": "Ditto.", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786574", "createdAt": "2020-03-17T15:57:19Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/binary/MUL.java", "diffHunk": "@@ -161,6 +169,13 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie result = op1gts ? ((GeoTimeSerie) op1).cloneEmpty(n) : ((GeoTimeSerie) op2).cloneEmpty();\n       GeoTimeSerie gts = op1gts ? (GeoTimeSerie) op1 : (GeoTimeSerie) op2;\n \n+      // Returns immediately a new clone if gts is empty.\n+      if (0 == n) {\n+        result.setType(TYPE.DOUBLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NzA0OA==", "bodyText": "Ditto.", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393787048", "createdAt": "2020-03-17T15:57:55Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/binary/SUB.java", "diffHunk": "@@ -58,6 +58,14 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie gts1 = (GeoTimeSerie) op1;\n       GeoTimeSerie gts2 = (GeoTimeSerie) op2;\n \n+      // Returns immediately a new gts if both inputs are empty\n+      if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n+        GeoTimeSerie result = new GeoTimeSerie();\n+        result.setType(TYPE.DOUBLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NzEyMA==", "bodyText": "Ditto.", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393787120", "createdAt": "2020-03-17T15:58:01Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/binary/SUB.java", "diffHunk": "@@ -155,6 +163,13 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie result = op1gts ? ((GeoTimeSerie) op1).cloneEmpty(n) : ((GeoTimeSerie) op2).cloneEmpty();\n       GeoTimeSerie gts = op1gts ? (GeoTimeSerie) op1 : (GeoTimeSerie) op2;\n \n+      // Returns immediately a new clone if gts is empty.\n+      if (0 == n) {\n+        result.setType(TYPE.DOUBLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c666129b9321d62052a840c4430c16c093af2de"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "author": {"user": {"login": "pi-r-p", "name": "Pierre Papin"}}, "url": "https://github.com/senx/warp10-platform/commit/e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "committedDate": "2020-03-18T07:34:30Z", "message": "untyped output for empty gts to gts operations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MzU5Mjg4", "url": "https://github.com/senx/warp10-platform/pull/676#pullrequestreview-378359288", "createdAt": "2020-03-20T10:11:48Z", "commit": {"oid": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3446, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}