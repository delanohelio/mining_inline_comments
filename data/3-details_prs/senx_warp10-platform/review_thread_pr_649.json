{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NTc4Mzcz", "number": 649, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNDowNDo1NVrODdV6zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNTowNjowOFrODdXW8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDk0NDEzOnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/continuum/egress/EgressFetchHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNDowNDo1NVrOFl41-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNDowNDo1NVrOFl41-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI3Mjk1NQ==", "bodyText": "expose could be replace with true as this is on attributes, not labels.", "url": "https://github.com/senx/warp10-platform/pull/649#discussion_r375272955", "createdAt": "2020-02-05T14:04:55Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/continuum/egress/EgressFetchHandler.java", "diffHunk": "@@ -1153,7 +1155,7 @@ private static void textDump(PrintWriter pw, GTSDecoderIterator iter, long now,\n               meta.setAttributes(new TreeMap<String,String>(meta.getAttributes()));\n             }\n             \n-            GTSHelper.labelsToString(sb, meta.getAttributes());\n+            GTSHelper.labelsToString(sb, meta.getAttributes(), expose);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baacddf26400f01f519ef4478f478270b5392e6e"}, "originalPosition": 100}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDk2OTM3OnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/continuum/ThrottlingManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNDoxMjoyN1rOFl5GAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNDoxMjoyN1rOFl5GAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI3NzA1Ng==", "bodyText": "Do or do not, there is no try.", "url": "https://github.com/senx/warp10-platform/pull/649#discussion_r375277056", "createdAt": "2020-02-05T14:12:27Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/continuum/ThrottlingManager.java", "diffHunk": "@@ -259,7 +259,8 @@ public static void checkMADS(Metadata metadata, String producer, String owner, S\n         labels.put(SensisionConstants.SENSISION_LABEL_PRODUCER, producer);\n         StringBuilder sb = new StringBuilder();\n         sb.append(\"Geo Time Series \");\n-        GTSHelper.metadataToString(sb, metadata.getName(), metadata.getLabels());\n+        // Do not ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baacddf26400f01f519ef4478f478270b5392e6e"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDk4NTg3OnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/script/functions/INFO.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNDoxNzoxN1rOFl5QVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNToyMjo0MlrOFmfB8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI3OTcwMA==", "bodyText": "Is that related to this PR?", "url": "https://github.com/senx/warp10-platform/pull/649#discussion_r375279700", "createdAt": "2020-02-05T14:17:17Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/functions/INFO.java", "diffHunk": "@@ -44,7 +44,11 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n     \n     if (Boolean.TRUE.equals(stack.getAttribute(WarpScriptStack.ATTRIBUTE_INFOMODE))) {\n       // Push the documentation back on the stack\n-      stack.push(top);\n+      // Perform a SNAPSHOT and an EVAL so we clone the info map\n+      StringBuilder sb = new StringBuilder();\n+      SNAPSHOT.addElement(sb, top);\n+      stack.execMulti(sb.toString());\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baacddf26400f01f519ef4478f478270b5392e6e"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTg5ODYxMQ==", "bodyText": "absolutely not!", "url": "https://github.com/senx/warp10-platform/pull/649#discussion_r375898611", "createdAt": "2020-02-06T15:22:42Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/functions/INFO.java", "diffHunk": "@@ -44,7 +44,11 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n     \n     if (Boolean.TRUE.equals(stack.getAttribute(WarpScriptStack.ATTRIBUTE_INFOMODE))) {\n       // Push the documentation back on the stack\n-      stack.push(top);\n+      // Perform a SNAPSHOT and an EVAL so we clone the info map\n+      StringBuilder sb = new StringBuilder();\n+      SNAPSHOT.addElement(sb, top);\n+      stack.execMulti(sb.toString());\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI3OTcwMA=="}, "originalCommit": {"oid": "baacddf26400f01f519ef4478f478270b5392e6e"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMTE2MzU1OnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/standalone/StandalonePlasmaHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNTowMTo1N1rOFl6_Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNTowMTo1N1rOFl6_Rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTMwODEwMg==", "bodyText": "Better to avoid searching for the key twice.", "url": "https://github.com/senx/warp10-platform/pull/649#discussion_r375308102", "createdAt": "2020-02-05T15:01:57Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/standalone/StandalonePlasmaHandler.java", "diffHunk": "@@ -509,12 +542,20 @@ private synchronized void listSubscriptions(Session session) throws IOException\n       for (BigInteger id: this.subscriptions.get(session)) {\n         sb.setLength(0);\n         sb.append(\"SUB \");\n-        GTSHelper.metadataToString(sb, metadatas.get(id).getName(), metadatas.get(id).getLabels());\n+        GTSHelper.metadataToString(sb, metadatas.get(id).getName(), metadatas.get(id).getLabels(), getExposeOwnerProducer(session));\n         session.getRemote().sendString(sb.toString());\n       }\n     }\n   }\n   \n+  private synchronized int getSubscriptionCount(Session session) {\n+    if (this.subscriptions.containsKey(session)) {\n+      return this.subscriptions.get(session).size();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baacddf26400f01f519ef4478f478270b5392e6e"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMTE4MDAxOnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/standalone/StandalonePlasmaHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNTowNjowOFrOFl7JzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxNTowNjowOFrOFl7JzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTMxMDc5Ng==", "bodyText": "Replace true by expose?", "url": "https://github.com/senx/warp10-platform/pull/649#discussion_r375310796", "createdAt": "2020-02-05T15:06:08Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/standalone/StandalonePlasmaHandler.java", "diffHunk": "@@ -800,6 +849,18 @@ protected void dispatch(GTSEncoder encoder) throws IOException {\n     return ids;\n   }\n   \n+  private boolean getExposeOwnerProducer(Session session) {\n+    return this.exposeOwnerProducer.getOrDefault(session, false);  \n+  }\n+  \n+  private synchronized void setExposeOwnerProducer(Session session, boolean expose) {\n+    if (true) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baacddf26400f01f519ef4478f478270b5392e6e"}, "originalPosition": 163}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1291, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}