{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwMjM1MTg0", "number": 811, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNToxNDowNlrOEUGCeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODozNDo1MFrOEUhCrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NTA1OTEzOnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/script/functions/REMOVE.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNToxNDowNlrOG6MNLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNToxNDowNlrOG6MNLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3MDU3Mw==", "bodyText": "Update copyright notice", "url": "https://github.com/senx/warp10-platform/pull/811#discussion_r463670573", "createdAt": "2020-07-31T15:14:06Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/functions/REMOVE.java", "diffHunk": "@@ -16,6 +16,8 @@\n \n package io.warp10.script.functions;\n \n+import io.warp10.continuum.gts.GTSHelper;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3e35eedf32c681d9c2b2cfc70aadd27fac88248"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5OTQ4MzMyOnYy", "diffSide": "RIGHT", "path": "warp10/src/main/java/io/warp10/script/functions/REMOVE.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODozNDo1MFrOG6w0fQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODozNzoyOVrOG6w5mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI3MDQ2MQ==", "bodyText": "Shouldn't REMOVE behave similarly on a GTS as it does on a list or map? i.e. leave on the stack the data point tuple it just removed? With [ 0 NaN NaN NaN NULL ] if the datapoint did not exist?", "url": "https://github.com/senx/warp10-platform/pull/811#discussion_r464270461", "createdAt": "2020-08-03T08:34:50Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/functions/REMOVE.java", "diffHunk": "@@ -67,8 +69,33 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       \n       stack.push(coll);\n       stack.push(o);\n+    } else if (coll instanceof GeoTimeSerie) {\n+      if (!(key instanceof Long) && !(key instanceof Integer)) {\n+        throw new WarpScriptException(getName() + \" expects an integer as key.\");\n+      }\n+      int idx = ((Number) key).intValue();\n+\n+      GeoTimeSerie gts = (GeoTimeSerie) coll;\n+\n+      int n = GTSHelper.nvalues(gts);\n+\n+      if (idx < 0) {\n+        idx += n;\n+      }\n+\n+      GeoTimeSerie pruned = gts.cloneEmpty(n);\n+\n+      for (int i = 0; i < n; i++) {\n+        if (i == idx) {\n+          continue;\n+        }\n+\n+        GTSHelper.setValue(pruned, GTSHelper.tickAtIndex(gts, i), GTSHelper.locationAtIndex(gts, i), GTSHelper.elevationAtIndex(gts, i), GTSHelper.valueAtIndex(gts, i), false);\n+      }\n+\n+      stack.push(pruned);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7d80d723ecf1e4c916cbad8f862bb339c901669"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI3MTc2OQ==", "bodyText": "You're right, fixing this.", "url": "https://github.com/senx/warp10-platform/pull/811#discussion_r464271769", "createdAt": "2020-08-03T08:37:29Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/functions/REMOVE.java", "diffHunk": "@@ -67,8 +69,33 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       \n       stack.push(coll);\n       stack.push(o);\n+    } else if (coll instanceof GeoTimeSerie) {\n+      if (!(key instanceof Long) && !(key instanceof Integer)) {\n+        throw new WarpScriptException(getName() + \" expects an integer as key.\");\n+      }\n+      int idx = ((Number) key).intValue();\n+\n+      GeoTimeSerie gts = (GeoTimeSerie) coll;\n+\n+      int n = GTSHelper.nvalues(gts);\n+\n+      if (idx < 0) {\n+        idx += n;\n+      }\n+\n+      GeoTimeSerie pruned = gts.cloneEmpty(n);\n+\n+      for (int i = 0; i < n; i++) {\n+        if (i == idx) {\n+          continue;\n+        }\n+\n+        GTSHelper.setValue(pruned, GTSHelper.tickAtIndex(gts, i), GTSHelper.locationAtIndex(gts, i), GTSHelper.elevationAtIndex(gts, i), GTSHelper.valueAtIndex(gts, i), false);\n+      }\n+\n+      stack.push(pruned);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI3MDQ2MQ=="}, "originalCommit": {"oid": "f7d80d723ecf1e4c916cbad8f862bb339c901669"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1145, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}