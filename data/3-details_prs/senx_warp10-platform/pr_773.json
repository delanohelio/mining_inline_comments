{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI5MjM1Mzg0", "number": 773, "title": "Initial commit of GEO.BUFFER", "bodyText": "", "createdAt": "2020-06-06T14:32:46Z", "url": "https://github.com/senx/warp10-platform/pull/773", "merged": true, "mergeCommit": {"oid": "c4e4a9fe23087a789fe6a5dd2205c62d0b61b3a0"}, "closed": true, "closedAt": "2020-06-10T15:36:07Z", "author": {"login": "hbs"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcooL6YAH2gAyNDI5MjM1Mzg0OmJhZDExODRlNmRkOTI0NjUyNDA3OTgwNmU1OGU5OGVhNjZjMjQyMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp7On-gFqTQyODE2MjI5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bad1184e6dd9246524079806e58e98ea66c2422c", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/bad1184e6dd9246524079806e58e98ea66c2422c", "committedDate": "2020-06-06T14:32:16Z", "message": "Initial commit of GEO.BUFFER"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0d71ab32be1bf7551354debec4902996d9b853e", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/d0d71ab32be1bf7551354debec4902996d9b853e", "committedDate": "2020-06-07T06:31:53Z", "message": "Added support for expressing distance in meters"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDkyOTQ2", "url": "https://github.com/senx/warp10-platform/pull/773#pullrequestreview-426092946", "createdAt": "2020-06-08T10:16:29Z", "commit": {"oid": "d0d71ab32be1bf7551354debec4902996d9b853e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDoxNjozMFrOGgXicw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDoxNjozMFrOGgXicw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU5MzI2Nw==", "bodyText": "If find this kind of hacky, I'd prefer to have a dedicated function to apply the buffer and output a WKT.\nOther solution: I was planning to modify ->GEOJSON and introduce ->WKT as well as ->WKB to convert between formats, maybe it would be a good place to add this logic?", "url": "https://github.com/senx/warp10-platform/pull/773#discussion_r436593267", "createdAt": "2020-06-08T10:16:30Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/script/functions/GeoJSON.java", "diffHunk": "@@ -67,6 +72,23 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       throw new WarpScriptException(uoe);\n     }\n \n+    //\n+    // Apply buffer if defined\n+    //\n+    Map<Object,Object> buffer = (Map<Object,Object>) stack.getAttribute(GEOBUFFER.ATTR_GEOBUFFER);\n+    \n+    if (null != buffer) {\n+      // Clear the buffer\n+      stack.setAttribute(GEOBUFFER.ATTR_GEOBUFFER, null);\n+      // Apply the buffer operation\n+      BufferOp bop = new BufferOp(geometry, (BufferParameters) buffer.get(GEOBUFFER.KEY_PARAMS));\n+      geometry = bop.getResultGeometry(((Double) buffer.get(GEOBUFFER.KEY_DIST)).doubleValue());\n+      if (Boolean.TRUE.equals(buffer.get(GEOBUFFER.KEY_WKT))) {\n+        stack.push(geometry.toText());\n+        return stack;\n+      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0d71ab32be1bf7551354debec4902996d9b853e"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "185c67032c654ca1631301ba4bb20c03674ef196", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/185c67032c654ca1631301ba4bb20c03674ef196", "committedDate": "2020-06-08T20:08:22Z", "message": "Addressed PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MTYyMjk1", "url": "https://github.com/senx/warp10-platform/pull/773#pullrequestreview-428162295", "createdAt": "2020-06-10T15:17:21Z", "commit": {"oid": "185c67032c654ca1631301ba4bb20c03674ef196"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3362, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}