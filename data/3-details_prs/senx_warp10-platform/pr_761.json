{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3NDYxNTAw", "number": 761, "title": "Merge most Math functions and make them applicable on lists", "bodyText": "Extensively tested with JMH and perfs are the same for already existing signatures.", "createdAt": "2020-05-13T16:03:08Z", "url": "https://github.com/senx/warp10-platform/pull/761", "merged": true, "mergeCommit": {"oid": "b50b669072fb80322725c39113aabbd7afb7ed20"}, "closed": true, "closedAt": "2020-05-15T13:33:02Z", "author": {"login": "ftence"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcglGUhgH2gAyNDE3NDYxNTAwOjI0YTZjY2MzNGRlY2MzZWEwMWE0ZWY3NmRhYzZjMjQ3MjJjMDQ0Nzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchd5VJgH2gAyNDE3NDYxNTAwOmI4NjMxNTgxZTEwYjdhYTg3MDIzZDE0NWIyZjBmM2QwODBhYjZiN2Y=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "24a6ccc34decc3ea01a4ef76dac6c24722c04479", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/24a6ccc34decc3ea01a4ef76dac6c24722c04479", "committedDate": "2020-05-12T14:25:03Z", "message": "Factorize code for many Math functions and make them compatible with Lists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "918245aed025064e0230cef4faa3ec95e986049b", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/918245aed025064e0230cef4faa3ec95e986049b", "committedDate": "2020-05-13T15:59:49Z", "message": "Add ListRecursiveSF, merge long and double ops"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b97b63c7a9a150d74ed8b2e32d58399981d2cc1", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/3b97b63c7a9a150d74ed8b2e32d58399981d2cc1", "committedDate": "2020-05-13T16:02:53Z", "message": "Fix copyright"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMDg0Mjc5", "url": "https://github.com/senx/warp10-platform/pull/761#pullrequestreview-411084279", "createdAt": "2020-05-13T16:12:29Z", "commit": {"oid": "3b97b63c7a9a150d74ed8b2e32d58399981d2cc1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNjoxMjoyOVrOGU5K_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNjoxMjoyOVrOGU5K_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU2MTQwNg==", "bodyText": "The handling of nested lists should be done by ElementStackFunction itself not left to the willingness of the applyOnElement implementation.\napplyOnElement should be declared abstract, but a final apply method should be added which checks if the passed object is a list, and if so it will build the resulting list by calling apply recursively until an element is not a list in which case applyOnElement will be called.", "url": "https://github.com/senx/warp10-platform/pull/761#discussion_r424561406", "createdAt": "2020-05-13T16:12:29Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/ListRecursiveStackFunction.java", "diffHunk": "@@ -0,0 +1,101 @@\n+//\n+//   Copyright 2020  SenX S.A.S.\n+//\n+//   Licensed under the Apache License, Version 2.0 (the \"License\");\n+//   you may not use this file except in compliance with the License.\n+//   You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+//   Unless required by applicable law or agreed to in writing, software\n+//   distributed under the License is distributed on an \"AS IS\" BASIS,\n+//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+//   See the License for the specific language governing permissions and\n+//   limitations under the License.\n+//\n+\n+package io.warp10.script;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+/**\n+ * Abstract class to inherit when a function can be called on a single element or a list of elements or list of list of elements, etc.\n+ * This class can be used, for instance, for a function working on GTSs, GTSEncoders and lists thereof, including lists with mixed types.\n+ * The idea is to generate a function using the parameters on the stack and then to apply this function on the element\n+ * or the list of elements.\n+ * This is similar to GTSStackFunction for GTSs but it is a tad faster if the function uses some parameters as this\n+ * implementation does not use a Map for parameters.\n+ * This is similar to ElementOrListStackFunction but it is faster has it checks for List after the other cases which\n+ * it optimal in almost all the cases where the number of elements is higher than the nesting depth of the lists.\n+ */\n+public abstract class ListRecursiveStackFunction extends NamedWarpScriptFunction implements WarpScriptStackFunction {\n+\n+  /**\n+   * Interface defining the function to be generated which is applied to each element.\n+   * This method should check the type of the given element and call unhandled on it if the element is of", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b97b63c7a9a150d74ed8b2e32d58399981d2cc1"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2af66bb26f5462a8b7cd2fdee292f5a8137b759a", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/2af66bb26f5462a8b7cd2fdee292f5a8137b759a", "committedDate": "2020-05-14T09:11:28Z", "message": "Change the logic so that applyOnElement does not have to call unhandled."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExODQ4OTk4", "url": "https://github.com/senx/warp10-platform/pull/761#pullrequestreview-411848998", "createdAt": "2020-05-14T14:15:40Z", "commit": {"oid": "2af66bb26f5462a8b7cd2fdee292f5a8137b759a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNDoxNTo0MFrOGVeYxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNDo1Nzo1MlrOGVgXtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE3MTE0Mw==", "bodyText": "list of lists or nested lists in a more general way?", "url": "https://github.com/senx/warp10-platform/pull/761#discussion_r425171143", "createdAt": "2020-05-14T14:15:40Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/ListRecursiveStackFunction.java", "diffHunk": "@@ -0,0 +1,105 @@\n+//\n+//   Copyright 2020  SenX S.A.S.\n+//\n+//   Licensed under the Apache License, Version 2.0 (the \"License\");\n+//   you may not use this file except in compliance with the License.\n+//   You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+//   Unless required by applicable law or agreed to in writing, software\n+//   distributed under the License is distributed on an \"AS IS\" BASIS,\n+//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+//   See the License for the specific language governing permissions and\n+//   limitations under the License.\n+//\n+\n+package io.warp10.script;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+/**\n+ * Abstract class to inherit when a function can be called on a single element or a list of elements or list of list of elements, etc.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2af66bb26f5462a8b7cd2fdee292f5a8137b759a"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIwMTUxOQ==", "bodyText": "extraneous 'the'", "url": "https://github.com/senx/warp10-platform/pull/761#discussion_r425201519", "createdAt": "2020-05-14T14:55:18Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/functions/NumericalBinaryFunction.java", "diffHunk": "@@ -0,0 +1,151 @@\n+//\n+//   Copyright 2020  SenX S.A.S.\n+//\n+//   Licensed under the Apache License, Version 2.0 (the \"License\");\n+//   you may not use this file except in compliance with the License.\n+//   You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+//   Unless required by applicable law or agreed to in writing, software\n+//   distributed under the License is distributed on an \"AS IS\" BASIS,\n+//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+//   See the License for the specific language governing permissions and\n+//   limitations under the License.\n+//\n+\n+package io.warp10.script.functions;\n+\n+import io.warp10.script.NamedWarpScriptFunction;\n+import io.warp10.script.WarpScriptException;\n+import io.warp10.script.WarpScriptStack;\n+import io.warp10.script.WarpScriptStackFunction;\n+\n+import java.math.BigDecimal;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.function.DoubleBinaryOperator;\n+import java.util.function.LongBinaryOperator;\n+\n+/**\n+ * Apply a double or long binary operator to two values.\n+ * If the only the long operator is defined, all numbers are converted to long.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2af66bb26f5462a8b7cd2fdee292f5a8137b759a"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIwMTk5NA==", "bodyText": "extraneous 'the'", "url": "https://github.com/senx/warp10-platform/pull/761#discussion_r425201994", "createdAt": "2020-05-14T14:55:53Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/functions/NumericalUnaryFunction.java", "diffHunk": "@@ -0,0 +1,66 @@\n+//\n+//   Copyright 2020  SenX S.A.S.\n+//\n+//   Licensed under the Apache License, Version 2.0 (the \"License\");\n+//   you may not use this file except in compliance with the License.\n+//   You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+//   Unless required by applicable law or agreed to in writing, software\n+//   distributed under the License is distributed on an \"AS IS\" BASIS,\n+//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+//   See the License for the specific language governing permissions and\n+//   limitations under the License.\n+//\n+\n+package io.warp10.script.functions;\n+\n+import io.warp10.script.ListRecursiveStackFunction;\n+import io.warp10.script.WarpScriptException;\n+import io.warp10.script.WarpScriptStack;\n+\n+import java.math.BigDecimal;\n+import java.util.function.DoubleUnaryOperator;\n+import java.util.function.LongUnaryOperator;\n+\n+/**\n+ * Apply a double or long unary operator to one value, a list of values or nested lists of values.\n+ * If the only the long operator is defined, all numbers are converted to long.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2af66bb26f5462a8b7cd2fdee292f5a8137b759a"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIwMzYzNw==", "bodyText": "Use 'true' and 'false', not the pythonic 'True' and 'False'", "url": "https://github.com/senx/warp10-platform/pull/761#discussion_r425203637", "createdAt": "2020-05-14T14:57:52Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/script/functions/NumericalBinaryFunction.java", "diffHunk": "@@ -0,0 +1,151 @@\n+//\n+//   Copyright 2020  SenX S.A.S.\n+//\n+//   Licensed under the Apache License, Version 2.0 (the \"License\");\n+//   you may not use this file except in compliance with the License.\n+//   You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+//   Unless required by applicable law or agreed to in writing, software\n+//   distributed under the License is distributed on an \"AS IS\" BASIS,\n+//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+//   See the License for the specific language governing permissions and\n+//   limitations under the License.\n+//\n+\n+package io.warp10.script.functions;\n+\n+import io.warp10.script.NamedWarpScriptFunction;\n+import io.warp10.script.WarpScriptException;\n+import io.warp10.script.WarpScriptStack;\n+import io.warp10.script.WarpScriptStackFunction;\n+\n+import java.math.BigDecimal;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.function.DoubleBinaryOperator;\n+import java.util.function.LongBinaryOperator;\n+\n+/**\n+ * Apply a double or long binary operator to two values.\n+ * If the only the long operator is defined, all numbers are converted to long.\n+ * If the only the double operator is defined, all numbers are converted to double.\n+ * If the both long and double operator are defined, all numbers are converted long until a Double or BigDecimal is found,\n+ * then they are all converted to double.\n+ *\n+ * The operator can also be applied to a list of values and a single operand, on top.\n+ * The result is a copy of the list with values being the result of the operator applied on the initial value and the single operand.\n+ *\n+ * If the function is given a list on top, its behavior depends on applyOnSingleList:\n+ * - if True the result is op(...op(op(op(v[0], v[1]), v[2]), v[3]), ... v[n])", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2af66bb26f5462a8b7cd2fdee292f5a8137b759a"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8631581e10b7aa87023d145b2f0f3d080ab6b7f", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/b8631581e10b7aa87023d145b2f0f3d080ab6b7f", "committedDate": "2020-05-15T08:35:27Z", "message": "Fix comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3345, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}