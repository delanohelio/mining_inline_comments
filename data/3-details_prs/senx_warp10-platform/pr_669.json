{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3MjgyMDY2", "number": 669, "title": "Fixes #667 - Add support for missing labels in Directory searches", "bodyText": "", "createdAt": "2020-02-19T17:08:57Z", "url": "https://github.com/senx/warp10-platform/pull/669", "merged": true, "mergeCommit": {"oid": "0b56cb5496c3eddecfbed96e9b0aef17dbaaeb05"}, "closed": true, "closedAt": "2020-02-28T22:21:55Z", "author": {"login": "hbs"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcF5r6BgH2gAyMzc3MjgyMDY2OmY3OGIyNjEzYzcwMjE5M2JhY2JiZGMwMTIxOWU1ZTFjNGQ5NWQ4MDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIyfa9gFqTM2NjUyMzg0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f78b2613c702193bacbbdc01219e5e1c4d95d807", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/f78b2613c702193bacbbdc01219e5e1c4d95d807", "committedDate": "2020-02-19T17:08:15Z", "message": "Fixes #667 - Add support for missing labels in Directory searches"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "379dfe71a35b7c43249cfaa5b0874da6a9fb0838", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/379dfe71a35b7c43249cfaa5b0874da6a9fb0838", "committedDate": "2020-02-20T12:51:20Z", "message": "Added parameter forSearch to buildSelector to differentiate the output depending on target use"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzOTYyNDYw", "url": "https://github.com/senx/warp10-platform/pull/669#pullrequestreview-363962460", "createdAt": "2020-02-25T08:54:41Z", "commit": {"oid": "379dfe71a35b7c43249cfaa5b0874da6a9fb0838"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwODo1NDo0MVrOFt9W2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwODo1NDo1OVrOFt9XYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzczNTUxMg==", "bodyText": "It there a reason it's warp10. instead of directory. like the other keys in this file?", "url": "https://github.com/senx/warp10-platform/pull/669#discussion_r383735512", "createdAt": "2020-02-25T08:54:41Z", "author": {"login": "ftence"}, "path": "etc/conf.templates/distributed/10-directory.conf.template", "diffHunk": "@@ -286,3 +286,8 @@ directory.hbase.filter = false\n // Should we ignore the proxy settings when doing a streaming request?\n //\n #directory.streaming.noproxy =\n+\n+//\n+// Set to true to allow Directory queries with missing label selectors (using empty exact match)\n+//\n+warp10.absent.label.support = true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "379dfe71a35b7c43249cfaa5b0874da6a9fb0838"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzczNTY1MA==", "bodyText": "Ditto.", "url": "https://github.com/senx/warp10-platform/pull/669#discussion_r383735650", "createdAt": "2020-02-25T08:54:59Z", "author": {"login": "ftence"}, "path": "etc/conf.templates/standalone/10-directory.conf.template", "diffHunk": "@@ -29,3 +29,8 @@ directory.stats.class.maxcardinality = 100\n // Maximum number of labels for which to report detailed stats in 'FINDSTATS'\n //\n directory.stats.labels.maxcardinality = 100\n+\n+//\n+// Set to true to allow Directory queries with missing label selectors (using empty exact match)\n+//\n+warp10.absent.label.support = true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "379dfe71a35b7c43249cfaa5b0874da6a9fb0838"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ad88f67de2816d3a3dfdf16ce5c245347522a32", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/4ad88f67de2816d3a3dfdf16ce5c245347522a32", "committedDate": "2020-02-26T07:39:06Z", "message": "Moved configuration into 00-warp.conf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67ae8d49e06c19fd9658c75aaf8378366541a9bc", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/67ae8d49e06c19fd9658c75aaf8378366541a9bc", "committedDate": "2020-02-26T07:59:15Z", "message": "Added support for missing labels"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1Njc2MjUy", "url": "https://github.com/senx/warp10-platform/pull/669#pullrequestreview-365676252", "createdAt": "2020-02-27T13:25:50Z", "commit": {"oid": "67ae8d49e06c19fd9658c75aaf8378366541a9bc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzoyNTo1MFrOFvSEFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzoyNTo1MFrOFvSEFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEyMzM0OA==", "bodyText": "Shouldn't  it be null != inputAttributes && null != inputAttributes.get(label) ?\nAlso you could merge the if and the else if blocks because they do the same.", "url": "https://github.com/senx/warp10-platform/pull/669#discussion_r385123348", "createdAt": "2020-02-27T13:25:50Z", "author": {"login": "ftence"}, "path": "warp10/src/main/java/io/warp10/continuum/gts/MetadataSelectorMatcher.java", "diffHunk": "@@ -177,8 +212,19 @@ public boolean matches(Metadata metadata) {\n     } else {\n       // standard selector\n       if (null != this.labelsPatterns) {\n+        for (String label: this.missingLabels) {\n+          if (null != inputLabels && null != inputLabels.get(label)) {\n+            labelAndAttributeMatch = false;\n+            break;\n+          } else if (null != inputAttributes && null != inputLabels.get(label)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67ae8d49e06c19fd9658c75aaf8378366541a9bc"}, "originalPosition": 93}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed6dbc774e5e26829b14832fec7eb40407d26674", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/ed6dbc774e5e26829b14832fec7eb40407d26674", "committedDate": "2020-02-27T14:33:15Z", "message": "Addressed PR comment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ae45241210ae631dc9d7a2aada764d1b081e862", "author": {"user": {"login": "hbs", "name": "Mathias Herberts"}}, "url": "https://github.com/senx/warp10-platform/commit/7ae45241210ae631dc9d7a2aada764d1b081e862", "committedDate": "2020-02-27T14:36:46Z", "message": "Addressed PR comment, merged conditionals."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NTIzODQw", "url": "https://github.com/senx/warp10-platform/pull/669#pullrequestreview-366523840", "createdAt": "2020-02-28T16:27:03Z", "commit": {"oid": "7ae45241210ae631dc9d7a2aada764d1b081e862"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3437, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}