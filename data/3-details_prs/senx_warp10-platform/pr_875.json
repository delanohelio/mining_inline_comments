{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MDQ4Njcy", "number": 875, "title": "Precise error message when conf files contain invalid lines, fixes #872", "bodyText": "When a configuration file contain errors (multiple = or invalid url-encoding), starting Warp 10 produces a message similar to this:\nFound errors while reading /opt/warp10/etc/conf.d/70--extensions.conf. (Malformed lines [61, 80].)\nFixes #872.", "createdAt": "2020-11-19T15:47:37Z", "url": "https://github.com/senx/warp10-platform/pull/875", "merged": true, "mergeCommit": {"oid": "2d7c2d37da3fbf0a50e05d515337751424478546"}, "closed": true, "closedAt": "2020-12-10T16:35:46Z", "author": {"login": "ftence"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddul1kAH2gAyNTI0MDQ4NjcyOjA0ZjI1NDM2MmNmZTRkMWE5NGQ0Nzk4MjQwYmVmNTZlYzg1YmRkYTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk1na0AFqTU0OTM1MzgwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "04f254362cfe4d1a94d4798240bef56ec85bdda2", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/04f254362cfe4d1a94d4798240bef56ec85bdda2", "committedDate": "2020-11-18T13:58:00Z", "message": "Add clearer error messages when reading conf files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bb6de1dddc0079d2f824cbd9629793e48842f46", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/3bb6de1dddc0079d2f824cbd9629793e48842f46", "committedDate": "2020-11-19T15:43:11Z", "message": "Avoid multiple var expansion and fixed WarpURLDecoded exception handling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMTk1MzIz", "url": "https://github.com/senx/warp10-platform/pull/875#pullrequestreview-540195323", "createdAt": "2020-11-27T21:28:52Z", "commit": {"oid": "3bb6de1dddc0079d2f824cbd9629793e48842f46"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QyMToyODo1MlrOH7J3FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QyMTo0MTo1NVrOH7KALw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTc4OTU4OQ==", "bodyText": "Rename parameter since it can now contain multiple files.", "url": "https://github.com/senx/warp10-platform/pull/875#discussion_r531789589", "createdAt": "2020-11-27T21:28:52Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/WarpConfig.java", "diffHunk": "@@ -122,62 +126,63 @@ public static void clearThreadProperties() {\n     threadProperties.remove();\n   }\n   \n-  public static void safeSetProperties(String file) throws IOException {\n+  public static void safeSetProperties(String... file) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bb6de1dddc0079d2f824cbd9629793e48842f46"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTc5MTkxOQ==", "bodyText": "Removing the System.exit call changes the behavior for callers other than the main method of WarpConfig, this will most likely break the behavior of many environment which initialize the Warp 10 config through this method, including the integration in Spark/Flink/Pig/KafkaStreams/NiFi and probably others.", "url": "https://github.com/senx/warp10-platform/pull/875#discussion_r531791919", "createdAt": "2020-11-27T21:41:55Z", "author": {"login": "hbs"}, "path": "warp10/src/main/java/io/warp10/WarpConfig.java", "diffHunk": "@@ -316,13 +327,16 @@ public static Properties readConfig(Reader reader, Properties properties, boolea\n \n     br.close();\n \n-    if (errorcount > 0) {\n-      System.err.println(\"Aborting due to \" + errorcount + \" error\" + (errorcount > 1 ? \"s\" : \"\") + \".\");\n-      System.exit(-1);\n+    if (!linesInError.isEmpty()) {\n+      throw new IOException(\"Malformed lines \" + linesInError.toString() + \".\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bb6de1dddc0079d2f824cbd9629793e48842f46"}, "originalPosition": 217}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61658d70c439cd2a491f468229b2091aa8567f9b", "author": {"user": {"login": "ftence", "name": "Fabien Tenc\u00e9"}}, "url": "https://github.com/senx/warp10-platform/commit/61658d70c439cd2a491f468229b2091aa8567f9b", "committedDate": "2020-12-02T14:28:31Z", "message": "Make WarpConfig exit on error by default, fix recursive safeSetProperties"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjMyNjY5", "url": "https://github.com/senx/warp10-platform/pull/875#pullrequestreview-548632669", "createdAt": "2020-12-09T21:40:03Z", "commit": {"oid": "61658d70c439cd2a491f468229b2091aa8567f9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MzUzODAz", "url": "https://github.com/senx/warp10-platform/pull/875#pullrequestreview-549353803", "createdAt": "2020-12-10T16:06:32Z", "commit": {"oid": "61658d70c439cd2a491f468229b2091aa8567f9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3260, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}