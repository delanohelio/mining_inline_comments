{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMDQ1ODc1", "number": 298, "title": "Support ContinueInitializationOnError for Acceptors", "bodyText": "Fixes #293", "createdAt": "2020-06-08T10:49:25Z", "url": "https://github.com/quickfix-j/quickfixj/pull/298", "merged": true, "mergeCommit": {"oid": "bd909146b8edb0b401606424df6cef894eab3b5e"}, "closed": true, "closedAt": "2020-06-08T21:01:55Z", "author": {"login": "chrjohn"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpN3SgAH2gAyNDMxMDQ1ODc1Ojk1ZDJhNTUwODNhMzJkNjUyOGFhMzE3NWY4MWJlYTBiM2E3ZWQxOTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpStMfAH2gAyNDMxMDQ1ODc1OmU3MWZmNzlhMzBmMDFmYTRiYjNhNzFhNGE3OTYxNTdjNjliYTJhN2Y=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "95d2a55083a32d6528aa3175f81bea0b3a7ed193", "author": {"user": {"login": "chrjohn", "name": "Christoph John"}}, "url": "https://github.com/quickfix-j/quickfixj/commit/95d2a55083a32d6528aa3175f81bea0b3a7ed193", "committedDate": "2020-06-08T10:26:08Z", "message": "Introduced method SessionConnector.isContinueInitOnError()\n to be used by AbstractSocketInitiator and AbstractSocketAcceptor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbb8fbe7cb5d5c68016535241d9d94e9599d3155", "author": {"user": {"login": "chrjohn", "name": "Christoph John"}}, "url": "https://github.com/quickfix-j/quickfixj/commit/cbb8fbe7cb5d5c68016535241d9d94e9599d3155", "committedDate": "2020-06-08T10:31:25Z", "message": "Changed AbstractSocketAcceptor.createSessions() to check if\n `continueInitOnError` is active.\n\n(Not a big fan of catching general `Throwable` but made code as similar\nas possible to AbstractSocketInitiator. Could be changed later.)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9123fd9f791680ae14c155a9cc52c8e8d5fc4565", "author": {"user": {"login": "chrjohn", "name": "Christoph John"}}, "url": "https://github.com/quickfix-j/quickfixj/commit/9123fd9f791680ae14c155a9cc52c8e8d5fc4565", "committedDate": "2020-06-08T10:36:30Z", "message": "Added test to MultiAcceptorTest and converted test to JUnit4 style."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25aac9327de343aa336fa2ea73a55433372d4a7a", "author": {"user": {"login": "chrjohn", "name": "Christoph John"}}, "url": "https://github.com/quickfix-j/quickfixj/commit/25aac9327de343aa336fa2ea73a55433372d4a7a", "committedDate": "2020-06-08T10:46:13Z", "message": "Added short note to configuration.html."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTE1MDYx", "url": "https://github.com/quickfix-j/quickfixj/pull/298#pullrequestreview-426115061", "createdAt": "2020-06-08T10:50:17Z", "commit": {"oid": "25aac9327de343aa336fa2ea73a55433372d4a7a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo1MDoxN1rOGgYjrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo1MDoxN1rOGgYjrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYwOTk2Ng==", "bodyText": "Not a big fan of catching general Throwable but made code as similar as possible to AbstractSocketInitiator. Could be changed later.", "url": "https://github.com/quickfix-j/quickfixj/pull/298#discussion_r436609966", "createdAt": "2020-06-08T10:50:17Z", "author": {"login": "chrjohn"}, "path": "quickfixj-core/src/main/java/quickfix/mina/acceptor/AbstractSocketAcceptor.java", "diffHunk": "@@ -227,11 +229,20 @@ private void createSessions(SessionSettings settings) throws ConfigError, FieldC\n             }\n \n             if (connectionType.equals(SessionFactory.ACCEPTOR_CONNECTION_TYPE)) {\n-                AcceptorSocketDescriptor descriptor = getAcceptorSocketDescriptor(settings, sessionID);\n-                if (!isTemplate) {\n-                    Session session = sessionFactory.create(sessionID, settings);\n-                    descriptor.acceptSession(session);\n-                    allSessions.put(sessionID, session);\n+                try {\n+                    AcceptorSocketDescriptor descriptor = getAcceptorSocketDescriptor(settings, sessionID);\n+                    if (!isTemplate) {\n+                        Session session = sessionFactory.create(sessionID, settings);\n+                        descriptor.acceptSession(session);\n+                        allSessions.put(sessionID, session);\n+                    }\n+                } catch (Throwable t) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25aac9327de343aa336fa2ea73a55433372d4a7a"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2Mjg3NzQ5", "url": "https://github.com/quickfix-j/quickfixj/pull/298#pullrequestreview-426287749", "createdAt": "2020-06-08T14:16:31Z", "commit": {"oid": "25aac9327de343aa336fa2ea73a55433372d4a7a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDoxNjozMlrOGggu2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDoxNjozMlrOGggu2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc0Mzg5Nw==", "bodyText": "assertFalse(acceptorSessions.contains(session2)); would be good.", "url": "https://github.com/quickfix-j/quickfixj/pull/298#discussion_r436743897", "createdAt": "2020-06-08T14:16:32Z", "author": {"login": "the-thing"}, "path": "quickfixj-core/src/test/java/quickfix/MultiAcceptorTest.java", "diffHunk": "@@ -111,6 +129,26 @@ public void testMessageSentOnWrongAcceptor() throws Exception {\n         }\n     }\n \n+    @Test\n+    public void testContinueInitializationOnError() throws Exception {\n+        testAcceptorApplication = new TestAcceptorApplication(3);\n+        int freePort1 = AvailablePortFinder.getNextAvailable();\n+        int freePort2 = AvailablePortFinder.getNextAvailable();\n+        int freePort3 = AvailablePortFinder.getNextAvailable();\n+\n+        Acceptor acceptor = createAcceptor(freePort1, freePort2, freePort3, true);\n+        acceptor.start();\n+\n+        List<SessionID> acceptorSessions = acceptor.getSessions();\n+        assertEquals(2, acceptorSessions.size());\n+        SessionID session1 = new SessionID(FixVersions.BEGINSTRING_FIX42, \"ACCEPTOR-\" + 1, \"INITIATOR\");\n+        SessionID session3 = new SessionID(FixVersions.BEGINSTRING_FIX42, \"ACCEPTOR-\" + 3, \"INITIATOR\");\n+        assertTrue(acceptorSessions.contains(session1));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25aac9327de343aa336fa2ea73a55433372d4a7a"}, "originalPosition": 98}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e71ff79a30f01fa4bb3a71a4a796157c69ba2a7f", "author": {"user": {"login": "chrjohn", "name": "Christoph John"}}, "url": "https://github.com/quickfix-j/quickfixj/commit/e71ff79a30f01fa4bb3a71a4a796157c69ba2a7f", "committedDate": "2020-06-08T16:04:38Z", "message": "Small addition to unit test."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3108, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}