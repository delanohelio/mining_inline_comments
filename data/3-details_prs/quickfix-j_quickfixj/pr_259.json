{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3OTU1MjAz", "number": 259, "title": "Fix variable interpolation with custom properties for SessionID", "bodyText": "There is no way to resolve variableValues from custom place (without using system properties) for SessionId fields. But they are used for FIX session creation.", "createdAt": "2020-02-20T20:21:17Z", "url": "https://github.com/quickfix-j/quickfixj/pull/259", "merged": true, "mergeCommit": {"oid": "c4b3f3563a5cfc0e60fb62f253b1b8557318d7a8"}, "closed": true, "closedAt": "2020-05-25T21:02:47Z", "author": {"login": "MAXbrainRUS"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGNp1IgH2gAyMzc3OTU1MjAzOmI0MGY5OTI3M2FmODYzNTg2ZWFhZGIyY2MzYTg5YzIxMTQ2YmZhNDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIJ3chgFqTM2NTA4MTU0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b40f99273af863586eaadb2cc3a89c21146bfa48", "author": {"user": {"login": "MAXbrainRUS", "name": null}}, "url": "https://github.com/quickfix-j/quickfixj/commit/b40f99273af863586eaadb2cc3a89c21146bfa48", "committedDate": "2020-02-20T16:24:05Z", "message": "small refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0721255ec6c8ddbba89f9d4add646011ab15fcd0", "author": {"user": {"login": "MAXbrainRUS", "name": null}}, "url": "https://github.com/quickfix-j/quickfixj/commit/0721255ec6c8ddbba89f9d4add646011ab15fcd0", "committedDate": "2020-02-20T16:49:41Z", "message": "Add new constructors for SessionSettings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b", "author": {"user": {"login": "MAXbrainRUS", "name": null}}, "url": "https://github.com/quickfix-j/quickfixj/commit/2f0cb0c19299a202286ab131b59e373d2d69354b", "committedDate": "2020-02-20T17:01:07Z", "message": "Add test for SessionSettings with custom variableValues and loading from file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzQyMDYx", "url": "https://github.com/quickfix-j/quickfixj/pull/259#pullrequestreview-362342061", "createdAt": "2020-02-21T01:04:09Z", "commit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwMTowNDoxMFrOFsoirg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwMToxODoxM1rOFsowHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM0NTkwMg==", "bodyText": "Make this private - it's not used outside this class.", "url": "https://github.com/quickfix-j/quickfixj/pull/259#discussion_r382345902", "createdAt": "2020-02-21T01:04:10Z", "author": {"login": "philipwhiuk"}, "path": "quickfixj-core/src/test/java/quickfix/SessionSettingsTest.java", "diffHunk": "@@ -537,4 +599,8 @@ public void testConcurrentAccess() throws ConfigError, InterruptedException {\n         return defaultSettings;\n     }\n \n+    protected String getConfigurationFileName() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b"}, "originalPosition": 102}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM0NjI1OQ==", "bodyText": "As an aside, this is still a terrible name for a variable IMO but we could fix that in another commit.\nTo be completely obtuse, it's a variable property that contains contains variable properties.\nmodifiableValues would move us in the right direction. I'll take that up in another PR when this is merged.", "url": "https://github.com/quickfix-j/quickfixj/pull/259#discussion_r382346259", "createdAt": "2020-02-21T01:05:26Z", "author": {"login": "philipwhiuk"}, "path": "quickfixj-core/src/main/java/quickfix/SessionSettings.java", "diffHunk": "@@ -86,13 +86,34 @@\n     // problems with moving configuration files between *nix and Windows.\n     private static final String NEWLINE = \"\\r\\n\";\n \n-    private Properties variableValues = System.getProperties();\n+    private Properties variableValues;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM0NzEzMw==", "bodyText": "These comments are kind of unnecessary IMO.", "url": "https://github.com/quickfix-j/quickfixj/pull/259#discussion_r382347133", "createdAt": "2020-02-21T01:08:55Z", "author": {"login": "philipwhiuk"}, "path": "quickfixj-core/src/test/java/quickfix/SessionSettingsTest.java", "diffHunk": "@@ -313,6 +324,57 @@ public void testVariableInterpolationWithProps() throws Exception {\n                 settings.getString(\"VariableTest\"));\n     }\n \n+    @Test\n+    public void testVariableInterpolationWithCustomPropsForSessionIdFromInputStream() throws Exception {\n+        // GIVEN", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM0OTM0Mw==", "bodyText": "This method is both hard to follow and repeated.\nI prefer\nprivate SessionID findSessionID(SessionSettings settings, String targetCompID) {\n     while (sessionIDIterator.hasNext()) {\n          if (sessionID.getTargetCompID().startsWith(sessionID)) {\n                  return sessionID;\n          }\n     }\n     return null;\n}\nthen\nSessionID sessionID = findSessionID(settings, \"CLIENT3\");\nassertNotNull(\"Settings for CLIENT3 not found\", sessionID);\nassertEquals(\"Wrong TargetCompID\", \"CLIENT3_FOO_BAR\", sessionID.getTargetCompID());\nThis abstracts the nasty Iterator iteration out the test and makes the test closer to the arrange, act, assert model - which is what your comments are really saying.", "url": "https://github.com/quickfix-j/quickfixj/pull/259#discussion_r382349343", "createdAt": "2020-02-21T01:18:13Z", "author": {"login": "philipwhiuk"}, "path": "quickfixj-core/src/test/java/quickfix/SessionSettingsTest.java", "diffHunk": "@@ -313,6 +324,57 @@ public void testVariableInterpolationWithProps() throws Exception {\n                 settings.getString(\"VariableTest\"));\n     }\n \n+    @Test\n+    public void testVariableInterpolationWithCustomPropsForSessionIdFromInputStream() throws Exception {\n+        // GIVEN\n+        System.setProperty(\"test.2\", \"BAR\");\n+        final Properties properties = new Properties(System.getProperties());\n+        properties.setProperty(\"test.1\", \"FOO\");\n+\n+        String settingsString = getDefaultSettingString();\n+        settingsString += \"\\n\";\n+        settingsString += \"[SESSION]\\n\";\n+        settingsString += \"BeginString=FIX.4.2\\n\";\n+        settingsString += \"TargetCompID=CLIENT3_${test.1}_${test.2}\\n\";\n+        settingsString += \"DataDictionary=../spec/FIX42.xml\\n\";\n+\n+        // WHEN\n+        final SessionSettings settings = createSettingsFromString(settingsString, properties);\n+\n+        // THEN\n+        Iterator<SessionID> sessionIDIterator = settings.sectionIterator();\n+        while (sessionIDIterator.hasNext()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzQ3MTIz", "url": "https://github.com/quickfix-j/quickfixj/pull/259#pullrequestreview-362347123", "createdAt": "2020-02-21T01:21:15Z", "commit": {"oid": "2f0cb0c19299a202286ab131b59e373d2d69354b"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81b7a38f382abafc1450517b1c4b35accef1f1c3", "author": {"user": {"login": "MAXbrainRUS", "name": null}}, "url": "https://github.com/quickfix-j/quickfixj/commit/81b7a38f382abafc1450517b1c4b35accef1f1c3", "committedDate": "2020-02-21T17:03:56Z", "message": "Fix method visibility"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09996e9492363b569b2ed3e3534fc57881bed79b", "author": {"user": {"login": "MAXbrainRUS", "name": null}}, "url": "https://github.com/quickfix-j/quickfixj/commit/09996e9492363b569b2ed3e3534fc57881bed79b", "committedDate": "2020-02-21T17:22:41Z", "message": "Stylistic refactoring after code-review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MDgxNTQ4", "url": "https://github.com/quickfix-j/quickfixj/pull/259#pullrequestreview-365081548", "createdAt": "2020-02-26T17:07:11Z", "commit": {"oid": "09996e9492363b569b2ed3e3534fc57881bed79b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3086, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}