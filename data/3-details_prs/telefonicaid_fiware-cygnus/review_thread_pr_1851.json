{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MTcxNzc4", "number": 1851, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDoxOTozMlrODt43-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1OToyNlrODuaiAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NDQ0MzQ3OnYy", "diffSide": "RIGHT", "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDoxOTozMlrOF_ks-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNTo0NDo1M1rOF_xi0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwNTk0NA==", "bodyText": "There is no need to overload the costructor in this case, since mongoAuthSource has a not null validation on getDatabase.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402205944", "createdAt": "2020-04-02T10:19:32Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -72,6 +73,25 @@ public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPas\n         this.mongoHosts = mongoHosts;\n         this.mongoUsername = mongoUsername;\n         this.mongoPassword = mongoPassword;\n+        this.mongoAuthSource = \"\";\n+        this.dataModel = dataModel;\n+    } // MongoBackendImpl\n+\n+    /**\n+     * Constructor.\n+     * @param mongoHosts\n+     * @param mongoUsername\n+     * @param mongoPassword\n+     * @param mongoAuthSource\n+     * @param dataModel\n+     */\n+    public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPassword,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyMzcxOQ==", "bodyText": "From my point of view it is better to have this new constructor to avoid side effect and maintain the backward compatibility. There is no problem to have 2 constructors in OOP and it is common to do it allowing to initialize and/or construct objects with different parameters depending of the use cases and future needs and maintaining the interface.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402223719", "createdAt": "2020-04-02T10:52:34Z", "author": {"login": "srrspace"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -72,6 +73,25 @@ public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPas\n         this.mongoHosts = mongoHosts;\n         this.mongoUsername = mongoUsername;\n         this.mongoPassword = mongoPassword;\n+        this.mongoAuthSource = \"\";\n+        this.dataModel = dataModel;\n+    } // MongoBackendImpl\n+\n+    /**\n+     * Constructor.\n+     * @param mongoHosts\n+     * @param mongoUsername\n+     * @param mongoPassword\n+     * @param mongoAuthSource\n+     * @param dataModel\n+     */\n+    public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPassword,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwNTk0NA=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIzMDY1OA==", "bodyText": "I agree, but the constructor is actually only used in NGSIMongoBaseSink and in tests, so there is no need to have both.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402230658", "createdAt": "2020-04-02T11:06:15Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -72,6 +73,25 @@ public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPas\n         this.mongoHosts = mongoHosts;\n         this.mongoUsername = mongoUsername;\n         this.mongoPassword = mongoPassword;\n+        this.mongoAuthSource = \"\";\n+        this.dataModel = dataModel;\n+    } // MongoBackendImpl\n+\n+    /**\n+     * Constructor.\n+     * @param mongoHosts\n+     * @param mongoUsername\n+     * @param mongoPassword\n+     * @param mongoAuthSource\n+     * @param dataModel\n+     */\n+    public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPassword,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwNTk0NA=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxNjMzOA==", "bodyText": "I agree with @IvanHdzC . The constructor is only used in one point of the code, so lest's adapt constructor and calling code better than adding a second constructor. In addition, the lesser constructor we have, the easier it would be to have good code coverage in tests.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402416338", "createdAt": "2020-04-02T15:44:53Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -72,6 +73,25 @@ public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPas\n         this.mongoHosts = mongoHosts;\n         this.mongoUsername = mongoUsername;\n         this.mongoPassword = mongoPassword;\n+        this.mongoAuthSource = \"\";\n+        this.dataModel = dataModel;\n+    } // MongoBackendImpl\n+\n+    /**\n+     * Constructor.\n+     * @param mongoHosts\n+     * @param mongoUsername\n+     * @param mongoPassword\n+     * @param mongoAuthSource\n+     * @param dataModel\n+     */\n+    public MongoBackendImpl(String mongoHosts, String mongoUsername, String mongoPassword,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwNTk0NA=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NDQ2MDI2OnYy", "diffSide": "RIGHT", "path": "cygnus-ngsi/src/main/java/com/telefonica/iot/cygnus/sinks/NGSIMongoBaseSink.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDoyNDoxOVrOF_k3RQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMTowOToyOFrOF_mUDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwODU4MQ==", "bodyText": "I thing it's more usuall that the default authSource is \"admin\". It would be better if the default value of mongo_auth_source is \"admin\".", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402208581", "createdAt": "2020-04-02T10:24:19Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-ngsi/src/main/java/com/telefonica/iot/cygnus/sinks/NGSIMongoBaseSink.java", "diffHunk": "@@ -98,33 +107,35 @@ protected void setBackend(MongoBackendImpl backend) {\n     protected MongoBackendImpl getBackend() {\n         return backend;\n     } // getBackend\n-    \n+\n     @Override\n     public void configure(Context context) {\n         super.configure(context);\n-        \n+\n         mongoHosts = context.getString(\"mongo_hosts\", \"localhost:27017\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_hosts=\" + mongoHosts + \")\");\n         mongoUsername = context.getString(\"mongo_username\", \"\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_username=\" + mongoUsername + \")\");\n         // FIXME: mongoPassword should be read as a SHA1 and decoded here\n         mongoPassword = context.getString(\"mongo_password\", \"\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_password=\" + mongoPassword + \")\");\n-        \n+        mongoAuthSource = context.getString(\"mongo_auth_source\", \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyOTEzNQ==", "bodyText": "IMHO authSource is necessary to be configured and not fixed as default constant value to admin for security reason. Admin is a sensible and critical database with rights and high privileges. Giving the possibility to configure the authentication database will allow to provide other specific databases with some restrictions and with just the necesary privileges with a set of user depending of the uses and applications needed and it is more secure tha using only the admin database.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402229135", "createdAt": "2020-04-02T11:03:13Z", "author": {"login": "srrspace"}, "path": "cygnus-ngsi/src/main/java/com/telefonica/iot/cygnus/sinks/NGSIMongoBaseSink.java", "diffHunk": "@@ -98,33 +107,35 @@ protected void setBackend(MongoBackendImpl backend) {\n     protected MongoBackendImpl getBackend() {\n         return backend;\n     } // getBackend\n-    \n+\n     @Override\n     public void configure(Context context) {\n         super.configure(context);\n-        \n+\n         mongoHosts = context.getString(\"mongo_hosts\", \"localhost:27017\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_hosts=\" + mongoHosts + \")\");\n         mongoUsername = context.getString(\"mongo_username\", \"\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_username=\" + mongoUsername + \")\");\n         // FIXME: mongoPassword should be read as a SHA1 and decoded here\n         mongoPassword = context.getString(\"mongo_password\", \"\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_password=\" + mongoPassword + \")\");\n-        \n+        mongoAuthSource = context.getString(\"mongo_auth_source\", \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwODU4MQ=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIzMjMzMg==", "bodyText": "You are right, I misunderstood the \"defaultauthdb\" value, it actually is the db where the connection is created.\nNTC", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402232332", "createdAt": "2020-04-02T11:09:28Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-ngsi/src/main/java/com/telefonica/iot/cygnus/sinks/NGSIMongoBaseSink.java", "diffHunk": "@@ -98,33 +107,35 @@ protected void setBackend(MongoBackendImpl backend) {\n     protected MongoBackendImpl getBackend() {\n         return backend;\n     } // getBackend\n-    \n+\n     @Override\n     public void configure(Context context) {\n         super.configure(context);\n-        \n+\n         mongoHosts = context.getString(\"mongo_hosts\", \"localhost:27017\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_hosts=\" + mongoHosts + \")\");\n         mongoUsername = context.getString(\"mongo_username\", \"\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_username=\" + mongoUsername + \")\");\n         // FIXME: mongoPassword should be read as a SHA1 and decoded here\n         mongoPassword = context.getString(\"mongo_password\", \"\");\n         LOGGER.debug(\"[\" + this.getName() + \"] Reading configuration (mongo_password=\" + mongoPassword + \")\");\n-        \n+        mongoAuthSource = context.getString(\"mongo_auth_source\", \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIwODU4MQ=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NDQ3MjE4OnYy", "diffSide": "RIGHT", "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDoyNzo1OFrOF_k-6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMTozNTowNFrOF_nFXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxMDUzNw==", "bodyText": "Not sure if the dbName is the right authSource in case it is not specified.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402210537", "createdAt": "2020-04-02T10:27:58Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -492,9 +512,20 @@ private MongoDatabase getDatabase(String dbName) {\n \n         if (client == null) {\n             if (mongoUsername.length() != 0) {\n-                MongoCredential credential = MongoCredential.createCredential(mongoUsername, dbName,\n+                String authSource;\n+                if ((mongoAuthSource != null) && !mongoAuthSource.isEmpty()) {\n+                    authSource = mongoAuthSource;\n+                } else {\n+                    authSource = dbName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIzMjUwMA==", "bodyText": "Before this modification dbName was the value used in the previous version. If authSource is not configured then the behavior of the code is the same as before maintaining the backward compatibility. From my point of view it is better to keep the code as it is and not setting authSource as a constant to \"admin\".", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402232500", "createdAt": "2020-04-02T11:09:47Z", "author": {"login": "srrspace"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -492,9 +512,20 @@ private MongoDatabase getDatabase(String dbName) {\n \n         if (client == null) {\n             if (mongoUsername.length() != 0) {\n-                MongoCredential credential = MongoCredential.createCredential(mongoUsername, dbName,\n+                String authSource;\n+                if ((mongoAuthSource != null) && !mongoAuthSource.isEmpty()) {\n+                    authSource = mongoAuthSource;\n+                } else {\n+                    authSource = dbName;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxMDUzNw=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIzMjUxMw==", "bodyText": "I misunderstood the \"defaultauthdb\" value, it actually is the db where the connection is created.\nNTC", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402232513", "createdAt": "2020-04-02T11:09:48Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -492,9 +512,20 @@ private MongoDatabase getDatabase(String dbName) {\n \n         if (client == null) {\n             if (mongoUsername.length() != 0) {\n-                MongoCredential credential = MongoCredential.createCredential(mongoUsername, dbName,\n+                String authSource;\n+                if ((mongoAuthSource != null) && !mongoAuthSource.isEmpty()) {\n+                    authSource = mongoAuthSource;\n+                } else {\n+                    authSource = dbName;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxMDUzNw=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI0NDk1OQ==", "bodyText": "Yes, dbName is one thing and authSource is another. The parameter dbName is the name of the database to create and based on \"Fiware-Service\" where the collections will be stored. And authSource is used to specify a user DB where the credentials are defined, as documented by Mongo and for the credentials objects. These are 2 different things.\ndbName is used in client.getDatabase(dbName) (class MongoClient) and authSource is used by credential object (MongoCredential) if only there is a need of authentication.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402244959", "createdAt": "2020-04-02T11:35:04Z", "author": {"login": "srrspace"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -492,9 +512,20 @@ private MongoDatabase getDatabase(String dbName) {\n \n         if (client == null) {\n             if (mongoUsername.length() != 0) {\n-                MongoCredential credential = MongoCredential.createCredential(mongoUsername, dbName,\n+                String authSource;\n+                if ((mongoAuthSource != null) && !mongoAuthSource.isEmpty()) {\n+                    authSource = mongoAuthSource;\n+                } else {\n+                    authSource = dbName;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIxMDUzNw=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NDU1NjQzOnYy", "diffSide": "RIGHT", "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMDo1MzowMFrOF_lzRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxOTowOTowOVrOF_5m2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyMzk0MQ==", "bodyText": "is this ever used?", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402223941", "createdAt": "2020-04-02T10:53:00Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -600,4 +631,24 @@ protected int getOffset(GregorianCalendar calendar, Resolution resolution) {\n         return offset;\n     } // getOffset\n \n+    /**\n+     * Gets the mongo auth_source\n+     * @return\n+     */\n+    public String getAuthSource() {\n+        return mongoAuthSource;\n+    } // getAuthSource\n+\n+    /**\n+     * Set the mongo auth_source\n+     * @param authSource DB used for mongo authentication\n+     */\n+    public void setAuthSource(String authSource) {\n+        if (authSource != null) {\n+            this.mongoAuthSource = authSource;\n+        } else {\n+            this.mongoAuthSource = \"\";\n+        }\n+    } // setAuthSource\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI0NTIxNg==", "bodyText": "Again, if somebody or other piece of code (allowing other new sink in the future to use mongo as a DB with authentication),  and want to use the first constructor without authSource in parameter, it will have the opportunity to set the authSource after to build the backend object using the setAuthSource(...) operation when needed and in some place in the code. It is typical and best practices to do it in OOP (overload constructors and get/set operations), and give more possibilities.\nNotice that in this case mongoAuthSource shoud not be annotated as \"final\" in the declaration.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402245216", "createdAt": "2020-04-02T11:35:35Z", "author": {"login": "srrspace"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -600,4 +631,24 @@ protected int getOffset(GregorianCalendar calendar, Resolution resolution) {\n         return offset;\n     } // getOffset\n \n+    /**\n+     * Gets the mongo auth_source\n+     * @return\n+     */\n+    public String getAuthSource() {\n+        return mongoAuthSource;\n+    } // getAuthSource\n+\n+    /**\n+     * Set the mongo auth_source\n+     * @param authSource DB used for mongo authentication\n+     */\n+    public void setAuthSource(String authSource) {\n+        if (authSource != null) {\n+            this.mongoAuthSource = authSource;\n+        } else {\n+            this.mongoAuthSource = \"\";\n+        }\n+    } // setAuthSource\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyMzk0MQ=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI1MDAyMw==", "bodyText": "get/setAuthSource(...) could be used, if somebody build the object without authSource parameter and if after they want to initialize this parameter.\nThis is what I tested successfully and put in comment as documentation (see start() operation), and use of the new constructor.\nBTW, What does it mean \"NTC\" and \"LGTM\"?", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402250023", "createdAt": "2020-04-02T11:45:28Z", "author": {"login": "srrspace"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -600,4 +631,24 @@ protected int getOffset(GregorianCalendar calendar, Resolution resolution) {\n         return offset;\n     } // getOffset\n \n+    /**\n+     * Gets the mongo auth_source\n+     * @return\n+     */\n+    public String getAuthSource() {\n+        return mongoAuthSource;\n+    } // getAuthSource\n+\n+    /**\n+     * Set the mongo auth_source\n+     * @param authSource DB used for mongo authentication\n+     */\n+    public void setAuthSource(String authSource) {\n+        if (authSource != null) {\n+            this.mongoAuthSource = authSource;\n+        } else {\n+            this.mongoAuthSource = \"\";\n+        }\n+    } // setAuthSource\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyMzk0MQ=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxODAzOA==", "bodyText": "NTC = Nothing to change\nLGTM = Looks good to me", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402418038", "createdAt": "2020-04-02T15:47:16Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -600,4 +631,24 @@ protected int getOffset(GregorianCalendar calendar, Resolution resolution) {\n         return offset;\n     } // getOffset\n \n+    /**\n+     * Gets the mongo auth_source\n+     * @return\n+     */\n+    public String getAuthSource() {\n+        return mongoAuthSource;\n+    } // getAuthSource\n+\n+    /**\n+     * Set the mongo auth_source\n+     * @param authSource DB used for mongo authentication\n+     */\n+    public void setAuthSource(String authSource) {\n+        if (authSource != null) {\n+            this.mongoAuthSource = authSource;\n+        } else {\n+            this.mongoAuthSource = \"\";\n+        }\n+    } // setAuthSource\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyMzk0MQ=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU0ODQ0MA==", "bodyText": "More on \"the NTC and LGTM protocol\" review protocol here: https://github.com/telefonicaid/fiware-orion/blob/master/doc/manuals/contribution_guidelines.md#pull-request-protocol", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r402548440", "createdAt": "2020-04-02T19:09:09Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/mongo/MongoBackendImpl.java", "diffHunk": "@@ -600,4 +631,24 @@ protected int getOffset(GregorianCalendar calendar, Resolution resolution) {\n         return offset;\n     } // getOffset\n \n+    /**\n+     * Gets the mongo auth_source\n+     * @return\n+     */\n+    public String getAuthSource() {\n+        return mongoAuthSource;\n+    } // getAuthSource\n+\n+    /**\n+     * Set the mongo auth_source\n+     * @param authSource DB used for mongo authentication\n+     */\n+    public void setAuthSource(String authSource) {\n+        if (authSource != null) {\n+            this.mongoAuthSource = authSource;\n+        } else {\n+            this.mongoAuthSource = \"\";\n+        }\n+    } // setAuthSource\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjIyMzk0MQ=="}, "originalCommit": {"oid": "e0ebd92a4e752cd2d78601af257a1f15ca5013f6"}, "originalPosition": 151}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5OTkyNDY5OnYy", "diffSide": "RIGHT", "path": "doc/cygnus-ngsi/flume_extensions_catalogue/ngsi_mongo_sink.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1MjoyN1rOGAY9kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1MjoyN1rOGAY9kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA2MjE2Mw==", "bodyText": "The new parameter mongo_auth_source should be also added to the configuration table included in this file .md file.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r403062163", "createdAt": "2020-04-03T14:52:27Z", "author": {"login": "fgalan"}, "path": "doc/cygnus-ngsi/flume_extensions_catalogue/ngsi_mongo_sink.md", "diffHunk": "@@ -332,6 +332,7 @@ A configuration example could be:\n     cygnus-ngsi.sinks.mongo-sink.mongo_hosts = 192.168.80.34:27017\n     cygnus-ngsi.sinks.mongo-sink.mongo_username = myuser\n     cygnus-ngsi.sinks.mongo-sink.mongo_password = mypassword\n+    cygnus-ngsi.sinks.mongo-sink.mongo_auth_source = admin\n     cygnus-ngsi.sinks.mongo-sink.db_prefix = cygnus_", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "773eb00c8d8972962e2448c59fe797424df6471b"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5OTkyNTUwOnYy", "diffSide": "RIGHT", "path": "doc/cygnus-ngsi/flume_extensions_catalogue/ngsi_sth_sink.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1MjozM1rOGAY-Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNTowMjo0NlrOGBcIMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA2MjI4Mg==", "bodyText": "The new parameter mongo_auth_source should be also added to the configuration table included in this file .md file.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r403062282", "createdAt": "2020-04-03T14:52:33Z", "author": {"login": "fgalan"}, "path": "doc/cygnus-ngsi/flume_extensions_catalogue/ngsi_sth_sink.md", "diffHunk": "@@ -330,6 +330,7 @@ A configuration example could be:\n     cygnus-ngsi.sinks.sth-sink.mongo_hosts = 192.168.80.34:27017\n     cygnus-ngsi.sinks.sth-sink.mongo_username = myuser\n     cygnus-ngsi.sinks.sth-sink.mongo_password = mypassword\n+    cygnus-ngsi.sinks.sth-sink.mongo_auth_source = admin", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "773eb00c8d8972962e2448c59fe797424df6471b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE2MjYwOA==", "bodyText": "The new parameter mongo_auth_source have been added to the configuration table for both sinks.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r404162608", "createdAt": "2020-04-06T15:02:46Z", "author": {"login": "srrspace"}, "path": "doc/cygnus-ngsi/flume_extensions_catalogue/ngsi_sth_sink.md", "diffHunk": "@@ -330,6 +330,7 @@ A configuration example could be:\n     cygnus-ngsi.sinks.sth-sink.mongo_hosts = 192.168.80.34:27017\n     cygnus-ngsi.sinks.sth-sink.mongo_username = myuser\n     cygnus-ngsi.sinks.sth-sink.mongo_password = mypassword\n+    cygnus-ngsi.sinks.sth-sink.mongo_auth_source = admin", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA2MjI4Mg=="}, "originalCommit": {"oid": "773eb00c8d8972962e2448c59fe797424df6471b"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5OTk0MDQyOnYy", "diffSide": "RIGHT", "path": "CHANGES_NEXT_RELEASE", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1NTozOFrOGAZG4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNTowMToyOFrOGBcEVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA2NDU0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [cygnus-ngsi][MongoSink] Add a new mongoAuthSource parameter to create the Mongo backend.\n          \n          \n            \n            [cygnus-ngsi][MongoSink][MongoSTH] Add a new mongoAuthSource parameter to create the Mongo backend.\n          \n      \n    \n    \n  \n\nGiven that, as far as I understand, both sinks are \"solved\" by this PR.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r403064545", "createdAt": "2020-04-03T14:55:38Z", "author": {"login": "fgalan"}, "path": "CHANGES_NEXT_RELEASE", "diffHunk": "@@ -12,3 +12,5 @@\n [cygnus-ngsi][Elasticsearch] Fix a bug that non-Latin characters such as Japanese are garbled. (#1839)\n [cygnus-ngsi][MongoSink]Fix on mongo collection name asignation. (#1845)\n [cygnus-ngsi][MongoSink]Fix on mongo recvTime Date format.\n+[cygnus-common][MongoBackend] Fix persistence error mongo authentication and side effect. (#1849)\n+[cygnus-ngsi][MongoSink] Add a new mongoAuthSource parameter to create the Mongo backend.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "773eb00c8d8972962e2448c59fe797424df6471b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE2MTYyMA==", "bodyText": "Yes, theoretically this PR solves both sinks", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r404161620", "createdAt": "2020-04-06T15:01:28Z", "author": {"login": "srrspace"}, "path": "CHANGES_NEXT_RELEASE", "diffHunk": "@@ -12,3 +12,5 @@\n [cygnus-ngsi][Elasticsearch] Fix a bug that non-Latin characters such as Japanese are garbled. (#1839)\n [cygnus-ngsi][MongoSink]Fix on mongo collection name asignation. (#1845)\n [cygnus-ngsi][MongoSink]Fix on mongo recvTime Date format.\n+[cygnus-common][MongoBackend] Fix persistence error mongo authentication and side effect. (#1849)\n+[cygnus-ngsi][MongoSink] Add a new mongoAuthSource parameter to create the Mongo backend.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA2NDU0NQ=="}, "originalCommit": {"oid": "773eb00c8d8972962e2448c59fe797424df6471b"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5OTk1Nzc3OnYy", "diffSide": "RIGHT", "path": "CHANGES_NEXT_RELEASE", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1OToyNlrOGAZRuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDo1OToyNlrOGAZRuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzA2NzMyMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [cygnus-common][MongoBackend] Fix persistence error mongo authentication and side effect. (#1849)\n          \n          \n            \n            [cygnus-common][MongoBackend] Fix persistence error mongo authentication and side effect (using new configuration parameter mongo_auth_source). (#1849)", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1851#discussion_r403067320", "createdAt": "2020-04-03T14:59:26Z", "author": {"login": "fgalan"}, "path": "CHANGES_NEXT_RELEASE", "diffHunk": "@@ -12,3 +12,5 @@\n [cygnus-ngsi][Elasticsearch] Fix a bug that non-Latin characters such as Japanese are garbled. (#1839)\n [cygnus-ngsi][MongoSink]Fix on mongo collection name asignation. (#1845)\n [cygnus-ngsi][MongoSink]Fix on mongo recvTime Date format.\n+[cygnus-common][MongoBackend] Fix persistence error mongo authentication and side effect. (#1849)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "773eb00c8d8972962e2448c59fe797424df6471b"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2450, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}