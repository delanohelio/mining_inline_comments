{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzOTYyODEx", "number": 1960, "title": "Fix/prepared statement", "bodyText": "This PR changes PreparedStatement behaviour.\nBefore this PR the final statement was builded with native sql driver methods, but it's failing when inserting some SQL objects. The ones identified are Timestamp with TZ and functions.(An issue was created to take a deeper look at this miss behaviour #1959)\nWith this PR the SQL query is builded as a plain String (as it does usually on the insert query).", "createdAt": "2020-10-15T09:33:43Z", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960", "merged": true, "mergeCommit": {"oid": "953dc1c841260fffa82aaf2201f320637a15e6af"}, "closed": true, "closedAt": "2020-10-15T13:51:55Z", "author": {"login": "IvanHdzC"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSsnawgH2gAyNTAzOTYyODExOmViMGI2NjkzMDQ3M2Y0NTY5NDNiZDQ2ZDM3ZDI4ZmY4ZjhjZjI5NTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSyH3ZgFqTUwOTQwMjE0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eb0b66930473f456943bd46d37d28ff8f8cf2957", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/eb0b66930473f456943bd46d37d28ff8f8cf2957", "committedDate": "2020-10-15T07:26:45Z", "message": "add values for insert methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7f8dab92a2b7b310d9631ae090b84c153c2b115", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/c7f8dab92a2b7b310d9631ae090b84c153c2b115", "committedDate": "2020-10-15T08:13:32Z", "message": "update tests to build query as string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60215301c7910f1a0539b74f1d482efe99f5b1dd", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/60215301c7910f1a0539b74f1d482efe99f5b1dd", "committedDate": "2020-10-15T08:14:02Z", "message": "remove addjson methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03d49e1c624f9b4a4078fdc183e4ac64cc260540", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/03d49e1c624f9b4a4078fdc183e4ac64cc260540", "committedDate": "2020-10-15T08:15:15Z", "message": "add nativetypes flags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "719c8444e962247e05b58facaacb6eb7754f2703", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/719c8444e962247e05b58facaacb6eb7754f2703", "committedDate": "2020-10-15T08:19:35Z", "message": "update backend"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/62d6451479608005a361801a6f34e522a82d9af6", "committedDate": "2020-10-15T09:12:22Z", "message": "update upsert transaction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88eb605909d69442eca2317e346cc5ff842ca767", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/88eb605909d69442eca2317e346cc5ff842ca767", "committedDate": "2020-10-15T09:24:17Z", "message": "add CNR entry"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MjAyMzY0", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#pullrequestreview-509202364", "createdAt": "2020-10-15T09:45:06Z", "commit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MjgwMDE1", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#pullrequestreview-509280015", "createdAt": "2020-10-15T11:30:50Z", "commit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTozMDo1MFrOHiDU7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTozMDo1MFrOHiDU7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2ODE0MQ==", "bodyText": "CNR entry (with reference to issue number, if we have some) should be included.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#discussion_r505468141", "createdAt": "2020-10-15T11:30:50Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/sql/SQLBackendImpl.java", "diffHunk": "@@ -581,12 +581,21 @@ public void upsertTransaction (LinkedHashMap<String, ArrayList<JsonElement>> agg\n             String insertQuery = SQLQueryUtils.sqlInsertQuery(aggregation,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MjgwOTUy", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#pullrequestreview-509280952", "createdAt": "2020-10-15T11:32:16Z", "commit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTozMjoxNlrOHiDX1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTozMjoxNlrOHiDX1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ2ODg4NA==", "bodyText": "Maybe this FIXME should mention an issue number? Is this related with #1959?", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#discussion_r505468884", "createdAt": "2020-10-15T11:32:16Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/sql/SQLBackendImpl.java", "diffHunk": "@@ -581,12 +581,21 @@ public void upsertTransaction (LinkedHashMap<String, ArrayList<JsonElement>> agg\n             String insertQuery = SQLQueryUtils.sqlInsertQuery(aggregation,\n                     tableName,\n                     sqlInstance,\n-                    destination).toString();\n+                    destination,\n+                    attrNativeTypes).toString();\n \n-            PreparedStatement insertStatement = null;\n+            PreparedStatement insertStatement;\n             insertStatement = connection.prepareStatement(insertQuery);\n+            /*\n+\n+            FIXME", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MzM5MDkx", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#pullrequestreview-509339091", "createdAt": "2020-10-15T12:47:45Z", "commit": {"oid": "62d6451479608005a361801a6f34e522a82d9af6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6405c4618697b38182c45733d38268d817e903fd", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/6405c4618697b38182c45733d38268d817e903fd", "committedDate": "2020-10-15T13:39:36Z", "message": "add fixme notes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f9140fe589e08bee19e85ea1daeca198e1e0f97", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/2f9140fe589e08bee19e85ea1daeca198e1e0f97", "committedDate": "2020-10-15T13:40:53Z", "message": "update CNR entry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17729c232e3178154185c00f1d7ac4ef202e4c1b", "author": {"user": {"login": "IvanHdzC", "name": "Ivan Hernandez"}}, "url": "https://github.com/telefonicaid/fiware-cygnus/commit/17729c232e3178154185c00f1d7ac4ef202e4c1b", "committedDate": "2020-10-15T13:42:36Z", "message": "Merge branch 'master' into fix/prepared_statement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDAyMTQ3", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1960#pullrequestreview-509402147", "createdAt": "2020-10-15T13:51:43Z", "commit": {"oid": "17729c232e3178154185c00f1d7ac4ef202e4c1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3793, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}