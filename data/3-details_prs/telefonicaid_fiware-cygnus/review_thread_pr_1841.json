{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMjM2OTI5", "number": 1841, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToxNTozMFrODqSoKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMTo1NDowMlrODqWFXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NjcxOTc4OnYy", "diffSide": "RIGHT", "path": "cygnus-common/src/test/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImplTest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToxNTozMFrOF58iGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDozNDo1MFrOF5_cVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNDkyMg==", "bodyText": "Leftover comment? In that case, it should be removed.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396304922", "createdAt": "2020-03-23T09:15:30Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/test/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImplTest.java", "diffHunk": "@@ -149,17 +157,18 @@ public void testBulkInsert_woData() {\n         public void testBulkInsert_oneData() {\n             System.out.println(getTestTraceHead(String.format(\"[ElasticsearchBackendImplTest.bulkInsert OK, TLS=%b, Data=1]\", flag)));\n \n+            System.out.println(String.format(\"%s, %b, %s\", schema, flag, msg));\n             List<Map<String, String>> data = new ArrayList<Map<String, String>>();\n             data.add(new HashMap<String, String>(){\n                 {\n                     put(\"recvTimeTs\", \"test_recvTimeTs_1\");\n-                    put(\"data\", \"{\\\"message\\\": \\\"test data 1\\\"}\");\n+                    put(\"data\", msg);\n                 }\n             });\n-            String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";\n+            // String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2be3106735d443639045b696f2356b596ef7c0ce"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNTY3NA==", "bodyText": "I'm sorry, this is my mistake. I'll remove this line and re-send pull request soon.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396305674", "createdAt": "2020-03-23T09:16:50Z", "author": {"login": "nmatsui"}, "path": "cygnus-common/src/test/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImplTest.java", "diffHunk": "@@ -149,17 +157,18 @@ public void testBulkInsert_woData() {\n         public void testBulkInsert_oneData() {\n             System.out.println(getTestTraceHead(String.format(\"[ElasticsearchBackendImplTest.bulkInsert OK, TLS=%b, Data=1]\", flag)));\n \n+            System.out.println(String.format(\"%s, %b, %s\", schema, flag, msg));\n             List<Map<String, String>> data = new ArrayList<Map<String, String>>();\n             data.add(new HashMap<String, String>(){\n                 {\n                     put(\"recvTimeTs\", \"test_recvTimeTs_1\");\n-                    put(\"data\", \"{\\\"message\\\": \\\"test data 1\\\"}\");\n+                    put(\"data\", msg);\n                 }\n             });\n-            String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";\n+            // String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNDkyMg=="}, "originalCommit": {"oid": "2be3106735d443639045b696f2356b596ef7c0ce"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM1MDI1MQ==", "bodyText": "... and re-send pull request soon.\n\nJust to clarify, you could use the same PR, no need of re-sending a new PR. Just commit the fix to the PR branch (and put a \"Fixed in <commithash>\" mark below this comment to resolve it). Thanks!", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396350251", "createdAt": "2020-03-23T10:31:05Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/test/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImplTest.java", "diffHunk": "@@ -149,17 +157,18 @@ public void testBulkInsert_woData() {\n         public void testBulkInsert_oneData() {\n             System.out.println(getTestTraceHead(String.format(\"[ElasticsearchBackendImplTest.bulkInsert OK, TLS=%b, Data=1]\", flag)));\n \n+            System.out.println(String.format(\"%s, %b, %s\", schema, flag, msg));\n             List<Map<String, String>> data = new ArrayList<Map<String, String>>();\n             data.add(new HashMap<String, String>(){\n                 {\n                     put(\"recvTimeTs\", \"test_recvTimeTs_1\");\n-                    put(\"data\", \"{\\\"message\\\": \\\"test data 1\\\"}\");\n+                    put(\"data\", msg);\n                 }\n             });\n-            String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";\n+            // String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNDkyMg=="}, "originalCommit": {"oid": "2be3106735d443639045b696f2356b596ef7c0ce"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM1MjU5Nw==", "bodyText": "Fixed in 7a6730e", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396352597", "createdAt": "2020-03-23T10:34:50Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/test/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImplTest.java", "diffHunk": "@@ -149,17 +157,18 @@ public void testBulkInsert_woData() {\n         public void testBulkInsert_oneData() {\n             System.out.println(getTestTraceHead(String.format(\"[ElasticsearchBackendImplTest.bulkInsert OK, TLS=%b, Data=1]\", flag)));\n \n+            System.out.println(String.format(\"%s, %b, %s\", schema, flag, msg));\n             List<Map<String, String>> data = new ArrayList<Map<String, String>>();\n             data.add(new HashMap<String, String>(){\n                 {\n                     put(\"recvTimeTs\", \"test_recvTimeTs_1\");\n-                    put(\"data\", \"{\\\"message\\\": \\\"test data 1\\\"}\");\n+                    put(\"data\", msg);\n                 }\n             });\n-            String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";\n+            // String recvTimeTs1Hash = \"599F4FB6AFDB1BEF51126B47DAC2696F\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNDkyMg=="}, "originalCommit": {"oid": "2be3106735d443639045b696f2356b596ef7c0ce"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NjcyOTkyOnYy", "diffSide": "RIGHT", "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToxODoxMVrOF58oPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDozNTowOFrOF5_c2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNjQ5NA==", "bodyText": "An entry to CHANGES_NEXT_RELEASE file, briefly describing the modifications in this PR and referencing the issue number, should be included. Please have a look to existing CHANGES_NEXT_RELEASE file to see the style we use.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396306494", "createdAt": "2020-03-23T09:18:11Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "diffHunk": "@@ -25,9 +25,9 @@\n import com.telefonica.iot.cygnus.errors.CygnusPersistenceError;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2be3106735d443639045b696f2356b596ef7c0ce"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM1MjczMA==", "bodyText": "Fixed in 5101c07", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396352730", "createdAt": "2020-03-23T10:35:08Z", "author": {"login": "fgalan"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "diffHunk": "@@ -25,9 +25,9 @@\n import com.telefonica.iot.cygnus.errors.CygnusPersistenceError;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNjQ5NA=="}, "originalCommit": {"oid": "2be3106735d443639045b696f2356b596ef7c0ce"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzI4NjA3OnYy", "diffSide": "RIGHT", "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMTo1NDowMlrOF6CFJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxMTozMDo1NlrOF6sCuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM5NTgxNQ==", "bodyText": "\"UTF-8\" should be declared as a String, so that if anytime another content-type is supported it would be easyer to modify it.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396395815", "createdAt": "2020-03-23T11:54:02Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "diffHunk": "@@ -117,10 +117,10 @@ public JsonResponse bulkInsert(String index, String type, List<Map<String, Strin\n                 jsonLines += String.format(\"{\\\"index\\\":{\\\"_id\\\":\\\"%s-%s\\\"}}\\n\", erecvTimeTs, hash);\n                 jsonLines += String.format(\"%s\\n\", edata);\n             } // for\n-            entity = new StringEntity(jsonLines);\n+            entity = new StringEntity(jsonLines, Charset.forName(\"UTF-8\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b225d3a1b09b7bfc6406a1d594d5298d7f248d46"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg0MTgxMA==", "bodyText": "@IvanHdzC Thank you for your advice. That's right, I think. I'll try to get 'content_type' as a configuration parameter.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r396841810", "createdAt": "2020-03-24T00:43:32Z", "author": {"login": "nmatsui"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "diffHunk": "@@ -117,10 +117,10 @@ public JsonResponse bulkInsert(String index, String type, List<Map<String, Strin\n                 jsonLines += String.format(\"{\\\"index\\\":{\\\"_id\\\":\\\"%s-%s\\\"}}\\n\", erecvTimeTs, hash);\n                 jsonLines += String.format(\"%s\\n\", edata);\n             } // for\n-            entity = new StringEntity(jsonLines);\n+            entity = new StringEntity(jsonLines, Charset.forName(\"UTF-8\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM5NTgxNQ=="}, "originalCommit": {"oid": "b225d3a1b09b7bfc6406a1d594d5298d7f248d46"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA4MzMyMA==", "bodyText": "Great! Please don't forget to update your branch.", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1841#discussion_r397083320", "createdAt": "2020-03-24T11:30:56Z", "author": {"login": "IvanHdzC"}, "path": "cygnus-common/src/main/java/com/telefonica/iot/cygnus/backends/elasticsearch/ElasticsearchBackendImpl.java", "diffHunk": "@@ -117,10 +117,10 @@ public JsonResponse bulkInsert(String index, String type, List<Map<String, Strin\n                 jsonLines += String.format(\"{\\\"index\\\":{\\\"_id\\\":\\\"%s-%s\\\"}}\\n\", erecvTimeTs, hash);\n                 jsonLines += String.format(\"%s\\n\", edata);\n             } // for\n-            entity = new StringEntity(jsonLines);\n+            entity = new StringEntity(jsonLines, Charset.forName(\"UTF-8\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM5NTgxNQ=="}, "originalCommit": {"oid": "b225d3a1b09b7bfc6406a1d594d5298d7f248d46"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2434, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}