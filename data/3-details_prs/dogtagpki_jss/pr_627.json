{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3MDg1MzE2", "number": 627, "title": "[v4.7.3] Disable Fallback SCSV and add PHA to legacy SSLSocket", "bodyText": "This PR fixes two additional issues:\n\nWe disable Fallback SCSV. While used by browsers, it isn't present in the cipher suites negotiated by SunJSSE by default. Since we're striving to be compatible with that, drop SCSV.\nAdd PHA to SSLSocket. This addresses the failure in dogtagpki/pki#537 and dogtagpki/pki#543, with one additional patch.\n\n@edewata / @jmagne -- should we make PHA default in the legacy SSLSocket? We added TLSv1.3 support to it a while ago, but TLSv1.3's behavior differs from TLSV1.2's behavior, probably why we had issues with SCSV and TLSv1.2 pinned as maximum in Dogtag PKI. If we enable PHA, TLSv1.2 and TLSv1.3 will mostly be compatible.\nIf so, we could avoid the need for a strict dependency on a newer JSS version.", "createdAt": "2020-09-01T13:33:58Z", "url": "https://github.com/dogtagpki/jss/pull/627", "merged": true, "mergeCommit": {"oid": "7a1d17c39c1393fb7f54c96c75ab292e2f376dd6"}, "closed": true, "closedAt": "2020-09-01T23:42:27Z", "author": {"login": "cipherboy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEmM00AH2gAyNDc3MDg1MzE2OjAwODU4ODNlOTU4Yzk5NGQzNmNjMTY1NDE3YjhhMzg3YmRjNGM3ODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEvUy1gFqTQ4MDE2NTkxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0085883e958c994d36cc165417b8a387bdc4c780", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/0085883e958c994d36cc165417b8a387bdc4c780", "committedDate": "2020-09-01T12:03:20Z", "message": "Disable ENABLE_FALLBACK_SCSV for JCA compatibility\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTc5MDg4", "url": "https://github.com/dogtagpki/jss/pull/627#pullrequestreview-479979088", "createdAt": "2020-09-01T17:45:37Z", "commit": {"oid": "5e206a609e0cfaad649717c38bc8a74833db512a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNzo0NTozOFrOHLBmtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNzo0NTozOFrOHLBmtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMyMjY3OQ==", "bodyText": "This is, can remove this comment.", "url": "https://github.com/dogtagpki/jss/pull/627#discussion_r481322679", "createdAt": "2020-09-01T17:45:38Z", "author": {"login": "cipherboy"}, "path": "org/mozilla/jss/ssl/SocketBase.java", "diffHunk": "@@ -101,9 +101,11 @@ void setProxy(SocketProxy sockProxy) {\n     /* ssl/sslt.h */\n     static final int SSL_Variant_Stream = 33;\n     static final int SSL_Variant_Datagram = 34;\n+    static final int SSL_ENABLE_POST_HANDSHAKE_AUTH = 36;\n \n     static final int SSL_AF_INET = 50;\n     static final int SSL_AF_INET6 = 51;\n+    /* TODO right place? */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e206a609e0cfaad649717c38bc8a74833db512a"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTc5MjM0", "url": "https://github.com/dogtagpki/jss/pull/627#pullrequestreview-479979234", "createdAt": "2020-09-01T17:45:49Z", "commit": {"oid": "5e206a609e0cfaad649717c38bc8a74833db512a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNzo0NTo0OVrOHLBnLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNzo0NTo0OVrOHLBnLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMyMjc5OA==", "bodyText": "Clean up diff.", "url": "https://github.com/dogtagpki/jss/pull/627#discussion_r481322798", "createdAt": "2020-09-01T17:45:49Z", "author": {"login": "cipherboy"}, "path": "org/mozilla/jss/ssl/common.c", "diffHunk": "@@ -422,6 +422,7 @@ PRInt32 JSSL_enums[] = {\n     ssl_variant_stream,           /* 33 */      /* sslt.h */\n     ssl_variant_datagram,         /* 34 */      /* sslt.h */\n     SSL_LIBRARY_VERSION_TLS_1_3,  /* 35 */      /* sslproto.h */\n+    SSL_ENABLE_POST_HANDSHAKE_AUTH,  /* 36 */      /* sslproto.h */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e206a609e0cfaad649717c38bc8a74833db512a"}, "originalPosition": 46}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5e206a609e0cfaad649717c38bc8a74833db512a", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/5e206a609e0cfaad649717c38bc8a74833db512a", "committedDate": "2020-09-01T13:20:15Z", "message": "Add Post-Handshake Auth to legacy SSLSocket\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}, "afterCommit": {"oid": "9e73a76af8d83bad12b489ac240b2ff3e6f233b0", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/9e73a76af8d83bad12b489ac240b2ff3e6f233b0", "committedDate": "2020-09-01T21:38:58Z", "message": "Add Post-Handshake Auth to legacy SSLSocket\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b031fedc2f9a6be1b1033df40b6758d3d0c9883a", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/b031fedc2f9a6be1b1033df40b6758d3d0c9883a", "committedDate": "2020-09-01T21:40:50Z", "message": "Add Post-Handshake Auth to legacy SSLSocket\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9e73a76af8d83bad12b489ac240b2ff3e6f233b0", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/9e73a76af8d83bad12b489ac240b2ff3e6f233b0", "committedDate": "2020-09-01T21:38:58Z", "message": "Add Post-Handshake Auth to legacy SSLSocket\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}, "afterCommit": {"oid": "b031fedc2f9a6be1b1033df40b6758d3d0c9883a", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/b031fedc2f9a6be1b1033df40b6758d3d0c9883a", "committedDate": "2020-09-01T21:40:50Z", "message": "Add Post-Handshake Auth to legacy SSLSocket\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTYyNTU3", "url": "https://github.com/dogtagpki/jss/pull/627#pullrequestreview-480162557", "createdAt": "2020-09-01T22:33:10Z", "commit": {"oid": "b031fedc2f9a6be1b1033df40b6758d3d0c9883a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMjozMzoxMVrOHLKh1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMjozMzoxMVrOHLKh1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ2ODg4NA==", "bodyText": "would it makes sense to just comment this out and give explanation, so later someone who wishes to add this would know why?", "url": "https://github.com/dogtagpki/jss/pull/627#discussion_r481468884", "createdAt": "2020-09-01T22:33:11Z", "author": {"login": "ladycfu"}, "path": "org/mozilla/jss/ssl/javax/JSSEngine.java", "diffHunk": "@@ -945,7 +945,6 @@ public boolean isOutboundDone() {\n         // TLS < 1.3.\n         result.put(SSL.ENABLE_RENEGOTIATION, SSL.RENEGOTIATE_REQUIRES_XTN);\n         result.put(SSL.REQUIRE_SAFE_NEGOTIATION, 1);\n-        result.put(SSL.ENABLE_FALLBACK_SCSV, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b031fedc2f9a6be1b1033df40b6758d3d0c9883a"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTY1MDU1", "url": "https://github.com/dogtagpki/jss/pull/627#pullrequestreview-480165055", "createdAt": "2020-09-01T22:39:12Z", "commit": {"oid": "b031fedc2f9a6be1b1033df40b6758d3d0c9883a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTY1OTE4", "url": "https://github.com/dogtagpki/jss/pull/627#pullrequestreview-480165918", "createdAt": "2020-09-01T22:41:11Z", "commit": {"oid": "b031fedc2f9a6be1b1033df40b6758d3d0c9883a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1456, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}