{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NDExMjg5", "number": 419, "title": "Query and Set Default SSL configuration", "bodyText": "When splitting JSSEngine into an abstract class and a reference implementation (in #150), I've left the SSLFDProxy instance, ssl_fd, in the reference implementation, but moved all the cipher suite configuration to JSSEngine.\nThis resulted in the need to query default configuration, instead of asking ssl_fd how it was configured, though technically this need already existed (as ssl_fd could've been null, which we largely ignored).\nThis introduces wrappers for SSL_CipherPrefSetDefault, SSL_CipherPrefGetDefault, SSL_VersionRangeGetDefault, and SSL_VersionRangeSetDefault.", "createdAt": "2020-03-05T17:37:15Z", "url": "https://github.com/dogtagpki/jss/pull/419", "merged": true, "mergeCommit": {"oid": "56560f0014c3851bd581be24c46eeef7bba82c75"}, "closed": true, "closedAt": "2020-03-05T19:32:31Z", "author": {"login": "cipherboy"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKu_cFgH2gAyMzg0NDExMjg5OmI0OWI5ZjA2YjU4ZDFhNTQ3MWFhZTMyMTI4NTVlYTlhYjRhMGJlYmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKwgHlgBqjMxMDI1NDcyNjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b49b9f06b58d1a5471aae3212855ea9ab4a0bebb", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/b49b9f06b58d1a5471aae3212855ea9ab4a0bebb", "committedDate": "2020-03-05T17:30:15Z", "message": "Add CipherPrefSetDefault, CipherPrefGetDefault\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5ODA4MjM3", "url": "https://github.com/dogtagpki/jss/pull/419#pullrequestreview-369808237", "createdAt": "2020-03-05T18:25:09Z", "commit": {"oid": "b3ed17093950e72941050e3045dd70ef07c37ecf"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxODoyNTowOVrOFye0wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxODozNTo0NVrOFyfK2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ3ODE0NQ==", "bodyText": "Is this the exact length of the current string? I'd give it a larger size (e.g. 200) to accommodate the variables and the possibilities of someone updating the text without updating the buffer size.", "url": "https://github.com/dogtagpki/jss/pull/419#discussion_r388478145", "createdAt": "2020-03-05T18:25:09Z", "author": {"login": "edewata"}, "path": "org/mozilla/jss/nss/SSL.c", "diffHunk": "@@ -278,6 +278,66 @@ Java_org_mozilla_jss_nss_SSL_VersionRangeGet(JNIEnv *env, jclass clazz,\n     return JSS_SSL_wrapVersionRange(env, vrange);\n }\n \n+JNIEXPORT int JNICALL\n+Java_org_mozilla_jss_nss_SSL_VersionRangeSetDefaultNative(JNIEnv *env, jclass clazz,\n+    jint variant_ssl, jint min_ssl, jint max_ssl)\n+{\n+    SSLVersionRange vrange;\n+    SSLProtocolVariant variant;\n+\n+    PR_ASSERT(env != NULL);\n+    PR_SetError(0, 0);\n+\n+    if (min_ssl < 0 || min_ssl >= JSSL_enums_size ||\n+            max_ssl < 0 || max_ssl >= JSSL_enums_size ||\n+            variant_ssl < 0 || variant_ssl >= JSSL_enums_size)\n+    {\n+        char buf[148];\n+        snprintf(buf, 148,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3ed17093950e72941050e3045dd70ef07c37ecf"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ4MjgyMQ==", "bodyText": "If we want to mimic Java Enum style, we probably can add a value() that returns _enum.", "url": "https://github.com/dogtagpki/jss/pull/419#discussion_r388482821", "createdAt": "2020-03-05T18:33:46Z", "author": {"login": "edewata"}, "path": "org/mozilla/jss/ssl/SSLProtocolVariant.java", "diffHunk": "@@ -16,5 +16,5 @@\n \n     private SSLProtocolVariant(int val) { _enum = val; }\n \n-    int getEnum() { return _enum; }\n+    public int getEnum() { return _enum; }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3ed17093950e72941050e3045dd70ef07c37ecf"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ4MzgwMQ==", "bodyText": "Is there any error code/message from NSS that we can include?", "url": "https://github.com/dogtagpki/jss/pull/419#discussion_r388483801", "createdAt": "2020-03-05T18:35:45Z", "author": {"login": "edewata"}, "path": "org/mozilla/jss/nss/SSL.c", "diffHunk": "@@ -192,6 +192,34 @@ Java_org_mozilla_jss_nss_SSL_CipherPrefGet(JNIEnv *env, jclass clazz,\n     return enabled;\n }\n \n+JNIEXPORT int JNICALL\n+Java_org_mozilla_jss_nss_SSL_CipherPrefSetDefault(JNIEnv *env, jclass clazz,\n+    jint cipher, jboolean enabled)\n+{\n+    PR_ASSERT(env != NULL);\n+    PR_SetError(0, 0);\n+\n+    return SSL_CipherPrefSetDefault(cipher, enabled);\n+}\n+\n+JNIEXPORT jboolean JNICALL\n+Java_org_mozilla_jss_nss_SSL_CipherPrefGetDefault(JNIEnv *env, jclass clazz,\n+    jint cipher)\n+{\n+    int enabled = false;\n+\n+    PR_ASSERT(env != NULL);\n+    PR_SetError(0, 0);\n+\n+    if (SSL_CipherPrefGetDefault(cipher, &enabled) != SECSuccess) {\n+        JSS_throwMsg(env, ILLEGAL_ARGUMENT_EXCEPTION,\n+            \"Unknown cipher suite to get or getting its value failed\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b49b9f06b58d1a5471aae3212855ea9ab4a0bebb"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18529ab98b4a5f572ad5e896228c6a77d404396c", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/18529ab98b4a5f572ad5e896228c6a77d404396c", "committedDate": "2020-03-05T19:13:53Z", "message": "Add VersionRangeGetDefault, VersionRangeSetDefault\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3ed17093950e72941050e3045dd70ef07c37ecf", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/b3ed17093950e72941050e3045dd70ef07c37ecf", "committedDate": "2020-03-05T17:30:15Z", "message": "Add VersionRangeGetDefault, VersionRangeSetDefault\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}, "afterCommit": {"oid": "18529ab98b4a5f572ad5e896228c6a77d404396c", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/18529ab98b4a5f572ad5e896228c6a77d404396c", "committedDate": "2020-03-05T19:13:53Z", "message": "Add VersionRangeGetDefault, VersionRangeSetDefault\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1543, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}