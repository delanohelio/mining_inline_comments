{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzODI1NTc3", "number": 369, "title": "Track SSLCipher supported status", "bodyText": "This allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\nWith TLSv1.3, or\nIn FIPS mode, or\nWith RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>\n\n@edewata This doesn't quite bring full crypto-policies compliance, just FIPS compliance. I'm not sure how to do the former.", "createdAt": "2020-01-16T20:14:05Z", "url": "https://github.com/dogtagpki/jss/pull/369", "merged": true, "mergeCommit": {"oid": "0e179095ef931a13b31000d5042d6463d8f63278"}, "closed": true, "closedAt": "2020-01-20T00:18:57Z", "author": {"login": "cipherboy"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6__q3ABqjI5NTU5MjI4NDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8AtpxgBqjI5NjEyNDQ4Njc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c6c897c56e3c583a005366e10b49a1511967db78", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/c6c897c56e3c583a005366e10b49a1511967db78", "committedDate": "2020-01-16T20:11:10Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}, "afterCommit": {"oid": "e981eb1ba55b8f4360dbb7ad10d9fb14318b0542", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/e981eb1ba55b8f4360dbb7ad10d9fb14318b0542", "committedDate": "2020-01-16T20:15:59Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e981eb1ba55b8f4360dbb7ad10d9fb14318b0542", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/e981eb1ba55b8f4360dbb7ad10d9fb14318b0542", "committedDate": "2020-01-16T20:15:59Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}, "afterCommit": {"oid": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "committedDate": "2020-01-16T20:17:42Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NzczODM0", "url": "https://github.com/dogtagpki/jss/pull/369#pullrequestreview-344773834", "createdAt": "2020-01-17T18:51:32Z", "commit": {"oid": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxODo1MTozMlrOFfCE2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxODo1MTo1M1rOFfCFaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA4NDE4NQ==", "bodyText": "Shouldn't that be info.isFIPS != 0?\nThis expression is also a bit hard to read. Could we break it down maybe like this?\nif (info.nonStandard != 0) {\n    // non-standard ciphers are not supported\n    return JNI_FALSE;\n}\nif (info.isFIPS == 0 && PKI_IsFIPS()) {\n    // non-FIPS ciphers are not supported in FIPS mode\n    return JNI_FALSE;\n}\nreturn JNI_TRUE;", "url": "https://github.com/dogtagpki/jss/pull/369#discussion_r368084185", "createdAt": "2020-01-17T18:51:32Z", "author": {"login": "edewata"}, "path": "org/mozilla/jss/ssl/SSLCipher.c", "diffHunk": "@@ -0,0 +1,31 @@\n+#include <nspr.h>\n+#include <nss.h>\n+#include <ssl.h>\n+#include <pk11pub.h>\n+#include <jni.h>\n+\n+#include \"_jni/org_mozilla_jss_ssl_SSLCipher.h\"\n+\n+JNIEXPORT jboolean JNICALL\n+Java_org_mozilla_jss_ssl_SSLCipher_checkSupportedStatus(JNIEnv *env, jclass clazz, jint cipher_suite)\n+{\n+    SSLCipherSuiteInfo info = { 0 };\n+    jboolean found = JNI_FALSE;\n+\n+    for (PRUint16 index = 0; index < SSL_NumImplementedCiphers; index++) {\n+        if (SSL_ImplementedCiphers[index] == cipher_suite) {\n+            found = JNI_TRUE;\n+            break;\n+        }\n+    }\n+\n+    if (found == JNI_FALSE) {\n+        return found;\n+    }\n+\n+    if (SSL_GetCipherSuiteInfo(cipher_suite, &info, sizeof(info)) != SECSuccess || info.length < sizeof(info)) {\n+        return JNI_FALSE;\n+    }\n+\n+    return ((!PK11_IsFIPS() || (info.isFIPS == 0)) && (info.nonStandard == 0)) ? JNI_TRUE : JNI_FALSE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA4NDMzMQ==", "bodyText": "Enums have built-in valueOf() so this method is redundant.\nhttps://www.tutorialspoint.com/java/lang/enum_valueof.htm", "url": "https://github.com/dogtagpki/jss/pull/369#discussion_r368084331", "createdAt": "2020-01-17T18:51:53Z", "author": {"login": "edewata"}, "path": "org/mozilla/jss/ssl/SSLCipher.java", "diffHunk": "@@ -365,10 +379,36 @@ public boolean isECC() {\n         return ecc;\n     }\n \n+    public boolean isTLSv13() {\n+        return tls13;\n+    }\n+\n+    public boolean isSupported() {\n+        return supported;\n+    }\n+\n+    public boolean requiresRSACert() {\n+        return this.name().contains(\"_RSA_\");\n+    }\n+\n+    public boolean requiresECDSACert() {\n+        return this.name().contains(\"_ECDSA_\");\n+    }\n+\n     public static SSLCipher valueOf(int id) {\n         for (SSLCipher cipher : SSLCipher.class.getEnumConstants()) {\n             if (cipher.id == id) return cipher;\n         }\n         return null;\n     }\n+\n+    public static SSLCipher fromName(String name) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f"}, "originalPosition": 68}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "committedDate": "2020-01-19T23:39:57Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "committedDate": "2020-01-16T20:17:42Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}, "afterCommit": {"oid": "5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "author": {"user": {"login": "cipherboy", "name": "Alexander Scheel"}}, "url": "https://github.com/dogtagpki/jss/commit/5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "committedDate": "2020-01-19T23:39:57Z", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1599, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}