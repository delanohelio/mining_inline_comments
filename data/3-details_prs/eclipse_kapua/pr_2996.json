{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3OTM4MjIy", "number": 2996, "title": "Enabling property to disable the OpenID Connect logout", "bodyText": "Added a property to disable the OpenID Connect logout.\nRelated Issue\nN/A\nDescription of the solution adopted\nThe OpenID Connect logout can be disabled by setting the console.sso.openid.logout.enabled property to false. This property is always true by default.\nIf the OpenID logout is disabled, the user is allowed to login again into the Kapua Console without the need to provide any credentials.\nScreenshots\nN/A\nAny side note on the changes made\nThis feature is implemented directly inside the getSsoLogoutUri method of the GwtSettingsServiceImpl class. If the property is false, an empty string (URL) will be returned to the console on the browser side, and the call to the logout endpoint won't be performed. This simple approach has been preferred to the use of a dedicated callback, in order to avoid having too many nested callbacks.", "createdAt": "2020-06-04T15:59:50Z", "url": "https://github.com/eclipse/kapua/pull/2996", "merged": true, "mergeCommit": {"oid": "f8261e772596d4a42449814325d02a822d589ffb"}, "closed": true, "closedAt": "2020-06-10T11:57:13Z", "author": {"login": "gbarbon"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn_4FAAH2gAyNDI3OTM4MjIyOmFiOWYwMGEwMjczMDg1N2RjMzQ2YjY3ZTI4ZTFlZDc3NjliZjQyYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp3lOegFqTQyNzk0Mzg0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac", "author": {"user": {"login": "gbarbon", "name": "Gianluca Barbon"}}, "url": "https://github.com/eclipse/kapua/commit/ab9f00a02730857dc346b67e28e1ed7769bf42ac", "committedDate": "2020-06-04T15:34:24Z", "message": "Enabling property to disable the OpenID Connect logout\n\nSigned-off-by: Gianluca Barbon <gianluca.barbon@eurotech.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODUyNzc5", "url": "https://github.com/eclipse/kapua/pull/2996#pullrequestreview-427852779", "createdAt": "2020-06-10T08:57:31Z", "commit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODUzODMw", "url": "https://github.com/eclipse/kapua/pull/2996#pullrequestreview-427853830", "createdAt": "2020-06-10T08:58:44Z", "commit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODo1ODo0NFrOGhrnIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODo1ODo0NFrOGhrnIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3MDcyMA==", "bodyText": "Can you please change the header to \"2020\"? I hope I am not too late \ud83d\ude04", "url": "https://github.com/eclipse/kapua/pull/2996#discussion_r437970720", "createdAt": "2020-06-10T08:58:44Z", "author": {"login": "LeoNerdoG"}, "path": "console/core/src/main/java/org/eclipse/kapua/app/console/core/client/KapuaCloudConsole.java", "diffHunk": "@@ -446,18 +446,23 @@ public void onFailure(Throwable caught) {\n \n                     @Override\n                     public void onSuccess(final String result) {\n-                        logger.info(\"Waiting for logout.\");\n-\n-                        // this timer is needed to give time to the ConsoleInfo.display method (called above) to show\n-                        // the message to the user (otherwise the Window.location.assign would reload the page,\n-                        // giving no time to the user to read the message).\n-                        Timer timer = new Timer() {\n-                            @Override\n-                            public void run() {\n-                                Window.Location.assign(result);\n-                            }\n-                        };\n-                        timer.schedule(SSO_FAILURE_WAIT_TIME);\n+                        if (!result.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3ODU0MjAx", "url": "https://github.com/eclipse/kapua/pull/2996#pullrequestreview-427854201", "createdAt": "2020-06-10T08:59:11Z", "commit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODo1OToxMVrOGhroLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwODo1OToyNFrOGhrosg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3MDk5MA==", "bodyText": "Can you please change the header to \"2020\"? I hope I am not too late \ud83d\ude04", "url": "https://github.com/eclipse/kapua/pull/2996#discussion_r437970990", "createdAt": "2020-06-10T08:59:11Z", "author": {"login": "LeoNerdoG"}, "path": "console/core/src/main/java/org/eclipse/kapua/app/console/core/server/GwtSettingsServiceImpl.java", "diffHunk": "@@ -52,8 +52,11 @@ public String getSsoLoginUri() throws GwtKapuaException {\n     @Override\n     public String getSsoLogoutUri(String ssoIdToken) throws GwtKapuaException {\n         try {\n-            return SsoLocator.getLocator(this).getService().getLogoutUri(ssoIdToken,\n-                    URI.create(SsoHelper.getHomeUri()), UUID.randomUUID().toString());\n+            if (SETTINGS.getBoolean(ConsoleSettingKeys.SSO_OPENID_LOGOUT_ENABLED, true)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3MTAyMw==", "bodyText": "Can you please change the header to \"2020\"? I hope I am not too late \ud83d\ude04", "url": "https://github.com/eclipse/kapua/pull/2996#discussion_r437971023", "createdAt": "2020-06-10T08:59:14Z", "author": {"login": "LeoNerdoG"}, "path": "console/core/src/main/java/org/eclipse/kapua/app/console/core/client/NorthView.java", "diffHunk": "@@ -197,16 +197,21 @@ public void onSuccess(Void arg0) {\n                                     gwtSettingService.getSsoLogoutUri(currentSession.getSsoIdToken(),\n                                             new AsyncCallback<String>() {\n \n-                                        @Override\n-                                        public void onFailure(Throwable caught) {\n-                                            FailureHandler.handle(caught);\n-                                        }\n-\n-                                        @Override\n-                                        public void onSuccess(String result) {\n-                                            Window.Location.assign(result);\n-                                        }\n-                                    });\n+                                                @Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk3MTEyMg==", "bodyText": "Can you please change the header to \"2020\"? I hope I am not too late \ud83d\ude04", "url": "https://github.com/eclipse/kapua/pull/2996#discussion_r437971122", "createdAt": "2020-06-10T08:59:24Z", "author": {"login": "LeoNerdoG"}, "path": "console/module/api/src/main/java/org/eclipse/kapua/app/console/module/api/setting/ConsoleSettingKeys.java", "diffHunk": "@@ -39,6 +39,7 @@\n \n     SSO_REDIRECT_URI(\"console.sso.redirect.uri\"), //\n     SSO_CONSOLE_HOME_URI(\"console.sso.home.uri\"), //\n+    SSO_OPENID_LOGOUT_ENABLED(\"console.sso.openid.logout.enabled\"), //", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab9f00a02730857dc346b67e28e1ed7769bf42ac"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79a49f4222de024085e93f8113a499ed9097bb02", "author": {"user": {"login": "gbarbon", "name": "Gianluca Barbon"}}, "url": "https://github.com/eclipse/kapua/commit/79a49f4222de024085e93f8113a499ed9097bb02", "committedDate": "2020-06-10T09:13:14Z", "message": "Updated headers\n\nSigned-off-by: Gianluca Barbon <gianluca.barbon@eurotech.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3OTE2NDAy", "url": "https://github.com/eclipse/kapua/pull/2996#pullrequestreview-427916402", "createdAt": "2020-06-10T10:20:35Z", "commit": {"oid": "79a49f4222de024085e93f8113a499ed9097bb02"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3OTQzODQ3", "url": "https://github.com/eclipse/kapua/pull/2996#pullrequestreview-427943847", "createdAt": "2020-06-10T11:02:25Z", "commit": {"oid": "79a49f4222de024085e93f8113a499ed9097bb02"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 180, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}