{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwMDgxODUx", "number": 1427, "title": "Fix warnings", "bodyText": "Changes within this PR are Sorted by Commit, each Commit addresses one category of Warning.\nStill left to do\n[] RawTypes\n[] CollectionUndefinedEquality\n[] LoggerEnclosingClass\n... some others", "createdAt": "2020-09-04T20:46:13Z", "url": "https://github.com/apache/iceberg/pull/1427", "merged": true, "mergeCommit": {"oid": "96959ece9faeb795757388908274cfd0ff1856ca"}, "closed": true, "closedAt": "2020-09-22T22:35:35Z", "author": {"login": "RussellSpitzer"}, "timelineItems": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFrfKqgBqjM3MzE1MTg2NzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLe6b_gFqTQ5Mzg2MTc3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf07fea1f47afaa7ff3bc5e7fc019f8b283c7fe5", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/bf07fea1f47afaa7ff3bc5e7fc019f8b283c7fe5", "committedDate": "2020-09-04T20:43:48Z", "message": "Fix Short Circut Boolean"}, "afterCommit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9", "committedDate": "2020-09-04T20:46:41Z", "message": "Fix Short Circut Boolean"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMxNjE1", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482931615", "createdAt": "2020-09-04T20:48:08Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODowOFrOHNbHmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODowOFrOHNbHmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzNzg1MA==", "bodyText": "Required for the FormatString Annotation", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483837850", "createdAt": "2020-09-04T20:48:08Z", "author": {"login": "RussellSpitzer"}, "path": "build.gradle", "diffHunk": "@@ -174,6 +174,7 @@ project(':iceberg-bundled-guava') {\n project(':iceberg-api') {\n   dependencies {\n     compile project(path: ':iceberg-bundled-guava', configuration: 'shadow')\n+    compileOnly \"com.google.errorprone:error_prone_annotations:2.3.3\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMxNzUy", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482931752", "createdAt": "2020-09-04T20:48:29Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODoyOVrOHNbIBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODoyOVrOHNbIBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzNzk1Nw==", "bodyText": "Previous Usage was Broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483837957", "createdAt": "2020-09-04T20:48:29Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/DeleteFileIndex.java", "diffHunk": "@@ -361,7 +361,7 @@ DeleteFileIndex build() {\n                 deleteEntries.add(entry.copy());\n               }\n             } catch (IOException e) {\n-              throw new RuntimeIOException(\"Failed to close\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMxNzkz", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482931793", "createdAt": "2020-09-04T20:48:36Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODozNlrOHNbIIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODozNlrOHNbIIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzNzk4NA==", "bodyText": "Previous Usage was Broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483837984", "createdAt": "2020-09-04T20:48:36Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/ManifestFilterManager.java", "diffHunk": "@@ -300,7 +300,7 @@ private ManifestFile filterManifest(StrictMetricsEvaluator metricsEvaluator, Man\n       return filterManifestWithDeletedFiles(metricsEvaluator, manifest, reader);\n \n     } catch (IOException e) {\n-      throw new RuntimeIOException(\"Failed to close manifest: \" + manifest, e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMyMTcx", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482932171", "createdAt": "2020-09-04T20:49:28Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0OToyOFrOHNbJSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0OToyOFrOHNbJSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzODI4Mg==", "bodyText": "Previous usage was broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483838282", "createdAt": "2020-09-04T20:49:28Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/ManifestFilterManager.java", "diffHunk": "@@ -422,7 +422,7 @@ private ManifestFile filterManifestWithDeletedFiles(\n       return filtered;\n \n     } catch (IOException e) {\n-      throw new RuntimeIOException(\"Failed to close manifest writer\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMyMjk2", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482932296", "createdAt": "2020-09-04T20:49:45Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0OTo0NlrOHNbJrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0OTo0NlrOHNbJrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzODM4Mw==", "bodyText": "Previous usage was broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483838383", "createdAt": "2020-09-04T20:49:46Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/ManifestMergeManager.java", "diffHunk": "@@ -172,7 +172,7 @@ private ManifestFile createManifest(int specId, List<ManifestFile> bin) {\n             }\n           }\n         } catch (IOException e) {\n-          throw new RuntimeIOException(\"Failed to close manifest reader\", e);\n+          throw new RuntimeIOException(e, \"Failed to close manifest reader\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMyMzgy", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482932382", "createdAt": "2020-09-04T20:49:58Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0OTo1OFrOHNbKAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0OTo1OFrOHNbKAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzODQ2NQ==", "bodyText": "Previous usage was broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483838465", "createdAt": "2020-09-04T20:49:58Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java", "diffHunk": "@@ -327,7 +327,7 @@ private ManifestFile newFilesAsManifest() {\n         this.cachedNewManifest = writer.toManifestFile();\n         this.hasNewFiles = false;\n       } catch (IOException e) {\n-        throw new RuntimeIOException(\"Failed to close manifest writer\", e);\n+        throw new RuntimeIOException(e, \"Failed to close manifest writer\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMyNTQx", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482932541", "createdAt": "2020-09-04T20:50:20Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1MDoyMFrOHNbKhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1MDoyMFrOHNbKhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzODU5Nw==", "bodyText": "Previous usage was broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483838597", "createdAt": "2020-09-04T20:50:20Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java", "diffHunk": "@@ -360,7 +360,7 @@ private ManifestFile newDeleteFilesAsManifest() {\n         this.cachedNewDeleteManifest = writer.toManifestFile();\n         this.hasNewDeleteFiles = false;\n       } catch (IOException e) {\n-        throw new RuntimeIOException(\"Failed to close manifest writer\", e);\n+        throw new RuntimeIOException(e, \"Failed to close manifest writer\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMzOTA0", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482933904", "createdAt": "2020-09-04T20:53:38Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1MzozOVrOHNbO0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1MzozOVrOHNbO0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzOTY5OQ==", "bodyText": "Previous usage was broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483839699", "createdAt": "2020-09-04T20:53:39Z", "author": {"login": "RussellSpitzer"}, "path": "core/src/main/java/org/apache/iceberg/util/Exceptions.java", "diffHunk": "@@ -32,7 +32,7 @@ public static void close(Closeable closeable, boolean suppressExceptions) {\n       closeable.close();\n     } catch (IOException e) {\n       if (!suppressExceptions) {\n-        throw new RuntimeIOException(\"Failed calling close\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTMzOTg3", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482933987", "createdAt": "2020-09-04T20:53:51Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1Mzo1MVrOHNbPDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1Mzo1MVrOHNbPDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzOTc1OA==", "bodyText": "Previous usage was broken", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483839758", "createdAt": "2020-09-04T20:53:51Z", "author": {"login": "RussellSpitzer"}, "path": "hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java", "diffHunk": "@@ -277,7 +277,7 @@ public boolean dropNamespace(Namespace namespace) {\n       return true;\n \n     } catch (InvalidOperationException e) {\n-      throw new NamespaceNotEmptyException(\"Namespace \" + namespace + \" is not empty. One or more tables exist.\", e);\n+      throw new NamespaceNotEmptyException(e, \"Namespace %s is not empty. One or more tables exist.\", namespace);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTM0ODAw", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482934800", "createdAt": "2020-09-04T20:55:54Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1NTo1NFrOHNbRuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1NTo1NFrOHNbRuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDQ0Mw==", "bodyText": "FormatMethod needs all variables to be effectively final. We do a lot of casting here which maybe screws up error-prone's analysis because we don't actually change anything here but ErrorProne still complains. Declaring everything final fixes it.", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483840443", "createdAt": "2020-09-04T20:55:54Z", "author": {"login": "RussellSpitzer"}, "path": "spark/src/main/java/org/apache/iceberg/spark/SparkExceptionUtil.java", "diffHunk": "@@ -39,7 +40,9 @@ private SparkExceptionUtil() {\n    * @param args format specifiers\n    * @return unchecked exception.\n    */\n-  public static RuntimeException toUncheckedException(Throwable cause, String message, Object... args) {\n+  @FormatMethod\n+  public static RuntimeException toUncheckedException(final Throwable cause, final String message,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTM1MzQ1", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-482935345", "createdAt": "2020-09-04T20:57:10Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1NzoxMFrOHNbTcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo1NzoxMFrOHNbTcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDg4Mw==", "bodyText": "Format Method allows for a compile time check that the format strings being used in String.Format are actually valid given the number of arguments passed to the method. This helps eliminate ignored variables or under-defined strings at compile time.", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483840883", "createdAt": "2020-09-04T20:57:10Z", "author": {"login": "RussellSpitzer"}, "path": "api/src/main/java/org/apache/iceberg/exceptions/AlreadyExistsException.java", "diffHunk": "@@ -19,14 +19,18 @@\n \n package org.apache.iceberg.exceptions;\n \n+import com.google.errorprone.annotations.FormatMethod;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMDM1NDg2", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-483035486", "createdAt": "2020-09-05T06:41:01Z", "commit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwNjo0MTowMVrOHNgD9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwNjo1MTowNlrOHNgG4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkxODgzNw==", "bodyText": "Why is this better?", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483918837", "createdAt": "2020-09-05T06:41:01Z", "author": {"login": "jzhuge"}, "path": "api/src/main/java/org/apache/iceberg/Files.java", "diffHunk": "@@ -76,7 +75,7 @@ public PositionOutputStream create() {\n     public PositionOutputStream createOrOverwrite() {\n       if (file.exists()) {\n         if (!file.delete()) {\n-          throw new RuntimeIOException(\"Failed to delete: \" + file);\n+          throw new RuntimeIOException(\"Failed to delete: %s\", file);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkxOTQwOA==", "bodyText": "Since RuntimeIOException is deprecated and you are touching this code, why not replace it?", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483919408", "createdAt": "2020-09-05T06:48:57Z", "author": {"login": "jzhuge"}, "path": "api/src/main/java/org/apache/iceberg/Files.java", "diffHunk": "@@ -60,9 +60,8 @@ public PositionOutputStream create() {\n \n       if (!file.getParentFile().isDirectory() && !file.getParentFile().mkdirs()) {\n         throw new RuntimeIOException(\n-            String.format(\n                 \"Failed to create the file's directory at %s.\",\n-                file.getParentFile().getAbsolutePath()));\n+                file.getParentFile().getAbsolutePath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkxOTU4NQ==", "bodyText": "Was there any discussion to turn on errorprone or spotbug in gradle?\nYour effort here will make it easier to turn it on.", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483919585", "createdAt": "2020-09-05T06:51:06Z", "author": {"login": "jzhuge"}, "path": "build.gradle", "diffHunk": "@@ -174,6 +174,7 @@ project(':iceberg-bundled-guava') {\n project(':iceberg-api') {\n   dependencies {\n     compile project(path: ':iceberg-bundled-guava', configuration: 'shadow')\n+    compileOnly \"com.google.errorprone:error_prone_annotations:2.3.3\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzNzg1MA=="}, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMDM2NTky", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-483036592", "createdAt": "2020-09-05T07:04:53Z", "commit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMDQzMDI5", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-483043029", "createdAt": "2020-09-05T09:13:41Z", "commit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwOToxMzo0MVrOHNgzfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwOToxMzo0MVrOHNgzfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkzMTAwNw==", "bodyText": "Forgive me if this is a silly question, as I am more of a scala developer traditionally and it's been a long day.\nDoes this change the semantics? Previously it was calling the dataManifests method of each value in the iterable. And I notice later on there's a call to this::isNamespace (so it seems possible to use a method reference to identify a particular instance, though that might be a special case for this). Is the method reference usage here expected to be called in a static fashion (the interface doesn't declare the method as static) or will it be called on each instance of the iterable? I only ask because BaseSnapshot#dataManifests is a potentially side-effecting function.\nBut again, I might just be working too late with too much Scala in the brain, so forgive me if I've just not brushed up on my Java lately. My brain is really trying to insert flatMap and several _ for args here so I could very well just need to brush up on my Java. \ud83d\ude05", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483931007", "createdAt": "2020-09-05T09:13:41Z", "author": {"login": "kbendick"}, "path": "core/src/main/java/org/apache/iceberg/IncrementalDataTableScan.java", "diffHunk": "@@ -74,7 +74,7 @@ public TableScan appendsAfter(long newFromSnapshotId) {\n     Set<Long> snapshotIds = Sets.newHashSet(Iterables.transform(snapshots, Snapshot::snapshotId));\n     Set<ManifestFile> manifests = FluentIterable\n         .from(snapshots)\n-        .transformAndConcat(s -> s.dataManifests())\n+        .transformAndConcat(Snapshot::dataManifests)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMDQzMjE3", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-483043217", "createdAt": "2020-09-05T09:17:43Z", "commit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwOToxNzo0M1rOHNg0uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwOToxNzo0M1rOHNg0uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkzMTMyMw==", "bodyText": "Brilliant. If we're going to consider enabling any more required rules, can something be done to better lint usages of boolean && vs the bit operation? I imagine there's a rule for disallow implicit integer type conversions to boolean or better yet to disallow bitwise operator in an if statement or the like? That could be handled in a separate PR / issue (I'd be happy to look into it if you don't know off the top of your head).", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r483931323", "createdAt": "2020-09-05T09:17:43Z", "author": {"login": "kbendick"}, "path": "core/src/main/java/org/apache/iceberg/hadoop/HadoopTables.java", "diffHunk": "@@ -102,7 +102,7 @@ public Table load(String location) {\n    */\n   private Pair<String, MetadataTableType> parseMetadataType(String location) {\n     int hashIndex = location.lastIndexOf('#');\n-    if (hashIndex != -1 & !location.endsWith(\"#\")) {\n+    if (hashIndex != -1 && !location.endsWith(\"#\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMDQzNDMy", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-483043432", "createdAt": "2020-09-05T09:22:17Z", "commit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MjA0MjU4", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-485204258", "createdAt": "2020-09-09T16:39:50Z", "commit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjozOTo1MFrOHPQgdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjozOTo1MFrOHPQgdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc2MTE0Mw==", "bodyText": "Was this meant to be id or ID?", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r485761143", "createdAt": "2020-09-09T16:39:50Z", "author": {"login": "fbocse"}, "path": "api/src/main/java/org/apache/iceberg/HistoryEntry.java", "diffHunk": "@@ -29,12 +29,12 @@\n  */\n public interface HistoryEntry extends Serializable {\n   /**\n-   * @return the timestamp in milliseconds of the change\n+   * Returns the timestamp in milliseconds of the change.\n    */\n   long timestampMillis();\n \n   /**\n-   * @return ID of the new current snapshot\n+   * Returns iD of the new current snapshot.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e4929efe64d7bb1ef4d3b75afed2c32e0aa70c9"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MjY0NjAz", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-487264603", "createdAt": "2020-09-13T00:22:04Z", "commit": {"oid": "3383f997148a06d7783d3fe79bb77f48199b40b9"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QwMDoyMjowNVrOHQ4YEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QwMDozMjoxNVrOHQ4bFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ2MjkzMA==", "bodyText": "Question: is this something that we should shade (possibly in a follow up PR)? I know that normally we shade thing like guava etc that the user might have on their classpath. Is it reasonable to expect that behavior here?\nI don't think this needs to be addressed in this PR, but something that crossed my mind as I'm re-reviewing this.", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r487462930", "createdAt": "2020-09-13T00:22:05Z", "author": {"login": "kbendick"}, "path": "api/src/main/java/org/apache/iceberg/exceptions/AlreadyExistsException.java", "diffHunk": "@@ -19,14 +19,18 @@\n \n package org.apache.iceberg.exceptions;\n \n+import com.google.errorprone.annotations.FormatMethod;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDg4Mw=="}, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ2MzMxNg==", "bodyText": "So looking at the definition of the literal() function in this class, it seems it's possible for it to return null.\nI guess it's not a concern as we would get NPE on the above call at line 136 when trying to call .to if literal() returned null before even getting to this part that calls literal().value(), but something I thought I'd bring up. Perhaps something we might follow up on in another issue or possibly I just missed the workflow that makes literal()'s result non-null by the time this bindLiteralOperration is called.", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r487463316", "createdAt": "2020-09-13T00:26:58Z", "author": {"login": "kbendick"}, "path": "api/src/main/java/org/apache/iceberg/expressions/UnboundPredicate.java", "diffHunk": "@@ -136,9 +136,8 @@ private Expression bindLiteralOperation(BoundTerm<T> boundTerm) {\n     Literal<T> lit = literal().to(boundTerm.type());\n \n     if (lit == null) {\n-      throw new ValidationException(String.format(\n-          \"Invalid value for conversion to type %s: %s (%s)\",\n-          boundTerm.type(), literal().value(), literal().value().getClass().getName()));\n+      throw new ValidationException(\"Invalid value for conversion to type %s: %s (%s)\",\n+          boundTerm.type(), literal().value(), literal().value().getClass().getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3383f997148a06d7783d3fe79bb77f48199b40b9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ2MzQ3Nw==", "bodyText": "Oh. Actually upon further inspection I can see that this function bindLiterralOperation is only called once in this class (and in the entire code base currently) and there's a null check prior to calling it. So shouldn't be a concern at the moment \ud83d\udc4d", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r487463477", "createdAt": "2020-09-13T00:29:34Z", "author": {"login": "kbendick"}, "path": "api/src/main/java/org/apache/iceberg/exceptions/AlreadyExistsException.java", "diffHunk": "@@ -19,14 +19,18 @@\n \n package org.apache.iceberg.exceptions;\n \n+import com.google.errorprone.annotations.FormatMethod;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDg4Mw=="}, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQ2MzcwMg==", "bodyText": "Hooray for compile time safety! My inner scala developer is pleased. \ud83d\ude00", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r487463702", "createdAt": "2020-09-13T00:32:15Z", "author": {"login": "kbendick"}, "path": "hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java", "diffHunk": "@@ -277,7 +277,7 @@ public boolean dropNamespace(Namespace namespace) {\n       return true;\n \n     } catch (InvalidOperationException e) {\n-      throw new NamespaceNotEmptyException(\"Namespace \" + namespace + \" is not empty. One or more tables exist.\", e);\n+      throw new NamespaceNotEmptyException(e, \"Namespace %s is not empty. One or more tables exist.\", namespace);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzOTc1OA=="}, "originalCommit": {"oid": "2e7d38543ae3b30ad6293aaae3301cb34dce3483"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3383f997148a06d7783d3fe79bb77f48199b40b9", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/3383f997148a06d7783d3fe79bb77f48199b40b9", "committedDate": "2020-09-10T14:40:16Z", "message": "Fix Capitilization of iD in HistoryEntry"}, "afterCommit": {"oid": "315de0d0efa561cecb7d5eefdd6ea8098096ee91", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/315de0d0efa561cecb7d5eefdd6ea8098096ee91", "committedDate": "2020-09-16T16:56:46Z", "message": "Fix more Javadoc Issues added after rebase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzODIwNzA3", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-493820707", "createdAt": "2020-09-22T20:28:03Z", "commit": {"oid": "315de0d0efa561cecb7d5eefdd6ea8098096ee91"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQyMDoyODowM1rOHWLI9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQyMDoyODowM1rOHWLI9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAxMzIzNg==", "bodyText": "nit: . at the end?", "url": "https://github.com/apache/iceberg/pull/1427#discussion_r493013236", "createdAt": "2020-09-22T20:28:03Z", "author": {"login": "aokolnychyi"}, "path": "api/src/main/java/org/apache/iceberg/PartitionSpec.java", "diffHunk": "@@ -101,6 +101,8 @@ int lastAssignedFieldId() {\n   }\n \n   /**\n+   * Returns the {@link PartitionField field} that partitions the given source field", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "315de0d0efa561cecb7d5eefdd6ea8098096ee91"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28797cf7a516e16aa1ff526a6be7051c5427ae42", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/28797cf7a516e16aa1ff526a6be7051c5427ae42", "committedDate": "2020-09-22T20:53:53Z", "message": "Fix all of the Javadoc Summary Missing Warnings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "420bb13ac6ab82ec9d15d858174c036bc43cab15", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/420bb13ac6ab82ec9d15d858174c036bc43cab15", "committedDate": "2020-09-22T20:53:53Z", "message": "Remove check for FinalClass\n\nThis warns on all classes that have only private constructors but\ndo not declare themselves final. This doesn't provide a lot of\nbenefit to iceberg so the check is disabled."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cde46048a62323ba0c301a0df1d523f28f17888", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/3cde46048a62323ba0c301a0df1d523f28f17888", "committedDate": "2020-09-22T20:53:53Z", "message": "Fix misnamed variable in javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cb41cd2784cc8671190b349b21a2035e76c909f", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/4cb41cd2784cc8671190b349b21a2035e76c909f", "committedDate": "2020-09-22T20:53:53Z", "message": "Fixes Various String Formatting Issues\n\nImplements Error-prones FormatMethod compile time exception checking. This\ndiscovered several errors in our usage of String.Format and methods which\nmimic it's behavior."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "611b90640d3f6de7b760c8fa74aaed56043ead95", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/611b90640d3f6de7b760c8fa74aaed56043ead95", "committedDate": "2020-09-22T20:53:53Z", "message": "Replace Uncessary Lambdas"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfa070756a02fecb1f0e647e13d8d041e06dc9b9", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/bfa070756a02fecb1f0e647e13d8d041e06dc9b9", "committedDate": "2020-09-22T20:53:53Z", "message": "Use Collection.forEach instead of Collection.stream.foreach"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1b1ca98651f610573cdfa57f4f01455a2c6d3cf", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/a1b1ca98651f610573cdfa57f4f01455a2c6d3cf", "committedDate": "2020-09-22T20:53:53Z", "message": "Fix Short Circut Boolean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b7c10ace232f772506ec6b978c63eb437fbfab7", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/7b7c10ace232f772506ec6b978c63eb437fbfab7", "committedDate": "2020-09-22T20:53:53Z", "message": "Fix Capitilization of iD in HistoryEntry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4f8f63bb9106474b4d29171ebc4df4c38d9c555", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/d4f8f63bb9106474b4d29171ebc4df4c38d9c555", "committedDate": "2020-09-22T20:53:53Z", "message": "Fix After Rebase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d18a63a7a7f2a29e17f21938bd1fe5f0393e744e", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/d18a63a7a7f2a29e17f21938bd1fe5f0393e744e", "committedDate": "2020-09-22T20:53:53Z", "message": "Ignore RawTypes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aeceddf5aac9db797a5c842d6131741fe19c4817", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/aeceddf5aac9db797a5c842d6131741fe19c4817", "committedDate": "2020-09-22T20:53:53Z", "message": "Fix more Javadoc Issues added after rebase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b095cb7785e8ee1ee05a6673205a80f328ca282c", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/b095cb7785e8ee1ee05a6673205a80f328ca282c", "committedDate": "2020-09-22T21:25:58Z", "message": "Rebase and fix a few additional JavaDoc Errors"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "315de0d0efa561cecb7d5eefdd6ea8098096ee91", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/315de0d0efa561cecb7d5eefdd6ea8098096ee91", "committedDate": "2020-09-16T16:56:46Z", "message": "Fix more Javadoc Issues added after rebase"}, "afterCommit": {"oid": "b095cb7785e8ee1ee05a6673205a80f328ca282c", "author": {"user": {"login": "RussellSpitzer", "name": "Russell Spitzer"}}, "url": "https://github.com/apache/iceberg/commit/b095cb7785e8ee1ee05a6673205a80f328ca282c", "committedDate": "2020-09-22T21:25:58Z", "message": "Rebase and fix a few additional JavaDoc Errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzODYxNzc3", "url": "https://github.com/apache/iceberg/pull/1427#pullrequestreview-493861777", "createdAt": "2020-09-22T21:31:23Z", "commit": {"oid": "b095cb7785e8ee1ee05a6673205a80f328ca282c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4177, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}