{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0OTA2MDU5", "number": 1395, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxOTo1NjoyNFrOEdXexQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMDozMTo1OFrOEdYLQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjI4ODY5OnYy", "diffSide": "RIGHT", "path": "spark/src/test/java/org/apache/iceberg/actions/TestExpireSnapshotsAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxOTo1NjoyNFrOHIfIlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMDowNDozMVrOHIfYVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2MDc1Ng==", "bodyText": "nit: I think it should be 4 spaces for continued indentation. Applies to the whole test.", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478660756", "createdAt": "2020-08-27T19:56:24Z", "author": {"login": "aokolnychyi"}, "path": "spark/src/test/java/org/apache/iceberg/actions/TestExpireSnapshotsAction.java", "diffHunk": "@@ -1008,4 +1008,37 @@ public void testExpireAction() {\n     Assert.assertSame(\"Multiple calls to expire should return the same deleted files\",\n         pendingDeletes, action.expire());\n   }\n+\n+  @Test\n+  public void testUseLocalIterator() {\n+    table.newFastAppend()\n+            .appendFile(FILE_A)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67176fe5dc103ac785c9aa5530662696f95fc00a"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2NDc4OA==", "bodyText": "Got it!", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478664788", "createdAt": "2020-08-27T20:04:31Z", "author": {"login": "RussellSpitzer"}, "path": "spark/src/test/java/org/apache/iceberg/actions/TestExpireSnapshotsAction.java", "diffHunk": "@@ -1008,4 +1008,37 @@ public void testExpireAction() {\n     Assert.assertSame(\"Multiple calls to expire should return the same deleted files\",\n         pendingDeletes, action.expire());\n   }\n+\n+  @Test\n+  public void testUseLocalIterator() {\n+    table.newFastAppend()\n+            .appendFile(FILE_A)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2MDc1Ng=="}, "originalCommit": {"oid": "67176fe5dc103ac785c9aa5530662696f95fc00a"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjI5MTA1OnYy", "diffSide": "RIGHT", "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxOTo1NzoxMFrOHIfKCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxOTo1NzoxMFrOHIfKCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2MTEzMA==", "bodyText": "nit: to use stream -> to stream", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478661130", "createdAt": "2020-08-27T19:57:10Z", "author": {"login": "aokolnychyi"}, "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "diffHunk": "@@ -90,6 +91,19 @@ protected Table table() {\n     return table;\n   }\n \n+  /**\n+   * Whether or not to use stream the expired file list to the driver. The default (false) will use", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67176fe5dc103ac785c9aa5530662696f95fc00a"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjMwMTY2OnYy", "diffSide": "RIGHT", "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMDowMDozNFrOHIfQnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMDowNDo0OVrOHIfY4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2MjgxMw==", "bodyText": "What about this? By default, all files to delete are brought to the driver at once which may be an issue with very long file lists. Set this to true to use {@link Dataset#toLocalIterator()} if you are running into memory issues when collecting the list of files to be deleted.", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478662813", "createdAt": "2020-08-27T20:00:34Z", "author": {"login": "aokolnychyi"}, "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "diffHunk": "@@ -90,6 +91,19 @@ protected Table table() {\n     return table;\n   }\n \n+  /**\n+   * Whether or not to use stream the expired file list to the driver. The default (false) will use\n+   * collect to bring back all results to the driver at once which may be an issue with very long file lists.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67176fe5dc103ac785c9aa5530662696f95fc00a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2NDg3OQ==", "bodyText": "Sgtm", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478664879", "createdAt": "2020-08-27T20:04:42Z", "author": {"login": "RussellSpitzer"}, "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "diffHunk": "@@ -90,6 +91,19 @@ protected Table table() {\n     return table;\n   }\n \n+  /**\n+   * Whether or not to use stream the expired file list to the driver. The default (false) will use\n+   * collect to bring back all results to the driver at once which may be an issue with very long file lists.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2MjgxMw=="}, "originalCommit": {"oid": "67176fe5dc103ac785c9aa5530662696f95fc00a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2NDkzMQ==", "bodyText": "Sounds good to me, except that it creates a dead link because Dataset#toLocalIterator is not in Iceberg Javadoc.", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478664931", "createdAt": "2020-08-27T20:04:49Z", "author": {"login": "rdblue"}, "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "diffHunk": "@@ -90,6 +91,19 @@ protected Table table() {\n     return table;\n   }\n \n+  /**\n+   * Whether or not to use stream the expired file list to the driver. The default (false) will use\n+   * collect to bring back all results to the driver at once which may be an issue with very long file lists.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY2MjgxMw=="}, "originalCommit": {"oid": "67176fe5dc103ac785c9aa5530662696f95fc00a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjQwMjU4OnYy", "diffSide": "RIGHT", "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMDozMTo1OFrOHIgOdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMDozODo0NlrOHIgbJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY3ODY0Ng==", "bodyText": "These are broken links because we don't have Spark's API in our Javadoc, right?", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478678646", "createdAt": "2020-08-27T20:31:58Z", "author": {"login": "rdblue"}, "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "diffHunk": "@@ -92,11 +92,10 @@ protected Table table() {\n   }\n \n   /**\n-   * Whether or not to use stream the expired file list to the driver. The default (false) will use\n-   * collect to bring back all results to the driver at once which may be an issue with very long file lists.\n-   * Set this to true to use toLocalIterator if you are running into memory issues when collecting the list of files\n-   * to be deleted.\n-   * @param stream whether to use toLocalIterator to stream results instead of collect.\n+   * By default, all files to delete are brought to the driver at once which may be an issue with very long file lists.\n+   * Set this to true to use {@link Dataset#toLocalIterator()} if you are running into memory issues when collecting\n+   * the list of files to be deleted.\n+   * @param stream whether to use {@link Dataset#toLocalIterator} to stream results instead of {@link Dataset#collect}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "764a58bf2f1e9ba0eaaa5b47cfc7491c3c29e14d"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY4MTg5NQ==", "bodyText": "You are right, my bad.", "url": "https://github.com/apache/iceberg/pull/1395#discussion_r478681895", "createdAt": "2020-08-27T20:38:46Z", "author": {"login": "aokolnychyi"}, "path": "spark/src/main/java/org/apache/iceberg/actions/ExpireSnapshotsAction.java", "diffHunk": "@@ -92,11 +92,10 @@ protected Table table() {\n   }\n \n   /**\n-   * Whether or not to use stream the expired file list to the driver. The default (false) will use\n-   * collect to bring back all results to the driver at once which may be an issue with very long file lists.\n-   * Set this to true to use toLocalIterator if you are running into memory issues when collecting the list of files\n-   * to be deleted.\n-   * @param stream whether to use toLocalIterator to stream results instead of collect.\n+   * By default, all files to delete are brought to the driver at once which may be an issue with very long file lists.\n+   * Set this to true to use {@link Dataset#toLocalIterator()} if you are running into memory issues when collecting\n+   * the list of files to be deleted.\n+   * @param stream whether to use {@link Dataset#toLocalIterator} to stream results instead of {@link Dataset#collect}.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY3ODY0Ng=="}, "originalCommit": {"oid": "764a58bf2f1e9ba0eaaa5b47cfc7491c3c29e14d"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3700, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}