{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NjY5MjA4", "number": 1553, "title": "BaseMetastoreTableOperations shouldn't disable refresh upon NoSuchTab\u2026", "bodyText": "\u2026leException. Otherwise it might cause unfriendly NPE for callers that don't check null return value from current() method.", "createdAt": "2020-10-06T16:08:00Z", "url": "https://github.com/apache/iceberg/pull/1553", "merged": true, "mergeCommit": {"oid": "dc661d417098265de61383650e784d1b39a57209"}, "closed": true, "closedAt": "2020-10-06T19:36:33Z", "author": {"login": "stevenzwu"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdP69HigFqTUwMzE0ODY2NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP8Q-ugBqjM4NDY4Mzg2OTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMTQ4NjY0", "url": "https://github.com/apache/iceberg/pull/1553#pullrequestreview-503148664", "createdAt": "2020-10-06T16:27:20Z", "commit": {"oid": "5dcd6c83a69bbc98bacc0bedef0f51edf1de4319"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjoyNzoyMVrOHdQFzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjoyNzoyMVrOHdQFzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQzNDM4Mw==", "bodyText": "Can you add this line back? Removing it will just cause commit conflicts and it isn't needed for the PR.", "url": "https://github.com/apache/iceberg/pull/1553#discussion_r500434383", "createdAt": "2020-10-06T16:27:21Z", "author": {"login": "rdblue"}, "path": "core/src/main/java/org/apache/iceberg/BaseMetastoreTableOperations.java", "diffHunk": "@@ -88,11 +88,9 @@ public TableMetadata refresh() {\n       if (currentMetadataWasAvailable) {\n         LOG.warn(\"Could not find the table during refresh, setting current metadata to null\", e);\n       }\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dcd6c83a69bbc98bacc0bedef0f51edf1de4319"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMTUwOTI4", "url": "https://github.com/apache/iceberg/pull/1553#pullrequestreview-503150928", "createdAt": "2020-10-06T16:30:03Z", "commit": {"oid": "5dcd6c83a69bbc98bacc0bedef0f51edf1de4319"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjozMDowM1rOHdQMmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjozMDowM1rOHdQMmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQzNjEyMg==", "bodyText": "I think this needs to set shouldRefresh to true. If refresh was called directly, then shouldRefresh may not already be true. But we want it to be true so that this will not return metadata until a successful refresh.", "url": "https://github.com/apache/iceberg/pull/1553#discussion_r500436122", "createdAt": "2020-10-06T16:30:03Z", "author": {"login": "rdblue"}, "path": "core/src/main/java/org/apache/iceberg/BaseMetastoreTableOperations.java", "diffHunk": "@@ -88,11 +88,9 @@ public TableMetadata refresh() {\n       if (currentMetadataWasAvailable) {\n         LOG.warn(\"Could not find the table during refresh, setting current metadata to null\", e);\n       }\n-\n       currentMetadata = null;\n       currentMetadataLocation = null;\n       version = -1;\n-      shouldRefresh = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dcd6c83a69bbc98bacc0bedef0f51edf1de4319"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76352f8aca59cb762d995994d04c84a57d30bd66", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/76352f8aca59cb762d995994d04c84a57d30bd66", "committedDate": "2020-10-06T17:58:13Z", "message": "BaseMetastoreTableOperations shouldn't disable refresh upon NoSuchTableException. Otherwise it might cause unfriendly NPE for callers that don't check null return value from current() method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5dcd6c83a69bbc98bacc0bedef0f51edf1de4319", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/5dcd6c83a69bbc98bacc0bedef0f51edf1de4319", "committedDate": "2020-10-06T16:05:35Z", "message": "BaseMetastoreTableOperations shouldn't disable refresh upon NoSuchTableException. Otherwise it might cause unfriendly NPE for callers that don't check null return value from current() method."}, "afterCommit": {"oid": "76352f8aca59cb762d995994d04c84a57d30bd66", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/76352f8aca59cb762d995994d04c84a57d30bd66", "committedDate": "2020-10-06T17:58:13Z", "message": "BaseMetastoreTableOperations shouldn't disable refresh upon NoSuchTableException. Otherwise it might cause unfriendly NPE for callers that don't check null return value from current() method."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3902, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}