{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMzY1NTE0", "number": 1765, "title": "Flink: Refactor SimpleDataUtil#assertTableRecords method", "bodyText": "if the parameter List<Record> contains repeated data, the Set will remove the duplicates, which is different from our expected value,we should compare the original list", "createdAt": "2020-11-13T06:00:06Z", "url": "https://github.com/apache/iceberg/pull/1765", "merged": true, "mergeCommit": {"oid": "c6c9d381718679959ba7b62dfe362848225e11c8"}, "closed": true, "closedAt": "2020-11-19T13:40:40Z", "author": {"login": "zhangjun0x01"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcDzFvAFqTUyOTkwNzk5OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeC3L1gFqTUzNDQ0OTQ3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5OTA3OTk4", "url": "https://github.com/apache/iceberg/pull/1765#pullrequestreview-529907998", "createdAt": "2020-11-13T09:32:38Z", "commit": {"oid": "e52aaa82372779b176c620e4104125ccf6f1ad41"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwOTozMjozOFrOHynENw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwOTozMjozOFrOHynENw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjgzMDkwMw==", "bodyText": "Using hashCode to sort this list is correct if we only want to check wether the two list is equal or not.  But it may not friend to debug the root cause when two list is not equal because those elements are disordered. I'd prefer to compare the fields in lexicographical order if possible.", "url": "https://github.com/apache/iceberg/pull/1765#discussion_r522830903", "createdAt": "2020-11-13T09:32:38Z", "author": {"login": "openinx"}, "path": "flink/src/test/java/org/apache/iceberg/flink/SimpleDataUtil.java", "diffHunk": "@@ -129,11 +129,25 @@ public static void assertTableRows(String tablePath, List<RowData> expected) thr\n   public static void assertTableRecords(Table table, List<Record> expected) throws IOException {\n     table.refresh();\n     try (CloseableIterable<Record> iterable = IcebergGenerics.read(table).build()) {\n-      Assert.assertEquals(\"Should produce the expected record\",\n-          Sets.newHashSet(expected), Sets.newHashSet(iterable));\n+      List<Record> iterList = Lists.newArrayList(iterable.iterator());\n+      sortRecordList(iterList);\n+      sortRecordList(expected);\n+      Assert.assertEquals(\"Should produce the expected record\", expected, iterList);\n     }\n   }\n \n+  private static void sortRecordList(List<Record> list) {\n+    Collections.sort(list, (o1, o2) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e52aaa82372779b176c620e4104125ccf6f1ad41"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "168b53f1660e8a3197e39d0ffc0e5e1b3c43cc5a", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/168b53f1660e8a3197e39d0ffc0e5e1b3c43cc5a", "committedDate": "2020-11-19T07:09:58Z", "message": "refactor assertTableRows methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b32919f16f6374dae56a44bd399deadb2ebc5786", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/b32919f16f6374dae56a44bd399deadb2ebc5786", "committedDate": "2020-11-19T07:09:58Z", "message": " HashMultiset instread of set"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e52aaa82372779b176c620e4104125ccf6f1ad41", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/e52aaa82372779b176c620e4104125ccf6f1ad41", "committedDate": "2020-11-13T05:58:42Z", "message": "refactor assertTableRows methods"}, "afterCommit": {"oid": "b32919f16f6374dae56a44bd399deadb2ebc5786", "author": {"user": null}, "url": "https://github.com/apache/iceberg/commit/b32919f16f6374dae56a44bd399deadb2ebc5786", "committedDate": "2020-11-19T07:09:58Z", "message": " HashMultiset instread of set"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NDQ5NDc0", "url": "https://github.com/apache/iceberg/pull/1765#pullrequestreview-534449474", "createdAt": "2020-11-19T13:35:03Z", "commit": {"oid": "b32919f16f6374dae56a44bd399deadb2ebc5786"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3746, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}