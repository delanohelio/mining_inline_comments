{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMjQ2OTQ5", "number": 1001, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjowNDozOFrOD5eNpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNzoxNTozMlrOD8KSsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNTkwNDM4OnYy", "diffSide": "RIGHT", "path": "parquet/src/main/java/org/apache/iceberg/parquet/ParquetTypeVisitor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjowNDozOFrOGQwjgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjowNDozOFrOGQwjgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIyNTkyMA==", "bodyText": "This was moved into its own method. The only changes are to use the new before and after methods.", "url": "https://github.com/apache/iceberg/pull/1001#discussion_r420225920", "createdAt": "2020-05-05T16:04:38Z", "author": {"login": "rdblue"}, "path": "parquet/src/main/java/org/apache/iceberg/parquet/ParquetTypeVisitor.java", "diffHunk": "@@ -123,19 +60,115 @@\n     }\n   }\n \n-  private static <T> T visitField(Type field, ParquetTypeVisitor<T> visitor) {\n-    visitor.fieldNames.push(field.getName());\n+  private static <T> T visitList(GroupType list, ParquetTypeVisitor<T> visitor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81fb595154e09e72a6b43348e3a11592b087c9f"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNTkwNTg4OnYy", "diffSide": "RIGHT", "path": "parquet/src/main/java/org/apache/iceberg/parquet/ParquetTypeVisitor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjowNDo1N1rOGQwkcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjowNDo1N1rOGQwkcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIyNjE2MQ==", "bodyText": "This was moved to its own method. The only changes are to use the new before and after methods.", "url": "https://github.com/apache/iceberg/pull/1001#discussion_r420226161", "createdAt": "2020-05-05T16:04:57Z", "author": {"login": "rdblue"}, "path": "parquet/src/main/java/org/apache/iceberg/parquet/ParquetTypeVisitor.java", "diffHunk": "@@ -123,19 +60,115 @@\n     }\n   }\n \n-  private static <T> T visitField(Type field, ParquetTypeVisitor<T> visitor) {\n-    visitor.fieldNames.push(field.getName());\n+  private static <T> T visitList(GroupType list, ParquetTypeVisitor<T> visitor) {\n+    Preconditions.checkArgument(!list.isRepetition(Type.Repetition.REPEATED),\n+        \"Invalid list: top-level group is repeated: %s\", list);\n+    Preconditions.checkArgument(list.getFieldCount() == 1,\n+        \"Invalid list: does not contain single repeated field: %s\", list);\n+\n+    GroupType repeatedElement = list.getFields().get(0).asGroupType();\n+    Preconditions.checkArgument(repeatedElement.isRepetition(Type.Repetition.REPEATED),\n+        \"Invalid list: inner group is not repeated\");\n+    Preconditions.checkArgument(repeatedElement.getFieldCount() <= 1,\n+        \"Invalid list: repeated group is not a single field: %s\", list);\n+\n+    visitor.beforeRepeatedElement(repeatedElement);\n     try {\n-      return visit(field, visitor);\n+      T elementResult = null;\n+      if (repeatedElement.getFieldCount() > 0) {\n+        Type elementField = repeatedElement.getType(0);\n+        visitor.beforeElementField(elementField);\n+        try {\n+          elementResult = visit(elementField, visitor);\n+        } finally {\n+          visitor.afterElementField(elementField);\n+        }\n+      }\n+\n+      return visitor.list(list, elementResult);\n+\n     } finally {\n-      visitor.fieldNames.pop();\n+      visitor.afterRepeatedElement(repeatedElement);\n+    }\n+  }\n+\n+  private static <T> T visitMap(GroupType map, ParquetTypeVisitor<T> visitor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81fb595154e09e72a6b43348e3a11592b087c9f"}, "originalPosition": 125}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NDA5Nzc4OnYy", "diffSide": "RIGHT", "path": "parquet/src/main/java/org/apache/iceberg/parquet/MessageTypeToType.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNzoxNTozMlrOGU7nZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNzoxNTozMlrOGU7nZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDYwMTQ0NQ==", "bodyText": "Nice!", "url": "https://github.com/apache/iceberg/pull/1001#discussion_r424601445", "createdAt": "2020-05-13T17:15:32Z", "author": {"login": "aokolnychyi"}, "path": "parquet/src/main/java/org/apache/iceberg/parquet/MessageTypeToType.java", "diffHunk": "@@ -187,11 +187,7 @@ public Type primitive(PrimitiveType primitive) {\n   }\n \n   private void addAlias(String name, int fieldId) {\n-    String fullName = name;\n-    if (!fieldNames.isEmpty()) {\n-      fullName = DOT.join(DOT.join(fieldNames.descendingIterator()), name);\n-    }\n-    aliasToId.put(fullName, fieldId);\n+    aliasToId.put(DOT.join(path(name)), fieldId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81fb595154e09e72a6b43348e3a11592b087c9f"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3981, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}