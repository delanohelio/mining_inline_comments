{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNTY3Nzg2", "number": 738, "title": "Collect row stats while writing manifests", "bodyText": "This PR extends the information stored in the manifest list with row stats to avoid touching manifests in #675. This change is backward and forward-compatible.\nThis addresses #733.", "createdAt": "2020-01-16T10:24:48Z", "url": "https://github.com/apache/iceberg/pull/738", "merged": true, "mergeCommit": {"oid": "fb1eb3a65e2065ab69e84edd7c82bcfb975acc23"}, "closed": true, "closedAt": "2020-01-23T17:51:04Z", "author": {"login": "aokolnychyi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb63nRwgBqjI5NTM5OTgzNzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9EboxgH2gAyMzYzNTY3Nzg2OjhkNzJjYzY2NDQ2MjQ1MDdiMWI3MzY5ZjU5MzMwOTdiMDliZTZiMWQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0e9bd6359314d834d3ad6aa242601b62c97debd4", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/0e9bd6359314d834d3ad6aa242601b62c97debd4", "committedDate": "2020-01-16T10:09:54Z", "message": "Collect row stats while writing manifests"}, "afterCommit": {"oid": "9e18ddc084ca1bcee7e2267ef08df85ea82f86c7", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/9e18ddc084ca1bcee7e2267ef08df85ea82f86c7", "committedDate": "2020-01-16T10:29:56Z", "message": "Collect row stats while writing manifests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzODE0OTg1", "url": "https://github.com/apache/iceberg/pull/738#pullrequestreview-343814985", "createdAt": "2020-01-16T10:33:28Z", "commit": {"oid": "9e18ddc084ca1bcee7e2267ef08df85ea82f86c7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxMDozMzoyOFrOFeU4ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxMDozMzoyOFrOFeU4ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzM0MzczOQ==", "bodyText": "Technically, this doesn't have to extend TableTestBase but we need writeManifest. I think we can refactor a bit and introduce a separate parent test class with the logic for writing/checking manifests/snapshots.", "url": "https://github.com/apache/iceberg/pull/738#discussion_r367343739", "createdAt": "2020-01-16T10:33:28Z", "author": {"login": "aokolnychyi"}, "path": "core/src/test/java/org/apache/iceberg/TestManifestWriter.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.iceberg;\n+\n+import java.io.IOException;\n+import java.util.UUID;\n+import org.apache.iceberg.ManifestEntry.Status;\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+public class TestManifestWriter extends TableTestBase {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e18ddc084ca1bcee7e2267ef08df85ea82f86c7"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NzE4Nzk2", "url": "https://github.com/apache/iceberg/pull/738#pullrequestreview-344718796", "createdAt": "2020-01-17T17:06:39Z", "commit": {"oid": "9e18ddc084ca1bcee7e2267ef08df85ea82f86c7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxNzowNjozOVrOFe_g8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxNzowNjozOVrOFe_g8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA0MjIyNg==", "bodyText": "Can we add these up by the data files counts?", "url": "https://github.com/apache/iceberg/pull/738#discussion_r368042226", "createdAt": "2020-01-17T17:06:39Z", "author": {"login": "rdblue"}, "path": "api/src/main/java/org/apache/iceberg/ManifestFile.java", "diffHunk": "@@ -42,7 +42,10 @@\n           required(509, \"contains_null\", Types.BooleanType.get()),\n           optional(510, \"lower_bound\", Types.BinaryType.get()), // null if no non-null values\n           optional(511, \"upper_bound\", Types.BinaryType.get())\n-      ))));\n+      ))),\n+      optional(512, \"added_rows_count\", Types.LongType.get()),\n+      optional(513, \"existing_rows_count\", Types.LongType.get()),\n+      optional(514, \"deleted_rows_count\", Types.LongType.get()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e18ddc084ca1bcee7e2267ef08df85ea82f86c7"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5c01089b5839ee38bbbd4e8935edb1b9550e7ee", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/d5c01089b5839ee38bbbd4e8935edb1b9550e7ee", "committedDate": "2020-01-21T08:12:08Z", "message": "Collect row stats while writing manifests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "873ae9147f423a5aef9726c5947927a110cd1682", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/873ae9147f423a5aef9726c5947927a110cd1682", "committedDate": "2020-01-21T08:12:08Z", "message": "Reorder fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4185fe021e10a4e6c489dde7d0db9a95c5b003de", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/4185fe021e10a4e6c489dde7d0db9a95c5b003de", "committedDate": "2020-01-21T08:12:08Z", "message": "Use SPEC to build files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9e18ddc084ca1bcee7e2267ef08df85ea82f86c7", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/9e18ddc084ca1bcee7e2267ef08df85ea82f86c7", "committedDate": "2020-01-16T10:29:56Z", "message": "Collect row stats while writing manifests"}, "afterCommit": {"oid": "4185fe021e10a4e6c489dde7d0db9a95c5b003de", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/4185fe021e10a4e6c489dde7d0db9a95c5b003de", "committedDate": "2020-01-21T08:12:08Z", "message": "Use SPEC to build files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d72cc6644624507b1b7369f5933097b09be6b1d", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/8d72cc6644624507b1b7369f5933097b09be6b1d", "committedDate": "2020-01-23T06:34:07Z", "message": "Revert \"Reorder fields\"\n\nThis reverts commit 873ae914"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4883, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}