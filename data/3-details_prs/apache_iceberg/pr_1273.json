{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5MDk5NjY2", "number": 1273, "title": "Generics: Refactor TestLocalScan", "bodyText": "This fixes ##1262.", "createdAt": "2020-07-30T11:40:04Z", "url": "https://github.com/apache/iceberg/pull/1273", "merged": true, "mergeCommit": {"oid": "3e8329ca61e5346126be1cbcaba9e9ddd9fa972f"}, "closed": true, "closedAt": "2020-08-06T07:02:29Z", "author": {"login": "chenjunjiedada"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6E7YNAH2gAyNDU5MDk5NjY2OmExMDI5YmIxZGFiZWEzMjY2MjRjZDU0NmExYjE2MGEzNzc5Y2MwOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7_ZAmgFqTQ2MTkxMjEzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a1029bb1dabea326624cd546a1b160a3779cc090", "author": {"user": {"login": "chenjunjiedada", "name": "Chen, Junjie"}}, "url": "https://github.com/apache/iceberg/commit/a1029bb1dabea326624cd546a1b160a3779cc090", "committedDate": "2020-07-30T19:38:10Z", "message": "Generics: Refactor TestLocalScan"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMjA5ODA5", "url": "https://github.com/apache/iceberg/pull/1273#pullrequestreview-460209809", "createdAt": "2020-08-03T17:30:59Z", "commit": {"oid": "a1029bb1dabea326624cd546a1b160a3779cc090"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzozMDo1OVrOG7CUUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzo0NDowOVrOG7C5JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU1NzEzOQ==", "bodyText": "It's a bit confusing that the name of the DataFile variable is different from the extension name, e.g. in this case DataFile is file12 and extension file-11. Is there a reason for the rename from how it was before?", "url": "https://github.com/apache/iceberg/pull/1273#discussion_r464557139", "createdAt": "2020-08-03T17:30:59Z", "author": {"login": "edgarRd"}, "path": "data/src/test/java/org/apache/iceberg/data/TestLocalScan.java", "diffHunk": "@@ -103,132 +103,100 @@ public TestLocalScan(String format) {\n \n   private String sharedTableLocation = null;\n   private Table sharedTable = null;\n-  private List<Record> file1Records = null;\n-  private List<Record> file2Records = null;\n-  private List<Record> file3Records = null;\n-  private List<Record> file1FirstSnapshotRecords = null;\n-  private List<Record> file2FirstSnapshotRecords = null;\n-  private List<Record> file3FirstSnapshotRecords = null;\n-  private List<Record> file1SecondSnapshotRecords = null;\n-  private List<Record> file2SecondSnapshotRecords = null;\n-  private List<Record> file3SecondSnapshotRecords = null;\n \n+  private final Record genericRecord = GenericRecord.create(SCHEMA);\n+\n+  private final List<Record> file1FirstRecords =  Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 0L, \"data\", \"clarification\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 1L, \"data\", \"risky\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 2L, \"data\", \"falafel\"))\n+  );\n+  private final List<Record> file2FirstRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 10L, \"data\", \"clammy\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 11L, \"data\", \"evacuate\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 12L, \"data\", \"tissue\"))\n+  );\n+  private final List<Record> file3FirstRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 20L, \"data\", \"ocean\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 21L, \"data\", \"holistic\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 22L, \"data\", \"preventative\"))\n+  );\n+\n+  private final List<Record> file1SecondSnapshotRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 4L, \"data\", \"obscure\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 5L, \"data\", \"secure\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 6L, \"data\", \"fetta\"))\n+  );\n+  private final List<Record> file2SecondSnapshotRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 14L, \"data\", \"radical\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 15L, \"data\", \"collocation\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 16L, \"data\", \"book\"))\n+  );\n+  private final List<Record> file3SecondSnapshotRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 24L, \"data\", \"cloud\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 25L, \"data\", \"zen\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 26L, \"data\", \"sky\"))\n+  );\n+\n+  private final List<Record> file1ThirdSnapshotRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 6L, \"data\", \"brainy\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 7L, \"data\", \"film\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 8L, \"data\", \"fetta\"))\n+  );\n+  private final List<Record> file2ThirdSnapshotRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 16L, \"data\", \"cake\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 17L, \"data\", \"intrinsic\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 18L, \"data\", \"paper\"))\n+  );\n+  private final List<Record> file3ThirdSnapshotRecords = Lists.newArrayList(\n+      genericRecord.copy(ImmutableMap.of(\"id\", 26L, \"data\", \"belleview\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 27L, \"data\", \"overview\")),\n+      genericRecord.copy(ImmutableMap.of(\"id\", 28L, \"data\", \"tender\"))\n+  );\n \n   private void overwriteExistingData() throws IOException {\n-    Record record = GenericRecord.create(SCHEMA);\n-\n-    this.file1FirstSnapshotRecords = Lists.newArrayList(\n-        record.copy(ImmutableMap.of(\"id\", 4L, \"data\", \"obscure\")),\n-        record.copy(ImmutableMap.of(\"id\", 5L, \"data\", \"secure\")),\n-        record.copy(ImmutableMap.of(\"id\", 6L, \"data\", \"fetta\"))\n-    );\n-    DataFile file11 = writeFile(sharedTableLocation, format.addExtension(\"file-11\"), file1FirstSnapshotRecords);\n-\n-    this.file2FirstSnapshotRecords = Lists.newArrayList(\n-        record.copy(ImmutableMap.of(\"id\", 14L, \"data\", \"radical\")),\n-        record.copy(ImmutableMap.of(\"id\", 15L, \"data\", \"collocation\")),\n-        record.copy(ImmutableMap.of(\"id\", 16L, \"data\", \"book\"))\n-    );\n-    DataFile file21 = writeFile(sharedTableLocation, format.addExtension(\"file-21\"), file2FirstSnapshotRecords);\n-\n-    this.file3FirstSnapshotRecords = Lists.newArrayList(\n-        record.copy(ImmutableMap.of(\"id\", 24L, \"data\", \"cloud\")),\n-        record.copy(ImmutableMap.of(\"id\", 25L, \"data\", \"zen\")),\n-        record.copy(ImmutableMap.of(\"id\", 26L, \"data\", \"sky\"))\n-    );\n-    DataFile file31 = writeFile(sharedTableLocation, format.addExtension(\"file-31\"), file3FirstSnapshotRecords);\n+    DataFile file12 = writeFile(sharedTableLocation, format.addExtension(\"file-11\"), file1SecondSnapshotRecords);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1029bb1dabea326624cd546a1b160a3779cc090"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU2NjU2NA==", "bodyText": "Looks like the goal is to make these immutable, have you considered using ImmutableList too?", "url": "https://github.com/apache/iceberg/pull/1273#discussion_r464566564", "createdAt": "2020-08-03T17:44:09Z", "author": {"login": "edgarRd"}, "path": "data/src/test/java/org/apache/iceberg/data/TestLocalScan.java", "diffHunk": "@@ -103,132 +103,100 @@ public TestLocalScan(String format) {\n \n   private String sharedTableLocation = null;\n   private Table sharedTable = null;\n-  private List<Record> file1Records = null;\n-  private List<Record> file2Records = null;\n-  private List<Record> file3Records = null;\n-  private List<Record> file1FirstSnapshotRecords = null;\n-  private List<Record> file2FirstSnapshotRecords = null;\n-  private List<Record> file3FirstSnapshotRecords = null;\n-  private List<Record> file1SecondSnapshotRecords = null;\n-  private List<Record> file2SecondSnapshotRecords = null;\n-  private List<Record> file3SecondSnapshotRecords = null;\n \n+  private final Record genericRecord = GenericRecord.create(SCHEMA);\n+\n+  private final List<Record> file1FirstRecords =  Lists.newArrayList(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1029bb1dabea326624cd546a1b160a3779cc090"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b75cf33eb4fa39f2940b954d21080bc61cc4e64", "author": {"user": {"login": "chenjunjiedada", "name": "Chen, Junjie"}}, "url": "https://github.com/apache/iceberg/commit/5b75cf33eb4fa39f2940b954d21080bc61cc4e64", "committedDate": "2020-08-04T02:01:24Z", "message": "address comments from Edgar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5c94315de53be4df46f955adb7e82f513de6c7e", "author": {"user": {"login": "chenjunjiedada", "name": "Chen, Junjie"}}, "url": "https://github.com/apache/iceberg/commit/e5c94315de53be4df46f955adb7e82f513de6c7e", "committedDate": "2020-08-04T01:50:13Z", "message": "address comments from Edgar"}, "afterCommit": {"oid": "5b75cf33eb4fa39f2940b954d21080bc61cc4e64", "author": {"user": {"login": "chenjunjiedada", "name": "Chen, Junjie"}}, "url": "https://github.com/apache/iceberg/commit/5b75cf33eb4fa39f2940b954d21080bc61cc4e64", "committedDate": "2020-08-04T02:01:24Z", "message": "address comments from Edgar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMzE5ODg1", "url": "https://github.com/apache/iceberg/pull/1273#pullrequestreview-461319885", "createdAt": "2020-08-05T03:47:59Z", "commit": {"oid": "5b75cf33eb4fa39f2940b954d21080bc61cc4e64"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxOTEyMTM1", "url": "https://github.com/apache/iceberg/pull/1273#pullrequestreview-461912135", "createdAt": "2020-08-05T18:18:57Z", "commit": {"oid": "5b75cf33eb4fa39f2940b954d21080bc61cc4e64"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4373, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}