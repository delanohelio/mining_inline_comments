{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzNTEwNzIz", "number": 1069, "title": "ORC: Disable predicate pushdown for timestamp type", "bodyText": "In #983 (comment) we discovered issues with ORC predicate pushdown for timestamp types, where timestamps less than epoch were not handled correctly.\ned91355 fixes this and updates the test case to test for both pre epoch and post epoch values\nAfter fixing this, I also found that ORC column stats for timestamp are only stored to millisecond precisions (with round down) and hence predicates on timestamp types with sub-millisecond literals can potentially be evaluated incorrectly. This is being fixed in https://issues.apache.org/jira/browse/ORC-611. So for the time being, I have disabled pushdown for timestamp types in  63bc62b", "createdAt": "2020-05-26T23:08:58Z", "url": "https://github.com/apache/iceberg/pull/1069", "merged": true, "mergeCommit": {"oid": "9583787eb428a1d2015ba08ceabe43521fc2bbef"}, "closed": true, "closedAt": "2020-05-26T23:55:56Z", "author": {"login": "shardulm94"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclM44MAH2gAyNDIzNTEwNzIzOmVkOTEzNTVkNTU1OTg1OGNkNjY1NTYwZjkyYzZkMmRmZGM0YTY4ODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclNY1HAFqTQxODc0ODY2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ed91355d5559858cd665560f92c6d2dfdc4a6885", "author": {"user": {"login": "shardulm94", "name": "Shardul Mahadik"}}, "url": "https://github.com/apache/iceberg/commit/ed91355d5559858cd665560f92c6d2dfdc4a6885", "committedDate": "2020-05-26T23:02:16Z", "message": "Correctly handle timestamps less than epoch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63bc62b0707f9fea220759b12a8a544aa63eb59e", "author": {"user": {"login": "shardulm94", "name": "Shardul Mahadik"}}, "url": "https://github.com/apache/iceberg/commit/63bc62b0707f9fea220759b12a8a544aa63eb59e", "committedDate": "2020-05-26T23:02:17Z", "message": "Disable ORC pushdown for timestamp types because of ORC-611"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4NzQ4NjYy", "url": "https://github.com/apache/iceberg/pull/1069#pullrequestreview-418748662", "createdAt": "2020-05-26T23:37:09Z", "commit": {"oid": "63bc62b0707f9fea220759b12a8a544aa63eb59e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQyMzozNzoxMFrOGazxyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQyMzozNzoxMFrOGazxyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDc2NDQ4OQ==", "bodyText": "Why did this change?", "url": "https://github.com/apache/iceberg/pull/1069#discussion_r430764489", "createdAt": "2020-05-26T23:37:10Z", "author": {"login": "rdblue"}, "path": "orc/src/main/java/org/apache/iceberg/orc/ExpressionToSearchArgument.java", "diffHunk": "@@ -254,8 +255,10 @@ public Action or(Action leftChild, Action rightChild) {\n         return Date.valueOf(LocalDate.ofEpochDay((Integer) icebergLiteral));\n       case TIMESTAMP:\n         long microsFromEpoch = (Long) icebergLiteral;\n-        return Timestamp.from(Instant.ofEpochSecond(Math.floorDiv(microsFromEpoch, 1_000_000),\n-            (microsFromEpoch % 1_000_000) * 1_000));\n+        return Timestamp.from(Instant.ofEpochSecond(\n+            Math.floorDiv(microsFromEpoch, 1_000_000),\n+            Math.floorMod(microsFromEpoch, 1_000_000) * 1_000", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63bc62b0707f9fea220759b12a8a544aa63eb59e"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4451, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}