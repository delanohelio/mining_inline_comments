{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NDg5MjE5", "number": 840, "title": "Fix SchemaVisitor thread safety", "bodyText": "This fixes #831 by removing the linked list that is accidentally shared between threads when SchemaVisitor implementations are singletons. Now, SchemaVisitor exposes beforeField and afterField callbacks so the visitor that uses field IDs can track them itself.", "createdAt": "2020-03-12T21:39:19Z", "url": "https://github.com/apache/iceberg/pull/840", "merged": true, "mergeCommit": {"oid": "f875fb2aa3300e281568f33c7f3521c17509a87b"}, "closed": true, "closedAt": "2020-03-13T16:11:40Z", "author": {"login": "rdblue"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNCuHsgH2gAyMzg3NDg5MjE5OmU4NTY1NDVjMGU3MTU3OWZlZTljNjdiMTEwY2I5ZDg0ZDc4MzZkYjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNLh5ugFqTM3NDEwMjc2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e856545c0e71579fee9c67b110cb9d84d7836db9", "author": {"user": {"login": "rdblue", "name": "Ryan Blue"}}, "url": "https://github.com/apache/iceberg/commit/e856545c0e71579fee9c67b110cb9d84d7836db9", "committedDate": "2020-03-12T21:37:17Z", "message": "Fix SchemaVisitor thread safety."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczOTIzNTE0", "url": "https://github.com/apache/iceberg/pull/840#pullrequestreview-373923514", "createdAt": "2020-03-12T21:44:46Z", "commit": {"oid": "e856545c0e71579fee9c67b110cb9d84d7836db9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MTAyNzYy", "url": "https://github.com/apache/iceberg/pull/840#pullrequestreview-374102762", "createdAt": "2020-03-13T07:53:04Z", "commit": {"oid": "e856545c0e71579fee9c67b110cb9d84d7836db9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwNzo1MzowNFrOF16WcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwNzo1MzowNFrOF16WcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjA3NDg2NA==", "bodyText": "nit: would be better to name the two as preVisitField(...)  & postVisitField(...) ?", "url": "https://github.com/apache/iceberg/pull/840#discussion_r392074864", "createdAt": "2020-03-13T07:53:04Z", "author": {"login": "openinx"}, "path": "api/src/main/java/org/apache/iceberg/types/TypeUtil.java", "diffHunk": "@@ -190,7 +189,11 @@ public static boolean isPromotionAllowed(Type from, Type.PrimitiveType to) {\n   }\n \n   public static class SchemaVisitor<T> {\n-    private final Deque<Integer> fieldIds = Lists.newLinkedList();\n+    public void beforeField(Types.NestedField field) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e856545c0e71579fee9c67b110cb9d84d7836db9"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4714, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}