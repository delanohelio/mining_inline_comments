{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwNTEzOTMw", "number": 1570, "title": "Run hive storage handler tests for both Parquet and ORC", "bodyText": "It would be great to increase our Hive test coverage for ORC as well. One way to make progress on that is to run the same StorageHandler tests for both file formats (Parquet and ORC).\nThis would be ideally done by using the JUnit Parameterized test runner, however, we're already using the StandaloneHiveRunner test runner, so can't use both on the same class. @massdosage are you aware of any easy ways to use HiveRunner without this test runner? Couldn't find any Rules-based implementation for it, and pulling out the logic of the HiveShell initialization from the Runner seemed complicated enough to make it not worth it. Similarly, I didn't find any Rules-based implementation for Parameterized either, therefore I had to resort to simply writing new test methods for ORC.\nIt's not elegant, but given the constraints, this comes out to be the least-complicated approach still - and gives us the test coverage we need. I'm happy to use a different approach if you guys have any other ideas on how to make this work in a way that 'scales' better. Thanks!\n@rdblue @massdosage @pvary", "createdAt": "2020-10-09T11:02:10Z", "url": "https://github.com/apache/iceberg/pull/1570", "merged": true, "mergeCommit": {"oid": "60ebbf0875bfc8be698faf68c4f9de3fef635058"}, "closed": true, "closedAt": "2020-10-10T22:20:42Z", "author": {"login": "marton-bod"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQjajLAH2gAyNTAwNTEzOTMwOmUyMWZiYTRjMDQyZWE1MWNkZTMyODVlNzU5ZTdiMjNmN2MzNjEzNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRQ_Y6AFqTUwNjEyNTA4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e21fba4c042ea51cde3285e759e7b23f7c361366", "author": {"user": {"login": "marton-bod", "name": "Marton Bod"}}, "url": "https://github.com/apache/iceberg/commit/e21fba4c042ea51cde3285e759e7b23f7c361366", "committedDate": "2020-10-08T15:35:42Z", "message": "run methods for both Parquet and ORC"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e5be00db17d87907054561cd993d6702f1ac618", "author": {"user": {"login": "marton-bod", "name": "Marton Bod"}}, "url": "https://github.com/apache/iceberg/commit/1e5be00db17d87907054561cd993d6702f1ac618", "committedDate": "2020-10-09T11:28:32Z", "message": "fix indentation for checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTI1MDgw", "url": "https://github.com/apache/iceberg/pull/1570#pullrequestreview-506125080", "createdAt": "2020-10-10T20:41:40Z", "commit": {"oid": "1e5be00db17d87907054561cd993d6702f1ac618"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMFQyMDo0MTo0MFrOHfiUhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMFQyMDo0MTo0MFrOHfiUhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjgzMDIxNA==", "bodyText": "Rather than creating more test cases, we usually parameterize the test suite. TestIdentityPartitionData is an example. Could you use that approach instead? Or is there a reason why you chose to do it this way?", "url": "https://github.com/apache/iceberg/pull/1570#discussion_r502830214", "createdAt": "2020-10-10T20:41:40Z", "author": {"login": "rdblue"}, "path": "mr/src/test/java/org/apache/iceberg/mr/hive/HiveIcebergStorageHandlerBaseTest.java", "diffHunk": "@@ -136,18 +136,50 @@ public void after() throws Exception {\n     }\n   }\n \n+  // PARQUET\n+\n+  @Test\n+  public void testScanEmptyTableParquet() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e5be00db17d87907054561cd993d6702f1ac618"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3921, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}