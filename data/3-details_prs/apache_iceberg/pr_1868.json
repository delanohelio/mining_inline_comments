{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxODA1MjU3", "number": 1868, "title": "Core: Add table properties for snapshot retention", "bodyText": "This PR adds table properties for snapshot retention.", "createdAt": "2020-12-03T14:10:56Z", "url": "https://github.com/apache/iceberg/pull/1868", "merged": true, "mergeCommit": {"oid": "d9ab0babd2de7c5d3dc14e8f458bd1020a14329e"}, "closed": true, "closedAt": "2020-12-03T19:36:28Z", "author": {"login": "aokolnychyi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdijx6FgFqTU0Mzk5MDY2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdioa2-AFqTU0NDMxOTAxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzOTkwNjYy", "url": "https://github.com/apache/iceberg/pull/1868#pullrequestreview-543990662", "createdAt": "2020-12-03T14:11:51Z", "commit": {"oid": "9c55902186b124c762180124840253506f224f29"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNDoxMTo1MVrOH-dkDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNDoxMTo1MVrOH-dkDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI1ODEyNA==", "bodyText": "This is not a particularly good default but we need it to keep the old behavior.", "url": "https://github.com/apache/iceberg/pull/1868#discussion_r535258124", "createdAt": "2020-12-03T14:11:51Z", "author": {"login": "aokolnychyi"}, "path": "core/src/main/java/org/apache/iceberg/TableProperties.java", "diffHunk": "@@ -140,4 +140,10 @@ private TableProperties() {\n \n   public static final String GC_ENABLED = \"gc.enabled\";\n   public static final boolean GC_ENABLED_DEFAULT = true;\n+\n+  public static final String MAX_SNAPSHOT_AGE_MS = \"history.expire.max-snapshot-age-ms\";\n+  public static final long MAX_SNAPSHOT_AGE_MS_DEFAULT = 5 * 24 * 60 * 60 * 1000; // 5 days\n+\n+  public static final String RETAIN_MIN_NUM_SNAPSHOTS = \"history.expire.retain-min-num-snapshots\";\n+  public static final int RETAIN_MIN_NUM_SNAPSHOTS_DEFAULT = 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c55902186b124c762180124840253506f224f29"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c55902186b124c762180124840253506f224f29", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/9c55902186b124c762180124840253506f224f29", "committedDate": "2020-12-03T14:07:18Z", "message": "Core: Add table properties for snapshot retention"}, "afterCommit": {"oid": "421b80a11a3a2dc6b385c2a159e4569e600c3017", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/421b80a11a3a2dc6b385c2a159e4569e600c3017", "committedDate": "2020-12-03T14:19:42Z", "message": "Core: Add table properties for snapshot retention"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1082f2041883dfe4b3a3f341201f76000273655", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/e1082f2041883dfe4b3a3f341201f76000273655", "committedDate": "2020-12-03T14:22:16Z", "message": "Core: Add table properties for snapshot retention"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "421b80a11a3a2dc6b385c2a159e4569e600c3017", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/421b80a11a3a2dc6b385c2a159e4569e600c3017", "committedDate": "2020-12-03T14:19:42Z", "message": "Core: Add table properties for snapshot retention"}, "afterCommit": {"oid": "e1082f2041883dfe4b3a3f341201f76000273655", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/e1082f2041883dfe4b3a3f341201f76000273655", "committedDate": "2020-12-03T14:22:16Z", "message": "Core: Add table properties for snapshot retention"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MjIwMTU5", "url": "https://github.com/apache/iceberg/pull/1868#pullrequestreview-544220159", "createdAt": "2020-12-03T17:46:45Z", "commit": {"oid": "e1082f2041883dfe4b3a3f341201f76000273655"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNzo0Njo0NVrOH-pPDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNzo0Njo0NVrOH-pPDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ0OTM1OQ==", "bodyText": "What do you think about a slight rename so that min comes first and we remove num? I'm thinking history.expire.min-retained-snapshots. We could also use kept instead of retained if that is more clear.", "url": "https://github.com/apache/iceberg/pull/1868#discussion_r535449359", "createdAt": "2020-12-03T17:46:45Z", "author": {"login": "rdblue"}, "path": "site/docs/configuration.md", "diffHunk": "@@ -81,6 +81,8 @@ Iceberg tables support table properties to configure table behavior, like the de\n | commit.manifest.target-size-bytes  | 8388608 (8 MB)   | Target size when merging manifest files                       |\n | commit.manifest.min-count-to-merge | 100              | Minimum number of manifests to accumulate before merging      |\n | commit.manifest-merge.enabled      | true             | Controls whether to automatically merge manifests on writes   |\n+| history.expire.max-snapshot-age-ms | 432000000 (5 days) | Default max age of snapshots to keep while expiring snapshots    |\n+| history.expire.retain-min-num-snapshots | 1             | Default min number of snapshots to keep while expiring snapshots |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1082f2041883dfe4b3a3f341201f76000273655"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c1f296c61ce0dfae0c564e8525d646ee699ad8a", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/4c1f296c61ce0dfae0c564e8525d646ee699ad8a", "committedDate": "2020-12-03T18:12:26Z", "message": "Change prop name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1a9b686115a93c43f04080c060996d4d013ee1a", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/a1a9b686115a93c43f04080c060996d4d013ee1a", "committedDate": "2020-12-03T18:16:50Z", "message": "Fix other places"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MzE5MDEx", "url": "https://github.com/apache/iceberg/pull/1868#pullrequestreview-544319011", "createdAt": "2020-12-03T19:36:12Z", "commit": {"oid": "a1a9b686115a93c43f04080c060996d4d013ee1a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3498, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}