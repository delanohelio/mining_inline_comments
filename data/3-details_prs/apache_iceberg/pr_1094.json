{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MDcxNTkw", "number": 1094, "title": "Add ignoreResiduals to TableScan", "bodyText": "This PR adds a way to ignore residuals and read full files that is needed for data compaction and eager updates/deletes/upserts.", "createdAt": "2020-06-04T20:31:01Z", "url": "https://github.com/apache/iceberg/pull/1094", "merged": true, "mergeCommit": {"oid": "c299b45bb6ec9a0f2f18451a16136bde9110b5b0"}, "closed": true, "closedAt": "2020-06-05T16:17:37Z", "author": {"login": "aokolnychyi"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoD8AvgH2gAyNDI4MDcxNTkwOjk0NjQ0NTcwYzk5ZWQzNTYxMzI1ZTU5ZGQ0ZTcyZmI2YjY3NDA3NmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoGdklgFqTQyNDg5NjUxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e", "author": {"user": {"login": "aokolnychyi", "name": "Anton Okolnychyi"}}, "url": "https://github.com/apache/iceberg/commit/94644570c99ed3561325e59dd4e72fb6b674076e", "committedDate": "2020-06-04T20:18:19Z", "message": "Add ignoreResiduals to TableScan"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODA3Mjkx", "url": "https://github.com/apache/iceberg/pull/1094#pullrequestreview-424807291", "createdAt": "2020-06-04T20:34:22Z", "commit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMDozNDoyMlrOGfWz3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMDozNDoyMlrOGfWz3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzMjc2NA==", "bodyText": "It is ugly but I don't see another way.", "url": "https://github.com/apache/iceberg/pull/1094#discussion_r435532764", "createdAt": "2020-06-04T20:34:22Z", "author": {"login": "aokolnychyi"}, "path": "core/src/main/java/org/apache/iceberg/AllEntriesTable.java", "diffHunk": "@@ -82,18 +83,21 @@ public Schema schema() {\n \n     private Scan(\n         TableOperations ops, Table table, Long snapshotId, Schema schema, Expression rowFilter,\n-        boolean caseSensitive, boolean colStats, Collection<String> selectedColumns,\n-        ImmutableMap<String, String> options) {\n-      super(ops, table, snapshotId, schema, rowFilter, caseSensitive, colStats, selectedColumns, options);\n+        boolean ignoreResiduals, boolean caseSensitive, boolean colStats,\n+        Collection<String> selectedColumns, ImmutableMap<String, String> options) {\n+      super(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODA3ODgx", "url": "https://github.com/apache/iceberg/pull/1094#pullrequestreview-424807881", "createdAt": "2020-06-04T20:35:16Z", "commit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMDozNToxNlrOGfW1sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMDozNToxNlrOGfW1sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzMzIzMg==", "bodyText": "Had to change this because files are filtered out otherwise.", "url": "https://github.com/apache/iceberg/pull/1094#discussion_r435533232", "createdAt": "2020-06-04T20:35:16Z", "author": {"login": "aokolnychyi"}, "path": "core/src/test/java/org/apache/iceberg/TableTestBase.java", "diffHunk": "@@ -56,25 +56,25 @@\n \n   static final DataFile FILE_A = DataFiles.builder(SPEC)\n       .withPath(\"/path/to/data-a.parquet\")\n-      .withFileSizeInBytes(0)\n+      .withFileSizeInBytes(10)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODYyNzQw", "url": "https://github.com/apache/iceberg/pull/1094#pullrequestreview-424862740", "createdAt": "2020-06-04T21:54:44Z", "commit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTo1NDo0NFrOGfZWtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTo1NDo0NFrOGfZWtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU3NDQ1NQ==", "bodyText": "What about not supporting this option for metadata tables? It doesn't seem necessary and if we can simplify this PR, that would be helpful.", "url": "https://github.com/apache/iceberg/pull/1094#discussion_r435574455", "createdAt": "2020-06-04T21:54:44Z", "author": {"login": "rdblue"}, "path": "core/src/main/java/org/apache/iceberg/AllDataFilesTable.java", "diffHunk": "@@ -85,19 +86,23 @@ public Schema schema() {\n \n     private AllDataFilesTableScan(\n         TableOperations ops, Table table, Long snapshotId, Schema schema, Expression rowFilter,\n-        boolean caseSensitive, boolean colStats, Collection<String> selectedColumns, Schema fileSchema,\n+        boolean ignoreResiduals, boolean caseSensitive, boolean colStats,\n+        Collection<String> selectedColumns, Schema fileSchema,\n         ImmutableMap<String, String> options) {\n-      super(ops, table, snapshotId, schema, rowFilter, caseSensitive, colStats, selectedColumns, options);\n+      super(\n+          ops, table, snapshotId, schema, rowFilter, ignoreResiduals,\n+          caseSensitive, colStats, selectedColumns, options);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODYzNTY1", "url": "https://github.com/apache/iceberg/pull/1094#pullrequestreview-424863565", "createdAt": "2020-06-04T21:56:17Z", "commit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTo1NjoxN1rOGfZZCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTo1NjoxN1rOGfZZCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU3NTA0OA==", "bodyText": "Test looks good.", "url": "https://github.com/apache/iceberg/pull/1094#discussion_r435575048", "createdAt": "2020-06-04T21:56:17Z", "author": {"login": "rdblue"}, "path": "core/src/test/java/org/apache/iceberg/TestDataTableScan.java", "diffHunk": "@@ -69,4 +74,36 @@ public void testTableScanHonorsSelectWithoutCaseSensitivity() {\n         scan2.schema().asStruct());\n   }\n \n+  @Test\n+  public void testTableScanHonorsIgnoreResiduals() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODk2NTE2", "url": "https://github.com/apache/iceberg/pull/1094#pullrequestreview-424896516", "createdAt": "2020-06-04T23:14:48Z", "commit": {"oid": "94644570c99ed3561325e59dd4e72fb6b674076e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4478, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}