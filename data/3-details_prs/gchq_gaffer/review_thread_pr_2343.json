{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMjg4NDUw", "number": 2343, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjo0OTozMFrOE6AEjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjo1NToyMlrOE6ANNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MjU0MDI5OnYy", "diffSide": "RIGHT", "path": "core/graph/src/main/java/uk/gov/gchq/gaffer/graph/Graph.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjo0OTozMFrOH0zTCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwOToyNzowN1rOH2T7zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEyODQ1OQ==", "bodyText": "Is this change needed? If it's just for the test then it would be better to indirectly call it from one of the public methods", "url": "https://github.com/gchq/Gaffer/pull/2343#discussion_r525128459", "createdAt": "2020-11-17T12:49:30Z", "author": {"login": "d47853"}, "path": "core/graph/src/main/java/uk/gov/gchq/gaffer/graph/Graph.java", "diffHunk": "@@ -350,22 +354,32 @@ public JobDetail executeJob(final Job job, final Context context) throws Operati\n         return new GraphResult<>(result, clonedContext);\n     }\n \n-    private void updateOperationChainView(final Operations<?> operations) {\n+    void updateOperationChainView(final Operations<?> operations) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8541087241882cab0064d85382b9d005a93f5fef"}, "originalPosition": 215}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjcxMTc1Ng==", "bodyText": "Sure thing, this is what I was trying to get at in the PR description - I'll refactor the test to work on the execute method and revert the visibility of the method.", "url": "https://github.com/gchq/Gaffer/pull/2343#discussion_r526711756", "createdAt": "2020-11-19T09:27:07Z", "author": {"login": "sw96411"}, "path": "core/graph/src/main/java/uk/gov/gchq/gaffer/graph/Graph.java", "diffHunk": "@@ -350,22 +354,32 @@ public JobDetail executeJob(final Job job, final Context context) throws Operati\n         return new GraphResult<>(result, clonedContext);\n     }\n \n-    private void updateOperationChainView(final Operations<?> operations) {\n+    void updateOperationChainView(final Operations<?> operations) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEyODQ1OQ=="}, "originalCommit": {"oid": "8541087241882cab0064d85382b9d005a93f5fef"}, "originalPosition": 215}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MjU0MTE3OnYy", "diffSide": "RIGHT", "path": "core/graph/src/test/java/uk/gov/gchq/gaffer/graph/GraphTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjo0OTo0NFrOH0zTkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwOToyODozMVrOH2T_gA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEyODU5Mw==", "bodyText": "There are a lot of changes to this file, most are whitespace from what I can tell. Please could you revert some of the whitespace changes so it's easier to review?", "url": "https://github.com/gchq/Gaffer/pull/2343#discussion_r525128593", "createdAt": "2020-11-17T12:49:44Z", "author": {"login": "d47853"}, "path": "core/graph/src/test/java/uk/gov/gchq/gaffer/graph/GraphTest.java", "diffHunk": "@@ -166,73 +167,41 @@ public void shouldConstructGraphFromSchemaModules() {\n         storeProperties.setStoreClass(TestStoreImpl.class.getName());\n \n         final Schema schemaModule1 = new Schema.Builder()\n-                .type(TestTypes.PROP_STRING, new TypeDefinition.Builder()\n-                        .clazz(String.class)\n-                        .build())\n-                .type(\"vertex\", new TypeDefinition.Builder()\n-                        .clazz(String.class)\n-                        .build())\n-                .edge(TestGroups.EDGE, new SchemaEdgeDefinition.Builder()\n-                        .property(TestPropertyNames.PROP_1, TestTypes.PROP_STRING)\n-                        .aggregate(false)\n-                        .source(\"vertex\")\n-                        .destination(\"vertex\")\n-                        .directed(DIRECTED_EITHER)\n-                        .build())\n+                .type(TestTypes.PROP_STRING, new TypeDefinition.Builder().clazz(String.class).build())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8541087241882cab0064d85382b9d005a93f5fef"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjcxMjcwNA==", "bodyText": "Sorry about that - was trying to setup my save actions to work with the Gaffer checkstyle and it looks like it's started merging lines (this also seems to have caused the measured test coverage % to drop) - I'll sort that out", "url": "https://github.com/gchq/Gaffer/pull/2343#discussion_r526712704", "createdAt": "2020-11-19T09:28:31Z", "author": {"login": "sw96411"}, "path": "core/graph/src/test/java/uk/gov/gchq/gaffer/graph/GraphTest.java", "diffHunk": "@@ -166,73 +167,41 @@ public void shouldConstructGraphFromSchemaModules() {\n         storeProperties.setStoreClass(TestStoreImpl.class.getName());\n \n         final Schema schemaModule1 = new Schema.Builder()\n-                .type(TestTypes.PROP_STRING, new TypeDefinition.Builder()\n-                        .clazz(String.class)\n-                        .build())\n-                .type(\"vertex\", new TypeDefinition.Builder()\n-                        .clazz(String.class)\n-                        .build())\n-                .edge(TestGroups.EDGE, new SchemaEdgeDefinition.Builder()\n-                        .property(TestPropertyNames.PROP_1, TestTypes.PROP_STRING)\n-                        .aggregate(false)\n-                        .source(\"vertex\")\n-                        .destination(\"vertex\")\n-                        .directed(DIRECTED_EITHER)\n-                        .build())\n+                .type(TestTypes.PROP_STRING, new TypeDefinition.Builder().clazz(String.class).build())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEyODU5Mw=="}, "originalCommit": {"oid": "8541087241882cab0064d85382b9d005a93f5fef"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MjU2MjQ2OnYy", "diffSide": "RIGHT", "path": "core/graph/src/test/java/uk/gov/gchq/gaffer/graph/GraphTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjo1NToyMlrOH0zgmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMjo1NToyMlrOH0zgmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTEzMTkyOA==", "bodyText": "Might be worth adding some integration tests into the federated store to check the behaviour", "url": "https://github.com/gchq/Gaffer/pull/2343#discussion_r525131928", "createdAt": "2020-11-17T12:55:22Z", "author": {"login": "d47853"}, "path": "core/graph/src/test/java/uk/gov/gchq/gaffer/graph/GraphTest.java", "diffHunk": "@@ -2418,20 +1970,94 @@ public void shouldNotAddDefaultSecurityHooksIfAlreadyAdded() {\n         TestStore.mockStore = mock(Store.class);\n         given(TestStore.mockStore.isSupported(NamedOperation.class)).willReturn(true);\n         // When\n-        final GraphConfig config = new GraphConfig.Builder()\n-                .graphId(\"test\")\n-                .addHook(new FunctionAuthoriser(Lists.newArrayList(Identity.class)))\n+        final GraphConfig config = new GraphConfig.Builder().graphId(\"test\")\n+                .addHook(new FunctionAuthoriser(Lists.newArrayList(Identity.class))).build();\n+\n+        final Graph graph = new Graph.Builder().addSchemas(StreamUtil.schemas(getClass()))\n+                .storeProperties(storeProperties).config(config).build();\n+\n+        // Then\n+        assertEquals(Arrays.asList(NamedOperationResolver.class, NamedViewResolver.class, FunctionAuthoriser.class),\n+                graph.getGraphHooks());\n+        assertEquals(Identity.class,\n+                ((FunctionAuthoriser) graph.getConfig().getHooks().get(2)).getUnauthorisedFunctions().get(0));\n+    }\n+\n+    @Test\n+    public void shouldExpandGlobalEdges() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8541087241882cab0064d85382b9d005a93f5fef"}, "originalPosition": 1825}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4310, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}