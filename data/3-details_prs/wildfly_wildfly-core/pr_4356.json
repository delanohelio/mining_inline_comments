{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NzYxMjY5", "number": 4356, "title": " [WFCORE-2687] Addition of getCurrentOperationName() and getCurrentOperationParameter(String name) methods", "bodyText": "https://issues.redhat.com/browse/WFCORE-2687", "createdAt": "2020-10-08T08:47:56Z", "url": "https://github.com/wildfly/wildfly-core/pull/4356", "merged": true, "mergeCommit": {"oid": "2e531435f74a9ecb87f555b46449bdf439ae7271"}, "closed": true, "closedAt": "2021-01-28T12:14:41Z", "author": {"login": "lvydra"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQgkXBAH2gAyNDk5NzYxMjY5OmEwOGIwOTNlZmVmMzE1OTk5ZDZhNmU5MWZjMjk3MDczNGE3ZmE2OTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd0bKmrgFqTU3NzkzNTQ0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690", "author": {"user": {"login": "lvydra", "name": null}}, "url": "https://github.com/wildfly/wildfly-core/commit/a08b093efef315999d6a6e91fc2970734a7fa690", "committedDate": "2020-10-08T12:16:42Z", "message": " [WFCORE-2687] Methods getCurrentOperationName() and getCurrentOperationParameter(String name) added"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f9953f7e00fb6322225499c23b075b00d62d322", "author": {"user": {"login": "lvydra", "name": null}}, "url": "https://github.com/wildfly/wildfly-core/commit/8f9953f7e00fb6322225499c23b075b00d62d322", "committedDate": "2020-10-08T12:15:44Z", "message": "[WFCORE-2687] Add OperationContext implementation"}, "afterCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690", "author": {"user": {"login": "lvydra", "name": null}}, "url": "https://github.com/wildfly/wildfly-core/commit/a08b093efef315999d6a6e91fc2970734a7fa690", "committedDate": "2020-10-08T12:16:42Z", "message": " [WFCORE-2687] Methods getCurrentOperationName() and getCurrentOperationParameter(String name) added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NjA4MDM3", "url": "https://github.com/wildfly/wildfly-core/pull/4356#pullrequestreview-544608037", "createdAt": "2020-12-04T02:13:38Z", "commit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwMjoxMzozOFrOH-9sTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwMjozMzoxMFrOH--GAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc4NDUyNQ==", "bodyText": "@lvydra Please remove 'parameterName.equals(NAME) 'from this. My apologies; I should not have listed 'name' as an invalid key in the JIRA description. I've corrected the JIRA description.", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535784525", "createdAt": "2020-12-04T02:13:38Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/AbstractOperationContext.java", "diffHunk": "@@ -541,6 +541,41 @@ public final String getCurrentAddressValue() {\n         return pa.getLastElement().getValue();\n     }\n \n+    @Override\n+    public final ModelNode getCurrentOperationName() {\n+        assert activeStep != null;\n+        ModelNode operation = activeStep.operation;\n+\n+        assert operation != null;\n+        return operation.get(NAME);\n+    }\n+\n+    @Override\n+    public final ModelNode getCurrentOperationParameter(final String parameterName) {\n+        return getCurrentOperationParameter(parameterName, true);\n+    }\n+\n+    @Override\n+    public final ModelNode getCurrentOperationParameter(final String parameterName, boolean nullable) {\n+        if (isLegalParameterName(parameterName)) {\n+            assert activeStep != null;\n+            ModelNode operation = activeStep.operation;\n+\n+            assert operation != null;\n+            if (!operation.has(parameterName) && nullable) {\n+                return null;\n+            } else {\n+                return operation.get(parameterName);\n+            }\n+        } else {\n+            throw new IllegalArgumentException(ControllerLogger.ROOT_LOGGER.invalidParameterName(parameterName));\n+        }\n+    }\n+\n+    private boolean isLegalParameterName(final String parameterName) {\n+        return !(parameterName.equals(NAME) || parameterName.equals(OP) || parameterName.equals(OP_ADDR) || parameterName.equals(OPERATION_HEADERS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc4NjUzNQ==", "bodyText": "The return type here should be IllegalArgumentException, as that is what you intend to throw.", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535786535", "createdAt": "2020-12-04T02:19:25Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/logging/ControllerLogger.java", "diffHunk": "@@ -3629,4 +3629,7 @@ OperationFailedRuntimeException capabilityAlreadyRegisteredInContext(String capa\n \n     @Message(id = 476, value = \"Value for attribute '%s' is invalid: either '%s' must be specified on its own or '%s' needs to be specified with at least one of '%s' or '%s'\")\n     OperationFailedException invalidCredentialReferenceValue(String attributeName, String clearTextAttributeName, String credentialStoreAttributeName, String clearTextAttributeName1, String alias);\n+\n+    @Message(id = 477, value = \"Parameter name '%s' is invalid.\")\n+    OperationFailedException invalidParameterName(String parameterName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc4NjgyMg==", "bodyText": "ControllerLogger.ROOT_LOGGER.invalidParameterName should return IllegalArgumentException so you can just throw what it returns without wrapping.", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535786822", "createdAt": "2020-12-04T02:20:18Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/AbstractOperationContext.java", "diffHunk": "@@ -541,6 +541,41 @@ public final String getCurrentAddressValue() {\n         return pa.getLastElement().getValue();\n     }\n \n+    @Override\n+    public final ModelNode getCurrentOperationName() {\n+        assert activeStep != null;\n+        ModelNode operation = activeStep.operation;\n+\n+        assert operation != null;\n+        return operation.get(NAME);\n+    }\n+\n+    @Override\n+    public final ModelNode getCurrentOperationParameter(final String parameterName) {\n+        return getCurrentOperationParameter(parameterName, true);\n+    }\n+\n+    @Override\n+    public final ModelNode getCurrentOperationParameter(final String parameterName, boolean nullable) {\n+        if (isLegalParameterName(parameterName)) {\n+            assert activeStep != null;\n+            ModelNode operation = activeStep.operation;\n+\n+            assert operation != null;\n+            if (!operation.has(parameterName) && nullable) {\n+                return null;\n+            } else {\n+                return operation.get(parameterName);\n+            }\n+        } else {\n+            throw new IllegalArgumentException(ControllerLogger.ROOT_LOGGER.invalidParameterName(parameterName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc4ODQwMg==", "bodyText": "This should also say 'or {@code null} if the operation has no such parameter'.", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535788402", "createdAt": "2020-12-04T02:25:01Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/OperationContext.java", "diffHunk": "@@ -418,6 +418,30 @@\n      */\n     String getCurrentAddressValue();\n \n+    /**\n+     * Get the node with current operation name\n+     *\n+     * @return operation name node\n+     */\n+    ModelNode getCurrentOperationName();\n+\n+    /**\n+     * Get parameter node by its name\n+     *\n+     * @param name of desired parameter\n+     * @return node for parameter of given name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc4ODY5Mg==", "bodyText": "This should return String. The node will always hold a string.", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535788692", "createdAt": "2020-12-04T02:25:53Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/OperationContext.java", "diffHunk": "@@ -418,6 +418,30 @@\n      */\n     String getCurrentAddressValue();\n \n+    /**\n+     * Get the node with current operation name\n+     *\n+     * @return operation name node\n+     */\n+    ModelNode getCurrentOperationName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc5MDg0OA==", "bodyText": "whether the return value can be null if the operation has no parameter with the given name", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535790848", "createdAt": "2020-12-04T02:32:19Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/OperationContext.java", "diffHunk": "@@ -418,6 +418,30 @@\n      */\n     String getCurrentAddressValue();\n \n+    /**\n+     * Get the node with current operation name\n+     *\n+     * @return operation name node\n+     */\n+    ModelNode getCurrentOperationName();\n+\n+    /**\n+     * Get parameter node by its name\n+     *\n+     * @param name of desired parameter\n+     * @return node for parameter of given name\n+     */\n+    ModelNode getCurrentOperationParameter(String name);\n+\n+    /**\n+     * Get parameter node by its name\n+     *\n+     * @param name of desired parameter\n+     * @param nullable whether return value can be null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc5MTEwNw==", "bodyText": "node for the parameter of the given name, or {@code null} if {@code nullable} is {@code true} and the operation has no parameter with the given name", "url": "https://github.com/wildfly/wildfly-core/pull/4356#discussion_r535791107", "createdAt": "2020-12-04T02:33:10Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/OperationContext.java", "diffHunk": "@@ -418,6 +418,30 @@\n      */\n     String getCurrentAddressValue();\n \n+    /**\n+     * Get the node with current operation name\n+     *\n+     * @return operation name node\n+     */\n+    ModelNode getCurrentOperationName();\n+\n+    /**\n+     * Get parameter node by its name\n+     *\n+     * @param name of desired parameter\n+     * @return node for parameter of given name\n+     */\n+    ModelNode getCurrentOperationParameter(String name);\n+\n+    /**\n+     * Get parameter node by its name\n+     *\n+     * @param name of desired parameter\n+     * @param nullable whether return value can be null\n+     * @return node for parameter of given name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a08b093efef315999d6a6e91fc2970734a7fa690"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f888b11b27efd4bc108c3efe9295d2a2e3324691", "author": {"user": {"login": "lvydra", "name": null}}, "url": "https://github.com/wildfly/wildfly-core/commit/f888b11b27efd4bc108c3efe9295d2a2e3324691", "committedDate": "2020-12-04T12:19:04Z", "message": "[WFCORE-2687] Requested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc3OTM1NDQx", "url": "https://github.com/wildfly/wildfly-core/pull/4356#pullrequestreview-577935441", "createdAt": "2021-01-28T02:20:19Z", "commit": {"oid": "f888b11b27efd4bc108c3efe9295d2a2e3324691"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3384, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}