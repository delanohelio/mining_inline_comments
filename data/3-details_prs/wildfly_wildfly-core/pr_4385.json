{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1OTU5MDA0", "number": 4385, "title": "[WFCORE-4135] Support for read only server configuration directory", "bodyText": "This PR supersedes #4104\nWildFly proposal can be found here: wildfly/wildfly-proposals#304. It allows to start the server if we are using --read-only-server-config and the server configuration directory is a read-only directory. Only in that case, the history root directory falls back to the server temporal directory.\nJira issue: https://issues.redhat.com/browse/WFCORE-4135", "createdAt": "2020-11-05T10:30:38Z", "url": "https://github.com/wildfly/wildfly-core/pull/4385", "merged": true, "mergeCommit": {"oid": "85f4c3f7d4aa03fd716fb708268795f4fdc008cd"}, "closed": true, "closedAt": "2020-12-04T21:47:55Z", "author": {"login": "yersan"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbfvs4gBqjM5ODQzODMzMDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdi7y4TAFqTU0NTE4NzI4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "310fa7f3015cc4a3124471d33d7b6c5502238e11", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/310fa7f3015cc4a3124471d33d7b6c5502238e11", "committedDate": "2020-11-05T09:45:03Z", "message": "[WFCORE-4135] Test server is able to start with a read only config directory"}, "afterCommit": {"oid": "60eaf2028f5a486e699e671e960842c07cdf567b", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/60eaf2028f5a486e699e671e960842c07cdf567b", "committedDate": "2020-11-11T15:32:02Z", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MTM4NTE1", "url": "https://github.com/wildfly/wildfly-core/pull/4385#pullrequestreview-536138515", "createdAt": "2020-11-23T01:04:50Z", "commit": {"oid": "60eaf2028f5a486e699e671e960842c07cdf567b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTowNDo1MFrOH39ESg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMToxNTo0NFrOH39JxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNDI1MA==", "bodyText": "Please add javadoc for the useGit param.", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528434250", "createdAt": "2020-11-23T01:04:50Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -151,6 +152,20 @@ public ConfigurationFile(final File configurationDir, final String rawName, fina\n         this(configurationDir, rawName, name, persistOriginal ? InteractionPolicy.STANDARD : InteractionPolicy.READ_ONLY, false);\n     }\n \n+    /**\n+     * Creates a new ConfigurationFile.\n+     *\n+     * @param configurationDir  directory in which configuration files are stored. Cannot be {@code null} and must exist\n+     *                          and be a directory\n+     * @param rawName           default name for configuration files of the type handled by this object.\n+     *                          Cannot be {@code null} or an empty string\n+     * @param name              user provided name of the configuration file to use\n+     * @param interactionPolicy policy governing interaction with the configuration file.\n+     */\n+    public ConfigurationFile(final File configurationDir, final String rawName, final String name, final InteractionPolicy interactionPolicy, final boolean useGit) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60eaf2028f5a486e699e671e960842c07cdf567b"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNDI4Mg==", "bodyText": "Please add javadoc for the tmpDir param.", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528434282", "createdAt": "2020-11-23T01:05:07Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -163,19 +178,22 @@ public ConfigurationFile(final File configurationDir, final String rawName, fina\n      * @param useGit {@code true} if configuration is using Git to manage its history.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60eaf2028f5a486e699e671e960842c07cdf567b"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNTY1Mw==", "bodyText": "I believe this can be package protected. If so, please make it package protected.", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528435653", "createdAt": "2020-11-23T01:15:44Z", "author": {"login": "bstansberry"}, "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -478,6 +496,9 @@ public File getConfigurationDir(){\n         return configurationDir;\n     }\n \n+    public File getConfigurationTmpDir() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60eaf2028f5a486e699e671e960842c07cdf567b"}, "originalPosition": 59}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60eaf2028f5a486e699e671e960842c07cdf567b", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/60eaf2028f5a486e699e671e960842c07cdf567b", "committedDate": "2020-11-11T15:32:02Z", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory"}, "afterCommit": {"oid": "dc693956d6e9d9ce2827740441bc4c697fe31959", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/dc693956d6e9d9ce2827740441bc4c697fe31959", "committedDate": "2020-11-23T11:34:58Z", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NzU0Nzky", "url": "https://github.com/wildfly/wildfly-core/pull/4385#pullrequestreview-544754792", "createdAt": "2020-12-04T08:43:36Z", "commit": {"oid": "dc693956d6e9d9ce2827740441bc4c697fe31959"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwODo0MzozNlrOH_GfUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwODo0MzozNlrOH_GfUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyODY1OQ==", "bodyText": "Do you rather mean temporary directory?", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r535928659", "createdAt": "2020-12-04T08:43:36Z", "author": {"login": "jmesnil"}, "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -154,28 +155,48 @@ public ConfigurationFile(final File configurationDir, final String rawName, fina\n     /**\n      * Creates a new ConfigurationFile.\n      *\n-     * @param configurationDir directory in which configuration files are stored. Cannot be {@code null} and must exist\n-     *                         and be a directory\n-     * @param rawName default name for configuration files of the type handled by this object.\n-     *                Cannot be {@code null} or an empty string\n-     * @param name user provided name of the configuration file to use\n-     * @param interactionPolicy policy governing interaction with the configuration file\n-     * @param useGit {@code true} if configuration is using Git to manage its history.\n+     * @param configurationDir  directory in which configuration files are stored. Cannot be {@code null} and must exist\n+     *                          and be a directory\n+     * @param rawName           default name for configuration files of the type handled by this object.\n+     *                          Cannot be {@code null} or an empty string\n+     * @param name              user provided name of the configuration file to use\n+     * @param interactionPolicy policy governing interaction with the configuration file.\n+     * @param useGit            {@code true} if configuration is using Git to manage its history.\n+     */\n+    public ConfigurationFile(final File configurationDir, final String rawName, final String name, final InteractionPolicy interactionPolicy, final boolean useGit) {\n+        this(configurationDir, rawName, name, interactionPolicy, useGit, null);\n+    }\n+\n+    /**\n+     * Creates a new ConfigurationFile.\n+     *\n+     * @param configurationDir  directory in which configuration files are stored. Cannot be {@code null} and must exist\n+     *                          and be a directory.\n+     * @param rawName           default name for configuration files of the type handled by this object.\n+     *                          Cannot be {@code null} or an empty string.\n+     * @param name              user provided name of the configuration file to use.\n+     * @param interactionPolicy policy governing interaction with the configuration file.\n+     * @param useGit            {@code true} if configuration is using Git to manage its history.\n+     * @param tmpDir            The server temporal directory to use as a fallback if the configuration directory cannot", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc693956d6e9d9ce2827740441bc4c697fe31959"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c81d065e4fc67bf0bd5588cd65868446223a6e57", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/c81d065e4fc67bf0bd5588cd65868446223a6e57", "committedDate": "2020-12-04T08:53:08Z", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc693956d6e9d9ce2827740441bc4c697fe31959", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/dc693956d6e9d9ce2827740441bc4c697fe31959", "committedDate": "2020-11-23T11:34:58Z", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory"}, "afterCommit": {"oid": "c81d065e4fc67bf0bd5588cd65868446223a6e57", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/c81d065e4fc67bf0bd5588cd65868446223a6e57", "committedDate": "2020-12-04T08:53:08Z", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MTg3Mjgw", "url": "https://github.com/wildfly/wildfly-core/pull/4385#pullrequestreview-545187280", "createdAt": "2020-12-04T18:10:38Z", "commit": {"oid": "c81d065e4fc67bf0bd5588cd65868446223a6e57"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3314, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}