{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3OTgxMTI5", "number": 4245, "title": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer", "bodyText": "Jira: https://issues.redhat.com/browse/WFCORE-4994\nTo pass CI, this will require an Elytron upgrade.\nAnalysis Document: wildfly/wildfly-proposals#315\nRequires: https://issues.redhat.com/browse/ELY-1987\nElytron PR with tests: wildfly-security/wildfly-elytron#1418\nWildfly PR with tests and documentation updates: wildfly/wildfly#13379", "createdAt": "2020-06-22T14:28:09Z", "url": "https://github.com/wildfly/wildfly-core/pull/4245", "merged": true, "mergeCommit": {"oid": "493c46ea8142888d1ac9e814ec733468b8ec6310"}, "closed": true, "closedAt": "2020-12-07T14:21:15Z", "author": {"login": "SoniaZaldana"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABct0Cj0AFqTQzNTA2MjEyMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdi4VDCABqjQwNzI4NTI3MDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MDYyMTIz", "url": "https://github.com/wildfly/wildfly-core/pull/4245#pullrequestreview-435062123", "createdAt": "2020-06-22T15:56:36Z", "commit": {"oid": "7e3b6898bdaba6ecd6dd90ced02ebc3db5336558"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNTo1NjozNlrOGnHBhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNTo1NjozNlrOGnHBhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY2MjcyNA==", "bodyText": "Just minor but would be good to add a comment here that the realm contains \"USER8\"", "url": "https://github.com/wildfly/wildfly-core/pull/4245#discussion_r443662724", "createdAt": "2020-06-22T15:56:36Z", "author": {"login": "fjuma"}, "path": "elytron/src/test/java/org/wildfly/extension/elytron/DomainTestCase.java", "diffHunk": "@@ -109,6 +109,43 @@ private void init() throws Exception {\n         TestEnvironment.activateService(services, Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY, \"SubjectAltNameEvidenceDecoderDomain\");\n         TestEnvironment.activateService(services, Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY, \"SubjectEvidenceDecoderDomain\");\n         TestEnvironment.activateService(services, Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY, \"SourceAddressRoleDecoderDomain\");\n+        TestEnvironment.activateService(services, Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY, \"LowerCasePrincipalTransformerDomain\");\n+        TestEnvironment.activateService(services, Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY, \"UpperCasePrincipalTransformerDomain\");\n+\n+    }\n+\n+    @Test\n+    public void testCasePrincipalTransformerLowerCase() throws Exception {\n+        init();\n+        ServiceName serviceName = Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY.getCapabilityServiceName(\"LowerCasePrincipalTransformerDomain\");\n+        SecurityDomain domain = (SecurityDomain) services.getContainer().getService(serviceName).getValue();\n+        Assert.assertNotNull(domain);\n+\n+        ServerAuthenticationContext context = domain.createNewAuthenticationContext();\n+        context.setAuthenticationName(\"USER1\"); // the realm contains \"user1\"\n+        Assert.assertTrue(context.exists());\n+        context.authorize();\n+        context.succeed();\n+\n+        SecurityIdentity identity = context.getAuthorizedIdentity();\n+        Assert.assertEquals(\"user1\", identity.getPrincipal().getName()); // after pre-realm-name-rewriter only\n+    }\n+\n+    @Test\n+    public void testCasePrincipalTransformerUpperCase() throws Exception {\n+        init();\n+        ServiceName serviceName = Capabilities.SECURITY_DOMAIN_RUNTIME_CAPABILITY.getCapabilityServiceName(\"UpperCasePrincipalTransformerDomain\");\n+        SecurityDomain domain = (SecurityDomain) services.getContainer().getService(serviceName).getValue();\n+        Assert.assertNotNull(domain);\n+\n+        ServerAuthenticationContext context = domain.createNewAuthenticationContext();\n+        context.setAuthenticationName(\"user8\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e3b6898bdaba6ecd6dd90ced02ebc3db5336558"}, "originalPosition": 34}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e3b6898bdaba6ecd6dd90ced02ebc3db5336558", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/7e3b6898bdaba6ecd6dd90ced02ebc3db5336558", "committedDate": "2020-06-18T19:08:05Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "3d1ce210d96bcf6b588c479ffe8f51797680581d", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/3d1ce210d96bcf6b588c479ffe8f51797680581d", "committedDate": "2020-06-22T17:25:44Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MDg5OTU1", "url": "https://github.com/wildfly/wildfly-core/pull/4245#pullrequestreview-456089955", "createdAt": "2020-07-27T19:56:40Z", "commit": {"oid": "3d1ce210d96bcf6b588c479ffe8f51797680581d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d1ce210d96bcf6b588c479ffe8f51797680581d", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/3d1ce210d96bcf6b588c479ffe8f51797680581d", "committedDate": "2020-06-22T17:25:44Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "c9980cedcd2099e6c49283d1178bf6988138d511", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/c9980cedcd2099e6c49283d1178bf6988138d511", "committedDate": "2020-07-27T20:41:53Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9980cedcd2099e6c49283d1178bf6988138d511", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/c9980cedcd2099e6c49283d1178bf6988138d511", "committedDate": "2020-07-27T20:41:53Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "9a257d67ce6bf06b94e8477ae3430f62707a0e9d", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/9a257d67ce6bf06b94e8477ae3430f62707a0e9d", "committedDate": "2020-09-08T15:40:18Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a257d67ce6bf06b94e8477ae3430f62707a0e9d", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/9a257d67ce6bf06b94e8477ae3430f62707a0e9d", "committedDate": "2020-09-08T15:40:18Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "122f322594b5d275486c524ba324c9df3f30aa68", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/122f322594b5d275486c524ba324c9df3f30aa68", "committedDate": "2020-09-23T17:53:02Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "122f322594b5d275486c524ba324c9df3f30aa68", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/122f322594b5d275486c524ba324c9df3f30aa68", "committedDate": "2020-09-23T17:53:02Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "cb0eb71a1c61206a9c0a8e83eebe6d9b423e8532", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/cb0eb71a1c61206a9c0a8e83eebe6d9b423e8532", "committedDate": "2020-09-23T18:06:27Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0OTU5MDQx", "url": "https://github.com/wildfly/wildfly-core/pull/4245#pullrequestreview-494959041", "createdAt": "2020-09-23T18:56:08Z", "commit": {"oid": "68ad4d8bd752e88c516c4394ca439b9b6615d822"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxODo1NjowOFrOHW8k9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxODo1NjowOFrOHW8k9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzgyMzIyMw==", "bodyText": "Before, you had updated ElytronSubsystemParser10_0.java (i.e., the previous parser), to update the return value to return new MapperParser(MapperParser.Version.VERSION_6_0).getParser();. That change should be removed from that file and added here instead (since now ElytronSubsystemParser11_0.java is the previous parser).", "url": "https://github.com/wildfly/wildfly-core/pull/4245#discussion_r493823223", "createdAt": "2020-09-23T18:56:08Z", "author": {"login": "fjuma"}, "path": "elytron/src/main/java/org/wildfly/extension/elytron/ElytronSubsystemParser11_0.java", "diffHunk": "@@ -33,11 +33,6 @@ String getNameSpace() {\n         return ElytronExtension.NAMESPACE_11_0;\n     }\n \n-    @Override\n-    protected PersistentResourceXMLDescription getMapperParser() {\n-        return new MapperParser().getParser();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68ad4d8bd752e88c516c4394ca439b9b6615d822"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68ad4d8bd752e88c516c4394ca439b9b6615d822", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/68ad4d8bd752e88c516c4394ca439b9b6615d822", "committedDate": "2020-09-23T18:48:54Z", "message": "[WFCORE-4994] Switching to subsystem version 12"}, "afterCommit": {"oid": "59fbe7f257f6387e200d64479543460f020f9a16", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/59fbe7f257f6387e200d64479543460f020f9a16", "committedDate": "2020-09-23T20:29:37Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59fbe7f257f6387e200d64479543460f020f9a16", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/59fbe7f257f6387e200d64479543460f020f9a16", "committedDate": "2020-09-23T20:29:37Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "d3300b433e7534b9e4b4d4a6f172180dd6d2673d", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/d3300b433e7534b9e4b4d4a6f172180dd6d2673d", "committedDate": "2020-09-24T14:48:29Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d3300b433e7534b9e4b4d4a6f172180dd6d2673d", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/d3300b433e7534b9e4b4d4a6f172180dd6d2673d", "committedDate": "2020-09-24T14:48:29Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "e57708b2e809bbff66e094981f352f348d3cbbc1", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/e57708b2e809bbff66e094981f352f348d3cbbc1", "committedDate": "2020-09-24T14:56:13Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1Njk0NjQy", "url": "https://github.com/wildfly/wildfly-core/pull/4245#pullrequestreview-495694642", "createdAt": "2020-09-24T15:28:24Z", "commit": {"oid": "e57708b2e809bbff66e094981f352f348d3cbbc1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e57708b2e809bbff66e094981f352f348d3cbbc1", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/e57708b2e809bbff66e094981f352f348d3cbbc1", "committedDate": "2020-09-24T14:56:13Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "f6876141d7dd7642bc2ca09728c65873b446ac90", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/f6876141d7dd7642bc2ca09728c65873b446ac90", "committedDate": "2020-11-26T20:15:31Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MzA2NTQw", "url": "https://github.com/wildfly/wildfly-core/pull/4245#pullrequestreview-544306540", "createdAt": "2020-12-03T19:25:17Z", "commit": {"oid": "f6876141d7dd7642bc2ca09728c65873b446ac90"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dff99099b45423a1dc5d5cf105c6e4bbaaade076", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/dff99099b45423a1dc5d5cf105c6e4bbaaade076", "committedDate": "2020-12-04T14:08:06Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f6876141d7dd7642bc2ca09728c65873b446ac90", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/f6876141d7dd7642bc2ca09728c65873b446ac90", "committedDate": "2020-11-26T20:15:31Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}, "afterCommit": {"oid": "dff99099b45423a1dc5d5cf105c6e4bbaaade076", "author": {"user": {"login": "SoniaZaldana", "name": "Sonia"}}, "url": "https://github.com/wildfly/wildfly-core/commit/dff99099b45423a1dc5d5cf105c6e4bbaaade076", "committedDate": "2020-12-04T14:08:06Z", "message": "[WFCORE-4994] Add the ability to adjust the case of a user name using an Elytron principal transformer"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3424, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}