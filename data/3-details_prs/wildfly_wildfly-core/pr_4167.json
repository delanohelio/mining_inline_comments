{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1MDEwMzEy", "number": 4167, "title": "[WFCORE-4922] Fix possible hang starting the embedded host and server", "bodyText": "Rollbacks the changes done in #4119 for the embedded server and fix the hang reading the process state for the embedded host controller\nJira issue: https://issues.redhat.com/browse/WFCORE-4922", "createdAt": "2020-04-17T08:58:58Z", "url": "https://github.com/wildfly/wildfly-core/pull/4167", "merged": true, "mergeCommit": {"oid": "2b844d9a20f3fee894977e6987427213d9893091"}, "closed": true, "closedAt": "2020-04-23T07:57:34Z", "author": {"login": "yersan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZoSKnAFqTM5NjkwMjY4NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaNwjrgFqTM5ODUyOTUyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2OTAyNjg0", "url": "https://github.com/wildfly/wildfly-core/pull/4167#pullrequestreview-396902684", "createdAt": "2020-04-21T00:10:14Z", "commit": {"oid": "c1c217a784283e1f9413bc08da5bce16dd5061f9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwMDoxMDoxNFrOGIs0NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwMDoxMDoxNFrOGIs0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTc3NjA1Mw==", "bodyText": "I believe status == null is a likely scenario while the host is starting. HostControllerImpl.currentProcessState starts as null and won't change to something else until it receives a notification of a change via ProcessStateNotifier.", "url": "https://github.com/wildfly/wildfly-core/pull/4167#discussion_r411776053", "createdAt": "2020-04-21T00:10:14Z", "author": {"login": "bstansberry"}, "path": "cli/src/main/java/org/jboss/as/cli/embedded/EmbedHostControllerHandler.java", "diffHunk": "@@ -276,7 +276,7 @@ protected void doHandle(CommandContext ctx) throws CommandLineException {\n                 do {\n                     status = hostController.getProcessState();\n \n-                    if (status == null || \"starting\".equals(status)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1c217a784283e1f9413bc08da5bce16dd5061f9"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2OTAzODIz", "url": "https://github.com/wildfly/wildfly-core/pull/4167#pullrequestreview-396903823", "createdAt": "2020-04-21T00:13:43Z", "commit": {"oid": "c1c217a784283e1f9413bc08da5bce16dd5061f9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwMDoxMzo0M1rOGIs5OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwMDoxMzo0M1rOGIs5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTc3NzMzNw==", "bodyText": "If you put a message here it really should be internationalized.\nA plain no-message UOE with a code comment should be enough. I think it would be a developer messing around who would hit this, not a user. They can analyze the stack trace find the code and read the comment.", "url": "https://github.com/wildfly/wildfly-core/pull/4167#discussion_r411777337", "createdAt": "2020-04-21T00:13:43Z", "author": {"login": "bstansberry"}, "path": "embedded/src/main/java/org/wildfly/core/embedded/EmbeddedStandaloneServerFactory.java", "diffHunk": "@@ -341,10 +341,7 @@ public void stop() {\n \n         @Override\n         public String getProcessState() {\n-            if (currentProcessState == null) {\n-                return null;\n-            }\n-            return currentProcessState.toString();\n+            throw new UnsupportedOperationException(\"The access to the internal process state is unsupported for this standalone embedded server\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1c217a784283e1f9413bc08da5bce16dd5061f9"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f378bbdb365a102239325e8589e7842a98ab7c66", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/f378bbdb365a102239325e8589e7842a98ab7c66", "committedDate": "2020-04-22T08:37:50Z", "message": "[WFCORE-4922] Fix possible hang starting the embedded host and server\n- Basically it rollbacks the changes done in https://issues.redhat.com/browse/WFCORE-4893 for the embedded server and fix the possible hang reading the process state for the embeddded host controller\n\njira issue: https://issues.redhat.com/browse/WFCORE-4922"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1c217a784283e1f9413bc08da5bce16dd5061f9", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/c1c217a784283e1f9413bc08da5bce16dd5061f9", "committedDate": "2020-04-17T08:40:51Z", "message": "[WFCORE-4922] Fix possible hang starting the embedded host and server\n- Basically it rollbacks the changes done in https://issues.redhat.com/browse/WFCORE-4893 for the embedded server and fix the possible hang reading the process state for the embeddded host controller\n\njira issue: https://issues.redhat.com/browse/WFCORE-4922"}, "afterCommit": {"oid": "f378bbdb365a102239325e8589e7842a98ab7c66", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly-core/commit/f378bbdb365a102239325e8589e7842a98ab7c66", "committedDate": "2020-04-22T08:37:50Z", "message": "[WFCORE-4922] Fix possible hang starting the embedded host and server\n- Basically it rollbacks the changes done in https://issues.redhat.com/browse/WFCORE-4893 for the embedded server and fix the possible hang reading the process state for the embeddded host controller\n\njira issue: https://issues.redhat.com/browse/WFCORE-4922"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NTI5NTI1", "url": "https://github.com/wildfly/wildfly-core/pull/4167#pullrequestreview-398529525", "createdAt": "2020-04-22T19:49:55Z", "commit": {"oid": "f378bbdb365a102239325e8589e7842a98ab7c66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3478, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}