{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwMjkxODg5", "number": 4291, "title": "[WFCORE-5076] The \"remoting-http-upgrade-service\" should be ACTIVE.", "bodyText": "https://issues.redhat.com/browse/WFCORE-5076\nThis is the simplest fix for the issue, a missing dependencies error is now reported:\n17:02:54,850 ERROR [org.jboss.as.controller.management-operation] (Controller Boot Thread) WFLYCTL0013: Operation (\"add\") failed - address: ([\n    (\"subsystem\" => \"remoting\"),\n    (\"http-connector\" => \"http-remoting-connector\")\n]) - failure description: {\n    \"WFLYCTL0412: Required services that are not installed:\" => [\"org.wildfly.core.management.security.realm.OtherRealm\"],\n    \"WFLYCTL0180: Services with missing/unavailable dependencies\" => [\"jboss.remoting.remoting-http-upgrade-service.http-remoting-connector is missing [org.wildfly.core.management.security.realm.OtherRealm]\"]\n}\n\nThis service does not have it's own dependants so I don't really see a justification for a resource defined in the remoting subsystem to come up if it can, if not wait for a client to connect with an obscure error message.\nWe could handle this with capabilities if we wanted as an alternative we have just been trying to avoid spending time converting legacy security realms to capabilities as they are deprecated but if that is seen as the more correct fix that may be required.\nNote: Once legacy security is removed the Elytron sasl-authentication-factory attribute is capability based so does not suffer the same issue here.\nThis PR also contains the following fixes to adjust the remoting layer(s):\nhttps://issues.redhat.com/browse/WFCORE-5078\nhttps://issues.redhat.com/browse/WFCORE-5082\nThe end result of the two layers can be seen in the following gist, in each case the gist was populated with files from a server provisioned with \"web-server\" only then either \"remoting\" or \"legacy-remoting\" were added so the effect of the change can be seen:\nhttps://gist.github.com/darranl/5503feaf0ab547fdde5622bd31de8dad/revisions", "createdAt": "2020-07-31T16:21:25Z", "url": "https://github.com/wildfly/wildfly-core/pull/4291", "merged": true, "mergeCommit": {"oid": "29356b6f475aeeebf201297b9cbedab50b73084a"}, "closed": true, "closedAt": "2020-08-13T18:34:51Z", "author": {"login": "darranl"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7N21-gFqTQ1OTg0NTkyOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-H7D9AFqTQ2NTc0MTExMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODQ1OTI5", "url": "https://github.com/wildfly/wildfly-core/pull/4291#pullrequestreview-459845929", "createdAt": "2020-08-03T08:36:17Z", "commit": {"oid": "00c4cc1891f477ccfc3b719969cfd42095248e42"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00c4cc1891f477ccfc3b719969cfd42095248e42", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/00c4cc1891f477ccfc3b719969cfd42095248e42", "committedDate": "2020-07-31T16:05:05Z", "message": "[WFCORE-5076] The \"remoting-http-upgrade-service\" should be ACTIVE."}, "afterCommit": {"oid": "1b9790684e2d3e229a2918578fed4ad1a448b8c0", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/1b9790684e2d3e229a2918578fed4ad1a448b8c0", "committedDate": "2020-08-05T16:22:53Z", "message": "[WFCORE-5078] Update the \"remoting\" layer to use a sasl-authentication-factory and ensure it depends on the the elytron layer."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNjgxMTUx", "url": "https://github.com/wildfly/wildfly-core/pull/4291#pullrequestreview-462681151", "createdAt": "2020-08-06T16:29:40Z", "commit": {"oid": "e88bad85a7a5cb2e26876f22e19f4ec1d6fa6821"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNjoyOTo0MFrOG87H0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNjoyOTo0MFrOG87H0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUzNjQwMg==", "bodyText": "Hi @darranl , I don't get this point, why io Galleon layer is no longer required on this variant or the remoting feature-group?", "url": "https://github.com/wildfly/wildfly-core/pull/4291#discussion_r466536402", "createdAt": "2020-08-06T16:29:40Z", "author": {"login": "yersan"}, "path": "core-feature-pack/galleon-feature-pack/src/main/resources/layers/standalone/legacy-remoting/layer-spec.xml", "diffHunk": "@@ -0,0 +1,8 @@\n+<?xml version=\"1.0\" ?>\n+<layer-spec xmlns=\"urn:jboss:galleon:layer-spec:1.0\" name=\"legacy-remoting\">\n+    <dependencies>\n+        <layer name=\"application-security-realm\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e88bad85a7a5cb2e26876f22e19f4ec1d6fa6821"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07333cc39c7502e9a116e044c23c4193b6383941", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/07333cc39c7502e9a116e044c23c4193b6383941", "committedDate": "2020-08-06T16:40:58Z", "message": "[WFCORE-5076] The \"remoting-http-upgrade-service\" should be ACTIVE."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc49ca796895fcff6bf42a67ac6fe69909323a82", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/dc49ca796895fcff6bf42a67ac6fe69909323a82", "committedDate": "2020-08-06T16:40:58Z", "message": "[WFCORE-5082] Add a new \"legacy-remoting\" layer which is secured using a legacy security realm and also depends on the \"application-security-realm\" layer to make sure the realm is available."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70f82dcac93ffd5df12f03fe28ccf1867ea23cc2", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/70f82dcac93ffd5df12f03fe28ccf1867ea23cc2", "committedDate": "2020-08-06T16:40:58Z", "message": "[WFCORE-5078] Update the \"remoting\" layer to use a sasl-authentication-factory and ensure it depends on the the elytron layer."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d822d417b9b5401900f39ba3b4fad99588be1591", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/d822d417b9b5401900f39ba3b4fad99588be1591", "committedDate": "2020-08-06T16:40:58Z", "message": "[WFCORE-5076] Remove testing of the remoting layer from WildFly Core as it is only functional with the Undertow subystem present."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e88bad85a7a5cb2e26876f22e19f4ec1d6fa6821", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/e88bad85a7a5cb2e26876f22e19f4ec1d6fa6821", "committedDate": "2020-08-06T12:58:46Z", "message": "[WFCORE-5076] Remove testing of the remoting layer from WildFly Core as it is only functional with the Undertow subystem present."}, "afterCommit": {"oid": "d822d417b9b5401900f39ba3b4fad99588be1591", "author": {"user": {"login": "darranl", "name": "Darran Lofthouse"}}, "url": "https://github.com/wildfly/wildfly-core/commit/d822d417b9b5401900f39ba3b4fad99588be1591", "committedDate": "2020-08-06T16:40:58Z", "message": "[WFCORE-5076] Remove testing of the remoting layer from WildFly Core as it is only functional with the Undertow subystem present."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NzQxMTEy", "url": "https://github.com/wildfly/wildfly-core/pull/4291#pullrequestreview-465741112", "createdAt": "2020-08-12T09:23:14Z", "commit": {"oid": "d822d417b9b5401900f39ba3b4fad99588be1591"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3340, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}