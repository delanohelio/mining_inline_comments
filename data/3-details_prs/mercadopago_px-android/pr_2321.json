{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0MjMyNzkz", "number": 2321, "title": "[Feature] Retries and error handling", "bodyText": "Motivaci\u00f3n y Contexto\nRe-intentos y manejo de errores\nDescripci\u00f3n\n\nC\u00f3mo probarlo\n\n\nScreenshots\n\n\nTipo de cambio (para el release manager)\n\n Breaking change (Fix o feature que cambia una funcionalidad existente o rompe firmas)\n\n\n\n Mi cambio afecta a los integradores internos\n\n\nCompartir conocimiento", "createdAt": "2020-09-10T19:12:17Z", "url": "https://github.com/mercadopago/px-android/pull/2321", "merged": true, "mergeCommit": {"oid": "fb03b8eb76b2561bb4ed027f306f588e8b63f27a"}, "closed": true, "closedAt": "2020-09-17T16:45:47Z", "author": {"login": "jorGonzalez291292"}, "timelineItems": {"totalCount": 49, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBvTzuAH2gAyNDg0MjMyNzkzOjI4YzJlNGZhYzkwZWQ1OTYxOTNiN2UxYWQ5NWE0MTNiNzk2NDFjYjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJzzr5AH2gAyNDg0MjMyNzkzOmY0OWMyNWIxNGY1OWEwNjNiODNmMmM0Y2Q1NDVhYWUwMDkzYTc4NzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "28c2e4fac90ed596193b7e1ad95a413b79641cb0", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/28c2e4fac90ed596193b7e1ad95a413b79641cb0", "committedDate": "2020-08-23T14:58:20Z", "message": "init feature branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82cb7b8cd4fb64f9e42d40854d85f880956dbd74", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/82cb7b8cd4fb64f9e42d40854d85f880956dbd74", "committedDate": "2020-08-31T11:50:47Z", "message": "security code fragment added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "769960d27b06ddae9581551b4e069398c5284144", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/769960d27b06ddae9581551b4e069398c5284144", "committedDate": "2020-08-31T11:53:03Z", "message": "Merge branch 'master' of github.com:mercadopago/px-android into feature/new-cvv-screen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be68dd58df70ccf5317ebf1bb4786fdf0b6b5d84", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/be68dd58df70ccf5317ebf1bb4786fdf0b6b5d84", "committedDate": "2020-09-01T14:41:35Z", "message": "viewmodel created"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c31e23d507d035c82f47793415037217608fc2e", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/3c31e23d507d035c82f47793415037217608fc2e", "committedDate": "2020-09-02T14:01:59Z", "message": "paylogic added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2007e41be0c724b30b7550dec14057d61fdecdfc", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/2007e41be0c724b30b7550dec14057d61fdecdfc", "committedDate": "2020-09-03T18:19:21Z", "message": "paylogic with paymentrecovery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "471a31738d0a9703820dcc597593098865e62692", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/471a31738d0a9703820dcc597593098865e62692", "committedDate": "2020-09-03T19:22:44Z", "message": "refactor ciew model factory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a848d10f0e21412eca04d4c0b10853577b844a1", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/5a848d10f0e21412eca04d4c0b10853577b844a1", "committedDate": "2020-09-03T19:45:28Z", "message": "merge master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0736150868f79f236616c9470832693fe6adcf0", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/f0736150868f79f236616c9470832693fe6adcf0", "committedDate": "2020-09-03T20:19:25Z", "message": "revert change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "686ebe01c123c898fa30c34f39fd22c77afb4ed5", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/686ebe01c123c898fa30c34f39fd22c77afb4ed5", "committedDate": "2020-09-03T20:22:04Z", "message": "revert change in samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c7fbb5ac3c2468e0cfc3c8c4fc6e26658e27dfe", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/4c7fbb5ac3c2468e0cfc3c8c4fc6e26658e27dfe", "committedDate": "2020-09-03T20:57:11Z", "message": "refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11ac243d0c1a1d5cff982a0e2c7ff4cc0a359709", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/11ac243d0c1a1d5cff982a0e2c7ff4cc0a359709", "committedDate": "2020-09-03T21:51:29Z", "message": "review changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10dc1e18846efee072bcb12b79242503eb2342a1", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/10dc1e18846efee072bcb12b79242503eb2342a1", "committedDate": "2020-09-04T17:37:56Z", "message": "add resource string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b22ca7591720cddcbf84ac98614fa3c1937bfa4", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/7b22ca7591720cddcbf84ac98614fa3c1937bfa4", "committedDate": "2020-09-04T18:06:13Z", "message": "translation resource added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c869ba4448f9fa02996a04359baa6ab6cde7922", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/7c869ba4448f9fa02996a04359baa6ab6cde7922", "committedDate": "2020-09-04T18:58:59Z", "message": "test fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23c082a4c974c3de3fafe440a1616836c5d3868c", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/23c082a4c974c3de3fafe440a1616836c5d3868c", "committedDate": "2020-09-08T20:27:20Z", "message": "retries with snackbar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de45027e4d12cbb74757866326df96bba146d07b", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/de45027e4d12cbb74757866326df96bba146d07b", "committedDate": "2020-09-08T21:36:36Z", "message": "review changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1db09895b41eca4fdf6f41ad6681aaea17166230", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/1db09895b41eca4fdf6f41ad6681aaea17166230", "committedDate": "2020-09-08T21:42:40Z", "message": "merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e6e3e19ada54d3fd49d2af23ee161c857bd81c0", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/2e6e3e19ada54d3fd49d2af23ee161c857bd81c0", "committedDate": "2020-09-09T15:20:42Z", "message": "snackbar error with action added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b6a3ed02e4f17dd508bb8ae3670c608e24575c8", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/0b6a3ed02e4f17dd508bb8ae3670c608e24575c8", "committedDate": "2020-09-09T16:31:15Z", "message": "review changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c0c37a44fa56b4e93f8312244acacb77d3e38ed", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/3c0c37a44fa56b4e93f8312244acacb77d3e38ed", "committedDate": "2020-09-09T18:27:02Z", "message": "merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a0770fa1e5c60de2dd94b9211d3499f6c2c34e7", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/5a0770fa1e5c60de2dd94b9211d3499f6c2c34e7", "committedDate": "2020-09-09T18:44:42Z", "message": "review changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d13d59112c8a5aeffafaec314919b91c303d8c1", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/9d13d59112c8a5aeffafaec314919b91c303d8c1", "committedDate": "2020-09-09T18:49:22Z", "message": "Merge branch 'feature/paylogic' of github.com:mercadopago/px-android into feature/error_retries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37754437552198465b613366fa1f24b330b7ff62", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/37754437552198465b613366fa1f24b330b7ff62", "committedDate": "2020-09-09T20:25:30Z", "message": "SingleLiveData created"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06bee422dd622403fd2d542f3ff878c7582202b4", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/06bee422dd622403fd2d542f3ff878c7582202b4", "committedDate": "2020-09-09T20:26:17Z", "message": "MutableSingleLiveData created"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f06dda5dad04d2bdc05ec27d3eb2d27324fc737", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/9f06dda5dad04d2bdc05ec27d3eb2d27324fc737", "committedDate": "2020-09-09T20:28:29Z", "message": "add tab"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92be8e5ad2f5ff0f682abddf9c7b3cb2ad95f5fc", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/92be8e5ad2f5ff0f682abddf9c7b3cb2ad95f5fc", "committedDate": "2020-09-10T11:55:42Z", "message": "merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec18cade1bb34463e3d10017ebe3f2926fbc2c7d", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/ec18cade1bb34463e3d10017ebe3f2926fbc2c7d", "committedDate": "2020-09-10T15:47:33Z", "message": "refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1783924fa107a1e7c2ca57dbdc8c5b9bc8bba6c", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/a1783924fa107a1e7c2ca57dbdc8c5b9bc8bba6c", "committedDate": "2020-09-10T16:35:12Z", "message": "merge with cvv-screen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "768d637491b7e89cc2c323e8465d02caf5f6d05f", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/768d637491b7e89cc2c323e8465d02caf5f6d05f", "committedDate": "2020-09-10T17:03:25Z", "message": "revert changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7efe1577aa8fd2c124d55c0c1954f62dce94417f", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/7efe1577aa8fd2c124d55c0c1954f62dce94417f", "committedDate": "2020-09-10T17:11:18Z", "message": "test fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c11400b8e57b4b2cb1bc2cf434a97cf6ae076b1", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/2c11400b8e57b4b2cb1bc2cf434a97cf6ae076b1", "committedDate": "2020-09-10T19:05:23Z", "message": "refactor code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MjQ1OTI1", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-486245925", "createdAt": "2020-09-10T19:27:34Z", "commit": {"oid": "2c11400b8e57b4b2cb1bc2cf434a97cf6ae076b1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxOToyNzozNFrOHQCtYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxOToyNzozNFrOHQCtYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MzY1MQ==", "bodyText": "Ojo, medio side effect el enable, show no implica que el bot\u00f3n tiene que estar habilitado", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r486583651", "createdAt": "2020-09-10T19:27:34Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -214,27 +206,32 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n     }\n \n     private fun restoreStatusBar() {\n-        activity?.let {\n-            ViewUtils.setStatusBarColor(ContextCompat.getColor(it, R.color.px_colorPrimaryDark), it.window)\n-        }\n+        activity?.let { ViewUtils.setStatusBarColor(ContextCompat.getColor(it, R.color.px_colorPrimaryDark), it.window) }\n     }\n \n     private fun hideConfirmButton() {\n-        button.clearAnimation()\n-        button.visibility = INVISIBLE\n+        with(button) {\n+            clearAnimation()\n+            visibility = INVISIBLE\n+        }\n     }\n \n     private fun showConfirmButton() {\n-        button.clearAnimation()\n-        button.visibility = VISIBLE\n+        enable()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c11400b8e57b4b2cb1bc2cf434a97cf6ae076b1"}, "originalPosition": 91}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "077f9f7267e3b1edc0e8e488389fe60f0f67eaa7", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/077f9f7267e3b1edc0e8e488389fe60f0f67eaa7", "committedDate": "2020-09-10T20:29:27Z", "message": "handle back fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0b9665d832ebbba5741152d158ec6d82748862a", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/d0b9665d832ebbba5741152d158ec6d82748862a", "committedDate": "2020-09-10T21:08:45Z", "message": "refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/7a2dda307b2e8089cea1fd2924d7007d8a7b0638", "committedDate": "2020-09-14T19:02:43Z", "message": "review change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NzM4MTc1", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-489738175", "createdAt": "2020-09-16T15:20:27Z", "commit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyMDoyOFrOHS2EPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyMDoyOFrOHS2EPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyMjIzOA==", "bodyText": "Esto ya lo metimos en master, habr\u00eda que sacarlo", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489522238", "createdAt": "2020-09-16T15:20:28Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "diffHunk": "@@ -174,7 +174,7 @@ public void onBackPressed() {\n     }\n \n     private boolean earlyExitFromBackHandler(@Nullable final Fragment fragment) {\n-        if (fragment instanceof BackHandler) {\n+        if (fragment instanceof BackHandler && fragment.isAdded()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NzQzODE3", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-489743817", "createdAt": "2020-09-16T15:26:18Z", "commit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyNjoxOVrOHS2VXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyNjoxOVrOHS2VXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNjYyMg==", "bodyText": "No deber\u00eda ser recuperable un error de conexi\u00f3n?", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489526622", "createdAt": "2020-09-16T15:26:19Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonViewModel.kt", "diffHunk": "@@ -217,16 +221,20 @@ internal class PayButtonViewModel(\n     }\n \n     private fun manageNoConnection() {\n-        val exception = NoConnectivityException()\n-        val apiException = ApiUtil.getApiException(exception)\n-        val error = MercadoPagoError(apiException, null)\n-        noRecoverableError(error)\n+        trackNoRecoverableFriction(connectivityError)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 65}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5ODQyNzY1", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-489842765", "createdAt": "2020-09-16T17:26:43Z", "commit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNzoyNjo0NFrOHS6_mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNzoyNjo0NFrOHS6_mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYwMjk3MQ==", "bodyText": "No hay retryCounter++ en Kotlin? D:", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489602971", "createdAt": "2020-09-16T17:26:44Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/security_code/SecurityCodeFragment.kt", "diffHunk": "@@ -113,30 +129,63 @@ internal class SecurityCodeFragment : Fragment(), PayButton.Handler, BackHandler\n         securityCodeViewModel.enqueueOnExploding(cvvEditText.text.toString(), callback)\n     }\n \n+    override fun resolvePaymentError(error: MercadoPagoError): Boolean {\n+        payButtonFragment.enable()\n+        when {\n+            error.isNoConnectivityError -> resolveConnectionError()\n+            !error.isPaymentProcessing -> {\n+                val action = AndesSnackbarAction(\n+                    getString(R.string.px_snackbar_error_action),\n+                    View.OnClickListener { activity?.onBackPressed() }\n+                )\n+                view.showSnackBar(getString(R.string.px_error_title), andesSnackbarAction = action)\n+            }\n+        }\n+        return true\n+    }\n+\n+    private fun resolveConnectionError() {\n+        if (retryCounter < MAXIMUM_RETRIES) {\n+            retryCounter += 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5OTc2MTE2", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-489976116", "createdAt": "2020-09-16T19:58:16Z", "commit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxOTo1ODoxN1rOHTCH6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxOTo1ODoxN1rOHTCH6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTcxOTc4Ng==", "bodyText": "Che y esto donde qued\u00f3? Por ahi se me pas\u00f3 pero :/", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489719786", "createdAt": "2020-09-16T19:58:17Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/TokenCreationWrapper.kt", "diffHunk": "@@ -72,68 +73,21 @@ internal class TokenCreationWrapper private constructor(builder: Builder) {\n         return true\n     }\n \n-    private suspend fun createESCToken(savedESCCardToken: SavedESCCardToken): Token {\n-        return suspendCoroutine {cont ->\n-            cardTokenRepository\n-                .createToken(savedESCCardToken).enqueue(object : TaggedCallback<Token>(ApiUtil.RequestOrigin.CREATE_TOKEN) {\n-                    override fun onSuccess(token: Token) {\n-                        if (Reason.ESC_CAP == reason) { // Remove previous esc for tracking purpose", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34a006f21976d846950826c2a59565cdea0db6d8", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/34a006f21976d846950826c2a59565cdea0db6d8", "committedDate": "2020-09-17T12:26:16Z", "message": "error handler fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9aea8661634f2e58e290d7831d31b190dc4ea576", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/9aea8661634f2e58e290d7831d31b190dc4ea576", "committedDate": "2020-09-17T12:32:38Z", "message": "revert change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b8b997ef408ee10390a354d4e947349e246da05", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/8b8b997ef408ee10390a354d4e947349e246da05", "committedDate": "2020-09-17T12:43:24Z", "message": "clear cap added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/c5c56be4bf89fff89b05f639dae63b8af2edf9ad", "committedDate": "2020-09-17T12:52:12Z", "message": "test fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzYyNDky", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-490762492", "createdAt": "2020-09-17T16:07:50Z", "commit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjowNzo1MFrOHTp-0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjowNzo1MFrOHTp-0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3MjgxOQ==", "bodyText": "todo lo que es retry en el fragment qued\u00f3 de m\u00e1s?", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490372819", "createdAt": "2020-09-17T16:07:50Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -246,6 +271,8 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n \n     companion object {\n         const val TAG = \"TAG_BUTTON_FRAGMENT\"\n+        private const val MAXIMUM_RETRIES = 3", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "originalPosition": 167}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzY0NTU2", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-490764556", "createdAt": "2020-09-17T16:10:17Z", "commit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjoxMDoxN1rOHTqI_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjoxMDoxN1rOHTqI_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3NTQyMw==", "bodyText": "por que no hacemos la asignaci\u00f3n directamente en vez de declarar un get?\nquizas hasta nos ahorra guardar el retries count como un val", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490375423", "createdAt": "2020-09-17T16:10:17Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonState.kt", "diffHunk": "@@ -20,9 +20,20 @@ internal open class UIResult : PayButtonState() {\n     object VisualProcessorResult : UIResult()\n     data class PaymentResult(val model: PaymentModel) : UIResult()\n     data class BusinessPaymentResult(val model: BusinessPaymentModel) : UIResult()\n-    data class NoCongratsResult(val model : PaymentModel) : UIResult()\n+    data class NoCongratsResult(val model: PaymentModel) : UIResult()\n }\n \n-internal open class UIError(val message: String, val detail: String) : PayButtonState() {\n-    class ConnectionError(error: MercadoPagoError) : UIError(error.message.orEmpty(), error.errorDetail.orEmpty())\n+internal open class UIError : PayButtonState() {\n+    class ConnectionError(private val retriesCount: Int): UIError() {\n+        private val maxRetries = 3\n+        private val neutralMessage = R.string.px_connectivity_neutral_error\n+        private val errorMessage = R.string.px_connectivity_error\n+\n+        val message: Int\n+            get() = if (retriesCount <= maxRetries) neutralMessage else errorMessage", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzkxOTY0", "url": "https://github.com/mercadopago/px-android/pull/2321#pullrequestreview-490791964", "createdAt": "2020-09-17T16:39:55Z", "commit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67a72c6ffce4ef9e6b243dcb07cd3757067b178d", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/67a72c6ffce4ef9e6b243dcb07cd3757067b178d", "committedDate": "2020-09-17T16:41:07Z", "message": "refactor ConnectionError"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f49c25b14f59a063b83f2c4cd545aae0093a7870", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/f49c25b14f59a063b83f2c4cd545aae0093a7870", "committedDate": "2020-09-17T16:44:10Z", "message": "remove values from paybutton"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3766, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}