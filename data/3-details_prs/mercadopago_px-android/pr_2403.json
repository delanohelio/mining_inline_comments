{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyMDEyNjkw", "number": 2403, "title": "[Feature][ci size] Web Pay -  Bottom Sheet", "bodyText": "Motivaci\u00f3n y Contexto\nSe agrega flujo de alta de tarjeta de d\u00e9bito con webpay.\nDescripci\u00f3n\n\nC\u00f3mo probarlo\n\n\nScreenshots\n\n\nTipo de cambio (para el release manager)\n\n Breaking change (Fix o feature que cambia una funcionalidad existente o rompe firmas)\n\n\n\n Mi cambio afecta a los integradores internos\n\n\nCompartir conocimiento", "createdAt": "2020-12-17T17:24:01Z", "url": "https://github.com/mercadopago/px-android/pull/2403", "merged": true, "mergeCommit": {"oid": "f8aa3ca443f29b9e1fd8034461936e7999eaa255"}, "closed": true, "closedAt": "2021-01-07T16:09:25Z", "author": {"login": "jorGonzalez291292"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgtOz3gH2gAyNTQyMDEyNjkwOjdmMjAxODlmNzA2MWM0YTE2NDU3ZDM4ODFlZjc1NWIzNmZlOWUyMzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdt2RjAAH2gAyNTQyMDEyNjkwOmZiNjNiMzg4YjdkZDUwMzVlMzIyYjM4OGU0NDk2ZDNlOWE0MjY2Y2Q=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7f20189f7061c4a16457d3881ef755b36fe9e234", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/7f20189f7061c4a16457d3881ef755b36fe9e234", "committedDate": "2020-11-27T20:04:43Z", "message": "[Feature] Card form bottom sheet (#2390)\n\n* add sheet option model\r\n\r\n* card form bottom sheet\r\n\r\n* recycler view and adepter added\r\n\r\n* cardformoption click listener added\r\n\r\n* add init type to new card meta data\r\n\r\n* refactor recycler view adapter\r\n\r\n* revert changes\r\n\r\n* refactor open card form\r\n\r\n* add code\r\n\r\n* rename file\r\n\r\n* update text sizes\r\n\r\n* rename package\r\n\r\n* rename package again\r\n\r\n* review changes\r\n\r\n* update layout sheet option\r\n\r\n* refactor header bottom sheet\r\n\r\n* change name method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcfc9211ea73812aa8d230ade74c33d1b19396d9", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/bcfc9211ea73812aa8d230ade74c33d1b19396d9", "committedDate": "2020-12-11T14:27:07Z", "message": "Merge branch 'master' of github.com:mercadopago/px-android into feature/web-pay"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1bb9e5f149263fa7366b473ce69ec5a0e081333", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/c1bb9e5f149263fa7366b473ce69ec5a0e081333", "committedDate": "2020-12-11T14:44:50Z", "message": "change margins sheet options row (#2395)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68afbd05009fac59761b01735b03228787eb1d20", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/68afbd05009fac59761b01735b03228787eb1d20", "committedDate": "2020-12-17T16:03:14Z", "message": "[Feature] card form web pay integration (#2402)\n\n* add sheet option model\r\n\r\n* card form bottom sheet\r\n\r\n* recycler view and adepter added\r\n\r\n* cardformoption click listener added\r\n\r\n* add init type to new card meta data\r\n\r\n* refactor recycler view adapter\r\n\r\n* revert changes\r\n\r\n* refactor open card form\r\n\r\n* add code\r\n\r\n* rename file\r\n\r\n* update text sizes\r\n\r\n* rename package\r\n\r\n* rename package again\r\n\r\n* review changes\r\n\r\n* update layout sheet option\r\n\r\n* refactor header bottom sheet\r\n\r\n* change name method\r\n\r\n* change margins sheet options row\r\n\r\n* card form web pay integration\r\n\r\n* process card form result\r\n\r\n* Update init cardform for webpay\r\n\r\n* card form webpay added\r\n\r\n* delete imports\r\n\r\n* logic step was to launch cardform to onetap fragment\r\n\r\n* card form option validation fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NTQ3MzE1", "url": "https://github.com/mercadopago/px-android/pull/2403#pullrequestreview-555547315", "createdAt": "2020-12-18T14:40:05Z", "commit": {"oid": "68afbd05009fac59761b01735b03228787eb1d20"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "639824a2c3ff1ed0ca73a513b69c655dba46cfba", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/639824a2c3ff1ed0ca73a513b69c655dba46cfba", "committedDate": "2020-12-18T14:42:17Z", "message": "experimental configuration added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5604fe6e7da46313eb4e9bce52e78aa771ffee68", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/5604fe6e7da46313eb4e9bce52e78aa771ffee68", "committedDate": "2020-12-18T15:49:35Z", "message": "fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b410ca2b73b66e0aff36965bed0a4d6b772ed829", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/b410ca2b73b66e0aff36965bed0a4d6b772ed829", "committedDate": "2020-12-18T16:26:07Z", "message": "merge with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "committedDate": "2021-01-06T20:42:59Z", "message": "Update cardform version and build gradle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNTYxODI1", "url": "https://github.com/mercadopago/px-android/pull/2403#pullrequestreview-563561825", "createdAt": "2021-01-07T15:07:36Z", "commit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNTowNzozNlrOIPv-qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNTowNzozNlrOIPv-qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4NTY0MA==", "bodyText": "qued\u00f3 de m\u00e1s", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553385640", "createdAt": "2021-01-07T15:07:36Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "diffHunk": "@@ -53,10 +61,11 @@\n import com.mercadopago.android.px.internal.features.pay_button.PayButton;\n import com.mercadopago.android.px.internal.features.pay_button.PayButtonFragment;\n import com.mercadopago.android.px.internal.features.security_code.SecurityCodeFragment;\n-import com.mercadopago.android.px.internal.util.CardFormWithFragmentWrapper;\n+import com.mercadopago.android.px.internal.util.CardFormWrapper;\n import com.mercadopago.android.px.internal.util.ErrorUtil;\n import com.mercadopago.android.px.internal.util.Logger;\n import com.mercadopago.android.px.internal.util.VibrationUtils;\n+import com.mercadopago.android.px.internal.util.ViewUtils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3acc191a017cf9e9f58248548315c55e49481d50", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/3acc191a017cf9e9f58248548315c55e49481d50", "committedDate": "2021-01-07T15:16:58Z", "message": "remove imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNTcwMTE4", "url": "https://github.com/mercadopago/px-android/pull/2403#pullrequestreview-563570118", "createdAt": "2021-01-07T15:17:28Z", "commit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxNzoyOFrOIPwWWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxNzoyOFrOIPwWWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MTcwNw==", "bodyText": "Podemos cambiarle el nombre a solo webpay? no dice mucho TBK", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553391707", "createdAt": "2021-01-07T15:17:28Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java", "diffHunk": "@@ -145,15 +174,30 @@ protected void loadImage(@NonNull final View view, @DrawableRes final int imageR\n     }\n \n     @Override\n-    public void startCardForm(@NonNull final CardFormWithFragmentWrapper cardFormWithFragmentWrapper) {\n-        final FragmentManager manager;\n-        if (getParentFragment() != null && (manager = getParentFragment().getFragmentManager()) != null) {\n-            cardFormWithFragmentWrapper.getCardFormWithFragment()\n-                .start(manager, ExpressPaymentFragment.REQ_CODE_CARD_FORM, R.id.one_tap_fragment);\n+    public void startCardForm(@NonNull final CardFormWrapper cardFormWrapper, @NonNull final CardFormInitType initType) {\n+        switch (initType) {\n+            case STANDARD: {\n+                final FragmentManager manager;\n+                if (getParentFragment() != null && (manager = getParentFragment().getFragmentManager()) != null) {\n+                    cardFormWrapper.getCardFormWithFragment()\n+                        .start(manager, REQ_CODE_CARD_FORM, R.id.one_tap_fragment);\n+                }\n+                break;\n+            }\n+            case WEBPAY_TBK: {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "originalPosition": 92}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNTcwNDY4", "url": "https://github.com/mercadopago/px-android/pull/2403#pullrequestreview-563570468", "createdAt": "2021-01-07T15:17:50Z", "commit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxNzo1MFrOIPwXaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxNzo1MFrOIPwXaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MTk3Ng==", "bodyText": "Es nonnull?", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553391976", "createdAt": "2021-01-07T15:17:50Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodPresenter.java", "diffHunk": "@@ -2,23 +2,19 @@\n \n import androidx.annotation.NonNull;\n import com.mercadopago.android.px.internal.base.BasePresenter;\n-import com.mercadopago.android.px.internal.repository.PaymentSettingRepository;\n-import com.mercadopago.android.px.internal.tracking.TrackingRepository;\n-import com.mercadopago.android.px.internal.util.CardFormWithFragmentWrapper;\n+import com.mercadopago.android.px.internal.util.CardFormWrapper;\n+import com.mercadopago.android.px.model.CardFormInitType;\n \n public class OtherPaymentMethodPresenter extends BasePresenter<AddNewCard.View> implements AddNewCard.Actions {\n \n-    private final PaymentSettingRepository settingRepository;\n-    @NonNull private final TrackingRepository trackingRepository;\n+    @NonNull private final CardFormWrapper cardFormWrapper;\n \n-    /* default */ OtherPaymentMethodPresenter(@NonNull final PaymentSettingRepository settingRepository,\n-        @NonNull final TrackingRepository trackingRepository) {\n-        this.settingRepository = settingRepository;\n-        this.trackingRepository = trackingRepository;\n+    /* default */ OtherPaymentMethodPresenter(@NonNull final CardFormWrapper cardFormWrapper) {\n+        this.cardFormWrapper = cardFormWrapper;\n     }\n \n     @Override\n-    public void onAddNewCardSelected() {\n-        getView().startCardForm(new CardFormWithFragmentWrapper(settingRepository, trackingRepository));\n+    public void onAddNewCardSelected(final CardFormInitType initType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNTc0NTU0", "url": "https://github.com/mercadopago/px-android/pull/2403#pullrequestreview-563574554", "createdAt": "2021-01-07T15:22:30Z", "commit": {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e20a32a198c736cfda07a20179ef74431c52d45", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/3e20a32a198c736cfda07a20179ef74431c52d45", "committedDate": "2021-01-07T15:39:18Z", "message": "request changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb63b388b7dd5035e322b388e4496d3e9a4266cd", "author": {"user": {"login": "jorGonzalez291292", "name": "Jorge Daniel Gonzalez"}}, "url": "https://github.com/mercadopago/px-android/commit/fb63b388b7dd5035e322b388e4496d3e9a4266cd", "committedDate": "2021-01-07T15:57:52Z", "message": "add NonNull annotation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3724, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}