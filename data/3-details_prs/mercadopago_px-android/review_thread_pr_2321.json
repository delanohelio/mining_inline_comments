{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0MjMyNzkz", "number": 2321, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxOToyNzozNFrOEiQvuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjoxMDoxN1rOEknUsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MzYxNDAxOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxOToyNzozNFrOHQCtYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNDoyMTozMlrOHQg6Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MzY1MQ==", "bodyText": "Ojo, medio side effect el enable, show no implica que el bot\u00f3n tiene que estar habilitado", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r486583651", "createdAt": "2020-09-10T19:27:34Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -214,27 +206,32 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n     }\n \n     private fun restoreStatusBar() {\n-        activity?.let {\n-            ViewUtils.setStatusBarColor(ContextCompat.getColor(it, R.color.px_colorPrimaryDark), it.window)\n-        }\n+        activity?.let { ViewUtils.setStatusBarColor(ContextCompat.getColor(it, R.color.px_colorPrimaryDark), it.window) }\n     }\n \n     private fun hideConfirmButton() {\n-        button.clearAnimation()\n-        button.visibility = INVISIBLE\n+        with(button) {\n+            clearAnimation()\n+            visibility = INVISIBLE\n+        }\n     }\n \n     private fun showConfirmButton() {\n-        button.clearAnimation()\n-        button.visibility = VISIBLE\n+        enable()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c11400b8e57b4b2cb1bc2cf434a97cf6ae076b1"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA3ODQxNQ==", "bodyText": "Lo reviso!", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r487078415", "createdAt": "2020-09-11T14:21:32Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -214,27 +206,32 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n     }\n \n     private fun restoreStatusBar() {\n-        activity?.let {\n-            ViewUtils.setStatusBarColor(ContextCompat.getColor(it, R.color.px_colorPrimaryDark), it.window)\n-        }\n+        activity?.let { ViewUtils.setStatusBarColor(ContextCompat.getColor(it, R.color.px_colorPrimaryDark), it.window) }\n     }\n \n     private fun hideConfirmButton() {\n-        button.clearAnimation()\n-        button.visibility = INVISIBLE\n+        with(button) {\n+            clearAnimation()\n+            visibility = INVISIBLE\n+        }\n     }\n \n     private fun showConfirmButton() {\n-        button.clearAnimation()\n-        button.visibility = VISIBLE\n+        enable()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MzY1MQ=="}, "originalCommit": {"oid": "2c11400b8e57b4b2cb1bc2cf434a97cf6ae076b1"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2Mjk1NTgzOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyMDoyOFrOHS2EPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMjozMzowM1rOHTf0hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyMjIzOA==", "bodyText": "Esto ya lo metimos en master, habr\u00eda que sacarlo", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489522238", "createdAt": "2020-09-16T15:20:28Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "diffHunk": "@@ -174,7 +174,7 @@ public void onBackPressed() {\n     }\n \n     private boolean earlyExitFromBackHandler(@Nullable final Fragment fragment) {\n-        if (fragment instanceof BackHandler) {\n+        if (fragment instanceof BackHandler && fragment.isAdded()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIwNjM0MA==", "bodyText": "Dale", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490206340", "createdAt": "2020-09-17T12:33:03Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "diffHunk": "@@ -174,7 +174,7 @@ public void onBackPressed() {\n     }\n \n     private boolean earlyExitFromBackHandler(@Nullable final Fragment fragment) {\n-        if (fragment instanceof BackHandler) {\n+        if (fragment instanceof BackHandler && fragment.isAdded()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyMjIzOA=="}, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2Mjk4Mjg1OnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonViewModel.kt", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyNjoxOVrOHS2VXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjoyNzozMlrOHTrevg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNjYyMg==", "bodyText": "No deber\u00eda ser recuperable un error de conexi\u00f3n?", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489526622", "createdAt": "2020-09-16T15:26:19Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonViewModel.kt", "diffHunk": "@@ -217,16 +221,20 @@ internal class PayButtonViewModel(\n     }\n \n     private fun manageNoConnection() {\n-        val exception = NoConnectivityException()\n-        val apiException = ApiUtil.getApiException(exception)\n-        val error = MercadoPagoError(apiException, null)\n-        noRecoverableError(error)\n+        trackNoRecoverableFriction(connectivityError)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIwNTY2Nw==", "bodyText": "Solo update el nombre del m\u00e9todo que se usaba noRecoverableError para hacer el track. En todo caso lo cambiar\u00eda a trackFriction().", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490205667", "createdAt": "2020-09-17T12:31:53Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonViewModel.kt", "diffHunk": "@@ -217,16 +221,20 @@ internal class PayButtonViewModel(\n     }\n \n     private fun manageNoConnection() {\n-        val exception = NoConnectivityException()\n-        val apiException = ApiUtil.getApiException(exception)\n-        val error = MercadoPagoError(apiException, null)\n-        noRecoverableError(error)\n+        trackNoRecoverableFriction(connectivityError)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNjYyMg=="}, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3ODE4OQ==", "bodyText": "me gusta trackFriction", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490378189", "createdAt": "2020-09-17T16:12:50Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonViewModel.kt", "diffHunk": "@@ -217,16 +221,20 @@ internal class PayButtonViewModel(\n     }\n \n     private fun manageNoConnection() {\n-        val exception = NoConnectivityException()\n-        val apiException = ApiUtil.getApiException(exception)\n-        val error = MercadoPagoError(apiException, null)\n-        noRecoverableError(error)\n+        trackNoRecoverableFriction(connectivityError)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNjYyMg=="}, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM5NzM3NA==", "bodyText": "Lo cambio en el PR de tracks.", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490397374", "createdAt": "2020-09-17T16:27:32Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonViewModel.kt", "diffHunk": "@@ -217,16 +221,20 @@ internal class PayButtonViewModel(\n     }\n \n     private fun manageNoConnection() {\n-        val exception = NoConnectivityException()\n-        val apiException = ApiUtil.getApiException(exception)\n-        val error = MercadoPagoError(apiException, null)\n-        noRecoverableError(error)\n+        trackNoRecoverableFriction(connectivityError)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNjYyMg=="}, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MzQ1NDMzOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/security_code/SecurityCodeFragment.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNzoyNjo0NFrOHS6_mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMjoyNjo1NFrOHTfmIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYwMjk3MQ==", "bodyText": "No hay retryCounter++ en Kotlin? D:", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489602971", "createdAt": "2020-09-16T17:26:44Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/security_code/SecurityCodeFragment.kt", "diffHunk": "@@ -113,30 +129,63 @@ internal class SecurityCodeFragment : Fragment(), PayButton.Handler, BackHandler\n         securityCodeViewModel.enqueueOnExploding(cvvEditText.text.toString(), callback)\n     }\n \n+    override fun resolvePaymentError(error: MercadoPagoError): Boolean {\n+        payButtonFragment.enable()\n+        when {\n+            error.isNoConnectivityError -> resolveConnectionError()\n+            !error.isPaymentProcessing -> {\n+                val action = AndesSnackbarAction(\n+                    getString(R.string.px_snackbar_error_action),\n+                    View.OnClickListener { activity?.onBackPressed() }\n+                )\n+                view.showSnackBar(getString(R.string.px_error_title), andesSnackbarAction = action)\n+            }\n+        }\n+        return true\n+    }\n+\n+    private fun resolveConnectionError() {\n+        if (retryCounter < MAXIMUM_RETRIES) {\n+            retryCounter += 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIwMjY1Ng==", "bodyText": "jaja modificado :P", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490202656", "createdAt": "2020-09-17T12:26:54Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/security_code/SecurityCodeFragment.kt", "diffHunk": "@@ -113,30 +129,63 @@ internal class SecurityCodeFragment : Fragment(), PayButton.Handler, BackHandler\n         securityCodeViewModel.enqueueOnExploding(cvvEditText.text.toString(), callback)\n     }\n \n+    override fun resolvePaymentError(error: MercadoPagoError): Boolean {\n+        payButtonFragment.enable()\n+        when {\n+            error.isNoConnectivityError -> resolveConnectionError()\n+            !error.isPaymentProcessing -> {\n+                val action = AndesSnackbarAction(\n+                    getString(R.string.px_snackbar_error_action),\n+                    View.OnClickListener { activity?.onBackPressed() }\n+                )\n+                view.showSnackBar(getString(R.string.px_error_title), andesSnackbarAction = action)\n+            }\n+        }\n+        return true\n+    }\n+\n+    private fun resolveConnectionError() {\n+        if (retryCounter < MAXIMUM_RETRIES) {\n+            retryCounter += 1", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYwMjk3MQ=="}, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDE0MjQ5OnYy", "diffSide": "LEFT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/TokenCreationWrapper.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxOTo1ODoxN1rOHTCH6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMjo0Mjo0NlrOHTgLSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTcxOTc4Ng==", "bodyText": "Che y esto donde qued\u00f3? Por ahi se me pas\u00f3 pero :/", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r489719786", "createdAt": "2020-09-16T19:58:17Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/TokenCreationWrapper.kt", "diffHunk": "@@ -72,68 +73,21 @@ internal class TokenCreationWrapper private constructor(builder: Builder) {\n         return true\n     }\n \n-    private suspend fun createESCToken(savedESCCardToken: SavedESCCardToken): Token {\n-        return suspendCoroutine {cont ->\n-            cardTokenRepository\n-                .createToken(savedESCCardToken).enqueue(object : TaggedCallback<Token>(ApiUtil.RequestOrigin.CREATE_TOKEN) {\n-                    override fun onSuccess(token: Token) {\n-                        if (Reason.ESC_CAP == reason) { // Remove previous esc for tracking purpose", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIxMjE3MA==", "bodyText": "Me lo comi, agregado.", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490212170", "createdAt": "2020-09-17T12:42:46Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/TokenCreationWrapper.kt", "diffHunk": "@@ -72,68 +73,21 @@ internal class TokenCreationWrapper private constructor(builder: Builder) {\n         return true\n     }\n \n-    private suspend fun createESCToken(savedESCCardToken: SavedESCCardToken): Token {\n-        return suspendCoroutine {cont ->\n-            cardTokenRepository\n-                .createToken(savedESCCardToken).enqueue(object : TaggedCallback<Token>(ApiUtil.RequestOrigin.CREATE_TOKEN) {\n-                    override fun onSuccess(token: Token) {\n-                        if (Reason.ESC_CAP == reason) { // Remove previous esc for tracking purpose", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTcxOTc4Ng=="}, "originalCommit": {"oid": "7a2dda307b2e8089cea1fd2924d7007d8a7b0638"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2ODI2OTMyOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjowNzo1MFrOHTp-0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjoyODoxN1rOHTrgfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3MjgxOQ==", "bodyText": "todo lo que es retry en el fragment qued\u00f3 de m\u00e1s?", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490372819", "createdAt": "2020-09-17T16:07:50Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -246,6 +271,8 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n \n     companion object {\n         const val TAG = \"TAG_BUTTON_FRAGMENT\"\n+        private const val MAXIMUM_RETRIES = 3", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "originalPosition": 167}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM5NzgyMQ==", "bodyText": "Sip, no se estaba usando. Lo borro.", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490397821", "createdAt": "2020-09-17T16:28:17Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonFragment.kt", "diffHunk": "@@ -246,6 +271,8 @@ class PayButtonFragment : Fragment(), PayButton.View, SecurityValidationHandler\n \n     companion object {\n         const val TAG = \"TAG_BUTTON_FRAGMENT\"\n+        private const val MAXIMUM_RETRIES = 3", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3MjgxOQ=="}, "originalCommit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "originalPosition": 167}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2ODI4NDY1OnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonState.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjoxMDoxN1rOHTqI_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNjozNzowNlrOHTr1uA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3NTQyMw==", "bodyText": "por que no hacemos la asignaci\u00f3n directamente en vez de declarar un get?\nquizas hasta nos ahorra guardar el retries count como un val", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490375423", "createdAt": "2020-09-17T16:10:17Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonState.kt", "diffHunk": "@@ -20,9 +20,20 @@ internal open class UIResult : PayButtonState() {\n     object VisualProcessorResult : UIResult()\n     data class PaymentResult(val model: PaymentModel) : UIResult()\n     data class BusinessPaymentResult(val model: BusinessPaymentModel) : UIResult()\n-    data class NoCongratsResult(val model : PaymentModel) : UIResult()\n+    data class NoCongratsResult(val model: PaymentModel) : UIResult()\n }\n \n-internal open class UIError(val message: String, val detail: String) : PayButtonState() {\n-    class ConnectionError(error: MercadoPagoError) : UIError(error.message.orEmpty(), error.errorDetail.orEmpty())\n+internal open class UIError : PayButtonState() {\n+    class ConnectionError(private val retriesCount: Int): UIError() {\n+        private val maxRetries = 3\n+        private val neutralMessage = R.string.px_connectivity_neutral_error\n+        private val errorMessage = R.string.px_connectivity_error\n+\n+        val message: Int\n+            get() = if (retriesCount <= maxRetries) neutralMessage else errorMessage", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQwMzI1Ng==", "bodyText": "lo cambio", "url": "https://github.com/mercadopago/px-android/pull/2321#discussion_r490403256", "createdAt": "2020-09-17T16:37:06Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/pay_button/PayButtonState.kt", "diffHunk": "@@ -20,9 +20,20 @@ internal open class UIResult : PayButtonState() {\n     object VisualProcessorResult : UIResult()\n     data class PaymentResult(val model: PaymentModel) : UIResult()\n     data class BusinessPaymentResult(val model: BusinessPaymentModel) : UIResult()\n-    data class NoCongratsResult(val model : PaymentModel) : UIResult()\n+    data class NoCongratsResult(val model: PaymentModel) : UIResult()\n }\n \n-internal open class UIError(val message: String, val detail: String) : PayButtonState() {\n-    class ConnectionError(error: MercadoPagoError) : UIError(error.message.orEmpty(), error.errorDetail.orEmpty())\n+internal open class UIError : PayButtonState() {\n+    class ConnectionError(private val retriesCount: Int): UIError() {\n+        private val maxRetries = 3\n+        private val neutralMessage = R.string.px_connectivity_neutral_error\n+        private val errorMessage = R.string.px_connectivity_error\n+\n+        val message: Int\n+            get() = if (retriesCount <= maxRetries) neutralMessage else errorMessage", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM3NTQyMw=="}, "originalCommit": {"oid": "c5c56be4bf89fff89b05f639dae63b8af2edf9ad"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1799, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}