{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3ODYyODY0", "number": 2097, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzo1MjozMlrODuKLnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDowMzoxM1rODuZCRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzI3OTAxOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/datasource/CongratsRepositoryImpl.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzo1MjozMlrOGAAdhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzo1MjozMlrOGAAdhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY2MDc0MA==", "bodyText": "El true lo voy a cambiar cuando tenga armado el callback de kyc, por ahora lo dejo hardcodeado", "url": "https://github.com/mercadopago/px-android/pull/2097#discussion_r402660740", "createdAt": "2020-04-02T23:52:32Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/datasource/CongratsRepositoryImpl.kt", "diffHunk": "@@ -53,23 +53,27 @@ class CongratsRepositoryImpl(private val congratsService: CongratsService,\n     private suspend fun getPaymentReward(payment: IPaymentDescriptor, paymentResult: PaymentResult) =\n         try {\n             val joinedPaymentIds = TextUtil.join(payment.paymentIds)\n+            val joinedPaymentMethodsIds = paymentResult.paymentDataList\n+                .joinToString(TextUtil.CSV_DELIMITER) { p -> (p.paymentMethod.id) }\n             val campaignId = paymentResult.paymentData.campaign?.run { id } ?: \"\"\n-            val response = congratsService.getPaymentReward(BuildConfig.API_ENVIRONMENT, locale, privateKey,\n-                    joinedPaymentIds, platform, campaignId, flow).await()\n+            val response = congratsService.getCongrats(BuildConfig.API_ENVIRONMENT, locale, privateKey,\n+                joinedPaymentIds, platform, campaignId, true, joinedPaymentMethodsIds, flow).await()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba72c2bf0e7980174a92259bfbcef4adc154cf67"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzI4MzAxOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/view/PaymentResultBody.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzo1NDoyN1rOGAAfww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzo1NDoyN1rOGAAfww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY2MTMxNQ==", "bodyText": "Por ahora uso este callback, pensaba en cambiarle el nombre a onClickDeepLinkButton pero me di cuenta que la implementaci\u00f3n hace un track de showAllDiscounts, quizas los tracks podrian estar dentro de la vista y no en el presenter? o armo otro callback que igual al de showAllDiscounts pero con otro track", "url": "https://github.com/mercadopago/px-android/pull/2097#discussion_r402661315", "createdAt": "2020-04-02T23:54:27Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/view/PaymentResultBody.java", "diffHunk": "@@ -171,6 +181,20 @@ private void renderMethods(@NonNull final Model model) {\n         }\n     }\n \n+    private void renderViewReceipt(@Nullable final Action viewReceiptAction, final Listener listener) {\n+        final MeliButton viewReceiptButton = findViewById(R.id.view_receipt_action);\n+        final String target = viewReceiptAction != null ? viewReceiptAction.getTarget() : null;\n+        if (TextUtil.isNotEmpty(target) && isMPInstalled(getContext().getPackageManager())) {\n+            viewReceiptButton\n+                .setBackground(ContextCompat.getDrawable(getContext(), R.drawable.px_quiet_button_selector));\n+            viewReceiptButton.setText(viewReceiptAction.getLabel());\n+            viewReceiptButton.setOnClickListener(\n+                v -> listener.onClickShowAllDiscounts(target));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba72c2bf0e7980174a92259bfbcef4adc154cf67"}, "originalPosition": 128}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5OTcxMjY4OnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/datasource/CongratsRepositoryImpl.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNDowMzoxM1rOGAW4zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQyMzo1NjozNFrOGBEh_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAyODE3Mg==", "bodyText": "por que usamos el .run aca? No podemos hacer campaign?.id?", "url": "https://github.com/mercadopago/px-android/pull/2097#discussion_r403028172", "createdAt": "2020-04-03T14:03:13Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/datasource/CongratsRepositoryImpl.kt", "diffHunk": "@@ -53,23 +53,27 @@ class CongratsRepositoryImpl(private val congratsService: CongratsService,\n     private suspend fun getPaymentReward(payment: IPaymentDescriptor, paymentResult: PaymentResult) =\n         try {\n             val joinedPaymentIds = TextUtil.join(payment.paymentIds)\n+            val joinedPaymentMethodsIds = paymentResult.paymentDataList\n+                .joinToString(TextUtil.CSV_DELIMITER) { p -> (p.paymentMethod.id) }\n             val campaignId = paymentResult.paymentData.campaign?.run { id } ?: \"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba72c2bf0e7980174a92259bfbcef4adc154cf67"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc3NTk5OQ==", "bodyText": "mm no s\u00e9 la motivaci\u00f3n del que escribi\u00f3 eso, entiendo que si hiciera lo que vos decis quedaria null y no vacio, a priori.", "url": "https://github.com/mercadopago/px-android/pull/2097#discussion_r403775999", "createdAt": "2020-04-05T23:56:34Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/datasource/CongratsRepositoryImpl.kt", "diffHunk": "@@ -53,23 +53,27 @@ class CongratsRepositoryImpl(private val congratsService: CongratsService,\n     private suspend fun getPaymentReward(payment: IPaymentDescriptor, paymentResult: PaymentResult) =\n         try {\n             val joinedPaymentIds = TextUtil.join(payment.paymentIds)\n+            val joinedPaymentMethodsIds = paymentResult.paymentDataList\n+                .joinToString(TextUtil.CSV_DELIMITER) { p -> (p.paymentMethod.id) }\n             val campaignId = paymentResult.paymentData.campaign?.run { id } ?: \"\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAyODE3Mg=="}, "originalCommit": {"oid": "ba72c2bf0e7980174a92259bfbcef4adc154cf67"}, "originalPosition": 33}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1676, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}