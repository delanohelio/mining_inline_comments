{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMTg1ODY3", "number": 2059, "title": "[enhancement] call clear cap service when tokenize after esc cap", "bodyText": "Se necesita este cambio para que al pedirle al usuario que ingrese CVV debido a que detectamos que se va a pasar del CAP de ESC, hagamos un reset de dicho CAP para que no falle luego en payments", "createdAt": "2020-03-03T21:21:37Z", "url": "https://github.com/mercadopago/px-android/pull/2059", "merged": true, "mergeCommit": {"oid": "e20f9c2d7ee60d8c026e3a046eff789506e731b6"}, "closed": true, "closedAt": "2020-03-05T18:39:37Z", "author": {"login": "cgaggino"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKJJHxABqjMwOTM5NDMxMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKWlfPgFqTM2ODc1NzkxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d48876431c0d2dc94300933fe50a1e7fbf987ba1", "author": {"user": {"login": "cgaggino", "name": "Cristian Gaggino"}}, "url": "https://github.com/mercadopago/px-android/commit/d48876431c0d2dc94300933fe50a1e7fbf987ba1", "committedDate": "2020-03-03T21:17:17Z", "message": "* Called clear cap service when tokenize after esc cap"}, "afterCommit": {"oid": "4dda9f8689d16b11d2ff2d3fb9f9ba4d9095208b", "author": {"user": {"login": "cgaggino", "name": "Cristian Gaggino"}}, "url": "https://github.com/mercadopago/px-android/commit/4dda9f8689d16b11d2ff2d3fb9f9ba4d9095208b", "committedDate": "2020-03-03T21:24:13Z", "message": "* Called clear cap service when tokenize after esc cap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4664d98fb458efc6514d5f3e93607ea76cc797b", "author": {"user": {"login": "cgaggino", "name": "Cristian Gaggino"}}, "url": "https://github.com/mercadopago/px-android/commit/e4664d98fb458efc6514d5f3e93607ea76cc797b", "committedDate": "2020-03-03T22:00:00Z", "message": "* Called clear cap service when tokenize after esc cap"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4dda9f8689d16b11d2ff2d3fb9f9ba4d9095208b", "author": {"user": {"login": "cgaggino", "name": "Cristian Gaggino"}}, "url": "https://github.com/mercadopago/px-android/commit/4dda9f8689d16b11d2ff2d3fb9f9ba4d9095208b", "committedDate": "2020-03-03T21:24:13Z", "message": "* Called clear cap service when tokenize after esc cap"}, "afterCommit": {"oid": "e4664d98fb458efc6514d5f3e93607ea76cc797b", "author": {"user": {"login": "cgaggino", "name": "Cristian Gaggino"}}, "url": "https://github.com/mercadopago/px-android/commit/e4664d98fb458efc6514d5f3e93607ea76cc797b", "committedDate": "2020-03-03T22:00:00Z", "message": "* Called clear cap service when tokenize after esc cap"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NzU3OTE2", "url": "https://github.com/mercadopago/px-android/pull/2059#pullrequestreview-368757916", "createdAt": "2020-03-04T13:03:08Z", "commit": {"oid": "e4664d98fb458efc6514d5f3e93607ea76cc797b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMzowMzowOFrOFxsYcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMzowMzowOFrOFxsYcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY1MTY5OQ==", "bodyText": "Si sale bien o mal, siempre hacemos lo mismo? resolveTokenCreation(token)", "url": "https://github.com/mercadopago/px-android/pull/2059#discussion_r387651699", "createdAt": "2020-03-04T13:03:08Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/datasource/CardTokenService.java", "diffHunk": "@@ -104,4 +106,24 @@ public void execute(final Callback<Token> callback) {\n             .updateToken(tokenId, paymentSettingRepository.getPublicKey(), paymentSettingRepository.getPrivateKey(),\n                 securityCodeIntent);\n     }\n-}\n+\n+    @Override\n+    public void clearCap(@NonNull final String cardId, @NonNull final ClearCapCallback callback) {\n+        if (TextUtil.isEmpty(paymentSettingRepository.getPrivateKey())) {\n+            callback.execute();\n+            return;\n+        }\n+        gatewayService.clearCap(API_ENVIRONMENT_INIT, cardId, paymentSettingRepository.getPrivateKey())\n+            .enqueue(new Callback<String>() {\n+                @Override\n+                public void success(final String s) {\n+                    callback.execute();\n+                }\n+\n+                @Override\n+                public void failure(final ApiException apiException) {\n+                    callback.execute();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4664d98fb458efc6514d5f3e93607ea76cc797b"}, "originalPosition": 57}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3880, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}