{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxMjI3MTI0", "number": 2402, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNTowMToxN1rOFGPL1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDozMjo1NVrOFGvKrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMDg0NTY2OnYy", "diffSide": "RIGHT", "path": "gradle.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNTowMToxN1rOIHJpHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNTowMToxN1rOIHJpHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDM2ODkyNA==", "bodyText": "Cuando este el posta lo cambio.", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544368924", "createdAt": "2020-12-16T15:01:17Z", "author": {"login": "jorGonzalez291292"}, "path": "gradle.properties", "diffHunk": "@@ -32,7 +32,7 @@ retrofit=2.6.4\n # Other PX libs\n cardDrawer=2.+\n businessComponents=1.+\n-cardForm=1.+\n+cardForm=EXPERIMENTAL-1.5.2-16122020015253852", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTUzODY0OnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/sheet_options/CardFormBottomSheetFragment.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoxMjozN1rOIHQFVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoxMjozN1rOIHQFVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ3NDQ1Mw==", "bodyText": "\ud83d\udc40", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544474453", "createdAt": "2020-12-16T17:12:37Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/sheet_options/CardFormBottomSheetFragment.kt", "diffHunk": "@@ -67,18 +69,19 @@ internal class CardFormBottomSheetFragment : Fragment() {\n \n             cardFormOptionClick?.onOptionClick()\n \n-            when (cardFormInitType) {\n-                CardFormInitType.STANDARD -> {\n-                    cardFormWrapper.getCardFormWithFragment().start(\n-                        fragmentManager,\n-                        ExpressPaymentFragment.REQ_CODE_CARD_FORM,\n-                        R.id.one_tap_fragment\n-                    )\n-                }\n+            postDelayed(200) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTU3NDc4OnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoxOTo0MlrOIHQaig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxODo1NTowNVrOIHUUOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ3OTg4Mg==", "bodyText": "Me gustar\u00eda que lo handlee directamente one tap, no se puede hacer el start con el fragment?", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544479882", "createdAt": "2020-12-16T17:19:42Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "diffHunk": "@@ -322,6 +327,28 @@ private void resolveCancelReviewAndConfirm(final Intent data) {\n         }\n     }\n \n+    private void resolveCardFormWebViewActivity(final int requestCode, final int resultCode, final Intent data) {\n+        if (resultCode == RESULT_OK) {\n+            final String cardId = data.getStringExtra(CardForm.RESULT_CARD_ID_KEY);\n+            showProgress();\n+            presenter.onCardAdded(cardId, new LifecycleListener.Callback() {\n+                @Override\n+                public void onSuccess() {\n+                    final Fragment fragment;\n+                    if ((fragment = getSupportFragmentManager().findFragmentByTag(TAG_ONETAP_FRAGMENT)) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDU0MzgwMQ==", "bodyText": "No, no se puede.\n    override fun start(activity: AppCompatActivity, requestCode: Int) {\n        CardFormWebActivity.start(activity,requestCode, this)\n    }\n\ny adem\u00e1s si nosotros queremos solo usar el context no vamos a poder iniciar el activity de cardformwebview de forma que devuelva un resultado.\ncompanion object {\n        fun start(activity: AppCompatActivity, requestCode: Int, cardFormWeb: CardFormWeb) {\n            val intent = Intent(activity, CardFormWebActivity::class.java)\n            val bundle = Bundle().also { it.putParcelable(CARD_FORM_EXTRA, cardFormWeb) }\n            intent.putExtras(bundle)\n            activity.startActivityForResult(intent, requestCode)\n        }\n    }", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544543801", "createdAt": "2020-12-16T18:55:05Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/checkout/CheckoutActivity.java", "diffHunk": "@@ -322,6 +327,28 @@ private void resolveCancelReviewAndConfirm(final Intent data) {\n         }\n     }\n \n+    private void resolveCardFormWebViewActivity(final int requestCode, final int resultCode, final Intent data) {\n+        if (resultCode == RESULT_OK) {\n+            final String cardId = data.getStringExtra(CardForm.RESULT_CARD_ID_KEY);\n+            showProgress();\n+            presenter.onCardAdded(cardId, new LifecycleListener.Callback() {\n+                @Override\n+                public void onSuccess() {\n+                    final Fragment fragment;\n+                    if ((fragment = getSupportFragmentManager().findFragmentByTag(TAG_ONETAP_FRAGMENT)) != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ3OTg4Mg=="}, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTU4MzMxOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/Constants.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoyMTozN1rOIHQfyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoyMTozN1rOIHQfyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ4MTIyNA==", "bodyText": "Estar\u00eda bueno que el c\u00f3digo est\u00e9 en quien lo inicia, constants queremos matarlo, es el mismo concept\u00f3 que las EXTRA_KEY, el que inicia deber\u00eda definir el c\u00f3digo para que no haya chances de colisi\u00f3n", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544481224", "createdAt": "2020-12-16T17:21:37Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/Constants.kt", "diffHunk": "@@ -11,4 +11,5 @@ object Constants {\n     const val RESULT_SILENT_ERROR = 8\n     const val EXTRA_BACK_URL = \"back_url\"\n     const val EXTRA_REDIRECT_URL = \"redirect_url\"\n+    const val REQ_CODE_CARD_FORM = 106", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTU5NDYwOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoyNDowMVrOIHQmgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxODozNDowN1rOIHTfNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ4Mjk0Ng==", "bodyText": "por que necesita un post delay?", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544482946", "createdAt": "2020-12-16T17:24:01Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "diffHunk": "@@ -609,7 +611,7 @@ public void onLoadCardFormSheetOptions(final CardFormBottomSheetModel cardFormBo\n \n     @Override\n     public void onNewCardWithSheetOptions() {\n-        cardFormBottomSheet.expand();\n+        new Handler(Looper.getMainLooper()).postDelayed(() -> cardFormBottomSheet.expand(), 200);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDUzMDIyOA==", "bodyText": "Porque o sino se levanta muy de golpe, queda muy feo.", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544530228", "createdAt": "2020-12-16T18:34:07Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "diffHunk": "@@ -609,7 +611,7 @@ public void onLoadCardFormSheetOptions(final CardFormBottomSheetModel cardFormBo\n \n     @Override\n     public void onNewCardWithSheetOptions() {\n-        cardFormBottomSheet.expand();\n+        new Handler(Looper.getMainLooper()).postDelayed(() -> cardFormBottomSheet.expand(), 200);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ4Mjk0Ng=="}, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTYxNDYyOnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/CardFormWrapper.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNzoyODoxNlrOIHQy4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxODozNDoxN1rOIHTflQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ4NjExNA==", "bodyText": "se que esto corresponde a card form pero viendolo ac\u00e1 me gustar\u00eda que se llame como en el otro builder, \"withAccessToken\", tecnicamente es un factory method del builder, por lo que no estas buildeando, estas creando el builder, si no estuviera el static import ser\u00eda Builder.withAccessToken", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544486114", "createdAt": "2020-12-16T17:28:16Z", "author": {"login": "cgaggino"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/CardFormWrapper.kt", "diffHunk": "@@ -18,8 +19,7 @@ internal class CardFormWrapper(\n         .setSessionId(trackingRepository.sessionId)\n         .setExcludedTypes(excludedPaymentTypes).build()\n \n-    //TODO: Change by builder web pay\n-    fun getCardFormWithWebView() = withAccessToken(privateKey, siteId, trackingRepository.flowId)\n+    fun getCardFormWithWebView() = buildWithAccessToken(privateKey, siteId, trackingRepository.flowId)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDUzMDMyNQ==", "bodyText": "Dale", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r544530325", "createdAt": "2020-12-16T18:34:17Z", "author": {"login": "jorGonzalez291292"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/CardFormWrapper.kt", "diffHunk": "@@ -18,8 +19,7 @@ internal class CardFormWrapper(\n         .setSessionId(trackingRepository.sessionId)\n         .setExcludedTypes(excludedPaymentTypes).build()\n \n-    //TODO: Change by builder web pay\n-    fun getCardFormWithWebView() = withAccessToken(privateKey, siteId, trackingRepository.flowId)\n+    fun getCardFormWithWebView() = buildWithAccessToken(privateKey, siteId, trackingRepository.flowId)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ4NjExNA=="}, "originalCommit": {"oid": "62b7286eafb1deb63a3a78609c80b6139f4f5cb2"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjA4NTU2OnYy", "diffSide": "RIGHT", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/CardFormWrapper.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDozMjo1NVrOIH4Zmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDozMjo1NVrOIH4Zmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTEzNTAwMg==", "bodyText": "Pareciera que no se usa este import", "url": "https://github.com/mercadopago/px-android/pull/2402#discussion_r545135002", "createdAt": "2020-12-17T14:32:55Z", "author": {"login": "guchito9"}, "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/util/CardFormWrapper.kt", "diffHunk": "@@ -1,9 +1,10 @@\n package com.mercadopago.android.px.internal.util\n \n-import com.mercadolibre.android.cardform.internal.CardFormWithFragment.Builder.Companion.withAccessToken\n+import com.mercadolibre.android.cardform.internal.CardFormWeb\n+import com.mercadolibre.android.cardform.internal.CardFormWithFragment\n import com.mercadopago.android.px.internal.repository.PaymentSettingRepository\n import com.mercadopago.android.px.internal.tracking.TrackingRepository\n-import java.util.*\n+import java.util.Collections", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3cc6a0cac385b5083a69e445fa73281dd3d9514"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1746, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}