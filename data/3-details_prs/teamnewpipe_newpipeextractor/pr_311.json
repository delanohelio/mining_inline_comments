{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMjIyOTcw", "number": 311, "title": "Search: add isCorrectedSearch() and fix YoutubeSearchExtractor#getSea\u2026", "bodyText": "I carefully read the contribution guidelines and agree to them.\n I have tested the API against NewPipe.\n I agree to create a pull request for NewPipe as soon as possible to make it compatible with the changed API.\n\nSee TeamNewPipe/NewPipe#3419 and TeamNewPipe/NewPipe#3419 (comment)\nWith TeamNewPipe/NewPipe#3419, I figured out two things:\nYouTube (& YouTube Music) either corrects your query, or suggest another one.\nI fixed the suggestion in YouTube which were actually the corrected query, and added a boolean to know if the query was corrected.", "createdAt": "2020-04-11T17:39:11Z", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311", "merged": true, "mergeCommit": {"oid": "baf5dd3e8f83bd8e3c5b616e1e377d06b8387624"}, "closed": true, "closedAt": "2020-05-12T07:29:16Z", "author": {"login": "B0pol"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcW5r5SgFqTM5MTg1MzMxNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgfGYQgFqTQwOTc2Njc0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODUzMzE2", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#pullrequestreview-391853316", "createdAt": "2020-04-12T12:41:02Z", "commit": {"oid": "fb18df7243eec1dadadc4d142463e1f48d7bef0b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxMjo0MTowMlrOGEVEyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxMjo0NDo0NlrOGEVGkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE5Mjc3Nw==", "bodyText": "Where is there no closing tag?", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#discussion_r407192777", "createdAt": "2020-04-12T12:41:02Z", "author": {"login": "wb9688"}, "path": "extractor/src/main/java/org/schabi/newpipe/extractor/search/SearchExtractor.java", "diffHunk": "@@ -37,4 +37,15 @@ public SearchQueryHandler getLinkHandler() {\n     public String getName() {\n         return getLinkHandler().getSearchString();\n     }\n+\n+    /**\n+     * When you search on some service, it can give you another and corrected request.\n+     * This method says if it's the case.\n+     * <p>\n+     * Example: on YouTube, if you search for \"pewdeipie\",\n+     * it will give you results for \"pewdiepie\", then isCorrectedSearch should return true.\n+     *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb18df7243eec1dadadc4d142463e1f48d7bef0b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE5Mjg0Mw==", "bodyText": "Please use a setter", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#discussion_r407192843", "createdAt": "2020-04-12T12:41:43Z", "author": {"login": "wb9688"}, "path": "extractor/src/main/java/org/schabi/newpipe/extractor/search/SearchInfo.java", "diffHunk": "@@ -46,6 +47,11 @@ public static SearchInfo getInfo(SearchExtractor extractor) throws ExtractionExc\n         } catch (Exception e) {\n             info.addError(e);\n         }\n+        try {\n+            info.isCorrectedSearch = extractor.isCorrectedSearch();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb18df7243eec1dadadc4d142463e1f48d7bef0b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE5Mjg5Mg==", "bodyText": "final", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#discussion_r407192892", "createdAt": "2020-04-12T12:42:10Z", "author": {"login": "wb9688"}, "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/youtube/extractors/YoutubeMusicSearchExtractor.java", "diffHunk": "@@ -141,6 +141,19 @@ public String getSearchSuggestion() throws ParsingException {\n         return getTextFromObject(didYouMeanRenderer.getObject(\"correctedQuery\"));\n     }\n \n+    @Override\n+    public boolean isCorrectedSearch() {\n+        final JsonObject itemSectionRenderer = initialData.getObject(\"contents\").getObject(\"sectionListRenderer\")\n+                .getArray(\"contents\").getObject(0).getObject(\"itemSectionRenderer\");\n+        if (itemSectionRenderer == null) {\n+            return false;\n+        }\n+\n+        JsonObject showingResultsForRenderer = itemSectionRenderer.getArray(\"contents\").getObject(0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb18df7243eec1dadadc4d142463e1f48d7bef0b"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE5MzIzMg==", "bodyText": "Why no expected search suggestion here?", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#discussion_r407193232", "createdAt": "2020-04-12T12:44:46Z", "author": {"login": "wb9688"}, "path": "extractor/src/test/java/org/schabi/newpipe/extractor/services/youtube/search/YoutubeSearchExtractorTest.java", "diffHunk": "@@ -132,8 +132,30 @@ public static void setUp() throws Exception {\n         @Override public String expectedOriginalUrlContains() { return \"youtube.com/results?search_query=\" + QUERY; }\n         @Override public String expectedSearchString() { return QUERY; }\n         @Nullable @Override public String expectedSearchSuggestion() { return EXPECTED_SUGGESTION; }\n+        @Override public InfoItem.InfoType expectedInfoItemType() { return InfoItem.InfoType.STREAM; }\n+    }\n+\n+    public static class CorrectedSearch extends DefaultSearchExtractorTest {\n+        private static SearchExtractor extractor;\n+        private static final String QUERY = \"pewdeipie\";\n \n+        @BeforeClass\n+        public static void setUp() throws Exception {\n+            NewPipe.init(DownloaderTestImpl.getInstance());\n+            extractor = YouTube.getSearchExtractor(QUERY, singletonList(VIDEOS), \"\");\n+            extractor.fetchPage();\n+        }\n+\n+        @Override public SearchExtractor extractor() { return extractor; }\n+        @Override public StreamingService expectedService() { return YouTube; }\n+        @Override public String expectedName() { return QUERY; }\n+        @Override public String expectedId() { return QUERY; }\n+        @Override public String expectedUrlContains() { return \"youtube.com/results?search_query=\" + QUERY; }\n+        @Override public String expectedOriginalUrlContains() { return \"youtube.com/results?search_query=\" + QUERY; }\n+        @Override public String expectedSearchString() { return QUERY; }\n+        @Nullable @Override public String expectedSearchSuggestion() { return null; }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb18df7243eec1dadadc4d142463e1f48d7bef0b"}, "originalPosition": 36}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e3733f4dfe5cbd5de3607925d052a6aa426efda6", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/e3733f4dfe5cbd5de3607925d052a6aa426efda6", "committedDate": "2020-04-12T13:27:51Z", "message": "put an Object final & add setter for isCorrectedSearch"}, "afterCommit": {"oid": "ff8354680e1c43146f628ccd0d289bd8cef3ff4e", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/ff8354680e1c43146f628ccd0d289bd8cef3ff4e", "committedDate": "2020-04-12T13:36:04Z", "message": "Use setters in SearchInfo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODYxNTcx", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#pullrequestreview-391861571", "createdAt": "2020-04-12T14:13:00Z", "commit": {"oid": "6d177e995c101df5cb7f367d5fc5fed6aa8bd800"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df1ff6faa41b29374623a9f4ff06b5b9f1320729", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/df1ff6faa41b29374623a9f4ff06b5b9f1320729", "committedDate": "2020-04-14T11:39:01Z", "message": "add an area to transform links"}, "afterCommit": {"oid": "6d177e995c101df5cb7f367d5fc5fed6aa8bd800", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/6d177e995c101df5cb7f367d5fc5fed6aa8bd800", "committedDate": "2020-04-12T14:06:52Z", "message": "getSearchSuggestion now returns the corrected query if isCorrectedSearch() is true"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDQ2NTk5", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#pullrequestreview-394046599", "createdAt": "2020-04-15T18:53:16Z", "commit": {"oid": "6d177e995c101df5cb7f367d5fc5fed6aa8bd800"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxODo1MzoxN1rOGGHLEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxODo1MzoxN1rOGGHLEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTA2MjE2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    isCorrectedSearch = correctedSearch;\n          \n          \n            \n                    this.isCorrectedSearch = correctedSearch;\n          \n      \n    \n    \n  \n\nUse this here too, for consistency's sake", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#discussion_r409062161", "createdAt": "2020-04-15T18:53:17Z", "author": {"login": "Stypox"}, "path": "extractor/src/main/java/org/schabi/newpipe/extractor/search/SearchInfo.java", "diffHunk": "@@ -70,4 +76,16 @@ public String getSearchString() {\n     public String getSearchSuggestion() {\n         return searchSuggestion;\n     }\n+\n+    public boolean isCorrectedSearch() {\n+        return this.isCorrectedSearch;\n+    }\n+\n+    public void setCorrectedSearch(boolean correctedSearch) {\n+        isCorrectedSearch = correctedSearch;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d177e995c101df5cb7f367d5fc5fed6aa8bd800"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDczODQx", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#pullrequestreview-394073841", "createdAt": "2020-04-15T19:32:11Z", "commit": {"oid": "621be5ba3b7d72e486111555a9a0e4400c8beedd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDYzOTYy", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#pullrequestreview-407463962", "createdAt": "2020-05-07T13:21:10Z", "commit": {"oid": "f79819e7526f3c436a01896ee2626d7389e0633d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzoyMToxMFrOGR-Muw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMzoyMToxMFrOGR-Muw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ5ODA0Mw==", "bodyText": "That works, however you could just do .isEmpty() instead, which would be slightly faster, but mainly is more readable imho", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#discussion_r421498043", "createdAt": "2020-05-07T13:21:10Z", "author": {"login": "wb9688"}, "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/youtube/extractors/YoutubeMusicSearchExtractor.java", "diffHunk": "@@ -133,7 +133,7 @@ public String getUrl() throws ParsingException {\n     public String getSearchSuggestion() throws ParsingException {\n         final JsonObject itemSectionRenderer = initialData.getObject(\"contents\").getObject(\"sectionListRenderer\")\n                 .getArray(\"contents\").getObject(0).getObject(\"itemSectionRenderer\");\n-        if (itemSectionRenderer == null) {\n+        if (itemSectionRenderer.equals(JsonUtils.EMPTY_OBJECT)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f79819e7526f3c436a01896ee2626d7389e0633d"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c2242d36ffe700af597262ee2ab0bd8320fb247", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/4c2242d36ffe700af597262ee2ab0bd8320fb247", "committedDate": "2020-05-05T08:09:35Z", "message": "clarified javadoc for isCorrectedSearch and getSearchSuggestions in SearchExtractor"}, "afterCommit": {"oid": "6fca13e84ce80bfe189458644107ede96f7ce6cf", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/6fca13e84ce80bfe189458644107ede96f7ce6cf", "committedDate": "2020-05-07T13:38:41Z", "message": "renaming methods for consistency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29b639b454ce38f29d9dcc4c9fe054d581005bbe", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/29b639b454ce38f29d9dcc4c9fe054d581005bbe", "committedDate": "2020-05-07T13:39:57Z", "message": "Search: add isCorrectedSearch() and fix YoutubeSearchExtractor#getSearchSuggestion()\n\nisCorrectedSearch: see the javadoc\ngetSearchSuggestion: in YoutubeSearchExtractor, it was giving the corrected search query. It now gives the suggested query, as it should"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d1c3b3fa2f9a28e6caf91621b3a88eff0e81a3c", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/5d1c3b3fa2f9a28e6caf91621b3a88eff0e81a3c", "committedDate": "2020-05-07T13:39:57Z", "message": "Use setters in SearchInfo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8d58e09c9be249bfa430357c059443cebda6989", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/e8d58e09c9be249bfa430357c059443cebda6989", "committedDate": "2020-05-07T13:40:41Z", "message": "getSearchSuggestion now returns the corrected query if isCorrectedSearch() is true"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79483a6dc04a1d37e1e9e661b113632ddb420bf7", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/79483a6dc04a1d37e1e9e661b113632ddb420bf7", "committedDate": "2020-05-07T13:40:41Z", "message": "\u00abUse this in SearchInfo, for consistency's sake\u00bb @Stypox order xD"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3757541a9c8223d4ffce261faddee95112f125b5", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/3757541a9c8223d4ffce261faddee95112f125b5", "committedDate": "2020-05-07T13:40:41Z", "message": "adapt new nanojson version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93e868634e1f3ab0fbfaf3724555c3c496108c21", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/93e868634e1f3ab0fbfaf3724555c3c496108c21", "committedDate": "2020-05-07T13:40:41Z", "message": "clarified javadoc for isCorrectedSearch and getSearchSuggestions in SearchExtractor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5760366d70ca5c6413f759af5b9be2c7e36c919a", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/5760366d70ca5c6413f759af5b9be2c7e36c919a", "committedDate": "2020-05-07T13:40:41Z", "message": "use JsonObject#isEmpty instead of JsonObject#equals(JsonUtils.EMPTY_OBJECT)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cff5de400f33f9e93c79efbf60cc0b7011b3027", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/6cff5de400f33f9e93c79efbf60cc0b7011b3027", "committedDate": "2020-05-07T13:40:41Z", "message": "renaming methods for consistency"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6fca13e84ce80bfe189458644107ede96f7ce6cf", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/6fca13e84ce80bfe189458644107ede96f7ce6cf", "committedDate": "2020-05-07T13:38:41Z", "message": "renaming methods for consistency"}, "afterCommit": {"oid": "6cff5de400f33f9e93c79efbf60cc0b7011b3027", "author": {"user": {"login": "B0pol", "name": "bopol"}}, "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/6cff5de400f33f9e93c79efbf60cc0b7011b3027", "committedDate": "2020-05-07T13:40:41Z", "message": "renaming methods for consistency"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NzY2NzQ2", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/311#pullrequestreview-409766746", "createdAt": "2020-05-12T07:25:41Z", "commit": {"oid": "6cff5de400f33f9e93c79efbf60cc0b7011b3027"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3996, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}