{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNzY0MjA0", "number": 775, "title": "CLDR-14180 Bill Pugh singletons", "bodyText": "CLDR-14180\nMultiple classes, notably:\n\nDBUtils: need special handling for test instances", "createdAt": "2020-10-12T19:20:18Z", "url": "https://github.com/unicode-org/cldr/pull/775", "merged": true, "mergeCommit": {"oid": "f6293a51489a2835c045aa9bcb87a7528970745d"}, "closed": true, "closedAt": "2020-10-13T21:37:29Z", "author": {"login": "srl295"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR5Q7zABqjM4NjgwMzUyMzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSJpXaAFqTUwNzUxMzAxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57d49de7d27a4927ae80c0a7f98611a5c5dce7a4", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/57d49de7d27a4927ae80c0a7f98611a5c5dce7a4", "committedDate": "2020-10-12T19:19:23Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances"}, "afterCommit": {"oid": "61945a1d30a1dcb4b03e58ba17a7034777f068a7", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/61945a1d30a1dcb4b03e58ba17a7034777f068a7", "committedDate": "2020-10-12T19:36:34Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses some to reduce object creation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2ODk1NDk4", "url": "https://github.com/unicode-org/cldr/pull/775#pullrequestreview-506895498", "createdAt": "2020-10-12T20:28:40Z", "commit": {"oid": "61945a1d30a1dcb4b03e58ba17a7034777f068a7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMDoyODo0MVrOHgMPBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMDoyOTozNlrOHgMQdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUxNjkzNQ==", "bodyText": "This doesn't appear right. The key to the Bill Pugh singletons is that the statics are in their own static class. That keeps them from being created until needed.", "url": "https://github.com/unicode-org/cldr/pull/775#discussion_r503516935", "createdAt": "2020-10-12T20:28:41Z", "author": {"login": "macchiati"}, "path": "tools/cldr-apps/src/main/java/org/unicode/cldr/web/CalendarSortMode.java", "diffHunk": "@@ -220,31 +220,33 @@ public boolean isMember(DataRow p) {\n     }\n \n     @Override\n-    Comparator<DataRow> createComparator() {\n-        return comparator();\n+    Comparator<DataRow> getComparator() {\n+        return COMPARATOR;\n     }\n \n-    public static Comparator<DataRow> comparator() {\n+    static final Comparator<DataRow> COMPARATOR = new  Comparator<DataRow>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61945a1d30a1dcb4b03e58ba17a7034777f068a7"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUxNzMwMw==", "bodyText": "This looks better, except that each static should be in its own helper. Otherwise you create all of them when any one of them is created.", "url": "https://github.com/unicode-org/cldr/pull/775#discussion_r503517303", "createdAt": "2020-10-12T20:29:36Z", "author": {"login": "macchiati"}, "path": "tools/cldr-apps/src/main/java/org/unicode/cldr/web/CodeSortMode.java", "diffHunk": "@@ -36,13 +36,20 @@ String getName() {\n     }\n \n     @Override\n-    Comparator<DataRow> createComparator() {\n-        return comparator();\n+    Comparator<DataRow> getComparator() {\n+        return CollatorHelper.COMPARATOR;\n     }\n \n-    public static Comparator<DataRow> comparator() {\n-        return new Comparator<DataRow>() {\n-            final Collator myCollator = createCollator();\n+    static final private class CollatorHelper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61945a1d30a1dcb4b03e58ba17a7034777f068a7"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61945a1d30a1dcb4b03e58ba17a7034777f068a7", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/61945a1d30a1dcb4b03e58ba17a7034777f068a7", "committedDate": "2020-10-12T19:36:34Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses some to reduce object creation"}, "afterCommit": {"oid": "4e37587e5d796071412249f7a9dff16d06102463", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/4e37587e5d796071412249f7a9dff16d06102463", "committedDate": "2020-10-12T23:06:20Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses some to reduce object creation\n- CLDRConfig: needs special handling per environment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4e37587e5d796071412249f7a9dff16d06102463", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/4e37587e5d796071412249f7a9dff16d06102463", "committedDate": "2020-10-12T23:06:20Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses some to reduce object creation\n- CLDRConfig: needs special handling per environment"}, "afterCommit": {"oid": "de912f4c0ba09304266e3e3db3c964e50d1d5c41", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/de912f4c0ba09304266e3e3db3c964e50d1d5c41", "committedDate": "2020-10-12T23:15:29Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de912f4c0ba09304266e3e3db3c964e50d1d5c41", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/de912f4c0ba09304266e3e3db3c964e50d1d5c41", "committedDate": "2020-10-12T23:15:29Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment"}, "afterCommit": {"oid": "a99393e5cc43a4390464c2f233d715b18bc1711d", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/a99393e5cc43a4390464c2f233d715b18bc1711d", "committedDate": "2020-10-12T23:22:59Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a99393e5cc43a4390464c2f233d715b18bc1711d", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/a99393e5cc43a4390464c2f233d715b18bc1711d", "committedDate": "2020-10-12T23:22:59Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment"}, "afterCommit": {"oid": "097faa0da98b1b328f3af1b55cdc07a8966fcaf1", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/097faa0da98b1b328f3af1b55cdc07a8966fcaf1", "committedDate": "2020-10-12T23:42:15Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment\n- deprecated CLDRConfig.getStandardCodes() - just use StandardCodes.make()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2OTc5Nzkz", "url": "https://github.com/unicode-org/cldr/pull/775#pullrequestreview-506979793", "createdAt": "2020-10-12T23:46:05Z", "commit": {"oid": "a99393e5cc43a4390464c2f233d715b18bc1711d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "097faa0da98b1b328f3af1b55cdc07a8966fcaf1", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/097faa0da98b1b328f3af1b55cdc07a8966fcaf1", "committedDate": "2020-10-12T23:42:15Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment\n- deprecated CLDRConfig.getStandardCodes() - just use StandardCodes.make()"}, "afterCommit": {"oid": "b2339d1a8b3a92377135fdfd6d62343e5132fb20", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/b2339d1a8b3a92377135fdfd6d62343e5132fb20", "committedDate": "2020-10-12T23:47:03Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment\n- deprecated CLDRConfig.getStandardCodes() - just use StandardCodes.make()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61041cd5d9d5d2661476a285ead8f25553bf49aa", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/61041cd5d9d5d2661476a285ead8f25553bf49aa", "committedDate": "2020-10-13T14:30:26Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: note special handling per environment. Many getter functions\nalready were practically static in semantics, but the API is retained as\nnon-static. Added some documentation.\n- deprecated CLDRConfig.getStandardCodes(), as callers should use StandardCodes.make()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2339d1a8b3a92377135fdfd6d62343e5132fb20", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/b2339d1a8b3a92377135fdfd6d62343e5132fb20", "committedDate": "2020-10-12T23:47:03Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: needs special handling per environment\n- deprecated CLDRConfig.getStandardCodes() - just use StandardCodes.make()"}, "afterCommit": {"oid": "61041cd5d9d5d2661476a285ead8f25553bf49aa", "author": {"user": {"login": "srl295", "name": "Steven R. Loomis"}}, "url": "https://github.com/unicode-org/cldr/commit/61041cd5d9d5d2661476a285ead8f25553bf49aa", "committedDate": "2020-10-13T14:30:26Z", "message": "CLDR-14180 Bill Pugh singletons\n\nMultiple classes, notably:\n- DBUtils: need special handling for test instances\n- restructured SortMode subclasses to reduce object creation\n- CLDRConfig: note special handling per environment. Many getter functions\nalready were practically static in semantics, but the API is retained as\nnon-static. Added some documentation.\n- deprecated CLDRConfig.getStandardCodes(), as callers should use StandardCodes.make()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NTEzMDE5", "url": "https://github.com/unicode-org/cldr/pull/775#pullrequestreview-507513019", "createdAt": "2020-10-13T14:42:12Z", "commit": {"oid": "61041cd5d9d5d2661476a285ead8f25553bf49aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1886, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}