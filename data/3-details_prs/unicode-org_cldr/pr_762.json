{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MTQ1MDAx", "number": 762, "title": "CLDR-14216 Automate ST db redaction for cldr-smoke", "bodyText": "-New redact-db-playbook.yml to set up and perform redaction\n-New redact-db.sql, fetch_db_sh.j2 and redact_db_sh.j2\n\nChecklist\n\n Issue filed: https://unicode-org.atlassian.net/browse/CLDR-14216\n Updated PR title and link in previous line to include Issue number", "createdAt": "2020-10-05T22:08:01Z", "url": "https://github.com/unicode-org/cldr/pull/762", "merged": true, "mergeCommit": {"oid": "464c39ff2e070a511354db057b2dbe2090f186fa"}, "closed": true, "closedAt": "2020-10-06T13:27:29Z", "author": {"login": "btangmu"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPrNTigH2gAyNDk4MTQ1MDAxOmE4YjdkMTliOTVlZDQ3MjNhZGE1Yzg2MmIzMTZjMjZjZDI5MWJkNmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPsGtXgFqTUwMjQ4MTA1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a8b7d19b95ed4723ada5c862b316c26cd291bd6f", "author": {"user": {"login": "btangmu", "name": "Tom Bishop"}}, "url": "https://github.com/unicode-org/cldr/commit/a8b7d19b95ed4723ada5c862b316c26cd291bd6f", "committedDate": "2020-10-05T22:06:33Z", "message": "CLDR-14216 Automate ST db redaction for cldr-smoke\n\n-New redact-db-playbook.yml to set up and perform redaction\n\n-New redact-db.sql, fetch_db_sh.j2 and redact_db_sh.j2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDgxMDUz", "url": "https://github.com/unicode-org/cldr/pull/762#pullrequestreview-502481053", "createdAt": "2020-10-05T23:09:11Z", "commit": {"oid": "a8b7d19b95ed4723ada5c862b316c26cd291bd6f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMzowOToxMVrOHcwrgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMzowOToxMVrOHcwrgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxOTc0NQ==", "bodyText": "good, so this one is a little different than other playbooks in that it is meant to be run only when redact is needed. Sounds good.  It's not included in setup playbook, for example.", "url": "https://github.com/unicode-org/cldr/pull/762#discussion_r499919745", "createdAt": "2020-10-05T23:09:11Z", "author": {"login": "srl295"}, "path": "tools/scripts/ansible/redact-db-playbook.yml", "diffHunk": "@@ -0,0 +1,73 @@\n+- hosts: redactdb\n+  vars_files:\n+    - vars/main.yml\n+    - local-vars/local.yml\n+  tasks:\n+    - name: set up /home/cldradmin/.ssh/config to fetch db backup\n+      template:\n+        src: templates/cldrbackup/config.j2\n+        dest: /home/cldradmin/.ssh/config\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0640'\n+    - name: set up /home/cldradmin/.ssh/id_rsa\n+      no_log: true\n+      copy:\n+        src: local-vars/cldrbackup/id_rsa\n+        dest: /home/cldradmin/.ssh/id_rsa\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0600'\n+    - name: set up /home/cldradmin/.ssh/id_rsa.pub\n+      copy:\n+        src: local-vars/cldrbackup/id_rsa.pub\n+        dest: /home/cldradmin/.ssh/id_rsa.pub\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0640'\n+    - name: set up /home/cldradmin/.ssh/known_hosts\n+      copy:\n+        src: local-vars/cldrbackup/known_hosts\n+        dest: /home/cldradmin/.ssh/known_hosts\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0640'\n+    - name: set up /home/cldradmin/redact-db.sql\n+      copy:\n+        src: templates/cldrbackup/redact-db.sql\n+        dest: /home/cldradmin/redact-db.sql\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0640'\n+    - name: set up /home/cldradmin/fetch-db.sh\n+      template:\n+        src: templates/cldrbackup/fetch_db_sh.j2\n+        dest: /home/cldradmin/fetch-db.sh\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0640'\n+    - name: set up /home/cldradmin/redact-db.sh\n+      template:\n+        src: templates/cldrbackup/redact_db_sh.j2\n+        dest: /home/cldradmin/redact-db.sh\n+        owner: cldradmin\n+        group: cldradmin\n+        mode: '0640'\n+    - name: fetch and unzip db\n+      command: bash /home/cldradmin/fetch-db.sh\n+      become: yes\n+      become_user: cldradmin\n+    - name: stop tomcat\n+      become: true\n+      service:\n+        name: tomcat8\n+        state: stopped\n+    - name: redact db\n+      command: bash /home/cldradmin/redact-db.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8b7d19b95ed4723ada5c862b316c26cd291bd6f"}, "originalPosition": 66}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1877, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}