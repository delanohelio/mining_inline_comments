{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3MTYyNjQz", "number": 261, "title": "Disable Teammate kill sound", "bodyText": "Signed-off-by: Vlad me@vladyslav.xyz", "createdAt": "2020-01-25T22:51:05Z", "url": "https://github.com/PGMDev/PGM/pull/261", "merged": true, "mergeCommit": {"oid": "04a7fef87ba82ddbc1a2526dfd91b6e02dd70099"}, "closed": true, "closedAt": "2020-01-29T00:57:29Z", "author": {"login": "VladyslavLukyanenko"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb97kSwgH2gAyMzY3MTYyNjQzOjU0ZDY4MjVmZDI2NzM3ZDc2ODBkOGFlYWQ0MzgzNjk5MjU1OWYwMjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-2fr5gH2gAyMzY3MTYyNjQzOjYxNWRlMjhiZjk4YTZlNzRjZjRkYTJkNDQ0NDM3ODU4YmIwY2ZhYTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "54d6825fd26737d7680d8aead43836992559f020", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/54d6825fd26737d7680d8aead43836992559f020", "committedDate": "2020-01-25T22:48:21Z", "message": "Disable Teammate kill sound\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ5NTQx", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348349541", "createdAt": "2020-01-25T22:55:13Z", "commit": {"oid": "54d6825fd26737d7680d8aead43836992559f020"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMjo1NToxM1rOFhxqkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMjo1NToxM1rOFhxqkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MTA0MA==", "bodyText": "remove the own-kill check if we have a same-party check", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370961040", "createdAt": "2020-01-25T22:55:13Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -55,7 +55,9 @@ private void playRaindrop(Competitor competitor) {\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null && !killer.getId().equals(victim.getId())) {\n+    if (killer != null\n+        && !killer.getId().equals(victim.getId())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54d6825fd26737d7680d8aead43836992559f020"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3e3c4072c9d54e5f0e1ac833b27b9a1800dfdfc", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/d3e3c4072c9d54e5f0e1ac833b27b9a1800dfdfc", "committedDate": "2020-01-25T23:29:08Z", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3857dbb485273e111acdf8e23fec6703e996a297", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/3857dbb485273e111acdf8e23fec6703e996a297", "committedDate": "2020-01-25T23:29:32Z", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzUwNzMy", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348350732", "createdAt": "2020-01-25T23:31:44Z", "commit": {"oid": "3857dbb485273e111acdf8e23fec6703e996a297"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMzozMTo0NFrOFhxwXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMzozMTo0NFrOFhxwXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MjUyNQ==", "bodyText": "Any reason not to use killer.getParty().equals(victim.getParty())?", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370962525", "createdAt": "2020-01-25T23:31:44Z", "author": {"login": "Meeples10"}, "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -32,51 +32,56 @@ public SoundsMatchModule createMatchModule(Match match) throws ModuleLoadExcepti\n   }\n \n   private static final Sound RAINDROP_SOUND = new Sound(\"random.levelup\", 1f, 1.5f);\n+  private static final Sound ENDERMAN_SCREAM = new Sound(\"mob.endermen.scream\", 1f, 1.5f);\n \n   public SoundsMatchModule(Match match) {\n     super(match);\n   }\n \n-  private void playRaindrop(MatchPlayer player) {\n+  private void playSound(MatchPlayer player, Sound sound) {\n     if (player.getSettings().getValue(SettingKey.SOUNDS).equals(SettingValue.SOUNDS_ON)) {\n-      player.playSound(RAINDROP_SOUND);\n+      player.playSound(sound);\n     }\n   }\n \n-  private void playRaindrop(MatchPlayerState playerState) {\n-    playerState.getPlayer().ifPresent(this::playRaindrop);\n+  private void playSound(MatchPlayerState playerState, Sound sound) {\n+    playerState.getPlayer().ifPresent(player -> playSound(player, sound));\n   }\n \n-  private void playRaindrop(Competitor competitor) {\n-    competitor.getPlayers().forEach(this::playRaindrop);\n+  private void playSound(Competitor competitor, Sound sound) {\n+    competitor.getPlayers().forEach(player -> playSound(player, sound));\n   }\n \n   @EventHandler(priority = EventPriority.MONITOR)\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null\n-        && !killer.getId().equals(victim.getId())\n-        && !killer.getParty().getName().equals(victim.getParty().getName())) {\n-      playRaindrop(killer);\n+    if (killer != null) {\n+      if (killer.getId().equals(victim.getId())) {\n+\n+      } else if (killer.getParty().getName().equals(victim.getParty().getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3857dbb485273e111acdf8e23fec6703e996a297"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31c82c10968168fb57fcdac589aa18894934b54f", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/31c82c10968168fb57fcdac589aa18894934b54f", "committedDate": "2020-01-25T23:33:32Z", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzUwOTYw", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348350960", "createdAt": "2020-01-25T23:39:23Z", "commit": {"oid": "31c82c10968168fb57fcdac589aa18894934b54f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMzozOToyM1rOFhxxiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMzozOToyM1rOFhxxiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2MjgyNQ==", "bodyText": "Let's not do this", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370962825", "createdAt": "2020-01-25T23:39:23Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -32,49 +32,56 @@ public SoundsMatchModule createMatchModule(Match match) throws ModuleLoadExcepti\n   }\n \n   private static final Sound RAINDROP_SOUND = new Sound(\"random.levelup\", 1f, 1.5f);\n+  private static final Sound ENDERMAN_SCREAM = new Sound(\"mob.endermen.scream\", 1f, 1.5f);\n \n   public SoundsMatchModule(Match match) {\n     super(match);\n   }\n \n-  private void playRaindrop(MatchPlayer player) {\n+  private void playSound(MatchPlayer player, Sound sound) {\n     if (player.getSettings().getValue(SettingKey.SOUNDS).equals(SettingValue.SOUNDS_ON)) {\n-      player.playSound(RAINDROP_SOUND);\n+      player.playSound(sound);\n     }\n   }\n \n-  private void playRaindrop(MatchPlayerState playerState) {\n-    playerState.getPlayer().ifPresent(this::playRaindrop);\n+  private void playSound(MatchPlayerState playerState, Sound sound) {\n+    playerState.getPlayer().ifPresent(player -> playSound(player, sound));\n   }\n \n-  private void playRaindrop(Competitor competitor) {\n-    competitor.getPlayers().forEach(this::playRaindrop);\n+  private void playSound(Competitor competitor, Sound sound) {\n+    competitor.getPlayers().forEach(player -> playSound(player, sound));\n   }\n \n   @EventHandler(priority = EventPriority.MONITOR)\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null && !killer.getId().equals(victim.getId())) {\n-      playRaindrop(killer);\n+    if (killer != null) {\n+      if (killer.getId().equals(victim.getId())) {\n+\n+      } else if (killer.getParty().equals(victim.getParty())) {\n+        playSound(killer, ENDERMAN_SCREAM);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31c82c10968168fb57fcdac589aa18894934b54f"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86a2b32418a06ad5c62e45cb65e1c00944f228fb", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/86a2b32418a06ad5c62e45cb65e1c00944f228fb", "committedDate": "2020-01-25T23:47:27Z", "message": "Refactor SoundsMatchModule\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "367cffead3ecc42f70d9d7a336592653f6370e7c", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/367cffead3ecc42f70d9d7a336592653f6370e7c", "committedDate": "2020-01-26T01:48:00Z", "message": "Add custom message\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzU1NjU4", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348355658", "createdAt": "2020-01-26T02:31:26Z", "commit": {"oid": "367cffead3ecc42f70d9d7a336592653f6370e7c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNlQwMjozMToyN1rOFhyK8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNlQwMjozMToyN1rOFhyK8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk2OTMzMA==", "bodyText": "I think we should keep the death. key for DeathMessageBuilder exclusively?", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370969330", "createdAt": "2020-01-26T02:31:27Z", "author": {"login": "TheMolkaPL"}, "path": "src/main/i18n/templates/strings.properties", "diffHunk": "@@ -69,6 +69,7 @@ death.predictedSuffix = (predicted)\n # {3} = mob\n # {4} = distance in blocks\n \n+death.friendlyfire.warning = Killing your teammates intentionally will get you punished", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "367cffead3ecc42f70d9d7a336592653f6370e7c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzU3MjIy", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348357222", "createdAt": "2020-01-26T03:46:50Z", "commit": {"oid": "367cffead3ecc42f70d9d7a336592653f6370e7c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNlQwMzo0Njo1MFrOFhyTvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNlQwMzo0Njo1MFrOFhyTvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk3MTU4MQ==", "bodyText": "It is not PGM's duty to moderate, and not every same-team kill is bad. Accidents can happen and there's no need to play enderman scream & warn them they're getting punished.", "url": "https://github.com/PGMDev/PGM/pull/261#discussion_r370971581", "createdAt": "2020-01-26T03:46:50Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/modules/SoundsMatchModule.java", "diffHunk": "@@ -32,49 +33,57 @@ public SoundsMatchModule createMatchModule(Match match) throws ModuleLoadExcepti\n   }\n \n   private static final Sound RAINDROP_SOUND = new Sound(\"random.levelup\", 1f, 1.5f);\n+  private static final Sound ENDERMAN_SCREAM = new Sound(\"mob.endermen.scream\", 1f, 1.5f);\n \n   public SoundsMatchModule(Match match) {\n     super(match);\n   }\n \n-  private void playRaindrop(MatchPlayer player) {\n+  private void playSound(MatchPlayer player, Sound sound) {\n     if (player.getSettings().getValue(SettingKey.SOUNDS).equals(SettingValue.SOUNDS_ON)) {\n-      player.playSound(RAINDROP_SOUND);\n+      player.playSound(sound);\n     }\n   }\n \n-  private void playRaindrop(MatchPlayerState playerState) {\n-    playerState.getPlayer().ifPresent(this::playRaindrop);\n+  private void playSound(MatchPlayerState playerState, Sound sound) {\n+    playerState.getPlayer().ifPresent(player -> playSound(player, sound));\n   }\n \n-  private void playRaindrop(Competitor competitor) {\n-    competitor.getPlayers().forEach(this::playRaindrop);\n+  private void playSound(Competitor competitor, Sound sound) {\n+    competitor.getPlayers().forEach(player -> playSound(player, sound));\n   }\n \n   @EventHandler(priority = EventPriority.MONITOR)\n   public void onMatchPlayerDeath(MatchPlayerDeathEvent event) {\n     ParticipantState killer = event.getKiller();\n     MatchPlayer victim = event.getVictim();\n-    if (killer != null && !killer.getId().equals(victim.getId())) {\n-      playRaindrop(killer);\n+    if (killer != null) {\n+      if (!killer.getId().equals(victim.getId())) {\n+        if (killer.getParty().equals(victim.getParty())) {\n+          playSound(killer, ENDERMAN_SCREAM);\n+          killer.sendWarning(new PersonalizedTranslatable(\"death.friendlyfire.warning\"), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "367cffead3ecc42f70d9d7a336592653f6370e7c"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04cce6b09ead87c3366feedd0302457e1ce080bf", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/04cce6b09ead87c3366feedd0302457e1ce080bf", "committedDate": "2020-01-26T11:44:05Z", "message": "Comply to Pablete\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32d4948453ad864eddfaf63dbfd8c6de7eafd26c", "author": {"user": {"login": "VladyslavLukyanenko", "name": "Vladyslav Lukyanenko"}}, "url": "https://github.com/PGMDev/PGM/commit/32d4948453ad864eddfaf63dbfd8c6de7eafd26c", "committedDate": "2020-01-26T11:54:51Z", "message": "Comply to Pablete\n\nSigned-off-by: Vlad <me@vladyslav.xyz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzgyODk3", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348382897", "createdAt": "2020-01-26T14:29:50Z", "commit": {"oid": "32d4948453ad864eddfaf63dbfd8c6de7eafd26c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzgzMTc1", "url": "https://github.com/PGMDev/PGM/pull/261#pullrequestreview-348383175", "createdAt": "2020-01-26T14:34:41Z", "commit": {"oid": "32d4948453ad864eddfaf63dbfd8c6de7eafd26c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "615de28bf98a6e74cf4da2d444437858bb0cfaa5", "author": {"user": {"login": "Pablete1234", "name": "Pablo Herrera"}}, "url": "https://github.com/PGMDev/PGM/commit/615de28bf98a6e74cf4da2d444437858bb0cfaa5", "committedDate": "2020-01-28T19:27:43Z", "message": "Merge branch 'master' into fix-teammate-death-sound"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 551, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}