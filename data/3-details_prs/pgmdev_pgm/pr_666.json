{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1OTk5MTc5", "number": 666, "title": "Add /votebook command", "bodyText": "Add a vote book command\nThis PR introduces a new command, /votebook, which allows for players who have lost the current voting book or who have joined after a vote has begun to receive the item again.\nScreenshot\n\nFeedback\nWhile there is already the /votenext -o flag, I felt that method of forcing open the vote book to not be as intuitive. And this command solves that by simply giving another book.\nIf you have any further suggestions just let me know \ud83d\udc4d\nSigned-off-by: applenick applenick@users.noreply.github.com", "createdAt": "2020-10-01T06:31:02Z", "url": "https://github.com/PGMDev/PGM/pull/666", "merged": true, "mergeCommit": {"oid": "531912b0eaa8f155d3a07a994dbcbb59bad86970"}, "closed": true, "closedAt": "2020-10-03T18:11:44Z", "author": {"login": "applenick"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOF32NAH2gAyNDk1OTk5MTc5OjJiNTE0NDM3YmFjM2NjMmNmOGNkOTFmOTAyNDNmOGY1YzhiMWE1NWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdO-pbCAFqTUwMTU2NDIxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b", "author": {"user": {"login": "applenick", "name": "applenick"}}, "url": "https://github.com/PGMDev/PGM/commit/2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b", "committedDate": "2020-10-01T00:02:42Z", "message": "Add /votebook command\n* Allows users to spawn a new vote book if lost or joining after vote has begun\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMzg5OTUy", "url": "https://github.com/PGMDev/PGM/pull/666#pullrequestreview-500389952", "createdAt": "2020-10-01T14:12:10Z", "commit": {"oid": "2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNDoxMjoxMFrOHbMVtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNDoxMjoxMFrOHbMVtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI3NTc2Nw==", "bodyText": "Maybe a message if you try to do /votebook during a match? We should have a generic You can not use this command while the match is running anyway IMO.", "url": "https://github.com/PGMDev/PGM/pull/666#discussion_r498275767", "createdAt": "2020-10-01T14:12:10Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/command/MapPoolCommand.java", "diffHunk": "@@ -284,21 +284,36 @@ public static void voteNext(\n       @Switch('o') boolean forceOpen,\n       @Text MapInfo map)\n       throws CommandException {\n+    MapPoll poll = getVotingPool(player, sender, mapOrder);\n+    if (poll != null) {\n+      boolean voteResult = poll.toggleVote(map, ((Player) sender).getUniqueId());\n+      Component voteAction =\n+          TranslatableComponent.of(\n+              voteResult ? \"vote.for\" : \"vote.abstain\",\n+              voteResult ? TextColor.GREEN : TextColor.RED,\n+              map.getStyledName(MapNameStyle.COLOR));\n+      player.sendMessage(voteAction);\n+      poll.sendBook(player, forceOpen);\n+    }\n+  }\n+\n+  @Command(aliases = \"votebook\", desc = \"Spawn a vote book\")\n+  public void voteBook(MatchPlayer player, CommandSender sender, MapOrder mapOrder)\n+      throws CommandException {\n+    MapPoll poll = getVotingPool(player, sender, mapOrder);\n+    if (poll != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNTY0MjEw", "url": "https://github.com/PGMDev/PGM/pull/666#pullrequestreview-501564210", "createdAt": "2020-10-03T18:11:32Z", "commit": {"oid": "2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 323, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}