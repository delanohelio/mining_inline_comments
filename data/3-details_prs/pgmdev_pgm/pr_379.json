{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MzczODE0", "number": 379, "title": "Add a line in /map showing which pools a map is in, if any.", "bodyText": "Closes #257\nTitle. Looks like this:\n2 or more pools will display like this\n\n1 pool will display like this\n\nHow it looks if map is in no pools\n\nSigned-off-by: KingOfSquares simonmorland@gmail.com", "createdAt": "2020-03-26T19:27:08Z", "url": "https://github.com/PGMDev/PGM/pull/379", "merged": true, "mergeCommit": {"oid": "5d1f5ac65d6239c54037857f297eb5a6330bf702"}, "closed": true, "closedAt": "2020-03-27T22:13:34Z", "author": {"login": "KingOfSquares"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRhR5ygH2gAyMzk0MzczODE0OjliN2VjNjNkOWViN2I4MTI4OTlmZDdmMzM4MjUzMTNiOWNiNDFjYzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcR4OWQgFqTM4MzIyODkzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3", "author": {"user": {"login": "KingOfSquares", "name": null}}, "url": "https://github.com/PGMDev/PGM/commit/9b7ec63d9eb7b812899fd7f33825313b9cb41cc3", "committedDate": "2020-03-26T19:29:13Z", "message": "Adds a check on /map that will show which pools a map is included in, if any.\n\nSigned-off-by: KingOfSquares <simonmorland@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fc0f65a696ce6ec5e1842ba8f5cd4eb2e8c6d29", "author": {"user": {"login": "KingOfSquares", "name": null}}, "url": "https://github.com/PGMDev/PGM/commit/9fc0f65a696ce6ec5e1842ba8f5cd4eb2e8c6d29", "committedDate": "2020-03-26T19:20:52Z", "message": "Adds a check on /map that will show which pools a map is included in, if any.\n\nSigned-off-by: KingOfSquares <simonmorland@gmail.com>"}, "afterCommit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3", "author": {"user": {"login": "KingOfSquares", "name": null}}, "url": "https://github.com/PGMDev/PGM/commit/9b7ec63d9eb7b812899fd7f33825313b9cb41cc3", "committedDate": "2020-03-26T19:29:13Z", "message": "Adds a check on /map that will show which pools a map is included in, if any.\n\nSigned-off-by: KingOfSquares <simonmorland@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDE4NDI4", "url": "https://github.com/PGMDev/PGM/pull/379#pullrequestreview-382418428", "createdAt": "2020-03-26T21:03:13Z", "commit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTowMzoxM1rOF8aU8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMToxMjoxNFrOF8aqzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5MDIyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            command.map.mapInfo.containedInMapPools = Pools\n          \n          \n            \n            command.map.mapInfo.pools = Pools", "url": "https://github.com/PGMDev/PGM/pull/379#discussion_r398890224", "createdAt": "2020-03-26T21:03:13Z", "author": {"login": "Pablete1234"}, "path": "util-bukkit/src/main/i18n/templates/strings.properties", "diffHunk": "@@ -547,6 +547,7 @@ command.map.mapInfo.sourceCode.tip = View the XML code that controls this map\n command.map.mapInfo.proto = Proto\n command.map.mapInfo.source = Source\n command.map.mapInfo.folder = Folder\n+command.map.mapInfo.containedInMapPools = Pools", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5MjExMg==", "bodyText": "This feels so specific that it looks out of place.\nJust from wherever you call, do:\npoolManager.getPools().stream()\n    .filter(p -> p.getMaps().contains(map)).collect(Collectors.toList());", "url": "https://github.com/PGMDev/PGM/pull/379#discussion_r398892112", "createdAt": "2020-03-26T21:04:59Z", "author": {"login": "Pablete1234"}, "path": "core/src/main/java/tc/oc/pgm/rotation/MapPoolManager.java", "diffHunk": "@@ -152,4 +152,16 @@ public void matchEnded(Match match) {\n \n     activeMapPool.matchEnded(match);\n   }\n+\n+  /**\n+   * Checks all loaded {@link MapPool}s for a given {@link MapInfo} and returns all {@link MapPool}s\n+   * that contains it\n+   */\n+  public List<MapPool> contains(MapInfo map) {\n+    List<MapPool> containedIn = new ArrayList<>();\n+    for (MapPool mapPool : this.mapPools) {\n+      if (mapPool.getMaps().contains(map)) containedIn.add(mapPool);\n+    }\n+    return containedIn;\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5NTY4OA==", "bodyText": "String pools = ((MapPoolManager) ..).getPools().stream()\n    .filter(p -> p.getMaps().contains(map)).collect(Collectors.joining(\", \"));", "url": "https://github.com/PGMDev/PGM/pull/379#discussion_r398895688", "createdAt": "2020-03-26T21:11:57Z", "author": {"login": "Pablete1234"}, "path": "core/src/main/java/tc/oc/pgm/commands/MapCommands.java", "diffHunk": "@@ -192,6 +196,16 @@ public void map(Audience audience, CommandSender sender, @Text MapInfo map) {\n     }\n \n     audience.sendMessage(createTagsComponent(map.getTags()));\n+\n+    if (PGM.get().getMapOrder() instanceof MapPoolManager) {\n+      List<MapPool> mapPools = ((MapPoolManager) PGM.get().getMapOrder()).contains(map);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5NTgyMQ==", "bodyText": "this can go away\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private Component createContainedInMapPoolsComponent(List<MapPool> mapPools) {\n          \n          \n            \n                PersonalizedText pools = new PersonalizedText();\n          \n          \n            \n                int iteration = 1;\n          \n          \n            \n                for (MapPool mapPool : mapPools) {\n          \n          \n            \n                  pools.extra(mapPool.getName());\n          \n          \n            \n                  if (mapPools.size() > iteration) pools.extra(\", \");\n          \n          \n            \n                  iteration++;\n          \n          \n            \n                }\n          \n          \n            \n                return new PersonalizedText(pools, ChatColor.GOLD);\n          \n          \n            \n              }", "url": "https://github.com/PGMDev/PGM/pull/379#discussion_r398895821", "createdAt": "2020-03-26T21:12:14Z", "author": {"login": "Pablete1234"}, "path": "core/src/main/java/tc/oc/pgm/commands/MapCommands.java", "diffHunk": "@@ -246,6 +260,17 @@ private static Component createPlayerLimitComponent(CommandSender sender, MapInf\n     return total.extra(\" \").extra(verbose);\n   }\n \n+  private Component createContainedInMapPoolsComponent(List<MapPool> mapPools) {\n+    PersonalizedText pools = new PersonalizedText();\n+    int iteration = 1;\n+    for (MapPool mapPool : mapPools) {\n+      pools.extra(mapPool.getName());\n+      if (mapPools.size() > iteration) pools.extra(\", \");\n+      iteration++;\n+    }\n+    return new PersonalizedText(pools, ChatColor.GOLD);\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7ec63d9eb7b812899fd7f33825313b9cb41cc3"}, "originalPosition": 56}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "301176677b39df3e579606189187d2575e9c4133", "author": {"user": {"login": "KingOfSquares", "name": null}}, "url": "https://github.com/PGMDev/PGM/commit/301176677b39df3e579606189187d2575e9c4133", "committedDate": "2020-03-27T19:13:31Z", "message": "Remove unneeded methods. Use Streams!\n\nSigned-off-by: KingOfSquares <simonmorland@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMjA5MjQ3", "url": "https://github.com/PGMDev/PGM/pull/379#pullrequestreview-383209247", "createdAt": "2020-03-27T21:25:50Z", "commit": {"oid": "301176677b39df3e579606189187d2575e9c4133"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMjI4OTM0", "url": "https://github.com/PGMDev/PGM/pull/379#pullrequestreview-383228934", "createdAt": "2020-03-27T22:13:09Z", "commit": {"oid": "301176677b39df3e579606189187d2575e9c4133"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 468, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}