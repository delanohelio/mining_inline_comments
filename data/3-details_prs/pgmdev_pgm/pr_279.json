{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4OTI4MzEy", "number": 279, "title": "Map Vote Enhancement: Announce the winning map", "bodyText": "Map Vote - Winner Announcement\nCurrently when a map poll comes to an end, the voting tallies are displayed then the server cycles to the next map. I believe it would make it easier for users, if the winning map were to be announced in a more prominent way.\nI implemented two types of announcements via titles and the hotbar. Both of which use the same formatting so the messages are consistent.\nEdit:\nAlso resolves #281\nTitle:\n\nHotbar:\n\nPlayers have the setting to toggle this feature between title, hotbar and off.\nNote:\nWhen naming the setting related to this feature, I was unsure whether to restrict it to map voting exclusively or keep it open for future improvements. One such idea was actually to make announcements relate to other already implemented title features, such as controlling for example when a match is about to start (3, 2, 1 countdown). So in that case, if the player has announcements toggled to hotbar, then instead of the countdown being sent via title, it would be in the hotbar instead.\nIf anyone has feedback regarding the setting values or the formatting for announcements, it'd be appreciated \ud83d\ude04\nSigned-off-by: applenick applenick@users.noreply.github.com", "createdAt": "2020-01-30T07:37:38Z", "url": "https://github.com/PGMDev/PGM/pull/279", "merged": true, "mergeCommit": {"oid": "6144ace0e9732b54631aecf77e81e47bc8806b50"}, "closed": true, "closedAt": "2020-02-02T21:48:09Z", "author": {"login": "applenick"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_VMnwgH2gAyMzY4OTI4MzEyOjRjNmQzNThjOGQxZmVjYWI1OTAxOWRhYjRjMDgwYzdkZmQ1NjlmZmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcAebllAH2gAyMzY4OTI4MzEyOjhiNjc2OWYyN2JkOThkODMyNTRhMzg0MDAyYTRhNGIzN2ZmZWFiNWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4c6d358c8d1fecab59019dab4c080c7dfd569fff", "author": {"user": {"login": "applenick", "name": "applenick"}}, "url": "https://github.com/PGMDev/PGM/commit/4c6d358c8d1fecab59019dab4c080c7dfd569fff", "committedDate": "2020-01-30T07:13:57Z", "message": "Announce map poll winner\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwOTc1NDQw", "url": "https://github.com/PGMDev/PGM/pull/279#pullrequestreview-350975440", "createdAt": "2020-01-30T16:45:08Z", "commit": {"oid": "4c6d358c8d1fecab59019dab4c080c7dfd569fff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo0NTowOFrOFjyDJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo0NTowOFrOFjyDJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2NDQ4NQ==", "bodyText": "I would just merge this method & the sendMessage method, wich is already done per-player, just rename sendMessage to announceMapWinner with the player & picked map as params, and integrate this logic there, it's only called when the map has actually ended.\nYou could also make it so the picked map name is underlined or bolded in the chat msg", "url": "https://github.com/PGMDev/PGM/pull/279#discussion_r373064485", "createdAt": "2020-01-30T16:45:08Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/rotation/MapPoll.java", "diffHunk": "@@ -225,4 +228,32 @@ private void updateScores() {\n     if (voters == 0) return;\n     votes.forEach((m, v) -> mapScores.put(m, Math.max(v.size() / voters, Double.MIN_VALUE)));\n   }\n+\n+  private void announceMapWinner(Match match, MapInfo winner) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c6d358c8d1fecab59019dab4c080c7dfd569fff"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58b9e14011717150943756f857e8d469e921a33e", "author": {"user": {"login": "applenick", "name": "applenick"}}, "url": "https://github.com/PGMDev/PGM/commit/58b9e14011717150943756f857e8d469e921a33e", "committedDate": "2020-02-01T19:25:14Z", "message": "Adjust titles, remove setting, new map name styling\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTE0OTgy", "url": "https://github.com/PGMDev/PGM/pull/279#pullrequestreview-351914982", "createdAt": "2020-02-02T02:24:51Z", "commit": {"oid": "58b9e14011717150943756f857e8d469e921a33e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQwMjoyNDo1MVrOFkf0HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQwMjoyNDo1MVrOFkf0HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgxNDMwMQ==", "bodyText": "Why not just append a .underlined(winner) (or bold)?", "url": "https://github.com/PGMDev/PGM/pull/279#discussion_r373814301", "createdAt": "2020-02-02T02:24:51Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/rotation/MapPoll.java", "diffHunk": "@@ -116,7 +129,9 @@ private Component getMapChatComponent(MatchPlayer viewer, MapInfo map) {\n         new PersonalizedText(\" \").bold(!voted), // Fix 1px symbol diff\n         new PersonalizedText(\"\" + countVotes(votes.get(map)), ChatColor.YELLOW),\n         new PersonalizedText(\"] \"),\n-        map.getStyledName(NameStyle.FANCY));\n+        map.getStyledMapName(\n+            winner ? MapNameStyle.HIGHLIGHT_WITH_AUTHORS : MapNameStyle.COLOR_WITH_AUTHORS,\n+            winner ? ChatColor.GREEN : ChatColor.GOLD));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58b9e14011717150943756f857e8d469e921a33e"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd4681751774ae0b129b45a32a6adc7246f0be6f", "author": {"user": {"login": "applenick", "name": "applenick"}}, "url": "https://github.com/PGMDev/PGM/commit/cd4681751774ae0b129b45a32a6adc7246f0be6f", "committedDate": "2020-02-02T07:36:29Z", "message": "Remove other text from title\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTQzMjQ1", "url": "https://github.com/PGMDev/PGM/pull/279#pullrequestreview-351943245", "createdAt": "2020-02-02T13:54:54Z", "commit": {"oid": "cd4681751774ae0b129b45a32a6adc7246f0be6f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1719f878356629324b00f0648f8910732ee0da18", "author": {"user": {"login": "applenick", "name": "applenick"}}, "url": "https://github.com/PGMDev/PGM/commit/1719f878356629324b00f0648f8910732ee0da18", "committedDate": "2020-02-02T16:39:20Z", "message": "Replace color adjustment with underline\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffaf7ef6db19848ef84008558d5999ad98d7d473", "author": {"user": {"login": "applenick", "name": "applenick"}}, "url": "https://github.com/PGMDev/PGM/commit/ffaf7ef6db19848ef84008558d5999ad98d7d473", "committedDate": "2020-02-02T17:46:40Z", "message": "Update title to use consistent map color\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTYwMzIx", "url": "https://github.com/PGMDev/PGM/pull/279#pullrequestreview-351960321", "createdAt": "2020-02-02T19:01:40Z", "commit": {"oid": "ffaf7ef6db19848ef84008558d5999ad98d7d473"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxOTY1NDUx", "url": "https://github.com/PGMDev/PGM/pull/279#pullrequestreview-351965451", "createdAt": "2020-02-02T20:33:14Z", "commit": {"oid": "ffaf7ef6db19848ef84008558d5999ad98d7d473"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b6769f27bd98d83254a384002a4a4b37ffeab5e", "author": {"user": {"login": "Electroid", "name": "Ashcon Partovi"}}, "url": "https://github.com/PGMDev/PGM/commit/8b6769f27bd98d83254a384002a4a4b37ffeab5e", "committedDate": "2020-02-02T20:33:22Z", "message": "Merge branch 'master' into mapvote-announce-winner"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 558, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}