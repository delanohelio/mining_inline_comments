{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MTE4MzQ5", "number": 390, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwODo0MjowOFrODtAWFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMjoxMzozN1rODtFC3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTE4MTY1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwODo0MjowOFrOF-LRVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwMToxMDoyMlrOF-tfWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDc0MDY5NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ChatColor.DARK_AQUA\n          \n          \n            \n                    ChatColor.AQUA", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r400740695", "createdAt": "2020-03-31T08:42:08Z", "author": {"login": "Pablete1234"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA3NDcwMw==", "bodyText": "Hey @Pablete1234,\nI want to keep all the tool names as separate colors, the observer tool is already Aqua. Do you have any recommendations? Perhaps bolded white or would you rather I swap the colors between the observer tools and this?", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401074703", "createdAt": "2020-03-31T17:06:47Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDc0MDY5NQ=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTMwMTMzNg==", "bodyText": "I\u2019m marking this as resolved, please check my most recent comment below for the new format. I think it looks better than dark aqua. Let me know if you agree.", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401301336", "createdAt": "2020-04-01T01:10:22Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDc0MDY5NQ=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTg4MTAzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMTo1NDowOVrOF-SENw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNzoxMjozMVrOF-f4Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg1MjAyMw==", "bodyText": "This should probably be in ObserverToolFactory / Observing", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r400852023", "createdAt": "2020-03-31T11:54:09Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA3ODM0Nw==", "bodyText": "@KingOfSquares I understand your idea, however that would break convention. Any tool that has built in functionality (picker, observer tools) is created in the match module where the related functionality is located. Were this featured handled outside of PGM then yeah it would be located there. Thanks for the suggestion though \ud83d\ude04", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401078347", "createdAt": "2020-03-31T17:12:31Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg1MjAyMw=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTg5OTc3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMTo1OToxN1rOF-SPtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMTo1OToxN1rOF-SPtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg1NDk2Ng==", "bodyText": "You should also add /tell and /reply", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r400854966", "createdAt": "2020-03-31T11:59:17Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 126}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTkzODI5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMjowOTo1NVrOF-Sm8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzozODo0OVrOF-0VvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MDkxMg==", "bodyText": "I believe you can just cancel PlayerBucketEvent instead of both fill and empty?", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r400860912", "createdAt": "2020-03-31T12:09:55Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTEyMTU4MQ==", "bodyText": "Good idea! I\u2019ll test that out and let you know.", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401121581", "createdAt": "2020-03-31T18:23:08Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MDkxMg=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE2MzI4MQ==", "bodyText": "Ok it\u2019s really weird but the PlayerBucketEvent caused a lot of headaches for an hour. For some reason it caused an issue where players were unable to join the server at all. So I\u2019m just going to keep the separate events.", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401163281", "createdAt": "2020-03-31T19:32:53Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MDkxMg=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxMzU2NQ==", "bodyText": "Well, thanks for trying \ud83d\udc4d", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401413565", "createdAt": "2020-04-01T07:38:49Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MDkxMg=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 201}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTk0NjYwOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMjoxMjoxM1rOF-SsIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNzoyMDozMFrOF-gMSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MjI0Mg==", "bodyText": "Same for this, why not just cancel all InventoryEvents, that way to can also cancel events like InventoryOpenEvent and opening other interfaces like Anvils, Crafting tables..\nEDIT: My bad, InventoryEvents dont directly relate to a player it seems. But you can maybe stop InventoryOpenEvent at least?", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r400862242", "createdAt": "2020-03-31T12:12:13Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW) // ignoreCancelled doesn't seem to work well here\n+  public void onPlayerInteract(final PlayerInteractEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onInventoryClick(final InventoryClickEvent event) {\n+    if (event.getWhoClicked() instanceof Player) {\n+      if (freeze.isFrozen(event.getWhoClicked())) {\n+        event.setCancelled(true);\n+      }\n+    }\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 217}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA4MDEwMA==", "bodyText": "@KingOfSquares Good thinking, however I think it\u2019s fine to allow the inventory open event. Let\u2019s say a moderator is questioning the contents of the frozen player\u2019s inventory, it may be useful to allow the user to open up their inventory and see. Plus with the inventory click blocking it, they can\u2019t edit it anyway.", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401080100", "createdAt": "2020-03-31T17:15:13Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW) // ignoreCancelled doesn't seem to work well here\n+  public void onPlayerInteract(final PlayerInteractEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onInventoryClick(final InventoryClickEvent event) {\n+    if (event.getWhoClicked() instanceof Player) {\n+      if (freeze.isFrozen(event.getWhoClicked())) {\n+        event.setCancelled(true);\n+      }\n+    }\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MjI0Mg=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 217}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA4MzQ2NA==", "bodyText": "@KingOfSquares Also just checked, InventoryEvent is not cancellable either.", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401083464", "createdAt": "2020-03-31T17:20:30Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW) // ignoreCancelled doesn't seem to work well here\n+  public void onPlayerInteract(final PlayerInteractEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onInventoryClick(final InventoryClickEvent event) {\n+    if (event.getWhoClicked() instanceof Player) {\n+      if (freeze.isFrozen(event.getWhoClicked())) {\n+        event.setCancelled(true);\n+      }\n+    }\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MjI0Mg=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 217}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTk1MTY3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMjoxMzozN1rOF-SvSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNzoxODoyOFrOF-gHSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MzA1MQ==", "bodyText": "This should maybe be placed together with the other VeichleEvents? And why not just cancel all VehicleEvents? :p", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r400863051", "createdAt": "2020-03-31T12:13:37Z", "author": {"login": "KingOfSquares"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW) // ignoreCancelled doesn't seem to work well here\n+  public void onPlayerInteract(final PlayerInteractEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onInventoryClick(final InventoryClickEvent event) {\n+    if (event.getWhoClicked() instanceof Player) {\n+      if (freeze.isFrozen(event.getWhoClicked())) {\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerDropItem(final PlayerDropItemEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onEntityDamge(final EntityDamageByEntityEvent event) {\n+    if (freeze.isFrozen(event.getDamager())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleDamage(final VehicleDamageEvent event) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 234}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA4MjE4Ng==", "bodyText": "@KingOfSquares You can\u2019t cancel VehicleEvent xD", "url": "https://github.com/PGMDev/PGM/pull/390#discussion_r401082186", "createdAt": "2020-03-31T17:18:28Z", "author": {"login": "applenick"}, "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -0,0 +1,349 @@\n+package tc.oc.pgm.community.modules;\n+\n+import com.google.common.collect.Lists;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.UUID;\n+import java.util.stream.Collectors;\n+import javax.annotation.Nullable;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.Location;\n+import org.bukkit.Material;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Player;\n+import org.bukkit.entity.TNTPrimed;\n+import org.bukkit.event.EventHandler;\n+import org.bukkit.event.EventPriority;\n+import org.bukkit.event.Listener;\n+import org.bukkit.event.block.BlockBreakEvent;\n+import org.bukkit.event.block.BlockPlaceEvent;\n+import org.bukkit.event.entity.EntityDamageByEntityEvent;\n+import org.bukkit.event.inventory.InventoryClickEvent;\n+import org.bukkit.event.player.PlayerBucketEmptyEvent;\n+import org.bukkit.event.player.PlayerBucketFillEvent;\n+import org.bukkit.event.player.PlayerCommandPreprocessEvent;\n+import org.bukkit.event.player.PlayerDropItemEvent;\n+import org.bukkit.event.player.PlayerInteractEvent;\n+import org.bukkit.event.player.PlayerJoinEvent;\n+import org.bukkit.event.player.PlayerMoveEvent;\n+import org.bukkit.event.player.PlayerQuitEvent;\n+import org.bukkit.event.vehicle.VehicleDamageEvent;\n+import org.bukkit.event.vehicle.VehicleEnterEvent;\n+import org.bukkit.event.vehicle.VehicleExitEvent;\n+import org.bukkit.event.vehicle.VehicleMoveEvent;\n+import org.bukkit.inventory.ItemFlag;\n+import org.bukkit.inventory.ItemStack;\n+import org.bukkit.inventory.meta.ItemMeta;\n+import org.bukkit.util.Vector;\n+import tc.oc.pgm.api.PGM;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.match.MatchModule;\n+import tc.oc.pgm.api.match.MatchScope;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.ObserverInteractEvent;\n+import tc.oc.pgm.community.commands.ModerationCommands;\n+import tc.oc.pgm.events.ListenerScope;\n+import tc.oc.pgm.listeners.ChatDispatcher;\n+import tc.oc.pgm.spawns.events.ObserverKitApplyEvent;\n+import tc.oc.util.bukkit.OnlinePlayerMapAdapter;\n+import tc.oc.util.bukkit.chat.Sound;\n+import tc.oc.util.bukkit.component.Component;\n+import tc.oc.util.bukkit.component.Components;\n+import tc.oc.util.bukkit.component.types.PersonalizedTranslatable;\n+import tc.oc.util.bukkit.named.NameStyle;\n+import tc.oc.util.bukkit.translations.AllTranslations;\n+\n+@ListenerScope(MatchScope.LOADED)\n+public class FreezeMatchModule implements MatchModule, Listener {\n+\n+  private static final Material TOOL_MATERIAL = Material.ICE;\n+  private static final int TOOL_SLOT_NUM = 6;\n+\n+  private final Match match;\n+  private final Freeze freeze;\n+\n+  public FreezeMatchModule(Match match) {\n+    this.match = match;\n+    this.freeze = new Freeze();\n+  }\n+\n+  public Freeze getFreeze() {\n+    return freeze;\n+  }\n+\n+  public List<MatchPlayer> getFrozenPlayers() {\n+    return freeze.frozenPlayers.values().stream().collect(Collectors.toList());\n+  }\n+\n+  private ItemStack getFreezeTool(CommandSender viewer) {\n+    ItemStack stack = new ItemStack(TOOL_MATERIAL);\n+    ItemMeta meta = stack.getItemMeta();\n+    meta.setDisplayName(\n+        ChatColor.DARK_AQUA\n+            + ChatColor.BOLD.toString()\n+            + AllTranslations.get().translate(\"freeze.itemName\", viewer));\n+    meta.addItemFlags(ItemFlag.values());\n+    meta.setLore(\n+        Collections.singletonList(\n+            ChatColor.GRAY + AllTranslations.get().translate(\"freeze.itemDescription\", viewer)));\n+    stack.setItemMeta(meta);\n+    return stack;\n+  }\n+\n+  @EventHandler\n+  public void giveKit(final ObserverKitApplyEvent event) {\n+    Player player = event.getPlayer().getBukkit();\n+    if (player.hasPermission(Permissions.STAFF)) {\n+      player.getInventory().setItem(TOOL_SLOT_NUM, getFreezeTool(player));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerInteractEntity(final ObserverInteractEvent event) {\n+    if (event.getPlayer().isDead()) return;\n+\n+    if (freeze.isFrozen(event.getPlayer().getBukkit())) {\n+      event.setCancelled(true);\n+    } else {\n+      if (event.getClickedItem() != null\n+          && event.getClickedItem().getType() == TOOL_MATERIAL\n+          && event.getPlayer().getBukkit().hasPermission(Permissions.STAFF)\n+          && event.getClickedPlayer() != null) {\n+\n+        event.setCancelled(true);\n+\n+        freeze.setFrozen(\n+            event.getPlayer().getBukkit(),\n+            event.getClickedPlayer(),\n+            !freeze.isFrozen(event.getClickedEntity()));\n+      }\n+    }\n+  }\n+\n+  private static final List<String> ALLOWED_CMDS = Lists.newArrayList(\"/msg\", \"/r\");\n+\n+  @EventHandler(priority = EventPriority.HIGH)\n+  public void onPlayerCommand(final PlayerCommandPreprocessEvent event) {\n+    if (freeze.isFrozen(event.getPlayer()) && !event.getPlayer().hasPermission(Permissions.STAFF)) {\n+      boolean allow =\n+          ALLOWED_CMDS.stream()\n+              .filter(cmd -> event.getMessage().startsWith(cmd))\n+              .findAny()\n+              .isPresent();\n+\n+      if (!allow) {\n+        // Don't allow commands except for those related to chat.\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerMove(final PlayerMoveEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      Location old = event.getFrom();\n+      old.setPitch(event.getTo().getPitch());\n+      old.setYaw(event.getTo().getYaw());\n+      event.setTo(old);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.HIGH, ignoreCancelled = true)\n+  public void onVehicleMove(final VehicleMoveEvent event) {\n+    if (!event.getVehicle().isEmpty() && freeze.isFrozen(event.getVehicle().getPassenger())) {\n+      event.getVehicle().setVelocity(new Vector(0, 0, 0));\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleEnter(final VehicleEnterEvent event) {\n+    if (freeze.isFrozen(event.getEntered())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleExit(final VehicleExitEvent event) {\n+    if (freeze.isFrozen(event.getExited())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockBreak(final BlockBreakEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBlockPlace(final BlockPlaceEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketFill(final PlayerBucketFillEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onBucketEmpty(final PlayerBucketEmptyEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW) // ignoreCancelled doesn't seem to work well here\n+  public void onPlayerInteract(final PlayerInteractEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onInventoryClick(final InventoryClickEvent event) {\n+    if (event.getWhoClicked() instanceof Player) {\n+      if (freeze.isFrozen(event.getWhoClicked())) {\n+        event.setCancelled(true);\n+      }\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onPlayerDropItem(final PlayerDropItemEvent event) {\n+    if (freeze.isFrozen(event.getPlayer())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onEntityDamge(final EntityDamageByEntityEvent event) {\n+    if (freeze.isFrozen(event.getDamager())) {\n+      event.setCancelled(true);\n+    }\n+  }\n+\n+  @EventHandler(priority = EventPriority.LOW, ignoreCancelled = true)\n+  public void onVehicleDamage(final VehicleDamageEvent event) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDg2MzA1MQ=="}, "originalCommit": {"oid": "618c4c876251673fe63705854e82dc5be1c33738"}, "originalPosition": 234}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1065, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}