{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MjM5MjA2", "number": 190, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMTozNToyNFrODV0PaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMjoyNDoyMFrODV0VCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0MjAyNjAxOnYy", "diffSide": "RIGHT", "path": "src/main/java/tc/oc/pgm/listeners/ChatDispatcher.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMTozNToyNFrOFaPNIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMTo1Mzo1N1rOFaPQJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NjQxOQ==", "bodyText": "I'm unsure what blockedNoPermissions message exactly is, but it shouldn't be a no perms, but rather a \"player doesn't want DMS\"", "url": "https://github.com/PGMDev/PGM/pull/190#discussion_r363056419", "createdAt": "2020-01-04T21:35:24Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/listeners/ChatDispatcher.java", "diffHunk": "@@ -102,6 +103,22 @@ public void sendAdmin(Match match, MatchPlayer sender, @Nullable @Text String me\n       desc = \"Send a direct message to a player\",\n       usage = \"[player] [message]\")\n   public void sendDirect(Match match, MatchPlayer sender, Player receiver, @Text String message) {\n+    MatchPlayer matchReceiver = manager.getPlayer(receiver);\n+    if (matchReceiver != null) {\n+      SettingValue option = matchReceiver.getSettings().getValue(SettingKey.PM);\n+\n+      switch (option) {\n+        case PM_OFF:\n+          if (!sender.getBukkit().hasPermission(Permissions.STAFF)) {\n+            String name = receiver.getDisplayName(sender.getBukkit()) + ChatColor.RED;\n+            Component component =\n+                new PersonalizedTranslatable(\"command.message.blockedNoPermissions\", name);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0d91db5e0cc5b2ead19a2a68c4dde348824f9c6"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NzE4OQ==", "bodyText": "It was already in the strings.\nhttps://github.com/Electroid/PGM/blob/1a604f129d510489aa9ec0a398a31b3c787c139d/src/main/i18n/templates/strings.properties#L818", "url": "https://github.com/PGMDev/PGM/pull/190#discussion_r363057189", "createdAt": "2020-01-04T21:53:57Z", "author": {"login": "TheMolkaPL"}, "path": "src/main/java/tc/oc/pgm/listeners/ChatDispatcher.java", "diffHunk": "@@ -102,6 +103,22 @@ public void sendAdmin(Match match, MatchPlayer sender, @Nullable @Text String me\n       desc = \"Send a direct message to a player\",\n       usage = \"[player] [message]\")\n   public void sendDirect(Match match, MatchPlayer sender, Player receiver, @Text String message) {\n+    MatchPlayer matchReceiver = manager.getPlayer(receiver);\n+    if (matchReceiver != null) {\n+      SettingValue option = matchReceiver.getSettings().getValue(SettingKey.PM);\n+\n+      switch (option) {\n+        case PM_OFF:\n+          if (!sender.getBukkit().hasPermission(Permissions.STAFF)) {\n+            String name = receiver.getDisplayName(sender.getBukkit()) + ChatColor.RED;\n+            Component component =\n+                new PersonalizedTranslatable(\"command.message.blockedNoPermissions\", name);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NjQxOQ=="}, "originalCommit": {"oid": "a0d91db5e0cc5b2ead19a2a68c4dde348824f9c6"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0MjAyNzE0OnYy", "diffSide": "RIGHT", "path": "src/main/java/tc/oc/pgm/listeners/ChatDispatcher.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMTozODo0MFrOFaPNrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMTo1NDoyNlrOFaPQLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NjU1OQ==", "bodyText": "A switch-case for 1 option, feels pretty redundant\nif (option == PM_OFF && !sender.getBukkit().hasPermission(Permissions.STAFF)) {\n  // send deny\n  return;\n}", "url": "https://github.com/PGMDev/PGM/pull/190#discussion_r363056559", "createdAt": "2020-01-04T21:38:40Z", "author": {"login": "Pablete1234"}, "path": "src/main/java/tc/oc/pgm/listeners/ChatDispatcher.java", "diffHunk": "@@ -102,6 +103,22 @@ public void sendAdmin(Match match, MatchPlayer sender, @Nullable @Text String me\n       desc = \"Send a direct message to a player\",\n       usage = \"[player] [message]\")\n   public void sendDirect(Match match, MatchPlayer sender, Player receiver, @Text String message) {\n+    MatchPlayer matchReceiver = manager.getPlayer(receiver);\n+    if (matchReceiver != null) {\n+      SettingValue option = matchReceiver.getSettings().getValue(SettingKey.PM);\n+\n+      switch (option) {\n+        case PM_OFF:\n+          if (!sender.getBukkit().hasPermission(Permissions.STAFF)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0d91db5e0cc5b2ead19a2a68c4dde348824f9c6"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NzE5Ng==", "bodyText": "Yeah, I'll change that.", "url": "https://github.com/PGMDev/PGM/pull/190#discussion_r363057196", "createdAt": "2020-01-04T21:54:26Z", "author": {"login": "TheMolkaPL"}, "path": "src/main/java/tc/oc/pgm/listeners/ChatDispatcher.java", "diffHunk": "@@ -102,6 +103,22 @@ public void sendAdmin(Match match, MatchPlayer sender, @Nullable @Text String me\n       desc = \"Send a direct message to a player\",\n       usage = \"[player] [message]\")\n   public void sendDirect(Match match, MatchPlayer sender, Player receiver, @Text String message) {\n+    MatchPlayer matchReceiver = manager.getPlayer(receiver);\n+    if (matchReceiver != null) {\n+      SettingValue option = matchReceiver.getSettings().getValue(SettingKey.PM);\n+\n+      switch (option) {\n+        case PM_OFF:\n+          if (!sender.getBukkit().hasPermission(Permissions.STAFF)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NjU1OQ=="}, "originalCommit": {"oid": "a0d91db5e0cc5b2ead19a2a68c4dde348824f9c6"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0MjA0MDE5OnYy", "diffSide": "RIGHT", "path": "src/main/java/tc/oc/pgm/api/setting/SettingKey.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMjoyNDowOFrOFaPUTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMjoyNDowOFrOFaPUTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1ODI1Mw==", "bodyText": "PM -> MESSAGE. message and dm", "url": "https://github.com/PGMDev/PGM/pull/190#discussion_r363058253", "createdAt": "2020-01-04T22:24:08Z", "author": {"login": "Electroid"}, "path": "src/main/java/tc/oc/pgm/api/setting/SettingKey.java", "diffHunk": "@@ -17,7 +17,8 @@\n   CHAT(\"chat\", CHAT_TEAM, CHAT_GLOBAL, CHAT_ADMIN), // Changes the default chat channel\n   DEATH(\n       Arrays.asList(\"death\", \"dms\"), DEATH_ALL, DEATH_OWN), // Changes which death messages are seen\n-  PICKER(\"picker\", PICKER_AUTO, PICKER_ON, PICKER_OFF); // Changes when the picker is displayed\n+  PICKER(\"picker\", PICKER_AUTO, PICKER_ON, PICKER_OFF), // Changes when the picker is displayed\n+  PM(Arrays.asList(\"pm\", \"dm\", \"msg\"), PM_ON, PM_OFF); // Changes if private messages are accepted", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ba1087d9c6edfb343cc35d9bb680f42468f54ba"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0MjA0MDQyOnYy", "diffSide": "RIGHT", "path": "src/main/java/tc/oc/pgm/api/setting/SettingValue.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMjoyNDoyMFrOFaPUZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMjoyNDoyMFrOFaPUZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1ODI3Nw==", "bodyText": "private -> direct", "url": "https://github.com/PGMDev/PGM/pull/190#discussion_r363058277", "createdAt": "2020-01-04T22:24:20Z", "author": {"login": "Electroid"}, "path": "src/main/java/tc/oc/pgm/api/setting/SettingValue.java", "diffHunk": "@@ -21,7 +21,9 @@\n   DEATH_ALL(\"death\", \"all\"), // Send all death messages, highlight your own\n   PICKER_AUTO(\"picker\", \"auto\"), // Display after cycle, or with permissions.\n   PICKER_ON(\"picker\", \"on\"), // Display the picker GUI always\n-  PICKER_OFF(\"picker\", \"off\"); // Never display the picker GUI\n+  PICKER_OFF(\"picker\", \"off\"), // Never display the picker GUI\n+  PM_ON(\"pm\", \"on\"), // Always accept private messages", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ba1087d9c6edfb343cc35d9bb680f42468f54ba"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1098, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}