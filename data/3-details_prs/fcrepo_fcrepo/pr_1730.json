{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NzAyNzA1", "number": 1730, "title": "Refactor to more broadly use FedoraId instead of a string", "bodyText": "JIRA Ticket: none\nWhat does this Pull Request do?\nRefactors the code to more broadly use FedoraId rather than a string to represent an identifier.\nThere are a handful of methods that I intentionally did not update OcflPersistentStorageUtils because they are removed in the next PR.\nHow should this be tested?\nNo functionality changes. Tests should pass, and everything should continue to work the same as before.\nInterested parties\n@fcrepo4/committers", "createdAt": "2020-07-23T13:20:05Z", "url": "https://github.com/fcrepo/fcrepo/pull/1730", "merged": true, "mergeCommit": {"oid": "f7c9ede08535d14f97da6a36018b6a47ef760bd0"}, "closed": true, "closedAt": "2020-07-23T18:59:53Z", "author": {"login": "pwinckles"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3vNqtgH2gAyNDU1NzAyNzA1OjU0NzgxZGI2YWFmZGEyN2QxMjhmNTE4Mzk2Njc2ZWE1MzZkZTlmOTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc30GKtgFqTQ1NDQwOTQzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "54781db6aafda27d128f518396676ea536de9f94", "author": {"user": {"login": "pwinckles", "name": "Peter Winckles"}}, "url": "https://github.com/fcrepo/fcrepo/commit/54781db6aafda27d128f518396676ea536de9f94", "committedDate": "2020-07-23T13:12:23Z", "message": "refactor operations to use FedoraId"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd1dd2b4a521a2c6ba1dd7d5e435e65ab6ef01d4", "author": {"user": {"login": "pwinckles", "name": "Peter Winckles"}}, "url": "https://github.com/fcrepo/fcrepo/commit/cd1dd2b4a521a2c6ba1dd7d5e435e65ab6ef01d4", "committedDate": "2020-07-23T13:12:23Z", "message": "refactor ResourceHeaders to use FedoraId"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzY5MTQ3", "url": "https://github.com/fcrepo/fcrepo/pull/1730#pullrequestreview-454369147", "createdAt": "2020-07-23T17:56:49Z", "commit": {"oid": "cd1dd2b4a521a2c6ba1dd7d5e435e65ab6ef01d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNzo1Njo0OVrOG2VfCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxODoxMzozOVrOG2WEGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyODI5Nw==", "bodyText": "Could this instead be: fedoraId.asBaseId()?", "url": "https://github.com/fcrepo/fcrepo/pull/1730#discussion_r459628297", "createdAt": "2020-07-23T17:56:49Z", "author": {"login": "awoods"}, "path": "fcrepo-kernel-impl/src/main/java/org/fcrepo/kernel/impl/services/WebacAclServiceImpl.java", "diffHunk": "@@ -76,8 +76,8 @@ public void create(final Transaction transaction, final FedoraId fedoraId, final\n         final RdfStream stream = fromModel(model.getResource(fedoraId.getFullId()).asNode(), model);\n \n         final RdfSourceOperation createOp = rdfSourceOperationFactory\n-                .createBuilder(fedoraId.getResourceId(), FEDORA_WEBAC_ACL_URI)\n-                .parentId(fedoraId.getBaseId())\n+                .createBuilder(fedoraId, FEDORA_WEBAC_ACL_URI)\n+                .parentId(FedoraId.create(fedoraId.getBaseId()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd1dd2b4a521a2c6ba1dd7d5e435e65ab6ef01d4"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYzMzYzNA==", "bodyText": "asBaseId()?", "url": "https://github.com/fcrepo/fcrepo/pull/1730#discussion_r459633634", "createdAt": "2020-07-23T18:06:23Z", "author": {"login": "awoods"}, "path": "fcrepo-persistence-ocfl/src/main/java/org/fcrepo/persistence/ocfl/impl/OcflPersistentStorageUtils.java", "diffHunk": "@@ -180,9 +181,9 @@ public static String resolveExtensions(final String subPath, final boolean isRdf\n      * @param fedoraIdentifier The fedora identifier\n      * @return The resolved topic\n      */\n-    public static  String resolveTopic(final String fedoraIdentifier) {\n-        if (fedoraIdentifier.endsWith(FEDORA_METADATA_SUFFIX)) {\n-            return fedoraIdentifier.substring(0, fedoraIdentifier.indexOf(FEDORA_METADATA_SUFFIX));\n+    public static FedoraId resolveTopic(final FedoraId fedoraIdentifier) {\n+        if (fedoraIdentifier.isDescription()) {\n+            return FedoraId.create(fedoraIdentifier.getBaseId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd1dd2b4a521a2c6ba1dd7d5e435e65ab6ef01d4"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYzNzc4NQ==", "bodyText": "It would seem that this method (which can be private) could be replaced by FedoraId.asBaseId()?", "url": "https://github.com/fcrepo/fcrepo/pull/1730#discussion_r459637785", "createdAt": "2020-07-23T18:13:39Z", "author": {"login": "awoods"}, "path": "fcrepo-persistence-ocfl/src/main/java/org/fcrepo/persistence/ocfl/impl/OcflPersistentStorageUtils.java", "diffHunk": "@@ -180,9 +181,9 @@ public static String resolveExtensions(final String subPath, final boolean isRdf\n      * @param fedoraIdentifier The fedora identifier\n      * @return The resolved topic\n      */\n-    public static  String resolveTopic(final String fedoraIdentifier) {\n-        if (fedoraIdentifier.endsWith(FEDORA_METADATA_SUFFIX)) {\n-            return fedoraIdentifier.substring(0, fedoraIdentifier.indexOf(FEDORA_METADATA_SUFFIX));\n+    public static FedoraId resolveTopic(final FedoraId fedoraIdentifier) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd1dd2b4a521a2c6ba1dd7d5e435e65ab6ef01d4"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46577da59dca2b9da7a04d9890a264afe16a0975", "author": {"user": {"login": "pwinckles", "name": "Peter Winckles"}}, "url": "https://github.com/fcrepo/fcrepo/commit/46577da59dca2b9da7a04d9890a264afe16a0975", "committedDate": "2020-07-23T18:42:11Z", "message": "pr fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NDA5NDMx", "url": "https://github.com/fcrepo/fcrepo/pull/1730#pullrequestreview-454409431", "createdAt": "2020-07-23T18:53:43Z", "commit": {"oid": "46577da59dca2b9da7a04d9890a264afe16a0975"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3175, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}