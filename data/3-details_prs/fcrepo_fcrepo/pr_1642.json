{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0OTgyMjA2", "number": 1642, "title": "Handle binary HTML test", "bodyText": "JIRA Ticket: https://jira.lyrasis.org/browse/FCREPO-3222\nLast PR for the above ticket\nWhat does this Pull Request do?\nCreates a getDescribedResource method for NonRdfSourceDescriptions so they can describe the correct resource.\nModifies the managedPropertyService to use the getDescribedResource to generate correct triples.\nCleans up some redundant logic in StreamingBaseHtmlProvider\nRemoves an un-used Predicate from ContentExposingResource, possibly might need to be re-added to a service later.\nUncomments the last test in FedoraHtmlIT\nThis test required the addition of a createObject() because it previously tried to\nPUT http://localhost:8080/1234-5678/file\n\nBut we currently  try to load 1234-5678 as a resource to be the parent, this will need to be fixed with the implementation of ghost nodes and can be tested by any number of tests in FedoraLdpIT that use the createDatastream() method.\nFor example:\n\nhttps://github.com/fcrepo4/fcrepo4/blob/master/fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java#L496\nhttps://github.com/fcrepo4/fcrepo4/blob/master/fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java#L626\nhttps://github.com/fcrepo4/fcrepo4/blob/master/fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java#L762\nhttps://github.com/fcrepo4/fcrepo4/blob/master/fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java#L1124\nas well as many more\n\nHow should this be tested?\nTests pass, but also when you GET the /fcr:metadata for a binary the RDF should have the subject of the binary and NOT have a fedora:NonRdfSourceDescription type.\nInterested parties\n@fcrepo4/committers", "createdAt": "2020-03-06T19:24:58Z", "url": "https://github.com/fcrepo/fcrepo/pull/1642", "merged": true, "mergeCommit": {"oid": "f1a61b10aa3f5c143cb51209499bfce1ee3b7eb4"}, "closed": true, "closedAt": "2020-03-11T14:03:09Z", "author": {"login": "whikloj"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLHOlhgFqTM3MDYzMjM0MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMe-ckAH2gAyMzg0OTgyMjA2OmQwOGVhNjk0YjUwNzZmZDgyZDNjODI1ZjI1ZjNhMDEzM2JiNGUwYTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNjMyMzQx", "url": "https://github.com/fcrepo/fcrepo/pull/1642#pullrequestreview-370632341", "createdAt": "2020-03-06T21:18:14Z", "commit": {"oid": "4b20ee79759ef702fac83be5e9965515096b9c63"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQyMToxODoxNFrOFzHwdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQyMTozMDo1NVrOFzIErQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE0ODc4OA==", "bodyText": "I think we should probably keep these for rendering these types (except, 'Pairtree').\nIs there a reason why you believe they should go away?", "url": "https://github.com/fcrepo/fcrepo/pull/1642#discussion_r389148788", "createdAt": "2020-03-06T21:18:14Z", "author": {"login": "awoods"}, "path": "fcrepo-http-api/src/main/java/org/fcrepo/http/api/responses/StreamingBaseHtmlProvider.java", "diffHunk": "@@ -164,10 +164,6 @@ void init() throws IOException {\n \n         templatesMap = templatesMapBuilder\n             .put(REPOSITORY_NAMESPACE + \"RepositoryRoot\", velocity.getTemplate(getTemplateLocation(\"root\")))\n-            .put(REPOSITORY_NAMESPACE + \"Binary\", velocity.getTemplate(getTemplateLocation(\"binary\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b20ee79759ef702fac83be5e9965515096b9c63"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MjQzNA==", "bodyText": "I suspect this was put in-place to prioritize the \"RepositoryRoot\" template... did your observations indicate otherwise?", "url": "https://github.com/fcrepo/fcrepo/pull/1642#discussion_r389152434", "createdAt": "2020-03-06T21:27:19Z", "author": {"login": "awoods"}, "path": "fcrepo-http-api/src/main/java/org/fcrepo/http/api/responses/StreamingBaseHtmlProvider.java", "diffHunk": "@@ -257,9 +253,6 @@ private Template getTemplate(final Model rdf, final Node subject,\n             .map(x -> ((HtmlTemplate) x).value()).filter(templatesMap::containsKey).findFirst()\n             .orElseGet(() -> {\n                 final List<String> types = multiValueURI(rdf.getResource(subject.getURI()), type);\n-                if (types.contains(REPOSITORY_NAMESPACE + \"RepositoryRoot\")) {\n-                    return REPOSITORY_NAMESPACE + \"RepositoryRoot\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b20ee79759ef702fac83be5e9965515096b9c63"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1Mzk2NQ==", "bodyText": "This comment can probably now be removed.", "url": "https://github.com/fcrepo/fcrepo/pull/1642#discussion_r389153965", "createdAt": "2020-03-06T21:30:55Z", "author": {"login": "awoods"}, "path": "fcrepo-kernel-impl/src/main/java/org/fcrepo/kernel/impl/models/NonRdfSourceDescriptionImpl.java", "diffHunk": "@@ -47,6 +58,20 @@ public NonRdfSourceDescriptionImpl(final String id,\n     @Override\n     public FedoraResource getDescribedResource() {\n         // TODO must return the described binary", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b20ee79759ef702fac83be5e9965515096b9c63"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9a22814aab44d1f31fe0b104c0d294d530b0801", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/c9a22814aab44d1f31fe0b104c0d294d530b0801", "committedDate": "2020-03-11T03:19:53Z", "message": "Handle binary HTML test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2b2e4907b1408fd514fc83fef7dd5cb8799d6e3", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/b2b2e4907b1408fd514fc83fef7dd5cb8799d6e3", "committedDate": "2020-03-11T03:54:24Z", "message": "Stuff to make the thing work, we hope"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b20ee79759ef702fac83be5e9965515096b9c63", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/4b20ee79759ef702fac83be5e9965515096b9c63", "committedDate": "2020-03-06T19:14:45Z", "message": "Handle binary HTML test"}, "afterCommit": {"oid": "b2b2e4907b1408fd514fc83fef7dd5cb8799d6e3", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/b2b2e4907b1408fd514fc83fef7dd5cb8799d6e3", "committedDate": "2020-03-11T03:54:24Z", "message": "Stuff to make the thing work, we hope"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d08ea694b5076fd82d3c825f25f3a0133bb4e0a3", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/d08ea694b5076fd82d3c825f25f3a0133bb4e0a3", "committedDate": "2020-03-11T03:58:32Z", "message": "Last time I do small PRs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3239, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}