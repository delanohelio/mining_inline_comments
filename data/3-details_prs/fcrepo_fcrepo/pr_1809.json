{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyOTA5NTcy", "number": 1809, "title": "More integration tests", "bodyText": "JIRA Ticket: https://jira.lyrasis.org/browse/FCREPO-3223\nWhat does this Pull Request do?\nAnother iteration on re-enabling integration tests.\nHow should this be tested?\nEnsure the changes made to the tests (or application) are correct.\nIn this exciting episode:\n\nWhen adding a blank node to a resource's graph, we no longer allow you to directly access the blank node as a URI (I was not aware you could ever do that). Instead we just check that the blank node is part of the resource's graph.\nWe ensure that GET -> PUT interactions omit server managed triples.\nWe change the expectations for binary and binary description ETags. They used to be separate and so changing one would not affect the other. They now a linked together.\n\nInterested parties\nTag (@ mention) interested parties or, if unsure, @fcrepo/committers", "createdAt": "2020-11-18T04:50:50Z", "url": "https://github.com/fcrepo/fcrepo/pull/1809", "merged": true, "mergeCommit": {"oid": "ef29e755fc19ede5aec5a1d67bab988629913496"}, "closed": true, "closedAt": "2020-11-19T18:08:12Z", "author": {"login": "whikloj"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdd215dgFqTUzMzk2NjUzNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeGwPSgFqTUzNDcxNjMyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzOTY2NTM1", "url": "https://github.com/fcrepo/fcrepo/pull/1809#pullrequestreview-533966535", "createdAt": "2020-11-18T23:33:37Z", "commit": {"oid": "1303c8068cbd04c75278a278601dbbcb02fe9066"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMzozMzozN1rOH2Gjxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMzozMzo1OFrOH2GkUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5MjYxNQ==", "bodyText": "Could we keep this request with the change to If-Match?", "url": "https://github.com/fcrepo/fcrepo/pull/1809#discussion_r526492615", "createdAt": "2020-11-18T23:33:37Z", "author": {"login": "awoods"}, "path": "fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java", "diffHunk": "@@ -1428,25 +1424,18 @@ public void testBinaryEtags() throws IOException, InterruptedException {\n                 \"INSERT { <> <http://purl.org/dc/elements/1.1/title> 'this is a title' } WHERE {}\"));\n         assertEquals(NO_CONTENT.getStatusCode(), getStatus(httpPatch));\n \n-        // Next, check headers for the binary; they should not have changed\n-        final HttpHead head1 = new HttpHead(location);\n+        // Next, check headers for the binary; they should have changed as binaries and their descriptions are\n+        // versioned together.\n+        final HttpHead head1 = new HttpHead(binaryLocation);\n         try (final CloseableHttpResponse response = execute(head1)) {\n             binaryEtag2 = response.getFirstHeader(\"ETag\").getValue();\n             binaryLastModed2 = response.getFirstHeader(\"Last-Modified\").getValue();\n         }\n \n-        assertEquals(\"ETags should be the same\", binaryEtag1, binaryEtag2);\n-        assertEquals(\"Last-Modified should be the same\", binaryLastModed1, binaryLastModed2);\n-\n-        final HttpGet get6 = new HttpGet(location);\n-        get6.addHeader(\"If-None-Match\", binaryEtag1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1303c8068cbd04c75278a278601dbbcb02fe9066"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5Mjc1Mw==", "bodyText": "Could we keep this request with the change to If-Unmodified-Since?", "url": "https://github.com/fcrepo/fcrepo/pull/1809#discussion_r526492753", "createdAt": "2020-11-18T23:33:58Z", "author": {"login": "awoods"}, "path": "fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java", "diffHunk": "@@ -1428,25 +1424,18 @@ public void testBinaryEtags() throws IOException, InterruptedException {\n                 \"INSERT { <> <http://purl.org/dc/elements/1.1/title> 'this is a title' } WHERE {}\"));\n         assertEquals(NO_CONTENT.getStatusCode(), getStatus(httpPatch));\n \n-        // Next, check headers for the binary; they should not have changed\n-        final HttpHead head1 = new HttpHead(location);\n+        // Next, check headers for the binary; they should have changed as binaries and their descriptions are\n+        // versioned together.\n+        final HttpHead head1 = new HttpHead(binaryLocation);\n         try (final CloseableHttpResponse response = execute(head1)) {\n             binaryEtag2 = response.getFirstHeader(\"ETag\").getValue();\n             binaryLastModed2 = response.getFirstHeader(\"Last-Modified\").getValue();\n         }\n \n-        assertEquals(\"ETags should be the same\", binaryEtag1, binaryEtag2);\n-        assertEquals(\"Last-Modified should be the same\", binaryLastModed1, binaryLastModed2);\n-\n-        final HttpGet get6 = new HttpGet(location);\n-        get6.addHeader(\"If-None-Match\", binaryEtag1);\n-        assertEquals(\"Expected 304 Not Modified\", NOT_MODIFIED.getStatusCode(), getStatus(get6));\n+        assertNotEquals(\"ETags should not be the same\", binaryEtag1, binaryEtag2);\n+        assertNotEquals(\"Last-Modified should not be the same\", binaryLastModed1, binaryLastModed2);\n \n-        final HttpGet get7 = new HttpGet(location);\n-        get7.addHeader(\"If-Modified-Since\", binaryLastModed1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1303c8068cbd04c75278a278601dbbcb02fe9066"}, "originalPosition": 107}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e25388548f907750b0d1322bf99c777aa840b2f", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/9e25388548f907750b0d1322bf99c777aa840b2f", "committedDate": "2020-11-19T15:15:34Z", "message": "More tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8624aa8c017676433799dd33100f4b4e033909b7", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/8624aa8c017676433799dd33100f4b4e033909b7", "committedDate": "2020-11-19T16:56:58Z", "message": "Re-add precondition test and alter memento URI comparison"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1303c8068cbd04c75278a278601dbbcb02fe9066", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/1303c8068cbd04c75278a278601dbbcb02fe9066", "committedDate": "2020-11-18T04:20:10Z", "message": "More tests"}, "afterCommit": {"oid": "8624aa8c017676433799dd33100f4b4e033909b7", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/8624aa8c017676433799dd33100f4b4e033909b7", "committedDate": "2020-11-19T16:56:58Z", "message": "Re-add precondition test and alter memento URI comparison"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54632fb3b19e55d9b7dfb18f2c5bf1d8dcf2afd3", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/54632fb3b19e55d9b7dfb18f2c5bf1d8dcf2afd3", "committedDate": "2020-11-19T17:02:50Z", "message": "Bad use of substring"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NzE2MzI1", "url": "https://github.com/fcrepo/fcrepo/pull/1809#pullrequestreview-534716325", "createdAt": "2020-11-19T18:07:05Z", "commit": {"oid": "54632fb3b19e55d9b7dfb18f2c5bf1d8dcf2afd3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3022, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}