{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NjY0ODk1", "number": 1667, "title": "Ensures that containment index persists between reboots.", "bodyText": "Resolves: https://jira.lyrasis.org/browse/FCREPO-3283\nEnsures that containment index persists between reboots.\n\nJIRA Ticket: https://jira.lyrasis.org/browse/FCREPO-3283\n\nOther Relevant Links (Mailing list discussion, related pull requests, etc.)\n\nWhat does this Pull Request do?\nThis PR changes the H2 database URL so that it persists the database to the fcrepo.ocfl.workdir.\nIn addition,  I moved the datasource and transaction manager configuration into the OCFLPersistenceConfig and removed the duplicate references from the spring configs.\nHow should this be tested?\n\nStart up Fedora.\nAdd a resource.\nStop Fedora\nStart up Fedora\nVerify that the repository root contains the resource.\n\nInterested parties\nTag (@ mention) interested parties or, if unsure, @fcrepo4/committers", "createdAt": "2020-04-24T17:03:48Z", "url": "https://github.com/fcrepo/fcrepo/pull/1667", "merged": true, "mergeCommit": {"oid": "ea3d8572bd1868b8724ac85963143ec371c6ad64"}, "closed": true, "closedAt": "2020-06-01T14:17:51Z", "author": {"login": "dbernstein"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABca0QNggH2gAyNDA4NjY0ODk1OmU3NGZlNGE1NGMwYzg2MmQyMWNmNWE5ZTIxZTFjZjQyMTBkZmQ3Y2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnA5pvAFqTQyMTg3NzE4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e74fe4a54c0c862d21cf5a9e21e1cf4210dfd7cb", "author": {"user": {"login": "dbernstein", "name": "dbernstein"}}, "url": "https://github.com/fcrepo/fcrepo/commit/e74fe4a54c0c862d21cf5a9e21e1cf4210dfd7cb", "committedDate": "2020-04-24T16:40:53Z", "message": "Ensures that containment index persists between reboots.\n\nResolves: https://jira.lyrasis.org/browse/FCREPO-3283"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MzE5MjE0", "url": "https://github.com/fcrepo/fcrepo/pull/1667#pullrequestreview-405319214", "createdAt": "2020-05-04T20:24:02Z", "commit": {"oid": "e74fe4a54c0c862d21cf5a9e21e1cf4210dfd7cb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQyMDoyNDowMlrOGQQyFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQyMDoyNDowMlrOGQQyFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwNTM2Nw==", "bodyText": "How do we configure Fedora to use MySQL, for example?", "url": "https://github.com/fcrepo/fcrepo/pull/1667#discussion_r419705367", "createdAt": "2020-05-04T20:24:02Z", "author": {"login": "awoods"}, "path": "fcrepo-persistence-ocfl/src/main/java/org/fcrepo/persistence/ocfl/impl/OCFLPersistenceConfig.java", "diffHunk": "@@ -42,4 +48,25 @@ public MutableOcflRepository repository() {\n         final OCFLConstants constants = new OCFLConstants();\n         return createRepository(constants.getStorageRootDir(), constants.getWorkDir());\n     }\n+\n+    @Bean\n+    public OCFLConstants ocflConstants(){\n+        return new OCFLConstants();\n+    }\n+\n+    @Bean\n+    public DataSource dataSource(final OCFLConstants ocflConstants) {\n+        final var dataSource = new DriverManagerDataSource();\n+        final var workDir = ocflConstants.getWorkDir().getAbsolutePath();\n+        dataSource.setUrl(\"jdbc:h2:\" + workDir + File.separator + \"containment.idx;FILE_LOCK=SOCKET\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e74fe4a54c0c862d21cf5a9e21e1cf4210dfd7cb"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxODc3MTg5", "url": "https://github.com/fcrepo/fcrepo/pull/1667#pullrequestreview-421877189", "createdAt": "2020-06-01T14:12:06Z", "commit": {"oid": "e74fe4a54c0c862d21cf5a9e21e1cf4210dfd7cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3101, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}