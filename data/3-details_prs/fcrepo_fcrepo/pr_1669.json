{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwNDIyMjQ2", "number": 1669, "title": "Adds support for PATCHing of RDF sources.", "bodyText": "Implement PATCH for RDF\n\nJIRA Ticket: https://jira.lyrasis.org/browse/FCREPO-3078\n\nOther Relevant Links (Mailing list discussion, related pull requests, etc.)\n\nWhat does this Pull Request do?\nAdds support for PATCH and enables the following integration tests:\n\nFedoraLdpIT.testUpdateObjectGraph()\nFedoraLdpIT.testDeleteMultipleMultiValuedProperties\nFedoraLdpIT.testPatchBinary()\nFedoraLdpIT.testPatchBinaryDescriptionWithBinaryProperties()\nFedoraLdpIT.testPatchBinaryNameAndType()\n\nWhat's new?\nBasic PATCH support with 5 old integration tests brought online.  One vestigial integration test was removed.\nHow should this be tested?\n#  create an RDF resource\ncurl -u fedoraAdmin:fedoraAdmin http://localhost:8080/rest/test1 -X PUT -H \"Content-Type: text/turtle\"\n\n# modify  it by adding triples via SPARQL\ncurl -i -XPATCH -H\"Content-type:application/sparql-update\" -ufedoraAdmin:fedoraAdmin -d \"INSERT DATA {<> <http://purl.org/dc/elements/1.1/title> 'MY TITLE'}\" http://localhost:8080/rest/test1 -u fedoraAdmin:fedoraAdmin \n\n# verify that the change took\ncurl -u fedoraAdmin:fedoraAdmin http://localhost:8080/rest/test1\n\n# modify it again by removing triples\ncurl -i -XPATCH -H\"Content-type:application/sparql-update\" -ufedoraAdmin:secret3 -d \"DELETE {<> <http://purl.org/dc/elements/1.1/title> 'MY TITLE'} WHERE {}\" http://localhost:8080/rest/test1 -u fedoraAdmin:fedoraAdmin\n# verify that the removed triples are gone.\ncurl -u fedoraAdmin:fedoraAdmin http://localhost:8080/rest/test1\n\nAdditional Notes:\nThis PR does not attempt to deal with all the potential corner cases around PATCH.  The object is to get PATCH working enough in order to unblock other work (WebACs) that depends on this functionality.\nInterested parties\nTag (@ mention) interested parties or, if unsure, @fcrepo4/committers", "createdAt": "2020-04-29T00:08:09Z", "url": "https://github.com/fcrepo/fcrepo/pull/1669", "merged": true, "mergeCommit": {"oid": "5f2acbee24de0a141229ab80d9a281b372ed2b64"}, "closed": true, "closedAt": "2020-04-30T21:22:07Z", "author": {"login": "dbernstein"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccclt3AH2gAyNDEwNDIyMjQ2Ojk5ODRhY2M3M2RhMDhhNWQzNDkyNGE2NmU3YTc3NTE5MzI2MjJkNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccznaRAFqTQwMzg3NjMyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9984acc73da08a5d34924a66e7a7751932622d54", "author": {"user": {"login": "dbernstein", "name": "dbernstein"}}, "url": "https://github.com/fcrepo/fcrepo/commit/9984acc73da08a5d34924a66e7a7751932622d54", "committedDate": "2020-04-29T18:14:30Z", "message": "Adds support for PATCHing of RDF sources.\n\nResolves:  https://jira.lyrasis.org/browse/FCREPO-3078"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a464140fd8ba8e84423a39b760a094ea42893d7f", "author": {"user": {"login": "dbernstein", "name": "dbernstein"}}, "url": "https://github.com/fcrepo/fcrepo/commit/a464140fd8ba8e84423a39b760a094ea42893d7f", "committedDate": "2020-04-28T23:53:03Z", "message": "Adds support for PATCHing of RDF sources.\n\nResolves:  https://jira.lyrasis.org/browse/FCREPO-3078"}, "afterCommit": {"oid": "9984acc73da08a5d34924a66e7a7751932622d54", "author": {"user": {"login": "dbernstein", "name": "dbernstein"}}, "url": "https://github.com/fcrepo/fcrepo/commit/9984acc73da08a5d34924a66e7a7751932622d54", "committedDate": "2020-04-29T18:14:30Z", "message": "Adds support for PATCHing of RDF sources.\n\nResolves:  https://jira.lyrasis.org/browse/FCREPO-3078"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyOTM0NTc0", "url": "https://github.com/fcrepo/fcrepo/pull/1669#pullrequestreview-402934574", "createdAt": "2020-04-29T18:35:11Z", "commit": {"oid": "9984acc73da08a5d34924a66e7a7751932622d54"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxODozNToxMVrOGOL3_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxODozNToxMVrOGOL3_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUyNzgwNA==", "bodyText": "Is this different than resource.getFedoraId()?", "url": "https://github.com/fcrepo/fcrepo/pull/1669#discussion_r417527804", "createdAt": "2020-04-29T18:35:11Z", "author": {"login": "pwinckles"}, "path": "fcrepo-http-api/src/main/java/org/fcrepo/http/api/ContentExposingResource.java", "diffHunk": "@@ -934,12 +934,11 @@ protected static boolean isRdfContentType(final String contentTypeString) {\n \n \n     protected void patchResourcewithSparql(final FedoraResource resource,\n-            final String requestBody,\n-            final RdfStream resourceTriples) {\n+            final String requestBody) {\n         updatePropertiesService.updateProperties(transaction().getId(),\n                                                  getUserPrincipal(),\n-                                                 resource.getId(),\n-                                                 requestBody, resourceTriples);\n+                                                 FedoraId.create(resource.getId()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9984acc73da08a5d34924a66e7a7751932622d54"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a1db83b3627a44763498a84c4c237cb2832b88f", "author": {"user": {"login": "dbernstein", "name": "dbernstein"}}, "url": "https://github.com/fcrepo/fcrepo/commit/2a1db83b3627a44763498a84c4c237cb2832b88f", "committedDate": "2020-04-29T20:46:48Z", "message": "Removes unused methods and used FedoraResource.getFedoraId()."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNjg3NDk2", "url": "https://github.com/fcrepo/fcrepo/pull/1669#pullrequestreview-403687496", "createdAt": "2020-04-30T16:32:26Z", "commit": {"oid": "2a1db83b3627a44763498a84c4c237cb2832b88f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNzAzMTA1", "url": "https://github.com/fcrepo/fcrepo/pull/1669#pullrequestreview-403703105", "createdAt": "2020-04-30T16:52:46Z", "commit": {"oid": "2a1db83b3627a44763498a84c4c237cb2832b88f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "366a6756e27dc3743dabc75f252b707d23687d6f", "author": {"user": {"login": "dbernstein", "name": "dbernstein"}}, "url": "https://github.com/fcrepo/fcrepo/commit/366a6756e27dc3743dabc75f252b707d23687d6f", "committedDate": "2020-04-30T20:54:04Z", "message": "Unignore state token ITs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzODc2MzI5", "url": "https://github.com/fcrepo/fcrepo/pull/1669#pullrequestreview-403876329", "createdAt": "2020-04-30T21:04:10Z", "commit": {"oid": "366a6756e27dc3743dabc75f252b707d23687d6f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3104, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}