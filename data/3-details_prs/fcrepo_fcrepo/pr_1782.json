{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2MzA1NzAw", "number": 1782, "title": "Reload resource after a PATCH request, enforce request preconditions.", "bodyText": "JIRA Ticket: https://jira.lyrasis.org/browse/FCREPO-3223\nWhat does this Pull Request do?\nAnother iteration on enabling FedoraLdpIT tests.\nHow should this be tested?\nThis is for internal tests.\nPreconditions on a PUT have been enabled, and literal whitespaces are translated to %20 in FedoraId to ensure our IRIs are valid.\nInterested parties\n@fcrepo/committers", "createdAt": "2020-10-19T22:02:34Z", "url": "https://github.com/fcrepo/fcrepo/pull/1782", "merged": true, "mergeCommit": {"oid": "221f5ca3cddfb2b65aa79f12c120e27a23488aef"}, "closed": true, "closedAt": "2020-11-05T14:44:28Z", "author": {"login": "whikloj"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUtGr0gFqTUxMzY1Njc0Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZjcuuAFqTUyNDMzMDUzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNjU2NzQz", "url": "https://github.com/fcrepo/fcrepo/pull/1782#pullrequestreview-513656743", "createdAt": "2020-10-21T13:08:45Z", "commit": {"oid": "15191fb641eaa80cf84b8de839b2d0ad5be1a49f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzowODo0NVrOHlq7zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzowODo0NVrOHlq7zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2Mjc5OQ==", "bodyText": "Perhaps there can be a FedoarId test for this behavior?", "url": "https://github.com/fcrepo/fcrepo/pull/1782#discussion_r509262799", "createdAt": "2020-10-21T13:08:45Z", "author": {"login": "pwinckles"}, "path": "fcrepo-kernel-api/src/main/java/org/fcrepo/kernel/api/identifiers/FedoraId.java", "diffHunk": "@@ -87,7 +87,7 @@\n      * @throws IllegalArgumentException If ID does not start with expected prefix.\n      */\n     private FedoraId(final String fullId) {\n-        this.fullId = ensurePrefix(fullId).replaceAll(\"/+$\", \"\");\n+        this.fullId = ensurePrefix(fullId).replaceAll(\"\\\\s\", \"%20\").replaceAll(\"/+$\", \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15191fb641eaa80cf84b8de839b2d0ad5be1a49f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5181e9068376604c8a023547e165215e3255800c", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/5181e9068376604c8a023547e165215e3255800c", "committedDate": "2020-10-29T18:17:20Z", "message": "Encode spaces in FedoraIds, reload resource after a PATCH request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97a6460c21def397188e66583d5d79b7bb6af0d5", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/97a6460c21def397188e66583d5d79b7bb6af0d5", "committedDate": "2020-10-29T18:17:28Z", "message": "Reject spaces in Slugs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "279d34bd361c6ce53200adf22dd88388c13f64cd", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/279d34bd361c6ce53200adf22dd88388c13f64cd", "committedDate": "2020-10-29T18:17:28Z", "message": "Unencode spaces so they don't get double encoded, encode spaces so they don't appear as literal spaces"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5453384fbc503a1702ac06998adb20ef9d85040a", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/5453384fbc503a1702ac06998adb20ef9d85040a", "committedDate": "2020-10-29T18:09:20Z", "message": "Unencode spaces so they don't get double encoded, encode spaces so they don't appear as literal spaces"}, "afterCommit": {"oid": "279d34bd361c6ce53200adf22dd88388c13f64cd", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/279d34bd361c6ce53200adf22dd88388c13f64cd", "committedDate": "2020-10-29T18:17:28Z", "message": "Unencode spaces so they don't get double encoded, encode spaces so they don't appear as literal spaces"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjMxMDUz", "url": "https://github.com/fcrepo/fcrepo/pull/1782#pullrequestreview-521631053", "createdAt": "2020-11-02T13:34:30Z", "commit": {"oid": "279d34bd361c6ce53200adf22dd88388c13f64cd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMzozNDozMVrOHsEjTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMzozNDozMVrOHsEjTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3Mzk2Ng==", "bodyText": "Why are spaces handled differently from any other character that might otherwise be url encoded? For example, is it okay if a slug contains a literal tab character? If so, what is it about spaces that requires special handling? (I'm not saying it doesn't require special handling, just trying to understand.)\nGenerally speaking, slugs are treated as string literals, yes? So, if I create an object with a slug of %D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82 is that the object's literal id or is it \u043e\u0431\u044a\u0435\u043a\u0442?", "url": "https://github.com/fcrepo/fcrepo/pull/1782#discussion_r515973966", "createdAt": "2020-11-02T13:34:31Z", "author": {"login": "pwinckles"}, "path": "fcrepo-http-api/src/main/java/org/fcrepo/http/api/FedoraLdp.java", "diffHunk": "@@ -799,6 +797,11 @@ private void handleRequestDisallowedOnMemento() {\n     private FedoraId mintNewPid(final FedoraId fedoraId, final String slug) {\n         final String pid;\n \n+        if (!isBlank(slug) && slug.contains(\" \")) {\n+            // Can't use a literal space\n+            throw new CannotCreateResourceException(\"Slug cannot include literal spaces\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "279d34bd361c6ce53200adf22dd88388c13f64cd"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84fc3499ae5c27970cc9b94942ac3f5995e04ae2", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/84fc3499ae5c27970cc9b94942ac3f5995e04ae2", "committedDate": "2020-11-02T21:22:54Z", "message": "Revert \"Unencode spaces so they don't get double encoded, encode spaces so they don't appear as literal spaces\"\n\nThis reverts commit 279d34bd361c6ce53200adf22dd88388c13f64cd."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8de54c0120a21b3ed5b0598b60b0a8baf3ad6da", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/a8de54c0120a21b3ed5b0598b60b0a8baf3ad6da", "committedDate": "2020-11-02T21:23:15Z", "message": "Revert \"Reject spaces in Slugs\"\n\nThis reverts commit 97a6460c21def397188e66583d5d79b7bb6af0d5."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab2a49e9176f34f58908402d56f49eba53e58a7b", "author": {"user": {"login": "whikloj", "name": "Jared Whiklo"}}, "url": "https://github.com/fcrepo/fcrepo/commit/ab2a49e9176f34f58908402d56f49eba53e58a7b", "committedDate": "2020-11-02T21:24:49Z", "message": "Revert changes for spaces in IDs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MjA5ODM5", "url": "https://github.com/fcrepo/fcrepo/pull/1782#pullrequestreview-524209839", "createdAt": "2020-11-05T12:25:54Z", "commit": {"oid": "ab2a49e9176f34f58908402d56f49eba53e58a7b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MzMwNTM0", "url": "https://github.com/fcrepo/fcrepo/pull/1782#pullrequestreview-524330534", "createdAt": "2020-11-05T14:43:24Z", "commit": {"oid": "ab2a49e9176f34f58908402d56f49eba53e58a7b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2985, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}