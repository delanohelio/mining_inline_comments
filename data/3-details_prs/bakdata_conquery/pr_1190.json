{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2ODcwMzM1", "number": 1190, "title": "secondary id improvements", "bodyText": "", "createdAt": "2020-05-12T17:36:08Z", "url": "https://github.com/bakdata/conquery/pull/1190", "merged": true, "mergeCommit": {"oid": "664b19f25e8d0c3d5ad7c6a438401017a21eeb11"}, "closed": true, "closedAt": "2020-10-07T14:58:56Z", "author": {"login": "manuel-hegner"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdyXpVAH2gAyNDE2ODcwMzM1OmI1NjMxYWM4MTQ1OTYzOGZkMTA1ODJlNDYwZjc5M2U0ZTYyYjFhZmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQOSUNAH2gAyNDE2ODcwMzM1OmY4OWMwNDhjNDZhNmNhZDA1NTgzMmI3YWM5OGZkZmY3OTZmYjYxZWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b5631ac81459638fd10582e460f793e4e62b1afd", "author": {"user": {"login": "manuel-hegner", "name": "Manuel Hegner"}}, "url": "https://github.com/bakdata/conquery/commit/b5631ac81459638fd10582e460f793e4e62b1afd", "committedDate": "2020-05-03T22:10:58Z", "message": "added support to SECONDARY_ID_QUERY queries for tables without secondary\nids"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da078e8751b24fbc073bfe350ec8c22c436e2212", "author": {"user": {"login": "manuel-hegner", "name": "Manuel Hegner"}}, "url": "https://github.com/bakdata/conquery/commit/da078e8751b24fbc073bfe350ec8c22c436e2212", "committedDate": "2020-05-03T22:29:36Z", "message": "added secondary id information to REST API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "381defd5c54bdb80668d4642f33a15c039fe2df5", "author": {"user": {"login": "manuel-hegner", "name": "Manuel Hegner"}}, "url": "https://github.com/bakdata/conquery/commit/381defd5c54bdb80668d4642f33a15c039fe2df5", "committedDate": "2020-05-12T17:36:13Z", "message": "Merge branch 'develop' into feature/secondary_id_improvements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97a6ca4b89acfe8cd96a64e3c21d3dd327056c13", "author": {"user": {"login": "manuel-hegner", "name": "Manuel Hegner"}}, "url": "https://github.com/bakdata/conquery/commit/97a6ca4b89acfe8cd96a64e3c21d3dd327056c13", "committedDate": "2020-05-12T17:36:15Z", "message": "Merge 381defd5c54bdb80668d4642f33a15c039fe2df5 into 3567834601be40d3e38a5b1ef8293ecc0c41778b"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b068cbc8c54330e6fb9b53d2847b43c25de3820", "author": {"user": {"login": "bakdata-bot", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/6b068cbc8c54330e6fb9b53d2847b43c25de3820", "committedDate": "2020-05-12T17:38:04Z", "message": "automatic update to docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNjE1MTYz", "url": "https://github.com/bakdata/conquery/pull/1190#pullrequestreview-412615163", "createdAt": "2020-05-15T12:46:01Z", "commit": {"oid": "6b068cbc8c54330e6fb9b53d2847b43c25de3820"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjo0NjowMVrOGWDVmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjo1NzowNVrOGWDthA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc3NjUzNw==", "bodyText": "Warum nicht die Ids?", "url": "https://github.com/bakdata/conquery/pull/1190#discussion_r425776537", "createdAt": "2020-05-15T12:46:01Z", "author": {"login": "awildturtok"}, "path": "backend/src/main/java/com/bakdata/conquery/models/api/description/FERoot.java", "diffHunk": "@@ -12,5 +16,6 @@\n  */\n @Getter\n public class FERoot {\n+\tprivate Set<String> secondaryIds = new HashSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b068cbc8c54330e6fb9b53d2847b43c25de3820"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc4MjMwNg==", "bodyText": "Kannst du die tables vorher auf trennen und dann die schleifen machen? Der Code macht schon so viel, da muss das nicht noch mit drin rumschwirren", "url": "https://github.com/bakdata/conquery/pull/1190#discussion_r425782306", "createdAt": "2020-05-15T12:56:26Z", "author": {"login": "awildturtok"}, "path": "backend/src/main/java/com/bakdata/conquery/models/query/queryplan/SecondaryIdQueryPlan.java", "diffHunk": "@@ -74,32 +72,24 @@ public EntityResult execute(QueryExecutionContext ctx, Entity entity) {\n \t\t\treturn EntityResult.notContained();\n \t\t}\n \n+\t\tList<Table> tablesWithoutSecondary = new ArrayList<>();\n+\t\t//first execute only tables with secondaryIds\n \t\tfor(Table currentTable : query.getRequiredTables()) {\n-\t\t\tcurrentSecondaryIdColumn = findSecondaryIdColumn(currentTable);\n-\t\t\tnextTable(ctx, currentTable);\n-\t\t\tfor(Bucket bucket : entity.getBucket(currentTable.getId())) {\n-\t\t\t\tint localEntity = bucket.toLocal(entity.getId());\n-\t\t\t\tAStringType<?> secondaryIdType = (AStringType<?>)currentSecondaryIdColumn.getTypeFor(bucket);\n-\t\t\t\tnextBlock(bucket);\n-\t\t\t\tif(bucket.containsLocalEntity(localEntity)) {\n-\t\t\t\t\tif(isOfInterest(bucket)) {\n-\t\t\t\t\t\tint start = bucket.getFirstEventOfLocal(localEntity);\n-\t\t\t\t\t\tint end = bucket.getLastEventOfLocal(localEntity);\n-\t\t\t\t\t\tfor(int event = start; event < end ; event++) {\n-\t\t\t\t\t\t\t//we ignore events with no value in the secondaryIdColumn\n-\t\t\t\t\t\t\tif(bucket.has(event, currentSecondaryIdColumn)) {\n-\t\t\t\t\t\t\t\tString key = secondaryIdType.getElement(bucket.getString(event, currentSecondaryIdColumn));\n-\t\t\t\t\t\t\t\tchildPerKey\n-\t\t\t\t\t\t\t\t\t.computeIfAbsent(key, k->this.createChild(k, ctx, bucket))\n-\t\t\t\t\t\t\t\t\t.nextEvent(bucket, event);\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n-\t\t\t\t}\n+\t\t\tColumn secondaryIdColumn = findSecondaryIdColumn(currentTable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b068cbc8c54330e6fb9b53d2847b43c25de3820"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc4MjY2MA==", "bodyText": "Bitte unterschiedliche namen anstatt overloading", "url": "https://github.com/bakdata/conquery/pull/1190#discussion_r425782660", "createdAt": "2020-05-15T12:57:05Z", "author": {"login": "awildturtok"}, "path": "backend/src/main/java/com/bakdata/conquery/models/query/queryplan/SecondaryIdQueryPlan.java", "diffHunk": "@@ -112,6 +102,50 @@ public EntityResult execute(QueryExecutionContext ctx, Entity entity) {\n \t\treturn EntityResult.multilineOf(entity.getId(), result);\n \t}\n \n+\tprivate void execute(QueryExecutionContext ctx, Entity entity, Column secondaryIdColumn) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b068cbc8c54330e6fb9b53d2847b43c25de3820"}, "originalPosition": 99}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fa3727efb1c9234a940671c7afc013cf29bd9bc", "author": {"user": {"login": "awildturtok", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/3fa3727efb1c9234a940671c7afc013cf29bd9bc", "committedDate": "2020-09-30T12:39:33Z", "message": "Merge remote-tracking branch 'origin/develop' into feature/secondary_id_improvements\n\n# Conflicts:\n#\tbackend/src/main/java/com/bakdata/conquery/models/query/queryplan/SecondaryIdQueryPlan.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b9358e318581706270aa5a02951f2c5a09ba0df", "author": {"user": {"login": "bakdata-bot", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/0b9358e318581706270aa5a02951f2c5a09ba0df", "committedDate": "2020-09-30T12:42:02Z", "message": "automatic update to docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NDM0MjA5", "url": "https://github.com/bakdata/conquery/pull/1190#pullrequestreview-499434209", "createdAt": "2020-09-30T13:33:16Z", "commit": {"oid": "0b9358e318581706270aa5a02951f2c5a09ba0df"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NDk3ODgx", "url": "https://github.com/bakdata/conquery/pull/1190#pullrequestreview-499497881", "createdAt": "2020-09-30T14:33:06Z", "commit": {"oid": "0b9358e318581706270aa5a02951f2c5a09ba0df"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4926dd24dc011e3adddb3c0f553f03c32c5c8a1", "author": {"user": {"login": "awildturtok", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/f4926dd24dc011e3adddb3c0f553f03c32c5c8a1", "committedDate": "2020-10-01T12:47:15Z", "message": "fix table of columns"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19593d07950b9501fb057d07a57d87a4a66b69ef", "author": {"user": {"login": "awildturtok", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/19593d07950b9501fb057d07a57d87a4a66b69ef", "committedDate": "2020-10-01T14:19:25Z", "message": "Merge remote-tracking branch 'origin/develop' into feature/secondary_id_improvements\n\n# Conflicts:\n#\tbackend/src/main/java/com/bakdata/conquery/models/query/queryplan/SecondaryIdQueryPlan.java\n#\tdocs/Concept JSONs.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e18f2299c1eb1fa27b956b3800f24d015bbcb1ed", "author": {"user": {"login": "bakdata-bot", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/e18f2299c1eb1fa27b956b3800f24d015bbcb1ed", "committedDate": "2020-10-01T14:21:34Z", "message": "automatic update to docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91b4d30f942371c44433d3540ea718f18ffd6b2b", "author": {"user": {"login": "awildturtok", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/91b4d30f942371c44433d3540ea718f18ffd6b2b", "committedDate": "2020-10-01T14:37:26Z", "message": "fix execution order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzOTcwNDIw", "url": "https://github.com/bakdata/conquery/pull/1190#pullrequestreview-503970420", "createdAt": "2020-10-07T14:55:16Z", "commit": {"oid": "91b4d30f942371c44433d3540ea718f18ffd6b2b"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f89c048c46a6cad055832b7ac98fdff796fb61ee", "author": {"user": {"login": "awildturtok", "name": null}}, "url": "https://github.com/bakdata/conquery/commit/f89c048c46a6cad055832b7ac98fdff796fb61ee", "committedDate": "2020-10-07T14:58:42Z", "message": "Merge branch 'develop' into feature/secondary_id_improvements"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4596, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}