{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1MTgyMTkz", "number": 2352, "title": "Messaging health check", "bodyText": "Add messaging health check so it is possible detect failed channels asap, if any channel intercept onError or cancel signals, whole messaging gets marked as DOWN\n{\n  \"outcome\": \"UP\",\n  \"status\": \"UP\",\n  \"checks\": [\n    {\n      \"name\": \"messaging\",\n      \"state\": \"UP\",\n      \"status\": \"UP\",\n      \"data\": {\n        \"test-channel-1\": \"UP\",\n        \"test-channel-2\": \"UP\"\n      }\n    }\n  ]\n}\nJust add dependency:\n<dependency>\n    <groupId>io.helidon.microprofile.messaging</groupId>\n    <artifactId>helidon-microprofile-messaging-health</artifactId>\n</dependency>", "createdAt": "2020-09-11T15:18:37Z", "url": "https://github.com/oracle/helidon/pull/2352", "merged": true, "mergeCommit": {"oid": "64f3e04916177104661f79cea745e09204298810"}, "closed": true, "closedAt": "2020-09-30T17:25:14Z", "author": {"login": "danielkec"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJwAAMAH2gAyNDg1MTgyMTkzOjY4MjhkNzVhYTUwOWVkNTcxZjQ5MzE3MWM3M2NmYzQ2OTlmZjk3ZjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN_Ri3AFqTQ5OTYwMzY2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6828d75aa509ed571f493171c73cfc4699ff97f2", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/6828d75aa509ed571f493171c73cfc4699ff97f2", "committedDate": "2020-09-17T12:18:00Z", "message": "Messaging health check\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "838a62fdf03c6605f3af0f740af0c95a0b2fb13e", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/838a62fdf03c6605f3af0f740af0c95a0b2fb13e", "committedDate": "2020-09-17T12:18:00Z", "message": "Aliveness check tests\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5154d51147fa4d5c39ed286710bdd0e80c059a5", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/d5154d51147fa4d5c39ed286710bdd0e80c059a5", "committedDate": "2020-09-17T12:18:00Z", "message": "Module info fix\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db53ff622a003ea22c773b7d7fa022e67ac73807", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/db53ff622a003ea22c773b7d7fa022e67ac73807", "committedDate": "2020-09-17T12:18:00Z", "message": "Cleanup\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db115141ee8a6e4e82585d21221fa3f9dfb67cc6", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/db115141ee8a6e4e82585d21221fa3f9dfb67cc6", "committedDate": "2020-09-14T12:27:25Z", "message": "Cleanup\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}, "afterCommit": {"oid": "a1a921579604dee3a3dd302c7bbe5f69feb51e0d", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/a1a921579604dee3a3dd302c7bbe5f69feb51e0d", "committedDate": "2020-09-17T13:14:01Z", "message": "Use @HelidonTest\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1a921579604dee3a3dd302c7bbe5f69feb51e0d", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/a1a921579604dee3a3dd302c7bbe5f69feb51e0d", "committedDate": "2020-09-17T13:14:01Z", "message": "Use @HelidonTest\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0OTAzMjA4", "url": "https://github.com/oracle/helidon/pull/2352#pullrequestreview-494903208", "createdAt": "2020-09-23T17:48:28Z", "commit": {"oid": "a1a921579604dee3a3dd302c7bbe5f69feb51e0d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo0ODoyOFrOHW5zHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo0OTo0MVrOHW52QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc3NzY5Mg==", "bodyText": "Is there a possibility isUp is called before connect? If so, this would return null and most likely cause a NPE", "url": "https://github.com/oracle/helidon/pull/2352#discussion_r493777692", "createdAt": "2020-09-23T17:48:28Z", "author": {"login": "tomas-langer"}, "path": "microprofile/messaging/core/src/main/java/io/helidon/microprofile/messaging/UniversalChannel.java", "diffHunk": "@@ -67,6 +69,10 @@ void setOutgoing(OutgoingMethod outgoingMethod) {\n         this.outgoingMethod = outgoingMethod;\n     }\n \n+    AtomicBoolean isUp() {\n+        return up;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a921579604dee3a3dd302c7bbe5f69feb51e0d"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc3ODQ5Ng==", "bodyText": "Also up is not volatile. Even if the field is AtomicBoolean, access to it must be correctly synchronized if the field may be created in a different thread.\nMaybe the AtomicBoolean should be final and true and sent to Probe.connect as a parameter", "url": "https://github.com/oracle/helidon/pull/2352#discussion_r493778496", "createdAt": "2020-09-23T17:49:41Z", "author": {"login": "tomas-langer"}, "path": "microprofile/messaging/core/src/main/java/io/helidon/microprofile/messaging/UniversalChannel.java", "diffHunk": "@@ -67,6 +69,10 @@ void setOutgoing(OutgoingMethod outgoingMethod) {\n         this.outgoingMethod = outgoingMethod;\n     }\n \n+    AtomicBoolean isUp() {\n+        return up;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc3NzY5Mg=="}, "originalCommit": {"oid": "a1a921579604dee3a3dd302c7bbe5f69feb51e0d"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ffe728ab5e48454e6aa7b015cfdf724dee337cf", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/0ffe728ab5e48454e6aa7b015cfdf724dee337cf", "committedDate": "2020-09-28T19:26:36Z", "message": "Review issues, add readiness check\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjAzNjY5", "url": "https://github.com/oracle/helidon/pull/2352#pullrequestreview-499603669", "createdAt": "2020-09-30T16:20:23Z", "commit": {"oid": "0ffe728ab5e48454e6aa7b015cfdf724dee337cf"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjoyMDoyM1rOHaldkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjoyMDoyM1rOHaldkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzYzODgwMw==", "bodyText": "This is leaking internal state - this method may just return a boolean", "url": "https://github.com/oracle/helidon/pull/2352#discussion_r497638803", "createdAt": "2020-09-30T16:20:23Z", "author": {"login": "tomas-langer"}, "path": "microprofile/messaging/core/src/main/java/io/helidon/microprofile/messaging/UniversalChannel.java", "diffHunk": "@@ -69,8 +70,12 @@ void setOutgoing(OutgoingMethod outgoingMethod) {\n         this.outgoingMethod = outgoingMethod;\n     }\n \n-    AtomicBoolean isUp() {\n-        return up;\n+    AtomicBoolean isLive() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ffe728ab5e48454e6aa7b015cfdf724dee337cf"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 448, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}