{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwOTg3NDc4", "number": 1624, "title": "Changed the default context root for Websocket endpoints", "bodyText": "Changed the default context root for Websocket endpoints to be \"/\", just like for REST. Improved testing of endpoints with and without using the default context root. One additional test that mixes REST resources and Websocket endpoints in same application.", "createdAt": "2020-04-08T17:42:08Z", "url": "https://github.com/oracle/helidon/pull/1624", "merged": true, "mergeCommit": {"oid": "d138a896518240d0555762ed8f23016cc4bca498"}, "closed": true, "closedAt": "2020-04-09T13:36:02Z", "author": {"login": "spericas"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVrgUxgH2gAyNDAwOTg3NDc4OjNlN2ZjZDIyMzk5NzIxODAxMzBmMmU3OGM4ODc3MzJmY2M5OTdjZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVuB9gAFqTM5MDMxMjE3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3e7fcd2239972180130f2e78c887732fcc997cd7", "author": {"user": {"login": "spericas", "name": "Santiago Pericasgeertsen"}}, "url": "https://github.com/oracle/helidon/commit/3e7fcd2239972180130f2e78c887732fcc997cd7", "committedDate": "2020-04-08T17:39:43Z", "message": "Changed the default context root for Websocket endpoints to be \"/\", just like for REST. Improved testing of endpoints with and without using the default context root. One additional test that mixes REST resources and Websocket endpoints in same application."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMjA4OTgz", "url": "https://github.com/oracle/helidon/pull/1624#pullrequestreview-390208983", "createdAt": "2020-04-08T18:04:31Z", "commit": {"oid": "3e7fcd2239972180130f2e78c887732fcc997cd7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxODowNDozMVrOGC6z7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxODowNDozMVrOGC6z7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcxMzkwMA==", "bodyText": "I know there have been discussions about avoiding fixed ports because of conflicts on shared systems or parallel tests. Is this opening us up to that problem?", "url": "https://github.com/oracle/helidon/pull/1624#discussion_r405713900", "createdAt": "2020-04-08T18:04:31Z", "author": {"login": "tjquinno"}, "path": "microprofile/websocket/src/test/java/io/helidon/microprofile/tyrus/WebSocketBaseTest.java", "diffHunk": "@@ -26,71 +30,33 @@\n import javax.websocket.OnMessage;\n import javax.websocket.OnOpen;\n import javax.websocket.Session;\n-import javax.websocket.server.ServerApplicationConfig;\n import javax.websocket.server.ServerEndpoint;\n-import javax.websocket.server.ServerEndpointConfig;\n-\n-import java.io.IOException;\n-import java.net.URI;\n-import java.util.Collections;\n-import java.util.Set;\n-import java.util.logging.Logger;\n \n-import io.helidon.microprofile.server.RoutingPath;\n-import io.helidon.microprofile.server.Server;\n import org.junit.jupiter.api.AfterAll;\n-import org.junit.jupiter.api.BeforeAll;\n import org.junit.jupiter.api.Test;\n \n /**\n- * Class WebSocketAppTest.\n+ * Class WebSocketBaseTest.\n  */\n-public class WebSocketAppTest {\n-\n-    private static Server server;\n+public abstract class WebSocketBaseTest {\n \n-    @BeforeAll\n-    static void initClass() {\n-        Server.Builder builder = Server.builder();\n-        server = builder.build();\n-        server.start();\n-    }\n+    static final int DEFAULT_PORT = 7001;\n+    static SeContainer container;\n \n     @AfterAll\n     static void destroyClass() {\n-        server.stop();\n+        container.close();\n     }\n \n-    @Test\n-    public void testEchoAnnot() throws Exception {\n-        URI echoUri = URI.create(\"ws://localhost:\" + server.port() + \"/web/echoAnnot\");\n-        EchoClient echoClient = new EchoClient(echoUri);\n-        echoClient.echo(\"hi\", \"how are you?\");\n-    }\n+    public abstract String context();\n \n     @Test\n-    public void testEchoProg() throws Exception {\n-        URI echoUri = URI.create(\"ws://localhost:\" + server.port() + \"/web/echoProg\");\n+    public void testEchoAnnot() throws Exception {\n+        URI echoUri = URI.create(\"ws://localhost:\" + DEFAULT_PORT + context() + \"/echoAnnot\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e7fcd2239972180130f2e78c887732fcc997cd7"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMjIyOTk1", "url": "https://github.com/oracle/helidon/pull/1624#pullrequestreview-390222995", "createdAt": "2020-04-08T18:24:18Z", "commit": {"oid": "3e7fcd2239972180130f2e78c887732fcc997cd7"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b7eaf402aa3d33a02c0a66f16eea4810dfa91ca", "author": {"user": {"login": "spericas", "name": "Santiago Pericasgeertsen"}}, "url": "https://github.com/oracle/helidon/commit/4b7eaf402aa3d33a02c0a66f16eea4810dfa91ca", "committedDate": "2020-04-08T18:25:04Z", "message": "Updated class comment.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36bfafce99814c5a854aa4dc2c03e52d7f928daf", "author": {"user": {"login": "spericas", "name": "Santiago Pericasgeertsen"}}, "url": "https://github.com/oracle/helidon/commit/36bfafce99814c5a854aa4dc2c03e52d7f928daf", "committedDate": "2020-04-08T18:49:59Z", "message": "Get server port via the CDI extension to avoid hardcoding the default port."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMjQ4ODk2", "url": "https://github.com/oracle/helidon/pull/1624#pullrequestreview-390248896", "createdAt": "2020-04-08T19:00:29Z", "commit": {"oid": "36bfafce99814c5a854aa4dc2c03e52d7f928daf"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e848f5a5ea0d6f21bae05f4b37caf15e7e168594", "author": {"user": {"login": "spericas", "name": "Santiago Pericasgeertsen"}}, "url": "https://github.com/oracle/helidon/commit/e848f5a5ea0d6f21bae05f4b37caf15e7e168594", "committedDate": "2020-04-08T20:05:03Z", "message": "Updated Websocket example after changes to context root.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMzEyMTcw", "url": "https://github.com/oracle/helidon/pull/1624#pullrequestreview-390312170", "createdAt": "2020-04-08T20:36:16Z", "commit": {"oid": "e848f5a5ea0d6f21bae05f4b37caf15e7e168594"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 702, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}