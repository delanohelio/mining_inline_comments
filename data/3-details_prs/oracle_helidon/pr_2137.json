{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0OTcyOTE5", "number": 2137, "title": "Create cli-data for snapshot builds", "bodyText": "", "createdAt": "2020-07-06T19:57:54Z", "url": "https://github.com/oracle/helidon/pull/2137", "merged": true, "mergeCommit": {"oid": "5280d68b03ec3dfa6dd3c5c15ab9fb02fd460385"}, "closed": true, "closedAt": "2020-07-07T22:28:48Z", "author": {"login": "batsatt"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyWzanAH2gAyNDQ0OTcyOTE5OjIzMTUwODE4YzJhYmE2NWUwOTYzMWM1YWVlMTdmODQ5NjY1YjIxYmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcys3GRAFqTQ0NDI2ODcxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba", "author": {"user": {"login": "batsatt", "name": "Bryan Atsatt"}}, "url": "https://github.com/oracle/helidon/commit/23150818c2aba65e09631c5aee17f849665b21ba", "committedDate": "2020-07-06T19:56:22Z", "message": "Create cli-data for snapshot builds."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMzkwNDA1", "url": "https://github.com/oracle/helidon/pull/2137#pullrequestreview-443390405", "createdAt": "2020-07-06T20:36:46Z", "commit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMDozNjo0NlrOGtmRfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMDo1MTowMFrOGtmrxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ2NjE3NQ==", "bodyText": "This plugin version needs to be managed in the top level pom.", "url": "https://github.com/oracle/helidon/pull/2137#discussion_r450466175", "createdAt": "2020-07-06T20:36:46Z", "author": {"login": "romain-grecourt"}, "path": "archetypes/catalog/pom.xml", "diffHunk": "@@ -67,4 +67,95 @@\n             <optional>true</optional>\n         </dependency>\n     </dependencies>\n+\n+    <properties>\n+        <!-- support command-line overrides -->\n+        <build.tools.version>${version.plugin.helidon-build-tools}</build.tools.version>\n+    </properties>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>io.helidon.build-tools</groupId>\n+                <artifactId>helidon-stager-maven-plugin</artifactId>\n+                <version>${version.plugin.helidon-build-tools}</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>stage</goal>\n+                        </goals>\n+                        <configuration>\n+                            <directories>\n+                                <directory target=\"${project.build.directory}\">\n+                                    <archives>\n+                                        <archive target=\"cli-data/${project.version}/cli-data.zip\">\n+                                            <unpack-artifacts>\n+                                                <unpack-artifact groupId=\"io.helidon.archetypes\"\n+                                                                 artifactId=\"helidon-archetype-catalog\"\n+                                                                 version=\"${project.version}\"\n+                                                                 type=\"zip\"\n+                                                                 target=\".\"/>\n+                                            </unpack-artifacts>\n+                                            <templates>\n+                                                <template source=\"cli-metadata.properties.mustache\"\n+                                                          target=\"metadata.properties\">\n+                                                    <variables>\n+                                                        <variable name=\"buildtoolsVersion\"\n+                                                                  value=\"${build.tools.version}\"/>\n+                                                        <variable name=\"cliVersion\"\n+                                                                  value=\"${version.plugin.helidon-build-tools}\"/>\n+                                                    </variables>\n+                                                </template>\n+                                            </templates>\n+                                        </archive>\n+                                    </archives>\n+                                    <files>\n+                                        <file target=\"cli-data/latest\">${project.version}</file>\n+                                    </files>\n+                                </directory>\n+                            </directories>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <groupId>com.soebes.maven.plugins</groupId>\n+                <artifactId>echo-maven-plugin</artifactId>\n+                <version>0.4.0</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ2OTEyNw==", "bodyText": "There is nothing to do unless one wants to test the archetypes. Can you change the beginning of this sentence to provide some context ? E.g. You can test the archetypes locally with the Helidon CLI using the following arguments:\nAlso, the version is not always snapshot. E.g. if you build a tag.", "url": "https://github.com/oracle/helidon/pull/2137#discussion_r450469127", "createdAt": "2020-07-06T20:43:04Z", "author": {"login": "romain-grecourt"}, "path": "archetypes/catalog/pom.xml", "diffHunk": "@@ -67,4 +67,95 @@\n             <optional>true</optional>\n         </dependency>\n     </dependencies>\n+\n+    <properties>\n+        <!-- support command-line overrides -->\n+        <build.tools.version>${version.plugin.helidon-build-tools}</build.tools.version>\n+    </properties>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>io.helidon.build-tools</groupId>\n+                <artifactId>helidon-stager-maven-plugin</artifactId>\n+                <version>${version.plugin.helidon-build-tools}</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>stage</goal>\n+                        </goals>\n+                        <configuration>\n+                            <directories>\n+                                <directory target=\"${project.build.directory}\">\n+                                    <archives>\n+                                        <archive target=\"cli-data/${project.version}/cli-data.zip\">\n+                                            <unpack-artifacts>\n+                                                <unpack-artifact groupId=\"io.helidon.archetypes\"\n+                                                                 artifactId=\"helidon-archetype-catalog\"\n+                                                                 version=\"${project.version}\"\n+                                                                 type=\"zip\"\n+                                                                 target=\".\"/>\n+                                            </unpack-artifacts>\n+                                            <templates>\n+                                                <template source=\"cli-metadata.properties.mustache\"\n+                                                          target=\"metadata.properties\">\n+                                                    <variables>\n+                                                        <variable name=\"buildtoolsVersion\"\n+                                                                  value=\"${build.tools.version}\"/>\n+                                                        <variable name=\"cliVersion\"\n+                                                                  value=\"${version.plugin.helidon-build-tools}\"/>\n+                                                    </variables>\n+                                                </template>\n+                                            </templates>\n+                                        </archive>\n+                                    </archives>\n+                                    <files>\n+                                        <file target=\"cli-data/latest\">${project.version}</file>\n+                                    </files>\n+                                </directory>\n+                            </directories>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <groupId>com.soebes.maven.plugins</groupId>\n+                <artifactId>echo-maven-plugin</artifactId>\n+                <version>0.4.0</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>echo</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+                <configuration>\n+                    <echos>\n+                        <echo> |</echo>\n+                        <echo> |                      /')    </echo>\n+                        <echo> |               ////  /' )'   </echo>\n+                        <echo> |              @   \\/'  )'    </echo>\n+                        <echo> |  { note }   &lt; (  (_...)' </echo>\n+                        <echo> |               \\      )      </echo>\n+                        <echo> |                \\,,,,/       </echo>\n+                        <echo> |                 _|_         </echo>\n+                        <echo> |</echo>\n+                        <echo> |  You must add the following arguments to the CLI to use these snapshot archetypes:</echo>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ3MTYyNw==", "bodyText": "Can you use the same name of in helidon-site ? I.e. cli.maven.plugin.version\nI know we have build.tools.version in metadata.properties, but IMO this is too confusing to expose as property.\nE.g. The line below has ${version.plugin.helidon-build-tools}\nI would like to use cli.maven.plugin.version onwards and look at renaming the property inside metadata.properties (even if that means having code that support both properties to maintain backward compatibility).\nAlso this property needs to have a default value since this stager plugin execution is added by default.\nYou should define the property with a default value in the top level pom:\n<cli.maven.plugin.version>${version.plugin.helidon-build-tools}</cli.maven.plugin.version>", "url": "https://github.com/oracle/helidon/pull/2137#discussion_r450471627", "createdAt": "2020-07-06T20:48:11Z", "author": {"login": "romain-grecourt"}, "path": "archetypes/catalog/pom.xml", "diffHunk": "@@ -67,4 +67,95 @@\n             <optional>true</optional>\n         </dependency>\n     </dependencies>\n+\n+    <properties>\n+        <!-- support command-line overrides -->\n+        <build.tools.version>${version.plugin.helidon-build-tools}</build.tools.version>\n+    </properties>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>io.helidon.build-tools</groupId>\n+                <artifactId>helidon-stager-maven-plugin</artifactId>\n+                <version>${version.plugin.helidon-build-tools}</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>stage</goal>\n+                        </goals>\n+                        <configuration>\n+                            <directories>\n+                                <directory target=\"${project.build.directory}\">\n+                                    <archives>\n+                                        <archive target=\"cli-data/${project.version}/cli-data.zip\">\n+                                            <unpack-artifacts>\n+                                                <unpack-artifact groupId=\"io.helidon.archetypes\"\n+                                                                 artifactId=\"helidon-archetype-catalog\"\n+                                                                 version=\"${project.version}\"\n+                                                                 type=\"zip\"\n+                                                                 target=\".\"/>\n+                                            </unpack-artifacts>\n+                                            <templates>\n+                                                <template source=\"cli-metadata.properties.mustache\"\n+                                                          target=\"metadata.properties\">\n+                                                    <variables>\n+                                                        <variable name=\"buildtoolsVersion\"\n+                                                                  value=\"${build.tools.version}\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ3MjY3OA==", "bodyText": "This is a continuation of my previous comment.\nI think it would be more explicit using cli.maven.plugin.version as the property name:\nmvn clean install -Dcli.maven.plugin.version=2.0.3-SNAPSHOT", "url": "https://github.com/oracle/helidon/pull/2137#discussion_r450472678", "createdAt": "2020-07-06T20:50:26Z", "author": {"login": "romain-grecourt"}, "path": "archetypes/catalog/pom.xml", "diffHunk": "@@ -67,4 +67,95 @@\n             <optional>true</optional>\n         </dependency>\n     </dependencies>\n+\n+    <properties>\n+        <!-- support command-line overrides -->\n+        <build.tools.version>${version.plugin.helidon-build-tools}</build.tools.version>\n+    </properties>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>io.helidon.build-tools</groupId>\n+                <artifactId>helidon-stager-maven-plugin</artifactId>\n+                <version>${version.plugin.helidon-build-tools}</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>stage</goal>\n+                        </goals>\n+                        <configuration>\n+                            <directories>\n+                                <directory target=\"${project.build.directory}\">\n+                                    <archives>\n+                                        <archive target=\"cli-data/${project.version}/cli-data.zip\">\n+                                            <unpack-artifacts>\n+                                                <unpack-artifact groupId=\"io.helidon.archetypes\"\n+                                                                 artifactId=\"helidon-archetype-catalog\"\n+                                                                 version=\"${project.version}\"\n+                                                                 type=\"zip\"\n+                                                                 target=\".\"/>\n+                                            </unpack-artifacts>\n+                                            <templates>\n+                                                <template source=\"cli-metadata.properties.mustache\"\n+                                                          target=\"metadata.properties\">\n+                                                    <variables>\n+                                                        <variable name=\"buildtoolsVersion\"\n+                                                                  value=\"${build.tools.version}\"/>\n+                                                        <variable name=\"cliVersion\"\n+                                                                  value=\"${version.plugin.helidon-build-tools}\"/>\n+                                                    </variables>\n+                                                </template>\n+                                            </templates>\n+                                        </archive>\n+                                    </archives>\n+                                    <files>\n+                                        <file target=\"cli-data/latest\">${project.version}</file>\n+                                    </files>\n+                                </directory>\n+                            </directories>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <groupId>com.soebes.maven.plugins</groupId>\n+                <artifactId>echo-maven-plugin</artifactId>\n+                <version>0.4.0</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>echo</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+                <configuration>\n+                    <echos>\n+                        <echo> |</echo>\n+                        <echo> |                      /')    </echo>\n+                        <echo> |               ////  /' )'   </echo>\n+                        <echo> |              @   \\/'  )'    </echo>\n+                        <echo> |  { note }   &lt; (  (_...)' </echo>\n+                        <echo> |               \\      )      </echo>\n+                        <echo> |                \\,,,,/       </echo>\n+                        <echo> |                 _|_         </echo>\n+                        <echo> |</echo>\n+                        <echo> |  You must add the following arguments to the CLI to use these snapshot archetypes:</echo>\n+                        <echo> |</echo>\n+                        <echo> |     --reset --url file://${project.build.directory}/cli-data</echo>\n+                        <echo> |</echo>\n+                        <echo> |  For example:</echo>\n+                        <echo> |</echo>\n+                        <echo> |     helidon init --batch --reset --url file://${project.build.directory}/cli-data</echo>\n+                        <echo> |</echo>\n+                        <echo> |  To use a build tools snapshot, specify the version when building this project, e.g.:</echo>\n+                        <echo> |</echo>\n+                        <echo> |     mvn clean install -Dbuild.tools.version=2.0.3-SNAPSHOT</echo>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ3MjkwMA==", "bodyText": "Not really a comment, but what's the ascii art ?", "url": "https://github.com/oracle/helidon/pull/2137#discussion_r450472900", "createdAt": "2020-07-06T20:51:00Z", "author": {"login": "romain-grecourt"}, "path": "archetypes/catalog/pom.xml", "diffHunk": "@@ -67,4 +67,95 @@\n             <optional>true</optional>\n         </dependency>\n     </dependencies>\n+\n+    <properties>\n+        <!-- support command-line overrides -->\n+        <build.tools.version>${version.plugin.helidon-build-tools}</build.tools.version>\n+    </properties>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>io.helidon.build-tools</groupId>\n+                <artifactId>helidon-stager-maven-plugin</artifactId>\n+                <version>${version.plugin.helidon-build-tools}</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>stage</goal>\n+                        </goals>\n+                        <configuration>\n+                            <directories>\n+                                <directory target=\"${project.build.directory}\">\n+                                    <archives>\n+                                        <archive target=\"cli-data/${project.version}/cli-data.zip\">\n+                                            <unpack-artifacts>\n+                                                <unpack-artifact groupId=\"io.helidon.archetypes\"\n+                                                                 artifactId=\"helidon-archetype-catalog\"\n+                                                                 version=\"${project.version}\"\n+                                                                 type=\"zip\"\n+                                                                 target=\".\"/>\n+                                            </unpack-artifacts>\n+                                            <templates>\n+                                                <template source=\"cli-metadata.properties.mustache\"\n+                                                          target=\"metadata.properties\">\n+                                                    <variables>\n+                                                        <variable name=\"buildtoolsVersion\"\n+                                                                  value=\"${build.tools.version}\"/>\n+                                                        <variable name=\"cliVersion\"\n+                                                                  value=\"${version.plugin.helidon-build-tools}\"/>\n+                                                    </variables>\n+                                                </template>\n+                                            </templates>\n+                                        </archive>\n+                                    </archives>\n+                                    <files>\n+                                        <file target=\"cli-data/latest\">${project.version}</file>\n+                                    </files>\n+                                </directory>\n+                            </directories>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <groupId>com.soebes.maven.plugins</groupId>\n+                <artifactId>echo-maven-plugin</artifactId>\n+                <version>0.4.0</version>\n+                <executions>\n+                    <execution>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>echo</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+                <configuration>\n+                    <echos>\n+                        <echo> |</echo>\n+                        <echo> |                      /')    </echo>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23150818c2aba65e09631c5aee17f849665b21ba"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd1f591f5ad59d96e1aaeae5fd978fa009e5aec5", "author": {"user": {"login": "batsatt", "name": "Bryan Atsatt"}}, "url": "https://github.com/oracle/helidon/commit/dd1f591f5ad59d96e1aaeae5fd978fa009e5aec5", "committedDate": "2020-07-06T21:35:47Z", "message": "Cleanup."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e4af03278ca929b8792fb68b50472869c710ac7", "author": {"user": {"login": "batsatt", "name": "Bryan Atsatt"}}, "url": "https://github.com/oracle/helidon/commit/7e4af03278ca929b8792fb68b50472869c710ac7", "committedDate": "2020-07-07T16:37:19Z", "message": "Merge branch 'master' into snapshot-cli-data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea2982a582d93592f70aabc862cd30f8343fb25c", "author": {"user": {"login": "batsatt", "name": "Bryan Atsatt"}}, "url": "https://github.com/oracle/helidon/commit/ea2982a582d93592f70aabc862cd30f8343fb25c", "committedDate": "2020-07-07T18:07:43Z", "message": "Add plugins to pluginManagement."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6742c031533c9a55d88cc7780745c671e4dd48f2", "author": {"user": {"login": "batsatt", "name": "Bryan Atsatt"}}, "url": "https://github.com/oracle/helidon/commit/6742c031533c9a55d88cc7780745c671e4dd48f2", "committedDate": "2020-07-07T21:21:19Z", "message": "Tweak override property name."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MjY4NzEz", "url": "https://github.com/oracle/helidon/pull/2137#pullrequestreview-444268713", "createdAt": "2020-07-07T21:38:18Z", "commit": {"oid": "6742c031533c9a55d88cc7780745c671e4dd48f2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 506, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}