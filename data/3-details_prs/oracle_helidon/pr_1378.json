{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NTUwOTI0", "number": 1378, "title": "Adds a default send(Throwable) method to ServerResponse.java as the first step in providing an easy facility for reporting exceptions during HTTP processing", "bodyText": "This PR, when ready, will add the ability to conveniently send a Throwable during HTTP processing.\nSigned-off-by: Laird Nelson laird.nelson@oracle.com", "createdAt": "2020-02-12T21:43:16Z", "url": "https://github.com/oracle/helidon/pull/1378", "merged": true, "mergeCommit": {"oid": "25eb862246635c67831f78825f482471e0ab0843"}, "closed": true, "closedAt": "2020-02-18T16:39:07Z", "author": {"login": "ljnelson"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDtYiVgH2gAyMzc0NTUwOTI0OjJiY2RkZTU2Y2MzNDY4MDVlNzYzNWQyZmFlM2ExODllMTYxNTVmOWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFIzJygFqTM1OTU0NzE1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2bcdde56cc346805e7635d2fae3a189e16155f9b", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/2bcdde56cc346805e7635d2fae3a189e16155f9b", "committedDate": "2020-02-12T21:40:23Z", "message": "Adds a default send(Throwable) method to ServerResponse.java as the first step in providing an easy facility for reporting exceptions during HTTP processing.\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d2b36b5e745ad20aa38ecd87fafc749f0ce700c", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/8d2b36b5e745ad20aa38ecd87fafc749f0ce700c", "committedDate": "2020-02-12T21:50:02Z", "message": "Interim squashable commit; added Javadoc comment to satisfy checkstyle\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc876262aa94e05d68fded0cdc9654ae1fb28ff0", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/dc876262aa94e05d68fded0cdc9654ae1fb28ff0", "committedDate": "2020-02-12T23:11:11Z", "message": "Interim squashable commit; adds ThrowableBodyWriter.java\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a41844095c634bdc960a7df97339241ae176762", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/3a41844095c634bdc960a7df97339241ae176762", "committedDate": "2020-02-12T23:13:16Z", "message": "Interim squashable commit; adds another create() method in ThrowableBodyWriter.java\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7096ed998cfafa8cc189193a73e8c6370495556", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/d7096ed998cfafa8cc189193a73e8c6370495556", "committedDate": "2020-02-13T22:14:44Z", "message": "Interim squashable commit; incorporated discussion outcome with Romain\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NjA5MjA0", "url": "https://github.com/oracle/helidon/pull/1378#pullrequestreview-358609204", "createdAt": "2020-02-13T22:51:25Z", "commit": {"oid": "d7096ed998cfafa8cc189193a73e8c6370495556"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMjo1MToyNlrOFpmVlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMjo1Njo1MVrOFpmdIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE2NDA1Mw==", "bodyText": "Function<T, Publisher<DataChunk> is the old style of writer that is deprecated, we don't need that.", "url": "https://github.com/oracle/helidon/pull/1378#discussion_r379164053", "createdAt": "2020-02-13T22:51:26Z", "author": {"login": "romain-grecourt"}, "path": "media/common/src/main/java/io/helidon/media/common/ContentWriters.java", "diffHunk": "@@ -147,4 +187,18 @@ private ContentWriters() {\n     public static Function<ReadableByteChannel, Publisher<DataChunk>> byteChannelWriter() {\n         return byteChannelWriter(null);\n     }\n+\n+    /**\n+     * Returns a writer function for a {@link Throwable}'s stack trace.\n+     *\n+     * @param context a {@link MessageBodyWriterContext}\n+     * @param setContentLength whether {@link MessageBodyWriterContext#contentLength(long)} should be called\n+     * @return a {@link Throwable} writer\n+     * @see #writeStackTrace(Throwable, MessageBodyWriterContext, boolean)\n+     */\n+    public static Function<Throwable, Publisher<DataChunk>> stackTraceWriter(MessageBodyWriterContext context,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7096ed998cfafa8cc189193a73e8c6370495556"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE2NTMxMA==", "bodyText": "With the addition the context as parameter, this methods differs from all the other ones in ContentWriters.\nLets not over do it and stick with just ThrowableBodyWriter.", "url": "https://github.com/oracle/helidon/pull/1378#discussion_r379165310", "createdAt": "2020-02-13T22:54:57Z", "author": {"login": "romain-grecourt"}, "path": "media/common/src/main/java/io/helidon/media/common/ContentWriters.java", "diffHunk": "@@ -81,6 +83,44 @@ private ContentWriters() {\n         return Single.just(DataChunk.create(false, buffer.encode(charset)));\n     }\n \n+    /**\n+     * Create a a publisher {@link DataChunk} with the given\n+     * {@link Throwable} / {@link Charset} and return a {@link Single}.\n+     *\n+     * @param throwable the {@link Throwable}\n+     * @param context a {@link MessageBodyWriterContext}\n+     * @param setContentLength whether {@link MessageBodyWriterContext#contentLength(long)} should be called\n+     * @return Single\n+     */\n+    public static Single<DataChunk> writeStackTrace(Throwable throwable,\n+                                                    MessageBodyWriterContext context,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7096ed998cfafa8cc189193a73e8c6370495556"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE2NTk4NQ==", "bodyText": "Lets not use a default method here.\nThe API and implementation come together, so there isn't much benefit to having a default method implementation right ?", "url": "https://github.com/oracle/helidon/pull/1378#discussion_r379165985", "createdAt": "2020-02-13T22:56:51Z", "author": {"login": "romain-grecourt"}, "path": "webserver/webserver/src/main/java/io/helidon/webserver/ServerResponse.java", "diffHunk": "@@ -100,6 +100,27 @@ default ServerResponse status(int statusCode) throws AlreadyCompletedException {\n      */\n     MessageBodyWriterContext writerContext();\n \n+    /**\n+     * Send a {@link Throwable} and close the response.\n+     *\n+     * @param content the {@link Throwable} to send\n+     * @return {@code null} when invoked\n+     * @throws IllegalArgumentException if there is no registered writer for a given type\n+     * @throws IllegalStateException if any {@code send(...)} method was already called\n+     * @see #send(Object)\n+     */\n+    default Void send(Throwable content) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7096ed998cfafa8cc189193a73e8c6370495556"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "199f84c896785a382fce7cebd040ef388ea25109", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/199f84c896785a382fce7cebd040ef388ea25109", "committedDate": "2020-02-13T23:06:35Z", "message": "Interim squashable commit; moved send(Throwable) to Response.java per discussion\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c079f8cca7a50a8137f26474c0183b9d9827e2a4", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/c079f8cca7a50a8137f26474c0183b9d9827e2a4", "committedDate": "2020-02-13T23:08:37Z", "message": "Interim squashable commit; removed apparently deprecated style of writer-furnishing method in ContentWriters.java per discussion\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27566c861698e2807766d65e2570bb1216b99e57", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/27566c861698e2807766d65e2570bb1216b99e57", "committedDate": "2020-02-13T23:19:22Z", "message": "Interim squashable commit; removed content length concerns from writeStackTrace method in ContentWriters.java per discussion\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6682c2a80c9b949de5c2a848e3116cfbba1e26c", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/b6682c2a80c9b949de5c2a848e3116cfbba1e26c", "committedDate": "2020-02-13T23:21:36Z", "message": "Interim squashable commit; fixing style\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "070053ececf06f1b5576b25cf7760b5b21f52fa2", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/070053ececf06f1b5576b25cf7760b5b21f52fa2", "committedDate": "2020-02-13T23:24:41Z", "message": "Interim squashable commit; removed null check in ThrowableBodyWriter per direction\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3136982a6268195c2b7e30adf5cd62ca5a0745b6", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/3136982a6268195c2b7e30adf5cd62ca5a0745b6", "committedDate": "2020-02-13T23:30:45Z", "message": "Interim squashable commit; moved media type assignment out of the mapper and into the write method per instruction\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "908308af5d219422a0d16951fab365f16fe2e7f7", "author": {"user": {"login": "ljnelson", "name": "Laird Nelson"}}, "url": "https://github.com/oracle/helidon/commit/908308af5d219422a0d16951fab365f16fe2e7f7", "committedDate": "2020-02-13T23:43:40Z", "message": "Interim squashable commit; removed another super() call\n\nSigned-off-by: Laird Nelson <laird.nelson@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4ODE4MTIy", "url": "https://github.com/oracle/helidon/pull/1378#pullrequestreview-358818122", "createdAt": "2020-02-14T09:42:52Z", "commit": {"oid": "908308af5d219422a0d16951fab365f16fe2e7f7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MjI3MDkx", "url": "https://github.com/oracle/helidon/pull/1378#pullrequestreview-359227091", "createdAt": "2020-02-14T21:24:14Z", "commit": {"oid": "908308af5d219422a0d16951fab365f16fe2e7f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NTQ3MTUz", "url": "https://github.com/oracle/helidon/pull/1378#pullrequestreview-359547153", "createdAt": "2020-02-17T08:10:49Z", "commit": {"oid": "908308af5d219422a0d16951fab365f16fe2e7f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 807, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}