{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NzIxODA3", "number": 1809, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1NzoyN1rOD89wCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1ODoyOVrOD89xXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MjUyODc0OnYy", "diffSide": "RIGHT", "path": "health/health/src/main/java/io/helidon/health/HealthSupport.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1NzoyN1rOGWOl-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxODoxMDowMVrOGWO-Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MDk1NQ==", "bodyText": "Just double-checking.  Repeatable semantics here are OK?", "url": "https://github.com/oracle/helidon/pull/1809#discussion_r425960955", "createdAt": "2020-05-15T17:57:27Z", "author": {"login": "ljnelson"}, "path": "health/health/src/main/java/io/helidon/health/HealthSupport.java", "diffHunk": "@@ -260,9 +259,9 @@ public static HealthSupport create(Config config) {\n      * Fluent API builder for {@link io.helidon.health.HealthSupport}.\n      */\n     public static final class Builder implements io.helidon.common.Builder<HealthSupport> {\n-        private final Set<HealthCheck> allChecks = new LinkedHashSet<>();\n-        private final Set<HealthCheck> livenessChecks = new LinkedHashSet<>();\n-        private final Set<HealthCheck> readinessChecks = new LinkedHashSet<>();\n+        private final List<HealthCheck> allChecks = new LinkedList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10438b99f6a4dd7c19054a731e3d3618114205c1"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2NTk1Nw==", "bodyText": "It would be called twice. There was a problem that some of our health checks just disappeared (we ended up with 2 out of 6 in a test). Some quirk most likely caused by Weld proxies and their equals/hashCode methods.", "url": "https://github.com/oracle/helidon/pull/1809#discussion_r425965957", "createdAt": "2020-05-15T18:07:32Z", "author": {"login": "tomas-langer"}, "path": "health/health/src/main/java/io/helidon/health/HealthSupport.java", "diffHunk": "@@ -260,9 +259,9 @@ public static HealthSupport create(Config config) {\n      * Fluent API builder for {@link io.helidon.health.HealthSupport}.\n      */\n     public static final class Builder implements io.helidon.common.Builder<HealthSupport> {\n-        private final Set<HealthCheck> allChecks = new LinkedHashSet<>();\n-        private final Set<HealthCheck> livenessChecks = new LinkedHashSet<>();\n-        private final Set<HealthCheck> readinessChecks = new LinkedHashSet<>();\n+        private final List<HealthCheck> allChecks = new LinkedList<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MDk1NQ=="}, "originalCommit": {"oid": "10438b99f6a4dd7c19054a731e3d3618114205c1"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2NzEyNw==", "bodyText": "I did consider using an identity set to at least prevent the same instances. Yet in MP, we register this from selected beans (so it should be unique), and in SE the user registers checks by hand (so they have full control).", "url": "https://github.com/oracle/helidon/pull/1809#discussion_r425967127", "createdAt": "2020-05-15T18:10:01Z", "author": {"login": "tomas-langer"}, "path": "health/health/src/main/java/io/helidon/health/HealthSupport.java", "diffHunk": "@@ -260,9 +259,9 @@ public static HealthSupport create(Config config) {\n      * Fluent API builder for {@link io.helidon.health.HealthSupport}.\n      */\n     public static final class Builder implements io.helidon.common.Builder<HealthSupport> {\n-        private final Set<HealthCheck> allChecks = new LinkedHashSet<>();\n-        private final Set<HealthCheck> livenessChecks = new LinkedHashSet<>();\n-        private final Set<HealthCheck> readinessChecks = new LinkedHashSet<>();\n+        private final List<HealthCheck> allChecks = new LinkedList<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MDk1NQ=="}, "originalCommit": {"oid": "10438b99f6a4dd7c19054a731e3d3618114205c1"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MjUzMjE0OnYy", "diffSide": "RIGHT", "path": "tests/integration/native-image/mp-1/src/main/java/io/helidon/tests/integration/nativeimage/mp1/Mp1Main.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1ODoyOVrOGWOoJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxODowODo0OVrOGWO77Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MTUxMA==", "bodyText": "typo", "url": "https://github.com/oracle/helidon/pull/1809#discussion_r425961510", "createdAt": "2020-05-15T17:58:29Z", "author": {"login": "ljnelson"}, "path": "tests/integration/native-image/mp-1/src/main/java/io/helidon/tests/integration/nativeimage/mp1/Mp1Main.java", "diffHunk": "@@ -427,8 +429,13 @@ private static void validateHealth(Errors.Collector collector, WebTarget target)\n                 .get(JsonObject.class);\n \n         JsonArray checks = health.getJsonArray(\"checks\");\n-        if (checks.size() < 1) {\n-            collector.fatal(\"There should be at least one readiness healtcheck provided by this app\");\n+        if (checks.size() != 1) {\n+            collector.fatal(\"There should be a readiness healtcheck provided by this app\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10438b99f6a4dd7c19054a731e3d3618114205c1"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2NjU3Mw==", "bodyText": "Fixed.", "url": "https://github.com/oracle/helidon/pull/1809#discussion_r425966573", "createdAt": "2020-05-15T18:08:49Z", "author": {"login": "tomas-langer"}, "path": "tests/integration/native-image/mp-1/src/main/java/io/helidon/tests/integration/nativeimage/mp1/Mp1Main.java", "diffHunk": "@@ -427,8 +429,13 @@ private static void validateHealth(Errors.Collector collector, WebTarget target)\n                 .get(JsonObject.class);\n \n         JsonArray checks = health.getJsonArray(\"checks\");\n-        if (checks.size() < 1) {\n-            collector.fatal(\"There should be at least one readiness healtcheck provided by this app\");\n+        if (checks.size() != 1) {\n+            collector.fatal(\"There should be a readiness healtcheck provided by this app\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MTUxMA=="}, "originalCommit": {"oid": "10438b99f6a4dd7c19054a731e3d3618114205c1"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 559, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}