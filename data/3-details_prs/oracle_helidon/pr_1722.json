{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMDQyNDcw", "number": 1722, "title": "Enable reflection init of NioSocketChannel with native image", "bodyText": "To avoid error with native image:\nCaused by: java.lang.IllegalArgumentException: Class NioSocketChannel does not have a public non-arg constructor\n\tat io.netty.channel.ReflectiveChannelFactory.<init>(ReflectiveChannelFactory.java:36)\n\tat io.netty.bootstrap.AbstractBootstrap.channel(AbstractBootstrap.java:104)\n\tat io.helidon.webclient.WebClientRequestBuilderImpl.lambda$invoke$7(WebClientRequestBuilderImpl.java:417)\n\tat java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1106)\n\tat java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2235)\n\tat java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:143)\n\tat io.helidon.webclient.WebClientRequestBuilderImpl.invoke(WebClientRequestBuilderImpl.java:395)\n\tat io.helidon.webclient.WebClientRequestBuilderImpl.lambda$submit$4(WebClientRequestBuilderImpl.java:318)\n\tat io.helidon.common.context.Contexts.runInContext(Contexts.java:118)\n\tat io.helidon.webclient.WebClientRequestBuilderImpl.submit(WebClientRequestBuilderImpl.java:318)\n\tat io.helidon.webclient.WebClientRequestBuilderImpl.submit(WebClientRequestBuilderImpl.java:328)\n\tat io.helidon.examples.webclient.standalone.ClientMain.performPutMethod(ClientMain.java:120)\n\tat io.helidon.examples.webclient.standalone.ClientMain.main(ClientMain.java:105)\n\t... 39 more\nCaused by: java.lang.NoSuchMethodException: io.netty.channel.socket.nio.NioSocketChannel.<init>()\n\tat java.lang.Class.getConstructor0(DynamicHub.java:3349)\n\tat java.lang.Class.getConstructor(DynamicHub.java:2151)\n\tat io.netty.channel.ReflectiveChannelFactory.<init>(ReflectiveChannelFactory.java:34)\n\t... 51 more\nTested in https://github.com/danielkec/helidon/tree/native-webclient-test\nhelidon/examples/webclient/standalone$ mvn clean package -DskipTests -Pnative-image\nhelidon/examples/webclient/standalone$ sudo ./target/helidon-examples-webclient-standalone \nThen call GET at: WEB server is up! http://localhost:41549/greet/test\n\u26a0\ufe0f sudo is needed because native image is using different tmp folder, see oracle/graal/issues/1754:\nPath tempPath = Files.createTempFile(\"helidon-large\", \".tmp\");\nSystem.out.println(\"TEMP FILE>\"+tempPath.toAbsolutePath().toString());\n// ---- java -jar ---- \nTEMP FILE>/tmp/helidon-large7670469747246904903.tmp\n// ---- native image ----\nTEMP FILE>/var/tmp/helidon-large7964339000716791151.tmp\nSigned-off-by: Daniel Kec daniel.kec@oracle.com", "createdAt": "2020-05-04T16:05:08Z", "url": "https://github.com/oracle/helidon/pull/1722", "merged": true, "mergeCommit": {"oid": "d93910edca35da097cf76e4fd68141a38d3a68a1"}, "closed": true, "closedAt": "2020-05-05T16:02:23Z", "author": {"login": "danielkec"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceBdhvAH2gAyNDEzMDQyNDcwOjgwMzMzNGNlNTVmMTMzYWI4NzI4YTY5NGUzY2UyMjk0MzM5MmI5ZjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceT1IBAFqTQwNTc3MDQwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "803334ce55f133ab8728a694e3ce22943392b9f5", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/803334ce55f133ab8728a694e3ce22943392b9f5", "committedDate": "2020-05-04T15:45:58Z", "message": "Enable reflection init of NioSocketChannel with native image\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1Mjg5MTAz", "url": "https://github.com/oracle/helidon/pull/1722#pullrequestreview-405289103", "createdAt": "2020-05-04T19:38:44Z", "commit": {"oid": "803334ce55f133ab8728a694e3ce22943392b9f5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxOTozODo0NFrOGQPQpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxOTozOTozM1rOGQPSeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY4MDQyMw==", "bodyText": "This file is not needed.", "url": "https://github.com/oracle/helidon/pull/1722#discussion_r419680423", "createdAt": "2020-05-04T19:38:44Z", "author": {"login": "tomas-langer"}, "path": "webclient/webclient/src/main/resources/META-INF/native-image/native-image.properties", "diffHunk": "@@ -0,0 +1,20 @@\n+#", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "803334ce55f133ab8728a694e3ce22943392b9f5"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY4MDg5MA==", "bodyText": "Rename to reflec-config.json and it would be picked up automatically.\nAlso move this file to\nMETA-INF/native-image/io.helidon.webclient/helidon-webclient - that is the recommended location (groupId/artifactId)", "url": "https://github.com/oracle/helidon/pull/1722#discussion_r419680890", "createdAt": "2020-05-04T19:39:33Z", "author": {"login": "tomas-langer"}, "path": "webclient/webclient/src/main/resources/META-INF/native-image/reflection-config.json", "diffHunk": "@@ -0,0 +1,8 @@\n+[", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "803334ce55f133ab8728a694e3ce22943392b9f5"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ea74ac1ab6c22585a01fa8cedc05be274866d86", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/9ea74ac1ab6c22585a01fa8cedc05be274866d86", "committedDate": "2020-05-04T20:46:30Z", "message": "Review issues\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b1a56cf6d332777fc051bb5ecfd6a1044f51ada", "author": {"user": {"login": "danielkec", "name": "Daniel Kec"}}, "url": "https://github.com/oracle/helidon/commit/5b1a56cf6d332777fc051bb5ecfd6a1044f51ada", "committedDate": "2020-05-04T20:49:39Z", "message": "Review issues\n\nSigned-off-by: Daniel Kec <daniel.kec@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NzcwNDAw", "url": "https://github.com/oracle/helidon/pull/1722#pullrequestreview-405770400", "createdAt": "2020-05-05T13:10:02Z", "commit": {"oid": "5b1a56cf6d332777fc051bb5ecfd6a1044f51ada"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 750, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}