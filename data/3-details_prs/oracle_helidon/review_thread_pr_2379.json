{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNDg1NjQ3", "number": 2379, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NDoxNFrOEmtsGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo0Mjo0M1rOEnDNCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDI5OTE1OnYy", "diffSide": "RIGHT", "path": "tests/functional/mp-compression/src/main/java/io/helidon/tests/functional/mpcompression/Main.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NDoxNFrOHW6A6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NDoxNFrOHW6A6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4MTIyNg==", "bodyText": "Main class/method is no longer needed for MP.\nYou can start the application using io.helidon.microprofile.cdi.Main", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r493781226", "createdAt": "2020-09-23T17:54:14Z", "author": {"login": "tomas-langer"}, "path": "tests/functional/mp-compression/src/main/java/io/helidon/tests/functional/mpcompression/Main.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08fb8035198b7939e3c2ea4fd3e293c7d276e6e7"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDMwODk2OnYy", "diffSide": "RIGHT", "path": "tests/functional/mp-compression/src/test/java/io/helidon/tests/functional/mpcompression/MpCompressionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1Njo0MFrOHW6HHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NzozNVrOHW6Jeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4MjgxNQ==", "bodyText": "Please switch to @HelidonTest\n\nyou can inject WebTarget that will be configured to the port (that will be random) of the server\nthe test would automatically start and stop the CDI in the background for you\n\nDeclaration of fields:\n@Inject\nprivate WebTarget baseTarget;", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r493782815", "createdAt": "2020-09-23T17:56:40Z", "author": {"login": "tomas-langer"}, "path": "tests/functional/mp-compression/src/test/java/io/helidon/tests/functional/mpcompression/MpCompressionTest.java", "diffHunk": "@@ -0,0 +1,73 @@\n+/*\n+ * Copyright (c) 2020 Oracle and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.helidon.tests.functional.mpcompression;\n+\n+import java.io.IOException;\n+import java.util.logging.LogManager;\n+\n+import javax.ws.rs.client.Client;\n+import javax.ws.rs.client.ClientBuilder;\n+import javax.ws.rs.client.WebTarget;\n+import javax.ws.rs.core.Response;\n+\n+import io.helidon.microprofile.server.Server;\n+\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.is;\n+import static org.hamcrest.MatcherAssert.assertThat;\n+\n+class MpCompressionTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08fb8035198b7939e3c2ea4fd3e293c7d276e6e7"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4MzQxOA==", "bodyText": "logging.properties is also automatically loaded by Helidon MP, so no need to add it manually", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r493783418", "createdAt": "2020-09-23T17:57:35Z", "author": {"login": "tomas-langer"}, "path": "tests/functional/mp-compression/src/test/java/io/helidon/tests/functional/mpcompression/MpCompressionTest.java", "diffHunk": "@@ -0,0 +1,73 @@\n+/*\n+ * Copyright (c) 2020 Oracle and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.helidon.tests.functional.mpcompression;\n+\n+import java.io.IOException;\n+import java.util.logging.LogManager;\n+\n+import javax.ws.rs.client.Client;\n+import javax.ws.rs.client.ClientBuilder;\n+import javax.ws.rs.client.WebTarget;\n+import javax.ws.rs.core.Response;\n+\n+import io.helidon.microprofile.server.Server;\n+\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.is;\n+import static org.hamcrest.MatcherAssert.assertThat;\n+\n+class MpCompressionTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4MjgxNQ=="}, "originalCommit": {"oid": "08fb8035198b7939e3c2ea4fd3e293c7d276e6e7"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDMxMDgyOnYy", "diffSide": "RIGHT", "path": "tests/functional/mp-compression/src/main/resources/META-INF/microprofile-config.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NzowOFrOHW6ISw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NzowOFrOHW6ISw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4MzExNQ==", "bodyText": "Unless you expect people to start this server as an example, server.port is not needed here", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r493783115", "createdAt": "2020-09-23T17:57:08Z", "author": {"login": "tomas-langer"}, "path": "tests/functional/mp-compression/src/main/resources/META-INF/microprofile-config.properties", "diffHunk": "@@ -0,0 +1,19 @@\n+#\n+# Copyright (c) 2020 Oracle and/or its affiliates. All rights reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+\n+server.port=7001", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08fb8035198b7939e3c2ea4fd3e293c7d276e6e7"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDMxODQ1OnYy", "diffSide": "RIGHT", "path": "webserver/jersey/src/test/java/io/helidon/webserver/jersey/JerseySupportTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1ODo0OFrOHW6Myw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1ODo0OFrOHW6Myw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4NDI2Nw==", "bodyText": "Please change such statements to use Hamcrest assertion.\nThis should be assertThat(new String(...), is(\"{...\") - that is the common approach we have accros Helidon tests", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r493784267", "createdAt": "2020-09-23T17:58:48Z", "author": {"login": "tomas-langer"}, "path": "webserver/jersey/src/test/java/io/helidon/webserver/jersey/JerseySupportTest.java", "diffHunk": "@@ -311,8 +311,8 @@ public void streamingOutput() throws IOException {\n         try (InputStream is = response.readEntity(InputStream.class)) {\n             byte[] buffer = new byte[32];\n             int n = is.read(buffer);        // should read only first chunk\n-            assertEquals(new String(buffer, 0, n), \"{ value: \\\"first\\\" }\\n\");\n-            while ((n = is.read(buffer)) > 0) {\n+            assertEquals(\"{ value: \\\"first\\\" }\\n\", new String(buffer, 0, n));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08fb8035198b7939e3c2ea4fd3e293c7d276e6e7"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDMyNDEyOnYy", "diffSide": "RIGHT", "path": "webserver/webserver/src/main/java/io/helidon/webserver/WebServer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxODowMDoxOFrOHW6QXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxODowMDoxOFrOHW6QXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4NTE4MQ==", "bodyText": "This should maybe say \"for default socket\", as this is socket specific, if I understood this PR correctly", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r493785181", "createdAt": "2020-09-23T18:00:18Z", "author": {"login": "tomas-langer"}, "path": "webserver/webserver/src/main/java/io/helidon/webserver/WebServer.java", "diffHunk": "@@ -751,6 +751,17 @@ public Builder workersCount(int workers) {\n             return this;\n         }\n \n+        /**\n+         * Configure whether to enable content negotiation for compression.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08fb8035198b7939e3c2ea4fd3e293c7d276e6e7"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MzgyNDEwOnYy", "diffSide": "RIGHT", "path": "webserver/webserver/src/main/java/io/helidon/webserver/WebServer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo0Mjo0M1rOHXbVcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo0Mjo0M1rOHXbVcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMyNzE1Mw==", "bodyText": "This method should be annotated with @Override and the javadoc is not necessary. If the javadoc is there, please add \"negotiation for compression for the default socket\"", "url": "https://github.com/oracle/helidon/pull/2379#discussion_r494327153", "createdAt": "2020-09-24T13:42:43Z", "author": {"login": "tomas-langer"}, "path": "webserver/webserver/src/main/java/io/helidon/webserver/WebServer.java", "diffHunk": "@@ -751,6 +751,17 @@ public Builder workersCount(int workers) {\n             return this;\n         }\n \n+        /**\n+         * Configure whether to enable content negotiation for compression.\n+         *\n+         * @param value compression flag\n+         * @return updated builder instance\n+         */\n+        public Builder enableCompression(boolean value) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "524d634ccea6388bfde67de9aa21cc28ab0c2fe6"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 420, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}