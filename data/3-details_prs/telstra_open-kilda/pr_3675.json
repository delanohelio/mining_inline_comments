{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMzgxNjcw", "number": 3675, "title": "Add check for the allocated paths to ensure that all ISLs are active on those paths", "bodyText": "Closes: #3665", "createdAt": "2020-08-05T13:24:12Z", "url": "https://github.com/telstra/open-kilda/pull/3675", "merged": true, "mergeCommit": {"oid": "5d408b6b60c3c112a972d6fc7eded1cb72f5585b"}, "closed": true, "closedAt": "2020-08-12T14:00:32Z", "author": {"login": "dpoltavets"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc774y_gFqTQ2MTcwNTg3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9yQUAAFqTQ2NDg0MDI1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNzA1ODc4", "url": "https://github.com/telstra/open-kilda/pull/3675#pullrequestreview-461705878", "createdAt": "2020-08-05T14:14:03Z", "commit": {"oid": "16fa8338226c1c7fd59f26261adfa00f67fb6cd4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16fa8338226c1c7fd59f26261adfa00f67fb6cd4", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/16fa8338226c1c7fd59f26261adfa00f67fb6cd4", "committedDate": "2020-08-05T13:21:06Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}, "afterCommit": {"oid": "876d29d8518846dc5c71d7d9d96cfad5021af237", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/876d29d8518846dc5c71d7d9d96cfad5021af237", "committedDate": "2020-08-06T12:52:39Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNDkxNjMx", "url": "https://github.com/telstra/open-kilda/pull/3675#pullrequestreview-462491631", "createdAt": "2020-08-06T12:57:43Z", "commit": {"oid": "876d29d8518846dc5c71d7d9d96cfad5021af237"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMDc0OTQ5", "url": "https://github.com/telstra/open-kilda/pull/3675#pullrequestreview-463074949", "createdAt": "2020-08-07T06:53:26Z", "commit": {"oid": "876d29d8518846dc5c71d7d9d96cfad5021af237"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNjo1MzoyNlrOG9OmHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNjo1MzoyNlrOG9OmHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg1NTQ1Mw==", "bodyText": "if this check fails will we end up with stalled resources allocated for the flow? since transaction is committed", "url": "https://github.com/telstra/open-kilda/pull/3675#discussion_r466855453", "createdAt": "2020-08-07T06:53:26Z", "author": {"login": "timofei-durakov"}, "path": "src-java/flowhs-topology/flowhs-storm-topology/src/main/java/org/openkilda/wfm/topology/flowhs/fsm/common/actions/BaseResourceAllocationAction.java", "diffHunk": "@@ -196,6 +201,8 @@ private void doAllocateInTransaction(T stateMachine) {\n         } catch (FailsafeException ex) {\n             throw ex.getCause();\n         }\n+\n+        checkAllocatedPaths(stateMachine);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "876d29d8518846dc5c71d7d9d96cfad5021af237"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "876d29d8518846dc5c71d7d9d96cfad5021af237", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/876d29d8518846dc5c71d7d9d96cfad5021af237", "committedDate": "2020-08-06T12:52:39Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}, "afterCommit": {"oid": "21d413ce3d8016710439a13cc87bd8094425ed98", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/21d413ce3d8016710439a13cc87bd8094425ed98", "committedDate": "2020-08-07T07:36:16Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMTA3MjI0", "url": "https://github.com/telstra/open-kilda/pull/3675#pullrequestreview-463107224", "createdAt": "2020-08-07T07:53:04Z", "commit": {"oid": "21d413ce3d8016710439a13cc87bd8094425ed98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNzo1MzowNFrOG9QMew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNzo1MzowNFrOG9QMew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg4MTY1OQ==", "bodyText": "what's aabout cookies, meters, vlans?", "url": "https://github.com/telstra/open-kilda/pull/3675#discussion_r466881659", "createdAt": "2020-08-07T07:53:04Z", "author": {"login": "timofei-durakov"}, "path": "src-java/flowhs-topology/flowhs-storm-topology/src/main/java/org/openkilda/wfm/topology/flowhs/fsm/common/actions/BaseResourceAllocationAction.java", "diffHunk": "@@ -196,6 +201,13 @@ private void doAllocateInTransaction(T stateMachine) {\n         } catch (FailsafeException ex) {\n             throw ex.getCause();\n         }\n+\n+        try {\n+            checkAllocatedPaths(stateMachine);\n+        } catch (ResourceAllocationException ex) {\n+            removeAllocatedPaths(stateMachine);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21d413ce3d8016710439a13cc87bd8094425ed98"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "21d413ce3d8016710439a13cc87bd8094425ed98", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/21d413ce3d8016710439a13cc87bd8094425ed98", "committedDate": "2020-08-07T07:36:16Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}, "afterCommit": {"oid": "c53f981b2cb94e82b53b1fab86e9eaa5b831e122", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/c53f981b2cb94e82b53b1fab86e9eaa5b831e122", "committedDate": "2020-08-07T08:11:45Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "committedDate": "2020-08-07T11:59:00Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c53f981b2cb94e82b53b1fab86e9eaa5b831e122", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/c53f981b2cb94e82b53b1fab86e9eaa5b831e122", "committedDate": "2020-08-07T08:11:45Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}, "afterCommit": {"oid": "7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/7d9ba629d59a0429bd1f2aa9a40e81486371fd8f", "committedDate": "2020-08-07T11:59:00Z", "message": "Added check for the allocated paths to ensure that all ISLs are active on those paths."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0ODM0MTYy", "url": "https://github.com/telstra/open-kilda/pull/3675#pullrequestreview-464834162", "createdAt": "2020-08-11T07:59:12Z", "commit": {"oid": "7d9ba629d59a0429bd1f2aa9a40e81486371fd8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0ODQwMjU1", "url": "https://github.com/telstra/open-kilda/pull/3675#pullrequestreview-464840255", "createdAt": "2020-08-11T08:08:32Z", "commit": {"oid": "7d9ba629d59a0429bd1f2aa9a40e81486371fd8f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3548, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}