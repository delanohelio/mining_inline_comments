{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MTIzMDgz", "number": 3213, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNzozNToxNFrODglsEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNzozOTo1MVrODglwEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NDk4NTEyOnYy", "diffSide": "RIGHT", "path": "src-java/base-topology/base-storm-topology/src/main/java/org/openkilda/wfm/share/hubandspoke/WorkerBolt.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNzozNToxNFrOFq3zkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwOTozNzoxMlrOFrhC1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5ODgzNA==", "bodyText": "maybe it's worth to log tuple payload as well? also, have you checked it doesn't spam a ton of errors?", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r380498834", "createdAt": "2020-02-18T07:35:14Z", "author": {"login": "timofei-durakov"}, "path": "src-java/base-topology/base-storm-topology/src/main/java/org/openkilda/wfm/share/hubandspoke/WorkerBolt.java", "diffHunk": "@@ -87,7 +87,8 @@ private void dispatchResponse(Tuple input) throws Exception {\n         if (request != null) {\n             onAsyncResponse(request, input);\n         } else {\n-            unhandledInput(input);\n+            log.error(\"{} drop worker async response. because {} key is not listed in pending response list\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3NDQ4Ng==", "bodyText": "It produce same amount of messages as removed unhandledInput() call. I don't see any benefits from logging tuple here (from my point of view, whole picture can be seen only when log records are filtered by correlation it...)", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381174486", "createdAt": "2020-02-19T09:37:12Z", "author": {"login": "surabujin"}, "path": "src-java/base-topology/base-storm-topology/src/main/java/org/openkilda/wfm/share/hubandspoke/WorkerBolt.java", "diffHunk": "@@ -87,7 +87,8 @@ private void dispatchResponse(Tuple input) throws Exception {\n         if (request != null) {\n             onAsyncResponse(request, input);\n         } else {\n-            unhandledInput(input);\n+            log.error(\"{} drop worker async response. because {} key is not listed in pending response list\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5ODgzNA=="}, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NDk5MDM5OnYy", "diffSide": "RIGHT", "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/kafka/RecordHandler.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNzozNzozN1rOFq32ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNzo1NDoxNVrOFsJNzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5OTY1MQ==", "bodyText": "don't get this fixme, null for the errors seems bad idea, also take into account this one #3160", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r380499651", "createdAt": "2020-02-18T07:37:37Z", "author": {"login": "timofei-durakov"}, "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/kafka/RecordHandler.java", "diffHunk": "@@ -1424,6 +1424,7 @@ private void dumpMeters(SwitchId switchId, String correlationId, String replyToT\n         try {\n             logger.debug(\"Get all meters for switch {}\", switchId);\n             ISwitchManager switchManager = context.getSwitchManager();\n+            // FIXME(surabujin): return null in case of errors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3MjkxMQ==", "bodyText": "I do not propose to return null. Now witchManager.dumpMeters(DatapathId.of(switchId.toLong())) return null in some cases and it leads to NPE in this method. This FIXME is reminder to fix it.", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381172911", "createdAt": "2020-02-19T09:34:39Z", "author": {"login": "surabujin"}, "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/kafka/RecordHandler.java", "diffHunk": "@@ -1424,6 +1424,7 @@ private void dumpMeters(SwitchId switchId, String correlationId, String replyToT\n         try {\n             logger.debug(\"Get all meters for switch {}\", switchId);\n             ISwitchManager switchManager = context.getSwitchManager();\n+            // FIXME(surabujin): return null in case of errors", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5OTY1MQ=="}, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgzMjY1Mg==", "bodyText": "ok, it's just composed badly then. It should be get rid of returning null.", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381832652", "createdAt": "2020-02-20T07:54:15Z", "author": {"login": "timofei-durakov"}, "path": "src-java/floodlight-service/floodlight-modules/src/main/java/org/openkilda/floodlight/kafka/RecordHandler.java", "diffHunk": "@@ -1424,6 +1424,7 @@ private void dumpMeters(SwitchId switchId, String correlationId, String replyToT\n         try {\n             logger.debug(\"Get all meters for switch {}\", switchId);\n             ISwitchManager switchManager = context.getSwitchManager();\n+            // FIXME(surabujin): return null in case of errors", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ5OTY1MQ=="}, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NDk5NTM5OnYy", "diffSide": "RIGHT", "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/fsm/SwitchSyncFsm.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNzozOTo1MVrOFq35vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNzo1NTozMlrOFsJPuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwMDQxNQ==", "bodyText": "just for the sake of curiosity, is it better to move key from the beginning from the search perspective?", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r380500415", "createdAt": "2020-02-18T07:39:51Z", "author": {"login": "timofei-durakov"}, "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/fsm/SwitchSyncFsm.java", "diffHunk": "@@ -171,15 +171,15 @@ public String getKey() {\n \n     protected void initialized(SwitchSyncState from, SwitchSyncState to,\n                                SwitchSyncEvent event, Object context) {\n-        log.info(\"Key: {}, sync FSM initialized\", key);\n+        log.info(\"The switch sync process for {} has been started (key={})\", switchId, key);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE3NTYwMA==", "bodyText": "No. For the same sake - will you ever search any records by this key?", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381175600", "createdAt": "2020-02-19T09:39:04Z", "author": {"login": "surabujin"}, "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/fsm/SwitchSyncFsm.java", "diffHunk": "@@ -171,15 +171,15 @@ public String getKey() {\n \n     protected void initialized(SwitchSyncState from, SwitchSyncState to,\n                                SwitchSyncEvent event, Object context) {\n-        log.info(\"Key: {}, sync FSM initialized\", key);\n+        log.info(\"The switch sync process for {} has been started (key={})\", switchId, key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwMDQxNQ=="}, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgzMzE0NA==", "bodyText": "it was aligned at least as for me. yeah, why not. (not a blocker, just curious)", "url": "https://github.com/telstra/open-kilda/pull/3213#discussion_r381833144", "createdAt": "2020-02-20T07:55:32Z", "author": {"login": "timofei-durakov"}, "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/fsm/SwitchSyncFsm.java", "diffHunk": "@@ -171,15 +171,15 @@ public String getKey() {\n \n     protected void initialized(SwitchSyncState from, SwitchSyncState to,\n                                SwitchSyncEvent event, Object context) {\n-        log.info(\"Key: {}, sync FSM initialized\", key);\n+        log.info(\"The switch sync process for {} has been started (key={})\", switchId, key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwMDQxNQ=="}, "originalCommit": {"oid": "c80f025ccf3a0b4be7fd0608be2a1b7c010b6f49"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2142, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}