{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NzU5NDE5", "number": 3724, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjoyNTozMVrOEoYxKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjoyNTozMVrOEoYxKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwNzg0Mjk5OnYy", "diffSide": "RIGHT", "path": "src-java/server42/server42-stats/src/main/java/org/openkilda/server42/stats/zeromq/StatsCollector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjoyNTozMVrOHZcmfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwODoxNjo0MVrOHZgzFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ0NTA1Mg==", "bodyText": "why is it break for EAGAIN?", "url": "https://github.com/telstra/open-kilda/pull/3724#discussion_r496445052", "createdAt": "2020-09-29T06:25:31Z", "author": {"login": "timofei-durakov"}, "path": "src-java/server42/server42-stats/src/main/java/org/openkilda/server42/stats/zeromq/StatsCollector.java", "diffHunk": "@@ -60,25 +73,33 @@ public void run() {\n         sessionId = RandomStringUtils.randomAlphanumeric(8);\n         log.info(\"started with session id {}\", sessionId);\n         while (!isInterrupted()) {\n-            try (ZContext context = new ZContext()) {\n-                Socket server = context.createSocket(ZMQ.PULL);\n-                try {\n-                    server.connect(connectEndpoint);\n-                    while (!isInterrupted()) {\n-                        byte[] recv = server.recv();\n-                        log.debug(\"stats recived\");\n-                        handleInput(recv);\n+            try (Socket server = context.createSocket(ZMQ.PULL)) {\n+                server.setReceiveTimeOut(1000);\n+                server.connect(connectEndpoint);\n+                log.info(\"connect to {}\", connectEndpoint);\n+                while (!isInterrupted()) {\n+                    byte[] recv = server.recv();\n+                    log.debug(\"recv {}\", recv);\n+                    if (recv == null && server.errno() == ZError.EAGAIN) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjUxMzgxMw==", "bodyText": "That is timeout. I didn't find documentation but I found src https://github.com/zeromq/jeromq/blob/master/src/main/java/zmq/SocketBase.java#L850", "url": "https://github.com/telstra/open-kilda/pull/3724#discussion_r496513813", "createdAt": "2020-09-29T08:16:41Z", "author": {"login": "nikitamarchenko"}, "path": "src-java/server42/server42-stats/src/main/java/org/openkilda/server42/stats/zeromq/StatsCollector.java", "diffHunk": "@@ -60,25 +73,33 @@ public void run() {\n         sessionId = RandomStringUtils.randomAlphanumeric(8);\n         log.info(\"started with session id {}\", sessionId);\n         while (!isInterrupted()) {\n-            try (ZContext context = new ZContext()) {\n-                Socket server = context.createSocket(ZMQ.PULL);\n-                try {\n-                    server.connect(connectEndpoint);\n-                    while (!isInterrupted()) {\n-                        byte[] recv = server.recv();\n-                        log.debug(\"stats recived\");\n-                        handleInput(recv);\n+            try (Socket server = context.createSocket(ZMQ.PULL)) {\n+                server.setReceiveTimeOut(1000);\n+                server.connect(connectEndpoint);\n+                log.info(\"connect to {}\", connectEndpoint);\n+                while (!isInterrupted()) {\n+                    byte[] recv = server.recv();\n+                    log.debug(\"recv {}\", recv);\n+                    if (recv == null && server.errno() == ZError.EAGAIN) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ0NTA1Mg=="}, "originalCommit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "originalPosition": 55}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1825, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}