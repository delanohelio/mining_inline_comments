{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2MjIzMDky", "number": 3829, "title": "ISL status transition visibility improvement", "bodyText": "", "createdAt": "2020-11-05T17:30:09Z", "url": "https://github.com/telstra/open-kilda/pull/3829", "merged": true, "mergeCommit": {"oid": "8a93fb72b6b7bf74d9fc8285c4d13394cc308240"}, "closed": true, "closedAt": "2020-11-24T19:45:19Z", "author": {"login": "surabujin"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZoOHpAH2gAyNTE2MjIzMDkyOmMzZjY1M2UzY2MzYzgwMTRjZTZmNDZlMmRiZGI0NzNhYjYxNWZiNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdd4opNgFqTUzNDAxNjI0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65", "committedDate": "2020-11-05T20:16:58Z", "message": "ISL status transition visibility improvement"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea4be657bfda7db0ec580ab7eecfa19df7ca7f25", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/ea4be657bfda7db0ec580ab7eecfa19df7ca7f25", "committedDate": "2020-11-05T17:28:26Z", "message": "ISL status transition visibility improvement"}, "afterCommit": {"oid": "c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65", "committedDate": "2020-11-05T20:16:58Z", "message": "ISL status transition visibility improvement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MDMwNTE2", "url": "https://github.com/telstra/open-kilda/pull/3829#pullrequestreview-527030516", "createdAt": "2020-11-10T09:52:21Z", "commit": {"oid": "c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNDAwODc3", "url": "https://github.com/telstra/open-kilda/pull/3829#pullrequestreview-531400877", "createdAt": "2020-11-16T14:59:37Z", "commit": {"oid": "c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDo1OTozOFrOH0ColA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDo1OTozOFrOH0ColA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDMzMTE1Ng==", "bodyText": "Why do you need to add space here?", "url": "https://github.com/telstra/open-kilda/pull/3829#discussion_r524331156", "createdAt": "2020-11-16T14:59:38Z", "author": {"login": "rozdy"}, "path": "src-java/network-topology/network-storm-topology/src/main/java/org/openkilda/wfm/topology/network/controller/isl/StatusAggregator.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/* Copyright 2020 Telstra Open Source\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *   you may not use this file except in compliance with the License.\n+ *   You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   Unless required by applicable law or agreed to in writing, software\n+ *   distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *   See the License for the specific language governing permissions and\n+ *   limitations under the License.\n+ */\n+\n+package org.openkilda.wfm.topology.network.controller.isl;\n+\n+import org.openkilda.model.IslDownReason;\n+import org.openkilda.model.IslStatus;\n+\n+import lombok.Getter;\n+\n+import java.util.Optional;\n+\n+class StatusAggregator {\n+    private IslStatus effectiveStatus = null;\n+\n+    @Getter\n+    private IslDownReason downReason = null;\n+\n+    private String details = \"\";\n+    private boolean isFirstHit = true;\n+\n+    public void evaluate(DiscoveryMonitor<?> monitor) {\n+        Optional<IslStatus> status = monitor.evaluateStatus();\n+        String detailsEntry = monitor.getName() + \":\";\n+        if (status.isPresent()) {\n+            if (isFirstHit) {\n+                isFirstHit = false;\n+\n+                effectiveStatus = status.get();\n+                downReason = monitor.getDownReason();\n+                detailsEntry = \"*\" + detailsEntry;\n+            }\n+            detailsEntry += status.get();\n+        } else {\n+            detailsEntry += \"-\";\n+        }\n+\n+        updateDetails(detailsEntry);\n+    }\n+\n+    IslStatus getEffectiveStatus() {\n+        if (effectiveStatus == null) {\n+            return IslStatus.INACTIVE;\n+        }\n+        return effectiveStatus;\n+    }\n+\n+    String getDetails() {\n+        return String.join(\" \", details);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MDE2MjQ4", "url": "https://github.com/telstra/open-kilda/pull/3829#pullrequestreview-534016248", "createdAt": "2020-11-19T01:40:07Z", "commit": {"oid": "c3f653e3cc3c8014ce6f46e2dbdb473ab615fb65"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3758, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}