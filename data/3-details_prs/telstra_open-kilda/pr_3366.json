{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NjkwNDAz", "number": 3366, "title": "Added GRPC service stub", "bodyText": "", "createdAt": "2020-04-06T14:34:22Z", "url": "https://github.com/telstra/open-kilda/pull/3366", "merged": true, "mergeCommit": {"oid": "c3306f3d3f7c7f43df89391b100cdaad1abc6d28"}, "closed": true, "closedAt": "2020-04-17T12:24:12Z", "author": {"login": "niksv"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVMt3ZgBqjMyMDgyODE5NjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYe1MTgBqjMyNDM4MjIxOTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e898c08850f92a787979ce1b04c1d65cf522832", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/2e898c08850f92a787979ce1b04c1d65cf522832", "committedDate": "2020-04-06T14:32:34Z", "message": "Added GRPC service stub"}, "afterCommit": {"oid": "476f531b71b579d35f23b28f3c8f37bcb588f730", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/476f531b71b579d35f23b28f3c8f37bcb588f730", "committedDate": "2020-04-07T05:47:10Z", "message": "Added GRPC service stub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5OTQ3MzA1", "url": "https://github.com/telstra/open-kilda/pull/3366#pullrequestreview-389947305", "createdAt": "2020-04-08T12:57:24Z", "commit": {"oid": "476f531b71b579d35f23b28f3c8f37bcb588f730"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1NzoyNVrOGCt8xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1NzoyNVrOGCt8xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwMzE3NA==", "bodyText": "tbh this doesn't look like a mandatory part of the system, thus should be wrapped with {{if not (exists \"/no_grpc_stub\")}} thing", "url": "https://github.com/telstra/open-kilda/pull/3366#discussion_r405503174", "createdAt": "2020-04-08T12:57:25Z", "author": {"login": "rtretyak"}, "path": "confd/templates/docker-compose/docker-compose.tmpl", "diffHunk": "@@ -4,6 +4,21 @@\n version: '2.1'\n services:\n \n+  grpc-stub:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "476f531b71b579d35f23b28f3c8f37bcb588f730"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "476f531b71b579d35f23b28f3c8f37bcb588f730", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/476f531b71b579d35f23b28f3c8f37bcb588f730", "committedDate": "2020-04-07T05:47:10Z", "message": "Added GRPC service stub"}, "afterCommit": {"oid": "a213d3cff35c75549b0c30a3c5002b6d08fc1588", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/a213d3cff35c75549b0c30a3c5002b6d08fc1588", "committedDate": "2020-04-08T15:42:31Z", "message": "Added GRPC service stub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a213d3cff35c75549b0c30a3c5002b6d08fc1588", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/a213d3cff35c75549b0c30a3c5002b6d08fc1588", "committedDate": "2020-04-08T15:42:31Z", "message": "Added GRPC service stub"}, "afterCommit": {"oid": "0bd7ebcba9b33651efcf8ad3c2e3526c9627816c", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/0bd7ebcba9b33651efcf8ad3c2e3526c9627816c", "committedDate": "2020-04-16T15:27:26Z", "message": "Added GRPC service stub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MjYzMDg2", "url": "https://github.com/telstra/open-kilda/pull/3366#pullrequestreview-395263086", "createdAt": "2020-04-17T08:33:13Z", "commit": {"oid": "5c64c8cc39e156bf0fd2db3b9676a26a8066ffdd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MzA2NzUw", "url": "https://github.com/telstra/open-kilda/pull/3366#pullrequestreview-395306750", "createdAt": "2020-04-17T09:36:12Z", "commit": {"oid": "5c64c8cc39e156bf0fd2db3b9676a26a8066ffdd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTozNjoxMlrOGHHEmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTozNjoxMlrOGHHEmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDEwOTA4Mw==", "bodyText": "this could lead to wrong network finding", "url": "https://github.com/telstra/open-kilda/pull/3366#discussion_r410109083", "createdAt": "2020-04-17T09:36:12Z", "author": {"login": "timofei-durakov"}, "path": "src-java/testing/functional-tests/src/main/groovy/org/openkilda/functionaltests/helpers/DockerHelper.groovy", "diffHunk": "@@ -0,0 +1,44 @@\n+package org.openkilda.functionaltests.helpers\n+\n+import com.spotify.docker.client.DefaultDockerClient\n+import com.spotify.docker.client.DockerClient\n+import com.spotify.docker.client.DockerClient.ListContainersParam\n+import groovy.util.logging.Slf4j\n+\n+@Slf4j\n+class DockerHelper {\n+\n+    DockerClient dockerClient\n+    String networkName\n+\n+    DockerHelper(String host) {\n+        log.debug(\"Configuring docker client\");\n+        if (host == 'localhost') {\n+            dockerClient = DefaultDockerClient.fromEnv().build()\n+        } else {\n+            dockerClient = DefaultDockerClient.fromEnv().uri(host).build()\n+        }\n+        log.debug(\"Connected to Docker Host: $host\")\n+\n+        networkName = getNetworkName()\n+        log.debug(\"Network name: $networkName\")\n+    }\n+\n+    String getContainerIp(String containerName) {\n+        dockerClient.listContainers(ListContainersParam.allContainers()).find {\n+            it.names().contains(\"/\" + containerName)\n+        }.networkSettings().networks()[networkName].ipAddress()\n+    }\n+\n+    void restartContainer(String containerId) {\n+        dockerClient.restartContainer(containerId)\n+    }\n+\n+    void waitContainer(String containerId) {\n+        dockerClient.waitContainer(containerId)\n+    }\n+\n+    private String getNetworkName() {\n+        dockerClient.listNetworks()*.name().find { it.contains('_default')}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c64c8cc39e156bf0fd2db3b9676a26a8066ffdd"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MzA2Nzc4", "url": "https://github.com/telstra/open-kilda/pull/3366#pullrequestreview-395306778", "createdAt": "2020-04-17T09:36:15Z", "commit": {"oid": "5c64c8cc39e156bf0fd2db3b9676a26a8066ffdd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1de92b826c892254a757872d92119b170b54591e", "author": {"user": {"login": "niksv", "name": "Sergey Nikitin"}}, "url": "https://github.com/telstra/open-kilda/commit/1de92b826c892254a757872d92119b170b54591e", "committedDate": "2020-04-17T10:31:58Z", "message": "Added GRPC service stub"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5affbebb4d80407d69689aec239e71bb39b8ebfe", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/5affbebb4d80407d69689aec239e71bb39b8ebfe", "committedDate": "2020-04-17T10:35:15Z", "message": "adjust grpc tests to work with grpc-stub (#3381)\n\n* add possibility to get ip of container via lockkeper\n\n* adjust grpc tests to work with stub\n\n* fix wfmManipulator\n\n* fix \"Simultaneous reroute of multiple flows should not oversubscribe any ISLs\""}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c64c8cc39e156bf0fd2db3b9676a26a8066ffdd", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/5c64c8cc39e156bf0fd2db3b9676a26a8066ffdd", "committedDate": "2020-04-17T08:32:20Z", "message": "adjust grpc tests to work with grpc-stub (#3381)\n\n* add possibility to get ip of container via lockkeper\r\n\r\n* adjust grpc tests to work with stub\r\n\r\n* fix wfmManipulator\r\n\r\n* fix \"Simultaneous reroute of multiple flows should not oversubscribe any ISLs\""}, "afterCommit": {"oid": "5affbebb4d80407d69689aec239e71bb39b8ebfe", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/5affbebb4d80407d69689aec239e71bb39b8ebfe", "committedDate": "2020-04-17T10:35:15Z", "message": "adjust grpc tests to work with grpc-stub (#3381)\n\n* add possibility to get ip of container via lockkeper\n\n* adjust grpc tests to work with stub\n\n* fix wfmManipulator\n\n* fix \"Simultaneous reroute of multiple flows should not oversubscribe any ISLs\""}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3613, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}