{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MTIwMDM0", "number": 3093, "title": "Fix the mess with flow endpoints during the flow update", "bodyText": "The mess happened because of the usage of inter-object reference stored inside objects. The caller code directly defines which objects must be used, so service code must not rely on relation stored inside objects. Or else... incorrect data will be used for flow segment speaker requests.\nSo always use provided \"parts\" of domain objects and avoid usage of inter-objects links/relations.", "createdAt": "2020-01-03T20:54:30Z", "url": "https://github.com/telstra/open-kilda/pull/3093", "merged": true, "mergeCommit": {"oid": "aec1b1087580a1666221841d42e269d8afca9e87"}, "closed": true, "closedAt": "2020-04-03T07:00:42Z", "author": {"login": "surabujin"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3poclgFqTMzODU3MDgzMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcT7XGAAFqTM4Njk3ODkyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4NTcwODMz", "url": "https://github.com/telstra/open-kilda/pull/3093#pullrequestreview-338570833", "createdAt": "2020-01-06T10:31:03Z", "commit": {"oid": "d0095184f6861762cf996ab7005a3420a8aa5fda"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MzI1NzYz", "url": "https://github.com/telstra/open-kilda/pull/3093#pullrequestreview-354325763", "createdAt": "2020-02-06T10:00:41Z", "commit": {"oid": "d0095184f6861762cf996ab7005a3420a8aa5fda"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMDowMDo0MVrOFmVWBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMDowMDo0MVrOFmVWBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTczOTkwOA==", "bodyText": "Why do we allow to build flow segment requests for \"null\" path?", "url": "https://github.com/telstra/open-kilda/pull/3093#discussion_r375739908", "createdAt": "2020-02-06T10:00:41Z", "author": {"login": "sergii-iakovenko"}, "path": "services/wfm/src/main/java/org/openkilda/wfm/share/service/SpeakerFlowSegmentRequestBuilder.java", "diffHunk": "@@ -103,22 +103,21 @@ public SpeakerFlowSegmentRequestBuilder(FlowResourcesManager resourcesManager) {\n \n         List<FlowSegmentRequestFactory> requests = new ArrayList<>();\n         requests.addAll(makePathRequests(\n-                path, context, encapsulation, doIngress, doTransit, doEgress));\n+                flow, path, context, encapsulation, doIngress, doTransit, doEgress));\n         if (oppositePath != null) {\n-            if (!flow.isOneSwitchFlow() && oppositePath != null) {\n+            if (!flow.isOneSwitchFlow()) {\n                 encapsulation = getEncapsulation(\n                         flow.getEncapsulationType(), oppositePath.getPathId(), path.getPathId());\n             }\n             requests.addAll(makePathRequests(\n-                    oppositePath, context, encapsulation, doIngress, doTransit, doEgress));\n+                    flow, oppositePath, context, encapsulation, doIngress, doTransit, doEgress));\n         }\n         return requests;\n     }\n \n     private List<FlowSegmentRequestFactory> makePathRequests(\n-            @NonNull FlowPath path, CommandContext context, FlowTransitEncapsulation encapsulation,\n+            Flow flow, FlowPath path, CommandContext context, FlowTransitEncapsulation encapsulation,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0095184f6861762cf996ab7005a3420a8aa5fda"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0095184f6861762cf996ab7005a3420a8aa5fda", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/d0095184f6861762cf996ab7005a3420a8aa5fda", "committedDate": "2020-01-03T20:43:17Z", "message": "Fix mess with flow endpoints duriong update\n\nThe mess happened because of usage inter-object reference stored inside\nobjects. Because there is no \"consistency\" into provided objects on the\ncaller side (at least now it is part of design) it leads to ... mess.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}, "afterCommit": {"oid": "05ae25a2f8c6e1f42851d191191547a288cdd9a8", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/05ae25a2f8c6e1f42851d191191547a288cdd9a8", "committedDate": "2020-03-04T16:44:41Z", "message": "Fix mess with flow endpoints duriong update\n\nThe mess happened because of usage inter-object reference stored inside\nobjects. Because there is no \"consistency\" into provided objects on the\ncaller side (at least now it is part of design) it leads to ... mess.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4OTUwOTI1", "url": "https://github.com/telstra/open-kilda/pull/3093#pullrequestreview-368950925", "createdAt": "2020-03-04T16:53:50Z", "commit": {"oid": "05ae25a2f8c6e1f42851d191191547a288cdd9a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05ae25a2f8c6e1f42851d191191547a288cdd9a8", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/05ae25a2f8c6e1f42851d191191547a288cdd9a8", "committedDate": "2020-03-04T16:44:41Z", "message": "Fix mess with flow endpoints duriong update\n\nThe mess happened because of usage inter-object reference stored inside\nobjects. Because there is no \"consistency\" into provided objects on the\ncaller side (at least now it is part of design) it leads to ... mess.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}, "afterCommit": {"oid": "3059705aa8bf4d526dd1eab6ff6bba3d025bbdcc", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/3059705aa8bf4d526dd1eab6ff6bba3d025bbdcc", "committedDate": "2020-03-04T16:51:23Z", "message": "Fix the mess with flow endpoints during the flow update\n\nThe mess happened because of the usage of inter-object reference stored\ninside objects. The caller code directly defines which objects must be\nused, so service code must not rely on relation stored inside objects.\nOr else... incorrect data will be used for flow segment speaker\nrequests.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3059705aa8bf4d526dd1eab6ff6bba3d025bbdcc", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/3059705aa8bf4d526dd1eab6ff6bba3d025bbdcc", "committedDate": "2020-03-04T16:51:23Z", "message": "Fix the mess with flow endpoints during the flow update\n\nThe mess happened because of the usage of inter-object reference stored\ninside objects. The caller code directly defines which objects must be\nused, so service code must not rely on relation stored inside objects.\nOr else... incorrect data will be used for flow segment speaker\nrequests.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}, "afterCommit": {"oid": "e2a78386ead7d479bcf4cab04647e0a113b62bec", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/e2a78386ead7d479bcf4cab04647e0a113b62bec", "committedDate": "2020-03-11T14:13:03Z", "message": "Fix the mess with flow endpoints during the flow update\n\nThe mess happened because of the usage of inter-object reference stored\ninside objects. The caller code directly defines which objects must be\nused, so service code must not rely on relation stored inside objects.\nOr else... incorrect data will be used for flow segment speaker\nrequests.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NTEzMDUz", "url": "https://github.com/telstra/open-kilda/pull/3093#pullrequestreview-379513053", "createdAt": "2020-03-23T14:59:50Z", "commit": {"oid": "e2a78386ead7d479bcf4cab04647e0a113b62bec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9012632f032834e3af272399041d6c79419637ed", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/9012632f032834e3af272399041d6c79419637ed", "committedDate": "2020-03-27T08:29:15Z", "message": "Fix the mess with flow endpoints during the flow update\n\nThe mess happened because of the usage of inter-object reference stored\ninside objects. The caller code directly defines which objects must be\nused, so service code must not rely on relation stored inside objects.\nOr else... incorrect data will be used for flow segment speaker\nrequests.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2a78386ead7d479bcf4cab04647e0a113b62bec", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/e2a78386ead7d479bcf4cab04647e0a113b62bec", "committedDate": "2020-03-11T14:13:03Z", "message": "Fix the mess with flow endpoints during the flow update\n\nThe mess happened because of the usage of inter-object reference stored\ninside objects. The caller code directly defines which objects must be\nused, so service code must not rely on relation stored inside objects.\nOr else... incorrect data will be used for flow segment speaker\nrequests.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}, "afterCommit": {"oid": "9012632f032834e3af272399041d6c79419637ed", "author": {"user": {"login": "surabujin", "name": "Dmitriy Bogun"}}, "url": "https://github.com/telstra/open-kilda/commit/9012632f032834e3af272399041d6c79419637ed", "committedDate": "2020-03-27T08:29:15Z", "message": "Fix the mess with flow endpoints during the flow update\n\nThe mess happened because of the usage of inter-object reference stored\ninside objects. The caller code directly defines which objects must be\nused, so service code must not rely on relation stored inside objects.\nOr else... incorrect data will be used for flow segment speaker\nrequests.\n\nSo always use provided \"parts\" of domain objects and avoid usage of\ninter-objects links/relations."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2OTc4OTIw", "url": "https://github.com/telstra/open-kilda/pull/3093#pullrequestreview-386978920", "createdAt": "2020-04-03T07:00:16Z", "commit": {"oid": "9012632f032834e3af272399041d6c79419637ed"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3722, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}