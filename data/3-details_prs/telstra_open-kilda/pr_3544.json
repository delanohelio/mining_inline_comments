{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1MDc3NDM0", "number": 3544, "title": "Minor stability adjustments in tests", "bodyText": "", "createdAt": "2020-06-16T09:05:50Z", "url": "https://github.com/telstra/open-kilda/pull/3544", "merged": true, "mergeCommit": {"oid": "5ed2e9c033ae4049ea9db3ad6aff27843b9727d2"}, "closed": true, "closedAt": "2020-06-23T10:33:23Z", "author": {"login": "rtretyak"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrxtW5gBqjM0NDgwNTI1Mjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsvQoLgBqjM0NjE1ODY3MTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac95044f0a5e14a7af4ef2366909b2bdc256c3c1", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/ac95044f0a5e14a7af4ef2366909b2bdc256c3c1", "committedDate": "2020-06-16T09:04:29Z", "message": "Minor stability adjustments in tests"}, "afterCommit": {"oid": "05eef7190cbeed9d6a41ca62a25cc4778475b5bd", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/05eef7190cbeed9d6a41ca62a25cc4778475b5bd", "committedDate": "2020-06-16T09:19:18Z", "message": "Minor stability adjustments in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxNDY3ODY0", "url": "https://github.com/telstra/open-kilda/pull/3544#pullrequestreview-431467864", "createdAt": "2020-06-16T12:50:23Z", "commit": {"oid": "05eef7190cbeed9d6a41ca62a25cc4778475b5bd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMjo1MDoyM1rOGkZvkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMjo1MDoyM1rOGkZvkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgyMzY5OA==", "bodyText": "You can use spaceship(v1 <=> v2) operator", "url": "https://github.com/telstra/open-kilda/pull/3544#discussion_r440823698", "createdAt": "2020-06-16T12:50:23Z", "author": {"login": "andriidovhan"}, "path": "src-java/testing/functional-tests/src/test/groovy/org/openkilda/functionaltests/spec/grpc/GrpcBaseSpecification.groovy", "diffHunk": "@@ -36,9 +36,33 @@ class GrpcBaseSpecification extends HealthCheckSpecification {\n                     false, \"of_version\", \"manufacturer\", \"hardware\", \"software\", \"serial_number\") as List\n         } else {\n             northbound.activeSwitches.findAll {\n-                def matcher = it.description =~ /NW[0-9]+.([0-9].[0-9])/\n-                return matcher && matcher[0][1] >= \"2.7\"\n+                it.manufacturer.toLowerCase().contains(\"noviflow\") &&\n+                        compareNoviVersions(it.software, \"500.2.7\") >= 0\n             }.unique { [it.hardware, it.software] }\n         }\n     }\n+\n+    /**\n+     * Compare 2 version strings. Must have equal amount of number groups, e.g. 500.0.0.1 and 49.555.45.0\n+     * @return '1' if v1 > v2, '-1' if v1 < v2, '0' if equal\n+     */\n+    int compareNoviVersions(String v1, String v2) {\n+        def pattern = /\\d+/\n+        def v1Matcher = v1 =~ pattern\n+        def v2Matcher = v2 =~ pattern\n+        if (!v1Matcher || !v2Matcher || v1Matcher.size() != v2Matcher.size()) {\n+            throw new RuntimeException(\"Unable to compare given version strings: $v1 and $v2\")\n+        }\n+        def v1Numbers = v1Matcher.collect { it[0] }\n+        def v2Numbers = v2Matcher.collect { it[0] }\n+        for (int i = 0; i < v1Numbers.size(); i++) {\n+            if (v1Numbers[i] > v2Numbers[i]) {\n+                return 1\n+            } else if (v1Numbers[i] < v2Numbers[i]) {\n+                return -1\n+            }\n+        }\n+        return 0\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05eef7190cbeed9d6a41ca62a25cc4778475b5bd"}, "originalPosition": 33}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05eef7190cbeed9d6a41ca62a25cc4778475b5bd", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/05eef7190cbeed9d6a41ca62a25cc4778475b5bd", "committedDate": "2020-06-16T09:19:18Z", "message": "Minor stability adjustments in tests"}, "afterCommit": {"oid": "60de6a108590877fed3fe607ed3423c4b97eb3ee", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/60de6a108590877fed3fe607ed3423c4b97eb3ee", "committedDate": "2020-06-16T15:48:29Z", "message": "Minor stability adjustments in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxODQyNTIw", "url": "https://github.com/telstra/open-kilda/pull/3544#pullrequestreview-431842520", "createdAt": "2020-06-16T19:52:44Z", "commit": {"oid": "60de6a108590877fed3fe607ed3423c4b97eb3ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxOTo1Mjo0NFrOGkq2zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxOTo1Mjo0NFrOGkq2zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTEwNDA3OA==", "bodyText": "what's wrong with that?", "url": "https://github.com/telstra/open-kilda/pull/3544#discussion_r441104078", "createdAt": "2020-06-16T19:52:44Z", "author": {"login": "andriidovhan"}, "path": "src-java/projectfloodlight/openflowj/build.gradle", "diffHunk": "@@ -46,9 +46,9 @@ task generateSources(type: Exec, dependsOn: cloneLoxigenRepo) {\n         commandLine 'make', 'java'\n     }\n     else {\n-        def uid = new UnixSystem().getUid()\n-        def gid = new UnixSystem().getGid()\n-        commandLine 'docker', 'run', '--rm', '-v', \"$workingDir:$workingDir\", '-w', \"$workingDir\", '-u', \"$uid:$gid\", 'kilda/base-ubuntu', 'make', 'java'\n+//        def uid = new UnixSystem().getUid()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60de6a108590877fed3fe607ed3423c4b97eb3ee"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60de6a108590877fed3fe607ed3423c4b97eb3ee", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/60de6a108590877fed3fe607ed3423c4b97eb3ee", "committedDate": "2020-06-16T15:48:29Z", "message": "Minor stability adjustments in tests"}, "afterCommit": {"oid": "3bab8eec31c6bd81ebf75479529a71df15472592", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/3bab8eec31c6bd81ebf75479529a71df15472592", "committedDate": "2020-06-17T07:40:30Z", "message": "Minor stability adjustments in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMTU5NDE1", "url": "https://github.com/telstra/open-kilda/pull/3544#pullrequestreview-432159415", "createdAt": "2020-06-17T08:09:43Z", "commit": {"oid": "3bab8eec31c6bd81ebf75479529a71df15472592"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3bab8eec31c6bd81ebf75479529a71df15472592", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/3bab8eec31c6bd81ebf75479529a71df15472592", "committedDate": "2020-06-17T07:40:30Z", "message": "Minor stability adjustments in tests"}, "afterCommit": {"oid": "028c8de06d345fefcfcd17b22590a539bd510037", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/028c8de06d345fefcfcd17b22590a539bd510037", "committedDate": "2020-06-18T08:40:46Z", "message": "Minor stability adjustments in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a15dedd31b47dd56bf3f91f494d471116fb8b638", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/a15dedd31b47dd56bf3f91f494d471116fb8b638", "committedDate": "2020-06-19T09:01:14Z", "message": "Minor stability adjustments in tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "028c8de06d345fefcfcd17b22590a539bd510037", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/028c8de06d345fefcfcd17b22590a539bd510037", "committedDate": "2020-06-18T08:40:46Z", "message": "Minor stability adjustments in tests"}, "afterCommit": {"oid": "a15dedd31b47dd56bf3f91f494d471116fb8b638", "author": {"user": {"login": "rtretyak", "name": "Roman Tretiak"}}, "url": "https://github.com/telstra/open-kilda/commit/a15dedd31b47dd56bf3f91f494d471116fb8b638", "committedDate": "2020-06-19T09:01:14Z", "message": "Minor stability adjustments in tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3590, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}