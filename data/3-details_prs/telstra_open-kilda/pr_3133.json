{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1Mzg1NTc3", "number": 3133, "title": "Reroute affected flows on switch up event", "bodyText": "Close #3131", "createdAt": "2020-01-21T16:07:58Z", "url": "https://github.com/telstra/open-kilda/pull/3133", "merged": true, "mergeCommit": {"oid": "db7b18a36f261f7c882c79ce2f369f55a78418f3"}, "closed": true, "closedAt": "2020-02-03T06:52:55Z", "author": {"login": "rozdy"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8kL2vgBqjI5NjcwMDc3Nzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_IIvqgFqTM1MDIyMzIxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62be7c97f2ee3b58a4c2d109d4518d009640f299", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/62be7c97f2ee3b58a4c2d109d4518d009640f299", "committedDate": "2020-01-21T16:02:22Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/c2578665b6e50a561aed114c12a3a0887f56036e", "committedDate": "2020-01-21T16:59:08Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzYxOTMx", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-346361931", "createdAt": "2020-01-22T06:06:16Z", "commit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjowNjoxNlrOFgRYNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjoxNDozMVrOFgReuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MzQ3Nw==", "bodyText": "There is RerouteAffectedFlows class in the same package, why not to extend it instead?", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r369383477", "createdAt": "2020-01-22T06:06:16Z", "author": {"login": "timofei-durakov"}, "path": "services/src/messaging/src/main/java/org/openkilda/messaging/command/reroute/RerouteAffectedFlowsRequest.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/* Copyright 2018 Telstra Open Source\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *   you may not use this file except in compliance with the License.\n+ *   You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   Unless required by applicable law or agreed to in writing, software\n+ *   distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *   See the License for the specific language governing permissions and\n+ *   limitations under the License.\n+ */\n+\n+package org.openkilda.messaging.command.reroute;\n+\n+import org.openkilda.messaging.command.CommandData;\n+import org.openkilda.model.SwitchId;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.PropertyNamingStrategy.SnakeCaseStrategy;\n+import com.fasterxml.jackson.databind.annotation.JsonNaming;\n+import lombok.Data;\n+import lombok.EqualsAndHashCode;\n+import lombok.NonNull;\n+\n+@Data\n+@EqualsAndHashCode(callSuper = false)\n+@JsonNaming(SnakeCaseStrategy.class)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public class RerouteAffectedFlowsRequest extends CommandData {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4NTE0NQ==", "bodyText": "I would prefer to extend repository with required method and not fetching all flows here.\nP.S. it's fine to filter out flows by segments since we do not interested in single switch flows here(kilda do not attempt to re-route them).", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r369385145", "createdAt": "2020-01-22T06:14:31Z", "author": {"login": "timofei-durakov"}, "path": "services/wfm/src/main/java/org/openkilda/wfm/topology/reroute/service/RerouteService.java", "diffHunk": "@@ -271,6 +296,24 @@ private boolean filterForwardPrimaryPath(FlowPath path) {\n                 );\n     }\n \n+    /**\n+     * Returns map with affected inactive flow and flow pathId set for rerouting.\n+     */\n+    public Map<Flow, Set<PathId>> getAffectedInactiveFlowsForRerouting(SwitchId switchId) {\n+        log.info(\"Get affected inactive flows for switch {}\", switchId);\n+        return flowRepository.findDownFlows().stream()\n+                .filter(f -> f.getPaths().stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzY0MTU5", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-346364159", "createdAt": "2020-01-22T06:15:07Z", "commit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjoxNTowN1rOFgRfLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjoxNTowN1rOFgRfLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4NTI2Mg==", "bodyText": "2020:-P", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r369385262", "createdAt": "2020-01-22T06:15:07Z", "author": {"login": "timofei-durakov"}, "path": "services/src/messaging/src/main/java/org/openkilda/messaging/command/reroute/RerouteAffectedFlowsRequest.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/* Copyright 2018 Telstra Open Source", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2578665b6e50a561aed114c12a3a0887f56036e", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/c2578665b6e50a561aed114c12a3a0887f56036e", "committedDate": "2020-01-21T16:59:08Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "3af5d5f9fbb7fa595bf5c2d26e3e293533104507", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/3af5d5f9fbb7fa595bf5c2d26e3e293533104507", "committedDate": "2020-01-22T11:37:39Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NTQyNDY3", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-346542467", "createdAt": "2020-01-22T12:14:05Z", "commit": {"oid": "3af5d5f9fbb7fa595bf5c2d26e3e293533104507"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxMjoxNDowNVrOFgaDQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxMjozNDo1NVrOFgakHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTUyNTU2OQ==", "bodyText": "Maybe it should be RerouteAffectedInactiveFlows?", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r369525569", "createdAt": "2020-01-22T12:14:05Z", "author": {"login": "niksv"}, "path": "services/src/messaging/src/main/java/org/openkilda/messaging/command/reroute/RerouteInactiveAffectedFlows.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/* Copyright 2020 Telstra Open Source\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *   you may not use this file except in compliance with the License.\n+ *   You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   Unless required by applicable law or agreed to in writing, software\n+ *   distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *   See the License for the specific language governing permissions and\n+ *   limitations under the License.\n+ */\n+\n+package org.openkilda.messaging.command.reroute;\n+\n+import org.openkilda.messaging.command.CommandData;\n+import org.openkilda.model.SwitchId;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.PropertyNamingStrategy.SnakeCaseStrategy;\n+import com.fasterxml.jackson.databind.annotation.JsonNaming;\n+import lombok.Data;\n+import lombok.EqualsAndHashCode;\n+import lombok.NonNull;\n+\n+@Data\n+@EqualsAndHashCode(callSuper = false)\n+@JsonNaming(SnakeCaseStrategy.class)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public class RerouteInactiveAffectedFlows extends CommandData {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3af5d5f9fbb7fa595bf5c2d26e3e293533104507"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTUzMzk4Mg==", "bodyText": "it can be better. You can optimize it by getting only Flow Paths of Down and Degraded flows by Neo4j.\nTo do it you need to add new method into flowPathRepository. Something like\n\n    @Override\n    public Collection<FlowPath> findInactiveBySegmentSwitch(SwitchId switchId) {\n        Map<String, Object> parameters = ImmutableMap.of(\n                \"switch_id\", switchIdConverter.toGraphProperty(switchId));\n\n        Set<String> pathIds = new HashSet<>();\n        queryForStrings(\"MATCH (ps_src:switch)-[:source]-(ps:path_segment)-[:destination]-(ps_dst:switch)\" +\n                \"WHERE ps_src.name = $switch_id OR ps_dst.name = $switch_id\" +\n                \"MATCH (f:flow)-[:owns]-(fp:flow_path)-[:owns]-(ps)\" +\n                \"WHERE f.status = 'down' or f.status = 'degraded'\" +\n                \"RETURN fp.path_id as path_id\", parameters, \"path_id\").forEach(pathIds::add);\n\n        if (pathIds.isEmpty()) {\n            return emptyList();\n        }\n\n        Filter pathIdsFilter = new Filter(PATH_ID_PROPERTY_NAME, new InOperatorWithNoConverterComparison(pathIds));\n\n        return loadAll(pathIdsFilter);\n    }", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r369533982", "createdAt": "2020-01-22T12:34:55Z", "author": {"login": "niksv"}, "path": "services/wfm/src/main/java/org/openkilda/wfm/topology/reroute/service/RerouteService.java", "diffHunk": "@@ -263,14 +289,25 @@ private boolean filterForwardPrimaryPath(FlowPath path) {\n     public Map<Flow, Set<PathId>> getInactiveFlowsForRerouting() {\n         log.info(\"Get inactive flows\");\n         return flowRepository.findDownFlows().stream()\n-                .collect(Collectors.toMap(Function.identity(),\n+                .collect(toMap(Function.identity(),\n                         flow -> flow.getPaths().stream()\n                         .filter(path -> FlowPathStatus.INACTIVE.equals(path.getStatus()))\n                         .map(FlowPath::getPathId)\n                         .collect(Collectors.toSet()))\n                 );\n     }\n \n+    /**\n+     * Returns affected inactive flow set for rerouting.\n+     */\n+    public Set<Flow> getAffectedInactiveFlowsForRerouting(SwitchId switchId) {\n+        log.info(\"Get affected inactive flows for switch {}\", switchId);\n+        return flowPathRepository.findBySegmentSwitch(switchId).stream()\n+                .map(FlowPath::getFlow)\n+                .filter(f -> f.getStatus() == FlowStatus.DOWN || f.getStatus() == FlowStatus.DEGRADED)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3af5d5f9fbb7fa595bf5c2d26e3e293533104507"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3af5d5f9fbb7fa595bf5c2d26e3e293533104507", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/3af5d5f9fbb7fa595bf5c2d26e3e293533104507", "committedDate": "2020-01-22T11:37:39Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "5ae508868775560383778af519e082ed505f12a5", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/5ae508868775560383778af519e082ed505f12a5", "committedDate": "2020-01-22T14:40:09Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2OTE1NzMy", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-346915732", "createdAt": "2020-01-22T21:28:52Z", "commit": {"oid": "5ae508868775560383778af519e082ed505f12a5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MDUzNjI3", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-347053627", "createdAt": "2020-01-23T04:34:53Z", "commit": {"oid": "5ae508868775560383778af519e082ed505f12a5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MDU5NTAz", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-347059503", "createdAt": "2020-01-23T05:06:32Z", "commit": {"oid": "5ae508868775560383778af519e082ed505f12a5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwNTowNjozMlrOFgy5cA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwNTowNjozMlrOFgy5cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTkzMjY1Ng==", "bodyText": "This method is not used anywhere.", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r369932656", "createdAt": "2020-01-23T05:06:32Z", "author": {"login": "dpoltavets"}, "path": "services/src/kilda-core/kilda-persistence-neo4j/src/main/java/org/openkilda/persistence/repositories/impl/Neo4jFlowPathRepository.java", "diffHunk": "@@ -206,6 +206,27 @@ public Neo4jFlowPathRepository(Neo4jSessionFactory sessionFactory, TransactionMa\n         return loadAll(pathIdsFilter);\n     }\n \n+    @Override\n+    public Collection<FlowPath> findInactiveBySegmentSwitch(SwitchId switchId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ae508868775560383778af519e082ed505f12a5"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5ae508868775560383778af519e082ed505f12a5", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/5ae508868775560383778af519e082ed505f12a5", "committedDate": "2020-01-22T14:40:09Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "3e70d04b632f8437c51e7e4a3395af368f623736", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/3e70d04b632f8437c51e7e4a3395af368f623736", "committedDate": "2020-01-23T11:06:32Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MjgzMjI3", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-347283227", "createdAt": "2020-01-23T13:11:39Z", "commit": {"oid": "3e70d04b632f8437c51e7e4a3395af368f623736"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NzMwNDAx", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-347730401", "createdAt": "2020-01-24T02:57:14Z", "commit": {"oid": "3e70d04b632f8437c51e7e4a3395af368f623736"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwMjo1NzoxNVrOFhS0QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwMjo1NzoxNVrOFhS0QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ1NTYxNg==", "bodyText": "Why you did that on sync, I prefer on Online state.", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r370455616", "createdAt": "2020-01-24T02:57:15Z", "author": {"login": "nikitamarchenko"}, "path": "docs/design/network-discovery/switch-FSM.puml", "diffHunk": "@@ -60,6 +60,7 @@ ONLINE --> OFFLINE : offline\n \n OFFLINE : enter / update status in DB\n OFFLINE : enter / emit offline for portAll()\n+OFFLINE : online / send reroute affected flows", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e70d04b632f8437c51e7e4a3395af368f623736"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NzMwNDky", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-347730492", "createdAt": "2020-01-24T02:57:38Z", "commit": {"oid": "3e70d04b632f8437c51e7e4a3395af368f623736"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e70d04b632f8437c51e7e4a3395af368f623736", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/3e70d04b632f8437c51e7e4a3395af368f623736", "committedDate": "2020-01-23T11:06:32Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "885b620915c72364c247f0dd53fb98a42157f45a", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/885b620915c72364c247f0dd53fb98a42157f45a", "committedDate": "2020-01-24T13:28:24Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "885b620915c72364c247f0dd53fb98a42157f45a", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/885b620915c72364c247f0dd53fb98a42157f45a", "committedDate": "2020-01-24T13:28:24Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "71594fe588098dbd78b53c27246e2c86261dee4f", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/71594fe588098dbd78b53c27246e2c86261dee4f", "committedDate": "2020-01-24T13:34:20Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "71594fe588098dbd78b53c27246e2c86261dee4f", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/71594fe588098dbd78b53c27246e2c86261dee4f", "committedDate": "2020-01-24T13:34:20Z", "message": "Reroute affected flows on switch up event"}, "afterCommit": {"oid": "4097ce3a1dd6c132013ddd8e7462e18de8f44183", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/4097ce3a1dd6c132013ddd8e7462e18de8f44183", "committedDate": "2020-01-24T15:40:20Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5bdedf2ce5033ed14e6b09d4c1bd213e4b67ba5f", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/5bdedf2ce5033ed14e6b09d4c1bd213e4b67ba5f", "committedDate": "2020-01-27T13:58:13Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}, "afterCommit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/908567380b0ac3d41a31c4f78b90d6f962fe3df2", "committedDate": "2020-01-27T14:17:29Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NzQyODQ3", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-348742847", "createdAt": "2020-01-27T15:19:49Z", "commit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MjExNTM4", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-349211538", "createdAt": "2020-01-28T08:59:55Z", "commit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwODo1OTo1NVrOFidP-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwODo1OTo1NVrOFidP-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY3NTEyOA==", "bodyText": "You already have that flag in DB", "url": "https://github.com/telstra/open-kilda/pull/3133#discussion_r371675128", "createdAt": "2020-01-28T08:59:55Z", "author": {"login": "nikitamarchenko"}, "path": "docs/design/network-discovery/switch-FSM.puml", "diffHunk": "@@ -28,6 +28,8 @@ endlegend\n \n [*] --> INIT\n \n+INIT : set wasOffline = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MjExOTI4", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-349211928", "createdAt": "2020-01-28T09:00:37Z", "commit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MjM5ODEw", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-349239810", "createdAt": "2020-01-28T09:44:56Z", "commit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "908567380b0ac3d41a31c4f78b90d6f962fe3df2", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/908567380b0ac3d41a31c4f78b90d6f962fe3df2", "committedDate": "2020-01-27T14:17:29Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}, "afterCommit": {"oid": "cf79003686b24c456a955032b63faa6164d07dd3", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/cf79003686b24c456a955032b63faa6164d07dd3", "committedDate": "2020-01-28T14:56:39Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5OTc5NzMx", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-349979731", "createdAt": "2020-01-29T09:52:52Z", "commit": {"oid": "cf79003686b24c456a955032b63faa6164d07dd3"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4698f82e37ba84b64ee028e4e0244d4eefee030", "author": {"user": {"login": "rozdy", "name": "Ievgen Rozdymakha"}}, "url": "https://github.com/telstra/open-kilda/commit/f4698f82e37ba84b64ee028e4e0244d4eefee030", "committedDate": "2020-01-29T10:28:25Z", "message": "Reroute affected flows on switch up event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5661587e697d72c5c6f5ce32f8c1063574c4791a", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/5661587e697d72c5c6f5ce32f8c1063574c4791a", "committedDate": "2020-01-29T10:28:31Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf79003686b24c456a955032b63faa6164d07dd3", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/cf79003686b24c456a955032b63faa6164d07dd3", "committedDate": "2020-01-28T14:56:39Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}, "afterCommit": {"oid": "5661587e697d72c5c6f5ce32f8c1063574c4791a", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/5661587e697d72c5c6f5ce32f8c1063574c4791a", "committedDate": "2020-01-29T10:28:31Z", "message": "add test: Flow is rerouted after switchUp event (#3137)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e7ce58685f7f52477fcc2687985c4538db5bf36", "author": {"user": {"login": "andriidovhan", "name": "AndriiDovhan"}}, "url": "https://github.com/telstra/open-kilda/commit/4e7ce58685f7f52477fcc2687985c4538db5bf36", "committedDate": "2020-01-29T12:34:11Z", "message": "improve tests for flow rerouting after switchUp event (#3150)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMjIzMjE2", "url": "https://github.com/telstra/open-kilda/pull/3133#pullrequestreview-350223216", "createdAt": "2020-01-29T16:00:57Z", "commit": {"oid": "4e7ce58685f7f52477fcc2687985c4538db5bf36"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3689, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}