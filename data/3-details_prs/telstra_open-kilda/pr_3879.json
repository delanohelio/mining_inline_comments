{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4NTc5Njcy", "number": 3879, "title": "Zero downtime Switch Manager", "bodyText": "", "createdAt": "2020-11-27T12:14:29Z", "url": "https://github.com/telstra/open-kilda/pull/3879", "merged": true, "mergeCommit": {"oid": "983a39adc709f5a70fd19bf25ef584d3c6e77ce9"}, "closed": true, "closedAt": "2021-02-04T15:13:04Z", "author": {"login": "dpoltavets"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdidNlsgBqjQwNjU3ODI0ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd22aTcgFqTU4MzQ5Njc1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ed2cefb6165b45b41b704ab789a3729493561875", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/ed2cefb6165b45b41b704ab789a3729493561875", "committedDate": "2020-11-27T12:12:19Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "a56f56880d0a554d486a2a73087ea2b32df0ba50", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/a56f56880d0a554d486a2a73087ea2b32df0ba50", "committedDate": "2020-12-03T06:32:28Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a56f56880d0a554d486a2a73087ea2b32df0ba50", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/a56f56880d0a554d486a2a73087ea2b32df0ba50", "committedDate": "2020-12-03T06:32:28Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "821a66248ee48bbd25b6ff94a622d259e96fdfe5", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/821a66248ee48bbd25b6ff94a622d259e96fdfe5", "committedDate": "2020-12-09T12:00:06Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "821a66248ee48bbd25b6ff94a622d259e96fdfe5", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/821a66248ee48bbd25b6ff94a622d259e96fdfe5", "committedDate": "2020-12-09T12:00:06Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "5b7cfbb2f36360b7e1a189cfe5915156e26495d1", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/5b7cfbb2f36360b7e1a189cfe5915156e26495d1", "committedDate": "2020-12-09T13:46:42Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b7cfbb2f36360b7e1a189cfe5915156e26495d1", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/5b7cfbb2f36360b7e1a189cfe5915156e26495d1", "committedDate": "2020-12-09T13:46:42Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "669763803926cce4b50a3e8b0e5e05bf089c5406", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/669763803926cce4b50a3e8b0e5e05bf089c5406", "committedDate": "2020-12-11T15:19:08Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "669763803926cce4b50a3e8b0e5e05bf089c5406", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/669763803926cce4b50a3e8b0e5e05bf089c5406", "committedDate": "2020-12-11T15:19:08Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "0852721286b865f732167319a9a93e6c6f119714", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/0852721286b865f732167319a9a93e6c6f119714", "committedDate": "2020-12-11T15:27:55Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0852721286b865f732167319a9a93e6c6f119714", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/0852721286b865f732167319a9a93e6c6f119714", "committedDate": "2020-12-11T15:27:55Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "0ade0005c503cac350e5a2d3eb1f1f7558517956", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/0ade0005c503cac350e5a2d3eb1f1f7558517956", "committedDate": "2020-12-17T12:43:04Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0ade0005c503cac350e5a2d3eb1f1f7558517956", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/0ade0005c503cac350e5a2d3eb1f1f7558517956", "committedDate": "2020-12-17T12:43:04Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "f36a09ebea456190d1cdf6e416575f51e17e38bc", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/f36a09ebea456190d1cdf6e416575f51e17e38bc", "committedDate": "2020-12-21T19:52:52Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f36a09ebea456190d1cdf6e416575f51e17e38bc", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/f36a09ebea456190d1cdf6e416575f51e17e38bc", "committedDate": "2020-12-21T19:52:52Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "7f81dc1e17d7bff4b753514c27b95d8b35aa2213", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/7f81dc1e17d7bff4b753514c27b95d8b35aa2213", "committedDate": "2020-12-23T06:28:03Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f81dc1e17d7bff4b753514c27b95d8b35aa2213", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/7f81dc1e17d7bff4b753514c27b95d8b35aa2213", "committedDate": "2020-12-23T06:28:03Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "ea003ebd1d9619ccdc892b4eb4edd19b5d8c461e", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/ea003ebd1d9619ccdc892b4eb4edd19b5d8c461e", "committedDate": "2020-12-28T10:44:14Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea003ebd1d9619ccdc892b4eb4edd19b5d8c461e", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/ea003ebd1d9619ccdc892b4eb4edd19b5d8c461e", "committedDate": "2020-12-28T10:44:14Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "d969d67fff3957473a8f72925a9b10cb8aebf21b", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/d969d67fff3957473a8f72925a9b10cb8aebf21b", "committedDate": "2021-01-14T14:25:04Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d969d67fff3957473a8f72925a9b10cb8aebf21b", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/d969d67fff3957473a8f72925a9b10cb8aebf21b", "committedDate": "2021-01-14T14:25:04Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "25a689b2d1c289547648e56d4f6658a9a0c6b70a", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/25a689b2d1c289547648e56d4f6658a9a0c6b70a", "committedDate": "2021-01-20T13:18:06Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25a689b2d1c289547648e56d4f6658a9a0c6b70a", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/25a689b2d1c289547648e56d4f6658a9a0c6b70a", "committedDate": "2021-01-20T13:18:06Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "08dee2a6e7135c7ad76a4b610c1444f2216651e6", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/08dee2a6e7135c7ad76a4b610c1444f2216651e6", "committedDate": "2021-01-27T08:12:12Z", "message": "Zero-downtime switch manager"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc3MzA4MTg2", "url": "https://github.com/telstra/open-kilda/pull/3879#pullrequestreview-577308186", "createdAt": "2021-01-27T12:59:26Z", "commit": {"oid": "08dee2a6e7135c7ad76a4b610c1444f2216651e6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "08dee2a6e7135c7ad76a4b610c1444f2216651e6", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/08dee2a6e7135c7ad76a4b610c1444f2216651e6", "committedDate": "2021-01-27T08:12:12Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "committedDate": "2021-01-29T06:02:52Z", "message": "Zero-downtime switch manager"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc5OTU5MjEy", "url": "https://github.com/telstra/open-kilda/pull/3879#pullrequestreview-579959212", "createdAt": "2021-02-01T01:00:59Z", "commit": {"oid": "5862f71a800d7a0ae717512c4a5d0dfd0b850d83"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQwMTowMDo1OVrOIdOXLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQwMTowMDo1OVrOIdOXLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NzUxNDkyNw==", "bodyText": "Does it make sense to introduce a dedicated \"build\" method instead of repeating \"getZkTopoName(), getConfig().getBlueGreenMode()\" each time?", "url": "https://github.com/telstra/open-kilda/pull/3879#discussion_r567514927", "createdAt": "2021-02-01T01:00:59Z", "author": {"login": "sergii-iakovenko"}, "path": "src-java/swmanager-topology/swmanager-storm-topology/src/main/java/org/openkilda/wfm/topology/switchmanager/SwitchManagerTopology.java", "diffHunk": "@@ -85,22 +94,34 @@ public StormTopology createTopology() {\n                 .workerSpoutComponent(WORKER_SPOUT)\n                 .defaultTimeout((int) TimeUnit.SECONDS.toMillis(topologyConfig.getOperationTimeout()))\n                 .build();\n-        declareKafkaSpout(builder, topologyConfig.getKafkaSwitchManagerTopic(), WORKER_SPOUT);\n+        declareKafkaSpout(builder, topologyConfig.getKafkaSwitchManagerTopic(), WORKER_SPOUT,\n+                getZkTopoName(), getConfig().getBlueGreenMode());\n         declareBolt(builder, new SpeakerWorkerBolt(speakerWorkerConfig),\n                 SpeakerWorkerBolt.ID)\n                 .fieldsGrouping(WORKER_SPOUT, FIELDS_KEY)\n                 .fieldsGrouping(SwitchManagerHub.ID, SpeakerWorkerBolt.INCOME_STREAM, FIELDS_KEY)\n                 .directGrouping(CoordinatorBolt.ID);\n \n-        declareBolt(builder, buildKafkaBolt(topologyConfig.getKafkaNorthboundTopic()), NB_KAFKA_BOLT)\n+        declareBolt(builder, buildKafkaBolt(topologyConfig.getKafkaNorthboundTopic(),\n+                getZkTopoName(), getConfig().getBlueGreenMode()), NB_KAFKA_BOLT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5862f71a800d7a0ae717512c4a5d0dfd0b850d83"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c7e15895d1585570ac248a802d9efd52d16e32d", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/6c7e15895d1585570ac248a802d9efd52d16e32d", "committedDate": "2021-02-03T13:02:17Z", "message": "Zero-downtime switch manager"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/5862f71a800d7a0ae717512c4a5d0dfd0b850d83", "committedDate": "2021-01-29T06:02:52Z", "message": "Zero-downtime switch manager"}, "afterCommit": {"oid": "6c7e15895d1585570ac248a802d9efd52d16e32d", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/6c7e15895d1585570ac248a802d9efd52d16e32d", "committedDate": "2021-02-03T13:02:17Z", "message": "Zero-downtime switch manager"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgzNDk2NzU3", "url": "https://github.com/telstra/open-kilda/pull/3879#pullrequestreview-583496757", "createdAt": "2021-02-04T15:12:45Z", "commit": {"oid": "6c7e15895d1585570ac248a802d9efd52d16e32d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3778, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}