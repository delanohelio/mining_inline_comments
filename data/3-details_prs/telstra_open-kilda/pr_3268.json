{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NzM2NzA3", "number": 3268, "title": "Add ISL busy check when deleting ISL.", "bodyText": "added ISL busy check when deleting ISL;\nadded force flag for ISL delete operation.", "createdAt": "2020-03-06T10:09:28Z", "url": "https://github.com/telstra/open-kilda/pull/3268", "merged": true, "mergeCommit": {"oid": "b30360e25228c1774e6ebdf88c60ebfb5f6d76c7"}, "closed": true, "closedAt": "2020-04-27T12:03:02Z", "author": {"login": "dpoltavets"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMMCkBAFqTM3MTY5NTkwMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcax6egAFqTM5OTk2OTg2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjk1OTAx", "url": "https://github.com/telstra/open-kilda/pull/3268#pullrequestreview-371695901", "createdAt": "2020-03-10T05:54:50Z", "commit": {"oid": "b2149d77722119d2fc92c12b90fd3634f35e0edd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0OTc3NzM4", "url": "https://github.com/telstra/open-kilda/pull/3268#pullrequestreview-374977738", "createdAt": "2020-03-16T07:51:55Z", "commit": {"oid": "b2149d77722119d2fc92c12b90fd3634f35e0edd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzo1MTo1NVrOF2ozGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNzo1MTo1NVrOF2ozGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgzNTg2Ng==", "bodyText": "write unit tests for that", "url": "https://github.com/telstra/open-kilda/pull/3268#discussion_r392835866", "createdAt": "2020-03-16T07:51:55Z", "author": {"login": "timofei-durakov"}, "path": "src-java/nbworker-topology/nbworker-storm-topology/src/main/java/org/openkilda/wfm/topology/nbworker/services/LinkOperationsService.java", "diffHunk": "@@ -126,9 +130,18 @@ public LinkOperationsService(ILinkOperationsServiceCarrier carrier,\n             throw new IslNotFoundException(sourceSwitch, sourcePort, destinationSwitch, destinationPort);\n         }\n \n-        if (isls.stream().anyMatch(x -> x.getStatus() == IslStatus.ACTIVE)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2149d77722119d2fc92c12b90fd3634f35e0edd"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c73c62fec015334558cef0df19bb6d0bf59c1d29", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/c73c62fec015334558cef0df19bb6d0bf59c1d29", "committedDate": "2020-04-15T10:53:03Z", "message": "Added ISL busy check when deleting ISL."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2149d77722119d2fc92c12b90fd3634f35e0edd", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/b2149d77722119d2fc92c12b90fd3634f35e0edd", "committedDate": "2020-03-06T10:06:00Z", "message": "Added ISL busy check when deleting ISL."}, "afterCommit": {"oid": "c73c62fec015334558cef0df19bb6d0bf59c1d29", "author": {"user": {"login": "dpoltavets", "name": "Dmitriy Poltavets"}}, "url": "https://github.com/telstra/open-kilda/commit/c73c62fec015334558cef0df19bb6d0bf59c1d29", "committedDate": "2020-04-15T10:53:03Z", "message": "Added ISL busy check when deleting ISL."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MzYyNDkx", "url": "https://github.com/telstra/open-kilda/pull/3268#pullrequestreview-398362491", "createdAt": "2020-04-22T16:24:57Z", "commit": {"oid": "c73c62fec015334558cef0df19bb6d0bf59c1d29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5OTY5ODY0", "url": "https://github.com/telstra/open-kilda/pull/3268#pullrequestreview-399969864", "createdAt": "2020-04-24T13:57:13Z", "commit": {"oid": "c73c62fec015334558cef0df19bb6d0bf59c1d29"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMzo1NzoxM1rOGLY9fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMzo1NzoxM1rOGLY9fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDU5NjQ3OQ==", "bodyText": "nit: I'd implement new method to fetch ids, instead of full objects", "url": "https://github.com/telstra/open-kilda/pull/3268#discussion_r414596479", "createdAt": "2020-04-24T13:57:13Z", "author": {"login": "timofei-durakov"}, "path": "src-java/nbworker-topology/nbworker-storm-topology/src/main/java/org/openkilda/wfm/topology/nbworker/services/LinkOperationsService.java", "diffHunk": "@@ -126,9 +130,18 @@ public LinkOperationsService(ILinkOperationsServiceCarrier carrier,\n             throw new IslNotFoundException(sourceSwitch, sourcePort, destinationSwitch, destinationPort);\n         }\n \n-        if (isls.stream().anyMatch(x -> x.getStatus() == IslStatus.ACTIVE)) {\n-            throw new IllegalIslStateException(sourceSwitch, sourcePort, destinationSwitch, destinationPort,\n-                    \"ISL must NOT be in active state.\");\n+        if (!force) {\n+            if (isls.stream().anyMatch(x -> x.getStatus() == IslStatus.ACTIVE)) {\n+                throw new IllegalIslStateException(sourceSwitch, sourcePort, destinationSwitch, destinationPort,\n+                        \"ISL must NOT be in active state.\");\n+            }\n+\n+            Collection<FlowPath> flowPaths = flowPathRepository.findWithPathSegment(sourceSwitch, sourcePort,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c73c62fec015334558cef0df19bb6d0bf59c1d29"}, "originalPosition": 51}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3661, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}