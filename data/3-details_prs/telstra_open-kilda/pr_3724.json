{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NzU5NDE5", "number": 3724, "title": "[Server42] Stats app reconnecting", "bodyText": "", "createdAt": "2020-09-14T17:04:41Z", "url": "https://github.com/telstra/open-kilda/pull/3724", "merged": true, "mergeCommit": {"oid": "10ff17baaaeaee390870949507d01f957777792d"}, "closed": true, "closedAt": "2020-09-30T07:01:30Z", "author": {"login": "nikitamarchenko"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI2RLcAH2gAyNDg2NzU5NDE5OjQ4MzU2N2U4OGQwOTA4YzY0MWY1ZmZkZjZjN2U5MmMzNDY2ZWY0YmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNjzu3AFqTQ5ODIyMzkyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb", "author": {"user": {"login": "nikitamarchenko", "name": "Nikita Marchenko"}}, "url": "https://github.com/telstra/open-kilda/commit/483567e88d0908c641f5ffdf6c7e92c3466ef4bb", "committedDate": "2020-09-14T17:02:16Z", "message": "[Server42] Stats app reconnecting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNjAwODk4", "url": "https://github.com/telstra/open-kilda/pull/3724#pullrequestreview-490600898", "createdAt": "2020-09-17T13:35:13Z", "commit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MjEyNDg1", "url": "https://github.com/telstra/open-kilda/pull/3724#pullrequestreview-497212485", "createdAt": "2020-09-28T06:17:54Z", "commit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MTI4ODQy", "url": "https://github.com/telstra/open-kilda/pull/3724#pullrequestreview-498128842", "createdAt": "2020-09-29T06:25:31Z", "commit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjoyNTozMVrOHZcmfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNjoyNTozMVrOHZcmfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ0NTA1Mg==", "bodyText": "why is it break for EAGAIN?", "url": "https://github.com/telstra/open-kilda/pull/3724#discussion_r496445052", "createdAt": "2020-09-29T06:25:31Z", "author": {"login": "timofei-durakov"}, "path": "src-java/server42/server42-stats/src/main/java/org/openkilda/server42/stats/zeromq/StatsCollector.java", "diffHunk": "@@ -60,25 +73,33 @@ public void run() {\n         sessionId = RandomStringUtils.randomAlphanumeric(8);\n         log.info(\"started with session id {}\", sessionId);\n         while (!isInterrupted()) {\n-            try (ZContext context = new ZContext()) {\n-                Socket server = context.createSocket(ZMQ.PULL);\n-                try {\n-                    server.connect(connectEndpoint);\n-                    while (!isInterrupted()) {\n-                        byte[] recv = server.recv();\n-                        log.debug(\"stats recived\");\n-                        handleInput(recv);\n+            try (Socket server = context.createSocket(ZMQ.PULL)) {\n+                server.setReceiveTimeOut(1000);\n+                server.connect(connectEndpoint);\n+                log.info(\"connect to {}\", connectEndpoint);\n+                while (!isInterrupted()) {\n+                    byte[] recv = server.recv();\n+                    log.debug(\"recv {}\", recv);\n+                    if (recv == null && server.errno() == ZError.EAGAIN) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MTI5Njcz", "url": "https://github.com/telstra/open-kilda/pull/3724#pullrequestreview-498129673", "createdAt": "2020-09-29T06:27:04Z", "commit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MjIzOTIy", "url": "https://github.com/telstra/open-kilda/pull/3724#pullrequestreview-498223922", "createdAt": "2020-09-29T08:21:26Z", "commit": {"oid": "483567e88d0908c641f5ffdf6c7e92c3466ef4bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3563, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}