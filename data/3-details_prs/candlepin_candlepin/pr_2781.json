{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMTc4MDg4", "number": 2781, "title": "org_migrator to python 3 and pipenv", "bodyText": "I set up org_migrator yesterday in order to help research an incident. In the process I captured the dependencies of the script in a pipenv file and updated two lines so that this was python 3 compatible. I figured I would create a PR if anyone would like these changes.\nLet me know if I should squash or anything, happy to do so.\nThanks!", "createdAt": "2020-08-25T12:44:18Z", "url": "https://github.com/candlepin/candlepin/pull/2781", "merged": true, "mergeCommit": {"oid": "931b31b6928f979f66385b0d5b054f098bc9fd27"}, "closed": true, "closedAt": "2020-08-26T18:40:17Z", "author": {"login": "Tomboyo"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCYOoNgFqTQ3NDU0ODk2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCZahogFqTQ3NDYxNDU4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NTQ4OTYy", "url": "https://github.com/candlepin/candlepin/pull/2781#pullrequestreview-474548962", "createdAt": "2020-08-25T14:38:47Z", "commit": {"oid": "da71d30ab575b17106531c8f9b722f386093e79d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3635851cc48f23860f007c350ed13f3d9ab5bed", "author": {"user": null}, "url": "https://github.com/candlepin/candlepin/commit/b3635851cc48f23860f007c350ed13f3d9ab5bed", "committedDate": "2020-08-25T15:18:15Z", "message": "Migrate org_migrator to pipenv + python3"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da71d30ab575b17106531c8f9b722f386093e79d", "author": {"user": null}, "url": "https://github.com/candlepin/candlepin/commit/da71d30ab575b17106531c8f9b722f386093e79d", "committedDate": "2020-08-25T11:33:57Z", "message": "Ignore the export.zip file generated from running the migrator"}, "afterCommit": {"oid": "b3635851cc48f23860f007c350ed13f3d9ab5bed", "author": {"user": null}, "url": "https://github.com/candlepin/candlepin/commit/b3635851cc48f23860f007c350ed13f3d9ab5bed", "committedDate": "2020-08-25T15:18:15Z", "message": "Migrate org_migrator to pipenv + python3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NjE0NTg5", "url": "https://github.com/candlepin/candlepin/pull/2781#pullrequestreview-474614589", "createdAt": "2020-08-25T15:46:24Z", "commit": {"oid": "da71d30ab575b17106531c8f9b722f386093e79d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNTo0NjozNlrOHGeYMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNjowMDo1NVrOHGe-uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU1MTIxNg==", "bodyText": "We are still limited to Python2 in some environments, so this change can't go through. But we can make it compatible with python3 by changing it to:\nprint(\"Available orgs: %s\" % (list_orgs(db)))", "url": "https://github.com/candlepin/candlepin/pull/2781#discussion_r476551216", "createdAt": "2020-08-25T15:46:36Z", "author": {"login": "Ceiu"}, "path": "server/bin/org_migrator/org_migrator.py", "diffHunk": "@@ -926,7 +926,7 @@ def main():\n                 log.error(\"No such org: %s\", args[0])\n \n         elif options.act_list:\n-            print \"Available orgs: %s\" % (list_orgs(db))\n+            print(f\"Available orgs: {list_orgs(db)}\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3635851cc48f23860f007c350ed13f3d9ab5bed"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU2MTA4Mw==", "bodyText": "In line with the other Python2 compat change, can we keep the buffer type present? I've also added some warning output and a handler in the event the type isn't present:\n    def data_converter(obj):\n        if isinstance(obj, (bytearray, buffer, memoryview)):\n            return binascii.b2a_base64(obj)\n        if isinstance(obj, datetime.datetime):\n            return str(obj)\n\n        raise TypeError(\"Unexpected type: %s\" % (type(obj)))", "url": "https://github.com/candlepin/candlepin/pull/2781#discussion_r476561083", "createdAt": "2020-08-25T16:00:55Z", "author": {"login": "Ceiu"}, "path": "server/bin/org_migrator/org_migrator.py", "diffHunk": "@@ -64,7 +64,7 @@ def list_orgs(db):\n \n def jsonify(data):\n     def data_converter(obj):\n-        if isinstance(obj, bytearray) or isinstance(obj, buffer):\n+        if isinstance(obj, (bytearray, memoryview)):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3635851cc48f23860f007c350ed13f3d9ab5bed"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2301, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}