{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NTkwODE2", "number": 2590, "title": "[M] 1469259: validate hypervisor update json (ENT-530)", "bodyText": "", "createdAt": "2020-01-29T14:35:37Z", "url": "https://github.com/candlepin/candlepin/pull/2590", "merged": true, "mergeCommit": {"oid": "28b27f2bdcc5bce1e629b2db81d5d192edb3b763"}, "closed": true, "closedAt": "2020-01-31T08:06:03Z", "author": {"login": "abhiskum"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_Z-SQgFqTM1MDc5NTYwNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_c_L9gFqTM1MDk1NDAwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNzk1NjA1", "url": "https://github.com/candlepin/candlepin/pull/2590#pullrequestreview-350795605", "createdAt": "2020-01-30T12:47:05Z", "commit": {"oid": "6e83236c46720738cdbd4268422a3350fc9e224b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMjo0NzowNlrOFjpsMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMjo0NzowNlrOFjpsMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkyNzUzNg==", "bodyText": "Replacing the first assertion with this is ok, but we should probably not remove the other 2 assertions (with report {} and {hypervisors:[]}.", "url": "https://github.com/candlepin/candlepin/pull/2590#discussion_r372927536", "createdAt": "2020-01-30T12:47:06Z", "author": {"login": "nikosmoum"}, "path": "server/spec/hypervisor_check_in_spec.rb", "diffHunk": "@@ -1201,18 +1208,10 @@ def create_virtwho_client(user)\n         ],\n         \"facts\" => {\"test_fact\" => \"fact_value\" }\n     }\n-    job_detail = send_host_guest_mapping(owner, user, report.to_json())\n-    job_detail[\"state\"].should == \"FAILED\"\n-\n-    # empty json\n-    report = {}\n-    job_detail = send_host_guest_mapping(owner, user, report.to_json())\n-    job_detail[\"state\"].should == \"FAILED\"\n-\n-    # this is the correct version of an empy list of hypervisors\n-    report = {hypervisors:[]}\n-    job_detail = send_host_guest_mapping(owner, user, report.to_json())\n-    job_detail[\"state\"].should == \"FINISHED\"\n+    virtwho = create_virtwho_client(@user)\n+    lambda do\n+      virtwho.hypervisor_update(@owner['key'], report.to_json())\n+    end.should raise_exception(RestClient::BadRequest)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e83236c46720738cdbd4268422a3350fc9e224b"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "948b6153aa2cd245868c291fca1b5cd9a9a4138f", "author": {"user": {"login": "abhiskum", "name": "Abhishek Kumar"}}, "url": "https://github.com/candlepin/candlepin/commit/948b6153aa2cd245868c291fca1b5cd9a9a4138f", "committedDate": "2020-01-30T15:40:40Z", "message": "1469259: validate hypervisor update json"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e83236c46720738cdbd4268422a3350fc9e224b", "author": {"user": {"login": "abhiskum", "name": "Abhishek Kumar"}}, "url": "https://github.com/candlepin/candlepin/commit/6e83236c46720738cdbd4268422a3350fc9e224b", "committedDate": "2020-01-29T14:34:50Z", "message": "1469259: validate hypervisor update json"}, "afterCommit": {"oid": "948b6153aa2cd245868c291fca1b5cd9a9a4138f", "author": {"user": {"login": "abhiskum", "name": "Abhishek Kumar"}}, "url": "https://github.com/candlepin/candlepin/commit/948b6153aa2cd245868c291fca1b5cd9a9a4138f", "committedDate": "2020-01-30T15:40:40Z", "message": "1469259: validate hypervisor update json"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwOTM3ODgz", "url": "https://github.com/candlepin/candlepin/pull/2590#pullrequestreview-350937883", "createdAt": "2020-01-30T15:58:50Z", "commit": {"oid": "948b6153aa2cd245868c291fca1b5cd9a9a4138f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwOTU0MDA1", "url": "https://github.com/candlepin/candlepin/pull/2590#pullrequestreview-350954005", "createdAt": "2020-01-30T16:18:31Z", "commit": {"oid": "948b6153aa2cd245868c291fca1b5cd9a9a4138f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2477, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}