{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4MDM1MTc4", "number": 2730, "title": "[M] 1844243: Added Quartz trigger misfire logging (ENT-2479)", "bodyText": "The JobManager now logs Quartz trigger misfire events as they occur", "createdAt": "2020-06-22T15:56:00Z", "url": "https://github.com/candlepin/candlepin/pull/2730", "merged": true, "mergeCommit": {"oid": "dbe1e1024456325203c35c81b418f31cdc341433"}, "closed": true, "closedAt": "2020-06-23T13:12:32Z", "author": {"login": "Ceiu"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqou-mgH2gAyNDM4MDM1MTc4OjIxMTFmNDliZTY5NzMzNDc2YWRmNDM1MDJkYWI3NWNlYjk3OGY5YjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuFO1yAFqTQzNTc2NjEwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2111f49be69733476adf43502dab75ceb978f9b4", "author": {"user": {"login": "Ceiu", "name": "Chris \"Ceiu\" Rog"}}, "url": "https://github.com/candlepin/candlepin/commit/2111f49be69733476adf43502dab75ceb978f9b4", "committedDate": "2020-06-12T20:18:25Z", "message": "1844243: Added Quartz trigger misfire logging\n\n- The JobManager now logs Quartz trigger misfire events as they occur"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6ca83970e073ef7460eca48fc13ed7c3d466fd74", "author": {"user": {"login": "Ceiu", "name": "Chris \"Ceiu\" Rog"}}, "url": "https://github.com/candlepin/candlepin/commit/6ca83970e073ef7460eca48fc13ed7c3d466fd74", "committedDate": "2020-06-12T16:58:27Z", "message": "1844243: Added Quartz trigger misfire logging\n\n- The JobManager now logs Quartz trigger misfire events as they occur"}, "afterCommit": {"oid": "2111f49be69733476adf43502dab75ceb978f9b4", "author": {"user": {"login": "Ceiu", "name": "Chris \"Ceiu\" Rog"}}, "url": "https://github.com/candlepin/candlepin/commit/2111f49be69733476adf43502dab75ceb978f9b4", "committedDate": "2020-06-12T20:18:25Z", "message": "1844243: Added Quartz trigger misfire logging\n\n- The JobManager now logs Quartz trigger misfire events as they occur"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1Njk0NTQ5", "url": "https://github.com/candlepin/candlepin/pull/2730#pullrequestreview-435694549", "createdAt": "2020-06-23T11:37:06Z", "commit": {"oid": "2111f49be69733476adf43502dab75ceb978f9b4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxMTozNzowNlrOGnlL-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxMTozNzowNlrOGnlL-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE1NjkyMQ==", "bodyText": "Do you think we should add a condition to check if Candlepin is in SUSPEND mode and not allow job to be executed.", "url": "https://github.com/candlepin/candlepin/pull/2730#discussion_r444156921", "createdAt": "2020-06-23T11:37:06Z", "author": {"login": "wolfdale"}, "path": "server/src/main/java/org/candlepin/async/JobManager.java", "diffHunk": "@@ -168,6 +169,37 @@ public void execute(org.quartz.JobExecutionContext context) throws org.quartz.Jo\n                 throw new org.quartz.JobExecutionException(errmsg, e);\n             }\n         }\n+\n+        @Override\n+        public String getName() {\n+            return this.getClass().getSimpleName();\n+        }\n+\n+        @Override\n+        public void triggerComplete(Trigger trigger, org.quartz.JobExecutionContext context,\n+            Trigger.CompletedExecutionInstruction triggerInstructionCode) {\n+            // Intentionally left empty\n+        }\n+\n+        @Override\n+        public void triggerFired(Trigger trigger, org.quartz.JobExecutionContext context) {\n+            // Intentionally left empty\n+        }\n+\n+        @Override\n+        public void triggerMisfired(Trigger trigger) {\n+            String jobKey = trigger.getKey().getName();\n+\n+            log.warn(\"Trigger misfired for job: {} [start: {}, end: {}, next fire time: {}, \" +\n+                \"final fire time: {}, priority: {}, misfire instruction: {}]\",\n+                jobKey, trigger.getStartTime(), trigger.getEndTime(), trigger.getNextFireTime(),\n+                trigger.getFinalFireTime(), trigger.getPriority(), trigger.getMisfireInstruction());\n+        }\n+\n+        @Override\n+        public boolean vetoJobExecution(Trigger trigger, org.quartz.JobExecutionContext context) {\n+            return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2111f49be69733476adf43502dab75ceb978f9b4"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1NzY2MTA2", "url": "https://github.com/candlepin/candlepin/pull/2730#pullrequestreview-435766106", "createdAt": "2020-06-23T13:12:20Z", "commit": {"oid": "2111f49be69733476adf43502dab75ceb978f9b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2431, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}