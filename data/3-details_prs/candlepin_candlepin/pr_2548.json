{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MTM1NTU4", "number": 2548, "title": "Add spec-first build changes", "bodyText": "After this is in place, the process for porting a given resource or DTO to spec-first is:\n\nAdd the resource definition to api/candlepin-api-spec.yaml (editor.swagger.io works well for this).\nAdd any DTOs to api/candlepin-api-spec.yaml.\nChange the resource to implement the generated API interface.\nRemove all javax.ws.rs annotations from the resource implementation.\nRemove all io.swagger annotations from the resource implementation.\nRemove old DTOs from the codebase (refactor to use the generated ones instead).\nFix any broken code or tests.\nEnsure unit tests still pass and the resource still works.\nEnsure swagger.json is still generated and is equivalent.\n\nNote: After building, you can view generated code in api/build/generated/src/gen/java.", "createdAt": "2020-01-03T21:55:53Z", "url": "https://github.com/candlepin/candlepin/pull/2548", "merged": true, "mergeCommit": {"oid": "2d81541828c5d46cc55fbf1df0b6995c5feec425"}, "closed": true, "closedAt": "2020-01-13T19:09:40Z", "author": {"login": "kahowell"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb21mH9gH2gAyMzU5MTM1NTU4Ojg4NzQxMTAyNDQwNjk1ZWNlMWZlOWFkZDU1NGQzZDA3ODVlZGFiMmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6As09AFqTM0MjA0OTM5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b", "author": {"user": {"login": "kahowell", "name": "Kevin Howell"}}, "url": "https://github.com/candlepin/candlepin/commit/88741102440695ece1fe9add554d3d0785edab2b", "committedDate": "2020-01-03T21:53:27Z", "message": "Add spec-first build changes\n\nAfter this is in place, the process for porting a given resource or DTO\nto spec-first is:\n\n1. Add the resource definition to `api/candlepin-api-spec.yaml`\n(editor.swagger.io works well for this).\n2. Add any DTOs to `api/candlepin-api-spec.yaml`.\n3. Change the resource to implement the generated API interface.\n4. Remove all `javax.ws.rs` annotations from the resource\nimplementation.\n5. Remove all `io.swagger` annotations from the resource implementation.\n6. Remove old DTOs from the codebase (refactor to use the generated ones\ninstead).\n7. Fix any broken code or tests.\n8. Ensure unit tests still pass and the resource still works.\n9. Ensure swagger.json is still generated and is equivalent.\n\nNote: After building, you can view generated code in\n`api/build/generated/src/gen/java`."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4NzczMjgw", "url": "https://github.com/candlepin/candlepin/pull/2548#pullrequestreview-338773280", "createdAt": "2020-01-06T17:13:56Z", "commit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNzoxMzo1NlrOFajnyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNzoxNDo1M1rOFajpUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzM5MDkyMw==", "bodyText": "What are the implications of the package changing with API version differences? That is, how painful is it going to be if we change this to a v2 or some such in the future?", "url": "https://github.com/candlepin/candlepin/pull/2548#discussion_r363390923", "createdAt": "2020-01-06T17:13:56Z", "author": {"login": "Ceiu"}, "path": "api/candlepin-api-config.json", "diffHunk": "@@ -0,0 +1,8 @@\n+{\n+  \"modelPackage\": \"org.candlepin.dto.api.v1\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzM5MTMxMg==", "bodyText": "Is this for a generic, unhandled exception? Do more specific exceptions get their own entry in this area?", "url": "https://github.com/candlepin/candlepin/pull/2548#discussion_r363391312", "createdAt": "2020-01-06T17:14:53Z", "author": {"login": "Ceiu"}, "path": "api/candlepin-api-spec.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+openapi: 3.0.2\n+info:\n+  title: Candlepin\n+  description: Candlepin is a subscription management server written in Java. It helps with management of software subscriptions.\n+  version: 3.0.0-draft\n+\n+servers:\n+  - url: /candlepin\n+\n+security:\n+  - basicAuth: []\n+\n+paths: {}\n+\n+components:\n+  schemas:\n+    ExceptionMessage:\n+      description: An exception occurred", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMTM0Njcw", "url": "https://github.com/candlepin/candlepin/pull/2548#pullrequestreview-340134670", "createdAt": "2020-01-08T20:47:20Z", "commit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo0NzoyMFrOFbjY2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo0OTozM1rOFbjcOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQzNTY3NQ==", "bodyText": "We could always have two API specification files that generate to different package names.  That wouldn't be awesome, but that's one way we could manage a change to v2.", "url": "https://github.com/candlepin/candlepin/pull/2548#discussion_r364435675", "createdAt": "2020-01-08T20:47:20Z", "author": {"login": "awood"}, "path": "api/candlepin-api-config.json", "diffHunk": "@@ -0,0 +1,8 @@\n+{\n+  \"modelPackage\": \"org.candlepin.dto.api.v1\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzM5MDkyMw=="}, "originalCommit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQzNjUzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      generatePom: false\n          \n          \n            \n                      generatePom: false,\n          \n          \n            \n                      dateLibrary: \"java8\"\n          \n      \n    \n    \n  \n\nNot mandatory or anything, but helpful for future proofing", "url": "https://github.com/candlepin/candlepin/pull/2548#discussion_r364436539", "createdAt": "2020-01-08T20:49:33Z", "author": {"login": "awood"}, "path": "build.gradle", "diffHunk": "@@ -194,6 +211,74 @@ subprojects {\n     }\n }\n \n+project(\":api\") {\n+    apply plugin: \"org.openapi.generator\"\n+\n+    // This project should only contain generated code.  No point in running checkstyle\n+    checkstyle.sourceSets = []\n+\n+    ext {\n+        api_spec_path = \"${projectDir}/candlepin-api-spec.yaml\"\n+        config_file = \"${projectDir}/candlepin-api-config.json\"\n+    }\n+\n+    openApiGenerate {\n+      generatorName = \"jaxrs-spec\"\n+      inputSpec = api_spec_path\n+      configFile = config_file\n+      outputDir = \"$buildDir/generated\"\n+      configOptions = [\n+          interfaceOnly: true,\n+          generatePom: false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88741102440695ece1fe9add554d3d0785edab2b"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d45aa4a4df366c82fbfed1cd0dc3c10236c24b0c", "author": {"user": {"login": "kahowell", "name": "Kevin Howell"}}, "url": "https://github.com/candlepin/candlepin/commit/d45aa4a4df366c82fbfed1cd0dc3c10236c24b0c", "committedDate": "2020-01-10T18:27:47Z", "message": "Specify java8 date library in code gen"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDE2MzEy", "url": "https://github.com/candlepin/candlepin/pull/2548#pullrequestreview-341416312", "createdAt": "2020-01-10T20:53:55Z", "commit": {"oid": "d45aa4a4df366c82fbfed1cd0dc3c10236c24b0c"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMDQ5Mzk3", "url": "https://github.com/candlepin/candlepin/pull/2548#pullrequestreview-342049397", "createdAt": "2020-01-13T18:31:30Z", "commit": {"oid": "d45aa4a4df366c82fbfed1cd0dc3c10236c24b0c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2438, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}