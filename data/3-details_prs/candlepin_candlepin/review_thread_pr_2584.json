{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2OTIwMzM4", "number": 2584, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQyMDowMjo1MlrODamNQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNDoxODoxMlrODaw0FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MjE1NTUzOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/candlepin/dto/api/v1/CertificateSerialTranslator.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQyMDowMjo1MlrOFho-Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxNjowNDo0NFrOFiqzjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxODY2Mg==", "bodyText": "I wonder if it'd be worth the effort (and if it's even possible) to update the entities to use LocalDate as well. While this translation works, I don't know how keen I am to be doing that everywhere.", "url": "https://github.com/candlepin/candlepin/pull/2584#discussion_r370818662", "createdAt": "2020-01-24T20:02:52Z", "author": {"login": "Ceiu"}, "path": "server/src/main/java/org/candlepin/dto/api/v1/CertificateSerialTranslator.java", "diffHunk": "@@ -56,14 +61,26 @@ public CertificateSerialDTO populate(CertificateSerial source, CertificateSerial\n     @Override\n     public CertificateSerialDTO populate(ModelTranslator translator, CertificateSerial source,\n         CertificateSerialDTO dest) {\n+        if (source == null) {\n+            throw new IllegalArgumentException(\"source is null\");\n+        }\n \n-        dest = super.populate(translator, source, dest);\n+        if (dest == null) {\n+            throw new IllegalArgumentException(\"dest is null\");\n+        }\n \n-        dest.setId(source.getId() == null ? null : source.getId().toString());\n-        dest.setSerial(source.getSerial() == null ? null : source.getSerial().toString());\n-        dest.setExpiration(source.getExpiration());\n-        dest.setCollected(source.isCollected());\n-        dest.setRevoked(source.isRevoked());\n+        Date created = source.getCreated();\n+        dest.setCreated(created != null ?  Instant.ofEpochMilli(created.getTime()).atZone(ZoneId.systemDefault()).toLocalDate(): null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f68ec46c4857a5b4672339669a67b41655a45ad9"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5NTY4NQ==", "bodyText": "I tried looking into changing CertificateSerial.java's expiration field from Date to OffsetDateTime.\nWe would need to change our CertificateSerialInfo Adapter inferface to support OffsetDateTime too, which would also force us to change the manifest CertificateSerialDTO to use it too, and this whole thing suddenly cascades wildly. Basically, if we change our model Dates to OffsetDateTimes, the Dates on the *Info would all also need to change. Not only that, but Date is basically used all across the codebase, so if we start changing those on the models, we'd have to change them everywhere (including model unit tests).\nCompared to all that, doing these conversions in translators only (and translator tests), is a good price to pay. So I'd vote to not do that. If we were going to do it though, it would probably have to be a massive effort, which I'd prefer be done separately alltogether from this epic (probably another epic).", "url": "https://github.com/candlepin/candlepin/pull/2584#discussion_r371895685", "createdAt": "2020-01-28T16:02:21Z", "author": {"login": "nikosmoum"}, "path": "server/src/main/java/org/candlepin/dto/api/v1/CertificateSerialTranslator.java", "diffHunk": "@@ -56,14 +61,26 @@ public CertificateSerialDTO populate(CertificateSerial source, CertificateSerial\n     @Override\n     public CertificateSerialDTO populate(ModelTranslator translator, CertificateSerial source,\n         CertificateSerialDTO dest) {\n+        if (source == null) {\n+            throw new IllegalArgumentException(\"source is null\");\n+        }\n \n-        dest = super.populate(translator, source, dest);\n+        if (dest == null) {\n+            throw new IllegalArgumentException(\"dest is null\");\n+        }\n \n-        dest.setId(source.getId() == null ? null : source.getId().toString());\n-        dest.setSerial(source.getSerial() == null ? null : source.getSerial().toString());\n-        dest.setExpiration(source.getExpiration());\n-        dest.setCollected(source.isCollected());\n-        dest.setRevoked(source.isRevoked());\n+        Date created = source.getCreated();\n+        dest.setCreated(created != null ?  Instant.ofEpochMilli(created.getTime()).atZone(ZoneId.systemDefault()).toLocalDate(): null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxODY2Mg=="}, "originalCommit": {"oid": "f68ec46c4857a5b4672339669a67b41655a45ad9"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5NzIzMA==", "bodyText": "Yikes, alright then.\nWe probably should switch to the java.time package eventually, but if it's going to be such a massive undertaking, then I agree that this PR is not the place for it.", "url": "https://github.com/candlepin/candlepin/pull/2584#discussion_r371897230", "createdAt": "2020-01-28T16:04:44Z", "author": {"login": "Ceiu"}, "path": "server/src/main/java/org/candlepin/dto/api/v1/CertificateSerialTranslator.java", "diffHunk": "@@ -56,14 +61,26 @@ public CertificateSerialDTO populate(CertificateSerial source, CertificateSerial\n     @Override\n     public CertificateSerialDTO populate(ModelTranslator translator, CertificateSerial source,\n         CertificateSerialDTO dest) {\n+        if (source == null) {\n+            throw new IllegalArgumentException(\"source is null\");\n+        }\n \n-        dest = super.populate(translator, source, dest);\n+        if (dest == null) {\n+            throw new IllegalArgumentException(\"dest is null\");\n+        }\n \n-        dest.setId(source.getId() == null ? null : source.getId().toString());\n-        dest.setSerial(source.getSerial() == null ? null : source.getSerial().toString());\n-        dest.setExpiration(source.getExpiration());\n-        dest.setCollected(source.isCollected());\n-        dest.setRevoked(source.isRevoked());\n+        Date created = source.getCreated();\n+        dest.setCreated(created != null ?  Instant.ofEpochMilli(created.getTime()).atZone(ZoneId.systemDefault()).toLocalDate(): null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxODY2Mg=="}, "originalCommit": {"oid": "f68ec46c4857a5b4672339669a67b41655a45ad9"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5Mzg5MzMzOnYy", "diffSide": "RIGHT", "path": "api/candlepin-api-config.json", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNDoxODoxMlrOFh3u_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNDoyNTo1OVrOFiEcDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2MDQ3OA==", "bodyText": "@kahowell @nikosmoum\nIf I remember correctly @kahowell mentioned that dateLibrary value set at openApiGenerate section in build.gradle.\nDo we need this here also?", "url": "https://github.com/candlepin/candlepin/pull/2584#discussion_r371060478", "createdAt": "2020-01-27T04:18:12Z", "author": {"login": "abhiskum"}, "path": "api/candlepin-api-config.json", "diffHunk": "@@ -4,5 +4,6 @@\n   \"invokerPackage\": \"org.candlepin\",\n   \"groupId\": \"org.candlepin\",\n   \"artifactId\": \"candlepin-api\",\n-  \"java8\": true\n+  \"java8\": true,\n+  \"dateLibrary\": \"java8\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f68ec46c4857a5b4672339669a67b41655a45ad9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI2ODYyMw==", "bodyText": "You are right, this is not needed here, so I'll remove it.", "url": "https://github.com/candlepin/candlepin/pull/2584#discussion_r371268623", "createdAt": "2020-01-27T14:25:59Z", "author": {"login": "nikosmoum"}, "path": "api/candlepin-api-config.json", "diffHunk": "@@ -4,5 +4,6 @@\n   \"invokerPackage\": \"org.candlepin\",\n   \"groupId\": \"org.candlepin\",\n   \"artifactId\": \"candlepin-api\",\n-  \"java8\": true\n+  \"java8\": true,\n+  \"dateLibrary\": \"java8\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2MDQ3OA=="}, "originalCommit": {"oid": "f68ec46c4857a5b4672339669a67b41655a45ad9"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4267, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}