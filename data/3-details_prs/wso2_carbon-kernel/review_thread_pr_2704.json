{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NDE0NzUw", "number": 2704, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzoxNzoxNVrOEHanyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwOTowNjoyNlrOEKbaqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjExNjU3OnYy", "diffSide": "RIGHT", "path": "distribution/kernel/carbon-home/dbscripts/db2.sql", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzoxNzoxNVrOGmw0IQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODo1NzozM1rOGrdJ4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ==", "bodyText": "We will have to look at execution plans and add necessary indexes and all for optimization.\nPlease create a task to track such and attend", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r443298849", "createdAt": "2020-06-22T03:17:15Z", "author": {"login": "malithie"}, "path": "distribution/kernel/carbon-home/dbscripts/db2.sql", "diffHunk": "@@ -796,6 +796,17 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n     PRIMARY KEY(UM_ID,UM_TENANT_ID)\n )/\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+    UM_ID DECIMAL(31,0) NOT NULL,\n+    UM_GROUP_NAME VARCHAR(255) NOT NULL,\n+    UM_ROLE_ID DECIMAL(31,0) NOT NULL,\n+    UM_TENANT_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UM_DOMAIN_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UNIQUE(UM_GROUP_NAME,UM_ROLE_ID,UM_TENANT_ID),\n+    FOREIGN KEY(UM_ROLE_ID,UM_TENANT_ID) REFERENCES UM_HYBRID_ROLE(UM_ID,UM_TENANT_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(UM_ID,UM_TENANT_ID)\n+)/\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ece06730d4254e78e19e1e62f29dbae41bb2f6b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE5ODk4OA==", "bodyText": "Created a task wso2/product-is#8595", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448198988", "createdAt": "2020-07-01T08:22:24Z", "author": {"login": "ashensw"}, "path": "distribution/kernel/carbon-home/dbscripts/db2.sql", "diffHunk": "@@ -796,6 +796,17 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n     PRIMARY KEY(UM_ID,UM_TENANT_ID)\n )/\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+    UM_ID DECIMAL(31,0) NOT NULL,\n+    UM_GROUP_NAME VARCHAR(255) NOT NULL,\n+    UM_ROLE_ID DECIMAL(31,0) NOT NULL,\n+    UM_TENANT_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UM_DOMAIN_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UNIQUE(UM_GROUP_NAME,UM_ROLE_ID,UM_TENANT_ID),\n+    FOREIGN KEY(UM_ROLE_ID,UM_TENANT_ID) REFERENCES UM_HYBRID_ROLE(UM_ID,UM_TENANT_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(UM_ID,UM_TENANT_ID)\n+)/\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ=="}, "originalCommit": {"oid": "8ece06730d4254e78e19e1e62f29dbae41bb2f6b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMTc3NQ==", "bodyText": "I think we need to write a trigger to implement auto-generated ID for UM_ID column similar to what we have done in UM_HYBRID_ROLE_TR1", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448211775", "createdAt": "2020-07-01T08:44:09Z", "author": {"login": "mefarazath"}, "path": "distribution/kernel/carbon-home/dbscripts/db2.sql", "diffHunk": "@@ -796,6 +796,17 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n     PRIMARY KEY(UM_ID,UM_TENANT_ID)\n )/\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+    UM_ID DECIMAL(31,0) NOT NULL,\n+    UM_GROUP_NAME VARCHAR(255) NOT NULL,\n+    UM_ROLE_ID DECIMAL(31,0) NOT NULL,\n+    UM_TENANT_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UM_DOMAIN_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UNIQUE(UM_GROUP_NAME,UM_ROLE_ID,UM_TENANT_ID),\n+    FOREIGN KEY(UM_ROLE_ID,UM_TENANT_ID) REFERENCES UM_HYBRID_ROLE(UM_ID,UM_TENANT_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(UM_ID,UM_TENANT_ID)\n+)/\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ=="}, "originalCommit": {"oid": "8ece06730d4254e78e19e1e62f29dbae41bb2f6b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxOTYxOA==", "bodyText": "Fixed and updated the PR.", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448219618", "createdAt": "2020-07-01T08:57:33Z", "author": {"login": "ashensw"}, "path": "distribution/kernel/carbon-home/dbscripts/db2.sql", "diffHunk": "@@ -796,6 +796,17 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n     PRIMARY KEY(UM_ID,UM_TENANT_ID)\n )/\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+    UM_ID DECIMAL(31,0) NOT NULL,\n+    UM_GROUP_NAME VARCHAR(255) NOT NULL,\n+    UM_ROLE_ID DECIMAL(31,0) NOT NULL,\n+    UM_TENANT_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UM_DOMAIN_ID DECIMAL(31,0) DEFAULT 0 NOT NULL,\n+    UNIQUE(UM_GROUP_NAME,UM_ROLE_ID,UM_TENANT_ID),\n+    FOREIGN KEY(UM_ROLE_ID,UM_TENANT_ID) REFERENCES UM_HYBRID_ROLE(UM_ID,UM_TENANT_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(UM_ID,UM_TENANT_ID)\n+)/\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5ODg0OQ=="}, "originalCommit": {"oid": "8ece06730d4254e78e19e1e62f29dbae41bb2f6b"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MzcwNDA5OnYy", "diffSide": "RIGHT", "path": "distribution/kernel/carbon-home/dbscripts/mysql_cluster.sql", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwOTowNjoyNlrOGrddnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNTo0Mjo0MFrOGrrZPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIyNDY3MQ==", "bodyText": "Any specific reason why we don't have foreign key references in this table?", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448224671", "createdAt": "2020-07-01T09:06:26Z", "author": {"login": "mefarazath"}, "path": "distribution/kernel/carbon-home/dbscripts/mysql_cluster.sql", "diffHunk": "@@ -393,6 +393,16 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n             PRIMARY KEY (UM_ID, UM_TENANT_ID)\n )ENGINE NDB;\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+            UM_ID INTEGER NOT NULL AUTO_INCREMENT,\n+            UM_GROUP_NAME VARCHAR(255),\n+            UM_ROLE_ID INTEGER NOT NULL,\n+            UM_TENANT_ID INTEGER DEFAULT 0,\n+            UM_DOMAIN_ID INTEGER,\n+            UNIQUE (UM_GROUP_NAME, UM_ROLE_ID, UM_TENANT_ID, UM_DOMAIN_ID),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b205ade8db7d1e0f281db1a0630a72d1ae94a72f"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ1MjkyNg==", "bodyText": "Added foreign keys for both UM_HYBRID_USER_ROLE and UM_HYBRID_GROUP_ROLE.", "url": "https://github.com/wso2/carbon-kernel/pull/2704#discussion_r448452926", "createdAt": "2020-07-01T15:42:40Z", "author": {"login": "ashensw"}, "path": "distribution/kernel/carbon-home/dbscripts/mysql_cluster.sql", "diffHunk": "@@ -393,6 +393,16 @@ CREATE TABLE UM_HYBRID_USER_ROLE(\n             PRIMARY KEY (UM_ID, UM_TENANT_ID)\n )ENGINE NDB;\n \n+CREATE TABLE UM_HYBRID_GROUP_ROLE(\n+            UM_ID INTEGER NOT NULL AUTO_INCREMENT,\n+            UM_GROUP_NAME VARCHAR(255),\n+            UM_ROLE_ID INTEGER NOT NULL,\n+            UM_TENANT_ID INTEGER DEFAULT 0,\n+            UM_DOMAIN_ID INTEGER,\n+            UNIQUE (UM_GROUP_NAME, UM_ROLE_ID, UM_TENANT_ID, UM_DOMAIN_ID),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIyNDY3MQ=="}, "originalCommit": {"oid": "b205ade8db7d1e0f281db1a0630a72d1ae94a72f"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2125, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}