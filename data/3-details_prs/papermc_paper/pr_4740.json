{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3MDQ5ODk2", "number": 4740, "title": "Item no age & no player pickup", "bodyText": "Fixes #4674", "createdAt": "2020-11-07T01:24:36Z", "url": "https://github.com/PaperMC/Paper/pull/4740", "merged": true, "mergeCommit": {"oid": "068313fa2e19e530bda6177fda27144c09184b31"}, "closed": true, "closedAt": "2020-11-11T17:35:08Z", "author": {"login": "alfiejfs"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdaG3g8AFqTUyNTYzNjE1Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbhdt5gFqTUyODM4ODY1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NjM2MTU2", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-525636156", "createdAt": "2020-11-07T07:57:31Z", "commit": {"oid": "30df9ea8abcd7921bdb9d5119523c1a3f57aa505"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwNzo1NzozMlrOHvGZwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwNzo1OTowNFrOHvGaJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE1MDAxOA==", "bodyText": "Why not use constants here?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +    private final static int noAgeTime = -32768;\n          \n          \n            \n            +    private final static int noAgeTime = (int) Short.MIN_VALUE;", "url": "https://github.com/PaperMC/Paper/pull/4740#discussion_r519150018", "createdAt": "2020-11-07T07:57:32Z", "author": {"login": "Proximyst"}, "path": "Spigot-Server-Patches/0594-Item-no-age-no-player-pickup.patch", "diffHunk": "@@ -0,0 +1,50 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Alfie Smith <alfie@alfiesmith.net>\n+Date: Sat, 7 Nov 2020 01:20:33 +0000\n+Subject: [PATCH] Item no age & no player pickup\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+index d6a64e4ecf9225f9a93523c50b2f1375296b406e..f34cfc5695c88754d7b78f49be282fb125a1cf94 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n++++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+@@ -10,6 +10,12 @@ import org.bukkit.entity.Item;\n+ import org.bukkit.inventory.ItemStack;\n+ \n+ public class CraftItem extends CraftEntity implements Item {\n++\n++    // Paper start\n++    private final static int noAgeTime = -32768;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30df9ea8abcd7921bdb9d5119523c1a3f57aa505"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE1MDAzOA==", "bodyText": "Why not use constants here?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +    private final static int noPickupTime = 32767;\n          \n          \n            \n            +    private final static int noPickupTime = (int) Short.MAX_VALUE;", "url": "https://github.com/PaperMC/Paper/pull/4740#discussion_r519150038", "createdAt": "2020-11-07T07:57:53Z", "author": {"login": "Proximyst"}, "path": "Spigot-Server-Patches/0594-Item-no-age-no-player-pickup.patch", "diffHunk": "@@ -0,0 +1,50 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Alfie Smith <alfie@alfiesmith.net>\n+Date: Sat, 7 Nov 2020 01:20:33 +0000\n+Subject: [PATCH] Item no age & no player pickup\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+index d6a64e4ecf9225f9a93523c50b2f1375296b406e..f34cfc5695c88754d7b78f49be282fb125a1cf94 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n++++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+@@ -10,6 +10,12 @@ import org.bukkit.entity.Item;\n+ import org.bukkit.inventory.ItemStack;\n+ \n+ public class CraftItem extends CraftEntity implements Item {\n++\n++    // Paper start\n++    private final static int noAgeTime = -32768;\n++    private final static int noPickupTime = 32767;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30df9ea8abcd7921bdb9d5119523c1a3f57aa505"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE1MDA4Mw==", "bodyText": "Isn't this modified every tick to account for specifically ageing?", "url": "https://github.com/PaperMC/Paper/pull/4740#discussion_r519150083", "createdAt": "2020-11-07T07:58:41Z", "author": {"login": "Proximyst"}, "path": "Spigot-Server-Patches/0594-Item-no-age-no-player-pickup.patch", "diffHunk": "@@ -0,0 +1,50 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Alfie Smith <alfie@alfiesmith.net>\n+Date: Sat, 7 Nov 2020 01:20:33 +0000\n+Subject: [PATCH] Item no age & no player pickup\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+index d6a64e4ecf9225f9a93523c50b2f1375296b406e..f34cfc5695c88754d7b78f49be282fb125a1cf94 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n++++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+@@ -10,6 +10,12 @@ import org.bukkit.entity.Item;\n+ import org.bukkit.inventory.ItemStack;\n+ \n+ public class CraftItem extends CraftEntity implements Item {\n++\n++    // Paper start\n++    private final static int noAgeTime = -32768;\n++    private final static int noPickupTime = 32767;\n++    // Paper end\n++\n+     private final EntityItem item;\n+ \n+     public CraftItem(CraftServer server, Entity entity, EntityItem item) {\n+@@ -57,6 +63,26 @@ public class CraftItem extends CraftEntity implements Item {\n+     public void setCanMobPickup(boolean canMobPickup) {\n+         item.canMobPickup = canMobPickup;\n+     }\n++\n++     @Override\n++     public boolean canPlayerPickup() {\n++        return item.pickupDelay == noPickupTime;\n++     }\n++\n++     @Override\n++     public void setCanPlayerPickup(boolean noPickup) {\n++        item.pickupDelay = noPickup ? noPickupTime : 0;\n++     }\n++\n++     @Override\n++     public boolean isAgeing() {\n++        return item.age == noAgeTime;\n++     }\n++\n++     @Override\n++     public void setAgeing(boolean ageing) {\n++        item.age = ageing ? 0 : noAgeTime;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30df9ea8abcd7921bdb9d5119523c1a3f57aa505"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE1MDExOA==", "bodyText": "See comment on setAgeing", "url": "https://github.com/PaperMC/Paper/pull/4740#discussion_r519150118", "createdAt": "2020-11-07T07:59:04Z", "author": {"login": "Proximyst"}, "path": "Spigot-Server-Patches/0594-Item-no-age-no-player-pickup.patch", "diffHunk": "@@ -0,0 +1,50 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Alfie Smith <alfie@alfiesmith.net>\n+Date: Sat, 7 Nov 2020 01:20:33 +0000\n+Subject: [PATCH] Item no age & no player pickup\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+index d6a64e4ecf9225f9a93523c50b2f1375296b406e..f34cfc5695c88754d7b78f49be282fb125a1cf94 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n++++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftItem.java\n+@@ -10,6 +10,12 @@ import org.bukkit.entity.Item;\n+ import org.bukkit.inventory.ItemStack;\n+ \n+ public class CraftItem extends CraftEntity implements Item {\n++\n++    // Paper start\n++    private final static int noAgeTime = -32768;\n++    private final static int noPickupTime = 32767;\n++    // Paper end\n++\n+     private final EntityItem item;\n+ \n+     public CraftItem(CraftServer server, Entity entity, EntityItem item) {\n+@@ -57,6 +63,26 @@ public class CraftItem extends CraftEntity implements Item {\n+     public void setCanMobPickup(boolean canMobPickup) {\n+         item.canMobPickup = canMobPickup;\n+     }\n++\n++     @Override\n++     public boolean canPlayerPickup() {\n++        return item.pickupDelay == noPickupTime;\n++     }\n++\n++     @Override\n++     public void setCanPlayerPickup(boolean noPickup) {\n++        item.pickupDelay = noPickup ? noPickupTime : 0;\n++     }\n++\n++     @Override\n++     public boolean isAgeing() {\n++        return item.age == noAgeTime;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30df9ea8abcd7921bdb9d5119523c1a3f57aa505"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2Njc0Nzk0", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-526674794", "createdAt": "2020-11-09T21:37:49Z", "commit": {"oid": "2480a0080356a54591635dcb3ace7c92f1abdb65"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2OTQ3Nzc0", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-526947774", "createdAt": "2020-11-10T08:12:51Z", "commit": {"oid": "2480a0080356a54591635dcb3ace7c92f1abdb65"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwODoxMjo1MVrOHwQlzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwODoxMjo1MVrOHwQlzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDM2NTUxNg==", "bodyText": "why is the var name negated here? this is rather confusing, if I want canPlayerPickup to return false, do I have to set noPickup to true? (would be inverted logic)\nlooking at the impl, there seems to be smth wrong, \"return item.pickupDelay == noPickupTime;\" would return true if a player can't pickup the item?\nidk, maybe its just early morning mini logic, but something seems off, maybe others can take a look", "url": "https://github.com/PaperMC/Paper/pull/4740#discussion_r520365516", "createdAt": "2020-11-10T08:12:51Z", "author": {"login": "MiniDigger"}, "path": "Spigot-API-Patches/0232-Item-no-age-no-player-pickup.patch", "diffHunk": "@@ -0,0 +1,45 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Alfie Smith <alfie@alfiesmith.net>\n+Date: Sat, 7 Nov 2020 01:20:27 +0000\n+Subject: [PATCH] Item no age & no player pickup\n+\n+\n+diff --git a/src/main/java/org/bukkit/entity/Item.java b/src/main/java/org/bukkit/entity/Item.java\n+index c404a5b8efea7c780db5ddae19456753808abb3d..5acbe1504fcdb93540acde0dcb00a9a6362dfc1e 100644\n+--- a/src/main/java/org/bukkit/entity/Item.java\n++++ b/src/main/java/org/bukkit/entity/Item.java\n+@@ -90,5 +90,34 @@ public interface Item extends Entity {\n+      * @param canMobPickup True to allow non-player entity pickup\n+      */\n+     public void setCanMobPickup(boolean canMobPickup);\n++\n++    /**\n++     * Gets whether the player can pickup the item or not\n++     *\n++     * @return whether a player can pickup the item\n++     */\n++    public boolean canPlayerPickup();\n++\n++    /**\n++     * Sets whether the item can be picked up or not. Modifies the pickup delay value to do so.\n++     *\n++     * @param noPickup Whether the item should be able to be picked up\n++     */\n++    public void setCanPlayerPickup(boolean noPickup);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2480a0080356a54591635dcb3ace7c92f1abdb65"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3OTkyMTg2", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-527992186", "createdAt": "2020-11-11T09:15:25Z", "commit": {"oid": "d13ada4d2219524a4adb49dab1653c806df8a605"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3OTkzNDE1", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-527993415", "createdAt": "2020-11-11T09:17:00Z", "commit": {"oid": "d13ada4d2219524a4adb49dab1653c806df8a605"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MzMwMzYw", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-528330360", "createdAt": "2020-11-11T16:26:40Z", "commit": {"oid": "d13ada4d2219524a4adb49dab1653c806df8a605"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "322d50ed40f3bd840699a06aaa7849f67d41f9f5", "author": {"user": {"login": "alfiejfs", "name": "Alfie Smith"}}, "url": "https://github.com/PaperMC/Paper/commit/322d50ed40f3bd840699a06aaa7849f67d41f9f5", "committedDate": "2020-11-11T17:31:35Z", "message": "Item no age & no player pickup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4Mzg4NjU2", "url": "https://github.com/PaperMC/Paper/pull/4740#pullrequestreview-528388656", "createdAt": "2020-11-11T17:32:31Z", "commit": {"oid": "322d50ed40f3bd840699a06aaa7849f67d41f9f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1471, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}