{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MzcwNjQ4", "number": 4614, "title": "EntityMoveEvent", "bodyText": "Adds the dreaded EntityMoveEvent everyone's been asking for since 2010.\nDont worry, the object creation is behind a handler size check. It will only create the event object if there is at least 1 listener to the event ;)", "createdAt": "2020-10-04T03:45:05Z", "url": "https://github.com/PaperMC/Paper/pull/4614", "merged": true, "mergeCommit": {"oid": "d9f5f7018837eeb8b3974252711949baa2230ecb"}, "closed": true, "closedAt": "2021-01-28T19:26:20Z", "author": {"login": "BillyGalbreath"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPHFtKAFqTUwMTU4OTAwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABd0XJzIgFqTU3Nzc4MjI1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNTg5MDA0", "url": "https://github.com/PaperMC/Paper/pull/4614#pullrequestreview-501589004", "createdAt": "2020-10-04T04:01:34Z", "commit": {"oid": "35a67019d79b477e2c9cea3f62e72f36c6191bf4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwNDowMTozNFrOHcE9Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwNDowMTozNFrOHcE9Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTIwMzM5NQ==", "bodyText": "this should be cached so JIT can optimize this out. These method calls aren't simple getters.", "url": "https://github.com/PaperMC/Paper/pull/4614#discussion_r499203395", "createdAt": "2020-10-04T04:01:34Z", "author": {"login": "aikar"}, "path": "Spigot-Server-Patches/0582-EntityMoveEvent.patch", "diffHunk": "@@ -0,0 +1,31 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: William Blake Galbreath <Blake.Galbreath@GMail.com>\n+Date: Tue, 11 Feb 2020 21:56:48 -0600\n+Subject: [PATCH] EntityMoveEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/EntityLiving.java b/src/main/java/net/minecraft/server/EntityLiving.java\n+index 76185f042dd773f267dc7574116cec7bd8a28ca8..399e4a67ca2433b4120dbfb5739730d1486ebb94 100644\n+--- a/src/main/java/net/minecraft/server/EntityLiving.java\n++++ b/src/main/java/net/minecraft/server/EntityLiving.java\n+@@ -2801,6 +2801,20 @@ public abstract class EntityLiving extends Entity {\n+ \n+         this.collideNearby();\n+         this.world.getMethodProfiler().exit();\n++        // Paper start\n++        if (com.destroystokyo.paper.event.entity.EntityMoveEvent.getHandlerList().getRegisteredListeners().length > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35a67019d79b477e2c9cea3f62e72f36c6191bf4"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNTk5MzA5", "url": "https://github.com/PaperMC/Paper/pull/4614#pullrequestreview-501599309", "createdAt": "2020-10-04T07:51:32Z", "commit": {"oid": "5e113f62d5e6edd91e0cbf5642ed4491d7b096e1"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwNzo1MTozMlrOHcFyRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwNzo1MTozMlrOHcFyRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTIxNjk2NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +package com.destroystokyo.paper.event.entity;\n          \n          \n            \n            +package io.papermc.paper.event.entity;", "url": "https://github.com/PaperMC/Paper/pull/4614#discussion_r499216964", "createdAt": "2020-10-04T07:51:32Z", "author": {"login": "Proximyst"}, "path": "Spigot-API-Patches/0228-EntityMoveEvent.patch", "diffHunk": "@@ -0,0 +1,107 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: William Blake Galbreath <Blake.Galbreath@GMail.com>\n+Date: Tue, 11 Feb 2020 21:56:38 -0600\n+Subject: [PATCH] EntityMoveEvent\n+\n+\n+diff --git a/src/main/java/com/destroystokyo/paper/event/entity/EntityMoveEvent.java b/src/main/java/com/destroystokyo/paper/event/entity/EntityMoveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..87fb271141a9604d879455f029d5cc009637afe3\n+--- /dev/null\n++++ b/src/main/java/com/destroystokyo/paper/event/entity/EntityMoveEvent.java\n+@@ -0,0 +1,95 @@\n++package com.destroystokyo.paper.event.entity;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e113f62d5e6edd91e0cbf5642ed4491d7b096e1"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNjAyMTM3", "url": "https://github.com/PaperMC/Paper/pull/4614#pullrequestreview-501602137", "createdAt": "2020-10-04T08:35:33Z", "commit": {"oid": "5e113f62d5e6edd91e0cbf5642ed4491d7b096e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwODozNTozNFrOHcF_2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQwODozNTozNFrOHcF_2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTIyMDQ0MA==", "bodyText": "shouldn't you use event.getTo() here?", "url": "https://github.com/PaperMC/Paper/pull/4614#discussion_r499220440", "createdAt": "2020-10-04T08:35:34Z", "author": {"login": "MrIvanPlays"}, "path": "Spigot-Server-Patches/0582-EntityMoveEvent.patch", "diffHunk": "@@ -0,0 +1,55 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: William Blake Galbreath <Blake.Galbreath@GMail.com>\n+Date: Tue, 11 Feb 2020 21:56:48 -0600\n+Subject: [PATCH] EntityMoveEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/EntityLiving.java b/src/main/java/net/minecraft/server/EntityLiving.java\n+index 76185f042dd773f267dc7574116cec7bd8a28ca8..5cc3ea591689e02a38546ef29fe2496590ca8155 100644\n+--- a/src/main/java/net/minecraft/server/EntityLiving.java\n++++ b/src/main/java/net/minecraft/server/EntityLiving.java\n+@@ -2801,6 +2801,20 @@ public abstract class EntityLiving extends Entity {\n+ \n+         this.collideNearby();\n+         this.world.getMethodProfiler().exit();\n++        // Paper start\n++        if (((WorldServer) world).hasEntityMoveEvent) {\n++            if (lastX != locX() || lastY != locY() || lastZ != locZ() || lastYaw != yaw || lastPitch != pitch) {\n++                Location from = new Location(world.getWorld(), lastX, lastY, lastZ, lastYaw, lastPitch);\n++                Location to = new Location (world.getWorld(), locX(), locY(), locZ(), yaw, pitch);\n++                com.destroystokyo.paper.event.entity.EntityMoveEvent event = new com.destroystokyo.paper.event.entity.EntityMoveEvent(getBukkitLivingEntity(), from, to.clone());\n++                if (!event.callEvent()) {\n++                    setLocation(from.getX(), from.getY(), from.getZ(), from.getYaw(), from.getPitch());\n++                } else if (!to.equals(event.getTo())) {\n++                    setLocation(to.getX(), to.getY(), to.getZ(), to.getYaw(), to.getPitch());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e113f62d5e6edd91e0cbf5642ed4491d7b096e1"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNDI4MTM2", "url": "https://github.com/PaperMC/Paper/pull/4614#pullrequestreview-551428136", "createdAt": "2020-12-14T14:36:48Z", "commit": {"oid": "f43b2abc80ab08c05f599daebdc0eae17a4c005f"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNDU2MDI2", "url": "https://github.com/PaperMC/Paper/pull/4614#pullrequestreview-551456026", "createdAt": "2020-12-14T15:04:32Z", "commit": {"oid": "f43b2abc80ab08c05f599daebdc0eae17a4c005f"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f31a13e9f9023de3031d36d10fe3ca4cac1d6b87", "author": {"user": {"login": "BillyGalbreath", "name": "BillyGalbreath"}}, "url": "https://github.com/PaperMC/Paper/commit/f31a13e9f9023de3031d36d10fe3ca4cac1d6b87", "committedDate": "2021-01-27T21:36:11Z", "message": "EntityMoveEvent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc3NzgyMjUz", "url": "https://github.com/PaperMC/Paper/pull/4614#pullrequestreview-577782253", "createdAt": "2021-01-27T21:39:49Z", "commit": {"oid": "f31a13e9f9023de3031d36d10fe3ca4cac1d6b87"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1639, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}