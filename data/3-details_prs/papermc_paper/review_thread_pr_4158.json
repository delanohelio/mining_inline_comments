{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwNzA2NDk0", "number": 4158, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMzozNTozOFrOEaiIwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMzozNjo1MVrOEaiLkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MjU3NzMwOnYy", "diffSide": "RIGHT", "path": "Spigot-Server-Patches/0553-Add-Wandering-Trader-spawn-rate-config-options.patch", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMzozNTozOFrOHEBcFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMzozNTozOFrOHEBcFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk3OTkyNg==", "bodyText": "Do no remove fields, this breaks plugins relying on nms", "url": "https://github.com/PaperMC/Paper/pull/4158#discussion_r473979926", "createdAt": "2020-08-20T13:35:38Z", "author": {"login": "JRoy"}, "path": "Spigot-Server-Patches/0553-Add-Wandering-Trader-spawn-rate-config-options.patch", "diffHunk": "@@ -0,0 +1,128 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: jmp <jasonpenilla2@me.com>\n+Date: Wed, 19 Aug 2020 23:33:43 -0700\n+Subject: [PATCH] Add Wandering Trader spawn rate config options\n+\n+Removes usages of the Vanilla wanderingTraderSpawnDelay and wanderingTraderSpawnChance values from the level.dat.\n+These were only used in some places, with hardcoded values in others (there are reports online of odd behaviour which match this).\n+This patch also simplifies the spawn delay logic and allows for arbitrary tick delays set in the Paper world config\n+(vanilla 24000 / 20 mins / 1 mc day), as well as adds config options for the minimum spawn chance, maximum spawn chance, and the\n+spawn chance increment on failed spawn attempts. These values are all easy to grasp and configure after a quick glance at\n+this page on the Minecraft wiki: https://minecraft.gamepedia.com/Wandering_Trader#Spawning\n+\n+diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java\n+index d5a1ade21749bba420257f3ece7878f32148d6ff..d940481880155d97b992c045b801b820ed4c6532 100644\n+--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java\n++++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java\n+@@ -654,4 +654,15 @@ public class PaperWorldConfig {\n+             maxLightningFlashDistance = 512; // Vanilla value\n+         }\n+     }\n++\n++    public int villagerTraderSpawnAttemptDelay = 24000;\n++    public int villagerTraderSpawnChanceFailureIncrement = 25;\n++    public int villagerTraderSpawnChanceMin = 25;\n++    public int villagerTraderSpawnChanceMax = 75;\n++    private void villagerTraderSettings() {\n++        villagerTraderSpawnAttemptDelay = getInt(\"wandering_trader.spawn-attempt-delay\", villagerTraderSpawnAttemptDelay);\n++        villagerTraderSpawnChanceFailureIncrement = getInt(\"wandering_trader.spawn-chance-failure-increment\", villagerTraderSpawnChanceFailureIncrement);\n++        villagerTraderSpawnChanceMin = getInt(\"wandering_trader.spawn-chance-min\", villagerTraderSpawnChanceMin);\n++        villagerTraderSpawnChanceMin = getInt(\"wandering_trader.spawn-chance-max\", villagerTraderSpawnChanceMax);\n++    }\n+ }\n+diff --git a/src/main/java/net/minecraft/server/MobSpawnerTrader.java b/src/main/java/net/minecraft/server/MobSpawnerTrader.java\n+index 502cb0ea40b5df1962c5a6d4b57d34de9d413e7f..419baf0e5aba3d0b31d2dbb95feb2d58e411fc60 100644\n+--- a/src/main/java/net/minecraft/server/MobSpawnerTrader.java\n++++ b/src/main/java/net/minecraft/server/MobSpawnerTrader.java\n+@@ -10,54 +10,62 @@ public class MobSpawnerTrader implements MobSpawner {\n+     private final Random a = new Random();\n+     private final IWorldDataServer b;\n+     private int c;\n+-    private int d;\n++    //private int d; // Paper", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5abeaa339bb6a7123a382c6a3fa3ef38f8ef0cb"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MjU4NDQ5OnYy", "diffSide": "RIGHT", "path": "Spigot-Server-Patches/0553-Add-Wandering-Trader-spawn-rate-config-options.patch", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMzozNjo1MVrOHEBg3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMzozNjo1MVrOHEBg3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk4MTE1MA==", "bodyText": "Please don't comment code out, just remove it as commenting increases the diff", "url": "https://github.com/PaperMC/Paper/pull/4158#discussion_r473981150", "createdAt": "2020-08-20T13:36:51Z", "author": {"login": "JRoy"}, "path": "Spigot-Server-Patches/0553-Add-Wandering-Trader-spawn-rate-config-options.patch", "diffHunk": "@@ -0,0 +1,128 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: jmp <jasonpenilla2@me.com>\n+Date: Wed, 19 Aug 2020 23:33:43 -0700\n+Subject: [PATCH] Add Wandering Trader spawn rate config options\n+\n+Removes usages of the Vanilla wanderingTraderSpawnDelay and wanderingTraderSpawnChance values from the level.dat.\n+These were only used in some places, with hardcoded values in others (there are reports online of odd behaviour which match this).\n+This patch also simplifies the spawn delay logic and allows for arbitrary tick delays set in the Paper world config\n+(vanilla 24000 / 20 mins / 1 mc day), as well as adds config options for the minimum spawn chance, maximum spawn chance, and the\n+spawn chance increment on failed spawn attempts. These values are all easy to grasp and configure after a quick glance at\n+this page on the Minecraft wiki: https://minecraft.gamepedia.com/Wandering_Trader#Spawning\n+\n+diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java\n+index d5a1ade21749bba420257f3ece7878f32148d6ff..d940481880155d97b992c045b801b820ed4c6532 100644\n+--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java\n++++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java\n+@@ -654,4 +654,15 @@ public class PaperWorldConfig {\n+             maxLightningFlashDistance = 512; // Vanilla value\n+         }\n+     }\n++\n++    public int villagerTraderSpawnAttemptDelay = 24000;\n++    public int villagerTraderSpawnChanceFailureIncrement = 25;\n++    public int villagerTraderSpawnChanceMin = 25;\n++    public int villagerTraderSpawnChanceMax = 75;\n++    private void villagerTraderSettings() {\n++        villagerTraderSpawnAttemptDelay = getInt(\"wandering_trader.spawn-attempt-delay\", villagerTraderSpawnAttemptDelay);\n++        villagerTraderSpawnChanceFailureIncrement = getInt(\"wandering_trader.spawn-chance-failure-increment\", villagerTraderSpawnChanceFailureIncrement);\n++        villagerTraderSpawnChanceMin = getInt(\"wandering_trader.spawn-chance-min\", villagerTraderSpawnChanceMin);\n++        villagerTraderSpawnChanceMin = getInt(\"wandering_trader.spawn-chance-max\", villagerTraderSpawnChanceMax);\n++    }\n+ }\n+diff --git a/src/main/java/net/minecraft/server/MobSpawnerTrader.java b/src/main/java/net/minecraft/server/MobSpawnerTrader.java\n+index 502cb0ea40b5df1962c5a6d4b57d34de9d413e7f..419baf0e5aba3d0b31d2dbb95feb2d58e411fc60 100644\n+--- a/src/main/java/net/minecraft/server/MobSpawnerTrader.java\n++++ b/src/main/java/net/minecraft/server/MobSpawnerTrader.java\n+@@ -10,54 +10,62 @@ public class MobSpawnerTrader implements MobSpawner {\n+     private final Random a = new Random();\n+     private final IWorldDataServer b;\n+     private int c;\n+-    private int d;\n++    //private int d; // Paper\n+     private int e;\n+ \n+     public MobSpawnerTrader(IWorldDataServer iworlddataserver) {\n+         this.b = iworlddataserver;\n+-        this.c = 1200;\n+-        this.d = iworlddataserver.v();\n+-        this.e = iworlddataserver.w();\n+-        if (this.d == 0 && this.e == 0) {\n+-            this.d = 24000;\n+-            iworlddataserver.g(this.d);\n+-            this.e = 25;\n+-            iworlddataserver.h(this.e);\n+-        }\n+-\n++        // Paper start\n++        this.c = Integer.MAX_VALUE;\n++        //this.d = iworlddataserver.v();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5abeaa339bb6a7123a382c6a3fa3ef38f8ef0cb"}, "originalPosition": 59}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1900, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}