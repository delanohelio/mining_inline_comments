{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNDE0ODg2", "number": 4832, "title": "Add cause to Weather/ThunderChangeEvents", "bodyText": "closes #3397", "createdAt": "2020-12-03T02:39:53Z", "url": "https://github.com/PaperMC/Paper/pull/4832", "merged": true, "mergeCommit": {"oid": "6f93dc95dcd15359884e43ad0521ddf0822a26c2"}, "closed": true, "closedAt": "2021-05-24T16:45:23Z", "author": {"login": "Machine-Maker"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABeFcYeUgBqjQ0ODczMjQ4MTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeZ9EMUgFqTY2Njk2NDI4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d43553fa3bf6777cf4cbdfa6fe60476057e89d4b", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/d43553fa3bf6777cf4cbdfa6fe60476057e89d4b", "committedDate": "2020-12-03T02:37:52Z", "message": "Add cause to Weather/ThunderChangeEvents"}, "afterCommit": {"oid": "3adb25d900d81e53b87c03da30abe4f78eb7fa82", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/3adb25d900d81e53b87c03da30abe4f78eb7fa82", "committedDate": "2021-03-21T23:21:57Z", "message": "Add cause to Weather/ThunderChangeEvents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjQ0MDE2ODI1", "url": "https://github.com/PaperMC/Paper/pull/4832#pullrequestreview-644016825", "createdAt": "2021-04-24T09:34:48Z", "commit": {"oid": "3adb25d900d81e53b87c03da30abe4f78eb7fa82"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3adb25d900d81e53b87c03da30abe4f78eb7fa82", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/3adb25d900d81e53b87c03da30abe4f78eb7fa82", "committedDate": "2021-03-21T23:21:57Z", "message": "Add cause to Weather/ThunderChangeEvents"}, "afterCommit": {"oid": "c416405261323f1019f991657c352431432905c9", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/c416405261323f1019f991657c352431432905c9", "committedDate": "2021-05-24T05:42:43Z", "message": "Add cause to Weather/ThunderChangeEvents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c416405261323f1019f991657c352431432905c9", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/c416405261323f1019f991657c352431432905c9", "committedDate": "2021-05-24T05:42:43Z", "message": "Add cause to Weather/ThunderChangeEvents"}, "afterCommit": {"oid": "f9bc80b048ef1110bf6cd6d7b6f3ca6c7660d750", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/f9bc80b048ef1110bf6cd6d7b6f3ca6c7660d750", "committedDate": "2021-05-24T05:44:06Z", "message": "Add cause to Weather/ThunderChangeEvents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f9bc80b048ef1110bf6cd6d7b6f3ca6c7660d750", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/f9bc80b048ef1110bf6cd6d7b6f3ca6c7660d750", "committedDate": "2021-05-24T05:44:06Z", "message": "Add cause to Weather/ThunderChangeEvents"}, "afterCommit": {"oid": "d3999fd6183dfd35822872c5aebc27277a328ced", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/d3999fd6183dfd35822872c5aebc27277a328ced", "committedDate": "2021-05-24T05:45:02Z", "message": "Add cause to Weather/ThunderChangeEvents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjY2NDkzMTAx", "url": "https://github.com/PaperMC/Paper/pull/4832#pullrequestreview-666493101", "createdAt": "2021-05-24T08:02:58Z", "commit": {"oid": "d3999fd6183dfd35822872c5aebc27277a328ced"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0yNFQwODowMjo1OVrOJgOAzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wNS0yNFQwODowNDo0M1rOJgOEYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzc2Mzc5MA==", "bodyText": "No, this happens when players go to sleep to skip the night.", "url": "https://github.com/PaperMC/Paper/pull/4832#discussion_r637763790", "createdAt": "2021-05-24T08:02:59Z", "author": {"login": "kennytv"}, "path": "Spigot-Server-Patches/0741-Add-cause-to-Weather-ThunderChangeEvents.patch", "diffHunk": "@@ -0,0 +1,118 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Jake Potrebic <jake.m.potrebic@gmail.com>\n+Date: Wed, 2 Dec 2020 18:23:26 -0800\n+Subject: [PATCH] Add cause to Weather/ThunderChangeEvents\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/level/WorldServer.java b/src/main/java/net/minecraft/server/level/WorldServer.java\n+index 6aace2155258d8257d53ebfcb20c37ea7497c02c..fe0afd4959fd0f5d99a20a42f01d9700a472bcec 100644\n+--- a/src/main/java/net/minecraft/server/level/WorldServer.java\n++++ b/src/main/java/net/minecraft/server/level/WorldServer.java\n+@@ -419,8 +419,8 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+         this.worldDataServer.setClearWeatherTime(i);\n+         this.worldDataServer.setWeatherDuration(j);\n+         this.worldDataServer.setThunderDuration(j);\n+-        this.worldDataServer.setStorm(flag);\n+-        this.worldDataServer.setThundering(flag1);\n++        this.worldDataServer.setStorm(flag, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper\n++        this.worldDataServer.setThundering(flag1, org.bukkit.event.weather.ThunderChangeEvent.Cause.COMMAND); // Paper\n+     }\n+ \n+     public BiomeBase getBiomeBySeed(int i, int j, int k) { return a(i, j, k); } // Paper - OBFHELPER\n+@@ -482,8 +482,8 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+                 this.worldDataServer.setThunderDuration(j);\n+                 this.worldDataServer.setWeatherDuration(k);\n+                 this.worldDataServer.setClearWeatherTime(i);\n+-                this.worldDataServer.setThundering(flag1);\n+-                this.worldDataServer.setStorm(flag2);\n++                this.worldDataServer.setThundering(flag1, org.bukkit.event.weather.ThunderChangeEvent.Cause.NATURAL); // Paper\n++                this.worldDataServer.setStorm(flag2, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper\n+             }\n+ \n+             this.lastThunderLevel = this.thunderLevel;\n+@@ -885,14 +885,14 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+ \n+     private void clearWeather() {\n+         // CraftBukkit start\n+-        this.worldDataServer.setStorm(false);\n++        this.worldDataServer.setStorm(false, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper - happens when weather cycle gamerule is set to false\n+         // If we stop due to everyone sleeping we should reset the weather duration to some other random value.\n+         // Not that everyone ever manages to get the whole server to sleep at the same time....\n+         if (!this.worldDataServer.hasStorm()) {\n+             this.worldDataServer.setWeatherDuration(0);\n+         }\n+         // CraftBukkit end\n+-        this.worldDataServer.setThundering(false);\n++        this.worldDataServer.setThundering(false, org.bukkit.event.weather.ThunderChangeEvent.Cause.COMMAND); // Paper - happens when weather cycle gamerule is set to false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3999fd6183dfd35822872c5aebc27277a328ced"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzc2NDMwNw==", "bodyText": "No, this happens when players go to sleep to skip the night.", "url": "https://github.com/PaperMC/Paper/pull/4832#discussion_r637764307", "createdAt": "2021-05-24T08:03:56Z", "author": {"login": "kennytv"}, "path": "Spigot-Server-Patches/0741-Add-cause-to-Weather-ThunderChangeEvents.patch", "diffHunk": "@@ -0,0 +1,118 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Jake Potrebic <jake.m.potrebic@gmail.com>\n+Date: Wed, 2 Dec 2020 18:23:26 -0800\n+Subject: [PATCH] Add cause to Weather/ThunderChangeEvents\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/level/WorldServer.java b/src/main/java/net/minecraft/server/level/WorldServer.java\n+index 6aace2155258d8257d53ebfcb20c37ea7497c02c..fe0afd4959fd0f5d99a20a42f01d9700a472bcec 100644\n+--- a/src/main/java/net/minecraft/server/level/WorldServer.java\n++++ b/src/main/java/net/minecraft/server/level/WorldServer.java\n+@@ -419,8 +419,8 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+         this.worldDataServer.setClearWeatherTime(i);\n+         this.worldDataServer.setWeatherDuration(j);\n+         this.worldDataServer.setThunderDuration(j);\n+-        this.worldDataServer.setStorm(flag);\n+-        this.worldDataServer.setThundering(flag1);\n++        this.worldDataServer.setStorm(flag, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper\n++        this.worldDataServer.setThundering(flag1, org.bukkit.event.weather.ThunderChangeEvent.Cause.COMMAND); // Paper\n+     }\n+ \n+     public BiomeBase getBiomeBySeed(int i, int j, int k) { return a(i, j, k); } // Paper - OBFHELPER\n+@@ -482,8 +482,8 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+                 this.worldDataServer.setThunderDuration(j);\n+                 this.worldDataServer.setWeatherDuration(k);\n+                 this.worldDataServer.setClearWeatherTime(i);\n+-                this.worldDataServer.setThundering(flag1);\n+-                this.worldDataServer.setStorm(flag2);\n++                this.worldDataServer.setThundering(flag1, org.bukkit.event.weather.ThunderChangeEvent.Cause.NATURAL); // Paper\n++                this.worldDataServer.setStorm(flag2, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper\n+             }\n+ \n+             this.lastThunderLevel = this.thunderLevel;\n+@@ -885,14 +885,14 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+ \n+     private void clearWeather() {\n+         // CraftBukkit start\n+-        this.worldDataServer.setStorm(false);\n++        this.worldDataServer.setStorm(false, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper - happens when weather cycle gamerule is set to false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3999fd6183dfd35822872c5aebc27277a328ced"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzc2NDcwNQ==", "bodyText": "Why is the reason here COMMAND?", "url": "https://github.com/PaperMC/Paper/pull/4832#discussion_r637764705", "createdAt": "2021-05-24T08:04:43Z", "author": {"login": "kennytv"}, "path": "Spigot-Server-Patches/0741-Add-cause-to-Weather-ThunderChangeEvents.patch", "diffHunk": "@@ -0,0 +1,118 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Jake Potrebic <jake.m.potrebic@gmail.com>\n+Date: Wed, 2 Dec 2020 18:23:26 -0800\n+Subject: [PATCH] Add cause to Weather/ThunderChangeEvents\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/level/WorldServer.java b/src/main/java/net/minecraft/server/level/WorldServer.java\n+index 6aace2155258d8257d53ebfcb20c37ea7497c02c..fe0afd4959fd0f5d99a20a42f01d9700a472bcec 100644\n+--- a/src/main/java/net/minecraft/server/level/WorldServer.java\n++++ b/src/main/java/net/minecraft/server/level/WorldServer.java\n+@@ -419,8 +419,8 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+         this.worldDataServer.setClearWeatherTime(i);\n+         this.worldDataServer.setWeatherDuration(j);\n+         this.worldDataServer.setThunderDuration(j);\n+-        this.worldDataServer.setStorm(flag);\n+-        this.worldDataServer.setThundering(flag1);\n++        this.worldDataServer.setStorm(flag, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper\n++        this.worldDataServer.setThundering(flag1, org.bukkit.event.weather.ThunderChangeEvent.Cause.COMMAND); // Paper\n+     }\n+ \n+     public BiomeBase getBiomeBySeed(int i, int j, int k) { return a(i, j, k); } // Paper - OBFHELPER\n+@@ -482,8 +482,8 @@ public class WorldServer extends World implements GeneratorAccessSeed {\n+                 this.worldDataServer.setThunderDuration(j);\n+                 this.worldDataServer.setWeatherDuration(k);\n+                 this.worldDataServer.setClearWeatherTime(i);\n+-                this.worldDataServer.setThundering(flag1);\n+-                this.worldDataServer.setStorm(flag2);\n++                this.worldDataServer.setThundering(flag1, org.bukkit.event.weather.ThunderChangeEvent.Cause.NATURAL); // Paper\n++                this.worldDataServer.setStorm(flag2, org.bukkit.event.weather.WeatherChangeEvent.Cause.COMMAND); // Paper", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3999fd6183dfd35822872c5aebc27277a328ced"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38aaf366dd89eb0b52b6a9c160426b8532b9ce28", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/38aaf366dd89eb0b52b6a9c160426b8532b9ce28", "committedDate": "2021-05-24T16:39:09Z", "message": "Add cause to Weather/ThunderChangeEvents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d3999fd6183dfd35822872c5aebc27277a328ced", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/d3999fd6183dfd35822872c5aebc27277a328ced", "committedDate": "2021-05-24T05:45:02Z", "message": "Add cause to Weather/ThunderChangeEvents"}, "afterCommit": {"oid": "38aaf366dd89eb0b52b6a9c160426b8532b9ce28", "author": {"user": {"login": "Machine-Maker", "name": "Jake Potrebic"}}, "url": "https://github.com/PaperMC/Paper/commit/38aaf366dd89eb0b52b6a9c160426b8532b9ce28", "committedDate": "2021-05-24T16:39:09Z", "message": "Add cause to Weather/ThunderChangeEvents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjY2OTY0Mjg5", "url": "https://github.com/PaperMC/Paper/pull/4832#pullrequestreview-666964289", "createdAt": "2021-05-24T16:45:17Z", "commit": {"oid": "38aaf366dd89eb0b52b6a9c160426b8532b9ce28"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1513, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}