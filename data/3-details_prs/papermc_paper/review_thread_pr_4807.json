{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NzU3NjQ1", "number": 4807, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwOTowNjo1M1rOE9il-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwOTowNjo1M1rOE9il-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyOTY1MzcxOnYy", "diffSide": "RIGHT", "path": "Spigot-Server-Patches/0602-Added-PlayerLoomPatternSelectEvent.patch", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwOTowNjo1M1rOH6R8YA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQyMDoyMzozNFrOH6mt1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3MzQ0MA==", "bodyText": "can we get an obf helper here?", "url": "https://github.com/PaperMC/Paper/pull/4807#discussion_r530873440", "createdAt": "2020-11-26T09:06:53Z", "author": {"login": "MiniDigger"}, "path": "Spigot-Server-Patches/0602-Added-PlayerLoomPatternSelectEvent.patch", "diffHunk": "@@ -0,0 +1,54 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Jake Potrebic <jake.m.potrebic@gmail.com>\n+Date: Wed, 25 Nov 2020 16:33:27 -0800\n+Subject: [PATCH] Added PlayerLoomPatternSelectEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/ContainerLoom.java b/src/main/java/net/minecraft/server/ContainerLoom.java\n+index 1fe21ca13a1eecb64cb2d3f4f18993e181d26ae2..b497af67338fc78121ad05bf00ac2f30c4712d88 100644\n+--- a/src/main/java/net/minecraft/server/ContainerLoom.java\n++++ b/src/main/java/net/minecraft/server/ContainerLoom.java\n+@@ -6,6 +6,7 @@ import org.bukkit.craftbukkit.inventory.CraftInventoryLoom;\n+ import org.bukkit.craftbukkit.inventory.CraftInventoryView;\n+ import org.bukkit.entity.Player;\n+ // CraftBukkit end\n++import io.papermc.paper.event.player.PlayerLoomPatternSelectEvent; // Paper\n+ \n+ public class ContainerLoom extends Container {\n+ \n+@@ -144,7 +145,22 @@ public class ContainerLoom extends Container {\n+     @Override\n+     public boolean a(EntityHuman entityhuman, int i) {\n+         if (i > 0 && i <= EnumBannerPatternType.R) {\n+-            this.d.set(i);\n++            // Paper start\n++            int enumBannerPatternTypeOrdinal = i;\n++            PlayerLoomPatternSelectEvent event = new PlayerLoomPatternSelectEvent((Player) entityhuman.getBukkitEntity(), ((CraftInventoryLoom) getBukkitView().getTopInventory()), org.bukkit.block.banner.PatternType.getByIdentifier(EnumBannerPatternType.values()[i].getIdentifier()));\n++            if (!event.callEvent()) {\n++                ((Player) entityhuman.getBukkitEntity()).updateInventory();\n++                return false;\n++            }\n++            for (EnumBannerPatternType nms : EnumBannerPatternType.values()) {\n++                if (event.getPatternType().getIdentifier().equals(nms.getIdentifier())) {\n++                    enumBannerPatternTypeOrdinal = nms.ordinal();\n++                    break;\n++                }\n++            }\n++            ((Player) entityhuman.getBukkitEntity()).updateInventory();\n++            this.d.set(enumBannerPatternTypeOrdinal);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82c531166ca4ceba301f4dfcc39daeaa6c204701"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTIxMzc4Mw==", "bodyText": "Done", "url": "https://github.com/PaperMC/Paper/pull/4807#discussion_r531213783", "createdAt": "2020-11-26T20:23:34Z", "author": {"login": "Machine-Maker"}, "path": "Spigot-Server-Patches/0602-Added-PlayerLoomPatternSelectEvent.patch", "diffHunk": "@@ -0,0 +1,54 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Jake Potrebic <jake.m.potrebic@gmail.com>\n+Date: Wed, 25 Nov 2020 16:33:27 -0800\n+Subject: [PATCH] Added PlayerLoomPatternSelectEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/ContainerLoom.java b/src/main/java/net/minecraft/server/ContainerLoom.java\n+index 1fe21ca13a1eecb64cb2d3f4f18993e181d26ae2..b497af67338fc78121ad05bf00ac2f30c4712d88 100644\n+--- a/src/main/java/net/minecraft/server/ContainerLoom.java\n++++ b/src/main/java/net/minecraft/server/ContainerLoom.java\n+@@ -6,6 +6,7 @@ import org.bukkit.craftbukkit.inventory.CraftInventoryLoom;\n+ import org.bukkit.craftbukkit.inventory.CraftInventoryView;\n+ import org.bukkit.entity.Player;\n+ // CraftBukkit end\n++import io.papermc.paper.event.player.PlayerLoomPatternSelectEvent; // Paper\n+ \n+ public class ContainerLoom extends Container {\n+ \n+@@ -144,7 +145,22 @@ public class ContainerLoom extends Container {\n+     @Override\n+     public boolean a(EntityHuman entityhuman, int i) {\n+         if (i > 0 && i <= EnumBannerPatternType.R) {\n+-            this.d.set(i);\n++            // Paper start\n++            int enumBannerPatternTypeOrdinal = i;\n++            PlayerLoomPatternSelectEvent event = new PlayerLoomPatternSelectEvent((Player) entityhuman.getBukkitEntity(), ((CraftInventoryLoom) getBukkitView().getTopInventory()), org.bukkit.block.banner.PatternType.getByIdentifier(EnumBannerPatternType.values()[i].getIdentifier()));\n++            if (!event.callEvent()) {\n++                ((Player) entityhuman.getBukkitEntity()).updateInventory();\n++                return false;\n++            }\n++            for (EnumBannerPatternType nms : EnumBannerPatternType.values()) {\n++                if (event.getPatternType().getIdentifier().equals(nms.getIdentifier())) {\n++                    enumBannerPatternTypeOrdinal = nms.ordinal();\n++                    break;\n++                }\n++            }\n++            ((Player) entityhuman.getBukkitEntity()).updateInventory();\n++            this.d.set(enumBannerPatternTypeOrdinal);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg3MzQ0MA=="}, "originalCommit": {"oid": "82c531166ca4ceba301f4dfcc39daeaa6c204701"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1756, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}