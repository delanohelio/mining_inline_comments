{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NTgyMjIw", "number": 3873, "title": "Fix SPIGOT-5824 Bukkit world-container is not used", "bodyText": "Fixes https://hub.spigotmc.org/jira/browse/SPIGOT-5824", "createdAt": "2020-07-10T18:25:20Z", "url": "https://github.com/PaperMC/Paper/pull/3873", "merged": true, "mergeCommit": {"oid": "9b93d122ecdfc797de63a37152cffde8d55687cb"}, "closed": true, "closedAt": "2020-07-22T05:31:54Z", "author": {"login": "BillyGalbreath"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczp7k2AFqTQ0NjY5MTYwMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3T_X4AH2gAyNDQ3NTgyMjIwOjliOTNkMTIyZWNkZmM3OTdkZTYzYTM3MTUyY2ZmZGU4ZDU1Njg3Y2I=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NjkxNjAx", "url": "https://github.com/PaperMC/Paper/pull/3873#pullrequestreview-446691601", "createdAt": "2020-07-10T20:47:23Z", "commit": {"oid": "443fc81677efaf57edc03951f127e5665fcd2fcd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMDo0NzoyM1rOGwFL1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMDo0NzoyM1rOGwFL1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA2OTc4MA==", "bodyText": "Use load() from YamlConfiguration object.\npublic static YamlConfiguration loadConfiguration(@NotNull Reader reader) {\n    Validate.notNull(reader, \"Stream cannot be null\");\n\n    YamlConfiguration config = new YamlConfiguration();\n\n    try {\n        config.load(reader);\n    } catch (IOException ex) {\n        Bukkit.getLogger().log(Level.SEVERE, \"Cannot load configuration from stream\", ex);\n    } catch (InvalidConfigurationException ex) {\n        Bukkit.getLogger().log(Level.SEVERE, \"Cannot load configuration from stream\", ex);\n    }\n\n    return config;\n}\nWhen IOException or InvalidConfigurationException occurs it will result in NPE since Bukkit.getServer() returns null until CraftServer sets Bukkit.setServer(...) in its constructor.", "url": "https://github.com/PaperMC/Paper/pull/3873#discussion_r453069780", "createdAt": "2020-07-10T20:47:23Z", "author": {"login": "TheMolkaPL"}, "path": "Spigot-Server-Patches/0543-Fix-SPIGOT-5824-Bukkit-world-container-is-not-used.patch", "diffHunk": "@@ -0,0 +1,32 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: William Blake Galbreath <Blake.Galbreath@GMail.com>\n+Date: Fri, 10 Jul 2020 13:12:33 -0500\n+Subject: [PATCH] Fix SPIGOT-5824 Bukkit world-container is not used\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/Main.java b/src/main/java/net/minecraft/server/Main.java\n+index 2f29d7040d37e8be2ba5f8f634011e069a07db2f..d5ae5c9da76134cfa0df125fb96db67071ed77d2 100644\n+--- a/src/main/java/net/minecraft/server/Main.java\n++++ b/src/main/java/net/minecraft/server/Main.java\n+@@ -86,7 +86,20 @@ public class Main {\n+                 return;\n+             }\n+ \n+-            File file = (File) optionset.valueOf(\"universe\"); // CraftBukkit\n++            // Paper start - fix SPIGOT-5824\n++            File file;\n++            if (optionset.has(\"universe\")) {\n++                file = (File) optionset.valueOf(\"universe\"); // CraftBukkit\n++            } else {\n++                try {\n++                    file = new File(org.bukkit.configuration.file.YamlConfiguration\n++                            .loadConfiguration((File) optionset.valueOf(\"bukkit-settings\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "443fc81677efaf57edc03951f127e5665fcd2fcd"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2Njk1MzEw", "url": "https://github.com/PaperMC/Paper/pull/3873#pullrequestreview-446695310", "createdAt": "2020-07-10T20:54:55Z", "commit": {"oid": "443fc81677efaf57edc03951f127e5665fcd2fcd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMDo1NDo1NVrOGwFW_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMDo1NDo1NVrOGwFW_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3MjYzNw==", "bodyText": "Are you sure this isn't always true? universe is set to return a File by default.", "url": "https://github.com/PaperMC/Paper/pull/3873#discussion_r453072637", "createdAt": "2020-07-10T20:54:55Z", "author": {"login": "TheMolkaPL"}, "path": "Spigot-Server-Patches/0543-Fix-SPIGOT-5824-Bukkit-world-container-is-not-used.patch", "diffHunk": "@@ -0,0 +1,32 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: William Blake Galbreath <Blake.Galbreath@GMail.com>\n+Date: Fri, 10 Jul 2020 13:12:33 -0500\n+Subject: [PATCH] Fix SPIGOT-5824 Bukkit world-container is not used\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/Main.java b/src/main/java/net/minecraft/server/Main.java\n+index 2f29d7040d37e8be2ba5f8f634011e069a07db2f..d5ae5c9da76134cfa0df125fb96db67071ed77d2 100644\n+--- a/src/main/java/net/minecraft/server/Main.java\n++++ b/src/main/java/net/minecraft/server/Main.java\n+@@ -86,7 +86,20 @@ public class Main {\n+                 return;\n+             }\n+ \n+-            File file = (File) optionset.valueOf(\"universe\"); // CraftBukkit\n++            // Paper start - fix SPIGOT-5824\n++            File file;\n++            if (optionset.has(\"universe\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "443fc81677efaf57edc03951f127e5665fcd2fcd"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bede4d304d67f61e81975192883672239fa20ac9", "author": {"user": {"login": "aikar", "name": "Daniel Ennis"}}, "url": "https://github.com/PaperMC/Paper/commit/bede4d304d67f61e81975192883672239fa20ac9", "committedDate": "2020-07-22T05:01:01Z", "message": "Load config files early on\n\nalso fixes the ide commodore rewrite patch version\n\nPrep for other PR's to be updated to use these as some options need to use some values earlier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b93d122ecdfc797de63a37152cffde8d55687cb", "author": {"user": {"login": "BillyGalbreath", "name": "BillyGalbreath"}}, "url": "https://github.com/PaperMC/Paper/commit/9b93d122ecdfc797de63a37152cffde8d55687cb", "committedDate": "2020-07-22T05:29:20Z", "message": "Fix SPIGOT-5824 Bukkit world-container is not used"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1658, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}