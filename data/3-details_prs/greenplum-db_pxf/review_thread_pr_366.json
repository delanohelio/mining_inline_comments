{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MTc5MDg4", "number": 366, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNjo0ODo1NFrOECPT1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNjo0ODo1NFrOECPT1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNzgzNDQ0OnYy", "diffSide": "RIGHT", "path": "server/pxf-s3/src/main/java/org/greenplum/pxf/plugins/s3/S3SelectAccessor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNjo0ODo1NFrOGekvbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNzowNjoxNFrOGelYqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMjQzMA==", "bodyText": "why do we want to do this now ? by this point we already read all data and just failed to close the stream, this is usually ignored as the stream itself will be GC-ed in a short while and the caller does not get any impact from this error ?", "url": "https://github.com/greenplum-db/pxf/pull/366#discussion_r434712430", "createdAt": "2020-06-03T16:48:54Z", "author": {"login": "denalex"}, "path": "server/pxf-s3/src/main/java/org/greenplum/pxf/plugins/s3/S3SelectAccessor.java", "diffHunk": "@@ -129,9 +139,16 @@ public void closeForRead() throws Exception {\n                 LOG.debug(\"ResultInputStream closed\");\n             } catch (IOException e) {\n                 LOG.error(\"Unable to close ResultInputStream\", e);\n+                error = defaultIfNull(error, e);\n             }\n         }\n \n+        if (error != null) {\n+            // If there's an error during closing of streams, report the first\n+            // encountered error\n+            throw error;\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "555dbbff690d731fc3804fad84c3b91c2e7ca095"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcyMjk4Ng==", "bodyText": "The error is swallowed by the BridgeResponse take a look at: https://github.com/greenplum-db/pxf/blob/spring-boot/server/pxf-service/src/main/java/org/greenplum/pxf/service/rest/BridgeResponse.java#L87 but I still think we should report errors generated during the stream closing, and they should be handled by the caller. The result is the same for the end user", "url": "https://github.com/greenplum-db/pxf/pull/366#discussion_r434722986", "createdAt": "2020-06-03T17:06:14Z", "author": {"login": "frankgh"}, "path": "server/pxf-s3/src/main/java/org/greenplum/pxf/plugins/s3/S3SelectAccessor.java", "diffHunk": "@@ -129,9 +139,16 @@ public void closeForRead() throws Exception {\n                 LOG.debug(\"ResultInputStream closed\");\n             } catch (IOException e) {\n                 LOG.error(\"Unable to close ResultInputStream\", e);\n+                error = defaultIfNull(error, e);\n             }\n         }\n \n+        if (error != null) {\n+            // If there's an error during closing of streams, report the first\n+            // encountered error\n+            throw error;\n+        }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMjQzMA=="}, "originalCommit": {"oid": "555dbbff690d731fc3804fad84c3b91c2e7ca095"}, "originalPosition": 75}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3667, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}