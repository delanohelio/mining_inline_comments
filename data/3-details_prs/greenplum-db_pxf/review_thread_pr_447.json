{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0MzQ4MDIx", "number": 447, "reviewThreads": {"totalCount": 42, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1MDowNVrOEiTgEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxODoyOTo0NlrOEmNqOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA2NTQ3OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf.go", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1MDowNVrOHQG-Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODo0MTo1OVrOHSPH2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1MzQ0Mw==", "bodyText": "since we are preserving and deprecating the old commands, should we deprecate PXF_CONF rather than removing it ? If it is set, we can print warning, but still use the value specified as PXF_RUN ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486653443", "createdAt": "2020-09-10T21:50:05Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf.go", "diffHunk": "@@ -16,7 +16,7 @@ type envVar string\n const (\n \tgpHome   envVar = \"GPHOME\"\n \tpxfHome  envVar = \"PXF_HOME\"\n-\tpxfConf  envVar = \"PXF_CONF\"\n+\tpxfRun  envVar = \"PXF_RUN\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI3NDQ1MQ==", "bodyText": "good point, I am adding PXF_CONF to the PXF script:\n# Deprecated, will be removed at some point in the future.\n# We keep it for backwards compatibility\nexport PXF_CONF=${PXF_CONF:-$PXF_HOME}\n\n# Path to PXF_RUN directories, defaults to PXF_HOME\nexport PXF_RUN=${PXF_RUN:-$PXF_CONF}", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487274451", "createdAt": "2020-09-11T20:28:10Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/pxf.go", "diffHunk": "@@ -16,7 +16,7 @@ type envVar string\n const (\n \tgpHome   envVar = \"GPHOME\"\n \tpxfHome  envVar = \"PXF_HOME\"\n-\tpxfConf  envVar = \"PXF_CONF\"\n+\tpxfRun  envVar = \"PXF_RUN\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1MzQ0Mw=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg4NDE4NQ==", "bodyText": "PXF_CONF migration is not straightforward, so we decided to come up with an upgrade path rather than supporting the PXF_CONF as a configuration point.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r488884185", "createdAt": "2020-09-15T18:41:59Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/pxf.go", "diffHunk": "@@ -16,7 +16,7 @@ type envVar string\n const (\n \tgpHome   envVar = \"GPHOME\"\n \tpxfHome  envVar = \"PXF_HOME\"\n-\tpxfConf  envVar = \"PXF_CONF\"\n+\tpxfRun  envVar = \"PXF_RUN\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1MzQ0Mw=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA3MzE1OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1Mjo0NlrOHQHCdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDo1MzoxMlrOHQtjBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NDU4Mg==", "bodyText": "does listing a variable here make is mandatory ? PXF_RUN is not mandatory for start / stop, but can be specified if it is not equal to PXF_HOME", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486654582", "createdAt": "2020-09-10T21:52:46Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf.go", "diffHunk": "@@ -130,7 +130,7 @@ var (\n \t\t\terr:     \"PXF failed to start on %d out of %d host%s\\n\",\n \t\t},\n \t\twarn:       false,\n-\t\tenvVars:    []envVar{pxfHome},\n+\t\tenvVars:    []envVar{pxfHome, pxfRun},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI4NTUxMA==", "bodyText": "I think for the CLI it will be mandatory. PXF_RUN will be provided to the CLI application from the pxf script.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487285510", "createdAt": "2020-09-11T20:53:12Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/pxf.go", "diffHunk": "@@ -130,7 +130,7 @@ var (\n \t\t\terr:     \"PXF failed to start on %d out of %d host%s\\n\",\n \t\t},\n \t\twarn:       false,\n-\t\tenvVars:    []envVar{pxfHome},\n+\t\tenvVars:    []envVar{pxfHome, pxfRun},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NDU4Mg=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA3OTM2OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1NToxNVrOHQHGSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMzowNzoyOVrOHTHICA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NTU2MA==", "bodyText": "why do we need PXF_RUN for init ? it should only copy extension file and is not dependent on PXF_RUN value, no ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486655560", "createdAt": "2020-09-10T21:55:15Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -11,27 +11,27 @@ import (\n )\n \n var _ = Describe(\"CommandFunc\", func() {\n-\tContext(\"when GPHOME, JAVA_HOME, PXF_CONF and PXF_HOME are set\", func() {\n+\tContext(\"when GPHOME, JAVA_HOME, PXF_RUN and PXF_HOME are set\", func() {\n \t\tBeforeEach(func() {\n \t\t\t_ = os.Setenv(\"GPHOME\", \"/test/gphome\")\n \t\t\t_ = os.Setenv(\"PXF_HOME\", \"/test/pxfhome\")\n-\t\t\t_ = os.Setenv(\"PXF_CONF\", \"/test/somewhere/pxf_conf\")\n+\t\t\t_ = os.Setenv(\"PXF_RUN\", \"/test/somewhere/pxf_run\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgwMTczNg==", "bodyText": "init does not need it, fixing it", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489801736", "createdAt": "2020-09-16T23:07:29Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -11,27 +11,27 @@ import (\n )\n \n var _ = Describe(\"CommandFunc\", func() {\n-\tContext(\"when GPHOME, JAVA_HOME, PXF_CONF and PXF_HOME are set\", func() {\n+\tContext(\"when GPHOME, JAVA_HOME, PXF_RUN and PXF_HOME are set\", func() {\n \t\tBeforeEach(func() {\n \t\t\t_ = os.Setenv(\"GPHOME\", \"/test/gphome\")\n \t\t\t_ = os.Setenv(\"PXF_HOME\", \"/test/pxfhome\")\n-\t\t\t_ = os.Setenv(\"PXF_CONF\", \"/test/somewhere/pxf_conf\")\n+\t\t\t_ = os.Setenv(\"PXF_RUN\", \"/test/somewhere/pxf_run\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NTU2MA=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA4NjUyOnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1ODowM1rOHQHKsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMzowODo0NVrOHTHJlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjY5MA==", "bodyText": "doesn't stop needs to know now where PXF_RUN is to lookup / manage PID ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486656690", "createdAt": "2020-09-10T21:58:03Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgwMjEzMw==", "bodyText": "start, stop, restart, status, and sync need PXF_RUN location\nstart needs it for PID, LOGS, etc\nstop needs it for PID\nrestart does a stop start\nstatus needs the PID location\nsync needs it for synchronization", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489802133", "createdAt": "2020-09-16T23:08:45Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjY5MA=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA4NzY1OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1ODozNFrOHQHLbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo1ODozNFrOHQHLbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1Njg3Nw==", "bodyText": "same for the above 2 commands", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486656877", "createdAt": "2020-09-10T21:58:34Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA5MTUyOnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMDowOFrOHQHN1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMDowOFrOHQHN1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NzQ5NA==", "bodyText": "no longer true, if PXF_RUN is not set it is assumed to be the same as PXF_HOME", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486657494", "createdAt": "2020-09-10T22:00:08Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n \t})\n \n-\tContext(\"when PXF_CONF is not set\", func() {\n+\tContext(\"when PXF_RUN is not set\", func() {\n \t\tBeforeEach(func() {\n \t\t\t_ = os.Setenv(\"GPHOME\", \"/test/gphome\")\n \t\t\t_ = os.Setenv(\"PXF_HOME\", \"/test/pxfhome\")\n-\t\t\t_ = os.Unsetenv(\"PXF_CONF\")\n+\t\t\t_ = os.Unsetenv(\"PXF_RUN\")\n \t\t\t_ = os.Unsetenv(\"JAVA_HOME\")\n \t\t})\n \n-\t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n-\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n-\t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n-\n-\t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n+\t\tIt(\"successfully generates stop, status, restart, and reset commands\", func() {\n+\t\t\tcommandFunc, err := cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n-\t\tIt(\"fails to init or sync\", func() {\n-\t\t\tcommandFunc, err := cmd.InitCommand.GetFunctionToExecute()\n+\t\tIt(\"fails to start, init or sync\", func() {\n+\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(commandFunc).To(BeNil())\n-\t\t\tExpect(err).To(Equal(errors.New(\"PXF_CONF must be set\")))\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA5MjUxOnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMDozMVrOHQHOZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMDozMVrOHQHOZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NzYzOA==", "bodyText": "init should not care about PXF_RUN now", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486657638", "createdAt": "2020-09-10T22:00:31Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n \t})\n \n-\tContext(\"when PXF_CONF is not set\", func() {\n+\tContext(\"when PXF_RUN is not set\", func() {\n \t\tBeforeEach(func() {\n \t\t\t_ = os.Setenv(\"GPHOME\", \"/test/gphome\")\n \t\t\t_ = os.Setenv(\"PXF_HOME\", \"/test/pxfhome\")\n-\t\t\t_ = os.Unsetenv(\"PXF_CONF\")\n+\t\t\t_ = os.Unsetenv(\"PXF_RUN\")\n \t\t\t_ = os.Unsetenv(\"JAVA_HOME\")\n \t\t})\n \n-\t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n-\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n-\t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n-\n-\t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n+\t\tIt(\"successfully generates stop, status, restart, and reset commands\", func() {\n+\t\t\tcommandFunc, err := cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n-\t\tIt(\"fails to init or sync\", func() {\n-\t\t\tcommandFunc, err := cmd.InitCommand.GetFunctionToExecute()\n+\t\tIt(\"fails to start, init or sync\", func() {\n+\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(commandFunc).To(BeNil())\n-\t\t\tExpect(err).To(Equal(errors.New(\"PXF_CONF must be set\")))\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))\n+\n+\t\t\tcommandFunc, err = cmd.InitCommand.GetFunctionToExecute()\n+\t\t\tExpect(commandFunc).To(BeNil())\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDA5Mzg1OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMDo1N1rOHQHPIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDo1NToxMVrOHQtmCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NzgyNg==", "bodyText": "sync should still work and sync from PXF_HOME", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486657826", "createdAt": "2020-09-10T22:00:57Z", "author": {"login": "denalex"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n \t})\n \n-\tContext(\"when PXF_CONF is not set\", func() {\n+\tContext(\"when PXF_RUN is not set\", func() {\n \t\tBeforeEach(func() {\n \t\t\t_ = os.Setenv(\"GPHOME\", \"/test/gphome\")\n \t\t\t_ = os.Setenv(\"PXF_HOME\", \"/test/pxfhome\")\n-\t\t\t_ = os.Unsetenv(\"PXF_CONF\")\n+\t\t\t_ = os.Unsetenv(\"PXF_RUN\")\n \t\t\t_ = os.Unsetenv(\"JAVA_HOME\")\n \t\t})\n \n-\t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n-\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n-\t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n-\n-\t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n+\t\tIt(\"successfully generates stop, status, restart, and reset commands\", func() {\n+\t\t\tcommandFunc, err := cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n-\t\tIt(\"fails to init or sync\", func() {\n-\t\t\tcommandFunc, err := cmd.InitCommand.GetFunctionToExecute()\n+\t\tIt(\"fails to start, init or sync\", func() {\n+\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(commandFunc).To(BeNil())\n-\t\t\tExpect(err).To(Equal(errors.New(\"PXF_CONF must be set\")))\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))\n+\n+\t\t\tcommandFunc, err = cmd.InitCommand.GetFunctionToExecute()\n+\t\t\tExpect(commandFunc).To(BeNil())\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))\n \n \t\t\tcommandFunc, err = cmd.SyncCommand.GetFunctionToExecute()\n \t\t\tExpect(commandFunc).To(BeNil())\n-\t\t\tExpect(err).To(Equal(errors.New(\"PXF_CONF must be set\")))\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI4NjI4Mw==", "bodyText": "yes, but the pxf command proxies the CLI (go) application. PXF_RUN is provided when the go application is run", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487286283", "createdAt": "2020-09-11T20:55:11Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/pxf_test.go", "diffHunk": "@@ -47,117 +47,117 @@ var _ = Describe(\"CommandFunc\", func() {\n \t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n \t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n+\t\t\tExpect(\"PXF_RUN=/test/somewhere/pxf_run /test/pxfhome/bin/pxf start\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n \t})\n \n-\tContext(\"when PXF_CONF is not set\", func() {\n+\tContext(\"when PXF_RUN is not set\", func() {\n \t\tBeforeEach(func() {\n \t\t\t_ = os.Setenv(\"GPHOME\", \"/test/gphome\")\n \t\t\t_ = os.Setenv(\"PXF_HOME\", \"/test/pxfhome\")\n-\t\t\t_ = os.Unsetenv(\"PXF_CONF\")\n+\t\t\t_ = os.Unsetenv(\"PXF_RUN\")\n \t\t\t_ = os.Unsetenv(\"JAVA_HOME\")\n \t\t})\n \n-\t\tIt(\"successfully generates start, stop, status, restart, and reset commands\", func() {\n-\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n-\t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf start\"))\n-\n-\t\t\tcommandFunc, err = cmd.StopCommand.GetFunctionToExecute()\n+\t\tIt(\"successfully generates stop, status, restart, and reset commands\", func() {\n+\t\t\tcommandFunc, err := cmd.StopCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf stop\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf stop\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.StatusCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf status\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf status\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.RestartCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf restart\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf restart\").To(Equal(commandFunc(\"foo\")))\n \n \t\t\tcommandFunc, err = cmd.ResetCommand.GetFunctionToExecute()\n \t\t\tExpect(err).To(BeNil())\n-\t\t\tExpect(commandFunc(\"foo\")).To(Equal(\"/test/pxfhome/bin/pxf reset --force\"))\n+\t\t\tExpect(\"/test/pxfhome/bin/pxf reset --force\").To(Equal(commandFunc(\"foo\")))\n \t\t})\n-\t\tIt(\"fails to init or sync\", func() {\n-\t\t\tcommandFunc, err := cmd.InitCommand.GetFunctionToExecute()\n+\t\tIt(\"fails to start, init or sync\", func() {\n+\t\t\tcommandFunc, err := cmd.StartCommand.GetFunctionToExecute()\n \t\t\tExpect(commandFunc).To(BeNil())\n-\t\t\tExpect(err).To(Equal(errors.New(\"PXF_CONF must be set\")))\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))\n+\n+\t\t\tcommandFunc, err = cmd.InitCommand.GetFunctionToExecute()\n+\t\t\tExpect(commandFunc).To(BeNil())\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))\n \n \t\t\tcommandFunc, err = cmd.SyncCommand.GetFunctionToExecute()\n \t\t\tExpect(commandFunc).To(BeNil())\n-\t\t\tExpect(err).To(Equal(errors.New(\"PXF_CONF must be set\")))\n+\t\t\tExpect(err).To(Equal(errors.New(\"PXF_RUN must be set\")))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NzgyNg=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 115}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDEwMDMwOnYy", "diffSide": "RIGHT", "path": "concourse/docker/pxf-dev-base/gpdb5/centos6/Dockerfile", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMzozM1rOHQHTCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowMzozM1rOHQHTCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1ODgyNg==", "bodyText": "this is redundant, it should only be set if different from PXF_HOME -- comment applies to all similar files", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486658826", "createdAt": "2020-09-10T22:03:33Z", "author": {"login": "denalex"}, "path": "concourse/docker/pxf-dev-base/gpdb5/centos6/Dockerfile", "diffHunk": "@@ -54,7 +54,7 @@ RUN ssh-keygen -t rsa -N \"\" -f /root/.ssh/id_rsa \\\n     && echo >> ~gpadmin/.pxfrc 'export LD_LIBRARY_PATH=${GPHOME}/lib:${LD_LIBRARY_PATH-}' \\\n     && echo >> ~gpadmin/.pxfrc 'export GPHD_ROOT=/singlecluster' \\\n     && echo >> ~gpadmin/.pxfrc 'export PXF_HOME=/usr/local/pxf-gp5' \\\n-    && echo >> ~gpadmin/.pxfrc 'export PXF_CONF=/home/gpadmin/pxf' \\\n+    && echo >> ~gpadmin/.pxfrc 'export PXF_RUN=/usr/local/pxf-gp5' \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDEwMjM5OnYy", "diffSide": "RIGHT", "path": "concourse/scripts/cli/common.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowNDoyMlrOHQHUXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDoxMDo1MVrOHQsahQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1OTE2Ng==", "bodyText": "not sure if this change is intended or not", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486659166", "createdAt": "2020-09-10T22:04:22Z", "author": {"login": "denalex"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -17,7 +17,8 @@ compare() {\n \tlocal usage='compare <expected_text> <text_to_compare> <msg>'\n \tlocal expected=${1:?${usage}} text=${2:?${usage}} msg=\"$(( ++test_cnt ))) ${3:?${usage}}\"\n \techo -e \"${yellow}${msg}${white}:\"\n-\tif [[ ${expected} == \"${text//\r/}\" ]]; then # clean up any cairrage returns\n+\tif [[ ${expected} == \"${text//\n+/}\" ]]; then # clean up any carriage returns", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI2Njk0OQ==", "bodyText": "not intended, thanks!", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487266949", "createdAt": "2020-09-11T20:10:51Z", "author": {"login": "frankgh"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -17,7 +17,8 @@ compare() {\n \tlocal usage='compare <expected_text> <text_to_compare> <msg>'\n \tlocal expected=${1:?${usage}} text=${2:?${usage}} msg=\"$(( ++test_cnt ))) ${3:?${usage}}\"\n \techo -e \"${yellow}${msg}${white}:\"\n-\tif [[ ${expected} == \"${text//\r/}\" ]]; then # clean up any cairrage returns\n+\tif [[ ${expected} == \"${text//\n+/}\" ]]; then # clean up any carriage returns", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1OTE2Ng=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDExNTExOnYy", "diffSide": "RIGHT", "path": "concourse/scripts/test_pxf_multinode.bash", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowOTozNVrOHQHcRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjowOTozNVrOHQHcRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2MTE5MQ==", "bodyText": "this is not very clear and general enough now -- if PXF_RUN == PXF_HOME, then the directory will already exist without register being performed and register will be skipped", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486661191", "createdAt": "2020-09-10T22:09:35Z", "author": {"login": "denalex"}, "path": "concourse/scripts/test_pxf_multinode.bash", "diffHunk": "@@ -79,61 +79,61 @@ function setup_pxf_on_cluster() {\n \t# drop named query file for JDBC test to gpadmin's home on mdw\n \tscp \"${SSH_OPTS[@]}\" pxf_src/automation/src/test/resources/{,hive-}report.sql gpadmin@mdw:\n \n-\t# init all PXFs using cluster command, configure PXF on master, sync configs and start pxf\n+\t# configure PXF on master, sync configs and start pxf\n \tssh \"${SSH_OPTS[@]}\" gpadmin@mdw \"\n \t\tsource ${GPHOME}/greenplum_path.sh &&\n-\t\tif [[ ! -d ${PXF_CONF_DIR} ]]; then\n-\t\t\tGPHOME=${GPHOME} PXF_CONF=${PXF_CONF_DIR} ${PXF_HOME}/bin/pxf cluster init\n-\t\t\tcp ${PXF_CONF_DIR}/templates/{hdfs,mapred,yarn,core,hbase,hive}-site.xml ${PXF_CONF_DIR}/servers/default\n-\t\t\tsed -i -e 's/\\(0.0.0.0\\|localhost\\|127.0.0.1\\)/${hadoop_ip}/g' ${PXF_CONF_DIR}/servers/default/*-site.xml\n+\t\tif [[ ! -d ${PXF_RUN_DIR} ]]; then\n+\t\t\t${PXF_HOME}/bin/pxf cluster register", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDEyMDA5OnYy", "diffSide": "RIGHT", "path": "concourse/scripts/test_pxf_multinode.bash", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoxMTo0NFrOHQHfUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDozMToxMVrOHQs9ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2MTk2OA==", "bodyText": "do we need to chown -R gpadmin:gpadmin ${PXF_RUN_DIR} then ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486661968", "createdAt": "2020-09-10T22:11:44Z", "author": {"login": "denalex"}, "path": "concourse/scripts/test_pxf_multinode.bash", "diffHunk": "@@ -316,7 +316,7 @@ function run_pxf_automation() {\n \telse\n \t\tsed -i 's/sutFile=default.xml/sutFile=MultiNodesCluster.xml/g' pxf_src/automation/jsystem.properties\n \tfi\n-\tchown -R gpadmin:gpadmin ~gpadmin/{.ssh,pxf} pxf_src/automation\n+\tchown -R gpadmin:gpadmin ~gpadmin/.ssh pxf_src/automation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 235}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI3NTkzNA==", "bodyText": "this is already done during RPM installation, assuming PXF_HOME is PXF_RUN_DIR, which is the case for this test", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487275934", "createdAt": "2020-09-11T20:31:11Z", "author": {"login": "frankgh"}, "path": "concourse/scripts/test_pxf_multinode.bash", "diffHunk": "@@ -316,7 +316,7 @@ function run_pxf_automation() {\n \telse\n \t\tsed -i 's/sutFile=default.xml/sutFile=MultiNodesCluster.xml/g' pxf_src/automation/jsystem.properties\n \tfi\n-\tchown -R gpadmin:gpadmin ~gpadmin/{.ssh,pxf} pxf_src/automation\n+\tchown -R gpadmin:gpadmin ~gpadmin/.ssh pxf_src/automation", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2MTk2OA=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 235}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDEzMTM0OnYy", "diffSide": "RIGHT", "path": "package/pxf-gp5.spec", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoxNjozMFrOHQHmRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDoxMjo1M1rOHQseJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2Mzc1MQ==", "bodyText": "maybe it's better to create them during staging process ? Also test rpm rebuilding job to make sure the included script there does not break things now.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486663751", "createdAt": "2020-09-10T22:16:30Z", "author": {"login": "denalex"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -36,6 +36,8 @@ fi\n \n %files\n %{prefix}\n+%attr(700, -, -) %dir %{prefix}/logs\n+%attr(700, -, -) %dir %{prefix}/run", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI2NzcxMQ==", "bodyText": "they are created during the stage process, the permissions get set during install. We are running all jobs in a test pipeline (hdfs + clouds + multinode, etc), are you referring to a specific job or build process? The pipeline is green", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487267711", "createdAt": "2020-09-11T20:12:33Z", "author": {"login": "frankgh"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -36,6 +36,8 @@ fi\n \n %files\n %{prefix}\n+%attr(700, -, -) %dir %{prefix}/logs\n+%attr(700, -, -) %dir %{prefix}/run", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2Mzc1MQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI2Nzg3OA==", "bodyText": "https://ud.ci.gpdb.pivotal.io/teams/main/pipelines/dev:fguerrero-spring-boot-init", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487267878", "createdAt": "2020-09-11T20:12:53Z", "author": {"login": "frankgh"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -36,6 +36,8 @@ fi\n \n %files\n %{prefix}\n+%attr(700, -, -) %dir %{prefix}/logs\n+%attr(700, -, -) %dir %{prefix}/run", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2Mzc1MQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDEzMzcwOnYy", "diffSide": "RIGHT", "path": "regression/Makefile", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoxNzowMVrOHQHnjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoxNzowMVrOHQHnjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2NDA3Ng==", "bodyText": "not required, should default to PXF_HOME", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486664076", "createdAt": "2020-09-10T22:17:01Z", "author": {"login": "denalex"}, "path": "regression/Makefile", "diffHunk": "@@ -1,8 +1,8 @@\n ifndef GPHOME\n $(error GPHOME is not defined)\n endif\n-ifndef PXF_CONF\n-$(error PXF_CONF is not defined)\n+ifndef PXF_RUN\n+$(error PXF_RUN is not defined)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDEzODA2OnYy", "diffSide": "RIGHT", "path": "regression/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoxODoxMlrOHQHqNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoxODoxMlrOHQHqNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2NDc1Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            All the general environment variables that come from `greenplum_path.sh` and `gpdemo-env.sh`, along with `PXF_RUN` must be set.\n          \n          \n            \n            All the general environment variables that come from `greenplum_path.sh` and `gpdemo-env.sh`. Additionally, `PXF_RUN` must be set if different from `PXF_HOME`.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486664757", "createdAt": "2020-09-10T22:18:12Z", "author": {"login": "denalex"}, "path": "regression/README.md", "diffHunk": "@@ -46,10 +46,10 @@ By setting environment variables you can change the location of the Greenplum ma\n \n ### General environment variables\n \n-All the general environment variables that come from `greenplum_path.sh` and `gpdemo-env.sh`, along with `PXF_CONF` must be set.\n+All the general environment variables that come from `greenplum_path.sh` and `gpdemo-env.sh`, along with `PXF_RUN` must be set.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE1NTg1OnYy", "diffSide": "RIGHT", "path": "server/pxf-api/src/main/java/org/greenplum/pxf/api/model/BaseConfigurationFactory.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoyNTozNFrOHQH03A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoyNTozNFrOHQH03A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2NzQ4NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this(new File(String.format(\"%s%sservers\", pxfServerProperties.getRun(), File.separator)));\n          \n          \n            \n                    this(new File(String.format(\"%s%sservers\", pxfServerProperties.getRunDir(), File.separator)));\n          \n      \n    \n    \n  \n\nmaybe name that method better", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486667484", "createdAt": "2020-09-10T22:25:34Z", "author": {"login": "denalex"}, "path": "server/pxf-api/src/main/java/org/greenplum/pxf/api/model/BaseConfigurationFactory.java", "diffHunk": "@@ -27,7 +27,7 @@\n \n     @Autowired\n     public BaseConfigurationFactory(PxfServerProperties pxfServerProperties) {\n-        this(new File(String.format(\"%s%sservers\", pxfServerProperties.getConf(), File.separator)));\n+        this(new File(String.format(\"%s%sservers\", pxfServerProperties.getRun(), File.separator)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE2MzI0OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/main/resources/banner.txt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoyODo0N1rOHQH5Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjoyODo0N1rOHQH5Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2ODYzNQ==", "bodyText": "wow ! :-)", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486668635", "createdAt": "2020-09-10T22:28:47Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/main/resources/banner.txt", "diffHunk": "@@ -0,0 +1,10 @@\n+\n+.______   ___   ___  _______ \n+|   _  \\  \\  \\ /  / |   ____|\n+|  |_)  |  \\  V  /  |  |__   \n+|   ___/    >   <   |   __|  \n+|  |       /  .  \\  |  |     \n+| _|      /__/ \\__\\ |__|     \n+                             \n+\n+:: Built with Spring Boot :: ${spring-boot.version}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE3MTU5OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozMjoyM1rOHQH-Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMTo0MToyNlrOHTFOmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2OTg3NQ==", "bodyText": "need to apply new logic here ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486669875", "createdAt": "2020-09-10T22:32:23Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI3ODMyMA==", "bodyText": "will need to rebase or merge", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487278320", "createdAt": "2020-09-11T20:36:02Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2OTg3NQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc3MDY1MA==", "bodyText": "done", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489770650", "createdAt": "2020-09-16T21:41:26Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2OTg3NQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE3NDgzOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozMzozNFrOHQH_-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozMzozNFrOHQH_-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MDMzMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            export PXF_RUNDIR=${PXF_HOME}/run\n          \n          \n            \n            export PXF_RUNDIR=${PXF_RUNDIR:=${PXF_RUN}/run}", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486670331", "createdAt": "2020-09-10T22:33:34Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}\n+\n+# Path to JAVA\n+export JAVA_HOME=${JAVA_HOME:=/usr/java/default}\n+\n+# Path to Log directory\n+export PXF_LOGDIR=${PXF_LOGDIR:=${PXF_RUN}/logs}\n+\n+# Path to Run directory\n+export PXF_RUNDIR=${PXF_HOME}/run", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE3NTk1OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozNDowNVrOHQIAtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozNDowNVrOHQIAtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MDUxOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n          \n          \n            \n            export PXF_RUN=${PXF_RUN:=$PXF_HOME}", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486670519", "createdAt": "2020-09-10T22:34:05Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE3OTE2OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozNToxOVrOHQICkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDozNjo0NlrOHQtISQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MDk5NQ==", "bodyText": "this ^^ not gonna work, we have to assume this file is read-only", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486670995", "createdAt": "2020-09-10T22:35:19Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}\n+\n+# Path to JAVA\n+export JAVA_HOME=${JAVA_HOME:=/usr/java/default}\n+\n+# Path to Log directory\n+export PXF_LOGDIR=${PXF_LOGDIR:=${PXF_RUN}/logs}\n+\n+# Path to Run directory\n+export PXF_RUNDIR=${PXF_HOME}/run\n+\n+# Port\n+export PXF_PORT=${PXF_PORT:=5888}\n+\n+# Memory\n+export PXF_JVM_OPTS=${PXF_JVM_OPTS:='-Xmx2g -Xms1g'}\n+\n+# Set to true to enable Remote debug via port 2020\n+export PXF_DEBUG=${PXF_DEBUG:-false}\n+\n+# Kill PXF on OutOfMemoryError, set to false to disable\n+export PXF_OOM_KILL=${PXF_OOM_KILL:-true}\n+\n+# Dump heap on OutOfMemoryError, set to dump path to enable\n+# export PXF_OOM_DUMP_PATH=", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI3ODY2NQ==", "bodyText": "true, removing", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487278665", "createdAt": "2020-09-11T20:36:46Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}\n+\n+# Path to JAVA\n+export JAVA_HOME=${JAVA_HOME:=/usr/java/default}\n+\n+# Path to Log directory\n+export PXF_LOGDIR=${PXF_LOGDIR:=${PXF_RUN}/logs}\n+\n+# Path to Run directory\n+export PXF_RUNDIR=${PXF_HOME}/run\n+\n+# Port\n+export PXF_PORT=${PXF_PORT:=5888}\n+\n+# Memory\n+export PXF_JVM_OPTS=${PXF_JVM_OPTS:='-Xmx2g -Xms1g'}\n+\n+# Set to true to enable Remote debug via port 2020\n+export PXF_DEBUG=${PXF_DEBUG:-false}\n+\n+# Kill PXF on OutOfMemoryError, set to false to disable\n+export PXF_OOM_KILL=${PXF_OOM_KILL:-true}\n+\n+# Dump heap on OutOfMemoryError, set to dump path to enable\n+# export PXF_OOM_DUMP_PATH=", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MDk5NQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE4MjAxOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozNjoyN1rOHQIELA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMjo1NDo1N1rOHQv6qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MTQwNA==", "bodyText": "can we use the new syntax with + for expansion of unset variables to nothing and do 1-liner here ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486671404", "createdAt": "2020-09-10T22:36:27Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}\n+\n+# Path to JAVA\n+export JAVA_HOME=${JAVA_HOME:=/usr/java/default}\n+\n+# Path to Log directory\n+export PXF_LOGDIR=${PXF_LOGDIR:=${PXF_RUN}/logs}\n+\n+# Path to Run directory\n+export PXF_RUNDIR=${PXF_HOME}/run\n+\n+# Port\n+export PXF_PORT=${PXF_PORT:=5888}\n+\n+# Memory\n+export PXF_JVM_OPTS=${PXF_JVM_OPTS:='-Xmx2g -Xms1g'}\n+\n+# Set to true to enable Remote debug via port 2020\n+export PXF_DEBUG=${PXF_DEBUG:-false}\n+\n+# Kill PXF on OutOfMemoryError, set to false to disable\n+export PXF_OOM_KILL=${PXF_OOM_KILL:-true}\n+\n+# Dump heap on OutOfMemoryError, set to dump path to enable\n+# export PXF_OOM_DUMP_PATH=\n+\n+# Additional locations to be class-loaded by the application\n+if [[ -n \"${PXF_LOADER_PATH}\" ]]; then\n+  export LOADER_PATH=\"${PXF_LOADER_PATH},file:${PXF_RUN}/conf,file:${PXF_RUN}/lib\"\n+else\n+  export LOADER_PATH=\"file:${PXF_RUN}/conf,file:${PXF_RUN}/lib\"\n+fi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMyNDMzMA==", "bodyText": "done!", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487324330", "createdAt": "2020-09-11T22:54:57Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n+\n+# Default PXF_HOME\n+export PXF_HOME=${PXF_HOME:=${PARENT_SCRIPT_DIR}}\n+\n+# Path to PXF_RUN directories, defaults to PXF_HOME\n+export PXF_RUN=${PXF_RUN:-$PXF_HOME}\n+\n+[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"\n+\n+# Path to HDFS native libraries\n+export LD_LIBRARY_PATH=/usr/lib/hadoop/lib/native:${LD_LIBRARY_PATH}\n+\n+# Path to JAVA\n+export JAVA_HOME=${JAVA_HOME:=/usr/java/default}\n+\n+# Path to Log directory\n+export PXF_LOGDIR=${PXF_LOGDIR:=${PXF_RUN}/logs}\n+\n+# Path to Run directory\n+export PXF_RUNDIR=${PXF_HOME}/run\n+\n+# Port\n+export PXF_PORT=${PXF_PORT:=5888}\n+\n+# Memory\n+export PXF_JVM_OPTS=${PXF_JVM_OPTS:='-Xmx2g -Xms1g'}\n+\n+# Set to true to enable Remote debug via port 2020\n+export PXF_DEBUG=${PXF_DEBUG:-false}\n+\n+# Kill PXF on OutOfMemoryError, set to false to disable\n+export PXF_OOM_KILL=${PXF_OOM_KILL:-true}\n+\n+# Dump heap on OutOfMemoryError, set to dump path to enable\n+# export PXF_OOM_DUMP_PATH=\n+\n+# Additional locations to be class-loaded by the application\n+if [[ -n \"${PXF_LOADER_PATH}\" ]]; then\n+  export LOADER_PATH=\"${PXF_LOADER_PATH},file:${PXF_RUN}/conf,file:${PXF_RUN}/lib\"\n+else\n+  export LOADER_PATH=\"file:${PXF_RUN}/conf,file:${PXF_RUN}/lib\"\n+fi", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MTQwNA=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE4NDYxOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozNzozNVrOHQIFrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozNzozNVrOHQIFrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MTc4OA==", "bodyText": "not sure if this is symlink friendly, there seems to be logic below that does symlinks", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486671788", "createdAt": "2020-09-10T22:37:35Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -24,6 +24,50 @@\n \n WORKING_DIR=\"$(pwd)\"\n \n+PARENT_SCRIPT_DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE4OTcwOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjozOTozNlrOHQIImQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMjoyMjoxMVrOHTGM-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MjUzNw==", "bodyText": "maybe it's time to rename it to just pxf.jar or pxf-app.jar form pxf-service.jar ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486672537", "createdAt": "2020-09-10T22:39:36Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -41,8 +85,7 @@ export PXF_HOME=$parent_script_dir\n [[ -z \"$STOP_WAIT_TIME\" ]] && STOP_WAIT_TIME=\"60\"\n identity=\"pxf-service\"\n \n-jarfile=\"${PXF_HOME}/server/pxf-service-_PXF_VERSION_.jar\"\n-default_env_script=${PXF_HOME}/conf/pxf-env-default.sh\n+jarfile=\"${PXF_HOME}/application/pxf-service-_PXF_VERSION_.jar\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc4NjYxNw==", "bodyText": "it's been renamed to pxf-app now.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489786617", "createdAt": "2020-09-16T22:22:11Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -41,8 +85,7 @@ export PXF_HOME=$parent_script_dir\n [[ -z \"$STOP_WAIT_TIME\" ]] && STOP_WAIT_TIME=\"60\"\n identity=\"pxf-service\"\n \n-jarfile=\"${PXF_HOME}/server/pxf-service-_PXF_VERSION_.jar\"\n-default_env_script=${PXF_HOME}/conf/pxf-env-default.sh\n+jarfile=\"${PXF_HOME}/application/pxf-service-_PXF_VERSION_.jar\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MjUzNw=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE5NzUxOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo0Mjo0MFrOHQINDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDozODowN1rOHQtKjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MzY3OQ==", "bodyText": "are we still sourcing the file ? where ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486673679", "createdAt": "2020-09-10T22:42:40Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -61,68 +104,21 @@ function validate_user()\n     [[ $EUID == 0 ]] && fail 'Cannot run as root user'\n }\n \n-function confirm_with_user()\n-{\n-    echoGreen  '*****************************************************************************'\n-    echoGreen  '* The PXF_CONF variable is not defined, using default location'\n-    echoGreen  \"* Using ${PXF_CONF} for user configurations\"\n-    echoYellow '* WARNING: using this directory is not recommended for production deployments'\n-    echoGreen  '*****************************************************************************'\n-\n-    read -rp 'Do you want to proceed? [Y]: ' answer\n-    answer=${answer:-'Y'}\n-    case ${answer:0:1} in\n-        y|Y)\n-            echoGreen 'Proceeding with the initialization'\n-        ;;\n-        *)\n-            echoYellow 'Initialization aborted'\n-            exit 1\n-        ;;\n-    esac\n-}\n-\n-function update_pxf_conf()\n-{\n-    if [[ -z $PXF_CONF ]]; then\n-        # PXF_CONF was not specified during init command\n-        # need to default to user's home directory and ask for confirmation, unless silent mode is used\n-        local current_user pxf_user_home\n-        current_user=$( id -un )\n-        pxf_user_home=$HOME\n-        if [[ -z $pxf_user_home ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory is not defined\"\n-        elif [[ ! -d ${pxf_user_home} ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory $pxf_user_home does not exist\"\n-        else\n-            export PXF_CONF=${pxf_user_home}/pxf\n-            if [[ $silent == false ]]; then\n-                confirm_with_user\n-            fi\n-        fi\n-    fi\n-\n-    echoYellow \"Using $PXF_CONF as a location for user-configurable files\"\n-\n-    # update the value on PXF_CONF in the default env file\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-.*}$|{PXF_CONF:-\\\"${PXF_CONF}\\\"}|g\" \"$default_env_script\"\n-}\n-\n function getEnvironment()\n {\n     local USER_SPECIFIED_JAVA_HOME=${JAVA_HOME}\n-    # load default environment\n-    if [[ ! -f $default_env_script ]]; then\n-        fail \"Failed to find $default_env_script\"\n-    fi\n-    # shellcheck source=/Users/pivotal/workspace/pxf/server/pxf-service/src/scripts/pxf-env-default.sh\n-    source \"$default_env_script\"\n     # we may have just overridden the user's intended JAVA_HOME\n-    # by sourcing PXF_CONF/conf/pxf-env.sh\n+    # by sourcing PXF_RUN/conf/pxf-env.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI3OTI0NA==", "bodyText": "we source it in this file:\n[[ -f ${PXF_RUN}/conf/pxf-env.sh ]] && source \"${PXF_RUN}/conf/pxf-env.sh\"", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487279244", "createdAt": "2020-09-11T20:38:07Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -61,68 +104,21 @@ function validate_user()\n     [[ $EUID == 0 ]] && fail 'Cannot run as root user'\n }\n \n-function confirm_with_user()\n-{\n-    echoGreen  '*****************************************************************************'\n-    echoGreen  '* The PXF_CONF variable is not defined, using default location'\n-    echoGreen  \"* Using ${PXF_CONF} for user configurations\"\n-    echoYellow '* WARNING: using this directory is not recommended for production deployments'\n-    echoGreen  '*****************************************************************************'\n-\n-    read -rp 'Do you want to proceed? [Y]: ' answer\n-    answer=${answer:-'Y'}\n-    case ${answer:0:1} in\n-        y|Y)\n-            echoGreen 'Proceeding with the initialization'\n-        ;;\n-        *)\n-            echoYellow 'Initialization aborted'\n-            exit 1\n-        ;;\n-    esac\n-}\n-\n-function update_pxf_conf()\n-{\n-    if [[ -z $PXF_CONF ]]; then\n-        # PXF_CONF was not specified during init command\n-        # need to default to user's home directory and ask for confirmation, unless silent mode is used\n-        local current_user pxf_user_home\n-        current_user=$( id -un )\n-        pxf_user_home=$HOME\n-        if [[ -z $pxf_user_home ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory is not defined\"\n-        elif [[ ! -d ${pxf_user_home} ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory $pxf_user_home does not exist\"\n-        else\n-            export PXF_CONF=${pxf_user_home}/pxf\n-            if [[ $silent == false ]]; then\n-                confirm_with_user\n-            fi\n-        fi\n-    fi\n-\n-    echoYellow \"Using $PXF_CONF as a location for user-configurable files\"\n-\n-    # update the value on PXF_CONF in the default env file\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-.*}$|{PXF_CONF:-\\\"${PXF_CONF}\\\"}|g\" \"$default_env_script\"\n-}\n-\n function getEnvironment()\n {\n     local USER_SPECIFIED_JAVA_HOME=${JAVA_HOME}\n-    # load default environment\n-    if [[ ! -f $default_env_script ]]; then\n-        fail \"Failed to find $default_env_script\"\n-    fi\n-    # shellcheck source=/Users/pivotal/workspace/pxf/server/pxf-service/src/scripts/pxf-env-default.sh\n-    source \"$default_env_script\"\n     # we may have just overridden the user's intended JAVA_HOME\n-    # by sourcing PXF_CONF/conf/pxf-env.sh\n+    # by sourcing PXF_RUN/conf/pxf-env.sh", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MzY3OQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDE5OTQwOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo0Mzo0MVrOHQIOTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDo0NjoxNVrOHQtYOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3Mzk5OA==", "bodyText": "remove comment ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486673998", "createdAt": "2020-09-10T22:43:41Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -61,68 +104,21 @@ function validate_user()\n     [[ $EUID == 0 ]] && fail 'Cannot run as root user'\n }\n \n-function confirm_with_user()\n-{\n-    echoGreen  '*****************************************************************************'\n-    echoGreen  '* The PXF_CONF variable is not defined, using default location'\n-    echoGreen  \"* Using ${PXF_CONF} for user configurations\"\n-    echoYellow '* WARNING: using this directory is not recommended for production deployments'\n-    echoGreen  '*****************************************************************************'\n-\n-    read -rp 'Do you want to proceed? [Y]: ' answer\n-    answer=${answer:-'Y'}\n-    case ${answer:0:1} in\n-        y|Y)\n-            echoGreen 'Proceeding with the initialization'\n-        ;;\n-        *)\n-            echoYellow 'Initialization aborted'\n-            exit 1\n-        ;;\n-    esac\n-}\n-\n-function update_pxf_conf()\n-{\n-    if [[ -z $PXF_CONF ]]; then\n-        # PXF_CONF was not specified during init command\n-        # need to default to user's home directory and ask for confirmation, unless silent mode is used\n-        local current_user pxf_user_home\n-        current_user=$( id -un )\n-        pxf_user_home=$HOME\n-        if [[ -z $pxf_user_home ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory is not defined\"\n-        elif [[ ! -d ${pxf_user_home} ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory $pxf_user_home does not exist\"\n-        else\n-            export PXF_CONF=${pxf_user_home}/pxf\n-            if [[ $silent == false ]]; then\n-                confirm_with_user\n-            fi\n-        fi\n-    fi\n-\n-    echoYellow \"Using $PXF_CONF as a location for user-configurable files\"\n-\n-    # update the value on PXF_CONF in the default env file\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-.*}$|{PXF_CONF:-\\\"${PXF_CONF}\\\"}|g\" \"$default_env_script\"\n-}\n-\n function getEnvironment()\n {\n     local USER_SPECIFIED_JAVA_HOME=${JAVA_HOME}\n-    # load default environment\n-    if [[ ! -f $default_env_script ]]; then\n-        fail \"Failed to find $default_env_script\"\n-    fi\n-    # shellcheck source=/Users/pivotal/workspace/pxf/server/pxf-service/src/scripts/pxf-env-default.sh\n-    source \"$default_env_script\"\n     # we may have just overridden the user's intended JAVA_HOME\n-    # by sourcing PXF_CONF/conf/pxf-env.sh\n+    # by sourcing PXF_RUN/conf/pxf-env.sh\n     [[ ${PRESERVE_JAVA_HOME} == true ]] && JAVA_HOME=${USER_SPECIFIED_JAVA_HOME}\n     pid_file=\"$PXF_RUNDIR/${identity}.pid\"\n }\n \n+function checkPermissions()\n+{\n+    touch \"$pid_file\" &> /dev/null || { echoRed \"ERROR: Operation not permitted (cannot access pid file: '$pid_file')\"; return 4; }\n+    # [ ! -d \"$PXF_LOGDIR\" ] && { echoRed \"Operation not permitted (log directory does not exist: '$PXF_LOGDIR')\"; return 4; }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI4Mjc0NQ==", "bodyText": "i forgot to uncomment actually", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487282745", "createdAt": "2020-09-11T20:46:15Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -61,68 +104,21 @@ function validate_user()\n     [[ $EUID == 0 ]] && fail 'Cannot run as root user'\n }\n \n-function confirm_with_user()\n-{\n-    echoGreen  '*****************************************************************************'\n-    echoGreen  '* The PXF_CONF variable is not defined, using default location'\n-    echoGreen  \"* Using ${PXF_CONF} for user configurations\"\n-    echoYellow '* WARNING: using this directory is not recommended for production deployments'\n-    echoGreen  '*****************************************************************************'\n-\n-    read -rp 'Do you want to proceed? [Y]: ' answer\n-    answer=${answer:-'Y'}\n-    case ${answer:0:1} in\n-        y|Y)\n-            echoGreen 'Proceeding with the initialization'\n-        ;;\n-        *)\n-            echoYellow 'Initialization aborted'\n-            exit 1\n-        ;;\n-    esac\n-}\n-\n-function update_pxf_conf()\n-{\n-    if [[ -z $PXF_CONF ]]; then\n-        # PXF_CONF was not specified during init command\n-        # need to default to user's home directory and ask for confirmation, unless silent mode is used\n-        local current_user pxf_user_home\n-        current_user=$( id -un )\n-        pxf_user_home=$HOME\n-        if [[ -z $pxf_user_home ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory is not defined\"\n-        elif [[ ! -d ${pxf_user_home} ]]; then\n-            fail \"PXF_CONF is not set and user $current_user home directory $pxf_user_home does not exist\"\n-        else\n-            export PXF_CONF=${pxf_user_home}/pxf\n-            if [[ $silent == false ]]; then\n-                confirm_with_user\n-            fi\n-        fi\n-    fi\n-\n-    echoYellow \"Using $PXF_CONF as a location for user-configurable files\"\n-\n-    # update the value on PXF_CONF in the default env file\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-.*}$|{PXF_CONF:-\\\"${PXF_CONF}\\\"}|g\" \"$default_env_script\"\n-}\n-\n function getEnvironment()\n {\n     local USER_SPECIFIED_JAVA_HOME=${JAVA_HOME}\n-    # load default environment\n-    if [[ ! -f $default_env_script ]]; then\n-        fail \"Failed to find $default_env_script\"\n-    fi\n-    # shellcheck source=/Users/pivotal/workspace/pxf/server/pxf-service/src/scripts/pxf-env-default.sh\n-    source \"$default_env_script\"\n     # we may have just overridden the user's intended JAVA_HOME\n-    # by sourcing PXF_CONF/conf/pxf-env.sh\n+    # by sourcing PXF_RUN/conf/pxf-env.sh\n     [[ ${PRESERVE_JAVA_HOME} == true ]] && JAVA_HOME=${USER_SPECIFIED_JAVA_HOME}\n     pid_file=\"$PXF_RUNDIR/${identity}.pid\"\n }\n \n+function checkPermissions()\n+{\n+    touch \"$pid_file\" &> /dev/null || { echoRed \"ERROR: Operation not permitted (cannot access pid file: '$pid_file')\"; return 4; }\n+    # [ ! -d \"$PXF_LOGDIR\" ] && { echoRed \"Operation not permitted (log directory does not exist: '$PXF_LOGDIR')\"; return 4; }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3Mzk5OA=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 131}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDIwMjk2OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo0NDo1NVrOHQIQQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo0NDo1NVrOHQIQQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NDQ5Nw==", "bodyText": "maybe list deprecated commands in a separate section below", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486674497", "createdAt": "2020-09-10T22:44:55Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -277,21 +211,20 @@ doHelp() {\n     cat <<-EOF\n \n \t${bold}List of commands${normal}:\n-\t  init                initialize the local PXF server instance, install PXF extension under \\$GPHOME\n+\t  init                (deprecated) install PXF extension under \\$GPHOME\n \t  start               start the local PXF server instance\n \t  stop                stop the local PXF server instance\n \t  restart             restart the local PXF server instance (not supported for cluster)\n \t  status              show the status of the local PXF server instance\n \t  version             show the version of PXF server\n-\t  reset               undo the local PXF initialization\n+\t  reset               (deprecated) no operation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 227}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDIxNTM0OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo1MDo1M1rOHQIXiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMTo0MjozM1rOHTFQeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NjM2MQ==", "bodyText": "do we need -R if we are copying only 1 file ?\nmaybe now have files under our gpextable without full subdirectories ?\nwe should not be doing sed on the target file under GPHOME", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486676361", "createdAt": "2020-09-10T22:50:53Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -305,73 +238,51 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'\n }\n \n function installExternalTableExtension()\n {\n     if [[ -d ${parent_script_dir}/gpextable ]]; then\n         if [[ -z \"${GPHOME}\" ]]; then\n-            echo 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n+            echoYellow 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n         elif [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n-            echo \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n+            echoYellow \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n         else\n-            echo \"Installing Greenplum External Table PXF Extension into ${GPHOME}\"\n-            cp -av ${parent_script_dir}/gpextable/* ${GPHOME}\n+            echoGreen \"Installing Greenplum External Table PXF Extension into '${GPHOME}'\"\n+\n+            local target_control_file=\"${GPHOME}/share/postgresql/extension/pxf.control\"\n+            cp -RLv \"${parent_script_dir}/gpextable/share/postgresql/extension/pxf.control\" \"${target_control_file}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 293}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzODAxOA==", "bodyText": "for # 3 do it at the deb/rpm level instead.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487338018", "createdAt": "2020-09-12T00:00:26Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -305,73 +238,51 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'\n }\n \n function installExternalTableExtension()\n {\n     if [[ -d ${parent_script_dir}/gpextable ]]; then\n         if [[ -z \"${GPHOME}\" ]]; then\n-            echo 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n+            echoYellow 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n         elif [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n-            echo \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n+            echoYellow \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n         else\n-            echo \"Installing Greenplum External Table PXF Extension into ${GPHOME}\"\n-            cp -av ${parent_script_dir}/gpextable/* ${GPHOME}\n+            echoGreen \"Installing Greenplum External Table PXF Extension into '${GPHOME}'\"\n+\n+            local target_control_file=\"${GPHOME}/share/postgresql/extension/pxf.control\"\n+            cp -RLv \"${parent_script_dir}/gpextable/share/postgresql/extension/pxf.control\" \"${target_control_file}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NjM2MQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 293}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzODAzOA==", "bodyText": "check with @bradfordb-vmware", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487338038", "createdAt": "2020-09-12T00:00:35Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -305,73 +238,51 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'\n }\n \n function installExternalTableExtension()\n {\n     if [[ -d ${parent_script_dir}/gpextable ]]; then\n         if [[ -z \"${GPHOME}\" ]]; then\n-            echo 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n+            echoYellow 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n         elif [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n-            echo \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n+            echoYellow \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n         else\n-            echo \"Installing Greenplum External Table PXF Extension into ${GPHOME}\"\n-            cp -av ${parent_script_dir}/gpextable/* ${GPHOME}\n+            echoGreen \"Installing Greenplum External Table PXF Extension into '${GPHOME}'\"\n+\n+            local target_control_file=\"${GPHOME}/share/postgresql/extension/pxf.control\"\n+            cp -RLv \"${parent_script_dir}/gpextable/share/postgresql/extension/pxf.control\" \"${target_control_file}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NjM2MQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 293}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc3MTEyOA==", "bodyText": "Removed -R\ngpextable does not have subdirectories\nsed is being done at RPM in %post section", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489771128", "createdAt": "2020-09-16T21:42:33Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -305,73 +238,51 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'\n }\n \n function installExternalTableExtension()\n {\n     if [[ -d ${parent_script_dir}/gpextable ]]; then\n         if [[ -z \"${GPHOME}\" ]]; then\n-            echo 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n+            echoYellow 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n         elif [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n-            echo \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n+            echoYellow \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n         else\n-            echo \"Installing Greenplum External Table PXF Extension into ${GPHOME}\"\n-            cp -av ${parent_script_dir}/gpextable/* ${GPHOME}\n+            echoGreen \"Installing Greenplum External Table PXF Extension into '${GPHOME}'\"\n+\n+            local target_control_file=\"${GPHOME}/share/postgresql/extension/pxf.control\"\n+            cp -RLv \"${parent_script_dir}/gpextable/share/postgresql/extension/pxf.control\" \"${target_control_file}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NjM2MQ=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 293}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDIxODQ1OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo1MjoyMFrOHQIZYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMTo1MDoxMVrOHT2v1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NjgzNA==", "bodyText": "VVV we used to remember JAVA_HOME given to us upon init, what is gonna happen now ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486676834", "createdAt": "2020-09-10T22:52:20Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -305,73 +238,51 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'\n }\n \n function installExternalTableExtension()\n {\n     if [[ -d ${parent_script_dir}/gpextable ]]; then\n         if [[ -z \"${GPHOME}\" ]]; then\n-            echo 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n+            echoYellow 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n         elif [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n-            echo \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n+            echoYellow \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n         else\n-            echo \"Installing Greenplum External Table PXF Extension into ${GPHOME}\"\n-            cp -av ${parent_script_dir}/gpextable/* ${GPHOME}\n+            echoGreen \"Installing Greenplum External Table PXF Extension into '${GPHOME}'\"\n+\n+            local target_control_file=\"${GPHOME}/share/postgresql/extension/pxf.control\"\n+            cp -RLv \"${parent_script_dir}/gpextable/share/postgresql/extension/pxf.control\" \"${target_control_file}\"\n+            chmod 755 \"${target_control_file}\"\n+            # update the directory to point to the extension directory located in the $PXF_HOME path\n+            sed \"${SED_OPTS[@]}\" \"s|directory =.*|directory = '${parent_script_dir}/gpextable/share/postgresql/extension'|g\" \"${target_control_file}\"\n+            # update the module_pathname to point to the so file located in the $PXF_HOME path\n+            sed \"${SED_OPTS[@]}\" \"s|module_pathname =.*|module_pathname = '${parent_script_dir}/gpextable/lib/postgresql/pxf'|g\" \"${target_control_file}\"\n         fi\n     fi\n }\n \n # doInit handles the init command\n function doInit()\n {\n-    if ! grep 'PXF_CONF:-NOT_INITIALIZED' \"$default_env_script\" > /dev/null; then\n-        echoYellow \"PXF has already been initialized. Use 'pxf [cluster] reset' before attempting to re-initialize PXF\"\n-        return 1\n-    fi\n-\n-    update_pxf_conf\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] init\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*'\n+    echoYellow '* Use the \"pxf [cluster] register\" command instead.'\n+    echoYellow '*'\n+    echoYellow '*****************************************************************************'\n     # preserve JAVA_HOME in case user is trying to change it\n     PRESERVE_JAVA_HOME=true getEnvironment\n     checkJavaHome\n-    generateUserConfigs || return 1\n-    editPxfEnvSh || return 1\n-    createLogsDir || return 1\n-    createRunDir  || return 1\n     installExternalTableExtension || return 1\n }\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 329}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU4MTk3NA==", "bodyText": "the code is irrelevant now, because we used to keep the value for writing it in pxf-env.sh, but we no longer write the JAVA_HOME value", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r490581974", "createdAt": "2020-09-17T21:50:11Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -305,73 +238,51 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'\n }\n \n function installExternalTableExtension()\n {\n     if [[ -d ${parent_script_dir}/gpextable ]]; then\n         if [[ -z \"${GPHOME}\" ]]; then\n-            echo 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n+            echoYellow 'WARNING: environment variable GPHOME is not set, skipping install of Greenplum External Table PXF Extension'\n         elif [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n-            echo \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n+            echoYellow \"WARNING: environment variable GPHOME (${GPHOME}) must be set to a valid Greenplum installation, skipping install of Greenplum External Table PXF Extension'\"\n         else\n-            echo \"Installing Greenplum External Table PXF Extension into ${GPHOME}\"\n-            cp -av ${parent_script_dir}/gpextable/* ${GPHOME}\n+            echoGreen \"Installing Greenplum External Table PXF Extension into '${GPHOME}'\"\n+\n+            local target_control_file=\"${GPHOME}/share/postgresql/extension/pxf.control\"\n+            cp -RLv \"${parent_script_dir}/gpextable/share/postgresql/extension/pxf.control\" \"${target_control_file}\"\n+            chmod 755 \"${target_control_file}\"\n+            # update the directory to point to the extension directory located in the $PXF_HOME path\n+            sed \"${SED_OPTS[@]}\" \"s|directory =.*|directory = '${parent_script_dir}/gpextable/share/postgresql/extension'|g\" \"${target_control_file}\"\n+            # update the module_pathname to point to the so file located in the $PXF_HOME path\n+            sed \"${SED_OPTS[@]}\" \"s|module_pathname =.*|module_pathname = '${parent_script_dir}/gpextable/lib/postgresql/pxf'|g\" \"${target_control_file}\"\n         fi\n     fi\n }\n \n # doInit handles the init command\n function doInit()\n {\n-    if ! grep 'PXF_CONF:-NOT_INITIALIZED' \"$default_env_script\" > /dev/null; then\n-        echoYellow \"PXF has already been initialized. Use 'pxf [cluster] reset' before attempting to re-initialize PXF\"\n-        return 1\n-    fi\n-\n-    update_pxf_conf\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] init\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*'\n+    echoYellow '* Use the \"pxf [cluster] register\" command instead.'\n+    echoYellow '*'\n+    echoYellow '*****************************************************************************'\n     # preserve JAVA_HOME in case user is trying to change it\n     PRESERVE_JAVA_HOME=true getEnvironment\n     checkJavaHome\n-    generateUserConfigs || return 1\n-    editPxfEnvSh || return 1\n-    createLogsDir || return 1\n-    createRunDir  || return 1\n     installExternalTableExtension || return 1\n }\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NjgzNA=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 329}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDIyMTcwOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo1Mzo1M1rOHQIbQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMjo1Nzo1NVrOHQv9ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NzMxMg==", "bodyText": "whichever file is loaded last, overrides the properties from the previous one, correct ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486677312", "createdAt": "2020-09-10T22:53:53Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -394,18 +304,28 @@ function do_start() {\n         isRunning \"$pid\" && { echoYellow \"PXF is already running [pid=$pid]\"; return 0; }\n     fi\n \n-    PXF_OPTS=(-Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager -Dlogging.config=${PXF_CONF}/conf/pxf-log4j2.xml)\n+    PXF_OPTS=(-Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager -Dlogging.config=${PXF_RUN}/conf/pxf-log4j2.xml)\n     [[ $PXF_DEBUG == true ]]      && PXF_OPTS+=(-agentlib:jdwp=transport=dt_socket,address=2020,suspend=n,server=y)\n     [[ $PXF_OOM_KILL = true ]]    && PXF_OPTS+=(-XX:OnOutOfMemoryError=\"${PXF_HOME}/bin/kill-pxf.sh %p\")\n     [[ -n \"$PXF_OOM_DUMP_PATH\" ]] && PXF_OPTS+=(-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=$PXF_OOM_DUMP_PATH)\n     JAVA_OPTS=($PXF_JVM_OPTS  \"${PXF_OPTS[@]}\")\n+    RUN_ARGS=(--spring.config.location=classpath:/application.properties,file:${PXF_RUN}/conf/pxf-application.properties)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 356}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMyNTA1MQ==", "bodyText": "Correct, here is a snippet the documentation:\n\nWhen custom config locations are configured by using spring.config.location, they replace the default locations. For example, if spring.config.location is configured with the value classpath:/custom-config/,file:./custom-config/, the search order becomes the following:\nfile:./custom-config/\nclasspath:custom-config/", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487325051", "createdAt": "2020-09-11T22:57:55Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -394,18 +304,28 @@ function do_start() {\n         isRunning \"$pid\" && { echoYellow \"PXF is already running [pid=$pid]\"; return 0; }\n     fi\n \n-    PXF_OPTS=(-Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager -Dlogging.config=${PXF_CONF}/conf/pxf-log4j2.xml)\n+    PXF_OPTS=(-Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager -Dlogging.config=${PXF_RUN}/conf/pxf-log4j2.xml)\n     [[ $PXF_DEBUG == true ]]      && PXF_OPTS+=(-agentlib:jdwp=transport=dt_socket,address=2020,suspend=n,server=y)\n     [[ $PXF_OOM_KILL = true ]]    && PXF_OPTS+=(-XX:OnOutOfMemoryError=\"${PXF_HOME}/bin/kill-pxf.sh %p\")\n     [[ -n \"$PXF_OOM_DUMP_PATH\" ]] && PXF_OPTS+=(-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=$PXF_OOM_DUMP_PATH)\n     JAVA_OPTS=($PXF_JVM_OPTS  \"${PXF_OPTS[@]}\")\n+    RUN_ARGS=(--spring.config.location=classpath:/application.properties,file:${PXF_RUN}/conf/pxf-application.properties)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NzMxMg=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 356}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDIzMDU4OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo1ODoxMFrOHQIgmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo1ODoxMFrOHQIgmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3ODY4Mw==", "bodyText": "I need to understand what happens with JAVA_HOME now, I feel this logic might be irrelevant now", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486678683", "createdAt": "2020-09-10T22:58:10Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -488,35 +406,26 @@ function doSync()\n         fail 'A destination hostname must be provided'\n     fi\n     getEnvironment\n-    checkPxfConf\n     warnUserEnvScript\n-    rsync -az${DELETE:+ --delete} -e \"ssh -o StrictHostKeyChecking=no\" \"$PXF_CONF\"/{conf,lib,servers} \"${target_host}:$PXF_CONF\"\n+    rsync -az${DELETE:+ --delete} -e \"ssh -o StrictHostKeyChecking=no\" \"$PXF_RUN\"/{conf,lib,servers} \"${target_host}:$PXF_RUN\"\n }\n \n function doCluster()\n {\n     local pxf_cluster_command=$2 is_init=false\n     [[ ${pxf_cluster_command} == init ]] && is_init=true\n     PRESERVE_JAVA_HOME=${is_init} getEnvironment", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 415}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDIzMzUwOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/templates/conf/pxf-application.properties", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMjo1OTozNFrOHQIiUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMjo1ODo0MFrOHQv-Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3OTEyMw==", "bodyText": "it is loaded by Spring Boot, not our control scripts, let's update the comment to be correct", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r486679123", "createdAt": "2020-09-10T22:59:34Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/templates/conf/pxf-application.properties", "diffHunk": "@@ -0,0 +1,23 @@\n+\n+##############################################################################\n+# This file contains PXF properties that can be specified by users           #\n+# to customize their deployments. This file is sourced by PXF Server control #\n+# scripts upon initialization, start and stop of the PXF Server.             #", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMyNTIwNw==", "bodyText": "done", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r487325207", "createdAt": "2020-09-11T22:58:40Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/templates/conf/pxf-application.properties", "diffHunk": "@@ -0,0 +1,23 @@\n+\n+##############################################################################\n+# This file contains PXF properties that can be specified by users           #\n+# to customize their deployments. This file is sourced by PXF Server control #\n+# scripts upon initialization, start and stop of the PXF Server.             #", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3OTEyMw=="}, "originalCommit": {"oid": "b6889873e0c5dcd716d41a9f1f39aadc2a1443b0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDg5MzM0OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/cluster.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMDo1Nzo1MlrOHTJMMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNzozNzoyN1rOHTuGuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgzNTU3MQ==", "bodyText": "should we have a secondary statement along the lines of deprecated, please use pxf run?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489835571", "createdAt": "2020-09-17T00:57:52Z", "author": {"login": "ashuka24"}, "path": "cli/go/src/pxf-cli/cmd/cluster.go", "diffHunk": "@@ -39,13 +39,13 @@ func createCobraCommand(use string, short string, cmd *command) *cobra.Command {\n \n var (\n \tclusterCmd  = createCobraCommand(\"cluster\", \"Perform <command> on each segment host in the cluster\", nil)\n-\tinitCmd     = createCobraCommand(\"init\", \"Initialize the PXF server instance and install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)\n+\tinitCmd     = createCobraCommand(\"init\", \"(deprecated) Install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ0MDM3Ng==", "bodyText": "Yeah, that makes sense. I'll add deprecation notices for pxf cluster init/reset", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r490440376", "createdAt": "2020-09-17T17:37:27Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/cluster.go", "diffHunk": "@@ -39,13 +39,13 @@ func createCobraCommand(use string, short string, cmd *command) *cobra.Command {\n \n var (\n \tclusterCmd  = createCobraCommand(\"cluster\", \"Perform <command> on each segment host in the cluster\", nil)\n-\tinitCmd     = createCobraCommand(\"init\", \"Initialize the PXF server instance and install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)\n+\tinitCmd     = createCobraCommand(\"init\", \"(deprecated) Install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgzNTU3MQ=="}, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDkxMzM4OnYy", "diffSide": "RIGHT", "path": "cli/go/src/pxf-cli/cmd/cluster.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMTowMzoxNVrOHTJZOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNDowMzozM1rOHTj23A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgzODkwNQ==", "bodyText": "since this is only deprecated and not removed, it seems like it is still an operation you can perform (and there are still locations elsewhere. (See  cli/go/src/pxf-cli/cmd/pxf.go line 184) that describe what this does. Should we leave the description of this command much like we do for init?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tresetCmd    = createCobraCommand(\"reset\", \"(deprecated) No operation\", &ResetCommand)\n          \n          \n            \n            \tresetCmd    = createCobraCommand(\"reset\", \"(deprecated) Reset PXF (undo initialization) on all segment hosts\", &ResetCommand)", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489838905", "createdAt": "2020-09-17T01:03:15Z", "author": {"login": "ashuka24"}, "path": "cli/go/src/pxf-cli/cmd/cluster.go", "diffHunk": "@@ -39,13 +39,13 @@ func createCobraCommand(use string, short string, cmd *command) *cobra.Command {\n \n var (\n \tclusterCmd  = createCobraCommand(\"cluster\", \"Perform <command> on each segment host in the cluster\", nil)\n-\tinitCmd     = createCobraCommand(\"init\", \"Initialize the PXF server instance and install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)\n+\tinitCmd     = createCobraCommand(\"init\", \"(deprecated) Install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)\n \tstartCmd    = createCobraCommand(\"start\", \"Start the PXF server instances on all segment hosts\", &StartCommand)\n \tstopCmd     = createCobraCommand(\"stop\", \"Stop the PXF server instances on all segment hosts\", &StopCommand)\n \tstatusCmd   = createCobraCommand(\"status\", \"Get status of PXF servers on all segment hosts\", &StatusCommand)\n \tsyncCmd     = createCobraCommand(\"sync\", \"Sync PXF configs from master to standby master and all segment hosts. Use --delete to delete extraneous remote files\", &SyncCommand)\n-\tresetCmd    = createCobraCommand(\"reset\", \"Reset PXF (undo initialization) on all segment hosts\", &ResetCommand)\n-\tregisterCmd = createCobraCommand(\"register\", \"Install PXF extension under $GPHOME on all segment hosts\", &RegisterCommand)\n+\tresetCmd    = createCobraCommand(\"reset\", \"(deprecated) No operation\", &ResetCommand)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI3MjQ3Ng==", "bodyText": "Well, pxf reset will not do anything actually, we keep the command, but plan to remove it at a later date", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r490272476", "createdAt": "2020-09-17T14:03:33Z", "author": {"login": "frankgh"}, "path": "cli/go/src/pxf-cli/cmd/cluster.go", "diffHunk": "@@ -39,13 +39,13 @@ func createCobraCommand(use string, short string, cmd *command) *cobra.Command {\n \n var (\n \tclusterCmd  = createCobraCommand(\"cluster\", \"Perform <command> on each segment host in the cluster\", nil)\n-\tinitCmd     = createCobraCommand(\"init\", \"Initialize the PXF server instance and install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)\n+\tinitCmd     = createCobraCommand(\"init\", \"(deprecated) Install PXF extension under $GPHOME on master, standby master, and all segment hosts\", &InitCommand)\n \tstartCmd    = createCobraCommand(\"start\", \"Start the PXF server instances on all segment hosts\", &StartCommand)\n \tstopCmd     = createCobraCommand(\"stop\", \"Stop the PXF server instances on all segment hosts\", &StopCommand)\n \tstatusCmd   = createCobraCommand(\"status\", \"Get status of PXF servers on all segment hosts\", &StatusCommand)\n \tsyncCmd     = createCobraCommand(\"sync\", \"Sync PXF configs from master to standby master and all segment hosts. Use --delete to delete extraneous remote files\", &SyncCommand)\n-\tresetCmd    = createCobraCommand(\"reset\", \"Reset PXF (undo initialization) on all segment hosts\", &ResetCommand)\n-\tregisterCmd = createCobraCommand(\"register\", \"Install PXF extension under $GPHOME on all segment hosts\", &RegisterCommand)\n+\tresetCmd    = createCobraCommand(\"reset\", \"(deprecated) No operation\", &ResetCommand)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgzODkwNQ=="}, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk1NzcyOnYy", "diffSide": "RIGHT", "path": "package/pxf-gp5.spec", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNDo1NVrOHTJ3hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNDo1NVrOHTJ3hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg0NjY2MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # Only when a config file has been edited and is different from the file in\n          \n          \n            \n            # When a config file has been edited and is different from the file in", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489846660", "createdAt": "2020-09-17T01:14:55Z", "author": {"login": "ashuka24"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -34,9 +34,36 @@ fi\n %__mkdir -p %{buildroot}/%{prefix}\n %__cp -R %{_sourcedir}/* %{buildroot}/%{prefix}\n \n+%post\n+sed -i \"s|directory =.*|directory = '%{prefix}/gpextable/'|g\" %{prefix}/gpextable/pxf.control\n+sed -i \"s|module_pathname =.*|module_pathname = '%{prefix}/gpextable/pxf'|g\" %{prefix}/gpextable/pxf.control\n+\n %files\n %{prefix}\n+%attr(700, -, -) %dir %{prefix}/run\n+\n+# If a file is not marked as a config file, or if a file has not been altered\n+# since installation, then it will be silently replaced by the version from the\n+# RPM.\n+\n+# If a config file has been edited on disk, but is not actually different from\n+# the file in the RPM then the edited version will be silently left in place.\n+\n+# Only when a config file has been edited and is different from the file in", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk1Nzc0OnYy", "diffSide": "RIGHT", "path": "package/pxf-gp5.spec", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNDo1NlrOHTJ3iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNDo1NlrOHTJ3iA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg0NjY2NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # the RPM the behavior is the following:\n          \n          \n            \n            # the RPM, then the behavior is the following:", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489846664", "createdAt": "2020-09-17T01:14:56Z", "author": {"login": "ashuka24"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -34,9 +34,36 @@ fi\n %__mkdir -p %{buildroot}/%{prefix}\n %__cp -R %{_sourcedir}/* %{buildroot}/%{prefix}\n \n+%post\n+sed -i \"s|directory =.*|directory = '%{prefix}/gpextable/'|g\" %{prefix}/gpextable/pxf.control\n+sed -i \"s|module_pathname =.*|module_pathname = '%{prefix}/gpextable/pxf'|g\" %{prefix}/gpextable/pxf.control\n+\n %files\n %{prefix}\n+%attr(700, -, -) %dir %{prefix}/run\n+\n+# If a file is not marked as a config file, or if a file has not been altered\n+# since installation, then it will be silently replaced by the version from the\n+# RPM.\n+\n+# If a config file has been edited on disk, but is not actually different from\n+# the file in the RPM then the edited version will be silently left in place.\n+\n+# Only when a config file has been edited and is different from the file in\n+# the RPM the behavior is the following:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk2MDQ2OnYy", "diffSide": "RIGHT", "path": "package/pxf-gp6.spec", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNTozNVrOHTJ5QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNTozNVrOHTJ5QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg0NzEwNA==", "bodyText": "same suggestions as the pxf5 spec", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489847104", "createdAt": "2020-09-17T01:15:35Z", "author": {"login": "ashuka24"}, "path": "package/pxf-gp6.spec", "diffHunk": "@@ -34,9 +34,36 @@ fi\n %__mkdir -p %{buildroot}/%{prefix}\n %__cp -R %{_sourcedir}/* %{buildroot}/%{prefix}\n \n+%post\n+sed -i \"s|directory =.*|directory = '%{prefix}/gpextable/'|g\" %{prefix}/gpextable/pxf.control\n+sed -i \"s|module_pathname =.*|module_pathname = '%{prefix}/gpextable/pxf'|g\" %{prefix}/gpextable/pxf.control\n+\n %files\n %{prefix}\n+%attr(700, -, -) %dir %{prefix}/run\n+\n+# If a file is not marked as a config file, or if a file has not been altered\n+# since installation, then it will be silently replaced by the version from the\n+# RPM.\n+\n+# If a config file has been edited on disk, but is not actually different from\n+# the file in the RPM then the edited version will be silently left in place.\n+\n+# Only when a config file has been edited and is different from the file in", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk2MjY1OnYy", "diffSide": "RIGHT", "path": "regression/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNjoxM1rOHTJ63w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNjoxM1rOHTJ63w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg0NzUxOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            `gpdemo-env.sh`. Additionally, `PXF_RUN` must be set if different from\n          \n          \n            \n            `gpdemo-env.sh` must be set. Additionally, `PXF_RUN` must be set if different from", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489847519", "createdAt": "2020-09-17T01:16:13Z", "author": {"login": "ashuka24"}, "path": "regression/README.md", "diffHunk": "@@ -46,10 +46,12 @@ By setting environment variables you can change the location of the Greenplum ma\n \n ### General environment variables\n \n-All the general environment variables that come from `greenplum_path.sh` and `gpdemo-env.sh`, along with `PXF_CONF` must be set.\n+All the general environment variables that come from `greenplum_path.sh` and\n+`gpdemo-env.sh`. Additionally, `PXF_RUN` must be set if different from", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk2NDQwOnYy", "diffSide": "RIGHT", "path": "regression/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNjozOVrOHTJ8CA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToxNjozOVrOHTJ8CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg0NzgxNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `SERVER_CONFIG`: the name of the config directory for your server, under `${PXF_RUN}/servers` (optional). If not set, will use one of `${PXF_RUN}/servers/{default,s3,gs,adl,wasbs}` as appropriate\n          \n          \n            \n            * `SERVER_CONFIG`: the name of the config directory for your server, under `${PXF_RUN}/servers` (optional). If not set, PXF will use one of `${PXF_RUN}/servers/{default,s3,gs,adl,wasbs}` as appropriate", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489847816", "createdAt": "2020-09-17T01:16:39Z", "author": {"login": "ashuka24"}, "path": "regression/README.md", "diffHunk": "@@ -46,10 +46,12 @@ By setting environment variables you can change the location of the Greenplum ma\n \n ### General environment variables\n \n-All the general environment variables that come from `greenplum_path.sh` and `gpdemo-env.sh`, along with `PXF_CONF` must be set.\n+All the general environment variables that come from `greenplum_path.sh` and\n+`gpdemo-env.sh`. Additionally, `PXF_RUN` must be set if different from\n+`PXF_HOME`.\n \n * `PXF_TEST_DEBUG`: set to anything to prevent deletion of data, and to run `pg_regress` in debug mode (optional)\n-* `SERVER_CONFIG`: the name of the config directory for your server, under `${PXF_CONF}/servers` (optional). If not set, will use one of `${PXF_CONF}/servers/{default,s3,gs,adl,wasbs}` as appropriate\n+* `SERVER_CONFIG`: the name of the config directory for your server, under `${PXF_RUN}/servers` (optional). If not set, will use one of `${PXF_RUN}/servers/{default,s3,gs,adl,wasbs}` as appropriate", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk4MjM4OnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToyMTo0MVrOHTKILQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNDoxMjoxMlrOHTkR4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg1MDkyNQ==", "bodyText": "same comment here about reset, we still leave the old comments elsewhere in the code", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489850925", "createdAt": "2020-09-17T01:21:41Z", "author": {"login": "ashuka24"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -278,21 +193,21 @@ doHelp() {\n     cat <<-EOF\n \n \t${bold}List of commands${normal}:\n-\t  init                initialize the local PXF server instance, install PXF extension under \\$GPHOME\n \t  start               start the local PXF server instance\n \t  stop                stop the local PXF server instance\n \t  restart             restart the local PXF server instance (not supported for cluster)\n \t  status              show the status of the local PXF server instance\n \t  version             show the version of PXF server\n-\t  reset               undo the local PXF initialization\n \t  register            install PXF extension under \\$GPHOME (useful after upgrades of Greenplum server)\n \t  cluster <command>   perform <command> on all the segment hosts in the cluster; try ${bold}pxf cluster help$normal\n \n-\t  sync <hostname>     synchronize \\$PXF_CONF/{conf,lib,servers} directories onto <hostname>. Use --delete to delete extraneous remote files\n+\t  sync <hostname>     synchronize \\$PXF_RUN/{conf,lib,servers} directories onto <hostname>. Use --delete to delete extraneous remote files\n+\n+\t  init                (deprecated) install PXF extension under \\$GPHOME\n+\t  reset               (deprecated) no operation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 228}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI3OTM5NA==", "bodyText": "The command description reflects what the command is actually doing. In the case of pxf init, we install (register) the PXF extension under $GPHOME. In the case of pxf reset, we don't do anything (we only show the deprecation message).", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r490279394", "createdAt": "2020-09-17T14:12:12Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -278,21 +193,21 @@ doHelp() {\n     cat <<-EOF\n \n \t${bold}List of commands${normal}:\n-\t  init                initialize the local PXF server instance, install PXF extension under \\$GPHOME\n \t  start               start the local PXF server instance\n \t  stop                stop the local PXF server instance\n \t  restart             restart the local PXF server instance (not supported for cluster)\n \t  status              show the status of the local PXF server instance\n \t  version             show the version of PXF server\n-\t  reset               undo the local PXF initialization\n \t  register            install PXF extension under \\$GPHOME (useful after upgrades of Greenplum server)\n \t  cluster <command>   perform <command> on all the segment hosts in the cluster; try ${bold}pxf cluster help$normal\n \n-\t  sync <hostname>     synchronize \\$PXF_CONF/{conf,lib,servers} directories onto <hostname>. Use --delete to delete extraneous remote files\n+\t  sync <hostname>     synchronize \\$PXF_RUN/{conf,lib,servers} directories onto <hostname>. Use --delete to delete extraneous remote files\n+\n+\t  init                (deprecated) install PXF extension under \\$GPHOME\n+\t  reset               (deprecated) no operation", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg1MDkyNQ=="}, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 228}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NDk4NTAxOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/scripts/pxf", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMToyMjoyOVrOHTKKEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNDoxMjozNFrOHTkS0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg1MTQxMA==", "bodyText": "is there an alternative similar to below where we tell them to use pxf register?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r489851410", "createdAt": "2020-09-17T01:22:29Z", "author": {"login": "ashuka24"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -306,33 +221,11 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 271}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI3OTYzMw==", "bodyText": "not really, there's nothing to be done for reset", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r490279633", "createdAt": "2020-09-17T14:12:34Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/scripts/pxf", "diffHunk": "@@ -306,33 +221,11 @@ function promptUser() {\n # doReset handles the reset command\n function doReset()\n {\n-    local force=$2\n-    echoRed \"This is a destructive action!\"\n-\n-    if [[ -f \"$pid_file\" ]]; then\n-        pid=$(cat \"$pid_file\")\n-        isRunning \"$pid\" && { echoYellow \"PXF is running [pid=$pid]\"; }\n-    fi\n-\n-    local prompt='Ensure your local PXF instance is stopped before continuing.\n-    Press [y] to continue:'\n-    if [[ $force != -f && $force != --force ]] && ! promptUser \"$prompt\"; then\n-        echoYellow 'pxf reset cancelled'\n-        return 1\n-    fi\n-\n-    if doStatus > /dev/null; then\n-        fail \"PXF is running. Stop PXF before running 'pxf [cluster] reset'\"\n-    fi\n-\n-    echoYellow \"Ignoring ${PXF_CONF}...\"\n-    echoYellow \"Cleaning ${PXF_RUNDIR}...\"\n-    rm -rf \"$PXF_RUNDIR\"\n-\n-    echoYellow \"Reverting changes to ${default_env_script}...\"\n-    sed \"${SED_OPTS[@]}\" \"s|{PXF_CONF:-\\\".*\\\"}|{PXF_CONF:-NOT_INITIALIZED}|g\" \"$default_env_script\"\n-\n-    echoGreen \"Finished resetting PXF\"\n+    echoYellow '*****************************************************************************'\n+    echoYellow '* DEPRECATION NOTICE:'\n+    echoYellow '* The \"pxf [cluster] reset\" command is deprecated and will be removed'\n+    echoYellow '* in a future release of PXF.'\n+    echoYellow '*****************************************************************************'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg1MTQxMA=="}, "originalCommit": {"oid": "8562b74c7bd1a479f3d651c7cbd82d509507bef4"}, "originalPosition": 271}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4NTA1MTQ2OnYy", "diffSide": "RIGHT", "path": "package/pxf-gp5.spec", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxODoyOTo0NlrOHWHLfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQyMzo0ODoyOVrOHWQIPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk0ODM0OA==", "bodyText": "I know I asked for this here :) but with conversations now on potentially shipping as a binary tarball as well, this will have to be at least externalized into a shippable script that tarball installation script can call to cause the similar change. {prefix} might be passed as a parameter, or the script will figure out itself where it is located. No change for now, though, just keep the thought.", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r492948348", "createdAt": "2020-09-22T18:29:46Z", "author": {"login": "denalex"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -34,9 +34,35 @@ fi\n %__mkdir -p %{buildroot}/%{prefix}\n %__cp -R %{_sourcedir}/* %{buildroot}/%{prefix}\n \n+%post\n+sed -i \"s|directory =.*|directory = '%{prefix}/gpextable/'|g\" %{prefix}/gpextable/pxf.control\n+sed -i \"s|module_pathname =.*|module_pathname = '%{prefix}/gpextable/pxf'|g\" %{prefix}/gpextable/pxf.control", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2463adee0bf58981f9d9aa45ce1320e557a5c88"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAwMDk5MA==", "bodyText": "I had this logic in the pxf register code. Maybe we should have it there after all, that would cover all use cases (RPM or tarball installation)?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r493000990", "createdAt": "2020-09-22T20:04:47Z", "author": {"login": "frankgh"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -34,9 +34,35 @@ fi\n %__mkdir -p %{buildroot}/%{prefix}\n %__cp -R %{_sourcedir}/* %{buildroot}/%{prefix}\n \n+%post\n+sed -i \"s|directory =.*|directory = '%{prefix}/gpextable/'|g\" %{prefix}/gpextable/pxf.control\n+sed -i \"s|module_pathname =.*|module_pathname = '%{prefix}/gpextable/pxf'|g\" %{prefix}/gpextable/pxf.control", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk0ODM0OA=="}, "originalCommit": {"oid": "a2463adee0bf58981f9d9aa45ce1320e557a5c88"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA5NDk3Mw==", "bodyText": "I still think it needs to be invoked from here, but if we externalize the logic in some script (like Debian does), then the script can be called from here and somewhere else, if needed. @bradfordb-vmware -- what would you suggest ?", "url": "https://github.com/greenplum-db/pxf/pull/447#discussion_r493094973", "createdAt": "2020-09-22T23:48:29Z", "author": {"login": "denalex"}, "path": "package/pxf-gp5.spec", "diffHunk": "@@ -34,9 +34,35 @@ fi\n %__mkdir -p %{buildroot}/%{prefix}\n %__cp -R %{_sourcedir}/* %{buildroot}/%{prefix}\n \n+%post\n+sed -i \"s|directory =.*|directory = '%{prefix}/gpextable/'|g\" %{prefix}/gpextable/pxf.control\n+sed -i \"s|module_pathname =.*|module_pathname = '%{prefix}/gpextable/pxf'|g\" %{prefix}/gpextable/pxf.control", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk0ODM0OA=="}, "originalCommit": {"oid": "a2463adee0bf58981f9d9aa45ce1320e557a5c88"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3466, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}