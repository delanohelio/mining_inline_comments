{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2NTA5MzY5", "number": 342, "title": "changed Makefiles to build tarball with all components", "bodyText": "", "createdAt": "2020-04-21T08:06:13Z", "url": "https://github.com/greenplum-db/pxf/pull/342", "merged": true, "mergeCommit": {"oid": "c505ccba1f50e10e79ca6363d6efea3a4b5d1f2f"}, "closed": true, "closedAt": "2020-04-29T21:24:30Z", "author": {"login": "denalex"}, "timelineItems": {"totalCount": 47, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZyImRAFqTM5NzIxODc5Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccfSM7AH2gAyNDA2NTA5MzY5OmMxMDMxMjllN2ZiYjU4YTMzNjRjMDMyZGJmMGY3OTkyNWVlMjk1MmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MjE4Nzk3", "url": "https://github.com/greenplum-db/pxf/pull/342#pullrequestreview-397218797", "createdAt": "2020-04-21T10:58:55Z", "commit": {"oid": "702cb878e3c394f2fb512d836ca6cac679d4e8be"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDo1ODo1NlrOGI_pjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMToyOTozNVrOGJAxhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4NDYyMg==", "bodyText": "should we just fail here instead? or maybe fail if the path does   not exist?", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r412084622", "createdAt": "2020-04-21T10:58:56Z", "author": {"login": "frankgh"}, "path": "Makefile", "diffHunk": "@@ -1,18 +1,27 @@\n+ifeq \"$(GPHOME)\" \"\"\n+    GPHOME = \"/usr/local/greenplum-db\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702cb878e3c394f2fb512d836ca6cac679d4e8be"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA5NzE4OQ==", "bodyText": "Should we take this opportunity to bump the version of our PXF server to 5.12.0-SNAPSHOT here https://github.com/greenplum-db/pxf/blob/master/server/gradle.properties? Maybe it's an opportunity to start using snapshots moving forward. This might break CI code that assumes the version number is major, minor, rev", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r412097189", "createdAt": "2020-04-21T11:20:03Z", "author": {"login": "frankgh"}, "path": "Makefile", "diffHunk": "@@ -1,18 +1,27 @@\n+ifeq \"$(GPHOME)\" \"\"\n+    GPHOME = \"/usr/local/greenplum-db\"\n+endif\n+\n ifeq \"$(PXF_HOME)\" \"\"\n-    ifneq \"$(GPHOME)\" \"\"\n-        PXF_HOME = \"$(GPHOME)/pxf\"\n-    endif\n+    PXF_HOME = \"$(GPHOME)/pxf\"\n endif\n \n SHELL := /bin/bash\n \n+export GPHOME\n export PXF_HOME\n \n+PXF_VERSION := $(shell grep version= server/gradle.properties | cut -d= -f2)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702cb878e3c394f2fb512d836ca6cac679d4e8be"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA5ODY5MQ==", "bodyText": "minor: this does not necessarily have to be an old version of PXF\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                echo \"Removing old PXF ...\"\n          \n          \n            \n                echo \"Removing existing PXF ...\"", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r412098691", "createdAt": "2020-04-21T11:22:27Z", "author": {"login": "frankgh"}, "path": "package/install_component", "diffHunk": "@@ -0,0 +1,43 @@\n+#!/usr/bin/env bash\n+\n+CWDIR=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\n+PXF_VERSION=$(<\"${CWDIR}/pxf/version\")\n+\n+function check_gphome() {\n+    if [[ -z \"${GPHOME}\" ]]; then\n+        echo \"Error: environment variable GPHOME is not set\"\n+        exit 1\n+    fi\n+\n+    if [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n+        echo \"Error: environment variable GPHOME must be set to a valid Greenplum installation\"\n+        exit 1\n+    fi\n+}\n+\n+function remove_old_component() {\n+    echo \"Removing old PXF ...\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702cb878e3c394f2fb512d836ca6cac679d4e8be"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA5ODkxOA==", "bodyText": "minor:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                echo \"Installing new PXF version ${PXF_VERSION} ...\"\n          \n          \n            \n                echo \"Installing PXF version ${PXF_VERSION} ...\"", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r412098918", "createdAt": "2020-04-21T11:22:53Z", "author": {"login": "frankgh"}, "path": "package/install_component", "diffHunk": "@@ -0,0 +1,43 @@\n+#!/usr/bin/env bash\n+\n+CWDIR=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\n+PXF_VERSION=$(<\"${CWDIR}/pxf/version\")\n+\n+function check_gphome() {\n+    if [[ -z \"${GPHOME}\" ]]; then\n+        echo \"Error: environment variable GPHOME is not set\"\n+        exit 1\n+    fi\n+\n+    if [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n+        echo \"Error: environment variable GPHOME must be set to a valid Greenplum installation\"\n+        exit 1\n+    fi\n+}\n+\n+function remove_old_component() {\n+    echo \"Removing old PXF ...\"\n+\n+}\n+\n+function install_new_component() {\n+    echo \"Installing new PXF version ${PXF_VERSION} ...\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702cb878e3c394f2fb512d836ca6cac679d4e8be"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjEwMzA0Nw==", "bodyText": "I think we should allow a $PXF_HOME environment variable to be defined, and if not. defined then PXF_HOME=GPHOME/pxf. We install the PXF Server + CLI components in PXF_HOME, and the extension inside GPHOME", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r412103047", "createdAt": "2020-04-21T11:29:35Z", "author": {"login": "frankgh"}, "path": "package/install_component", "diffHunk": "@@ -0,0 +1,43 @@\n+#!/usr/bin/env bash\n+\n+CWDIR=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\n+PXF_VERSION=$(<\"${CWDIR}/pxf/version\")\n+\n+function check_gphome() {\n+    if [[ -z \"${GPHOME}\" ]]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702cb878e3c394f2fb512d836ca6cac679d4e8be"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7060195ce40f522bcf306ea6bf9d04f7e1a87ba0", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/7060195ce40f522bcf306ea6bf9d04f7e1a87ba0", "committedDate": "2020-04-22T02:22:10Z", "message": "manage version at the top level"}, "afterCommit": {"oid": "fdabc603c0f4d8a25246f6b5234f3268b7b85f99", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/fdabc603c0f4d8a25246f6b5234f3268b7b85f99", "committedDate": "2020-04-22T02:23:13Z", "message": "manage version at the top level"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MDY1MjM0", "url": "https://github.com/greenplum-db/pxf/pull/342#pullrequestreview-398065234", "createdAt": "2020-04-22T10:43:42Z", "commit": {"oid": "3bca5d269e5bdd37d8af26ce13e84f06394bd75c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDo0Mzo0MlrOGJvxiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDo0Mzo0MlrOGJvxiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg3MzA5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    echo \"Removing existing PXF ${OLD_PXF_VERSION}from ${PXF_HOME} ...\"\n          \n          \n            \n                    echo \"Removing existing PXF ${OLD_PXF_VERSION} from ${PXF_HOME} ...\"", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r412873099", "createdAt": "2020-04-22T10:43:42Z", "author": {"login": "frankgh"}, "path": "package/install_component", "diffHunk": "@@ -0,0 +1,84 @@\n+#!/usr/bin/env bash\n+\n+CWDIR=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\n+PXF_VERSION=$(<\"${CWDIR}/pxf/version\")\n+\n+function show_help() {\n+    echo \"This script installs PXF Greenplum Extension and PXF Server\"\n+    echo \"to install the PXF Extension :\"\n+    echo \"  set GPHOME environment variable to the installation directory of Greenplum Database\"\n+    echo \"to install the PXF Server :\"\n+    echo \"  either set PXF_HOME environment variable to the target PXF Server installation directory\"\n+    echo \"  or     set GPHOME   environment variable to have PXF Server installed into \\${GPHOME}/pxf\"\n+    echo \"current values:\"\n+    echo \"  GPHOME   = ${GPHOME:-<unset>}\"\n+    echo \"  PXF_HOME = ${PXF_HOME:-<unset>}\"\n+}\n+\n+function check_status() {\n+    if [ $1 -ne 0 ]; then\n+        echo \"Error: Installation failed\"\n+        exit $1\n+    fi\n+}\n+\n+function check_gphome() {\n+    if [[ -z \"${GPHOME}\" ]]; then\n+        if [[ -z \"${PXF_HOME}\" ]]; then\n+            echo \"Error: environment variables GPHOME and PXF_HOME are not set\"\n+            exit 1\n+        fi\n+    else\n+        if [[ ! -f ${GPHOME}/greenplum_path.sh ]]; then\n+            echo \"Error: environment variable GPHOME must be set to a valid Greenplum installation\"\n+            exit 1\n+        fi\n+        if [[ -z \"${PXF_HOME}\" ]]; then\n+            PXF_HOME=\"${GPHOME}/pxf\"\n+        fi\n+    fi\n+}\n+\n+function remove_old_component() {\n+    if [[ ! -z \"${PXF_HOME}\" && -d ${PXF_HOME} ]]; then\n+        if [[ -f ${PXF_HOME}/version ]]; then\n+            OLD_PXF_VERSION=\"version $(<\"${PXF_HOME}/version\") \"\n+        fi\n+\n+        echo \"Removing existing PXF ${OLD_PXF_VERSION}from ${PXF_HOME} ...\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bca5d269e5bdd37d8af26ce13e84f06394bd75c"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa1c05e36dd253a73dca2c7dba25bd9f0817d430", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/fa1c05e36dd253a73dca2c7dba25bd9f0817d430", "committedDate": "2020-04-29T17:25:32Z", "message": "changed Makefiles to build tarball with all components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8da0ec5078ba46a780880674ea0b8861e4a833b9", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/8da0ec5078ba46a780880674ea0b8861e4a833b9", "committedDate": "2020-04-29T17:25:32Z", "message": "manage version at the top level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3884ed78bcd2f3fdda790d69d34032db6ca57945", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/3884ed78bcd2f3fdda790d69d34032db6ca57945", "committedDate": "2020-04-29T17:30:28Z", "message": "update build pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b29a6f5fea0b383a88cba10676096b713fe6c25", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/2b29a6f5fea0b383a88cba10676096b713fe6c25", "committedDate": "2020-04-29T17:30:28Z", "message": "debug echo dep binary"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e28463bd04c13007bf7ee0130be89101d58e7997", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/e28463bd04c13007bf7ee0130be89101d58e7997", "committedDate": "2020-04-29T17:30:28Z", "message": "use login shell to run build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faf576c79f380cd688007a8f081f05689ccbc7db", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/faf576c79f380cd688007a8f081f05689ccbc7db", "committedDate": "2020-04-29T17:30:28Z", "message": "remove login shell, source /etc/bashrc directly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10cc385c051b517c671869731504fe4cdb8b69d5", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/10cc385c051b517c671869731504fe4cdb8b69d5", "committedDate": "2020-04-29T17:30:28Z", "message": "fixed quotes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7edd6777860284fb256d52a8d2893458e3808545", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/7edd6777860284fb256d52a8d2893458e3808545", "committedDate": "2020-04-29T17:30:28Z", "message": "introduced test job"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95b893e00772760f13b85ea35d12393eb5043dc2", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/95b893e00772760f13b85ea35d12393eb5043dc2", "committedDate": "2020-04-29T17:30:28Z", "message": "update pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c519069db47b6b01d832c8422b4ed190a819866", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/2c519069db47b6b01d832c8422b4ed190a819866", "committedDate": "2020-04-29T17:30:28Z", "message": "using versioned_file resource"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92d0701be8eb4329ae64eafd19f2071d46e6d356", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/92d0701be8eb4329ae64eafd19f2071d46e6d356", "committedDate": "2020-04-29T17:30:28Z", "message": "temporarily bump version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02c8bbca8d32be1775f33839ba9d95b81e47520b", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/02c8bbca8d32be1775f33839ba9d95b81e47520b", "committedDate": "2020-04-29T17:30:28Z", "message": "reverted version, removed version from file name in CI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5ffbb3810e0b5299b8b4a6914e72e7bb97fdc3a", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/a5ffbb3810e0b5299b8b4a6914e72e7bb97fdc3a", "committedDate": "2020-04-29T17:30:28Z", "message": "call initialize_gpdb.bash"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2dfedbc523dab58cdbb6fd91142ac290db2dbca", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/d2dfedbc523dab58cdbb6fd91142ac290db2dbca", "committedDate": "2020-04-29T17:30:28Z", "message": "added test jobs, updated script variable name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71aad7b4103b13693ac462f4074e3df827d669be", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/71aad7b4103b13693ac462f4074e3df827d669be", "committedDate": "2020-04-29T17:30:28Z", "message": "fixed port, added sleep on gpdb startup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc56a5f91808851993cd2f49b340944d4f689e16", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/bc56a5f91808851993cd2f49b340944d4f689e16", "committedDate": "2020-04-29T17:30:28Z", "message": "conditional use of gpdemo-env.sh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10c8d57a11573511f220118ba31dc697b7001318", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/10c8d57a11573511f220118ba31dc697b7001318", "committedDate": "2020-04-29T17:30:28Z", "message": "export MASTER_DATA_DIRECTORY"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff6e542b7a95717c81ae65e18ea032eebc205e8a", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/ff6e542b7a95717c81ae65e18ea032eebc205e8a", "committedDate": "2020-04-29T17:30:28Z", "message": "update MASTER_DATA_DIRECTORY"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23d9fbd8129915d6cee23e334c9c3225104bfc73", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/23d9fbd8129915d6cee23e334c9c3225104bfc73", "committedDate": "2020-04-29T17:30:28Z", "message": "relax version requirement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82ba39f05caf955306b5848245657c6bd52e11bc", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/82ba39f05caf955306b5848245657c6bd52e11bc", "committedDate": "2020-04-29T17:30:28Z", "message": "relax version requirement in pxf init script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49f5706cb31f44f1b1daddc0dc0230b87b26f3cb", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/49f5706cb31f44f1b1daddc0dc0230b87b26f3cb", "committedDate": "2020-04-29T17:30:28Z", "message": "specify explicit goal when calling make"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72e25781860b6b89656c43578fd38d37a52ac3bf", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/72e25781860b6b89656c43578fd38d37a52ac3bf", "committedDate": "2020-04-29T17:30:28Z", "message": "update regex"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "620c5609a6f9c2b48786e2e3a715d91ccf1ec50b", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/620c5609a6f9c2b48786e2e3a715d91ccf1ec50b", "committedDate": "2020-04-29T17:30:28Z", "message": "update Ubuntu install command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1185294ef6c2bd5e0f91ac3df84eca3d0c49748f", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/1185294ef6c2bd5e0f91ac3df84eca3d0c49748f", "committedDate": "2020-04-29T17:30:28Z", "message": "remove extra GPHOME manipulation for Ubuntu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1434c5847faf10f7f4a180c9fe40b14feb531606", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/1434c5847faf10f7f4a180c9fe40b14feb531606", "committedDate": "2020-04-29T17:30:28Z", "message": "added more jobs to the pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bacdcac8a99f4cf6c491ac73af571c2dd2d4feb4", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/bacdcac8a99f4cf6c491ac73af571c2dd2d4feb4", "committedDate": "2020-04-29T17:30:28Z", "message": "added multi-node job"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3563960dd2fff71fe6b2a53d38e3a1e45c83ed6", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/c3563960dd2fff71fe6b2a53d38e3a1e45c83ed6", "committedDate": "2020-04-29T17:30:28Z", "message": "make install_hadoop handle component-based install"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98f32dff38fb45d39c2df93ae4e65e3739b1d880", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/98f32dff38fb45d39c2df93ae4e65e3739b1d880", "committedDate": "2020-04-29T17:30:28Z", "message": "remove typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2231ab5a1687eb31c5a85ab3c3236eee1a53870e", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/2231ab5a1687eb31c5a85ab3c3236eee1a53870e", "committedDate": "2020-04-29T17:30:28Z", "message": "removed .bash extension"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "343a88bdbe42f43bffefa898ea60e8ccf9443858", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/343a88bdbe42f43bffefa898ea60e8ccf9443858", "committedDate": "2020-04-29T17:30:28Z", "message": "install PXF as a superuser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66b4ab0ac1400664437abc457af3ac62fdfb1f08", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/66b4ab0ac1400664437abc457af3ac62fdfb1f08", "committedDate": "2020-04-29T17:30:28Z", "message": "break command into 3 lines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fdc1a3fcfed2a080412a10b1ca27292530d261d", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/0fdc1a3fcfed2a080412a10b1ca27292530d261d", "committedDate": "2020-04-29T17:30:28Z", "message": "removed sourcing the script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "981fcd767fc291df57903f26b2afc69fca3acef1", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/981fcd767fc291df57903f26b2afc69fca3acef1", "committedDate": "2020-04-29T17:30:28Z", "message": "export GPHOME from multinode test script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e14e8afc3b4f834c6eef7c03b27f4c5d355e4c0", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/6e14e8afc3b4f834c6eef7c03b27f4c5d355e4c0", "committedDate": "2020-04-29T17:30:28Z", "message": "adjust GPHOME in SUT files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1241f298cae629f3fdd0d014e294a4d4eef33542", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/1241f298cae629f3fdd0d014e294a4d4eef33542", "committedDate": "2020-04-29T17:30:28Z", "message": "added jobs, HDFS verify delay 3 secs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "250430d77f6b667fae07cf451cb1a2999b333fbc", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/250430d77f6b667fae07cf451cb1a2999b333fbc", "committedDate": "2020-04-29T17:30:28Z", "message": "check file during test verification, added jobs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea8273d0022045413e2294095116d4d32b3e4deb", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/ea8273d0022045413e2294095116d4d32b3e4deb", "committedDate": "2020-04-29T17:30:28Z", "message": "changed handling of impersonation in multi-node script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/9847fb0da1237d83cb9d8c4abfddee06e344bc7c", "committedDate": "2020-04-29T17:30:28Z", "message": "bump wait time, harden writable tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1da9208f7675d3ae7780e6e0823f50dec333425b", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/1da9208f7675d3ae7780e6e0823f50dec333425b", "committedDate": "2020-04-29T04:09:49Z", "message": "bump wait time, harden writable tests"}, "afterCommit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/9847fb0da1237d83cb9d8c4abfddee06e344bc7c", "committedDate": "2020-04-29T17:30:28Z", "message": "bump wait time, harden writable tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/f87aedc213114317905f6f1ec9396d8da37377ef", "committedDate": "2020-04-29T17:49:29Z", "message": "hardened Parquet test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyODk0MzA2", "url": "https://github.com/greenplum-db/pxf/pull/342#pullrequestreview-402894306", "createdAt": "2020-04-29T17:41:16Z", "commit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c"}, "state": "APPROVED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNzo0MToxNlrOGOJ4Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxODowNDo0MlrOGOKyjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ5NTExMA==", "bodyText": "We should take the opportunity to switch to $() notation rather than ``.", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417495110", "createdAt": "2020-04-29T17:41:16Z", "author": {"login": "oliverralbertini"}, "path": "automation/Makefile", "diffHunk": "@@ -91,7 +91,7 @@ symlink_pxf_jars:\n \t\tmkdir -p $(PXF_HOME)/tmp && \\\n \t\tcd $(PXF_HOME)/tmp && \\\n \t\tfor X in $(PXF_HOME)/lib/pxf-*-[0-9]*.jar; do \\\n-\t\t\tln -sf $$X `echo \\`basename $$X\\` | sed -e 's/-[a-zA-Z0-9.]*.jar/.jar/'`; \\\n+\t\t\tln -sf $$X `echo \\`basename $$X\\` | sed -E -e 's/-[0-9]+[a-zA-Z0-9\\.-]*.jar/.jar/'`; \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ5NzMyMQ==", "bodyText": "is $PXF_ROOT_DIR/version a script? I think you are missing a cat or <:\nPXF_VERSION ?= $(shell < $(PXF_ROOT_DIR)/version)", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417497321", "createdAt": "2020-04-29T17:44:48Z", "author": {"login": "oliverralbertini"}, "path": "cli/go/src/pxf-cli/Makefile", "diffHunk": "@@ -1,28 +1,30 @@\n-.PHONY: all depend build tar install test clean help\n+include ../../../../common.mk\n+\n+.PHONY: all depend build stage install test clean help\n .DEFAULT_GOAL := build\n \n TARGET := $(shell echo $${PWD\\#\\#*/})\n PXF_ROOT_DIR := $(shell cd ../../../.. && pwd)\n-GO_DEP_CACHE := ${PXF_ROOT_DIR}/cli/go/pkg/dep\n PXF_SERVER_DIR := ${PXF_ROOT_DIR}/server\n-PXF_STAGING_DIR := ${PXF_SERVER_DIR}/build/stage/bin\n-PXF_SERVICE_SCRIPTS := ${PXF_SERVER_DIR}/pxf-service/src/scripts\n-PXF_VERSION := $(shell grep version= ${PXF_SERVER_DIR}/gradle.properties | cut -d= -f2)\n+PXF_CLI_DIR := ${PXF_ROOT_DIR}/cli\n+PXF_VERSION ?= $(shell $(PXF_ROOT_DIR)/version)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ5NzgyMA==", "bodyText": "maybe the PXF_VERSION should also be set in common.mk", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417497820", "createdAt": "2020-04-29T17:45:37Z", "author": {"login": "oliverralbertini"}, "path": "cli/go/src/pxf-cli/Makefile", "diffHunk": "@@ -1,28 +1,30 @@\n-.PHONY: all depend build tar install test clean help\n+include ../../../../common.mk\n+\n+.PHONY: all depend build stage install test clean help\n .DEFAULT_GOAL := build\n \n TARGET := $(shell echo $${PWD\\#\\#*/})\n PXF_ROOT_DIR := $(shell cd ../../../.. && pwd)\n-GO_DEP_CACHE := ${PXF_ROOT_DIR}/cli/go/pkg/dep\n PXF_SERVER_DIR := ${PXF_ROOT_DIR}/server\n-PXF_STAGING_DIR := ${PXF_SERVER_DIR}/build/stage/bin\n-PXF_SERVICE_SCRIPTS := ${PXF_SERVER_DIR}/pxf-service/src/scripts\n-PXF_VERSION := $(shell grep version= ${PXF_SERVER_DIR}/gradle.properties | cut -d= -f2)\n+PXF_CLI_DIR := ${PXF_ROOT_DIR}/cli\n+PXF_VERSION ?= $(shell $(PXF_ROOT_DIR)/version)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ5NzMyMQ=="}, "originalCommit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ5OTg2MQ==", "bodyText": "can't this be done with make now?", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417499861", "createdAt": "2020-04-29T17:48:49Z", "author": {"login": "oliverralbertini"}, "path": "concourse/scripts/build.bash", "diffHunk": "@@ -26,39 +23,17 @@ function install_gpdb() {\n function compile_pxf_protocol_extension() {\n     source \"${GPHOME}/greenplum_path.sh\"\n     if [[ ${TARGET_OS} == \"rhel6\" ]]; then\n-\t    source /opt/gcc_env.sh\n+        source /opt/gcc_env.sh\n     fi\n-\n-    USE_PGXS=1 make -C \"pxf-protocol-extension_src\"\n+    source /etc/bashrc\n+    make -C \"${PWD}/pxf_src\" tar\n }\n \n function package_pxf_protocol_extension() {\n-\n-    # store latest commit SHA\n-    pushd pxf-protocol-extension_src > /dev/null\n-    echo $(git rev-parse --verify HEAD) > commit.sha\n-    echo ${PPE_VERSION} > version\n-    popd > /dev/null\n-\n-    # establish OS-specific package name\n-    local package_name=ppe-gpdb${GPDB_MAJOR_VERSION}-${PPE_VERSION}-${TARGET_OS}-${TARGET_AR}\n-\n-    # prepare directory layout for artifacts\n-    mkdir -p dist/${package_name}/{lib/postgresql,share/postgresql/extension}\n-\n-    # place artifacts into appropriate locations\n-    cp pxf-protocol-extension_src/pxf.so dist/${package_name}/lib/postgresql/\n-    cp pxf-protocol-extension_src/pxf*.{sql,control} dist/${package_name}/share/postgresql/extension/\n-    cp pxf-protocol-extension_src/{commit.sha,version,concourse/scripts/install_component.bash} dist/${package_name}\n-\n-    # package artifacts into a tarball\n-    pushd dist > /dev/null\n-    tar cvzf ${package_name}.tar.gz ${package_name}\n-    popd > /dev/null\n-\n     # verify contents\n-    ls -al dist\n-    tar -tvzf dist/${package_name}.tar.gz\n+    ls -al pxf_src/build/dist\n+    tar -tvzf pxf_src/build/dist/pxf-*.tar.gz\n+    cp pxf_src/build/dist/pxf-*.tar.gz dist", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9847fb0da1237d83cb9d8c4abfddee06e344bc7c"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUwMDgzOQ==", "bodyText": "typo", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417500839", "createdAt": "2020-04-29T17:50:19Z", "author": {"login": "oliverralbertini"}, "path": "concourse/scripts/install_hadoop.bash", "diffHunk": "@@ -12,8 +12,14 @@ REMOTE_GPHD_ROOT=~centos/singlecluster\n function install_hadoop_single_cluster() {\n \tlocal hadoop_ip=${1}\n \n-\ttar -xzf pxf_tarball/pxf.tar.gz -C /tmp\n-\tcp /tmp/pxf/lib/pxf-hbase-*.jar \"${LOCAL_GPHD_ROOT}/hbase/lib\"\n+\ttar -xzf pxf_tarball/pxf*.tar.gz -C /tmp\n+\tif [[ -d /tmp/pxf/lib ]]; then\n+\t    # regular tarball based install (old)\n+\t    cp /tmp/pxf/lib/pxf-hbase-*.jar \"${LOCAL_GPHD_ROOT}/hbase/lib\"\n+\telse\n+\t    # componet tarball based install (new)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUwMTcxMg==", "bodyText": "Do you want to do PXF_COMPONENT flag like in install_pxf.bash?", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417501712", "createdAt": "2020-04-29T17:51:39Z", "author": {"login": "oliverralbertini"}, "path": "concourse/scripts/install_hadoop.bash", "diffHunk": "@@ -12,8 +12,14 @@ REMOTE_GPHD_ROOT=~centos/singlecluster\n function install_hadoop_single_cluster() {\n \tlocal hadoop_ip=${1}\n \n-\ttar -xzf pxf_tarball/pxf.tar.gz -C /tmp\n-\tcp /tmp/pxf/lib/pxf-hbase-*.jar \"${LOCAL_GPHD_ROOT}/hbase/lib\"\n+\ttar -xzf pxf_tarball/pxf*.tar.gz -C /tmp\n+\tif [[ -d /tmp/pxf/lib ]]; then\n+\t    # regular tarball based install (old)\n+\t    cp /tmp/pxf/lib/pxf-hbase-*.jar \"${LOCAL_GPHD_ROOT}/hbase/lib\"\n+\telse\n+\t    # componet tarball based install (new)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUwMDgzOQ=="}, "originalCommit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUwMzU4OA==", "bodyText": "Should we delete the old pxf test script?", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417503588", "createdAt": "2020-04-29T17:54:31Z", "author": {"login": "oliverralbertini"}, "path": "concourse/scripts/test.bash", "diffHunk": "@@ -0,0 +1,250 @@\n+#!/bin/bash", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUwNTc0MQ==", "bodyText": "I like this idea, but does it belong on the docker image level?", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417505741", "createdAt": "2020-04-29T17:57:45Z", "author": {"login": "oliverralbertini"}, "path": "dev/install_gpdb_package.bash", "diffHunk": "@@ -0,0 +1,60 @@\n+#!/usr/bin/env bash\n+\n+CWDIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n+\n+# TODO: check if gpadmin-limits.conf already exists and bail out if it does\n+>/etc/security/limits.d/gpadmin-limits.conf cat <<-EOF\n+gpadmin soft core unlimited\n+gpadmin soft nproc 131072\n+gpadmin soft nofile 65536\n+EOF\n+\n+>>/home/gpadmin/.bash_profile cat <<EOF", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUwODgwNA==", "bodyText": "same comment as for pxf-cli/Makefile", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417508804", "createdAt": "2020-04-29T18:02:38Z", "author": {"login": "oliverralbertini"}, "path": "server/Makefile", "diffHunk": "@@ -17,30 +17,34 @@\n #\n # protect the default target for this file from the targets in Makefile.global\n \n-default: all\n+include ../common.mk\n+\n+default: stage-notest\n \n-BUILD_PARAMS+= -DdeployPath=\"$(PXF_HOME)\"\n TOMCAT_VERSION=\"7.0.100\"\n TOMCAT_DIR=\"tomcat/build\"\n TOMCAT_TAR=\"apache-tomcat-${TOMCAT_VERSION}.tar.gz\"\n TOMCAT_URL=\"http://archive.apache.org/dist/tomcat/tomcat-7/v${TOMCAT_VERSION}/bin/${TOMCAT_TAR}\"\n \n+PXF_ROOT_DIR := $(shell cd .. && pwd)\n+PXF_VERSION ?= $(shell $(PXF_ROOT_DIR)/version)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUxMDAyOQ==", "bodyText": "We going to keep this?", "url": "https://github.com/greenplum-db/pxf/pull/342#discussion_r417510029", "createdAt": "2020-04-29T18:04:42Z", "author": {"login": "oliverralbertini"}, "path": "server/pxf-jdbc/src/test/java/org/greenplum/pxf/plugins/jdbc/utils/ConnectionManagerTest.java", "diffHunk": "@@ -76,6 +77,7 @@ public void testGetConnectionPoolDisabled() throws SQLException {\n     }\n \n     @Test\n+    @Ignore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87aedc213114317905f6f1ec9396d8da37377ef"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb472a908740bef0fdddda9d3c5e8b115b5c568", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/9eb472a908740bef0fdddda9d3c5e8b115b5c568", "committedDate": "2020-04-29T18:57:47Z", "message": "address PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7697e6dd336ed58edd64e25b0e70fc4b4853bc29", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/7697e6dd336ed58edd64e25b0e70fc4b4853bc29", "committedDate": "2020-04-29T19:30:35Z", "message": "harden Parquet test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c103129e7fbb58a3364c032dbf0f79925ee2952f", "author": {"user": {"login": "denalex", "name": "Alexander Denissov"}}, "url": "https://github.com/greenplum-db/pxf/commit/c103129e7fbb58a3364c032dbf0f79925ee2952f", "committedDate": "2020-04-29T21:22:54Z", "message": "added missing ccp7-image"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 36, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}