{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0OTczMTc0", "number": 479, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzowMTowNVrOE1AyBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo1MzowMFrOE1BeJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0MDIyNzkxOnYy", "diffSide": "RIGHT", "path": "concourse/scripts/cli/common.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzowMTowNVrOHtDhoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNTowNjoxMFrOHtcRmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAwNTcyOQ==", "bodyText": "I don't think we need to use find here, wouldn't export PXF_HOME=\"/usr/local/pxf-gp*\" work? If you wanted to be really defensive, you could use glob like /usr/local/pxf-gp?or/usr/local/pxf-gp[56]`.", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517005729", "createdAt": "2020-11-03T23:01:05Z", "author": {"login": "bradfordb-vmware"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -1,8 +1,13 @@\n #!/usr/bin/env bash\n \n export PXF_CONF=~gpadmin/pxf\n-GPHOME=/usr/local/greenplum-db-devel\n-export PATH=$PATH:${GPHOME}/pxf/bin\n+export GPHOME=/usr/local/greenplum-db\n+export PXF_HOME=$(find /usr/local/ -name \"pxf-gp*\" -type d)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6ca5763d1cbe97ad9e9e3564736b2ad7f85b7fc"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMTIyNA==", "bodyText": "I couldn't get globs working here. Reverted back to find", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517411224", "createdAt": "2020-11-04T15:06:10Z", "author": {"login": "frankgh"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -1,8 +1,13 @@\n #!/usr/bin/env bash\n \n export PXF_CONF=~gpadmin/pxf\n-GPHOME=/usr/local/greenplum-db-devel\n-export PATH=$PATH:${GPHOME}/pxf/bin\n+export GPHOME=/usr/local/greenplum-db\n+export PXF_HOME=$(find /usr/local/ -name \"pxf-gp*\" -type d)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAwNTcyOQ=="}, "originalCommit": {"oid": "b6ca5763d1cbe97ad9e9e3564736b2ad7f85b7fc"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0MDI2MDg4OnYy", "diffSide": "RIGHT", "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzoxNDo1MFrOHtD0iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzoyMTowMVrOHtD8OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAxMDU3MQ==", "bodyText": "why do we need the standby master?", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517010571", "createdAt": "2020-11-03T23:14:50Z", "author": {"login": "ashuka24"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -1189,6 +1189,7 @@ jobs:\n             segments_per_host: 4\n             instance_type: n1-standard-4\n             ccp_reap_minutes: 120\n+            standby_master: true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8316a631f6ee4507ca703b143053a2cf87dbd8eb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAxMjUzNw==", "bodyText": "The PXF CLI tests make sure that standby master is also being tested", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517012537", "createdAt": "2020-11-03T23:21:01Z", "author": {"login": "frankgh"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -1189,6 +1189,7 @@ jobs:\n             segments_per_host: 4\n             instance_type: n1-standard-4\n             ccp_reap_minutes: 120\n+            standby_master: true", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAxMDU3MQ=="}, "originalCommit": {"oid": "8316a631f6ee4507ca703b143053a2cf87dbd8eb"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0MDMyOTMyOnYy", "diffSide": "RIGHT", "path": "concourse/scripts/cli/common.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo0Njo1MlrOHtEcFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNTowNDozNlrOHtcNMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMDY5Mg==", "bodyText": "is ? supposed to be there ?", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517020692", "createdAt": "2020-11-03T23:46:52Z", "author": {"login": "denalex"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -1,8 +1,13 @@\n #!/usr/bin/env bash\n \n export PXF_CONF=~gpadmin/pxf\n-GPHOME=/usr/local/greenplum-db-devel\n-export PATH=$PATH:${GPHOME}/pxf/bin\n+export GPHOME=/usr/local/greenplum-db\n+export PXF_HOME=/usr/local/pxf-gp?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMDA5OA==", "bodyText": "it turns out glob expansion doesn't work when defining env variables", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517410098", "createdAt": "2020-11-04T15:04:36Z", "author": {"login": "frankgh"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -1,8 +1,13 @@\n #!/usr/bin/env bash\n \n export PXF_CONF=~gpadmin/pxf\n-GPHOME=/usr/local/greenplum-db-devel\n-export PATH=$PATH:${GPHOME}/pxf/bin\n+export GPHOME=/usr/local/greenplum-db\n+export PXF_HOME=/usr/local/pxf-gp?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMDY5Mg=="}, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0MDM0MDg0OnYy", "diffSide": "RIGHT", "path": "concourse/pipelines/templates/dev_build_pipeline-tpl.yml", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo1MzowMFrOHtEjFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNTowNToxMVrOHtcPAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMjQ4NA==", "bodyText": "does this assume CLI tests leave PXF installation / configuration in a correct state for the downstream feature suite to work ? If yes, that would be a burden for future CLI test developers not aware of this coupling. If not, should the feature suite cleanup everything before starting ?", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517022484", "createdAt": "2020-11-03T23:53:00Z", "author": {"login": "denalex"}, "path": "concourse/pipelines/templates/dev_build_pipeline-tpl.yml", "diffHunk": "@@ -1074,6 +1075,12 @@ jobs:\n       GP_VER: [[gp_ver]]\n       KERBEROS: ((kerberos-enabled))\n       PXF_JVM_OPTS: ((pxf-jvm-opts))\n+  - task: Test PXF CLI\n+    image: gpdb[[gp_ver]]-pxf-dev-centos7-image\n+    file: pxf_src/concourse/tasks/test_pxf_cli.yml\n+    params:\n+      TARGET_OS: centos\n+      TARGET_OS_VERSION: 7", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA0NTM2NA==", "bodyText": "that's a concern I have in the back of my mind. I was considering moving this task to run after the automation test task. That way we don't need to worry about the state of PXF before running the automation tests", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517045364", "createdAt": "2020-11-04T01:18:11Z", "author": {"login": "frankgh"}, "path": "concourse/pipelines/templates/dev_build_pipeline-tpl.yml", "diffHunk": "@@ -1074,6 +1075,12 @@ jobs:\n       GP_VER: [[gp_ver]]\n       KERBEROS: ((kerberos-enabled))\n       PXF_JVM_OPTS: ((pxf-jvm-opts))\n+  - task: Test PXF CLI\n+    image: gpdb[[gp_ver]]-pxf-dev-centos7-image\n+    file: pxf_src/concourse/tasks/test_pxf_cli.yml\n+    params:\n+      TARGET_OS: centos\n+      TARGET_OS_VERSION: 7", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMjQ4NA=="}, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMDU2Mg==", "bodyText": "ok, moved the test to run as the last task.", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517410562", "createdAt": "2020-11-04T15:05:11Z", "author": {"login": "frankgh"}, "path": "concourse/pipelines/templates/dev_build_pipeline-tpl.yml", "diffHunk": "@@ -1074,6 +1075,12 @@ jobs:\n       GP_VER: [[gp_ver]]\n       KERBEROS: ((kerberos-enabled))\n       PXF_JVM_OPTS: ((pxf-jvm-opts))\n+  - task: Test PXF CLI\n+    image: gpdb[[gp_ver]]-pxf-dev-centos7-image\n+    file: pxf_src/concourse/tasks/test_pxf_cli.yml\n+    params:\n+      TARGET_OS: centos\n+      TARGET_OS_VERSION: 7", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMjQ4NA=="}, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3517, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}