{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0OTU5MTM2", "number": 431, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMjoxODozN1rOEdaE3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToyNTozMFrOEfFf1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjcxMzg4OnYy", "diffSide": "RIGHT", "path": "concourse/vars/build.dev.yml", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMjoxODozN1rOHIjKdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMzozMDowMFrOHIkmWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcyNjc3NQ==", "bodyText": "I guess we have a concourse/settings that is kind of equivalent to vars. Should we consolidate?", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r478726775", "createdAt": "2020-08-27T22:18:37Z", "author": {"login": "frankgh"}, "path": "concourse/vars/build.dev.yml", "diffHunk": "@@ -0,0 +1,5 @@\n+pxf-git-remote-ssh-url: git@github.com:pivotal/gp-pxf-dev.git", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0da70606d0189653fc023955d57504eaea4070a8"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODc1MDE5MA==", "bodyText": "probably. We have things scattered around pxf-secrets and settings. I'd like to understand what belongs where -- anything non-credential goes to settings ? In that case we might need to do some migration.", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r478750190", "createdAt": "2020-08-27T23:29:41Z", "author": {"login": "denalex"}, "path": "concourse/vars/build.dev.yml", "diffHunk": "@@ -0,0 +1,5 @@\n+pxf-git-remote-ssh-url: git@github.com:pivotal/gp-pxf-dev.git", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcyNjc3NQ=="}, "originalCommit": {"oid": "0da70606d0189653fc023955d57504eaea4070a8"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODc1MDI5Ng==", "bodyText": "I think consolidation is a great idea. I'll move this file to concourse/settings/build.dev.yml", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r478750296", "createdAt": "2020-08-27T23:30:00Z", "author": {"login": "bradfordb-vmware"}, "path": "concourse/vars/build.dev.yml", "diffHunk": "@@ -0,0 +1,5 @@\n+pxf-git-remote-ssh-url: git@github.com:pivotal/gp-pxf-dev.git", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcyNjc3NQ=="}, "originalCommit": {"oid": "0da70606d0189653fc023955d57504eaea4070a8"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjcxNjE3OnYy", "diffSide": "RIGHT", "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMjoxOTozMlrOHIjLyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMzozMTo1MFrOHIkorQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcyNzExNQ==", "bodyText": "what's the difference between [ and (?", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r478727115", "createdAt": "2020-08-27T22:19:32Z", "author": {"login": "frankgh"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -1565,10 +1568,10 @@ jobs:\n     image: google-cloud-sdk-slim-image\n     file: pxf_src/concourse/tasks/get_pxf_release_artifacts.yml\n     params:\n-      GCS_ODP_PATH: prod/ODP\n-      GCS_OSL_PATH: prod/OSL\n+      GCS_ODP_PATH: [[pxf_releases_bucket_prefix]]/ODP", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0da70606d0189653fc023955d57504eaea4070a8"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODc0ODc5NA==", "bodyText": "[ are template generation variables, it will generate yams files with resolved variables. We usually use that for control (send slack or not) and gp_ver. Should these buckets be driven by values of the secrets rather than template substitutions ?", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r478748794", "createdAt": "2020-08-27T23:24:54Z", "author": {"login": "denalex"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -1565,10 +1568,10 @@ jobs:\n     image: google-cloud-sdk-slim-image\n     file: pxf_src/concourse/tasks/get_pxf_release_artifacts.yml\n     params:\n-      GCS_ODP_PATH: prod/ODP\n-      GCS_OSL_PATH: prod/OSL\n+      GCS_ODP_PATH: [[pxf_releases_bucket_prefix]]/ODP", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcyNzExNQ=="}, "originalCommit": {"oid": "0da70606d0189653fc023955d57504eaea4070a8"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODc1MDg5Mw==", "bodyText": "We can change this to ((pxf-release-bucket-prefix)) and add them to concourse/settings/build.{dev,prod}.yml. Since these aren't credentials, I like to keep the settings close to the pipeline.", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r478750893", "createdAt": "2020-08-27T23:31:50Z", "author": {"login": "bradfordb-vmware"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -1565,10 +1568,10 @@ jobs:\n     image: google-cloud-sdk-slim-image\n     file: pxf_src/concourse/tasks/get_pxf_release_artifacts.yml\n     params:\n-      GCS_ODP_PATH: prod/ODP\n-      GCS_OSL_PATH: prod/OSL\n+      GCS_ODP_PATH: [[pxf_releases_bucket_prefix]]/ODP", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcyNzExNQ=="}, "originalCommit": {"oid": "0da70606d0189653fc023955d57504eaea4070a8"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMDMxMzgyOnYy", "diffSide": "RIGHT", "path": "concourse/Makefile", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToyNTozMFrOHLI0Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMjoxMDowMlrOHLJ_gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ0MDg2Ng==", "bodyText": "I thought at some point we talked about copying all secrets, even common GP CI ones into PXF secrets file. Not sure if this is still desired", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r481440866", "createdAt": "2020-09-01T21:25:30Z", "author": {"login": "denalex"}, "path": "concourse/Makefile", "diffHunk": "@@ -46,28 +48,61 @@ set-build-pipeline:\n \t@PIPELINE_FILE=$$(mktemp) && \\\n \t$(TEMPLATE_CMD) --template build_pipeline-tpl.yml --vars \\\n \t\tbuild_deb=$(BUILD_DEB) \\\n+\t\temail_notification=$(EMAIL) \\\n \t\tslack_notification=$(SLACK) \\\n \t\tgit_branch=$(BRANCH) \\\n \t\tnum_gpdb5_versions=$(NUM_GPDB5_VERSIONS) \\\n-\t\tnum_gpdb6_versions=$(NUM_GPDB6_VERSIONS) >\"$${PIPELINE_FILE}\" && \\\n+\t\tnum_gpdb6_versions=$(NUM_GPDB6_VERSIONS) \\\n+\t\tpxf_build_bucket_prefix=prod \\\n+\t\tpxf_releases_bucket_prefix=prod >\"$${PIPELINE_FILE}\" && \\\n \t$(FLY_CMD) --target=$(CONCOURSE) \\\n \t\tset-pipeline \\\n \t\t--check-creds \\\n \t\t--pipeline=$(BUILD_PIPELINE_NAME) \\\n \t\t--config \"$${PIPELINE_FILE}\" \\\n-\t\t--load-vars-from=$(SECRETS_FILE) \\\n-\t\t--load-vars-from=$(HOME)/workspace/gp-continuous-integration/secrets/gpdb_common-ci-secrets.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/pxf-secrets.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/gpdb_common-ci-secrets.yml \\\n \t\t--load-vars-from=$(HOME)/workspace/pxf/concourse/settings/pxf-multinode-params.yml \\\n-\t\t--load-vars-from=$(HOME)/workspace/gp-continuous-integration/secrets/ccp_ci_secrets_ud.yml \\\n-\t\t--load-vars-from=$(HOME)/workspace/gp-continuous-integration/secrets/ccp_ci_secrets_ud_kerberos.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/ccp_ci_secrets_ud.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/ccp_ci_secrets_ud_kerberos.yml \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a55d02f97a5a9950b0372772c901e9c5cdca304f"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ2MDA5OQ==", "bodyText": "w/ @ashuka24: We've consolidated the separate CCP credential files into the single pxf-secrets.yml and have updated the make commands.", "url": "https://github.com/greenplum-db/pxf/pull/431#discussion_r481460099", "createdAt": "2020-09-01T22:10:02Z", "author": {"login": "bradfordb-vmware"}, "path": "concourse/Makefile", "diffHunk": "@@ -46,28 +48,61 @@ set-build-pipeline:\n \t@PIPELINE_FILE=$$(mktemp) && \\\n \t$(TEMPLATE_CMD) --template build_pipeline-tpl.yml --vars \\\n \t\tbuild_deb=$(BUILD_DEB) \\\n+\t\temail_notification=$(EMAIL) \\\n \t\tslack_notification=$(SLACK) \\\n \t\tgit_branch=$(BRANCH) \\\n \t\tnum_gpdb5_versions=$(NUM_GPDB5_VERSIONS) \\\n-\t\tnum_gpdb6_versions=$(NUM_GPDB6_VERSIONS) >\"$${PIPELINE_FILE}\" && \\\n+\t\tnum_gpdb6_versions=$(NUM_GPDB6_VERSIONS) \\\n+\t\tpxf_build_bucket_prefix=prod \\\n+\t\tpxf_releases_bucket_prefix=prod >\"$${PIPELINE_FILE}\" && \\\n \t$(FLY_CMD) --target=$(CONCOURSE) \\\n \t\tset-pipeline \\\n \t\t--check-creds \\\n \t\t--pipeline=$(BUILD_PIPELINE_NAME) \\\n \t\t--config \"$${PIPELINE_FILE}\" \\\n-\t\t--load-vars-from=$(SECRETS_FILE) \\\n-\t\t--load-vars-from=$(HOME)/workspace/gp-continuous-integration/secrets/gpdb_common-ci-secrets.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/pxf-secrets.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/gpdb_common-ci-secrets.yml \\\n \t\t--load-vars-from=$(HOME)/workspace/pxf/concourse/settings/pxf-multinode-params.yml \\\n-\t\t--load-vars-from=$(HOME)/workspace/gp-continuous-integration/secrets/ccp_ci_secrets_ud.yml \\\n-\t\t--load-vars-from=$(HOME)/workspace/gp-continuous-integration/secrets/ccp_ci_secrets_ud_kerberos.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/ccp_ci_secrets_ud.yml \\\n+\t\t--load-vars-from=$(SECRETS_HOME)/ccp_ci_secrets_ud_kerberos.yml \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ0MDg2Ng=="}, "originalCommit": {"oid": "a55d02f97a5a9950b0372772c901e9c5cdca304f"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3447, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}