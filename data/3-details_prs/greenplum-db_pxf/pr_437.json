{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NDUzNjI0", "number": 437, "title": "Build DEB package for pxf-gp6 on Ubuntu 18.04", "bodyText": "", "createdAt": "2020-09-02T00:35:40Z", "url": "https://github.com/greenplum-db/pxf/pull/437", "merged": true, "mergeCommit": {"oid": "5fed2528d75e11c648a3d8a622a2d56d5d07dc23"}, "closed": true, "closedAt": "2020-09-09T22:10:36Z", "author": {"login": "bradfordb-vmware"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE5oqSAFqTQ4MDMwNzM4MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHTrdLABqjM3NDgwMjk4OTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMzA3Mzgw", "url": "https://github.com/greenplum-db/pxf/pull/437#pullrequestreview-480307380", "createdAt": "2020-09-02T01:45:02Z", "commit": {"oid": "de735c4455ba12d201c6b2c637581b7d87513329"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMTo0NTowMlrOHLOwTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMDo0MToxMFrOHLpRlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUzODEyNA==", "bodyText": "why use underscore here, pxf-gp6_ where we use dash for rhel?", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481538124", "createdAt": "2020-09-02T01:45:02Z", "author": {"login": "frankgh"}, "path": "concourse/scripts/generate_releng_email.bash", "diffHunk": "@@ -22,6 +22,7 @@ version=$(<pxf_shipit_file/version)\n pxf_gp5_el6_releng_url=\"${RELENG_GP5_DROP_URL}/pxf-gp5-${version}-2.el6.x86_64.rpm\"\n pxf_gp5_el7_releng_url=\"${RELENG_GP5_DROP_URL}/pxf-gp5-${version}-2.el7.x86_64.rpm\"\n pxf_gp6_el7_releng_url=\"${RELENG_GP6_DROP_URL}/pxf-gp6-${version}-2.el7.x86_64.rpm\"\n+pxf_gp6_ubuntu18_releng_url=\"${RELENG_GP6_DROP_URL}/pxf-gp6_${version}-2.ubuntu18.04_amd64.deb\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de735c4455ba12d201c6b2c637581b7d87513329"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MDY0OQ==", "bodyText": "I was reading that apt is a more user friendly command introduced to be a more user facing, whereas apt-get gives  your more low-level control during installation. Any reason we prefer one or the other here?", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481970649", "createdAt": "2020-09-02T10:37:44Z", "author": {"login": "frankgh"}, "path": "concourse/scripts/pxf_common.bash", "diffHunk": "@@ -155,15 +155,15 @@ function install_gpdb_package() {\n \t\tfi\n \t\tpython_dir=python${python_version}/site-packages\n \t\texport_pythonpath+=:/usr/lib/${python_dir}:/usr/lib64/${python_dir}\n-\telif command -v apt; then\n-\t\t# install GPDB DEB, apt wants an absolute path\n+\telif command -v apt-get; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de735c4455ba12d201c6b2c637581b7d87513329"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MTIxMQ==", "bodyText": "minor, this line uses tab, vs the lines preceding it use spaces", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481971211", "createdAt": "2020-09-02T10:38:48Z", "author": {"login": "frankgh"}, "path": "dev/install_greenplum.bash", "diffHunk": "@@ -29,8 +29,8 @@ else\n     fi\n \n     echo \"Installing GPDB from ${LATEST_DEB} ...\"\n-    # apt wants a full path\n-\tsudo apt install -qq \"${PWD}/${LATEST_DEB}\"\n+    # apt-get wants a full path\n+\tsudo apt-get install -qq \"${PWD}/${LATEST_DEB}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de735c4455ba12d201c6b2c637581b7d87513329"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MjYzMA==", "bodyText": "should we parameterize the Maintainer as well? I'm concerned about our team email address being in the wild", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481972630", "createdAt": "2020-09-02T10:41:10Z", "author": {"login": "frankgh"}, "path": "package/control", "diffHunk": "@@ -0,0 +1,5 @@\n+Package: pxf-gp6\n+Version: %VERSION%\n+Architecture: amd64\n+Maintainer: Greenplum Unmanaged Data <pvtl-gp-ud@vmware.com>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de735c4455ba12d201c6b2c637581b7d87513329"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMjkyODA0", "url": "https://github.com/greenplum-db/pxf/pull/437#pullrequestreview-481292804", "createdAt": "2020-09-02T20:54:07Z", "commit": {"oid": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMDo1NDowN1rOHMGpcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMjowNzozMFrOHMK0Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ1Mzg3Mg==", "bodyText": "please add new targets to the list below", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482453872", "createdAt": "2020-09-02T20:54:07Z", "author": {"login": "denalex"}, "path": "Makefile", "diffHunk": "@@ -97,6 +97,40 @@ rpm-tar: rpm\n \tcp package/install_rpm build/stagerpm/$${PXF_PACKAGE_NAME}/install_component ;\\\n \ttar -czf build/distrpm/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagerpm $${PXF_PACKAGE_NAME}\n \n+deb:\n+\tmake -C external-table stage\n+\tmake -C cli/go/src/pxf-cli stage\n+\tmake -C server stage\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_MAIN_VERSION=$${PXF_VERSION//-SNAPSHOT/} ;\\\n+\tif [[ $${PXF_VERSION} == *\"-SNAPSHOT\" ]]; then PXF_RELEASE=SNAPSHOT; else PXF_RELEASE=1; fi ;\\\n+\trm -rf build/debbuild ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a external-table/build/stage/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a cli/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tcp -a server/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\techo $$(git rev-parse --verify HEAD) > build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/commit.sha ;\\\n+\tmkdir build/debbuild/DEBIAN ;\\\n+\tsed -e \"s/%VERSION%/$${PXF_MAIN_VERSION}-$${PXF_RELEASE}/\" package/control > build/debbuild/DEBIAN/control ;\\\n+\tcp -a package/prerm build/debbuild/DEBIAN/prerm ;\\\n+\tdpkg-deb --build build/debbuild ;\\\n+\tmv build/debbuild.deb build/pxf-gp$${GP_MAJOR_VERSION}_$${PXF_MAIN_VERSION}-$${PXF_RELEASE}.ubuntu18.04_amd64.deb\n+\n+deb-tar: deb\n+\trm -rf build/{stagedeb,distdeb}\n+\tmkdir -p build/{stagedeb,distdeb}\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_DEB_FILE=$$(find build/ -name pxf-gp$${GP_MAJOR_VERSION}*.deb) ;\\\n+\tPXF_PACKAGE_NAME=$$(dpkg-deb --field $${PXF_DEB_FILE} Package)-$$(dpkg-deb --field $${PXF_DEB_FILE} Version).$${TARGET_OS} ;\\\n+\tmkdir -p build/stagedeb/$${PXF_PACKAGE_NAME} ;\\\n+\tcp $${PXF_DEB_FILE} build/stagedeb/$${PXF_PACKAGE_NAME} ;\\\n+\tcp package/install_deb build/stagedeb/$${PXF_PACKAGE_NAME}/install_component ;\\\n+\ttar -czf build/distdeb/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagedeb $${PXF_PACKAGE_NAME}\n+\n+\n help:\n \t@echo\n \t@echo 'Possible targets'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ1ODE0Mw==", "bodyText": "line 109 is technically not needed as 110 will create the full path along", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482458143", "createdAt": "2020-09-02T20:57:20Z", "author": {"login": "denalex"}, "path": "Makefile", "diffHunk": "@@ -97,6 +97,40 @@ rpm-tar: rpm\n \tcp package/install_rpm build/stagerpm/$${PXF_PACKAGE_NAME}/install_component ;\\\n \ttar -czf build/distrpm/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagerpm $${PXF_PACKAGE_NAME}\n \n+deb:\n+\tmake -C external-table stage\n+\tmake -C cli/go/src/pxf-cli stage\n+\tmake -C server stage\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_MAIN_VERSION=$${PXF_VERSION//-SNAPSHOT/} ;\\\n+\tif [[ $${PXF_VERSION} == *\"-SNAPSHOT\" ]]; then PXF_RELEASE=SNAPSHOT; else PXF_RELEASE=1; fi ;\\\n+\trm -rf build/debbuild ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ2MzQwNg==", "bodyText": "since stage target prepares binary layout, why just not cp -R build/stagestage build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ?", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482463406", "createdAt": "2020-09-02T21:01:20Z", "author": {"login": "denalex"}, "path": "Makefile", "diffHunk": "@@ -97,6 +97,40 @@ rpm-tar: rpm\n \tcp package/install_rpm build/stagerpm/$${PXF_PACKAGE_NAME}/install_component ;\\\n \ttar -czf build/distrpm/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagerpm $${PXF_PACKAGE_NAME}\n \n+deb:\n+\tmake -C external-table stage\n+\tmake -C cli/go/src/pxf-cli stage\n+\tmake -C server stage\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_MAIN_VERSION=$${PXF_VERSION//-SNAPSHOT/} ;\\\n+\tif [[ $${PXF_VERSION} == *\"-SNAPSHOT\" ]]; then PXF_RELEASE=SNAPSHOT; else PXF_RELEASE=1; fi ;\\\n+\trm -rf build/debbuild ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a external-table/build/stage/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a cli/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tcp -a server/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3NjA2MA==", "bodyText": "lines 708 and 710 look redundant now, why not just hardcode the number 6 in the job names ?", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482476060", "createdAt": "2020-09-02T21:11:48Z", "author": {"login": "denalex"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -724,14 +706,10 @@ jobs:\n       - Test PXF-GP6-HDP2 on OEL7\n {% set gp_ver = None %}\n {% set gp_ver = 6 %}\n-{% if build_deb %}\n       - Test PXF-GP[[gp_ver]]-HDP2 on Ubuntu18\n-{% endif %}\n {% set gp_ver = 6 %}\n-{% if build_deb %}\n     - get: pxf_gp[[gp_ver]]_tarball_ubuntu18\n       passed: [Test PXF-GP[[gp_ver]]-HDP2 on Ubuntu18]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyMDk4MA==", "bodyText": "Does it need to have email there ? Can we just say VMware, Inc. ?", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482520980", "createdAt": "2020-09-02T22:05:56Z", "author": {"login": "denalex"}, "path": "package/control", "diffHunk": "@@ -0,0 +1,5 @@\n+Package: pxf-gp6\n+Version: %VERSION%\n+Architecture: amd64\n+Maintainer: Greenplum Unmanaged Data <pvtl-gp-ud@vmware.com>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MjYzMA=="}, "originalCommit": {"oid": "de735c4455ba12d201c6b2c637581b7d87513329"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyMjExNA==", "bodyText": "how is this file integrated with install / upgrade from DEB ?", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482522114", "createdAt": "2020-09-02T22:07:30Z", "author": {"login": "denalex"}, "path": "package/prerm", "diffHunk": "@@ -0,0 +1,5 @@\n+#!/bin/sh\n+\n+rm -f /usr/local/pxf-gp6/conf/pxf-private.classpath\n+rm -rf /usr/local/pxf-gp6/pxf-service\n+rm -rf /usr/local/pxf-gp6/run", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDU4NDY3", "url": "https://github.com/greenplum-db/pxf/pull/437#pullrequestreview-482058467", "createdAt": "2020-09-03T17:33:01Z", "commit": {"oid": "3078236b5bfed2436337bf49737d5f55e2fff26f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNzozMzowMlrOHMwzZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNzozMzowMlrOHMwzZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0NDU0OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t@echo\t'  - rpm - create PXF RPM'\n          \n          \n            \n            \t@echo\t'  - rpm - create PXF RPM package'", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r483144548", "createdAt": "2020-09-03T17:33:02Z", "author": {"login": "ashuka24"}, "path": "Makefile", "diffHunk": "@@ -142,5 +141,7 @@ help:\n \t@echo\t'  - test - runs tests for PXF Go CLI and server'\n \t@echo\t'  - install - install PXF external table extension, CLI and server'\n \t@echo\t'  - tar - bundle PXF external table extension, CLI, server and tomcat into a single tarball'\n-\t@echo\t'  - rpm - create PXF RPM / DEB package'\n-\t@echo\t'  - rpm-tar - bundle PXF RPM / DEB package along with helper scripts into a single tarball'\n+\t@echo\t'  - rpm - create PXF RPM'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3078236b5bfed2436337bf49737d5f55e2fff26f"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d8a64ac1a10b838294b2dbcb1eec4b4af59ea8a", "author": {"user": {"login": "ashuka24", "name": "Ashuka Xue"}}, "url": "https://github.com/greenplum-db/pxf/commit/6d8a64ac1a10b838294b2dbcb1eec4b4af59ea8a", "committedDate": "2020-09-03T20:55:51Z", "message": "fixup! Build and package PXF for Greenplum 6 on Ubuntu 18.04"}, "afterCommit": {"oid": "0f4fbdbf36dd5df82146218828cc7f6cb45c8738", "author": {"user": {"login": "ashuka24", "name": "Ashuka Xue"}}, "url": "https://github.com/greenplum-db/pxf/commit/0f4fbdbf36dd5df82146218828cc7f6cb45c8738", "committedDate": "2020-09-09T18:17:58Z", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d93f685f73de800c1353142505e6540f10781e92", "author": {"user": {"login": "ashuka24", "name": "Ashuka Xue"}}, "url": "https://github.com/greenplum-db/pxf/commit/d93f685f73de800c1353142505e6540f10781e92", "committedDate": "2020-09-09T22:10:01Z", "message": "Use apt-get in CI scripts instead of apt\n\napt is a more user-fiendly front-end and is not intended for use in\nscripts.\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "author": {"user": {"login": "ashuka24", "name": "Ashuka Xue"}}, "url": "https://github.com/greenplum-db/pxf/commit/5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "committedDate": "2020-09-09T22:10:01Z", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f4fbdbf36dd5df82146218828cc7f6cb45c8738", "author": {"user": {"login": "ashuka24", "name": "Ashuka Xue"}}, "url": "https://github.com/greenplum-db/pxf/commit/0f4fbdbf36dd5df82146218828cc7f6cb45c8738", "committedDate": "2020-09-09T18:17:58Z", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>"}, "afterCommit": {"oid": "5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "author": {"user": {"login": "ashuka24", "name": "Ashuka Xue"}}, "url": "https://github.com/greenplum-db/pxf/commit/5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "committedDate": "2020-09-09T22:10:01Z", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4871, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}