{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwOTczMjgy", "number": 308, "title": "Fix ESCAPE 'OFF' is not processed correctly on PXF side error", "bodyText": "Currently, PXF is not handling ESCAPE 'OFF' and DELIMITER 'OFF' correctly.\nThese are valid keywords that can be used to create an external table.\nIf provided, PXF should not ESCAPE or add DELIMITERS when reading data.\nFixes #307\nIntegrations tests to come", "createdAt": "2020-02-27T17:18:21Z", "url": "https://github.com/greenplum-db/pxf/pull/308", "merged": true, "mergeCommit": {"oid": "6f10d46b1ece84a054c0ac69907ee1b8384e87a2"}, "closed": true, "closedAt": "2020-02-28T20:44:43Z", "author": {"login": "frankgh"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIe2YxAFqTM2NTg2MDA2Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcI080NAFqTM2NjYyNzYzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODYwMDY3", "url": "https://github.com/greenplum-db/pxf/pull/308#pullrequestreview-365860067", "createdAt": "2020-02-27T17:34:02Z", "commit": {"oid": "a3f3d23944b2b07950b8e71554f90b8bf7a5c95b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDU0MTc5", "url": "https://github.com/greenplum-db/pxf/pull/308#pullrequestreview-366054179", "createdAt": "2020-02-27T22:46:12Z", "commit": {"oid": "a3f3d23944b2b07950b8e71554f90b8bf7a5c95b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjo0NjoxM1rOFvj5Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjo1MToyNVrOFvkAeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQxNTQ2Mw==", "bodyText": "can ESCAPE be a multi-char string ?", "url": "https://github.com/greenplum-db/pxf/pull/308#discussion_r385415463", "createdAt": "2020-02-27T22:46:13Z", "author": {"login": "denalex"}, "path": "server/pxf-api/src/main/java/org/greenplum/pxf/api/model/GreenplumCSV.java", "diffHunk": "@@ -105,7 +105,9 @@ public GreenplumCSV withQuoteChar(char quoteChar) {\n      * @return GreenplumCSV object for builder pattern\n      */\n     public GreenplumCSV withEscapeChar(String escapeString) {\n-        if (StringUtils.isNotEmpty(escapeString)) {\n+        if (StringUtils.equalsIgnoreCase(\"OFF\", escapeString)) {\n+            escape = null;\n+        } else if (StringUtils.isNotEmpty(escapeString)) {\n             validateSingleCharacter(escapeString, \"ESCAPE\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3f3d23944b2b07950b8e71554f90b8bf7a5c95b"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQxNzMzNw==", "bodyText": "wouldn't this be a problem for non-CSV tables where there's no delimiter ?", "url": "https://github.com/greenplum-db/pxf/pull/308#discussion_r385417337", "createdAt": "2020-02-27T22:51:25Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/main/java/org/greenplum/pxf/service/HttpRequestParser.java", "diffHunk": "@@ -163,6 +163,11 @@ public RequestContext parseRequest(HttpHeaders request, RequestContext.RequestTy\n         // parse CSV format information\n         parseGreenplumCSV(params, context);\n \n+        // Only single column tables support 'OFF' delimiter\n+        if (context.getTupleDescription().size() != 1 && context.getGreenplumCSV().getDelimiter() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3f3d23944b2b07950b8e71554f90b8bf7a5c95b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "525aaf0ce68f1f1c927d4c010fa55cb0c1dece72", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/525aaf0ce68f1f1c927d4c010fa55cb0c1dece72", "committedDate": "2020-02-28T15:35:54Z", "message": "Fix ESCAPE 'OFF' is not processed correctly on PXF side error"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3f3d23944b2b07950b8e71554f90b8bf7a5c95b", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/a3f3d23944b2b07950b8e71554f90b8bf7a5c95b", "committedDate": "2020-02-27T16:53:02Z", "message": "Fix ESCAPE 'OFF' is not processed correctly on PXF side error"}, "afterCommit": {"oid": "525aaf0ce68f1f1c927d4c010fa55cb0c1dece72", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/525aaf0ce68f1f1c927d4c010fa55cb0c1dece72", "committedDate": "2020-02-28T15:35:54Z", "message": "Fix ESCAPE 'OFF' is not processed correctly on PXF side error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f747e073912c145330087859a5ebc7717122646", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/1f747e073912c145330087859a5ebc7717122646", "committedDate": "2020-02-28T18:51:40Z", "message": "Add integration tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NjI3NjMw", "url": "https://github.com/greenplum-db/pxf/pull/308#pullrequestreview-366627630", "createdAt": "2020-02-28T19:18:58Z", "commit": {"oid": "1f747e073912c145330087859a5ebc7717122646"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4995, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}