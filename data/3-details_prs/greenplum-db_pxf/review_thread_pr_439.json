{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwNTE4NTg5", "number": 439, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjo0OTozMlrOEhxIaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNzozNDozM1rOEhyOeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzODQzNDMyOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjo0OTozMlrOHPQ_gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNzoyODoxNlrOHPSiWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc2OTA4OA==", "bodyText": "Are we sure that $LD_LIBRARY_PATH is non-empty at this point? If not, we need to use a different pattern: https://stackoverflow.com/questions/9631228/how-to-smart-append-ld-library-path-in-shell-when-nounset/9631350#9631350. Here's a anecdote of this bug in the wild.", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485769088", "createdAt": "2020-09-09T16:49:32Z", "author": {"login": "bradfordb-vmware"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native:${LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3528b7324730df8f9e1822c1d32e41ce6f59700"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc3Njk3Nw==", "bodyText": "Thanks for the feedback, I updated the PR", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485776977", "createdAt": "2020-09-09T16:58:41Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native:${LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc2OTA4OA=="}, "originalCommit": {"oid": "c3528b7324730df8f9e1822c1d32e41ce6f59700"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5NDM5NA==", "bodyText": "do we want the examples in the docs to use the new pattern as well?", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485794394", "createdAt": "2020-09-09T17:28:16Z", "author": {"login": "lisakowen"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native:${LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc2OTA4OA=="}, "originalCommit": {"oid": "c3528b7324730df8f9e1822c1d32e41ce6f59700"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzODYxMzcwOnYy", "diffSide": "RIGHT", "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNzozNDozM1rOHPSweA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxODozODozNFrOHPU5fA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5ODAwOA==", "bodyText": "if they uncomment it, it will cause ${PXF_CONF}/lib/native be listed after /usr/lib/hadoop/lib/native since that's how it is defined in pxf-env-default.sh, should it be in a different order ?", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485798008", "createdAt": "2020-09-09T17:34:33Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fab84049abf9d6c02882247b5cf201ee36950fd"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgwMTY4Mw==", "bodyText": "@denalex good point, ${PXF_CONF}/lib/native should be the first in the search path.\nWe should document that by default we pick native libraries from this path : /usr/lib/hadoop/lib/native. But if uncommented, the priority is\n\n${PXF_CONF}/lib/native\n/usr/lib/hadoop/lib/native\nLD_LIBRARY_PATH\n\n@bradfordb-vmware  are there any side effects of having LD_LIBRARY_PATH point to a non-existent directory?", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485801683", "createdAt": "2020-09-09T17:41:08Z", "author": {"login": "frankgh"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5ODAwOA=="}, "originalCommit": {"oid": "5fab84049abf9d6c02882247b5cf201ee36950fd"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgyMDQ2MQ==", "bodyText": "The way it is currently implemented (which is correct), if users uncomment, the order will be:\n${PXF_CONF}/lib/native\nLD_LIBRARY_PATH\n/usr/lib/hadoop/lib/native", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485820461", "createdAt": "2020-09-09T18:15:36Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5ODAwOA=="}, "originalCommit": {"oid": "5fab84049abf9d6c02882247b5cf201ee36950fd"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgyMTYzNA==", "bodyText": "Will tests on single cluster now use this automatically ? What about dataproc ? We should have at least some environments to use it so we know it is working fine. And some environments should not have native so we know it is working as well.", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485821634", "createdAt": "2020-09-09T18:17:41Z", "author": {"login": "denalex"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5ODAwOA=="}, "originalCommit": {"oid": "5fab84049abf9d6c02882247b5cf201ee36950fd"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgzMzA4NA==", "bodyText": "do we still want to allow users to specify their own path for native libraries?  and if so, how do we want them to modify the LD_LIBRARY_PATH setting in pxf-env.sh - add their library directory as the first element?", "url": "https://github.com/greenplum-db/pxf/pull/439#discussion_r485833084", "createdAt": "2020-09-09T18:38:34Z", "author": {"login": "lisakowen"}, "path": "server/pxf-service/src/templates/user/conf/pxf-env.sh", "diffHunk": "@@ -58,3 +58,6 @@ PXF_CONF=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )/..\" && pwd )\"\n \n # Dump heap on OutOfMemoryError, set to dump path to enable\n # export PXF_OOM_DUMP_PATH=/tmp/pxf_heap_dump\n+\n+# Uncomment below if you installed native libraries to be loaded by PXF\n+# export LD_LIBRARY_PATH=${PXF_CONF}/lib/native${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc5ODAwOA=="}, "originalCommit": {"oid": "5fab84049abf9d6c02882247b5cf201ee36950fd"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3457, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}