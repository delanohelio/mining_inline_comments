{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0OTczMTc0", "number": 479, "title": "Add PXF CLI test to multinode test", "bodyText": "After the RPM work was merged, the CLI test pipeline stopped working.\nThis PR restores the CLI tests, but it adds the test as a task in the\nmultinode impersonation job. This way, it reuses the setup, which is\nexpensive, and then the automation tests run after the CLI tests are\nsuccessful.", "createdAt": "2020-11-03T20:25:30Z", "url": "https://github.com/greenplum-db/pxf/pull/479", "merged": true, "mergeCommit": {"oid": "d071c23387e14d6b691952270a74debb7ec89738"}, "closed": true, "closedAt": "2020-11-04T22:52:02Z", "author": {"login": "frankgh"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdY_Gc4gH2gAyNTE0OTczMTc0OmI2Y2E1NzYzZDFjYmU5N2FkOWU5ZTM1NjQ3MzZiMmFkN2Y4NWI3ZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZVzQYAFqTUyMzc5MzE3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6ca5763d1cbe97ad9e9e3564736b2ad7f85b7fc", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/b6ca5763d1cbe97ad9e9e3564736b2ad7f85b7fc", "committedDate": "2020-11-03T20:22:29Z", "message": "Add PXF CLI test to multinode test\n\nAfter the RPM work was merged, the CLI test pipeline stopped working.\nThis PR restores the CLI tests, but it adds the test as a task in the\nmultinode impersonation job. This way, it reuses the setup, which is\nexpensive, and then the automation tests run after the CLI tests are\nsuccessful."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTM2MzQ3", "url": "https://github.com/greenplum-db/pxf/pull/479#pullrequestreview-522936347", "createdAt": "2020-11-03T23:01:05Z", "commit": {"oid": "b6ca5763d1cbe97ad9e9e3564736b2ad7f85b7fc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzowMTowNVrOHtDhoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzowMTowNVrOHtDhoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAwNTcyOQ==", "bodyText": "I don't think we need to use find here, wouldn't export PXF_HOME=\"/usr/local/pxf-gp*\" work? If you wanted to be really defensive, you could use glob like /usr/local/pxf-gp?or/usr/local/pxf-gp[56]`.", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517005729", "createdAt": "2020-11-03T23:01:05Z", "author": {"login": "bradfordb-vmware"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -1,8 +1,13 @@\n #!/usr/bin/env bash\n \n export PXF_CONF=~gpadmin/pxf\n-GPHOME=/usr/local/greenplum-db-devel\n-export PATH=$PATH:${GPHOME}/pxf/bin\n+export GPHOME=/usr/local/greenplum-db\n+export PXF_HOME=$(find /usr/local/ -name \"pxf-gp*\" -type d)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6ca5763d1cbe97ad9e9e3564736b2ad7f85b7fc"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8316a631f6ee4507ca703b143053a2cf87dbd8eb", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/8316a631f6ee4507ca703b143053a2cf87dbd8eb", "committedDate": "2020-11-03T23:04:46Z", "message": "Address PR feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTQxOTk3", "url": "https://github.com/greenplum-db/pxf/pull/479#pullrequestreview-522941997", "createdAt": "2020-11-03T23:14:49Z", "commit": {"oid": "8316a631f6ee4507ca703b143053a2cf87dbd8eb"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzoxNDo1MFrOHtD0iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzoxNDo1MFrOHtD0iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAxMDU3MQ==", "bodyText": "why do we need the standby master?", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517010571", "createdAt": "2020-11-03T23:14:50Z", "author": {"login": "ashuka24"}, "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -1189,6 +1189,7 @@ jobs:\n             segments_per_host: 4\n             instance_type: n1-standard-4\n             ccp_reap_minutes: 120\n+            standby_master: true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8316a631f6ee4507ca703b143053a2cf87dbd8eb"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/9374aeff957f66ccd36f9ac6888d47e530de0fd1", "committedDate": "2020-11-03T23:39:19Z", "message": "remove quotes for PXF_HOME"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTUzOTU0", "url": "https://github.com/greenplum-db/pxf/pull/479#pullrequestreview-522953954", "createdAt": "2020-11-03T23:46:52Z", "commit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo0Njo1MlrOHtEcFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo1MzowMFrOHtEjFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMDY5Mg==", "bodyText": "is ? supposed to be there ?", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517020692", "createdAt": "2020-11-03T23:46:52Z", "author": {"login": "denalex"}, "path": "concourse/scripts/cli/common.sh", "diffHunk": "@@ -1,8 +1,13 @@\n #!/usr/bin/env bash\n \n export PXF_CONF=~gpadmin/pxf\n-GPHOME=/usr/local/greenplum-db-devel\n-export PATH=$PATH:${GPHOME}/pxf/bin\n+export GPHOME=/usr/local/greenplum-db\n+export PXF_HOME=/usr/local/pxf-gp?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMjQ4NA==", "bodyText": "does this assume CLI tests leave PXF installation / configuration in a correct state for the downstream feature suite to work ? If yes, that would be a burden for future CLI test developers not aware of this coupling. If not, should the feature suite cleanup everything before starting ?", "url": "https://github.com/greenplum-db/pxf/pull/479#discussion_r517022484", "createdAt": "2020-11-03T23:53:00Z", "author": {"login": "denalex"}, "path": "concourse/pipelines/templates/dev_build_pipeline-tpl.yml", "diffHunk": "@@ -1074,6 +1075,12 @@ jobs:\n       GP_VER: [[gp_ver]]\n       KERBEROS: ((kerberos-enabled))\n       PXF_JVM_OPTS: ((pxf-jvm-opts))\n+  - task: Test PXF CLI\n+    image: gpdb[[gp_ver]]-pxf-dev-centos7-image\n+    file: pxf_src/concourse/tasks/test_pxf_cli.yml\n+    params:\n+      TARGET_OS: centos\n+      TARGET_OS_VERSION: 7", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9374aeff957f66ccd36f9ac6888d47e530de0fd1"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7851b127d1efb4c40e2f254c62a13a2927150e5", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/b7851b127d1efb4c40e2f254c62a13a2927150e5", "committedDate": "2020-11-04T01:19:03Z", "message": "Use single quote for globbing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaded7d35549c057cc72bd787933b5764da4b564", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/aaded7d35549c057cc72bd787933b5764da4b564", "committedDate": "2020-11-04T03:53:46Z", "message": "Revert \"Use single quote for globbing\"\n\nThis reverts commit b7851b127d1efb4c40e2f254c62a13a2927150e5."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53064fe16c22cf4b419cff653710a78481d2c28d", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/53064fe16c22cf4b419cff653710a78481d2c28d", "committedDate": "2020-11-04T03:54:06Z", "message": "Revert \"remove quotes for PXF_HOME\"\n\nThis reverts commit 9374aeff957f66ccd36f9ac6888d47e530de0fd1."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb2eabfea637b73a70ea6ed6a04e9f75edb96d88", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/cb2eabfea637b73a70ea6ed6a04e9f75edb96d88", "committedDate": "2020-11-04T03:54:26Z", "message": "Revert \"Address PR feedback\"\n\nThis reverts commit 8316a631f6ee4507ca703b143053a2cf87dbd8eb."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f388fae1fedd1ea0ac7afc67a9f289c3d0a13dbd", "author": {"user": null}, "url": "https://github.com/greenplum-db/pxf/commit/f388fae1fedd1ea0ac7afc67a9f289c3d0a13dbd", "committedDate": "2020-11-04T04:51:56Z", "message": "Move CLI test after automation test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzkzMTc0", "url": "https://github.com/greenplum-db/pxf/pull/479#pullrequestreview-523793174", "createdAt": "2020-11-04T22:49:20Z", "commit": {"oid": "f388fae1fedd1ea0ac7afc67a9f289c3d0a13dbd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4930, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}