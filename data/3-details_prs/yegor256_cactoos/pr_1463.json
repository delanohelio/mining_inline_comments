{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3Mjc0ODE5", "number": 1463, "title": "#1384: Remove lazy initizaliaztion from MapEnvelope", "bodyText": "Per #1384\n\nMake MapEnvelope a proper envelope\nAdd ctor for MapOf\nRemove tests for lazy initialization", "createdAt": "2020-09-15T12:52:28Z", "url": "https://github.com/yegor256/cactoos/pull/1463", "merged": true, "mergeCommit": {"oid": "227c23c2dfa7799f95250840ea4e6124c5fe76c0"}, "closed": true, "closedAt": "2020-09-20T17:01:07Z", "author": {"login": "andreoss"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJHJKlAH2gAyNDg3Mjc0ODE5OmM2Nzg0MTBlZmM3OWUwZDU0NWU5ZWI1NzBjYjY5ZjU5MTAzZDU5ODk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKxtO9AFqTQ5MjIwNzI1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c678410efc79e0d545e9eb570cb69f59103d5989", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/c678410efc79e0d545e9eb570cb69f59103d5989", "committedDate": "2020-09-15T12:41:54Z", "message": "(#1384) Add ctor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94795d84435684cd8d993c200bf115d263c9279b", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/94795d84435684cd8d993c200bf115d263c9279b", "committedDate": "2020-09-15T12:46:59Z", "message": "(#1384) Reuse MapOf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1deca5de24bcfe2270a967fad5621eebfd00b61c", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/1deca5de24bcfe2270a967fad5621eebfd00b61c", "committedDate": "2020-09-15T12:47:23Z", "message": "(#1384) Reuse MapOf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a168ca6e0e6104c088597ac03e497f14907e8c79", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/a168ca6e0e6104c088597ac03e497f14907e8c79", "committedDate": "2020-09-15T12:47:42Z", "message": "(#1384) Reuse MapOf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68de084cc8a16db69a48da9e4c002d863abe3ae1", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/68de084cc8a16db69a48da9e4c002d863abe3ae1", "committedDate": "2020-09-15T12:48:07Z", "message": "(#1384) Reuse MapOf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75b2fe01bdebef14da237b0b59ea37e4a6821609", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/75b2fe01bdebef14da237b0b59ea37e4a6821609", "committedDate": "2020-09-15T12:48:30Z", "message": "(#1384) Reuse MapOf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd75e081a42c0cae153311a96c15a4012cdc45a3", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/fd75e081a42c0cae153311a96c15a4012cdc45a3", "committedDate": "2020-09-15T12:49:05Z", "message": "(#1384) Simplify MapEnvelope"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4c2ac213075e58f26a4d22c22b81be3732c1c53", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/b4c2ac213075e58f26a4d22c22b81be3732c1c53", "committedDate": "2020-09-15T13:07:13Z", "message": "(#1384) Remove test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "44745408afb1c37bcc555657f0048a6354eb4924", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/44745408afb1c37bcc555657f0048a6354eb4924", "committedDate": "2020-09-15T12:52:56Z", "message": "(#1384) Remove test"}, "afterCommit": {"oid": "b4c2ac213075e58f26a4d22c22b81be3732c1c53", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/b4c2ac213075e58f26a4d22c22b81be3732c1c53", "committedDate": "2020-09-15T13:07:13Z", "message": "(#1384) Remove test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/5c092308b35aa44c74ba3dc089022fc1eb546259", "committedDate": "2020-09-15T14:39:15Z", "message": "(#1384) Qulice complience"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4OTA2NzQz", "url": "https://github.com/yegor256/cactoos/pull/1463#pullrequestreview-488906743", "createdAt": "2020-09-15T17:27:05Z", "commit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzoyNzowNVrOHSMXYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzoyOToyOFrOHSMchg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzOTAwOQ==", "bodyText": "@andreoss this class should be removed too as discussed in the ticket", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488839009", "createdAt": "2020-09-15T17:27:05Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/Solid.java", "diffHunk": "@@ -148,8 +148,10 @@ public Solid(final Map<X, Y> map,\n      */\n     public Solid(final Map<X, Y> map) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzOTA2Mw==", "bodyText": "@andreoss this class should be removed too as discussed in the ticket", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488839063", "createdAt": "2020-09-15T17:27:10Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/Sticky.java", "diffHunk": "@@ -158,12 +158,14 @@ public Sticky(final Map<X, Y> map,\n      */\n     public Sticky(final Map<X, Y> map) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzOTQwOQ==", "bodyText": "@andreoss there is no need for wrapping that into Synced anymore since it is evaluated in the constructor", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488839409", "createdAt": "2020-09-15T17:27:50Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/Synced.java", "diffHunk": "@@ -150,12 +150,14 @@ public Synced(final Map<X, Y> map,\n      */\n     public Synced(final Map<X, Y> map) {\n         super(\n-            new org.cactoos.scalar.Synced<>(\n-                () -> {\n-                    final Map<X, Y> temp = new ConcurrentHashMap<>(0);\n-                    temp.putAll(map);\n-                    return temp;\n-                }\n+            new MapOf<>(\n+                new org.cactoos.scalar.Synced<>(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzOTYyOA==", "bodyText": "@andreoss what is the problem with this test?", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488839628", "createdAt": "2020-09-15T17:28:15Z", "author": {"login": "victornoel"}, "path": "src/test/java/org/cactoos/map/MapOfTest.java", "diffHunk": "@@ -78,24 +74,6 @@ void convertsIterableToMap() {\n         );\n     }\n \n-    @Test\n-    void sensesChangesInMap() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzOTczMA==", "bodyText": "@andreoss here too", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488839730", "createdAt": "2020-09-15T17:28:24Z", "author": {"login": "victornoel"}, "path": "src/test/java/org/cactoos/scalar/PropertiesOfTest.java", "diffHunk": "@@ -107,24 +102,4 @@ void convertsMapToProperties() {\n         ).affirm();\n     }\n \n-    @Test\n-    void sensesChangesInMap() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg0MDMyNg==", "bodyText": "@andreoss instead of using a Scalar based constructor, I think it would make more sense to follow the same pattern as in ListOf and SetOf.", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488840326", "createdAt": "2020-09-15T17:29:28Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/MapOf.java", "diffHunk": "@@ -148,12 +150,20 @@ public MapOf(final Map<X, Y> src,\n      * @param entries List of the entries\n      */\n     public MapOf(final Iterable<Map.Entry<X, Y>> entries) {\n-        super(() -> {\n+        this(() -> {\n             final Map<X, Y> temp = new HashMap<>(0);\n             for (final Map.Entry<X, Y> entry : entries) {\n                 temp.put(entry.getKey(), entry.getValue());\n             }\n             return Collections.unmodifiableMap(temp);\n         });\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "263ac9863dc8c7c496a89fa894182f8e0beca4ba", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/263ac9863dc8c7c496a89fa894182f8e0beca4ba", "committedDate": "2020-09-15T17:51:33Z", "message": "(#1384) Remove map.Sticky"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19ad463103acf0d7bdac58511bd058d5366e7cde", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/19ad463103acf0d7bdac58511bd058d5366e7cde", "committedDate": "2020-09-15T17:51:49Z", "message": "(#1384) Remove map.Solid"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41ce82eed734d200ef0b892f83cfde0b8c716b0e", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/41ce82eed734d200ef0b892f83cfde0b8c716b0e", "committedDate": "2020-09-15T17:54:45Z", "message": "(#1384) Do not sync, since map created at construction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c4db78bdcca148c70f386def639eb738e815641", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/0c4db78bdcca148c70f386def639eb738e815641", "committedDate": "2020-09-15T17:55:21Z", "message": "(#1384) Fill new map at construction"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4OTM3Mjkw", "url": "https://github.com/yegor256/cactoos/pull/1463#pullrequestreview-488937290", "createdAt": "2020-09-15T18:06:13Z", "commit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODowNjoxNFrOHSN8Fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODowNjoxNFrOHSN8Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2NDc5MQ==", "bodyText": "@andreoss here please replace all of this by just wrapping the map into Collections.synchronizedMap as with list.Synced", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r488864791", "createdAt": "2020-09-15T18:06:14Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/Synced.java", "diffHunk": "@@ -150,12 +150,14 @@ public Synced(final Map<X, Y> map,\n      */\n     public Synced(final Map<X, Y> map) {\n         super(\n-            new org.cactoos.scalar.Synced<>(\n-                () -> {\n-                    final Map<X, Y> temp = new ConcurrentHashMap<>(0);\n-                    temp.putAll(map);\n-                    return temp;\n-                }\n+            new MapOf<>(\n+                new org.cactoos.scalar.Synced<>(\n+                    () -> {\n+                        final Map<X, Y> temp = new ConcurrentHashMap<>(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c092308b35aa44c74ba3dc089022fc1eb546259"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c6bdf1f6b463495c2a8273c3a6e439243cf8079", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/4c6bdf1f6b463495c2a8273c3a6e439243cf8079", "committedDate": "2020-09-15T18:18:21Z", "message": "(#1384) Remove Sticky from test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c13447d49510b08ecfd5d6dd2ffe22db1c621aa9", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/c13447d49510b08ecfd5d6dd2ffe22db1c621aa9", "committedDate": "2020-09-15T18:30:29Z", "message": "(#1384) Delegate whole set of methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f55c283cb7772a95999ab04839dc3ef9c6608ac", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/4f55c283cb7772a95999ab04839dc3ef9c6608ac", "committedDate": "2020-09-15T18:51:52Z", "message": "(#1384) Clean up test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a76443430de4bffa378f19de643074b83a1560e1", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/a76443430de4bffa378f19de643074b83a1560e1", "committedDate": "2020-09-15T18:52:06Z", "message": "(#1384) Use Collections.synchronizedMap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e9081312bd3778a0dad9042b696b8cc58c9e67b", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/6e9081312bd3778a0dad9042b696b8cc58c9e67b", "committedDate": "2020-09-15T18:56:49Z", "message": "(#1384) Remove dead link"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1a587c59e4b8a9703740b5fbd1f44c86b9ee3f1", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/a1a587c59e4b8a9703740b5fbd1f44c86b9ee3f1", "committedDate": "2020-09-15T18:57:59Z", "message": "(#1384) Remove dead link & update doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NzQzNDM5", "url": "https://github.com/yegor256/cactoos/pull/1463#pullrequestreview-489743439", "createdAt": "2020-09-16T15:25:55Z", "commit": {"oid": "a1a587c59e4b8a9703740b5fbd1f44c86b9ee3f1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyNTo1NVrOHS2UPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNToyNzowMlrOHS2XvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNjMzNA==", "bodyText": "@andreoss normally you don't need to go through MapOf, the stream.collect returns a Map that can be passed directly to super. Right?", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r489526334", "createdAt": "2020-09-16T15:25:55Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/Grouped.java", "diffHunk": "@@ -57,16 +57,19 @@ public Grouped(\n         final Function<T, K> keys,\n         final Function<T, V> values\n     ) {\n-        super(() -> {\n-            final Stream<T> stream = StreamSupport.stream(\n-                list.spliterator(), false\n-            );\n-            return stream.collect(\n-                Collectors.groupingBy(\n-                    keys,\n-                    Collectors.mapping(values, Collectors.toList())\n-                )\n-            );\n-        });\n+        super(\n+            new MapOf<>(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a587c59e4b8a9703740b5fbd1f44c86b9ee3f1"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyNzIyOA==", "bodyText": "@andreoss what is the Scalar for? If we want to create a map from an existing one, then let's just take a map in the constructor. You can then use putAll to add all the elements of the original map.", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r489527228", "createdAt": "2020-09-16T15:27:02Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/MapOf.java", "diffHunk": "@@ -143,17 +140,22 @@ public MapOf(final Map<X, Y> src,\n         );\n     }\n \n+    /**\n+     * Ctor.\n+     * @param scalar The scalar for Map.\n+     */\n+    public MapOf(final Scalar<Map<X, Y>> scalar) {\n+        this(new Unchecked<>(scalar).value().entrySet());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a587c59e4b8a9703740b5fbd1f44c86b9ee3f1"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7925bc6127bdb3e679d25ca1cb4e779827dbdcde", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/7925bc6127bdb3e679d25ca1cb4e779827dbdcde", "committedDate": "2020-09-19T10:20:43Z", "message": "(#1384) Remove extra wrapping"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81580b2b923fb0098511f2856be069a78b4c6bb8", "author": {"user": {"login": "andreoss", "name": null}}, "url": "https://github.com/yegor256/cactoos/commit/81580b2b923fb0098511f2856be069a78b4c6bb8", "committedDate": "2020-09-19T10:22:14Z", "message": "(#1384) Remove unused ctor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMjA3MjU3", "url": "https://github.com/yegor256/cactoos/pull/1463#pullrequestreview-492207257", "createdAt": "2020-09-20T16:51:14Z", "commit": {"oid": "81580b2b923fb0098511f2856be069a78b4c6bb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQxNjo1MToxNFrOHU7mJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQxNjo1MToxNFrOHU7mJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwOTk4OA==", "bodyText": "@andreoss can't we manage to avoid creating an intermediate list just to iterate over it in MapOf? I'm not very clear about what streams provide us for that though...", "url": "https://github.com/yegor256/cactoos/pull/1463#discussion_r491709988", "createdAt": "2020-09-20T16:51:14Z", "author": {"login": "victornoel"}, "path": "src/main/java/org/cactoos/map/Merged.java", "diffHunk": "@@ -42,11 +42,12 @@\n      */\n     @SafeVarargs\n     public Merged(final Map<K, V>... maps) {\n-        super(() -> new MapOf<>(\n-            new ListOf<>(maps)\n-                .stream()\n-                .flatMap(map -> map.entrySet().stream())\n-                .collect(Collectors.toList())\n+        super(\n+            new MapOf<>(\n+                new ListOf<>(maps)\n+                    .stream()\n+                    .flatMap(map -> map.entrySet().stream())\n+                    .collect(Collectors.toList())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81580b2b923fb0098511f2856be069a78b4c6bb8"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 512, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}