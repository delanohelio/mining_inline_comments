{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyNDk3NTkz", "number": 3478, "title": "CAMEL-14397: DefaultComponent should prefer getting the configurers f\u2026", "bodyText": "\u2026rom the registry before checking the FactoryFinder", "createdAt": "2020-01-14T08:00:51Z", "url": "https://github.com/apache/camel/pull/3478", "merged": true, "mergeCommit": {"oid": "3986d800e371e51f46185238e929e464ec9d9908"}, "closed": true, "closedAt": "2020-01-15T11:23:15Z", "author": {"login": "ppalaga"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6Me2xAFqTM0MjM0OTQ1Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6jxTcAFqTM0MzE1MTU2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMzQ5NDUz", "url": "https://github.com/apache/camel/pull/3478#pullrequestreview-342349453", "createdAt": "2020-01-14T08:14:49Z", "commit": {"oid": "5f05f1a0c485177bd0602ac48a6a7c2c674a3643"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwODoxNDo0OVrOFdPARw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwODoxNTowMVrOFdPAlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE5ODg1NQ==", "bodyText": "The name should have -configurer, eg -component-configurer", "url": "https://github.com/apache/camel/pull/3478#discussion_r366198855", "createdAt": "2020-01-14T08:14:49Z", "author": {"login": "davsclaus"}, "path": "core/camel-support/src/main/java/org/apache/camel/support/DefaultComponent.java", "diffHunk": "@@ -406,17 +407,25 @@ protected void doInit() throws Exception {\n                 name = StringHelper.before(name, \",\");\n             }\n             try {\n+                final Registry registry = getCamelContext().getRegistry();\n                 log.trace(\"Discovering optional component property configurer class for component: {}\", name);\n-                Optional<Class<?>> clazz = getCamelContext().adapt(ExtendedCamelContext.class).getFactoryFinder(RESOURCE_PATH)\n-                        .findOptionalClass(name + \"-component\", null);\n-                clazz.ifPresent(c -> componentPropertyConfigurer = org.apache.camel.support.ObjectHelper.newInstance(c, GeneratedPropertyConfigurer.class));\n+                componentPropertyConfigurer = registry.lookupByNameAndType(name + \"-component\", GeneratedPropertyConfigurer.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f05f1a0c485177bd0602ac48a6a7c2c674a3643"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE5ODkzNA==", "bodyText": "The name should have -configurer, eg -endpoint-configurer", "url": "https://github.com/apache/camel/pull/3478#discussion_r366198934", "createdAt": "2020-01-14T08:15:01Z", "author": {"login": "davsclaus"}, "path": "core/camel-support/src/main/java/org/apache/camel/support/DefaultComponent.java", "diffHunk": "@@ -406,17 +407,25 @@ protected void doInit() throws Exception {\n                 name = StringHelper.before(name, \",\");\n             }\n             try {\n+                final Registry registry = getCamelContext().getRegistry();\n                 log.trace(\"Discovering optional component property configurer class for component: {}\", name);\n-                Optional<Class<?>> clazz = getCamelContext().adapt(ExtendedCamelContext.class).getFactoryFinder(RESOURCE_PATH)\n-                        .findOptionalClass(name + \"-component\", null);\n-                clazz.ifPresent(c -> componentPropertyConfigurer = org.apache.camel.support.ObjectHelper.newInstance(c, GeneratedPropertyConfigurer.class));\n+                componentPropertyConfigurer = registry.lookupByNameAndType(name + \"-component\", GeneratedPropertyConfigurer.class);\n+                if (componentPropertyConfigurer == null) {\n+                    final Optional<Class<?>> clazz = getCamelContext().adapt(ExtendedCamelContext.class).getFactoryFinder(RESOURCE_PATH)\n+                            .findOptionalClass(name + \"-component\", null);\n+                    clazz.ifPresent(c -> componentPropertyConfigurer = org.apache.camel.support.ObjectHelper.newInstance(c, GeneratedPropertyConfigurer.class));\n+                }\n                 if (log.isDebugEnabled() && componentPropertyConfigurer != null) {\n                     log.debug(\"Discovered component property configurer: {} -> {}\", name, componentPropertyConfigurer);\n                 }\n+\n                 log.trace(\"Discovering optional endpoint property configurer class for component: {}\", name);\n-                clazz = getCamelContext().adapt(ExtendedCamelContext.class).getFactoryFinder(RESOURCE_PATH)\n-                        .findOptionalClass(name + \"-endpoint\", null);\n-                clazz.ifPresent(c -> endpointPropertyConfigurer = org.apache.camel.support.ObjectHelper.newInstance(c, GeneratedPropertyConfigurer.class));\n+                endpointPropertyConfigurer = registry.lookupByNameAndType(name + \"-endpoint\", GeneratedPropertyConfigurer.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f05f1a0c485177bd0602ac48a6a7c2c674a3643"}, "originalPosition": 61}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f05f1a0c485177bd0602ac48a6a7c2c674a3643", "author": {"user": {"login": "ppalaga", "name": "Peter Palaga"}}, "url": "https://github.com/apache/camel/commit/5f05f1a0c485177bd0602ac48a6a7c2c674a3643", "committedDate": "2020-01-14T07:44:55Z", "message": "CAMEL-14397: DefaultComponent should prefer getting the configurers from the registry before checking the FactoryFinder"}, "afterCommit": {"oid": "14c51885d9352498c8b5edaf1a104beed0d5ef4c", "author": {"user": {"login": "ppalaga", "name": "Peter Palaga"}}, "url": "https://github.com/apache/camel/commit/14c51885d9352498c8b5edaf1a104beed0d5ef4c", "committedDate": "2020-01-14T09:37:28Z", "message": "CAMEL-14397: Rename the configurer property files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyNDAyNDMy", "url": "https://github.com/apache/camel/pull/3478#pullrequestreview-342402432", "createdAt": "2020-01-14T09:47:17Z", "commit": {"oid": "14c51885d9352498c8b5edaf1a104beed0d5ef4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "804f0bab824b08c188feab65f23d2a7d0eea30d2", "author": {"user": {"login": "ppalaga", "name": "Peter Palaga"}}, "url": "https://github.com/apache/camel/commit/804f0bab824b08c188feab65f23d2a7d0eea30d2", "committedDate": "2020-01-14T13:16:30Z", "message": "CAMEL-14397: DefaultComponent should prefer getting the configurers from\nthe registry before checking the FactoryFinder"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14c51885d9352498c8b5edaf1a104beed0d5ef4c", "author": {"user": {"login": "ppalaga", "name": "Peter Palaga"}}, "url": "https://github.com/apache/camel/commit/14c51885d9352498c8b5edaf1a104beed0d5ef4c", "committedDate": "2020-01-14T09:37:28Z", "message": "CAMEL-14397: Rename the configurer property files"}, "afterCommit": {"oid": "804f0bab824b08c188feab65f23d2a7d0eea30d2", "author": {"user": {"login": "ppalaga", "name": "Peter Palaga"}}, "url": "https://github.com/apache/camel/commit/804f0bab824b08c188feab65f23d2a7d0eea30d2", "committedDate": "2020-01-14T13:16:30Z", "message": "CAMEL-14397: DefaultComponent should prefer getting the configurers from\nthe registry before checking the FactoryFinder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzMTUxNTY5", "url": "https://github.com/apache/camel/pull/3478#pullrequestreview-343151569", "createdAt": "2020-01-15T11:23:04Z", "commit": {"oid": "804f0bab824b08c188feab65f23d2a7d0eea30d2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2736, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}