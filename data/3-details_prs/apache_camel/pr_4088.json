{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MjYyMjc0", "number": 4088, "title": "CAMEL-14826: Add unit tests to the platform-http component", "bodyText": "A test of platform-http using jetty server. For the test, I needed to create a custom Consumer.", "createdAt": "2020-08-13T09:23:21Z", "url": "https://github.com/apache/camel/pull/4088", "merged": true, "mergeCommit": {"oid": "c4d9bc34cc2067ec9495e16eae51039d3fb303bc"}, "closed": true, "closedAt": "2020-08-13T16:14:11Z", "author": {"login": "zbendhiba"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-ctiWAFqTQ2NjYwMTIwNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-iBcQAFqTQ2Njg5MDkzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjAxMjA2", "url": "https://github.com/apache/camel/pull/4088#pullrequestreview-466601206", "createdAt": "2020-08-13T09:36:28Z", "commit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjE3ODc5", "url": "https://github.com/apache/camel/pull/4088#pullrequestreview-466617879", "createdAt": "2020-08-13T09:59:56Z", "commit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjQ0MDYy", "url": "https://github.com/apache/camel/pull/4088#pullrequestreview-466644062", "createdAt": "2020-08-13T10:39:22Z", "commit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjcwMDI1", "url": "https://github.com/apache/camel/pull/4088#pullrequestreview-466670025", "createdAt": "2020-08-13T11:21:08Z", "commit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMToyMTowOFrOHAHMMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMToyMzo1OVrOHAHRbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg3OTg1OQ==", "bodyText": "I would change the name of the method, e.g. tearDown()", "url": "https://github.com/apache/camel/pull/4088#discussion_r469879859", "createdAt": "2020-08-13T11:21:08Z", "author": {"login": "aldettinger"}, "path": "components/camel-platform-http/src/test/java/org/apache/camel/component/platform/http/PlatformHttpTest.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.platform.http;\n+\n+import io.restassured.RestAssured;\n+import io.restassured.response.Response;\n+import io.restassured.specification.RequestSpecification;\n+import org.apache.camel.CamelContext;\n+import org.apache.camel.builder.RouteBuilder;\n+import org.apache.camel.impl.DefaultCamelContext;\n+import org.apache.camel.test.AvailablePortFinder;\n+import org.apache.camel.test.junit5.CamelTestSupport;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.Test;\n+\n+import static io.restassured.RestAssured.given;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+\n+public class PlatformHttpTest extends CamelTestSupport {\n+    private static JettyServerTest server;\n+    private static CamelContext ctx;\n+    private static int port;\n+\n+    @BeforeAll\n+    public static void init() throws Exception {\n+\n+        ctx = new DefaultCamelContext();\n+        ctx.getRegistry().bind(PlatformHttpConstants.PLATFORM_HTTP_ENGINE_FACTORY, new JettyCustomPlatformHttpEngine());\n+\n+        port = AvailablePortFinder.getNextAvailable();\n+        server = new JettyServerTest(port);\n+\n+        ctx.getRegistry().bind(JettyServerTest.JETTY_SERVER_NAME, server);\n+        server.start();\n+\n+        ctx.addRoutes(new RouteBuilder() {\n+            @Override\n+            public void configure() throws Exception {\n+                from(\"platform-http:/get\")\n+                        .setBody().constant(\"get\");\n+                from(\"platform-http:/post\")\n+                        .transform().body(String.class, b -> b.toUpperCase());\n+            }\n+        });\n+        ctx.start();\n+    }\n+\n+    @AfterAll\n+    public static void initPort() throws Exception {\n+        ctx.stop();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4MTE5Ng==", "bodyText": "We may remove this line if not needed ?", "url": "https://github.com/apache/camel/pull/4088#discussion_r469881196", "createdAt": "2020-08-13T11:23:59Z", "author": {"login": "aldettinger"}, "path": "components/camel-platform-http/src/test/resources/log4j2.properties", "diffHunk": "@@ -0,0 +1,29 @@\n+## ---------------------------------------------------------------------------\n+## Licensed to the Apache Software Foundation (ASF) under one or more\n+## contributor license agreements.  See the NOTICE file distributed with\n+## this work for additional information regarding copyright ownership.\n+## The ASF licenses this file to You under the Apache License, Version 2.0\n+## (the \"License\"); you may not use this file except in compliance with\n+## the License.  You may obtain a copy of the License at\n+##\n+##      http://www.apache.org/licenses/LICENSE-2.0\n+##\n+## Unless required by applicable law or agreed to in writing, software\n+## distributed under the License is distributed on an \"AS IS\" BASIS,\n+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+## See the License for the specific language governing permissions and\n+## limitations under the License.\n+## ---------------------------------------------------------------------------\n+appender.file.type = File\n+appender.file.name = file\n+appender.file.fileName = target/camel-platform-http-test.log\n+appender.file.layout.type = PatternLayout\n+appender.file.layout.pattern = %d [%-15.15t] %-5p %-30.30c{1} - %m%n\n+appender.out.type = Console\n+appender.out.name = out\n+appender.out.layout.type = PatternLayout\n+appender.out.layout.pattern = [%30.30t] %-30.30c{1} %-5p %m%n\n+\n+rootLogger.level = INFO\n+rootLogger.appenderRef.file.ref = file\n+#rootLogger.appenderRef.out.ref = out", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f70aa6477e1a350af097b59a772315e584abd03e", "author": {"user": {"login": "zbendhiba", "name": "Zineb BENDHIBA"}}, "url": "https://github.com/apache/camel/commit/f70aa6477e1a350af097b59a772315e584abd03e", "committedDate": "2020-08-13T15:36:18Z", "message": "CAMEL-14826: Add unit tests to the platform-http component"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48", "author": {"user": {"login": "zbendhiba", "name": "Zineb BENDHIBA"}}, "url": "https://github.com/apache/camel/commit/ed7a005dcdbb08ca7136205ea3ef5876f57dae48", "committedDate": "2020-08-13T09:18:11Z", "message": "CAMEL-14826: Add unit tests to the platform-http component"}, "afterCommit": {"oid": "f70aa6477e1a350af097b59a772315e584abd03e", "author": {"user": {"login": "zbendhiba", "name": "Zineb BENDHIBA"}}, "url": "https://github.com/apache/camel/commit/f70aa6477e1a350af097b59a772315e584abd03e", "committedDate": "2020-08-13T15:36:18Z", "message": "CAMEL-14826: Add unit tests to the platform-http component"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2ODkwOTMw", "url": "https://github.com/apache/camel/pull/4088#pullrequestreview-466890930", "createdAt": "2020-08-13T15:47:44Z", "commit": {"oid": "f70aa6477e1a350af097b59a772315e584abd03e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2922, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}