{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzNjU4Nzcx", "number": 4630, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNTo0NTowOFrOE64ocw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTozOTowM1rOE7HSFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMTgwNzIzOnYy", "diffSide": "RIGHT", "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/api/dto/SearchResult2.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNTo0NTowOFrOH2Nm2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNTo0NTowOFrOH2Nm2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYwODA4OQ==", "bodyText": "Please add license", "url": "https://github.com/apache/camel/pull/4630#discussion_r526608089", "createdAt": "2020-11-19T05:45:08Z", "author": {"login": "oscerd"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/api/dto/SearchResult2.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package org.apache.camel.component.salesforce.api.dto;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "470c5a0cef14095ade83c4a8c3bdecd26e676e95"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNDIwNzU5OnYy", "diffSide": "RIGHT", "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTozOTowM1rOH2kn6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNjo1Mjo0NVrOH2oFnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA==", "bodyText": "can we somewhat move the version 37.0 number into a constant?", "url": "https://github.com/apache/camel/pull/4630#discussion_r526985194", "createdAt": "2020-11-19T15:39:03Z", "author": {"login": "omarsmak"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5NDI4Mg==", "bodyText": "I considered that, but couldn't think of a good name. There's no concept that symbolizes any given version. Open to suggestions.", "url": "https://github.com/apache/camel/pull/4630#discussion_r526994282", "createdAt": "2020-11-19T15:50:27Z", "author": {"login": "jeremyross"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAwOTQ1OA==", "bodyText": "True, another option is, we can create a common function in the AbstractRestProcessor that sets response type property for Json and XML, e.g:\nprotected void setSearchResponseType(Object fallbackType) {\nif (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {\n       exchange.setProperty(RESPONSE_TYPE, SearchResult2.class);\n} else {\n       exchange.setProperty(RESPONSE_TYPE, fallbackType);\n     }\n}\n\nAnd then called either setSearchResponseType(TypeReferences.SEARCH_RESULT_TYPE) or setSearchResponseType(SearchResults.class). WDYT?", "url": "https://github.com/apache/camel/pull/4630#discussion_r527009458", "createdAt": "2020-11-19T16:09:36Z", "author": {"login": "omarsmak"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAyODE2MQ==", "bodyText": "Hmm. JsonRestProcessor sets the RESPONSE_TYPE property, whereas XmlRestProcessor sets the RESPONSE_CLASS property. And for  < 37.0, the type is different. I'm struggling to find enough in common to extract.", "url": "https://github.com/apache/camel/pull/4630#discussion_r527028161", "createdAt": "2020-11-19T16:34:38Z", "author": {"login": "jeremyross"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAzNjI5Mw==", "bodyText": "But I'm glad you asked this, because I now realize that JsonRestProcessor should be using RESPONSE_CLASS for SearchResult2.", "url": "https://github.com/apache/camel/pull/4630#discussion_r527036293", "createdAt": "2020-11-19T16:45:17Z", "author": {"login": "jeremyross"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAzNzI0Mg==", "bodyText": "ah sorry didn't realize that, you are right, only the version need to be extracted. Anyway, if you can't find a some meaningful naming, is also fine like this as long not much of duplications happening, just wanted to avoid the magic number ;)", "url": "https://github.com/apache/camel/pull/4630#discussion_r527037242", "createdAt": "2020-11-19T16:46:26Z", "author": {"login": "omarsmak"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA0MDI2NQ==", "bodyText": "I know, it bothers me too. But I think public static final String API_VERSION_37_0 = \"37.0\"; would bother me more. It brings nothing to the party, ya know?", "url": "https://github.com/apache/camel/pull/4630#discussion_r527040265", "createdAt": "2020-11-19T16:50:23Z", "author": {"login": "jeremyross"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA0MTk0OQ==", "bodyText": "yeah I know, is fine then", "url": "https://github.com/apache/camel/pull/4630#discussion_r527041949", "createdAt": "2020-11-19T16:52:45Z", "author": {"login": "omarsmak"}, "path": "components/camel-salesforce/camel-salesforce-component/src/main/java/org/apache/camel/component/salesforce/internal/processor/JsonRestProcessor.java", "diffHunk": "@@ -100,7 +101,11 @@ protected void processRequest(Exchange exchange) throws SalesforceException {\n \n             case SEARCH:\n                 // handle known response type\n-                exchange.setProperty(RESPONSE_TYPE, TypeReferences.SEARCH_RESULT_TYPE);\n+                if (Double.parseDouble(endpoint.getConfiguration().getApiVersion()) >= 37.0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk4NTE5NA=="}, "originalCommit": {"oid": "44f3b7036467183af8163d411672819d4bb5e1f5"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4746, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}