{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NDYxOTM4", "number": 4573, "title": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExisting\u2026", "bodyText": "\u2026Strategy when tempFile is also configured\n\n Make sure there is a JIRA issue filed for the change (usually before you start working on it).  Trivial changes like typos do not require a JIRA issue.  Your pull request should address just this issue, without pulling in other changes.\n Each commit in the pull request should have a meaningful subject line and body.\n If you're unsure, you can format the pull request title like [CAMEL-XXX] Fixes bug in camel-file component, where you replace CAMEL-XXX with the appropriate JIRA issue.\n Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n Run mvn clean install -Psourcecheck in your module with source check enabled to make sure basic checks pass and there are no checkstyle violations. A more thorough check will be performed on your pull request automatically.\nBelow are the contribution guidelines:\nhttps://github.com/apache/camel/blob/master/CONTRIBUTING.md", "createdAt": "2020-11-06T03:01:16Z", "url": "https://github.com/apache/camel/pull/4573", "merged": true, "mergeCommit": {"oid": "235a0a5f3d15df253c939380e3927ca08eda5546"}, "closed": true, "closedAt": "2020-11-10T17:21:06Z", "author": {"login": "luigidemasi"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZuZCDgBqjM5NjUzNDUxMjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbMgKhgBqjM5ODAwMDk3OTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ab37ca8f2a2c3130c969bff3ecc56ba74a852a5", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/2ab37ca8f2a2c3130c969bff3ecc56ba74a852a5", "committedDate": "2020-11-06T02:56:32Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured"}, "afterCommit": {"oid": "e174c23dbdb57809c1fd00aa7fcc1fa226dc1209", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/e174c23dbdb57809c1fd00aa7fcc1fa226dc1209", "committedDate": "2020-11-06T03:27:32Z", "message": "fix cs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e174c23dbdb57809c1fd00aa7fcc1fa226dc1209", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/e174c23dbdb57809c1fd00aa7fcc1fa226dc1209", "committedDate": "2020-11-06T03:27:32Z", "message": "fix cs"}, "afterCommit": {"oid": "89c3a8adbec330e3aa7c1dcb3e7f9c87a78468d6", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/89c3a8adbec330e3aa7c1dcb3e7f9c87a78468d6", "committedDate": "2020-11-06T04:10:58Z", "message": "fix cs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89c3a8adbec330e3aa7c1dcb3e7f9c87a78468d6", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/89c3a8adbec330e3aa7c1dcb3e7f9c87a78468d6", "committedDate": "2020-11-06T04:10:58Z", "message": "fix cs"}, "afterCommit": {"oid": "f1a93eaf9432f328edceeb4e3940d8b09dcce90c", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/f1a93eaf9432f328edceeb4e3940d8b09dcce90c", "committedDate": "2020-11-06T05:35:04Z", "message": "fix cs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0OTYyODEx", "url": "https://github.com/apache/camel/pull/4573#pullrequestreview-524962811", "createdAt": "2020-11-06T08:57:40Z", "commit": {"oid": "f1a93eaf9432f328edceeb4e3940d8b09dcce90c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwODo1Nzo0MFrOHulV_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwODo1Nzo0MFrOHulV_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYwODM4MA==", "bodyText": "I see some of this logic to check the name being repeated across the three strategies, can we somehow unify this logic into a common function to ease maintainability?", "url": "https://github.com/apache/camel/pull/4573#discussion_r518608380", "createdAt": "2020-11-06T08:57:40Z", "author": {"login": "omarsmak"}, "path": "components/camel-file/src/main/java/org/apache/camel/component/file/GenericFileDefaultMoveExistingFileStrategy.java", "diffHunk": "@@ -49,14 +49,24 @@ public boolean moveExistingFile(GenericFileEndpoint endpoint, GenericFileOperati\n         dummy.getIn().setHeader(Exchange.FILE_PARENT, parent);\n \n         String to = endpoint.getMoveExisting().evaluate(dummy, String.class);\n-        // we must normalize it (to avoid having both \\ and / in the name which\n-        // confuses java.io.File)\n-        to = FileUtil.normalizePath(to);\n+\n         if (ObjectHelper.isEmpty(to)) {\n             throw new GenericFileOperationFailedException(\n                     \"moveExisting evaluated as empty String, cannot move existing file: \" + fileName);\n         }\n \n+        if (to.length() > 1 && to.endsWith(\"/\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1a93eaf9432f328edceeb4e3940d8b09dcce90c"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MzMxNzI4", "url": "https://github.com/apache/camel/pull/4573#pullrequestreview-527331728", "createdAt": "2020-11-10T15:39:09Z", "commit": {"oid": "f1a93eaf9432f328edceeb4e3940d8b09dcce90c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1a93eaf9432f328edceeb4e3940d8b09dcce90c", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/f1a93eaf9432f328edceeb4e3940d8b09dcce90c", "committedDate": "2020-11-06T05:35:04Z", "message": "fix cs"}, "afterCommit": {"oid": "18e26a212ec3b9e0d8e9b92c974288dfd5206c37", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/18e26a212ec3b9e0d8e9b92c974288dfd5206c37", "committedDate": "2020-11-10T15:07:30Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured\n\nfix cs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18e26a212ec3b9e0d8e9b92c974288dfd5206c37", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/18e26a212ec3b9e0d8e9b92c974288dfd5206c37", "committedDate": "2020-11-10T15:07:30Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured\n\nfix cs"}, "afterCommit": {"oid": "fb17fec3aba4cc6e0f2ced08f15579c64c7e3c2a", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/fb17fec3aba4cc6e0f2ced08f15579c64c7e3c2a", "committedDate": "2020-11-10T17:06:20Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured\n\nfix cs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85e8da6ff34fcbeaeefa0ea28b378dc29a6c4d3a", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/85e8da6ff34fcbeaeefa0ea28b378dc29a6c4d3a", "committedDate": "2020-11-10T17:06:55Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb17fec3aba4cc6e0f2ced08f15579c64c7e3c2a", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/fb17fec3aba4cc6e0f2ced08f15579c64c7e3c2a", "committedDate": "2020-11-10T17:06:20Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured\n\nfix cs"}, "afterCommit": {"oid": "85e8da6ff34fcbeaeefa0ea28b378dc29a6c4d3a", "author": {"user": {"login": "luigidemasi", "name": "Luigi De Masi"}}, "url": "https://github.com/apache/camel/commit/85e8da6ff34fcbeaeefa0ea28b378dc29a6c4d3a", "committedDate": "2020-11-10T17:06:55Z", "message": "CAMEL-15822: [camel-file] fileExist=Move doesn't use FileMoveExistingStrategy when tempFile is also configured"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2827, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}