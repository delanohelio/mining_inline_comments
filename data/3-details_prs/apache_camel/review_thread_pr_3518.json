{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3MjcxNTgw", "number": 3518, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1Mjo0M1rODazNOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1ODozN1rODazTqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NDI4NTM4OnYy", "diffSide": "RIGHT", "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/AddWorkLogProducer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1Mjo0M1rOFh7P_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODo0NDoxN1rOFiNWuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTExODA3OA==", "bodyText": "Can we use here primitiveinstead of the boxedInteger`?", "url": "https://github.com/apache/camel/pull/3518#discussion_r371118078", "createdAt": "2020-01-27T08:52:43Z", "author": {"login": "omarsmak"}, "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/AddWorkLogProducer.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.jira.producer;\n+\n+import static org.apache.camel.component.jira.JiraConstants.ISSUE_KEY;\n+import static org.apache.camel.component.jira.JiraConstants.MINUTES_SPENT;\n+\n+import com.atlassian.jira.rest.client.api.IssueRestClient;\n+import com.atlassian.jira.rest.client.api.JiraRestClient;\n+import com.atlassian.jira.rest.client.api.domain.Issue;\n+import com.atlassian.jira.rest.client.api.domain.input.WorklogInput;\n+import org.apache.camel.Exchange;\n+import org.apache.camel.component.jira.JiraEndpoint;\n+import org.apache.camel.support.DefaultProducer;\n+import org.joda.time.DateTime;\n+\n+public class AddWorkLogProducer extends DefaultProducer {\n+\n+    public AddWorkLogProducer(JiraEndpoint endpoint) {\n+        super(endpoint);\n+    }\n+\n+    @Override\n+    public void process(Exchange exchange) {\n+        String issueKey = exchange.getIn().getHeader(ISSUE_KEY, String.class);\n+        if (issueKey == null) {\n+            throw new IllegalArgumentException(\"Missing exchange input header named \" + ISSUE_KEY);\n+        }\n+        String comment = exchange.getIn().getBody(String.class);\n+        if (comment == null) {\n+            throw new IllegalArgumentException(\"Missing exchange body, it should specify the string comment.\");\n+        }\n+        Integer minutesSpent = exchange.getIn().getHeader(MINUTES_SPENT, Integer.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQxNDcxMw==", "bodyText": "Ok, I see where you're coming from, I initially did this to avoid the NullPointerException and have the more meaningful IllegalArgumentException with message instead.\nI'm updating this to default to a negative value, to keep the best of both worlds.\nprivate static final int DEFAULT_MINUTES_SPENT = -1;\n\n[...]\n\nint minutesSpent = exchange.getIn().getHeader(MINUTES_SPENT, DEFAULT_MINUTES_SPENT, int.class);\nif (DEFAULT_MINUTES_SPENT == minutesSpent) {\n     throw new IllegalArgumentException(\"Missing exchange input header named \" + MINUTES_SPENT);\n}", "url": "https://github.com/apache/camel/pull/3518#discussion_r371414713", "createdAt": "2020-01-27T18:44:17Z", "author": {"login": "clementmouchet"}, "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/AddWorkLogProducer.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.jira.producer;\n+\n+import static org.apache.camel.component.jira.JiraConstants.ISSUE_KEY;\n+import static org.apache.camel.component.jira.JiraConstants.MINUTES_SPENT;\n+\n+import com.atlassian.jira.rest.client.api.IssueRestClient;\n+import com.atlassian.jira.rest.client.api.JiraRestClient;\n+import com.atlassian.jira.rest.client.api.domain.Issue;\n+import com.atlassian.jira.rest.client.api.domain.input.WorklogInput;\n+import org.apache.camel.Exchange;\n+import org.apache.camel.component.jira.JiraEndpoint;\n+import org.apache.camel.support.DefaultProducer;\n+import org.joda.time.DateTime;\n+\n+public class AddWorkLogProducer extends DefaultProducer {\n+\n+    public AddWorkLogProducer(JiraEndpoint endpoint) {\n+        super(endpoint);\n+    }\n+\n+    @Override\n+    public void process(Exchange exchange) {\n+        String issueKey = exchange.getIn().getHeader(ISSUE_KEY, String.class);\n+        if (issueKey == null) {\n+            throw new IllegalArgumentException(\"Missing exchange input header named \" + ISSUE_KEY);\n+        }\n+        String comment = exchange.getIn().getBody(String.class);\n+        if (comment == null) {\n+            throw new IllegalArgumentException(\"Missing exchange body, it should specify the string comment.\");\n+        }\n+        Integer minutesSpent = exchange.getIn().getHeader(MINUTES_SPENT, Integer.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTExODA3OA=="}, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NDI4NzQ2OnYy", "diffSide": "RIGHT", "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/AddIssueLinkProducer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1MzozMVrOFh7ROA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODozNTo0MFrOFiNGqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTExODM5Mg==", "bodyText": "I think the static imports should be at the bottom of the imports. Did you run the build with sourcecheck enabled?", "url": "https://github.com/apache/camel/pull/3518#discussion_r371118392", "createdAt": "2020-01-27T08:53:31Z", "author": {"login": "omarsmak"}, "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/AddIssueLinkProducer.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.jira.producer;\n+\n+import static org.apache.camel.component.jira.JiraConstants.CHILD_ISSUE_KEY;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQxMDYwMw==", "bodyText": "My bad, I use IDEA and had my imports organised in a different order. I'll format this to be consistent with the rest of the project.", "url": "https://github.com/apache/camel/pull/3518#discussion_r371410603", "createdAt": "2020-01-27T18:35:40Z", "author": {"login": "clementmouchet"}, "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/AddIssueLinkProducer.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.jira.producer;\n+\n+import static org.apache.camel.component.jira.JiraConstants.CHILD_ISSUE_KEY;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTExODM5Mg=="}, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NDI5Njg3OnYy", "diffSide": "RIGHT", "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/FetchIssueProducer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1NzowMlrOFh7Wrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODozNDowNlrOFiNEAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTExOTc5MQ==", "bodyText": "If not mistaken, exchange().getOut() has been deprecated in favour of exchange().getMessage()", "url": "https://github.com/apache/camel/pull/3518#discussion_r371119791", "createdAt": "2020-01-27T08:57:02Z", "author": {"login": "omarsmak"}, "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/FetchIssueProducer.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.jira.producer;\n+\n+import static org.apache.camel.component.jira.JiraConstants.ISSUE_KEY;\n+\n+import com.atlassian.jira.rest.client.api.IssueRestClient;\n+import com.atlassian.jira.rest.client.api.JiraRestClient;\n+import com.atlassian.jira.rest.client.api.domain.Issue;\n+import org.apache.camel.Exchange;\n+import org.apache.camel.component.jira.JiraEndpoint;\n+import org.apache.camel.support.DefaultProducer;\n+\n+public class FetchIssueProducer extends DefaultProducer {\n+    public FetchIssueProducer(JiraEndpoint endpoint) {\n+        super(endpoint);\n+    }\n+\n+    @Override\n+    public void process(Exchange exchange) {\n+        String issueKey = exchange.getIn().getHeader(ISSUE_KEY, String.class);\n+        if (issueKey == null) {\n+            throw new IllegalArgumentException(\"Missing exchange input header named \" + ISSUE_KEY);\n+        }\n+        JiraRestClient client = ((JiraEndpoint) getEndpoint()).getClient();\n+        IssueRestClient issueClient = client.getIssueClient();\n+        Issue issue = issueClient.getIssue(issueKey).claim();\n+\n+        // support InOut\n+        if (exchange.getPattern().isOutCapable()) {\n+            // copy the header of in message to the out message\n+            exchange.getOut().copyFrom(exchange.getIn());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwOTkyMA==", "bodyText": "Of course, I'll drop the .isOutCapable() block and use exchange().getMessage() instead.", "url": "https://github.com/apache/camel/pull/3518#discussion_r371409920", "createdAt": "2020-01-27T18:34:06Z", "author": {"login": "clementmouchet"}, "path": "components/camel-jira/src/main/java/org/apache/camel/component/jira/producer/FetchIssueProducer.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.jira.producer;\n+\n+import static org.apache.camel.component.jira.JiraConstants.ISSUE_KEY;\n+\n+import com.atlassian.jira.rest.client.api.IssueRestClient;\n+import com.atlassian.jira.rest.client.api.JiraRestClient;\n+import com.atlassian.jira.rest.client.api.domain.Issue;\n+import org.apache.camel.Exchange;\n+import org.apache.camel.component.jira.JiraEndpoint;\n+import org.apache.camel.support.DefaultProducer;\n+\n+public class FetchIssueProducer extends DefaultProducer {\n+    public FetchIssueProducer(JiraEndpoint endpoint) {\n+        super(endpoint);\n+    }\n+\n+    @Override\n+    public void process(Exchange exchange) {\n+        String issueKey = exchange.getIn().getHeader(ISSUE_KEY, String.class);\n+        if (issueKey == null) {\n+            throw new IllegalArgumentException(\"Missing exchange input header named \" + ISSUE_KEY);\n+        }\n+        JiraRestClient client = ((JiraEndpoint) getEndpoint()).getClient();\n+        IssueRestClient issueClient = client.getIssueClient();\n+        Issue issue = issueClient.getIssue(issueKey).claim();\n+\n+        // support InOut\n+        if (exchange.getPattern().isOutCapable()) {\n+            // copy the header of in message to the out message\n+            exchange.getOut().copyFrom(exchange.getIn());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTExOTc5MQ=="}, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NDMwMTg2OnYy", "diffSide": "RIGHT", "path": "components/camel-jira/src/test/java/org/apache/camel/component/jira/Utils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1ODozN1rOFh7ZlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwODo1ODozN1rOFh7ZlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTEyMDUzMw==", "bodyText": "Since you are at it, can you please change this to long primitive type? :)", "url": "https://github.com/apache/camel/pull/3518#discussion_r371120533", "createdAt": "2020-01-27T08:58:37Z", "author": {"login": "omarsmak"}, "path": "components/camel-jira/src/test/java/org/apache/camel/component/jira/Utils.java", "diffHunk": "@@ -102,13 +105,43 @@ public static Issue createIssueWithComments(long id, Collection<Comment> comment\n                 null, null, null, null, null, null, null, null);\n     }\n \n+    public static Issue createIssueWithLinks(long id, Collection<IssueLink> issueLinks) {\n+        URI selfUri = URI.create(TEST_JIRA_URL + \"/rest/api/latest/issue/\" + id);\n+        return new Issue(\"jira summary test \" + id, selfUri, KEY + \"-\" + id, id, null, issueType, null, \"Description \" + id,\n+            null, null, null, null, userAssignee, null, null, null, null, null, null, null, null, null, null, issueLinks,\n+            null, null, null, null, null, null, null, null);\n+    }\n+\n+    public static Issue createIssueWithWorkLogs(long id, Collection<Worklog> worklogs) {\n+        URI selfUri = URI.create(TEST_JIRA_URL + \"/rest/api/latest/issue/\" + id);\n+        return new Issue(\"jira summary test \" + id, selfUri, KEY + \"-\" + id, id, null, issueType, null, \"Description \" + id,\n+            null, null, null, null, userAssignee, null, null, null, null, null, null, null, null, null, null, null,\n+            null, worklogs, null, null, null, null, null, null);\n+    }\n+\n     public static Comment newComment(long issueId, int newCommentId, String comment) {\n         DateTime now = DateTime.now();\n         Long id = Long.parseLong(issueId + \"0\" + newCommentId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fddeea6ec3794c251353fc5c91429aefb0edeb43"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4733, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}