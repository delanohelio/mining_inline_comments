{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3NzcwNzM5", "number": 3824, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzoyODo1MlrOD8Wu4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozMToxOFrOD8Wx1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NjEzNjAxOnYy", "diffSide": "RIGHT", "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzoyODo1MlrOGVPZoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzoyODo1MlrOGVPZoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyNTYwMA==", "bodyText": "This might be not necessary here. And it should be in https://github.com/apache/camel/blob/master/core/camel-base/src/main/java/org/apache/camel/impl/engine/AbstractCamelContext.java#L1457", "url": "https://github.com/apache/camel/pull/3824#discussion_r424925600", "createdAt": "2020-05-14T07:28:52Z", "author": {"login": "zhfeng"}, "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "diffHunk": "@@ -78,10 +79,16 @@ public void afterPropertiesConfigured(CamelContext camelContext) {\n         delegateEndpoint.setWebhookConfiguration(configuration);\n     }\n \n+    @Override\n+    protected void doInit() throws Exception {\n+        super.doInit();\n+        ServiceHelper.initService(delegateEndpoint);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf322124b2a0001625adb65b69facdfd074d3d9c"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NjE0MDQ5OnYy", "diffSide": "RIGHT", "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozMDoyMlrOGVPclg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozOTowMlrOGVPtng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyNjM1OA==", "bodyText": "if the delegateEndpoint has been stared as this router is added after the camel context started, what would happen ? The endpoint can be started twice ?", "url": "https://github.com/apache/camel/pull/3824#discussion_r424926358", "createdAt": "2020-05-14T07:30:22Z", "author": {"login": "zhfeng"}, "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "diffHunk": "@@ -78,10 +79,16 @@ public void afterPropertiesConfigured(CamelContext camelContext) {\n         delegateEndpoint.setWebhookConfiguration(configuration);\n     }\n \n+    @Override\n+    protected void doInit() throws Exception {\n+        super.doInit();\n+        ServiceHelper.initService(delegateEndpoint);\n+    }\n+\n     @Override\n     protected void doStart() throws Exception {\n         super.doStart();\n-\n+        ServiceHelper.startService(delegateEndpoint);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf322124b2a0001625adb65b69facdfd074d3d9c"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkzMDcxOA==", "bodyText": "Thats taken care of internally by Camel to check its state and only start if not already started etc.", "url": "https://github.com/apache/camel/pull/3824#discussion_r424930718", "createdAt": "2020-05-14T07:39:02Z", "author": {"login": "davsclaus"}, "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "diffHunk": "@@ -78,10 +79,16 @@ public void afterPropertiesConfigured(CamelContext camelContext) {\n         delegateEndpoint.setWebhookConfiguration(configuration);\n     }\n \n+    @Override\n+    protected void doInit() throws Exception {\n+        super.doInit();\n+        ServiceHelper.initService(delegateEndpoint);\n+    }\n+\n     @Override\n     protected void doStart() throws Exception {\n         super.doStart();\n-\n+        ServiceHelper.startService(delegateEndpoint);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyNjM1OA=="}, "originalCommit": {"oid": "bf322124b2a0001625adb65b69facdfd074d3d9c"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NjE0MzU3OnYy", "diffSide": "RIGHT", "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozMToxOFrOGVPehw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozOTo0MVrOGVPvFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyNjg1NQ==", "bodyText": "Not sure it is safe to stop the endpoint here.", "url": "https://github.com/apache/camel/pull/3824#discussion_r424926855", "createdAt": "2020-05-14T07:31:18Z", "author": {"login": "zhfeng"}, "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "diffHunk": "@@ -91,11 +98,17 @@ protected void doStart() throws Exception {\n     @Override\n     protected void doStop() throws Exception {\n         super.doStop();\n-\n         if (configuration.isWebhookAutoRegister() && delegateEndpoint != null) {\n             LOG.info(\"Unregistering webhook for endpoint: {}\", delegateEndpoint);\n             delegateEndpoint.unregisterWebhook();\n         }\n+        ServiceHelper.stopService(delegateEndpoint);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf322124b2a0001625adb65b69facdfd074d3d9c"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkzMTA5Mg==", "bodyText": "The webhook is creating the delegate endpoint and should handle its lifecycle. That is how its done in other componens that does something like this", "url": "https://github.com/apache/camel/pull/3824#discussion_r424931092", "createdAt": "2020-05-14T07:39:41Z", "author": {"login": "davsclaus"}, "path": "components/camel-webhook/src/main/java/org/apache/camel/component/webhook/WebhookEndpoint.java", "diffHunk": "@@ -91,11 +98,17 @@ protected void doStart() throws Exception {\n     @Override\n     protected void doStop() throws Exception {\n         super.doStop();\n-\n         if (configuration.isWebhookAutoRegister() && delegateEndpoint != null) {\n             LOG.info(\"Unregistering webhook for endpoint: {}\", delegateEndpoint);\n             delegateEndpoint.unregisterWebhook();\n         }\n+        ServiceHelper.stopService(delegateEndpoint);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyNjg1NQ=="}, "originalCommit": {"oid": "bf322124b2a0001625adb65b69facdfd074d3d9c"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4951, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}