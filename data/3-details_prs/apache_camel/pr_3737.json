{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzMjA0NzM2", "number": 3737, "title": "CAMEL-14892 Camel-influxdb uses deprecated methods in doInsert action", "bodyText": "Issue: https://issues.apache.org/jira/browse/CAMEL-14892\n2 depricated calls are replaced with the correct ones. (queries with SHOW DATABASES and CREATE DATABASE  are called instead of depricated method on InfluxDB).\nTest covering call is added.\n[ ] Make sure there is a JIRA issue filed for the change (usually before you start working on it).  Trivial changes like typos do not require a JIRA issue.  Your pull request should address just this issue, without pulling in other changes.\n[ ] Each commit in the pull request should have a meaningful subject line and body.\n[ ] If you're unsure, you can format the pull request title like [CAMEL-XXX] Fixes bug in camel-file component, where you replace CAMEL-XXX with the appropriate JIRA issue.\n[ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n[ ] Run mvn clean install -Psourcecheck in your module with source check enabled to make sure basic checks pass and there are no checkstyle violations. A more thorough check will be performed on your pull request automatically.\nBelow are the contribution guidelines:\nhttps://github.com/apache/camel/blob/master/CONTRIBUTING.md", "createdAt": "2020-04-14T14:03:26Z", "url": "https://github.com/apache/camel/pull/3737", "merged": true, "mergeCommit": {"oid": "f9e921c1b9681c20e71e5751f738544b9985ac40"}, "closed": true, "closedAt": "2020-04-15T08:43:28Z", "author": {"login": "JiriOndrusek"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXkB9oAFqTM5Mjk2MDI1NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXk-DVABqjMyMzE2MDA3Mjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyOTYwMjU1", "url": "https://github.com/apache/camel/pull/3737#pullrequestreview-392960255", "createdAt": "2020-04-14T14:05:04Z", "commit": {"oid": "5adc8a497c4261897cf376311e19301499a8181b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyOTc0ODQ3", "url": "https://github.com/apache/camel/pull/3737#pullrequestreview-392974847", "createdAt": "2020-04-14T14:20:16Z", "commit": {"oid": "5adc8a497c4261897cf376311e19301499a8181b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDoyMDoxNlrOGFQ_UQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDoyMDozNlrOGFRAXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE3NDQxNw==", "bodyText": "Typos", "url": "https://github.com/apache/camel/pull/3737#discussion_r408174417", "createdAt": "2020-04-14T14:20:16Z", "author": {"login": "davsclaus"}, "path": "components/camel-influxdb/src/main/java/org/apache/camel/component/influxdb/InfluxDbProducer.java", "diffHunk": "@@ -138,4 +137,22 @@ private String calculateQuery(Exchange exchange) {\n         return query;\n     }\n \n+    private void ensureDatabaseExists(String dataBaseName) {\n+        QueryResult result = connection.query(new Query(SHOW_DATABASES));\n+\n+        //databases are in the first Serie called 'databases' and values are te fist value called 'name',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5adc8a497c4261897cf376311e19301499a8181b"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE3NDY4NA==", "bodyText": "Isn't there a nicer way than to catch a NPE", "url": "https://github.com/apache/camel/pull/3737#discussion_r408174684", "createdAt": "2020-04-14T14:20:36Z", "author": {"login": "davsclaus"}, "path": "components/camel-influxdb/src/main/java/org/apache/camel/component/influxdb/InfluxDbProducer.java", "diffHunk": "@@ -138,4 +137,22 @@ private String calculateQuery(Exchange exchange) {\n         return query;\n     }\n \n+    private void ensureDatabaseExists(String dataBaseName) {\n+        QueryResult result = connection.query(new Query(SHOW_DATABASES));\n+\n+        //databases are in the first Serie called 'databases' and values are te fist value called 'name',\n+        //if any object on the 'path' is null, database does not exist\n+        boolean exists;\n+        try {\n+            exists = result.getResults().get(0).getSeries().get(0).getValues().get(0).contains(dataBaseName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5adc8a497c4261897cf376311e19301499a8181b"}, "originalPosition": 32}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5adc8a497c4261897cf376311e19301499a8181b", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/5adc8a497c4261897cf376311e19301499a8181b", "committedDate": "2020-04-14T14:02:37Z", "message": "CAMEL-14892 Camel-influxdb uses deprecated methods in doInsert action"}, "afterCommit": {"oid": "2c5825a59d4884fcd7d764390adf7a703d58693f", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/2c5825a59d4884fcd7d764390adf7a703d58693f", "committedDate": "2020-04-14T14:29:30Z", "message": "CAMEL-14892 Camel-influxdb uses deprecated methods in doInsert action"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMDIwODM4", "url": "https://github.com/apache/camel/pull/3737#pullrequestreview-393020838", "createdAt": "2020-04-14T15:05:35Z", "commit": {"oid": "2c5825a59d4884fcd7d764390adf7a703d58693f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15663cc9ed7166729c2c62ff12f9fbd1f8ddb6a1", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/15663cc9ed7166729c2c62ff12f9fbd1f8ddb6a1", "committedDate": "2020-04-14T15:10:23Z", "message": "CAMEL-14892 Camel-influxdb uses deprecated methods in doInsert action"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c5825a59d4884fcd7d764390adf7a703d58693f", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/2c5825a59d4884fcd7d764390adf7a703d58693f", "committedDate": "2020-04-14T14:29:30Z", "message": "CAMEL-14892 Camel-influxdb uses deprecated methods in doInsert action"}, "afterCommit": {"oid": "15663cc9ed7166729c2c62ff12f9fbd1f8ddb6a1", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/15663cc9ed7166729c2c62ff12f9fbd1f8ddb6a1", "committedDate": "2020-04-14T15:10:23Z", "message": "CAMEL-14892 Camel-influxdb uses deprecated methods in doInsert action"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3077, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}