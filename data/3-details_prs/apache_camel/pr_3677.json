{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNDk3MTc5", "number": 3677, "title": "CAMEL-14780 camel-undertow: Enhance SPI API for HttpHandler change", "bodyText": "Issue: https://issues.apache.org/jira/browse/CAMEL-14780\nChange adds method co change httpHandler into SPI API.\nExtension of API is back compatible with previous version of API.\nAdded JUnit test validating htppHandler 'hook' and test for usage of security parameters defined on component.\n[ ] Make sure there is a JIRA issue filed for the change (usually before you start working on it).  Trivial changes like typos do not require a JIRA issue.  Your pull request should address just this issue, without pulling in other changes.\n[ ] Each commit in the pull request should have a meaningful subject line and body.\n[ ] If you're unsure, you can format the pull request title like [CAMEL-XXX] Fixes bug in camel-file component, where you replace CAMEL-XXX with the appropriate JIRA issue.\n[ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n[ ] Run mvn clean install -Psourcecheck in your module with source check enabled to make sure basic checks pass and there are no checkstyle violations. A more thorough check will be performed on your pull request automatically.\nBelow are the contribution guidelines:\nhttps://github.com/apache/camel/blob/master/CONTRIBUTING.md", "createdAt": "2020-03-25T10:12:44Z", "url": "https://github.com/apache/camel/pull/3677", "merged": true, "mergeCommit": {"oid": "050c0913aaedfe8279f41b96df618545dccbf4d7"}, "closed": true, "closedAt": "2020-03-25T13:12:31Z", "author": {"login": "JiriOndrusek"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcREv8dgFqTM4MTAxMjE0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRHSd1AFqTM4MTEzMTM1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMDEyMTQ3", "url": "https://github.com/apache/camel/pull/3677#pullrequestreview-381012147", "createdAt": "2020-03-25T10:14:47Z", "commit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMDEyODg0", "url": "https://github.com/apache/camel/pull/3677#pullrequestreview-381012884", "createdAt": "2020-03-25T10:15:47Z", "commit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMDoxNTo0N1rOF7UPiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMDoxNzoxNVrOF7US0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc0MTk2MA==", "bodyText": "Add @metadata with security label.", "url": "https://github.com/apache/camel/pull/3677#discussion_r397741960", "createdAt": "2020-03-25T10:15:47Z", "author": {"login": "davsclaus"}, "path": "components/camel-undertow/src/main/java/org/apache/camel/component/undertow/UndertowComponent.java", "diffHunk": "@@ -78,6 +87,7 @@\n     @Metadata(label = \"security\")\n     private String allowedRoles;\n \n+    private UndertowSecurityProvider securityProvider;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc0MjA5NA==", "bodyText": "Add setter so you can set this explicit", "url": "https://github.com/apache/camel/pull/3677#discussion_r397742094", "createdAt": "2020-03-25T10:16:04Z", "author": {"login": "davsclaus"}, "path": "components/camel-undertow/src/main/java/org/apache/camel/component/undertow/UndertowComponent.java", "diffHunk": "@@ -435,4 +476,8 @@ public String getAllowedRoles() {\n     public void setAllowedRoles(String allowedRoles) {\n         this.allowedRoles = allowedRoles;\n     }\n+\n+    public UndertowSecurityProvider getSecurityProvider() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "originalPosition": 116}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc0MjIwMA==", "bodyText": "Only init if the security provider is null", "url": "https://github.com/apache/camel/pull/3677#discussion_r397742200", "createdAt": "2020-03-25T10:16:17Z", "author": {"login": "davsclaus"}, "path": "components/camel-undertow/src/main/java/org/apache/camel/component/undertow/UndertowComponent.java", "diffHunk": "@@ -306,6 +339,8 @@ public Producer createProducer(CamelContext camelContext, String host,\n     protected void doStart() throws Exception {\n         super.doStart();\n \n+        initSecurityProvider();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc0MjYyMA==", "bodyText": "getter/setters should be plain, not these tricks. Instead when creating the endpoint in the component, then set the security provider on the endpoint correctly", "url": "https://github.com/apache/camel/pull/3677#discussion_r397742620", "createdAt": "2020-03-25T10:16:56Z", "author": {"login": "davsclaus"}, "path": "components/camel-undertow/src/main/java/org/apache/camel/component/undertow/UndertowEndpoint.java", "diffHunk": "@@ -147,7 +147,11 @@ public UndertowComponent getComponent() {\n     }\n \n     public UndertowSecurityProvider getSecurityProvider() {\n-        return securityProvider;\n+        if (this.securityProvider == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc0MjgwMA==", "bodyText": "See prev comment, getter/setter should be plain", "url": "https://github.com/apache/camel/pull/3677#discussion_r397742800", "createdAt": "2020-03-25T10:17:15Z", "author": {"login": "davsclaus"}, "path": "components/camel-undertow/src/main/java/org/apache/camel/component/undertow/UndertowEndpoint.java", "diffHunk": "@@ -454,14 +458,13 @@ public boolean isPreserveHostHeader() {\n     }\n \n     public Object getSecurityConfiguration() {\n-        return this.securityConfiguration == null ? getComponent().getSecurityConfiguration() : this.securityConfiguration;\n+        return this.securityConfiguration;\n     }\n \n     public void setSecurityConfiguration(Object securityConfiguration) {\n         this.securityConfiguration = securityConfiguration;\n     }\n \n-\n     public String getAllowedRoles() {\n         return allowedRoles == null ? getComponent().getAllowedRoles() : allowedRoles;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a77ee789aad3cf2093e54db901a1400c93b17fe6", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/a77ee789aad3cf2093e54db901a1400c93b17fe6", "committedDate": "2020-03-25T11:06:38Z", "message": "CAMEL-14780 camel-undertow: UndertowSecurityProvider SPI API misses a method to change HttpHandler"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "54a3cbecb78f140ef1591da3a4aa428ec0736ea0", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/54a3cbecb78f140ef1591da3a4aa428ec0736ea0", "committedDate": "2020-03-25T10:10:26Z", "message": "CAMEL-14780 camel-undertow: UndertowSecurityProvider SPI API misses a method to change HttpHandler"}, "afterCommit": {"oid": "a77ee789aad3cf2093e54db901a1400c93b17fe6", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/a77ee789aad3cf2093e54db901a1400c93b17fe6", "committedDate": "2020-03-25T11:06:38Z", "message": "CAMEL-14780 camel-undertow: UndertowSecurityProvider SPI API misses a method to change HttpHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMTMxMzUy", "url": "https://github.com/apache/camel/pull/3677#pullrequestreview-381131352", "createdAt": "2020-03-25T13:12:18Z", "commit": {"oid": "a77ee789aad3cf2093e54db901a1400c93b17fe6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3050, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}