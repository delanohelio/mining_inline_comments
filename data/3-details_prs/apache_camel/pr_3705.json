{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NTEzMzU2", "number": 3705, "title": "CAMEL-14833 camel-tika: enhance TikaProducer to be easoly extensible", "bodyText": "Issue: https://issues.apache.org/jira/browse/CAMEL-14833\nImprovement for usage of different parser (not autodetectParser)  inside tika component.\nThere is no need for a new test because functionality is not changed.\n[ ] Make sure there is a JIRA issue filed for the change (usually before you start working on it).  Trivial changes like typos do not require a JIRA issue.  Your pull request should address just this issue, without pulling in other changes.\n[ ] Each commit in the pull request should have a meaningful subject line and body.\n[ ] If you're unsure, you can format the pull request title like [CAMEL-XXX] Fixes bug in camel-file component, where you replace CAMEL-XXX with the appropriate JIRA issue.\n[ ] Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n[ ] Run mvn clean install -Psourcecheck in your module with source check enabled to make sure basic checks pass and there are no checkstyle violations. A more thorough check will be performed on your pull request automatically.\nBelow are the contribution guidelines:\nhttps://github.com/apache/camel/blob/master/CONTRIBUTING.md", "createdAt": "2020-04-02T11:16:26Z", "url": "https://github.com/apache/camel/pull/3705", "merged": true, "mergeCommit": {"oid": "5dba43891e0bdf805c4e065d68bddb0803a83830"}, "closed": true, "closedAt": "2020-04-03T06:24:18Z", "author": {"login": "JiriOndrusek"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTqjRdgFqTM4NjMzMzU2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcT62CxAFqTM4Njk2MzQzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MzMzNTY4", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386333568", "createdAt": "2020-04-02T11:25:11Z", "commit": {"oid": "225528a48bd20af13a258c831e75848f408d16c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MzM3OTE2", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386337916", "createdAt": "2020-04-02T11:32:15Z", "commit": {"oid": "225528a48bd20af13a258c831e75848f408d16c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMTozMjoxNVrOF_nAIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMTozMjoxNVrOF_nAIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI0MzYxOA==", "bodyText": "I just realized that setProperties should be done on the endpoint not on the configuration in order to avoid reflection, is that correct @oscerd ?", "url": "https://github.com/apache/camel/pull/3705#discussion_r402243618", "createdAt": "2020-04-02T11:32:15Z", "author": {"login": "omarsmak"}, "path": "components/camel-tika/src/main/java/org/apache/camel/component/tika/TikaComponent.java", "diffHunk": "@@ -38,6 +38,10 @@ protected Endpoint createEndpoint(String uri, String remaining, Map<String, Obje\n             tikaConfiguration.setTikaConfig(config);\r\n         }\r\n         tikaConfiguration.setOperation(new URI(uri).getHost());\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "225528a48bd20af13a258c831e75848f408d16c3"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MzcwMzcz", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386370373", "createdAt": "2020-04-02T12:21:19Z", "commit": {"oid": "225528a48bd20af13a258c831e75848f408d16c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjoyMToyMFrOF_olIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMjoyMToyMFrOF_olIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI2OTQ3Mw==", "bodyText": "It seams to be a related to IDE, but looks like we don't need this for all fields.", "url": "https://github.com/apache/camel/pull/3705#discussion_r402269473", "createdAt": "2020-04-02T12:21:20Z", "author": {"login": "dmvolod"}, "path": "components/camel-tika/src/main/java/org/apache/camel/component/tika/TikaProducer.java", "diffHunk": "@@ -59,12 +59,24 @@\n     private final String encoding;\r\n \r\n     public TikaProducer(TikaEndpoint endpoint) {\r\n+        this(endpoint, true, null);\r\n+    }\r\n+\r\n+    public TikaProducer(TikaEndpoint endpoint, Parser parser) {\r\n+        this(endpoint, parser == null, parser);\r\n+    }\r\n+\r\n+    private TikaProducer(TikaEndpoint endpoint, boolean autodetectParser, Parser parser) {\r\n         super(endpoint);\r\n         this.tikaConfiguration = endpoint.getTikaConfiguration();\r\n         this.encoding = this.tikaConfiguration.getTikaParseOutputEncoding();\r\n         TikaConfig config = this.tikaConfiguration.getTikaConfig();\r\n-        this.parser = new AutoDetectParser(config);\r\n         this.detector = config.getDetector();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "225528a48bd20af13a258c831e75848f408d16c3"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "225528a48bd20af13a258c831e75848f408d16c3", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/225528a48bd20af13a258c831e75848f408d16c3", "committedDate": "2020-04-02T11:11:02Z", "message": "CAMEL-14833 camel-tika: enhance TikaProducer to use different tika parser instead of AutodetectParse"}, "afterCommit": {"oid": "72147d76e96908c2cd3e9992c1518c294a31ee65", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/72147d76e96908c2cd3e9992c1518c294a31ee65", "committedDate": "2020-04-02T12:52:01Z", "message": "CAMEL-14833 camel-tika: enhance TikaProducer to use different tika parser instead of AutodetectParse"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NDE3NDAz", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386417403", "createdAt": "2020-04-02T13:20:36Z", "commit": {"oid": "72147d76e96908c2cd3e9992c1518c294a31ee65"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMzoyMDozNlrOF_q1iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMzoyMDozNlrOF_q1iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMwNjQ0MQ==", "bodyText": "I think you can replace autodetectParser with parser == null and eliminate the three-args constructor.", "url": "https://github.com/apache/camel/pull/3705#discussion_r402306441", "createdAt": "2020-04-02T13:20:36Z", "author": {"login": "ppalaga"}, "path": "components/camel-tika/src/main/java/org/apache/camel/component/tika/TikaProducer.java", "diffHunk": "@@ -59,12 +59,24 @@\n     private final String encoding;\r\n \r\n     public TikaProducer(TikaEndpoint endpoint) {\r\n+        this(endpoint, true, null);\r\n+    }\r\n+\r\n+    public TikaProducer(TikaEndpoint endpoint, Parser parser) {\r\n+        this(endpoint, parser == null, parser);\r\n+    }\r\n+\r\n+    private TikaProducer(TikaEndpoint endpoint, boolean autodetectParser, Parser parser) {\r\n         super(endpoint);\r\n         this.tikaConfiguration = endpoint.getTikaConfiguration();\r\n         this.encoding = this.tikaConfiguration.getTikaParseOutputEncoding();\r\n         TikaConfig config = this.tikaConfiguration.getTikaConfig();\r\n-        this.parser = new AutoDetectParser(config);\r\n         this.detector = config.getDetector();\r\n+        if (autodetectParser) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72147d76e96908c2cd3e9992c1518c294a31ee65"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf52a18f9308f6a648dfa8f79831bbe1756aead4", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/bf52a18f9308f6a648dfa8f79831bbe1756aead4", "committedDate": "2020-04-02T13:30:31Z", "message": "CAMEL-14833 camel-tika: enhance TikaProducer to use different tika parser instead of AutodetectParse"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72147d76e96908c2cd3e9992c1518c294a31ee65", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/72147d76e96908c2cd3e9992c1518c294a31ee65", "committedDate": "2020-04-02T12:52:01Z", "message": "CAMEL-14833 camel-tika: enhance TikaProducer to use different tika parser instead of AutodetectParse"}, "afterCommit": {"oid": "bf52a18f9308f6a648dfa8f79831bbe1756aead4", "author": {"user": {"login": "JiriOndrusek", "name": null}}, "url": "https://github.com/apache/camel/commit/bf52a18f9308f6a648dfa8f79831bbe1756aead4", "committedDate": "2020-04-02T13:30:31Z", "message": "CAMEL-14833 camel-tika: enhance TikaProducer to use different tika parser instead of AutodetectParse"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NDY5Mjg0", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386469284", "createdAt": "2020-04-02T14:15:21Z", "commit": {"oid": "bf52a18f9308f6a648dfa8f79831bbe1756aead4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NDc0NDc1", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386474475", "createdAt": "2020-04-02T14:20:44Z", "commit": {"oid": "bf52a18f9308f6a648dfa8f79831bbe1756aead4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NjEyOTk2", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386612996", "createdAt": "2020-04-02T16:50:58Z", "commit": {"oid": "bf52a18f9308f6a648dfa8f79831bbe1756aead4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2OTYzNDM5", "url": "https://github.com/apache/camel/pull/3705#pullrequestreview-386963439", "createdAt": "2020-04-03T06:24:10Z", "commit": {"oid": "bf52a18f9308f6a648dfa8f79831bbe1756aead4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3068, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}