{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1Mjg0MDU1", "number": 2120, "title": "[Gradle Plugin] Support Kotlin multiplatform", "bodyText": "Support Kotlin Multiplatform projects in the Gradle Plugin\n\nApollo Compiler uses multiplatform compatible Throws and IOException\nSince generated code supports \"common\" code, it should be compatible with all targets.\nCurrently only supports commonMain and commonTest. Looks like supporting per target would make it extremely complex.\nFor multiplatform projects, Kotlin code generation cannot be turned off.\n\nAlso increased Gradle's memory since with iOS builds, it consumes much more memory.\nFixes #2086", "createdAt": "2020-03-29T17:01:22Z", "url": "https://github.com/apollographql/apollo-android/pull/2120", "merged": true, "mergeCommit": {"oid": "3e37125cc4f98e6e981c37e877c1cc4f61f17604"}, "closed": true, "closedAt": "2020-04-04T07:51:13Z", "author": {"login": "tasomaniac"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSbvbzAH2gAyMzk1Mjg0MDU1Ojc4OWZkNWI3ZjQ2Y2NlYmE5NjcwYjlmMmE1YWNhODE4N2U4MWFlOTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcULjGsAH2gAyMzk1Mjg0MDU1OjljZTcxMTA2NzQyY2U3YWViNTg4ZWJkOTAwNWI0NDZhOWFhNjIwODk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "789fd5b7f46cceba9670b9f2a5aca8187e81ae96", "author": {"user": {"login": "tasomaniac", "name": "Said Tahsin Dane"}}, "url": "https://github.com/apollographql/apollo-android/commit/789fd5b7f46cceba9670b9f2a5aca8187e81ae96", "committedDate": "2020-03-29T15:35:58Z", "message": "Support Multiplatform projects on Apollo Gradle Plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be04f17a0c2fc0de29e556f8f2831ffc99ffc8b1", "author": {"user": {"login": "tasomaniac", "name": "Said Tahsin Dane"}}, "url": "https://github.com/apollographql/apollo-android/commit/be04f17a0c2fc0de29e556f8f2831ffc99ffc8b1", "committedDate": "2020-03-29T16:25:14Z", "message": "Support Multiplatform typealias classes explicitly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "307f89f5751db815a68ff2e68d61bdfa75527c4f", "author": {"user": {"login": "tasomaniac", "name": "Said Tahsin Dane"}}, "url": "https://github.com/apollographql/apollo-android/commit/307f89f5751db815a68ff2e68d61bdfa75527c4f", "committedDate": "2020-03-29T16:25:41Z", "message": "Set Gradle memory for composite builds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c", "author": {"user": {"login": "tasomaniac", "name": "Said Tahsin Dane"}}, "url": "https://github.com/apollographql/apollo-android/commit/132839a722d6b5ba7e8015ba79a8fb62eba5a22c", "committedDate": "2020-03-29T20:23:00Z", "message": "Update test fixtures regarding import changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MjQ5OTM4", "url": "https://github.com/apollographql/apollo-android/pull/2120#pullrequestreview-384249938", "createdAt": "2020-03-30T21:37:16Z", "commit": {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTkzNzA1", "url": "https://github.com/apollographql/apollo-android/pull/2120#pullrequestreview-387593705", "createdAt": "2020-04-03T21:33:08Z", "commit": {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTozMzowOFrOGAqWLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTozMzowOFrOGAqWLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0Njk5MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            val MULTIPLATFORM_THROWS = ClassName.bestGuess(\"com.apollographql.apollo.api.internal.Throws\")\n          \n          \n            \n            private val MULTIPLATFORM_THROWS = ClassName(\"com.apollographql.apollo.api.internal\", \"Throws\")\n          \n      \n    \n    \n  \n\nbestGuess works the same but the \"guess\" part is a bit misleading as it implies this might fail (while it won't)", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403346991", "createdAt": "2020-04-03T21:33:08Z", "author": {"login": "martinbonnin"}, "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/codegen/kotlin/KotlinCodeGenUtil.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package com.apollographql.apollo.compiler.codegen.kotlin\n+\n+import com.squareup.kotlinpoet.AnnotationSpec\n+import com.squareup.kotlinpoet.ClassName\n+import com.squareup.kotlinpoet.FunSpec\n+\n+val MULTIPLATFORM_THROWS = ClassName.bestGuess(\"com.apollographql.apollo.api.internal.Throws\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTkzNzg3", "url": "https://github.com/apollographql/apollo-android/pull/2120#pullrequestreview-387593787", "createdAt": "2020-04-03T21:33:18Z", "commit": {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTozMzoxOVrOGAqWbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTozMzoxOVrOGAqWbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NzA1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            val MULTIPLATFORM_IO_EXCEPTION = ClassName.bestGuess(\"okio.IOException\")\n          \n          \n            \n            private val MULTIPLATFORM_IO_EXCEPTION = ClassName(\"okio\", \"IOException\")", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403347055", "createdAt": "2020-04-03T21:33:19Z", "author": {"login": "martinbonnin"}, "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/codegen/kotlin/KotlinCodeGenUtil.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package com.apollographql.apollo.compiler.codegen.kotlin\n+\n+import com.squareup.kotlinpoet.AnnotationSpec\n+import com.squareup.kotlinpoet.ClassName\n+import com.squareup.kotlinpoet.FunSpec\n+\n+val MULTIPLATFORM_THROWS = ClassName.bestGuess(\"com.apollographql.apollo.api.internal.Throws\")\n+val MULTIPLATFORM_IO_EXCEPTION = ClassName.bestGuess(\"okio.IOException\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "132839a722d6b5ba7e8015ba79a8fb62eba5a22c"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTk3MjMw", "url": "https://github.com/apollographql/apollo-android/pull/2120#pullrequestreview-387597230", "createdAt": "2020-04-03T21:41:31Z", "commit": {"oid": "789fd5b7f46cceba9670b9f2a5aca8187e81ae96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTo0MTozMVrOGAqieA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTo0MTozMVrOGAqieA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM1MDEzNg==", "bodyText": "\ud83d\udc4d  very nice to have that by default !", "url": "https://github.com/apollographql/apollo-android/pull/2120#discussion_r403350136", "createdAt": "2020-04-03T21:41:31Z", "author": {"login": "martinbonnin"}, "path": "apollo-gradle-plugin/src/main/kotlin/com/apollographql/apollo/gradle/internal/DefaultCompilationUnit.kt", "diffHunk": "@@ -104,12 +105,13 @@ abstract class DefaultCompilationUnit @Inject constructor(\n     }\n   }\n \n-  fun generateKotlinModels(): Boolean {\n-    return generateKotlinModels.orElse(service.generateKotlinModels).orElse(apolloExtension.generateKotlinModels).getOrElse(false)\n+  fun generateKotlinModels(): Boolean = when {\n+    project.isKotlinMultiplatform -> true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "789fd5b7f46cceba9670b9f2a5aca8187e81ae96"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df93de41bbcbdbcfdedd56860f4a3597e7b88a54", "author": {"user": {"login": "martinbonnin", "name": "Martin Bonnin"}}, "url": "https://github.com/apollographql/apollo-android/commit/df93de41bbcbdbcfdedd56860f4a3597e7b88a54", "committedDate": "2020-04-03T22:48:00Z", "message": "add a multiplatform ios test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NjIzMTc2", "url": "https://github.com/apollographql/apollo-android/pull/2120#pullrequestreview-387623176", "createdAt": "2020-04-03T22:52:58Z", "commit": {"oid": "df93de41bbcbdbcfdedd56860f4a3597e7b88a54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ce71106742ce7aeb588ebd9005b446a9aa62089", "author": {"user": {"login": "tasomaniac", "name": "Said Tahsin Dane"}}, "url": "https://github.com/apollographql/apollo-android/commit/9ce71106742ce7aeb588ebd9005b446a9aa62089", "committedDate": "2020-04-04T01:51:52Z", "message": "Apply suggestions from code review\n\nCo-Authored-By: Martin Bonnin <martin@mbonnin.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3914, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}