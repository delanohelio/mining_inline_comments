{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NTg4MzMw", "number": 2063, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwODowMDowN1rODoCdwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwODowMToyOFrODoCeEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzEwMDE2OnYy", "diffSide": "RIGHT", "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwODowMDowN1rOF2YW5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQyMzowMDoxMVrOF2b_jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NjUwMA==", "bodyText": "Is java.lang.String enough or should we also check other Strings? Like I wonder what would happen on iOS. Of course can be tackled later.", "url": "https://github.com/apollographql/apollo-android/pull/2063#discussion_r392566500", "createdAt": "2020-03-14T08:00:07Z", "author": {"login": "tasomaniac"}, "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "diffHunk": "@@ -1,10 +1,117 @@\n package com.apollographql.apollo.api\n \n-expect class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+import com.apollographql.apollo.api.CustomTypeValue.*\n+import com.apollographql.apollo.api.CustomTypeValue.Companion.fromRawValue\n+import com.apollographql.apollo.api.internal.json.JsonWriter\n+import com.apollographql.apollo.api.internal.json.Utils\n+import com.apollographql.apollo.api.internal.json.use\n+import okio.Buffer\n+import kotlin.jvm.JvmField\n \n-  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T>\n+class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+  private val customAdapters = customAdapters.mapKeys { it.key.typeName() }\n+\n+  @Suppress(\"UNCHECKED_CAST\")\n+  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T> {\n+    var customTypeAdapter: CustomTypeAdapter<*>? = customAdapters[scalarType.typeName()]\n+    if (customTypeAdapter == null) {\n+      customTypeAdapter = DEFAULT_ADAPTERS[scalarType.className()]\n+    }\n+    return requireNotNull(customTypeAdapter) {\n+      \"Can't map GraphQL type: `${scalarType.typeName()}` to: `${scalarType.className()}`. Did you forget to add a custom type adapter?\"\n+    } as CustomTypeAdapter<T>\n+  }\n \n   companion object {\n-    val DEFAULT: ScalarTypeAdapters\n+    @JvmField\n+    val DEFAULT = ScalarTypeAdapters(emptyMap())\n+\n+    private val DEFAULT_ADAPTERS = emptyMap<String, CustomTypeAdapter<*>>() +\n+        createDefaultScalarTypeAdapter(\"java.lang.String\", \"kotlin.String\") { value ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3adc7d8a424e63ac6d46cfb6a6d0b315416c835f"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYyNDEyMQ==", "bodyText": "on iOS it must be kotlin.String as generated code is platform agnostic (common).", "url": "https://github.com/apollographql/apollo-android/pull/2063#discussion_r392624121", "createdAt": "2020-03-14T22:25:30Z", "author": {"login": "sav007"}, "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "diffHunk": "@@ -1,10 +1,117 @@\n package com.apollographql.apollo.api\n \n-expect class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+import com.apollographql.apollo.api.CustomTypeValue.*\n+import com.apollographql.apollo.api.CustomTypeValue.Companion.fromRawValue\n+import com.apollographql.apollo.api.internal.json.JsonWriter\n+import com.apollographql.apollo.api.internal.json.Utils\n+import com.apollographql.apollo.api.internal.json.use\n+import okio.Buffer\n+import kotlin.jvm.JvmField\n \n-  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T>\n+class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+  private val customAdapters = customAdapters.mapKeys { it.key.typeName() }\n+\n+  @Suppress(\"UNCHECKED_CAST\")\n+  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T> {\n+    var customTypeAdapter: CustomTypeAdapter<*>? = customAdapters[scalarType.typeName()]\n+    if (customTypeAdapter == null) {\n+      customTypeAdapter = DEFAULT_ADAPTERS[scalarType.className()]\n+    }\n+    return requireNotNull(customTypeAdapter) {\n+      \"Can't map GraphQL type: `${scalarType.typeName()}` to: `${scalarType.className()}`. Did you forget to add a custom type adapter?\"\n+    } as CustomTypeAdapter<T>\n+  }\n \n   companion object {\n-    val DEFAULT: ScalarTypeAdapters\n+    @JvmField\n+    val DEFAULT = ScalarTypeAdapters(emptyMap())\n+\n+    private val DEFAULT_ADAPTERS = emptyMap<String, CustomTypeAdapter<*>>() +\n+        createDefaultScalarTypeAdapter(\"java.lang.String\", \"kotlin.String\") { value ->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NjUwMA=="}, "originalCommit": {"oid": "3adc7d8a424e63ac6d46cfb6a6d0b315416c835f"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYyNjA2Mw==", "bodyText": "\ud83d\udc4d sounds good.", "url": "https://github.com/apollographql/apollo-android/pull/2063#discussion_r392626063", "createdAt": "2020-03-14T23:00:11Z", "author": {"login": "tasomaniac"}, "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "diffHunk": "@@ -1,10 +1,117 @@\n package com.apollographql.apollo.api\n \n-expect class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+import com.apollographql.apollo.api.CustomTypeValue.*\n+import com.apollographql.apollo.api.CustomTypeValue.Companion.fromRawValue\n+import com.apollographql.apollo.api.internal.json.JsonWriter\n+import com.apollographql.apollo.api.internal.json.Utils\n+import com.apollographql.apollo.api.internal.json.use\n+import okio.Buffer\n+import kotlin.jvm.JvmField\n \n-  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T>\n+class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+  private val customAdapters = customAdapters.mapKeys { it.key.typeName() }\n+\n+  @Suppress(\"UNCHECKED_CAST\")\n+  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T> {\n+    var customTypeAdapter: CustomTypeAdapter<*>? = customAdapters[scalarType.typeName()]\n+    if (customTypeAdapter == null) {\n+      customTypeAdapter = DEFAULT_ADAPTERS[scalarType.className()]\n+    }\n+    return requireNotNull(customTypeAdapter) {\n+      \"Can't map GraphQL type: `${scalarType.typeName()}` to: `${scalarType.className()}`. Did you forget to add a custom type adapter?\"\n+    } as CustomTypeAdapter<T>\n+  }\n \n   companion object {\n-    val DEFAULT: ScalarTypeAdapters\n+    @JvmField\n+    val DEFAULT = ScalarTypeAdapters(emptyMap())\n+\n+    private val DEFAULT_ADAPTERS = emptyMap<String, CustomTypeAdapter<*>>() +\n+        createDefaultScalarTypeAdapter(\"java.lang.String\", \"kotlin.String\") { value ->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NjUwMA=="}, "originalCommit": {"oid": "3adc7d8a424e63ac6d46cfb6a6d0b315416c835f"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzEwMDk4OnYy", "diffSide": "RIGHT", "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwODowMToyOFrOF2YXQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQyMjoyNTo0N1rOF2b4Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NjU5NQ==", "bodyText": "Why does this say Double for FileUpload?", "url": "https://github.com/apollographql/apollo-android/pull/2063#discussion_r392566595", "createdAt": "2020-03-14T08:01:28Z", "author": {"login": "tasomaniac"}, "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "diffHunk": "@@ -1,10 +1,117 @@\n package com.apollographql.apollo.api\n \n-expect class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+import com.apollographql.apollo.api.CustomTypeValue.*\n+import com.apollographql.apollo.api.CustomTypeValue.Companion.fromRawValue\n+import com.apollographql.apollo.api.internal.json.JsonWriter\n+import com.apollographql.apollo.api.internal.json.Utils\n+import com.apollographql.apollo.api.internal.json.use\n+import okio.Buffer\n+import kotlin.jvm.JvmField\n \n-  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T>\n+class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+  private val customAdapters = customAdapters.mapKeys { it.key.typeName() }\n+\n+  @Suppress(\"UNCHECKED_CAST\")\n+  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T> {\n+    var customTypeAdapter: CustomTypeAdapter<*>? = customAdapters[scalarType.typeName()]\n+    if (customTypeAdapter == null) {\n+      customTypeAdapter = DEFAULT_ADAPTERS[scalarType.className()]\n+    }\n+    return requireNotNull(customTypeAdapter) {\n+      \"Can't map GraphQL type: `${scalarType.typeName()}` to: `${scalarType.className()}`. Did you forget to add a custom type adapter?\"\n+    } as CustomTypeAdapter<T>\n+  }\n \n   companion object {\n-    val DEFAULT: ScalarTypeAdapters\n+    @JvmField\n+    val DEFAULT = ScalarTypeAdapters(emptyMap())\n+\n+    private val DEFAULT_ADAPTERS = emptyMap<String, CustomTypeAdapter<*>>() +\n+        createDefaultScalarTypeAdapter(\"java.lang.String\", \"kotlin.String\") { value ->\n+          if (value is GraphQLJsonList || value is GraphQLJsonObject) {\n+            val buffer = Buffer()\n+            JsonWriter.of(buffer).use { writer ->\n+              Utils.writeToJson(value.value, writer)\n+            }\n+            buffer.readUtf8()\n+          } else {\n+            value.value.toString()\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Boolean\", \"kotlin.Boolean\") { value ->\n+          when (value) {\n+            is GraphQLBoolean -> value.value\n+            is GraphQLString -> value.value.toBoolean()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Boolean\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Integer\", \"kotlin.Int\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toInt()\n+            is GraphQLString -> value.value.toInt()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Integer\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Long\", \"kotlin.Long\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toLong()\n+            is GraphQLString -> value.value.toLong()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Long\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Float\", \"kotlin.Float\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toFloat()\n+            is GraphQLString -> value.value.toFloat()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Float\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Double\", \"kotlin.Double\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toDouble()\n+            is GraphQLString -> value.value.toDouble()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Double\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(FileUpload::class.qualifiedName!!) { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toDouble()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3adc7d8a424e63ac6d46cfb6a6d0b315416c835f"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYyNDE0Ng==", "bodyText": "ogh, jeez my bad", "url": "https://github.com/apollographql/apollo-android/pull/2063#discussion_r392624146", "createdAt": "2020-03-14T22:25:47Z", "author": {"login": "sav007"}, "path": "apollo-api/src/commonMain/kotlin/com/apollographql/apollo/api/ScalarTypeAdapters.kt", "diffHunk": "@@ -1,10 +1,117 @@\n package com.apollographql.apollo.api\n \n-expect class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+import com.apollographql.apollo.api.CustomTypeValue.*\n+import com.apollographql.apollo.api.CustomTypeValue.Companion.fromRawValue\n+import com.apollographql.apollo.api.internal.json.JsonWriter\n+import com.apollographql.apollo.api.internal.json.Utils\n+import com.apollographql.apollo.api.internal.json.use\n+import okio.Buffer\n+import kotlin.jvm.JvmField\n \n-  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T>\n+class ScalarTypeAdapters(customAdapters: Map<ScalarType, CustomTypeAdapter<*>>) {\n+  private val customAdapters = customAdapters.mapKeys { it.key.typeName() }\n+\n+  @Suppress(\"UNCHECKED_CAST\")\n+  fun <T : Any> adapterFor(scalarType: ScalarType): CustomTypeAdapter<T> {\n+    var customTypeAdapter: CustomTypeAdapter<*>? = customAdapters[scalarType.typeName()]\n+    if (customTypeAdapter == null) {\n+      customTypeAdapter = DEFAULT_ADAPTERS[scalarType.className()]\n+    }\n+    return requireNotNull(customTypeAdapter) {\n+      \"Can't map GraphQL type: `${scalarType.typeName()}` to: `${scalarType.className()}`. Did you forget to add a custom type adapter?\"\n+    } as CustomTypeAdapter<T>\n+  }\n \n   companion object {\n-    val DEFAULT: ScalarTypeAdapters\n+    @JvmField\n+    val DEFAULT = ScalarTypeAdapters(emptyMap())\n+\n+    private val DEFAULT_ADAPTERS = emptyMap<String, CustomTypeAdapter<*>>() +\n+        createDefaultScalarTypeAdapter(\"java.lang.String\", \"kotlin.String\") { value ->\n+          if (value is GraphQLJsonList || value is GraphQLJsonObject) {\n+            val buffer = Buffer()\n+            JsonWriter.of(buffer).use { writer ->\n+              Utils.writeToJson(value.value, writer)\n+            }\n+            buffer.readUtf8()\n+          } else {\n+            value.value.toString()\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Boolean\", \"kotlin.Boolean\") { value ->\n+          when (value) {\n+            is GraphQLBoolean -> value.value\n+            is GraphQLString -> value.value.toBoolean()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Boolean\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Integer\", \"kotlin.Int\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toInt()\n+            is GraphQLString -> value.value.toInt()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Integer\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Long\", \"kotlin.Long\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toLong()\n+            is GraphQLString -> value.value.toLong()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Long\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Float\", \"kotlin.Float\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toFloat()\n+            is GraphQLString -> value.value.toFloat()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Float\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(\"java.lang.Double\", \"kotlin.Double\") { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toDouble()\n+            is GraphQLString -> value.value.toDouble()\n+            else -> throw IllegalArgumentException(\"Can't decode: $value into Double\")\n+          }\n+        } +\n+        createDefaultScalarTypeAdapter(FileUpload::class.qualifiedName!!) { value ->\n+          when (value) {\n+            is GraphQLNumber -> value.value.toDouble()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NjU5NQ=="}, "originalCommit": {"oid": "3adc7d8a424e63ac6d46cfb6a6d0b315416c835f"}, "originalPosition": 81}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3303, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}