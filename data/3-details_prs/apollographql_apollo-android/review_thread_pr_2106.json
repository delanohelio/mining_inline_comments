{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0OTUzNzMw", "number": 2106, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMDoyMzozOFrODsN3CQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMTo1ODozOVrODsPUtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjkxMDE3OnYy", "diffSide": "LEFT", "path": "build.gradle.kts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMDoyMzozOFrOF9Atyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMDoyMzozOFrOF9Atyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTUxOTE3OQ==", "bodyText": "I just noticed that this is deprecated in AGP 3.6.1 and removed in 4.0", "url": "https://github.com/apollographql/apollo-android/pull/2106#discussion_r399519179", "createdAt": "2020-03-27T20:23:38Z", "author": {"login": "tasomaniac"}, "path": "build.gradle.kts", "diffHunk": "@@ -55,7 +55,7 @@ subprojects {\n   }\n \n   plugins.withType(com.android.build.gradle.BasePlugin::class.java) {\n-    extension.compileOptions {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c80fae375159e5134fcb623570b7fe422fc5e79f"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NzE0OTk2OnYy", "diffSide": "RIGHT", "path": "apollo-gradle-plugin/src/main/kotlin/com/apollographql/apollo/gradle/internal/DefaultCompilationUnit.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMTo1ODozOVrOF9DCqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMTo1ODozOVrOF9DCqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU1NzI4OQ==", "bodyText": "Starting from suggestions in the IDE, I ended up refactoring this to make it easier to follow. This is the only behavior change.\nI recommend reviewing this in \"split\" view.", "url": "https://github.com/apollographql/apollo-android/pull/2106#discussion_r399557289", "createdAt": "2020-03-27T21:58:39Z", "author": {"login": "tasomaniac"}, "path": "apollo-gradle-plugin/src/main/kotlin/com/apollographql/apollo/gradle/internal/DefaultCompilationUnit.kt", "diffHunk": "@@ -65,29 +66,38 @@ abstract class DefaultCompilationUnit @Inject constructor(\n     }\n   }\n \n-  fun setSourcesIfNeeded(graphqlSourceDirectorySet: SourceDirectorySet, schemaFile: RegularFileProperty) {\n-    if (graphqlSourceDirectorySet.srcDirs.isEmpty()) {\n-      if (schemaFile.isPresent) {\n-        graphqlSourceDirectorySet.srcDir(schemaFile.asFile.get().parent)\n-      } else {\n+  fun setSourcesIfNeeded(sourceDirectorySet: SourceDirectorySet, schemaFile: RegularFileProperty) {\n+    if (sourceDirectorySet.srcDirs.isEmpty()) {\n+      sourceDirectorySet.findSources(schemaFile)\n+    }\n+\n+    if (!schemaFile.isPresent) {\n+      schemaFile.set { resolveSchema(sourceDirectorySet) }\n+    }\n+  }\n+\n+  private fun SourceDirectorySet.findSources(schemaFile: RegularFileProperty) {\n+    when {\n+      apolloVariant.isTest -> srcDirFromVariant(apolloVariant)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3396e5f184b8701dcfe142d63460da732760ec15"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3162, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}