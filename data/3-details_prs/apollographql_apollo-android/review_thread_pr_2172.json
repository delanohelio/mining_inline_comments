{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzMzI2Njc3", "number": 2172, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODozMjozM1rODxxX7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzo1NjowMFrODx9PlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTE1NzU3OnYy", "diffSide": "RIGHT", "path": "build.gradle.kts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODozMjozM1rOGFbsRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODozMjozM1rOGFbsRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0OTc2NA==", "bodyText": "This was missing and preventing the license url to be present in the pom files", "url": "https://github.com/apollographql/apollo-android/pull/2172#discussion_r408349764", "createdAt": "2020-04-14T18:32:33Z", "author": {"login": "martinbonnin"}, "path": "build.gradle.kts", "diffHunk": "@@ -209,43 +208,43 @@ fun Project.configurePublishing() {\n \n   configure<PublishingExtension> {\n     publications {\n-      if (plugins.hasPlugin(\"org.jetbrains.kotlin.multiplatform\")) {\n-        withType<MavenPublication>().getByName(\"jvm\") {\n-          if (javadocJarTaskProvider != null) {\n-            artifact(javadocJarTaskProvider.get())\n+      when {\n+        plugins.hasPlugin(\"org.jetbrains.kotlin.multiplatform\") -> {\n+          withType<MavenPublication>().getByName(\"jvm\") {\n+            if (javadocJarTaskProvider != null) {\n+              artifact(javadocJarTaskProvider.get())\n+            }\n           }\n         }\n-      } else {\n-        create<MavenPublication>(publicationName) {\n-          val javaComponent = components.findByName(\"java\")\n-          if (javaComponent != null) {\n-            from(javaComponent)\n-          } else if (android != null) {\n-            // this is a workaround while the below is fixed.\n-            // dependency information in the pom file will most likely be wrong\n-            // but it's been like that for some time now. As long as users still\n-            // import apollo-runtime in addition to the android artifacts, it\n-            // should be fine.\n-            //\n-            // https://issuetracker.google.com/issues/37055147\n-            // https://github.com/gradle/gradle/pull/8399\n-            afterEvaluate {\n-              artifact(tasks.named(\"bundleReleaseAar\").get())\n+        plugins.hasPlugin(\"java-gradle-plugin\") -> {\n+          // do nothing, the plugin will create the publications for us\n+        }\n+        else -> {\n+          create<MavenPublication>(\"default\") {\n+            val javaComponent = components.findByName(\"java\")\n+            if (javaComponent != null) {\n+              from(javaComponent)\n+            } else if (android != null) {\n+              from(components.findByName(\"release\"))\n             }\n-          }\n \n-          if (javadocJarTaskProvider != null) {\n-            artifact(javadocJarTaskProvider.get())\n-          }\n-          if (sourcesJarTaskProvider != null) {\n-            artifact(sourcesJarTaskProvider.get())\n-          }\n+            if (javadocJarTaskProvider != null) {\n+              artifact(javadocJarTaskProvider.get())\n+            }\n+            if (sourcesJarTaskProvider != null) {\n+              artifact(sourcesJarTaskProvider.get())\n+            }\n \n-          pom {\n-            artifactId = findProperty(\"POM_ARTIFACT_ID\") as String?\n+            pom {\n+              artifactId = findProperty(\"POM_ARTIFACT_ID\") as String?\n+            }\n           }\n         }\n       }\n+\n+      withType<MavenPublication>() {\n+        setDefaultPomFields()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63186853aa6773a967246df7621ccd5487877b8d"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzEwMjI4OnYy", "diffSide": "RIGHT", "path": "apollo-normalized-cache-sqlite/gradle.properties", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzo1NjowMFrOGFuD8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzo1NjowMFrOGFuD8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY1MDczOA==", "bodyText": "Ops", "url": "https://github.com/apollographql/apollo-android/pull/2172#discussion_r408650738", "createdAt": "2020-04-15T07:56:00Z", "author": {"login": "tasomaniac"}, "path": "apollo-normalized-cache-sqlite/gradle.properties", "diffHunk": "@@ -1,4 +1,4 @@\n-POM_ARTIFACT_ID=apollo-sqlite-cache\n+POM_ARTIFACT_ID=apollo-normalized-cache-sqlite", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "528407644623b02c25d4fa71782f0e276e4d9dd2"}, "originalPosition": 2}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3196, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}