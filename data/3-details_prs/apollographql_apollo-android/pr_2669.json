{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1MDM0NzAw", "number": 2669, "title": "[bugfix] fragment code-gen respect module package.", "bodyText": "", "createdAt": "2020-10-16T18:48:18Z", "url": "https://github.com/apollographql/apollo-android/pull/2669", "merged": true, "mergeCommit": {"oid": "019edd04fdfe51f107061d0d74cb5025d58f2528"}, "closed": true, "closedAt": "2020-10-30T09:42:47Z", "author": {"login": "Laimiux"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTLww-gBqjM4ODc5NDAxOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdW9-SogH2gAyNTA1MDM0NzAwOjU4OWFjNzVjMjkxMmI1MzFjODUwNTEzYjE3NTliOWJmYWNmZWZiZmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ba647dfc0a7bbf32a3fac0c21c77134b7fb5287", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/2ba647dfc0a7bbf32a3fac0c21c77134b7fb5287", "committedDate": "2020-10-16T18:47:45Z", "message": "[bugfix] fragment code-gen respect module package."}, "afterCommit": {"oid": "44e3f482775c588c6a38b2db60b340b36042fbe3", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/44e3f482775c588c6a38b2db60b340b36042fbe3", "committedDate": "2020-10-16T19:43:53Z", "message": "[bugfix] fragment code-gen respect module package."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "44e3f482775c588c6a38b2db60b340b36042fbe3", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/44e3f482775c588c6a38b2db60b340b36042fbe3", "committedDate": "2020-10-16T19:43:53Z", "message": "[bugfix] fragment code-gen respect module package."}, "afterCommit": {"oid": "02821ada0765ddf5946713a064de7228aa10c169", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/02821ada0765ddf5946713a064de7228aa10c169", "committedDate": "2020-10-16T19:44:58Z", "message": "[bugfix] fragment code-gen respect module package."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNzU1NTU1", "url": "https://github.com/apollographql/apollo-android/pull/2669#pullrequestreview-510755555", "createdAt": "2020-10-16T19:46:07Z", "commit": {"oid": "02821ada0765ddf5946713a064de7228aa10c169"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxOTo0NjowN1rOHjNxjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxOTo0NjowN1rOHjNxjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY4Nzg4Nw==", "bodyText": "I think this should work but would love another pair of eyes.", "url": "https://github.com/apollographql/apollo-android/pull/2669#discussion_r506687887", "createdAt": "2020-10-16T19:46:07Z", "author": {"login": "Laimiux"}, "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/FragmentsResponseMapperBuilder.kt", "diffHunk": "@@ -69,7 +69,7 @@ class FragmentsResponseMapperBuilder(\n   private fun mapperFields(fragmentFields: List<ResponseFieldSpec>): List<FieldSpec> {\n     return fragmentFields.map { field ->\n       val fieldType = field.normalizedFieldSpec.type as ClassName\n-      val mapperClassName = ClassName.get(context.ir.fragmentsPackageName, fieldType.simpleName(),\n+      val mapperClassName = ClassName.get(fieldType.packageName(), fieldType.simpleName(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02821ada0765ddf5946713a064de7228aa10c169"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/d042483ac9d2f4d67877854a86e0987160bf6aab", "committedDate": "2020-10-16T19:46:39Z", "message": "[bugfix] fragment code-gen respect module package."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02821ada0765ddf5946713a064de7228aa10c169", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/02821ada0765ddf5946713a064de7228aa10c169", "committedDate": "2020-10-16T19:44:58Z", "message": "[bugfix] fragment code-gen respect module package."}, "afterCommit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/d042483ac9d2f4d67877854a86e0987160bf6aab", "committedDate": "2020-10-16T19:46:39Z", "message": "[bugfix] fragment code-gen respect module package."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNzU2MjAx", "url": "https://github.com/apollographql/apollo-android/pull/2669#pullrequestreview-510756201", "createdAt": "2020-10-16T19:47:17Z", "commit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxOTo0NzoxN1rOHjNzjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxOTo0NzoxN1rOHjNzjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY4ODM5OQ==", "bodyText": "I'm assuming fragmentRef and fragment are representing the same object.", "url": "https://github.com/apollographql/apollo-android/pull/2669#discussion_r506688399", "createdAt": "2020-10-16T19:47:17Z", "author": {"login": "Laimiux"}, "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/SchemaTypeSpecBuilder.kt", "diffHunk": "@@ -190,7 +190,7 @@ class SchemaTypeSpecBuilder(\n             val optional = fragmentRef.isOptional()\n             val possibleTypes = fragment.takeIf { fragment.typeCondition != normalizeGraphQlType(schemaType) }?.possibleTypes ?: emptyList()\n             val fieldSpec = FieldSpec.builder(\n-                JavaTypeResolver(context = context, packageName = context.ir.fragmentsPackageName)\n+                JavaTypeResolver(context = context, packageName = fragment.packageName)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNzU2MDQw", "url": "https://github.com/apollographql/apollo-android/pull/2669#pullrequestreview-510756040", "createdAt": "2020-10-16T19:46:58Z", "commit": {"oid": "44e3f482775c588c6a38b2db60b340b36042fbe3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxOTo0NzowOVrOHjNzXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxOTo0NzowOVrOHjNzXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY4ODM1MQ==", "bodyText": "A few comments:\n\nWhat about dropping the \".fragment\" here? It made sense as long as all fragments ended up in the same package but if we start using the file package name instead, it might be confusing to append \".fragment\nSince fragments are not operations, we might want to rename operationPackageName to filePackageName\nIt's ok to change this behaviour for experimental multi-module things but not for the stable non-multi-module users so this will have to be configurable somewhere.", "url": "https://github.com/apollographql/apollo-android/pull/2669#discussion_r506688351", "createdAt": "2020-10-16T19:47:09Z", "author": {"login": "martinbonnin"}, "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/parser/graphql/GraphQLDocumentParser.kt", "diffHunk": "@@ -531,7 +531,8 @@ class GraphQLDocumentParser(\n             fragmentRefs = fragmentRefs.union(mergeInlineFragmentRefs).toList(),\n             inlineFragments = inlineFragments.result.filter { it.typeCondition != typeCondition },\n             filePath = graphQLFilePath,\n-            sourceLocation = SourceLocation(start)\n+            sourceLocation = SourceLocation(start),\n+            packageName = \"${packageNameProvider.operationPackageName(graphQLFilePath)}.fragment\".removePrefix(\".\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNzcyNTAx", "url": "https://github.com/apollographql/apollo-android/pull/2669#pullrequestreview-510772501", "createdAt": "2020-10-16T20:16:32Z", "commit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQyMDoxNjozMlrOHjOkAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQyMDoxNjozMlrOHjOkAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjcwMDgwMg==", "bodyText": "Can you add packageName: String? to ObjectType instead? It doesn't really make sense to have an AST type named \"Fragment\" as Kotlin doesn't know anything about a Fragment.", "url": "https://github.com/apollographql/apollo-android/pull/2669#discussion_r506700802", "createdAt": "2020-10-16T20:16:32Z", "author": {"login": "martinbonnin"}, "path": "apollo-compiler/src/main/kotlin/com/apollographql/apollo/compiler/ast/AST.kt", "diffHunk": "@@ -92,6 +92,11 @@ internal data class ObjectType(\n   }\n }\n \n+internal class FragmentType(\n+    val objectType: ObjectType,\n+    val packageName: String\n+)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d042483ac9d2f4d67877854a86e0987160bf6aab"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e0d8d65c532ab40807eac2b4190b3f485a45e8f", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/2e0d8d65c532ab40807eac2b4190b3f485a45e8f", "committedDate": "2020-10-16T20:35:49Z", "message": "PR feedback."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "275a74e61ca96e99f5461c1d8bcf5dd8c1a3dc34", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/275a74e61ca96e99f5461c1d8bcf5dd8c1a3dc34", "committedDate": "2020-10-16T21:01:49Z", "message": "Fix test compilation + new fixtures."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c645cdd36d2f41fd0e2aca72c397c47fb04ff2a4", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/c645cdd36d2f41fd0e2aca72c397c47fb04ff2a4", "committedDate": "2020-10-16T20:59:46Z", "message": "Fix test compilation + new fixtures."}, "afterCommit": {"oid": "275a74e61ca96e99f5461c1d8bcf5dd8c1a3dc34", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/275a74e61ca96e99f5461c1d8bcf5dd8c1a3dc34", "committedDate": "2020-10-16T21:01:49Z", "message": "Fix test compilation + new fixtures."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ca4aae49d4bac4a4ca4f91f18443ee3516242cc", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/0ca4aae49d4bac4a4ca4f91f18443ee3516242cc", "committedDate": "2020-10-16T21:54:48Z", "message": "Fixing missing compiler flag."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5aacb8e0331449e6e9d75dde02028dc0719bfc7", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/e5aacb8e0331449e6e9d75dde02028dc0719bfc7", "committedDate": "2020-10-16T21:54:17Z", "message": "Fixing missing compiler flag."}, "afterCommit": {"oid": "0ca4aae49d4bac4a4ca4f91f18443ee3516242cc", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/0ca4aae49d4bac4a4ca4f91f18443ee3516242cc", "committedDate": "2020-10-16T21:54:48Z", "message": "Fixing missing compiler flag."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "114dc70256f99b461344f8b1cd726b0215c058d0", "author": {"user": {"login": "martinbonnin", "name": "Martin Bonnin"}}, "url": "https://github.com/apollographql/apollo-android/commit/114dc70256f99b461344f8b1cd726b0215c058d0", "committedDate": "2020-10-17T14:27:55Z", "message": "update metalava"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwOTg5OTY4", "url": "https://github.com/apollographql/apollo-android/pull/2669#pullrequestreview-510989968", "createdAt": "2020-10-17T14:30:57Z", "commit": {"oid": "114dc70256f99b461344f8b1cd726b0215c058d0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2ead39b3f2478f2b3021db96be4a92defce0320", "author": {"user": {"login": "Laimiux", "name": "Laimonas Turauskas"}}, "url": "https://github.com/apollographql/apollo-android/commit/c2ead39b3f2478f2b3021db96be4a92defce0320", "committedDate": "2020-10-20T21:18:09Z", "message": "Adding a new code-gen test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d99c5c92752e9c6673854cbe032ae4e52ce660fb", "author": {"user": {"login": "martinbonnin", "name": "Martin Bonnin"}}, "url": "https://github.com/apollographql/apollo-android/commit/d99c5c92752e9c6673854cbe032ae4e52ce660fb", "committedDate": "2020-10-28T10:53:48Z", "message": "replace `useFilePackageNameForFragments` with plain `packageName`\n\npackageName not take into account the folder hiearchy and puts\neverything under the flat `packageName` directory\n\nThis is not working for input/enum/scalars yet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6978db3e67f1e50460ce5d463d290e3a59052bfa", "author": {"user": {"login": "martinbonnin", "name": "Martin Bonnin"}}, "url": "https://github.com/apollographql/apollo-android/commit/6978db3e67f1e50460ce5d463d290e3a59052bfa", "committedDate": "2020-10-28T11:13:21Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "611e1dda7ae25c121aa4fdf71ec70177637ca502", "author": {"user": {"login": "martinbonnin", "name": "Martin Bonnin"}}, "url": "https://github.com/apollographql/apollo-android/commit/611e1dda7ae25c121aa4fdf71ec70177637ca502", "committedDate": "2020-10-28T11:21:33Z", "message": "fix java test fixtures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "589ac75c2912b531c850513b1759b9bfacfefbfe", "author": {"user": {"login": "martinbonnin", "name": "Martin Bonnin"}}, "url": "https://github.com/apollographql/apollo-android/commit/589ac75c2912b531c850513b1759b9bfacfefbfe", "committedDate": "2020-10-28T13:55:49Z", "message": "fix metalava"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4159, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}