{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NTMxODY4", "number": 560, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1OToyNlrOD9tDzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1OToyNlrOD9tDzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDI3OTgzOnYy", "diffSide": "RIGHT", "path": "snomed/com.b2international.snowowl.snomed.datastore/src/com/b2international/snowowl/snomed/datastore/index/change/SnomedRepositoryPreCommitHook.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1OToyNlrOGXWuMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOTowNToxN1rOGXW9VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0MjcwNg==", "bodyText": "\u26a0\ufe0f Missing active check?", "url": "https://github.com/b2ihealthcare/snow-owl/pull/560#discussion_r427142706", "createdAt": "2020-05-19T08:59:26Z", "author": {"login": "cmark"}, "path": "snomed/com.b2international.snowowl.snomed.datastore/src/com/b2international/snowowl/snomed/datastore/index/change/SnomedRepositoryPreCommitHook.java", "diffHunk": "@@ -152,6 +153,32 @@ protected void preUpdateDocuments(StagingArea staging, RevisionSearcher index) t\n \t\t\t}\n \t\t}\n \t\t\n+\t\tstaging.getRemovedObjects(SnomedDescriptionIndexEntry.class).forEach(removedDescription -> {\n+\t\t\tif (removedDescription.isFsn() && removedDescription.isActive()) {\n+\t\t\t\tstatedSourceIds.add(removedDescription.getConceptId());\n+\t\t\t\tinferredSourceIds.add(removedDescription.getConceptId());\n+\t\t\t}\n+\t\t});\n+\t\t\n+\t\tstaging.getChangedRevisions(SnomedDescriptionIndexEntry.class, Set.of(\n+\t\t\t\tSnomedDescriptionIndexEntry.Fields.ACTIVE,\n+\t\t\t\tSnomedDescriptionIndexEntry.Fields.TERM)).forEach(diff -> {\n+\n+\t\t\tSnomedDescriptionIndexEntry newRevision = (SnomedDescriptionIndexEntry) diff.newRevision;\n+\t\t\t\n+\t\t\tif (newRevision.isFsn()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe5b83865827adfb8ea79d639832246072758b08"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0NTcwMg==", "bodyText": "A status change in either direction may result in the concept's \"official\" semantic tag changing.", "url": "https://github.com/b2ihealthcare/snow-owl/pull/560#discussion_r427145702", "createdAt": "2020-05-19T09:03:58Z", "author": {"login": "apeteri"}, "path": "snomed/com.b2international.snowowl.snomed.datastore/src/com/b2international/snowowl/snomed/datastore/index/change/SnomedRepositoryPreCommitHook.java", "diffHunk": "@@ -152,6 +153,32 @@ protected void preUpdateDocuments(StagingArea staging, RevisionSearcher index) t\n \t\t\t}\n \t\t}\n \t\t\n+\t\tstaging.getRemovedObjects(SnomedDescriptionIndexEntry.class).forEach(removedDescription -> {\n+\t\t\tif (removedDescription.isFsn() && removedDescription.isActive()) {\n+\t\t\t\tstatedSourceIds.add(removedDescription.getConceptId());\n+\t\t\t\tinferredSourceIds.add(removedDescription.getConceptId());\n+\t\t\t}\n+\t\t});\n+\t\t\n+\t\tstaging.getChangedRevisions(SnomedDescriptionIndexEntry.class, Set.of(\n+\t\t\t\tSnomedDescriptionIndexEntry.Fields.ACTIVE,\n+\t\t\t\tSnomedDescriptionIndexEntry.Fields.TERM)).forEach(diff -> {\n+\n+\t\t\tSnomedDescriptionIndexEntry newRevision = (SnomedDescriptionIndexEntry) diff.newRevision;\n+\t\t\t\n+\t\t\tif (newRevision.isFsn()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0MjcwNg=="}, "originalCommit": {"oid": "fe5b83865827adfb8ea79d639832246072758b08"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0NjU4MQ==", "bodyText": "Right, then good to go.", "url": "https://github.com/b2ihealthcare/snow-owl/pull/560#discussion_r427146581", "createdAt": "2020-05-19T09:05:17Z", "author": {"login": "cmark"}, "path": "snomed/com.b2international.snowowl.snomed.datastore/src/com/b2international/snowowl/snomed/datastore/index/change/SnomedRepositoryPreCommitHook.java", "diffHunk": "@@ -152,6 +153,32 @@ protected void preUpdateDocuments(StagingArea staging, RevisionSearcher index) t\n \t\t\t}\n \t\t}\n \t\t\n+\t\tstaging.getRemovedObjects(SnomedDescriptionIndexEntry.class).forEach(removedDescription -> {\n+\t\t\tif (removedDescription.isFsn() && removedDescription.isActive()) {\n+\t\t\t\tstatedSourceIds.add(removedDescription.getConceptId());\n+\t\t\t\tinferredSourceIds.add(removedDescription.getConceptId());\n+\t\t\t}\n+\t\t});\n+\t\t\n+\t\tstaging.getChangedRevisions(SnomedDescriptionIndexEntry.class, Set.of(\n+\t\t\t\tSnomedDescriptionIndexEntry.Fields.ACTIVE,\n+\t\t\t\tSnomedDescriptionIndexEntry.Fields.TERM)).forEach(diff -> {\n+\n+\t\t\tSnomedDescriptionIndexEntry newRevision = (SnomedDescriptionIndexEntry) diff.newRevision;\n+\t\t\t\n+\t\t\tif (newRevision.isFsn()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0MjcwNg=="}, "originalCommit": {"oid": "fe5b83865827adfb8ea79d639832246072758b08"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1753, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}