{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NjMwNTgz", "number": 303, "title": "Security", "bodyText": "", "createdAt": "2020-05-18T17:09:01Z", "url": "https://github.com/questdb/questdb/pull/303", "merged": true, "mergeCommit": {"oid": "807fa1fca181046c727801a3b52c8fa8212fb240"}, "closed": true, "closedAt": "2020-05-19T12:26:43Z", "author": {"login": "patrickSpaceSurfer"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcii-r8gH2gAyNDE5NjMwNTgzOjQ0OWIzZWMzZjExYmIzMzEwMTllN2E3NmRjOGJiMTJmMDhlODhiZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcizlamAFqTQxNDM5MTA5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "449b3ec3f11bb331019e7a76dc8bb12f08e88bfc", "author": {"user": {"login": "patrickSpaceSurfer", "name": "Patrick Mackinlay"}}, "url": "https://github.com/questdb/questdb/commit/449b3ec3f11bb331019e7a76dc8bb12f08e88bfc", "committedDate": "2020-05-18T17:04:45Z", "message": "feat(cairo): Security"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcd406053116ffea1935b3bc4e06331b25cf2e82", "author": {"user": {"login": "patrickSpaceSurfer", "name": "Patrick Mackinlay"}}, "url": "https://github.com/questdb/questdb/commit/fcd406053116ffea1935b3bc4e06331b25cf2e82", "committedDate": "2020-05-18T17:05:54Z", "message": "feat(cairo): Security"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc42575ca50be9ddda81d827b9395a85221718b4", "author": {"user": {"login": "patrickSpaceSurfer", "name": "Patrick Mackinlay"}}, "url": "https://github.com/questdb/questdb/commit/bc42575ca50be9ddda81d827b9395a85221718b4", "committedDate": "2020-05-18T17:05:54Z", "message": "feat(cairo): Security"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MzAwMzcx", "url": "https://github.com/questdb/questdb/pull/303#pullrequestreview-414300371", "createdAt": "2020-05-19T10:12:47Z", "commit": {"oid": "bc42575ca50be9ddda81d827b9395a85221718b4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDoxMjo0N1rOGXZgDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMDoxNjo1OFrOGXZpPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE4ODIzOQ==", "bodyText": "static call looks a little strange here. I was expecting something like\nsecurityContext.checkWritePermission();", "url": "https://github.com/questdb/questdb/pull/303#discussion_r427188239", "createdAt": "2020-05-19T10:12:47Z", "author": {"login": "bluestreak01"}, "path": "core/src/main/java/io/questdb/cairo/CairoEngine.java", "diffHunk": "@@ -82,6 +83,7 @@ public void creatTable(\n             Path path,\n             TableStructure struct\n     ) {\n+        CairoSecurityContext.checkWritePermission(securityContext);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc42575ca50be9ddda81d827b9395a85221718b4"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE5MDU4OQ==", "bodyText": "Generally speaking nothing in the codebase handles exceptions via Throwable. The rule of thumb when new exception is introduced a special consideration needs to be paid to how this exception is received by API users. This special consideration is missing from the PR.\nEasier way to deal with this is to reuse CairoException this is also a runtime exception and it is handled (and handling is tested)", "url": "https://github.com/questdb/questdb/pull/303#discussion_r427190589", "createdAt": "2020-05-19T10:16:58Z", "author": {"login": "bluestreak01"}, "path": "core/src/main/java/io/questdb/cairo/CairoSecurityContext.java", "diffHunk": "@@ -24,5 +24,15 @@\n \n package io.questdb.cairo;\n \n+import io.questdb.cairo.security.CairoSecurityException;\n+\n public interface CairoSecurityContext {\n+\n+    public static void checkWritePermission(CairoSecurityContext securityContext) {\n+        if (null == securityContext || !securityContext.canWrite()) {\n+            throw CairoSecurityException.instance().put(\"Write permission denied\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc42575ca50be9ddda81d827b9395a85221718b4"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ab579355203499834a2c59a79d05d10da2f0dd3", "author": {"user": {"login": "patrickSpaceSurfer", "name": "Patrick Mackinlay"}}, "url": "https://github.com/questdb/questdb/commit/8ab579355203499834a2c59a79d05d10da2f0dd3", "committedDate": "2020-05-19T10:31:34Z", "message": "feat(cairo): Security"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a63361b1481e8e0f0b9348a178a28ac34880d87", "author": {"user": {"login": "patrickSpaceSurfer", "name": "Patrick Mackinlay"}}, "url": "https://github.com/questdb/questdb/commit/9a63361b1481e8e0f0b9348a178a28ac34880d87", "committedDate": "2020-05-19T11:09:36Z", "message": "feat(cairo): Security"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MzkxMDkx", "url": "https://github.com/questdb/questdb/pull/303#pullrequestreview-414391091", "createdAt": "2020-05-19T12:25:32Z", "commit": {"oid": "9a63361b1481e8e0f0b9348a178a28ac34880d87"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3320, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}