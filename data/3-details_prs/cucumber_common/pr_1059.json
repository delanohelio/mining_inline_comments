{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NTEzMDM4", "number": 1059, "title": "Use ansi-to-html to render ANSI characters in logs", "bodyText": "Summary\nThis is linked to issue #1057 - it uses ansi-to-html to turn ANSI characters into colored text.\nA few notes:\n\nit only works with strings that have been logged using the log method. The idea its to avoid getting colorised output due to some file content for example, but that can be discussed/changed.\nI did not manage to get the TypeScript declaration from ansi-to-html, so there's a copy of their declaration file in types.d.ts- there is certainly a better way to do this but I did not find it :/\n\nDetails\n\nMotivation and Context\n\n\nHow Has This Been Tested?\nOne unit test with Mocha and also an example in storybook.\nScreenshots (if appropriate):\n\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue).\n New feature (non-breaking change which adds functionality).\n Breaking change (fix or feature that would cause existing functionality to not work as expected).\n\nChecklist:\n\n\n\n The change has been ported to Java.\n The change has been ported to Ruby.\n The change has been ported to JavaScript.\n The change has been ported to Go.\n The change has been ported to .NET.\n I've added tests for my code.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have updated the CHANGELOG accordingly.", "createdAt": "2020-06-15T12:38:17Z", "url": "https://github.com/cucumber/common/pull/1059", "merged": true, "mergeCommit": {"oid": "dbbcd84861afb869e13c7a595262c753662f8edf"}, "closed": true, "closedAt": "2020-06-18T21:51:00Z", "author": {"login": "vincent-psarga"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrf3nnAH2gAyNDM0NTEzMDM4OmE1ODNhOWRkN2NiOGMwOTk0ZTQ1NTgzYjVlNmY3ZjU4ZjQzNTdjMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcshVk1gH2gAyNDM0NTEzMDM4OjU2NDljYmNlNGVkYTk1OTgxMWFlNWEyNTRiOWY3N2VmODU2YWY1MDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a583a9dd7cb8c0994e45583b5e6f7f58f4357c22", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/a583a9dd7cb8c0994e45583b5e6f7f58f4357c22", "committedDate": "2020-06-15T12:32:38Z", "message": "Use ansi-to-html to render ansi characters in logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3a934c9ba893605ba987bb122c7b12ed0e40837", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/c3a934c9ba893605ba987bb122c7b12ed0e40837", "committedDate": "2020-06-16T06:39:36Z", "message": "Merge branch 'master' into 1057-use-ansi-to-html-in-react"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dd8bc18c36e8d0afc0278716f38751da7cc27a3", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/1dd8bc18c36e8d0afc0278716f38751da7cc27a3", "committedDate": "2020-06-16T07:07:49Z", "message": "Remove types.d.ts and use ts-ignore instead"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c2c4a5fed584bbfdfa5b22509141c911dd88c1f", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/6c2c4a5fed584bbfdfa5b22509141c911dd88c1f", "committedDate": "2020-06-16T07:16:23Z", "message": "Less code-duplication"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8f73c886734ab70584874d387f6a4355238e91d", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/a8f73c886734ab70584874d387f6a4355238e91d", "committedDate": "2020-06-16T07:19:09Z", "message": "CCK makefile cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxMjIzMDY5", "url": "https://github.com/cucumber/common/pull/1059#pullrequestreview-431223069", "createdAt": "2020-06-16T07:18:30Z", "commit": {"oid": "6c2c4a5fed584bbfdfa5b22509141c911dd88c1f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwNzoxODozMVrOGkOTnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwNzoxODozMVrOGkOTnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDYzNjMxNw==", "bodyText": "Can we change this from prettyJSON() to prettyJSON like I had done in my PR?", "url": "https://github.com/cucumber/common/pull/1059#discussion_r440636317", "createdAt": "2020-06-16T07:18:31Z", "author": {"login": "aslakhellesoy"}, "path": "react/javascript/src/components/gherkin/Attachment.tsx", "diffHunk": "@@ -13,10 +15,12 @@ const Attachment: React.FunctionComponent<IProps> = ({ attachment }) => {\n     return image(attachment)\n   } else if (attachment.mediaType.match(/^video\\//)) {\n     return video(attachment)\n+  } else if (attachment.mediaType == 'text/x.cucumber.log+plain') {\n+    return text(attachment, prettyANSI, true)\n   } else if (attachment.mediaType.match(/^text\\//)) {\n-    return text(attachment, (s) => s)\n+    return text(attachment, (s) => s, false)\n   } else if (attachment.mediaType.match(/^application\\/json/)) {\n-    return text(attachment, prettyJSON())\n+    return text(attachment, prettyJSON(), false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c2c4a5fed584bbfdfa5b22509141c911dd88c1f"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be10df86865a863ed25898f3a0d7c959750bd6cc", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/be10df86865a863ed25898f3a0d7c959750bd6cc", "committedDate": "2020-06-16T07:26:46Z", "message": "Add ANSI example in CCK - regenerate golden NDJSONs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "982644b76d8deb75197483e04cd97e02c994275e", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/982644b76d8deb75197483e04cd97e02c994275e", "committedDate": "2020-06-16T07:29:20Z", "message": "Do not wrap prettyJSON"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "adfc34ff9f3760c2b50f06bb36f6fcbe30c60e37", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/adfc34ff9f3760c2b50f06bb36f6fcbe30c60e37", "committedDate": "2020-06-16T07:43:33Z", "message": "Update Ruby CCK steps"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "546f9e734871e473fe8e816f50bf217ec1414b6f", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/546f9e734871e473fe8e816f50bf217ec1414b6f", "committedDate": "2020-06-16T07:46:10Z", "message": "Correctly output the ansi character in cck/ruby"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "176dc625d8928d28b98e387c6c2479aadcc1cb58", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/176dc625d8928d28b98e387c6c2479aadcc1cb58", "committedDate": "2020-06-16T07:48:23Z", "message": "Merge branch 'master' into 1057-use-ansi-to-html-in-react"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1ede749feaeb05000fc3acd4057cd9847ab20a1", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/d1ede749feaeb05000fc3acd4057cd9847ab20a1", "committedDate": "2020-06-16T23:13:40Z", "message": "Merge branch 'master' into 1057-use-ansi-to-html-in-react"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5649cbce4eda959811ae5a254b9f77ef856af500", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/5649cbce4eda959811ae5a254b9f77ef856af500", "committedDate": "2020-06-18T16:49:11Z", "message": "Merge branch 'master' into 1057-use-ansi-to-html-in-react"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3052, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}