{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNTEzNTUy", "number": 1280, "title": "Verify HTML reports with puppeteer", "bodyText": "This automates the verification of generated HTML reports by rendering them with puppeteer. If the rendering fails, the build fails.\nIn order to make it pass I also had to downgrade to webpack 4 - not sure what's up with webpack 5.", "createdAt": "2020-12-18T12:27:08Z", "url": "https://github.com/cucumber/common/pull/1280", "merged": true, "mergeCommit": {"oid": "ede96324c1c1c218c20e4f2d239295bcfb3b9e40"}, "closed": true, "closedAt": "2020-12-18T16:15:55Z", "author": {"login": "aslakhellesoy"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnGbfEAH2gAyNTQyNTEzNTUyOjBiNTNkOGMyMTA2NGM3MDBiNTM5ZGIwZThiNjA4NGYxYTkxMGVlYzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnaTkJgFqTU1NTYxMTg2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0b53d8c21064c700b539db0e8b6084f1a910eec0", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/0b53d8c21064c700b539db0e8b6084f1a910eec0", "committedDate": "2020-12-17T16:49:44Z", "message": "Release html-formatter v11.0.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae5b3a77ad93844f049376205262cf24aa9136dd", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/ae5b3a77ad93844f049376205262cf24aa9136dd", "committedDate": "2020-12-17T21:53:54Z", "message": "Downgrade from webpack 5 to 4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "992717249d00641768825daf5af807b78bd09e53", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/992717249d00641768825daf5af807b78bd09e53", "committedDate": "2020-12-18T12:24:25Z", "message": "Check all generated HTML files with puppeteer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "790c061866ffe2b2ae3b1eec3230db59e45bf60d", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/790c061866ffe2b2ae3b1eec3230db59e45bf60d", "committedDate": "2020-12-18T12:28:18Z", "message": "Change references"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b243e28ffed2cdfc6b990519a938f1099daac832", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/b243e28ffed2cdfc6b990519a938f1099daac832", "committedDate": "2020-12-18T12:49:57Z", "message": "Capture puppeteer errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NDU3MjIy", "url": "https://github.com/cucumber/common/pull/1280#pullrequestreview-555457222", "createdAt": "2020-12-18T12:47:35Z", "commit": {"oid": "790c061866ffe2b2ae3b1eec3230db59e45bf60d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjo0NzozNVrOIIhj6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjo0OTozN1rOIIhoKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgwOTM4Nw==", "bodyText": "What purpose does the PDF generation serve?", "url": "https://github.com/cucumber/common/pull/1280#discussion_r545809387", "createdAt": "2020-12-18T12:47:35Z", "author": {"login": "davidjgoss"}, "path": "html-formatter/javascript/check.js", "diffHunk": "@@ -0,0 +1,22 @@\n+const fs = require('fs')\n+const path = process.argv[2]\n+const html = fs.readFileSync(path, 'utf-8')\n+const puppeteer = require('puppeteer');\n+\n+(async () => {\n+  const browser = await puppeteer.launch();\n+  const page = await browser.newPage();\n+  await page.setContent(html)\n+  await page.pdf({path: 'hn.pdf', format: 'A4'});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "790c061866ffe2b2ae3b1eec3230db59e45bf60d"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgxMDQ3Mw==", "bodyText": "Not sure if there could be errors in lower components (e.g. markdown) but the root one still render enough for this to pass?\nTo solve a similar problem before I've queried the console for errors - I could always do a follow up if you think it's a good idea.", "url": "https://github.com/cucumber/common/pull/1280#discussion_r545810473", "createdAt": "2020-12-18T12:49:37Z", "author": {"login": "davidjgoss"}, "path": "html-formatter/javascript/check.js", "diffHunk": "@@ -0,0 +1,22 @@\n+const fs = require('fs')\n+const path = process.argv[2]\n+const html = fs.readFileSync(path, 'utf-8')\n+const puppeteer = require('puppeteer');\n+\n+(async () => {\n+  const browser = await puppeteer.launch();\n+  const page = await browser.newPage();\n+  await page.setContent(html)\n+  await page.pdf({path: 'hn.pdf', format: 'A4'});\n+  const dynamicHTML = await page.evaluate(() => {\n+    const content = document.querySelector('.cucumber-react')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "790c061866ffe2b2ae3b1eec3230db59e45bf60d"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b09797d94562bfe756a4426f3c35c773f3ce7e31", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/b09797d94562bfe756a4426f3c35c773f3ce7e31", "committedDate": "2020-12-18T12:53:48Z", "message": "Remove pdf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97e254739e946c352ea529758a08d87cb5905d8d", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/97e254739e946c352ea529758a08d87cb5905d8d", "committedDate": "2020-12-18T13:10:40Z", "message": "Tweak puppeteer environment and settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e4a2b129a7592057a7d49b94a583247eddb8492", "author": {"user": {"login": "aslakhellesoy", "name": "Aslak Helles\u00f8y"}}, "url": "https://github.com/cucumber/common/commit/9e4a2b129a7592057a7d49b94a583247eddb8492", "committedDate": "2020-12-18T15:35:27Z", "message": "Only do integrity check when package.json points to released modules"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NjExODYw", "url": "https://github.com/cucumber/common/pull/1280#pullrequestreview-555611860", "createdAt": "2020-12-18T15:59:11Z", "commit": {"oid": "9e4a2b129a7592057a7d49b94a583247eddb8492"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3002, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}