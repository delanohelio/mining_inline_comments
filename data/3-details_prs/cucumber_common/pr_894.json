{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMjQxOTAw", "number": 894, "title": "Handle output in json-formatter", "bodyText": "Summary\nJSON formatter currently does not handle output field in the  generated json files. This field is populated in the steps by calling puts(in Ruby, there must be equivalents elsewhere).\nThe idea here is to use a specific attachment type (text/output) which won't end up in the attachments.\nOf course we should not ask the users to handle the output type themselves, but we should add this in the various cucumber flavours.\nFor example, in cucumber-ruby, we could have this the messages formatter:\n      def puts(message)\n        embed(message, 'text/output')\n      end\nI'm not 100% sure of the way to use attachments for output, so any better idea is more than welcome :)\nDetails\n\nMotivation and Context\n\n\nHow Has This Been Tested?\n\n\n\n\nScreenshots (if appropriate):\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue).\n New feature (non-breaking change which adds functionality).\n Breaking change (fix or feature that would cause existing functionality to not work as expected).\n\nChecklist:\n\n\n\n The change has been ported to Java.\n The change has been ported to Ruby.\n The change has been ported to JavaScript.\n The change has been ported to Go.\n The change has been ported to .NET.\n I've added tests for my code.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n I have updated the CHANGELOG accordingly.", "createdAt": "2020-02-10T16:49:57Z", "url": "https://github.com/cucumber/common/pull/894", "merged": true, "mergeCommit": {"oid": "1c427551710c911092413eadbf22c46cbdd93f7a"}, "closed": true, "closedAt": "2020-02-21T13:32:22Z", "author": {"login": "vincent-psarga"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcC_cG1gH2gAyMzczMjQxOTAwOmJmZTdiYmU3ZGRlYTgwNDRlMWNmMTNkNzY0OTQzZDJlZWMyYTc1ZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGfhVtAH2gAyMzczMjQxOTAwOjhhY2QwMzMyZTk1MzcyYTc0YzllZTU3MmNiMTQ4NjE2MDk2NDVkZjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bfe7bbe7ddea8044e1cf13d764943d2eec2a75e3", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/bfe7bbe7ddea8044e1cf13d764943d2eec2a75e3", "committedDate": "2020-02-10T16:08:39Z", "message": "Add feature file showing how output is handled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6799539c45adcec48a1547af606beb2c51ca5f0f", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/6799539c45adcec48a1547af606beb2c51ca5f0f", "committedDate": "2020-02-10T16:25:08Z", "message": "json-formatter: ensure JS ndjson are regenerated when changing step definitions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "303a49e81af9884a18d1497817be72cf44078eb9", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/303a49e81af9884a18d1497817be72cf44078eb9", "committedDate": "2020-02-10T16:44:30Z", "message": "json-formatyter: handle attachments with type text/output as outputs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a05af1fa82b3d7fce68b95d281fd8b3ada557c8", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/4a05af1fa82b3d7fce68b95d281fd8b3ada557c8", "committedDate": "2020-02-10T16:51:41Z", "message": "Use proper name for variables"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MzQzNTQ4", "url": "https://github.com/cucumber/common/pull/894#pullrequestreview-356343548", "createdAt": "2020-02-10T23:39:06Z", "commit": {"oid": "4a05af1fa82b3d7fce68b95d281fd8b3ada557c8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMzozOTowNlrOFn5jow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMzozOTowNlrOFn5jow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM4MTc5NQ==", "bodyText": "text/output is not a valid media type. It should be text/plain. Alternatively, it should be an extension - I suggest text/x.cucumber.output+plain.", "url": "https://github.com/cucumber/common/pull/894#discussion_r377381795", "createdAt": "2020-02-10T23:39:06Z", "author": {"login": "aslakhellesoy"}, "path": "json-formatter/javascript/features/step_definitions/steps.ts", "diffHunk": "@@ -8,6 +8,10 @@ Given('a passed {word} with text attachment {string}', function(word: string, at\n   this.attach(attachmentText, 'text/plain')\n })\n \n+Given('a step outputs:', function(txt: string) {\n+  this.attach(txt, 'text/output')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a05af1fa82b3d7fce68b95d281fd8b3ada557c8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9145e7627bb1a67f0074ddc122cc77a018bf547", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/d9145e7627bb1a67f0074ddc122cc77a018bf547", "committedDate": "2020-02-11T10:36:59Z", "message": "Use a better media type for output attachments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3322fee436bbc4da5061cc25875e0d6ffb4f2723", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/3322fee436bbc4da5061cc25875e0d6ffb4f2723", "committedDate": "2020-02-11T10:49:16Z", "message": "fake-cucumber: added a `log` function to World which will add specific attachments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd2958d38834739e9c4372a1a135f39f413f4939", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/bd2958d38834739e9c4372a1a135f39f413f4939", "committedDate": "2020-02-12T13:21:44Z", "message": "Use media-type \"text/x.cucumber.log+plain\" for attachments (instead of \"text/x.cucumber.output+plain\")"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8a0db4fbf3d79dcd92b15cd8f97aadecd8da3c2", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/f8a0db4fbf3d79dcd92b15cd8f97aadecd8da3c2", "committedDate": "2020-02-21T10:49:31Z", "message": "Merge branch 'master' into json-formatter-handle-text-attachments-as-output"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8acd0332e95372a74c9ee572cb14861609645df5", "author": {"user": {"login": "vincent-psarga", "name": "Vincent"}}, "url": "https://github.com/cucumber/common/commit/8acd0332e95372a74c9ee572cb14861609645df5", "committedDate": "2020-02-21T13:13:06Z", "message": "Update changelog"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3069, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}