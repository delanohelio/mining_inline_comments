{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NjYzNDE2", "number": 880, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNzoyNDowM1rOE-wjzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNzoyNDowM1rOE-wjzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MjQyNzY1OnYy", "diffSide": "RIGHT", "path": "smallrye-reactive-messaging-kafka/src/main/java/io/smallrye/reactive/messaging/kafka/fault/KafkaDeadLetterQueue.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNzoyNDowM1rOH8FltQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwOToxNDoyOVrOH8ftNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc2ODE4MQ==", "bodyText": "We can introduce huge string creation and even invalid strings\nCan you switch to:\nrecord.getHeaders().forEach(header -> dead.addHeader(KafkaHeader.header(header.key(), Buffer.buffer(header.value()))));", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/880#discussion_r532768181", "createdAt": "2020-11-30T17:24:03Z", "author": {"login": "cescoffier"}, "path": "smallrye-reactive-messaging-kafka/src/main/java/io/smallrye/reactive/messaging/kafka/fault/KafkaDeadLetterQueue.java", "diffHunk": "@@ -102,6 +102,7 @@ private String getThrowableMessage(Throwable throwable) {\n         dead.addHeader(DEAD_LETTER_TOPIC, record.getTopic());\n         dead.addHeader(DEAD_LETTER_PARTITION, Integer.toString(record.getPartition()));\n         dead.addHeader(DEAD_LETTER_OFFSET, Long.toString(record.getOffset()));\n+        record.getHeaders().forEach(header -> dead.addHeader(header.key(), new String(header.value())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "673d74edb09b773137b80371f6bd19aa9aad557c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE5NjA4Ng==", "bodyText": "done", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/880#discussion_r533196086", "createdAt": "2020-12-01T09:14:29Z", "author": {"login": "loicmathieu"}, "path": "smallrye-reactive-messaging-kafka/src/main/java/io/smallrye/reactive/messaging/kafka/fault/KafkaDeadLetterQueue.java", "diffHunk": "@@ -102,6 +102,7 @@ private String getThrowableMessage(Throwable throwable) {\n         dead.addHeader(DEAD_LETTER_TOPIC, record.getTopic());\n         dead.addHeader(DEAD_LETTER_PARTITION, Integer.toString(record.getPartition()));\n         dead.addHeader(DEAD_LETTER_OFFSET, Long.toString(record.getOffset()));\n+        record.getHeaders().forEach(header -> dead.addHeader(header.key(), new String(header.value())));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc2ODE4MQ=="}, "originalCommit": {"oid": "673d74edb09b773137b80371f6bd19aa9aad557c"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 21, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}