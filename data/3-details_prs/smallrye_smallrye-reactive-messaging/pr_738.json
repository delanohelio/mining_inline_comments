{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2ODAzMjk5", "number": 738, "title": "Introduce Message Converters", "bodyText": "This PR is a replacement for the metadata injection support (#726).\nThe main use case for metadata injection was to access technical metadata from method accepting payload only.\nWhile functional, the API was not great, and it removes a few \"type\" check making error detection most complicated.\nMessageConverter takes the problem from the opposite direction.\nIt allows converting a message into another message, generally to change the type of payload.\nFor example, a converter can transform a message coming from Kafka to a KafkaRecord, which means that the user can access the key directly.\nA converter is a simple bean implementing an interface.\nThen, reactive messaging looks for the right converter if needed and invoke it for each transiting message.\nFor the user, it's transparent, the converter being called to transform the incoming message into the expected type.", "createdAt": "2020-09-14T18:30:39Z", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/738", "merged": true, "mergeCommit": {"oid": "18839a947f57bbe35b485e3fae89b8d3245d74aa"}, "closed": true, "closedAt": "2020-09-16T14:16:00Z", "author": {"login": "cescoffier"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI4K6dAFqTQ4ODA2MDk2Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJHz74gBqjM3NjgzNDY1MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MDYwOTYz", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/738#pullrequestreview-488060963", "createdAt": "2020-09-14T19:04:37Z", "commit": {"oid": "41a3ed332d9e1b07013cc4931d1c7c1e818d479c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxOTowNDozN1rOHRivXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxOTowNDozN1rOHRivXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NzAyMg==", "bodyText": "accept is quite overloaded.\nMaybe canConvert? or isConvertible? or handles?", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/738#discussion_r488157022", "createdAt": "2020-09-14T19:04:37Z", "author": {"login": "kenfinnigan"}, "path": "api/src/main/java/io/smallrye/reactive/messaging/MessageConverter.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package io.smallrye.reactive.messaging;\n+\n+import java.lang.reflect.Type;\n+\n+import org.eclipse.microprofile.reactive.messaging.Message;\n+\n+/**\n+ * Converter transforming {@code Message<A>} into {@code Message<B>}.\n+ * To register a converter, expose a, generally {@code ApplicationScoped} bean, implementing this interface.\n+ */\n+public interface MessageConverter {\n+\n+    /**\n+     * Checks whether this instance of converter can convert the given message {@code in} into a {@code Message<T>} with\n+     * {@code T} being the type represented by {@code target}.\n+     *\n+     * @param in the input message, not {@code null}\n+     * @param target the target type, generally the type ingested by a method\n+     * @return {@code true} if the conversion is possible, {@code false} otherwise.\n+     */\n+    boolean accept(Message<?> in, Type target);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41a3ed332d9e1b07013cc4931d1c7c1e818d479c"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "41a3ed332d9e1b07013cc4931d1c7c1e818d479c", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/41a3ed332d9e1b07013cc4931d1c7c1e818d479c", "committedDate": "2020-09-14T18:51:01Z", "message": "Avoid unnecessary conversions."}, "afterCommit": {"oid": "ed86fd9c91b262b99c34f604ed6dc3f93e2e9d53", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/ed86fd9c91b262b99c34f604ed6dc3f93e2e9d53", "committedDate": "2020-09-15T08:51:25Z", "message": "Add support for converter priority"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NjM1Mzcy", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/738#pullrequestreview-488635372", "createdAt": "2020-09-15T12:37:09Z", "commit": {"oid": "ba5c1628a35ead5ce0720b39bb0070f5d2fe7ef5"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8db0d68d976f8d3ac7098767f627f3f50e9e556a", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/8db0d68d976f8d3ac7098767f627f3f50e9e556a", "committedDate": "2020-09-15T13:28:21Z", "message": "Extract ingested payload type."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70da2801ffaa89839f164f57e714a92c5142a058", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/70da2801ffaa89839f164f57e714a92c5142a058", "committedDate": "2020-09-15T13:28:23Z", "message": "Define MessageConverter and introduce these converters in the weaving."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9cf02cc9cc2bbad0c8e042b55c24b7e2e727513", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/c9cf02cc9cc2bbad0c8e042b55c24b7e2e727513", "committedDate": "2020-09-15T13:28:23Z", "message": "Avoid unnecessary conversions."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33f66c376f15eb4f44f00e82959db39a1cb90e7d", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/33f66c376f15eb4f44f00e82959db39a1cb90e7d", "committedDate": "2020-09-15T13:28:23Z", "message": "Add support for converter priority"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ad6a21ae104b5ce94bb4dd454f6c56e424473ec", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/7ad6a21ae104b5ce94bb4dd454f6c56e424473ec", "committedDate": "2020-09-15T13:28:23Z", "message": "Document message converters"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba5c1628a35ead5ce0720b39bb0070f5d2fe7ef5", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/ba5c1628a35ead5ce0720b39bb0070f5d2fe7ef5", "committedDate": "2020-09-15T11:41:33Z", "message": "Document message converters"}, "afterCommit": {"oid": "7ad6a21ae104b5ce94bb4dd454f6c56e424473ec", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/7ad6a21ae104b5ce94bb4dd454f6c56e424473ec", "committedDate": "2020-09-15T13:28:23Z", "message": "Document message converters"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2261, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}