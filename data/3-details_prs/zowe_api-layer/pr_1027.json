{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNjU0OTEw", "number": 1027, "title": " Checking SAF resource via REST endpoint", "bodyText": "Signed-off-by: Pavel Jare\u0161 pavel.jares@broadcom.com\nDescription\nThis PR extends PR #1025 for checking SAF resource via REST endpoint (ie. ZSS). The PR should be merged into master before this one.\nFixes # (issue)\nType of change\n\n New feature (non-breaking change which adds functionality)\n\nChecklist:\n\n My code follows the style guidelines of this project\n I have performed a self-review of my own code\n I have commented my code, particularly in hard-to-understand areas\n My changes generate no new warnings\n I have added tests that prove my fix is effective or that my feature works\n New and existing unit tests pass locally with my changes\n\nFor more details about how should the code look like read the Contributing guideline", "createdAt": "2020-12-18T16:40:10Z", "url": "https://github.com/zowe/api-layer/pull/1027", "merged": true, "mergeCommit": {"oid": "cded12312e8658fc88f511e19c598df159050422"}, "closed": true, "closedAt": "2021-01-04T08:11:04Z", "author": {"login": "pj892031"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnaxcQgH2gAyNTQyNjU0OTEwOmU4ZDg0NTBkYzkxNWMxNTIzYjFjYTRkNzViNTkwMDc1OThmMzRmY2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdsxo6GAH2gAyNTQyNjU0OTEwOjg4MzdjZmNkOWE5MTRhN2NlNmI3NjY1NDgyNzNmMGEzZWRjMzA2NDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e8d8450dc915c1523b1ca4d75b59007598f34fcd", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/e8d8450dc915c1523b1ca4d75b59007598f34fcd", "committedDate": "2020-12-18T16:31:49Z", "message": " EndpointVerifier\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64b160b8529f4c1d60f969bebf7df33d455b2903", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/64b160b8529f4c1d60f969bebf7df33d455b2903", "committedDate": "2020-12-22T12:52:52Z", "message": "Merge branch 'master' into protectors/endpointVerifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8c5a5901b409b54d850824d111becdf3dfc793f", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/f8c5a5901b409b54d850824d111becdf3dfc793f", "committedDate": "2020-12-22T23:36:41Z", "message": "Merge branch 'master' into protectors/endpointVerifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "882551183f3625129ea2ee2cc1b9f11399814570", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/882551183f3625129ea2ee2cc1b9f11399814570", "committedDate": "2020-12-22T23:51:45Z", "message": "fix merge\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/5c06a229b802ca56dd5e0b94f277b231b944a74d", "committedDate": "2020-12-23T00:08:29Z", "message": "sonar suppress warning\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzMxMjU2", "url": "https://github.com/zowe/api-layer/pull/1027#pullrequestreview-557731256", "createdAt": "2020-12-23T09:00:53Z", "commit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowMDo1M1rOIKc2eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowMDo1M1rOIKc2eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgyOTM3MA==", "bodyText": "Does it make sense to use conditional @configuration instead?", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547829370", "createdAt": "2020-12-23T09:00:53Z", "author": {"login": "JirkaAichler"}, "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessConfig.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.web.client.RestTemplate;\n+\n+import java.io.IOException;\n+\n+@Configuration\n+@Slf4j\n+public class SafResourceAccessConfig {\n+\n+    @Value(\"${apiml.security.safEndpoint.enabled:false}\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzMyNDgx", "url": "https://github.com/zowe/api-layer/pull/1027#pullrequestreview-557732481", "createdAt": "2020-12-23T09:03:05Z", "commit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowMzowNVrOIKc9zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowMzowNVrOIKc9zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzMTI0NA==", "bodyText": "You don't need to suppress it when you name your constant with URL instead of `PATH'.", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547831244", "createdAt": "2020-12-23T09:03:05Z", "author": {"login": "JirkaAichler"}, "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessEndpoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.RequiredArgsConstructor;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.web.client.RestTemplate;\n+\n+@RequiredArgsConstructor\n+public class SafResourceAccessEndpoint implements SafResourceAccessVerifying {\n+\n+    @SuppressWarnings(\"squid:S1075\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzM1MDY0", "url": "https://github.com/zowe/api-layer/pull/1027#pullrequestreview-557735064", "createdAt": "2020-12-23T09:07:38Z", "commit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowNzozOFrOIKdNYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowNzozOFrOIKdNYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzNTIzNA==", "bodyText": "Shouldn't you set some default value to make sure that it is not null or empty? Can you obtain it from Zowe installation so it does not have to be configured manually?", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547835234", "createdAt": "2020-12-23T09:07:38Z", "author": {"login": "JirkaAichler"}, "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessEndpoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.RequiredArgsConstructor;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.web.client.RestTemplate;\n+\n+@RequiredArgsConstructor\n+public class SafResourceAccessEndpoint implements SafResourceAccessVerifying {\n+\n+    @SuppressWarnings(\"squid:S1075\")\n+    private static final String PATH_VRIABLE_SUFFIX = \"/{userId}/{class}/{entity}/{level}\";\n+\n+    @Value(\"${apiml.security.safEndpoint.url}\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzM2MjM1", "url": "https://github.com/zowe/api-layer/pull/1027#pullrequestreview-557736235", "createdAt": "2020-12-23T09:09:48Z", "commit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowOTo0OFrOIKdU3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTowOTo0OFrOIKdU3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzNzE1MQ==", "bodyText": "I am lazy to check the code myself so I am just asking. Is it protected by HTTPS? I somehow thought there are multiple RestTemplate beans.", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547837151", "createdAt": "2020-12-23T09:09:48Z", "author": {"login": "JirkaAichler"}, "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessEndpoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.RequiredArgsConstructor;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.web.client.RestTemplate;\n+\n+@RequiredArgsConstructor\n+public class SafResourceAccessEndpoint implements SafResourceAccessVerifying {\n+\n+    @SuppressWarnings(\"squid:S1075\")\n+    private static final String PATH_VRIABLE_SUFFIX = \"/{userId}/{class}/{entity}/{level}\";\n+\n+    @Value(\"${apiml.security.safEndpoint.url}\")\n+    private String endpointUrl;\n+\n+    private final RestTemplate restTemplate;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "219bd0c3e0a5f3338b972811dd0234b33dad3b6b", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/219bd0c3e0a5f3338b972811dd0234b33dad3b6b", "committedDate": "2020-12-31T12:59:40Z", "message": "Merge branch 'master' into protectors/endpointVerifier\n\n# Conflicts:\n#\tapiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessConfig.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acb9c646b60342f348b97349c05408952f23b89a", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/acb9c646b60342f348b97349c05408952f23b89a", "committedDate": "2020-12-31T13:13:14Z", "message": "fix null pointer sonar bug\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMzU1NTY0", "url": "https://github.com/zowe/api-layer/pull/1027#pullrequestreview-560355564", "createdAt": "2020-12-31T13:57:21Z", "commit": {"oid": "acb9c646b60342f348b97349c05408952f23b89a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eba44051e504ca445303b62629c673299ab53980", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/eba44051e504ca445303b62629c673299ab53980", "committedDate": "2020-12-31T14:14:34Z", "message": "Merge branch 'master' into protectors/endpointVerifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce0c419aa63fafd1f0a98f9c7a26c164f6f06525", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/ce0c419aa63fafd1f0a98f9c7a26c164f6f06525", "committedDate": "2021-01-04T07:49:17Z", "message": "attempt to fix default value and sonar issue\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8837cfcd9a914a7ce6b766548273f0a3edc30648", "author": {"user": {"login": "pj892031", "name": "Pavel Jare\u0161"}}, "url": "https://github.com/zowe/api-layer/commit/8837cfcd9a914a7ce6b766548273f0a3edc30648", "committedDate": "2021-01-04T07:59:56Z", "message": "Merge branch 'master' into protectors/endpointVerifier"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4797, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}