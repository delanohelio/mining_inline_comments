{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0NjQyNTAy", "number": 805, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzozNzoxMVrOEdOdcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzozNzoxMVrOEdOdcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MDgxMDc1OnYy", "diffSide": "RIGHT", "path": "zaas-client/src/main/java/org/zowe/apiml/zaasclient/service/internal/HttpsClientProvider.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzozNzoxMVrOHIQu1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzo1Nzo0MFrOHIRouQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQyNDc4OQ==", "bodyText": "There is a TODO left. Beside that, it looks fine", "url": "https://github.com/zowe/api-layer/pull/805#discussion_r478424789", "createdAt": "2020-08-27T13:37:11Z", "author": {"login": "taban03"}, "path": "zaas-client/src/main/java/org/zowe/apiml/zaasclient/service/internal/HttpsClientProvider.java", "diffHunk": "@@ -58,30 +63,30 @@ public HttpsClientProvider(ConfigProperties configProperties) throws ZaasConfigu\n     }\n \n     @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .build();\n-    }\n-\n-    @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore(BasicCookieStore cookieStore) throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .setDefaultCookieStore(cookieStore)\n-            .build();\n+    public synchronized CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n+        if (httpsClientWithTruststore == null) {\n+            httpsClientWithTruststore = sharedHttpClientConfiguration(getSSLContext())\n+                .build();\n+        }\n+        return httpsClientWithTruststore;\n     }\n \n+    //TODO how is this working compared to the other method to get the client?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "025351768cc310c1b379e9abd6e0d58cb0e7e17d"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQyNzUyOA==", "bodyText": "Yes, i left that TODO intentionally so it's not forgotten. I will address it with additional tests, but not in this PR. It does not have anything to do with performance. It's just the way the client is built which seems incorrect.", "url": "https://github.com/zowe/api-layer/pull/805#discussion_r478427528", "createdAt": "2020-08-27T13:41:08Z", "author": {"login": "jandadav"}, "path": "zaas-client/src/main/java/org/zowe/apiml/zaasclient/service/internal/HttpsClientProvider.java", "diffHunk": "@@ -58,30 +63,30 @@ public HttpsClientProvider(ConfigProperties configProperties) throws ZaasConfigu\n     }\n \n     @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .build();\n-    }\n-\n-    @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore(BasicCookieStore cookieStore) throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .setDefaultCookieStore(cookieStore)\n-            .build();\n+    public synchronized CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n+        if (httpsClientWithTruststore == null) {\n+            httpsClientWithTruststore = sharedHttpClientConfiguration(getSSLContext())\n+                .build();\n+        }\n+        return httpsClientWithTruststore;\n     }\n \n+    //TODO how is this working compared to the other method to get the client?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQyNDc4OQ=="}, "originalCommit": {"oid": "025351768cc310c1b379e9abd6e0d58cb0e7e17d"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQzNTQyMg==", "bodyText": "If you agree, i'd keep it in and it will be removed later when i manage to verify if it's a problem. So far the code works, so i did not change it.", "url": "https://github.com/zowe/api-layer/pull/805#discussion_r478435422", "createdAt": "2020-08-27T13:52:01Z", "author": {"login": "jandadav"}, "path": "zaas-client/src/main/java/org/zowe/apiml/zaasclient/service/internal/HttpsClientProvider.java", "diffHunk": "@@ -58,30 +63,30 @@ public HttpsClientProvider(ConfigProperties configProperties) throws ZaasConfigu\n     }\n \n     @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .build();\n-    }\n-\n-    @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore(BasicCookieStore cookieStore) throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .setDefaultCookieStore(cookieStore)\n-            .build();\n+    public synchronized CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n+        if (httpsClientWithTruststore == null) {\n+            httpsClientWithTruststore = sharedHttpClientConfiguration(getSSLContext())\n+                .build();\n+        }\n+        return httpsClientWithTruststore;\n     }\n \n+    //TODO how is this working compared to the other method to get the client?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQyNDc4OQ=="}, "originalCommit": {"oid": "025351768cc310c1b379e9abd6e0d58cb0e7e17d"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQzOTYwOQ==", "bodyText": "I'm ok with that.", "url": "https://github.com/zowe/api-layer/pull/805#discussion_r478439609", "createdAt": "2020-08-27T13:57:40Z", "author": {"login": "taban03"}, "path": "zaas-client/src/main/java/org/zowe/apiml/zaasclient/service/internal/HttpsClientProvider.java", "diffHunk": "@@ -58,30 +63,30 @@ public HttpsClientProvider(ConfigProperties configProperties) throws ZaasConfigu\n     }\n \n     @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .build();\n-    }\n-\n-    @Override\n-    public CloseableHttpClient getHttpsClientWithTrustStore(BasicCookieStore cookieStore) throws ZaasConfigurationException {\n-        return sharedHttpClientConfiguration(getSSLContext())\n-            .setDefaultCookieStore(cookieStore)\n-            .build();\n+    public synchronized CloseableHttpClient getHttpsClientWithTrustStore() throws ZaasConfigurationException {\n+        if (httpsClientWithTruststore == null) {\n+            httpsClientWithTruststore = sharedHttpClientConfiguration(getSSLContext())\n+                .build();\n+        }\n+        return httpsClientWithTruststore;\n     }\n \n+    //TODO how is this working compared to the other method to get the client?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQyNDc4OQ=="}, "originalCommit": {"oid": "025351768cc310c1b379e9abd6e0d58cb0e7e17d"}, "originalPosition": 52}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 485, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}