{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NDIzMTEy", "number": 762, "title": "Create ApiMediationClient.isRegistered Interface", "bodyText": "Description\nCreates ApiMediationClient.isRegistered method that allows for extending code to test for successful registration with the Discovery Service.\nFixes #307\nType of change\nPlease delete options that are not relevant.\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to not work as expected)\n This change requires a documentation update\n\nChecklist:\n\n My code follows the style guidelines of this project\n I have performed a self-review of my own code\n I have commented my code, particularly in hard-to-understand areas\n[ x My changes generate no new warnings\n I have added tests that prove my fix is effective or that my feature works\n New and existing unit tests pass locally with my changes\n\nFor more details about how should the code look like read the Contributing guideline", "createdAt": "2020-07-24T18:14:46Z", "url": "https://github.com/zowe/api-layer/pull/762", "merged": true, "mergeCommit": {"oid": "124376c984406e439ea16f7a08c02d990d42cac1"}, "closed": true, "closedAt": "2020-08-03T07:34:37Z", "author": {"login": "CarsonCook"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3unF9gH2gAyNDU2NDIzMTEyOmNkYzlhNWQ1YTFkOGY2YzAzMGQxMDIxZTU2ZTNkZGMyYmM0YTI3MzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7M99WgFqTQ1OTgwNzQyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cdc9a5d5a1d8f6c030d1021e56e3ddc2bc4a2734", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/cdc9a5d5a1d8f6c030d1021e56e3ddc2bc4a2734", "committedDate": "2020-07-23T12:30:15Z", "message": "Create ApiMediationClient.isRegistered\n\nUses EurekaClient.getInstanceRemoteStatus to test for registration with the Discovery Service.\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05d5aded89c0bd7f6ff919fddb5b5f1f13146bbd", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/05d5aded89c0bd7f6ff919fddb5b5f1f13146bbd", "committedDate": "2020-07-24T15:08:23Z", "message": "Create test API endpoint in discoverable client\n\nCreates a new endpoint to test registration to the Discovery Service via the API Mediation Client.\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cbf56489428a6ff7b3d2c251313d7807f3e067a", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/7cbf56489428a6ff7b3d2c251313d7807f3e067a", "committedDate": "2020-07-24T15:30:30Z", "message": "Merge branch 'master' into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c9bedf74585c6833f20e39a1b942082bf545361", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/3c9bedf74585c6833f20e39a1b942082bf545361", "committedDate": "2020-07-24T16:10:46Z", "message": "Remove unused config reader property\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be82525ebae1d79499870fa1fb4d485ed451a364", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/be82525ebae1d79499870fa1fb4d485ed451a364", "committedDate": "2020-07-24T16:11:39Z", "message": "Merge branch 'master' of github.com:zowe/api-layer into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a136c7b8f57e51fe5b4f24f0becb52e9f0ffd50d", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/a136c7b8f57e51fe5b4f24f0becb52e9f0ffd50d", "committedDate": "2020-07-24T16:12:22Z", "message": "Merge branch 'user/carsoncook/isEurekaRegisteredWithDiscoveryInterface' of github.com:CarsonCook/api-layer into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99ca380b4b615227655c6172619391fdefbcb3de", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/99ca380b4b615227655c6172619391fdefbcb3de", "committedDate": "2020-07-24T16:45:06Z", "message": "Merge branch 'user/carsoncook/isEurekaRegisteredWithDiscoveryInterface' of github.com:CarsonCook/api-layer into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8342f031c9166338ce63871ddbae4a8f48b94d7", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/f8342f031c9166338ce63871ddbae4a8f48b94d7", "committedDate": "2020-07-24T17:41:23Z", "message": "Add tests for mediation client endpoint in discoverable client\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "878f01a68f916c1de51da9529b01f96aef107fc3", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/878f01a68f916c1de51da9529b01f96aef107fc3", "committedDate": "2020-07-24T18:11:53Z", "message": "Merge branch 'user/carsoncook/isEurekaRegisteredWithDiscoveryInterface' of github.com:CarsonCook/api-layer into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e059fd14c826a8ce7816209c7a52f68f7f10962", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/4e059fd14c826a8ce7816209c7a52f68f7f10962", "committedDate": "2020-07-24T20:34:20Z", "message": "Create ApiMediationService unit tests\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "956817911879e14da1f3faa9516feb5c0003d828", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/956817911879e14da1f3faa9516feb5c0003d828", "committedDate": "2020-07-28T12:14:45Z", "message": "Merge branch 'master' into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDUwMDU5", "url": "https://github.com/zowe/api-layer/pull/762#pullrequestreview-457450059", "createdAt": "2020-07-29T11:58:14Z", "commit": {"oid": "956817911879e14da1f3faa9516feb5c0003d828"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1ODoxNVrOG41HZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1ODoxNVrOG41HZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MzY4Nw==", "bodyText": "Can we please change the hardcoded items and take them from the discoverable client configuration where it makes sense?", "url": "https://github.com/zowe/api-layer/pull/762#discussion_r462243687", "createdAt": "2020-07-29T11:58:15Z", "author": {"login": "jandadav"}, "path": "discoverable-client/src/main/java/org/zowe/apiml/client/service/ApiMediationClientService.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.client.service;\n+\n+import org.springframework.stereotype.Service;\n+import org.zowe.apiml.config.ApiInfo;\n+import org.zowe.apiml.eurekaservice.client.ApiMediationClient;\n+import org.zowe.apiml.eurekaservice.client.config.*;\n+import org.zowe.apiml.eurekaservice.client.impl.ApiMediationClientImpl;\n+import org.zowe.apiml.exception.ServiceDefinitionException;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+\n+@Service\n+public class ApiMediationClientService {\n+    private final ApiMediationClient apiMediationClient;\n+    private static final char[] PASSWORD = \"password\".toCharArray();\n+\n+    public ApiMediationClientService() {\n+        apiMediationClient = new ApiMediationClientImpl();\n+    }\n+\n+    public void register() throws ServiceDefinitionException {\n+        ApiInfo apiInfo = new ApiInfo(\"org.zowe.discoverableclient.registrationTest\", \"api/v1\", \"1.0.0\", \"https://localhost:10013/dummy\", null);\n+        Catalog catalogUiTile = new Catalog(new Catalog.Tile(\"cademoapps\", \"Sample API Mediation Client\", \"Application that demonstrates API Mediation registration\", \"1.0.1\"));\n+        Authentication authentication = new Authentication(\"bypass\", null);\n+        Ssl ssl = new Ssl(true, true, \"TLSv1.2\", \"localhost\", PASSWORD,\n+            \"../keystore/localhost/localhost.keystore.p12\", PASSWORD, \"PKCS12\",\n+            \"../keystore/localhost/localhost.truststore.p12\", PASSWORD, \"PKCS12\");\n+        List<Route> routes = new ArrayList<>();\n+        Route apiRoute = new Route(\"api/v1\", \"/registrationTest/api/v1\");\n+        routes.add(apiRoute);\n+\n+        ApiMediationServiceConfig config = ApiMediationServiceConfig.builder()\n+            .apiInfo(Collections.singletonList(apiInfo))\n+            .catalog(catalogUiTile)\n+            .authentication(authentication)\n+            .routes(routes)\n+            .description(\"Example for API Mediation registration\")\n+            .title(\"API Mediation Registration\")\n+            .serviceId(\"registrationTest\")\n+            .baseUrl(\"https://localhost:10013\")\n+            .healthCheckRelativeUrl(\"\")\n+            .homePageRelativeUrl(\"\")\n+            .statusPageRelativeUrl(\"\")\n+            .discoveryServiceUrls(Collections.singletonList(\"https://localhost:10011/eureka\"))\n+            .ssl(ssl)\n+            .serviceIpAddress(\"127.0.0.1\")\n+            .build();\n+        apiMediationClient.register(config);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "956817911879e14da1f3faa9516feb5c0003d828"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bb38ffce51154083596b9cc16a38c4d013bd80a", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/8bb38ffce51154083596b9cc16a38c4d013bd80a", "committedDate": "2020-07-30T15:58:12Z", "message": "Replace hardcoded config with dynamic DC config\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bf41a3fd3951b3b7dcc31df9b900c4985e6c66d", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/3bf41a3fd3951b3b7dcc31df9b900c4985e6c66d", "committedDate": "2020-07-30T15:58:51Z", "message": "Fix code smell on tests with no assert\n\nSigned-off-by: Carson Cook <carson.cook@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed7dc80bff56088bf10ed54ecb249a0f33703210", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/ed7dc80bff56088bf10ed54ecb249a0f33703210", "committedDate": "2020-07-30T15:59:06Z", "message": "Merge branch 'master' of github.com:zowe/api-layer into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9ba6c291f3ee4e330ef72310b320dfdb2c82415", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/c9ba6c291f3ee4e330ef72310b320dfdb2c82415", "committedDate": "2020-07-30T16:04:06Z", "message": "Merge branch 'user/carsoncook/isEurekaRegisteredWithDiscoveryInterface' of github.com:CarsonCook/api-layer into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea31fbcda5ee00282dc484937618a56299ddf190", "author": {"user": {"login": "CarsonCook", "name": "Carson Cook"}}, "url": "https://github.com/zowe/api-layer/commit/ea31fbcda5ee00282dc484937618a56299ddf190", "committedDate": "2020-07-31T14:47:13Z", "message": "Merge branch 'master' into user/carsoncook/isEurekaRegisteredWithDiscoveryInterface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODA3NDIz", "url": "https://github.com/zowe/api-layer/pull/762#pullrequestreview-459807423", "createdAt": "2020-08-03T07:34:09Z", "commit": {"oid": "ea31fbcda5ee00282dc484937618a56299ddf190"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4814, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}