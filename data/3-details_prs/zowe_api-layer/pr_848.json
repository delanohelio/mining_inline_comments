{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxMTM1MzM1", "number": 848, "title": "Zss integration with apiml", "bodyText": "Description\nPossibility to use external mapper for x509 authentication.\nType of change\nPlease delete options that are not relevant.\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to not work as expected)\n This change requires a documentation update\n\nChecklist:\n\n My code follows the style guidelines of this project\n I have performed a self-review of my own code\n I have commented my code, particularly in hard-to-understand areas\n I have made corresponding changes to the documentation\n My changes generate no new warnings\n I have added tests that prove my fix is effective or that my feature works\n New and existing unit tests pass locally with my changes\n Any dependent changes have been merged and published in downstream modules\n\nFor more details about how should the code look like read the Contributing guideline", "createdAt": "2020-09-22T19:02:03Z", "url": "https://github.com/zowe/api-layer/pull/848", "merged": true, "mergeCommit": {"oid": "d5efe973d091d73c4b0fb2ce6c654bd15b819c90"}, "closed": true, "closedAt": "2020-09-24T15:47:21Z", "author": {"login": "achmelo"}, "timelineItems": {"totalCount": 32, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKEY61gH2gAyNDkxMTM1MzM1OjI4N2U3NjkwYjQ2MzI3N2RhOGJlOWJkZjMwNTcxNDFmMWMyMTQxZjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMCpNggFqTQ5NTY3NTcxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "287e7690b463277da8be9bdf3057141f1c2141f7", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/287e7690b463277da8be9bdf3057141f1c2141f7", "committedDate": "2020-09-18T12:03:19Z", "message": "external cert mapper\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "617cd3e2c91020e1ece756f24e90ec3865f87f25", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/617cd3e2c91020e1ece756f24e90ec3865f87f25", "committedDate": "2020-09-18T14:05:46Z", "message": "add more unit test for ZaasJwtService\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03340fd6e1ec5aca48e921b831facc7c64649896", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/03340fd6e1ec5aca48e921b831facc7c64649896", "committedDate": "2020-09-21T09:12:49Z", "message": "use appropriate x509mapper\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fac53d9a2ab643e080cd6eee974a8a529d6059d3", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/fac53d9a2ab643e080cd6eee974a8a529d6059d3", "committedDate": "2020-09-21T09:13:00Z", "message": "Merge remote-tracking branch 'origin/zss_integration_with_apiml' into zss_integration_with_apiml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b282523164dd7ea6a8dfe5608d52fcc31bf19486", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/b282523164dd7ea6a8dfe5608d52fcc31bf19486", "committedDate": "2020-09-22T07:52:46Z", "message": "Merge branch 'master' into zss_integration_with_apiml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f609b54308cc5d54cbaac7933b970c63e66cc2c2", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/f609b54308cc5d54cbaac7933b970c63e66cc2c2", "committedDate": "2020-09-22T08:34:19Z", "message": "parametrized zss url\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18a315bd7219df0d5efff025369aff25d69377b1", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/18a315bd7219df0d5efff025369aff25d69377b1", "committedDate": "2020-09-22T08:34:42Z", "message": "Merge remote-tracking branch 'origin/zss_integration_with_apiml' into zss_integration_with_apiml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce25929482c964ff565536a79ecb66392bde9cec", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/ce25929482c964ff565536a79ecb66392bde9cec", "committedDate": "2020-09-22T11:32:02Z", "message": "Refactoring\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbd1d64821073ca9ab59055d5799dea9814cd5e7", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/fbd1d64821073ca9ab59055d5799dea9814cd5e7", "committedDate": "2020-09-22T12:19:06Z", "message": "Add javadoc and change the URL for the certificate mapping\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5616dae28def8b25399bc85d023e82ce7129e284", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/5616dae28def8b25399bc85d023e82ce7129e284", "committedDate": "2020-09-22T12:44:45Z", "message": "run logouts last\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dba8b052652513899458dbe0ac023739b7812d8a", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/dba8b052652513899458dbe0ac023739b7812d8a", "committedDate": "2020-09-22T18:59:51Z", "message": "fix field names\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6191f620b4e00dd1cc0e653dc199bd4c938ba92", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/b6191f620b4e00dd1cc0e653dc199bd4c938ba92", "committedDate": "2020-09-23T06:31:38Z", "message": "trim trailing spaces from usermap response\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e5fafbeb530f8be7e533336140bcc51d1385930", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/0e5fafbeb530f8be7e533336140bcc51d1385930", "committedDate": "2020-09-23T06:40:06Z", "message": "add login tests as @AuthenticationTest\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f7a75b86eccdaa28e5e11c38226544eb47a397e", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/3f7a75b86eccdaa28e5e11c38226544eb47a397e", "committedDate": "2020-09-23T06:45:16Z", "message": "revert changes\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bfccb4763812ccd36bc9f88f5fa02abdab32314", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/5bfccb4763812ccd36bc9f88f5fa02abdab32314", "committedDate": "2020-09-23T08:09:26Z", "message": "Merge branch 'master' into zss_integration_with_apiml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5f2c321f29e2ca0bf9a33534a097b35b9af2e71", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/f5f2c321f29e2ca0bf9a33534a097b35b9af2e71", "committedDate": "2020-09-23T10:44:49Z", "message": "remove logouts except for authentication tests\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d60adb5bcb5ef722fdf0c11873b32479dfb0459", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/0d60adb5bcb5ef722fdf0c11873b32479dfb0459", "committedDate": "2020-09-23T13:28:05Z", "message": "Merge branch 'master' into private/dj/run-logout-it-last"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23336c587a1fcd944b785581f97bc8c895c54ce1", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/23336c587a1fcd944b785581f97bc8c895c54ce1", "committedDate": "2020-09-23T13:55:19Z", "message": "external mapper unit tests\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fbe216a9cf1ce9a146ab547f9671474143cfd75", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/5fbe216a9cf1ce9a146ab547f9671474143cfd75", "committedDate": "2020-09-23T13:55:32Z", "message": "Merge branch 'private/dj/run-logout-it-last' into zss_integration_with_apiml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a9a6ebd85b5f11770b7542b903459743c901e97", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/9a9a6ebd85b5f11770b7542b903459743c901e97", "committedDate": "2020-09-23T15:05:41Z", "message": "test omitting specific user\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69fb6099557fc141d55fb6b6d4a6f5f9a05051d4", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/69fb6099557fc141d55fb6b6d4a6f5f9a05051d4", "committedDate": "2020-09-23T15:19:41Z", "message": "remove body check\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19bd1f6463fe6ae18e488769739faed427432c7e", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/19bd1f6463fe6ae18e488769739faed427432c7e", "committedDate": "2020-09-23T16:26:15Z", "message": ".\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d36881fa4b688b2532d1eb451309bc2fac00492", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/5d36881fa4b688b2532d1eb451309bc2fac00492", "committedDate": "2020-09-24T07:21:44Z", "message": "external mapper unit tests\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c33dc3804442b01e62251f13d182a944e876725", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/2c33dc3804442b01e62251f13d182a944e876725", "committedDate": "2020-09-24T07:25:00Z", "message": "Merge branch 'master' into zss_integration_with_apiml\n\n# Conflicts:\n#\tintegration-tests/src/test/java/org/zowe/apiml/gatewayservice/authentication/LogoutTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54bb8dd5cba5e880921136752a08768dc9e690b8", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/54bb8dd5cba5e880921136752a08768dc9e690b8", "committedDate": "2020-09-24T08:07:36Z", "message": "refactor\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7833f652623b068f0ae10a12d50d8ade3d956921", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/7833f652623b068f0ae10a12d50d8ade3d956921", "committedDate": "2020-09-24T08:36:22Z", "message": "checkstyle\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4ff688b9afe491c782711c464450a7d27b1f153", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/f4ff688b9afe491c782711c464450a7d27b1f153", "committedDate": "2020-09-24T08:52:13Z", "message": "remove unused files\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1Mzc5NTk2", "url": "https://github.com/zowe/api-layer/pull/848#pullrequestreview-495379596", "createdAt": "2020-09-24T09:21:16Z", "commit": {"oid": "f4ff688b9afe491c782711c464450a7d27b1f153"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwOToyMToxNlrOHXRiSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwOTozMDoyNVrOHXR4CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE2NjYwMQ==", "bodyText": "is this extendable? Can Spring features be used instead of static map?", "url": "https://github.com/zowe/api-layer/pull/848#discussion_r494166601", "createdAt": "2020-09-24T09:21:16Z", "author": {"login": "jandadav"}, "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/security/config/ComponentsConfiguration.java", "diffHunk": "@@ -54,8 +63,12 @@ public Providers loginProviders(\n     }\n \n     @Bean\n-    public X509AuthenticationMapper x509Authentication() {\n-        return new X509CommonNameUserMapper();\n+    @Autowired\n+    public Map<String, X509AuthenticationMapper> x509Authentication(CloseableHttpClient httpClientProxy) {\n+        Map<String, X509AuthenticationMapper> x509Providers = new HashMap<>();\n+        x509Providers.put(\"externalMapper\", new X509ExternalMapper(httpClientProxy, externalMapperUrl));\n+        x509Providers.put(\"commonNameMapper\", new X509CommonNameUserMapper());\n+        return x509Providers;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4ff688b9afe491c782711c464450a7d27b1f153"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE2OTMwNQ==", "bodyText": "Could we simplify this?", "url": "https://github.com/zowe/api-layer/pull/848#discussion_r494169305", "createdAt": "2020-09-24T09:25:38Z", "author": {"login": "jandadav"}, "path": "gateway-service/src/main/resources/application.yml", "diffHunk": "@@ -51,6 +51,10 @@ apiml:\n             jwtKeyAlias: jwtsecret\n         x509:\n             enabled: true\n+            useZss: false\n+            externalMapperUrl: http://localhost:8542/certificate/x509/map\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4ff688b9afe491c782711c464450a7d27b1f153"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE3MjE2OQ==", "bodyText": "I can't see the change in internal repo, please help me, i must be missing something.", "url": "https://github.com/zowe/api-layer/pull/848#discussion_r494172169", "createdAt": "2020-09-24T09:30:25Z", "author": {"login": "jandadav"}, "path": "gateway-service/src/main/resources/application.yml", "diffHunk": "@@ -51,6 +51,10 @@ apiml:\n             jwtKeyAlias: jwtsecret\n         x509:\n             enabled: true\n+            useZss: false\n+            externalMapperUrl: http://localhost:8542/certificate/x509/map\n+\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE2OTMwNQ=="}, "originalCommit": {"oid": "f4ff688b9afe491c782711c464450a7d27b1f153"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8745dab34473f959f5729f52102c84f99e1ea790", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/8745dab34473f959f5729f52102c84f99e1ea790", "committedDate": "2020-09-24T12:26:07Z", "message": "conditional bean, check zss running\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d93fb931b6a6060f03227160c66373c4599cea38", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/d93fb931b6a6060f03227160c66373c4599cea38", "committedDate": "2020-09-24T14:05:36Z", "message": "remove env check for zos, add description for express service\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c17ad09003b3610e607208d4af1424cc3ee721c", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/5c17ad09003b3610e607208d4af1424cc3ee721c", "committedDate": "2020-09-24T15:03:24Z", "message": "Merge branch 'master' into zss_integration_with_apiml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1Njc1NzE5", "url": "https://github.com/zowe/api-layer/pull/848#pullrequestreview-495675719", "createdAt": "2020-09-24T15:09:09Z", "commit": {"oid": "5c17ad09003b3610e607208d4af1424cc3ee721c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4840, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}