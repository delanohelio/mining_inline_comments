{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MjczMjE2", "number": 484, "title": "Client certificate is not used when it is not needed", "bodyText": "The APIML client certificates are not used when the API gateway is sending requests to z/OSMF and routing other services.\nIt remains to be used for inter-APIML communication.\nHttpsFactory needs to create an empty keystore because IBMJSSE2 behavior (different from Oracle Java):\n\nIf no KeyStore parameter is passed to the IBMJSSE2 default IbmX509 KeyManagerFactory, the factory tries to find key material by consulting the system properties\njavax.net.ssl.keyStore\njavax.net.ssl.keyStorePassword\njavax.net.ssl.keyStoreType\n\nSource: https://www.ibm.com/support/knowledgecenter/SSYKE2_8.0.0/com.ibm.java.security.component.80.doc/security-component/jsse2Docs/x509keymanager.html", "createdAt": "2020-01-30T20:31:43Z", "url": "https://github.com/zowe/api-layer/pull/484", "merged": true, "mergeCommit": {"oid": "a6691c0eab19efd33bfd62b6d2b82f06cbea7a26"}, "closed": true, "closedAt": "2020-01-31T09:05:01Z", "author": {"login": "plavjanik"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_fhDVgH2gAyMzY5MjczMjE2OjA0MTQ0Y2ZmMDg3NjJhNGI2YmU1NzJlNTFiNjcyYjg4ZjM1ZDcyMGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_rGN6AFqTM1MTM0NzIwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "04144cff08762a4b6be572e51b672b88f35d720b", "author": {"user": {"login": "plavjanik", "name": "Petr Plavjanik"}}, "url": "https://github.com/zowe/api-layer/commit/04144cff08762a4b6be572e51b672b88f35d720b", "committedDate": "2020-01-30T19:15:19Z", "message": "Do not use client certs for z/OSMF\n\nSigned-off-by: Petr Plavjanik <plavjanik@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56d22ce69003bfb0dfa76e9319e627150dc87902", "author": {"user": {"login": "plavjanik", "name": "Petr Plavjanik"}}, "url": "https://github.com/zowe/api-layer/commit/56d22ce69003bfb0dfa76e9319e627150dc87902", "committedDate": "2020-01-30T20:26:19Z", "message": "Use HttpClient without keystore in Zuul\n\nSigned-off-by: Petr Plavjanik <plavjanik@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMzQ3MjAy", "url": "https://github.com/zowe/api-layer/pull/484#pullrequestreview-351347202", "createdAt": "2020-01-31T08:18:00Z", "commit": {"oid": "56d22ce69003bfb0dfa76e9319e627150dc87902"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQwODoxODowMFrOFkEDpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQwODoxODowMFrOFkEDpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM1OTUyNw==", "bodyText": "What about use lambda:\n        Supplier<HttpsConfig.HttpsConfigBuilder> httpsConfigBuilderSupplier = () ->\n            HttpsConfig.builder().protocol(protocol)\n            .trustStore(trustStore)\n            .trustStoreType(trustStoreType).trustStorePassword(trustStorePassword).trustStoreRequired(trustStoreRequired)\n            .verifySslCertificatesOfServices(verifySslCertificatesOfServices);\n\nHttpsFactory factory = new HttpsFactory(httpsConfig);\nHttpsFactory factoryWithoutKeyStore = new HttpsFactory(httpsConfigBuilderSupplier.get().build());\nsecureHttpClientWithoutKeystore = factoryWithoutKeyStore.createSecureHttpClient();", "url": "https://github.com/zowe/api-layer/pull/484#discussion_r373359527", "createdAt": "2020-01-31T08:18:00Z", "author": {"login": "pj892031"}, "path": "apiml-common/src/main/java/com/ca/mfaas/product/web/HttpConfig.java", "diffHunk": "@@ -96,6 +99,13 @@ public void init() {\n             secureHostnameVerifier = factory.createHostnameVerifier();\n             eurekaJerseyClientBuilder = factory.createEurekaJerseyClientBuilder(eurekaServerUrl, serviceId);\n \n+            HttpsConfig httpsConfigWithoutKeystore = HttpsConfig.builder().protocol(protocol).trustStore(trustStore)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d22ce69003bfb0dfa76e9319e627150dc87902"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4899, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}