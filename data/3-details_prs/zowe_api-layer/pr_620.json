{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4MzU5MzQy", "number": 620, "title": "us654068/leverage ha modes for downstream services", "bodyText": "Retry logic for ribbon load balancer. Adds retry capability to Gateway when service instance is not responding.\nApologies for the size and time.", "createdAt": "2020-04-24T06:35:56Z", "url": "https://github.com/zowe/api-layer/pull/620", "merged": true, "mergeCommit": {"oid": "01ce0866164d6b90608dab0754dc2540819100f5"}, "closed": true, "closedAt": "2020-04-28T12:41:13Z", "author": {"login": "jandadav"}, "timelineItems": {"totalCount": 83, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbaEBrABqjMyNzI5MDY0OTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccDGSugFqTQwMTc4NjkzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "486248b9ec0fbece6bf7e01bf4022da388a925ed", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/486248b9ec0fbece6bf7e01bf4022da388a925ed", "committedDate": "2020-04-26T12:32:35Z", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}, "afterCommit": {"oid": "addefec126391609087f90922f9deccbf42a3483", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/addefec126391609087f90922f9deccbf42a3483", "committedDate": "2020-04-26T12:43:45Z", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a35e46d55d9a8660ccaf0e63ba3f9836cbed9fc2", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/a35e46d55d9a8660ccaf0e63ba3f9836cbed9fc2", "committedDate": "2020-04-27T06:13:22Z", "message": "switch to retryable client\nfailing gzip integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f2d0a30188db850fc02f0c6a9e835772c459eda", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/7f2d0a30188db850fc02f0c6a9e835772c459eda", "committedDate": "2020-04-27T06:13:22Z", "message": "gzip encoding fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26ff34e5e684459c9298315ea03493a1e2d2353f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/26ff34e5e684459c9298315ea03493a1e2d2353f", "committedDate": "2020-04-27T06:13:22Z", "message": "refactor http client proxy and aop\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "873885748af677657fd0a9db065b67082f6604ca", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/873885748af677657fd0a9db065b67082f6604ca", "committedDate": "2020-04-27T06:13:22Z", "message": "cleanup refactored classes\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ef0411cc8e246e72863ef9b9a1e4fd21b3374a3", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/8ef0411cc8e246e72863ef9b9a1e4fd21b3374a3", "committedDate": "2020-04-27T06:13:22Z", "message": "RequestUtils\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d516272eed14697f9c69cb35ada5e8b54846fa5d", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/d516272eed14697f9c69cb35ada5e8b54846fa5d", "committedDate": "2020-04-27T06:13:23Z", "message": "Request decorator\nAuthenticationCommand changes\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42d7f73e987e6ec19b50bdd52f00830dc79e0064", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/42d7f73e987e6ec19b50bdd52f00830dc79e0064", "committedDate": "2020-04-27T06:13:23Z", "message": "fix proxy tests\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b46dd23393ef995d5e223b92a8e866ce4b5caac5", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/b46dd23393ef995d5e223b92a8e866ce4b5caac5", "committedDate": "2020-04-27T06:13:23Z", "message": "Refactor ZosmfSchemeTest\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfb0cfff5dc10c236a0de17538eec7336d9a4446", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/cfb0cfff5dc10c236a0de17538eec7336d9a4446", "committedDate": "2020-04-27T06:13:23Z", "message": "Implementation of applyToReques method for the ZoweScheme class and added test (wip)\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19f9e30d751786e1c3f547d4070e6f3bcf9ae2f4", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/19f9e30d751786e1c3f547d4070e6f3bcf9ae2f4", "committedDate": "2020-04-27T06:13:23Z", "message": "Use cookie version 0\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b4bcde41c5d2f9a39eed5c02e479eedab9d2f20", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/0b4bcde41c5d2f9a39eed5c02e479eedab9d2f20", "committedDate": "2020-04-27T06:13:23Z", "message": "implement applyToRequest for AuthenticationCommand and PassTicketCommand\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cbe7b3a5ab219888524f9316dd7713f79e7c696", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/4cbe7b3a5ab219888524f9316dd7713f79e7c696", "committedDate": "2020-04-27T06:13:23Z", "message": "Add more tests for zosmfscheme class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6936963d2c00d0451effd139ce4d8ddc4f69a7ec", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/6936963d2c00d0451effd139ce4d8ddc4f69a7ec", "committedDate": "2020-04-27T06:13:23Z", "message": "make test independent of test execution order\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d4edd4e4e51ab74f4918227286a6aa187d540e6", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/9d4edd4e4e51ab74f4918227286a6aa187d540e6", "committedDate": "2020-04-27T06:13:23Z", "message": "Exceptions and test for ServiceAuthenticationDecorator\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12ef360edab7e415c4d14cbfd99ad1d4cfc3e8ca", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/12ef360edab7e415c4d14cbfd99ad1d4cfc3e8ca", "committedDate": "2020-04-27T06:13:23Z", "message": "Exception handling and messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c56052a4a5b8b2115d70ab54af7c0381b12a3a4a", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/c56052a4a5b8b2115d70ab54af7c0381b12a3a4a", "committedDate": "2020-04-27T06:13:23Z", "message": "Add implementation of process method and add unit tests for Decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8653d96812e8d5c14c5b213266a014e7bca5b32f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/8653d96812e8d5c14c5b213266a014e7bca5b32f", "committedDate": "2020-04-27T06:13:23Z", "message": "SecurityDecorator exceptionhandling\nByPassScheme fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e450677d892ec1a80a49d04b6ba58915b604068", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/6e450677d892ec1a80a49d04b6ba58915b604068", "committedDate": "2020-04-27T06:13:23Z", "message": "Javadoc, checkstyle and small fixes\ncleanup\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fdb195a9f6b9482f0dd71999e98d7622f49c6f9", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/9fdb195a9f6b9482f0dd71999e98d7622f49c6f9", "committedDate": "2020-04-27T06:13:23Z", "message": "refactor ServiceAuthenticationDecoratorTest\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcaaee5a6bc4e05e9a5812fc0ca493cc12b8eb52", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/dcaaee5a6bc4e05e9a5812fc0ca493cc12b8eb52", "committedDate": "2020-04-27T06:13:23Z", "message": "Suppress log messages\nSendErrorFilter\nNo handler for GET /error\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3c2eea7d5cb8110efba4773310e83bce2d26196", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/b3c2eea7d5cb8110efba4773310e83bce2d26196", "committedDate": "2020-04-27T06:13:23Z", "message": "Fix sonar problems and add unit test for decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbc1a08ba35d8d7141fc7cd3c6de16ef4500c4b7", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/fbc1a08ba35d8d7141fc7cd3c6de16ef4500c4b7", "committedDate": "2020-04-27T06:13:24Z", "message": "Fix sonar problems with Cookie security\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff9dd9fc6a529c839277e96d667d283f0e2e57ef", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/ff9dd9fc6a529c839277e96d667d283f0e2e57ef", "committedDate": "2020-04-27T06:13:24Z", "message": "Fix more sonar problems and add unit test for RibbonRetryError class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0c44a81870226037b520fdf5e608a4430b04900", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/e0c44a81870226037b520fdf5e608a4430b04900", "committedDate": "2020-04-27T06:13:24Z", "message": "Http/Https resolution for service instances\nRefactor exceptions\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38381259304d781c8c2ecee6788b0bb269204112", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/38381259304d781c8c2ecee6788b0bb269204112", "committedDate": "2020-04-27T06:13:24Z", "message": "Initialize client with LoadBalancerContext\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0503148c1ec8cf016f909facb01295d1558275e1", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/0503148c1ec8cf016f909facb01295d1558275e1", "committedDate": "2020-04-27T06:13:24Z", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/9cc2807d5c8c7b05072ff438d2c30648643de91f", "committedDate": "2020-04-27T06:13:24Z", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e9557e75a59e5f26dd9be0f5920ab2b65b28db43", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/e9557e75a59e5f26dd9be0f5920ab2b65b28db43", "committedDate": "2020-04-26T13:34:14Z", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}, "afterCommit": {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/9cc2807d5c8c7b05072ff438d2c30648643de91f", "committedDate": "2020-04-27T06:13:24Z", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNjcwMDAy", "url": "https://github.com/zowe/api-layer/pull/620#pullrequestreview-400670002", "createdAt": "2020-04-27T06:53:52Z", "commit": {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNjo1Mzo1MlrOGMTiBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNjo1Mzo1MlrOGMTiBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU1NjEwMg==", "bodyText": "Deduplicate by extracting in private method?", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415556102", "createdAt": "2020-04-27T06:53:52Z", "author": {"login": "balhar-jakub"}, "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/error/check/RibbonRetryErrorCheck.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+\n+package org.zowe.apiml.gateway.error.check;\n+\n+import lombok.RequiredArgsConstructor;\n+import org.apache.commons.lang3.exception.ExceptionUtils;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.MediaType;\n+import org.springframework.http.ResponseEntity;\n+import org.zowe.apiml.gateway.error.ErrorUtils;\n+import org.zowe.apiml.gateway.ribbon.http.RequestAbortException;\n+import org.zowe.apiml.gateway.ribbon.http.RequestContextNotPreparedException;\n+import org.zowe.apiml.message.api.ApiMessageView;\n+import org.zowe.apiml.message.core.MessageService;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import java.net.ConnectException;\n+\n+/**\n+ * Handler for exceptions that arise during the Ribbon retries\n+ */\n+@RequiredArgsConstructor\n+public class RibbonRetryErrorCheck implements ErrorCheck {\n+    private final MessageService messageService;\n+    @Override\n+    public ResponseEntity<ApiMessageView> checkError(HttpServletRequest request, Throwable exc) {\n+\n+        int exceptionIndex = -1;\n+\n+        if ( (exceptionIndex = ExceptionUtils.indexOfType(exc, RequestAbortException.class)) != -1) {\n+            Throwable t = ExceptionUtils.getThrowables(exc)[exceptionIndex];\n+            if (t instanceof RequestContextNotPreparedException) {\n+                ApiMessageView messageView = messageService.createMessage(\"org.zowe.apiml.gateway.contextNotPrepared\").mapToView();\n+                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNjc5MTI0", "url": "https://github.com/zowe/api-layer/pull/620#pullrequestreview-400679124", "createdAt": "2020-04-27T07:10:10Z", "commit": {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzoxMDoxMVrOGMUDNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzoxMDoxMVrOGMUDNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU2NDU5Nw==", "bodyText": "Possibly deduplicate via extraction to private?", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415564597", "createdAt": "2020-04-27T07:10:11Z", "author": {"login": "balhar-jakub"}, "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java", "diffHunk": "@@ -108,6 +112,40 @@ public void apply(InstanceInfo instanceInfo) {\n             });\n         }\n \n+        @Override\n+        public void applyToRequest(HttpRequest request) {\n+            RequestUtils wrapper = RequestUtils.of(request);\n+            final RequestContext context = RequestContext.getCurrentContext();\n+\n+            Optional<String> jwtToken = authenticationService.getJwtTokenFromRequest(context.getRequest());\n+            jwtToken.ifPresent(token -> {\n+                // parse JWT token to detect the source (z/OSMF / Zowe)\n+                QueryResponse queryResponse = authenticationService.parseJwtToken(token);\n+                switch (queryResponse.getSource()) {\n+                    case ZOSMF:\n+                        wrapper.removeCookie(authConfigurationProperties.getCookieProperties().getCookieName());\n+                        HttpCookie jwtCookie = new HttpCookie(ZosmfService.TokenType.JWT.getCookieName(), token);\n+                        jwtCookie.setSecure(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f56148692caf9392df77d4dfd97b0afd5b83278e", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/f56148692caf9392df77d4dfd97b0afd5b83278e", "committedDate": "2020-04-27T07:40:54Z", "message": "Fixed messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "committedDate": "2020-04-27T09:41:44Z", "message": "Refactor of the code\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODA2OTE3", "url": "https://github.com/zowe/api-layer/pull/620#pullrequestreview-400806917", "createdAt": "2020-04-27T10:05:30Z", "commit": {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDowNTozMFrOGMbLow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDowNTozMFrOGMbLow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4MTQ0Mw==", "bodyText": "We are loosing the information from the original exception. Maybe at least log the information?", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415681443", "createdAt": "2020-04-27T10:05:30Z", "author": {"login": "balhar-jakub"}, "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/http/ServiceAuthenticationDecorator.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+\n+package org.zowe.apiml.gateway.ribbon.http;\n+\n+import com.netflix.appinfo.InstanceInfo;\n+import com.netflix.zuul.context.RequestContext;\n+import lombok.RequiredArgsConstructor;\n+import org.apache.http.HttpRequest;\n+import org.springframework.security.authentication.BadCredentialsException;\n+import org.springframework.security.core.AuthenticationException;\n+import org.zowe.apiml.gateway.ribbon.RequestContextUtils;\n+import org.zowe.apiml.gateway.security.service.AuthenticationService;\n+import org.zowe.apiml.gateway.security.service.ServiceAuthenticationServiceImpl;\n+import org.zowe.apiml.gateway.security.service.schema.AuthenticationCommand;\n+import org.zowe.apiml.gateway.security.service.schema.ServiceAuthenticationService;\n+import org.zowe.apiml.security.common.auth.Authentication;\n+\n+import static org.zowe.apiml.gateway.security.service.ServiceAuthenticationServiceImpl.AUTHENTICATION_COMMAND_KEY;\n+\n+@RequiredArgsConstructor\n+public class ServiceAuthenticationDecorator {\n+\n+    private final ServiceAuthenticationService serviceAuthenticationService;\n+    private final AuthenticationService authenticationService;\n+\n+    private static final String INVALID_JWT_MESSAGE = \"Invalid JWT token\";\n+\n+    public void process(HttpRequest request) {\n+        final RequestContext context = RequestContext.getCurrentContext();\n+\n+        if (context.get(AUTHENTICATION_COMMAND_KEY) instanceof ServiceAuthenticationServiceImpl.UniversalAuthenticationCommand) {\n+            InstanceInfo info = RequestContextUtils.getInstanceInfo().orElseThrow(\n+                () -> new RequestContextNotPreparedException(\"InstanceInfo of loadbalanced instance is not present in RequestContext\")\n+            );\n+            final Authentication authentication = serviceAuthenticationService.getAuthentication(info);\n+            boolean rejected = false;\n+            AuthenticationCommand cmd = null;\n+\n+            try {\n+                final String jwtToken = authenticationService.getJwtTokenFromRequest(context.getRequest()).orElse(null);\n+\n+                cmd = serviceAuthenticationService.getAuthenticationCommand(authentication, jwtToken);\n+\n+                if (cmd == null) {\n+                    return;\n+                }\n+\n+                if (cmd.isRequiredValidJwt()) {\n+                    rejected = (jwtToken == null) || !authenticationService.validateJwtToken(jwtToken).isAuthenticated();\n+                }\n+            }\n+            catch (AuthenticationException ae) {\n+                rejected = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODEwNTEw", "url": "https://github.com/zowe/api-layer/pull/620#pullrequestreview-400810510", "createdAt": "2020-04-27T10:10:25Z", "commit": {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDoxMDoyNVrOGMbX4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDoxMDoyNVrOGMbX4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4NDU3Nw==", "bodyText": "Have you considered implementing as a Bean instead of as a collection of static methods?", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415684577", "createdAt": "2020-04-27T10:10:25Z", "author": {"login": "balhar-jakub"}, "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/RequestContextUtils.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+\n+package org.zowe.apiml.gateway.ribbon;\n+\n+import com.netflix.appinfo.InstanceInfo;\n+import com.netflix.zuul.context.RequestContext;\n+\n+import java.util.Optional;\n+\n+/**\n+ * Class for storing and retrieving instance information from RequestContext\n+ */\n+public class RequestContextUtils {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODcyNDIw", "url": "https://github.com/zowe/api-layer/pull/620#pullrequestreview-400872420", "createdAt": "2020-04-27T11:44:38Z", "commit": {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96385946694689de337fffab4ef073498ca9f270", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/96385946694689de337fffab4ef073498ca9f270", "committedDate": "2020-04-27T14:30:45Z", "message": "Improve documentation, remove duplication in tests (#622)\n\nImprove documentation, remove duplication in tests\r\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "516d7da034c8c6ba3d518613828e74e787f77ff3", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/516d7da034c8c6ba3d518613828e74e787f77ff3", "committedDate": "2020-04-28T08:45:27Z", "message": "Remove Request related part from the Utils\nRename to coherent Cookies class\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac601210463454e3f565c31e960e4f0a0538e7f5", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/ac601210463454e3f565c31e960e4f0a0538e7f5", "committedDate": "2020-04-28T08:09:57Z", "message": "Merge branch 'rip/TA1543407/ha_integrations_tests' into rip/US654068/leverage-ha-modes-for-downstream-services"}, "afterCommit": {"oid": "d8b10e1735036b7f6e13a1fb3bfd00de8954ec94", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/d8b10e1735036b7f6e13a1fb3bfd00de8954ec94", "committedDate": "2020-04-28T09:28:33Z", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd26be286b1c9be062c3e7150566eea1fe2aa2e5", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/cd26be286b1c9be062c3e7150566eea1fe2aa2e5", "committedDate": "2020-04-28T09:31:41Z", "message": "switch to retryable client\nfailing gzip integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "573495dc804d223200ad366f95f1363e18751c59", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/573495dc804d223200ad366f95f1363e18751c59", "committedDate": "2020-04-28T09:31:41Z", "message": "gzip encoding fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5c077d0cf716dfedea79d7eccb2d0202596757d", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/b5c077d0cf716dfedea79d7eccb2d0202596757d", "committedDate": "2020-04-28T09:31:41Z", "message": "refactor http client proxy and aop\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4e7a9c79497dafbebd03696003adad786d70ff7", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/d4e7a9c79497dafbebd03696003adad786d70ff7", "committedDate": "2020-04-28T09:31:41Z", "message": "cleanup refactored classes\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f440a2bee636f40810bfe51cda2fa784fc7adc8", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/8f440a2bee636f40810bfe51cda2fa784fc7adc8", "committedDate": "2020-04-28T09:31:41Z", "message": "RequestUtils\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b243af0c24e23278b4a49f209c5f8b6039e44df", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/5b243af0c24e23278b4a49f209c5f8b6039e44df", "committedDate": "2020-04-28T09:31:41Z", "message": "Request decorator\nAuthenticationCommand changes\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60359fde6fb270cd64135c1fb0059b9a9d5ecf00", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/60359fde6fb270cd64135c1fb0059b9a9d5ecf00", "committedDate": "2020-04-28T09:31:41Z", "message": "fix proxy tests\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78ac24af515f3a3fb8eb8c578c25a052904303fb", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/78ac24af515f3a3fb8eb8c578c25a052904303fb", "committedDate": "2020-04-28T09:31:41Z", "message": "Refactor ZosmfSchemeTest\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b45d99161b88f869a466fbdc55ecbfbf41192298", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/b45d99161b88f869a466fbdc55ecbfbf41192298", "committedDate": "2020-04-28T09:31:41Z", "message": "Implementation of applyToReques method for the ZoweScheme class and added test (wip)\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53e5415c4cb94c9a2972bdf76b5abecd287f924f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/53e5415c4cb94c9a2972bdf76b5abecd287f924f", "committedDate": "2020-04-28T09:31:41Z", "message": "Use cookie version 0\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fae948c6c163a7420ba9d39226e94604665caa6", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/8fae948c6c163a7420ba9d39226e94604665caa6", "committedDate": "2020-04-28T09:31:41Z", "message": "implement applyToRequest for AuthenticationCommand and PassTicketCommand\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "195603260b73eb8001f8fb728d2b29171fdaf6c4", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/195603260b73eb8001f8fb728d2b29171fdaf6c4", "committedDate": "2020-04-28T09:31:41Z", "message": "Add more tests for zosmfscheme class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "010219fe141bf36b3d6b6c6bbbb98bc85c0342d3", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/010219fe141bf36b3d6b6c6bbbb98bc85c0342d3", "committedDate": "2020-04-28T09:31:41Z", "message": "make test independent of test execution order\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e51f10889ef84c1a9d2175f87c78663433b54e6", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/8e51f10889ef84c1a9d2175f87c78663433b54e6", "committedDate": "2020-04-28T09:31:41Z", "message": "Exceptions and test for ServiceAuthenticationDecorator\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efac37358c2eb89c86dea542dcea5d1aba8c49b5", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/efac37358c2eb89c86dea542dcea5d1aba8c49b5", "committedDate": "2020-04-28T09:31:41Z", "message": "Exception handling and messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f97653b0569dc91f2d7f746b808ed68df04685b", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/0f97653b0569dc91f2d7f746b808ed68df04685b", "committedDate": "2020-04-28T09:31:42Z", "message": "Add implementation of process method and add unit tests for Decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37cc322ba60ac2578d1623fcfa8e03fac0aaabef", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/37cc322ba60ac2578d1623fcfa8e03fac0aaabef", "committedDate": "2020-04-28T09:31:42Z", "message": "SecurityDecorator exceptionhandling\nByPassScheme fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c236a55d32f7248234b33cd74530982d5f103ea", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/9c236a55d32f7248234b33cd74530982d5f103ea", "committedDate": "2020-04-28T09:31:42Z", "message": "Javadoc, checkstyle and small fixes\ncleanup\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ab840c4f391b4c041fb9eb1ad11f0220185e74b", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/6ab840c4f391b4c041fb9eb1ad11f0220185e74b", "committedDate": "2020-04-28T09:31:42Z", "message": "refactor ServiceAuthenticationDecoratorTest\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39cefc2a00982c23e84fd3375a5cd3c29441805a", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/39cefc2a00982c23e84fd3375a5cd3c29441805a", "committedDate": "2020-04-28T09:31:42Z", "message": "Suppress log messages\nSendErrorFilter\nNo handler for GET /error\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bc933b31d1e3ac4a62e0a35d39c40397e56467e", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/9bc933b31d1e3ac4a62e0a35d39c40397e56467e", "committedDate": "2020-04-28T09:31:42Z", "message": "Fix sonar problems and add unit test for decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2984803375318a274a4f7a6263b207660b6665c3", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/2984803375318a274a4f7a6263b207660b6665c3", "committedDate": "2020-04-28T09:31:42Z", "message": "Fix sonar problems with Cookie security\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3df5d617543f82c0fe86ba0dd3ff610225c2adca", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/3df5d617543f82c0fe86ba0dd3ff610225c2adca", "committedDate": "2020-04-28T09:31:42Z", "message": "Fix more sonar problems and add unit test for RibbonRetryError class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e492efa70dad217fa6111c71540a1207fa9e75a4", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/e492efa70dad217fa6111c71540a1207fa9e75a4", "committedDate": "2020-04-28T09:31:42Z", "message": "Http/Https resolution for service instances\nRefactor exceptions\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d668dcf62e478818fbfcc5a547cf4a3a9b7a451", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/8d668dcf62e478818fbfcc5a547cf4a3a9b7a451", "committedDate": "2020-04-28T09:31:42Z", "message": "Initialize client with LoadBalancerContext\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee891ac02b493db2b368c835e511e7a031d2a46e", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/ee891ac02b493db2b368c835e511e7a031d2a46e", "committedDate": "2020-04-28T09:31:42Z", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f715319afd54e29323125264ebae3f98721402a2", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/f715319afd54e29323125264ebae3f98721402a2", "committedDate": "2020-04-28T09:31:42Z", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "189b01d4a09c3eb376ac009c03e7013f59d68665", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/189b01d4a09c3eb376ac009c03e7013f59d68665", "committedDate": "2020-04-28T09:31:42Z", "message": "Fixed messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da19fd7b840d5e62b8d0b08facabc76cc764f24b", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/da19fd7b840d5e62b8d0b08facabc76cc764f24b", "committedDate": "2020-04-28T09:31:42Z", "message": "Refactor of the code\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21842a19d312d3054d31254b05cd0a61798de83c", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/21842a19d312d3054d31254b05cd0a61798de83c", "committedDate": "2020-04-28T09:31:42Z", "message": "Improve documentation, remove duplication in tests (#622)\n\nImprove documentation, remove duplication in tests\r\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>\r\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfbd67f9c9f134dfabdc30378c8d048726a23ca4", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/dfbd67f9c9f134dfabdc30378c8d048726a23ca4", "committedDate": "2020-04-28T09:31:42Z", "message": "try tests in jenkins\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea1be4be4da0d710e16d79902718937604efa1e7", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/ea1be4be4da0d710e16d79902718937604efa1e7", "committedDate": "2020-04-28T09:31:42Z", "message": "styles\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb845d280f997e6152c79fa825cccfb6c50cd9c4", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/fb845d280f997e6152c79fa825cccfb6c50cd9c4", "committedDate": "2020-04-28T09:31:42Z", "message": "split auth tests\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65ac91571238dd9bfe8b039974e765774eb54fb7", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/65ac91571238dd9bfe8b039974e765774eb54fb7", "committedDate": "2020-04-28T09:31:42Z", "message": "change applid\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b5b8cadeed0589c3024373350b3bc43802259e3", "author": {"user": {"login": "achmelo", "name": null}}, "url": "https://github.com/zowe/api-layer/commit/6b5b8cadeed0589c3024373350b3bc43802259e3", "committedDate": "2020-04-28T09:31:42Z", "message": "change applid and assertion\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "committedDate": "2020-04-28T09:31:42Z", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8b10e1735036b7f6e13a1fb3bfd00de8954ec94", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/d8b10e1735036b7f6e13a1fb3bfd00de8954ec94", "committedDate": "2020-04-28T09:28:33Z", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}, "afterCommit": {"oid": "97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "author": {"user": {"login": "jandadav", "name": "David Janda"}}, "url": "https://github.com/zowe/api-layer/commit/97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "committedDate": "2020-04-28T09:31:42Z", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e50c54d30cac72e5fad2dc69a6314b9d6c7bf1b", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/4e50c54d30cac72e5fad2dc69a6314b9d6c7bf1b", "committedDate": "2020-04-28T09:36:14Z", "message": "Reflect removal of Header related functionality in tests\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39a8512d5a50a0f2d671d07a8c6f50e07e930863", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/39a8512d5a50a0f2d671d07a8c6f50e07e930863", "committedDate": "2020-04-28T09:36:56Z", "message": "Clean unused imports\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2246337bfc98648f8fdf827850473472e78a868f", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/2246337bfc98648f8fdf827850473472e78a868f", "committedDate": "2020-04-28T09:37:13Z", "message": "Remove Authorization instead of setting to null\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c33e475db7760a6d729b2578fc1e93e4c9f35b45", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/c33e475db7760a6d729b2578fc1e93e4c9f35b45", "committedDate": "2020-04-28T09:41:04Z", "message": "Merge remote-tracking branch 'origin/rip/US654068/leverage-ha-modes-for-downstream-services' into rip/US654068/leverage-ha-modes-for-downstream-services\n\n# Conflicts:\n#\tgateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/HttpBasicPassTicketScheme.java\n#\tgateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java\n#\tgateway-service/src/test/java/org/zowe/apiml/gateway/security/service/schema/HttpBasicPassTicketSchemeTest.java\n#\tgateway-service/src/test/java/org/zowe/apiml/gateway/security/service/schema/ZosmfSchemeTest.java\n#\tintegration-tests/src/test/java/org/zowe/apiml/gatewayservice/ServiceHaMode.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31ceea538667eaa32441010c152d9b9046d648c5", "author": {"user": {"login": "balhar-jakub", "name": "Jakub Balhar"}}, "url": "https://github.com/zowe/api-layer/commit/31ceea538667eaa32441010c152d9b9046d648c5", "committedDate": "2020-04-28T09:44:02Z", "message": "Remove Authorization instead of setting to null\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa13d9660b6cac8aa590b0373893293f15899d64", "author": {"user": {"login": "taban03", "name": "Andrea Tabone"}}, "url": "https://github.com/zowe/api-layer/commit/fa13d9660b6cac8aa590b0373893293f15899d64", "committedDate": "2020-04-28T11:50:08Z", "message": "Improve errorCheck for requestAbort exception to handle nested exceptions cause and refactor of process method\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzg2OTMy", "url": "https://github.com/zowe/api-layer/pull/620#pullrequestreview-401786932", "createdAt": "2020-04-28T12:32:33Z", "commit": {"oid": "fa13d9660b6cac8aa590b0373893293f15899d64"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4858, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}