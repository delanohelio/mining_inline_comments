{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MDU5NDE5", "number": 7993, "title": "Update language property on /content node when project is created/mod\u2026", "bodyText": "\u2026ified #7975", "createdAt": "2020-04-01T15:13:37Z", "url": "https://github.com/enonic/xp/pull/7993", "merged": true, "mergeCommit": {"oid": "a9c6e2f9458acc5d2f4e1934b23928dc226a1dde"}, "closed": true, "closedAt": "2020-04-02T07:59:42Z", "author": {"login": "vbradnitski"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTadhKgFqTM4NTc0NDU4NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTnm5zAFqTM4NjE4ODcwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NzQ0NTg0", "url": "https://github.com/enonic/xp/pull/7993#pullrequestreview-385744584", "createdAt": "2020-04-01T16:19:27Z", "commit": {"oid": "46601fcb4100baf8832330df05b13743b7693912"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNjoxOToyN1rOF_IWyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNjoxOToyN1rOF_IWyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc0MTUxNQ==", "bodyText": "requireNonNullElse is better", "url": "https://github.com/enonic/xp/pull/7993#discussion_r401741515", "createdAt": "2020-04-01T16:19:27Z", "author": {"login": "rymsha"}, "path": "modules/admin/admin-impl/src/main/java/com/enonic/xp/admin/impl/rest/resource/project/ApplyProjectLanguageCommand.java", "diffHunk": "@@ -0,0 +1,80 @@\n+package com.enonic.xp.admin.impl.rest.resource.project;\n+\n+import java.util.Locale;\n+\n+import com.enonic.xp.content.Content;\n+import com.enonic.xp.content.ContentPath;\n+import com.enonic.xp.content.UpdateContentParams;\n+import com.enonic.xp.context.Context;\n+import com.enonic.xp.context.ContextAccessor;\n+import com.enonic.xp.security.User;\n+\n+public final class ApplyProjectLanguageCommand\n+    extends AbstractProjectRootCommand\n+{\n+    private final Locale language;\n+\n+    private ApplyProjectLanguageCommand( final Builder builder )\n+    {\n+        super( builder );\n+        this.language = builder.language;\n+    }\n+\n+    public static Builder create()\n+    {\n+        return new Builder();\n+    }\n+\n+    public Locale execute()\n+    {\n+        return doUpdateLanguage();\n+    }\n+\n+    private Locale doUpdateLanguage()\n+    {\n+        return projectRepoContext.callWith( () -> {\n+            final Content root = this.contentService.getByPath( ContentPath.ROOT );\n+\n+            final UpdateContentParams params = new UpdateContentParams().\n+                contentId( root.getId() ).\n+                modifier( getCurrentUser().getKey() ).\n+                editor( edit -> edit.language = this.language );\n+\n+            return this.contentService.update( params ).\n+                getLanguage();\n+        } );\n+    }\n+\n+    private User getCurrentUser()\n+    {\n+        final Context context = ContextAccessor.current();\n+        return context.getAuthInfo().getUser() != null ? context.getAuthInfo().getUser() : User.ANONYMOUS;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46601fcb4100baf8832330df05b13743b7693912"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "author": {"user": {"login": "vbradnitski", "name": "Bradnitski Viachaslau"}}, "url": "https://github.com/enonic/xp/commit/cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "committedDate": "2020-04-01T17:57:22Z", "message": "Update language property on /content node when project is created/modified #7975"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46601fcb4100baf8832330df05b13743b7693912", "author": {"user": {"login": "vbradnitski", "name": "Bradnitski Viachaslau"}}, "url": "https://github.com/enonic/xp/commit/46601fcb4100baf8832330df05b13743b7693912", "committedDate": "2020-04-01T13:31:57Z", "message": "Update language property on /content node when project is created/modified #7975"}, "afterCommit": {"oid": "cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "author": {"user": {"login": "vbradnitski", "name": "Bradnitski Viachaslau"}}, "url": "https://github.com/enonic/xp/commit/cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6", "committedDate": "2020-04-01T17:57:22Z", "message": "Update language property on /content node when project is created/modified #7975"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1OTY2MzE3", "url": "https://github.com/enonic/xp/pull/7993#pullrequestreview-385966317", "createdAt": "2020-04-01T21:34:56Z", "commit": {"oid": "cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MTg4NzA5", "url": "https://github.com/enonic/xp/pull/7993#pullrequestreview-386188709", "createdAt": "2020-04-02T07:59:26Z", "commit": {"oid": "cc2d17e6dfccf59b3f3a8aebdcd1e17903889ed6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4506, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}