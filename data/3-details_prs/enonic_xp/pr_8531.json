{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzNzMyODU1", "number": 8531, "title": "Anonymous audit-log events #8511", "bodyText": "", "createdAt": "2020-12-07T14:54:21Z", "url": "https://github.com/enonic/xp/pull/8531", "merged": true, "mergeCommit": {"oid": "dc3c53b958966d23c0be0122b16dc14350a12eed"}, "closed": true, "closedAt": "2020-12-08T09:03:08Z", "author": {"login": "anatol-sialitski"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdj21OwAFqTU0NjIyODQ2Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkGKT0AFqTU0Njg3MTUyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2MjI4NDY2", "url": "https://github.com/enonic/xp/pull/8531#pullrequestreview-546228466", "createdAt": "2020-12-07T14:56:53Z", "commit": {"oid": "4f93091f8a1149d1f3ce0b4e4f6f22e353df8df3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNDo1Njo1M1rOIAqwog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNDo1Njo1M1rOIAqwog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU3MTQ5MA==", "bodyText": "Do we use this field at all? We should not, probably as we should not trust the caller.", "url": "https://github.com/enonic/xp/pull/8531#discussion_r537571490", "createdAt": "2020-12-07T14:56:53Z", "author": {"login": "rymsha"}, "path": "modules/admin/admin-impl/src/main/java/com/enonic/xp/admin/impl/rest/resource/content/json/UpdateContentJson.java", "diffHunk": "@@ -59,10 +60,14 @@\n         final PropertyTree contentData = PropertyTreeJson.fromJson( propertyArrayJsonList );\n         final ExtraDatas extraDatas = parseExtradata( extraDataJsonList );\n \n+        final PrincipalKey modifier = ContextAccessor.current().getAuthInfo().getUser() != null\n+            ? ContextAccessor.current().getAuthInfo().getUser().getKey()\n+            : PrincipalKey.ofAnonymous();\n+\n         this.updateContentParams = new UpdateContentParams().\n             requireValid( Boolean.parseBoolean( requireValid ) ).\n             contentId( ContentId.from( contentId ) ).\n-            modifier( PrincipalKey.ofAnonymous() ).\n+            modifier( modifier ).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f93091f8a1149d1f3ce0b4e4f6f22e353df8df3"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "871899a6641de0f01a69884652a34db7c05c2038", "author": {"user": {"login": "anatol-sialitski", "name": null}}, "url": "https://github.com/enonic/xp/commit/871899a6641de0f01a69884652a34db7c05c2038", "committedDate": "2020-12-07T15:49:27Z", "message": "Anonymous audit-log events #8511"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f93091f8a1149d1f3ce0b4e4f6f22e353df8df3", "author": {"user": {"login": "anatol-sialitski", "name": null}}, "url": "https://github.com/enonic/xp/commit/4f93091f8a1149d1f3ce0b4e4f6f22e353df8df3", "committedDate": "2020-12-07T14:52:22Z", "message": "Anonymous audit-log events #8511"}, "afterCommit": {"oid": "871899a6641de0f01a69884652a34db7c05c2038", "author": {"user": {"login": "anatol-sialitski", "name": null}}, "url": "https://github.com/enonic/xp/commit/871899a6641de0f01a69884652a34db7c05c2038", "committedDate": "2020-12-07T15:49:27Z", "message": "Anonymous audit-log events #8511"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2Mjk2ODYw", "url": "https://github.com/enonic/xp/pull/8531#pullrequestreview-546296860", "createdAt": "2020-12-07T16:06:51Z", "commit": {"oid": "871899a6641de0f01a69884652a34db7c05c2038"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNjowNjo1MVrOIAuJtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNjowNjo1MVrOIAuJtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzYyNzA2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.modifier = modifier;", "url": "https://github.com/enonic/xp/pull/8531#discussion_r537627060", "createdAt": "2020-12-07T16:06:51Z", "author": {"login": "rymsha"}, "path": "modules/core/core-api/src/main/java/com/enonic/xp/content/UpdateContentParams.java", "diffHunk": "@@ -40,6 +40,7 @@ public UpdateContentParams contentId( final ContentId contentId )\n         return this;\n     }\n \n+    @Deprecated\n     public UpdateContentParams modifier( final PrincipalKey modifier )\n     {\n         this.modifier = modifier;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "871899a6641de0f01a69884652a34db7c05c2038"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2ODY2NzQw", "url": "https://github.com/enonic/xp/pull/8531#pullrequestreview-546866740", "createdAt": "2020-12-08T08:46:31Z", "commit": {"oid": "871899a6641de0f01a69884652a34db7c05c2038"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2ODcxNTI0", "url": "https://github.com/enonic/xp/pull/8531#pullrequestreview-546871524", "createdAt": "2020-12-08T08:49:12Z", "commit": {"oid": "871899a6641de0f01a69884652a34db7c05c2038"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4369, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}