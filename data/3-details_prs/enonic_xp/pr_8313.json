{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NDIwODM2", "number": 8313, "title": "snapshot restore `latest` option support #8222", "bodyText": "", "createdAt": "2020-08-28T13:55:00Z", "url": "https://github.com/enonic/xp/pull/8313", "merged": true, "mergeCommit": {"oid": "62a19fc177af69f4197fd10de48b6cd9c0ee6f05"}, "closed": true, "closedAt": "2020-08-31T07:52:04Z", "author": {"login": "anatol-sialitski"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDVozdgFqTQ3Nzc2MTc5OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEN-3jAFqTQ3ODM5MzkyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NzYxNzk4", "url": "https://github.com/enonic/xp/pull/8313#pullrequestreview-477761798", "createdAt": "2020-08-28T14:11:30Z", "commit": {"oid": "de805860d29c27f58cf141f985aaabe28ac162c1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNDoxMTozMFrOHJH9xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNDoxMTozMFrOHJH9xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTMyOTczMg==", "bodyText": "We are slowly getting away from Guava. We don't use Iterables class (almost) anywhere else.\nlist.get( list.size() - 1 ) is not perfect but good enough alternative.\nIt would be also good to check if size is not 0 and throw exception with clear message: \"No snapshots found\" for ex.", "url": "https://github.com/enonic/xp/pull/8313#discussion_r479329732", "createdAt": "2020-08-28T14:11:30Z", "author": {"login": "rymsha"}, "path": "modules/core/core-repo/src/main/java/com/enonic/xp/repo/impl/elasticsearch/snapshot/SnapshotServiceImpl.java", "diffHunk": "@@ -96,15 +98,29 @@ public RestoreResult restore( final RestoreParams restoreParams )\n     private RestoreResult doRestore( final RestoreParams restoreParams )\n     {\n         checkSnapshotRepository();\n-        validateSnapshot( restoreParams.getSnapshotName() );\n+\n+        String snapshotName;\n+\n+        if ( restoreParams.isLatest() )\n+        {\n+            final SnapshotResult snapshotResult = Iterables.getLast( list() );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de805860d29c27f58cf141f985aaabe28ac162c1"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17113e64422092963d0f3c8b61b672ba0cecc605", "author": {"user": {"login": "anatol-sialitski", "name": null}}, "url": "https://github.com/enonic/xp/commit/17113e64422092963d0f3c8b61b672ba0cecc605", "committedDate": "2020-08-28T15:19:17Z", "message": "snapshot restore `latest` option support #8222"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de805860d29c27f58cf141f985aaabe28ac162c1", "author": {"user": {"login": "anatol-sialitski", "name": null}}, "url": "https://github.com/enonic/xp/commit/de805860d29c27f58cf141f985aaabe28ac162c1", "committedDate": "2020-08-28T13:53:26Z", "message": "snapshot restore `latest` option support #8222"}, "afterCommit": {"oid": "17113e64422092963d0f3c8b61b672ba0cecc605", "author": {"user": {"login": "anatol-sialitski", "name": null}}, "url": "https://github.com/enonic/xp/commit/17113e64422092963d0f3c8b61b672ba0cecc605", "committedDate": "2020-08-28T15:19:17Z", "message": "snapshot restore `latest` option support #8222"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3ODI0Nzkz", "url": "https://github.com/enonic/xp/pull/8313#pullrequestreview-477824793", "createdAt": "2020-08-28T15:29:28Z", "commit": {"oid": "17113e64422092963d0f3c8b61b672ba0cecc605"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MzkzOTI0", "url": "https://github.com/enonic/xp/pull/8313#pullrequestreview-478393924", "createdAt": "2020-08-31T07:50:22Z", "commit": {"oid": "17113e64422092963d0f3c8b61b672ba0cecc605"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4469, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}