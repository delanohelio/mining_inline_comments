{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNTg0MTYz", "number": 8524, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMDo0MjowMFrOFAKGZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDoyOTowNFrOFAu8Aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1NzA5Nzk3OnYy", "diffSide": "RIGHT", "path": "modules/lib/lib-content/src/main/java/com/enonic/xp/lib/content/ResetInheritanceHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMDo0MjowMFrOH-S9qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMDo0MjowMFrOH-S9qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTA4NDQ1OQ==", "bodyText": "call get() in doExecute\nDue to OSGi dynamic nature service may become unavailable between initialize and doExecute.", "url": "https://github.com/enonic/xp/pull/8524#discussion_r535084459", "createdAt": "2020-12-03T10:42:00Z", "author": {"login": "rymsha"}, "path": "modules/lib/lib-content/src/main/java/com/enonic/xp/lib/content/ResetInheritanceHandler.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.enonic.xp.lib.content;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import com.google.common.base.Preconditions;\n+\n+import com.enonic.xp.content.Content;\n+import com.enonic.xp.content.ContentId;\n+import com.enonic.xp.content.ContentInheritType;\n+import com.enonic.xp.content.ContentPath;\n+import com.enonic.xp.content.ResetContentInheritParams;\n+import com.enonic.xp.content.SyncContentService;\n+import com.enonic.xp.project.ProjectName;\n+import com.enonic.xp.script.bean.BeanContext;\n+\n+public class ResetInheritanceHandler\n+    extends BaseContextHandler\n+{\n+    private SyncContentService syncContentService;\n+\n+    private String key;\n+\n+    private String projectName;\n+\n+    private List<String> inherit;\n+\n+    @Override\n+    public void initialize( final BeanContext context )\n+    {\n+        super.initialize( context );\n+        this.syncContentService = context.getService( SyncContentService.class ).get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75ea1986817635535622d135bfe4b12e22916386"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1NzYzMTY1OnYy", "diffSide": "RIGHT", "path": "modules/lib/lib-content/src/main/resources/lib/xp/content.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjoxMDowMlrOH-YW7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjoxMDowMlrOH-YW7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE3Mjg0Nw==", "bodyText": "add /* global __ */ on top of the file. see how it is done in project.js", "url": "https://github.com/enonic/xp/pull/8524#discussion_r535172847", "createdAt": "2020-12-03T12:10:02Z", "author": {"login": "rymsha"}, "path": "modules/lib/lib-content/src/main/resources/lib/xp/content.js", "diffHunk": "@@ -512,3 +512,20 @@ exports.getOutboundDependencies = function (params) {\n \n     return __.toNativeObject(bean.execute());\n };\n+\n+/** Resets dropped inherit flags back.\n+ *\n+ * @param {object} params JSON parameters.\n+ * @param {string} params.key Path or id of the content.\n+ * @param {string} params.projectName name of project with content.\n+ * @param {string[]} params.inherit flags to be reset.\n+ */\n+exports.resetInheritance = function (params) {\n+    var bean = __.newBean('com.enonic.xp.lib.content.ResetInheritanceHandler');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0f9137e7a0b9f5aef4f6d7b2ed36282bc84acd6"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1NzY1MTY2OnYy", "diffSide": "RIGHT", "path": "modules/lib/lib-content/src/main/resources/lib/xp/examples/content/resetInheritance.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjoxMzoxNVrOH-YkOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjoxMzoxNVrOH-YkOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE3NjI0OA==", "bodyText": "should we add assertions here instead of java?", "url": "https://github.com/enonic/xp/pull/8524#discussion_r535176248", "createdAt": "2020-12-03T12:13:15Z", "author": {"login": "rymsha"}, "path": "modules/lib/lib-content/src/main/resources/lib/xp/examples/content/resetInheritance.js", "diffHunk": "@@ -0,0 +1,16 @@\n+var contentLib = require('/lib/xp/content');\n+\n+// reset content by path\n+contentLib.resetInheritance({\n+    key: '/a/b/mycontent',\n+    projectName: 'child1',\n+    inherit: ['NAME', 'CONTENT']\n+});\n+\n+// reset content by id\n+contentLib.resetInheritance({\n+    key: 'mycontent-id',\n+    projectName: 'child2',\n+    inherit: ['SORT']\n+});\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0f9137e7a0b9f5aef4f6d7b2ed36282bc84acd6"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzEzMTIzOnYy", "diffSide": "RIGHT", "path": "modules/lib/lib-content/src/main/java/com/enonic/xp/lib/content/mapper/ContentMapper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDoyODoyOVrOH_KoaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDoyODoyOVrOH_KoaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk5NjUyMA==", "bodyText": "Don't we need to mention new field in JSDoc?", "url": "https://github.com/enonic/xp/pull/8524#discussion_r535996520", "createdAt": "2020-12-04T10:28:29Z", "author": {"login": "rymsha"}, "path": "modules/lib/lib-content/src/main/java/com/enonic/xp/lib/content/mapper/ContentMapper.java", "diffHunk": "@@ -168,6 +172,16 @@ private void serializeAttachments( final MapGenerator gen, final Attachments val\n         gen.end();\n     }\n \n+    private void serializeInherit( final MapGenerator gen, final Set<ContentInheritType> value )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de7c6a28641cd2db641b728557639773f3ff4ad0"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MzEzMzQ3OnYy", "diffSide": "RIGHT", "path": "modules/lib/lib-content/src/main/resources/lib/xp/content.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDoyOTowNFrOH_Kptw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDoyOTowNFrOH_Kptw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk5Njg1NQ==", "bodyText": "We have a limited set of values accepted, maybe mention them here?", "url": "https://github.com/enonic/xp/pull/8524#discussion_r535996855", "createdAt": "2020-12-04T10:29:04Z", "author": {"login": "rymsha"}, "path": "modules/lib/lib-content/src/main/resources/lib/xp/content.js", "diffHunk": "@@ -512,3 +512,20 @@ exports.getOutboundDependencies = function (params) {\n \n     return __.toNativeObject(bean.execute());\n };\n+\n+/** Resets dropped inherit flags back.\n+ *\n+ * @param {object} params JSON parameters.\n+ * @param {string} params.key Path or id of the content.\n+ * @param {string} params.projectName name of project with content.\n+ * @param {string[]} params.inherit flags to be reset.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de7c6a28641cd2db641b728557639773f3ff4ad0"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 930, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}