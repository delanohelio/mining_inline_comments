{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNjYzNDQy", "number": 12625, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMTo0NDoxM1rOEJ13wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOTo0NjoxNVrOELCISA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NzU1MjY2OnYy", "diffSide": "RIGHT", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMTo0NDoxM1rOGqjTdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMTo0NDoxM1rOGqjTdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI3MTc5Nw==", "bodyText": "why do we make a copy of the user-provided options here?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447271797", "createdAt": "2020-06-29T21:44:13Z", "author": {"login": "srnagar"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "diffHunk": "@@ -687,13 +726,14 @@ private void throwIfAnalyzeStatusInvalid(AnalyzeOperationResult analyzeResponse)\n         return Mono.just(new PollResponse<>(status, operationResultPollResponse.getValue()));\n     }\n \n-    private static Flux<ByteBuffer> getByteBufferFlux(InputStream form, Flux<ByteBuffer> formData) {\n-        Flux<ByteBuffer> buffer;\n-        if (form != null) {\n-            buffer = Utility.toFluxByteBuffer(form);\n+    private RecognizeOptions getRecognizeOptionsProperties(RecognizeOptions userProvidedOptions) {\n+        if (userProvidedOptions != null) {\n+            return new RecognizeOptions()\n+                .setPollInterval(userProvidedOptions.getPollInterval())\n+                .setFormContentType(userProvidedOptions.getFormContentType())\n+                .setIncludeTextContent(userProvidedOptions.isIncludeTextContent());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5e13b90389d9abfa857967ee7e75089f4089600"}, "originalPosition": 380}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NzU5MjQzOnYy", "diffSide": "RIGHT", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMTo1ODoyN1rOGqjrgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjowMDoxM1rOGqjuPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI3Nzk1Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param length The exact length of the data. Size of the file must be less than 50 MB.\n          \n          \n            \n                 * @param length The exact length of the data. Size of the bytebuffer flux must be less than 50 MB.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447277952", "createdAt": "2020-06-29T21:58:27Z", "author": {"login": "srnagar"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "diffHunk": "@@ -271,10 +299,12 @@\n      * {@code Flux} must produce the same data each time it is subscribed to.\n      *\n      * <p><strong>Code sample</strong></p>\n-     * {@codesnippet com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeContent#recognizeOptions}\n+     * {@codesnippet com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeContent#Flux-long-recognizeOptions}\n      *\n-     * @param recognizeOptions The configurable {@code RecognizeOptions options} that may be passed when recognizing\n-     * content on a form.\n+     * @param form The data of the form to recognize content information from.\n+     * @param length The exact length of the data. Size of the file must be less than 50 MB.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5e13b90389d9abfa857967ee7e75089f4089600"}, "originalPosition": 228}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI3ODY1NA==", "bodyText": "Actually, we should just remove this limit from the javadoc as the limit is controlled by the service and an error will be thrown from the service if the limit exceeds. This allows service to increase or decrease the limit dynamically.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447278654", "createdAt": "2020-06-29T22:00:13Z", "author": {"login": "srnagar"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "diffHunk": "@@ -271,10 +299,12 @@\n      * {@code Flux} must produce the same data each time it is subscribed to.\n      *\n      * <p><strong>Code sample</strong></p>\n-     * {@codesnippet com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeContent#recognizeOptions}\n+     * {@codesnippet com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeContent#Flux-long-recognizeOptions}\n      *\n-     * @param recognizeOptions The configurable {@code RecognizeOptions options} that may be passed when recognizing\n-     * content on a form.\n+     * @param form The data of the form to recognize content information from.\n+     * @param length The exact length of the data. Size of the file must be less than 50 MB.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI3Nzk1Mg=="}, "originalCommit": {"oid": "a5e13b90389d9abfa857967ee7e75089f4089600"}, "originalPosition": 228}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NzYwOTA5OnYy", "diffSide": "RIGHT", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjowNDoxMlrOGqj1Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjowNDoxMlrOGqj1Aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI4MDM4Nw==", "bodyText": "Change file to flux of bytebuffer.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447280387", "createdAt": "2020-06-29T22:04:12Z", "author": {"login": "srnagar"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "diffHunk": "@@ -383,10 +425,12 @@\n      * {@code Flux} must produce the same data each time it is subscribed to.\n      *\n      * <p><strong>Code sample</strong></p>\n-     * {@codesnippet com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceipts#recognizeOptions}\n+     * {@codesnippet com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceipts#Flux-long-recognizeOptions}\n      *\n-     * @param recognizeOptions The configurable {@code RecognizeOptions options} that may be passed when recognizing\n-     * receipt data on the provided receipt document.\n+     * @param receipt The data of the document to recognize receipt information from.\n+     * @param length The exact length of the data. Size of the file must be less than 50 MB", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5e13b90389d9abfa857967ee7e75089f4089600"}, "originalPosition": 338}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NzY5MzEwOnYy", "diffSide": "RIGHT", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjoyNTo1MVrOGqkntg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjoyNTo1MVrOGqkntg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI5MzM2Ng==", "bodyText": "subscribe inside another subscribe looks a bit odd. Can we instead use reactor pattern here?\nformRecognizerAsyncClient.beginRecognizeReceiptsFromUrl(...)\n        .flatMap(recognizePollingOperation -> recognizePollingOperation.getFinalResult())\n        .subscribe(recognizedReceipts -> {...});", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447293366", "createdAt": "2020-06-29T22:25:51Z", "author": {"login": "srnagar"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -274,16 +329,68 @@ public void beginRecognizeReceiptsFromUrl() {\n     }\n \n     /**\n-     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceipts(Flux, long, FormContentType)}\n+     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceiptsFromUrl(String, RecognizeOptions)}\n+     */\n+    public void beginRecognizeReceiptsFromUrlWithOptions() {\n+        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string-recognizeOptions\n+        String receiptUrl = \"{file_source_url}\";\n+        boolean includeTextContent = true;\n+        formRecognizerAsyncClient.beginRecognizeReceiptsFromUrl(receiptUrl,\n+            new RecognizeOptions()\n+                .setIncludeTextContent(includeTextContent)\n+                .setPollInterval(Duration.ofSeconds(5)))\n+            .subscribe(recognizePollingOperation -> {\n+                // if training polling operation completed, retrieve the final result.\n+                recognizePollingOperation.getFinalResult().subscribe(recognizedReceipts -> {\n+                    for (int i = 0; i < recognizedReceipts.size(); i++) {\n+                        RecognizedReceipt recognizedReceipt = recognizedReceipts.get(i);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5e13b90389d9abfa857967ee7e75089f4089600"}, "originalPosition": 230}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MTA1MDY3OnYy", "diffSide": "RIGHT", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNjoyMDo0NlrOGrESEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMTozNjoxN1rOGrT54g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ==", "bodyText": "In .NET we call this field ContentType only (without the Form prefix). Are we concerned about consistency in fields names? If formContentType feels more idiomatic to Java, I believe that's not a big concern on the .NET side and can be easily updated.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447812115", "createdAt": "2020-06-30T16:20:46Z", "author": {"login": "kinelski"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkwMDM3MQ==", "bodyText": "I think we agreed to keep this model named FormContentType.\n@kristapratico and @jeremymeng can you confirm what Python and JS have?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447900371", "createdAt": "2020-06-30T18:39:43Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkwNTE2NA==", "bodyText": "The model is called FormContentType as well in .NET. I'm talking about the formContentType, which is simply ContentType in .NET. I know it's private, but since you have the public getFormContentType method, I was wondering whether we should update its name in .NET.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447905164", "createdAt": "2020-06-30T18:48:02Z", "author": {"login": "kinelski"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkxNTYxMQ==", "bodyText": "We renamed the type to FormContentType to differentiate from general content type as only a handful content types are supported.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447915611", "createdAt": "2020-06-30T19:04:59Z", "author": {"login": "jeremymeng"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkyNDgwOA==", "bodyText": "We are all in the same page with the name of the type.\nI think what @kinelski is pointing out is the name of the property. Currently .NET, JS, and Python have Content Type for the property name.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447924808", "createdAt": "2020-06-30T19:22:33Z", "author": {"login": "maririos"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk0MTU3Nw==", "bodyText": "we don't have this in an option bag in JS.  for parameters it's just contentType", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r447941577", "createdAt": "2020-06-30T19:54:34Z", "author": {"login": "jeremymeng"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA0OTY0Mg==", "bodyText": "I am inclined to keep it consistent with the property name unless we have any strong objections.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r448049642", "createdAt": "2020-07-01T00:23:25Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA2ODA2Ng==", "bodyText": "I am not against it, although I will like to understand why the deviation from the other languages though", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r448068066", "createdAt": "2020-07-01T01:36:17Z", "author": {"login": "maririos"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/RecognizeOptions.java", "diffHunk": "@@ -3,64 +3,19 @@\n package com.azure.ai.formrecognizer.models;\n \n import com.azure.core.annotation.Fluent;\n-import reactor.core.publisher.Flux;\n \n-import java.io.InputStream;\n-import java.nio.ByteBuffer;\n import java.time.Duration;\n \n /**\n  * Options that may be passed when using recognize APIs on Form Recognizer client.\n  */\n @Fluent\n public class RecognizeOptions {\n-    private final InputStream form;\n-    private final Flux<ByteBuffer> formData;\n-    private final long length;\n-    private final String formUrl;\n     private FormContentType formContentType;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgxMjExNQ=="}, "originalCommit": {"oid": "f577718a56cdb0c08c186632cd02004cec6fa2f1"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMDA0NjgwOnYy", "diffSide": "RIGHT", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOTo0NjoxNVrOGsa_-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMDowNjoyOVrOGsbg-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIzMjg5MA==", "bodyText": "Use forEach() instead or you can also show the reactor pattern here:\nformRecognizerAsyncClient.beginRecognizeReceipts(buffer, receipt.length())\n     .flatMap(recognizePollingOperation -> recognizePollingOperation.getFinalResult())\n     .flatMap(recognizedReceipts -> Flux.fromIterable(recognizedReceipts))\n     .subscribe(recognizedReceipt -> {...});", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r449232890", "createdAt": "2020-07-02T19:46:15Z", "author": {"login": "srnagar"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -264,115 +323,170 @@ public void beginRecognizeReceiptsFromUrl() {\n                     }\n                 }\n             });\n-        });\n         // END: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string\n     }\n \n     /**\n-     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceipts(Flux, long, FormContentType)}\n+     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceiptsFromUrl(String, RecognizeOptions)}\n+     */\n+    public void beginRecognizeReceiptsFromUrlWithOptions() {\n+        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string-recognizeOptions\n+        String receiptUrl = \"{receiptUrl}\";\n+        boolean includeTextContent = true;\n+        formRecognizerAsyncClient.beginRecognizeReceiptsFromUrl(receiptUrl,\n+            new RecognizeOptions()\n+                .setIncludeFieldElements(includeTextContent)\n+                .setPollInterval(Duration.ofSeconds(5)))\n+            .flatMap(recognizePollingOperation ->\n+                // if training polling operation completed, retrieve the final result.\n+                recognizePollingOperation.getFinalResult())\n+            .subscribe(recognizedReceipts -> {\n+                for (int i = 0; i < recognizedReceipts.size(); i++) {\n+                    RecognizedReceipt recognizedReceipt = recognizedReceipts.get(i);\n+                    Map<String, FormField> recognizedFields = recognizedReceipt.getRecognizedForm().getFields();\n+                    System.out.printf(\"----------- Recognized Receipt page %s -----------%n\", i);\n+                    FormField merchantNameField = recognizedFields.get(\"MerchantName\");\n+                    if (merchantNameField.getFieldValue().getType() == FieldValueType.STRING) {\n+                        System.out.printf(\"Merchant Name: %s, confidence: %.2f%n\",\n+                            merchantNameField.getFieldValue().asString(),\n+                            merchantNameField.getConfidence());\n+                    }\n+                    FormField transactionDateField = recognizedFields.get(\"TransactionDate\");\n+                    if (transactionDateField.getFieldValue().getType() == FieldValueType.DATE) {\n+                        System.out.printf(\"Transaction Date: %s, confidence: %.2f%n\",\n+                            transactionDateField.getFieldValue().asDate(),\n+                            transactionDateField.getConfidence());\n+                    }\n+                    FormField receiptItemsField = recognizedFields.get(\"Items\");\n+                    System.out.printf(\"Receipt Items: %n\");\n+                    if (receiptItemsField.getFieldValue().getType() == FieldValueType.LIST) {\n+                        List<FormField> receiptItems = receiptItemsField.getFieldValue().asList();\n+                        receiptItems.forEach(receiptItem -> {\n+                            if (receiptItem.getFieldValue().getType() == FieldValueType.MAP) {\n+                                receiptItem.getFieldValue().asMap().forEach((key, formField) -> {\n+                                    if (key.equals(\"Quantity\")) {\n+                                        if (formField.getFieldValue().getType() == FieldValueType.INTEGER) {\n+                                            System.out.printf(\"Quantity: %s, confidence: %.2f%n\",\n+                                                formField.getFieldValue().asInteger(), formField.getConfidence());\n+                                        }\n+                                    }\n+                                });\n+                            }\n+                        });\n+                    }\n+                }\n+            });\n+        // END: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string-recognizeOptions\n+    }\n+\n+    /**\n+     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceipts(Flux, long)}\n      *\n      * @throws IOException Exception thrown when there is an error in reading all the bytes from the File.\n      */\n     public void beginRecognizeReceipts() throws IOException {\n-        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceipts#Flux-long-FormContentType\n-        File receipt = new File(\"{local/file_path/fileName.jpg}\");\n-        // Utility method to convert input stream to Byte buffer\n+        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceipts#Flux-long\n+        File receipt = new File(\"{file_source_url}\");\n         Flux<ByteBuffer> buffer = toFluxByteBuffer(new ByteArrayInputStream(Files.readAllBytes(receipt.toPath())));\n-        formRecognizerAsyncClient.beginRecognizeReceipts(buffer, receipt.length(), FormContentType.IMAGE_JPEG)\n-            .subscribe(recognizePollingOperation -> {\n+        formRecognizerAsyncClient.beginRecognizeReceipts(buffer, receipt.length())\n+            .flatMap(recognizePollingOperation ->\n                 // if training polling operation completed, retrieve the final result.\n-                recognizePollingOperation.getFinalResult().subscribe(recognizedReceipts -> {\n-                    for (int i = 0; i < recognizedReceipts.size(); i++) {\n-                        RecognizedReceipt recognizedReceipt = recognizedReceipts.get(i);\n-                        Map<String, FormField> recognizedFields = recognizedReceipt.getRecognizedForm().getFields();\n-                        System.out.printf(\"----------- Recognized Receipt page %s -----------%n\", i);\n-                        FormField merchantNameField = recognizedFields.get(\"MerchantName\");\n-                        if (merchantNameField.getFieldValue().getType() == FieldValueType.STRING) {\n-                            System.out.printf(\"Merchant Name: %s, confidence: %.2f%n\",\n-                                merchantNameField.getFieldValue().asString(),\n-                                merchantNameField.getConfidence());\n-                        }\n-                        FormField transactionDateField = recognizedFields.get(\"TransactionDate\");\n-                        if (transactionDateField.getFieldValue().getType() == FieldValueType.DATE) {\n-                            System.out.printf(\"Transaction Date: %s, confidence: %.2f%n\",\n-                                transactionDateField.getFieldValue().asDate(),\n-                                transactionDateField.getConfidence());\n-                        }\n-                        FormField receiptItemsField = recognizedFields.get(\"Items\");\n-                        System.out.printf(\"Receipt Items: %n\");\n-                        if (receiptItemsField.getFieldValue().getType() == FieldValueType.LIST) {\n-                            List<FormField> receiptItems = receiptItemsField.getFieldValue().asList();\n-                            receiptItems.forEach(receiptItem -> {\n-                                if (receiptItem.getFieldValue().getType() == FieldValueType.MAP) {\n-                                    receiptItem.getFieldValue().asMap().forEach((key, formField) -> {\n-                                        if (key.equals(\"Quantity\")) {\n-                                            if (formField.getFieldValue().getType() == FieldValueType.INTEGER) {\n-                                                System.out.printf(\"Quantity: %s, confidence: %.2f%n\",\n-                                                    formField.getFieldValue().asInteger(), formField.getConfidence());\n-                                            }\n+                recognizePollingOperation.getFinalResult())\n+            .subscribe(recognizedReceipts -> {\n+                for (int i = 0; i < recognizedReceipts.size(); i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8af7125bed7abbc115af554f4cd7677a29e0ad0c"}, "originalPosition": 414}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI0MTMzNg==", "bodyText": "Yep, I am preparing a follow-up PR for sample and snippets update to follow reactor pattern more!", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12625#discussion_r449241336", "createdAt": "2020-07-02T20:06:29Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -264,115 +323,170 @@ public void beginRecognizeReceiptsFromUrl() {\n                     }\n                 }\n             });\n-        });\n         // END: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string\n     }\n \n     /**\n-     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceipts(Flux, long, FormContentType)}\n+     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceiptsFromUrl(String, RecognizeOptions)}\n+     */\n+    public void beginRecognizeReceiptsFromUrlWithOptions() {\n+        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string-recognizeOptions\n+        String receiptUrl = \"{receiptUrl}\";\n+        boolean includeTextContent = true;\n+        formRecognizerAsyncClient.beginRecognizeReceiptsFromUrl(receiptUrl,\n+            new RecognizeOptions()\n+                .setIncludeFieldElements(includeTextContent)\n+                .setPollInterval(Duration.ofSeconds(5)))\n+            .flatMap(recognizePollingOperation ->\n+                // if training polling operation completed, retrieve the final result.\n+                recognizePollingOperation.getFinalResult())\n+            .subscribe(recognizedReceipts -> {\n+                for (int i = 0; i < recognizedReceipts.size(); i++) {\n+                    RecognizedReceipt recognizedReceipt = recognizedReceipts.get(i);\n+                    Map<String, FormField> recognizedFields = recognizedReceipt.getRecognizedForm().getFields();\n+                    System.out.printf(\"----------- Recognized Receipt page %s -----------%n\", i);\n+                    FormField merchantNameField = recognizedFields.get(\"MerchantName\");\n+                    if (merchantNameField.getFieldValue().getType() == FieldValueType.STRING) {\n+                        System.out.printf(\"Merchant Name: %s, confidence: %.2f%n\",\n+                            merchantNameField.getFieldValue().asString(),\n+                            merchantNameField.getConfidence());\n+                    }\n+                    FormField transactionDateField = recognizedFields.get(\"TransactionDate\");\n+                    if (transactionDateField.getFieldValue().getType() == FieldValueType.DATE) {\n+                        System.out.printf(\"Transaction Date: %s, confidence: %.2f%n\",\n+                            transactionDateField.getFieldValue().asDate(),\n+                            transactionDateField.getConfidence());\n+                    }\n+                    FormField receiptItemsField = recognizedFields.get(\"Items\");\n+                    System.out.printf(\"Receipt Items: %n\");\n+                    if (receiptItemsField.getFieldValue().getType() == FieldValueType.LIST) {\n+                        List<FormField> receiptItems = receiptItemsField.getFieldValue().asList();\n+                        receiptItems.forEach(receiptItem -> {\n+                            if (receiptItem.getFieldValue().getType() == FieldValueType.MAP) {\n+                                receiptItem.getFieldValue().asMap().forEach((key, formField) -> {\n+                                    if (key.equals(\"Quantity\")) {\n+                                        if (formField.getFieldValue().getType() == FieldValueType.INTEGER) {\n+                                            System.out.printf(\"Quantity: %s, confidence: %.2f%n\",\n+                                                formField.getFieldValue().asInteger(), formField.getConfidence());\n+                                        }\n+                                    }\n+                                });\n+                            }\n+                        });\n+                    }\n+                }\n+            });\n+        // END: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceiptsFromUrl#string-recognizeOptions\n+    }\n+\n+    /**\n+     * Code snippet for {@link FormRecognizerAsyncClient#beginRecognizeReceipts(Flux, long)}\n      *\n      * @throws IOException Exception thrown when there is an error in reading all the bytes from the File.\n      */\n     public void beginRecognizeReceipts() throws IOException {\n-        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceipts#Flux-long-FormContentType\n-        File receipt = new File(\"{local/file_path/fileName.jpg}\");\n-        // Utility method to convert input stream to Byte buffer\n+        // BEGIN: com.azure.ai.formrecognizer.FormRecognizerAsyncClient.beginRecognizeReceipts#Flux-long\n+        File receipt = new File(\"{file_source_url}\");\n         Flux<ByteBuffer> buffer = toFluxByteBuffer(new ByteArrayInputStream(Files.readAllBytes(receipt.toPath())));\n-        formRecognizerAsyncClient.beginRecognizeReceipts(buffer, receipt.length(), FormContentType.IMAGE_JPEG)\n-            .subscribe(recognizePollingOperation -> {\n+        formRecognizerAsyncClient.beginRecognizeReceipts(buffer, receipt.length())\n+            .flatMap(recognizePollingOperation ->\n                 // if training polling operation completed, retrieve the final result.\n-                recognizePollingOperation.getFinalResult().subscribe(recognizedReceipts -> {\n-                    for (int i = 0; i < recognizedReceipts.size(); i++) {\n-                        RecognizedReceipt recognizedReceipt = recognizedReceipts.get(i);\n-                        Map<String, FormField> recognizedFields = recognizedReceipt.getRecognizedForm().getFields();\n-                        System.out.printf(\"----------- Recognized Receipt page %s -----------%n\", i);\n-                        FormField merchantNameField = recognizedFields.get(\"MerchantName\");\n-                        if (merchantNameField.getFieldValue().getType() == FieldValueType.STRING) {\n-                            System.out.printf(\"Merchant Name: %s, confidence: %.2f%n\",\n-                                merchantNameField.getFieldValue().asString(),\n-                                merchantNameField.getConfidence());\n-                        }\n-                        FormField transactionDateField = recognizedFields.get(\"TransactionDate\");\n-                        if (transactionDateField.getFieldValue().getType() == FieldValueType.DATE) {\n-                            System.out.printf(\"Transaction Date: %s, confidence: %.2f%n\",\n-                                transactionDateField.getFieldValue().asDate(),\n-                                transactionDateField.getConfidence());\n-                        }\n-                        FormField receiptItemsField = recognizedFields.get(\"Items\");\n-                        System.out.printf(\"Receipt Items: %n\");\n-                        if (receiptItemsField.getFieldValue().getType() == FieldValueType.LIST) {\n-                            List<FormField> receiptItems = receiptItemsField.getFieldValue().asList();\n-                            receiptItems.forEach(receiptItem -> {\n-                                if (receiptItem.getFieldValue().getType() == FieldValueType.MAP) {\n-                                    receiptItem.getFieldValue().asMap().forEach((key, formField) -> {\n-                                        if (key.equals(\"Quantity\")) {\n-                                            if (formField.getFieldValue().getType() == FieldValueType.INTEGER) {\n-                                                System.out.printf(\"Quantity: %s, confidence: %.2f%n\",\n-                                                    formField.getFieldValue().asInteger(), formField.getConfidence());\n-                                            }\n+                recognizePollingOperation.getFinalResult())\n+            .subscribe(recognizedReceipts -> {\n+                for (int i = 0; i < recognizedReceipts.size(); i++) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIzMjg5MA=="}, "originalCommit": {"oid": "8af7125bed7abbc115af554f4cd7677a29e0ad0c"}, "originalPosition": 414}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3713, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}