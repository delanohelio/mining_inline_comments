{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5NzgwMDgz", "number": 7166, "title": "Fixes NullReferenceException when using long running producer", "bodyText": "Since our refactoring, we now maintain internal links in each EventHubProducer, before, each producer was associated with a single AMQP link.\n\nMultiple calls to createBatch() would create a new ActiveDirectoryTokenManager. During refresh, the sink would be null.\n\n\nActiveClientTokenManager is rewritten so that the sink is never null using Flux.switchOnNext and EmitterProcessor.\n\nThis problem doesn't exist in PR: #7090\nFixes #7149", "createdAt": "2020-01-07T01:14:14Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7166", "merged": true, "mergeCommit": {"oid": "0f27612640ebd71b79b0b78c64f68a870c71e010"}, "closed": true, "closedAt": "2020-01-07T23:46:53Z", "author": {"login": "conniey"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb33DQdAFqTMzODk5NzM2NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4JIYHgH2gAyMzU5NzgwMDgzOjlmNGYwNzEwMjQwNzcyZjk2YmY4YTBlZWE3MzAxYjQ3ZmI2ZGZmY2U=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4OTk3MzY0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7166#pullrequestreview-338997364", "createdAt": "2020-01-07T02:05:04Z", "commit": {"oid": "71429d51535f059977f61a77b176362f90de175a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwMjowNTowNFrOFauNhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwMjowNTowNFrOFauNhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU2NDQyMg==", "bodyText": "Delete this.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7166#discussion_r363564422", "createdAt": "2020-01-07T02:05:04Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core-amqp/src/test/java/com/azure/core/amqp/implementation/ActiveClientTokenManagerTest.java", "diffHunk": "@@ -48,20 +49,22 @@ public void teardown() {\n      * Verify that we can get successes and errors from CBS node.\n      */\n     @Test\n-    public void getAuthorizationResults() {\n+    void getAuthorizationResults() {\n         // Arrange\n         final Mono<ClaimsBasedSecurityNode> cbsNodeMono = Mono.fromCallable(() -> cbsNode);\n         when(cbsNode.authorize(any(), any())).thenReturn(getNextExpiration(3));\n \n         final ActiveClientTokenManager tokenManager = new ActiveClientTokenManager(cbsNodeMono, AUDIENCE, SCOPES);\n \n         // Act & Assert\n+//        tokenManager.authorize().subscribe();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71429d51535f059977f61a77b176362f90de175a"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "616ad47b0679af5188616d2dd57513ce9abde2c0", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/616ad47b0679af5188616d2dd57513ce9abde2c0", "committedDate": "2020-01-07T20:13:51Z", "message": "Fixing potential NPE when token managers are created multiple times."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe80c486fd9c4d2d6a79db23393598235a1886fd", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fe80c486fd9c4d2d6a79db23393598235a1886fd", "committedDate": "2020-01-07T20:13:52Z", "message": "Fix test assertions."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a549a78c3ebba38a0d63a9abcc35a009e76b1c1", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7a549a78c3ebba38a0d63a9abcc35a009e76b1c1", "committedDate": "2020-01-07T20:13:52Z", "message": "Add test for provider."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76286d1f1650b08a69fb2bc9e29a81c058d39817", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/76286d1f1650b08a69fb2bc9e29a81c058d39817", "committedDate": "2020-01-07T20:13:52Z", "message": "Fixing warning."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b34de9fa3e846167c4b8b17c5af8e74cc4d5f3d7", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b34de9fa3e846167c4b8b17c5af8e74cc4d5f3d7", "committedDate": "2020-01-07T20:13:53Z", "message": "Removing unused line."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bda5b997089f8e33cb6ef811c821ba46e0e0c8a", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0bda5b997089f8e33cb6ef811c821ba46e0e0c8a", "committedDate": "2020-01-07T20:13:53Z", "message": "Fixing indentation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a572672ae84ac01910fbc206a835c81eef4a3aeb", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a572672ae84ac01910fbc206a835c81eef4a3aeb", "committedDate": "2020-01-07T02:58:04Z", "message": "Fixing indentation."}, "afterCommit": {"oid": "0bda5b997089f8e33cb6ef811c821ba46e0e0c8a", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0bda5b997089f8e33cb6ef811c821ba46e0e0c8a", "committedDate": "2020-01-07T20:13:53Z", "message": "Fixing indentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7e8def1129ac4c647f320c6755ca298a1429445", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b7e8def1129ac4c647f320c6755ca298a1429445", "committedDate": "2020-01-07T20:42:27Z", "message": "Add explicit timeouts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fc627ee804f1252613ead70e339b2c782e1822d", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5fc627ee804f1252613ead70e339b2c782e1822d", "committedDate": "2020-01-07T22:20:35Z", "message": "Add timeout."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1e31f216c3385d96e89c3ed107c64b53d2c7f0d", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b1e31f216c3385d96e89c3ed107c64b53d2c7f0d", "committedDate": "2020-01-07T22:35:27Z", "message": "No longer using NPE."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19f55c7d40677517330cefb9784714603add6f70", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/19f55c7d40677517330cefb9784714603add6f70", "committedDate": "2020-01-07T22:41:02Z", "message": "Fixing test scenario"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f4f0710240772f96bf8a0eea7301b47fb6dffce", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9f4f0710240772f96bf8a0eea7301b47fb6dffce", "committedDate": "2020-01-07T23:12:59Z", "message": "Fix spotbug."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 692, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}