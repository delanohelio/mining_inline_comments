{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwMjg5MjEw", "number": 16821, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQyMjozOToyOFrOEyHVyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMTozMjowN1rOEzAnGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwOTg0NTIzOnYy", "diffSide": "RIGHT", "path": "sdk/communication/azure-communication-administration/src/test/resources/session-records/beginReleasePhoneNumbers.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQyMjozOToyOFrOHok_wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQyMjozOToyOFrOHok_wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjMxMTIzMg==", "bodyText": "Should we be redacting the releaseId and phone number details?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r512311232", "createdAt": "2020-10-26T22:39:28Z", "author": {"login": "minnieliu"}, "path": "sdk/communication/azure-communication-administration/src/test/resources/session-records/beginReleasePhoneNumbers.json", "diffHunk": "@@ -0,0 +1,383 @@\n+{\n+    \"networkCallRecords\" : [ {\n+      \"Method\" : \"POST\",\n+      \"Uri\" : \"https://REDACTED.communication.azure.com/administration/phonenumbers/releases?api-version=2020-07-20-preview1\",\n+      \"Headers\" : {\n+        \"User-Agent\" : \"azsdk-java-azure-communication-administration/1.0.0-beta.3 (11.0.8; Windows 10; 10.0)\",\n+        \"Content-Type\" : \"application/json\"\n+      },\n+      \"Response\" : {\n+        \"Transfer-Encoding\" : \"chunked\",\n+        \"X-Processing-Time\" : \"1021ms\",\n+        \"MS-CV\" : \"OkktCzuvUUeGdwjjKSxWpw.0\",\n+        \"retry-after\" : \"0\",\n+        \"X-Azure-Ref\" : \"0GiyXXwAAAACsY2Y2pmWDQ4uF9jhQlzhHREVOMDJFREdFMDMxNAA5ZmM3YjUxOS1hOGNjLTRmODktOTM1ZS1jOTE0OGFlMDllODE=\",\n+        \"StatusCode\" : \"200\",\n+        \"Body\" : \"{\\\"releaseId\\\":\\\"1e671fd9-31e3-4c93-a688-e3c13e865e25\\\"}\",\n+        \"Date\" : \"Mon, 26 Oct 2020 20:05:46 GMT\",\n+        \"Content-Type\" : \"application/json; charset=utf-8\"\n+      },\n+      \"Exception\" : null\n+    }, {\n+      \"Method\" : \"GET\",\n+      \"Uri\" : \"https://REDACTED.communication.azure.com/administration/phonenumbers/releases/1e671fd9-31e3-4c93-a688-e3c13e865e25?api-version=2020-07-20-preview1\",\n+      \"Headers\" : {\n+        \"User-Agent\" : \"azsdk-java-azure-communication-administration/1.0.0-beta.3 (11.0.8; Windows 10; 10.0)\"\n+      },\n+      \"Response\" : {\n+        \"Transfer-Encoding\" : \"chunked\",\n+        \"X-Processing-Time\" : \"447ms\",\n+        \"MS-CV\" : \"LA1nngj23EKnZVRmN3kZHQ.0\",\n+        \"retry-after\" : \"0\",\n+        \"X-Azure-Ref\" : \"0GyyXXwAAAAANStwPu4xJRJ55d7IxiXsAREVOMDJFREdFMDMwOQA5ZmM3YjUxOS1hOGNjLTRmODktOTM1ZS1jOTE0OGFlMDllODE=\",\n+        \"StatusCode\" : \"200\",\n+        \"Body\" : \"{\\\"releaseId\\\":\\\"1e671fd9-31e3-4c93-a688-e3c13e865e25\\\",\\\"createdAt\\\":\\\"2020-10-26T20:05:46.9508456+00:00\\\",\\\"status\\\":\\\"Pending\\\",\\\"phoneNumberReleaseStatusDetails\\\":{\\\"+12134592987\\\":{\\\"status\\\":\\\"Pending\\\"}}}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e90c1a610a797b750e6f2e7b3ad0f343ef6d4225"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwOTg1Mzc2OnYy", "diffSide": "RIGHT", "path": "sdk/communication/azure-communication-administration/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQyMjo0MzowNlrOHolFCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTo0ODowMVrOHpDYCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjMxMjU4Nw==", "bodyText": "Update this to \"Phone number release status\" ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r512312587", "createdAt": "2020-10-26T22:43:06Z", "author": {"login": "minnieliu"}, "path": "sdk/communication/azure-communication-administration/README.md", "diffHunk": "@@ -303,6 +303,22 @@ SyncPoller<Void, Void> res =\n res.waitForCompletion();\n ```\n \n+### Release Phone Numbers\n+<!-- embedme ./src/samples/java/com/azure/communication/administration/ReadmeSamples.java#L399-L409 -->\n+```java\n+    PhoneNumber phoneNumber = new PhoneNumber(\"PHONE_NUMBER_TO_RELEASE\");\n+    List<PhoneNumber> phoneNumbers = new ArrayList<>();\n+    phoneNumbers.add(phoneNumber);\n+    PhoneNumberClient phoneNumberClient = createPhoneNumberClient();\n+\n+    SyncPoller<PhoneNumberRelease, PhoneNumberRelease> res = \n+        phoneNumberClient.beginReleasePhoneNumbers(phoneNumbers, duration);\n+    res.waitForCompletion();\n+    PhoneNumberRelease result = res.getFinalResult();\n+    System.out.println(\"Phone number status: \" + result.getStatus());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e90c1a610a797b750e6f2e7b3ad0f343ef6d4225"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgwODk3MQ==", "bodyText": "Thank you!", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r512808971", "createdAt": "2020-10-27T15:48:01Z", "author": {"login": "jbeauregardb"}, "path": "sdk/communication/azure-communication-administration/README.md", "diffHunk": "@@ -303,6 +303,22 @@ SyncPoller<Void, Void> res =\n res.waitForCompletion();\n ```\n \n+### Release Phone Numbers\n+<!-- embedme ./src/samples/java/com/azure/communication/administration/ReadmeSamples.java#L399-L409 -->\n+```java\n+    PhoneNumber phoneNumber = new PhoneNumber(\"PHONE_NUMBER_TO_RELEASE\");\n+    List<PhoneNumber> phoneNumbers = new ArrayList<>();\n+    phoneNumbers.add(phoneNumber);\n+    PhoneNumberClient phoneNumberClient = createPhoneNumberClient();\n+\n+    SyncPoller<PhoneNumberRelease, PhoneNumberRelease> res = \n+        phoneNumberClient.beginReleasePhoneNumbers(phoneNumbers, duration);\n+    res.waitForCompletion();\n+    PhoneNumberRelease result = res.getFinalResult();\n+    System.out.println(\"Phone number status: \" + result.getStatus());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjMxMjU4Nw=="}, "originalCommit": {"oid": "e90c1a610a797b750e6f2e7b3ad0f343ef6d4225"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTIxMjA5OnYy", "diffSide": "RIGHT", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMToyNzozMFrOHp-ImA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMToyNzozMFrOHp-ImA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3MTY3Mg==", "bodyText": "Similar to other, can you use the default interval here as well?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r513771672", "createdAt": "2020-10-28T21:27:30Z", "author": {"login": "ankitarorabit"}, "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -896,4 +896,67 @@\n         };\n \n     }\n+\n+ /**\n+     * Releases the given phone numbers.\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param phoneNumbers A list of {@link PhoneNumber} with the desired numbers to release\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the release entity\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberRelease, PhoneNumberRelease> \n+        beginReleasePhoneNumbers(List<PhoneNumber> phoneNumbers, Duration pollInterval) {\n+        Objects.requireNonNull(phoneNumbers, \"'phoneNumbers' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f11ee5351b0aa65fc62a7ecd2e45ebd32a9aef0a"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTIxNjYxOnYy", "diffSide": "RIGHT", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMToyODo1NFrOHp-LSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMToyODo1NFrOHp-LSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3MjM2Mg==", "bodyText": "nit: can you move the argument in the above line?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r513772362", "createdAt": "2020-10-28T21:28:54Z", "author": {"login": "ankitarorabit"}, "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -896,4 +896,67 @@\n         };\n \n     }\n+\n+ /**\n+     * Releases the given phone numbers.\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param phoneNumbers A list of {@link PhoneNumber} with the desired numbers to release\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the release entity\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberRelease, PhoneNumberRelease> \n+        beginReleasePhoneNumbers(List<PhoneNumber> phoneNumbers, Duration pollInterval) {\n+        Objects.requireNonNull(phoneNumbers, \"'phoneNumbers' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberRelease, PhoneNumberRelease>(pollInterval,\n+            releaseNumbersActivationOperation(phoneNumbers),\n+            releaseNumbersPollOperation(),\n+            (activationResponse, pollingContext) ->\n+            monoError(logger, new RuntimeException(\"Cancellation is not supported\")),\n+            releaseNumbersFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberRelease>, Mono<PhoneNumberRelease>> \n+        releaseNumbersActivationOperation(List<PhoneNumber> phoneNumbers) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberRelease> response = releasePhoneNumbers(phoneNumbers)\n+                .flatMap(releaseNumberResponse -> {\n+                    String releaseId = releaseNumberResponse.getReleaseId();\n+                    Mono<PhoneNumberRelease> phoneNumberRelease = getReleaseById(releaseId);\n+                    return phoneNumberRelease;\n+                });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberRelease>, \n+        Mono<PollResponse<PhoneNumberRelease>>> ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f11ee5351b0aa65fc62a7ecd2e45ebd32a9aef0a"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTIyNDcxOnYy", "diffSide": "RIGHT", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMTozMTowMlrOHp-P0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMTozMTowMlrOHp-P0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3MzUyMg==", "bodyText": "Didnt we say that we will not block and instead use stepVerifier in tests?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r513773522", "createdAt": "2020-10-28T21:31:02Z", "author": {"login": "ankitarorabit"}, "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -525,6 +494,22 @@ public void beginPurchaseSearch(HttpClient httpClient) {\n             .verifyComplete();\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"com.azure.core.test.TestBase#getHttpClients\")\n+    public void beginReleasePhoneNumbers(HttpClient httpClient) {\n+        PhoneNumber phoneNumber = new PhoneNumber(PHONENUMBER_TO_RELEASE);\n+        List<PhoneNumber> phoneNumbers = new ArrayList<>();\n+        phoneNumbers.add(phoneNumber);\n+        Duration pollInterval = Duration.ofSeconds(5);\n+        PollerFlux<PhoneNumberRelease, PhoneNumberRelease> poller =\n+            this.getClient(httpClient).beginReleasePhoneNumbers(phoneNumbers, pollInterval);\n+        AsyncPollResponse<PhoneNumberRelease, PhoneNumberRelease> asyncRes = ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f11ee5351b0aa65fc62a7ecd2e45ebd32a9aef0a"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTIyODQwOnYy", "diffSide": "RIGHT", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMTozMjowN1rOHp-R9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMTozNTowOFrOHp-XuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3NDA2OA==", "bodyText": "I am not sure what the developers will understand out of PhoneNumberRelease, can't we have a better naming atleast for this?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r513774068", "createdAt": "2020-10-28T21:32:07Z", "author": {"login": "ankitarorabit"}, "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -896,4 +896,67 @@\n         };\n \n     }\n+\n+ /**\n+     * Releases the given phone numbers.\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param phoneNumbers A list of {@link PhoneNumber} with the desired numbers to release\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the release entity\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberRelease, PhoneNumberRelease> ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f11ee5351b0aa65fc62a7ecd2e45ebd32a9aef0a"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3NTU0NA==", "bodyText": "Ideally, I would want to see something more meaningful -- do we know how other languages are solving this?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16821#discussion_r513775544", "createdAt": "2020-10-28T21:35:08Z", "author": {"login": "ankitarorabit"}, "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -896,4 +896,67 @@\n         };\n \n     }\n+\n+ /**\n+     * Releases the given phone numbers.\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param phoneNumbers A list of {@link PhoneNumber} with the desired numbers to release\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the release entity\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberRelease, PhoneNumberRelease> ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3NDA2OA=="}, "originalCommit": {"oid": "f11ee5351b0aa65fc62a7ecd2e45ebd32a9aef0a"}, "originalPosition": 50}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3852, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}