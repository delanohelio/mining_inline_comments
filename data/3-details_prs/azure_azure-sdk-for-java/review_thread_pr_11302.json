{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5OTgxMTg5", "number": 11302, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOToxMjowOFrOD9tX5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOToxMzozMlrOD9taIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDMzMTI0OnYy", "diffSide": "RIGHT", "path": "sdk/management/azure/src/main/java/com/azure/management/Azure.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOToxMjowOFrOGXXOGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOTo0MToxMFrOGXYVPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1MDg3Mw==", "bodyText": "Is it possible to find a more specific exception type? RuntimeException is generally only viewed as abstract base class. Maybe IllegalStateException, or InvalidArgumentException (if we take that defaultSubscription only works for 1 subscription).", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11302#discussion_r427150873", "createdAt": "2020-05-19T09:12:08Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/management/azure/src/main/java/com/azure/management/Azure.java", "diffHunk": "@@ -325,8 +331,25 @@ public Azure withSubscription(String subscriptionId) {\n         @Override\n         public Azure withDefaultSubscription() {\n             if (profile.subscriptionId() == null) {\n-                throw logger.logExceptionAsError(\n-                    new IllegalArgumentException(\"Please specify the subscription ID for resource management.\"));\n+                List<Subscription> subscriptions = new ArrayList<>();\n+                this.subscriptions().list().forEach(subscription -> {\n+                    subscriptions.add(subscription);\n+                });\n+                if (subscriptions.size() == 0) {\n+                    throw logger.logExceptionAsError(\n+                        new RuntimeException(\"Please create a subscription before you start resource management. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f97d7f9b1859df2c3b7eceab12f76fcf48b2de5"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2MjE0Ng==", "bodyText": "Two candidates:\n\nIllegalStateException :\n\n\nSignals that a method has been invoked at an illegal or inappropriate time. In other words, the Java environment or Java application is not in an appropriate state for the requested operation.\n\n\nUnsupportedOperationException :\n\n\nThrown to indicate that the requested operation is not supported.\n\nMaybe UnsupportedOperationException is better? The withDefaultSubscription() is not supported when no subscription found or more than one subscription found.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11302#discussion_r427162146", "createdAt": "2020-05-19T09:30:02Z", "author": {"login": "xseeseesee"}, "path": "sdk/management/azure/src/main/java/com/azure/management/Azure.java", "diffHunk": "@@ -325,8 +331,25 @@ public Azure withSubscription(String subscriptionId) {\n         @Override\n         public Azure withDefaultSubscription() {\n             if (profile.subscriptionId() == null) {\n-                throw logger.logExceptionAsError(\n-                    new IllegalArgumentException(\"Please specify the subscription ID for resource management.\"));\n+                List<Subscription> subscriptions = new ArrayList<>();\n+                this.subscriptions().list().forEach(subscription -> {\n+                    subscriptions.add(subscription);\n+                });\n+                if (subscriptions.size() == 0) {\n+                    throw logger.logExceptionAsError(\n+                        new RuntimeException(\"Please create a subscription before you start resource management. \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1MDg3Mw=="}, "originalCommit": {"oid": "3f97d7f9b1859df2c3b7eceab12f76fcf48b2de5"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2NDY1Ng==", "bodyText": "UnsupportedOperationException is not good here. It is most commonly used in optional operation, which can be left unimplemented at all (like https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#add(E)).\nSo I would vote IllegalStateException.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11302#discussion_r427164656", "createdAt": "2020-05-19T09:34:03Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/management/azure/src/main/java/com/azure/management/Azure.java", "diffHunk": "@@ -325,8 +331,25 @@ public Azure withSubscription(String subscriptionId) {\n         @Override\n         public Azure withDefaultSubscription() {\n             if (profile.subscriptionId() == null) {\n-                throw logger.logExceptionAsError(\n-                    new IllegalArgumentException(\"Please specify the subscription ID for resource management.\"));\n+                List<Subscription> subscriptions = new ArrayList<>();\n+                this.subscriptions().list().forEach(subscription -> {\n+                    subscriptions.add(subscription);\n+                });\n+                if (subscriptions.size() == 0) {\n+                    throw logger.logExceptionAsError(\n+                        new RuntimeException(\"Please create a subscription before you start resource management. \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1MDg3Mw=="}, "originalCommit": {"oid": "3f97d7f9b1859df2c3b7eceab12f76fcf48b2de5"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2OTA4NA==", "bodyText": "Got it. It's not the same as InvalidOperationException in csharp. So it's like the withDefaultSubscription() cannot be done at this time due to some restrictions if we pick IllegalStateException.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11302#discussion_r427169084", "createdAt": "2020-05-19T09:41:10Z", "author": {"login": "xseeseesee"}, "path": "sdk/management/azure/src/main/java/com/azure/management/Azure.java", "diffHunk": "@@ -325,8 +331,25 @@ public Azure withSubscription(String subscriptionId) {\n         @Override\n         public Azure withDefaultSubscription() {\n             if (profile.subscriptionId() == null) {\n-                throw logger.logExceptionAsError(\n-                    new IllegalArgumentException(\"Please specify the subscription ID for resource management.\"));\n+                List<Subscription> subscriptions = new ArrayList<>();\n+                this.subscriptions().list().forEach(subscription -> {\n+                    subscriptions.add(subscription);\n+                });\n+                if (subscriptions.size() == 0) {\n+                    throw logger.logExceptionAsError(\n+                        new RuntimeException(\"Please create a subscription before you start resource management. \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1MDg3Mw=="}, "originalCommit": {"oid": "3f97d7f9b1859df2c3b7eceab12f76fcf48b2de5"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDMzNjk4OnYy", "diffSide": "RIGHT", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/implementation/ResourceManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOToxMzozMlrOGXXRnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOToxMzozMlrOGXXRnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1MTc3Mg==", "bodyText": "Is it possible to share some code?\nMaybe Azure could call some util method in Resources?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11302#discussion_r427151772", "createdAt": "2020-05-19T09:13:32Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/implementation/ResourceManager.java", "diffHunk": "@@ -192,8 +198,25 @@ public ResourceManager withSubscription(String subscriptionId) {\n         @Override\n         public ResourceManager withDefaultSubscription() {\n             if (profile.subscriptionId() == null) {\n-                throw logger.logExceptionAsError(\n-                    new IllegalArgumentException(\"Please specify the subscription ID for resource management.\"));\n+                List<Subscription> subscriptions = new ArrayList<>();\n+                this.subscriptions().list().forEach(subscription -> {\n+                    subscriptions.add(subscription);\n+                });\n+                if (subscriptions.size() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f97d7f9b1859df2c3b7eceab12f76fcf48b2de5"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4177, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}