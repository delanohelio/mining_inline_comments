{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzNjkyNjU4", "number": 17678, "title": "Vijay receive message ttl fix", "bodyText": "Fixing a regression introduced in the last release 3.5.0.\nAlso bumping up the version as a patch on the last released version.", "createdAt": "2020-11-19T05:45:16Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17678", "merged": true, "mergeCommit": {"oid": "8db7cef7e9f26ca94856d4fbe92bb0fdff73da46"}, "closed": true, "closedAt": "2020-11-19T22:15:41Z", "author": {"login": "yvgopal"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdd75gZgH2gAyNTIzNjkyNjU4OmM4ZWUyZGU5NmNhMTRmYjQ0ZmFlZDI5MjI3ZmY3MjJlZjdmNmU2MjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeJGSzgFqTUzNDg0MDE2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c8ee2de96ca14fb44faed29227ff722ef7f6e620", "author": {"user": {"login": "yvgopal", "name": "Vijaya Gopal Yarramneni"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c8ee2de96ca14fb44faed29227ff722ef7f6e620", "committedDate": "2020-11-19T05:28:15Z", "message": "Fixing a regresion in message converter."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15d0292a7791125cf0502c8c08913e0ff1313c5b", "author": {"user": {"login": "yvgopal", "name": "Vijaya Gopal Yarramneni"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/15d0292a7791125cf0502c8c08913e0ff1313c5b", "committedDate": "2020-11-19T05:43:36Z", "message": "Changing version number."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0ODQwMTY0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17678#pullrequestreview-534840164", "createdAt": "2020-11-19T20:50:53Z", "commit": {"oid": "15d0292a7791125cf0502c8c08913e0ff1313c5b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDo1MDo1M1rOH2xHBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDo1MDo1M1rOH2xHBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE4OTc2NQ==", "bodyText": "I understand that this override is done for a long time ,  Why is it done in first place ? If  amqpMessage.getTtl()    is positive , this override is needed ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17678#discussion_r527189765", "createdAt": "2020-11-19T20:50:53Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/microsoft-azure-servicebus/src/main/java/com/microsoft/azure/servicebus/MessageConverter.java", "diffHunk": "@@ -131,14 +131,20 @@ public static Message convertAmqpMessageToBrokeredMessage(org.apache.qpid.proton\n         // Header\n         // Delivery count for service bus starts from 1, for AMQP it starts from 0.\n         brokeredMessage.setDeliveryCount(amqpMessage.getDeliveryCount() + 1);\n-        brokeredMessage.setTimeToLive(Duration.ofMillis(amqpMessage.getTtl()));\n-        \n+        long ttlMillis = amqpMessage.getTtl();\n+        if (ttlMillis > 0l) {\n+        \tbrokeredMessage.setTimeToLive(Duration.ofMillis(ttlMillis));\n+        }\n \n         // Properties\n         // Override TimeToLive from CrationTime and ExpiryTime, as they support duration of any length, which ttl doesn't\n         if (amqpMessage.getCreationTime() != 0l && amqpMessage.getExpiryTime() != 0l) {\n-        \tbrokeredMessage.setTimeToLive(Duration.ofMillis(amqpMessage.getExpiryTime() - amqpMessage.getCreationTime()));\n+        \tttlMillis = amqpMessage.getExpiryTime() - amqpMessage.getCreationTime();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0292a7791125cf0502c8c08913e0ff1313c5b"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1592, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}