{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMTMyMDYw", "number": 15418, "title": "update aad endpoints in readmes", "bodyText": "Update AAD endpoints in READMEs to v2, modified files include:\n\nazure-spring-boot-sample-active-directory-backend-v2/README.md\nazure-spring-boot-sample-active-directory-backend/README.md\nazure-spring-boot-starter-active-directory/README.md", "createdAt": "2020-09-21T08:30:56Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418", "merged": true, "mergeCommit": {"oid": "f1bd81eab130270cbbee78f31995a54a30735c20"}, "closed": true, "closedAt": "2020-09-22T02:37:52Z", "author": {"login": "yiliuTo"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdK_H4FAH2gAyNDkwMTMyMDYwOmFkMGMyOTMyNjFkZTg3MzQzNGZmMTliYWM3NGJmZDljOWE1NjRlMTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLOpSNAFqTQ5MzA5NDM0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13", "author": {"user": {"login": "yiliuTo", "name": "Yi Liu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/ad0c293261de873434ff19bac74bfd9c9a564e13", "committedDate": "2020-09-21T08:29:06Z", "message": "update aad endpoints in readmes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNDAwOTkz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#pullrequestreview-492400993", "createdAt": "2020-09-21T09:03:30Z", "commit": {"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwOTowMzozMFrOHVGjJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwOTowNzoyMlrOHVGrog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4OTQ0Ng==", "bodyText": "Why update azure-oauth-provider to azure? the provider name is azure-oauth-provider here, see L77", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491889446", "createdAt": "2020-09-21T09:03:30Z", "author": {"login": "zhoufenqin"}, "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -80,10 +80,10 @@ spring.security.oauth2.client.registration.azure.redirect-uri-template={baseUrl}\n spring.security.oauth2.client.registration.azure.client-authentication-method=basic\n spring.security.oauth2.client.registration.azure.authorization-grant-type=authorization_code\n \n-spring.security.oauth2.client.provider.azure-oauth-provider.authorization-uri=https://login.microsoftonline.com/common/oauth2/authorize\n-spring.security.oauth2.client.provider.azure-oauth-provider.token-uri=https://login.microsoftonline.com/common/oauth2/token\n-spring.security.oauth2.client.provider.azure-oauth-provider.user-info-uri=https://login.microsoftonline.com/common/openid/userinfo\n-spring.security.oauth2.client.provider.azure-oauth-provider.jwk-set-uri=https://login.microsoftonline.com/common/discovery/keys\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/v2.0/authorize", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4OTk5NA==", "bodyText": "I think there is an error here, spring.security.oauth2.client.registration.azure.redirect-uri-template should update to spring.security.oauth2.client.registration.azure.redirect-uri\nand do we need to add profile in spring.security.oauth2.client.registration.azure.scope?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491889994", "createdAt": "2020-09-21T09:04:31Z", "author": {"login": "zhoufenqin"}, "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -80,10 +80,10 @@ spring.security.oauth2.client.registration.azure.redirect-uri-template={baseUrl}\n spring.security.oauth2.client.registration.azure.client-authentication-method=basic", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg5MDI3NA==", "bodyText": "same above", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491890274", "createdAt": "2020-09-21T09:05:00Z", "author": {"login": "zhoufenqin"}, "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -97,10 +97,10 @@ In this auto-configuration, by [default](https://github.com/Azure/azure-sdk-for-\n \n Configure endpoints with specific tenant-id by replacing `common` in your application.properties file:\n ```properties\n-spring.security.oauth2.client.provider.azure-oauth-provider.authorization-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/authorize\n-spring.security.oauth2.client.provider.azure-oauth-provider.token-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/token\n-spring.security.oauth2.client.provider.azure-oauth-provider.user-info-uri=https://login.microsoftonline.com/{your-tenant-id}/openid/userinfo\n-spring.security.oauth2.client.provider.azure-oauth-provider.jwk-set-uri=https://login.microsoftonline.com/{your-tenant-id}/discovery/keys\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/v2.0/authorize", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg5MTYxOA==", "bodyText": "Here I think we don't need to update {your-tenant-id} to common, see the description above. L90-93", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491891618", "createdAt": "2020-09-21T09:07:22Z", "author": {"login": "zhoufenqin"}, "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend/README.md", "diffHunk": "@@ -92,10 +92,10 @@ In this auto-configuration, by [default](https://github.com/Azure/azure-sdk-for-\n \n Configure endpoints with specific tenant-id by replacing `common` in your application.properties file:\n ```properties\n-spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/authorize\n-spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/token\n-spring.security.oauth2.client.provider.azure.user-info-uri=https://login.microsoftonline.com/{your-tenant-id}/openid/userinfo\n-spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/{your-tenant-id}/discovery/keys\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/v2.0/authorize\n+spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/common/oauth2/v2.0/token\n+spring.security.oauth2.client.provider.azure.user-info-uri=https://graph.microsoft.com/oidc/userinfo\n+spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/common/discovery/v2.0/keys\n ```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2645fe0ebc75d51005f167708c2b307b4b80d7a6", "author": {"user": {"login": "yiliuTo", "name": "Yi Liu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2645fe0ebc75d51005f167708c2b307b4b80d7a6", "committedDate": "2020-09-21T09:49:50Z", "message": "update property in readme from redirect-uri-template to redirect-uri"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNDY4NzM4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#pullrequestreview-492468738", "createdAt": "2020-09-21T10:37:39Z", "commit": {"oid": "2645fe0ebc75d51005f167708c2b307b4b80d7a6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMDozNzo0MFrOHVJ32g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMDozNzo0MFrOHVJ32g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk0Mzg5OA==", "bodyText": "Do we need to show the v1 usage here @saragluna", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491943898", "createdAt": "2020-09-21T10:37:40Z", "author": {"login": "zhoufenqin"}, "path": "sdk/spring/azure-spring-boot-starter-active-directory/README.md", "diffHunk": "@@ -199,12 +199,13 @@ azure.activedirectory.environment=cn-v2-graph\n Please refer to [azure-spring-boot-sample-active-directory-backend-v2](https://github.com/Azure/azure-sdk-for-java/blob/master/sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md) to see a sample configured to use the Microsoft Graph API.\n \n ### Using Microsoft identity platform endpoints\n-If you want to use v2 version endpoints to do authorization and authentication, please pay attention to the attributes of claims, because there are some attributes exists in v1 version id-token by default but not in v2 version id-token, if you have to get that attribute, please make sure to add it into your scope.\n-There is the doc [Difference between v1 and v2](https://docs.microsoft.com/azure/active-directory/develop/azure-ad-endpoint-comparison), For example, the name attribute doesn't exist in v2 token, if you want it, you need add `profile` to your scope, like this:\n-```properties\n-spring.security.oauth2.client.registration.azure.scope=openid, https://graph.microsoft.com/user.read, profile\n+This starter uses v2 version endpoints to do authorization and authentication by default. To use v1.0, please specify the following endpoints in properties.\n+```\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/authorize\n+spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/common/oauth2/token\n+spring.security.oauth2.client.provider.azure.user-info-uri=https://login.microsoftonline.com/common/openid/userinfo\n+spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/common/discovery/keys\n ```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2645fe0ebc75d51005f167708c2b307b4b80d7a6"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e697c3e71787b13951b1239f2eabcd8845b3314d", "author": {"user": {"login": "yiliuTo", "name": "Yi Liu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e697c3e71787b13951b1239f2eabcd8845b3314d", "committedDate": "2020-09-21T12:15:42Z", "message": "add section for replace endpoints of v1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMDgyOTM1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#pullrequestreview-493082935", "createdAt": "2020-09-22T01:43:05Z", "commit": {"oid": "2645fe0ebc75d51005f167708c2b307b4b80d7a6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwMTo0MzowNVrOHVn06w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwMTo0MzowNVrOHVn06w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQzNDY2Nw==", "bodyText": "We already used azure-oauth-provider, to keep same style, should we use azure-client instead of azure here?\nRefs: https://docs.spring.io/spring-boot/docs/2.3.4.RELEASE/reference/html/spring-boot-features.html#boot-features-security-oauth2-client\nOr rename all azure-oauth-provider to azure.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r492434667", "createdAt": "2020-09-22T01:43:05Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -75,15 +75,15 @@ spring.security.oauth2.client.registration.azure.client-id=xxxxxx-your-client-id\n spring.security.oauth2.client.registration.azure.client-secret=xxxxxx-your-client-secret-xxxxxx\n spring.security.oauth2.client.registration.azure.client-name=Azure\n spring.security.oauth2.client.registration.azure.provider=azure-oauth-provider\n-spring.security.oauth2.client.registration.azure.scope=openid, https://graph.microsoft.com/user.read\n-spring.security.oauth2.client.registration.azure.redirect-uri-template={baseUrl}/login/oauth2/code/{registrationId}\n+spring.security.oauth2.client.registration.azure.scope=openid, https://graph.microsoft.com/user.read, profile\n+spring.security.oauth2.client.registration.azure.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2645fe0ebc75d51005f167708c2b307b4b80d7a6"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMDgzODkx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#pullrequestreview-493083891", "createdAt": "2020-09-22T01:47:15Z", "commit": {"oid": "e697c3e71787b13951b1239f2eabcd8845b3314d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e60bc5516500ac37fb84a6cc0bb37f7bf08fe04", "author": {"user": {"login": "yiliuTo", "name": "Yi Liu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5e60bc5516500ac37fb84a6cc0bb37f7bf08fe04", "committedDate": "2020-09-22T02:04:46Z", "message": "replace OAuth2ClientProperties name from azure to azure-oauth-client"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMDk0MzQ4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#pullrequestreview-493094348", "createdAt": "2020-09-22T02:34:10Z", "commit": {"oid": "5e60bc5516500ac37fb84a6cc0bb37f7bf08fe04"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3429, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}