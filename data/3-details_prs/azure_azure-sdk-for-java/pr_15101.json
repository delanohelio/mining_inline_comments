{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0ODM1MjMy", "number": 15101, "title": "Make code easier to read", "bodyText": "", "createdAt": "2020-09-11T08:59:46Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101", "merged": true, "mergeCommit": {"oid": "2a5327e823604153619ef8a85bcd24ebcc069d4e"}, "closed": true, "closedAt": "2020-09-15T06:33:59Z", "author": {"login": "chenrujun"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHxKJOAH2gAyNDg0ODM1MjMyOmRmNTMwZDQ5ZGQxMzI1OGZmZTFlNzA0ZWNlZGVmZmM4YjMyNWM1MTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJB39hgFqTQ4ODM2MzkyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "df530d49dd13258ffe1e704ecedeffc8b325c512", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/df530d49dd13258ffe1e704ecedeffc8b325c512", "committedDate": "2020-09-11T08:31:08Z", "message": "No logic change, just make code easier to read."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbc178df8fed6f6591f26626b498acb954aa4fc9", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dbc178df8fed6f6591f26626b498acb954aa4fc9", "committedDate": "2020-09-11T08:37:06Z", "message": "Add class: AccessTokenClaims."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46c897c676289520dec57bdb50f56c80b8643cb8", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/46c897c676289520dec57bdb50f56c80b8643cb8", "committedDate": "2020-09-11T08:52:55Z", "message": "No logic change, just make code easier to read."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1b55d0d4459250a4f3da710c37fa74f60bdcce1", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b1b55d0d4459250a4f3da710c37fa74f60bdcce1", "committedDate": "2020-09-11T08:58:53Z", "message": "Remame AccessTokenClaim to AccessTokenClaims."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "945e2f38ba0a84142ad4cda34d496684e7059bc1", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/945e2f38ba0a84142ad4cda34d496684e7059bc1", "committedDate": "2020-09-11T09:06:00Z", "message": "Combine 2 kinds of Exception, delete ErrorCode."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99acb6cc896c00f0c221e9e1eff896d986972147", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/99acb6cc896c00f0c221e9e1eff896d986972147", "committedDate": "2020-09-11T09:25:29Z", "message": "Add AADOAuth2ErrorCode."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9f9724f59a6c72873eb261e1551ebcedf64cd61", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b9f9724f59a6c72873eb261e1551ebcedf64cd61", "committedDate": "2020-09-11T09:28:08Z", "message": "Rename AccessTokenClaim to AADAccessTokenClaim."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb622c8ca2fdbf386628918112a1bc6663d7b437", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/eb622c8ca2fdbf386628918112a1bc6663d7b437", "committedDate": "2020-09-11T09:49:43Z", "message": "No logic change, just make code easier to read."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9b36fb1c552e7d77f5d256572fc8c8c80983bd0", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e9b36fb1c552e7d77f5d256572fc8c8c80983bd0", "committedDate": "2020-09-11T09:52:06Z", "message": "setStatus before sendRedirect."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2OTI1NDMz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101#pullrequestreview-486925433", "createdAt": "2020-09-11T15:51:01Z", "commit": {"oid": "e9b36fb1c552e7d77f5d256572fc8c8c80983bd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNTo1MTowMVrOHQkYjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNTo1MTowMVrOHQkYjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzEzNTM3NA==", "bodyText": "this is just a style comment, but I personally find the original form of the throw (1 line versus 5 lines) easier to read.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101#discussion_r487135374", "createdAt": "2020-09-11T15:51:01Z", "author": {"login": "joshfree"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AADOAuth2UserService.java", "diffHunk": "@@ -50,25 +45,44 @@ public OidcUser loadUser(OidcUserRequest userRequest) throws OAuth2Authenticatio\n             // https://github.com/MicrosoftDocs/azure-docs/issues/8121#issuecomment-387090099\n             // In AAD App Registration configure oauth2AllowImplicitFlow to true\n             final ClientRegistration registration = userRequest.getClientRegistration();\n-            final AzureADGraphClient graphClient = new AzureADGraphClient(\n+            final AzureADGraphClient azureADGraphClient = new AzureADGraphClient(\n                 registration.getClientId(),\n                 registration.getClientSecret(),\n-                aadAuthProps,\n-                serviceEndpointsProps\n+                aadAuthenticationProperties,\n+                serviceEndpointsProperties\n             );\n-            String graphApiToken = graphClient\n-                .acquireTokenForGraphApi(userRequest.getIdToken().getTokenValue(), aadAuthProps.getTenantId())\n+            String graphApiToken = azureADGraphClient\n+                .acquireTokenForGraphApi(\n+                    userRequest.getIdToken().getTokenValue(),\n+                    aadAuthenticationProperties.getTenantId()\n+                )\n                 .accessToken();\n-            mappedAuthorities = graphClient.getGrantedAuthorities(graphApiToken);\n+            mappedAuthorities = azureADGraphClient.getGrantedAuthorities(graphApiToken);\n         } catch (MalformedURLException e) {\n-            throw wrapException(INVALID_REQUEST, \"Failed to acquire token for Graph API.\", null, e);\n+            throw toOAuth2AuthenticationException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9b36fb1c552e7d77f5d256572fc8c8c80983bd0"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2OTI1NjUw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101#pullrequestreview-486925650", "createdAt": "2020-09-11T15:51:19Z", "commit": {"oid": "e9b36fb1c552e7d77f5d256572fc8c8c80983bd0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16fbf66b7d658140403804e643e8a775140e59d9", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/16fbf66b7d658140403804e643e8a775140e59d9", "committedDate": "2020-09-14T08:25:20Z", "message": "No logic change, just make code easier to read."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77becea05b2ab8dce44ddf571ef71fd9118efdda", "author": {"user": {"login": "chenrujun", "name": "Rujun Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/77becea05b2ab8dce44ddf571ef71fd9118efdda", "committedDate": "2020-09-15T00:57:14Z", "message": "Fix error reported by maven-checkstyle-plugin."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MzYzOTI5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101#pullrequestreview-488363929", "createdAt": "2020-09-15T06:33:35Z", "commit": {"oid": "77becea05b2ab8dce44ddf571ef71fd9118efdda"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3421, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}