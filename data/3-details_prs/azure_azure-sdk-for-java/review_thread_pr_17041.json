{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMzQ4NDI4", "number": 17041, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMToxMDo1M1rOEz_6CA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMzo1OTo1NVrOE4aMDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTU5ODgwOnYy", "diffSide": "RIGHT", "path": "eng/docgeneration/Generate-DocIndex.ps1", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMToxMDo1M1rOHrj08Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMToxMDo1M1rOHrj08Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQzNzgwOQ==", "bodyText": "For testing purpose, will revert the change once ready to merge", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17041#discussion_r515437809", "createdAt": "2020-10-31T01:10:53Z", "author": {"login": "sima-zhu"}, "path": "eng/docgeneration/Generate-DocIndex.ps1", "diffHunk": "@@ -98,9 +98,9 @@ function GenerateDocfxTocContent([Hashtable]$tocContent, [String]$lang) {\n     $DocOutDir = \"${RepoRoot}/docfx_project\"\n \n     LogDebug \"Initializing Default DocFx Site...\"\n-    & $($DocFx) init -q -o \"${DocOutDir}\"\n+    #& $($DocFx) init -q -o \"${DocOutDir}\"\n     # The line below is used for testing in local\n-    #docfx init -q -o \"${DocOutDir}\"\n+    docfx init -q -o \"${DocOutDir}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3680e2d736b9ca0b043c99e71b6da063a7b56961"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2OTg5MDI1OnYy", "diffSide": "RIGHT", "path": "eng/docgeneration/templates/matthews/styles/main.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxOToyMDo0NFrOHxa-7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxOToyMDo0NFrOHxa-7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU4NDM2NQ==", "bodyText": "If GA or preview is missing lets just not show that list item. Also lets not add any text just have the version link.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17041#discussion_r521584365", "createdAt": "2020-11-11T19:20:44Z", "author": {"login": "weshaggard"}, "path": "eng/docgeneration/templates/matthews/styles/main.js", "diffHunk": "@@ -78,24 +79,62 @@ function httpGetAsync(targetUrl, callback) {\n }\n \n function populateIndexList(selector, packageName) {\n-    url = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/versions\"\n-\n-    httpGetAsync(url, function (responseText) {\n-\n-        var publishedversions = document.createElement(\"ul\")\n+    var url = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/versions\"\n+    var latestGAUrl = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/latest-ga\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f9c8197acf97d43132b014320a7c89b5b8eb8ed"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2OTg5NDA3OnYy", "diffSide": "RIGHT", "path": "eng/docgeneration/templates/matthews/styles/main.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxOToyMTo1MlrOHxbBKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMzozODozOVrOHyTTBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU4NDkzNw==", "bodyText": "Lets see if we can make the other versions text align with the other list bullets.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17041#discussion_r521584937", "createdAt": "2020-11-11T19:21:52Z", "author": {"login": "weshaggard"}, "path": "eng/docgeneration/templates/matthews/styles/main.js", "diffHunk": "@@ -78,24 +79,62 @@ function httpGetAsync(targetUrl, callback) {\n }\n \n function populateIndexList(selector, packageName) {\n-    url = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/versions\"\n-\n-    httpGetAsync(url, function (responseText) {\n-\n-        var publishedversions = document.createElement(\"ul\")\n+    var url = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/versions\"\n+    var latestGAUrl = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/latest-ga\"\n+    var latestPreviewUrl = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/latest-preview\"\n+    var latestVersions = document.createElement(\"ul\")\n+    httpGetAsync(latestGAUrl, function (responseText) {\n         if (responseText) {\n-            options = responseText.match(/[^\\r\\n]+/g)\n-\n-            for (var i in options) {\n-                $(publishedversions).append('<li><a href=\"' + getPackageUrl(SELECTED_LANGUAGE, packageName, options[i]) + '\" target=\"_blank\">' + options[i] + '</a></li>')\n-            }\n+            version = responseText.match(/[^\\r\\n]+/g)\n+            $(latestVersions).append('<li><a href=\"' + getPackageUrl(SELECTED_LANGUAGE, packageName, version) + '\" target=\"_blank\">' + 'Latest GA Version: ' + version + '</a></li>')\n         }\n         else {\n-            $(publishedversions).append('<li>No discovered versions present in blob storage.</li>')\n+            $(latestVersions).append('<li>No latest GA versions found.</li>')\n+        }                \n+    })\n+    httpGetAsync(latestPreviewUrl, function (responseText) {\n+        if (responseText) {\n+            version = responseText.match(/[^\\r\\n]+/g)\n+            $(latestVersions).append('<li><a href=\"' + getPackageUrl(SELECTED_LANGUAGE, packageName, version) + '\" target=\"_blank\">' + 'Latest Preview Version: ' + version + '</a></li>')\n         }\n-\n-        $(selector).after(publishedversions)\n+        else {\n+            $(latestVersions).append('<li>No latest Preview versions found.</li>')\n+        }                \n     })\n+    var publishedVersions = $('<ul style=\"display: none;\"></ul>')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f9c8197acf97d43132b014320a7c89b5b8eb8ed"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUwNzAxMw==", "bodyText": "Done.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17041#discussion_r522507013", "createdAt": "2020-11-12T23:38:39Z", "author": {"login": "sima-zhu"}, "path": "eng/docgeneration/templates/matthews/styles/main.js", "diffHunk": "@@ -78,24 +79,62 @@ function httpGetAsync(targetUrl, callback) {\n }\n \n function populateIndexList(selector, packageName) {\n-    url = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/versions\"\n-\n-    httpGetAsync(url, function (responseText) {\n-\n-        var publishedversions = document.createElement(\"ul\")\n+    var url = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/versions\"\n+    var latestGAUrl = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/latest-ga\"\n+    var latestPreviewUrl = \"https://azuresdkdocs.blob.core.windows.net/$web/\" + SELECTED_LANGUAGE + \"/\" + packageName + \"/versioning/latest-preview\"\n+    var latestVersions = document.createElement(\"ul\")\n+    httpGetAsync(latestGAUrl, function (responseText) {\n         if (responseText) {\n-            options = responseText.match(/[^\\r\\n]+/g)\n-\n-            for (var i in options) {\n-                $(publishedversions).append('<li><a href=\"' + getPackageUrl(SELECTED_LANGUAGE, packageName, options[i]) + '\" target=\"_blank\">' + options[i] + '</a></li>')\n-            }\n+            version = responseText.match(/[^\\r\\n]+/g)\n+            $(latestVersions).append('<li><a href=\"' + getPackageUrl(SELECTED_LANGUAGE, packageName, version) + '\" target=\"_blank\">' + 'Latest GA Version: ' + version + '</a></li>')\n         }\n         else {\n-            $(publishedversions).append('<li>No discovered versions present in blob storage.</li>')\n+            $(latestVersions).append('<li>No latest GA versions found.</li>')\n+        }                \n+    })\n+    httpGetAsync(latestPreviewUrl, function (responseText) {\n+        if (responseText) {\n+            version = responseText.match(/[^\\r\\n]+/g)\n+            $(latestVersions).append('<li><a href=\"' + getPackageUrl(SELECTED_LANGUAGE, packageName, version) + '\" target=\"_blank\">' + 'Latest Preview Version: ' + version + '</a></li>')\n         }\n-\n-        $(selector).after(publishedversions)\n+        else {\n+            $(latestVersions).append('<li>No latest Preview versions found.</li>')\n+        }                \n     })\n+    var publishedVersions = $('<ul style=\"display: none;\"></ul>')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU4NDkzNw=="}, "originalCommit": {"oid": "2f9c8197acf97d43132b014320a7c89b5b8eb8ed"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3NTg0NzgwOnYy", "diffSide": "RIGHT", "path": "eng/docgeneration/Generate-DocIndex.ps1", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMzo1OTo1NVrOHyT66A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwMDowODo0NVrOHyUFXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUxNzIyNA==", "bodyText": "orthogonal but I'm curious why you don't just remove these and just pass docfx as a parameter?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17041#discussion_r522517224", "createdAt": "2020-11-12T23:59:55Z", "author": {"login": "weshaggard"}, "path": "eng/docgeneration/Generate-DocIndex.ps1", "diffHunk": "@@ -134,9 +134,9 @@ function GenerateDocfxTocContent([Hashtable]$tocContent, [String]$lang) {\n     Copy-Item \"$($RepoRoot)/CONTRIBUTING.md\" -Destination \"${DocOutDir}/api/CONTRIBUTING.md\" -Force\n \n     LogDebug \"Building site...\"\n-    & $($DocFx) build \"${DocOutDir}/docfx.json\"\n+    #& $($DocFx) build \"${DocOutDir}/docfx.json\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edda34232ac84af243c89d1ffaf1e3ec9082c7f6"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUxOTkwMQ==", "bodyText": "It is better to pass the docfx path in my local run. I am using nuget and npm command to install docfx commands. Have some trouble to find the right path. The best approach is to pass the path as an argument.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17041#discussion_r522519901", "createdAt": "2020-11-13T00:08:45Z", "author": {"login": "sima-zhu"}, "path": "eng/docgeneration/Generate-DocIndex.ps1", "diffHunk": "@@ -134,9 +134,9 @@ function GenerateDocfxTocContent([Hashtable]$tocContent, [String]$lang) {\n     Copy-Item \"$($RepoRoot)/CONTRIBUTING.md\" -Destination \"${DocOutDir}/api/CONTRIBUTING.md\" -Force\n \n     LogDebug \"Building site...\"\n-    & $($DocFx) build \"${DocOutDir}/docfx.json\"\n+    #& $($DocFx) build \"${DocOutDir}/docfx.json\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUxNzIyNA=="}, "originalCommit": {"oid": "edda34232ac84af243c89d1ffaf1e3ec9082c7f6"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3824, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}