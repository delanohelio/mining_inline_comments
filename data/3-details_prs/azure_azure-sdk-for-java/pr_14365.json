{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyMjU5NTMz", "number": 14365, "title": "Mgmt Appplatform: update and change some API", "bodyText": "leave a large change to another PR with two different flow for deployment", "createdAt": "2020-08-24T05:03:31Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365", "merged": true, "mergeCommit": {"oid": "6176e3f5150d268474d2f41d73b9a00e63a73755"}, "closed": true, "closedAt": "2020-08-25T05:03:45Z", "author": {"login": "ChenTanyi"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_t5RsAH2gAyNDcyMjU5NTMzOmQzNzhmNmVkNjQ0YzcxYjFkMWMxMzYyZTg2NWYxMmNmMGI2MjRiNGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCPH8OAH2gAyNDcyMjU5NTMzOjE4MmQxMTFiM2M5YzU1NjMwNTUyMTc4NmRjNTUxZWMwYTM2NzZiZmI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d378f6ed644c71b1d1c1362e865f12cf0b624b4e", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d378f6ed644c71b1d1c1362e865f12cf0b624b4e", "committedDate": "2020-08-17T08:11:36Z", "message": "update api-spec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c700c11645fe6c93218b07c9f3c48d73e103477", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6c700c11645fe6c93218b07c9f3c48d73e103477", "committedDate": "2020-08-17T08:12:09Z", "message": "generate app platform"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00f92ec050d8016bd8d10aedcf89714874fc89bb", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/00f92ec050d8016bd8d10aedcf89714874fc89bb", "committedDate": "2020-08-17T09:10:24Z", "message": "fix compile error and update api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c3ce08d9a9f73d1609fcb726c0149958daed215", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/3c3ce08d9a9f73d1609fcb726c0149958daed215", "committedDate": "2020-08-18T06:50:49Z", "message": "update service when needed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd8b9023efb39581dbda71892e5a5b27cc9623df", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/cd8b9023efb39581dbda71892e5a5b27cc9623df", "committedDate": "2020-08-18T06:50:53Z", "message": "add active deployment api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7584d188e150860befbcb04c90f8c7783ee1705", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b7584d188e150860befbcb04c90f8c7783ee1705", "committedDate": "2020-08-18T06:53:06Z", "message": "remove deploy from app"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f809cbcaaa1480932a041e0228afee9bb5bd3a89", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f809cbcaaa1480932a041e0228afee9bb5bd3a89", "committedDate": "2020-08-18T07:22:43Z", "message": "remove setting from other deployment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1073cec0570cc7939079bca406e77c7731818001", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1073cec0570cc7939079bca406e77c7731818001", "committedDate": "2020-08-18T07:23:09Z", "message": "remove useless impl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "934abd47b7e84699702a9a5bd05b28ce8a19b488", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/934abd47b7e84699702a9a5bd05b28ce8a19b488", "committedDate": "2020-08-18T07:47:14Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4800b6147332cae1580e035be66fb7aa2f2b35dd", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/4800b6147332cae1580e035be66fb7aa2f2b35dd", "committedDate": "2020-08-24T01:56:25Z", "message": "remove compression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c342d2bdb6e568a801c14f6bc3795f067002385", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7c342d2bdb6e568a801c14f6bc3795f067002385", "committedDate": "2020-08-24T02:05:34Z", "message": "compress to test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0c0b4097848f8a8cb095bb8c7ca9642ac2a1c5c", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a0c0b4097848f8a8cb095bb8c7ca9642ac2a1c5c", "committedDate": "2020-08-24T02:23:24Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59f111d200c86a3489497ff30af4be1ac7d67398", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/59f111d200c86a3489497ff30af4be1ac7d67398", "committedDate": "2020-08-24T03:32:54Z", "message": "update test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMTI4NDY5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365#pullrequestreview-473128469", "createdAt": "2020-08-24T05:27:08Z", "commit": {"oid": "59f111d200c86a3489497ff30af4be1ac7d67398"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwNToyNzowOFrOHFVE8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwNToyNzowOFrOHFVE8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM1MDI1OA==", "bodyText": "Better to have an object configured, and delay postRunDependency to e.g. beforeCreating", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365#discussion_r475350258", "createdAt": "2020-08-24T05:27:08Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/resourcemanager/azure-resourcemanager-appplatform/src/main/java/com/azure/resourcemanager/appplatform/implementation/SpringServiceImpl.java", "diffHunk": "@@ -107,70 +121,80 @@ public SpringServiceImpl withSku(String skuName, int capacity) {\n \n     @Override\n     public SpringServiceImpl withSku(Sku sku) {\n+        needUpdate = true;\n         inner().withSku(sku);\n         return this;\n     }\n \n     @Override\n     public SpringServiceImpl withTracing(String appInsightInstrumentationKey) {\n-        if (inner().properties() == null) {\n-            inner().withProperties(new ClusterResourceProperties());\n-        }\n-        inner().properties().withTrace(\n-            new TraceProperties().withAppInsightInstrumentationKey(appInsightInstrumentationKey).withEnabled(true));\n+        this.addPostRunDependent(\n+            context -> manager().inner().getMonitoringSettings()\n+                .updatePatchAsync(resourceGroupName(), name(), new MonitoringSettingProperties()\n+                    .withAppInsightsInstrumentationKey(appInsightInstrumentationKey)\n+                    .withTraceEnabled(true))\n+                .then(context.voidMono())\n+        );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59f111d200c86a3489497ff30af4be1ac7d67398"}, "originalPosition": 97}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMTM0MDQz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365#pullrequestreview-473134043", "createdAt": "2020-08-24T05:45:15Z", "commit": {"oid": "59f111d200c86a3489497ff30af4be1ac7d67398"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7deabea4334f1edbcc8ab9d9cb2d02e592e7ad0e", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7deabea4334f1edbcc8ab9d9cb2d02e592e7ad0e", "committedDate": "2020-08-24T06:19:18Z", "message": "deployment with instance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7171542ec40b1a091a819b10a221d2721527374e", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7171542ec40b1a091a819b10a221d2721527374e", "committedDate": "2020-08-24T06:19:53Z", "message": "update test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66b6e885ec226fc6bff3f1108245536c1dc8d602", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/66b6e885ec226fc6bff3f1108245536c1dc8d602", "committedDate": "2020-08-24T08:49:17Z", "message": "prepare for post run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMjgyMTMz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365#pullrequestreview-473282133", "createdAt": "2020-08-24T09:21:31Z", "commit": {"oid": "66b6e885ec226fc6bff3f1108245536c1dc8d602"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMjg3NDg3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14365#pullrequestreview-473287487", "createdAt": "2020-08-24T09:25:57Z", "commit": {"oid": "66b6e885ec226fc6bff3f1108245536c1dc8d602"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f187bd763ea411e416dd605064c0a75b21e98d3", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0f187bd763ea411e416dd605064c0a75b21e98d3", "committedDate": "2020-08-25T03:27:27Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "182d111b3c9c556305521786dc551ec0a3676bfb", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/182d111b3c9c556305521786dc551ec0a3676bfb", "committedDate": "2020-08-25T04:02:20Z", "message": "fix spotbug"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 197, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}