{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MjY4ODc1", "number": 11195, "title": "share artifact staging. add release stage", "bodyText": "@Azure/azure-sdk-eng\nEdit: @mitchdenny, @JimSuplizio  for brevity to not handle the -signed versus unsigned, I just swapped anything parsing the artifacts to use the unsigned artifacts folder.\nI don't believe we actually care about the signed values, due to the fact we're actually going after metadata or the raw html, but I feel that it's a callout that I should make.\nEdit: Successful Release", "createdAt": "2020-05-14T22:02:30Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195", "merged": true, "mergeCommit": {"oid": "a67beaf874bbd301ba568fc40ce88c51e3c52206"}, "closed": true, "closedAt": "2020-05-20T22:46:35Z", "author": {"login": "scbedd"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchU1TFAH2gAyNDE4MjY4ODc1OmEyN2UwNGE1Zjk2MTBmY2M1MTJiOWFmY2YyMmQ0YzAyZWRkOWRiYjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjMhYMgFqTQxNTU2MDE4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a27e04a5f9610fcc512b9afcf22d4c02edd9dbb4", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a27e04a5f9610fcc512b9afcf22d4c02edd9dbb4", "committedDate": "2020-05-14T22:01:54Z", "message": "share artifact staging. add release stage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbbad4a8ec28a24a097eb85d5deda314025de7dc", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fbbad4a8ec28a24a097eb85d5deda314025de7dc", "committedDate": "2020-05-14T22:58:32Z", "message": "update default argument"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMjU4NTky", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195#pullrequestreview-412258592", "createdAt": "2020-05-14T23:48:27Z", "commit": {"oid": "fbbad4a8ec28a24a097eb85d5deda314025de7dc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMzo0ODoyN1rOGVx3-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMzo0ODoyN1rOGVx3-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ5MDQyNQ==", "bodyText": "orthogonal to your change but we probably should see about moving these to the latest windows image, windows-2019", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195#discussion_r425490425", "createdAt": "2020-05-14T23:48:27Z", "author": {"login": "weshaggard"}, "path": "eng/pipelines/templates/stages/archetype-java-release.yml", "diffHunk": "@@ -85,21 +87,58 @@ stages:\n                 deploy:\n                   steps:\n                     - checkout: self\n-                    - pwsh: |\n-                        Get-ChildItem $(Pipeline.Workspace)/${{parameters.ArtifactName}}-signed\n-                        New-Item -Type Directory -Name ${{artifact.safeName}} -Path $(Pipeline.Workspace)\n-                        Copy-Item $(Pipeline.Workspace)/${{parameters.ArtifactName}}-signed/${{artifact.name}}-[0-9]*.[0-9]*.[0-9]* $(Pipeline.Workspace)/${{artifact.safeName}}\n-                        Get-ChildItem $(Pipeline.Workspace)/${{artifact.safeName}}\n-                      workingDirectory: $(Pipeline.Workspace)\n+                    - template: /eng/pipelines/templates/steps/stage-filtered-artifacts.yml\n+                      parameters:\n+                        SourceFolder: ${{parameters.ArtifactName}} \n+                        TargetFolder: ${{artifact.safeName}}\n+                        PackageName: ${{artifact.name}}\n                       displayName: Stage artifacts\n-                      timeoutInMinutes: 5\n                     - template: /eng/common/pipelines/templates/steps/create-tags-and-git-release.yml\n                       parameters:\n                         ArtifactLocation: $(Pipeline.Workspace)/${{artifact.safeName}}\n                         PackageRepository: Maven\n                         ReleaseSha: $(Build.SourceVersion)\n                         RepoId: Azure/azure-sdk-for-java\n \n+\n+          - ${{if ne(artifact.options.skipPublishDocs, 'true')}}:\n+            - deployment: PublicDocsMs\n+              displayName: \"Publish Updates for Docs.MS\"\n+              condition: and(succeeded(), ne(variables['Skip.PublishDocs'], 'true'))\n+              environment: github\n+              timeoutInMinutes: 5\n+              dependsOn: VerifyReleaseVersion\n+\n+              pool:\n+                vmImage: vs2017-win2016", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fbbad4a8ec28a24a097eb85d5deda314025de7dc"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af6fe4ed4018fd9f07c3ddb921cbf015153647ad", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/af6fe4ed4018fd9f07c3ddb921cbf015153647ad", "committedDate": "2020-05-15T00:11:36Z", "message": "update target doc repository"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dada083a5314265353be2295989d8dd4a758346a", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dada083a5314265353be2295989d8dd4a758346a", "committedDate": "2020-05-15T18:10:06Z", "message": "swap everything to use the signed artifacts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc012f34572b606153587a5c77db97e6fdefdebf", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bc012f34572b606153587a5c77db97e6fdefdebf", "committedDate": "2020-05-18T21:39:38Z", "message": "get rid of erroneous objects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "401934523452814d673514a702914d29f571db6e", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/401934523452814d673514a702914d29f571db6e", "committedDate": "2020-05-18T22:24:19Z", "message": "resolve bad yml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f08dd665a6e31336e24102cf30d677a2d942730c", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f08dd665a6e31336e24102cf30d677a2d942730c", "committedDate": "2020-05-18T22:36:37Z", "message": "commenting publish for easy execution. bumping template version for easy test of the release functionality"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cede1333dc1ae1671ed156e95f046a4acfa11fec", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/cede1333dc1ae1671ed156e95f046a4acfa11fec", "committedDate": "2020-05-19T00:09:02Z", "message": "updating versions so this can actually launch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb6e832ac2782c9d663b65cdf38cf994c9f84365", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bb6e832ac2782c9d663b65cdf38cf994c9f84365", "committedDate": "2020-05-19T01:07:29Z", "message": "set dependsOn value for update docs.ms to publishpackage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5574ffc7ec6fa0e92a7600502ceb76a191b7baa", "author": {"user": {"login": "scbedd", "name": "Scott Beddall"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a5574ffc7ec6fa0e92a7600502ceb76a191b7baa", "committedDate": "2020-05-19T01:07:58Z", "message": "re-enable publishing to maven. artifact staging seems to be working appropriately"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a72537c20aeae8b028b26ec7b46c6033d4bdc6b4", "author": {"user": {"login": "JimSuplizio", "name": "James Suplizio"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a72537c20aeae8b028b26ec7b46c6033d4bdc6b4", "committedDate": "2020-05-19T13:42:23Z", "message": "Update CHANGELOG.md\n\n1.0.4-beta.15 is \"Unreleased\", it wasn't released yesterday."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDYxNjAy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195#pullrequestreview-414461602", "createdAt": "2020-05-19T13:46:09Z", "commit": {"oid": "a72537c20aeae8b028b26ec7b46c6033d4bdc6b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjYxOTA0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195#pullrequestreview-414661904", "createdAt": "2020-05-19T17:19:36Z", "commit": {"oid": "a72537c20aeae8b028b26ec7b46c6033d4bdc6b4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzoxOTozNlrOGXqpJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzoxOTozNlrOGXqpJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ2OTA5NA==", "bodyText": "We should consider adding the \"-signed\" as part of the template.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195#discussion_r427469094", "createdAt": "2020-05-19T17:19:36Z", "author": {"login": "weshaggard"}, "path": "eng/pipelines/templates/stages/archetype-java-release.yml", "diffHunk": "@@ -85,14 +87,11 @@ stages:\n                 deploy:\n                   steps:\n                     - checkout: self\n-                    - pwsh: |\n-                        Get-ChildItem $(Pipeline.Workspace)/${{parameters.ArtifactName}}-signed\n-                        New-Item -Type Directory -Name ${{artifact.safeName}} -Path $(Pipeline.Workspace)\n-                        Copy-Item $(Pipeline.Workspace)/${{parameters.ArtifactName}}-signed/${{artifact.name}}-[0-9]*.[0-9]*.[0-9]* $(Pipeline.Workspace)/${{artifact.safeName}}\n-                        Get-ChildItem $(Pipeline.Workspace)/${{artifact.safeName}}\n-                      workingDirectory: $(Pipeline.Workspace)\n-                      displayName: Stage artifacts\n-                      timeoutInMinutes: 5\n+                    - template: /eng/pipelines/templates/steps/stage-artifacts.yml\n+                      parameters:\n+                        SourceFolder: ${{parameters.ArtifactName}}-signed", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a72537c20aeae8b028b26ec7b46c6033d4bdc6b4"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NTYwMTg0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11195#pullrequestreview-415560184", "createdAt": "2020-05-20T17:28:45Z", "commit": {"oid": "a72537c20aeae8b028b26ec7b46c6033d4bdc6b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4310, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}