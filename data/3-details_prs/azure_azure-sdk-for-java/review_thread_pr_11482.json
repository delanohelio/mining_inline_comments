{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MTQ0NTI1", "number": 11482, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMzoxMTo0NlrOEATlTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMzoxMzoyMVrOEATmuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NzU2MzAyOnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedUdfsTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMzoxMTo0N1rOGbgSpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMDo0NTowNlrOGbh-Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5Mzc5OA==", "bodyText": "result validation validates page size, etc. that may fail. you need to update the validation section.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11482#discussion_r431493798", "createdAt": "2020-05-27T23:11:47Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedUdfsTest.java", "diffHunk": "@@ -37,12 +37,10 @@ public ReadFeedUdfsTest(CosmosClientBuilder clientBuilder) {\n \n     @Test(groups = { \"simple\" }, timeOut = FEED_TIMEOUT)\n     public void readUserDefinedFunctions() throws Exception {\n-\n-        FeedOptions options = new FeedOptions();\n         int maxItemCount = 2;\n \n         CosmosPagedFlux<CosmosUserDefinedFunctionProperties> feedObservable = createdCollection.getScripts()\n-                                                                                               .readAllUserDefinedFunctions(options);\n+                                                                                               .readAllUserDefinedFunctions();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e21262d1f70a82cc28a448a0f033fbe17f8904c2"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyMTM3MA==", "bodyText": "Page sizes are controlled by maxItemCount which is no longer part of the FeedOptions since when we start returning PageFlux as results.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11482#discussion_r431521370", "createdAt": "2020-05-28T00:45:06Z", "author": {"login": "milismsft"}, "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedUdfsTest.java", "diffHunk": "@@ -37,12 +37,10 @@ public ReadFeedUdfsTest(CosmosClientBuilder clientBuilder) {\n \n     @Test(groups = { \"simple\" }, timeOut = FEED_TIMEOUT)\n     public void readUserDefinedFunctions() throws Exception {\n-\n-        FeedOptions options = new FeedOptions();\n         int maxItemCount = 2;\n \n         CosmosPagedFlux<CosmosUserDefinedFunctionProperties> feedObservable = createdCollection.getScripts()\n-                                                                                               .readAllUserDefinedFunctions(options);\n+                                                                                               .readAllUserDefinedFunctions();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5Mzc5OA=="}, "originalCommit": {"oid": "e21262d1f70a82cc28a448a0f033fbe17f8904c2"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NzU2MzUwOnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedUsersTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMzoxMTo1NFrOGbgS6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMDo0NDo0NlrOGbh9_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5Mzg2NA==", "bodyText": "result validation validates page size, etc. that may fail. you need to update the validation section.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11482#discussion_r431493864", "createdAt": "2020-05-27T23:11:54Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedUsersTest.java", "diffHunk": "@@ -37,11 +37,9 @@ public ReadFeedUsersTest(CosmosClientBuilder clientBuilder) {\n \n     @Test(groups = { \"simple\" }, timeOut = FEED_TIMEOUT)\n     public void readUsers() throws Exception {\n-\n-        FeedOptions options = new FeedOptions();\n         int maxItemCount = 2;\n \n-        CosmosPagedFlux<CosmosUserProperties> feedObservable = createdDatabase.readAllUsers(options);\n+        CosmosPagedFlux<CosmosUserProperties> feedObservable = createdDatabase.readAllUsers();\n \n         int expectedPageSize = (createdUsers.size() + maxItemCount - 1) / maxItemCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e21262d1f70a82cc28a448a0f033fbe17f8904c2"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyMTI3Ng==", "bodyText": "Page sizes are controlled by maxItemCount which is no longer part of the FeedOptions since when we start returning PageFlux as results.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11482#discussion_r431521276", "createdAt": "2020-05-28T00:44:46Z", "author": {"login": "milismsft"}, "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedUsersTest.java", "diffHunk": "@@ -37,11 +37,9 @@ public ReadFeedUsersTest(CosmosClientBuilder clientBuilder) {\n \n     @Test(groups = { \"simple\" }, timeOut = FEED_TIMEOUT)\n     public void readUsers() throws Exception {\n-\n-        FeedOptions options = new FeedOptions();\n         int maxItemCount = 2;\n \n-        CosmosPagedFlux<CosmosUserProperties> feedObservable = createdDatabase.readAllUsers(options);\n+        CosmosPagedFlux<CosmosUserProperties> feedObservable = createdDatabase.readAllUsers();\n \n         int expectedPageSize = (createdUsers.size() + maxItemCount - 1) / maxItemCount;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5Mzg2NA=="}, "originalCommit": {"oid": "e21262d1f70a82cc28a448a0f033fbe17f8904c2"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NzU2NjY3OnYy", "diffSide": "LEFT", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedDatabasesTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMzoxMzoyMVrOGbgUzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMDo0MzoxMFrOGbh8fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5NDM0OA==", "bodyText": "the page size validation may fail.\n        int expectedPageSize = (allDatabases.size() + maxItemCount - 1) / maxItemCount;\n        FeedResponseListValidator<CosmosDatabaseProperties> validator = new FeedResponseListValidator.Builder<CosmosDatabaseProperties>()\n                .totalSize(allDatabases.size())\n                .exactlyContainsInAnyOrder(allDatabases.stream().map(d -> d.getResourceId()).collect(Collectors.toList()))\n                .numberOfPages(expectedPageSize)\n                .pageSatisfy(0, new FeedResponseValidator.Builder<CosmosDatabaseProperties>()\n                        .requestChargeGreaterThanOrEqualTo(1.0).build())\n                .build();\n\n        validateQuerySuccess(feedObservable.byPage(maxItemCount), validator, FEED_TIMEOUT);", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11482#discussion_r431494348", "createdAt": "2020-05-27T23:13:21Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedDatabasesTest.java", "diffHunk": "@@ -36,11 +36,9 @@ public ReadFeedDatabasesTest(CosmosClientBuilder clientBuilder) {\n \n     @Test(groups = { \"simple\" }, timeOut = FEED_TIMEOUT)\n     public void readDatabases() throws Exception {\n-\n-        FeedOptions options = new FeedOptions();\n         int maxItemCount = 2;\n \n-        CosmosPagedFlux<CosmosDatabaseProperties> feedObservable = client.readAllDatabases(options);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e21262d1f70a82cc28a448a0f033fbe17f8904c2"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyMDg5NQ==", "bodyText": "I'm not seeing any test failures when run locally...\nI'm not sure I understand the concern since we already moved the maxItemCount out of the FeedOptions when we transitioned to return PageFlux results... Plus under the new API we do exactly what the test does, which is to call the now package private readAll*() API with a \"new FeedOptions()\" argument value.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11482#discussion_r431520895", "createdAt": "2020-05-28T00:43:10Z", "author": {"login": "milismsft"}, "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ReadFeedDatabasesTest.java", "diffHunk": "@@ -36,11 +36,9 @@ public ReadFeedDatabasesTest(CosmosClientBuilder clientBuilder) {\n \n     @Test(groups = { \"simple\" }, timeOut = FEED_TIMEOUT)\n     public void readDatabases() throws Exception {\n-\n-        FeedOptions options = new FeedOptions();\n         int maxItemCount = 2;\n \n-        CosmosPagedFlux<CosmosDatabaseProperties> feedObservable = client.readAllDatabases(options);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5NDM0OA=="}, "originalCommit": {"oid": "e21262d1f70a82cc28a448a0f033fbe17f8904c2"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4083, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}