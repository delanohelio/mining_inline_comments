{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3ODA1ODY3", "number": 16638, "title": "[FR] Add support for Selection Mark feature", "bodyText": "Added a new feature, Selection Mark.\n\nImplementation\nSamples (URL sample will be added later after the selectionMark PDF file is merged)\nTest\nREADME & CHANGELOG\n\n\n\nfixes: #14886\n\nRemoved a duplicate static constant value, Duration.ofSecond(5);", "createdAt": "2020-10-21T19:13:40Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638", "merged": true, "mergeCommit": {"oid": "76aa5f15d23ff8f5bd5baaa08667fb3d890fe16f"}, "closed": true, "closedAt": "2020-10-23T19:03:02Z", "author": {"login": "mssfang"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUyO7ogH2gAyNTA3ODA1ODY3OjFmNjk3MzViYzljMzMyNzU4YmQ0ZjQ5NmI1M2ZjZmNkMWU5MmY3ZTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVahBrgFqTUxNTg5MTE2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1f69735bc9c332758bd4f496b53fcfcd1e92f7e5", "committedDate": "2020-10-21T19:07:17Z", "message": "Init commit for SelectionMark"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MTAxNjc3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-514101677", "createdAt": "2020-10-21T19:16:21Z", "commit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxOToxNjoyMVrOHl_pGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxOToxNjoyMVrOHl_pGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYwMjA3NA==", "bodyText": "delete it because nowhere is using this method.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509602074", "createdAt": "2020-10-21T19:16:21Z", "author": {"login": "mssfang"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/TestUtils.java", "diffHunk": "@@ -70,22 +69,6 @@ static InputStream getContentDetectionFileData(String localFileUrl) {\n         }\n     }\n \n-    static Flux<ByteBuffer> getReplayableBufferData(String localFileUrl) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MTM0MDkx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-514134091", "createdAt": "2020-10-21T19:52:28Z", "commit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "state": "COMMENTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxOTo1MjoyOFrOHmBLFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMDowNjoyM1rOHmCE5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYyNzE1OA==", "bodyText": "No need to create the boundingBoxStr. You could leverage the BoundingBox.toString()", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509627158", "createdAt": "2020-10-21T19:52:28Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/README.md", "diffHunk": "@@ -245,6 +246,14 @@ for (int i = 0; i < contentPageResults.size(); i++) {\n         formTable.getCells().forEach(formTableCell ->\n             System.out.printf(\"Cell has text %s.%n\", formTableCell.getText()));\n     });\n+    // Selection Mark\n+    formPage.getSelectionMarks().forEach(selectionMark -> {\n+        StringBuilder boundingBoxStr = new StringBuilder();\n+        selectionMark.getBoundingBox().getPoints().forEach(\n+            point -> boundingBoxStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYyOTY3MA==", "bodyText": "nit: Don't need the full qualifier?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509629670", "createdAt": "2020-10-21T19:54:18Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/Transforms.java", "diffHunk": "@@ -360,25 +396,48 @@ private static float setDefaultConfidenceValue(Float confidence) {\n             .collect(Collectors.toList());\n     }\n \n+    /**\n+     * Helper method to convert the service level field value selection marks to SDK level model.\n+     *\n+     * @param fieldValueSelectionMark The field value selection mark state, i.e., SELECTED and UNSELECTED.\n+     *\n+     * @return The selection mark state in the SDK level model.\n+     */\n+    private static SelectionMarkState toFieldValueSelectionMarkState(\n+        com.azure.ai.formrecognizer.implementation.models.FieldValueSelectionMark fieldValueSelectionMark) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzMTQ1Mw==", "bodyText": "Rather than assigning the result value, you can just return?\n return SelectionMarkState.SELECTED;", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509631453", "createdAt": "2020-10-21T19:55:47Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/Transforms.java", "diffHunk": "@@ -360,25 +396,48 @@ private static float setDefaultConfidenceValue(Float confidence) {\n             .collect(Collectors.toList());\n     }\n \n+    /**\n+     * Helper method to convert the service level field value selection marks to SDK level model.\n+     *\n+     * @param fieldValueSelectionMark The field value selection mark state, i.e., SELECTED and UNSELECTED.\n+     *\n+     * @return The selection mark state in the SDK level model.\n+     */\n+    private static SelectionMarkState toFieldValueSelectionMarkState(\n+        com.azure.ai.formrecognizer.implementation.models.FieldValueSelectionMark fieldValueSelectionMark) {\n+        SelectionMarkState result = null;\n+        if (com.azure.ai.formrecognizer.implementation.models.FieldValueSelectionMark.SELECTED.equals(\n+            fieldValueSelectionMark)) {\n+            result = SelectionMarkState.SELECTED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzMTkwNg==", "bodyText": "This is an elseif what happens when none of the conditions are true?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509631906", "createdAt": "2020-10-21T19:56:17Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/Transforms.java", "diffHunk": "@@ -360,25 +396,48 @@ private static float setDefaultConfidenceValue(Float confidence) {\n             .collect(Collectors.toList());\n     }\n \n+    /**\n+     * Helper method to convert the service level field value selection marks to SDK level model.\n+     *\n+     * @param fieldValueSelectionMark The field value selection mark state, i.e., SELECTED and UNSELECTED.\n+     *\n+     * @return The selection mark state in the SDK level model.\n+     */\n+    private static SelectionMarkState toFieldValueSelectionMarkState(\n+        com.azure.ai.formrecognizer.implementation.models.FieldValueSelectionMark fieldValueSelectionMark) {\n+        SelectionMarkState result = null;\n+        if (com.azure.ai.formrecognizer.implementation.models.FieldValueSelectionMark.SELECTED.equals(\n+            fieldValueSelectionMark)) {\n+            result = SelectionMarkState.SELECTED;\n+        } else if (com.azure.ai.formrecognizer.implementation.models.FieldValueSelectionMark.UNSELECTED.equals(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzMjgzMQ==", "bodyText": "This looks the same as this method. Can it be combined/reused?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509632831", "createdAt": "2020-10-21T19:57:29Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/Transforms.java", "diffHunk": "@@ -497,4 +556,24 @@ private static FieldBoundingBox toBoundingBox(List<Float> serviceBoundingBox) {\n         }\n         return new FieldBoundingBox(pointList);\n     }\n+\n+    /**\n+     * Helper method to convert the service level selection marks state to SDK level model.\n+     *\n+     * @param selectionMarkState The selection mark state, i.e., SELECTED and UNSELECTED.\n+     *\n+     * @return The selection mark state in the SDK level model.\n+     */\n+    private static SelectionMarkState toSelectionMarkState(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzMzI0OA==", "bodyText": "Should return an unmodifiable list to the user.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509633248", "createdAt": "2020-10-21T19:58:08Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/FormPage.java", "diffHunk": "@@ -140,5 +142,14 @@ public float getWidth() {\n     public Integer getPageNumber() {\n         return this.pageNumber;\n     }\n+\n+    /**\n+     * Get the selection marks in the input document.\n+     *\n+     * @return the selection marks.\n+     */\n+    public List<FormSelectionMark> getSelectionMarks() {\n+        return this.selectionMarks;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzMzk5Nw==", "bodyText": "Let's make this expandable, I think the service had some plans to introduce an unidentified value to this.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509633997", "createdAt": "2020-10-21T19:59:20Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/SelectionMarkState.java", "diffHunk": "@@ -0,0 +1,13 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+/** Defines values for SelectionMarkState. i.e., Selected or Unselected */\n+public enum SelectionMarkState {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzNTI0MQ==", "bodyText": "use BoundingBox.toString()", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509635241", "createdAt": "2020-10-21T20:00:11Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/ReadmeSamples.java", "diffHunk": "@@ -136,6 +136,14 @@ public void recognizeContent() throws IOException {\n                 formTable.getCells().forEach(formTableCell ->\n                     System.out.printf(\"Cell has text %s.%n\", formTableCell.getText()));\n             });\n+            // Selection Mark\n+            formPage.getSelectionMarks().forEach(selectionMark -> {\n+                StringBuilder boundingBoxStr = new StringBuilder();\n+                selectionMark.getBoundingBox().getPoints().forEach(\n+                    point -> boundingBoxStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzNjcyNQ==", "bodyText": "Let's keep the env vars out and samples consistent. Could think about this update for all or none in upcoming PR's/", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509636725", "createdAt": "2020-10-21T20:01:14Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/RecognizeContentWithSelectionMarks.java", "diffHunk": "@@ -0,0 +1,87 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer;\n+\n+import com.azure.ai.formrecognizer.models.FormPage;\n+import com.azure.ai.formrecognizer.models.FormRecognizerOperationResult;\n+import com.azure.ai.formrecognizer.models.FormSelectionMark;\n+import com.azure.ai.formrecognizer.models.FormTable;\n+import com.azure.core.credential.AzureKeyCredential;\n+import com.azure.core.util.Configuration;\n+import com.azure.core.util.polling.SyncPoller;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.nio.file.Files;\n+import java.util.List;\n+\n+public class RecognizeContentWithSelectionMarks {\n+    /**\n+     * Main method to invoke this demo.\n+     *\n+     * @param args Unused. Arguments to the program.\n+     *\n+     * @throws IOException Exception thrown when there is an error in reading all the bytes from the File.\n+     */\n+    public static void main(final String[] args) throws IOException {\n+        // Instantiate a client that will be used to call the service.\n+        FormRecognizerClient client = new FormRecognizerClientBuilder()\n+                                          .credential(new AzureKeyCredential(Configuration.getGlobalConfiguration().get(\"AZURE_FORM_RECOGNIZER_API_KEY\")))\n+                                          .endpoint(Configuration.getGlobalConfiguration().get(\"AZURE_FORM_RECOGNIZER_ENDPOINT\"))\n+                                          .buildClient();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzODUyMg==", "bodyText": "Rather than keeping the tests disabled, do you want to create a small PR to add these files to the repo first?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509638522", "createdAt": "2020-10-21T20:02:42Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientTest.java", "diffHunk": "@@ -1106,6 +1165,28 @@ public void recognizeCustomFormDamagedPdf(HttpClient httpClient,\n             }));\n     }\n \n+    @Disabled(\"add this test when the selection mark test file is merged\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYzOTUzMQ==", "bodyText": "Why do we need to ignore the case, we should have the same casing.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509639531", "createdAt": "2020-10-21T20:03:44Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientTestBase.java", "diffHunk": "@@ -242,6 +246,19 @@ private static void validateFormLineData(List<TextLine> expectedLines, List<Form\n         }\n     }\n \n+    private static void validateFormSelectionMarkData(List<SelectionMark> expectedMarks,\n+        List<FormSelectionMark> actualMarks, int pageNumber) {\n+        for (int i = 0; i < actualMarks.size(); i++) {\n+            final SelectionMark expectedMark = expectedMarks.get(i);\n+            final FormSelectionMark actualMark = actualMarks.get(i);\n+            assertTrue(expectedMark.getState().toString().equalsIgnoreCase(actualMark.getState().toString()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY0MTIxMg==", "bodyText": "Use the common constants one.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509641212", "createdAt": "2020-10-21T20:05:37Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/TestUtils.java", "diffHunk": "@@ -37,27 +32,31 @@\n  * Contains helper methods for generating inputs for test methods\n  */\n final class TestUtils {\n-    static final String URL_TEST_FILE_FORMAT = \"https://raw.githubusercontent.com/Azure/azure-sdk-for-java/\"\n-        + \"master/sdk/formrecognizer/azure-ai-formrecognizer/src/test/resources/sample_files/Test/\";\n+    // Duration\n+    static final Duration ONE_NANO_DURATION = Duration.ofNanos(1);\n+    static final Duration DEFAULT_DURATION = Duration.ofSeconds(5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY0MTk1Ng==", "bodyText": "only used at one place, no need to define it in a constant.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509641956", "createdAt": "2020-10-21T20:06:23Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/TestUtils.java", "diffHunk": "@@ -37,27 +32,31 @@\n  * Contains helper methods for generating inputs for test methods\n  */\n final class TestUtils {\n-    static final String URL_TEST_FILE_FORMAT = \"https://raw.githubusercontent.com/Azure/azure-sdk-for-java/\"\n-        + \"master/sdk/formrecognizer/azure-ai-formrecognizer/src/test/resources/sample_files/Test/\";\n+    // Duration\n+    static final Duration ONE_NANO_DURATION = Duration.ofNanos(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MTY3MjQ5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-514167249", "createdAt": "2020-10-21T20:39:10Z", "commit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMDozOToxMFrOHmEI7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMDozOToxMFrOHmEI7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY3NTc1Nw==", "bodyText": "update the description", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509675757", "createdAt": "2020-10-21T20:39:10Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/FormSelectionMark.java", "diffHunk": "@@ -0,0 +1,65 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+/**\n+ * The SelectionMark model.\n+ */\n+public final class FormSelectionMark extends FormElement {\n+    private float confidence;\n+    private SelectionMarkState state;\n+\n+    /**\n+     * Creates raw OCR item.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MTY3Mzk1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-514167395", "createdAt": "2020-10-21T20:39:24Z", "commit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMDozOToyNFrOHmEJww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMDozOToyNFrOHmEJww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY3NTk3MQ==", "bodyText": "FormSelectionMark", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r509675971", "createdAt": "2020-10-21T20:39:24Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/FormSelectionMark.java", "diffHunk": "@@ -0,0 +1,65 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.ai.formrecognizer.models;\n+\n+/**\n+ * The SelectionMark model.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f69735bc9c332758bd4f496b53fcfcd1e92f7e5"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdbe028ce8af7cabaa27d1dd646b2776dfaca2f7", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bdbe028ce8af7cabaa27d1dd646b2776dfaca2f7", "committedDate": "2020-10-21T21:44:33Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into FR-SelectionMark"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b86bb51de63a5039677eb9d398f396241a77c46", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2b86bb51de63a5039677eb9d398f396241a77c46", "committedDate": "2020-10-22T06:52:57Z", "message": "address feedbakcs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/23fe1cffa5c3dc0063466e679434569115535b8a", "committedDate": "2020-10-22T17:02:43Z", "message": "add missing sync client tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDUxNzQ4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-515051748", "createdAt": "2020-10-22T19:29:03Z", "commit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOToyOTowM1rOHmwp3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOToyOTowM1rOHmwp3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQwNTA4Nw==", "bodyText": "sorry if I missed it elsewhere, but we said that until the service correctly sends a non-null value in valueSelectionMark, we would return value.text in the meantime. Does this code do that?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r510405087", "createdAt": "2020-10-22T19:29:03Z", "author": {"login": "kristapratico"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/models/FieldValue.java", "diffHunk": "@@ -70,6 +72,9 @@ public FieldValue(final Object value, final FieldValueType valueType) {\n             case MAP:\n                 formFieldMap = (Map<String, FormField>) value;\n                 break;\n+            case SELECTION_MARK_STATE:\n+                selectionMarkState = (SelectionMarkState) value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDQ0MTUy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-515044152", "createdAt": "2020-10-22T19:17:46Z", "commit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOToxNzo0NlrOHmwS7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTozMDoxNFrOHmwsqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM5OTIxMw==", "bodyText": "put this as a service bug", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r510399213", "createdAt": "2020-10-22T19:17:46Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/Transforms.java", "diffHunk": "@@ -497,4 +537,32 @@ private static FieldBoundingBox toBoundingBox(List<Float> serviceBoundingBox) {\n         }\n         return new FieldBoundingBox(pointList);\n     }\n+\n+    /**\n+     * Helper method to convert the service level selection marks state to SDK level model.\n+     *\n+     * @param selectionMarkState The selection mark state, i.e., SELECTED and UNSELECTED.\n+     *\n+     * @return The selection mark state in the SDK level model.\n+     */\n+    private static com.azure.ai.formrecognizer.models.SelectionMarkState toSelectionMarkState(\n+        Object selectionMarkState) {\n+        if (selectionMarkState instanceof FieldValueSelectionMark) {\n+            if (FieldValueSelectionMark.SELECTED.equals(selectionMarkState)) {\n+                return com.azure.ai.formrecognizer.models.SelectionMarkState.SELECTED;\n+            } else if (FieldValueSelectionMark.UNSELECTED.equals(selectionMarkState)) {\n+                return com.azure.ai.formrecognizer.models.SelectionMarkState.UNSELECTED;\n+            }\n+        } else if (selectionMarkState instanceof SelectionMarkState) {\n+            if (SelectionMarkState.SELECTED.equals(selectionMarkState)) {\n+                return com.azure.ai.formrecognizer.models.SelectionMarkState.SELECTED;\n+            } else if (SelectionMarkState.UNSELECTED.equals(selectionMarkState)) {\n+                return com.azure.ai.formrecognizer.models.SelectionMarkState.UNSELECTED;\n+            }\n+        }\n+        return null;\n+        // TODO: (shawn) currently, the fieldValue's valueSelectionMark is null which is incorrect.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "originalPosition": 137}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQwNTgwMA==", "bodyText": "Lets split this method.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r510405800", "createdAt": "2020-10-22T19:30:14Z", "author": {"login": "samvaity"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/Transforms.java", "diffHunk": "@@ -497,4 +537,32 @@ private static FieldBoundingBox toBoundingBox(List<Float> serviceBoundingBox) {\n         }\n         return new FieldBoundingBox(pointList);\n     }\n+\n+    /**\n+     * Helper method to convert the service level selection marks state to SDK level model.\n+     *\n+     * @param selectionMarkState The selection mark state, i.e., SELECTED and UNSELECTED.\n+     *\n+     * @return The selection mark state in the SDK level model.\n+     */\n+    private static com.azure.ai.formrecognizer.models.SelectionMarkState toSelectionMarkState(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "originalPosition": 121}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDUyODg1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-515052885", "createdAt": "2020-10-22T19:30:36Z", "commit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTozMDozNlrOHmwtjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTozMDozNlrOHmwtjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQwNjAyOA==", "bodyText": "why not showcase selection marks in this sample as well?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#discussion_r510406028", "createdAt": "2020-10-22T19:30:36Z", "author": {"login": "kristapratico"}, "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/GetBoundingBoxes.java", "diffHunk": "@@ -70,8 +70,8 @@ public static void main(String[] args) {\n                             System.out.printf(\"Cell text %s has following words: %n\", formTableCell.getText());\n                             // FormElements only exists if you set includeFieldElements to true in your\n                             // call to beginRecognizeCustomFormsFromUrl\n-                            // It is also a list of FormWords and FormLines, but in this example, we only deal with\n-                            // FormWords\n+                            // It is also a list of FormWords, FormLines and FormSelectionMarks, but in this example,\n+                            // we only deal with FormWords.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23fe1cffa5c3dc0063466e679434569115535b8a"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bf5182f22a0991be24db6c138695a8f0a365230", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6bf5182f22a0991be24db6c138695a8f0a365230", "committedDate": "2020-10-22T20:19:46Z", "message": "remove the selection mark transfor helper method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c169545ebcaea28191f3ff2d2629492dcbc1347", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/4c169545ebcaea28191f3ff2d2629492dcbc1347", "committedDate": "2020-10-22T20:21:30Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into FR-SelectionMark"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "318cb9ec1e5bf151433b31576e41e1e286bc38e6", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/318cb9ec1e5bf151433b31576e41e1e286bc38e6", "committedDate": "2020-10-23T17:53:12Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into FR-SelectionMark"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "402baf98988524992438d90afbf53fb3fa14763b", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/402baf98988524992438d90afbf53fb3fa14763b", "committedDate": "2020-10-23T17:59:06Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into FR-SelectionMark"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1ODkxMTY2", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16638#pullrequestreview-515891166", "createdAt": "2020-10-23T18:03:15Z", "commit": {"oid": "402baf98988524992438d90afbf53fb3fa14763b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1891, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}