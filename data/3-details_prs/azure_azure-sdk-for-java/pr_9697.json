{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1OTcyNzg1", "number": 9697, "title": "ServiceBusClientBuilder updates", "bodyText": "Clients implement AutoCloseable\nReceiver throws when operations are called on a disposed one\nShared connection support\nClientBuilder API updates.", "createdAt": "2020-03-30T23:52:47Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9697", "merged": true, "mergeCommit": {"oid": "7a46ae735680d86761945907e36a6d0d35a26136"}, "closed": true, "closedAt": "2020-03-31T17:14:12Z", "author": {"login": "conniey"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS1awpgH2gAyMzk1OTcyNzg1OmNmNDAyZTM3ZWVlYzlkNmUyOTQ3YjBhMTMzZmM4NjgyNjY5MWU1OWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTF8IhgFqTM4NDkxODI1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cf402e37eeec9d6e2947b0a133fc86826691e59e", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/cf402e37eeec9d6e2947b0a133fc86826691e59e", "committedDate": "2020-03-30T21:30:55Z", "message": "Implement AutoCloseable."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f8098f1b041cb9a2144dabad065da0753044b83", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/8f8098f1b041cb9a2144dabad065da0753044b83", "committedDate": "2020-03-30T21:51:08Z", "message": "Throw exception when receiver is disposed.\nPass ability to share connection."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6fe735a9d2bff49f66369bb2558037c689cf8e1", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a6fe735a9d2bff49f66369bb2558037c689cf8e1", "committedDate": "2020-03-30T22:52:28Z", "message": "Fixing test cases."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a3db2f94d1169dcdc6099b3e91272fd1712d553", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a3db2f94d1169dcdc6099b3e91272fd1712d553", "committedDate": "2020-03-30T23:09:28Z", "message": "Adding documentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea059638ffd88cf084f90260c0936d1c097d56e5", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/ea059638ffd88cf084f90260c0936d1c097d56e5", "committedDate": "2020-03-30T23:15:28Z", "message": "Adding queueName and topicName to sender builder."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5156cbe69d45ff091aa0cc57366319067a0bfed", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c5156cbe69d45ff091aa0cc57366319067a0bfed", "committedDate": "2020-03-30T23:22:50Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b73edfb99769ba4e98bb8a2c83c43a059cd2e4e", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5b73edfb99769ba4e98bb8a2c83c43a059cd2e4e", "committedDate": "2020-03-30T23:37:56Z", "message": "Fixing tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec07f50252e3409bf0704109aeb6ca0eb7f72e77", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/ec07f50252e3409bf0704109aeb6ca0eb7f72e77", "committedDate": "2020-03-30T23:51:12Z", "message": "Renaming sender/receiver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9920b593fb817c237795de45295d66508bd128f5", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9920b593fb817c237795de45295d66508bd128f5", "committedDate": "2020-03-30T23:52:15Z", "message": "Fix readme"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abf74451909bfb187d69ae8d19138f80913b0d61", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/abf74451909bfb187d69ae8d19138f80913b0d61", "committedDate": "2020-03-31T00:56:52Z", "message": "Revert comment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afcb7ba68c92a953560e1da0686ed29eb707237b", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/afcb7ba68c92a953560e1da0686ed29eb707237b", "committedDate": "2020-03-31T01:16:53Z", "message": "Adding documentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d019945ec060078b7409387da7ee5071e3e8620d", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d019945ec060078b7409387da7ee5071e3e8620d", "committedDate": "2020-03-31T15:13:02Z", "message": "Removing import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODUzMTMx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9697#pullrequestreview-384853131", "createdAt": "2020-03-31T15:31:42Z", "commit": {"oid": "afcb7ba68c92a953560e1da0686ed29eb707237b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNTozMTo0MlrOF-bnpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNTo0OTo1M1rOF-cfAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAwODU1MA==", "bodyText": "This should probably also clarify that this will be done for Async client only. And will not autorenew for sync client.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9697#discussion_r401008550", "createdAt": "2020-03-31T15:31:42Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java", "diffHunk": "@@ -423,7 +504,9 @@ public ServiceBusReceiverClientBuilder isAutoComplete(boolean autoComplete) {\n         /**\n          * Sets if lock should be automatically renewed.\n          *\n-         * @param isLockAutoRenewed {@code true} if the lock should be automatically renewed; {@code false} otherwise.\n+         * @param isLockAutoRenewed {@code true} if the lock should be automatically renewed; {@code false}\n+         *     otherwise.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afcb7ba68c92a953560e1da0686ed29eb707237b"}, "originalPosition": 230}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAxNzA3Nw==", "bodyText": "Line 660: IllegalArgumentException if the entity type is not a queue or a topic : You have already explained all the scenario above this. UNKNOWN , type is internal to us and if we can avoid using entity type , one less thing to learn for user .\nYou do throw this exception but this will only happen if user has not set both queue ,topic and connection string has entityName in it.\nOr it may say something like Queue or topic name are not set via queueNme() or topicName() respectively.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9697#discussion_r401017077", "createdAt": "2020-03-31T15:42:28Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java", "diffHunk": "@@ -574,14 +644,20 @@ public ServiceBusReceiverAsyncClient buildAsyncClient() {\n \n             return new ServiceBusReceiverAsyncClient(connectionProcessor.getFullyQualifiedNamespace(), entityPath,\n                 entityType, false, receiveMessageOptions, connectionProcessor, tracerProvider,\n-                messageSerializer, messageLockContainer);\n+                messageSerializer, messageLockContainer, ServiceBusClientBuilder.this::onClientClose);\n         }\n \n         /**\n-         * Creates <b>synchronous</b> Service Bus receiver responsible for reading {@link ServiceBusMessage\n-         * messages} from a specific queue or topic.\n+         * Creates <b>synchronous</b> Service Bus receiver responsible for reading {@link ServiceBusMessage messages}\n+         * from a specific queue or topic.\n          *\n          * @return An new {@link ServiceBusReceiverClient} that receives messages from a queue or topic.\n+         * @throws IllegalStateException if {@link #queueName(String) queueName} or {@link #topicName(String)\n+         *     topicName} are not set or, both of these fields are set. It is also thrown if the Service Bus {@link\n+         *     #connectionString(String) connectionString} contains an {@code EntityPath} that does not match one set in\n+         *     {@link #queueName(String) queueName} or {@link #topicName(String) topicName}. Lastly, if a {@link\n+         *     #topicName(String) topicName} is set, but {@link #subscriptionName(String) subscriptionName} is not.\n+         * @throws IllegalArgumentException if the entity type is not a queue or a topic.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afcb7ba68c92a953560e1da0686ed29eb707237b"}, "originalPosition": 339}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAyMjcyMA==", "bodyText": "Probably not urgent, but should we also add Autocloseableon receiver/sender builder because some time a user might just want to close the connection from builder in order to stop everything ?  We could decide about it later.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9697#discussion_r401022720", "createdAt": "2020-03-31T15:49:53Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java", "diffHunk": "@@ -208,13 +209,23 @@ public ServiceBusReceiverClientBuilder buildReceiverClientBuilder() {\n      */\n     void onClientClose() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afcb7ba68c92a953560e1da0686ed29eb707237b"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d56cccecb9b4c7d416df34f392908e1682099ce6", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d56cccecb9b4c7d416df34f392908e1682099ce6", "committedDate": "2020-03-31T16:38:28Z", "message": "Adding tests and updating logic."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1cff126666c3dbabc0aa21803aa5a73b1301095", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f1cff126666c3dbabc0aa21803aa5a73b1301095", "committedDate": "2020-03-31T16:44:28Z", "message": "Update docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0OTE4MjU5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9697#pullrequestreview-384918259", "createdAt": "2020-03-31T16:45:51Z", "commit": {"oid": "f1cff126666c3dbabc0aa21803aa5a73b1301095"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1447, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}