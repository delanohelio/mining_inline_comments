{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4MTc0NjQ5", "number": 14144, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQyMTowNDo0NFrOEYndxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQyMTowNDo0NFrOEYndxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0MjQ3ODc5OnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/directconnectivity/rntbd/RntbdServiceEndpoint.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQyMTowNDo0NFrOHBDSdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQyMTo0NDozMFrOHBEIPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg2NDUwMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // idleEndpointTimeoutInNanos - elapsedTimeInNanos <= 0\n          \n          \n            \n                    if no request has been sent initially over this endpoint, the below calculation can result in a very big difference \n          \n          \n            \n                    final long elapsedTimeInNanos = System.nanoTime() - endpoint.lastRequestNanoTime();\n          \n          \n            \n                    which can cause endpoint to close unnecessary.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14144#discussion_r470864502", "createdAt": "2020-08-14T21:04:44Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/directconnectivity/rntbd/RntbdServiceEndpoint.java", "diffHunk": "@@ -89,7 +89,10 @@ private RntbdServiceEndpoint(\n         this.channelPool = new RntbdClientChannelPool(this, bootstrap, config);\n         this.remoteAddress = bootstrap.config().remoteAddress();\n         this.concurrentRequests = new AtomicInteger();\n-        this.lastRequestNanoTime = new AtomicLong();\n+        // if no request has been sent over this endpoint we want to make sure we don't trigger a connection close\n+        // due to elapsedTimeInNanos being negative.\n+        // idleEndpointTimeoutInNanos - elapsedTimeInNanos <= 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1b238aba36a41140bb4c1146f7de2222f363dd6"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg3ODI2OQ==", "bodyText": "updated the comment.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14144#discussion_r470878269", "createdAt": "2020-08-14T21:44:30Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/directconnectivity/rntbd/RntbdServiceEndpoint.java", "diffHunk": "@@ -89,7 +89,10 @@ private RntbdServiceEndpoint(\n         this.channelPool = new RntbdClientChannelPool(this, bootstrap, config);\n         this.remoteAddress = bootstrap.config().remoteAddress();\n         this.concurrentRequests = new AtomicInteger();\n-        this.lastRequestNanoTime = new AtomicLong();\n+        // if no request has been sent over this endpoint we want to make sure we don't trigger a connection close\n+        // due to elapsedTimeInNanos being negative.\n+        // idleEndpointTimeoutInNanos - elapsedTimeInNanos <= 0", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg2NDUwMg=="}, "originalCommit": {"oid": "a1b238aba36a41140bb4c1146f7de2222f363dd6"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1606, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}