{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MTI1OTM2", "number": 8837, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjowOTowNlrODmBeDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwMTozNDozMFrODmEBjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk2NTU3OnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos-benchmark/src/test/java/com/azure/cosmos/benchmark/Utils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjowOTowNlrOFzO1bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjowOTowNlrOFzO1bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NDc0OA==", "bodyText": "why FeedResponse is a model but pageFlux is not?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389264748", "createdAt": "2020-03-07T16:09:06Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos-benchmark/src/test/java/com/azure/cosmos/benchmark/Utils.java", "diffHunk": "@@ -4,9 +4,9 @@\n package com.azure.cosmos.benchmark;\n \n import com.azure.cosmos.ConnectionPolicy;\n-import com.azure.cosmos.FeedResponse;\n-import com.azure.cosmos.ThrottlingRetryOptions;\n-import com.azure.cosmos.SqlQuerySpec;\n+import com.azure.cosmos.model.FeedResponse;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk2NTc3OnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/BasicDemo.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjowOTo1NFrOFzO1iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODo0MTo0M1rOFzRLMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NDc3Ng==", "bodyText": "FeedResponse was moved to model, why CosmosPageFlux is not a model?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389264776", "createdAt": "2020-03-07T16:09:54Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/BasicDemo.java", "diffHunk": "@@ -5,14 +5,14 @@\n import com.azure.cosmos.CosmosAsyncClient;\n import com.azure.cosmos.CosmosAsyncContainer;\n import com.azure.cosmos.CosmosAsyncDatabase;\n-import com.azure.cosmos.CosmosAsyncItemResponse;\n+import com.azure.cosmos.model.CosmosAsyncItemResponse;\n import com.azure.cosmos.CosmosClientBuilder;\n import com.azure.cosmos.CosmosClientException;\n-import com.azure.cosmos.CosmosContainerProperties;\n+import com.azure.cosmos.model.CosmosContainerProperties;\n import com.azure.cosmos.CosmosPagedFlux;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMzA4OQ==", "bodyText": "Yes, these should be model too. I will move both CosmosPagedFlux and CosmosPagedIterable to model.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389303089", "createdAt": "2020-03-07T18:41:43Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/BasicDemo.java", "diffHunk": "@@ -5,14 +5,14 @@\n import com.azure.cosmos.CosmosAsyncClient;\n import com.azure.cosmos.CosmosAsyncContainer;\n import com.azure.cosmos.CosmosAsyncDatabase;\n-import com.azure.cosmos.CosmosAsyncItemResponse;\n+import com.azure.cosmos.model.CosmosAsyncItemResponse;\n import com.azure.cosmos.CosmosClientBuilder;\n import com.azure.cosmos.CosmosClientException;\n-import com.azure.cosmos.CosmosContainerProperties;\n+import com.azure.cosmos.model.CosmosContainerProperties;\n import com.azure.cosmos.CosmosPagedFlux;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NDc3Ng=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk2NjkwOnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos-examples/src/test/java/com/azure/cosmos/rx/examples/Utils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjoxMjowN1rOFzO2Dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODozNzoxNlrOFzRJ2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NDkxMA==", "bodyText": "question: ThrottingRetryOption is not a rest contract. it defines client behaviour on throttling. Is this qualify for a model?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389264910", "createdAt": "2020-03-07T16:12:07Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos-examples/src/test/java/com/azure/cosmos/rx/examples/Utils.java", "diffHunk": "@@ -5,9 +5,9 @@\n \n import com.azure.cosmos.ConnectionMode;\n import com.azure.cosmos.ConnectionPolicy;\n-import com.azure.cosmos.FeedResponse;\n-import com.azure.cosmos.ThrottlingRetryOptions;\n-import com.azure.cosmos.SqlQuerySpec;\n+import com.azure.cosmos.model.FeedResponse;\n+import com.azure.cosmos.model.ThrottlingRetryOptions;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjc0NQ==", "bodyText": "No it doesn't, as it specifies client configuration.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302745", "createdAt": "2020-03-07T18:37:16Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos-examples/src/test/java/com/azure/cosmos/rx/examples/Utils.java", "diffHunk": "@@ -5,9 +5,9 @@\n \n import com.azure.cosmos.ConnectionMode;\n import com.azure.cosmos.ConnectionPolicy;\n-import com.azure.cosmos.FeedResponse;\n-import com.azure.cosmos.ThrottlingRetryOptions;\n-import com.azure.cosmos.SqlQuerySpec;\n+import com.azure.cosmos.model.FeedResponse;\n+import com.azure.cosmos.model.ThrottlingRetryOptions;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NDkxMA=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk3OTUwOnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/FeedResponseDiagnostics.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjozNTo1OFrOFzO8KA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODozOTo0MVrOFzRKiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NjQ3Mg==", "bodyText": "why FeedResponseDiagnostics is a model?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389266472", "createdAt": "2020-03-07T16:35:58Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/FeedResponseDiagnostics.java", "diffHunk": "@@ -1,7 +1,7 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.cosmos;\n+package com.azure.cosmos.model;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjkyMQ==", "bodyText": "I was not sure about this one. But since CosmosResponseDiagnostics is not a model too, so I agree, this shouldn't be either. Will move this back to cosmos package.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302921", "createdAt": "2020-03-07T18:39:41Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/FeedResponseDiagnostics.java", "diffHunk": "@@ -1,7 +1,7 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.cosmos;\n+package com.azure.cosmos.model;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NjQ3Mg=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk4MTIzOnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ThrottlingRetryOptions.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjozODo1OVrOFzO89w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODozNjozNFrOFzRJpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NjY3OQ==", "bodyText": "I am not sure if this is a model. as it specifies client behaviour not over wire contract", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389266679", "createdAt": "2020-03-07T16:38:59Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ThrottlingRetryOptions.java", "diffHunk": "@@ -1,7 +1,7 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.cosmos;\n+package com.azure.cosmos.model;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjY5Mg==", "bodyText": "Agreed, as it specifies client behavior, will move it back.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302692", "createdAt": "2020-03-07T18:36:34Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ThrottlingRetryOptions.java", "diffHunk": "@@ -1,7 +1,7 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.cosmos;\n+package com.azure.cosmos.model;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NjY3OQ=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk4NjI2OnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ModelBridgeInternal.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjo0OTo0OVrOFzO_dQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODozNDozNVrOFzRJHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzMxNw==", "bodyText": "why do we need the setMapper?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389267317", "createdAt": "2020-03-07T16:49:49Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ModelBridgeInternal.java", "diffHunk": "@@ -0,0 +1,405 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.cosmos.model;\n+\n+import com.azure.cosmos.CosmosAsyncClient;\n+import com.azure.cosmos.CosmosAsyncContainer;\n+import com.azure.cosmos.CosmosAsyncDatabase;\n+import com.azure.cosmos.CosmosAsyncUser;\n+import com.azure.cosmos.CosmosClient;\n+import com.azure.cosmos.CosmosClientException;\n+import com.azure.cosmos.CosmosDatabase;\n+import com.azure.cosmos.CosmosStoredProcedure;\n+import com.azure.cosmos.CosmosTrigger;\n+import com.azure.cosmos.CosmosUserDefinedFunction;\n+import com.azure.cosmos.implementation.Conflict;\n+import com.azure.cosmos.implementation.Constants;\n+import com.azure.cosmos.implementation.CosmosItemProperties;\n+import com.azure.cosmos.implementation.Database;\n+import com.azure.cosmos.implementation.Document;\n+import com.azure.cosmos.implementation.DocumentCollection;\n+import com.azure.cosmos.implementation.HttpConstants;\n+import com.azure.cosmos.implementation.QueryMetrics;\n+import com.azure.cosmos.implementation.ReplicationPolicy;\n+import com.azure.cosmos.implementation.RequestOptions;\n+import com.azure.cosmos.implementation.ResourceResponse;\n+import com.azure.cosmos.implementation.RxDocumentServiceResponse;\n+import com.azure.cosmos.implementation.StoredProcedure;\n+import com.azure.cosmos.implementation.StoredProcedureResponse;\n+import com.azure.cosmos.implementation.Trigger;\n+import com.azure.cosmos.implementation.User;\n+import com.azure.cosmos.implementation.UserDefinedFunction;\n+import com.azure.cosmos.implementation.routing.PartitionKeyInternal;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+\n+import java.time.OffsetDateTime;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.ConcurrentMap;\n+\n+/**\n+ * This is meant to be used only internally as a bridge access to classes in\n+ * com.azure.cosmos.model package\n+ **/\n+public class ModelBridgeInternal {\n+\n+    public static CosmosAsyncConflictResponse createCosmosAsyncConflictResponse(ResourceResponse<Conflict> response,\n+                                                                                CosmosAsyncContainer container) {\n+        return new CosmosAsyncConflictResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncContainerResponse createCosmosAsyncContainerResponse(ResourceResponse<DocumentCollection> response,\n+                                                                                  CosmosAsyncDatabase database) {\n+        return new CosmosAsyncContainerResponse(response, database);\n+    }\n+\n+    public static CosmosAsyncDatabaseResponse createCosmosAsyncDatabaseResponse(ResourceResponse<Database> response,\n+                                                                                 CosmosAsyncClient client) {\n+        return new CosmosAsyncDatabaseResponse(response, client);\n+    }\n+\n+    public static <T> CosmosAsyncItemResponse<T> createCosmosAsyncItemResponse(ResourceResponse<Document> response, Class<T> classType) {\n+        return new CosmosAsyncItemResponse<>(response, classType);\n+    }\n+\n+    public static CosmosAsyncItemResponse createCosmosAsyncItemResponseWithObjectType(ResourceResponse<Document> response, Class classType) {\n+        return new CosmosAsyncItemResponse(response, classType);\n+    }\n+\n+    public static CosmosAsyncPermissionResponse createCosmosAsyncPermissionResponse(ResourceResponse<Permission> response,\n+                                                                                    CosmosAsyncUser cosmosUser) {\n+        return new CosmosAsyncPermissionResponse(response, cosmosUser);\n+    }\n+\n+    public static CosmosAsyncStoredProcedureResponse createCosmosAsyncStoredProcedureResponse(ResourceResponse<StoredProcedure> response,\n+                                                                                              CosmosAsyncContainer cosmosContainer) {\n+        return new CosmosAsyncStoredProcedureResponse(response, cosmosContainer);\n+    }\n+\n+    public static CosmosAsyncStoredProcedureResponse createCosmosAsyncStoredProcedureResponse(StoredProcedureResponse response,\n+                                                                                              CosmosAsyncContainer cosmosContainer,\n+                                                                                              String storedProcedureId) {\n+        return new CosmosAsyncStoredProcedureResponse(response, cosmosContainer, storedProcedureId);\n+    }\n+\n+    public static CosmosStoredProcedureProperties createCosmosStoredProcedureProperties(String jsonString) {\n+        return new CosmosStoredProcedureProperties(jsonString);\n+    }\n+\n+    public static CosmosAsyncTriggerResponse createCosmosAsyncTriggerResponse(ResourceResponse<Trigger> response,\n+                                                                              CosmosAsyncContainer container) {\n+        return new CosmosAsyncTriggerResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncUserDefinedFunctionResponse createCosmosAsyncUserDefinedFunctionResponse(ResourceResponse<UserDefinedFunction> response,\n+                                                                                                      CosmosAsyncContainer container) {\n+        return new CosmosAsyncUserDefinedFunctionResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncUserResponse createCosmosAsyncUserResponse(ResourceResponse<User> response, CosmosAsyncDatabase database) {\n+        return new CosmosAsyncUserResponse(response, database);\n+    }\n+\n+    public static CosmosContainerResponse createCosmosContainerResponse(CosmosAsyncContainerResponse response,\n+                                                                        CosmosDatabase database, CosmosClient client) {\n+        return new CosmosContainerResponse(response, database, client);\n+    }\n+\n+    public static CosmosUserResponse createCosmosUserResponse(CosmosAsyncUserResponse response, CosmosDatabase database) {\n+        return new CosmosUserResponse(response, database);\n+    }\n+\n+    public static <T> CosmosItemResponse<T> createCosmosItemResponse(CosmosAsyncItemResponse<T> response) {\n+        return new CosmosItemResponse<>(response);\n+    }\n+\n+    public static CosmosDatabaseResponse createCosmosDatabaseResponse(CosmosAsyncDatabaseResponse response, CosmosClient client) {\n+        return new CosmosDatabaseResponse(response, client);\n+    }\n+\n+    public static CosmosStoredProcedureResponse createCosmosStoredProcedureResponse(CosmosAsyncStoredProcedureResponse resourceResponse,\n+                                                CosmosStoredProcedure storedProcedure) {\n+        return new CosmosStoredProcedureResponse(resourceResponse, storedProcedure);\n+    }\n+\n+    public static CosmosUserDefinedFunctionResponse createCosmosUserDefinedFunctionResponse(CosmosAsyncUserDefinedFunctionResponse resourceResponse,\n+                                                    CosmosUserDefinedFunction userDefinedFunction) {\n+        return new CosmosUserDefinedFunctionResponse(resourceResponse, userDefinedFunction);\n+    }\n+\n+    public static CosmosTriggerResponse createCosmosTriggerResponse(CosmosAsyncTriggerResponse asyncResponse,\n+                                        CosmosTrigger syncTrigger) {\n+        return new CosmosTriggerResponse(asyncResponse, syncTrigger);\n+    }\n+\n+    public static List<CosmosConflictProperties> getCosmosConflictPropertiesFromV2Results(List<Conflict> results) {\n+        return CosmosConflictProperties.getFromV2Results(results);\n+    }\n+\n+    public static DocumentCollection getV2Collection(CosmosContainerProperties containerProperties) {\n+        return containerProperties.getV2Collection();\n+    }\n+\n+    public static List<CosmosContainerProperties> getCosmosContainerPropertiesFromV2Results(List<DocumentCollection> results) {\n+        return CosmosContainerProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosDatabaseProperties> getCosmosDatabasePropertiesFromV2Results(List<Database> results) {\n+        return CosmosDatabaseProperties.getFromV2Results(results);\n+    }\n+\n+    public static <T> CosmosItemProperties getCosmosItemProperties(CosmosAsyncItemResponse<T> cosmosItemResponse) {\n+        return cosmosItemResponse.getProperties();\n+    }\n+\n+    public static <T> CosmosItemProperties getCosmosItemProperties(CosmosItemResponse<T> cosmosItemResponse) {\n+        return cosmosItemResponse.getProperties();\n+    }\n+\n+    public static Permission getV2Permissions(CosmosPermissionProperties permissionSettings) {\n+        return permissionSettings.getV2Permissions();\n+    }\n+\n+    public static List<CosmosPermissionProperties> getCosmosPermissionPropertiesFromV2Results(List<Permission> results) {\n+        return CosmosPermissionProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosStoredProcedureProperties> getCosmosStoredProcedurePropertiesFromV2Results(List<StoredProcedure> results) {\n+        return CosmosStoredProcedureProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosTriggerProperties> getCosmosTriggerPropertiesFromV2Results(List<Trigger> results) {\n+        return CosmosTriggerProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosUserDefinedFunctionProperties> getCosmosUserDefinedFunctionPropertiesFromV2Results(List<UserDefinedFunction> results) {\n+        return CosmosUserDefinedFunctionProperties.getFromV2Results(results);\n+    }\n+\n+    public static User getV2User(CosmosUserProperties cosmosUserProperties) {\n+        return cosmosUserProperties.getV2User();\n+    }\n+\n+    public static List<CosmosUserProperties> getCosmosUserPropertiesFromV2Results(List<User> results) {\n+        return CosmosUserProperties.getFromV2Results(results);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosConflictRequestOptions cosmosConflictRequestOptions) {\n+        return cosmosConflictRequestOptions.toRequestOptions();\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosContainerRequestOptions cosmosContainerRequestOptions) {\n+        return cosmosContainerRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosContainerRequestOptions setOfferThroughput(CosmosContainerRequestOptions cosmosContainerRequestOptions,\n+                                                                   Integer offerThroughput) {\n+        return cosmosContainerRequestOptions.setOfferThroughput(offerThroughput);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosDatabaseRequestOptions cosmosDatabaseRequestOptions) {\n+        return cosmosDatabaseRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosDatabaseRequestOptions setOfferThroughput(CosmosDatabaseRequestOptions cosmosDatabaseRequestOptions,\n+                                                                   Integer offerThroughput) {\n+        return cosmosDatabaseRequestOptions.setOfferThroughput(offerThroughput);\n+    }\n+\n+    public static CosmosItemRequestOptions setPartitionKey(CosmosItemRequestOptions cosmosItemRequestOptions,\n+                                                           PartitionKey partitionKey) {\n+        return cosmosItemRequestOptions.setPartitionKey(partitionKey);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosItemRequestOptions cosmosItemRequestOptions) {\n+        return cosmosItemRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosItemRequestOptions createCosmosItemRequestOptions(PartitionKey partitionKey) {\n+        return new CosmosItemRequestOptions(partitionKey);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosPermissionRequestOptions cosmosPermissionRequestOptions) {\n+        return cosmosPermissionRequestOptions.toRequestOptions();\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosStoredProcedureRequestOptions cosmosStoredProcedureRequestOptions) {\n+        return cosmosStoredProcedureRequestOptions.toRequestOptions();\n+    }\n+\n+    public static String getAddressesLink(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getAddressesLink();\n+    }\n+\n+    public static DatabaseAccount toDatabaseAccount(RxDocumentServiceResponse response) {\n+        DatabaseAccount account = response.getResource(DatabaseAccount.class);\n+\n+        // read the headers and set to the account\n+        Map<String, String> responseHeader = response.getResponseHeaders();\n+\n+        account.setMaxMediaStorageUsageInMB(\n+            Long.valueOf(responseHeader.get(HttpConstants.HttpHeaders.MAX_MEDIA_STORAGE_USAGE_IN_MB)));\n+        account.setMediaStorageUsageInMB(\n+            Long.valueOf(responseHeader.get(HttpConstants.HttpHeaders.CURRENT_MEDIA_STORAGE_USAGE_IN_MB)));\n+\n+        return account;\n+    }\n+\n+    public static Map<String, Object> getQueryEngineConfiuration(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getQueryEngineConfiguration();\n+    }\n+\n+    public static ReplicationPolicy getReplicationPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getReplicationPolicy();\n+    }\n+\n+    public static ReplicationPolicy getSystemReplicationPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getSystemReplicationPolicy();\n+    }\n+\n+    public static ConsistencyPolicy getConsistencyPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getConsistencyPolicy();\n+    }\n+\n+    /**\n+     * Gets the partitionKeyRangeId.\n+     *\n+     * @param options the feed options\n+     * @return the partitionKeyRangeId.\n+     */\n+    public static String partitionKeyRangeIdInternal(FeedOptions options) {\n+        return options.getPartitionKeyRangeIdInternal();\n+    }\n+\n+    /**\n+     * Sets the PartitionKeyRangeId.\n+     *\n+     * @param options the feed options\n+     * @param partitionKeyRangeId the partition key range id\n+     * @return the partitionKeyRangeId.\n+     */\n+    public static FeedOptions partitionKeyRangeIdInternal(FeedOptions options, String partitionKeyRangeId) {\n+        return options.setPartitionKeyRangeIdInternal(partitionKeyRangeId);\n+    }\n+\n+    public static <T extends Resource> FeedResponse<T> toFeedResponsePage(RxDocumentServiceResponse response,\n+                                                                          Class<T> cls) {\n+        return new FeedResponse<T>(response.getQueryResponse(cls), response.getResponseHeaders());\n+    }\n+\n+    public static <T> FeedResponse<T> toFeedResponsePage(List<T> results, Map<String, String> headers, boolean noChanges) {\n+        return new FeedResponse<>(results, headers, noChanges);\n+    }\n+\n+    public static <T extends Resource> FeedResponse<T> toChaneFeedResponsePage(RxDocumentServiceResponse response,\n+                                                                               Class<T> cls) {\n+        return new FeedResponse<T>(noChanges(response) ? Collections.emptyList() : response.getQueryResponse(cls),\n+            response.getResponseHeaders(), noChanges(response));\n+    }\n+\n+    public static <T extends Resource> boolean noChanges(FeedResponse<T> page) {\n+        return page.nochanges;\n+    }\n+\n+    public static <T extends Resource> boolean noChanges(RxDocumentServiceResponse rsp) {\n+        return rsp.getStatusCode() == HttpConstants.StatusCodes.NOT_MODIFIED;\n+    }\n+\n+    public static <T> FeedResponse<T> createFeedResponse(List<T> results,\n+                                                         Map<String, String> headers) {\n+        return new FeedResponse<>(results, headers);\n+    }\n+\n+    public static <T> FeedResponse<T> createFeedResponseWithQueryMetrics(List<T> results,\n+                                                                         Map<String, String> headers, ConcurrentMap<String, QueryMetrics> queryMetricsMap) {\n+        return new FeedResponse<>(results, headers, queryMetricsMap);\n+    }\n+\n+    public static <T> ConcurrentMap<String, QueryMetrics> queryMetricsMap(FeedResponse<T> feedResponse) {\n+        return feedResponse.queryMetricsMap();\n+    }\n+\n+    public static <T> ConcurrentMap<String, QueryMetrics> queryMetrics(FeedResponse<T> feedResponse) {\n+        return feedResponse.queryMetrics();\n+    }\n+\n+    public static String toLower(RequestVerb verb) {\n+        return verb.toLowerCase();\n+    }\n+\n+    public static boolean isV2(PartitionKeyDefinition pkd) {\n+        return pkd.getVersion() != null && PartitionKeyDefinitionVersion.V2.val == pkd.getVersion().val;\n+    }\n+\n+    public static PartitionKeyInternal getNonePartitionKey(PartitionKeyDefinition partitionKeyDefinition) {\n+        return partitionKeyDefinition.getNonePartitionKeyValue();\n+    }\n+\n+    public static PartitionKeyInternal getPartitionKeyInternal(PartitionKey partitionKey) {\n+        return partitionKey.getInternalPartitionKey();\n+    }\n+\n+    public static PartitionKey partitionKeyfromJsonString(String jsonString) {\n+        return PartitionKey.fromJsonString(jsonString);\n+    }\n+\n+    public static Object getPartitionKeyObject(PartitionKey right) {\n+        return right.getKeyObject();\n+    }\n+\n+    public static String getAltLink(Resource resource) {\n+        return resource.getAltLink();\n+    }\n+\n+    public static void setAltLink(Resource resource, String altLink) {\n+        resource.setAltLink(altLink);\n+    }\n+\n+    public static void setResourceSelfLink(Resource resource, String selfLink) {\n+        resource.setSelfLink(selfLink);\n+    }\n+\n+    public static void setTimestamp(Resource resource, OffsetDateTime date) {\n+        resource.setTimestamp(date);\n+    }\n+\n+    public static void validateResource(Resource resource) {\n+        Resource.validateResource(resource);\n+    }\n+\n+    public static <T> void setProperty(JsonSerializable jsonSerializable, String propertyName, T value) {\n+        jsonSerializable.set(propertyName, value);\n+    }\n+\n+    public static ObjectNode getObject(JsonSerializable jsonSerializable, String propertyName) {\n+        return jsonSerializable.getObject(propertyName);\n+    }\n+\n+    public static void remove(JsonSerializable jsonSerializable, String propertyName) {\n+        jsonSerializable.remove(propertyName);\n+    }\n+\n+    public static Object getValue(JsonNode value) {\n+        return JsonSerializable.getValue(value);\n+    }\n+\n+    public static CosmosError createCosmosError(ObjectNode objectNode) {\n+        return new CosmosError(objectNode);\n+    }\n+\n+    public static CosmosError createCosmosError(String jsonString) {\n+        return new CosmosError(jsonString);\n+    }\n+\n+    public static void populatePropertyBagJsonSerializable(JsonSerializable jsonSerializable) {\n+        jsonSerializable.populatePropertyBag();\n+    }\n+\n+    public static void setMapper(JsonSerializable jsonSerializable, ObjectMapper om) {\n+        jsonSerializable.setMapper(om);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 403}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjQ5OQ==", "bodyText": "setMapper is used in a constructor in Document.java class.\n/**\n     * Initialize a document object from json string.\n     *\n     * @param jsonString the json string that represents the document object.\n     * @param objectMapper the custom object mapper\n     */\n    Document(String jsonString, ObjectMapper objectMapper) {\n        // TODO: Made package private due to #153. #171 adding custom serialization options back.\n        super(jsonString);\n        setMapper(this, objectMapper);\n    }", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302499", "createdAt": "2020-03-07T18:33:39Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ModelBridgeInternal.java", "diffHunk": "@@ -0,0 +1,405 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.cosmos.model;\n+\n+import com.azure.cosmos.CosmosAsyncClient;\n+import com.azure.cosmos.CosmosAsyncContainer;\n+import com.azure.cosmos.CosmosAsyncDatabase;\n+import com.azure.cosmos.CosmosAsyncUser;\n+import com.azure.cosmos.CosmosClient;\n+import com.azure.cosmos.CosmosClientException;\n+import com.azure.cosmos.CosmosDatabase;\n+import com.azure.cosmos.CosmosStoredProcedure;\n+import com.azure.cosmos.CosmosTrigger;\n+import com.azure.cosmos.CosmosUserDefinedFunction;\n+import com.azure.cosmos.implementation.Conflict;\n+import com.azure.cosmos.implementation.Constants;\n+import com.azure.cosmos.implementation.CosmosItemProperties;\n+import com.azure.cosmos.implementation.Database;\n+import com.azure.cosmos.implementation.Document;\n+import com.azure.cosmos.implementation.DocumentCollection;\n+import com.azure.cosmos.implementation.HttpConstants;\n+import com.azure.cosmos.implementation.QueryMetrics;\n+import com.azure.cosmos.implementation.ReplicationPolicy;\n+import com.azure.cosmos.implementation.RequestOptions;\n+import com.azure.cosmos.implementation.ResourceResponse;\n+import com.azure.cosmos.implementation.RxDocumentServiceResponse;\n+import com.azure.cosmos.implementation.StoredProcedure;\n+import com.azure.cosmos.implementation.StoredProcedureResponse;\n+import com.azure.cosmos.implementation.Trigger;\n+import com.azure.cosmos.implementation.User;\n+import com.azure.cosmos.implementation.UserDefinedFunction;\n+import com.azure.cosmos.implementation.routing.PartitionKeyInternal;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+\n+import java.time.OffsetDateTime;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.ConcurrentMap;\n+\n+/**\n+ * This is meant to be used only internally as a bridge access to classes in\n+ * com.azure.cosmos.model package\n+ **/\n+public class ModelBridgeInternal {\n+\n+    public static CosmosAsyncConflictResponse createCosmosAsyncConflictResponse(ResourceResponse<Conflict> response,\n+                                                                                CosmosAsyncContainer container) {\n+        return new CosmosAsyncConflictResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncContainerResponse createCosmosAsyncContainerResponse(ResourceResponse<DocumentCollection> response,\n+                                                                                  CosmosAsyncDatabase database) {\n+        return new CosmosAsyncContainerResponse(response, database);\n+    }\n+\n+    public static CosmosAsyncDatabaseResponse createCosmosAsyncDatabaseResponse(ResourceResponse<Database> response,\n+                                                                                 CosmosAsyncClient client) {\n+        return new CosmosAsyncDatabaseResponse(response, client);\n+    }\n+\n+    public static <T> CosmosAsyncItemResponse<T> createCosmosAsyncItemResponse(ResourceResponse<Document> response, Class<T> classType) {\n+        return new CosmosAsyncItemResponse<>(response, classType);\n+    }\n+\n+    public static CosmosAsyncItemResponse createCosmosAsyncItemResponseWithObjectType(ResourceResponse<Document> response, Class classType) {\n+        return new CosmosAsyncItemResponse(response, classType);\n+    }\n+\n+    public static CosmosAsyncPermissionResponse createCosmosAsyncPermissionResponse(ResourceResponse<Permission> response,\n+                                                                                    CosmosAsyncUser cosmosUser) {\n+        return new CosmosAsyncPermissionResponse(response, cosmosUser);\n+    }\n+\n+    public static CosmosAsyncStoredProcedureResponse createCosmosAsyncStoredProcedureResponse(ResourceResponse<StoredProcedure> response,\n+                                                                                              CosmosAsyncContainer cosmosContainer) {\n+        return new CosmosAsyncStoredProcedureResponse(response, cosmosContainer);\n+    }\n+\n+    public static CosmosAsyncStoredProcedureResponse createCosmosAsyncStoredProcedureResponse(StoredProcedureResponse response,\n+                                                                                              CosmosAsyncContainer cosmosContainer,\n+                                                                                              String storedProcedureId) {\n+        return new CosmosAsyncStoredProcedureResponse(response, cosmosContainer, storedProcedureId);\n+    }\n+\n+    public static CosmosStoredProcedureProperties createCosmosStoredProcedureProperties(String jsonString) {\n+        return new CosmosStoredProcedureProperties(jsonString);\n+    }\n+\n+    public static CosmosAsyncTriggerResponse createCosmosAsyncTriggerResponse(ResourceResponse<Trigger> response,\n+                                                                              CosmosAsyncContainer container) {\n+        return new CosmosAsyncTriggerResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncUserDefinedFunctionResponse createCosmosAsyncUserDefinedFunctionResponse(ResourceResponse<UserDefinedFunction> response,\n+                                                                                                      CosmosAsyncContainer container) {\n+        return new CosmosAsyncUserDefinedFunctionResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncUserResponse createCosmosAsyncUserResponse(ResourceResponse<User> response, CosmosAsyncDatabase database) {\n+        return new CosmosAsyncUserResponse(response, database);\n+    }\n+\n+    public static CosmosContainerResponse createCosmosContainerResponse(CosmosAsyncContainerResponse response,\n+                                                                        CosmosDatabase database, CosmosClient client) {\n+        return new CosmosContainerResponse(response, database, client);\n+    }\n+\n+    public static CosmosUserResponse createCosmosUserResponse(CosmosAsyncUserResponse response, CosmosDatabase database) {\n+        return new CosmosUserResponse(response, database);\n+    }\n+\n+    public static <T> CosmosItemResponse<T> createCosmosItemResponse(CosmosAsyncItemResponse<T> response) {\n+        return new CosmosItemResponse<>(response);\n+    }\n+\n+    public static CosmosDatabaseResponse createCosmosDatabaseResponse(CosmosAsyncDatabaseResponse response, CosmosClient client) {\n+        return new CosmosDatabaseResponse(response, client);\n+    }\n+\n+    public static CosmosStoredProcedureResponse createCosmosStoredProcedureResponse(CosmosAsyncStoredProcedureResponse resourceResponse,\n+                                                CosmosStoredProcedure storedProcedure) {\n+        return new CosmosStoredProcedureResponse(resourceResponse, storedProcedure);\n+    }\n+\n+    public static CosmosUserDefinedFunctionResponse createCosmosUserDefinedFunctionResponse(CosmosAsyncUserDefinedFunctionResponse resourceResponse,\n+                                                    CosmosUserDefinedFunction userDefinedFunction) {\n+        return new CosmosUserDefinedFunctionResponse(resourceResponse, userDefinedFunction);\n+    }\n+\n+    public static CosmosTriggerResponse createCosmosTriggerResponse(CosmosAsyncTriggerResponse asyncResponse,\n+                                        CosmosTrigger syncTrigger) {\n+        return new CosmosTriggerResponse(asyncResponse, syncTrigger);\n+    }\n+\n+    public static List<CosmosConflictProperties> getCosmosConflictPropertiesFromV2Results(List<Conflict> results) {\n+        return CosmosConflictProperties.getFromV2Results(results);\n+    }\n+\n+    public static DocumentCollection getV2Collection(CosmosContainerProperties containerProperties) {\n+        return containerProperties.getV2Collection();\n+    }\n+\n+    public static List<CosmosContainerProperties> getCosmosContainerPropertiesFromV2Results(List<DocumentCollection> results) {\n+        return CosmosContainerProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosDatabaseProperties> getCosmosDatabasePropertiesFromV2Results(List<Database> results) {\n+        return CosmosDatabaseProperties.getFromV2Results(results);\n+    }\n+\n+    public static <T> CosmosItemProperties getCosmosItemProperties(CosmosAsyncItemResponse<T> cosmosItemResponse) {\n+        return cosmosItemResponse.getProperties();\n+    }\n+\n+    public static <T> CosmosItemProperties getCosmosItemProperties(CosmosItemResponse<T> cosmosItemResponse) {\n+        return cosmosItemResponse.getProperties();\n+    }\n+\n+    public static Permission getV2Permissions(CosmosPermissionProperties permissionSettings) {\n+        return permissionSettings.getV2Permissions();\n+    }\n+\n+    public static List<CosmosPermissionProperties> getCosmosPermissionPropertiesFromV2Results(List<Permission> results) {\n+        return CosmosPermissionProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosStoredProcedureProperties> getCosmosStoredProcedurePropertiesFromV2Results(List<StoredProcedure> results) {\n+        return CosmosStoredProcedureProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosTriggerProperties> getCosmosTriggerPropertiesFromV2Results(List<Trigger> results) {\n+        return CosmosTriggerProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosUserDefinedFunctionProperties> getCosmosUserDefinedFunctionPropertiesFromV2Results(List<UserDefinedFunction> results) {\n+        return CosmosUserDefinedFunctionProperties.getFromV2Results(results);\n+    }\n+\n+    public static User getV2User(CosmosUserProperties cosmosUserProperties) {\n+        return cosmosUserProperties.getV2User();\n+    }\n+\n+    public static List<CosmosUserProperties> getCosmosUserPropertiesFromV2Results(List<User> results) {\n+        return CosmosUserProperties.getFromV2Results(results);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosConflictRequestOptions cosmosConflictRequestOptions) {\n+        return cosmosConflictRequestOptions.toRequestOptions();\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosContainerRequestOptions cosmosContainerRequestOptions) {\n+        return cosmosContainerRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosContainerRequestOptions setOfferThroughput(CosmosContainerRequestOptions cosmosContainerRequestOptions,\n+                                                                   Integer offerThroughput) {\n+        return cosmosContainerRequestOptions.setOfferThroughput(offerThroughput);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosDatabaseRequestOptions cosmosDatabaseRequestOptions) {\n+        return cosmosDatabaseRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosDatabaseRequestOptions setOfferThroughput(CosmosDatabaseRequestOptions cosmosDatabaseRequestOptions,\n+                                                                   Integer offerThroughput) {\n+        return cosmosDatabaseRequestOptions.setOfferThroughput(offerThroughput);\n+    }\n+\n+    public static CosmosItemRequestOptions setPartitionKey(CosmosItemRequestOptions cosmosItemRequestOptions,\n+                                                           PartitionKey partitionKey) {\n+        return cosmosItemRequestOptions.setPartitionKey(partitionKey);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosItemRequestOptions cosmosItemRequestOptions) {\n+        return cosmosItemRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosItemRequestOptions createCosmosItemRequestOptions(PartitionKey partitionKey) {\n+        return new CosmosItemRequestOptions(partitionKey);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosPermissionRequestOptions cosmosPermissionRequestOptions) {\n+        return cosmosPermissionRequestOptions.toRequestOptions();\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosStoredProcedureRequestOptions cosmosStoredProcedureRequestOptions) {\n+        return cosmosStoredProcedureRequestOptions.toRequestOptions();\n+    }\n+\n+    public static String getAddressesLink(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getAddressesLink();\n+    }\n+\n+    public static DatabaseAccount toDatabaseAccount(RxDocumentServiceResponse response) {\n+        DatabaseAccount account = response.getResource(DatabaseAccount.class);\n+\n+        // read the headers and set to the account\n+        Map<String, String> responseHeader = response.getResponseHeaders();\n+\n+        account.setMaxMediaStorageUsageInMB(\n+            Long.valueOf(responseHeader.get(HttpConstants.HttpHeaders.MAX_MEDIA_STORAGE_USAGE_IN_MB)));\n+        account.setMediaStorageUsageInMB(\n+            Long.valueOf(responseHeader.get(HttpConstants.HttpHeaders.CURRENT_MEDIA_STORAGE_USAGE_IN_MB)));\n+\n+        return account;\n+    }\n+\n+    public static Map<String, Object> getQueryEngineConfiuration(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getQueryEngineConfiguration();\n+    }\n+\n+    public static ReplicationPolicy getReplicationPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getReplicationPolicy();\n+    }\n+\n+    public static ReplicationPolicy getSystemReplicationPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getSystemReplicationPolicy();\n+    }\n+\n+    public static ConsistencyPolicy getConsistencyPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getConsistencyPolicy();\n+    }\n+\n+    /**\n+     * Gets the partitionKeyRangeId.\n+     *\n+     * @param options the feed options\n+     * @return the partitionKeyRangeId.\n+     */\n+    public static String partitionKeyRangeIdInternal(FeedOptions options) {\n+        return options.getPartitionKeyRangeIdInternal();\n+    }\n+\n+    /**\n+     * Sets the PartitionKeyRangeId.\n+     *\n+     * @param options the feed options\n+     * @param partitionKeyRangeId the partition key range id\n+     * @return the partitionKeyRangeId.\n+     */\n+    public static FeedOptions partitionKeyRangeIdInternal(FeedOptions options, String partitionKeyRangeId) {\n+        return options.setPartitionKeyRangeIdInternal(partitionKeyRangeId);\n+    }\n+\n+    public static <T extends Resource> FeedResponse<T> toFeedResponsePage(RxDocumentServiceResponse response,\n+                                                                          Class<T> cls) {\n+        return new FeedResponse<T>(response.getQueryResponse(cls), response.getResponseHeaders());\n+    }\n+\n+    public static <T> FeedResponse<T> toFeedResponsePage(List<T> results, Map<String, String> headers, boolean noChanges) {\n+        return new FeedResponse<>(results, headers, noChanges);\n+    }\n+\n+    public static <T extends Resource> FeedResponse<T> toChaneFeedResponsePage(RxDocumentServiceResponse response,\n+                                                                               Class<T> cls) {\n+        return new FeedResponse<T>(noChanges(response) ? Collections.emptyList() : response.getQueryResponse(cls),\n+            response.getResponseHeaders(), noChanges(response));\n+    }\n+\n+    public static <T extends Resource> boolean noChanges(FeedResponse<T> page) {\n+        return page.nochanges;\n+    }\n+\n+    public static <T extends Resource> boolean noChanges(RxDocumentServiceResponse rsp) {\n+        return rsp.getStatusCode() == HttpConstants.StatusCodes.NOT_MODIFIED;\n+    }\n+\n+    public static <T> FeedResponse<T> createFeedResponse(List<T> results,\n+                                                         Map<String, String> headers) {\n+        return new FeedResponse<>(results, headers);\n+    }\n+\n+    public static <T> FeedResponse<T> createFeedResponseWithQueryMetrics(List<T> results,\n+                                                                         Map<String, String> headers, ConcurrentMap<String, QueryMetrics> queryMetricsMap) {\n+        return new FeedResponse<>(results, headers, queryMetricsMap);\n+    }\n+\n+    public static <T> ConcurrentMap<String, QueryMetrics> queryMetricsMap(FeedResponse<T> feedResponse) {\n+        return feedResponse.queryMetricsMap();\n+    }\n+\n+    public static <T> ConcurrentMap<String, QueryMetrics> queryMetrics(FeedResponse<T> feedResponse) {\n+        return feedResponse.queryMetrics();\n+    }\n+\n+    public static String toLower(RequestVerb verb) {\n+        return verb.toLowerCase();\n+    }\n+\n+    public static boolean isV2(PartitionKeyDefinition pkd) {\n+        return pkd.getVersion() != null && PartitionKeyDefinitionVersion.V2.val == pkd.getVersion().val;\n+    }\n+\n+    public static PartitionKeyInternal getNonePartitionKey(PartitionKeyDefinition partitionKeyDefinition) {\n+        return partitionKeyDefinition.getNonePartitionKeyValue();\n+    }\n+\n+    public static PartitionKeyInternal getPartitionKeyInternal(PartitionKey partitionKey) {\n+        return partitionKey.getInternalPartitionKey();\n+    }\n+\n+    public static PartitionKey partitionKeyfromJsonString(String jsonString) {\n+        return PartitionKey.fromJsonString(jsonString);\n+    }\n+\n+    public static Object getPartitionKeyObject(PartitionKey right) {\n+        return right.getKeyObject();\n+    }\n+\n+    public static String getAltLink(Resource resource) {\n+        return resource.getAltLink();\n+    }\n+\n+    public static void setAltLink(Resource resource, String altLink) {\n+        resource.setAltLink(altLink);\n+    }\n+\n+    public static void setResourceSelfLink(Resource resource, String selfLink) {\n+        resource.setSelfLink(selfLink);\n+    }\n+\n+    public static void setTimestamp(Resource resource, OffsetDateTime date) {\n+        resource.setTimestamp(date);\n+    }\n+\n+    public static void validateResource(Resource resource) {\n+        Resource.validateResource(resource);\n+    }\n+\n+    public static <T> void setProperty(JsonSerializable jsonSerializable, String propertyName, T value) {\n+        jsonSerializable.set(propertyName, value);\n+    }\n+\n+    public static ObjectNode getObject(JsonSerializable jsonSerializable, String propertyName) {\n+        return jsonSerializable.getObject(propertyName);\n+    }\n+\n+    public static void remove(JsonSerializable jsonSerializable, String propertyName) {\n+        jsonSerializable.remove(propertyName);\n+    }\n+\n+    public static Object getValue(JsonNode value) {\n+        return JsonSerializable.getValue(value);\n+    }\n+\n+    public static CosmosError createCosmosError(ObjectNode objectNode) {\n+        return new CosmosError(objectNode);\n+    }\n+\n+    public static CosmosError createCosmosError(String jsonString) {\n+        return new CosmosError(jsonString);\n+    }\n+\n+    public static void populatePropertyBagJsonSerializable(JsonSerializable jsonSerializable) {\n+        jsonSerializable.populatePropertyBag();\n+    }\n+\n+    public static void setMapper(JsonSerializable jsonSerializable, ObjectMapper om) {\n+        jsonSerializable.setMapper(om);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzMxNw=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 403}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjU1Ng==", "bodyText": "I checked again, and this constructor is not used at all, I will see if we can remove this constructor and hence setMapper can be removed as well.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302556", "createdAt": "2020-03-07T18:34:35Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ModelBridgeInternal.java", "diffHunk": "@@ -0,0 +1,405 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.cosmos.model;\n+\n+import com.azure.cosmos.CosmosAsyncClient;\n+import com.azure.cosmos.CosmosAsyncContainer;\n+import com.azure.cosmos.CosmosAsyncDatabase;\n+import com.azure.cosmos.CosmosAsyncUser;\n+import com.azure.cosmos.CosmosClient;\n+import com.azure.cosmos.CosmosClientException;\n+import com.azure.cosmos.CosmosDatabase;\n+import com.azure.cosmos.CosmosStoredProcedure;\n+import com.azure.cosmos.CosmosTrigger;\n+import com.azure.cosmos.CosmosUserDefinedFunction;\n+import com.azure.cosmos.implementation.Conflict;\n+import com.azure.cosmos.implementation.Constants;\n+import com.azure.cosmos.implementation.CosmosItemProperties;\n+import com.azure.cosmos.implementation.Database;\n+import com.azure.cosmos.implementation.Document;\n+import com.azure.cosmos.implementation.DocumentCollection;\n+import com.azure.cosmos.implementation.HttpConstants;\n+import com.azure.cosmos.implementation.QueryMetrics;\n+import com.azure.cosmos.implementation.ReplicationPolicy;\n+import com.azure.cosmos.implementation.RequestOptions;\n+import com.azure.cosmos.implementation.ResourceResponse;\n+import com.azure.cosmos.implementation.RxDocumentServiceResponse;\n+import com.azure.cosmos.implementation.StoredProcedure;\n+import com.azure.cosmos.implementation.StoredProcedureResponse;\n+import com.azure.cosmos.implementation.Trigger;\n+import com.azure.cosmos.implementation.User;\n+import com.azure.cosmos.implementation.UserDefinedFunction;\n+import com.azure.cosmos.implementation.routing.PartitionKeyInternal;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+\n+import java.time.OffsetDateTime;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.ConcurrentMap;\n+\n+/**\n+ * This is meant to be used only internally as a bridge access to classes in\n+ * com.azure.cosmos.model package\n+ **/\n+public class ModelBridgeInternal {\n+\n+    public static CosmosAsyncConflictResponse createCosmosAsyncConflictResponse(ResourceResponse<Conflict> response,\n+                                                                                CosmosAsyncContainer container) {\n+        return new CosmosAsyncConflictResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncContainerResponse createCosmosAsyncContainerResponse(ResourceResponse<DocumentCollection> response,\n+                                                                                  CosmosAsyncDatabase database) {\n+        return new CosmosAsyncContainerResponse(response, database);\n+    }\n+\n+    public static CosmosAsyncDatabaseResponse createCosmosAsyncDatabaseResponse(ResourceResponse<Database> response,\n+                                                                                 CosmosAsyncClient client) {\n+        return new CosmosAsyncDatabaseResponse(response, client);\n+    }\n+\n+    public static <T> CosmosAsyncItemResponse<T> createCosmosAsyncItemResponse(ResourceResponse<Document> response, Class<T> classType) {\n+        return new CosmosAsyncItemResponse<>(response, classType);\n+    }\n+\n+    public static CosmosAsyncItemResponse createCosmosAsyncItemResponseWithObjectType(ResourceResponse<Document> response, Class classType) {\n+        return new CosmosAsyncItemResponse(response, classType);\n+    }\n+\n+    public static CosmosAsyncPermissionResponse createCosmosAsyncPermissionResponse(ResourceResponse<Permission> response,\n+                                                                                    CosmosAsyncUser cosmosUser) {\n+        return new CosmosAsyncPermissionResponse(response, cosmosUser);\n+    }\n+\n+    public static CosmosAsyncStoredProcedureResponse createCosmosAsyncStoredProcedureResponse(ResourceResponse<StoredProcedure> response,\n+                                                                                              CosmosAsyncContainer cosmosContainer) {\n+        return new CosmosAsyncStoredProcedureResponse(response, cosmosContainer);\n+    }\n+\n+    public static CosmosAsyncStoredProcedureResponse createCosmosAsyncStoredProcedureResponse(StoredProcedureResponse response,\n+                                                                                              CosmosAsyncContainer cosmosContainer,\n+                                                                                              String storedProcedureId) {\n+        return new CosmosAsyncStoredProcedureResponse(response, cosmosContainer, storedProcedureId);\n+    }\n+\n+    public static CosmosStoredProcedureProperties createCosmosStoredProcedureProperties(String jsonString) {\n+        return new CosmosStoredProcedureProperties(jsonString);\n+    }\n+\n+    public static CosmosAsyncTriggerResponse createCosmosAsyncTriggerResponse(ResourceResponse<Trigger> response,\n+                                                                              CosmosAsyncContainer container) {\n+        return new CosmosAsyncTriggerResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncUserDefinedFunctionResponse createCosmosAsyncUserDefinedFunctionResponse(ResourceResponse<UserDefinedFunction> response,\n+                                                                                                      CosmosAsyncContainer container) {\n+        return new CosmosAsyncUserDefinedFunctionResponse(response, container);\n+    }\n+\n+    public static CosmosAsyncUserResponse createCosmosAsyncUserResponse(ResourceResponse<User> response, CosmosAsyncDatabase database) {\n+        return new CosmosAsyncUserResponse(response, database);\n+    }\n+\n+    public static CosmosContainerResponse createCosmosContainerResponse(CosmosAsyncContainerResponse response,\n+                                                                        CosmosDatabase database, CosmosClient client) {\n+        return new CosmosContainerResponse(response, database, client);\n+    }\n+\n+    public static CosmosUserResponse createCosmosUserResponse(CosmosAsyncUserResponse response, CosmosDatabase database) {\n+        return new CosmosUserResponse(response, database);\n+    }\n+\n+    public static <T> CosmosItemResponse<T> createCosmosItemResponse(CosmosAsyncItemResponse<T> response) {\n+        return new CosmosItemResponse<>(response);\n+    }\n+\n+    public static CosmosDatabaseResponse createCosmosDatabaseResponse(CosmosAsyncDatabaseResponse response, CosmosClient client) {\n+        return new CosmosDatabaseResponse(response, client);\n+    }\n+\n+    public static CosmosStoredProcedureResponse createCosmosStoredProcedureResponse(CosmosAsyncStoredProcedureResponse resourceResponse,\n+                                                CosmosStoredProcedure storedProcedure) {\n+        return new CosmosStoredProcedureResponse(resourceResponse, storedProcedure);\n+    }\n+\n+    public static CosmosUserDefinedFunctionResponse createCosmosUserDefinedFunctionResponse(CosmosAsyncUserDefinedFunctionResponse resourceResponse,\n+                                                    CosmosUserDefinedFunction userDefinedFunction) {\n+        return new CosmosUserDefinedFunctionResponse(resourceResponse, userDefinedFunction);\n+    }\n+\n+    public static CosmosTriggerResponse createCosmosTriggerResponse(CosmosAsyncTriggerResponse asyncResponse,\n+                                        CosmosTrigger syncTrigger) {\n+        return new CosmosTriggerResponse(asyncResponse, syncTrigger);\n+    }\n+\n+    public static List<CosmosConflictProperties> getCosmosConflictPropertiesFromV2Results(List<Conflict> results) {\n+        return CosmosConflictProperties.getFromV2Results(results);\n+    }\n+\n+    public static DocumentCollection getV2Collection(CosmosContainerProperties containerProperties) {\n+        return containerProperties.getV2Collection();\n+    }\n+\n+    public static List<CosmosContainerProperties> getCosmosContainerPropertiesFromV2Results(List<DocumentCollection> results) {\n+        return CosmosContainerProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosDatabaseProperties> getCosmosDatabasePropertiesFromV2Results(List<Database> results) {\n+        return CosmosDatabaseProperties.getFromV2Results(results);\n+    }\n+\n+    public static <T> CosmosItemProperties getCosmosItemProperties(CosmosAsyncItemResponse<T> cosmosItemResponse) {\n+        return cosmosItemResponse.getProperties();\n+    }\n+\n+    public static <T> CosmosItemProperties getCosmosItemProperties(CosmosItemResponse<T> cosmosItemResponse) {\n+        return cosmosItemResponse.getProperties();\n+    }\n+\n+    public static Permission getV2Permissions(CosmosPermissionProperties permissionSettings) {\n+        return permissionSettings.getV2Permissions();\n+    }\n+\n+    public static List<CosmosPermissionProperties> getCosmosPermissionPropertiesFromV2Results(List<Permission> results) {\n+        return CosmosPermissionProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosStoredProcedureProperties> getCosmosStoredProcedurePropertiesFromV2Results(List<StoredProcedure> results) {\n+        return CosmosStoredProcedureProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosTriggerProperties> getCosmosTriggerPropertiesFromV2Results(List<Trigger> results) {\n+        return CosmosTriggerProperties.getFromV2Results(results);\n+    }\n+\n+    public static List<CosmosUserDefinedFunctionProperties> getCosmosUserDefinedFunctionPropertiesFromV2Results(List<UserDefinedFunction> results) {\n+        return CosmosUserDefinedFunctionProperties.getFromV2Results(results);\n+    }\n+\n+    public static User getV2User(CosmosUserProperties cosmosUserProperties) {\n+        return cosmosUserProperties.getV2User();\n+    }\n+\n+    public static List<CosmosUserProperties> getCosmosUserPropertiesFromV2Results(List<User> results) {\n+        return CosmosUserProperties.getFromV2Results(results);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosConflictRequestOptions cosmosConflictRequestOptions) {\n+        return cosmosConflictRequestOptions.toRequestOptions();\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosContainerRequestOptions cosmosContainerRequestOptions) {\n+        return cosmosContainerRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosContainerRequestOptions setOfferThroughput(CosmosContainerRequestOptions cosmosContainerRequestOptions,\n+                                                                   Integer offerThroughput) {\n+        return cosmosContainerRequestOptions.setOfferThroughput(offerThroughput);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosDatabaseRequestOptions cosmosDatabaseRequestOptions) {\n+        return cosmosDatabaseRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosDatabaseRequestOptions setOfferThroughput(CosmosDatabaseRequestOptions cosmosDatabaseRequestOptions,\n+                                                                   Integer offerThroughput) {\n+        return cosmosDatabaseRequestOptions.setOfferThroughput(offerThroughput);\n+    }\n+\n+    public static CosmosItemRequestOptions setPartitionKey(CosmosItemRequestOptions cosmosItemRequestOptions,\n+                                                           PartitionKey partitionKey) {\n+        return cosmosItemRequestOptions.setPartitionKey(partitionKey);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosItemRequestOptions cosmosItemRequestOptions) {\n+        return cosmosItemRequestOptions.toRequestOptions();\n+    }\n+\n+    public static CosmosItemRequestOptions createCosmosItemRequestOptions(PartitionKey partitionKey) {\n+        return new CosmosItemRequestOptions(partitionKey);\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosPermissionRequestOptions cosmosPermissionRequestOptions) {\n+        return cosmosPermissionRequestOptions.toRequestOptions();\n+    }\n+\n+    public static RequestOptions toRequestOptions(CosmosStoredProcedureRequestOptions cosmosStoredProcedureRequestOptions) {\n+        return cosmosStoredProcedureRequestOptions.toRequestOptions();\n+    }\n+\n+    public static String getAddressesLink(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getAddressesLink();\n+    }\n+\n+    public static DatabaseAccount toDatabaseAccount(RxDocumentServiceResponse response) {\n+        DatabaseAccount account = response.getResource(DatabaseAccount.class);\n+\n+        // read the headers and set to the account\n+        Map<String, String> responseHeader = response.getResponseHeaders();\n+\n+        account.setMaxMediaStorageUsageInMB(\n+            Long.valueOf(responseHeader.get(HttpConstants.HttpHeaders.MAX_MEDIA_STORAGE_USAGE_IN_MB)));\n+        account.setMediaStorageUsageInMB(\n+            Long.valueOf(responseHeader.get(HttpConstants.HttpHeaders.CURRENT_MEDIA_STORAGE_USAGE_IN_MB)));\n+\n+        return account;\n+    }\n+\n+    public static Map<String, Object> getQueryEngineConfiuration(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getQueryEngineConfiguration();\n+    }\n+\n+    public static ReplicationPolicy getReplicationPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getReplicationPolicy();\n+    }\n+\n+    public static ReplicationPolicy getSystemReplicationPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getSystemReplicationPolicy();\n+    }\n+\n+    public static ConsistencyPolicy getConsistencyPolicy(DatabaseAccount databaseAccount) {\n+        return databaseAccount.getConsistencyPolicy();\n+    }\n+\n+    /**\n+     * Gets the partitionKeyRangeId.\n+     *\n+     * @param options the feed options\n+     * @return the partitionKeyRangeId.\n+     */\n+    public static String partitionKeyRangeIdInternal(FeedOptions options) {\n+        return options.getPartitionKeyRangeIdInternal();\n+    }\n+\n+    /**\n+     * Sets the PartitionKeyRangeId.\n+     *\n+     * @param options the feed options\n+     * @param partitionKeyRangeId the partition key range id\n+     * @return the partitionKeyRangeId.\n+     */\n+    public static FeedOptions partitionKeyRangeIdInternal(FeedOptions options, String partitionKeyRangeId) {\n+        return options.setPartitionKeyRangeIdInternal(partitionKeyRangeId);\n+    }\n+\n+    public static <T extends Resource> FeedResponse<T> toFeedResponsePage(RxDocumentServiceResponse response,\n+                                                                          Class<T> cls) {\n+        return new FeedResponse<T>(response.getQueryResponse(cls), response.getResponseHeaders());\n+    }\n+\n+    public static <T> FeedResponse<T> toFeedResponsePage(List<T> results, Map<String, String> headers, boolean noChanges) {\n+        return new FeedResponse<>(results, headers, noChanges);\n+    }\n+\n+    public static <T extends Resource> FeedResponse<T> toChaneFeedResponsePage(RxDocumentServiceResponse response,\n+                                                                               Class<T> cls) {\n+        return new FeedResponse<T>(noChanges(response) ? Collections.emptyList() : response.getQueryResponse(cls),\n+            response.getResponseHeaders(), noChanges(response));\n+    }\n+\n+    public static <T extends Resource> boolean noChanges(FeedResponse<T> page) {\n+        return page.nochanges;\n+    }\n+\n+    public static <T extends Resource> boolean noChanges(RxDocumentServiceResponse rsp) {\n+        return rsp.getStatusCode() == HttpConstants.StatusCodes.NOT_MODIFIED;\n+    }\n+\n+    public static <T> FeedResponse<T> createFeedResponse(List<T> results,\n+                                                         Map<String, String> headers) {\n+        return new FeedResponse<>(results, headers);\n+    }\n+\n+    public static <T> FeedResponse<T> createFeedResponseWithQueryMetrics(List<T> results,\n+                                                                         Map<String, String> headers, ConcurrentMap<String, QueryMetrics> queryMetricsMap) {\n+        return new FeedResponse<>(results, headers, queryMetricsMap);\n+    }\n+\n+    public static <T> ConcurrentMap<String, QueryMetrics> queryMetricsMap(FeedResponse<T> feedResponse) {\n+        return feedResponse.queryMetricsMap();\n+    }\n+\n+    public static <T> ConcurrentMap<String, QueryMetrics> queryMetrics(FeedResponse<T> feedResponse) {\n+        return feedResponse.queryMetrics();\n+    }\n+\n+    public static String toLower(RequestVerb verb) {\n+        return verb.toLowerCase();\n+    }\n+\n+    public static boolean isV2(PartitionKeyDefinition pkd) {\n+        return pkd.getVersion() != null && PartitionKeyDefinitionVersion.V2.val == pkd.getVersion().val;\n+    }\n+\n+    public static PartitionKeyInternal getNonePartitionKey(PartitionKeyDefinition partitionKeyDefinition) {\n+        return partitionKeyDefinition.getNonePartitionKeyValue();\n+    }\n+\n+    public static PartitionKeyInternal getPartitionKeyInternal(PartitionKey partitionKey) {\n+        return partitionKey.getInternalPartitionKey();\n+    }\n+\n+    public static PartitionKey partitionKeyfromJsonString(String jsonString) {\n+        return PartitionKey.fromJsonString(jsonString);\n+    }\n+\n+    public static Object getPartitionKeyObject(PartitionKey right) {\n+        return right.getKeyObject();\n+    }\n+\n+    public static String getAltLink(Resource resource) {\n+        return resource.getAltLink();\n+    }\n+\n+    public static void setAltLink(Resource resource, String altLink) {\n+        resource.setAltLink(altLink);\n+    }\n+\n+    public static void setResourceSelfLink(Resource resource, String selfLink) {\n+        resource.setSelfLink(selfLink);\n+    }\n+\n+    public static void setTimestamp(Resource resource, OffsetDateTime date) {\n+        resource.setTimestamp(date);\n+    }\n+\n+    public static void validateResource(Resource resource) {\n+        Resource.validateResource(resource);\n+    }\n+\n+    public static <T> void setProperty(JsonSerializable jsonSerializable, String propertyName, T value) {\n+        jsonSerializable.set(propertyName, value);\n+    }\n+\n+    public static ObjectNode getObject(JsonSerializable jsonSerializable, String propertyName) {\n+        return jsonSerializable.getObject(propertyName);\n+    }\n+\n+    public static void remove(JsonSerializable jsonSerializable, String propertyName) {\n+        jsonSerializable.remove(propertyName);\n+    }\n+\n+    public static Object getValue(JsonNode value) {\n+        return JsonSerializable.getValue(value);\n+    }\n+\n+    public static CosmosError createCosmosError(ObjectNode objectNode) {\n+        return new CosmosError(objectNode);\n+    }\n+\n+    public static CosmosError createCosmosError(String jsonString) {\n+        return new CosmosError(jsonString);\n+    }\n+\n+    public static void populatePropertyBagJsonSerializable(JsonSerializable jsonSerializable) {\n+        jsonSerializable.populatePropertyBag();\n+    }\n+\n+    public static void setMapper(JsonSerializable jsonSerializable, ObjectMapper om) {\n+        jsonSerializable.setMapper(om);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzMxNw=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 403}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk4NzM0OnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/BridgeInternal.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjo1MTo1OVrOFzO_-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODozMDo1NlrOFzRIJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzQ0OA==", "bodyText": "can you move instantiateJsonSerializable to model package?\nIf you do that then you don't have to do setAccessible()", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389267448", "createdAt": "2020-03-07T16:51:59Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/BridgeInternal.java", "diffHunk": "@@ -544,12 +493,61 @@ public static JsonSerializable instantiateJsonSerializable(ObjectNode objectNode\n                 || klassType.equals(DatabaseAccount.class) || klassType.equals(DatabaseAccountLocation.class)\n                 || klassType.equals(ReplicationPolicy.class) || klassType.equals(ConsistencyPolicy.class)\n                 || klassType.equals(DocumentCollection.class) || klassType.equals(Database.class)) {\n-                return (JsonSerializable) klassType.getDeclaredConstructor(ObjectNode.class).newInstance(objectNode);\n+                Constructor declaredConstructor =\n+                    klassType.getDeclaredConstructor(ObjectNode.class);\n+                declaredConstructor.setAccessible(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 288}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjMxMA==", "bodyText": "Agreed, will move it.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302310", "createdAt": "2020-03-07T18:30:56Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/BridgeInternal.java", "diffHunk": "@@ -544,12 +493,61 @@ public static JsonSerializable instantiateJsonSerializable(ObjectNode objectNode\n                 || klassType.equals(DatabaseAccount.class) || klassType.equals(DatabaseAccountLocation.class)\n                 || klassType.equals(ReplicationPolicy.class) || klassType.equals(ConsistencyPolicy.class)\n                 || klassType.equals(DocumentCollection.class) || klassType.equals(Database.class)) {\n-                return (JsonSerializable) klassType.getDeclaredConstructor(ObjectNode.class).newInstance(objectNode);\n+                Constructor declaredConstructor =\n+                    klassType.getDeclaredConstructor(ObjectNode.class);\n+                declaredConstructor.setAccessible(true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzQ0OA=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 288}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMTk4NzQyOnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/BridgeInternal.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxNjo1MjoxOFrOFzPAAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QxODozNTozMlrOFzRJXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzQ1Nw==", "bodyText": "same here. if instantiateJsonSerializable is moved to model package, setAccessable should be required.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389267457", "createdAt": "2020-03-07T16:52:18Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/BridgeInternal.java", "diffHunk": "@@ -544,12 +493,61 @@ public static JsonSerializable instantiateJsonSerializable(ObjectNode objectNode\n                 || klassType.equals(DatabaseAccount.class) || klassType.equals(DatabaseAccountLocation.class)\n                 || klassType.equals(ReplicationPolicy.class) || klassType.equals(ConsistencyPolicy.class)\n                 || klassType.equals(DocumentCollection.class) || klassType.equals(Database.class)) {\n-                return (JsonSerializable) klassType.getDeclaredConstructor(ObjectNode.class).newInstance(objectNode);\n+                Constructor declaredConstructor =\n+                    klassType.getDeclaredConstructor(ObjectNode.class);\n+                declaredConstructor.setAccessible(true);\n+                return (JsonSerializable) declaredConstructor.newInstance(objectNode);\n             } else {\n-                return (JsonSerializable) klassType.getDeclaredConstructor(String.class).newInstance(Utils.toJson(Utils.getSimpleObjectMapper(), objectNode));\n+                Constructor declaredConstructor = klassType.getDeclaredConstructor(String.class);\n+                declaredConstructor.setAccessible(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 293}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMjYyMQ==", "bodyText": "moved it to ModelBridgeInternal.java", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389302621", "createdAt": "2020-03-07T18:35:32Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/BridgeInternal.java", "diffHunk": "@@ -544,12 +493,61 @@ public static JsonSerializable instantiateJsonSerializable(ObjectNode objectNode\n                 || klassType.equals(DatabaseAccount.class) || klassType.equals(DatabaseAccountLocation.class)\n                 || klassType.equals(ReplicationPolicy.class) || klassType.equals(ConsistencyPolicy.class)\n                 || klassType.equals(DocumentCollection.class) || klassType.equals(Database.class)) {\n-                return (JsonSerializable) klassType.getDeclaredConstructor(ObjectNode.class).newInstance(objectNode);\n+                Constructor declaredConstructor =\n+                    klassType.getDeclaredConstructor(ObjectNode.class);\n+                declaredConstructor.setAccessible(true);\n+                return (JsonSerializable) declaredConstructor.newInstance(objectNode);\n             } else {\n-                return (JsonSerializable) klassType.getDeclaredConstructor(String.class).newInstance(Utils.toJson(Utils.getSimpleObjectMapper(), objectNode));\n+                Constructor declaredConstructor = klassType.getDeclaredConstructor(String.class);\n+                declaredConstructor.setAccessible(true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI2NzQ1Nw=="}, "originalCommit": {"oid": "d258f0d8f205c058bf09a849f634984884a119fc"}, "originalPosition": 293}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMjM4NDE0OnYy", "diffSide": "RIGHT", "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/BasicDemo.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwMTozNDozMFrOFzSl6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQwOTo1NDozMFrOFzUPdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjMxMw==", "bodyText": "I am not sure if CosmosPageFlux is a model or not.\nFrom one perspective  using CosmosPageFlux internally will issue IO request to fetch more results, so it shouldn't be a model.\nfrom another perspective, other query result classes are model, so one may say this one is a model too.\nCan we check what some other services are doing? is any other service sdk using pageflux?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389326313", "createdAt": "2020-03-08T01:34:30Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/BasicDemo.java", "diffHunk": "@@ -5,14 +5,14 @@\n import com.azure.cosmos.CosmosAsyncClient;\n import com.azure.cosmos.CosmosAsyncContainer;\n import com.azure.cosmos.CosmosAsyncDatabase;\n-import com.azure.cosmos.CosmosAsyncItemResponse;\n+import com.azure.cosmos.model.CosmosAsyncItemResponse;\n import com.azure.cosmos.CosmosClientBuilder;\n import com.azure.cosmos.CosmosClientException;\n-import com.azure.cosmos.CosmosContainerProperties;\n-import com.azure.cosmos.CosmosPagedFlux;\n-import com.azure.cosmos.FeedOptions;\n-import com.azure.cosmos.FeedResponse;\n-import com.azure.cosmos.PartitionKey;\n+import com.azure.cosmos.model.CosmosContainerProperties;\n+import com.azure.cosmos.model.CosmosPagedFlux;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "481c6de304617ea036f44152e9514b55902b60f8"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM1MzMzNA==", "bodyText": "Sure, to be consistent with other azure SDKs, I reverted the change and moved both CosmosPagedFlux and CosmosPagedIterable back to cosmos package.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8837#discussion_r389353334", "createdAt": "2020-03-08T09:54:30Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/BasicDemo.java", "diffHunk": "@@ -5,14 +5,14 @@\n import com.azure.cosmos.CosmosAsyncClient;\n import com.azure.cosmos.CosmosAsyncContainer;\n import com.azure.cosmos.CosmosAsyncDatabase;\n-import com.azure.cosmos.CosmosAsyncItemResponse;\n+import com.azure.cosmos.model.CosmosAsyncItemResponse;\n import com.azure.cosmos.CosmosClientBuilder;\n import com.azure.cosmos.CosmosClientException;\n-import com.azure.cosmos.CosmosContainerProperties;\n-import com.azure.cosmos.CosmosPagedFlux;\n-import com.azure.cosmos.FeedOptions;\n-import com.azure.cosmos.FeedResponse;\n-import com.azure.cosmos.PartitionKey;\n+import com.azure.cosmos.model.CosmosContainerProperties;\n+import com.azure.cosmos.model.CosmosPagedFlux;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyNjMxMw=="}, "originalCommit": {"oid": "481c6de304617ea036f44152e9514b55902b60f8"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 217, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}