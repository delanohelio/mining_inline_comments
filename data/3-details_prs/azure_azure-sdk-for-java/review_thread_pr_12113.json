{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzMzcxNDQy", "number": 12113, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjo1NTowMVrOEE4Bxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzowNDoxOVrOEE4JCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTQ3NzE5OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjo1NTowMVrOGixaSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjo1NTowMVrOGixaSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNDMxNQ==", "bodyText": "nit: add method-level javadocs.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439114315", "createdAt": "2020-06-11T22:55:01Z", "author": {"login": "srnagar"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "diffHunk": "@@ -1,22 +1,58 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.storage.blob.models;\n+package com.azure.storage.blob.options;\n \n import com.azure.core.annotation.Fluent;\n+import com.azure.storage.blob.models.AccessTier;\n+import com.azure.storage.blob.models.BlobHttpHeaders;\n+import com.azure.storage.blob.models.BlobRequestConditions;\n+import com.azure.storage.blob.models.ParallelTransferOptions;\n+import reactor.core.publisher.Flux;\n \n+import java.io.InputStream;\n+import java.nio.ByteBuffer;\n+import java.time.Duration;\n import java.util.Map;\n \n /**\n  * Extended options that may be passed when uploading a Block Blob in parallel.\n  */\n @Fluent\n public class BlobParallelUploadOptions {\n+    private final InputStream dataStream;\n+    private final long length;\n     private ParallelTransferOptions parallelTransferOptions;\n     private BlobHttpHeaders headers;\n     private Map<String, String> metadata;\n     private AccessTier tier;\n     private BlobRequestConditions requestConditions;\n+    private Duration timeout;\n+\n+    /**\n+     * @param dataStream The data to write to the blob.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTQ4MDI1OnYy", "diffSide": "LEFT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/BlobClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjo1NjoxN1rOGixcFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzowNjozMFrOGixocg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNDc3Mg==", "bodyText": "This was added in a preview right?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439114772", "createdAt": "2020-06-11T22:56:17Z", "author": {"login": "alzimmermsft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/BlobClient.java", "diffHunk": "@@ -170,39 +171,33 @@ public void upload(InputStream data, long length, boolean overwrite) {\n     public void uploadWithResponse(InputStream data, long length, ParallelTransferOptions parallelTransferOptions,\n         BlobHttpHeaders headers, Map<String, String> metadata, AccessTier tier, BlobRequestConditions requestConditions,\n         Duration timeout, Context context) {\n-        uploadWithResponse(data, length, new BlobParallelUploadOptions()\n+        uploadWithResponse(new BlobParallelUploadOptions(data, length)\n             .setParallelTransferOptions(parallelTransferOptions).setHeaders(headers).setMetadata(metadata).setTier(tier)\n-            .setRequestConditions(requestConditions), timeout, context);\n+            .setRequestConditions(requestConditions).setTimeout(timeout), context);\n     }\n \n     /**\n      * Creates a new blob, or updates the content of an existing blob.\n      * <p>\n      * To avoid overwriting, pass \"*\" to {@link BlobRequestConditions#setIfNoneMatch(String)}.\n-     *\n-     * @param data The data to write to the blob.\n-     * @param length The exact length of the data. It is important that this value match precisely the length of the\n-     * data provided in the {@link InputStream}.\n      * @param options {@link BlobParallelUploadOptions}\n-     * @param timeout An optional timeout value beyond which a {@link RuntimeException} will be raised.\n      * @param context Additional context that is passed through the Http pipeline during the service call.\n      * @return Information about the uploaded block blob.\n      */\n-    public Response<BlockBlobItem> uploadWithResponse(InputStream data, long length, BlobParallelUploadOptions options,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNzkzOA==", "bodyText": "Correct. 12.7.0-beta.1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439117938", "createdAt": "2020-06-11T23:06:30Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/BlobClient.java", "diffHunk": "@@ -170,39 +171,33 @@ public void upload(InputStream data, long length, boolean overwrite) {\n     public void uploadWithResponse(InputStream data, long length, ParallelTransferOptions parallelTransferOptions,\n         BlobHttpHeaders headers, Map<String, String> metadata, AccessTier tier, BlobRequestConditions requestConditions,\n         Duration timeout, Context context) {\n-        uploadWithResponse(data, length, new BlobParallelUploadOptions()\n+        uploadWithResponse(new BlobParallelUploadOptions(data, length)\n             .setParallelTransferOptions(parallelTransferOptions).setHeaders(headers).setMetadata(metadata).setTier(tier)\n-            .setRequestConditions(requestConditions), timeout, context);\n+            .setRequestConditions(requestConditions).setTimeout(timeout), context);\n     }\n \n     /**\n      * Creates a new blob, or updates the content of an existing blob.\n      * <p>\n      * To avoid overwriting, pass \"*\" to {@link BlobRequestConditions#setIfNoneMatch(String)}.\n-     *\n-     * @param data The data to write to the blob.\n-     * @param length The exact length of the data. It is important that this value match precisely the length of the\n-     * data provided in the {@link InputStream}.\n      * @param options {@link BlobParallelUploadOptions}\n-     * @param timeout An optional timeout value beyond which a {@link RuntimeException} will be raised.\n      * @param context Additional context that is passed through the Http pipeline during the service call.\n      * @return Information about the uploaded block blob.\n      */\n-    public Response<BlockBlobItem> uploadWithResponse(InputStream data, long length, BlobParallelUploadOptions options,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNDc3Mg=="}, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTQ4MjM1OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/BlobClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjo1NzoyOFrOGixddw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzowOToyM1rOGixsCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNTEyNw==", "bodyText": "Does the corresponding async method have an options bag as well?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439115127", "createdAt": "2020-06-11T22:57:28Z", "author": {"login": "alzimmermsft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/BlobClient.java", "diffHunk": "@@ -170,39 +171,33 @@ public void upload(InputStream data, long length, boolean overwrite) {\n     public void uploadWithResponse(InputStream data, long length, ParallelTransferOptions parallelTransferOptions,\n         BlobHttpHeaders headers, Map<String, String> metadata, AccessTier tier, BlobRequestConditions requestConditions,\n         Duration timeout, Context context) {\n-        uploadWithResponse(data, length, new BlobParallelUploadOptions()\n+        uploadWithResponse(new BlobParallelUploadOptions(data, length)\n             .setParallelTransferOptions(parallelTransferOptions).setHeaders(headers).setMetadata(metadata).setTier(tier)\n-            .setRequestConditions(requestConditions), timeout, context);\n+            .setRequestConditions(requestConditions).setTimeout(timeout), context);\n     }\n \n     /**\n      * Creates a new blob, or updates the content of an existing blob.\n      * <p>\n      * To avoid overwriting, pass \"*\" to {@link BlobRequestConditions#setIfNoneMatch(String)}.\n-     *\n-     * @param data The data to write to the blob.\n-     * @param length The exact length of the data. It is important that this value match precisely the length of the\n-     * data provided in the {@link InputStream}.\n      * @param options {@link BlobParallelUploadOptions}\n-     * @param timeout An optional timeout value beyond which a {@link RuntimeException} will be raised.\n      * @param context Additional context that is passed through the Http pipeline during the service call.\n      * @return Information about the uploaded block blob.\n      */\n-    public Response<BlockBlobItem> uploadWithResponse(InputStream data, long length, BlobParallelUploadOptions options,\n-        Duration timeout, Context context) {\n-        BlobParallelUploadOptions blobParallelUploadOptions = options == null ? new BlobParallelUploadOptions()\n-            : options;\n+    public Response<BlockBlobItem> uploadWithResponse(BlobParallelUploadOptions options, Context context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExODg1OA==", "bodyText": "Yes-ish. There is a corresponding upload method on async, but we did not add an options bag upload for it in master. We added it only on sync to address a Snowflake issue which required us to return the BlockBlobItem. I will be updating this for both sync and async in the stg73 branch. I can add the async overload here now, though, if you'd prefer it maintain its symmetry", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439118858", "createdAt": "2020-06-11T23:09:23Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/BlobClient.java", "diffHunk": "@@ -170,39 +171,33 @@ public void upload(InputStream data, long length, boolean overwrite) {\n     public void uploadWithResponse(InputStream data, long length, ParallelTransferOptions parallelTransferOptions,\n         BlobHttpHeaders headers, Map<String, String> metadata, AccessTier tier, BlobRequestConditions requestConditions,\n         Duration timeout, Context context) {\n-        uploadWithResponse(data, length, new BlobParallelUploadOptions()\n+        uploadWithResponse(new BlobParallelUploadOptions(data, length)\n             .setParallelTransferOptions(parallelTransferOptions).setHeaders(headers).setMetadata(metadata).setTier(tier)\n-            .setRequestConditions(requestConditions), timeout, context);\n+            .setRequestConditions(requestConditions).setTimeout(timeout), context);\n     }\n \n     /**\n      * Creates a new blob, or updates the content of an existing blob.\n      * <p>\n      * To avoid overwriting, pass \"*\" to {@link BlobRequestConditions#setIfNoneMatch(String)}.\n-     *\n-     * @param data The data to write to the blob.\n-     * @param length The exact length of the data. It is important that this value match precisely the length of the\n-     * data provided in the {@link InputStream}.\n      * @param options {@link BlobParallelUploadOptions}\n-     * @param timeout An optional timeout value beyond which a {@link RuntimeException} will be raised.\n      * @param context Additional context that is passed through the Http pipeline during the service call.\n      * @return Information about the uploaded block blob.\n      */\n-    public Response<BlockBlobItem> uploadWithResponse(InputStream data, long length, BlobParallelUploadOptions options,\n-        Duration timeout, Context context) {\n-        BlobParallelUploadOptions blobParallelUploadOptions = options == null ? new BlobParallelUploadOptions()\n-            : options;\n+    public Response<BlockBlobItem> uploadWithResponse(BlobParallelUploadOptions options, Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNTEyNw=="}, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTQ5NDU2OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzowMzo0NFrOGixk5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzoxMDo1M1rOGixtzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNzAzMQ==", "bodyText": "This should include Flux<ByteBuffer> as well and a ctor overload for it.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439117031", "createdAt": "2020-06-11T23:03:44Z", "author": {"login": "srnagar"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "diffHunk": "@@ -1,22 +1,58 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.storage.blob.models;\n+package com.azure.storage.blob.options;\n \n import com.azure.core.annotation.Fluent;\n+import com.azure.storage.blob.models.AccessTier;\n+import com.azure.storage.blob.models.BlobHttpHeaders;\n+import com.azure.storage.blob.models.BlobRequestConditions;\n+import com.azure.storage.blob.models.ParallelTransferOptions;\n+import reactor.core.publisher.Flux;\n \n+import java.io.InputStream;\n+import java.nio.ByteBuffer;\n+import java.time.Duration;\n import java.util.Map;\n \n /**\n  * Extended options that may be passed when uploading a Block Blob in parallel.\n  */\n @Fluent\n public class BlobParallelUploadOptions {\n+    private final InputStream dataStream;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExOTMxMQ==", "bodyText": "See response to Alan's comment. Resolving per offline discussion", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439119311", "createdAt": "2020-06-11T23:10:53Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "diffHunk": "@@ -1,22 +1,58 @@\n // Copyright (c) Microsoft Corporation. All rights reserved.\n // Licensed under the MIT License.\n \n-package com.azure.storage.blob.models;\n+package com.azure.storage.blob.options;\n \n import com.azure.core.annotation.Fluent;\n+import com.azure.storage.blob.models.AccessTier;\n+import com.azure.storage.blob.models.BlobHttpHeaders;\n+import com.azure.storage.blob.models.BlobRequestConditions;\n+import com.azure.storage.blob.models.ParallelTransferOptions;\n+import reactor.core.publisher.Flux;\n \n+import java.io.InputStream;\n+import java.nio.ByteBuffer;\n+import java.time.Duration;\n import java.util.Map;\n \n /**\n  * Extended options that may be passed when uploading a Block Blob in parallel.\n  */\n @Fluent\n public class BlobParallelUploadOptions {\n+    private final InputStream dataStream;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNzAzMQ=="}, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNTQ5NTc3OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzowNDoxOVrOGixlng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzoxMDoyNVrOGixtMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNzIxNA==", "bodyText": "Also, document that this will be ignored for async operations.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439117214", "createdAt": "2020-06-11T23:04:19Z", "author": {"login": "srnagar"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "diffHunk": "@@ -97,4 +133,17 @@ public BlobParallelUploadOptions setRequestConditions(BlobRequestConditions requ\n         this.requestConditions = requestConditions;\n         return this;\n     }\n+\n+    public Duration getTimeout() {\n+        return this.timeout;\n+    }\n+\n+    /**\n+     * @param timeout An optional timeout value beyond which a {@link RuntimeException} will be raised.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExOTE1Mg==", "bodyText": "I will add that in the stg73 branch when I update it there. Right now this only applies to sync, so it won't make sense to mention that.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12113#discussion_r439119152", "createdAt": "2020-06-11T23:10:25Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobParallelUploadOptions.java", "diffHunk": "@@ -97,4 +133,17 @@ public BlobParallelUploadOptions setRequestConditions(BlobRequestConditions requ\n         this.requestConditions = requestConditions;\n         return this;\n     }\n+\n+    public Duration getTimeout() {\n+        return this.timeout;\n+    }\n+\n+    /**\n+     * @param timeout An optional timeout value beyond which a {@link RuntimeException} will be raised.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExNzIxNA=="}, "originalCommit": {"oid": "26a638035dce602be5ebc2373050cd66803935dc"}, "originalPosition": 70}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3897, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}