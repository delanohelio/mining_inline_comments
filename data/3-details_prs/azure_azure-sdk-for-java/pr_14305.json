{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwODQ5MDYw", "number": 14305, "title": "Use next link from group membership request", "bodyText": "loadUsers() only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\nFor V1 odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\nFor V2 odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\nfix #14222", "createdAt": "2020-08-20T11:35:05Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305", "merged": true, "mergeCommit": {"oid": "419eeb19df85de17611e0df029409f702b400ff8"}, "closed": true, "closedAt": "2020-08-31T05:39:22Z", "author": {"login": "ppartarr"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAvFA5gBqjM2NzQ5MzQyNzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEMGrKgFqTQ3ODMyMTYyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73907f56ef478ed44720c610936dfcc2c079fffe", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/73907f56ef478ed44720c610936dfcc2c079fffe", "committedDate": "2020-08-20T11:28:16Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}, "afterCommit": {"oid": "50118879acb60f97469b77025acee7f67736258e", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/50118879acb60f97469b77025acee7f67736258e", "committedDate": "2020-08-20T12:07:56Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "50118879acb60f97469b77025acee7f67736258e", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/50118879acb60f97469b77025acee7f67736258e", "committedDate": "2020-08-20T12:07:56Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}, "afterCommit": {"oid": "42f76973a73399039ad8c4aaf264f6fca540483c", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/42f76973a73399039ad8c4aaf264f6fca540483c", "committedDate": "2020-08-20T12:15:39Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "42f76973a73399039ad8c4aaf264f6fca540483c", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/42f76973a73399039ad8c4aaf264f6fca540483c", "committedDate": "2020-08-20T12:15:39Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}, "afterCommit": {"oid": "78a2aeb1c22769a7c6dda521016bf259fd6b3aed", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/78a2aeb1c22769a7c6dda521016bf259fd6b3aed", "committedDate": "2020-08-20T12:16:42Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78a2aeb1c22769a7c6dda521016bf259fd6b3aed", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/78a2aeb1c22769a7c6dda521016bf259fd6b3aed", "committedDate": "2020-08-20T12:16:42Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}, "afterCommit": {"oid": "02755715d8bb277ed14f934ca253365600953e87", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/02755715d8bb277ed14f934ca253365600953e87", "committedDate": "2020-08-20T12:58:47Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02755715d8bb277ed14f934ca253365600953e87", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/02755715d8bb277ed14f934ca253365600953e87", "committedDate": "2020-08-20T12:58:47Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}, "afterCommit": {"oid": "fd5ed7040e637bb3df6d8e04595081b099821b39", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fd5ed7040e637bb3df6d8e04595081b099821b39", "committedDate": "2020-08-21T09:28:36Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNTg0NTMz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-472584533", "createdAt": "2020-08-21T15:24:46Z", "commit": {"oid": "fd5ed7040e637bb3df6d8e04595081b099821b39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNToyNDo0NlrOHExjiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNToyNDo0NlrOHExjiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc2ODI2Nw==", "bodyText": "Ah, yes, we have guidance around adding dependencies. Is there a reason this is required?\nThere is guidance around how to add dependencies. https://github.com/Azure/azure-sdk-for-java/blob/master/CONTRIBUTING.md#current-version-dependency-version-unreleased-dependency-version-and-released-beta-dependency-version", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r474768267", "createdAt": "2020-08-21T15:24:46Z", "author": {"login": "conniey"}, "path": "sdk/spring/azure-spring-boot/pom.xml", "diffHunk": "@@ -197,6 +197,12 @@\n       <version>2.11.2</version> <!-- {x-version-update;com.fasterxml.jackson.core:jackson-databind;external_dependency} -->\n     </dependency>\n \n+    <dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd5ed7040e637bb3df6d8e04595081b099821b39"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd5ed7040e637bb3df6d8e04595081b099821b39", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fd5ed7040e637bb3df6d8e04595081b099821b39", "committedDate": "2020-08-21T09:28:36Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}, "afterCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/42467b4341c1fb56f051453a19e5879247f4406c", "committedDate": "2020-08-21T16:34:15Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMzAxNjIx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-473301621", "createdAt": "2020-08-24T09:46:23Z", "commit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwOTo0NjoyM1rOHFc4Mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwMTo1NjozOFrOHG3_QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTQ3ODA2Ng==", "bodyText": "odataNextLink is not used?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r475478066", "createdAt": "2020-08-24T09:46:23Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AzureADGraphClient.java", "diffHunk": "@@ -77,7 +77,7 @@ private void initAADMicrosoftGraphApiBool(String endpointEnv) {\n         this.aadMicrosoftGraphApiBool = endpointEnv.contains(V2_VERSION_ENV_FLAG);\n     }\n \n-    private String getUserMembershipsV1(String accessToken) throws IOException {\n+    private String getUserMemberships(String accessToken, Optional<String> odataNextLink) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk3MDgxNw==", "bodyText": "Is Jdk8Module is used for support Optional type in json?\nCan we use null instead of Optional?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r476970817", "createdAt": "2020-08-26T01:56:38Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AzureADGraphClient.java", "diffHunk": "@@ -121,22 +121,21 @@ private static String getResponseStringFromConn(HttpURLConnection conn) throws I\n     }\n \n     private List<UserGroup> loadUserGroups(String graphApiToken) throws IOException {\n-        final String responseInJson = getUserMembershipsV1(graphApiToken);\n+        String responseInJson = getUserMemberships(graphApiToken, Optional.empty());\n         final List<UserGroup> lUserGroups = new ArrayList<>();\n         final ObjectMapper objectMapper = JacksonObjectMapperFactory.getInstance();\n-        final JsonNode rootNode = objectMapper.readValue(responseInJson, JsonNode.class);\n-        final JsonNode valuesNode = rootNode.get(\"value\");\n-\n-        if (valuesNode != null) {\n-            lUserGroups\n-                .addAll(StreamSupport.stream(valuesNode.spliterator(), false).filter(this::isMatchingUserGroupKey)\n-                    .map(node -> {\n-                        final String objectID = node.\n-                            get(aadAuthenticationProperties.getUserGroup().getObjectIDKey()).asText();\n-                        final String displayName = node.get(\"displayName\").asText();\n-                        return new UserGroup(objectID, displayName);\n-                    }).collect(Collectors.toList()));\n+        objectMapper.registerModule(new Jdk8Module());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MjIwNzI3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-475220727", "createdAt": "2020-08-26T07:27:58Z", "commit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNzoyNzo1OFrOHG_TaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNzoyNzo1OFrOHG_TaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzA5MDY2NQ==", "bodyText": "I debugged in my localhost, groupsFromJson.getOdataNextLink() will return null, not Optional.empty(), so groupsFromJson.getOdataNextLink().isPresent() will throw NullPointerExceotion.\nJson:\n\nScreenshot of IDE:", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r477090665", "createdAt": "2020-08-26T07:27:58Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AzureADGraphClient.java", "diffHunk": "@@ -121,22 +121,21 @@ private static String getResponseStringFromConn(HttpURLConnection conn) throws I\n     }\n \n     private List<UserGroup> loadUserGroups(String graphApiToken) throws IOException {\n-        final String responseInJson = getUserMembershipsV1(graphApiToken);\n+        String responseInJson = getUserMemberships(graphApiToken, Optional.empty());\n         final List<UserGroup> lUserGroups = new ArrayList<>();\n         final ObjectMapper objectMapper = JacksonObjectMapperFactory.getInstance();\n-        final JsonNode rootNode = objectMapper.readValue(responseInJson, JsonNode.class);\n-        final JsonNode valuesNode = rootNode.get(\"value\");\n-\n-        if (valuesNode != null) {\n-            lUserGroups\n-                .addAll(StreamSupport.stream(valuesNode.spliterator(), false).filter(this::isMatchingUserGroupKey)\n-                    .map(node -> {\n-                        final String objectID = node.\n-                            get(aadAuthenticationProperties.getUserGroup().getObjectIDKey()).asText();\n-                        final String displayName = node.get(\"displayName\").asText();\n-                        return new UserGroup(objectID, displayName);\n-                    }).collect(Collectors.toList()));\n+        objectMapper.registerModule(new Jdk8Module());\n+        UserGroups groupsFromJson = objectMapper.readValue(responseInJson, UserGroups.class);\n \n+        if (groupsFromJson.getValue() != null) {\n+            lUserGroups.addAll(groupsFromJson.getValue().stream().filter(this::isMatchingUserGroupKey)\n+                .collect(Collectors.toList()));\n+        }\n+        while (groupsFromJson.getOdataNextLink().isPresent()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MjM1MjEz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-475235213", "createdAt": "2020-08-26T07:48:34Z", "commit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNzo0ODozNVrOHG__4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNzo0ODozNVrOHG__4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzEwMjA0OQ==", "bodyText": "Please update java doc in line 147.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r477102049", "createdAt": "2020-08-26T07:48:35Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AzureADGraphClient.java", "diffHunk": "@@ -149,9 +148,8 @@ private static String getResponseStringFromConn(HttpURLConnection conn) throws I\n      *             {@link AADAuthenticationProperties.UserGroupProperties}\n      * @return true if the json node contains the correct key, and expected value to identify a user group.\n      */\n-    private boolean isMatchingUserGroupKey(final JsonNode node) {\n-        return node.get(aadAuthenticationProperties.getUserGroup().getKey()).asText()\n-            .equals(aadAuthenticationProperties.getUserGroup().getValue());\n+    private boolean isMatchingUserGroupKey(final UserGroup group) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MjQwMzA3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-475240307", "createdAt": "2020-08-26T07:55:18Z", "commit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNzo1NToxOFrOHHAPpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwNzo1NToxOFrOHHAPpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzEwNjA4Nw==", "bodyText": "When will id and objectType been used? In the json I get, it only have objectId and odata.type.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r477106087", "createdAt": "2020-08-26T07:55:18Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/UserGroup.java", "diffHunk": "@@ -6,21 +6,42 @@\n import java.io.Serializable;\n import java.util.Objects;\n \n+import com.fasterxml.jackson.annotation.JsonAlias;\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+@JsonIgnoreProperties(ignoreUnknown = true)\n public class UserGroup implements Serializable {\n     private static final long serialVersionUID = 9064197572478554735L;\n \n+    @JsonProperty(\"objectId\")\n+    @JsonAlias(\"id\")\n     private String objectID;\n+\n+    @JsonProperty(\"objectType\")\n+    @JsonAlias(\"@odata.type\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MzAxNDcw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-475301470", "createdAt": "2020-08-26T09:12:57Z", "commit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwOToxMjo1OFrOHHDKfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwOToxMjo1OFrOHHDKfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzE1MzkxOA==", "bodyText": "We can set default value to Optional.empty() to avoid NullPointerException.\nRefs: https://stackoverflow.com/questions/18805455/setting-default-values-to-null-fields-when-mapping-with-jackson\nBut having an Optional in a class field or in a data structure, is considered a misuse of the API,\nRefs: https://stackoverflow.com/questions/23454952/uses-for-optional\nSo I suggest to use\nprivate String odataNextLink;\n\ninstead of\nprivate Optional<String> odataNextLink;", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#discussion_r477153918", "createdAt": "2020-08-26T09:12:58Z", "author": {"login": "chenrujun"}, "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/UserGroups.java", "diffHunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.microsoft.azure.spring.autoconfigure.aad;\n+\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.Optional;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class UserGroups {\n+\n+    @JsonProperty(\"odata.nextLink\")\n+    private Optional<String> odataNextLink;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42467b4341c1fb56f051453a19e5879247f4406c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "744247507590c431c83ec2d2fd2bd2375300a411", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/744247507590c431c83ec2d2fd2bd2375300a411", "committedDate": "2020-08-27T12:13:55Z", "message": "Use next link from group membership request\n\nloadUser only gets the first 100 groups a user belongs to rather than\nusing the odata.nextLink in the response to get the full list of groups.\nFix this by checking if the response contains an odata.nextLink and then\nbuild the URL appropriately for the configured API version.\n\nFor V1, odata.nextLink contains a skip token which we extract. More\ninformation here: https://docs.microsoft.com/en-us/previous-versions/azure/ad/graph/api/users-operations#get-a-users-manager--\n\nFor V2, odata.nextLink can be used directly as the URL for the request\nas specified here: https://docs.microsoft.com/en-us/graph/paging\n\nfix #14222"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b864a8eb603ab5630f0af894acaf17ec44f789bc", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b864a8eb603ab5630f0af894acaf17ec44f789bc", "committedDate": "2020-08-27T12:13:56Z", "message": "Remove jackson datatype dep\n\nChange the type of the odata.nextLink from Optional<String> to String"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3c832f87cf65219dd7b500ab25a998c38dab8a3", "author": {"user": {"login": "ppartarr", "name": "Philippe Partarrieu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e3c832f87cf65219dd7b500ab25a998c38dab8a3", "committedDate": "2020-08-27T12:13:56Z", "message": "Remove unused Jdk8Module import"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "80c4050c2e5c2117d685160739ff49cb1658506b", "author": {"user": {"login": "ppartarr", "name": "Philippe Partarrieu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/80c4050c2e5c2117d685160739ff49cb1658506b", "committedDate": "2020-08-26T16:24:16Z", "message": "Remove unused Jdk8Module import"}, "afterCommit": {"oid": "e3c832f87cf65219dd7b500ab25a998c38dab8a3", "author": {"user": {"login": "ppartarr", "name": "Philippe Partarrieu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e3c832f87cf65219dd7b500ab25a998c38dab8a3", "committedDate": "2020-08-27T12:13:56Z", "message": "Remove unused Jdk8Module import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MzIxNjI0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14305#pullrequestreview-478321624", "createdAt": "2020-08-31T05:39:05Z", "commit": {"oid": "e3c832f87cf65219dd7b500ab25a998c38dab8a3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 311, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}