{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzNDczNTMz", "number": 11435, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDoyMToxOVrOECx0rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDoyNzoxMlrOECx4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMzQ4OTA5OnYy", "diffSide": "RIGHT", "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDoyMToxOVrOGfcg8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDoyMToxOVrOGfcg8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyNjIyNw==", "bodyText": "This tells the broker that the receiving client wants to settle received messages explicitly. ->This tells the broker that the receiving client wants to manage settlement of received messages explicitly.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11435#discussion_r435626227", "createdAt": "2020-06-05T00:21:19Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -172,41 +176,53 @@ You'll need to create an asynchronous [`ServiceBusReceiverAsyncClient`][ServiceB\n [`ServiceBusReceiverClient`][ServiceBusReceiverClient] to receive messages. Each receiver can consume messages from\n either a queue or a topic subscription.\n \n+By default, the receive mode is [`ReceiveMode.PEEK_LOCK`][ReceiveMode]. This tells the broker that the receiving client\n+wants to settle received messages explicitly. The message is made available for the receiver to process, while held", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "324c957308217348a273de3ae936d3ebf381d223"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMzQ5ODExOnYy", "diffSide": "RIGHT", "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDoyNzoxMlrOGfcmeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDoyNzoxMlrOGfcmeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyNzY0MQ==", "bodyText": "continuously  ->  infinitely\nThis will register in user mind that they have to handle this properly.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11435#discussion_r435627641", "createdAt": "2020-06-05T00:27:12Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -172,41 +176,53 @@ You'll need to create an asynchronous [`ServiceBusReceiverAsyncClient`][ServiceB\n [`ServiceBusReceiverClient`][ServiceBusReceiverClient] to receive messages. Each receiver can consume messages from\n either a queue or a topic subscription.\n \n+By default, the receive mode is [`ReceiveMode.PEEK_LOCK`][ReceiveMode]. This tells the broker that the receiving client\n+wants to settle received messages explicitly. The message is made available for the receiver to process, while held\n+under an exclusive lock in the service so that other, competing receivers cannot see it.\n+`ServiceBusReceivedMessage.getLockedUntil()` indicates when the lock expires and can be extended by the client using\n+`receiver.renewMessageLock()`.\n+\n #### Receive a batch of messages\n \n-The snippet below creates a `ServiceBusReceiverClient` to receive messages from a topic subscription. It returns a batch\n-of messages when 10 messages are received or until 30 seconds have elapsed, whichever happens first.\n+The snippet below creates a [`ServiceBusReceiverClient`][ServiceBusReceiverClient] to receive messages from a topic\n+subscription.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L81-L94 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L84-L101 -->\n ```java\n ServiceBusReceiverClient receiver = new ServiceBusClientBuilder()\n     .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n     .receiver()\n     .topicName(\"<< TOPIC NAME >>\")\n     .subscriptionName(\"<< SUBSCRIPTION NAME >>\")\n-    .receiveMode(ReceiveMode.PEEK_LOCK)\n     .buildClient();\n \n+// Receives a batch of messages when 10 messages are received or until 30 seconds have elapsed, whichever\n+// happens first.\n IterableStream<ServiceBusReceivedMessageContext> messages = receiver.receive(10, Duration.ofSeconds(30));\n messages.forEach(context -> {\n     ServiceBusReceivedMessage message = context.getMessage();\n     System.out.printf(\"Id: %s. Contents: %s%n\", message.getMessageId(),\n         new String(message.getBody(), StandardCharsets.UTF_8));\n });\n+\n+// When you are done using the receiver, dispose of it.\n+receiver.close();\n ```\n \n #### Receive a stream of messages\n \n-The asynchronous `ServiceBusReceiverAsyncClient` continuously fetches messages until the `subscription` is disposed.\n+The asynchronous [`ServiceBusReceiverAsyncClient`][ServiceBusReceiverAsyncClient] continuously fetches messages until\n+the `subscription` is disposed.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L101-L115 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L108-L129 -->\n ```java\n ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n     .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n     .receiver()\n     .queueName(\"<< QUEUE NAME >>\")\n     .buildAsyncClient();\n \n+// receive() operation continuously fetches messages until the subscription is disposed.\n Disposable subscription = receiver.receive().subscribe(context -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "324c957308217348a273de3ae936d3ebf381d223"}, "originalPosition": 86}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4142, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}