{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NjY5NzMz", "number": 12198, "title": "API Changes for ORS", "bodyText": "", "createdAt": "2020-06-15T17:16:31Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198", "merged": true, "mergeCommit": {"oid": "76470e2a6987ad263be3edc655b405d65dc40666"}, "closed": true, "closedAt": "2020-06-15T20:07:41Z", "author": {"login": "gapra-msft"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrj5xGAH2gAyNDM0NjY5NzMzOjFjODJjMzU3NzU3ZTllZGMyMjA3MTBlMmE4OTEyZGY5MGI4YjkwYmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrl8ZcgH2gAyNDM0NjY5NzMzOjk1YWU5YmIyODQyMTYzN2JhZjI0ZmQ3MjU2YzY3ZTFkYTI4NzRkMDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1c82c357757e9edc220710e2a8912df90b8b90be", "committedDate": "2020-06-15T17:14:36Z", "message": "ObjectReplication API changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwODQxNTQ0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#pullrequestreview-430841544", "createdAt": "2020-06-15T17:17:00Z", "commit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzoxNzowMFrOGj7byQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzoxNzowMFrOGj7byQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyNzExMw==", "bodyText": "Should I be more explicit with source in the name?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#discussion_r440327113", "createdAt": "2020-06-15T17:17:00Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobDownloadHeaders.java", "diffHunk": "@@ -24,7 +27,7 @@\n      * Instantiates an empty {@code BlobDownloadHeaders}.\n      */\n     public BlobDownloadHeaders() {\n-        objectReplicationSourcePolicies = null;\n+        objectReplicationPolicies = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwODQyNDQ4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#pullrequestreview-430842448", "createdAt": "2020-06-15T17:18:19Z", "commit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzoxODoxOVrOGj7emA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzoxODoxOVrOGj7emA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMyNzgzMg==", "bodyText": "TODO : delete", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#discussion_r440327832", "createdAt": "2020-06-15T17:18:19Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -50,7 +52,8 @@\n     private final Long tagCount;\n     private final String versionId;\n     private final Boolean isCurrentVersion;\n-    private final Map<String, ObjectReplicationPolicy> objectReplicationSourcePolicies;\n+    private final List<ObjectReplicationPolicy> objectReplicationPolicies;\n+//    private final Map<String, ObjectReplicationPolicy> objectReplicationSourcePolicies;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b040d4c433d380d083b3cb556d92236e2679c234", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b040d4c433d380d083b3cb556d92236e2679c234", "committedDate": "2020-06-15T17:30:08Z", "message": "Added back imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwODQ5ODAy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#pullrequestreview-430849802", "createdAt": "2020-06-15T17:28:19Z", "commit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzoyODoxOVrOGj70hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzozMTo1NlrOGj78RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzMzQ0Ng==", "bodyText": "We should accept list of rules as constructor parameter as well, so that this is fully functional after construction (avoid multi-step init).\nIf we're aiming to make this class immutable we should clone the list (https://stackoverflow.com/questions/6137224/immutable-object-with-arraylist-member-variable-why-can-this-variable-be-chang )", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#discussion_r440333446", "createdAt": "2020-06-15T17:28:19Z", "author": {"login": "kasobol-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/ObjectReplicationPolicy.java", "diffHunk": "@@ -3,24 +3,24 @@\n \n package com.azure.storage.blob.models;\n \n-import java.util.HashMap;\n-import java.util.Map;\n+import java.util.ArrayList;\n+import java.util.List;\n \n /**\n  * A type that contains information about an object replication policy on a source blob.\n  */\n public class ObjectReplicationPolicy {\n \n     private final String policyId;\n-    private final Map<String, String> ruleStatuses;\n+    private final List<ObjectReplicationRule> objectReplicationRules;\n \n     ObjectReplicationPolicy(String policyId) {\n         this.policyId = policyId;\n-        this.ruleStatuses = new HashMap<>();\n+        this.objectReplicationRules = new ArrayList<>();\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzNDcwNg==", "bodyText": "By looking at usage I think we could simplify this and code that's using it by usage of stream api.\nhttps://stackoverflow.com/questions/23696317/find-first-element-by-predicate", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#discussion_r440334706", "createdAt": "2020-06-15T17:30:32Z", "author": {"login": "kasobol-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/ObjectReplicationPolicy.java", "diffHunk": "@@ -31,10 +31,20 @@ public String getPolicyId() {\n     }\n \n     /**\n-     * @return A {@code Map} of rules associated with this policy to the status of the replication associated with that\n+     * @return A {@code List} of rules associated with this policy to the status of the replication associated with that\n      * rule.\n      */\n-    public Map<String, String> getRules() {\n-        return this.ruleStatuses;\n+    public List<ObjectReplicationRule> getRules() {\n+        return this.objectReplicationRules;\n+    }\n+\n+    static int getIndexOfObjectReplicationPolicy(String policyId,\n+        List<ObjectReplicationPolicy> objectReplicationPolicies) {\n+        for (int i = 0; i < objectReplicationPolicies.size(); i++) {\n+            if (policyId.equals(objectReplicationPolicies.get(i).getPolicyId())) {\n+                return i;\n+            }\n+        }\n+        return -1;\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzNTI0MQ==", "bodyText": "same here.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#discussion_r440335241", "createdAt": "2020-06-15T17:31:36Z", "author": {"login": "kasobol-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/ObjectReplicationRule.java", "diffHunk": "@@ -0,0 +1,45 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.storage.blob.models;\n+\n+import java.util.List;\n+\n+/**\n+ * A type that contains information about an object replication rule on a source blob.\n+ */\n+public class ObjectReplicationRule {\n+\n+    private final String ruleId;\n+    private final ObjectReplicationStatus status;\n+\n+\n+    ObjectReplicationRule(String ruleId, ObjectReplicationStatus status) {\n+        this.ruleId = ruleId;\n+        this.status = status;\n+    }\n+\n+    /**\n+     * @return The rule id.\n+     */\n+    public String getRuleId() {\n+        return ruleId;\n+    }\n+\n+    /**\n+     * @return The {@link ObjectReplicationStatus}\n+     */\n+    public ObjectReplicationStatus getStatus() {\n+        return status;\n+    }\n+\n+    static int getIndexOfObjectReplicationRule(String ruleId,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzNTQyOQ==", "bodyText": "star import.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#discussion_r440335429", "createdAt": "2020-06-15T17:31:56Z", "author": {"login": "kasobol-msft"}, "path": "sdk/storage/azure-storage-blob/src/test/java/com/azure/storage/blob/BlobAPITest.groovy", "diffHunk": "@@ -7,28 +7,7 @@ import com.azure.core.http.RequestConditions\n import com.azure.core.util.CoreUtils\n import com.azure.core.util.polling.LongRunningOperationStatus\n import com.azure.identity.DefaultAzureCredentialBuilder\n-import com.azure.identity.EnvironmentCredentialBuilder\n-import com.azure.storage.blob.models.AccessTier\n-import com.azure.storage.blob.models.ArchiveStatus\n-import com.azure.storage.blob.models.BlobBeginCopyOptions\n-import com.azure.storage.blob.models.BlobCopyFromUrlOptions\n-import com.azure.storage.blob.models.BlobErrorCode\n-import com.azure.storage.blob.models.BlobHttpHeaders\n-import com.azure.storage.blob.models.BlobRange\n-import com.azure.storage.blob.models.BlobRequestConditions\n-import com.azure.storage.blob.models.BlobStorageException\n-import com.azure.storage.blob.models.BlobType\n-import com.azure.storage.blob.models.BlockListType\n-import com.azure.storage.blob.models.CopyStatusType\n-import com.azure.storage.blob.models.CustomerProvidedKey\n-import com.azure.storage.blob.models.DeleteSnapshotsOptionType\n-import com.azure.storage.blob.models.DownloadRetryOptions\n-import com.azure.storage.blob.models.LeaseStateType\n-import com.azure.storage.blob.models.LeaseStatusType\n-import com.azure.storage.blob.models.ParallelTransferOptions\n-import com.azure.storage.blob.models.PublicAccessType\n-import com.azure.storage.blob.models.RehydratePriority\n-import com.azure.storage.blob.models.SyncCopyStatusType\n+import com.azure.storage.blob.models.*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c82c357757e9edc220710e2a8912df90b8b90be"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e5a0c0ac0bcdfc7d858e304bfb983faea9ce7f2", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5e5a0c0ac0bcdfc7d858e304bfb983faea9ce7f2", "committedDate": "2020-06-15T17:33:23Z", "message": "rename to source"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4541da5b8939978feb8d8f6c7e4f03618c749fed", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/4541da5b8939978feb8d8f6c7e4f03618c749fed", "committedDate": "2020-06-15T17:55:59Z", "message": "Added more gt status"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28d31ae8c597430b6fb5de6448b4259a2457469a", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/28d31ae8c597430b6fb5de6448b4259a2457469a", "committedDate": "2020-06-15T17:56:17Z", "message": "Added docs to constructors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e992693067c4fb5983bda827412fa5087844bf45", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e992693067c4fb5983bda827412fa5087844bf45", "committedDate": "2020-06-15T17:57:35Z", "message": "Analyze"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9139c81af417bc1224376285ce0a4a54b2e0be5", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b9139c81af417bc1224376285ce0a4a54b2e0be5", "committedDate": "2020-06-15T17:58:50Z", "message": "Added back imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "800265a3707af650ef1bf0d051432b3e6c3e1e64", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/800265a3707af650ef1bf0d051432b3e6c3e1e64", "committedDate": "2020-06-15T18:27:41Z", "message": "Added collection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3be1baa0afc4584ad36e033ea1b9ff07e75feb08", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/3be1baa0afc4584ad36e033ea1b9ff07e75feb08", "committedDate": "2020-06-15T19:04:10Z", "message": "Made immutable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwOTE1NzE5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#pullrequestreview-430915719", "createdAt": "2020-06-15T19:04:37Z", "commit": {"oid": "800265a3707af650ef1bf0d051432b3e6c3e1e64"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwOTE3MzUz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12198#pullrequestreview-430917353", "createdAt": "2020-06-15T19:06:48Z", "commit": {"oid": "3be1baa0afc4584ad36e033ea1b9ff07e75feb08"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ce9d5c21eebe73a928a781f81d49f86d889a02e", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6ce9d5c21eebe73a928a781f81d49f86d889a02e", "committedDate": "2020-06-15T19:07:52Z", "message": "fixed imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95ae9bb28421637baf24fd7256c67e1da2874d09", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/95ae9bb28421637baf24fd7256c67e1da2874d09", "committedDate": "2020-06-15T19:37:17Z", "message": "analyze fix"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3026, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}