{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4MTI3MTEy", "number": 10464, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODozNDo1NVrOD3VCCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMDo1NDozMlrOD3YGUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzQyODU5OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobDownloadHeaders.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODozNDo1NVrOGNhp8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODozNDo1NVrOGNhp8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzNjA4MA==", "bodyText": "nit : add a new line to the end in swagger README", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416836080", "createdAt": "2020-04-28T18:34:55Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobDownloadHeaders.java", "diffHunk": "@@ -342,6 +364,70 @@ public BlobDownloadHeaders setMetadata(Map<String, String> metadata) {\n         return this;\n     }\n \n+    /**\n+     * Get the objectReplicationDestinationPolicyId property: Optional. Only\n+     * valid when Object Replication is enabled for the storage container and\n+     * on the destination blob of the replication.\n+     *\n+     * @return the objectReplicationDestinationPolicyId value.\n+     */\n+    public String getObjectReplicationDestinationPolicyId() {\n+        return this.objectReplicationRuleStatus.getOrDefault(\"policy-id\", null);\n+    }\n+\n+    /**\n+     * Set the objectReplicationDestinationPolicyId property: Optional. Only\n+     * valid when Object Replication is enabled for the storage container and\n+     * on the destination blob of the replication.\n+     *\n+     * @param objectReplicationDestinationPolicyId the\n+     * objectReplicationDestinationPolicyId value to set.\n+     * @return the BlobDownloadHeaders object itself.\n+     */\n+    public BlobDownloadHeaders setObjectReplicationDestinationPolicyId(String objectReplicationDestinationPolicyId) {\n+        this.objectReplicationDestinationPolicyId = objectReplicationDestinationPolicyId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get the objectReplicationRuleStatus property: The\n+     * objectReplicationRuleStatus property.\n+     *\n+     * @return the objectReplicationRuleStatus value.\n+     */\n+    public Map<String, ObjectReplicationPolicy> getObjectReplicationSourcePolicies() {\n+        Map<String, ObjectReplicationPolicy> objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = this.objectReplicationRuleStatus.getOrDefault(\"policy-id\", null);\n+        if (objectReplicationDestinationPolicyId == null) {\n+            for (String str : this.objectReplicationRuleStatus.keySet()) {\n+                String[] split = str.split(\"_\");\n+                String policyId = split[0];\n+                String ruleId = split[1];\n+                if (objectReplicationSourcePolicies.containsKey(policyId)) {\n+                    objectReplicationSourcePolicies.get(policyId)\n+                        .putRuleAndStatus(ruleId, this.objectReplicationRuleStatus.get(str));\n+                } else {\n+                    ObjectReplicationPolicy policy = new ObjectReplicationPolicy(policyId);\n+                    policy.putRuleAndStatus(ruleId, objectReplicationRuleStatus.get(str));\n+                    objectReplicationSourcePolicies.put(policyId, policy);\n+                }\n+            }\n+        }\n+        return objectReplicationSourcePolicies;    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzQ0MTUzOnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobItem.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODozODoxOFrOGNhxyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxOTowODo0NFrOGNi30A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzODA4OA==", "bodyText": "Is this ok to do since BlobItemInternal is \"private\" and BlobItem is public. Would it be better to like extract the pieces in a private method wherever you use this constructor and make this constructor like take in all the properties?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416838088", "createdAt": "2020-04-28T18:38:18Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobItem.java", "diffHunk": "@@ -15,6 +17,30 @@\n @JacksonXmlRootElement(localName = \"Blob\")\n @Fluent\n public final class BlobItem {\n+\n+    /**\n+     * Initializes a new BlobItem.\n+     */\n+    public BlobItem() {\n+\n+    }\n+\n+    /**\n+     * Initializes a new blob item.\n+     *\n+     * @param blobItemInternal The internal structure from which to pull state.\n+     */\n+    public BlobItem(BlobItemInternal blobItemInternal) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzODc5MQ==", "bodyText": "Though this is technically cleaner", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416838791", "createdAt": "2020-04-28T18:39:34Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobItem.java", "diffHunk": "@@ -15,6 +17,30 @@\n @JacksonXmlRootElement(localName = \"Blob\")\n @Fluent\n public final class BlobItem {\n+\n+    /**\n+     * Initializes a new BlobItem.\n+     */\n+    public BlobItem() {\n+\n+    }\n+\n+    /**\n+     * Initializes a new blob item.\n+     *\n+     * @param blobItemInternal The internal structure from which to pull state.\n+     */\n+    public BlobItem(BlobItemInternal blobItemInternal) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzODA4OA=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1NjAxNg==", "bodyText": "Hmm. Interesting. I guess that is what we do with BlobProperties. Though I don't remember the reason why. There must've been a reason other than we needed to construct it from different sources (download, getProperties, etc.) or we would've just had multiple constructors. I can change it if we had a good reason for that.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416856016", "createdAt": "2020-04-28T19:08:44Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobItem.java", "diffHunk": "@@ -15,6 +17,30 @@\n @JacksonXmlRootElement(localName = \"Blob\")\n @Fluent\n public final class BlobItem {\n+\n+    /**\n+     * Initializes a new BlobItem.\n+     */\n+    public BlobItem() {\n+\n+    }\n+\n+    /**\n+     * Initializes a new blob item.\n+     *\n+     * @param blobItemInternal The internal structure from which to pull state.\n+     */\n+    public BlobItem(BlobItemInternal blobItemInternal) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgzODA4OA=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzQ1MzU1OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo0MToyOVrOGNh5Xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxODo1ODozOFrOGQN2cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDAzMA==", "bodyText": "Is there a clean way we could unduplicate this code? I'm not sure where it could live though.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416840030", "createdAt": "2020-04-28T18:41:29Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1NjY2Ng==", "bodyText": "I don't think so. One lives in the readme and the other lives in BlobProperties. And they aren't totally identical because the one here saves this as the actual property rather than constructing it in the getter, and that would be way more complicated to do in swagger.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416856666", "createdAt": "2020-04-28T19:09:53Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDAzMA=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY1NzMyOA==", "bodyText": "Even with the update of moving this out of the readme, I don't know that there's a great place for us to put this code to get rid of the duplication. There's not really a common code path between them, and we're trying to move away from using utility methods.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r419657328", "createdAt": "2020-05-04T18:58:38Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDAzMA=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzQ1OTM4OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo0Mjo1N1rOGNh9BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxODo1NzowMFrOGQNy1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDk2NQ==", "bodyText": "Why are there 2 similar seeming constructors added? Is it to make the OR logic separate from the max constructor?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416840965", "createdAt": "2020-04-28T18:42:57Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);\n+        if (objectReplicationDestinationPolicyId == null) {\n+            for (String str : objectReplicationStatus.keySet()) {\n+                String[] split = str.split(\"_\");\n+                String policyId = split[0];\n+                String ruleId = split[1];\n+                if (objectReplicationSourcePolicies.containsKey(policyId)) {\n+                    objectReplicationSourcePolicies.get(policyId)\n+                        .putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                } else {\n+                    ObjectReplicationPolicy policy = new ObjectReplicationPolicy(policyId);\n+                    policy.putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                    objectReplicationSourcePolicies.put(policyId, policy);\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Constructs a {@link BlobProperties}.\n+     *\n+     * @param creationTime Creation time of the blob.\n+     * @param lastModified Datetime when the blob was last modified.\n+     * @param eTag ETag of the blob.\n+     * @param blobSize Size of the blob.\n+     * @param contentType Content type specified for the blob.\n+     * @param contentMd5 Content MD5 specified for the blob.\n+     * @param contentEncoding Content encoding specified for the blob.\n+     * @param contentDisposition Content disposition specified for the blob.\n+     * @param contentLanguage Content language specified for the blob.\n+     * @param cacheControl Cache control specified for the blob.\n+     * @param blobSequenceNumber The current sequence number for a page blob, if the blob is an append or block blob\n+     * pass {@code null}.\n+     * @param blobType Type of the blob.\n+     * @param leaseStatus Status of the lease on the blob.\n+     * @param leaseState State of the lease on the blob.\n+     * @param leaseDuration Type of lease on the blob.\n+     * @param copyId Identifier of the last copy operation performed on the blob.\n+     * @param copyStatus Status of the last copy operation performed on the blob.\n+     * @param copySource Source of the last copy operation performed on the blob.\n+     * @param copyProgress Progress of the last copy operation performed on the blob.\n+     * @param copyCompletionTime Datetime when the last copy operation on the blob completed.\n+     * @param copyStatusDescription Description of the last copy operation on the blob.\n+     * @param isServerEncrypted Flag indicating if the blob's content is encrypted on the server.\n+     * @param isIncrementalCopy Flag indicating if the blob was incrementally copied.\n+     * @param copyDestinationSnapshot Snapshot identifier of the last incremental copy snapshot for the blob.\n+     * @param accessTier Access tier of the blob.\n+     * @param isAccessTierInferred Flag indicating if the access tier of the blob was inferred from properties of the\n+     * blob.\n+     * @param archiveStatus Archive status of the blob.\n+     * @param encryptionKeySha256 SHA256 of the customer provided encryption key used to encrypt the blob on the server.\n+     * @param accessTierChangeTime Datetime when the access tier of the blob last changed.\n+     * @param metadata Metadata associated with the blob.\n+     * @param committedBlockCount Number of blocks committed to an append blob, if the blob is a block or page blob\n+     * pass {@code null}.\n+     * @param versionId The version identifier of the blob.\n+     * @param isCurrentVersion Flag indicating if version identifier points to current version of the blob.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1Nzk2Ng==", "bodyText": "It's because sometimes we construct this type from downloadHeaders, which has already deserialized the ORS stuff (second constructor) and sometimes we construct this type from getPropertiesHeaders, which hasn't already done this.\nOur story for returning these properties is a mess.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416857966", "createdAt": "2020-04-28T19:12:11Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);\n+        if (objectReplicationDestinationPolicyId == null) {\n+            for (String str : objectReplicationStatus.keySet()) {\n+                String[] split = str.split(\"_\");\n+                String policyId = split[0];\n+                String ruleId = split[1];\n+                if (objectReplicationSourcePolicies.containsKey(policyId)) {\n+                    objectReplicationSourcePolicies.get(policyId)\n+                        .putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                } else {\n+                    ObjectReplicationPolicy policy = new ObjectReplicationPolicy(policyId);\n+                    policy.putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                    objectReplicationSourcePolicies.put(policyId, policy);\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Constructs a {@link BlobProperties}.\n+     *\n+     * @param creationTime Creation time of the blob.\n+     * @param lastModified Datetime when the blob was last modified.\n+     * @param eTag ETag of the blob.\n+     * @param blobSize Size of the blob.\n+     * @param contentType Content type specified for the blob.\n+     * @param contentMd5 Content MD5 specified for the blob.\n+     * @param contentEncoding Content encoding specified for the blob.\n+     * @param contentDisposition Content disposition specified for the blob.\n+     * @param contentLanguage Content language specified for the blob.\n+     * @param cacheControl Cache control specified for the blob.\n+     * @param blobSequenceNumber The current sequence number for a page blob, if the blob is an append or block blob\n+     * pass {@code null}.\n+     * @param blobType Type of the blob.\n+     * @param leaseStatus Status of the lease on the blob.\n+     * @param leaseState State of the lease on the blob.\n+     * @param leaseDuration Type of lease on the blob.\n+     * @param copyId Identifier of the last copy operation performed on the blob.\n+     * @param copyStatus Status of the last copy operation performed on the blob.\n+     * @param copySource Source of the last copy operation performed on the blob.\n+     * @param copyProgress Progress of the last copy operation performed on the blob.\n+     * @param copyCompletionTime Datetime when the last copy operation on the blob completed.\n+     * @param copyStatusDescription Description of the last copy operation on the blob.\n+     * @param isServerEncrypted Flag indicating if the blob's content is encrypted on the server.\n+     * @param isIncrementalCopy Flag indicating if the blob was incrementally copied.\n+     * @param copyDestinationSnapshot Snapshot identifier of the last incremental copy snapshot for the blob.\n+     * @param accessTier Access tier of the blob.\n+     * @param isAccessTierInferred Flag indicating if the access tier of the blob was inferred from properties of the\n+     * blob.\n+     * @param archiveStatus Archive status of the blob.\n+     * @param encryptionKeySha256 SHA256 of the customer provided encryption key used to encrypt the blob on the server.\n+     * @param accessTierChangeTime Datetime when the access tier of the blob last changed.\n+     * @param metadata Metadata associated with the blob.\n+     * @param committedBlockCount Number of blocks committed to an append blob, if the blob is a block or page blob\n+     * pass {@code null}.\n+     * @param versionId The version identifier of the blob.\n+     * @param isCurrentVersion Flag indicating if version identifier points to current version of the blob.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDk2NQ=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkyNzUwMw==", "bodyText": "Is there a way we could get the above constructor to call into this one (it could still do that deserialization) in the above constructor", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416927503", "createdAt": "2020-04-28T21:15:24Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);\n+        if (objectReplicationDestinationPolicyId == null) {\n+            for (String str : objectReplicationStatus.keySet()) {\n+                String[] split = str.split(\"_\");\n+                String policyId = split[0];\n+                String ruleId = split[1];\n+                if (objectReplicationSourcePolicies.containsKey(policyId)) {\n+                    objectReplicationSourcePolicies.get(policyId)\n+                        .putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                } else {\n+                    ObjectReplicationPolicy policy = new ObjectReplicationPolicy(policyId);\n+                    policy.putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                    objectReplicationSourcePolicies.put(policyId, policy);\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Constructs a {@link BlobProperties}.\n+     *\n+     * @param creationTime Creation time of the blob.\n+     * @param lastModified Datetime when the blob was last modified.\n+     * @param eTag ETag of the blob.\n+     * @param blobSize Size of the blob.\n+     * @param contentType Content type specified for the blob.\n+     * @param contentMd5 Content MD5 specified for the blob.\n+     * @param contentEncoding Content encoding specified for the blob.\n+     * @param contentDisposition Content disposition specified for the blob.\n+     * @param contentLanguage Content language specified for the blob.\n+     * @param cacheControl Cache control specified for the blob.\n+     * @param blobSequenceNumber The current sequence number for a page blob, if the blob is an append or block blob\n+     * pass {@code null}.\n+     * @param blobType Type of the blob.\n+     * @param leaseStatus Status of the lease on the blob.\n+     * @param leaseState State of the lease on the blob.\n+     * @param leaseDuration Type of lease on the blob.\n+     * @param copyId Identifier of the last copy operation performed on the blob.\n+     * @param copyStatus Status of the last copy operation performed on the blob.\n+     * @param copySource Source of the last copy operation performed on the blob.\n+     * @param copyProgress Progress of the last copy operation performed on the blob.\n+     * @param copyCompletionTime Datetime when the last copy operation on the blob completed.\n+     * @param copyStatusDescription Description of the last copy operation on the blob.\n+     * @param isServerEncrypted Flag indicating if the blob's content is encrypted on the server.\n+     * @param isIncrementalCopy Flag indicating if the blob was incrementally copied.\n+     * @param copyDestinationSnapshot Snapshot identifier of the last incremental copy snapshot for the blob.\n+     * @param accessTier Access tier of the blob.\n+     * @param isAccessTierInferred Flag indicating if the access tier of the blob was inferred from properties of the\n+     * blob.\n+     * @param archiveStatus Archive status of the blob.\n+     * @param encryptionKeySha256 SHA256 of the customer provided encryption key used to encrypt the blob on the server.\n+     * @param accessTierChangeTime Datetime when the access tier of the blob last changed.\n+     * @param metadata Metadata associated with the blob.\n+     * @param committedBlockCount Number of blocks committed to an append blob, if the blob is a block or page blob\n+     * pass {@code null}.\n+     * @param versionId The version identifier of the blob.\n+     * @param isCurrentVersion Flag indicating if version identifier points to current version of the blob.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDk2NQ=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUyMDY5OA==", "bodyText": "Yea that's probably more concise. I can do the deserialization and then call into the last constructor. Good call.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r417520698", "createdAt": "2020-04-29T18:23:09Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);\n+        if (objectReplicationDestinationPolicyId == null) {\n+            for (String str : objectReplicationStatus.keySet()) {\n+                String[] split = str.split(\"_\");\n+                String policyId = split[0];\n+                String ruleId = split[1];\n+                if (objectReplicationSourcePolicies.containsKey(policyId)) {\n+                    objectReplicationSourcePolicies.get(policyId)\n+                        .putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                } else {\n+                    ObjectReplicationPolicy policy = new ObjectReplicationPolicy(policyId);\n+                    policy.putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                    objectReplicationSourcePolicies.put(policyId, policy);\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Constructs a {@link BlobProperties}.\n+     *\n+     * @param creationTime Creation time of the blob.\n+     * @param lastModified Datetime when the blob was last modified.\n+     * @param eTag ETag of the blob.\n+     * @param blobSize Size of the blob.\n+     * @param contentType Content type specified for the blob.\n+     * @param contentMd5 Content MD5 specified for the blob.\n+     * @param contentEncoding Content encoding specified for the blob.\n+     * @param contentDisposition Content disposition specified for the blob.\n+     * @param contentLanguage Content language specified for the blob.\n+     * @param cacheControl Cache control specified for the blob.\n+     * @param blobSequenceNumber The current sequence number for a page blob, if the blob is an append or block blob\n+     * pass {@code null}.\n+     * @param blobType Type of the blob.\n+     * @param leaseStatus Status of the lease on the blob.\n+     * @param leaseState State of the lease on the blob.\n+     * @param leaseDuration Type of lease on the blob.\n+     * @param copyId Identifier of the last copy operation performed on the blob.\n+     * @param copyStatus Status of the last copy operation performed on the blob.\n+     * @param copySource Source of the last copy operation performed on the blob.\n+     * @param copyProgress Progress of the last copy operation performed on the blob.\n+     * @param copyCompletionTime Datetime when the last copy operation on the blob completed.\n+     * @param copyStatusDescription Description of the last copy operation on the blob.\n+     * @param isServerEncrypted Flag indicating if the blob's content is encrypted on the server.\n+     * @param isIncrementalCopy Flag indicating if the blob was incrementally copied.\n+     * @param copyDestinationSnapshot Snapshot identifier of the last incremental copy snapshot for the blob.\n+     * @param accessTier Access tier of the blob.\n+     * @param isAccessTierInferred Flag indicating if the access tier of the blob was inferred from properties of the\n+     * blob.\n+     * @param archiveStatus Archive status of the blob.\n+     * @param encryptionKeySha256 SHA256 of the customer provided encryption key used to encrypt the blob on the server.\n+     * @param accessTierChangeTime Datetime when the access tier of the blob last changed.\n+     * @param metadata Metadata associated with the blob.\n+     * @param committedBlockCount Number of blocks committed to an append blob, if the blob is a block or page blob\n+     * pass {@code null}.\n+     * @param versionId The version identifier of the blob.\n+     * @param isCurrentVersion Flag indicating if version identifier points to current version of the blob.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDk2NQ=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY1NjQwNg==", "bodyText": "Turns out this isn't possible. The compiler needs the call into another constructor to be the first line :(", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r419656406", "createdAt": "2020-05-04T18:57:00Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobProperties.java", "diffHunk": "@@ -191,6 +194,116 @@ public BlobProperties(final OffsetDateTime creationTime, final OffsetDateTime la\n         this.committedBlockCount = committedBlockCount;\n         this.versionId = versionId;\n         this.isCurrentVersion = isCurrentVersion;\n+\n+        this.objectReplicationSourcePolicies = new HashMap<>();\n+        this.objectReplicationDestinationPolicyId = objectReplicationStatus.getOrDefault(\"policy-id\", null);\n+        if (objectReplicationDestinationPolicyId == null) {\n+            for (String str : objectReplicationStatus.keySet()) {\n+                String[] split = str.split(\"_\");\n+                String policyId = split[0];\n+                String ruleId = split[1];\n+                if (objectReplicationSourcePolicies.containsKey(policyId)) {\n+                    objectReplicationSourcePolicies.get(policyId)\n+                        .putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                } else {\n+                    ObjectReplicationPolicy policy = new ObjectReplicationPolicy(policyId);\n+                    policy.putRuleAndStatus(ruleId, objectReplicationStatus.get(str));\n+                    objectReplicationSourcePolicies.put(policyId, policy);\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Constructs a {@link BlobProperties}.\n+     *\n+     * @param creationTime Creation time of the blob.\n+     * @param lastModified Datetime when the blob was last modified.\n+     * @param eTag ETag of the blob.\n+     * @param blobSize Size of the blob.\n+     * @param contentType Content type specified for the blob.\n+     * @param contentMd5 Content MD5 specified for the blob.\n+     * @param contentEncoding Content encoding specified for the blob.\n+     * @param contentDisposition Content disposition specified for the blob.\n+     * @param contentLanguage Content language specified for the blob.\n+     * @param cacheControl Cache control specified for the blob.\n+     * @param blobSequenceNumber The current sequence number for a page blob, if the blob is an append or block blob\n+     * pass {@code null}.\n+     * @param blobType Type of the blob.\n+     * @param leaseStatus Status of the lease on the blob.\n+     * @param leaseState State of the lease on the blob.\n+     * @param leaseDuration Type of lease on the blob.\n+     * @param copyId Identifier of the last copy operation performed on the blob.\n+     * @param copyStatus Status of the last copy operation performed on the blob.\n+     * @param copySource Source of the last copy operation performed on the blob.\n+     * @param copyProgress Progress of the last copy operation performed on the blob.\n+     * @param copyCompletionTime Datetime when the last copy operation on the blob completed.\n+     * @param copyStatusDescription Description of the last copy operation on the blob.\n+     * @param isServerEncrypted Flag indicating if the blob's content is encrypted on the server.\n+     * @param isIncrementalCopy Flag indicating if the blob was incrementally copied.\n+     * @param copyDestinationSnapshot Snapshot identifier of the last incremental copy snapshot for the blob.\n+     * @param accessTier Access tier of the blob.\n+     * @param isAccessTierInferred Flag indicating if the access tier of the blob was inferred from properties of the\n+     * blob.\n+     * @param archiveStatus Archive status of the blob.\n+     * @param encryptionKeySha256 SHA256 of the customer provided encryption key used to encrypt the blob on the server.\n+     * @param accessTierChangeTime Datetime when the access tier of the blob last changed.\n+     * @param metadata Metadata associated with the blob.\n+     * @param committedBlockCount Number of blocks committed to an append blob, if the blob is a block or page blob\n+     * pass {@code null}.\n+     * @param versionId The version identifier of the blob.\n+     * @param isCurrentVersion Flag indicating if version identifier points to current version of the blob.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MDk2NQ=="}, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzQ2NzQ5OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/test/java/com/azure/storage/blob/BlobAPITest.groovy", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo0NToyMVrOGNiCLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxODo0NToyMVrOGNiCLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg0MjI4NQ==", "bodyText": "Nice, I think this is a great way to test features that need to be configured a specific way", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416842285", "createdAt": "2020-04-28T18:45:21Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/test/java/com/azure/storage/blob/BlobAPITest.groovy", "diffHunk": "@@ -926,6 +926,41 @@ class BlobAPITest extends APISpec {\n         null     | null       | null        | null         | garbageLeaseID\n     }\n \n+    /*\n+    This test requires two accounts that are configured in a very specific way. It is not feasible to setup that\n+    relationship programmatically, so we have recorded a successful interaction and only test recordings.\n+     */\n+    @Requires( {playbackMode()})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0443ce9f81729bee855368c3a6ec1dc676381958"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MzkzMTA3OnYy", "diffSide": "RIGHT", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobDownloadHeaders.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMDo1NDozMlrOGNmg9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMDo1NDozMlrOGNmg9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkxNTcwMw==", "bodyText": "Can we add a comment somewhere just for future reference for why we have these two classes?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10464#discussion_r416915703", "createdAt": "2020-04-28T20:54:32Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/models/BlobDownloadHeaders.java", "diffHunk": "@@ -12,27 +12,107 @@\n import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlRootElement;\n import java.time.OffsetDateTime;\n import java.util.Map;\n+import java.util.HashMap;\n \n /**\n  * Defines headers for Download operation.\n  */\n @JacksonXmlRootElement(localName = \"Blob-Download-Headers\")\n @Fluent\n public final class BlobDownloadHeaders {\n+\n+    public BlobDownloadHeaders() {\n+\n+    }\n+\n+    public BlobDownloadHeaders(com.azure.storage.blob.implementation.models.BlobDownloadHeaders headers) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baa9c3e358b9dca189a7fa41f1235814b90c0776"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4605, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}