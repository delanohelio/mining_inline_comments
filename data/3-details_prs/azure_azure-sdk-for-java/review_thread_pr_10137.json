{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyNzU0ODYx", "number": 10137, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNzo1MToyNlrODxU3gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNzo1OToyNFrODxwpSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMDQ4NzA1OnYy", "diffSide": "RIGHT", "path": "sdk/search/azure-search-documents/pom.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNzo1MToyNlrOGEu8Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNzo1Njo1NVrOGEvI2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYxNjYwNw==", "bodyText": "Would rather not eagerly move to an unreleased version of Azure Core, is this being done to make testing the build from source issue more easily?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407616607", "createdAt": "2020-04-13T17:51:26Z", "author": {"login": "alzimmermsft"}, "path": "sdk/search/azure-search-documents/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <dependency>\n       <groupId>com.azure</groupId>\n       <artifactId>azure-core</artifactId>\n-      <version>1.4.0</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->\n+      <version>1.5.0-beta.1</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "331d69658989989abc38766039814570f2e52da8"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYxNzgzNg==", "bodyText": "I am not sure why. The search ci nightly build failed because of new azure core change.\nI don't quite get why the build test on new changes.\nhttps://dev.azure.com/azure-sdk/internal/_build/results?buildId=354178&view=logs&j=3d7a0212-45d0-5080-1981-6d6ef159b344&t=14d7dc25-187c-516a-cf22-fdfcecf8f884", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407617836", "createdAt": "2020-04-13T17:53:36Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <dependency>\n       <groupId>com.azure</groupId>\n       <artifactId>azure-core</artifactId>\n-      <version>1.4.0</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->\n+      <version>1.5.0-beta.1</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYxNjYwNw=="}, "originalCommit": {"oid": "331d69658989989abc38766039814570f2e52da8"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYxOTgwMw==", "bodyText": "Search changes here is to test over the azure-core-test changes. Will revert back to azure-core and azure-core released version after testing.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407619803", "createdAt": "2020-04-13T17:56:55Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <dependency>\n       <groupId>com.azure</groupId>\n       <artifactId>azure-core</artifactId>\n-      <version>1.4.0</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->\n+      <version>1.5.0-beta.1</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYxNjYwNw=="}, "originalCommit": {"oid": "331d69658989989abc38766039814570f2e52da8"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMDY3OTMzOnYy", "diffSide": "RIGHT", "path": "sdk/core/azure-core-test/src/main/java/com/azure/core/test/http/MockHttpResponse.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxODo0NzoyNlrOGEw1lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxODo0ODo1NFrOGEw5Cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY0NzYzNg==", "bodyText": "You'll want to move this into the getBodyAsString overload without parameters, nothing I've found in Azure Core leverages the Charset overload.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407647636", "createdAt": "2020-04-13T18:47:26Z", "author": {"login": "alzimmermsft"}, "path": "sdk/core/azure-core-test/src/main/java/com/azure/core/test/http/MockHttpResponse.java", "diffHunk": "@@ -182,7 +182,7 @@ public HttpHeaders getHeaders() {\n \n         return bodyBytes == null\n                 ? Mono.empty()\n-                : Mono.just(new String(bodyBytes, charset));\n+                : Mono.just(CoreUtils.bomAwareToString(bodyBytes, getHeaderValue(\"Content-Type\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "331d69658989989abc38766039814570f2e52da8"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY0ODUyMg==", "bodyText": "public Mono<String> getBodyAsString() {\n  return (bodyBytes == null)\n    ? Mono.empty()\n    : Mono.just(CoreUtils.bomAwareToString(bodyBytes, getHeaderValue(\"Content-Type\"));\n}", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407648522", "createdAt": "2020-04-13T18:48:54Z", "author": {"login": "alzimmermsft"}, "path": "sdk/core/azure-core-test/src/main/java/com/azure/core/test/http/MockHttpResponse.java", "diffHunk": "@@ -182,7 +182,7 @@ public HttpHeaders getHeaders() {\n \n         return bodyBytes == null\n                 ? Mono.empty()\n-                : Mono.just(new String(bodyBytes, charset));\n+                : Mono.just(CoreUtils.bomAwareToString(bodyBytes, getHeaderValue(\"Content-Type\")));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY0NzYzNg=="}, "originalCommit": {"oid": "331d69658989989abc38766039814570f2e52da8"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMDk2NDg0OnYy", "diffSide": "RIGHT", "path": "sdk/search/azure-search-documents/pom.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMDoxMzowNVrOGEznBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMDo0NzoyMVrOGE0uFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzA2MQ==", "bodyText": "Shouldn't the version tag also be updated when we switch to unreleased dependency?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407693061", "createdAt": "2020-04-13T20:13:05Z", "author": {"login": "srnagar"}, "path": "sdk/search/azure-search-documents/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <dependency>\n       <groupId>com.azure</groupId>\n       <artifactId>azure-core</artifactId>\n-      <version>1.4.0</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->\n+      <version>1.5.0-beta.1</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzcxMTI1NQ==", "bodyText": "This is for test purpose. I am going to revert back to the released version as we do not depend on any new Version functionality for now.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407711255", "createdAt": "2020-04-13T20:47:21Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <dependency>\n       <groupId>com.azure</groupId>\n       <artifactId>azure-core</artifactId>\n-      <version>1.4.0</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->\n+      <version>1.5.0-beta.1</version> <!-- {x-version-update;com.azure:azure-core;dependency} -->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzA2MQ=="}, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMDk2Nzg4OnYy", "diffSide": "RIGHT", "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMDoxNDowOFrOGEzpDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNzo0MDo1NlrOGFZx4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzU4MQ==", "bodyText": "If create succeeded, then you can break out of the do-while loop.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407693581", "createdAt": "2020-04-13T20:14:08Z", "author": {"login": "srnagar"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()\n+                    .define(searchServiceName)\n+                    .withRegion(location)\n+                    .withExistingResourceGroup(resourceGroup)\n+                    .withFreeSku()\n+                    .create();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzcxMTkzMQ==", "bodyText": "The management plane does not provide us the status of creation. I have to ping the service to confirm. The newly added code is to avoid failure of creating on already exists account.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r407711931", "createdAt": "2020-04-13T20:48:34Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()\n+                    .define(searchServiceName)\n+                    .withRegion(location)\n+                    .withExistingResourceGroup(resourceGroup)\n+                    .withFreeSku()\n+                    .create();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzU4MQ=="}, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODI2ODA3Ng==", "bodyText": "Could we check the status of the SearchService object?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r408268076", "createdAt": "2020-04-14T16:22:45Z", "author": {"login": "alzimmermsft"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()\n+                    .define(searchServiceName)\n+                    .withRegion(location)\n+                    .withExistingResourceGroup(resourceGroup)\n+                    .withFreeSku()\n+                    .create();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzU4MQ=="}, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODI3ODQ4MQ==", "bodyText": "Just checked over the API. Find the status one this time. Missing from the initial investigation.\nWill try to switch to status() checking", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r408278481", "createdAt": "2020-04-14T16:37:50Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()\n+                    .define(searchServiceName)\n+                    .withRegion(location)\n+                    .withExistingResourceGroup(resourceGroup)\n+                    .withFreeSku()\n+                    .create();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzU4MQ=="}, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMxODMwNw==", "bodyText": "I have tried the API they provided. Seems not that stable as service ping. In order to make our live tests more stable. I decided to switch back to ping machenism.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r408318307", "createdAt": "2020-04-14T17:40:44Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()\n+                    .define(searchServiceName)\n+                    .withRegion(location)\n+                    .withExistingResourceGroup(resourceGroup)\n+                    .withFreeSku()\n+                    .create();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzU4MQ=="}, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMxODQzMw==", "bodyText": "https://dev.azure.com/azure-sdk/internal/_build/results?buildId=356026&view=results", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r408318433", "createdAt": "2020-04-14T17:40:56Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()\n+                    .define(searchServiceName)\n+                    .withRegion(location)\n+                    .withExistingResourceGroup(resourceGroup)\n+                    .withFreeSku()\n+                    .create();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY5MzU4MQ=="}, "originalCommit": {"oid": "32ace2dcbde31204c592ba836dd8150f184561f3"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTAzODE5OnYy", "diffSide": "RIGHT", "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNzo1OToyNFrOGFaf7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODowMTowOFrOGFaj_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMDIyMw==", "bodyText": "We should add some delay between each retry instead of retrying with no delay.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r408330223", "createdAt": "2020-04-14T17:59:24Z", "author": {"login": "srnagar"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b823970e7f52b9a136e18aef8f401daf3272773c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMTI2MA==", "bodyText": "There is delay of 30 seconds on every .create() operation.\nPut it in shouldRetry() helper.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10137#discussion_r408331260", "createdAt": "2020-04-14T18:01:08Z", "author": {"login": "sima-zhu"}, "path": "sdk/search/azure-search-documents/src/test/java/com/azure/search/documents/test/environment/setup/AzureSearchResources.java", "diffHunk": "@@ -114,13 +115,21 @@ public void createService(TestResourceNamer testResourceNamer) {\n         System.out.println(\"Creating Azure Cognitive Search service: \" + searchServiceName);\n         int recreateCount = 0;\n         do {\n-            searchService = azure.searchServices()\n-                .define(searchServiceName)\n-                .withRegion(location)\n-                .withExistingResourceGroup(resourceGroup)\n-                .withFreeSku()\n-                .create();\n-            recreateCount += 1;\n+            try {\n+                searchService = azure.searchServices()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMDIyMw=="}, "originalCommit": {"oid": "b823970e7f52b9a136e18aef8f401daf3272773c"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1867, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}