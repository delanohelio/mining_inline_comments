{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3MDUwNTg0", "number": 11116, "title": "Tracing updates", "bodyText": "Update log levels in tracing code to verbose [Cosmos need]\n Update code to support only a single implementation of Tracer. Being consistent with other languages. Also, not a real use case for supporting multiple tracer implementations at a given time.", "createdAt": "2020-05-13T00:52:11Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116", "merged": true, "mergeCommit": {"oid": "782516de10ced2997ff4b03623a0436ea2f062fc"}, "closed": true, "closedAt": "2020-05-18T18:06:52Z", "author": {"login": "samvaity"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgtPaIgH2gAyNDE3MDUwNTg0OjliNjg4YzYzOTEyNDc0OWY1MTFiOTBhNGQ2MGE3Zjg0NGEzMDZmYzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcijtFrAFqTQxMzgxNjAxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b688c639124749f511b90a4d60a7f844a306fc9", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9b688c639124749f511b90a4d60a7f844a306fc9", "committedDate": "2020-05-12T23:54:13Z", "message": "update log level in tracing lib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/21fd4bf37fb3ab27656e2bb8076971c6b47adb62", "committedDate": "2020-05-13T00:48:58Z", "message": "update list of tracers to single tracer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMDY5NDY0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#pullrequestreview-411069464", "createdAt": "2020-05-13T15:56:05Z", "commit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNTo1NjowNVrOGU4dng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNTo1NjowNVrOGU4dng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTc5MA==", "bodyText": "Do we have any mechanisms available which will ensure a certain tracer is loaded if I happen to bring multiple? This can be a follow-up as it is definitely an edge case.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424549790", "createdAt": "2020-05-13T15:56:05Z", "author": {"login": "alzimmermsft"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -17,14 +17,13 @@\n  */\n public final class TracerProxy {\n \n-    private static final List<Tracer> TRACERS;\n+    private static Tracer TRACER;\n+\n     static {\n         ServiceLoader<Tracer> serviceLoader = ServiceLoader.load(Tracer.class);\n-        List<Tracer> tracers = new ArrayList<>();\n-        for (Tracer tracer : serviceLoader) {\n-            tracers.add(tracer);\n+        if (serviceLoader != null) {\n+            TRACER = serviceLoader.iterator().next();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMDY5NzE0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#pullrequestreview-411069714", "createdAt": "2020-05-13T15:56:23Z", "commit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "320d89a5c537d037e45465683b832c1c38c8bfbf", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/320d89a5c537d037e45465683b832c1c38c8bfbf", "committedDate": "2020-05-13T18:55:28Z", "message": "update single tracer support amqp"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "64f70665364fd99f759a956f316b6fb1d4b108df", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/64f70665364fd99f759a956f316b6fb1d4b108df", "committedDate": "2020-05-13T18:51:54Z", "message": "update single tracer support amqp"}, "afterCommit": {"oid": "320d89a5c537d037e45465683b832c1c38c8bfbf", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/320d89a5c537d037e45465683b832c1c38c8bfbf", "committedDate": "2020-05-13T18:55:28Z", "message": "update single tracer support amqp"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMjI1NjM5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#pullrequestreview-411225639", "createdAt": "2020-05-13T19:16:49Z", "commit": {"oid": "320d89a5c537d037e45465683b832c1c38c8bfbf"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxOToxNjo0OVrOGVAAlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxOToxODoxOFrOGVADjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY3MzQyOQ==", "bodyText": "Or, if there are multiple instances of tracer implementations, should we support all of them? Create spans on each tracer implementation?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424673429", "createdAt": "2020-05-13T19:16:49Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -17,14 +17,13 @@\n  */\n public final class TracerProxy {\n \n-    private static final List<Tracer> TRACERS;\n+    private static Tracer TRACER;\n+\n     static {\n         ServiceLoader<Tracer> serviceLoader = ServiceLoader.load(Tracer.class);\n-        List<Tracer> tracers = new ArrayList<>();\n-        for (Tracer tracer : serviceLoader) {\n-            tracers.add(tracer);\n+        if (serviceLoader != null) {\n+            TRACER = serviceLoader.iterator().next();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTc5MA=="}, "originalCommit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY3NDE5MQ==", "bodyText": "Why does this API return Context? It's inconsistent with setAttribute() API which returns a void. Or, should setAttribute() return Context too since start() is also returning Context?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424674191", "createdAt": "2020-05-13T19:18:18Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -84,11 +86,9 @@ public static void end(int responseCode, Throwable error, Context context) {\n      * @return An updated {@link Context} object.\n      */\n     public static Context setSpanName(String spanName, Context context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "320d89a5c537d037e45465683b832c1c38c8bfbf"}, "originalPosition": 92}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1893a06a2e909c2d00201bb27bef24e4acec42f0", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1893a06a2e909c2d00201bb27bef24e4acec42f0", "committedDate": "2020-05-13T20:56:16Z", "message": "update tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74f5f3ff4383110dc220703069c709999306d8ff", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/74f5f3ff4383110dc220703069c709999306d8ff", "committedDate": "2020-05-13T20:54:56Z", "message": "update tests"}, "afterCommit": {"oid": "1893a06a2e909c2d00201bb27bef24e4acec42f0", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1893a06a2e909c2d00201bb27bef24e4acec42f0", "committedDate": "2020-05-13T20:56:16Z", "message": "update tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fe7373b6e31599fc9c2565ec902c00ccc63e634", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2fe7373b6e31599fc9c2565ec902c00ccc63e634", "committedDate": "2020-05-17T19:53:18Z", "message": "update static variable name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzODE2MDEz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#pullrequestreview-413816013", "createdAt": "2020-05-18T17:55:26Z", "commit": {"oid": "2fe7373b6e31599fc9c2565ec902c00ccc63e634"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4281, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}