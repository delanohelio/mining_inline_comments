{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3Nzk2NjQw", "number": 17826, "title": "Javadocs update 2", "bodyText": "Update Sender and Receiver client documentation\nUpdate message batch and processor client docs.\nUpdate transaction snippets\nSnippets for creating sessions.", "createdAt": "2020-11-26T03:20:19Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826", "merged": true, "mergeCommit": {"oid": "33362b5a8b64e10952aa8b58e4c8a448348502a0"}, "closed": true, "closedAt": "2020-11-28T02:23:19Z", "author": {"login": "conniey"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf5g54gH2gAyNTI3Nzk2NjQwOmEyY2E2NzU4N2ZmZGI4OThhM2M4YzE3NmUzNTgzNWQwOTAzYWVjOTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgyNv-gBqjQwNDc1NjkwNzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a2ca67587ffdb898a3c8c176e35835d0903aec92", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a2ca67587ffdb898a3c8c176e35835d0903aec92", "committedDate": "2020-11-25T07:49:25Z", "message": "Update documentation for message batch and processor client."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "806d30b9aa415d959080e7f95468dbbfd1df9432", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/806d30b9aa415d959080e7f95468dbbfd1df9432", "committedDate": "2020-11-25T09:51:27Z", "message": "Update documentation for messages."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00bcda4ec89bb08552b09a3ad765730951c2d570", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/00bcda4ec89bb08552b09a3ad765730951c2d570", "committedDate": "2020-11-25T09:51:36Z", "message": "Update documentation for Message Context."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91278d754d2149d2018c3057a222a8e9310a76f2", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/91278d754d2149d2018c3057a222a8e9310a76f2", "committedDate": "2020-11-25T20:16:49Z", "message": "Add transaction snippets."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0210147c942b1efbc4759512b6211a41d07d025e", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0210147c942b1efbc4759512b6211a41d07d025e", "committedDate": "2020-11-25T20:40:28Z", "message": "Adding links to options."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64cd70507da12c884538f0588b4ab3313634b699", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/64cd70507da12c884538f0588b4ab3313634b699", "committedDate": "2020-11-25T21:24:19Z", "message": "Add transaction code snippets."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "271ee6974fca6b1937293bc05cfc385c738ad558", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/271ee6974fca6b1937293bc05cfc385c738ad558", "committedDate": "2020-11-26T01:07:37Z", "message": "Adding sender and receiver documentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c9653c6adf55ce0db79f7010dda91c24509fded", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9c9653c6adf55ce0db79f7010dda91c24509fded", "committedDate": "2020-11-26T01:14:32Z", "message": "Update session client documentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a608cadc737b981e91d681e338b0da7dbc8a4934", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a608cadc737b981e91d681e338b0da7dbc8a4934", "committedDate": "2020-11-26T02:25:54Z", "message": "Fix docs naming"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8579fcf5e2d3d1333642c370ef64249eee4e2379", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/8579fcf5e2d3d1333642c370ef64249eee4e2379", "committedDate": "2020-11-26T02:49:31Z", "message": "Updating session documents."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c14842baa12819bfd308ac1c812def473b9fe116", "committedDate": "2020-11-26T03:17:31Z", "message": "Merge branch 'master' of https://github.com/azure/azure-sdk-for-java into javadocs-part2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4OTg4Njcw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#pullrequestreview-538988670", "createdAt": "2020-11-26T04:37:19Z", "commit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwNDozNzoxOVrOH6Llpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwNTo1MTo0OVrOH6MtBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc2OTMxOQ==", "bodyText": "May be explain about autoComplete as it is important part.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530769319", "createdAt": "2020-11-26T04:37:19Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusProcessorClient.java", "diffHunk": "@@ -36,11 +36,10 @@\n import static com.azure.messaging.servicebus.implementation.ServiceBusConstants.AZ_TRACING_SERVICE_NAME;\n \n /**\n- *  The processor client for processing Service Bus messages. {@link ServiceBusProcessorClient\n- *  ServiceBusProcessorClients} provides a push-based mechanism that invokes the message processing callback when a\n- *  message is received or the error handler when an error occurs when receiving messages. A\n- *  {@link ServiceBusProcessorClient} can be created to process messages for a session-enabled Service Bus entity or\n- *  a non session-enabled Service Bus entity.\n+ * The processor client for processing Service Bus messages. {@link ServiceBusProcessorClient} provides a push-based\n+ * mechanism that invokes the message processing callback when a message is received or the error handler when an error\n+ * occurs when receiving messages. A {@link ServiceBusProcessorClient} can be created to process messages for a\n+ * session-enabled or non session-enabled Service Bus entity.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc3NTM4OA==", "bodyText": "I missed it to change to return BinaryData.fromBytes(amqpAnnotatedMessage.getBody().getFirstData())\nBinaryData will always have data, a null is converted into empty byte array inside BinaryData, So we do not have to\ncheck for payload.isPresent().\nBinaryData  store data in byte[] variable. so calling getFirstData will be efficient.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530775388", "createdAt": "2020-11-26T05:03:34Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceivedMessage.java", "diffHunk": "@@ -50,50 +60,56 @@\n     }\n \n     /**\n-     * The representation of message as defined by AMQP protocol.\n-     *\n-     * @see <a href=\"http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#section-message-format\">\n-     *     Amqp Message Format.</a>\n+     * Gets the set of free-form {@link ServiceBusReceivedMessage} properties which may be used for passing metadata\n+     * associated with the {@link ServiceBusReceivedMessage} during Service Bus operations. A common use-case for\n+     * {@code properties()} is to associate serialization hints for the {@link #getBody()} as an aid to consumers\n+     * who wish to deserialize the binary data.\n      *\n-     * @return the {@link AmqpAnnotatedMessage} representing amqp message.\n+     * @return Application properties associated with this {@link ServiceBusReceivedMessage}.\n+     * @see ServiceBusMessage#getApplicationProperties()\n      */\n-    public AmqpAnnotatedMessage getRawAmqpMessage() {\n-        return amqpAnnotatedMessage;\n+    public Map<String, Object> getApplicationProperties() {\n+        return amqpAnnotatedMessage.getApplicationProperties();\n     }\n \n     /**\n-     * Gets the actual payload/data wrapped by the {@link ServiceBusReceivedMessage}.\n+     * Gets the payload wrapped by the {@link ServiceBusReceivedMessage}.\n      *\n      * <p>The {@link BinaryData} wraps byte array and is an abstraction over many different ways it can be represented.\n-     * It provides many convenience API including APIs to serialize/deserialize object.\n+     * It provides convenience APIs to serialize/deserialize the object.</p>\n+     *\n      * <p>\n      * If the means for deserializing the raw data is not apparent to consumers, a common technique is to make use of\n      * {@link #getApplicationProperties()} when creating the event, to associate serialization hints as an aid to\n      * consumers who wish to deserialize the binary data.\n      * </p>\n      *\n-     * @return A byte array representing the data.\n+     * @return Binary data representing the payload.\n+     * @see ServiceBusMessage#getBody()\n      */\n     public BinaryData getBody() {\n         final AmqpMessageBodyType bodyType = amqpAnnotatedMessage.getBody().getBodyType();\n         switch (bodyType) {\n             case DATA:\n-                return BinaryData.fromBytes(amqpAnnotatedMessage.getBody()\n-                    .getData().stream().findFirst().get());\n+                final Optional<byte[]> payload = amqpAnnotatedMessage.getBody().getData().stream().findFirst();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc4MTY2MQ==", "bodyText": "This is also, I think we missed it,\nThis should get getSubgect.\nJust to verify this is .Net API View https://apiview.dev/Assemblies/Review/b5d7e3304000449c859c2016f718db52#Azure.Messaging.ServiceBus.ServiceBusReceivedMessage", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530781661", "createdAt": "2020-11-26T05:28:58Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceivedMessage.java", "diffHunk": "@@ -238,25 +266,30 @@ public OffsetDateTime getExpiresAt() {\n     /**\n      * Gets the label for the message.\n      *\n+     * <p>\n+     * This property enables the application to indicate the purpose of the message to the receiver in a standardized\n+     * fashion, similar to an email subject line. The mapped AMQP property is \"subject\".\n+     * </p>\n+     *\n      * @return The label for the message.\n+     * @see ServiceBusMessage#getSubject()\n      */\n     public String getLabel() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 248}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc4NDQwOA==", "bodyText": "Document : This should throw exception if this is called for non-session entity. I think we do not have that check. we should add that check.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530784408", "createdAt": "2020-11-26T05:39:25Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverClient.java", "diffHunk": "@@ -258,8 +255,8 @@ public ServiceBusReceivedMessage peekMessage() {\n \n     /**\n      * Reads the next active message without changing the state of the receiver or the message source. The first call to\n-     * {@code peek()} fetches the first active message for this receiver. Each subsequent call fetches the subsequent\n-     * message in the entity.\n+     * {@code peekMessage()} fetches the first active message for this receiver. Each subsequent call fetches the\n+     * subsequent message in the entity.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 206}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc4NTE1Ng==", "bodyText": "if the session lock cannot be renewed. : We have this line many places, but it does not give hint why this operation can not be done. One reason is  id client is already disposed. Should we let user know why  ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530785156", "createdAt": "2020-11-26T05:42:12Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverClient.java", "diffHunk": "@@ -538,9 +556,8 @@ public void renewMessageLock(ServiceBusReceivedMessage message, Duration maxLock\n      * Sets the state of the session if this receiver is a session receiver.\n      *\n      * @return The next expiration time for the session lock.\n-     * @throws NullPointerException if {@code sessionId} is null.\n-     * @throws IllegalArgumentException if {@code sessionId} is an empty string.\n      * @throws IllegalStateException if the receiver is a non-session receiver or receiver is already disposed.\n+     * @throws ServiceBusException if the session lock cannot be renewed.\n      */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 348}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc4NTUzOA==", "bodyText": "isn't this true that AmqpException will be mapped to ServiceBusException. Same in following few API.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530785538", "createdAt": "2020-11-26T05:43:55Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusSenderAsyncClient.java", "diffHunk": "@@ -160,9 +162,11 @@ public String getEntityPath() {\n      *\n      * @return The {@link Mono} the finishes this operation on service bus resource.\n      *\n-     * @throws NullPointerException if {@code message} is {@code null} , {@code transactionContext} or\n-     * {@code transactionContext.transactionID} is {@code null}.\n+     * @throws NullPointerException if {@code message}, {@code transactionContext} or\n+     *      {@code transactionContext.transactionId} is {@code null}.\n      * @throws IllegalStateException if sender is already disposed.\n+     * @throws AmqpException if {@code message} is larger than the maximum allowed size of a single message.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc4NzU4OQ==", "bodyText": "When user create  this  client ServiceBusSessionReceiverClient, they have to close this. Because this is intermediate client, it is easy to miss. We had same issue in our live test.\nSo may be we can write this  in builder when this is created also here so User ensure this is closed.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#discussion_r530787589", "createdAt": "2020-11-26T05:51:49Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusSessionReceiverClient.java", "diffHunk": "@@ -13,14 +15,15 @@\n /**\n  * This session receiver client is used to acquire session locks from a queue or topic and create\n  * {@link ServiceBusReceiverClient} instances that are tied to the locked sessions.\n- * Use {@link #acceptSession(String)} to acquire the lock of a session if you know the session id.\n- *\n- * {@codesnippet com.azure.messaging.servicebus.servicebusreceiverclient.instantiation#nextsession}\n- *\n- * Use {@link #acceptNextSession()} to acquire the lock of the next available session without specifying the session id.\n  *\n+ * <p><strong>Receive messages from a specific session</strong></p>\n+ * <p>Use {@link #acceptSession(String)} to acquire the lock of a session if you know the session id.</p>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c14842baa12819bfd308ac1c812def473b9fe116"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daa96f338e793909a3535f8aaa90df73afc9acb4", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/daa96f338e793909a3535f8aaa90df73afc9acb4", "committedDate": "2020-11-26T06:46:37Z", "message": "Update to getSubject -> getLabel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28c06ff51ecb8daf7e28003ffd8527b4d278968d", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/28c06ff51ecb8daf7e28003ffd8527b4d278968d", "committedDate": "2020-11-28T00:06:16Z", "message": "Change to getFirstData()"}, "afterCommit": {"oid": "5a4b5ee537af34cfbcbd3583f3e9fa2b0040ef98", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a4b5ee537af34cfbcbd3583f3e9fa2b0040ef98", "committedDate": "2020-11-28T00:06:58Z", "message": "Change to getFirstData()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMjEzNzI1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17826#pullrequestreview-540213725", "createdAt": "2020-11-28T00:10:05Z", "commit": {"oid": "5a4b5ee537af34cfbcbd3583f3e9fa2b0040ef98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a190287a2e5ac37485a50073c2d55750c898fda", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0a190287a2e5ac37485a50073c2d55750c898fda", "committedDate": "2020-11-28T01:52:53Z", "message": "Change to getFirstData()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a4b5ee537af34cfbcbd3583f3e9fa2b0040ef98", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a4b5ee537af34cfbcbd3583f3e9fa2b0040ef98", "committedDate": "2020-11-28T00:06:58Z", "message": "Change to getFirstData()"}, "afterCommit": {"oid": "0a190287a2e5ac37485a50073c2d55750c898fda", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0a190287a2e5ac37485a50073c2d55750c898fda", "committedDate": "2020-11-28T01:52:53Z", "message": "Change to getFirstData()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1511, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}