{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwODcwNDA0", "number": 17925, "title": "fix consumer processError in the service bus example", "bodyText": "In the new version (7.0.0) of Azure Service Bus, the method processError of the class ServiceBusClientBuilder has the input parameter with a different type.\nIt has been changed from Consumer<Throwable> to Consumer<ServiceBusErrorContext>.\nYou can see this commit.\nI notice that the README has not been updated. Therefore, I fix the consumer processError\nfrom\nConsumer<Throwable> processError = throwable -> {\n    logError(throwable);\n    metrics.recordError(throwable);\n};\n\nto\nConsumer<ServiceBusErrorContext> processError = errorContext -> {\n    logError(errorContext.getException());\n    metrics.recordError(errorContext.getException());\n};\n\nI also added two missing semicolons in the definition of functions.\nFix for #17490", "createdAt": "2020-12-02T09:16:31Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17925", "merged": true, "mergeCommit": {"oid": "fc7c91bd092e2ed20c5da20ae39a5e3f7d03f37d"}, "closed": true, "closedAt": "2020-12-03T20:47:47Z", "author": {"login": "frascu"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdh9WdygH2gAyNTMwODcwNDA0OmU4NGNmMjcxMjY3ZThjZWRiNjQ4N2M1ZGY1NDYzYjRiOTdjMmMyYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdipb_6gFqTU0NDQyODY0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e84cf271267e8cedb6487c5df5463b4b97c2c2af", "author": {"user": {"login": "frascu", "name": "Francesco Scuccimarri"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e84cf271267e8cedb6487c5df5463b4b97c2c2af", "committedDate": "2020-12-01T17:25:29Z", "message": "fix consumer process error in the service bus example\n\n(cherry picked from commit 83dc4c38813905452dd578b746321bb8f6043a0a)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a77ddaed8f28d7432a087bc85f0b575cfcf987cc", "author": {"user": {"login": "frascu", "name": "Francesco Scuccimarri"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a77ddaed8f28d7432a087bc85f0b575cfcf987cc", "committedDate": "2020-12-02T23:13:35Z", "message": "add embedme for code example of processore client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c4ae6f95a681e016572f02c565f58b6b8c3ac26", "author": {"user": {"login": "frascu", "name": "Francesco Scuccimarri"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6c4ae6f95a681e016572f02c565f58b6b8c3ac26", "committedDate": "2020-12-02T23:17:16Z", "message": "change default strings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMzQ2ODE4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17925#pullrequestreview-543346818", "createdAt": "2020-12-03T00:24:56Z", "commit": {"oid": "6c4ae6f95a681e016572f02c565f58b6b8c3ac26"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwMDoyNDo1N1rOH9zyxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwMDoyNDo1N1rOH9zyxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU3Mzc2NA==", "bodyText": "Add .disableAutoComplete()\nBy default autoComplete is enabled,  this means this SDK will internally  complete the message for you and user do not need to call messageContext.complete() .\nBut since we want to show how  user can disable this feature  by calling disableAutoComplete and complete it manually (like you do in  processMessage Consumer).\nWe had this bug in readme and it was  left over,  since you are touching this specific part, you can fix this also.  Thank You", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17925#discussion_r534573764", "createdAt": "2020-12-03T00:24:57Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java", "diffHunk": "@@ -206,4 +207,38 @@ public void createSynchronousServiceBusDeadLetterQueueReceiver() {\n             .subQueue(SubQueue.DEAD_LETTER_QUEUE)\n             .buildClient();\n     }\n+\n+    /**\n+     * Code sample for creating a Service Bus Processor Client.\n+     */\n+    public void createServiceBusProcessorClient() {\n+        // Sample code that processes a single message\n+        Consumer<ServiceBusReceivedMessageContext> processMessage = messageContext -> {\n+            try {\n+                System.out.println(messageContext.getMessage().getMessageId());\n+                // other message processing code\n+                messageContext.complete();\n+            } catch (Exception ex) {\n+                messageContext.abandon();\n+            }\n+        };\n+\n+        // Sample code that gets called if there's an error\n+        Consumer<ServiceBusErrorContext> processError = errorContext -> {\n+            System.err.println(\"Error occurred while receiving message: \" + errorContext.getException());\n+        };\n+\n+        // create the processor client via the builder and its sub-builder\n+        ServiceBusProcessorClient processorClient = new ServiceBusClientBuilder()\n+                                        .connectionString(\"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\")\n+                                        .processor()\n+                                        .queueName(\"<< QUEUE NAME >>\")\n+                                        .processMessage(processMessage)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c4ae6f95a681e016572f02c565f58b6b8c3ac26"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "853be0a6a8a121da4e02b77c27aee81c9699e086", "author": {"user": {"login": "frascu", "name": "Francesco Scuccimarri"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/853be0a6a8a121da4e02b77c27aee81c9699e086", "committedDate": "2020-12-03T07:46:18Z", "message": "add disableAutoComplete to complete/abandon the message manually"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NDI4NjQx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17925#pullrequestreview-544428641", "createdAt": "2020-12-03T20:47:21Z", "commit": {"oid": "853be0a6a8a121da4e02b77c27aee81c9699e086"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1304, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}