{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMTM5NjA5", "number": 12654, "title": "change RNTBD defaults as per learning and to be in par with .Net", "bodyText": "RNTBD connect timeout changed from 60 seconds to 5 seconds\n(60 seconds connect timeout, will cause very high latency if an endpoint is not reachable for any reason)\ndefault for .Net is 5 seconds.\nhttps://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.documents.client.connectionpolicy.opentcpconnectiontimeout?view=azure-dotnet#Microsoft_Azure_Documents_Client_ConnectionPolicy_OpenTcpConnectionTimeout\nchanging idle timeout to ensure always a connection will be kept to the endpoint.", "createdAt": "2020-06-30T16:15:40Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654", "merged": true, "mergeCommit": {"oid": "c548afc068451c8f24e503f24a369e7145091995"}, "closed": true, "closedAt": "2020-07-07T20:44:44Z", "author": {"login": "moderakh"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwX_jkgH2gAyNDQyMTM5NjA5OjZhMjE4OTgzYzhiZGFhNzVkOWU1MTJjYWYwNGVlYzhiZDQwMDFkMjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyXKItgFqTQ0MzM4MTMwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6a218983c8bdaa75d9e512caf04eec8bd4001d29", "author": {"user": {"login": "moderakh", "name": "Mohammad Derakhshani"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6a218983c8bdaa75d9e512caf04eec8bd4001d29", "committedDate": "2020-06-30T16:11:41Z", "message": "change RNTBD defaults as per learning from customer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTkyNDc5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#pullrequestreview-440192479", "createdAt": "2020-06-30T16:33:00Z", "commit": {"oid": "6a218983c8bdaa75d9e512caf04eec8bd4001d29"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNjozMzowMFrOGrE3Zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNjozMzowMFrOGrE3Zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyMTY3MQ==", "bodyText": "Isn't this too much ?\nFor big customers, who have very high number of physical partitions - like around 500 or 1000. Then this will always create that many connections -> physical partitions * 4 (which is the number of replicas) - and will keep the resources occupied for 24 hours even if we don't need them.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#discussion_r447821671", "createdAt": "2020-06-30T16:33:00Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/DirectConnectionConfig.java", "diffHunk": "@@ -15,8 +15,8 @@\n  */\n public final class DirectConnectionConfig {\n     //  Constants\n-    private static final Duration DEFAULT_IDLE_ENDPOINT_TIMEOUT = Duration.ofSeconds(70L);\n-    private static final Duration DEFAULT_CONNECT_TIMEOUT = Duration.ofSeconds(60L);\n+    private static final Duration DEFAULT_IDLE_ENDPOINT_TIMEOUT = Duration.ofHours(24L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a218983c8bdaa75d9e512caf04eec8bd4001d29"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f06f73834c0fb855ec572c8d1e9b7b2d0080c8e1", "author": {"user": {"login": "moderakh", "name": "Mohammad Derakhshani"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f06f73834c0fb855ec572c8d1e9b7b2d0080c8e1", "committedDate": "2020-06-30T19:27:15Z", "message": "reduced idle value to 1h"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMzMyMTU0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#pullrequestreview-440332154", "createdAt": "2020-06-30T19:45:04Z", "commit": {"oid": "f06f73834c0fb855ec572c8d1e9b7b2d0080c8e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwODgwMTUw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#pullrequestreview-440880150", "createdAt": "2020-07-01T13:41:50Z", "commit": {"oid": "f06f73834c0fb855ec572c8d1e9b7b2d0080c8e1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjE3NTgz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#pullrequestreview-440217583", "createdAt": "2020-06-30T17:03:41Z", "commit": {"oid": "6a218983c8bdaa75d9e512caf04eec8bd4001d29"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzowMzo0MlrOGrGGXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNzowNDowMlrOGrGHEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0MTg4Ng==", "bodyText": "This may result in the appearance of a resource leak when the partition count is large, hits on partitions are sparse and shifting. Example: 1,000 partitions. Partition 1 is hot for a short period of time causing numerous connections to be opened. Now partition 2 is hot. Then partition 3,... Half the partitions then go dormant. These connections might last 24 hours without being used.\nAlternatively, in another PR, we might consider changing the algorithm so one connection stays open. We\u2019d consume fewer resources unnecessarily. I\u2019d like some time to think about the specifics of how this might work.\n@moderakh let\u2019s chat about this offline.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#discussion_r447841886", "createdAt": "2020-06-30T17:03:42Z", "author": {"login": "David-Noble-at-work"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/DirectConnectionConfig.java", "diffHunk": "@@ -15,8 +15,8 @@\n  */\n public final class DirectConnectionConfig {\n     //  Constants\n-    private static final Duration DEFAULT_IDLE_ENDPOINT_TIMEOUT = Duration.ofSeconds(70L);\n-    private static final Duration DEFAULT_CONNECT_TIMEOUT = Duration.ofSeconds(60L);\n+    private static final Duration DEFAULT_IDLE_ENDPOINT_TIMEOUT = Duration.ofHours(24L);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyMTY3MQ=="}, "originalCommit": {"oid": "6a218983c8bdaa75d9e512caf04eec8bd4001d29"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0MjA2NQ==", "bodyText": "thanks!", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#discussion_r447842065", "createdAt": "2020-06-30T17:04:02Z", "author": {"login": "David-Noble-at-work"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/DirectConnectionConfig.java", "diffHunk": "@@ -15,8 +15,8 @@\n  */\n public final class DirectConnectionConfig {\n     //  Constants\n-    private static final Duration DEFAULT_IDLE_ENDPOINT_TIMEOUT = Duration.ofSeconds(70L);\n-    private static final Duration DEFAULT_CONNECT_TIMEOUT = Duration.ofSeconds(60L);\n+    private static final Duration DEFAULT_IDLE_ENDPOINT_TIMEOUT = Duration.ofHours(24L);\n+    private static final Duration DEFAULT_CONNECT_TIMEOUT = Duration.ofSeconds(5L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a218983c8bdaa75d9e512caf04eec8bd4001d29"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxOTQwMzMy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#pullrequestreview-441940332", "createdAt": "2020-07-02T18:43:21Z", "commit": {"oid": "f06f73834c0fb855ec572c8d1e9b7b2d0080c8e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMzgxMzAx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12654#pullrequestreview-443381301", "createdAt": "2020-07-06T20:21:11Z", "commit": {"oid": "f06f73834c0fb855ec572c8d1e9b7b2d0080c8e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2878, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}