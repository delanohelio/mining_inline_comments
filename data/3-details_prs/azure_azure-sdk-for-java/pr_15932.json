{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MDU4NTQ2", "number": 15932, "title": "Reduce settlement API on receiver Use Options instead", "bodyText": "Reduce settlement API on receiver by introducing following\n\nAbandonOptions\nCompleteOptions\nDeferOptions\nDeadletterOption (Pre existing class)\n\n\n\nAPI View : https://apiview.dev/Assemblies/Review/6af850ed7eb04843a6897afbe13cdd28", "createdAt": "2020-10-05T19:10:27Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932", "merged": true, "mergeCommit": {"oid": "16332b92601eadad4c97d1604d443d78340d8cca"}, "closed": true, "closedAt": "2020-10-06T03:34:59Z", "author": {"login": "hemanttanwar"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdN_MvPgH2gAyNDk4MDU4NTQ2OmI2ODcyYmE4ZTZmZGViM2JjZTVlNDc2MmIyYzM2MjNlMDRmYWYxNjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPr6ExgFqTUwMjQ3NTY0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6872ba8e6fdeb3bce5e4762b2c3623e04faf169", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b6872ba8e6fdeb3bce5e4762b2c3623e04faf169", "committedDate": "2020-09-30T16:16:11Z", "message": "continue implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "572c854d45cdd5393e538d17954cd41a84c892d1", "author": {"user": {"login": "YijunXieMS", "name": "Yijun Xie"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/572c854d45cdd5393e538d17954cd41a84c892d1", "committedDate": "2020-10-04T23:20:22Z", "message": "Move transaction context from XXXOptions constructors to setters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce", "committedDate": "2020-10-05T19:07:16Z", "message": "Reduce settlement API on receiver- By using Options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30c37fae6ff4fd8e715fdafe5e363a8d2b894f3a", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/30c37fae6ff4fd8e715fdafe5e363a8d2b894f3a", "committedDate": "2020-10-05T19:14:19Z", "message": "Reduce settlement API on receiver- By using Options"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDQ1MzEz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#pullrequestreview-502445313", "createdAt": "2020-10-05T21:48:50Z", "commit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMTo0ODo1MFrOHcu83Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMjowNzoxMlrOHcvaaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg5MTQyMQ==", "bodyText": "AbandonOptions#setTransactionContext", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#discussion_r499891421", "createdAt": "2020-10-05T21:48:50Z", "author": {"login": "YijunXieMS"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverAsyncClient.java", "diffHunk": "@@ -198,55 +201,40 @@ public String getEntityPath() {\n      *     mode.\n      */\n     public Mono<Void> abandon(ServiceBusReceivedMessage message) {\n-        return abandon(message, null);\n-    }\n-\n-    /**\n-     * Abandon a {@link ServiceBusReceivedMessage message} updates the message's properties.\n-     * This will make the message available again for processing. Abandoning a message will increase the delivery count\n-     * on the message.\n-     *\n-     * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Properties to modify on the message.\n-     *\n-     * @return A {@link Mono} that completes when the Service Bus operation finishes.\n-     * @throws NullPointerException if {@code message} is null.\n-     * @throws UnsupportedOperationException if the receiver was opened in {@link ReceiveMode#RECEIVE_AND_DELETE}\n-     *     mode.\n-     */\n-    public Mono<Void> abandon(ServiceBusReceivedMessage message, Map<String, Object> propertiesToModify) {\n         return updateDisposition(message, DispositionStatus.ABANDONED, null, null,\n-            propertiesToModify, null);\n+            null, null);\n     }\n \n     /**\n-     * Abandon a {@link ServiceBusReceivedMessage message} with its lock token and updates the message's properties.\n+     * Abandon a {@link ServiceBusReceivedMessage message} updates the message's properties.\n      * This will make the message available again for processing. Abandoning a message will increase the delivery count\n      * on the message.\n-     * <p><strong>Complete a message with a transaction</strong></p>\n-     * {@codesnippet com.azure.messaging.servicebus.servicebusasyncreceiverclient.abandonMessageWithTransaction}\n      *\n      * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Properties to modify on the message.\n-     * @param transactionContext in which this operation is taking part in. The transaction should be created first by\n-     * {@link ServiceBusReceiverAsyncClient#createTransaction()} or\n-     * {@link ServiceBusSenderAsyncClient#createTransaction()}.\n+     * @param options to abandon the message. You can specify\n+     *     {@link AbandonOptions#setPropertiesToModify(Map) properties} to modify on the Message. The\n+     *     {@code transactionContext} can be set using\n+     *     {@link CompleteOptions#setTransactionContext(ServiceBusTransactionContext)}. The transaction should be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg5ODA0Ng==", "bodyText": "DeferOptions", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#discussion_r499898046", "createdAt": "2020-10-05T22:04:57Z", "author": {"login": "YijunXieMS"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverAsyncClient.java", "diffHunk": "@@ -296,58 +288,43 @@ public String getEntityPath() {\n      *\n      * @return A {@link Mono} that completes when the Service Bus defer operation finishes.\n      * @throws NullPointerException if {@code message} is null.\n-     * @throws UnsupportedOperationException if the receiver was opened in {@link ReceiveMode#RECEIVE_AND_DELETE}\n-     *     mode.\n+     * @throws UnsupportedOperationException if the receiver was opened in {@link ReceiveMode#RECEIVE_AND_DELETE} mode.\n      * @see <a href=\"https://docs.microsoft.com/azure/service-bus-messaging/message-deferral\">Message deferral</a>\n      */\n     public Mono<Void> defer(ServiceBusReceivedMessage message) {\n-        return defer(message, null);\n-    }\n-\n-    /**\n-     * Defers a {@link ServiceBusReceivedMessage message} with modified message property. This will move message into\n-     * the deferred subqueue.\n-     *\n-     * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Message properties to modify.\n-     *\n-     * @return A {@link Mono} that completes when the defer operation finishes.\n-     * @throws NullPointerException if {@code message} is null.\n-     * @throws UnsupportedOperationException if the receiver was opened in {@link ReceiveMode#RECEIVE_AND_DELETE}\n-     *     mode.\n-     * @see <a href=\"https://docs.microsoft.com/azure/service-bus-messaging/message-deferral\">Message deferral</a>\n-     */\n-    public Mono<Void> defer(ServiceBusReceivedMessage message, Map<String, Object> propertiesToModify) {\n         return updateDisposition(message, DispositionStatus.DEFERRED, null, null,\n-            propertiesToModify, null);\n+            null, null);\n     }\n \n     /**\n      * Defers a {@link ServiceBusReceivedMessage message} with modified message property. This will move message into\n      * the deferred subqueue.\n      *\n      * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Message properties to modify.\n-     * @param transactionContext in which this operation is taking part in. The transaction should be created first\n-     *     by {@link ServiceBusReceiverAsyncClient#createTransaction()} or\n+     * @param options to defer the message. You can specify {@link DeferOptions#setPropertiesToModify(Map) properties}\n+     *     to modify on the Message. The {@code transactionContext} can be set using\n+     *     {@link CompleteOptions#setTransactionContext(ServiceBusTransactionContext)}. The transaction should be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg5ODQzNw==", "bodyText": "DeadLetterOptions", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#discussion_r499898437", "createdAt": "2020-10-05T22:05:48Z", "author": {"login": "YijunXieMS"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverAsyncClient.java", "diffHunk": "@@ -370,69 +347,31 @@ public String getEntityPath() {\n      * Moves a {@link ServiceBusReceivedMessage message} to the deadletter sub-queue.\n      *\n      * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param transactionContext in which this operation is taking part in. The transaction should be created first\n-     *     by {@link ServiceBusReceiverAsyncClient#createTransaction()} or\n+     * @param options to deadLetter the message. You can specify\n+     *     {@link DeadLetterOptions#setPropertiesToModify(Map) properties} to modify on the Message. The\n+     *     {@code transactionContext} can be set using\n+     *     {@link CompleteOptions#setTransactionContext(ServiceBusTransactionContext)}. The transaction should be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "originalPosition": 219}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg5ODcxOQ==", "bodyText": "AbandonOptions", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#discussion_r499898719", "createdAt": "2020-10-05T22:06:31Z", "author": {"login": "YijunXieMS"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverClient.java", "diffHunk": "@@ -88,35 +91,20 @@ public void abandon(ServiceBusReceivedMessage message) {\n      * available again for processing. Abandoning a message will increase the delivery count on the message.\n      *\n      * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Properties to modify on the message.\n-     *\n-     * @throws NullPointerException if {@code message} is null.\n-     * @throws UnsupportedOperationException if the receiver was opened in {@link ReceiveMode#RECEIVE_AND_DELETE}\n-     *     mode.\n-     */\n-    public void abandon(ServiceBusReceivedMessage message, Map<String, Object> propertiesToModify) {\n-        asyncClient.abandon(message, propertiesToModify).block(operationTimeout);\n-    }\n-\n-    /**\n-     * Abandon a {@link ServiceBusReceivedMessage message} updates the message's properties. This will make the message\n-     * available again for processing. Abandoning a message will increase the delivery count on the message.\n-     *\n-     * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Properties to modify on the message.\n-     * @param transactionContext in which this operation is taking part in. The transaction should be created first\n-     *     by {@link ServiceBusReceiverClient#createTransaction()} or\n-     *     {@link ServiceBusSenderClient#createTransaction()}.\n-     *\n-     * @throws NullPointerException if {@code message}, {@code transactionContext} or {@code\n-     *     transactionContext.transactionId} is null.\n+     * @param options to abandon the message. You can specify\n+     *     {@link AbandonOptions#setPropertiesToModify(Map) properties} to modify on the Message. The\n+     *     {@code transactionContext} can be set using\n+     *     {@link CompleteOptions#setTransactionContext(ServiceBusTransactionContext)}. The transaction should be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg5ODg1MA==", "bodyText": "DeferOptions", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#discussion_r499898850", "createdAt": "2020-10-05T22:06:52Z", "author": {"login": "YijunXieMS"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverClient.java", "diffHunk": "@@ -168,36 +157,20 @@ public void defer(ServiceBusReceivedMessage message) {\n      * move message into the deferred subqueue.\n      *\n      * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param propertiesToModify Message properties to modify.\n-     *\n-     * @throws NullPointerException if {@code message} is null.\n+     * @param options to defer the message. You can specify {@link DeferOptions#setPropertiesToModify(Map) properties}\n+     *     to modify on the Message. The {@code transactionContext} can be set using\n+     *     {@link CompleteOptions#setTransactionContext(ServiceBusTransactionContext)}. The transaction should be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg5ODk4Nw==", "bodyText": "DeadLetterOptions", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#discussion_r499898987", "createdAt": "2020-10-05T22:07:12Z", "author": {"login": "YijunXieMS"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverClient.java", "diffHunk": "@@ -220,34 +193,20 @@ public void deadLetter(ServiceBusReceivedMessage message) {\n      * description, and/or modified properties.\n      *\n      * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param deadLetterOptions The options to specify when moving message to the deadletter sub-queue.\n-     *\n-     * @throws NullPointerException if {@code message} is null.\n-     * @throws UnsupportedOperationException if the receiver was opened in {@link ReceiveMode#RECEIVE_AND_DELETE}\n-     *     mode.\n-     */\n-    public void deadLetter(ServiceBusReceivedMessage message, DeadLetterOptions deadLetterOptions) {\n-        asyncClient.deadLetter(message, deadLetterOptions).block(operationTimeout);\n-    }\n-\n-    /**\n-     * Moves a {@link ServiceBusReceivedMessage message} to the deadletter subqueue with deadletter reason, error\n-     * description, and/or modified properties.\n-     *\n-     * @param message The {@link ServiceBusReceivedMessage} to perform this operation.\n-     * @param deadLetterOptions The options to specify when moving message to the deadletter sub-queue.\n-     * @param transactionContext in which this operation is taking part in. The transaction should be created first\n-     *     by {@link ServiceBusReceiverClient#createTransaction()} or\n-     *     {@link ServiceBusSenderClient#createTransaction()}.\n-     *\n-     * @throws NullPointerException if {@code message}, {@code transactionContext} or {@code\n-     *     transactionContext.transactionId} is null.\n+     * @param options to deadLetter the message. You can specify\n+     *     {@link DeadLetterOptions#setPropertiesToModify(Map) properties} to modify on the Message. The\n+     *     {@code transactionContext} can be set using\n+     *     {@link CompleteOptions#setTransactionContext(ServiceBusTransactionContext)}. The transaction should be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ab5217d38aaf4cfa5185b8d674c2e9e5cf34ce"}, "originalPosition": 161}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40430728921edda34575bb28495b62a814629e1e", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/40430728921edda34575bb28495b62a814629e1e", "committedDate": "2020-10-05T22:25:40Z", "message": "changed javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDY0NjY5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#pullrequestreview-502464669", "createdAt": "2020-10-05T22:29:03Z", "commit": {"oid": "40430728921edda34575bb28495b62a814629e1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDc1NjQx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15932#pullrequestreview-502475641", "createdAt": "2020-10-05T22:55:27Z", "commit": {"oid": "40430728921edda34575bb28495b62a814629e1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2239, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}