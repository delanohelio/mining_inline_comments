{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxNzgyOTU4", "number": 14891, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0ODoxMlrOEjfSHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0OTowOVrOEjfTng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjQ4MTU3OnYy", "diffSide": "RIGHT", "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0ODoxMlrOHR3bDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwODoxOTozOVrOHUC8Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NTg4NA==", "bodyText": "If no order needed, use Flux.mergeDelayError", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#discussion_r488495884", "createdAt": "2020-09-15T08:48:12Z", "author": {"login": "ChenTanyi"}, "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "diffHunk": "@@ -134,25 +132,34 @@ public String id() {\n                 this.name(),\n                 endpointUpdateParameters);\n \n-        Mono<CustomDomainInner> customDomainTask = Flux.fromIterable(this.deletedCustomDomainList)\n+        Flux<CustomDomainInner> customDomainCreateTask = Flux.fromIterable(this.customDomainList)\n+            .flatMapDelayError(itemToCreate -> this.parent().manager().inner().getCustomDomains().createAsync(\n+                this.parent().resourceGroupName(),\n+                this.parent().name(),\n+                this.name(),\n+                self.parent().manager().sdkContext().randomResourceName(\"CustomDomain\", 50),\n+                itemToCreate.hostname()\n+            ), 32, 32);\n+\n+        Flux<CustomDomainInner> customDomainDeleteTask = Flux.fromIterable(this.deletedCustomDomainList)\n             .flatMapDelayError(itemToDelete -> this.parent().manager().inner().getCustomDomains().deleteAsync(\n                 this.parent().resourceGroupName(),\n                 this.parent().name(),\n                 this.name(),\n                 itemToDelete.name()\n-            ), 32, 32)\n-            .last();\n+            ), 32, 32);\n \n-        return Flux.zip(originUpdateTask, endpointUpdateTask, customDomainTask)\n-            .last()\n-            .map(objects -> {\n-                self.setInner(objects.getT2());\n+        Flux<CustomDomainInner> customDomainTask = Flux.concat(customDomainCreateTask, customDomainDeleteTask);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc4MTcwMg==", "bodyText": "The concern to have concat came from Azure/azure-libraries-for-net#891. For safe, I just concat the custom domain tasks. For tasks of different resources, we can use merge.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#discussion_r490781702", "createdAt": "2020-09-18T08:19:39Z", "author": {"login": "xseeseesee"}, "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "diffHunk": "@@ -134,25 +132,34 @@ public String id() {\n                 this.name(),\n                 endpointUpdateParameters);\n \n-        Mono<CustomDomainInner> customDomainTask = Flux.fromIterable(this.deletedCustomDomainList)\n+        Flux<CustomDomainInner> customDomainCreateTask = Flux.fromIterable(this.customDomainList)\n+            .flatMapDelayError(itemToCreate -> this.parent().manager().inner().getCustomDomains().createAsync(\n+                this.parent().resourceGroupName(),\n+                this.parent().name(),\n+                this.name(),\n+                self.parent().manager().sdkContext().randomResourceName(\"CustomDomain\", 50),\n+                itemToCreate.hostname()\n+            ), 32, 32);\n+\n+        Flux<CustomDomainInner> customDomainDeleteTask = Flux.fromIterable(this.deletedCustomDomainList)\n             .flatMapDelayError(itemToDelete -> this.parent().manager().inner().getCustomDomains().deleteAsync(\n                 this.parent().resourceGroupName(),\n                 this.parent().name(),\n                 this.name(),\n                 itemToDelete.name()\n-            ), 32, 32)\n-            .last();\n+            ), 32, 32);\n \n-        return Flux.zip(originUpdateTask, endpointUpdateTask, customDomainTask)\n-            .last()\n-            .map(objects -> {\n-                self.setInner(objects.getT2());\n+        Flux<CustomDomainInner> customDomainTask = Flux.concat(customDomainCreateTask, customDomainDeleteTask);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NTg4NA=="}, "originalCommit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjQ4NTQyOnYy", "diffSide": "RIGHT", "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0OTowOVrOHR3dYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwOToxMToyNVrOHUEvIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NjQ4Mg==", "bodyText": "If no order needed, use Flux.mergeDelayError(customDomainTask.then(), originUpdateTask.then(), endpointUpdateTask), for parallel", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#discussion_r488496482", "createdAt": "2020-09-15T08:49:09Z", "author": {"login": "ChenTanyi"}, "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "diffHunk": "@@ -134,25 +132,34 @@ public String id() {\n                 this.name(),\n                 endpointUpdateParameters);\n \n-        Mono<CustomDomainInner> customDomainTask = Flux.fromIterable(this.deletedCustomDomainList)\n+        Flux<CustomDomainInner> customDomainCreateTask = Flux.fromIterable(this.customDomainList)\n+            .flatMapDelayError(itemToCreate -> this.parent().manager().inner().getCustomDomains().createAsync(\n+                this.parent().resourceGroupName(),\n+                this.parent().name(),\n+                this.name(),\n+                self.parent().manager().sdkContext().randomResourceName(\"CustomDomain\", 50),\n+                itemToCreate.hostname()\n+            ), 32, 32);\n+\n+        Flux<CustomDomainInner> customDomainDeleteTask = Flux.fromIterable(this.deletedCustomDomainList)\n             .flatMapDelayError(itemToDelete -> this.parent().manager().inner().getCustomDomains().deleteAsync(\n                 this.parent().resourceGroupName(),\n                 this.parent().name(),\n                 this.name(),\n                 itemToDelete.name()\n-            ), 32, 32)\n-            .last();\n+            ), 32, 32);\n \n-        return Flux.zip(originUpdateTask, endpointUpdateTask, customDomainTask)\n-            .last()\n-            .map(objects -> {\n-                self.setInner(objects.getT2());\n+        Flux<CustomDomainInner> customDomainTask = Flux.concat(customDomainCreateTask, customDomainDeleteTask);\n+\n+        return customDomainTask.then(originUpdateTask).then(endpointUpdateTask)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDgxMTE3MA==", "bodyText": "Updated.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#discussion_r490811170", "createdAt": "2020-09-18T09:11:25Z", "author": {"login": "xseeseesee"}, "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "diffHunk": "@@ -134,25 +132,34 @@ public String id() {\n                 this.name(),\n                 endpointUpdateParameters);\n \n-        Mono<CustomDomainInner> customDomainTask = Flux.fromIterable(this.deletedCustomDomainList)\n+        Flux<CustomDomainInner> customDomainCreateTask = Flux.fromIterable(this.customDomainList)\n+            .flatMapDelayError(itemToCreate -> this.parent().manager().inner().getCustomDomains().createAsync(\n+                this.parent().resourceGroupName(),\n+                this.parent().name(),\n+                this.name(),\n+                self.parent().manager().sdkContext().randomResourceName(\"CustomDomain\", 50),\n+                itemToCreate.hostname()\n+            ), 32, 32);\n+\n+        Flux<CustomDomainInner> customDomainDeleteTask = Flux.fromIterable(this.deletedCustomDomainList)\n             .flatMapDelayError(itemToDelete -> this.parent().manager().inner().getCustomDomains().deleteAsync(\n                 this.parent().resourceGroupName(),\n                 this.parent().name(),\n                 this.name(),\n                 itemToDelete.name()\n-            ), 32, 32)\n-            .last();\n+            ), 32, 32);\n \n-        return Flux.zip(originUpdateTask, endpointUpdateTask, customDomainTask)\n-            .last()\n-            .map(objects -> {\n-                self.setInner(objects.getT2());\n+        Flux<CustomDomainInner> customDomainTask = Flux.concat(customDomainCreateTask, customDomainDeleteTask);\n+\n+        return customDomainTask.then(originUpdateTask).then(endpointUpdateTask)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NjQ4Mg=="}, "originalCommit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "originalPosition": 93}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1211, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}