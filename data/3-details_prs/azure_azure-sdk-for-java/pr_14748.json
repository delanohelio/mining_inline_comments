{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4MjAwNjc1", "number": 14748, "title": "Fix timeout exceptions when using tcnative", "bodyText": "Issue: #7829\nRoot cause:\nThere are some implementation difference between OpenSslEngine and JDKSslEngine. When enabling tcnative-boringssl, what has been found is that in the inbound bytebuf, there could be several responses unwrapped. So this issue is caused by combination of  multipleResponseUnwrapped + discardReadBytes + using of slice of the bytebuf.\n\nmultiple response is unwrapped in the same bytebuf (A, B, C)\nRntbdResponse.decode-> slice of the bytebuf (which is a view of the subregion)\nRntbdResponse.discardReadBytes -> reset the readerIndex/writerIndex of the bytebuf. This might involve extra memory copy around.\nRntbdRequestManager.getTransportRequestId -> The transportRequestId returned is B's transportRequestId , complete B, A got requestTimeoutException.\n\nPossible Solutions:\n\nRemove discardReadBytes\nEnable jdkCompatibilityMode -> this PR\nDo not use slice of the bytebuf\n\nTest Results:", "createdAt": "2020-09-02T22:00:05Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748", "merged": true, "mergeCommit": {"oid": "df5a8f46f44351fdad364702ec4ef2bad2a04566"}, "closed": true, "closedAt": "2020-09-03T21:47:27Z", "author": {"login": "xinlian12"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEqDqqgH2gAyNDc4MjAwNjc1OmI0MjIzMGVlZmQwZWM2NmI2MzM3OGQ1MmFkZGY3ODA1ZDMwZDMwYTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFXf0vAFqTQ4MjIxMzMxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b42230eefd0ec66b63378d52addf7805d30d30a3", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b42230eefd0ec66b63378d52addf7805d30d30a3", "committedDate": "2020-09-01T16:32:57Z", "message": "enable tcnative"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b772d6e51e95d340e6440953e31722d1c267515", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0b772d6e51e95d340e6440953e31722d1c267515", "committedDate": "2020-09-01T19:28:09Z", "message": "Merge branch 'master' into enableTcnative"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8530c0a9a9870c76ab30d39dfc5330415d215b2", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e8530c0a9a9870c76ab30d39dfc5330415d215b2", "committedDate": "2020-09-02T02:14:49Z", "message": "Merge branch 'master' into enableTcnative"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63b216f73a1d3d982d4d3f7d21705a919bcc574d", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/63b216f73a1d3d982d4d3f7d21705a919bcc574d", "committedDate": "2020-09-02T04:09:32Z", "message": "enable jdk compatile mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37488f6d1df4748fe43d6c2f6fa970ddb450fa67", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/37488f6d1df4748fe43d6c2f6fa970ddb450fa67", "committedDate": "2020-09-02T04:23:27Z", "message": "add log"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4ff870fb5984ad246f76a98f9a22374f62a8483", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c4ff870fb5984ad246f76a98f9a22374f62a8483", "committedDate": "2020-09-02T04:47:43Z", "message": "Merge branch 'master' into enableTcnativeJdkCompatibleMode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfa4003c30e07611a814f6689623e3a5ac39fd92", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bfa4003c30e07611a814f6689623e3a5ac39fd92", "committedDate": "2020-09-02T21:47:37Z", "message": "add comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfae00f2e372f2e10e81fde65e03f74397e14548", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dfae00f2e372f2e10e81fde65e03f74397e14548", "committedDate": "2020-09-02T21:48:34Z", "message": "Merge branch 'master' into enableOpensslJdkCompatibleMode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e01395d61e73d40df881414caa17c282e58d9634", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e01395d61e73d40df881414caa17c282e58d9634", "committedDate": "2020-09-02T21:56:06Z", "message": "fix for issue relates to tcnative"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMzM0NzQy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748#pullrequestreview-481334742", "createdAt": "2020-09-02T22:07:53Z", "commit": {"oid": "e01395d61e73d40df881414caa17c282e58d9634"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMzM1MjA2", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748#pullrequestreview-481335206", "createdAt": "2020-09-02T22:09:01Z", "commit": {"oid": "e01395d61e73d40df881414caa17c282e58d9634"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMjowOTowMlrOHMK4VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMjowOTowMlrOHMK4VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyMzIyMQ==", "bodyText": "please update azure-cosmos and remove the explicit exclusion. This library is a dependency of azure-core we don't need to have explicit dependency on it.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748#discussion_r482523221", "createdAt": "2020-09-02T22:09:02Z", "author": {"login": "moderakh"}, "path": "sdk/cosmos/azure-cosmos-benchmark/pom.xml", "diffHunk": "@@ -88,14 +88,11 @@ Licensed under the MIT License.\n       <version>1.5.4</version> <!-- {x-version-update;io.micrometer:micrometer-registry-graphite;external_dependency} -->\n     </dependency>\n \n-    <!-- Issue: We have a problem with Direct TCP with using netty-tcnative when OpenSSL 1.1 is installed\n     <dependency>\n       <groupId>io.netty</groupId>\n-      <artifactId>netty-tcnative</artifactId>\n-      <version>2.0.31.Final</version> {x-version-update;io.netty:netty-tcnative;external_dependency}\n-      <classifier>linux-x86_64</classifier>\n+      <artifactId>netty-tcnative-boringssl-static</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e01395d61e73d40df881414caa17c282e58d9634"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a17aac2db788ea9328800e4510a100aac4b728be", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a17aac2db788ea9328800e4510a100aac4b728be", "committedDate": "2020-09-02T23:39:55Z", "message": "remove exclusions of tcnative from the pom files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMzk2MzUx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748#pullrequestreview-481396351", "createdAt": "2020-09-03T00:16:21Z", "commit": {"oid": "a17aac2db788ea9328800e4510a100aac4b728be"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMjEzMzE2", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748#pullrequestreview-482213316", "createdAt": "2020-09-03T21:24:30Z", "commit": {"oid": "a17aac2db788ea9328800e4510a100aac4b728be"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMToyNDozMVrOHM3-ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMToyNDozMVrOHM3-ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI2MjEzOA==", "bodyText": "Does boring ssl get brought in now that we've removed the exclusion from azure-cosmos/pom.xml? If so then this is good. If not, consider bringing in boring ssl for all platforms here. It should make running the benchmark program easier (build once, run everywhere without installing OpenSSL)", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14748#discussion_r483262138", "createdAt": "2020-09-03T21:24:31Z", "author": {"login": "David-Noble-at-work"}, "path": "sdk/cosmos/azure-cosmos-benchmark/pom.xml", "diffHunk": "@@ -88,15 +88,6 @@ Licensed under the MIT License.\n       <version>1.5.4</version> <!-- {x-version-update;io.micrometer:micrometer-registry-graphite;external_dependency} -->\n     </dependency>\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a17aac2db788ea9328800e4510a100aac4b728be"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4841, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}