{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxNzgyOTU4", "number": 14891, "title": "mgmt support azure-resourcemanager-cdn", "bodyText": "", "createdAt": "2020-09-08T05:24:28Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891", "merged": true, "mergeCommit": {"oid": "2518416272019a7bbd19f75b34ab646f48c736b7"}, "closed": true, "closedAt": "2020-09-21T02:13:07Z", "author": {"login": "xseeseesee"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGekPXgH2gAyNDgxNzgyOTU4OjZhNWIyM2VhNzJhNjYyYTdlZTA4YWEwNDQ0ZDRkYTgxNTk4OWIwMDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKCgX_gFqTQ5MTMxNzQ5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6a5b23ea72a662a7ee08aa0444d4da815989b002", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6a5b23ea72a662a7ee08aa0444d4da815989b002", "committedDate": "2020-09-07T08:17:31Z", "message": "copy cdn from azure-libraries-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd9da5fba5154a3e05344ae5374537c8b6e7019b", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bd9da5fba5154a3e05344ae5374537c8b6e7019b", "committedDate": "2020-09-07T08:29:07Z", "message": "restructure cdn before generating code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93c339e9ee18c702f45bc3113be0fccb8e68fb25", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/93c339e9ee18c702f45bc3113be0fccb8e68fb25", "committedDate": "2020-09-07T08:29:36Z", "message": "update versioning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a49ebea04a8c4eee44e900cddab2b938c5126cab", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a49ebea04a8c4eee44e900cddab2b938c5126cab", "committedDate": "2020-09-07T08:30:19Z", "message": "update api-specs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8008330bb5fb9e0c711ce8cc562c4c99bf9a424", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e8008330bb5fb9e0c711ce8cc562c4c99bf9a424", "committedDate": "2020-09-07T08:33:27Z", "message": "generate cdn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "165d4b9c4338af8b41f38ddfbd6975d41f7d6b3e", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/165d4b9c4338af8b41f38ddfbd6975d41f7d6b3e", "committedDate": "2020-09-08T05:14:49Z", "message": "manual change for naming conflict by generated code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6d4027a23e44c07c2d6346adba2de81e353eac", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1e6d4027a23e44c07c2d6346adba2de81e353eac", "committedDate": "2020-09-08T05:15:20Z", "message": "fix compile errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eabb497cf1a90d14e5f8ebc3b7061239bbe2bbb6", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/eabb497cf1a90d14e5f8ebc3b7061239bbe2bbb6", "committedDate": "2020-09-08T05:24:10Z", "message": "move client and builder into fluent package"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2NDMzNjcz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#pullrequestreview-486433673", "createdAt": "2020-09-11T02:34:43Z", "commit": {"oid": "eabb497cf1a90d14e5f8ebc3b7061239bbe2bbb6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2b6507a465e18d541f14cb95c247b1e624c250dd", "committedDate": "2020-09-11T04:43:25Z", "message": "add tests and samples for cdn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3529134b62bbaf14d83ae2ade9f596d7094bc27", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d3529134b62bbaf14d83ae2ade9f596d7094bc27", "committedDate": "2020-09-11T04:48:57Z", "message": "regenerate cdn after updating generator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afec02ad4a3e90d49d5368c09d7d04df4a2fef1e", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/afec02ad4a3e90d49d5368c09d7d04df4a2fef1e", "committedDate": "2020-09-11T04:51:41Z", "message": "manual fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb13cf339477fc4c59da0fba040917dc666255f3", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fb13cf339477fc4c59da0fba040917dc666255f3", "committedDate": "2020-09-11T04:53:20Z", "message": "Merge branch 'master' into add-mgmt-cdn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f9f365f2762fa2dfe04938d0c6b5ca9e2015a57", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2f9f365f2762fa2dfe04938d0c6b5ca9e2015a57", "committedDate": "2020-09-11T04:54:55Z", "message": "update test dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5651b512a315fbf9fea61fb5da3b302a16e5998", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c5651b512a315fbf9fea61fb5da3b302a16e5998", "committedDate": "2020-09-15T03:25:11Z", "message": "Merge branch 'master' into add-mgmt-cdn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "609479069ef07e170427e4b77218d32718bc3f76", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/609479069ef07e170427e4b77218d32718bc3f76", "committedDate": "2020-09-15T07:26:28Z", "message": "mgmt cdn add live only test and update ci.yml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NDYyODg4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#pullrequestreview-488462888", "createdAt": "2020-09-15T08:48:12Z", "commit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0ODoxMlrOHR3bDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0ODoxMlrOHR3bDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NTg4NA==", "bodyText": "If no order needed, use Flux.mergeDelayError", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#discussion_r488495884", "createdAt": "2020-09-15T08:48:12Z", "author": {"login": "ChenTanyi"}, "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "diffHunk": "@@ -134,25 +132,34 @@ public String id() {\n                 this.name(),\n                 endpointUpdateParameters);\n \n-        Mono<CustomDomainInner> customDomainTask = Flux.fromIterable(this.deletedCustomDomainList)\n+        Flux<CustomDomainInner> customDomainCreateTask = Flux.fromIterable(this.customDomainList)\n+            .flatMapDelayError(itemToCreate -> this.parent().manager().inner().getCustomDomains().createAsync(\n+                this.parent().resourceGroupName(),\n+                this.parent().name(),\n+                this.name(),\n+                self.parent().manager().sdkContext().randomResourceName(\"CustomDomain\", 50),\n+                itemToCreate.hostname()\n+            ), 32, 32);\n+\n+        Flux<CustomDomainInner> customDomainDeleteTask = Flux.fromIterable(this.deletedCustomDomainList)\n             .flatMapDelayError(itemToDelete -> this.parent().manager().inner().getCustomDomains().deleteAsync(\n                 this.parent().resourceGroupName(),\n                 this.parent().name(),\n                 this.name(),\n                 itemToDelete.name()\n-            ), 32, 32)\n-            .last();\n+            ), 32, 32);\n \n-        return Flux.zip(originUpdateTask, endpointUpdateTask, customDomainTask)\n-            .last()\n-            .map(objects -> {\n-                self.setInner(objects.getT2());\n+        Flux<CustomDomainInner> customDomainTask = Flux.concat(customDomainCreateTask, customDomainDeleteTask);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "originalPosition": 91}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NDYzNjM3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#pullrequestreview-488463637", "createdAt": "2020-09-15T08:49:09Z", "commit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0OTowOVrOHR3dYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo0OTowOVrOHR3dYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ5NjQ4Mg==", "bodyText": "If no order needed, use Flux.mergeDelayError(customDomainTask.then(), originUpdateTask.then(), endpointUpdateTask), for parallel", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#discussion_r488496482", "createdAt": "2020-09-15T08:49:09Z", "author": {"login": "ChenTanyi"}, "path": "sdk/resourcemanager/azure-resourcemanager-cdn/src/main/java/com/azure/resourcemanager/cdn/implementation/CdnEndpointImpl.java", "diffHunk": "@@ -134,25 +132,34 @@ public String id() {\n                 this.name(),\n                 endpointUpdateParameters);\n \n-        Mono<CustomDomainInner> customDomainTask = Flux.fromIterable(this.deletedCustomDomainList)\n+        Flux<CustomDomainInner> customDomainCreateTask = Flux.fromIterable(this.customDomainList)\n+            .flatMapDelayError(itemToCreate -> this.parent().manager().inner().getCustomDomains().createAsync(\n+                this.parent().resourceGroupName(),\n+                this.parent().name(),\n+                this.name(),\n+                self.parent().manager().sdkContext().randomResourceName(\"CustomDomain\", 50),\n+                itemToCreate.hostname()\n+            ), 32, 32);\n+\n+        Flux<CustomDomainInner> customDomainDeleteTask = Flux.fromIterable(this.deletedCustomDomainList)\n             .flatMapDelayError(itemToDelete -> this.parent().manager().inner().getCustomDomains().deleteAsync(\n                 this.parent().resourceGroupName(),\n                 this.parent().name(),\n                 this.name(),\n                 itemToDelete.name()\n-            ), 32, 32)\n-            .last();\n+            ), 32, 32);\n \n-        return Flux.zip(originUpdateTask, endpointUpdateTask, customDomainTask)\n-            .last()\n-            .map(objects -> {\n-                self.setInner(objects.getT2());\n+        Flux<CustomDomainInner> customDomainTask = Flux.concat(customDomainCreateTask, customDomainDeleteTask);\n+\n+        return customDomainTask.then(originUpdateTask).then(endpointUpdateTask)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b6507a465e18d541f14cb95c247b1e624c250dd"}, "originalPosition": 93}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95aaf0e4c7f5d60c1fc6e07d54ab8499db745448", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/95aaf0e4c7f5d60c1fc6e07d54ab8499db745448", "committedDate": "2020-09-18T09:00:49Z", "message": "update cdn endpoint updateResourceAsync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30c0775d5ac862d934282a4439e42d9c9256553c", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/30c0775d5ac862d934282a4439e42d9c9256553c", "committedDate": "2020-09-18T09:06:26Z", "message": "regenerate code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d502b80dbe27fe2621f0eb542c797375058b6e4", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/3d502b80dbe27fe2621f0eb542c797375058b6e4", "committedDate": "2020-09-18T09:10:40Z", "message": "remove azure-resourcemanager-test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "700ee1230300a3c7416ab635355b2620f4b4e90a", "author": {"user": {"login": "xseeseesee", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/700ee1230300a3c7416ab635355b2620f4b4e90a", "committedDate": "2020-09-18T09:23:28Z", "message": "clear customDomainList after cdn endpoint update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMzE3NDkz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14891#pullrequestreview-491317493", "createdAt": "2020-09-18T09:51:39Z", "commit": {"oid": "700ee1230300a3c7416ab635355b2620f4b4e90a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3655, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}