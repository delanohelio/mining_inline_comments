{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExMzg0NDg1", "number": 10637, "title": "Add support for associated link name, session id, and clean up ManagementNode", "bodyText": "Feature changes\n\nRemoves sessionId from createManagementNode. Multi-session deals with many session ids, we don't want to create a different management node for each session id.\nAdds support for associating the link name.\nMoves lastPeekedSequence into receiver. The receiver can peek different messages depending on its sessionId, this will result in the incorrectly mapped sequence number if we use peek() or peekBatch(int).\nCleans up ManagementNode by using overloads and reducing the number of interface methods.\nAdds tests.\n\nBug fixes\n\nFixes bug where management node by its key was not properly returned.\nFixes bug where session'd entity operations were not correct on management node.\n\nPart of a larger PR for multi-sessioned support. Related to #10183", "createdAt": "2020-04-30T11:45:50Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10637", "merged": true, "mergeCommit": {"oid": "bfad69cc0b736c4015019dac9d8fb9dbc8ef1d06"}, "closed": true, "closedAt": "2020-04-30T20:32:04Z", "author": {"login": "conniey"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccyW91AFqTQwMzgxOTg4MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccyriPABqjMyOTExMjE1NDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzODE5ODgw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10637#pullrequestreview-403819880", "createdAt": "2020-04-30T19:36:17Z", "commit": {"oid": "e79698d480073ed07d40403293f5e872ad530079"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxOTozNjoxOFrOGO3ifw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxOTozNjoxOFrOGO3ifw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI0MzE5OQ==", "bodyText": "Another error case : Where user pass in a session id which is not equal to current active session id.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10637#discussion_r418243199", "createdAt": "2020-04-30T19:36:18Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/test/java/com/azure/messaging/servicebus/implementation/ManagementChannelTests.java", "diffHunk": "@@ -117,11 +137,9 @@ void teardown(TestInfo testInfo) {\n     void setsSessionState(byte[] state) {\n         // Arrange\n         final String sessionId = \"A session-id\";\n-        managementChannel = new ManagementChannel(Mono.just(requestResponseChannel), NAMESPACE, ENTITY_PATH, sessionId,\n-            tokenManager, messageSerializer, Duration.ofSeconds(10));\n \n         // Act\n-        StepVerifier.create(managementChannel.setSessionState(state))\n+        StepVerifier.create(managementChannel.setSessionState(sessionId, state, LINK_NAME))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e79698d480073ed07d40403293f5e872ad530079"}, "originalPosition": 109}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzODIyOTQ4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10637#pullrequestreview-403822948", "createdAt": "2020-04-30T19:41:01Z", "commit": {"oid": "e79698d480073ed07d40403293f5e872ad530079"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ada83121848d8c19017d34427ac9601008e4049d", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/ada83121848d8c19017d34427ac9601008e4049d", "committedDate": "2020-04-30T19:56:29Z", "message": "Initial changes to management node."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20cbf078da98d9e7c216aa581facb5e7866323b8", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/20cbf078da98d9e7c216aa581facb5e7866323b8", "committedDate": "2020-04-30T19:56:29Z", "message": "Cleaning up ManagementNode interface. Adding session and associated link."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dd86f485e2d0ae99078a0d3e1b682e76d2f787f", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2dd86f485e2d0ae99078a0d3e1b682e76d2f787f", "committedDate": "2020-04-30T19:56:29Z", "message": "Fixing client and test breaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a16b34b9e453ac53ae1001e226d2a658cc5fece6", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a16b34b9e453ac53ae1001e226d2a658cc5fece6", "committedDate": "2020-04-30T19:56:29Z", "message": "Fixing bug where correct management node not returned."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2bb18cd593fc311df2cf3e311c044b5867bd584", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f2bb18cd593fc311df2cf3e311c044b5867bd584", "committedDate": "2020-04-30T19:56:29Z", "message": "Move single call ManagementChannel method back into parent method."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e803ee32b05183b1552efdd847c8452755e81272", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e803ee32b05183b1552efdd847c8452755e81272", "committedDate": "2020-04-30T19:56:29Z", "message": "Adding logging and test case for peaked messages."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f342013f7ba621f39e1350d963bf5162d59942e", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6f342013f7ba621f39e1350d963bf5162d59942e", "committedDate": "2020-04-30T19:56:29Z", "message": "Adding key x-opt-enqueue-sequence-number."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6c127ae8d58abb13ebacbc81dba643671fb9a25", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b6c127ae8d58abb13ebacbc81dba643671fb9a25", "committedDate": "2020-04-30T19:56:30Z", "message": "Fixing log comment."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e79698d480073ed07d40403293f5e872ad530079", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e79698d480073ed07d40403293f5e872ad530079", "committedDate": "2020-04-30T17:42:39Z", "message": "Fixing log comment."}, "afterCommit": {"oid": "b6c127ae8d58abb13ebacbc81dba643671fb9a25", "author": {"user": {"login": "conniey", "name": "Connie Yau"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b6c127ae8d58abb13ebacbc81dba643671fb9a25", "committedDate": "2020-04-30T19:56:30Z", "message": "Fixing log comment."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4469, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}