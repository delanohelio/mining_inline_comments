{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2Mzg2MzU2", "number": 13992, "title": "Update FieldBuilder and MemberNameConverter", "bodyText": "This PR updates the azure-core-serializer-json-jackson implementation of MemberNameConverter to be more restrictive when dealing with Methods. FieldBuilder has been updated to look at both Fields and Methods as both are supported by MemberNameConverter. Additionally, due to needing to supporting both Field and Method Search annotations for FieldBuilder can now be applied to either.", "createdAt": "2020-08-11T22:21:19Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992", "merged": true, "mergeCommit": {"oid": "b099d020e5b12e865d26e36a42b57c8f95f70638"}, "closed": true, "closedAt": "2020-08-12T05:00:40Z", "author": {"login": "alzimmermsft"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9qEU2AH2gAyNDY2Mzg2MzU2OjJlN2FmNTFmOTdkZTlmMjJjOTI5ZmYwODhjZDA2MDljYmZlYTEzMTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-AjiOAH2gAyNDY2Mzg2MzU2OjljYjdmMWU1OTM5MzJlYTJhOWZiYTFmMDg3MWU3YzQ2M2ZiYTdiNGU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e7af51f97de9f22c929ff088cd0609cbfea1312", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2e7af51f97de9f22c929ff088cd0609cbfea1312", "committedDate": "2020-08-10T22:36:12Z", "message": "Update JacksonJsonSerializer's MemberNameConverter implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a47c0576602193a9d6187fc70de5c1c0a83b42b", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/4a47c0576602193a9d6187fc70de5c1c0a83b42b", "committedDate": "2020-08-10T23:53:13Z", "message": "Update FieldBuilderOptions to take JsonSerializer instead of MemberNameConverter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f737b1585f965fa9a2fafce39f3c72b14392564", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7f737b1585f965fa9a2fafce39f3c72b14392564", "committedDate": "2020-08-11T18:42:25Z", "message": "Merge branch 'master' into AzCore_FinalizeMemberNameConverter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f9438bac3c4d736cb41ac4eeef53e0e1b844c83", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5f9438bac3c4d736cb41ac4eeef53e0e1b844c83", "committedDate": "2020-08-11T22:19:04Z", "message": "Update FieldBuilder to check both Fields and Methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23a35540a142efd2576a7ed7830a17f3747b6524", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/23a35540a142efd2576a7ed7830a17f3747b6524", "committedDate": "2020-08-11T22:36:18Z", "message": "Resolve conflict"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NDc5NzEw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#pullrequestreview-465479710", "createdAt": "2020-08-11T22:48:41Z", "commit": {"oid": "23a35540a142efd2576a7ed7830a17f3747b6524"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMjo0ODo0MVrOG_L0uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMjo1MDoxOVrOG_L3Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwNzE5Mg==", "bodyText": "It would be useful log a warning if the method has any annotation but is non-public. It will let the users know that the visibility of the method is the reason for ignoring it. Same for field too.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#discussion_r468907192", "createdAt": "2020-08-11T22:48:41Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core-serializer-json-jackson/src/main/java/com/azure/core/serializer/json/jackson/JacksonJsonSerializer.java", "diffHunk": "@@ -82,36 +84,70 @@ public String convertMemberName(Member member) {\n         if (Modifier.isTransient(member.getModifiers())) {\n             return null;\n         }\n+\n+        VisibilityChecker<?> visibilityChecker = mapper.getVisibilityChecker();\n         if (member instanceof Field) {\n             Field f = (Field) member;\n-            if (f.isAnnotationPresent(JsonIgnore.class)) {\n+\n+            if (f.isAnnotationPresent(JsonIgnore.class) || !visibilityChecker.isFieldVisible(f)) {\n                 return null;\n             }\n+\n             if (f.isAnnotationPresent(JsonProperty.class)) {\n                 String propertyName = f.getDeclaredAnnotation(JsonProperty.class).value();\n                 return CoreUtils.isNullOrEmpty(propertyName) ? f.getName() : propertyName;\n             }\n+\n             return f.getName();\n         }\n \n         if (member instanceof Method) {\n             Method m = (Method) member;\n-            String methodNameWithoutJavaBeans = removePrefix(m);\n-            if (m.isAnnotationPresent(JsonIgnore.class)) {\n+\n+            /*\n+             * If the method isn't a getter, is annotated with JsonIgnore, or isn't visible to the ObjectMapper ignore\n+             * it.\n+             */\n+            if (!verifyGetter(m)\n+                || m.isAnnotationPresent(JsonIgnore.class)\n+                || !visibilityChecker.isGetterVisible(m)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23a35540a142efd2576a7ed7830a17f3747b6524"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkwNzc4Nw==", "bodyText": "Was this intended? Seems like random string in the javadoc.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13992#discussion_r468907787", "createdAt": "2020-08-11T22:50:19Z", "author": {"login": "srnagar"}, "path": "sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/SearchClient.java", "diffHunk": "@@ -39,7 +39,7 @@\n \n     /**\n      * Package private constructor to be used by {@link SearchClientBuilder}\n-     *\n+     *classWithGettersWithAnnotations", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23a35540a142efd2576a7ed7830a17f3747b6524"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fa5795c546eab60ae46fe762b037a93a1655f2c", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/4fa5795c546eab60ae46fe762b037a93a1655f2c", "committedDate": "2020-08-12T00:37:37Z", "message": "Merge branch 'master' into AzCore_FinalizeMemberNameConverter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e86ababe7f9abacc840772284cb20aef0d391fe1", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e86ababe7f9abacc840772284cb20aef0d391fe1", "committedDate": "2020-08-12T00:41:14Z", "message": "Add logging when the Field or Method isn't accessible to the MemberNameConverter but has annotations to serialize it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cb7f1e593932ea2a9fba1f0871e7c463fba7b4e", "author": {"user": {"login": "alzimmermsft", "name": "Alan Zimmer"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9cb7f1e593932ea2a9fba1f0871e7c463fba7b4e", "committedDate": "2020-08-12T00:48:12Z", "message": "Update Field logger message"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 584, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}