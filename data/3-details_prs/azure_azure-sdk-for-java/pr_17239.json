{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2Mzk0NzI2", "number": 17239, "title": "Share enable protocol", "bodyText": "", "createdAt": "2020-11-05T23:13:24Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239", "merged": true, "mergeCommit": {"oid": "7424373e84bbc3d51f9b058949d9ed5158f357e5"}, "closed": true, "closedAt": "2020-11-07T00:25:33Z", "author": {"login": "rickle-msft"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZp0uDAH2gAyNTE2Mzk0NzI2OmJlMTI5M2E5YzIzYjM2NWMzNmFkZmRlMGIyZDNkOWMxMjk1YmU5ZWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZ-L3agH2gAyNTE2Mzk0NzI2OjA5NTYxMzg0NWUyNGMwM2JjZWFlNDY3NGIzMDgxODRkODdiZTJlMTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be1293a9c23b365c36adfde0b2d3d9c1295be9ef", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/be1293a9c23b365c36adfde0b2d3d9c1295be9ef", "committedDate": "2020-11-05T22:09:02Z", "message": "Added share enabled protocols and tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f2f275995de08b6ac5fce879f8641552f5afb108", "committedDate": "2020-11-05T23:11:12Z", "message": "Updated generated code with internal types"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NzQ4NjE3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-524748617", "createdAt": "2020-11-05T23:20:08Z", "commit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyMDowOVrOHuabNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyMDowOVrOHuabNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQyOTQ5Mw==", "bodyText": "Can we just do ShareEnabledProtocol.parse(protocol)", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#discussion_r518429493", "createdAt": "2020-11-05T23:20:09Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-file-share/src/test/java/com/azure/storage/file/share/ShareAPITests.groovy", "diffHunk": "@@ -313,9 +316,21 @@ class ShareAPITests extends APISpec {\n         FileTestHelper.assertExceptionStatusCodeAndMessage(e, 404, ShareErrorCode.SHARE_NOT_FOUND)\n     }\n \n+    @Unroll\n     def \"Get properties premium\"() {\n         given:\n-        def premiumShareClient = premiumFileServiceClient.createShareWithResponse(generateShareName(), testMetadata, null, null, null).getValue()\n+        ShareEnabledProtocol enabledProtocol = new ShareEnabledProtocol()\n+        if (Constants.HeaderConstants.SMB_PROTOCOL == protocol) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "originalPosition": 104}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NzQ4OTAx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-524748901", "createdAt": "2020-11-05T23:20:49Z", "commit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyMDo1MFrOHuacFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyMDo1MFrOHuacFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQyOTcxOQ==", "bodyText": "Same comment as above", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#discussion_r518429719", "createdAt": "2020-11-05T23:20:50Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-file-share/src/test/java/com/azure/storage/file/share/ShareAsyncAPITests.groovy", "diffHunk": "@@ -190,9 +193,20 @@ class ShareAsyncAPITests extends APISpec {\n             }\n     }\n \n+    @Unroll\n     def \"Get properties premium\"() {\n         given:\n-        def premiumShare = premiumFileServiceAsyncClient.createShareWithResponse(generateShareName(), testMetadata, null).block().getValue()\n+        ShareEnabledProtocol enabledProtocol = new ShareEnabledProtocol()\n+        if (Constants.HeaderConstants.SMB_PROTOCOL == protocol) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NzQ5MTc2", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-524749176", "createdAt": "2020-11-05T23:21:22Z", "commit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyMToyM1rOHuadAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyMToyM1rOHuadAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQyOTk1Mw==", "bodyText": "Reminder to revert this when merged", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#discussion_r518429953", "createdAt": "2020-11-05T23:21:23Z", "author": {"login": "gapra-msft"}, "path": "sdk/storage/azure-storage-file-share/swagger/README.md", "diffHunk": "@@ -15,7 +15,7 @@ autorest --use=@microsoft.azure/autorest.java@3.0.4 --use=jianghaolu/autorest.mo\n \n ### Code generation settings\n ``` yaml\n-input-file: https://raw.githubusercontent.com/Azure/azure-rest-api-specs/storage-dataplane-preview/specification/storage/data-plane/Microsoft.FileStorage/preview/2020-02-10/file.json\n+input-file: https://raw.githubusercontent.com/seanmcc-msft/azure-rest-api-specs/feature/storage/shareEnableProtocolShareSquashRoot/specification/storage/data-plane/Microsoft.FileStorage/preview/2020-04-08/file.json", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NzUxNjYw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-524751660", "createdAt": "2020-11-05T23:26:56Z", "commit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyNjo1NlrOHuak5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMzoyNjo1NlrOHuak5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQzMTk3NQ==", "bodyText": "should this be named ShareEnabledProtocols ? As far as I understand one can have multiple of them enabled when this \"enum\" expands.\nI'd rather use enum and EnumSet to model this. See https://github.com/Azure/azure-sdk-for-java/blob/4da5d307be3b618c7c989e76b13cf1e96e9dbb17/sdk/storage/azure-storage-file-share/src/main/java/com/azure/storage/file/share/models/NtfsFileAttributes.java for example.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#discussion_r518431975", "createdAt": "2020-11-05T23:26:56Z", "author": {"login": "kasobol-msft"}, "path": "sdk/storage/azure-storage-file-share/src/main/java/com/azure/storage/file/share/models/ShareEnabledProtocol.java", "diffHunk": "@@ -0,0 +1,75 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.storage.file.share.models;\n+\n+import com.azure.storage.common.implementation.Constants;\n+\n+/**\n+ * Represents protocols that can be set on a share.\n+ */\n+public class ShareEnabledProtocol {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2f275995de08b6ac5fce879f8641552f5afb108"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80d9064ebfdc1d82df1021e0fd3b44378af79d41", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/80d9064ebfdc1d82df1021e0fd3b44378af79d41", "committedDate": "2020-11-05T23:57:48Z", "message": "PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fac78cc1563e61c5c88c9842e181f330255aacec", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fac78cc1563e61c5c88c9842e181f330255aacec", "committedDate": "2020-11-06T00:21:47Z", "message": "Forgot to commit some new files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6070ec2021b718cbcc4b21843161816307b97bd9", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6070ec2021b718cbcc4b21843161816307b97bd9", "committedDate": "2020-11-06T00:38:16Z", "message": "Updated test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0ODM4ODE0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-524838814", "createdAt": "2020-11-06T03:48:52Z", "commit": {"oid": "6070ec2021b718cbcc4b21843161816307b97bd9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MjkxMzQ1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-525291345", "createdAt": "2020-11-06T16:08:21Z", "commit": {"oid": "6070ec2021b718cbcc4b21843161816307b97bd9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c136c81acf0be6d54dbffeabba1367bbf1c670ee", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c136c81acf0be6d54dbffeabba1367bbf1c670ee", "committedDate": "2020-11-06T20:43:56Z", "message": "Fix analyze step"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NDg3MjQ3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#pullrequestreview-525487247", "createdAt": "2020-11-06T20:54:42Z", "commit": {"oid": "c136c81acf0be6d54dbffeabba1367bbf1c670ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQyMDo1NDo0M1rOHu9QgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQyMDo1NDo0M1rOHu9QgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTAwMDE5Mg==", "bodyText": "@rickle-msft FYI this discussion here is still developing Azure/azure-sdk-for-net#16123 (comment) . We might need to loosen this validation if it turns out that new protocols can be returned with old service version in the future.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17239#discussion_r519000192", "createdAt": "2020-11-06T20:54:43Z", "author": {"login": "kasobol-msft"}, "path": "sdk/storage/azure-storage-file-share/src/main/java/com/azure/storage/file/share/models/ShareEnabledProtocols.java", "diffHunk": "@@ -0,0 +1,88 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.storage.file.share.models;\n+\n+import com.azure.storage.common.implementation.Constants;\n+\n+/**\n+ * Represents protocols that can be set on a share.\n+ */\n+public class ShareEnabledProtocols {\n+\n+    private boolean smb;\n+\n+    private boolean nfs;\n+\n+    /**\n+     * @return Enable SMB\n+     */\n+    public boolean isSmb() {\n+        return smb;\n+    }\n+\n+    /**\n+     * @return Enable NFS\n+     */\n+    public boolean isNfs() {\n+        return nfs;\n+    }\n+\n+    /**\n+     * @param smb Enable SMB\n+     * @return The updated object\n+     */\n+    public ShareEnabledProtocols setSmb(boolean smb) {\n+        this.smb = smb;\n+        return this;\n+    }\n+\n+    /**\n+     * @param nfs Enable NFS\n+     * @return The updated object\n+     */\n+    public ShareEnabledProtocols setNfs(boolean nfs) {\n+        this.nfs = nfs;\n+        return this;\n+    }\n+\n+    /**\n+     * Converts the given protocols to a {@code String}.\n+     *\n+     * @return A {@code String} which represents the enabled protocols.\n+     * @throws IllegalArgumentException If both SMB and NFS are set.\n+     */\n+    public String toString() {\n+        if (this.smb) {\n+            if (this.nfs) {\n+                throw new IllegalArgumentException(\"SMB and NFS cannot both be set.\");\n+            }\n+            return Constants.HeaderConstants.SMB_PROTOCOL;\n+        }\n+        if (this.nfs) {\n+            return Constants.HeaderConstants.NFS_PROTOCOL;\n+        }\n+        return null;\n+    }\n+\n+    /**\n+     * Parses a {@code String} into a {@code SharEnabledProtocol}.\n+     *\n+     * @param str The string to parse.\n+     * @return A {@code ShareEnabledProtocol} represented by the string.\n+     * @throws IllegalArgumentException If the String is not a recognized protocol.\n+     */\n+    public static ShareEnabledProtocols parse(String str) {\n+        if (str == null) {\n+            return null;\n+        }\n+\n+        if (str.equals(Constants.HeaderConstants.SMB_PROTOCOL)) {\n+            return new ShareEnabledProtocols().setSmb(true);\n+        } else if (str.equals(Constants.HeaderConstants.NFS_PROTOCOL)) {\n+            return new ShareEnabledProtocols().setNfs(true);\n+        }\n+\n+        throw new IllegalArgumentException(\"String is not an understood protocol: \" + str);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c136c81acf0be6d54dbffeabba1367bbf1c670ee"}, "originalPosition": 86}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6521efa9407fb3fb7226f6e9b599739bf3910041", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6521efa9407fb3fb7226f6e9b599739bf3910041", "committedDate": "2020-11-06T21:34:06Z", "message": "Checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "095613845e24c03bceae4674b308184d87be2e14", "author": {"user": {"login": "rickle-msft", "name": "Rick Ley"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/095613845e24c03bceae4674b308184d87be2e14", "committedDate": "2020-11-06T21:52:25Z", "message": "Checkstyle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 286, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}