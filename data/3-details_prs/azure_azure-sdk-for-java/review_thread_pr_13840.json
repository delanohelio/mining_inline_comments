{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MjAwNTAw", "number": 13840, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTozNDo0OFrOEWACRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTozNTo1M1rOEWADjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNTA0NzExOnYy", "diffSide": "RIGHT", "path": "sdk/core/azure-core-serializer-json-jackson/src/main/java/com/azure/core/serializer/json/jackson/JacksonJsonSerializer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTozNDo0OFrOG9FCdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMzo1MzowMFrOG9H5lA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5ODg2OQ==", "bodyText": "Regex should be \"^get|^set\". Current regex will replace isPreset to ``isPre`.\njshell> System.out.println(\"isPreset\".replaceFirst(\"^get|set\", \"\"))\nisPre", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466698869", "createdAt": "2020-08-06T21:34:48Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core-serializer-json-jackson/src/main/java/com/azure/core/serializer/json/jackson/JacksonJsonSerializer.java", "diffHunk": "@@ -93,16 +95,28 @@ public String convertMemberName(Member member) {\n \n         if (member instanceof Method) {\n             Method m = (Method) member;\n+            String methodNameWithoutJavaBeans = removePrefix(m.getName());\n             if (m.isAnnotationPresent(JsonIgnore.class)) {\n                 return null;\n             }\n             if (m.isAnnotationPresent(JsonProperty.class)) {\n                 String propertyName = m.getDeclaredAnnotation(JsonProperty.class).value();\n-                return CoreUtils.isNullOrEmpty(propertyName) ? m.getName() : propertyName;\n+                return CoreUtils.isNullOrEmpty(propertyName) ? methodNameWithoutJavaBeans : propertyName;\n             }\n-            return member.getName();\n+            return methodNameWithoutJavaBeans;\n         }\n \n         return null;\n     }\n+\n+    private String removePrefix(String methodName) {\n+        if (methodName == null || !(methodName.contains(\"get\") || methodName.contains(\"set\"))) {\n+            return methodName;\n+        }\n+        String noPrefix = methodName.replaceFirst(\"^get|set\", \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a20086c7e8040da7132ba4090cbfeafc5c77458f"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0NTc0OA==", "bodyText": "Use BeanUtil in jackson lib to do the check", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466745748", "createdAt": "2020-08-06T23:53:00Z", "author": {"login": "sima-zhu"}, "path": "sdk/core/azure-core-serializer-json-jackson/src/main/java/com/azure/core/serializer/json/jackson/JacksonJsonSerializer.java", "diffHunk": "@@ -93,16 +95,28 @@ public String convertMemberName(Member member) {\n \n         if (member instanceof Method) {\n             Method m = (Method) member;\n+            String methodNameWithoutJavaBeans = removePrefix(m.getName());\n             if (m.isAnnotationPresent(JsonIgnore.class)) {\n                 return null;\n             }\n             if (m.isAnnotationPresent(JsonProperty.class)) {\n                 String propertyName = m.getDeclaredAnnotation(JsonProperty.class).value();\n-                return CoreUtils.isNullOrEmpty(propertyName) ? m.getName() : propertyName;\n+                return CoreUtils.isNullOrEmpty(propertyName) ? methodNameWithoutJavaBeans : propertyName;\n             }\n-            return member.getName();\n+            return methodNameWithoutJavaBeans;\n         }\n \n         return null;\n     }\n+\n+    private String removePrefix(String methodName) {\n+        if (methodName == null || !(methodName.contains(\"get\") || methodName.contains(\"set\"))) {\n+            return methodName;\n+        }\n+        String noPrefix = methodName.replaceFirst(\"^get|set\", \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5ODg2OQ=="}, "originalCommit": {"oid": "a20086c7e8040da7132ba4090cbfeafc5c77458f"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNTA1MDM3OnYy", "diffSide": "RIGHT", "path": "sdk/core/azure-core-serializer-json-jackson/src/test/java/com/azure/core/serializer/json/jackson/JacksonPropertyNameTests.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTozNTo1M1rOG9FEcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMzo1MzoyMlrOG9H59w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5OTM3OA==", "bodyText": "Add some tests where the property name also contains get and set.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466699378", "createdAt": "2020-08-06T21:35:53Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core-serializer-json-jackson/src/test/java/com/azure/core/serializer/json/jackson/JacksonPropertyNameTests.java", "diffHunk": "@@ -98,10 +97,35 @@ public void testPropertyNameOnMethodName() throws NoSuchMethodException {\n             public String getHotelName() {\n                 return hotelName;\n             }\n+            public void setHotelName(String hotelName) {\n+                this.hotelName = hotelName;\n+            }\n         }\n \n-        Method m = LocalHotel.class.getDeclaredMethod(\"getHotelName\");\n-        assertEquals(\"getHotelName\", serializer.convertMemberName(m));\n+        Method getterM = LocalHotel.class.getDeclaredMethod(\"getHotelName\");\n+        assertEquals(\"hotelName\", serializer.convertMemberName(getterM));\n+        Method setterM = LocalHotel.class.getDeclaredMethod(\"setHotelName\", String.class);\n+        assertEquals(\"hotelName\", serializer.convertMemberName(setterM));\n+    }\n+\n+    @Test\n+    public void testPropertyNameOnMethodNameWithoutGetSet() throws NoSuchMethodException {\n+        class LocalHotel {\n+            String hotelName;\n+\n+            public String hotelName1() {\n+                return hotelName;\n+            }\n+\n+            public void hotelName2(String hotelName) {\n+                this.hotelName = hotelName;\n+            }\n+        }\n+\n+        Method getterM = LocalHotel.class.getDeclaredMethod(\"hotelName1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a20086c7e8040da7132ba4090cbfeafc5c77458f"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0NTg0Nw==", "bodyText": "More test coverage now", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466745847", "createdAt": "2020-08-06T23:53:22Z", "author": {"login": "sima-zhu"}, "path": "sdk/core/azure-core-serializer-json-jackson/src/test/java/com/azure/core/serializer/json/jackson/JacksonPropertyNameTests.java", "diffHunk": "@@ -98,10 +97,35 @@ public void testPropertyNameOnMethodName() throws NoSuchMethodException {\n             public String getHotelName() {\n                 return hotelName;\n             }\n+            public void setHotelName(String hotelName) {\n+                this.hotelName = hotelName;\n+            }\n         }\n \n-        Method m = LocalHotel.class.getDeclaredMethod(\"getHotelName\");\n-        assertEquals(\"getHotelName\", serializer.convertMemberName(m));\n+        Method getterM = LocalHotel.class.getDeclaredMethod(\"getHotelName\");\n+        assertEquals(\"hotelName\", serializer.convertMemberName(getterM));\n+        Method setterM = LocalHotel.class.getDeclaredMethod(\"setHotelName\", String.class);\n+        assertEquals(\"hotelName\", serializer.convertMemberName(setterM));\n+    }\n+\n+    @Test\n+    public void testPropertyNameOnMethodNameWithoutGetSet() throws NoSuchMethodException {\n+        class LocalHotel {\n+            String hotelName;\n+\n+            public String hotelName1() {\n+                return hotelName;\n+            }\n+\n+            public void hotelName2(String hotelName) {\n+                this.hotelName = hotelName;\n+            }\n+        }\n+\n+        Method getterM = LocalHotel.class.getDeclaredMethod(\"hotelName1\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5OTM3OA=="}, "originalCommit": {"oid": "a20086c7e8040da7132ba4090cbfeafc5c77458f"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4654, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}