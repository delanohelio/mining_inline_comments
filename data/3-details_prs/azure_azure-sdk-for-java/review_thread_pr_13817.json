{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNjY0Mjc1", "number": 13817, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjowMjo1OVrOEVl-JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjowMjo1OVrOEVl-JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMDc3NjY4OnYy", "diffSide": "RIGHT", "path": "sdk/keyvault/azure-security-keyvault-keys/src/test/java/com/azure/security/keyvault/keys/cryptography/KeyEncryptionKeyClientTestBase.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjowMjo1OVrOG8cM1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMDozNjozMFrOG8fMhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAyOTc4MA==", "bodyText": "We only use record policy in RECORD mode. Should exclude LIVE test mode here as well. Same as below", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13817#discussion_r466029780", "createdAt": "2020-08-05T22:02:59Z", "author": {"login": "sima-zhu"}, "path": "sdk/keyvault/azure-security-keyvault-keys/src/test/java/com/azure/security/keyvault/keys/cryptography/KeyEncryptionKeyClientTestBase.java", "diffHunk": "@@ -71,7 +71,10 @@ HttpPipeline getHttpPipeline(HttpClient httpClient, CryptographyServiceVersion s\n         }\n         HttpPolicyProviders.addAfterRetryPolicies(policies);\n         policies.add(new HttpLoggingPolicy(new HttpLogOptions().setLogLevel(HttpLogDetailLevel.BODY_AND_HEADERS)));\n-        policies.add(interceptorManager.getRecordPolicy());\n+\n+        if (!interceptorManager.isPlaybackMode()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c762934fdca2ecf780d227ef030179302a9eba9a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzMTkxMQ==", "bodyText": "@sima-zhu We probably should modify the other TestBase classes in our repository if that's the case. They currently use a record policy when not in playback mode.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13817#discussion_r466031911", "createdAt": "2020-08-05T22:08:33Z", "author": {"login": "vcolin7"}, "path": "sdk/keyvault/azure-security-keyvault-keys/src/test/java/com/azure/security/keyvault/keys/cryptography/KeyEncryptionKeyClientTestBase.java", "diffHunk": "@@ -71,7 +71,10 @@ HttpPipeline getHttpPipeline(HttpClient httpClient, CryptographyServiceVersion s\n         }\n         HttpPolicyProviders.addAfterRetryPolicies(policies);\n         policies.add(new HttpLoggingPolicy(new HttpLogOptions().setLogLevel(HttpLogDetailLevel.BODY_AND_HEADERS)));\n-        policies.add(interceptorManager.getRecordPolicy());\n+\n+        if (!interceptorManager.isPlaybackMode()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAyOTc4MA=="}, "originalCommit": {"oid": "c762934fdca2ecf780d227ef030179302a9eba9a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNTM1Nw==", "bodyText": "Could you point out the place mentioned use RecordPolicy when not playback.\nWe introduce LIVE mode slightly later than the other modes, so it might not up-to-date.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13817#discussion_r466035357", "createdAt": "2020-08-05T22:18:01Z", "author": {"login": "sima-zhu"}, "path": "sdk/keyvault/azure-security-keyvault-keys/src/test/java/com/azure/security/keyvault/keys/cryptography/KeyEncryptionKeyClientTestBase.java", "diffHunk": "@@ -71,7 +71,10 @@ HttpPipeline getHttpPipeline(HttpClient httpClient, CryptographyServiceVersion s\n         }\n         HttpPolicyProviders.addAfterRetryPolicies(policies);\n         policies.add(new HttpLoggingPolicy(new HttpLogOptions().setLogLevel(HttpLogDetailLevel.BODY_AND_HEADERS)));\n-        policies.add(interceptorManager.getRecordPolicy());\n+\n+        if (!interceptorManager.isPlaybackMode()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAyOTc4MA=="}, "originalCommit": {"oid": "c762934fdca2ecf780d227ef030179302a9eba9a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA3ODg1Mg==", "bodyText": "Besides the two classes included in this PR, in KeyVault you can find this in the following classes:\n\nCertificateClientTestBase\nCryptographyClientTestBase\nKeyClientTestBase", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13817#discussion_r466078852", "createdAt": "2020-08-06T00:36:30Z", "author": {"login": "vcolin7"}, "path": "sdk/keyvault/azure-security-keyvault-keys/src/test/java/com/azure/security/keyvault/keys/cryptography/KeyEncryptionKeyClientTestBase.java", "diffHunk": "@@ -71,7 +71,10 @@ HttpPipeline getHttpPipeline(HttpClient httpClient, CryptographyServiceVersion s\n         }\n         HttpPolicyProviders.addAfterRetryPolicies(policies);\n         policies.add(new HttpLoggingPolicy(new HttpLogOptions().setLogLevel(HttpLogDetailLevel.BODY_AND_HEADERS)));\n-        policies.add(interceptorManager.getRecordPolicy());\n+\n+        if (!interceptorManager.isPlaybackMode()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAyOTc4MA=="}, "originalCommit": {"oid": "c762934fdca2ecf780d227ef030179302a9eba9a"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4644, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}