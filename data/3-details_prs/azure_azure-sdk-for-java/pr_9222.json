{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwODQ2NjUw", "number": 9222, "title": "Update KV clients to set tracing namespace info", "bodyText": "[FEATURE REQ] Distributed tracing: set az.namespace attribute, here\nClient libraries must provide their respective Microsoft Resource Provider Namespace to the tracing plugin package for setting the namespace attribute on the outgoing spans.\nApproach\nAdd a withContext method overload into FluxUtil that takes in a map to specify tracing attributes.", "createdAt": "2020-03-19T07:42:54Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222", "merged": true, "mergeCommit": {"oid": "2863d99940a79f93da60992d3cd51a89cf4091f7"}, "closed": true, "closedAt": "2020-03-20T00:20:22Z", "author": {"login": "samvaity"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPG97SgH2gAyMzkwODQ2NjUwOmU1M2IwYTM0MGJjOWYxMGY4MTExY2YwODg4NDNhOTBhYzk5YjE2Y2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPVHnKAFqTM3ODE3NDI0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e53b0a340bc9f10f8111cf088843a90ac99b16ce", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e53b0a340bc9f10f8111cf088843a90ac99b16ce", "committedDate": "2020-03-19T07:42:01Z", "message": "update kv clients tracing namespace"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3OTcwNTg0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#pullrequestreview-377970584", "createdAt": "2020-03-19T18:05:39Z", "commit": {"oid": "e53b0a340bc9f10f8111cf088843a90ac99b16ce"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxODowNTozOVrOF46bnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxODoxMDoyM1rOF46mQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIyMTkxNg==", "bodyText": "does this need to be public ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#discussion_r395221916", "createdAt": "2020-03-19T18:05:39Z", "author": {"login": "g2vinay"}, "path": "sdk/keyvault/azure-security-keyvault-secrets/src/main/java/com/azure/security/keyvault/secrets/SecretAsyncClient.java", "diffHunk": "@@ -59,6 +62,10 @@\n     static final int DEFAULT_MAX_PAGE_RESULTS = 25;\n     static final String CONTENT_TYPE_HEADER_VALUE = \"application/json\";\n     static final String KEY_VAULT_SCOPE = \"https://vault.azure.net/.default\";\n+    // Please see <a href=https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/azure-services-resource-providers>here</a>\n+    // for more information on Azure resource provider namespaces.\n+    public static final Map<String, String> KEYVAULT_TRACING_PROPERTIES =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e53b0a340bc9f10f8111cf088843a90ac99b16ce"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIyNDY0Mw==", "bodyText": "Just curious, under what scenarios, we would expect this map to contain more than one value ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#discussion_r395224643", "createdAt": "2020-03-19T18:10:23Z", "author": {"login": "g2vinay"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/FluxUtil.java", "diffHunk": "@@ -98,8 +99,34 @@ private static void accept(ByteArrayOutputStream byteOutputStream, ByteBuffer by\n      * @return The response from service call\n      */\n     public static <T> Mono<T> withContext(Function<Context, Mono<T>> serviceCall) {\n+        return withContext(serviceCall, Collections.emptyMap());\n+    }\n+\n+    /**\n+     * This method converts the incoming {@code subscriberContext} from {@link reactor.util.context.Context Reactor\n+     * Context} to {@link Context Azure Context}, adds the specified context attributes and calls the given lambda\n+     * function with this context and returns a single entity of type {@code T}\n+     * <p>\n+     * If the reactor context is empty, {@link Context#NONE} will be used to call the lambda function\n+     * </p>\n+     *\n+     * @param serviceCall serviceCall The lambda function that makes the service call into which azure context\n+     * will be passed\n+     * @param contextAttributes The map of attributes sent by the calling method to be set on {@link Context}.\n+     * @param  <T> The type of response returned from the service call\n+     * @return The response from service call\n+     */\n+    public static <T> Mono<T> withContext(Function<Context, Mono<T>> serviceCall,\n+        Map<String, String> contextAttributes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e53b0a340bc9f10f8111cf088843a90ac99b16ce"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3OTg2NzEy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#pullrequestreview-377986712", "createdAt": "2020-03-19T18:27:37Z", "commit": {"oid": "e53b0a340bc9f10f8111cf088843a90ac99b16ce"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f638b06c1b9b5093ab37fb15870651c4e56e1d87", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f638b06c1b9b5093ab37fb15870651c4e56e1d87", "committedDate": "2020-03-19T19:53:21Z", "message": "update other KV clients"}, "afterCommit": {"oid": "254f856bae9a96f1656b0ccaa4be2914ded4a200", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/254f856bae9a96f1656b0ccaa4be2914ded4a200", "committedDate": "2020-03-19T20:01:22Z", "message": "update other KV clients"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "254f856bae9a96f1656b0ccaa4be2914ded4a200", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/254f856bae9a96f1656b0ccaa4be2914ded4a200", "committedDate": "2020-03-19T20:01:22Z", "message": "update other KV clients"}, "afterCommit": {"oid": "f8e6dc6130f5f9bc6f0cb17978512308e9e0c79e", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f8e6dc6130f5f9bc6f0cb17978512308e9e0c79e", "committedDate": "2020-03-19T20:04:05Z", "message": "update other KV clients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0db1b153b7cae425d2214aa409f0121c125a40e9", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0db1b153b7cae425d2214aa409f0121c125a40e9", "committedDate": "2020-03-19T20:52:29Z", "message": "update other KV clients"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8e6dc6130f5f9bc6f0cb17978512308e9e0c79e", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f8e6dc6130f5f9bc6f0cb17978512308e9e0c79e", "committedDate": "2020-03-19T20:04:05Z", "message": "update other KV clients"}, "afterCommit": {"oid": "0db1b153b7cae425d2214aa409f0121c125a40e9", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0db1b153b7cae425d2214aa409f0121c125a40e9", "committedDate": "2020-03-19T20:52:29Z", "message": "update other KV clients"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTM0ODcz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#pullrequestreview-378134873", "createdAt": "2020-03-19T22:23:50Z", "commit": {"oid": "0db1b153b7cae425d2214aa409f0121c125a40e9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc32a3410af9c0ef31686207558dfe32a30b4082", "author": {"user": {"login": "samvaity", "name": "Sameeksha Vaity"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dc32a3410af9c0ef31686207558dfe32a30b4082", "committedDate": "2020-03-19T23:35:30Z", "message": "add cryptography client"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTczOTAw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#pullrequestreview-378173900", "createdAt": "2020-03-20T00:10:00Z", "commit": {"oid": "dc32a3410af9c0ef31686207558dfe32a30b4082"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTc0MjQ0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#pullrequestreview-378174244", "createdAt": "2020-03-20T00:11:15Z", "commit": {"oid": "dc32a3410af9c0ef31686207558dfe32a30b4082"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMDoxMToxNVrOF5EeDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMDoxMToxNVrOF5EeDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4NjM4MQ==", "bodyText": "Is this something good to mention in KV changelogs too ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9222#discussion_r395386381", "createdAt": "2020-03-20T00:11:15Z", "author": {"login": "g2vinay"}, "path": "sdk/core/azure-core-tracing-opentelemetry/CHANGELOG.md", "diffHunk": "@@ -1,6 +1,7 @@\n # Release History\n \n ## 1.0.0-beta.4 (Unreleased)\n+- Keyvault: add az namespace info attribute to all outgoing spans.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc32a3410af9c0ef31686207558dfe32a30b4082"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 743, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}