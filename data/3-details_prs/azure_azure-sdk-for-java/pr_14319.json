{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxMjQwMTEx", "number": 14319, "title": "Added code to allow scheduling file expiry", "bodyText": "", "createdAt": "2020-08-20T21:02:43Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14319", "merged": true, "mergeCommit": {"oid": "c96fefbc002d4de3405f88c9fa93d12e2bbe9f5b"}, "closed": true, "closedAt": "2020-08-25T16:12:54Z", "author": {"login": "gapra-msft"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdA2VN4gH2gAyNDcxMjQwMTExOjM2YTk2NDJkNmU2NTgxMTFlYmNlYThlY2I4NDhlYWRiYmE0NDA1NGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCMLcvgH2gAyNDcxMjQwMTExOjdmNTY3MWM2NzY0ZTY2NjhhODdjNGExMmRmMWMzNmJkMjBjYmEwODQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "36a9642d6e658111ebcea8ecb848eadbba44054a", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/36a9642d6e658111ebcea8ecb848eadbba44054a", "committedDate": "2020-08-20T20:35:17Z", "message": "Added code to allow scheduling file expiry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a50691c3f6a66a8edeff9757ce34cfed67844442", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a50691c3f6a66a8edeff9757ce34cfed67844442", "committedDate": "2020-08-20T22:35:59Z", "message": "Added snippets"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMDM1OTE1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14319#pullrequestreview-472035915", "createdAt": "2020-08-20T22:48:51Z", "commit": {"oid": "a50691c3f6a66a8edeff9757ce34cfed67844442"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc42bbbf03e38b903e02778c7263bb21f37073a2", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dc42bbbf03e38b903e02778c7263bb21f37073a2", "committedDate": "2020-08-21T20:34:12Z", "message": "Added exclude"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNjA4NzA1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14319#pullrequestreview-473608705", "createdAt": "2020-08-24T15:24:02Z", "commit": {"oid": "dc42bbbf03e38b903e02778c7263bb21f37073a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNToyNDowM1rOHFqP2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNToyNDowM1rOHFqP2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY5NzExMw==", "bodyText": "Can we verify the value of the time?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14319#discussion_r475697113", "createdAt": "2020-08-24T15:24:03Z", "author": {"login": "rickle-msft"}, "path": "sdk/storage/azure-storage-file-datalake/src/test/java/com/azure/storage/file/datalake/FileAPITest.groovy", "diffHunk": "@@ -3364,6 +3367,53 @@ class FileAPITest extends APISpec {\n         null     | null       | null        | null         | garbageLeaseID\n     }\n \n+    @Unroll\n+    def \"Schedule deletion\"() {\n+        given:\n+        def fileClient = fsc.getFileClient(generatePathName())\n+        fileClient.create()\n+\n+        when:\n+        fileClient.scheduleDeletionWithResponse(fileScheduleDeletionOptions, null, null)\n+        def expiryTimeProperty = fileClient.getProperties().getExpiresOn()\n+\n+        then:\n+        (expiryTimeProperty != null) == hasExpiry\n+\n+        where:\n+        fileScheduleDeletionOptions                                                             | hasExpiry\n+        new FileScheduleDeletionOptions(Duration.ofDays(1), FileExpirationOffset.CREATION_TIME) | true\n+        new FileScheduleDeletionOptions(Duration.ofDays(1), FileExpirationOffset.NOW)           | true\n+        new FileScheduleDeletionOptions()                                                       | false\n+        null                                                                                    | false\n+    }\n+\n+    def \"Schedule deletion time\"() {\n+        given:\n+        def fileScheduleDeletionOptions = new FileScheduleDeletionOptions(getUTCNow().plusDays(1))\n+        def fileClient = fsc.getFileClient(generatePathName())\n+        fileClient.create()\n+\n+        when:\n+        fileClient.scheduleDeletionWithResponse(fileScheduleDeletionOptions, null, null)\n+        def expiryTimeProperty = fileClient.getProperties().getExpiresOn()\n+\n+        then:\n+        expiryTimeProperty", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc42bbbf03e38b903e02778c7263bb21f37073a2"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNjA4Nzkw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14319#pullrequestreview-473608790", "createdAt": "2020-08-24T15:24:08Z", "commit": {"oid": "dc42bbbf03e38b903e02778c7263bb21f37073a2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f5671c6764e6668a87c4a12df1c36bd20cba084", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7f5671c6764e6668a87c4a12df1c36bd20cba084", "committedDate": "2020-08-25T00:36:27Z", "message": "Check the time"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 315, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}