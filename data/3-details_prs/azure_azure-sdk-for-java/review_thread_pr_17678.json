{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzNjkyNjU4", "number": 17678, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDo1MDo1M1rOE7PKHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDo1MDo1M1rOE7PKHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNTQ5NzkxOnYy", "diffSide": "RIGHT", "path": "sdk/servicebus/microsoft-azure-servicebus/src/main/java/com/microsoft/azure/servicebus/MessageConverter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMDo1MDo1M1rOH2xHBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMToxNjozM1rOH2x-hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE4OTc2NQ==", "bodyText": "I understand that this override is done for a long time ,  Why is it done in first place ? If  amqpMessage.getTtl()    is positive , this override is needed ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17678#discussion_r527189765", "createdAt": "2020-11-19T20:50:53Z", "author": {"login": "hemanttanwar"}, "path": "sdk/servicebus/microsoft-azure-servicebus/src/main/java/com/microsoft/azure/servicebus/MessageConverter.java", "diffHunk": "@@ -131,14 +131,20 @@ public static Message convertAmqpMessageToBrokeredMessage(org.apache.qpid.proton\n         // Header\n         // Delivery count for service bus starts from 1, for AMQP it starts from 0.\n         brokeredMessage.setDeliveryCount(amqpMessage.getDeliveryCount() + 1);\n-        brokeredMessage.setTimeToLive(Duration.ofMillis(amqpMessage.getTtl()));\n-        \n+        long ttlMillis = amqpMessage.getTtl();\n+        if (ttlMillis > 0l) {\n+        \tbrokeredMessage.setTimeToLive(Duration.ofMillis(ttlMillis));\n+        }\n \n         // Properties\n         // Override TimeToLive from CrationTime and ExpiryTime, as they support duration of any length, which ttl doesn't\n         if (amqpMessage.getCreationTime() != 0l && amqpMessage.getExpiryTime() != 0l) {\n-        \tbrokeredMessage.setTimeToLive(Duration.ofMillis(amqpMessage.getExpiryTime() - amqpMessage.getCreationTime()));\n+        \tttlMillis = amqpMessage.getExpiryTime() - amqpMessage.getCreationTime();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15d0292a7791125cf0502c8c08913e0ff1313c5b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzIwMzk3Mw==", "bodyText": "Needed because ttl is milliseconds as integer, so it can't support time to live of more than 50 days. That's why we had to change it.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17678#discussion_r527203973", "createdAt": "2020-11-19T21:16:33Z", "author": {"login": "yvgopal"}, "path": "sdk/servicebus/microsoft-azure-servicebus/src/main/java/com/microsoft/azure/servicebus/MessageConverter.java", "diffHunk": "@@ -131,14 +131,20 @@ public static Message convertAmqpMessageToBrokeredMessage(org.apache.qpid.proton\n         // Header\n         // Delivery count for service bus starts from 1, for AMQP it starts from 0.\n         brokeredMessage.setDeliveryCount(amqpMessage.getDeliveryCount() + 1);\n-        brokeredMessage.setTimeToLive(Duration.ofMillis(amqpMessage.getTtl()));\n-        \n+        long ttlMillis = amqpMessage.getTtl();\n+        if (ttlMillis > 0l) {\n+        \tbrokeredMessage.setTimeToLive(Duration.ofMillis(ttlMillis));\n+        }\n \n         // Properties\n         // Override TimeToLive from CrationTime and ExpiryTime, as they support duration of any length, which ttl doesn't\n         if (amqpMessage.getCreationTime() != 0l && amqpMessage.getExpiryTime() != 0l) {\n-        \tbrokeredMessage.setTimeToLive(Duration.ofMillis(amqpMessage.getExpiryTime() - amqpMessage.getCreationTime()));\n+        \tttlMillis = amqpMessage.getExpiryTime() - amqpMessage.getCreationTime();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE4OTc2NQ=="}, "originalCommit": {"oid": "15d0292a7791125cf0502c8c08913e0ff1313c5b"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2763, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}