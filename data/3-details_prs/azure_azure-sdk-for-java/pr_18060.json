{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NTc3MTky", "number": 18060, "title": "[Communication] - Common - Adding TokenRefreshOptions to CommunicationTokenCredential ctor", "bodyText": "", "createdAt": "2020-12-10T01:42:22Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060", "merged": true, "mergeCommit": {"oid": "fc1878d8b2dcf58a7878cb60cdd329de8939459e"}, "closed": true, "closedAt": "2020-12-15T23:00:35Z", "author": {"login": "minnieliu"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkpPD4AH2gAyNTM1NTc3MTkyOjEwYTZiNmMzOWE2YjlkNTBiODFmODUyNzUwMjg3ODQ5M2YyZmVmMDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmiMpygH2gAyNTM1NTc3MTkyOmUyYWJlOWI4ODUxYWU5NGE3NGUzOTc0MjU4ZjA2YzVjMWM3MzI2YzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "10a6b6c39a6b9d50b81f8527502878493f2fef00", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/10a6b6c39a6b9d50b81f8527502878493f2fef00", "committedDate": "2020-12-10T01:41:04Z", "message": "Adding TokenRefreshOptions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/69145df0396789549be7d1bf903eeb3e4af58515", "committedDate": "2020-12-14T19:07:38Z", "message": "Resolve merge conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxODIxOTk3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#pullrequestreview-551821997", "createdAt": "2020-12-14T19:26:52Z", "commit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxOToyNjo1MlrOIFik2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxOToyNjo1MlrOIFik2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjY4MDI4Mw==", "bodyText": "Should we also include the breaking change of renaming CommunicationUser to CommunicationUserIdentifier in this file? Or do you plan to include that update in a different PR?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#discussion_r542680283", "createdAt": "2020-12-14T19:26:52Z", "author": {"login": "JianpingChen"}, "path": "sdk/communication/azure-communication-common/CHANGELOG.md", "diffHunk": "@@ -3,6 +3,8 @@\n ## 1.0.0-beta.4 (Unreleased)\n ### Breaking Changes\n - Renamed `CommunicationUserCredential` to `CommunicationTokenCredential`\n+- Replaced constructor `CommunicationTokenCredential(TokenRefresher tokenRefresher, String initialToken,\tboolean refreshProactively)` with `CommunicationTokenCredential(TokenRefreshOptions tokenRefreshOptions, String initialToken)`\n+- Replaced constructor `CommunicationTokenCredential(TokenRefresher tokenRefresher)` with `CommunicationTokenCredential(TokenRefreshOptions tokenRefreshOptions)`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNzUwNTgw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#pullrequestreview-552750580", "createdAt": "2020-12-15T18:31:51Z", "commit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxODozMTo1MlrOIGZ5DA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxODozMzo1MlrOIGZ91Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU4NjU3Mg==", "bodyText": "I think we should rename initialToken to simply token everywhere.\nFor the constructor with refresh options, token can be an optional argument in the options bag, we don't need it as a top-level arg in the constructor.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#discussion_r543586572", "createdAt": "2020-12-15T18:31:52Z", "author": {"login": "DominikMe"}, "path": "sdk/communication/azure-communication-common/src/main/java/com/azure/communication/common/CommunicationTokenCredential.java", "diffHunk": "@@ -61,19 +62,14 @@ public CommunicationTokenCredential(TokenRefresher tokenRefresher) {\n      * CallbackOffsetMinutes defaulted to two minutes. To modify this default, call\n      * setCallbackOffsetMinutes after construction\n      * \n-     * @param tokenRefresher implementation to supply fresh token when reqested\n+     * @param tokenRefreshOptions implementation to supply fresh token when reqested\n      * @param initialToken serialized JWT token\n-     * @param refreshProactively when set to true, turn on proactive fetching to call\n-     *                           tokenRefresher before token expiry by minutes set\n-     *                           with setCallbackOffsetMinutes or default value of\n-     *                           two minutes\n      */\n-    public CommunicationTokenCredential(TokenRefresher tokenRefresher, String initialToken,\n-            boolean refreshProactively) {\n-        this(tokenRefresher);\n+    public CommunicationTokenCredential(TokenRefreshOptions tokenRefreshOptions, String initialToken) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU4NzMwNQ==", "bodyText": "To avoid naming ambiguity I can hear Kryzsztof ask to rename this to CommunicationTokenRefreshOptions and I think we should. :-)", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#discussion_r543587305", "createdAt": "2020-12-15T18:33:01Z", "author": {"login": "DominikMe"}, "path": "sdk/communication/azure-communication-common/src/main/java/com/azure/communication/common/TokenRefreshOptions.java", "diffHunk": "@@ -0,0 +1,39 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+package com.azure.communication.common;\n+\n+/**\n+ * Options for refreshing CommunicationTokenCredential\n+ */\n+public class TokenRefreshOptions {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU4Nzc5Nw==", "bodyText": "As mentioned above, token can go here too. The comment can explain that token is an optional initial token.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#discussion_r543587797", "createdAt": "2020-12-15T18:33:52Z", "author": {"login": "DominikMe"}, "path": "sdk/communication/azure-communication-common/src/main/java/com/azure/communication/common/TokenRefreshOptions.java", "diffHunk": "@@ -0,0 +1,39 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+package com.azure.communication.common;\n+\n+/**\n+ * Options for refreshing CommunicationTokenCredential\n+ */\n+public class TokenRefreshOptions {\n+    private final TokenRefresher tokenRefresher;\n+    private final boolean refreshProactively;\n+\n+    /**\n+     * Creates a TokenRefreshOptions object\n+     * \n+     * @param tokenRefresher the token refresher to provide capacity to fetch fresh token\n+     * @param refreshProactively when set to true, turn on proactive fetching to call\n+     *                           tokenRefresher before token expiry by minutes set\n+     *                           with setCallbackOffsetMinutes or default value of\n+     *                           two minutes\n+     */\n+    public TokenRefreshOptions(TokenRefresher tokenRefresher, boolean refreshProactively) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69145df0396789549be7d1bf903eeb3e4af58515"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b8b0c4c0bd88241b28b1214c775ef9d5f6a9368", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7b8b0c4c0bd88241b28b1214c775ef9d5f6a9368", "committedDate": "2020-12-15T20:28:07Z", "message": "Address PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyOTgyODQw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#pullrequestreview-552982840", "createdAt": "2020-12-15T22:17:53Z", "commit": {"oid": "7b8b0c4c0bd88241b28b1214c775ef9d5f6a9368"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMjoxNzo1NFrOIGigPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMjoxNzo1NFrOIGigPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzcyNzY3OA==", "bodyText": "One more change needed after the last commit.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - Replaced constructor `CommunicationTokenCredential(TokenRefresher tokenRefresher, String initialToken,\tboolean refreshProactively)` with `CommunicationTokenCredential(CommunicationTokenRefreshOptions tokenRefreshOptions, String initialToken)`\n          \n          \n            \n            - Replaced constructor `CommunicationTokenCredential(TokenRefresher tokenRefresher, String initialToken,\tboolean refreshProactively)` with `CommunicationTokenCredential(CommunicationTokenRefreshOptions tokenRefreshOptions)`\n          \n      \n    \n    \n  \n\nWe can also combine both replacements into one line.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18060#discussion_r543727678", "createdAt": "2020-12-15T22:17:54Z", "author": {"login": "DominikMe"}, "path": "sdk/communication/azure-communication-common/CHANGELOG.md", "diffHunk": "@@ -3,6 +3,8 @@\n ## 1.0.0-beta.4 (Unreleased)\n ### Breaking Changes\n - Renamed `CommunicationUserCredential` to `CommunicationTokenCredential`\n+- Replaced constructor `CommunicationTokenCredential(TokenRefresher tokenRefresher, String initialToken,\tboolean refreshProactively)` with `CommunicationTokenCredential(CommunicationTokenRefreshOptions tokenRefreshOptions, String initialToken)`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b8b0c4c0bd88241b28b1214c775ef9d5f6a9368"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de17498e9caed101781ed3a31a7d975116538a0c", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/de17498e9caed101781ed3a31a7d975116538a0c", "committedDate": "2020-12-15T22:28:46Z", "message": "Update changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2abe9b8851ae94a74e3974258f06c5c1c7326c0", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e2abe9b8851ae94a74e3974258f06c5c1c7326c0", "committedDate": "2020-12-15T22:36:57Z", "message": "Update changelog"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1450, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}