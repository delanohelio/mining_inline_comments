{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyOTg2MDc0", "number": 11423, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNTowNzo0NlrOD_hdkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNToyOToyMlrOD_8Kag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3OTM1MTIyOnYy", "diffSide": "RIGHT", "path": "sdk/appservice/mgmt/src/main/java/com/azure/management/appservice/FunctionApp.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNTowNzo0NlrOGaOwoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNToxMzo1NVrOGaO2qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE1Nzk4NQ==", "bodyText": "Is it required only for new section added in README? Should we plan to cover same scenario for important resource inside Network, Compute, etc. ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11423#discussion_r430157985", "createdAt": "2020-05-26T05:07:46Z", "author": {"login": "xseeseesee"}, "path": "sdk/appservice/mgmt/src/main/java/com/azure/management/appservice/FunctionApp.java", "diffHunk": "@@ -325,6 +325,14 @@\n              */\n             WithCreate withNewStorageAccount(String name, StorageAccountSkuType sku);\n \n+            /**\n+             * Creates a new storage account to use for the function app.\n+             *\n+             * @param storageAccount a creatable definition for a new storage account\n+             * @return the next stage of the definition\n+             */\n+            WithCreate withNewStorageAccount(Creatable<StorageAccount> storageAccount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "299192ee3fa5d487e19d9dd10b015daedbd108ee"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE1ODkzNw==", "bodyText": "Yes, I think we should cover them (they are largely already covered, as in VM, network. But just this one I was trying to do in README is not...).\nProbably going to put it in guideline if possible.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11423#discussion_r430158937", "createdAt": "2020-05-26T05:11:29Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/appservice/mgmt/src/main/java/com/azure/management/appservice/FunctionApp.java", "diffHunk": "@@ -325,6 +325,14 @@\n              */\n             WithCreate withNewStorageAccount(String name, StorageAccountSkuType sku);\n \n+            /**\n+             * Creates a new storage account to use for the function app.\n+             *\n+             * @param storageAccount a creatable definition for a new storage account\n+             * @return the next stage of the definition\n+             */\n+            WithCreate withNewStorageAccount(Creatable<StorageAccount> storageAccount);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE1Nzk4NQ=="}, "originalCommit": {"oid": "299192ee3fa5d487e19d9dd10b015daedbd108ee"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE1OTUyOQ==", "bodyText": "OK. As we put this on README, then it will be significant to our users. I will double check if any missing in Network and Compute first.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11423#discussion_r430159529", "createdAt": "2020-05-26T05:13:55Z", "author": {"login": "xseeseesee"}, "path": "sdk/appservice/mgmt/src/main/java/com/azure/management/appservice/FunctionApp.java", "diffHunk": "@@ -325,6 +325,14 @@\n              */\n             WithCreate withNewStorageAccount(String name, StorageAccountSkuType sku);\n \n+            /**\n+             * Creates a new storage account to use for the function app.\n+             *\n+             * @param storageAccount a creatable definition for a new storage account\n+             * @return the next stage of the definition\n+             */\n+            WithCreate withNewStorageAccount(Creatable<StorageAccount> storageAccount);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE1Nzk4NQ=="}, "originalCommit": {"oid": "299192ee3fa5d487e19d9dd10b015daedbd108ee"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3OTQxOTI3OnYy", "diffSide": "RIGHT", "path": "sdk/management/README.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNTo0ODoyMFrOGaPaaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNTo1ODoyNVrOGaPmfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE2ODY4Mw==", "bodyText": "Currently, we don't have a AzureProfile constructor with only one parameter.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11423#discussion_r430168683", "createdAt": "2020-05-26T05:48:20Z", "author": {"login": "ChenTanyi"}, "path": "sdk/management/README.md", "diffHunk": "@@ -70,7 +70,7 @@ In addition, Azure subscription ID can be configured via environment variable `A\n With above configuration, `azure` client can be authenticated by following code:\n \n ```java\n-AzureProfile profile = new AzureProfile(AzureEnvironment.AZURE, true);\n+AzureProfile profile = new AzureProfile(AzureEnvironment.AZURE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "757bface202afa5c3a080eeec02ab77ca2f51a59"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE3MTc3Mg==", "bodyText": "That is a pending discussion with Chuang. true or false here is not very human friendly. So a proposal is either take a Configuration object, or just remove it (since there is another constructor that takes tenantId subscriptionId azureEnvironment).\nI will adjust this when finalized.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11423#discussion_r430171772", "createdAt": "2020-05-26T05:58:25Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/management/README.md", "diffHunk": "@@ -70,7 +70,7 @@ In addition, Azure subscription ID can be configured via environment variable `A\n With above configuration, `azure` client can be authenticated by following code:\n \n ```java\n-AzureProfile profile = new AzureProfile(AzureEnvironment.AZURE, true);\n+AzureProfile profile = new AzureProfile(AzureEnvironment.AZURE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE2ODY4Mw=="}, "originalCommit": {"oid": "757bface202afa5c3a080eeec02ab77ca2f51a59"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MzcyNTg2OnYy", "diffSide": "RIGHT", "path": "sdk/management/README.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNToyOToyMlrOGa56JQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNToyOToyMlrOGa56JQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2NDkzMw==", "bodyText": "Add a section on RBAC. Probably this is the only lib in java than can do this...", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11423#discussion_r430864933", "createdAt": "2020-05-27T05:29:22Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/management/README.md", "diffHunk": "@@ -132,12 +135,78 @@ linuxVM.update()\n     .apply();\n ```\n \n+### Dependency across Azure resources.\n+\n+You can create a function app, together with required storage account and app service plan created on specification.\n+\n+```java\n+Creatable<StorageAccount> creatableStorageAccount = azure.storageAccounts()\n+    .define(storageAccountName)\n+    .withRegion(Region.US_EAST)\n+    .withExistingResourceGroup(rgName)\n+    .withGeneralPurposeAccountKindV2()\n+    .withSku(StorageAccountSkuType.STANDARD_LRS);\n+\n+Creatable<AppServicePlan> creatableAppServicePlan = azure.appServicePlans()\n+    .define(appServicePlanName)\n+    .withRegion(Region.US_EAST)\n+    .withExistingResourceGroup(rgName)\n+    .withPricingTier(PricingTier.STANDARD_S1)\n+    .withOperatingSystem(OperatingSystem.LINUX);\n+\n+FunctionApp linuxFunctionApp = azure.functionApps().define(functionAppName)\n+    .withRegion(Region.US_EAST)\n+    .withExistingResourceGroup(rgName)\n+    .withNewLinuxAppServicePlan(creatableAppServicePlan)\n+    .withBuiltInImage(FunctionRuntimeStack.JAVA_8)\n+    .withNewStorageAccount(creatableStorageAccount)\n+    .withHttpsOnly(true)\n+    .withAppSetting(\"WEBSITE_RUN_FROM_PACKAGE\", functionAppPackageUrl)\n+    .create();\n+```\n+\n+### Batch Azure resource provisioning\n+\n+You can batch create and delete managed disk instances.\n+\n+```java\n+List<String> diskNames = Arrays.asList(\"datadisk1\", \"datadisk2\");\n+\n+List<Creatable<Disk>> creatableDisks = diskNames.stream()\n+    .map(diskName -> azure.disks()\n+        .define(diskName)\n+        .withRegion(Region.US_EAST)\n+        .withExistingResourceGroup(rgName)\n+        .withData()\n+        .withSizeInGB(1)\n+        .withSku(DiskSkuTypes.STANDARD_LRS))\n+    .collect(Collectors.toList());\n+\n+Collection<Disk> disks = azure.disks().create(creatableDisks).values();\n+\n+azure.disks().deleteByIds(disks.stream().map(Disk::id).collect(Collectors.toList()));\n+```\n+\n+### Integration with Azure role-based access control\n+\n+You can assign Contributor for an Azure resource to a service principal.\n+\n+```java\n+String raName = UUID.randomUUID().toString();\n+RoleAssignment roleAssignment = azure.accessManagement().roleAssignments()\n+    .define(raName)\n+    .forServicePrincipal(servicePrincipal)\n+    .withBuiltInRole(BuiltInRole.CONTRIBUTOR)\n+    .withScope(resource.id())\n+    .create();\n+```\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3eb4a15b3d31e872f0d84dc17ab0c651552f3566"}, "originalPosition": 97}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4134, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}