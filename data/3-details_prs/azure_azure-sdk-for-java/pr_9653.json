{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MDAzMDk4", "number": 9653, "title": "Readme changes, Add sample for settlement of message plus more samples", "bodyText": "Adding sample  code for few use cases.", "createdAt": "2020-03-27T23:02:10Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653", "merged": true, "mergeCommit": {"oid": "5d0cfe100228453c50c8f3847b7be6077fd2d5e8"}, "closed": true, "closedAt": "2020-04-03T01:22:22Z", "author": {"login": "hemanttanwar"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcR456WAH2gAyMzk1MDAzMDk4OmVjOGMyOWY5ZjdmYTE2NTNlMGIyNDNhODliN2RiYWQxZTRlMmE4Yjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTxXbhgFqTM4NjcyNjkwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ec8c29f9f7fa1653e0b243a89b7dbad1e4e2a8b9", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/ec8c29f9f7fa1653e0b243a89b7dbad1e4e2a8b9", "committedDate": "2020-03-27T23:00:44Z", "message": "Add sample for settlement of message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMjUxMDk5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#pullrequestreview-383251099", "createdAt": "2020-03-27T23:28:50Z", "commit": {"oid": "ec8c29f9f7fa1653e0b243a89b7dbad1e4e2a8b9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMzoyODo1MFrOF9EieA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QyMzoyODo1MFrOF9EieA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU4MTgxNg==", "bodyText": "Do on next is for side effects like logging, you should use the first overload of subscribe", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r399581816", "createdAt": "2020-03-27T23:28:50Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,80 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");\n+\n+        // Create a receiver.\n+        // \"<<fully-qualified-namespace>>\" will look similar to \"{your-namespace}.servicebus.windows.net\"\n+        // \"<<queue-name>>\" will be the name of the Service Bus queue instance you created\n+        // inside the Service Bus namespace.\n+\n+        ServiceBusReceiverAsyncClient receiverAsyncClient = new ServiceBusClientBuilder()\n+            .connectionString(connectionString)\n+            .buildReceiverClientBuilder()\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .isLockAutoRenewed(true)\n+            .queueName(\"<<queue-name>>\")\n+            .maxAutoLockRenewalDuration(Duration.ofSeconds(2))\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiverAsyncClient.receive()\n+            .doOnNext(received -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec8c29f9f7fa1653e0b243a89b7dbad1e4e2a8b9"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14052e3a5d993db2a562c921c95ae56fd38f2b18", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/14052e3a5d993db2a562c921c95ae56fd38f2b18", "committedDate": "2020-03-27T23:31:31Z", "message": "send batch of messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c06cf2421e5272a418c52e21f7600719aa39e4f8", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c06cf2421e5272a418c52e21f7600719aa39e4f8", "committedDate": "2020-03-27T23:32:17Z", "message": "send batch of messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1b80ca0c1c4fb85785f47e1268fbbe71c569671", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/b1b80ca0c1c4fb85785f47e1268fbbe71c569671", "committedDate": "2020-03-28T06:26:19Z", "message": "review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99fe7a45e1cb074d63218596c04bed8ceb864d38", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/99fe7a45e1cb074d63218596c04bed8ceb864d38", "committedDate": "2020-03-28T20:26:04Z", "message": "review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "251c96130c99c69dad2b651554a277965439e7fa", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/251c96130c99c69dad2b651554a277965439e7fa", "committedDate": "2020-03-28T21:51:05Z", "message": "adding more samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35718719676d270167c199d6e5a169db4aeacfd8", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/35718719676d270167c199d6e5a169db4aeacfd8", "committedDate": "2020-03-28T22:05:00Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd65518c2d31d4edd6fba36b17bfae7c705e3d58", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dd65518c2d31d4edd6fba36b17bfae7c705e3d58", "committedDate": "2020-03-28T22:17:47Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a49d81d867716a99ce02b1666ca70436f3ae1466", "committedDate": "2020-03-28T22:35:24Z", "message": "undo eventshub readme changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzOTg4MDE4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#pullrequestreview-383988018", "createdAt": "2020-03-30T15:44:47Z", "commit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNTo0NDo0N1rOF9wJ5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNTo1MjoxOVrOF9wffw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5NjQyMg==", "bodyText": "A stream could be infinite. It's a batch of messages.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400296422", "createdAt": "2020-03-30T15:44:47Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -29,7 +29,10 @@ have to be online at the same time.\n   - [Send Message to Queue or Topic](#send-message-to-queue-or-topic)\n   - [Receive message from Queue or Subscription](#receive-message-from-queue-or-subscription)\n   - [Send message with Azure Active Directory credentials](#send-message-with-azure-active-directory-credentials)\n+  - [Send a batch of messages](#send-a-batch-of-messages)\n   - [Receive message with Azure Active Directory credentials](#receive-message-with-azure-active-directory-credentials)\n+  - [Receive messages and settle them](#receive-messages-and-settle-them)\n+  - [Receive stream of messages synchronously](#receive-stream-of-messages-synchronously)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5Njg2MA==", "bodyText": "iirc, we want to showcase DefaultAzureCredential. I would use that instead of explicitly choosing ClientSecretCredential.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400296860", "createdAt": "2020-03-30T15:45:25Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -89,14 +92,44 @@ Follow the instructions in [Creating a service principal using Azure Portal][app\n service principal and a client secret. The corresponding `clientId` and `tenantId` for the service principal can be\n obtained from the [App registration page][app_registration_page].\n \n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L60-L69 -->\n+```java\n+ClientSecretCredential credential = new ClientSecretCredentialBuilder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5NzM5Mw==", "bodyText": "We don't need method names in our code snippets.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400297393", "createdAt": "2020-03-30T15:46:11Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -109,26 +142,39 @@ Both the asynchronous and synchronous Service Bus sender and receiver clients ca\n \n The snippet below creates an asynchronous Service Bus sender.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L18-L23 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L21-L26 -->\n ```java\n-String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n-ServiceBusSenderAsyncClient sender = new ServiceBusClientBuilder()\n-    .connectionString(connectionString)\n-    .buildSenderClientBuilder()\n-    .entityName(\"<< QUEUE OR TOPIC NAME >>\")\n-    .buildAsyncClient();\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5NzcwOQ==", "bodyText": "The namespace connection string is not sufficient, they need to also set the entityPath.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400297709", "createdAt": "2020-03-30T15:46:38Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -109,26 +142,39 @@ Both the asynchronous and synchronous Service Bus sender and receiver clients ca\n \n The snippet below creates an asynchronous Service Bus sender.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L18-L23 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L21-L26 -->\n ```java\n-String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n-ServiceBusSenderAsyncClient sender = new ServiceBusClientBuilder()\n-    .connectionString(connectionString)\n-    .buildSenderClientBuilder()\n-    .entityName(\"<< QUEUE OR TOPIC NAME >>\")\n-    .buildAsyncClient();\n+ */\n+public void createAsynchronousServiceBusSender() {\n+    String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n+    ServiceBusSenderAsyncClient sender = new ServiceBusClientBuilder()\n+        .connectionString(connectionString)\n+        .buildSenderClientBuilder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5Nzk0NA==", "bodyText": "Same for these ones below. I would make sure they run.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400297944", "createdAt": "2020-03-30T15:46:57Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -109,26 +142,39 @@ Both the asynchronous and synchronous Service Bus sender and receiver clients ca\n \n The snippet below creates an asynchronous Service Bus sender.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L18-L23 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L21-L26 -->\n ```java\n-String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n-ServiceBusSenderAsyncClient sender = new ServiceBusClientBuilder()\n-    .connectionString(connectionString)\n-    .buildSenderClientBuilder()\n-    .entityName(\"<< QUEUE OR TOPIC NAME >>\")\n-    .buildAsyncClient();\n+ */\n+public void createAsynchronousServiceBusSender() {\n+    String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n+    ServiceBusSenderAsyncClient sender = new ServiceBusClientBuilder()\n+        .connectionString(connectionString)\n+        .buildSenderClientBuilder()\n ```\n \n The snippet below creates an asynchronous Service Bus receiver.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L30-L35 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L33-L38 -->\n ```java\n-String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n-ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n-    .connectionString(connectionString)\n-    .buildReceiverClientBuilder()\n-    .queueName(\"<< QUEUE NAME >>\")\n-    .buildAsyncClient();\n+ */\n+public void createAsynchronousServiceBusReceiver() {\n+    String connectionString = \"<< CONNECTION STRING FOR THE SERVICE BUS NAMESPACE >>\";\n+    ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n+        .connectionString(connectionString)\n+        .buildReceiverClientBuilder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5ODg4Ng==", "bodyText": "This is a lot of headers. It could be condensed into a list of links.\n* [Sending a batch of messages][sample-send-batch-messages]\n* [Receive messages and settle them][ ... ]\n...", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400298886", "createdAt": "2020-03-30T15:48:18Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -151,9 +197,18 @@ Example of receiving a message asynchronously is documented [here][sample-receiv\n ### Send message with Azure Active Directory credentials\n Example of sending a message asynchronously using active directory credential is documented [here][sample-send-async-aad-message].\n \n+### Send a batch of messages ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5OTkxNQ==", "bodyText": "nit: Consistency with spacing. Space should follow //. (ie. // This)", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400299915", "createdAt": "2020-03-30T15:49:40Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,100 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");\n+\n+        // Create a receiver.\n+        // \"<<fully-qualified-namespace>>\" will look similar to \"{your-namespace}.servicebus.windows.net\"\n+        // \"<<queue-name>>\" will be the name of the Service Bus queue instance you created\n+        // inside the Service Bus namespace.\n+\n+        ServiceBusReceiverAsyncClient receiverAsyncClient = new ServiceBusClientBuilder()\n+            .connectionString(connectionString)\n+            .buildReceiverClientBuilder()\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .isLockAutoRenewed(true)\n+            .queueName(\"<<queue-name>>\")\n+            .maxAutoLockRenewalDuration(Duration.ofSeconds(2))\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiverAsyncClient.receive()\n+            .subscribe(received -> {\n+                Instant latest = Instant.MIN;\n+\n+                // Simulate some sort of long processing. Sleep should not be used in production system.\n+                for (int i = 0; i < 3; i++) {\n+                    try {\n+                        TimeUnit.SECONDS.sleep(15);\n+                    } catch (InterruptedException error) {\n+                        System.out.println(\"Error occurred while sleeping: \" + error);\n+                    }\n+                    latest = received.getLockedUntil();\n+                    System.out.println(\"Message Locked Until \" + latest);\n+                }\n+\n+                //This is application business logic to take action based on some application logic.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMwMTU3NA==", "bodyText": "You need to set \"isAutoComplete\" to false when building this client. Or it'll try to complete or abandon the message again.\n\"Duration.ofSeconds()\" is used multiple times and can be a final variable.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400301574", "createdAt": "2020-03-30T15:51:50Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,100 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");\n+\n+        // Create a receiver.\n+        // \"<<fully-qualified-namespace>>\" will look similar to \"{your-namespace}.servicebus.windows.net\"\n+        // \"<<queue-name>>\" will be the name of the Service Bus queue instance you created\n+        // inside the Service Bus namespace.\n+\n+        ServiceBusReceiverAsyncClient receiverAsyncClient = new ServiceBusClientBuilder()\n+            .connectionString(connectionString)\n+            .buildReceiverClientBuilder()\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .isLockAutoRenewed(true)\n+            .queueName(\"<<queue-name>>\")\n+            .maxAutoLockRenewalDuration(Duration.ofSeconds(2))\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiverAsyncClient.receive()\n+            .subscribe(received -> {\n+                Instant latest = Instant.MIN;\n+\n+                // Simulate some sort of long processing. Sleep should not be used in production system.\n+                for (int i = 0; i < 3; i++) {\n+                    try {\n+                        TimeUnit.SECONDS.sleep(15);\n+                    } catch (InterruptedException error) {\n+                        System.out.println(\"Error occurred while sleeping: \" + error);\n+                    }\n+                    latest = received.getLockedUntil();\n+                    System.out.println(\"Message Locked Until \" + latest);\n+                }\n+\n+                //This is application business logic to take action based on some application logic.\n+                // For demo purpose we are using a property for application logic.\n+                String propertyValue = \"UNDEFINED\";\n+                if (received.getProperties().get(\"SOME_USER_PROPERTY\") != null) {\n+                    propertyValue = (String) received.getProperties().get(\"SOME_USER_PROPERTY\");\n+                }\n+\n+                switch (propertyValue) {\n+                    case \"VALUE-1\":\n+                        System.out.println(\"Completing message.\");\n+                        receiverAsyncClient.complete(received).block(Duration.ofSeconds(15));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMwMTk1MQ==", "bodyText": "You sleep for 20 seconds, but each iteration is 15 seconds in the subscribe. Have you run these samples?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r400301951", "createdAt": "2020-03-30T15:52:19Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,100 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");\n+\n+        // Create a receiver.\n+        // \"<<fully-qualified-namespace>>\" will look similar to \"{your-namespace}.servicebus.windows.net\"\n+        // \"<<queue-name>>\" will be the name of the Service Bus queue instance you created\n+        // inside the Service Bus namespace.\n+\n+        ServiceBusReceiverAsyncClient receiverAsyncClient = new ServiceBusClientBuilder()\n+            .connectionString(connectionString)\n+            .buildReceiverClientBuilder()\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .isLockAutoRenewed(true)\n+            .queueName(\"<<queue-name>>\")\n+            .maxAutoLockRenewalDuration(Duration.ofSeconds(2))\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiverAsyncClient.receive()\n+            .subscribe(received -> {\n+                Instant latest = Instant.MIN;\n+\n+                // Simulate some sort of long processing. Sleep should not be used in production system.\n+                for (int i = 0; i < 3; i++) {\n+                    try {\n+                        TimeUnit.SECONDS.sleep(15);\n+                    } catch (InterruptedException error) {\n+                        System.out.println(\"Error occurred while sleeping: \" + error);\n+                    }\n+                    latest = received.getLockedUntil();\n+                    System.out.println(\"Message Locked Until \" + latest);\n+                }\n+\n+                //This is application business logic to take action based on some application logic.\n+                // For demo purpose we are using a property for application logic.\n+                String propertyValue = \"UNDEFINED\";\n+                if (received.getProperties().get(\"SOME_USER_PROPERTY\") != null) {\n+                    propertyValue = (String) received.getProperties().get(\"SOME_USER_PROPERTY\");\n+                }\n+\n+                switch (propertyValue) {\n+                    case \"VALUE-1\":\n+                        System.out.println(\"Completing message.\");\n+                        receiverAsyncClient.complete(received).block(Duration.ofSeconds(15));\n+                        break;\n+                    case \"VALUE-2\":\n+                        System.out.println(\"Abandon message.\");\n+                        receiverAsyncClient.abandon(received).block(Duration.ofSeconds(15));\n+                        break;\n+                    case \"VALUE-3\":\n+                        System.out.println(\"Defer message.\");\n+                        receiverAsyncClient.defer(received).block(Duration.ofSeconds(15));\n+                        break;\n+                    default:\n+                        System.out.println(\"Deadletter message.\");\n+                        receiverAsyncClient.deadLetter(received).block(Duration.ofSeconds(15));\n+                }\n+            });\n+\n+        // Receiving messages from the queue for a duration of 20 seconds.\n+        // Subscribe is not a blocking call so we sleep here so the program does not end.\n+        try {\n+            Thread.sleep(Duration.ofSeconds(20).toMillis());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 90}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "929730eaf6ffeea511c49d5b01f810940350e27c", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/929730eaf6ffeea511c49d5b01f810940350e27c", "committedDate": "2020-03-31T04:42:14Z", "message": "Fixed the samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "451024a4ac0c71674f1a07c4c12d2d8875723276", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/451024a4ac0c71674f1a07c4c12d2d8875723276", "committedDate": "2020-03-31T04:44:25Z", "message": "Fixed the samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a00043ec1f51ccf74183130cd4dd0904746c553", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9a00043ec1f51ccf74183130cd4dd0904746c553", "committedDate": "2020-03-31T04:58:40Z", "message": "Fixed the samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e596f09e9e6b4a0be9e1618c75283c9d18f2c1ee", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e596f09e9e6b4a0be9e1618c75283c9d18f2c1ee", "committedDate": "2020-03-31T05:27:53Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47385b99a54b76741a091df4bf5116bb5f81c17a", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/47385b99a54b76741a091df4bf5116bb5f81c17a", "committedDate": "2020-03-31T05:46:34Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6209cacba14e4c8960fa4e173aec3b1b65ee606f", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6209cacba14e4c8960fa4e173aec3b1b65ee606f", "committedDate": "2020-03-31T05:48:39Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fff7d5158d1e314d818bb98950d74934e63e8e70", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fff7d5158d1e314d818bb98950d74934e63e8e70", "committedDate": "2020-03-31T05:54:06Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9612ab38d1f070cf14b896adb240ec7c045233e7", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/9612ab38d1f070cf14b896adb240ec7c045233e7", "committedDate": "2020-03-31T06:04:20Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/313d5decbdbcb88f1202023fb1570881bb78c5f1", "committedDate": "2020-03-31T06:07:03Z", "message": "readme changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0OTIxODY4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#pullrequestreview-384921868", "createdAt": "2020-03-31T16:50:11Z", "commit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNjo1MDoxMVrOF-fAoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNzoxMzozMlrOF-f60A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA2NDA5Nw==", "bodyText": "This is the same as the code sample above in 44 - 52.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401064097", "createdAt": "2020-03-31T16:50:11Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java", "diffHunk": "@@ -34,4 +38,31 @@ public void createAsynchronousServiceBusReceiver() {\n             .queueName(\"<< QUEUE NAME >>\")\n             .buildAsyncClient();\n     }\n+\n+    /**\n+     * Code sample for creating an asynchronous Service Bus receiver using {@link DefaultAzureCredentialBuilder}.\n+     */\n+    public void createAsynchronousServiceBusReceiverWithAzureIdentity() {\n+        TokenCredential credential = new DefaultAzureCredentialBuilder()\n+            .build();\n+        ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n+            .credential(\"<<fully-qualified-namespace>>\", credential)\n+            .buildReceiverClientBuilder()\n+            .queueName(\"<<queue-name>>\")\n+            .buildAsyncClient();\n+    }\n+\n+    /**\n+     * Code sample for creating an asynchronous Service Bus receiver using Aad.\n+     */\n+    public void createAsynchronousServiceBusReceiverWithAad() {\n+        DefaultAzureCredential credential = new DefaultAzureCredentialBuilder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA2NDczMQ==", "bodyText": "TIME_OUT -> TIMEOUT", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401064731", "createdAt": "2020-03-31T16:51:10Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,109 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    private static final Duration TIME_OUT = Duration.ofSeconds(15);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA2NTEzNA==", "bodyText": "Rather than using an environment variable, the template of how one should look is easier to digest. Some of the other samples use this template.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401065134", "createdAt": "2020-03-31T16:51:47Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,109 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    private static final Duration TIME_OUT = Duration.ofSeconds(15);\n+\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA3NTE0Ng==", "bodyText": "I don't think this is a good sample, I think it would be better to show chained reactor operations that could take longer than the 15 seconds.\nFor example:\nclient.receive().flatMap(message -> {\n    // A sample of processing the message followed by a persisting the message logic.\n    return Mono.delay(Duration.ofSeconds(15).thenReturn(message);\n}).onErrorContinue((message, error) -> {\n    // Handle the message that caused the error while processing above. In this case, we'll abandon it and let someone else handle it.\n    client.abandon(message).block();\n})\n.flatMap(message -> {\n  // This is a message that was successfully processed. So we complete it.\n  return client.complete(message);\n})\n.subscribe();", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401075146", "createdAt": "2020-03-31T17:07:34Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleSample.java", "diffHunk": "@@ -0,0 +1,109 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.ReceiveMode;\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.concurrent.TimeUnit;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue and settle\n+ * it. Settling of message include accept, defer and abandon the message as needed.\n+ */\n+public class ReceiveMessageAndSettleSample {\n+    private static final Duration TIME_OUT = Duration.ofSeconds(15);\n+\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");\n+\n+        // Create a receiver.\n+        // \"<<fully-qualified-namespace>>\" will look similar to \"{your-namespace}.servicebus.windows.net\"\n+        // \"<<queue-name>>\" will be the name of the Service Bus queue instance you created\n+        // inside the Service Bus namespace.\n+\n+        ServiceBusReceiverAsyncClient receiverAsyncClient = new ServiceBusClientBuilder()\n+            .connectionString(connectionString)\n+            .buildReceiverClientBuilder()\n+            .receiveMode(ReceiveMode.PEEK_LOCK)\n+            .isLockAutoRenewed(true)\n+            .queueName(\"<<queue-name>>\")\n+            .isAutoComplete(false)\n+            .maxAutoLockRenewalDuration(Duration.ofSeconds(2))\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiverAsyncClient.receive()\n+            .subscribe(received -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA3NzU1Nw==", "bodyText": "Should we describe that these messages are also autocompleted?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401077557", "createdAt": "2020-03-31T17:11:11Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAsyncSample.java", "diffHunk": "@@ -0,0 +1,59 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import reactor.core.Disposable;\n+\n+import java.time.Duration;\n+\n+/**\n+ * Sample demonstrates how to receive an {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue using\n+ * connection string.\n+ */\n+public class ReceiveMessageAsyncSample {\n+    /**\n+     * Main method to invoke this demo on how to receive an {@link ServiceBusMessage} from an Azure Service Bus\n+     * Queue\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {\n+\n+        // The connection string value can be obtained by:\n+        // 1. Going to your Service Bus namespace in Azure Portal.\n+        // 2. Go to \"Shared access policies\"\n+        // 3. Copy the connection string for the \"RootManageSharedAccessKey\" policy.\n+        String connectionString = System.getenv(\"AZURE_SERVICEBUS_CONNECTION_STRING\");\n+\n+        // Create a receiver.\n+        // \"<<fully-qualified-namespace>>\" will look similar to \"{your-namespace}.servicebus.windows.net\"\n+        // \"<<queue-name>>\" will be the name of the Service Bus queue instance you created\n+        // inside the Service Bus namespace.\n+        ServiceBusReceiverAsyncClient receiverAsyncClient = new ServiceBusClientBuilder()\n+            .connectionString(connectionString)\n+            .buildReceiverClientBuilder()\n+            .queueName(\"<<queue-name>>\")\n+            .buildAsyncClient();\n+\n+        Disposable subscription = receiverAsyncClient.receive()\n+            .subscribe(message -> {\n+                System.out.println(\"Received Message Id:\" + message.getMessageId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA3ODIzMg==", "bodyText": "It's not a stream. You received a batch of, at most, 5 messages from the service bus queue. The data structure we return could be streamed.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401078232", "createdAt": "2020-03-31T17:12:19Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageStreamSyncSample.java", "diffHunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.core.util.IterableStream;\n+\n+import java.time.Duration;\n+\n+/**\n+ * Sample demonstrates how to receive a stream of {@link ServiceBusReceivedMessage} from an Azure Service Bus Queue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTA3ODk5Mg==", "bodyText": "Some of your samples you prefix with Async or SyncSample. It is not clear that it is a sync sample until you delve into the code.\nI don't think you need to highlight \"ConnectionString\" in the title.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r401078992", "createdAt": "2020-03-31T17:13:32Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/SendMessageBatchWithConnectionStringSample.java", "diffHunk": "@@ -0,0 +1,72 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.messaging.servicebus.models.CreateBatchOptions;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+\n+public class SendMessageBatchWithConnectionStringSample {\n+\n+    /**\n+     * Main method to invoke this demo on how to send an {@link ServiceBusMessageBatch} to an Azure Service Bus.\n+     *\n+     * @param args Unused arguments to the program.\n+     */\n+    public static void main(String[] args) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NzEyNDE5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#pullrequestreview-385712419", "createdAt": "2020-04-01T15:43:03Z", "commit": {"oid": "313d5decbdbcb88f1202023fb1570881bb78c5f1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2993a1960c59b271341766c70fad50e7270dcd9b", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2993a1960c59b271341766c70fad50e7270dcd9b", "committedDate": "2020-04-01T15:52:37Z", "message": "renaming classes and review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e1a9ac44bc8adda13013199dd48cc738373522b", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1e1a9ac44bc8adda13013199dd48cc738373522b", "committedDate": "2020-04-01T20:50:41Z", "message": "change continue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/8f7013b271eca494a2e5d8ab0a81944101f57120", "committedDate": "2020-04-02T06:24:21Z", "message": "review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NTY3Nzg5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#pullrequestreview-386567789", "createdAt": "2020-04-02T15:57:00Z", "commit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNTo1NzowMFrOF_yFzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowMjoyMVrOF_yUsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyNTI5NQ==", "bodyText": "This is unresolved. The section for this snippet is to highlight using AAD. We still want to highlight showing DefaultAzureCredential.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r402425295", "createdAt": "2020-04-02T15:57:00Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -89,14 +92,44 @@ Follow the instructions in [Creating a service principal using Azure Portal][app\n service principal and a client secret. The corresponding `clientId` and `tenantId` for the service principal can be\n obtained from the [App registration page][app_registration_page].\n \n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L60-L69 -->\n+```java\n+ClientSecretCredential credential = new ClientSecretCredentialBuilder()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5Njg2MA=="}, "originalCommit": {"oid": "a49d81d867716a99ce02b1666ca70436f3ae1466"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyNTg2MQ==", "bodyText": "This snippet is unnecessary.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r402425861", "createdAt": "2020-04-02T15:57:47Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -131,28 +148,38 @@ ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n     .buildAsyncClient();\n ```\n \n-### Send message to Queue or Topic\n+The snippet below creates an asynchronous Service Bus receiver with default token credential.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyNjIzMw==", "bodyText": "The backticks are not needed. These are not pieces of code or a particular class. Same with your other links for receiving.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r402426233", "createdAt": "2020-04-02T15:58:16Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -131,28 +148,38 @@ ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n     .buildAsyncClient();\n ```\n \n-### Send message to Queue or Topic\n+The snippet below creates an asynchronous Service Bus receiver with default token credential.\n+\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L47-L53 -->\n+```java\n+TokenCredential credential = new DefaultAzureCredentialBuilder()\n+    .build();\n+ServiceBusReceiverAsyncClient receiver = new ServiceBusClientBuilder()\n+    .credential(\"<<fully-qualified-namespace>>\", credential)\n+    .receiver()\n+    .queueName(\"<<queue-name>>\")\n+    .buildAsyncClient();\n+```\n+### Send Message Examples\n \n You'll need to create an asynchronous [`ServiceBusSenderAsyncClient`][ServiceBusSenderAsyncClient] or\n a synchronous [`ServiceBusSenderClient`][ServiceBusSenderClient] to send message. Each sender can send message to either, a queue,\n or topic.\n \n-#### Create a Sender and send message to queue or topic\n-Example of sending a message asynchronously is documented [here][sample-send-async-message].\n+* [`Sending a message asynchronously`][sample-send-async-message].", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyNjkzNg==", "bodyText": "Do not check in binaries. Delete: jacoco.exec", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r402426936", "createdAt": "2020-04-02T15:59:12Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -252,11 +279,16 @@ Guidelines](./CONTRIBUTING.md) for more information.\n [LogLevels]: ../../core/azure-core/src/main/java/com/azure/core/util/logging/ClientLogger.java\n [RetryOptions]: ../../core/azure-core-amqp/src/main/java/com/azure/core/amqp/AmqpRetryOptions.java\n [ServiceBusSenderAsyncClient]: ./src/main/java/com/azure/messaging/servicebus/ServiceBusSenderAsyncClient.java\n-[ServiceBusReceiverAsyncClient]: ./src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\n+[ServiceBusSenderClient]: ./src/main/java/com/azure/messaging/servicebus/ServiceBusSenderClient.java\n+[ServiceBusReceiverClient]: ./src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverClient.java\n+[ServiceBusReceiverAsyncClient]: ./src/main/java/com/azure/messaging/servicebus/ServiceBusReceiverAsyncClient.java\n [service_bus_connection_string]: https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-create-namespace-portal#get-the-connection-string\n-[sample-send-async-message]: ./src/samples/java/com/azure/messaging/servicebus/MessageSendAsyncSample.java\n-[sample-receive-async-message]: ./src/samples/java/com/azure/messaging/servicebus/MessageReceiverAsyncClient.java\n-[sample-send-async-aad-message]: ./src/samples/java/com/azure/messaging/servicebus/SendMessageWithAzureIdentity.java\n-[sample-receive-async-aad-message]: ./src/samples/java/com/azure/messaging/servicebus/ReceiveMessageWithAzureIDentity.java\n+[sample-send-async-message]: ./src/samples/java/com/azure/messaging/servicebus/SendMessageAsyncSample.java\n+[sample-receive-async-message]: ./src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAsyncSample.java\n+[sample-send-async-aad-message]: ./src/samples/java/com/azure/messaging/servicebus/SendMessageWithAzureIdentityAsyncSample.java\n+[sample-receive-async-aad-message]: ./src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAzureIdentityAsyncSample.java\n+[sample-send-batch-messages]: ./src/samples/java/com/azure/messaging/servicebus/SendMessageBatchSyncSample.java\n+[sample-receive-message-and-settle]: ./src/samples/java/com/azure/messaging/servicebus/ReceiveMessageAndSettleAsyncSample.java\n+[sample-receive-message-batch-synchronously]: ./src/samples/java/com/azure/messaging/servicebus/ReceiveMessageBatchSyncSample.java\n \n ![Impressions](https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-java%2Fsdk%2Fservicebus%2Fazure-messaging-servicebus%2FREADME.png)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyNzY0Mw==", "bodyText": "One of the receive samples can be co-opted to create a topic subscription.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r402427643", "createdAt": "2020-04-02T16:00:15Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/README.md", "diffHunk": "@@ -121,7 +138,7 @@ ServiceBusSenderAsyncClient sender = new ServiceBusClientBuilder()\n \n The snippet below creates an asynchronous Service Bus receiver.\n \n-<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L30-L35 -->\n+<!-- embedme ./src/samples/java/com/azure/messaging/servicebus/ReadmeSamples.java#L35-L40 -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyOTEwNg==", "bodyText": "ReceiveMessageSyncSample is sufficient. We are returning a collection, the batch is implied by the return type.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#discussion_r402429106", "createdAt": "2020-04-02T16:02:21Z", "author": {"login": "conniey"}, "path": "sdk/servicebus/azure-messaging-servicebus/src/samples/java/com/azure/messaging/servicebus/ReceiveMessageBatchSyncSample.java", "diffHunk": "@@ -0,0 +1,52 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f7013b271eca494a2e5d8ab0a81944101f57120"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31e4b6fa7b9d30e5533603e3dd1592f7754d6b92", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/31e4b6fa7b9d30e5533603e3dd1592f7754d6b92", "committedDate": "2020-04-02T17:18:18Z", "message": "readme changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dc0ecbf825144cd30a9efcdec1f7582db37be19", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1dc0ecbf825144cd30a9efcdec1f7582db37be19", "committedDate": "2020-04-02T18:50:51Z", "message": "readme changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NzI2OTA5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9653#pullrequestreview-386726909", "createdAt": "2020-04-02T19:21:35Z", "commit": {"oid": "1dc0ecbf825144cd30a9efcdec1f7582db37be19"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1405, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}