{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0Mzg1Mjg3", "number": 13855, "title": "[TA] Added offset and length support in CatorizedEntities and LinkedEntitiesMatch", "bodyText": "Added \"Offset\" and \"length\" support in CatorizedEntities and LinkedEntitiesMatch\n\n\nAdditional, refactor other endpoints tests exception sentiment analysis. It will be handle in  #13855", "createdAt": "2020-08-07T04:41:43Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855", "merged": true, "mergeCommit": {"oid": "20ed3326627ab2ca7b7f5aadb4a36645ba9e1774"}, "closed": true, "closedAt": "2020-08-10T21:33:21Z", "author": {"login": "mssfang"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8c2GHAH2gAyNDY0Mzg1Mjg3OjJlOTVkMjliOGQyMDU4ZTkzZDk5ZDJiZGQwOGE4MTkyY2Q3ZTQ3NzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9nw3WAH2gAyNDY0Mzg1Mjg3OjI5OTMzNzdlNWFjZjllMGZkOWEyZjVjOWFlNzAwODU4M2VlZGMzNmE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e95d29b8d2058e93d99d2bdd08a8192cd7e4770", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2e95d29b8d2058e93d99d2bdd08a8192cd7e4770", "committedDate": "2020-08-07T04:37:58Z", "message": "added offset and length for CategorizedEntities and LinkedEntitesMatch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80", "committedDate": "2020-08-07T05:45:42Z", "message": "refactor other endpoint besides analyze sentiment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMzc4OTIw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#pullrequestreview-463378920", "createdAt": "2020-08-07T14:53:55Z", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxNDo1Mzo1NlrOG9dBsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxNDo1NjoxOFrOG9dHXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA5MTg4OQ==", "bodyText": "@maririos made this comment on my PR too, but it would be clearer if this was \"Get the offset of the linked entity match text\"", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#discussion_r467091889", "createdAt": "2020-08-07T14:53:56Z", "author": {"login": "iscai-msft"}, "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/LinkedEntityMatch.java", "diffHunk": "@@ -51,4 +79,22 @@ public double getConfidenceScore() {\n     public String getText() {\n         return this.text;\n     }\n+\n+    /**\n+     * Get the offset of entity text.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA5MzM0MQ==", "bodyText": "next time can you make these other test changes in another PR, it's a little hard to see what actual tests were added for offset and length", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#discussion_r467093341", "createdAt": "2020-08-07T14:56:18Z", "author": {"login": "iscai-msft"}, "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsClientTestBase.java", "diffHunk": "@@ -484,6 +521,8 @@ static void validateCategorizedEntity(\n         CategorizedEntity expectedCategorizedEntity, CategorizedEntity actualCategorizedEntity) {\n         assertEquals(expectedCategorizedEntity.getSubcategory(), actualCategorizedEntity.getSubcategory());\n         assertEquals(expectedCategorizedEntity.getText(), actualCategorizedEntity.getText());\n+        assertEquals(expectedCategorizedEntity.getOffset(), actualCategorizedEntity.getOffset());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTAzNzM2", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#pullrequestreview-463503736", "createdAt": "2020-08-07T18:02:31Z", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODowMjozMVrOG9jDbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODowMjozMVrOG9jDbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE5MDYzOQ==", "bodyText": "should we keep the offset and length after confidenceScore so that someone that depended on previous constructor would use this by just appending properties?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#discussion_r467190639", "createdAt": "2020-08-07T18:02:31Z", "author": {"login": "maririos"}, "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/CategorizedEntity.java", "diffHunk": "@@ -43,6 +53,28 @@ public CategorizedEntity(String text, EntityCategory category, String subcategor\n         this.category = category;\n         this.subcategory = subcategory;\n         this.confidenceScore = confidenceScore;\n+        this.offset = 0;\n+        this.length = 0;\n+    }\n+\n+    /**\n+     * Creates a {@link CategorizedEntity} model that describes entity.\n+     *\n+     * @param text The entity text as appears in the request.\n+     * @param category The entity category, such as Person/Location/Org/SSN etc.\n+     * @param subcategory The entity subcategory, such as Age/Year/TimeRange etc.\n+     * @param offset The start position for the entity text.\n+     * @param length The length for the entity text.\n+     * @param confidenceScore A confidence score between 0 and 1 of the extracted entity.\n+     */\n+    public CategorizedEntity(String text, EntityCategory category, String subcategory, int offset, int length,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTA0MDk3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#pullrequestreview-463504097", "createdAt": "2020-08-07T18:03:10Z", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODowMzoxMFrOG9jEhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODowMzoxMFrOG9jEhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE5MDkxNg==", "bodyText": "linked entity text...", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#discussion_r467190916", "createdAt": "2020-08-07T18:03:10Z", "author": {"login": "maririos"}, "path": "sdk/textanalytics/azure-ai-textanalytics/src/main/java/com/azure/ai/textanalytics/models/LinkedEntityMatch.java", "diffHunk": "@@ -51,4 +79,22 @@ public double getConfidenceScore() {\n     public String getText() {\n         return this.text;\n     }\n+\n+    /**\n+     * Get the offset of entity text.\n+     *\n+     * @return The offset of entity text.\n+     */\n+    public int getOffset() {\n+        return offset;\n+    }\n+\n+    /**\n+     * Get the length of entity text.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTA5OTA5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#pullrequestreview-463509909", "createdAt": "2020-08-07T18:13:07Z", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODoxMzowN1rOG9jXPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODoxMzowN1rOG9jXPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE5NTcxMQ==", "bodyText": "is this just cleanup? or what is the motivation for these changes", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#discussion_r467195711", "createdAt": "2020-08-07T18:13:07Z", "author": {"login": "maririos"}, "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TestUtils.java", "diffHunk": "@@ -144,22 +144,24 @@\n      * @return A {@link DetectLanguageResultCollection}.\n      */\n     static DetectLanguageResultCollection getExpectedBatchDetectedLanguages() {\n-        DetectedLanguage detectedLanguage1 = new DetectedLanguage(\"English\", \"en\", 0.0, null);\n-        DetectedLanguage detectedLanguage2 = new DetectedLanguage(\"Spanish\", \"es\", 0.0, null);\n-        DetectedLanguage detectedLanguage3 = new DetectedLanguage(\"(Unknown)\", \"(Unknown)\", 0.0, null);\n-\n-        TextDocumentStatistics textDocumentStatistics1 = new TextDocumentStatistics(26, 1);\n-        TextDocumentStatistics textDocumentStatistics2 = new TextDocumentStatistics(40, 1);\n-        TextDocumentStatistics textDocumentStatistics3 = new TextDocumentStatistics(6, 1);\n+        final TextDocumentBatchStatistics textDocumentBatchStatistics = new TextDocumentBatchStatistics(3, 3, 0, 3);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTExMjUx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#pullrequestreview-463511251", "createdAt": "2020-08-07T18:15:18Z", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODoxNToxOFrOG9jbew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODoxNToxOFrOG9jbew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE5Njc5NQ==", "bodyText": "my concern with having all this tests to look at specific values is that if the service changes something about their model, then our test will fail.\nMake sure whenever u call this that the model-version is set to avoid it", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#discussion_r467196795", "createdAt": "2020-08-07T18:15:18Z", "author": {"login": "maririos"}, "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TestUtils.java", "diffHunk": "@@ -217,32 +218,40 @@ static RecognizeEntitiesResult getExpectedBatchCategorizedEntities2() {\n      * @return A {@link RecognizeLinkedEntitiesResultCollection}.\n      */\n     static RecognizeLinkedEntitiesResultCollection getExpectedBatchLinkedEntities() {\n-        LinkedEntityMatch linkedEntityMatch1 = new LinkedEntityMatch(\"Seattle\", 0.0);\n-        LinkedEntityMatch linkedEntityMatch2 = new LinkedEntityMatch(\"Microsoft\", 0.0);\n+        final TextDocumentBatchStatistics textDocumentBatchStatistics = new TextDocumentBatchStatistics(2, 2, 0, 2);\n+        final List<RecognizeLinkedEntitiesResult> recognizeLinkedEntitiesResultList =\n+            Arrays.asList(\n+                new RecognizeLinkedEntitiesResult(\n+                    \"0\", new TextDocumentStatistics(44, 1), null,\n+                    new LinkedEntityCollection(new IterableStream<>(getLinkedEntitiesList1()), null)),\n+                new RecognizeLinkedEntitiesResult(\n+                    \"1\", new TextDocumentStatistics(20, 1), null,\n+                    new LinkedEntityCollection(new IterableStream<>(getLinkedEntitiesList2()), null)));\n+        return new RecognizeLinkedEntitiesResultCollection(recognizeLinkedEntitiesResultList, DEFAULT_MODEL_VERSION, textDocumentBatchStatistics);\n+    }\n \n-        LinkedEntity linkedEntity1 = new LinkedEntity(\n-            \"Seattle\", new IterableStream<>(Collections.singletonList(linkedEntityMatch1)),\n+    /**\n+     * Helper method to get the expected linked Entities List 1\n+     */\n+    static List<LinkedEntity> getLinkedEntitiesList1() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "originalPosition": 84}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTEyNTI0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13855#pullrequestreview-463512524", "createdAt": "2020-08-07T18:17:29Z", "commit": {"oid": "bd47a0dc9a2716a875d7cbe7e63e2f8221fcfc80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2993377e5acf9e0fd9a2f5c9ae7008583eedc36a", "author": {"user": {"login": "mssfang", "name": "Shawn Fang"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2993377e5acf9e0fd9a2f5c9ae7008583eedc36a", "committedDate": "2020-08-10T19:55:08Z", "message": "address feedbacks"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 857, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}