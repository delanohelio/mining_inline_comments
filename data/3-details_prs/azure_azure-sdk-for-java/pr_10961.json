{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MzI4MzYy", "number": 10961, "title": "Update scan_for_unreleased_dependencies.ps1", "bodyText": "There was issue this week where a library was allowed to ship GA with beta dependencies. The fix here is to ensure that any dependency that not an external_dependency (aka, something we build/ship) has its version checked. If the version is beta and the library being shipped is GA, then we fail. The output would look like this:\ninputGroupId=com.azure\ninputArtifactId=azure-core-amqp\nserviceDirectory=C:\\src\\azure-sdk-for-java\\sdk\\core\nFound pom file with matching groupId(com.azure)/artifactId(azure-core-amqp), pomFile=C:\\src\\azure-sdk-for-java\\sdk\\core\\azure-core-amqp\\pom.xml\nLibrary is not releasing as Beta, version=1.1.1\nError: Cannot release non-beta libraries with beta dependencies. dependency={x-version-update;com.azure:azure-core;current}, version=1.6.0-beta.1", "createdAt": "2020-05-08T16:50:21Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10961", "merged": true, "mergeCommit": {"oid": "3777e2d02395b9c482142e330aeb667bf7adaa28"}, "closed": true, "closedAt": "2020-05-08T19:52:27Z", "author": {"login": "JimSuplizio"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfUqkeAH2gAyNDE1MzI4MzYyOjQ5ZTFmY2UzYjA0ZDZkYzhkNDg4OWI5ZDVmMGU2OWNmOTgzYzRjODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfZUSLgFqTQwODU1NDYxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "49e1fce3b04d6dc8d4889b9d5f0e69cf983c4c80", "author": {"user": {"login": "JimSuplizio", "name": "James Suplizio"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/49e1fce3b04d6dc8d4889b9d5f0e69cf983c4c80", "committedDate": "2020-05-08T16:42:20Z", "message": "Update dep scanner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4Mzc0OTUw", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10961#pullrequestreview-408374950", "createdAt": "2020-05-08T16:52:31Z", "commit": {"oid": "49e1fce3b04d6dc8d4889b9d5f0e69cf983c4c80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4Mzg1MTMy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10961#pullrequestreview-408385132", "createdAt": "2020-05-08T17:08:29Z", "commit": {"oid": "49e1fce3b04d6dc8d4889b9d5f0e69cf983c4c80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NTU0NjE5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10961#pullrequestreview-408554619", "createdAt": "2020-05-08T22:07:31Z", "commit": {"oid": "49e1fce3b04d6dc8d4889b9d5f0e69cf983c4c80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQyMjowNzozMVrOGS1Hng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQyMjowNzozMVrOGS1Hng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM5Nzg1NA==", "bodyText": "I think it is actually a good idea to do a check for both internal and external dependencies. I'd suggest we use the SemVer.ps1 script we have under common and check to see if our version and if it is not prerelease then we should error for any dependency that is marked as a prerelease.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10961#discussion_r422397854", "createdAt": "2020-05-08T22:07:31Z", "author": {"login": "weshaggard"}, "path": "eng/versioning/scan_for_unreleased_dependencies.ps1", "diffHunk": "@@ -87,6 +87,21 @@ Get-ChildItem -Path $serviceDirectory -Filter pom*.xml -Recurse -File | ForEach-\n                         Write-Error-With-Color \"Error: Cannot release non-beta libraries with beta_ dependencies. dependency=$($versionUpdateTag)\"\n                     }\n                     continue\n+                } else {\n+                    # If this is an external dependency then continue\n+                    if ($versionUpdateTag -match \"external_dependency}\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49e1fce3b04d6dc8d4889b9d5f0e69cf983c4c80"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4405, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}