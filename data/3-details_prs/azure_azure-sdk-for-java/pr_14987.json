{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzMDU3MDI0", "number": 14987, "title": "feat(samples): Components samples", "bodyText": "Add Components samples\nMove serialization package from implementation to core. We have models here that we are exposing to the user so they should not be in the implementation package.", "createdAt": "2020-09-09T18:56:54Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987", "merged": true, "mergeCommit": {"oid": "4f90c1cd025d2818eaa31fb58814e48a9aaa3938"}, "closed": true, "closedAt": "2020-09-09T20:57:44Z", "author": {"login": "azabbasi"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHRJd_AFqTQ4NTMyMTI4Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHSTQpAH2gAyNDgzMDU3MDI0OjgyMTRiOWI2OTU5MTAyMWQzZTcxNTdjOWNhNjg3NWZmMDQ0NWM2YTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzIxMjg3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485321287", "createdAt": "2020-09-09T19:13:25Z", "commit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToxMzoyNlrOHPWCww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToxMzoyNlrOHPWCww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg1MTg0Mw==", "bodyText": "wouldn't we want to iterate over the created models list and use those Ids to log the success statement here?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#discussion_r485851843", "createdAt": "2020-09-09T19:13:26Z", "author": {"login": "abhipsaMisra"}, "path": "sdk/digitaltwins/azure-digitaltwins-core/src/samples/java/com/azure/digitaltwins/core/ComponentSyncSamples.java", "diffHunk": "@@ -0,0 +1,158 @@\n+package com.azure.digitaltwins.core;\n+\n+import com.azure.core.http.policy.HttpLogOptions;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.util.Context;\n+import com.azure.digitaltwins.core.helpers.ConsoleLogger;\n+import com.azure.digitaltwins.core.helpers.SamplesArguments;\n+import com.azure.digitaltwins.core.helpers.SamplesConstants;\n+import com.azure.digitaltwins.core.helpers.UniqueIdHelper;\n+import com.azure.digitaltwins.core.implementation.models.ErrorResponseException;\n+import com.azure.digitaltwins.core.serialization.BasicDigitalTwin;\n+import com.azure.digitaltwins.core.serialization.DigitalTwinMetadata;\n+import com.azure.digitaltwins.core.serialization.ModelProperties;\n+import com.azure.digitaltwins.core.util.UpdateOperationUtility;\n+import com.azure.identity.ClientSecretCredentialBuilder;\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+\n+import javax.net.ssl.HttpsURLConnection;\n+import java.io.IOException;\n+import java.util.*;\n+\n+public class ComponentSyncSamples {\n+    private static DigitalTwinsClient client;\n+    private static final ObjectMapper mapper = new ObjectMapper();\n+\n+    public static void main(String[] args) throws IOException, InterruptedException {\n+\n+        SamplesArguments parsedArguments = new SamplesArguments(args);\n+\n+        client = new DigitalTwinsClientBuilder()\n+            .tokenCredential(\n+                new ClientSecretCredentialBuilder()\n+                    .tenantId(parsedArguments.getTenantId())\n+                    .clientId(parsedArguments.getClientId())\n+                    .clientSecret(parsedArguments.getClientSecret())\n+                    .build()\n+            )\n+            .endpoint(parsedArguments.getDigitalTwinEndpoint())\n+            .httpLogOptions(\n+                new HttpLogOptions()\n+                    .setLogLevel(parsedArguments.getHttpLogDetailLevel()))\n+            .buildClient();\n+\n+        runComponentSample();\n+    }\n+\n+    public static void runComponentSample() throws JsonProcessingException {\n+\n+        ConsoleLogger.printHeader(\"COMPONENT SAMPLES\");\n+\n+        // For the purpose of this example we will create temporary models using a random model Ids.\n+        // We have to make sure these model Ids are unique within the DT instance.\n+\n+        String componentModelId = UniqueIdHelper.getUniqueModelId(SamplesConstants.TemporaryComponentModelPrefix, client);\n+        String modelId = UniqueIdHelper.getUniqueModelId(SamplesConstants.TemporaryModelPrefix, client);\n+        String basicDigitalTwinId = UniqueIdHelper.getUniqueDigitalTwinId(SamplesConstants.TemporaryTwinPrefix, client);\n+\n+        String newComponentModelPayload = SamplesConstants.TemporaryComponentModelPayload\n+            .replace(SamplesConstants.ComponentId, componentModelId);\n+\n+        String newModelPayload = SamplesConstants.TemporaryModelWithComponentPayload\n+            .replace(SamplesConstants.ModelId, modelId)\n+            .replace(SamplesConstants.ComponentId, componentModelId);\n+\n+        List<String> modelsList = new ArrayList<>(Arrays.asList(newComponentModelPayload, newModelPayload));\n+\n+        ConsoleLogger.printHeader(\"Create Models\");\n+        // We now create all the models (including components)\n+        client.createModels(modelsList);\n+\n+        ConsoleLogger.print(\"Created models: \" + componentModelId + \" and \" + modelId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "originalPosition": 72}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzI5Mzc2", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485329376", "createdAt": "2020-09-09T19:18:58Z", "commit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToxODo1OVrOHPWNrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToxODo1OVrOHPWNrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg1NDYzOQ==", "bodyText": "Could you add some comments to these helper methods, describing their user-cases.\nAlso, just FYI - Jonathan recommended that we don't use println, I have asked for clarification on if we should use printf or logger.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#discussion_r485854639", "createdAt": "2020-09-09T19:18:59Z", "author": {"login": "abhipsaMisra"}, "path": "sdk/digitaltwins/azure-digitaltwins-core/src/samples/java/com/azure/digitaltwins/core/helpers/ConsoleLogger.java", "diffHunk": "@@ -7,21 +7,27 @@\n     private static final String ANSI_RED = \"\\u001B[31m\";\n     private static final String ANSI_GREEN = \"\\u001B[32m\";\n     public static final String ANSI_YELLOW = \"\\u001B[33m\";\n+    public static final String ANSI_BLUE = \"\\u001B[34m\";\n     private static final String ANSI_CYAN = \"\\u001B[36m\";\n \n-    public static void PrintHeader(String message) {\n+    public static void printHeader(String message) {\n         System.out.println(ANSI_CYAN + \"\\n===\" + message.toUpperCase() + \"===\\n\" + ANSI_RESET);\n     }\n \n-    public static void PrintSuccess(String message) {\n-        System.out.println(ANSI_GREEN + message + ANSI_RESET);\n+    public static void print(String message) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzMwNzM0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485330734", "createdAt": "2020-09-09T19:19:47Z", "commit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToxOTo0N1rOHPWPYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToxOTo0N1rOHPWPYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg1NTA3Mw==", "bodyText": "This class should be annotated with @Fluent.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#discussion_r485855073", "createdAt": "2020-09-09T19:19:47Z", "author": {"login": "abhipsaMisra"}, "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/serialization/ComponentMetadata.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package com.azure.digitaltwins.core.serialization;\n+\n+import com.fasterxml.jackson.annotation.JsonAnyGetter;\n+import com.fasterxml.jackson.annotation.JsonAnySetter;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+/**\n+ * An optional helper class for deserializing a digital twin\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzMxMzYx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485331361", "createdAt": "2020-09-09T19:20:14Z", "commit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToyMDoxNFrOHPWQaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToyMDoxNFrOHPWQaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg1NTMzOQ==", "bodyText": "@Fluent here, as well", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#discussion_r485855339", "createdAt": "2020-09-09T19:20:14Z", "author": {"login": "abhipsaMisra"}, "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/serialization/ModelProperties.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package com.azure.digitaltwins.core.serialization;\n+\n+import com.fasterxml.jackson.annotation.JsonAnyGetter;\n+import com.fasterxml.jackson.annotation.JsonAnySetter;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+/**\n+ * Properties on a component that adhere to a specific model.\n+ */\n+public class ModelProperties {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzMxOTAz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485331903", "createdAt": "2020-09-09T19:20:35Z", "commit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzMyMTQ3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485332147", "createdAt": "2020-09-09T19:20:44Z", "commit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToyMDo0NFrOHPWRcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxOToyMDo0NFrOHPWRcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg1NTYwMw==", "bodyText": "While you are sprucing this up, we can actually do region sections in java, too.\n//region Models APIs\n...\n//endregion Models APIs\nIntellij will let you collapse the code just like how C# does", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#discussion_r485855603", "createdAt": "2020-09-09T19:20:44Z", "author": {"login": "timtay-microsoft"}, "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java", "diffHunk": "@@ -221,6 +226,10 @@ public void deleteDigitalTwin(String digitalTwinId)\n         return digitalTwinsAsyncClient.deleteDigitalTwinWithResponse(digitalTwinId, options, context).block();\n     }\n \n+    //==================================================================================================================================================\n+    // Relationship APIs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bce98ed429eef081b6dc61706edac4ec48587f05"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcd81cd86fe924e3c1932afc7b1209f739c19ca4", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fcd81cd86fe924e3c1932afc7b1209f739c19ca4", "committedDate": "2020-09-09T19:26:19Z", "message": "Move serialization package from implementation to the root package. Add Component samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e51904d3d9416702e155d3832abe9976ea25357", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7e51904d3d9416702e155d3832abe9976ea25357", "committedDate": "2020-09-09T19:27:03Z", "message": "Fix build issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08eeb7e4bc9164b1551bca2273bd6a2fc59444cd", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/08eeb7e4bc9164b1551bca2273bd6a2fc59444cd", "committedDate": "2020-09-09T19:29:55Z", "message": "rebase onto master"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fef2515b21d5faafc70c4d978ab72d166fdd9a72", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fef2515b21d5faafc70c4d978ab72d166fdd9a72", "committedDate": "2020-09-09T19:24:57Z", "message": "Merge branch 'master' into feature/adt/azabbasi/componentSamples"}, "afterCommit": {"oid": "08eeb7e4bc9164b1551bca2273bd6a2fc59444cd", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/08eeb7e4bc9164b1551bca2273bd6a2fc59444cd", "committedDate": "2020-09-09T19:29:55Z", "message": "rebase onto master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03cab61d050679dceb88c553a1ced7d403a30c86", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/03cab61d050679dceb88c553a1ced7d403a30c86", "committedDate": "2020-09-09T19:33:02Z", "message": "Refactor constant variable names."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42f454cd3757ca471e32d8d49570a21be3652414", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/42f454cd3757ca471e32d8d49570a21be3652414", "committedDate": "2020-09-09T19:39:16Z", "message": "Update DigitalTwinsClient.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbcc3df37ead89a705b3eb7f93927b46fee3957f", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dbcc3df37ead89a705b3eb7f93927b46fee3957f", "committedDate": "2020-09-09T19:48:28Z", "message": "Address comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzU2ODM4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14987#pullrequestreview-485356838", "createdAt": "2020-09-09T19:54:37Z", "commit": {"oid": "dbcc3df37ead89a705b3eb7f93927b46fee3957f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a683ebdb243249c369f769b0beb0985c0e46c6f6", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a683ebdb243249c369f769b0beb0985c0e46c6f6", "committedDate": "2020-09-09T20:00:34Z", "message": "Add Model API tests to ADT, fix a few ADT implementation details (#14791)\n\nFixed a few test assets as well. While they were accepted by the service when the context field was just one value, the service always returns a model such that the context is an array with one value instead. This makes it easier to test that models retrieved from the service match our expectations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e633fec93e3e3ebcf4e14227695a362d9c61acbe", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e633fec93e3e3ebcf4e14227695a362d9c61acbe", "committedDate": "2020-09-09T20:14:31Z", "message": "Move serialization package from implementation to the root package. Add Component samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15bc60cdc544527a37d6cf587d3fc454637cab3c", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/15bc60cdc544527a37d6cf587d3fc454637cab3c", "committedDate": "2020-09-09T20:14:32Z", "message": "Fix build issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa2488338ca0f1a3e092b50705d94518b2168860", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/aa2488338ca0f1a3e092b50705d94518b2168860", "committedDate": "2020-09-09T20:14:32Z", "message": "rebase onto master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f04811227a9381dee5856e0e5968371d0561707b", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f04811227a9381dee5856e0e5968371d0561707b", "committedDate": "2020-09-09T20:14:49Z", "message": "Refactor constant variable names."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe0e76ff95d30b3175eb173d1ff898466e99fc9e", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fe0e76ff95d30b3175eb173d1ff898466e99fc9e", "committedDate": "2020-09-09T20:14:50Z", "message": "Update DigitalTwinsClient.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc8b31384497889439857b8c0ed30a037b1a1489", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/dc8b31384497889439857b8c0ed30a037b1a1489", "committedDate": "2020-09-09T20:14:50Z", "message": "Address comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07f8256a25cd3b920d3246c96269bfb1e3c96ca2", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/07f8256a25cd3b920d3246c96269bfb1e3c96ca2", "committedDate": "2020-09-09T20:32:34Z", "message": "Rebase master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8214b9b69591021d3e7157c9ca6875ff0445c6a6", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/8214b9b69591021d3e7157c9ca6875ff0445c6a6", "committedDate": "2020-09-09T20:34:02Z", "message": "Merge branch 'feature/adt/azabbasi/componentSamples' of https://github.com/Azure/azure-sdk-for-java into feature/adt/azabbasi/componentSamples"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3537, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}