{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MjExOTQ5", "number": 13593, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMTowODo0NlrOEUM50Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMTozMzowOVrOEUNgFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjE4Mzg1OnYy", "diffSide": "RIGHT", "path": "sdk/identity/azure-identity/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMTowODo0NlrOG6WwnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxOToyMDoxM1rOG7FxVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg0MzQ4NA==", "bodyText": "Should we also mention about EnvironmentCredential not being available too  and then attempting below chain of creds ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r463843484", "createdAt": "2020-07-31T21:08:46Z", "author": {"login": "g2vinay"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -159,7 +118,14 @@ If the environment configuration is not present or incomplete, the `DefaultAzure\n require platform support. See the\n [managed identity documentation](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/services-support-managed-identities) for more details on this.\n \n-If a managed identity isn't available, and the application is running on Windows, the `DefaultAzureCredential` will then attempt reading from a local user token cache. `AZURE_USERNAME` environment variable must be specified if there are more than one accounts in the cache. The local token cache is shared between this library, Visual Studio (2019+), and Azure CLI. See [Enable applications for shared token cache credential](#enable-applications-for-shared-token-cache-credential) to see how to populate / clean up this token cache.\n+If a managed identity isn't available, the `DefaultAzureCredential` will then attempt reading the signed in user from a set of local developer tools, in the following order", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 129}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDYxMzcxOA==", "bodyText": "It's mentioned in line 117 - just not shown in GitHub diff", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r464613718", "createdAt": "2020-08-03T19:20:13Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -159,7 +118,14 @@ If the environment configuration is not present or incomplete, the `DefaultAzure\n require platform support. See the\n [managed identity documentation](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/services-support-managed-identities) for more details on this.\n \n-If a managed identity isn't available, and the application is running on Windows, the `DefaultAzureCredential` will then attempt reading from a local user token cache. `AZURE_USERNAME` environment variable must be specified if there are more than one accounts in the cache. The local token cache is shared between this library, Visual Studio (2019+), and Azure CLI. See [Enable applications for shared token cache credential](#enable-applications-for-shared-token-cache-credential) to see how to populate / clean up this token cache.\n+If a managed identity isn't available, the `DefaultAzureCredential` will then attempt reading the signed in user from a set of local developer tools, in the following order", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg0MzQ4NA=="}, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 129}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjI0NDA1OnYy", "diffSide": "RIGHT", "path": "sdk/identity/azure-identity/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMToxOTozNVrOG6XOIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxOTozNzowNFrOG7GPgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1MTA0MQ==", "bodyText": "Client Id is required for Interactive Browser Cred, so this won't work as it is.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r463851041", "createdAt": "2020-07-31T21:19:35Z", "author": {"login": "g2vinay"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -274,14 +250,39 @@ public void createUserNamePasswordCredential() {\n }\n ```\n \n+### Authenticating a user account interactively in the browser\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `InteractiveBrowserCredential`. There's also [a compilable sample](../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java) to create a Key Vault secret client you can copy-paste. \n+\n+See more about how to configure an AAD application for interactive browser authentication and listen on a port locally in [Enable applications for interactive browser oauth 2 flow](#enable-applications-for-interactive-browser-oauth-2-flow)\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L190-L203 -->\n+```java\n+/**\n+ * Authenticate interactively in the browser.\n+ */\n+public void createInteractiveBrowserCredential() {\n+    InteractiveBrowserCredential interactiveBrowserCredential = new InteractiveBrowserCredentialBuilder()\n+        .port(8765)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 229}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDYyMTQ0Mg==", "bodyText": "added", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r464621442", "createdAt": "2020-08-03T19:37:04Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -274,14 +250,39 @@ public void createUserNamePasswordCredential() {\n }\n ```\n \n+### Authenticating a user account interactively in the browser\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `InteractiveBrowserCredential`. There's also [a compilable sample](../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java) to create a Key Vault secret client you can copy-paste. \n+\n+See more about how to configure an AAD application for interactive browser authentication and listen on a port locally in [Enable applications for interactive browser oauth 2 flow](#enable-applications-for-interactive-browser-oauth-2-flow)\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L190-L203 -->\n+```java\n+/**\n+ * Authenticate interactively in the browser.\n+ */\n+public void createInteractiveBrowserCredential() {\n+    InteractiveBrowserCredential interactiveBrowserCredential = new InteractiveBrowserCredentialBuilder()\n+        .port(8765)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1MTA0MQ=="}, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 229}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjI1NDczOnYy", "diffSide": "RIGHT", "path": "sdk/identity/azure-identity/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMToyMToyMVrOG6XTSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyODoyNFrOG7HpfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1MjM2Mw==", "bodyText": "Maybe elaborate the comment here ?\nrequired only for Windows.\nNo configuration needed for Linux / Mac", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r463852363", "createdAt": "2020-07-31T21:21:21Z", "author": {"login": "g2vinay"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -300,10 +301,76 @@ public void createAuthCodeCredential() {\n }\n ```\n \n+### Authenticating a user account with Azure CLI\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `AzureCliCredential` on a workstation with Azure CLI installed and signed in.\n+\n+See more about how to configure Azure CLI in [Sign in Azure CLI for AzureCliCredential](#sign-in-azure-cli-for-azureclicredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L148-L159 -->\n+```java\n+/**\n+ * Authenticate with Azure CLI.\n+ */\n+public void createAzureCliCredential() {\n+    AzureCliCredential cliCredential = new AzureCliCredentialBuilder().build();\n+\n+    // Azure SDK client builders accept the credential as a parameter\n+    SecretClient client = new SecretClientBuilder()\n+        .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+        .credential(cliCredential)\n+        .buildClient();\n+}\n+```\n+\n+### Authenticating a user account with IntelliJ IDEA\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `IntelliJCredential` on a workstation with IntelliJ IDEA installed, and the user has signed in with an Azure account.\n+\n+See more about how to configure your IntelliJ IDEA in [Sign in Azure Toolkit for IntelliJ for IntelliJCredential](#sign-in-azure-toolkit-for-intellij-for-intellijcredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L174-L188 -->\n+```java\n+/**\n+ * Authenticate with IntelliJ IDEA.\n+ */\n+public void createIntelliJCredential() {\n+    IntelliJCredential intelliJCredential = new IntelliJCredentialBuilder()\n+        // KeePass configuration required for Windows", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 291}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NDQ3Ng==", "bodyText": "modified", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r464644476", "createdAt": "2020-08-03T20:28:24Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -300,10 +301,76 @@ public void createAuthCodeCredential() {\n }\n ```\n \n+### Authenticating a user account with Azure CLI\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `AzureCliCredential` on a workstation with Azure CLI installed and signed in.\n+\n+See more about how to configure Azure CLI in [Sign in Azure CLI for AzureCliCredential](#sign-in-azure-cli-for-azureclicredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L148-L159 -->\n+```java\n+/**\n+ * Authenticate with Azure CLI.\n+ */\n+public void createAzureCliCredential() {\n+    AzureCliCredential cliCredential = new AzureCliCredentialBuilder().build();\n+\n+    // Azure SDK client builders accept the credential as a parameter\n+    SecretClient client = new SecretClientBuilder()\n+        .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+        .credential(cliCredential)\n+        .buildClient();\n+}\n+```\n+\n+### Authenticating a user account with IntelliJ IDEA\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `IntelliJCredential` on a workstation with IntelliJ IDEA installed, and the user has signed in with an Azure account.\n+\n+See more about how to configure your IntelliJ IDEA in [Sign in Azure Toolkit for IntelliJ for IntelliJCredential](#sign-in-azure-toolkit-for-intellij-for-intellijcredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L174-L188 -->\n+```java\n+/**\n+ * Authenticate with IntelliJ IDEA.\n+ */\n+public void createIntelliJCredential() {\n+    IntelliJCredential intelliJCredential = new IntelliJCredentialBuilder()\n+        // KeePass configuration required for Windows", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1MjM2Mw=="}, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 291}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjI1ODM0OnYy", "diffSide": "RIGHT", "path": "sdk/identity/azure-identity/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMToyMjoyNFrOG6XVOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyODo0MVrOG7Hp9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1Mjg1OQ==", "bodyText": "Should this be moved to  first in the order ?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r463852859", "createdAt": "2020-07-31T21:22:24Z", "author": {"login": "g2vinay"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -334,6 +401,129 @@ public void createChainedCredential() {\n }\n ```\n \n+## Configurations\n+### Creating a Service Principal with the Azure CLI\n+Use the [Azure CLI][azure_cli] snippet below to create/get client secret credentials.\n+\n+ * Create a service principal and configure its access to Azure resources:\n+\n+    ```bash\n+    az ad sp create-for-rbac -n <your-application-name> --skip-assignment\n+    ```\n+\n+    Output:\n+\n+    ```json\n+    {\n+        \"appId\": \"generated-app-ID\",\n+        \"displayName\": \"dummy-app-name\",\n+        \"name\": \"http://dummy-app-name\",\n+        \"password\": \"random-password\",\n+        \"tenant\": \"tenant-ID\"\n+    }\n+    ```\n+\n+* Use the returned credentials above to set  **AZURE\\_CLIENT\\_ID**(appId), **AZURE\\_CLIENT\\_SECRET**(password) and **AZURE\\_TENANT\\_ID**(tenant) [environment variables](#environment-variables).\n+\n+### Enable applications for device code flow\n+In order to authenticate a user through device code flow, you need to go to Azure Active Directory on Azure Portal and find you app registration and enable the following 2 configurations:\n+\n+![device code enable](./images/devicecode-enable.png)\n+\n+This will let the application authenticate, but the application still doesn't have permission to log you into Active Directory, or access resources on your behalf. Open API Permissions, and enable Microsoft Graph, and the resources you want to access, e.g., Azure Service Management, Key Vault, etc:\n+\n+![device code permissions](./images/devicecode-permissions.png)\n+\n+Note that you also need to be the admin of your tenant to grant consent to your application when you login for the first time. Also note after 2018 your Active Directory may require your application to be multi-tenant. Select \"Accounts in any organizational directory\" under Authentication panel (where you enabled Device Code) to make your application a multi-tenant app.\n+\n+### Enable applications for interactive browser oauth 2 flow\n+You need to register an application in Azure Active Directory with permissions to login on behalf of a user to use InteractiveBrowserCredential. Follow all the steps above for device code flow to register your application to support logging you into Active Directory and access certain resources. Note the same limitations apply that an admin of your tenant must grant consent to your application before any user account can login.\n+\n+You may notice in `InteractiveBrowserCredentialBuilder`, a port number is required, and you need to add the redirect URL on this page too:\n+\n+![interactive redirect uri](./images/interactive-redirecturi.png)\n+\n+In this case, the port number is 8765.\n+\n+### Enable applications for oauth 2 auth code flow\n+You need the same application registered as in [Enable applications for interactive browser oauth 2 flow](#enable-applications-for-interactive-browser-oauth-2-flow), except that the redirect URL must be an API endpoint on your web application where the auth code must be handled as a query parameter.\n+\n+### Enable applications for shared token cache credential\n+You will need to have Visual Studio 2019 installed. Login to Visual Studio with your org ID or live ID and you are ready to use shared token cache credential.\n+\n+Open your Visual Studio account settings and you can see the list of accounts with cached tokens in the red rectangle below. Note the Personalization Account is not related to this token cache. You can delete all info and tokens of this account in the token cache by removing the account here and closing the Visual Studio window.\n+\n+![vs2019 account settings](./images/vs2019-account-settings.png)\n+\n+If you have multiple accounts listed here, you must specify the `AZURE_USERNAME` environment variable to the email of the account you'd like to use for all the authentications.\n+\n+If you see an error \"MSAL V3 Deserialization failed\", try clearing the cache in `C:\\Users\\{username}\\AppData\\Local\\.IdentityService`.\n+\n+### Sign in Azure CLI for AzureCliCredential\n+Sign in [Azure CLI][azure_cli] with command\n+\n+```bash\n+az login\n+```\n+\n+as a user, or \n+\n+```bash\n+az login --service-principal --username <client-id> --password <client-secret> --tenant <tenant-id>\n+```\n+\n+as a service principal.\n+\n+If the account / service principal has access to multiple tenants, make sure the desired tenant or subscription is in the state \"Enabled\" in the output from command:\n+\n+```bash\n+az account list\n+```\n+\n+Before you use AzureCliCredential in the code, run\n+\n+```bash\n+az account get-access-token\n+```\n+\n+to verify the account has been successfully configured.\n+\n+You may have to repeat this process after a certain period (usually a few weeks to a few months based on the refresh token validity configured in your organization). AzureCliCredential will prompt you to sign in again.\n+\n+### Sign in Azure Toolkit for IntelliJ for IntelliJCredential\n+\n+In your IntelliJ window, open File -> Settings -> Plugins. Search \u201cAzure Toolkit for IntelliJ\u201d in the marketplace. Install and restart IDE.\n+\n+Now you should be able to find a new menu item Tools -> Azure -> Azure Sign In\u2026\n+\n+![intellij sign in](./images/intellij-sign-in.png)\n+\n+Device Login will help you login as a user account. Follow the instructions to login on the login.microsoftonline.com website with the device code. IntelliJ will prompt you to select your subscriptions. Please select the \n+\n+On Windows, you will also need the KeePass database path to read IntelliJ credentials. You can find the path in IntelliJ settings under File -> Settings -> Appearance & Behavior -> System Settings -> Passwords:\n+\n+![intellij keepass](./images/intellij-keepass.png)\n+\n+### Sign in Visual Studio Code for VisualStudioCodeCredential\n+\n+The Visual Studio Code authentication is handled by an integration with the Azure Account extension. To use, install the Azure Account extension, then use View->Command Palette to execute the \u201cAzure: Sign In\u201d command:\n+\n+![vscode sign in](./images/vscode-sign-in.png)\n+\n+This will open a browser that allows you to sign in to Azure. Once you have completed the login process, you can close the browser as directed. Running your application (either in the debugger or anywhere on the development machine) will use the credential from your sign-in.\n+\n+![vscode logged in](./images/vscode-logged-in.png)\n+\n+### Configure `DefaultAzureCredential`\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 451}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NDU5OA==", "bodyText": "Moved", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r464644598", "createdAt": "2020-08-03T20:28:41Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -334,6 +401,129 @@ public void createChainedCredential() {\n }\n ```\n \n+## Configurations\n+### Creating a Service Principal with the Azure CLI\n+Use the [Azure CLI][azure_cli] snippet below to create/get client secret credentials.\n+\n+ * Create a service principal and configure its access to Azure resources:\n+\n+    ```bash\n+    az ad sp create-for-rbac -n <your-application-name> --skip-assignment\n+    ```\n+\n+    Output:\n+\n+    ```json\n+    {\n+        \"appId\": \"generated-app-ID\",\n+        \"displayName\": \"dummy-app-name\",\n+        \"name\": \"http://dummy-app-name\",\n+        \"password\": \"random-password\",\n+        \"tenant\": \"tenant-ID\"\n+    }\n+    ```\n+\n+* Use the returned credentials above to set  **AZURE\\_CLIENT\\_ID**(appId), **AZURE\\_CLIENT\\_SECRET**(password) and **AZURE\\_TENANT\\_ID**(tenant) [environment variables](#environment-variables).\n+\n+### Enable applications for device code flow\n+In order to authenticate a user through device code flow, you need to go to Azure Active Directory on Azure Portal and find you app registration and enable the following 2 configurations:\n+\n+![device code enable](./images/devicecode-enable.png)\n+\n+This will let the application authenticate, but the application still doesn't have permission to log you into Active Directory, or access resources on your behalf. Open API Permissions, and enable Microsoft Graph, and the resources you want to access, e.g., Azure Service Management, Key Vault, etc:\n+\n+![device code permissions](./images/devicecode-permissions.png)\n+\n+Note that you also need to be the admin of your tenant to grant consent to your application when you login for the first time. Also note after 2018 your Active Directory may require your application to be multi-tenant. Select \"Accounts in any organizational directory\" under Authentication panel (where you enabled Device Code) to make your application a multi-tenant app.\n+\n+### Enable applications for interactive browser oauth 2 flow\n+You need to register an application in Azure Active Directory with permissions to login on behalf of a user to use InteractiveBrowserCredential. Follow all the steps above for device code flow to register your application to support logging you into Active Directory and access certain resources. Note the same limitations apply that an admin of your tenant must grant consent to your application before any user account can login.\n+\n+You may notice in `InteractiveBrowserCredentialBuilder`, a port number is required, and you need to add the redirect URL on this page too:\n+\n+![interactive redirect uri](./images/interactive-redirecturi.png)\n+\n+In this case, the port number is 8765.\n+\n+### Enable applications for oauth 2 auth code flow\n+You need the same application registered as in [Enable applications for interactive browser oauth 2 flow](#enable-applications-for-interactive-browser-oauth-2-flow), except that the redirect URL must be an API endpoint on your web application where the auth code must be handled as a query parameter.\n+\n+### Enable applications for shared token cache credential\n+You will need to have Visual Studio 2019 installed. Login to Visual Studio with your org ID or live ID and you are ready to use shared token cache credential.\n+\n+Open your Visual Studio account settings and you can see the list of accounts with cached tokens in the red rectangle below. Note the Personalization Account is not related to this token cache. You can delete all info and tokens of this account in the token cache by removing the account here and closing the Visual Studio window.\n+\n+![vs2019 account settings](./images/vs2019-account-settings.png)\n+\n+If you have multiple accounts listed here, you must specify the `AZURE_USERNAME` environment variable to the email of the account you'd like to use for all the authentications.\n+\n+If you see an error \"MSAL V3 Deserialization failed\", try clearing the cache in `C:\\Users\\{username}\\AppData\\Local\\.IdentityService`.\n+\n+### Sign in Azure CLI for AzureCliCredential\n+Sign in [Azure CLI][azure_cli] with command\n+\n+```bash\n+az login\n+```\n+\n+as a user, or \n+\n+```bash\n+az login --service-principal --username <client-id> --password <client-secret> --tenant <tenant-id>\n+```\n+\n+as a service principal.\n+\n+If the account / service principal has access to multiple tenants, make sure the desired tenant or subscription is in the state \"Enabled\" in the output from command:\n+\n+```bash\n+az account list\n+```\n+\n+Before you use AzureCliCredential in the code, run\n+\n+```bash\n+az account get-access-token\n+```\n+\n+to verify the account has been successfully configured.\n+\n+You may have to repeat this process after a certain period (usually a few weeks to a few months based on the refresh token validity configured in your organization). AzureCliCredential will prompt you to sign in again.\n+\n+### Sign in Azure Toolkit for IntelliJ for IntelliJCredential\n+\n+In your IntelliJ window, open File -> Settings -> Plugins. Search \u201cAzure Toolkit for IntelliJ\u201d in the marketplace. Install and restart IDE.\n+\n+Now you should be able to find a new menu item Tools -> Azure -> Azure Sign In\u2026\n+\n+![intellij sign in](./images/intellij-sign-in.png)\n+\n+Device Login will help you login as a user account. Follow the instructions to login on the login.microsoftonline.com website with the device code. IntelliJ will prompt you to select your subscriptions. Please select the \n+\n+On Windows, you will also need the KeePass database path to read IntelliJ credentials. You can find the path in IntelliJ settings under File -> Settings -> Appearance & Behavior -> System Settings -> Passwords:\n+\n+![intellij keepass](./images/intellij-keepass.png)\n+\n+### Sign in Visual Studio Code for VisualStudioCodeCredential\n+\n+The Visual Studio Code authentication is handled by an integration with the Azure Account extension. To use, install the Azure Account extension, then use View->Command Palette to execute the \u201cAzure: Sign In\u201d command:\n+\n+![vscode sign in](./images/vscode-sign-in.png)\n+\n+This will open a browser that allows you to sign in to Azure. Once you have completed the login process, you can close the browser as directed. Running your application (either in the debugger or anywhere on the development machine) will use the credential from your sign-in.\n+\n+![vscode logged in](./images/vscode-logged-in.png)\n+\n+### Configure `DefaultAzureCredential`\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1Mjg1OQ=="}, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 451}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjI1OTQ3OnYy", "diffSide": "RIGHT", "path": "sdk/keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMToyMjo1MlrOG6XV6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyODo1NlrOG7Hqcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1MzAzMg==", "bodyText": "client id too, needs to be added.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r463853032", "createdAt": "2020-07-31T21:22:52Z", "author": {"login": "g2vinay"}, "path": "sdk/keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java", "diffHunk": "@@ -137,4 +145,60 @@ public void createChainedCredential() {\n             .buildClient();\n     }\n \n+    /**\n+     * Authenticate with Azure CLI.\n+     */\n+    public void createAzureCliCredential() {\n+        AzureCliCredential cliCredential = new AzureCliCredentialBuilder().build();\n+\n+        // Azure SDK client builders accept the credential as a parameter\n+        SecretClient client = new SecretClientBuilder()\n+            .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+            .credential(cliCredential)\n+            .buildClient();\n+    }\n+\n+    /**\n+     * Authenticate with Visual Studio Code.\n+     */\n+    public void createVisualStudioCodeCredential() {\n+        VisualStudioCodeCredential visualStudioCodeCredential = new VisualStudioCodeCredentialBuilder().build();\n+\n+        // Azure SDK client builders accept the credential as a parameter\n+        SecretClient client = new SecretClientBuilder()\n+            .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+            .credential(visualStudioCodeCredential)\n+            .buildClient();\n+    }\n+\n+    /**\n+     * Authenticate with IntelliJ IDEA.\n+     */\n+    public void createIntelliJCredential() {\n+        IntelliJCredential intelliJCredential = new IntelliJCredentialBuilder()\n+            // KeePass configuration required for Windows\n+            .keePassDatabasePath(\"C:\\\\Users\\\\user\\\\AppData\\\\Roaming\\\\JetBrains\\\\IdeaIC2020.1\\\\c.kdbx\")\n+            .build();\n+\n+        // Azure SDK client builders accept the credential as a parameter\n+        SecretClient client = new SecretClientBuilder()\n+            .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+            .credential(intelliJCredential)\n+            .buildClient();\n+    }\n+\n+    /**\n+     * Authenticate interactively in the browser.\n+     */\n+    public void createInteractiveBrowserCredential() {\n+        InteractiveBrowserCredential interactiveBrowserCredential = new InteractiveBrowserCredentialBuilder()\n+            .port(8765)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NDcyMg==", "bodyText": "Added", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r464644722", "createdAt": "2020-08-03T20:28:56Z", "author": {"login": "jianghaolu"}, "path": "sdk/keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java", "diffHunk": "@@ -137,4 +145,60 @@ public void createChainedCredential() {\n             .buildClient();\n     }\n \n+    /**\n+     * Authenticate with Azure CLI.\n+     */\n+    public void createAzureCliCredential() {\n+        AzureCliCredential cliCredential = new AzureCliCredentialBuilder().build();\n+\n+        // Azure SDK client builders accept the credential as a parameter\n+        SecretClient client = new SecretClientBuilder()\n+            .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+            .credential(cliCredential)\n+            .buildClient();\n+    }\n+\n+    /**\n+     * Authenticate with Visual Studio Code.\n+     */\n+    public void createVisualStudioCodeCredential() {\n+        VisualStudioCodeCredential visualStudioCodeCredential = new VisualStudioCodeCredentialBuilder().build();\n+\n+        // Azure SDK client builders accept the credential as a parameter\n+        SecretClient client = new SecretClientBuilder()\n+            .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+            .credential(visualStudioCodeCredential)\n+            .buildClient();\n+    }\n+\n+    /**\n+     * Authenticate with IntelliJ IDEA.\n+     */\n+    public void createIntelliJCredential() {\n+        IntelliJCredential intelliJCredential = new IntelliJCredentialBuilder()\n+            // KeePass configuration required for Windows\n+            .keePassDatabasePath(\"C:\\\\Users\\\\user\\\\AppData\\\\Roaming\\\\JetBrains\\\\IdeaIC2020.1\\\\c.kdbx\")\n+            .build();\n+\n+        // Azure SDK client builders accept the credential as a parameter\n+        SecretClient client = new SecretClientBuilder()\n+            .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+            .credential(intelliJCredential)\n+            .buildClient();\n+    }\n+\n+    /**\n+     * Authenticate interactively in the browser.\n+     */\n+    public void createInteractiveBrowserCredential() {\n+        InteractiveBrowserCredential interactiveBrowserCredential = new InteractiveBrowserCredentialBuilder()\n+            .port(8765)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1MzAzMg=="}, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjI4MTgyOnYy", "diffSide": "RIGHT", "path": "sdk/identity/azure-identity/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMTozMzowOVrOG6XjfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyODo1MFrOG7HqOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1NjUwOQ==", "bodyText": "Sign in Visual Studio Code for...  ---->.  Sign in Visual Studio Code Azure Extension for....", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r463856509", "createdAt": "2020-07-31T21:33:09Z", "author": {"login": "g2vinay"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -300,10 +301,76 @@ public void createAuthCodeCredential() {\n }\n ```\n \n+### Authenticating a user account with Azure CLI\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `AzureCliCredential` on a workstation with Azure CLI installed and signed in.\n+\n+See more about how to configure Azure CLI in [Sign in Azure CLI for AzureCliCredential](#sign-in-azure-cli-for-azureclicredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L148-L159 -->\n+```java\n+/**\n+ * Authenticate with Azure CLI.\n+ */\n+public void createAzureCliCredential() {\n+    AzureCliCredential cliCredential = new AzureCliCredentialBuilder().build();\n+\n+    // Azure SDK client builders accept the credential as a parameter\n+    SecretClient client = new SecretClientBuilder()\n+        .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+        .credential(cliCredential)\n+        .buildClient();\n+}\n+```\n+\n+### Authenticating a user account with IntelliJ IDEA\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `IntelliJCredential` on a workstation with IntelliJ IDEA installed, and the user has signed in with an Azure account.\n+\n+See more about how to configure your IntelliJ IDEA in [Sign in Azure Toolkit for IntelliJ for IntelliJCredential](#sign-in-azure-toolkit-for-intellij-for-intellijcredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L174-L188 -->\n+```java\n+/**\n+ * Authenticate with IntelliJ IDEA.\n+ */\n+public void createIntelliJCredential() {\n+    IntelliJCredential intelliJCredential = new IntelliJCredentialBuilder()\n+        // KeePass configuration required for Windows\n+        .keePassDatabasePath(\"C:\\\\Users\\\\user\\\\AppData\\\\Roaming\\\\JetBrains\\\\IdeaIC2020.1\\\\c.kdbx\")\n+        .build();\n+\n+    // Azure SDK client builders accept the credential as a parameter\n+    SecretClient client = new SecretClientBuilder()\n+        .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+        .credential(intelliJCredential)\n+        .buildClient();\n+}\n+```\n+\n+### Authenticating a user account with Visual Studio Code\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `VisualStudioCodeCredential` on a workstation with Visual Studio Code installed, and the user has signed in with an Azure account.\n+\n+See more about how to configure your Visual Studio Code in [Sign in Visual Studio Code for VisualStudioCodeCredential](#sign-in-visual-studio-code-for-visualstudiocodecredential)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 306}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NDY2Nw==", "bodyText": "Modified", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13593#discussion_r464644667", "createdAt": "2020-08-03T20:28:50Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/README.md", "diffHunk": "@@ -300,10 +301,76 @@ public void createAuthCodeCredential() {\n }\n ```\n \n+### Authenticating a user account with Azure CLI\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `AzureCliCredential` on a workstation with Azure CLI installed and signed in.\n+\n+See more about how to configure Azure CLI in [Sign in Azure CLI for AzureCliCredential](#sign-in-azure-cli-for-azureclicredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L148-L159 -->\n+```java\n+/**\n+ * Authenticate with Azure CLI.\n+ */\n+public void createAzureCliCredential() {\n+    AzureCliCredential cliCredential = new AzureCliCredentialBuilder().build();\n+\n+    // Azure SDK client builders accept the credential as a parameter\n+    SecretClient client = new SecretClientBuilder()\n+        .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+        .credential(cliCredential)\n+        .buildClient();\n+}\n+```\n+\n+### Authenticating a user account with IntelliJ IDEA\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `IntelliJCredential` on a workstation with IntelliJ IDEA installed, and the user has signed in with an Azure account.\n+\n+See more about how to configure your IntelliJ IDEA in [Sign in Azure Toolkit for IntelliJ for IntelliJCredential](#sign-in-azure-toolkit-for-intellij-for-intellijcredential).\n+\n+<!-- embedme ../../keyvault/azure-security-keyvault-secrets/src/samples/java/com/azure/security/keyvault/secrets/IdentityReadmeSamples.java#L174-L188 -->\n+```java\n+/**\n+ * Authenticate with IntelliJ IDEA.\n+ */\n+public void createIntelliJCredential() {\n+    IntelliJCredential intelliJCredential = new IntelliJCredentialBuilder()\n+        // KeePass configuration required for Windows\n+        .keePassDatabasePath(\"C:\\\\Users\\\\user\\\\AppData\\\\Roaming\\\\JetBrains\\\\IdeaIC2020.1\\\\c.kdbx\")\n+        .build();\n+\n+    // Azure SDK client builders accept the credential as a parameter\n+    SecretClient client = new SecretClientBuilder()\n+        .vaultUrl(\"https://{YOUR_VAULT_NAME}.vault.azure.net\")\n+        .credential(intelliJCredential)\n+        .buildClient();\n+}\n+```\n+\n+### Authenticating a user account with Visual Studio Code\n+This example demonstrates authenticating the `KeyClient` from the [azure-security-keyvault-keys][keys_client_library] client library using the `VisualStudioCodeCredential` on a workstation with Visual Studio Code installed, and the user has signed in with an Azure account.\n+\n+See more about how to configure your Visual Studio Code in [Sign in Visual Studio Code for VisualStudioCodeCredential](#sign-in-visual-studio-code-for-visualstudiocodecredential)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg1NjUwOQ=="}, "originalCommit": {"oid": "13a0449007f7242483a0cf471155c37dd052f2b2"}, "originalPosition": 306}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4761, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}