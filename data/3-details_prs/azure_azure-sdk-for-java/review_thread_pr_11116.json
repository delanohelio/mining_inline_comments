{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3MDUwNTg0", "number": 11116, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNTo1NjowNVrOD8IZHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxOToxODoxOFrOD8NBmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0Mzc4NjUzOnYy", "diffSide": "RIGHT", "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNTo1NjowNVrOGU4dng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDoyMzo0NlrOGVCM0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTc5MA==", "bodyText": "Do we have any mechanisms available which will ensure a certain tracer is loaded if I happen to bring multiple? This can be a follow-up as it is definitely an edge case.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424549790", "createdAt": "2020-05-13T15:56:05Z", "author": {"login": "alzimmermsft"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -17,14 +17,13 @@\n  */\n public final class TracerProxy {\n \n-    private static final List<Tracer> TRACERS;\n+    private static Tracer TRACER;\n+\n     static {\n         ServiceLoader<Tracer> serviceLoader = ServiceLoader.load(Tracer.class);\n-        List<Tracer> tracers = new ArrayList<>();\n-        for (Tracer tracer : serviceLoader) {\n-            tracers.add(tracer);\n+        if (serviceLoader != null) {\n+            TRACER = serviceLoader.iterator().next();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0ODU5MA==", "bodyText": "Yeah, I think we could add a feature where a user preference could be preferred for a single implementation if multiple found.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424648590", "createdAt": "2020-05-13T18:33:30Z", "author": {"login": "samvaity"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -17,14 +17,13 @@\n  */\n public final class TracerProxy {\n \n-    private static final List<Tracer> TRACERS;\n+    private static Tracer TRACER;\n+\n     static {\n         ServiceLoader<Tracer> serviceLoader = ServiceLoader.load(Tracer.class);\n-        List<Tracer> tracers = new ArrayList<>();\n-        for (Tracer tracer : serviceLoader) {\n-            tracers.add(tracer);\n+        if (serviceLoader != null) {\n+            TRACER = serviceLoader.iterator().next();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTc5MA=="}, "originalCommit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY3MzQyOQ==", "bodyText": "Or, if there are multiple instances of tracer implementations, should we support all of them? Create spans on each tracer implementation?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424673429", "createdAt": "2020-05-13T19:16:49Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -17,14 +17,13 @@\n  */\n public final class TracerProxy {\n \n-    private static final List<Tracer> TRACERS;\n+    private static Tracer TRACER;\n+\n     static {\n         ServiceLoader<Tracer> serviceLoader = ServiceLoader.load(Tracer.class);\n-        List<Tracer> tracers = new ArrayList<>();\n-        for (Tracer tracer : serviceLoader) {\n-            tracers.add(tracer);\n+        if (serviceLoader != null) {\n+            TRACER = serviceLoader.iterator().next();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTc5MA=="}, "originalCommit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcwOTMzMA==", "bodyText": "There is no real use case to support multiple implementations, as users would always tie it with a single implementation of tracer to an exporter.\nIt brings in a lot of complexity for the users of the library to actually look to configure each span with a single tracer implementation and then the corresponding exporter for that tracer. As mentioned above, not a real use case and something only Java SDK was supporting.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424709330", "createdAt": "2020-05-13T20:23:46Z", "author": {"login": "samvaity"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -17,14 +17,13 @@\n  */\n public final class TracerProxy {\n \n-    private static final List<Tracer> TRACERS;\n+    private static Tracer TRACER;\n+\n     static {\n         ServiceLoader<Tracer> serviceLoader = ServiceLoader.load(Tracer.class);\n-        List<Tracer> tracers = new ArrayList<>();\n-        for (Tracer tracer : serviceLoader) {\n-            tracers.add(tracer);\n+        if (serviceLoader != null) {\n+            TRACER = serviceLoader.iterator().next();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU0OTc5MA=="}, "originalCommit": {"oid": "21fd4bf37fb3ab27656e2bb8076971c6b47adb62"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NDU0NTUyOnYy", "diffSide": "RIGHT", "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxOToxODoxOFrOGVADjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDozMToxMFrOGVCb1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY3NDE5MQ==", "bodyText": "Why does this API return Context? It's inconsistent with setAttribute() API which returns a void. Or, should setAttribute() return Context too since start() is also returning Context?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424674191", "createdAt": "2020-05-13T19:18:18Z", "author": {"login": "srnagar"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -84,11 +86,9 @@ public static void end(int responseCode, Throwable error, Context context) {\n      * @return An updated {@link Context} object.\n      */\n     public static Context setSpanName(String spanName, Context context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "320d89a5c537d037e45465683b832c1c38c8bfbf"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcxMzE3Mw==", "bodyText": "start() should return a Context as we update the context to hold the span that it just created/started.\nsetAttribute()  shouldn't because we do not have anything to return. We are actually just using the span information from the provided Context.\nsetSpanName() I think this method is redundant to set the span name as we already use the provided context for that. I see it is only used in RestProxy here.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11116#discussion_r424713173", "createdAt": "2020-05-13T20:31:10Z", "author": {"login": "samvaity"}, "path": "sdk/core/azure-core/src/main/java/com/azure/core/util/tracing/TracerProxy.java", "diffHunk": "@@ -84,11 +86,9 @@ public static void end(int responseCode, Throwable error, Context context) {\n      * @return An updated {@link Context} object.\n      */\n     public static Context setSpanName(String spanName, Context context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY3NDE5MQ=="}, "originalCommit": {"oid": "320d89a5c537d037e45465683b832c1c38c8bfbf"}, "originalPosition": 92}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4259, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}