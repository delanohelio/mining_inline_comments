{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MDE2ODIz", "number": 10419, "title": "POM-only release pipeline", "bodyText": "This PR adds the ability to release artifacts that are just a POM file (e.g. the packages in sdk/parents and sdk/boms. At the moment the pipeline is not capable of releasing com.microsoft.azure:azure-arm-parent because of an old dependency. When that dependency is brought up this pipeline will also be able to release the arm parent (/cc @weidongxu-microsoft).\nThe layout of artifacts in this pipeline are different to our regular pipelines (its basically a snapshot of a locally deployed repository). We'll probably end up moving to a similar structure for all of the Java pipelines.\nI wanted to get @scbedd and @JimSuplizio's input on what I've done here since they need to pass through the craggy nooks of version update land and the valley of doc publishing despair.\nI've done testing up to the point of releasing a staged repository using the java - parents pipeline and also validated that the tweaks I made to the Maven publishing script didn't break the existing pipelines with the java - template pipeline.", "createdAt": "2020-04-22T03:07:14Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419", "merged": true, "mergeCommit": {"oid": "b210b576dc4930684b175f080b9676e49fc08733"}, "closed": true, "closedAt": "2020-04-30T21:57:44Z", "author": {"login": "mitchdenny"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaIZ4CgFqTM5ODE5NjgxMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcc0RqXgFqTQwMzkwMjI0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MTk2ODEz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#pullrequestreview-398196813", "createdAt": "2020-04-22T13:35:37Z", "commit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzozNTozN1rOGJ2x0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzozNTozN1rOGJ2x0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4Nzg1Nw==", "bodyText": "Should this be commented out or removed?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r412987857", "createdAt": "2020-04-22T13:35:37Z", "author": {"login": "JimSuplizio"}, "path": "eng/scripts/Publish-MavenPackages.ps1", "diffHunk": "@@ -261,7 +266,7 @@ foreach ($packageDetail in $packageDetails) {\n \n   if ($RepositoryUrl -like \"https://pkgs.dev.azure.com/azure-sdk/public/*\") {\n     Write-Information \"GPG Signing and deploying package in one step to: $RepositoryUrl\"\n-    mvn gpg:sign-and-deploy-file \"--batch-mode\" \"$pomOption\" \"$fileOption\" \"$javadocOption\" \"$sourcesOption\" \"$filesOption\" $classifiersOption \"$typesOption\" \"-Durl=$RepositoryUrl\" \"$gpgexeOption\" \"-DrepositoryId=target-repo\" \"-Drepo.password=$RepositoryPassword\" \"--settings=$PSScriptRoot\\..\\maven.publish.settings.xml\"\n+    # mvn gpg:sign-and-deploy-file \"--batch-mode\" \"$pomOption\" \"$fileOption\" \"$javadocOption\" \"$sourcesOption\" \"$filesOption\" $classifiersOption \"$typesOption\" \"-Durl=$RepositoryUrl\" \"$gpgexeOption\" \"-DrepositoryId=target-repo\" \"-Drepo.password=$RepositoryPassword\" \"--settings=$PSScriptRoot\\..\\maven.publish.settings.xml\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MTk4MDU0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#pullrequestreview-398198054", "createdAt": "2020-04-22T13:36:52Z", "commit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzozNjo1MlrOGJ21vQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzozNjo1MlrOGJ21vQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4ODg2MQ==", "bodyText": "@mitchdenny please do not remove these comments from the pom file. These are the responsibility of the Cosmos team to remove before GA and I want them kept here.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r412988861", "createdAt": "2020-04-22T13:36:52Z", "author": {"login": "JimSuplizio"}, "path": "sdk/parents/azure-client-sdk-parent/pom.xml", "diffHunk": "@@ -1468,8 +1468,8 @@\n     <module>../../core/azure-core-test</module>\n     <module>../../core/azure-core-tracing-opentelemetry</module>\n     <module>../../cosmos/azure-cosmos</module>\n-    <module>../../cosmos/azure-cosmos-benchmark</module> <!-- CosmosSkip - Benchmark will go away, this is temporary -->\n-    <module>../../cosmos/azure-cosmos-examples</module> <!-- CosmosSkip - Examples will go away, this is temporary -->\n+    <module>../../cosmos/azure-cosmos-benchmark</module>\n+    <module>../../cosmos/azure-cosmos-examples</module> ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MjAxNDA5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#pullrequestreview-398201409", "createdAt": "2020-04-22T13:40:18Z", "commit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzo0MDoxOFrOGJ3BEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMzo0MDoxOFrOGJ3BEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5MTc2Mg==", "bodyText": "I'm under the impression that this is mainly for management track right now so why isn't that artifact listed here? In theory, we're done releasing client and data parent poms and have been for months.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r412991762", "createdAt": "2020-04-22T13:40:18Z", "author": {"login": "JimSuplizio"}, "path": "sdk/parents/ci.yml", "diffHunk": "@@ -31,11 +31,18 @@ pr:\n   paths:\n     include:\n       - sdk/parents/\n-\n+  \n stages:\n-  - stage: Placeholder\n-    jobs:\n-      - job: Placeholder\n-        steps:\n-          - script: |\n-              echo Hello, world!\n+  - template: ../../eng/pipelines/templates/stages/archetype-sdk-pom-only.yml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MjAxNzIz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#pullrequestreview-398201723", "createdAt": "2020-04-22T13:40:36Z", "commit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f9e0a56d76c6285a109d4c886d1812db55f84e8", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/3f9e0a56d76c6285a109d4c886d1812db55f84e8", "committedDate": "2020-04-26T23:15:53Z", "message": "Revising POM-only pipeline."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a8454bd7ec023fefefe0b168bb1bc1ecb3bfd1e", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a8454bd7ec023fefefe0b168bb1bc1ecb3bfd1e", "committedDate": "2020-04-26T23:15:54Z", "message": "Updated templates to use."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da95dce86d4aa0a2c2c9c0cd3552f4de5696f0b7", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/da95dce86d4aa0a2c2c9c0cd3552f4de5696f0b7", "committedDate": "2020-04-26T23:15:54Z", "message": "Tweak escaping."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "699de8e2b47596d1d790fcf27387a0e971bb87a1", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/699de8e2b47596d1d790fcf27387a0e971bb87a1", "committedDate": "2020-04-26T23:15:54Z", "message": "Fix parent name in ci.yml."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02a58905640db94054bec87735c6b88370b89f79", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/02a58905640db94054bec87735c6b88370b89f79", "committedDate": "2020-04-26T23:15:54Z", "message": "Try installing to a known location."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99238e334cc280c944cb3c71e1ab14d871e29f6a", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/99238e334cc280c944cb3c71e1ab14d871e29f6a", "committedDate": "2020-04-26T23:15:54Z", "message": "Skip GPG signing at build time."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1eb31a20be9496586c8bd300cbb099c995703b73", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1eb31a20be9496586c8bd300cbb099c995703b73", "committedDate": "2020-04-26T23:15:54Z", "message": "HACK: install build tools."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c172612d5f8c745cc6d6ee2a489e6565a92ce5cf", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c172612d5f8c745cc6d6ee2a489e6565a92ce5cf", "committedDate": "2020-04-26T23:15:54Z", "message": "Added xml suffix."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c36ec77786c237168b65cfe859680a90c9416f19", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c36ec77786c237168b65cfe859680a90c9416f19", "committedDate": "2020-04-26T23:15:55Z", "message": "Point deployment repository to staging directory."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0da8a9b7c7724f4845b2877c411fd00e3f240993", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0da8a9b7c7724f4845b2877c411fd00e3f240993", "committedDate": "2020-04-26T23:15:55Z", "message": "Fix merge issue."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96d3fbef6bcca351f901f5dc54e94140c77dc088", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/96d3fbef6bcca351f901f5dc54e94140c77dc088", "committedDate": "2020-04-26T23:15:55Z", "message": "Removed distribution management section."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "428f8f2034707f838876f532d98bc41d1ca600b6", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/428f8f2034707f838876f532d98bc41d1ca600b6", "committedDate": "2020-04-26T23:15:55Z", "message": "Remove arm parent from artifact list because parent version block."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ee3e3c49c0d770bf4e6cf1141af24a141bd62fe", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1ee3e3c49c0d770bf4e6cf1141af24a141bd62fe", "committedDate": "2020-04-26T23:15:55Z", "message": "Modify boms service directory to use new pipeline."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc2279031cad09a87db85c85140ca50b7442b6ec", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/bc2279031cad09a87db85c85140ca50b7442b6ec", "committedDate": "2020-04-26T23:15:55Z", "message": "Temporarily comment out some destructive publishing logic."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3dd2065c280213d3d517ca9bfbef29d6907b71d", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f3dd2065c280213d3d517ca9bfbef29d6907b71d", "committedDate": "2020-04-26T23:15:56Z", "message": "Comment out more parts of the pipeline for safety."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30a88fdccde52e31414c40d4f1d6149a40ec746f", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/30a88fdccde52e31414c40d4f1d6149a40ec746f", "committedDate": "2020-04-26T23:15:56Z", "message": "Add POM to the actual file list."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0749d05894dff764c1e7e5291ecd3b6c579a11a8", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0749d05894dff764c1e7e5291ecd3b6c579a11a8", "committedDate": "2020-04-26T23:15:56Z", "message": "Trying to get POM properly attached."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4aa736d9487baca483e503b49f54df0d8205090", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d4aa736d9487baca483e503b49f54df0d8205090", "committedDate": "2020-04-26T23:15:56Z", "message": "Fixed typo."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a16eef4c2d0d0e8502da129de2f906a8d9cac54", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1a16eef4c2d0d0e8502da129de2f906a8d9cac54", "committedDate": "2020-04-26T23:15:56Z", "message": "Fixed some more typos."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36546169db82ebfc4af2b8f039d15afa4582cbb9", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/36546169db82ebfc4af2b8f039d15afa4582cbb9", "committedDate": "2020-04-26T23:15:56Z", "message": "Should fix deployments ... I hope."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f35c43a2a5029c2d21503acf1c639ea2ab2cbf3", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0f35c43a2a5029c2d21503acf1c639ea2ab2cbf3", "committedDate": "2020-04-26T23:15:56Z", "message": "POM releases should now work end-to-end."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2946db4c83639ebc25a53d0314656da277411b02", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2946db4c83639ebc25a53d0314656da277411b02", "committedDate": "2020-04-26T23:15:57Z", "message": "Respond to PR feedback."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e9bc16014da6b1ae5db3bc71d218793f0ccb01d", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/7e9bc16014da6b1ae5db3bc71d218793f0ccb01d", "committedDate": "2020-04-22T23:15:14Z", "message": "Respond to PR feedback."}, "afterCommit": {"oid": "2946db4c83639ebc25a53d0314656da277411b02", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2946db4c83639ebc25a53d0314656da277411b02", "committedDate": "2020-04-26T23:15:57Z", "message": "Respond to PR feedback."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNjk5NTc4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#pullrequestreview-402699578", "createdAt": "2020-04-29T14:04:28Z", "commit": {"oid": "2946db4c83639ebc25a53d0314656da277411b02"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNDowNDoyOFrOGOAczw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNDowOTo0OFrOGOAsmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzM0MDYyMw==", "bodyText": "nit: This change is neither correct nor necessary, please undo the changes to this file and remove from this PR.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r417340623", "createdAt": "2020-04-29T14:04:28Z", "author": {"login": "JimSuplizio"}, "path": "sdk/parents/azure-client-sdk-parent/pom.xml", "diffHunk": "@@ -1470,7 +1470,7 @@\n     <module>../../core/azure-core-tracing-opentelemetry</module>\n     <module>../../cosmos/azure-cosmos</module>\n     <module>../../cosmos/azure-cosmos-benchmark</module> <!-- CosmosSkip - Benchmark will go away, this is temporary -->\n-    <module>../../cosmos/azure-cosmos-examples</module> <!-- CosmosSkip - Examples will go away, this is temporary -->\n+    <module>../../cosmos/azure-cosmos-examples</module> <!-- CosmosSkip - Benchmark will go away, this is temporary -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2946db4c83639ebc25a53d0314656da277411b02"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzM0NDY2NA==", "bodyText": "To be 100% clear: the client and data parent poms should really not need to be released ever again. The only parent pom that we know we're guaranteed to have to release at some point and time in the future is azure-arm-parent which management's parent. That should definitely be one of the artifacts listed below.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r417344664", "createdAt": "2020-04-29T14:09:48Z", "author": {"login": "JimSuplizio"}, "path": "sdk/parents/ci.yml", "diffHunk": "@@ -31,11 +31,18 @@ pr:\n   paths:\n     include:\n       - sdk/parents/\n-\n+  \n stages:\n-  - stage: Placeholder\n-    jobs:\n-      - job: Placeholder\n-        steps:\n-          - script: |\n-              echo Hello, world!\n+  - template: ../../eng/pipelines/templates/stages/archetype-sdk-pom-only.yml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5MTc2Mg=="}, "originalCommit": {"oid": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be68690c000be04f5527cd645bf6509bb77dcfe4", "author": {"user": {"login": "mitchdenny", "name": "Mitch Denny"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/be68690c000be04f5527cd645bf6509bb77dcfe4", "committedDate": "2020-04-29T23:05:01Z", "message": "Fix cut and paste issue from revert."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzOTAyMjQ1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#pullrequestreview-403902245", "createdAt": "2020-04-30T21:50:19Z", "commit": {"oid": "be68690c000be04f5527cd645bf6509bb77dcfe4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4762, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}