{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNzE5MTAx", "number": 9415, "title": "update default azure credential config", "bodyText": "Fixes #9131", "createdAt": "2020-03-24T01:12:25Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415", "merged": true, "mergeCommit": {"oid": "4d08eac2097d1908eab2e751868720af3cbd9ad9"}, "closed": true, "closedAt": "2020-04-03T00:42:52Z", "author": {"login": "g2vinay"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQoUKpAH2gAyMzkyNzE5MTAxOjE1YTRhMGUxYjdmZWQzMjEyZjhhMTY0M2I3MGI1MmIyOTZkNTZlMzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcT1nkhAH2gAyMzkyNzE5MTAxOjhlY2NkMzQwZWU2MWVkZTg0MDI3ZDhhMjg3MmE1MDQ1MjIzYjUyNzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "15a4a0e1b7fed3212f8a1643b70b52b296d56e34", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/15a4a0e1b7fed3212f8a1643b70b52b296d56e34", "committedDate": "2020-03-24T01:07:06Z", "message": "update default azure credential config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a377a1dfa839b62efd94cbf6691620d135aa8c4c", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a377a1dfa839b62efd94cbf6691620d135aa8c4c", "committedDate": "2020-03-24T20:20:34Z", "message": "update tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzEyNjU0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-381312654", "createdAt": "2020-03-25T16:19:04Z", "commit": {"oid": "a377a1dfa839b62efd94cbf6691620d135aa8c4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjoxOTowNFrOF7jKWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjoxOTowNFrOF7jKWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4NjM5NA==", "bodyText": "Do you think that we need the boolean parameter? Should builder.excludeEnvironmentCredential() just set excludeEnvironmentCredential to true?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#discussion_r397986394", "createdAt": "2020-03-25T16:19:04Z", "author": {"login": "schaabs"}, "path": "sdk/identity/azure-identity/src/main/java/com/azure/identity/DefaultAzureCredentialBuilder.java", "diffHunk": "@@ -23,6 +34,57 @@ public DefaultAzureCredentialBuilder authorityHost(String authorityHost) {\n         return this;\n     }\n \n+\n+    /**\n+     * Specifies whether the {@link EnvironmentCredential} will be excluded from the {@link DefaultAzureCredential}\n+     * authentication flow. Setting to true disables reading authentication details from the process' environment\n+     * variables.\n+     *\n+     * @param shouldExclude the status indicating to exclude the credential or not.\n+     * @return An updated instance of this builder with the Environment credential exclusion set as specified.\n+     */\n+    public DefaultAzureCredentialBuilder excludeEnvironmentCredential(boolean shouldExclude) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a377a1dfa839b62efd94cbf6691620d135aa8c4c"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzE0MTQ1", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-381314145", "createdAt": "2020-03-25T16:20:38Z", "commit": {"oid": "a377a1dfa839b62efd94cbf6691620d135aa8c4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjoyMDozOVrOF7jPAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjoyMDozOVrOF7jPAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4NzU4NA==", "bodyText": "In .NET the interactive browser credential is also part of the DefaultAzureCredential but it is excluded by default.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#discussion_r397987584", "createdAt": "2020-03-25T16:20:39Z", "author": {"login": "schaabs"}, "path": "sdk/identity/azure-identity/src/main/java/com/azure/identity/DefaultAzureCredentialBuilder.java", "diffHunk": "@@ -12,6 +17,12 @@\n  * @see DefaultAzureCredential\n  */\n public class DefaultAzureCredentialBuilder extends CredentialBuilderBase<DefaultAzureCredentialBuilder> {\n+    private boolean excludeEnvironmentCredential;\n+    private boolean excludeManagedIdentityCredential;\n+    private boolean excludeSharedTokenCacheCredential;\n+    private boolean excludeAzureCliCredential;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a377a1dfa839b62efd94cbf6691620d135aa8c4c"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fbbc63146b39ec168542e42bb028c4201733252", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6fbbc63146b39ec168542e42bb028c4201733252", "committedDate": "2020-03-31T19:58:14Z", "message": "update the setters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6ad2f66962a7a1c8366f884e63f23e0055a0b7b7", "committedDate": "2020-03-31T20:11:01Z", "message": "update tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MDAzNjUx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-386003651", "createdAt": "2020-04-01T22:52:24Z", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1MjoyNFrOF_Vc_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1MjoyNFrOF_Vc_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NjA5Mg==", "bodyText": "Is there a reason to build a List in the builder and convert to ArrayDeque here?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#discussion_r401956092", "createdAt": "2020-04-01T22:52:24Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/src/main/java/com/azure/identity/DefaultAzureCredential.java", "diffHunk": "@@ -32,13 +32,9 @@\n      * If these environment variables are not available, then this will use the Shared MSAL\n      * token cache.\n      *\n-     * @param identityClientOptions the options to configure the IdentityClient\n+     * @param tokenCredentials the list of credentials to execute for authentication.\n      */\n-    DefaultAzureCredential(IdentityClientOptions identityClientOptions) {\n-        super(new ArrayDeque<>(Arrays.asList(new EnvironmentCredential(identityClientOptions),\n-            new ManagedIdentityCredential(null, identityClientOptions),\n-            new SharedTokenCacheCredential(null, null, \"04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\n-                identityClientOptions),\n-            new AzureCliCredential(identityClientOptions))));\n+    DefaultAzureCredential(List<TokenCredential> tokenCredentials) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MDA0NjYy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-386004662", "createdAt": "2020-04-01T22:54:53Z", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1NDo1NFrOF_Vglw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1NDo1NFrOF_Vglw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NzAxNQ==", "bodyText": "We can simply build a Deque here?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#discussion_r401957015", "createdAt": "2020-04-01T22:54:54Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/src/main/java/com/azure/identity/DefaultAzureCredentialBuilder.java", "diffHunk": "@@ -50,6 +107,31 @@ public DefaultAzureCredentialBuilder executorService(ExecutorService executorSer\n      * @return a {@link DefaultAzureCredential} with the current configurations.\n      */\n     public DefaultAzureCredential build() {\n-        return new DefaultAzureCredential(identityClientOptions);\n+        return new DefaultAzureCredential(getCredentialsChain());\n+    }\n+\n+    private List<TokenCredential> getCredentialsChain() {\n+        List<TokenCredential> output = new ArrayList<>(4);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "originalPosition": 87}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MDA1MTky", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-386005192", "createdAt": "2020-04-01T22:56:11Z", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1NjoxMVrOF_Vibw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1NjoxMVrOF_Vibw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NzQ4Nw==", "bodyText": "too much indentation?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#discussion_r401957487", "createdAt": "2020-04-01T22:56:11Z", "author": {"login": "jianghaolu"}, "path": "sdk/identity/azure-identity/src/test/java/com/azure/identity/DefaultAzureCredentialTest.java", "diffHunk": "@@ -132,4 +132,84 @@ public void testNoCredentialWorks() throws Exception {\n                                                    + \"[\\\\$\\\\w]+\\\\$\\\\d*,\\\\s+AzureCliCredential[\\\\$\\\\w\\\\s\\\\.]+\"))\n             .verify();\n     }\n+\n+    @Test(expected = IllegalArgumentException.class)\n+    public void testExcludeCredentials() throws Exception {\n+        DefaultAzureCredential credential = new DefaultAzureCredentialBuilder()\n+                                                .excludeEnvironmentCredential()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MDA1NjAz", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-386005603", "createdAt": "2020-04-01T22:57:06Z", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MDA3NzA0", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-386007704", "createdAt": "2020-04-01T23:02:19Z", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MTU3NTI4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9415#pullrequestreview-386157528", "createdAt": "2020-04-02T07:09:49Z", "commit": {"oid": "6ad2f66962a7a1c8366f884e63f23e0055a0b7b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1445863cd87698e2f53cff42a764b7fd97effe6", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f1445863cd87698e2f53cff42a764b7fd97effe6", "committedDate": "2020-04-03T00:07:59Z", "message": "add credentials"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8eccd340ee61ede84027d8a2872a5045223b5271", "author": {"user": null}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/8eccd340ee61ede84027d8a2872a5045223b5271", "committedDate": "2020-04-03T00:18:50Z", "message": "fix checkstyle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1504, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}