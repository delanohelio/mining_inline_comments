{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2Nzg4MTk0", "number": 12339, "title": "[BUG] Cosmos | Direct TCP | Address null pointer exception in RntbdClientChannelPool.computeLoadFactor", "bodyText": "This issue occurs when an available channel loses its connection. In this case its request manager is set to null and this causes the NullPointerException when the request manager is accessed in RntbdClientChannelPool.computeLoadFactor. The code now check for null and logs the fact that the connection was lost before continuing. As before this change, the skipped channel will be removed from the list of available channels on the next channel acquisition.\nAlso:\n\n\nIncreased the default value for RntbdTransportClient.Options.maxChannelsPerEndpoint to 130.\nPerformance runs indicate that under load this is a better value than 10. See the Jupyter Notebook charts at https://ms.portal.azure.com/#@microsoft.onmicrosoft.com/resource/subscriptions/86886548-0a7c-430b-b16f-014095647de4/resourcegroups/danoble.sdk-development/providers/Microsoft.DocumentDB/databaseAccounts/cosmos-sdk-core-3/dataExplorer.\n\n\nAddressed an RntbdTransportClient.Options deserialization issue by adding a parameterless constructor to RntbdTransportClient.Options.\n\n\nImproved a logger message in RntbdServiceEndpoint.writeWhenConnected.", "createdAt": "2020-06-18T22:12:29Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12339", "merged": true, "mergeCommit": {"oid": "e48e6275a5bd4c14ac428245425ff7345d65090d"}, "closed": true, "closedAt": "2020-06-24T16:18:19Z", "author": {"login": "David-Noble-at-work"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbkQmrkAH2gAyNDM2Nzg4MTk0Ojg0YTM3YWIzMjk1MjVhZTUyZDdjMWFkYzZlN2JhM2MzMzYyNWM1Yzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABct1_c-gFqTQzNTIxMTAzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "84a37ab329525ae52d7c1adc6e7ba3c33625c5c7", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/84a37ab329525ae52d7c1adc6e7ba3c33625c5c7", "committedDate": "2019-11-07T04:36:56Z", "message": "Port from v4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d218925e1dff21266697a27e4271d34dfcc3b6a7", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d218925e1dff21266697a27e4271d34dfcc3b6a7", "committedDate": "2019-11-08T01:46:09Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11cbbf37bf63bf50e94f67fe30300ac39c72ed4f", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/11cbbf37bf63bf50e94f67fe30300ac39c72ed4f", "committedDate": "2019-11-08T03:20:35Z", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05c7e0551ffb6fd1ed80c15d1068cb32e734007e", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/05c7e0551ffb6fd1ed80c15d1068cb32e734007e", "committedDate": "2019-11-09T00:07:30Z", "message": "Corrected package misspelling in log4j.properties and removed System.exit from Main.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dfa3dbf03ae2addeddcb34ffc67c362670a164c", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/8dfa3dbf03ae2addeddcb34ffc67c362670a164c", "committedDate": "2019-11-09T00:07:47Z", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6e71f5e6b292cac17b6a9687d04ad858f02a8a1", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e6e71f5e6b292cac17b6a9687d04ad858f02a8a1", "committedDate": "2019-11-09T18:42:20Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e082d817a13d64ed57e5243cbc1da5b4ef0ab58e", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/e082d817a13d64ed57e5243cbc1da5b4ef0ab58e", "committedDate": "2019-11-17T00:51:11Z", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "069c822e997087f384cf1a1864e7efec331e69f8", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/069c822e997087f384cf1a1864e7efec331e69f8", "committedDate": "2019-11-23T22:36:47Z", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ead1cca230e56b61e5376e73bd1481f7a7b81e6", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/3ead1cca230e56b61e5376e73bd1481f7a7b81e6", "committedDate": "2019-12-03T18:58:37Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "669ba8b28ed6ae321fda445e0e167ff027cc6481", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/669ba8b28ed6ae321fda445e0e167ff027cc6481", "committedDate": "2019-12-04T19:34:26Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "735f57269d45a3497a66d47d594b7efac88179ff", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/735f57269d45a3497a66d47d594b7efac88179ff", "committedDate": "2019-12-04T19:36:31Z", "message": "Responded to code review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6db330d843c4cdbb80b90c6f734f69a59afb9183", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6db330d843c4cdbb80b90c6f734f69a59afb9183", "committedDate": "2020-01-04T00:31:23Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48855b55564f6f216ee6a156f7a64ff5991ee2e6", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/48855b55564f6f216ee6a156f7a64ff5991ee2e6", "committedDate": "2020-01-04T02:07:38Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2367f50dd69e8f4d1ba123c3b42ad4388caeaa66", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/2367f50dd69e8f4d1ba123c3b42ad4388caeaa66", "committedDate": "2020-01-17T20:51:14Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb9cac0c12e21f09e3c45580bf324bef7733b8c1", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/fb9cac0c12e21f09e3c45580bf324bef7733b8c1", "committedDate": "2020-01-23T01:18:46Z", "message": "Updated sdk/cosmos/README.md with info on using system properties to modify default Direct TCP options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dd708ef9e753607040a6bb1f2b69c863dda8a0a", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1dd708ef9e753607040a6bb1f2b69c863dda8a0a", "committedDate": "2020-01-23T01:21:11Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "203507a249705593b04dec3e36566537d15da4e2", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/203507a249705593b04dec3e36566537d15da4e2", "committedDate": "2020-03-16T00:12:48Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "368b10f9893cdf49e95545e8ae4ec5ff03450f60", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/368b10f9893cdf49e95545e8ae4ec5ff03450f60", "committedDate": "2020-03-16T17:10:04Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0b44a7f9ef506fe168d1bce9918be6d3a6bfea7", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a0b44a7f9ef506fe168d1bce9918be6d3a6bfea7", "committedDate": "2020-04-15T01:29:42Z", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d810ba8e1c8384eb363273d6c723f940ee8d244f", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/d810ba8e1c8384eb363273d6c723f940ee8d244f", "committedDate": "2020-05-06T18:39:06Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64a12afb32dc1ca4704ed84098766fe4f97c863b", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/64a12afb32dc1ca4704ed84098766fe4f97c863b", "committedDate": "2020-06-04T15:25:14Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74cc11654de9dffafff1513c52926259e86594e8", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/74cc11654de9dffafff1513c52926259e86594e8", "committedDate": "2020-06-09T03:26:08Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into feature/cosmos-4.x/connection-state-listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38bf6e502f93cc650d719f4cfb61b8446816cadc", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/38bf6e502f93cc650d719f4cfb61b8446816cadc", "committedDate": "2020-06-10T18:15:31Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into feature/cosmos-4.x/connection-state-listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bf8f18752bc8e593cc6d6a3369ad51d8714ae35", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6bf8f18752bc8e593cc6d6a3369ad51d8714ae35", "committedDate": "2020-06-15T18:03:11Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into feature/cosmos-4.x/connection-state-listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de5f8d0cc6ce11e1c63a7ec162c478063a6cda99", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/de5f8d0cc6ce11e1c63a7ec162c478063a6cda99", "committedDate": "2020-06-18T19:57:17Z", "message": "Addresses a NullPointerException raised when an available channel closes since it became available, improves two log messages, and increases the value of maxChannelsPerEndpoint from 10 to 130. The latter is based on performance runs that indicate this is a better value in syncrhonous and asynchronous point read scenarios"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "216cf58358e16c371bfa81e13c47752c5103dc56", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/216cf58358e16c371bfa81e13c47752c5103dc56", "committedDate": "2020-06-18T21:39:48Z", "message": "Tweaked logger message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7047a636bf4d0765d5376568f0d87e20f6709e0", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/f7047a636bf4d0765d5376568f0d87e20f6709e0", "committedDate": "2020-06-18T21:40:03Z", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into feature/cosmos-4.x/connection-state-listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "380e43a0e5c7e64975bb219ce67075fff5e3b22a", "author": {"user": {"login": "David-Noble-at-work", "name": "David Noble"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/380e43a0e5c7e64975bb219ce67075fff5e3b22a", "committedDate": "2020-06-18T22:24:15Z", "message": "Removed README.md because it was deleted on master and was not removed when I pulled from master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MjIxMDIy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12339#pullrequestreview-434221022", "createdAt": "2020-06-19T16:56:18Z", "commit": {"oid": "380e43a0e5c7e64975bb219ce67075fff5e3b22a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MjIxMzQ4", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12339#pullrequestreview-434221348", "createdAt": "2020-06-19T16:56:53Z", "commit": {"oid": "380e43a0e5c7e64975bb219ce67075fff5e3b22a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjo1Njo1NFrOGmbgpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjo1Njo1NFrOGmbgpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0OTc5Ng==", "bodyText": "Is this the null manager change we talked about on the email with context to linkedin?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12339#discussion_r442949796", "createdAt": "2020-06-19T16:56:54Z", "author": {"login": "kushagraThapar"}, "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/directconnectivity/rntbd/RntbdClientChannelPool.java", "diffHunk": "@@ -623,6 +623,12 @@ private double computeLoadFactor() {\n         for (Channel channel : this.availableChannels) {\n \n             final RntbdRequestManager manager = channel.pipeline().get(RntbdRequestManager.class);\n+\n+            if (manager == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "380e43a0e5c7e64975bb219ce67075fff5e3b22a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjExMDMx", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12339#pullrequestreview-435211031", "createdAt": "2020-06-22T19:26:57Z", "commit": {"oid": "380e43a0e5c7e64975bb219ce67075fff5e3b22a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2980, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}