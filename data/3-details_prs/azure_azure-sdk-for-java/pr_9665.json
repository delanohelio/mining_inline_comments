{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MzcwNTMy", "number": 9665, "title": "support legacy PagedList for convenience of migration", "bodyText": "Fix Azure/azure-libraries-for-java#1102\nOrigin PagedList https://github.com/Azure/autorest-clientruntime-for-java/blob/master/azure-client-runtime/src/main/java/com/microsoft/azure/PagedList.java\nOrigin test https://github.com/Azure/autorest-clientruntime-for-java/blob/master/azure-client-runtime/src/test/java/com/microsoft/azure/PagedListTests.java", "createdAt": "2020-03-30T02:33:02Z", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665", "merged": true, "mergeCommit": {"oid": "6b504dc8515839079d17be9e497835edd3deb124"}, "closed": true, "closedAt": "2020-04-01T09:09:59Z", "author": {"login": "weidongxu-microsoft"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRYEdLgH2gAyMzk1MzcwNTMyOjFmZjE2MmU2N2JiOGQ5NmFlYWRkNDBkNGVmMjBlYzIzMWUzOTFlNWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTT07VgFqTM4NTM4OTE1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ff162e67bb8d96aeadd40d4ef20ec231e391e5f", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/1ff162e67bb8d96aeadd40d4ef20ec231e391e5f", "committedDate": "2020-03-26T08:45:23Z", "message": "add major mgmt libs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "118ce203682b38e208cc705b48cbfb77a195bdac", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/118ce203682b38e208cc705b48cbfb77a195bdac", "committedDate": "2020-03-26T08:48:32Z", "message": "misc files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "432ed8b2aa5b5c0eb681471aa436af390e429c34", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/432ed8b2aa5b5c0eb681471aa436af390e429c34", "committedDate": "2020-03-26T08:50:21Z", "message": "rename azure-samples to samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f28f69233ebad2b9662c0f9370f3e7747e18cf5", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6f28f69233ebad2b9662c0f9370f3e7747e18cf5", "committedDate": "2020-03-26T08:52:52Z", "message": "adapt pom"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fc87975e4ea2be91870fa4a4c68676e80926dc8", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/0fc87975e4ea2be91870fa4a4c68676e80926dc8", "committedDate": "2020-03-26T08:55:25Z", "message": "fix folder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ff2198e91a13ca54db5d406b2d49f95e424d202", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/6ff2198e91a13ca54db5d406b2d49f95e424d202", "committedDate": "2020-03-26T09:30:53Z", "message": "exclude mgmt from client/data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12a8967ef6754de79ffdddd92762c1b0b57ca827", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/12a8967ef6754de79ffdddd92762c1b0b57ca827", "committedDate": "2020-03-27T01:52:17Z", "message": "refresh from vnext"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51723dd245ff7337e88fa7ac671136bfcb8fc515", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/51723dd245ff7337e88fa7ac671136bfcb8fc515", "committedDate": "2020-03-27T02:06:34Z", "message": "refresh from vnext"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50a0cb48eebc399673c518987dabc7db84b30236", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/50a0cb48eebc399673c518987dabc7db84b30236", "committedDate": "2020-03-27T04:24:03Z", "message": "update parent pom location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c965873d599a45bdde65627a0d6455d4f826949e", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/c965873d599a45bdde65627a0d6455d4f826949e", "committedDate": "2020-03-27T05:26:19Z", "message": "refresh from vnext"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec533e70ed68f6103b027ccc27dc65a64fff2332", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/ec533e70ed68f6103b027ccc27dc65a64fff2332", "committedDate": "2020-03-27T05:47:46Z", "message": "remove readme"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84e2690298cfc0681c513cdf2f0f75b0c013e9aa", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/84e2690298cfc0681c513cdf2f0f75b0c013e9aa", "committedDate": "2020-03-27T11:23:35Z", "message": "initial support PagedList"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50b14a5e5fc49dff6f016c74fa322f132875c767", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/50b14a5e5fc49dff6f016c74fa322f132875c767", "committedDate": "2020-03-30T01:29:37Z", "message": "Merge branch 'master' into support_paged_list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "133721a4de6210edbaa7a129bd88a0a5dbe8d844", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/133721a4de6210edbaa7a129bd88a0a5dbe8d844", "committedDate": "2020-03-30T02:30:45Z", "message": "Merge branch 'master' into support_paged_list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNDk3NzQy", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#pullrequestreview-383497742", "createdAt": "2020-03-30T02:33:22Z", "commit": {"oid": "133721a4de6210edbaa7a129bd88a0a5dbe8d844"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwMjozMzoyMlrOF9X1YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwMjozMzo0M1rOF9X1tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg5Nzk1Mw==", "bodyText": "Annotate as deprecated.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#discussion_r399897953", "createdAt": "2020-03-30T02:33:22Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/utils/PagedList.java", "diffHunk": "@@ -0,0 +1,364 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.management.resources.fluentcore.utils;\n+\n+import com.azure.core.http.rest.PagedIterable;\n+import com.azure.core.http.rest.PagedResponse;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.ConcurrentModificationException;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.ListIterator;\n+import java.util.NoSuchElementException;\n+import java.util.Objects;\n+\n+/**\n+ * Defines a list response from a paging operation. The pages are\n+ * lazy initialized when an instance of this class is iterated.\n+ *\n+ * @deprecated Use {@link PagedIterable} instead.\n+ *\n+ * @param <E> the element type.\n+ */\n+@Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "133721a4de6210edbaa7a129bd88a0a5dbe8d844"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg5ODAzNw==", "bodyText": "Expect user to create it via the standard PagedIterable.", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#discussion_r399898037", "createdAt": "2020-03-30T02:33:43Z", "author": {"login": "weidongxu-microsoft"}, "path": "sdk/resources/mgmt/src/test/java/com/azure/management/resources/fluentcore/utils/PagedListTests.java", "diffHunk": "@@ -0,0 +1,64 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.management.resources.fluentcore.utils;\n+\n+import com.azure.core.http.rest.PagedFlux;\n+import com.azure.core.http.rest.PagedIterable;\n+import com.azure.core.http.rest.PagedResponseBase;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import reactor.core.publisher.Mono;\n+\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+\n+public class PagedListTests {\n+\n+    private PagedList<Integer> list;\n+\n+    @BeforeEach\n+    public void setupList() {\n+        final int pageSize = 10;\n+        final int lastFullPageInt = 50;\n+        final int lastPageSize = 5;\n+\n+        final PagedFlux<Integer> mockedPagedFlux = new PagedFlux<>(\n+            // 1st page 0-9\n+            () -> Mono.just(new PagedResponseBase<>(null, 200, null,\n+                IntStream.range(0, pageSize).boxed().collect(Collectors.toList()), Integer.toString(pageSize),\n+                (Object)null)),\n+            // 2nd page 10-19\n+            // 3rd page 20-29\n+            // ...\n+            // last page 50-55\n+            (continuationToken) -> {\n+                int nextInt = Integer.parseInt(continuationToken);\n+                String nextToken = Integer.toString(nextInt + pageSize);\n+                if (nextInt < lastFullPageInt) {\n+                    return Mono.just(new PagedResponseBase<>(null, 200, null,\n+                        IntStream.range(nextInt, nextInt + pageSize).boxed().collect(Collectors.toList()), nextToken,\n+                        (Object) null));\n+                } else {\n+                    return Mono.just(new PagedResponseBase<>(null, 200, null,\n+                        IntStream.range(nextInt, nextInt + lastPageSize).boxed().collect(Collectors.toList()), null,\n+                        (Object) null));\n+                }\n+            }\n+        );\n+        final PagedIterable<Integer> pagedIterable = new PagedIterable<>(mockedPagedFlux);\n+\n+        list = new PagedList<>(pagedIterable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "133721a4de6210edbaa7a129bd88a0a5dbe8d844"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a16fc22b201120949839b04b92e6e3a5d023a34c", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/a16fc22b201120949839b04b92e6e3a5d023a34c", "committedDate": "2020-03-30T02:51:09Z", "message": "add unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTIyMTg5", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#pullrequestreview-383522189", "createdAt": "2020-03-30T04:22:22Z", "commit": {"oid": "a16fc22b201120949839b04b92e6e3a5d023a34c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNDoyMjoyMlrOF9ZKKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNDoyNToxOFrOF9ZMmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTkxOTY1Nw==", "bodyText": "what's the deprecation mean? Should v2 still use PagedList or should not?", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#discussion_r399919657", "createdAt": "2020-03-30T04:22:22Z", "author": {"login": "yungezz"}, "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/utils/PagedList.java", "diffHunk": "@@ -0,0 +1,364 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.management.resources.fluentcore.utils;\n+\n+import com.azure.core.http.rest.PagedIterable;\n+import com.azure.core.http.rest.PagedResponse;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.ConcurrentModificationException;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.ListIterator;\n+import java.util.NoSuchElementException;\n+import java.util.Objects;\n+\n+/**\n+ * Defines a list response from a paging operation. The pages are\n+ * lazy initialized when an instance of this class is iterated.\n+ *\n+ * @deprecated Use {@link PagedIterable} instead.\n+ *\n+ * @param <E> the element type.\n+ */\n+@Deprecated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg5Nzk1Mw=="}, "originalCommit": {"oid": "133721a4de6210edbaa7a129bd88a0a5dbe8d844"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTkyMDI4Mw==", "bodyText": "seems cachedpage removed, any concern on performance etc when original cachedpage adding? Or we may revisit it later when there's complain", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#discussion_r399920283", "createdAt": "2020-03-30T04:25:18Z", "author": {"login": "yungezz"}, "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/utils/PagedList.java", "diffHunk": "@@ -0,0 +1,367 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.management.resources.fluentcore.utils;\n+\n+import com.azure.core.http.rest.PagedIterable;\n+import com.azure.core.http.rest.PagedResponse;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.ConcurrentModificationException;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.ListIterator;\n+import java.util.NoSuchElementException;\n+import java.util.Objects;\n+\n+/**\n+ * Defines a list response from a paging operation. The pages are\n+ * lazy initialized when an instance of this class is iterated.\n+ *\n+ * @deprecated Use {@link PagedIterable} instead.\n+ *\n+ * @param <E> the element type.\n+ */\n+@Deprecated\n+public final class PagedList<E> implements List<E> {\n+\n+    // The invariant is that before / after read-only method, items + pagedResponseIterator is the complete pagedIterable.\n+\n+    /** The items retrieved. */\n+    private final List<E> items;\n+\n+    /** The paged response iterator for not retrieved items. */\n+    private Iterator<PagedResponse<E>> pagedResponseIterator;\n+\n+    /**\n+     * Creates an instance of PagedList.\n+     */\n+    public PagedList() {\n+        items = new ArrayList<>();\n+        pagedResponseIterator = Collections.emptyIterator();\n+    }\n+\n+    /**\n+     * Creates an instance of PagedList from a {@link PagedIterable}.\n+     *\n+     * @param pagedIterable the {@link PagedIterable} object.\n+     */\n+    public PagedList(PagedIterable<E> pagedIterable) {\n+        items = new ArrayList<>();\n+        Objects.requireNonNull(pagedIterable, \"'pagedIterable' cannot be null.\");\n+        this.pagedResponseIterator = pagedIterable.iterableByPage().iterator();\n+    }\n+\n+    /**\n+     * If there are more pages available.\n+     *\n+     * @return true if there are more pages to load. False otherwise.\n+     */\n+    protected boolean hasNextPage() {\n+        return pagedResponseIterator.hasNext();\n+    }\n+\n+    /**\n+     * Loads a page from next page link.\n+     * The exceptions are wrapped into Java Runtime exceptions.\n+     */\n+    protected void loadNextPage() {\n+        this.items.addAll(pagedResponseIterator.next().getValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a16fc22b201120949839b04b92e6e3a5d023a34c"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90426ff03ef005334b4190349681f11b5b193fdc", "author": {"user": {"login": "weidongxu-microsoft", "name": "Weidong Xu"}}, "url": "https://github.com/Azure/azure-sdk-for-java/commit/90426ff03ef005334b4190349681f11b5b193fdc", "committedDate": "2020-04-01T08:55:03Z", "message": "t Merge branch 'master' into support_paged_list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1Mzg5MTU3", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9665#pullrequestreview-385389157", "createdAt": "2020-04-01T08:56:39Z", "commit": {"oid": "90426ff03ef005334b4190349681f11b5b193fdc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1419, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}