{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMTAwOTcy", "number": 1311, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwOToxNDoyM1rOFCNdew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwOToxNjoxNFrOFCNg1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3ODYyMDExOnYy", "diffSide": "RIGHT", "path": "core/src/main/resources/xml/xsl/stub4testtool.xsl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwOToxNDoyM1rOIBO9ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwOToxNDoyM1rOIBO9ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODE2NDYzOA==", "bodyText": "Zou je hier een comment bij kunnen zetten dat deze Listeners als uitzondering niet gestubt worden, en alle overige wel?", "url": "https://github.com/ibissource/iaf/pull/1311#discussion_r538164638", "createdAt": "2020-12-08T09:14:23Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/resources/xml/xsl/stub4testtool.xsl", "diffHunk": "@@ -25,321 +25,320 @@\n \t<xsl:template match=\"/\">\n \t\t<xsl:apply-templates select=\"*|@*|comment()|processing-instruction()\" />\n \t</xsl:template>\n+\t\n \t<xsl:template match=\"*|@*|comment()|processing-instruction()\">\n-\t\t<xsl:choose>\n-\t\t\t<xsl:when test=\"name()='receiver'\">\n-\t\t\t\t<xsl:choose>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.jdbc.JdbcQueryListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.receivers.DirectoryListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.receivers.JavaListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.http.WebServiceListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.http.RestListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.jdbc.MessageStoreListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.http.rest.ApiListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:otherwise>\n-\t\t\t\t\t\t<xsl:call-template name=\"disable\" />\n-\t\t\t\t\t</xsl:otherwise>\n-\t\t\t\t</xsl:choose>\n-\t\t\t</xsl:when>\n-\t\t\t<xsl:when test=\"name()='pipeline'\">\n-\t\t\t\t<xsl:element name=\"receiver\">\n-\t\t\t\t\t<xsl:attribute name=\"name\">\n-\t\t\t\t\t\t<xsl:value-of select=\"concat('testtool-',parent::*[name()='adapter']/@name)\" />\n-\t\t\t\t\t</xsl:attribute>\n-\t\t\t\t\t<xsl:apply-templates select=\"parent::*[name()='adapter']/receiver/@*[name()!='transactionAttribute']\" />\n-\t\t\t\t\t<xsl:element name=\"listener\">\n-\t\t\t\t\t\t<xsl:attribute name=\"className\">nl.nn.adapterframework.receivers.JavaListener</xsl:attribute>\n-\t\t\t\t\t\t<xsl:attribute name=\"serviceName\">\n-\t\t\t\t\t\t\t<xsl:value-of select=\"concat('testtool-',parent::*[name()='adapter']/@name)\" />\n-\t\t\t\t\t\t</xsl:attribute>\n-\t\t\t\t\t\t<xsl:if test=\"parent::*[name()='adapter']/errorMessageFormatter\">\n-\t\t\t\t\t\t\t<xsl:attribute name=\"throwException\">false</xsl:attribute>\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:element>\n-\t\t\t\t\t<xsl:for-each select=\"parent::*[name()='adapter']/receiver/errorStorage[@className='nl.nn.adapterframework.jdbc.JdbcTransactionalStorage' or @className='nl.nn.adapterframework.jdbc.DummyTransactionalStorage']\">\n-\t\t\t\t\t\t<xsl:if test=\"position()=1\">\n-\t\t\t\t\t\t\t<xsl:copy-of select=\".\" />\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:for-each>\n-\t\t\t\t\t<xsl:for-each select=\"parent::*[name()='adapter']/receiver/errorSender[@className='nl.nn.adapterframework.senders.IbisLocalSender']\">\n-\t\t\t\t\t\t<xsl:if test=\"position()=1\">\n-\t\t\t\t\t\t\t<xsl:copy-of select=\".\" />\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:for-each>\n-\t\t\t\t\t<xsl:for-each select=\"parent::*[name()='adapter']/receiver/messageLog[@className='nl.nn.adapterframework.jdbc.JdbcTransactionalStorage' or @className='nl.nn.adapterframework.jdbc.DummyTransactionalStorage']\">\n-\t\t\t\t\t\t<xsl:if test=\"position()=1\">\n-\t\t\t\t\t\t\t<xsl:copy-of select=\".\" />\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:for-each>\n-\t\t\t\t</xsl:element>\n-\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t</xsl:when>\n-\t\t\t<xsl:when test=\"name()='listener'\">\n+\t\t<xsl:call-template name=\"copy\" />\n+\t</xsl:template>\n+\t\n+\t<xsl:template match=\"adapter\">\n+\t\t<xsl:element name=\"adapter\">\n+\t\t\t<xsl:apply-templates select=\"@*\" />\n+\t\t\t<xsl:for-each select=\"receiver[1]\">\n+\t\t\t\t<xsl:call-template name=\"stubReceiver\">\n+\t\t\t\t\t<xsl:with-param name=\"isAdapterStub\" select=\"true()\"/>\n+\t\t\t\t</xsl:call-template>\n+\t\t\t</xsl:for-each>\n+\t\t\t<xsl:apply-templates select=\"*|comment()|processing-instruction()|text()\" />\n+\t\t</xsl:element>\n+\t</xsl:template>\n+\t\n+\t<xsl:template match=\"receiver[listener[@className='nl.nn.adapterframework.jdbc.JdbcQueryListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.receivers.DirectoryListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.receivers.JavaListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.http.WebServiceListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.http.RestListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.jdbc.MessageStoreListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.http.rest.ApiListener']]\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a228a99b743041dc9318bdfd7e3dda0c09cc871"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3ODYyODY5OnYy", "diffSide": "RIGHT", "path": "core/src/main/resources/xml/xsl/stub4testtool.xsl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwOToxNjoxNFrOIBPC0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwOToxNjoxNFrOIBPC0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODE2NTk3MQ==", "bodyText": "Zou je hier een comment bij kunnen zetten dat deze Senders als uitzondering niet gestubt worden, en alle overige wel?", "url": "https://github.com/ibissource/iaf/pull/1311#discussion_r538165971", "createdAt": "2020-12-08T09:16:14Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/resources/xml/xsl/stub4testtool.xsl", "diffHunk": "@@ -25,321 +25,320 @@\n \t<xsl:template match=\"/\">\n \t\t<xsl:apply-templates select=\"*|@*|comment()|processing-instruction()\" />\n \t</xsl:template>\n+\t\n \t<xsl:template match=\"*|@*|comment()|processing-instruction()\">\n-\t\t<xsl:choose>\n-\t\t\t<xsl:when test=\"name()='receiver'\">\n-\t\t\t\t<xsl:choose>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.jdbc.JdbcQueryListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.receivers.DirectoryListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.receivers.JavaListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.http.WebServiceListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.http.RestListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.jdbc.MessageStoreListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:when test=\"listener[@className='nl.nn.adapterframework.http.rest.ApiListener']\">\n-\t\t\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t\t\t</xsl:when>\n-\t\t\t\t\t<xsl:otherwise>\n-\t\t\t\t\t\t<xsl:call-template name=\"disable\" />\n-\t\t\t\t\t</xsl:otherwise>\n-\t\t\t\t</xsl:choose>\n-\t\t\t</xsl:when>\n-\t\t\t<xsl:when test=\"name()='pipeline'\">\n-\t\t\t\t<xsl:element name=\"receiver\">\n-\t\t\t\t\t<xsl:attribute name=\"name\">\n-\t\t\t\t\t\t<xsl:value-of select=\"concat('testtool-',parent::*[name()='adapter']/@name)\" />\n-\t\t\t\t\t</xsl:attribute>\n-\t\t\t\t\t<xsl:apply-templates select=\"parent::*[name()='adapter']/receiver/@*[name()!='transactionAttribute']\" />\n-\t\t\t\t\t<xsl:element name=\"listener\">\n-\t\t\t\t\t\t<xsl:attribute name=\"className\">nl.nn.adapterframework.receivers.JavaListener</xsl:attribute>\n-\t\t\t\t\t\t<xsl:attribute name=\"serviceName\">\n-\t\t\t\t\t\t\t<xsl:value-of select=\"concat('testtool-',parent::*[name()='adapter']/@name)\" />\n-\t\t\t\t\t\t</xsl:attribute>\n-\t\t\t\t\t\t<xsl:if test=\"parent::*[name()='adapter']/errorMessageFormatter\">\n-\t\t\t\t\t\t\t<xsl:attribute name=\"throwException\">false</xsl:attribute>\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:element>\n-\t\t\t\t\t<xsl:for-each select=\"parent::*[name()='adapter']/receiver/errorStorage[@className='nl.nn.adapterframework.jdbc.JdbcTransactionalStorage' or @className='nl.nn.adapterframework.jdbc.DummyTransactionalStorage']\">\n-\t\t\t\t\t\t<xsl:if test=\"position()=1\">\n-\t\t\t\t\t\t\t<xsl:copy-of select=\".\" />\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:for-each>\n-\t\t\t\t\t<xsl:for-each select=\"parent::*[name()='adapter']/receiver/errorSender[@className='nl.nn.adapterframework.senders.IbisLocalSender']\">\n-\t\t\t\t\t\t<xsl:if test=\"position()=1\">\n-\t\t\t\t\t\t\t<xsl:copy-of select=\".\" />\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:for-each>\n-\t\t\t\t\t<xsl:for-each select=\"parent::*[name()='adapter']/receiver/messageLog[@className='nl.nn.adapterframework.jdbc.JdbcTransactionalStorage' or @className='nl.nn.adapterframework.jdbc.DummyTransactionalStorage']\">\n-\t\t\t\t\t\t<xsl:if test=\"position()=1\">\n-\t\t\t\t\t\t\t<xsl:copy-of select=\".\" />\n-\t\t\t\t\t\t</xsl:if>\n-\t\t\t\t\t</xsl:for-each>\n-\t\t\t\t</xsl:element>\n-\t\t\t\t<xsl:call-template name=\"copy\" />\n-\t\t\t</xsl:when>\n-\t\t\t<xsl:when test=\"name()='listener'\">\n+\t\t<xsl:call-template name=\"copy\" />\n+\t</xsl:template>\n+\t\n+\t<xsl:template match=\"adapter\">\n+\t\t<xsl:element name=\"adapter\">\n+\t\t\t<xsl:apply-templates select=\"@*\" />\n+\t\t\t<xsl:for-each select=\"receiver[1]\">\n+\t\t\t\t<xsl:call-template name=\"stubReceiver\">\n+\t\t\t\t\t<xsl:with-param name=\"isAdapterStub\" select=\"true()\"/>\n+\t\t\t\t</xsl:call-template>\n+\t\t\t</xsl:for-each>\n+\t\t\t<xsl:apply-templates select=\"*|comment()|processing-instruction()|text()\" />\n+\t\t</xsl:element>\n+\t</xsl:template>\n+\t\n+\t<xsl:template match=\"receiver[listener[@className='nl.nn.adapterframework.jdbc.JdbcQueryListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.receivers.DirectoryListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.receivers.JavaListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.http.WebServiceListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.http.RestListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.jdbc.MessageStoreListener'\n+\t\t\t\t\t\t\t\t\t\tor @className='nl.nn.adapterframework.http.rest.ApiListener']]\">\n+\t\t<xsl:call-template name=\"copy\" />\n+\t\t<xsl:call-template name=\"stubReceiver\">\n+\t\t\t<xsl:with-param name=\"isAdapterStub\" select=\"false()\"/>\n+\t\t</xsl:call-template>\n+\t</xsl:template>\n+\t\n+\t<xsl:template match=\"receiver\">\n+\t\t<xsl:call-template name=\"disable\" />\n+\t\t<xsl:call-template name=\"stubReceiver\">\n+\t\t\t<xsl:with-param name=\"isAdapterStub\" select=\"false()\"/>\n+\t\t</xsl:call-template>\n+\t</xsl:template>\t\n+\t\n+\t<xsl:template name=\"stubReceiver\">\n+\t\t<xsl:param name=\"isAdapterStub\" as=\"xs:boolean\"/>\n+\n+\t\t<xsl:variable name=\"receiverName\">\n+\t\t\t<xsl:choose>\n+\t\t\t\t<xsl:when test=\"$isAdapterStub\">\n+\t\t\t\t\t<xsl:value-of select=\"parent::adapter/@name\"/>\n+\t\t\t\t</xsl:when>\n+\t\t\t\t<xsl:otherwise>\n+\t\t\t\t\t<xsl:value-of select=\"string-join((parent::adapter/@name,xs:string(count(preceding-sibling::receiver)+1)),'-')\"/>\n+\t\t\t\t</xsl:otherwise>\n+\t\t\t</xsl:choose>\n+\t\t</xsl:variable>\n+\t\t\n+\t\t<xsl:element name=\"receiver\">\n+\t\t\t<xsl:attribute name=\"name\">\n+\t\t\t\t<xsl:value-of select=\"concat('testtool-',$receiverName)\" />\n+\t\t\t</xsl:attribute>\n+\t\t\t<xsl:apply-templates select=\"@*[name()!='transactionAttribute' and name() !='name']\" />\n+\t\t\t<xsl:element name=\"listener\">\n+\t\t\t\t<xsl:attribute name=\"className\">nl.nn.adapterframework.receivers.JavaListener</xsl:attribute>\n+\t\t\t\t<xsl:attribute name=\"serviceName\">\n+\t\t\t\t\t<xsl:value-of select=\"concat('testtool-',$receiverName)\" />\n+\t\t\t\t</xsl:attribute>\n+\t\t\t\t<xsl:if test=\"parent::*[adapter]/errorMessageFormatter\">\n+\t\t\t\t\t<xsl:attribute name=\"throwException\">false</xsl:attribute>\n+\t\t\t\t</xsl:if>\n+\t\t\t</xsl:element>\n+\t\t\t<xsl:copy-of select=\"errorStorage[@className='nl.nn.adapterframework.jdbc.JdbcTransactionalStorage' or @className='nl.nn.adapterframework.jdbc.DummyTransactionalStorage']\"/>\n+\t\t\t<xsl:copy-of select=\"errorSender[@className='nl.nn.adapterframework.senders.IbisLocalSender']\"/>\n+\t\t\t<xsl:copy-of select=\"messageLog[@className='nl.nn.adapterframework.jdbc.JdbcTransactionalStorage' or @className='nl.nn.adapterframework.jdbc.DummyTransactionalStorage']\"/>\n+\t\t</xsl:element>\n+\t</xsl:template>\n+\t\n+\t<xsl:template match=\"sender[   @className='nl.nn.adapterframework.jdbc.ResultSet2FileSender'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a228a99b743041dc9318bdfd7e3dda0c09cc871"}, "originalPosition": 145}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 518, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}