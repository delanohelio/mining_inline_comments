{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NzIyMDIw", "number": 857, "title": "Avoid classloader contents appearing in logs", "bodyText": "fix #829: Modified some log statements that printed out classloader. Under WebSphere this cluttered the log a lot, and is not really useful", "createdAt": "2020-06-22T06:44:40Z", "url": "https://github.com/ibissource/iaf/pull/857", "merged": true, "mergeCommit": {"oid": "8e9709ac6ce4c76581c25b6502636b54ec3779ab"}, "closed": true, "closedAt": "2020-07-01T12:12:23Z", "author": {"login": "gvanbrakel"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctrD4hAH2gAyNDM3NzIyMDIwOjEzMjg5ZTdlOGI1NmQyNTkzNDcwYTc3OGIwNzE2MjZkZjQzOGM4NGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwo2BDgH2gAyNDM3NzIyMDIwOjhhOWY5ZGUyM2Q0MGM5NmMwNjViMDM2NGQxZGYzZjBiY2IyY2NlODU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "13289e7e8b56d2593470a778b071626df438c84b", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/13289e7e8b56d2593470a778b071626df438c84b", "committedDate": "2020-06-22T06:42:50Z", "message": "Avoid classloader contents appearing in logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8ba220a8bfa0bb9b4a168a70901c280cad17f8a", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/c8ba220a8bfa0bb9b4a168a70901c280cad17f8a", "committedDate": "2020-06-22T17:12:07Z", "message": "Prep ClassLoader refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ab1a332ad1e8f29830fc8156248dc3295393caf", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/3ab1a332ad1e8f29830fc8156248dc3295393caf", "committedDate": "2020-06-22T17:12:43Z", "message": "Use ClassUtils.getClassLoaderName"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "874d94a1d76c4044f5ee46fb42f6e020b5eb71c2", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/874d94a1d76c4044f5ee46fb42f6e020b5eb71c2", "committedDate": "2020-06-22T17:59:38Z", "message": "Oops its ClassLoaderBase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afe6fccb3a008ac8c76084cb14e5be7d0e86991a", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/afe6fccb3a008ac8c76084cb14e5be7d0e86991a", "committedDate": "2020-06-23T07:55:05Z", "message": "Toch maar even anders gedaan"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e0473209441cfd0bf6097e7065355c402d32d08", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/4e0473209441cfd0bf6097e7065355c402d32d08", "committedDate": "2020-06-23T08:00:41Z", "message": "fix log name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "120f39a586c2f48435a7866a31cd9081bf2e2b18", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/120f39a586c2f48435a7866a31cd9081bf2e2b18", "committedDate": "2020-06-23T14:06:09Z", "message": "Implement destroy method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b0049ee723179750b68ddb3d5cfe6ea9cc2c5bb", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/9b0049ee723179750b68ddb3d5cfe6ea9cc2c5bb", "committedDate": "2020-06-23T14:06:33Z", "message": "fix memleak"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d29cd8bd373694d401c5dc92ea4fc74ccf525cd", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/0d29cd8bd373694d401c5dc92ea4fc74ccf525cd", "committedDate": "2020-06-23T14:17:00Z", "message": "Fix mem leak in UtilityTransformerPools"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f5e8926187579aafd53059a1e569409ba24dfc6", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/8f5e8926187579aafd53059a1e569409ba24dfc6", "committedDate": "2020-06-23T14:17:13Z", "message": "Actually call shutdown on all classLoaders"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/7a6953c2996f2c872270e0baff3c9f77b8ec6b24", "committedDate": "2020-06-23T18:05:19Z", "message": "Fix junit test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MDUwMjQ3", "url": "https://github.com/ibissource/iaf/pull/857#pullrequestreview-438050247", "createdAt": "2020-06-26T06:46:01Z", "commit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjo0NjowMVrOGpVjOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzowNDoyMFrOGpV-eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Nzg4Mw==", "bodyText": "derivable?\nbeter misschien: 'is not a', 'does not derive from' of 'does not implement'", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r445997883", "createdAt": "2020-06-26T06:46:01Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/configuration/ClassLoaderManager.java", "diffHunk": "@@ -241,14 +241,36 @@ public void reload(ClassLoader classLoader) throws ConfigurationException {\n \t\tif (classLoader == null)\n \t\t\tthrow new ConfigurationException(\"classloader cannot be null\");\n \n-\t\tif (classLoader instanceof ReloadAware) {\n-\t\t\t((ReloadAware)classLoader).reload();\n+\t\tif (classLoader instanceof IConfigurationClassLoader) {\n+\t\t\t((IConfigurationClassLoader) classLoader).reload();\n \t\t} else {\n-\t\t\tLOG.warn(\"classloader [\"+classLoader.toString()+\"] is not ReloadAware, ignoring reload\");\n+\t\t\tLOG.warn(\"classloader [\"+classLoader.toString()+\"] is not derivable from IConfigurationClassLoader, ignoring reload\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5ODM1MA==", "bodyText": "Hier ook 'derivable',  maar ook: moet dit wel een warning zijn?", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r445998350", "createdAt": "2020-06-26T06:47:13Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/configuration/ClassLoaderManager.java", "diffHunk": "@@ -241,14 +241,36 @@ public void reload(ClassLoader classLoader) throws ConfigurationException {\n \t\tif (classLoader == null)\n \t\t\tthrow new ConfigurationException(\"classloader cannot be null\");\n \n-\t\tif (classLoader instanceof ReloadAware) {\n-\t\t\t((ReloadAware)classLoader).reload();\n+\t\tif (classLoader instanceof IConfigurationClassLoader) {\n+\t\t\t((IConfigurationClassLoader) classLoader).reload();\n \t\t} else {\n-\t\t\tLOG.warn(\"classloader [\"+classLoader.toString()+\"] is not ReloadAware, ignoring reload\");\n+\t\t\tLOG.warn(\"classloader [\"+classLoader.toString()+\"] is not derivable from IConfigurationClassLoader, ignoring reload\");\n \t\t}\n \t}\n \n \tpublic boolean contains(String currentConfigurationName) {\n \t\treturn (classLoaders.containsKey(currentConfigurationName));\n \t}\n+\n+\t/**\n+\t * Removes all created ClassLoaders\n+\t */\n+\tpublic void shutdown() {\n+\t\tfor (Iterator<String> iterator = classLoaders.keySet().iterator(); iterator.hasNext();) {\n+\t\t\tString configurationClassLoader = iterator.next();\n+\t\t\tClassLoader classLoader = classLoaders.get(configurationClassLoader);\n+\t\t\tif(classLoader instanceof IConfigurationClassLoader) {\n+\t\t\t\t((IConfigurationClassLoader) classLoader).destroy();\n+\t\t\t} else {\n+\t\t\t\tLOG.warn(\"classloader [\"+ClassUtils.getClassLoaderName(classLoader)+\"] is not derivable from IConfigurationClassLoader, ignoring destroy\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5OTM0OQ==", "bodyText": "Is reload() hetzelfde als destroy()? Is dat altijd zo", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r445999349", "createdAt": "2020-06-26T06:49:53Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/configuration/classloaders/ClassLoaderBase.java", "diffHunk": "@@ -253,26 +257,21 @@ public URL getResource(String name, boolean useParent) {\n \t}\n \n \t@Override\n-\tpublic String toString() {\n-\t\tif(StringUtils.isEmpty(getConfigurationName())) {\n-\t\t\treturn super.toString();\n-\t\t}\n+\tpublic void reload() throws ConfigurationException {\n+\t\tlog.debug(\"reloading classloader [\"+getConfigurationName()+\"]\");\n \n-\t\tif(logPrefix==null) {\n-\t\t\tString superString = super.toString();\n-\t\t\tlogPrefix = superString.substring(superString.lastIndexOf(\".\")+1)+\"[\"+getConfigurationName()+\"]\";\n-\t\t}\n-\t\treturn logPrefix;\n+\t\tAppConstants.removeInstance(this);\n \t}\n \n \t@Override\n-\tpublic void reload() throws ConfigurationException {\n-\t\tlog.debug(\"reloading configuration [\"+getConfigurationName()+\"]\");\n-\n-\t\tif (getParent() instanceof ReloadAware) {\n-\t\t\t((ReloadAware)getParent()).reload();\n-\t\t}\n+\tpublic void destroy() {\n+\t\tlog.debug(\"removing classloader [\"+this.toString()+\"]\");\n \n \t\tAppConstants.removeInstance(this);\n \t}\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwMTAwNg==", "bodyText": "Zou van mij ook getName() mogen heten.", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r446001006", "createdAt": "2020-06-26T06:54:26Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/ClassUtils.java", "diffHunk": "@@ -148,21 +149,36 @@ static public URL getResourceURL(ClassLoader classLoader, String resource, Strin\n \t\t\t\t\t\ttry {\n \t\t\t\t\t\t\turl = new URL(Misc.replace(resource, \" \", \"%20\"));\n \t\t\t\t\t\t} catch(MalformedURLException e) {\n-\t\t\t\t\t\t\tlog.debug(\"Could not find resource [\"+resource+\"] in classloader [\"+classLoader+\"] and not as URL [\" + resource + \"]: \"+e.getMessage());\n+\t\t\t\t\t\t\tlog.debug(\"Could not find resource [\"+resource+\"] in classloader [\"+getClassLoaderName(classLoader)+\"] and not as URL [\" + resource + \"]: \"+e.getMessage());\n \t\t\t\t\t\t}\n-\t\t\t\t\t} else if(log.isDebugEnabled()) log.debug(\"Cannot lookup resource [\"+resource+\"] in classloader [\"+classLoader+\"], not allowed with protocol [\"+protocol+\"] allowedProtocols \"+protocols.toString());\n+\t\t\t\t\t} else if(log.isDebugEnabled()) log.debug(\"Cannot lookup resource [\"+resource+\"] in classloader [\"+getClassLoaderName(classLoader)+\"], not allowed with protocol [\"+protocol+\"] allowedProtocols \"+protocols.toString());\n \t\t\t\t} else {\n-\t\t\t\t\tif(log.isDebugEnabled()) log.debug(\"Could not find resource as URL [\" + resource + \"] in classloader [\"+classLoader+\"], with protocol [\"+protocol+\"], no allowedProtocols\");\n+\t\t\t\t\tif(log.isDebugEnabled()) log.debug(\"Could not find resource as URL [\" + resource + \"] in classloader [\"+getClassLoaderName(classLoader)+\"], with protocol [\"+protocol+\"], no allowedProtocols\");\n \t\t\t\t}\n \t\t\t} else {\n-\t\t\t\tif(log.isDebugEnabled()) log.debug(\"Cannot lookup resource [\"+resource+\"] in classloader [\"+classLoader+\"] and no protocol to try as URL\");\n+\t\t\t\tif(log.isDebugEnabled()) log.debug(\"Cannot lookup resource [\"+resource+\"] in classloader [\"+getClassLoaderName(classLoader)+\"] and no protocol to try as URL\");\n \t\t\t}\n \t\t}\n \n \t\treturn url;\n \t}\n \n- \tpublic static InputStream urlToStream(URL url, int timeoutMs) throws IOException {\n+\t/**\n+\t * If the classLoader is derivable of IConfigurationClassLoader return the className + configurationName, \n+\t * else return the className of the object. Don't return the package name to avoid cluttering the logs.\n+\t */\n+\tpublic static String getClassLoaderName(ClassLoader classLoader) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwMjEyMw==", "bodyText": "Eens. Moet 'null' zijn, d.w.z. als de Xslt niet via een Resource wordt aangeboden mag er geen External Entity Expansion zijn, en dus ook geen classpath nodig.", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r446002123", "createdAt": "2020-06-26T06:57:23Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/TransformerPool.java", "diffHunk": "@@ -168,27 +164,33 @@ private TransformerPool(Source source, String sysId, int xsltVersion, Source con\n \t\t}\n \t\tthis.xsltVersion=xsltVersion;\n \t\ttFactory = XmlUtils.getTransformerFactory(xsltVersion);\n-\t\tclassLoaderURIResolver = new ClassLoaderURIResolver(classLoader);\n-\t\tif (log.isDebugEnabled()) log.debug(\"created Transformerpool for sysId [\"+sysId+\"] classLoader [\"+classLoader+\"]\");\n-\t\ttFactory.setURIResolver(classLoaderURIResolver);\n+\t\tif(classLoader != null) {\n+\t\t\tclassLoaderURIResolver = new ClassLoaderURIResolver(classLoader);\n+\t\t\tif (log.isDebugEnabled()) log.debug(\"created Transformerpool for sysId [\"+sysId+\"] classloader [\"+ClassUtils.getClassLoaderName(classLoader)+\"]\");\n+\t\t\ttFactory.setURIResolver(classLoaderURIResolver);\n+\t\t}\n \t\tinitTransformerPool(source, sysId);\n \n \t\t// check if a transformer can be initiated\n \t\tTransformer t = getTransformer();\n \t\t\n \t\treleaseTransformer(t);\n-\t}\t\n+\t}\n \n \n \tprivate TransformerPool(Resource resource, int xsltVersion) throws TransformerConfigurationException, IOException, SAXException {\n \t\tthis(resource.asSource(),resource.getSystemId(),xsltVersion,resource.asSource(), resource.getClassLoader());\n \t}\n-\t\n+\n+\t//TODO Fix this, Thread.currentThread().getContextClassLoader() should not be used and causes memory leaks upon reloading configurations!!!", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwMzM4MA==", "bodyText": "Dat je deze sluit betekent niet dat je ze allemaal sluit!", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r446003380", "createdAt": "2020-06-26T07:00:41Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/TransformerPool.java", "diffHunk": "@@ -352,18 +362,23 @@ public static TransformerPool configureStyleSheetTransformer(String logPrefix, C\n \t\treturn result;\n \t}\n \n-\t\n \tpublic void open() throws Exception {\n \t}\n-\t\n+\n+\t/**\n+\t * Closing the Pool doesn't automatically mean all references remaining in the pool will be terminated.\n+\t * After closing, manually releases any associated resources in the pool\n+\t */\n \tpublic void close() {\n \t\ttry {\n-\t\t\tpool.clear();\t\t\t\n+\t\t\tpool.clear();\n+\t\t\tclearTransformerPools();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwNDg1OA==", "bodyText": "Werkt dit altijd? Of alleen voor IConfigurationClassLoaders? Dan class hernoemen.", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r446004858", "createdAt": "2020-06-26T07:04:20Z", "author": {"login": "gvanbrakel"}, "path": "core/src/test/java/nl/nn/adapterframework/configuration/classloaders/ClassLoaderTestBase.java", "diffHunk": "@@ -254,4 +254,12 @@ public void configurationFileCustomLocationAndBasePath() throws Exception {\n \t\tassertNotNull(\"config file [\"+configFile+\"] cannot be found\", configURL);\n \t\tassertTrue(configURL.getPath().endsWith(file));\n \t}\n+\n+\t@Test\n+\tpublic void toStringTest() throws Exception {\n+\t\tString logPrefix = classLoader.getClass().getSimpleName() + \"@\" + Integer.toHexString(classLoader.hashCode());\n+\n+\t\t//Should match DatabaseClassLoader@1234abcd[<CONFIG-NAME>]\n+\t\tassertEquals(logPrefix+\"[\"+getConfigurationName()+\"]\", classLoader.toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6953c2996f2c872270e0baff3c9f77b8ec6b24"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "023aa980827ad6fb08643577403a83459bb04f7b", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/023aa980827ad6fb08643577403a83459bb04f7b", "committedDate": "2020-06-29T07:51:25Z", "message": "Rename getClassLoaderName to getName"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8212c17c50afad00fe25df94bcad5db3afe811f6", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/8212c17c50afad00fe25df94bcad5db3afe811f6", "committedDate": "2020-06-29T08:11:35Z", "message": "Remove clearTransformerPools"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb21acf4c737a352afb44cfeee7227e83d18d1bd", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/cb21acf4c737a352afb44cfeee7227e83d18d1bd", "committedDate": "2020-06-29T08:13:42Z", "message": "Rename classloadertest base class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e4c8374219a04bfef3a53c3f96334c807263157", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/3e4c8374219a04bfef3a53c3f96334c807263157", "committedDate": "2020-06-29T08:15:48Z", "message": "Remove unused field"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "885919276bc0f6c81ec5835a9102527179deff23", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/885919276bc0f6c81ec5835a9102527179deff23", "committedDate": "2020-06-29T09:14:25Z", "message": "Rename to nameOf"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MjY4MzI4", "url": "https://github.com/ibissource/iaf/pull/857#pullrequestreview-439268328", "createdAt": "2020-06-29T15:37:44Z", "commit": {"oid": "3e4c8374219a04bfef3a53c3f96334c807263157"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5OTA2NzIx", "url": "https://github.com/ibissource/iaf/pull/857#pullrequestreview-439906721", "createdAt": "2020-06-30T11:03:36Z", "commit": {"oid": "3e4c8374219a04bfef3a53c3f96334c807263157"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMTowMzozN1rOGq3RIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMTowMzozN1rOGq3RIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU5ODg4MQ==", "bodyText": "Hier moet je dan in de else tak een NonResolvingUriResolver zetten.", "url": "https://github.com/ibissource/iaf/pull/857#discussion_r447598881", "createdAt": "2020-06-30T11:03:37Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/TransformerPool.java", "diffHunk": "@@ -168,27 +164,33 @@ private TransformerPool(Source source, String sysId, int xsltVersion, Source con\n \t\t}\n \t\tthis.xsltVersion=xsltVersion;\n \t\ttFactory = XmlUtils.getTransformerFactory(xsltVersion);\n-\t\tclassLoaderURIResolver = new ClassLoaderURIResolver(classLoader);\n-\t\tif (log.isDebugEnabled()) log.debug(\"created Transformerpool for sysId [\"+sysId+\"] classLoader [\"+classLoader+\"]\");\n-\t\ttFactory.setURIResolver(classLoaderURIResolver);\n+\t\tif(classLoader != null) {\n+\t\t\tclassLoaderURIResolver = new ClassLoaderURIResolver(classLoader);\n+\t\t\tif (log.isDebugEnabled()) log.debug(\"created Transformerpool for sysId [\"+sysId+\"] classloader [\"+ClassUtils.getName(classLoader)+\"]\");\n+\t\t\ttFactory.setURIResolver(classLoaderURIResolver);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e4c8374219a04bfef3a53c3f96334c807263157"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a9f9de23d40c96c065b0364d1df3f0bcb2cce85", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/8a9f9de23d40c96c065b0364d1df3f0bcb2cce85", "committedDate": "2020-07-01T11:49:39Z", "message": "Make sure resources don't resolve when no ClassLoader is present"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1265, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}