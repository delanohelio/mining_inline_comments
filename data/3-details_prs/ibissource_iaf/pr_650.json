{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjcyNDMw", "number": 650, "title": "Fix recursive property resolution in log4j2 configuration files", "bodyText": "", "createdAt": "2020-04-28T17:58:49Z", "url": "https://github.com/ibissource/iaf/pull/650", "merged": true, "mergeCommit": {"oid": "6ec3d160dadc3f635505deae198fc6c6060bd216"}, "closed": true, "closedAt": "2020-04-29T11:34:09Z", "author": {"login": "nielsm5"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccHwCZAH2gAyNDEwMjcyNDMwOjFkODkxYmEzMDhkYTc2NDJiODY3NDRlNzQ4YmFiNzAzMmY5YmJkODc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccW27QAFqTQwMjU4MTc1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1d891ba308da7642b86744e748bab7032f9bbd87", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/1d891ba308da7642b86744e748bab7032f9bbd87", "committedDate": "2020-04-28T17:57:46Z", "message": "Fix recursive property resolution in log4j2 configuration files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "365898fcc0404c0863220aa67af3bb973690dc94", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/365898fcc0404c0863220aa67af3bb973690dc94", "committedDate": "2020-04-28T18:03:19Z", "message": "Fix typo and log configuration error to system.err"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMzk1MTEy", "url": "https://github.com/ibissource/iaf/pull/650#pullrequestreview-402395112", "createdAt": "2020-04-29T06:37:24Z", "commit": {"oid": "365898fcc0404c0863220aa67af3bb973690dc94"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjozNzoyNFrOGNxeKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNjo0OTowOFrOGNxvWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA5NTIxMQ==", "bodyText": "Ik vind dat als je een then clause op een volgende regel zet, je dan snorhaken moet gebruiken (accolades mag ook)", "url": "https://github.com/ibissource/iaf/pull/650#discussion_r417095211", "createdAt": "2020-04-29T06:37:24Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/logging/IbisLoggerConfigurationFactory.java", "diffHunk": "@@ -80,7 +82,10 @@ public Configuration getConfiguration(LoggerContext loggerContext, Configuration\n \t\t\tMap<String, String> substitutions = new HashMap<>();\n \t\t\twhile (m.find()) {\n \t\t\t\tString key = m.group(1);\n-\t\t\t\tsubstitutions.put(key, properties.getProperty(key));\n+\t\t\t\tString value = resolveValueRecursively(properties, key);\n+\n+\t\t\t\tif(value != null)\n+\t\t\t\t\tsubstitutions.put(key, value);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "365898fcc0404c0863220aa67af3bb973690dc94"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA5Nzc1NQ==", "bodyText": "Je weet niet of het obsolete is, je hebt alleen maar geen \"<log4j2:Configuration\" gezien.\nIk denk dat je moet zeggen: \"did not recognize configuration format, expected log4j2 layout.\nWordt het vervolgens nog wel ge\u00efnterpreteerd? dan dat ook zeggen.", "url": "https://github.com/ibissource/iaf/pull/650#discussion_r417097755", "createdAt": "2020-04-29T06:44:18Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/logging/IbisLoggerConfigurationFactory.java", "diffHunk": "@@ -140,6 +157,7 @@ public static String readLog4jConfiguration(InputStream stream) throws IOExcepti\n \t\t\t\tif(checkVersionOnlyFirst1024Characters) {\n \t\t\t\t\t//See if log4j2 prefix is somewhere in the first 1024 characters\n \t\t\t\t\tif(!stringWriter.toString().contains(\"<log4j2:Configuration\")) {\n+\t\t\t\t\t\tSystem.err.println(LOG_PREFIX + \"detected obsolete configuration format. Please use the log4j2 layout in file log4j4ibis.xml\");\n \t\t\t\t\t\tthrow new IllegalStateException(\"Detected obsolete configuration format. Please use the log4j2 layout in file log4j4ibis.xml\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "365898fcc0404c0863220aa67af3bb973690dc94"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA5OTYwOA==", "bodyText": "Bedoel je niet build.dir? user.dir is toch niet de project directory?", "url": "https://github.com/ibissource/iaf/pull/650#discussion_r417099608", "createdAt": "2020-04-29T06:49:08Z", "author": {"login": "gvanbrakel"}, "path": "core/src/test/resources/DeploymentSpecifics.properties", "diffHunk": "@@ -1,4 +1,4 @@\n instance.name=test\n-log.dir=${user.dir}\\\\target\n+log.dir=${user.dir}\\\\target\\\\test-logs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "365898fcc0404c0863220aa67af3bb973690dc94"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09b09ffc37dd0a506af95f0b6ff3fa38f42f81c9", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/09b09ffc37dd0a506af95f0b6ff3fa38f42f81c9", "committedDate": "2020-04-29T07:57:25Z", "message": "Fix logging in other modules"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNTgxNzU0", "url": "https://github.com/ibissource/iaf/pull/650#pullrequestreview-402581754", "createdAt": "2020-04-29T11:33:52Z", "commit": {"oid": "09b09ffc37dd0a506af95f0b6ff3fa38f42f81c9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1344, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}