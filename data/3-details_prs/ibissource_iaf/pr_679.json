{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNjM4OTQw", "number": 679, "title": "Dynamically enable and disable struts servlet", "bodyText": "", "createdAt": "2020-05-05T16:59:04Z", "url": "https://github.com/ibissource/iaf/pull/679", "merged": true, "mergeCommit": {"oid": "9da456e90e9a1cc903e2d337267cb51ab1c97dcb"}, "closed": true, "closedAt": "2020-05-08T13:23:30Z", "author": {"login": "nielsm5"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceWJl-AH2gAyNDEzNjM4OTQwOmE5MDJhMTVmNzUwZDk2NGIwYzE3MWVmMGZkZWUxYjQ1MDQzNGFiZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfRztWAFqTQwODIzMzcyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a902a15f750d964b0c171ef0fdee1b450434abd6", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/a902a15f750d964b0c171ef0fdee1b450434abd6", "committedDate": "2020-05-05T15:52:12Z", "message": "Turn Struts ActionServlet into Spring bean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6715dbcffd5a1806c9e3c0936dc39273732a73ed", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/6715dbcffd5a1806c9e3c0936dc39273732a73ed", "committedDate": "2020-05-05T16:19:00Z", "message": "Make cookies httpOnly and secure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03445dbf740499468e629509853bc30ca9f4a36f", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/03445dbf740499468e629509853bc30ca9f4a36f", "committedDate": "2020-05-06T14:26:20Z", "message": "introduce flow diagram lazyloading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "145ec545896b037d1a95ffbdc7b8b20287344154", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/145ec545896b037d1a95ffbdc7b8b20287344154", "committedDate": "2020-05-06T19:19:24Z", "message": "Hide aspectj logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79d159d63b302f9de8983bee7ce36703837b43e9", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/79d159d63b302f9de8983bee7ce36703837b43e9", "committedDate": "2020-05-06T19:19:35Z", "message": "bugfix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dc422b596af9d7ce86b7bd5157378ffb908121b", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/2dc422b596af9d7ce86b7bd5157378ffb908121b", "committedDate": "2020-05-06T20:04:09Z", "message": "Add tmp dir location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/1c5fd9704fe5334451582eb516b782d9b8e65030", "committedDate": "2020-05-06T20:31:30Z", "message": "Create tmp dir if not exist"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MDM3MzEw", "url": "https://github.com/ibissource/iaf/pull/679#pullrequestreview-408037310", "createdAt": "2020-05-08T06:54:48Z", "commit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQwNjo1NDo0OFrOGSbWVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQwNzoxMTo1MlrOGSbw-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3NTYzOQ==", "bodyText": "Wat doet dit precies?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421975639", "createdAt": "2020-05-08T06:54:48Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/FlowDiagram.java", "diffHunk": "@@ -16,49 +16,55 @@\n package nl.nn.adapterframework.util;\n \n import java.io.File;\n+import java.io.FileInputStream;\n import java.io.FileOutputStream;\n import java.io.IOException;\n+import java.io.InputStream;\n import java.util.List;\n \n import javax.xml.transform.TransformerConfigurationException;\n+import javax.xml.transform.TransformerException;\n \n import org.apache.commons.lang3.StringUtils;\n-import nl.nn.adapterframework.util.LogUtil;\n import org.apache.logging.log4j.Logger;\n+import org.springframework.beans.factory.DisposableBean;\n+import org.springframework.context.annotation.Scope;\n+import org.xml.sax.SAXException;\n \n import nl.nn.adapterframework.configuration.Configuration;\n-import nl.nn.adapterframework.configuration.ConfigurationException;\n import nl.nn.adapterframework.core.IAdapter;\n import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.extensions.graphviz.Format;\n import nl.nn.adapterframework.extensions.graphviz.GraphvizEngine;\n import nl.nn.adapterframework.extensions.graphviz.GraphvizException;\n import nl.nn.adapterframework.extensions.graphviz.Options;\n+import nl.nn.adapterframework.lifecycle.IbisInitializer;\n \n /**\n  * Utility class to generate the flow diagram for an adapter or a configuration.\n  * \n- * @author Peter Leeuwenburgh\n  * @author Niels Meijer\n  * @version 2.0\n  */\n \n-public class FlowDiagram {\n+@IbisInitializer\n+@Scope(\"singleton\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3NjA2MQ==", "bodyText": "Huh? Als de namen niet goed waren, moet je all the way gaan, en ook de .xsls hernoemen.", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421976061", "createdAt": "2020-05-08T06:55:54Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/FlowDiagram.java", "diffHunk": "@@ -16,49 +16,55 @@\n package nl.nn.adapterframework.util;\n \n import java.io.File;\n+import java.io.FileInputStream;\n import java.io.FileOutputStream;\n import java.io.IOException;\n+import java.io.InputStream;\n import java.util.List;\n \n import javax.xml.transform.TransformerConfigurationException;\n+import javax.xml.transform.TransformerException;\n \n import org.apache.commons.lang3.StringUtils;\n-import nl.nn.adapterframework.util.LogUtil;\n import org.apache.logging.log4j.Logger;\n+import org.springframework.beans.factory.DisposableBean;\n+import org.springframework.context.annotation.Scope;\n+import org.xml.sax.SAXException;\n \n import nl.nn.adapterframework.configuration.Configuration;\n-import nl.nn.adapterframework.configuration.ConfigurationException;\n import nl.nn.adapterframework.core.IAdapter;\n import nl.nn.adapterframework.core.Resource;\n import nl.nn.adapterframework.extensions.graphviz.Format;\n import nl.nn.adapterframework.extensions.graphviz.GraphvizEngine;\n import nl.nn.adapterframework.extensions.graphviz.GraphvizException;\n import nl.nn.adapterframework.extensions.graphviz.Options;\n+import nl.nn.adapterframework.lifecycle.IbisInitializer;\n \n /**\n  * Utility class to generate the flow diagram for an adapter or a configuration.\n  * \n- * @author Peter Leeuwenburgh\n  * @author Niels Meijer\n  * @version 2.0\n  */\n \n-public class FlowDiagram {\n+@IbisInitializer\n+@Scope(\"singleton\")\n+public class FlowDiagram implements DisposableBean {\n \tprivate static Logger log = LogUtil.getLogger(FlowDiagram.class);\n \n \tprivate final AppConstants APP_CONSTANTS = AppConstants.getInstance();\n \tprivate File adapterFlowDir = new File(APP_CONSTANTS.getResolvedProperty(\"flow.adapter.dir\"));\n \tprivate File configFlowDir = new File(APP_CONSTANTS.getResolvedProperty(\"flow.config.dir\"));\n \n-\tprivate static final String CONFIG2DOT_XSLT = \"/IAF_WebControl/GenerateFlowDiagram/xsl/config2dot.xsl\";\n-\tprivate static final String IBIS2DOT_XSLT = \"/IAF_WebControl/GenerateFlowDiagram/xsl/ibis2dot.xsl\";\n+\tprivate static final String ADAPTER2DOT_XSLT = \"/IAF_WebControl/GenerateFlowDiagram/xsl/config2dot.xsl\";\n+\tprivate static final String CONFIGURATION2DOT_XSLT = \"/IAF_WebControl/GenerateFlowDiagram/xsl/ibis2dot.xsl\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3NzI3MA==", "bodyText": "Het zou toch ook aardig zijn om hier gebruik te maken van FileSystems, zodat je deze flowdiagrams ook op een S3 bucket of SambaShare kan hosten", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421977270", "createdAt": "2020-05-08T06:58:59Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/FlowDiagram.java", "diffHunk": "@@ -96,25 +90,52 @@ public FlowDiagram(String format, String version) throws TransformerConfiguratio\n \n \t\toptions = options.format(this.format);\n \n-\t\tResource xsltSourceConfig = Resource.getResource(CONFIG2DOT_XSLT);\n+\t\tResource xsltSourceConfig = Resource.getResource(ADAPTER2DOT_XSLT);\n+\t\ttransformerPoolAdapter = TransformerPool.getInstance(xsltSourceConfig, 2);\n \n-\t\ttransformerPoolConfig = TransformerPool.getInstance(xsltSourceConfig, 2);\n+\t\tResource xsltSourceIbis = Resource.getResource(CONFIGURATION2DOT_XSLT);\n+\t\ttransformerPoolConfig = TransformerPool.getInstance(xsltSourceIbis, 2);\n+\t}\n \n-\t\tResource xsltSourceIbis = Resource.getResource(IBIS2DOT_XSLT);\n-\t\ttransformerPoolIbis = TransformerPool.getInstance(xsltSourceIbis, 2);\n+\tpublic InputStream get(IAdapter adapter) throws IOException, GraphvizException {\n+\t\tFile destFile = retrieveAdapterFlowFile(adapter);\n+\n+\t\tif(!destFile.exists()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3ODY5OA==", "bodyText": "Is dit cookie gedocumenteerd in de consent page?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421978698", "createdAt": "2020-05-08T07:02:45Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/action/BrowseJdbcTableExecute.java", "diffHunk": "@@ -240,6 +240,8 @@ public ActionForward executeSub(\n \t\t\t\t\t\"WEB_JDBCBROWSECOOKIE_NAME\"),\n \t\t\t\tcookieValue);\n \t\tsendJdbcBrowseCookie.setMaxAge(Integer.MAX_VALUE);\n+\t\tsendJdbcBrowseCookie.setHttpOnly(true);\n+\t\tsendJdbcBrowseCookie.setSecure(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3ODczMg==", "bodyText": "Is dit cookie gedocumenteerd in de consent page?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421978732", "createdAt": "2020-05-08T07:02:51Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/action/BrowseQueueExecute.java", "diffHunk": "@@ -158,6 +158,8 @@ public ActionForward executeSub(\n \t\t\t\t\t\"WEB_QBROWSECOOKIE\"),\n \t\t\t\tcookieValue);\n \t\tsendJmsCookie.setMaxAge(Integer.MAX_VALUE);\n+\t\tsendJmsCookie.setHttpOnly(true);\n+\t\tsendJmsCookie.setSecure(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3ODgyOA==", "bodyText": "Is dit cookie gedocumenteerd in de consent page?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421978828", "createdAt": "2020-05-08T07:03:06Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/action/ExecuteJdbcQueryExecute.java", "diffHunk": "@@ -119,6 +119,8 @@ public ActionForward executeSub(ActionMapping mapping, ActionForm form, HttpServ\n \t\t\t\t\t\"WEB_EXECJDBCCOOKIE_NAME\"),\n \t\t\t\tcookieValue);\n \t\texecJdbcCookie.setMaxAge(Integer.MAX_VALUE);\n+\t\texecJdbcCookie.setHttpOnly(true);\n+\t\texecJdbcCookie.setSecure(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3ODk2Mw==", "bodyText": "Is dit cookie gedocumenteerd in de consent page?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421978963", "createdAt": "2020-05-08T07:03:29Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/action/SendJmsMessageExecute.java", "diffHunk": "@@ -168,6 +168,8 @@ public ActionForward executeSub(ActionMapping mapping, ActionForm form, HttpServ\n \t          cookieValue += \"destinationType=\\\"\" + form_destinationType + \"\\\"\";\n \t          Cookie sendJmsCookie = new Cookie(AppConstants.getInstance().getProperty(\"WEB_JMSCOOKIE_NAME\"), cookieValue);\n \t          sendJmsCookie.setMaxAge(Integer.MAX_VALUE);\n+\t          sendJmsCookie.setHttpOnly(true);\n+\t          sendJmsCookie.setSecure(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk3OTAwOQ==", "bodyText": "Is dit cookie gedocumenteerd in de consent page?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421979009", "createdAt": "2020-05-08T07:03:36Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/action/ShowIbisstoreSummary.java", "diffHunk": "@@ -177,6 +177,8 @@ public ActionForward executeSub(ActionMapping mapping, ActionForm form, HttpServ\n \t\tString cookieValue = jmsRealm;\n \t\tCookie cookie =\tnew Cookie(cookieName, cookieValue);\n \t\tcookie.setMaxAge(Integer.MAX_VALUE);\n+\t\tcookie.setHttpOnly(true);\n+\t\tcookie.setSecure(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk4MDQ5Mw==", "bodyText": "Niet 'old' en 'legacy' noemen, ook geen 'ugly' of 'beautiful', maar naar iets wat het is. Zoiets als 'struts console'.", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421980493", "createdAt": "2020-05-08T07:07:13Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/resources/AppConstants.properties", "diffHunk": "@@ -352,6 +352,9 @@ etag.ehcache.dir=${cache.dir}\n etag.ehcache.diskPersistent=false\n etag.ehcache.diskExpiryThreadIntervalSeconds=600\n \n+########## OLD CONSOLE ##########\n+legacyConsole.enabled=false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk4MDY1OQ==", "bodyText": "Was die ander dan niet interactief?", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421980659", "createdAt": "2020-05-08T07:07:38Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/resources/AppConstants.properties", "diffHunk": "@@ -352,6 +352,9 @@ etag.ehcache.dir=${cache.dir}\n etag.ehcache.diskPersistent=false\n etag.ehcache.diskExpiryThreadIntervalSeconds=600\n \n+########## OLD CONSOLE ##########\n+legacyConsole.enabled=false\n+active.config.database=false\n \n ########## INTERACTIVE CONSOLE ##########\n # Activates the new IBIS API + GUI3.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk4MjQ1Ng==", "bodyText": "Ook hier: Struts console, console 1.2", "url": "https://github.com/ibissource/iaf/pull/679#discussion_r421982456", "createdAt": "2020-05-08T07:11:52Z", "author": {"login": "gvanbrakel"}, "path": "webapp/src/main/webapp/iaf/gui/js/controllers.js", "diffHunk": "@@ -398,6 +399,13 @@ angular.module('iaf.beheerconsole')\n \t\t$(\".rating i\").removeClass(\"fa-star\").addClass(\"fa-star-o\");\n \t\t$(\".rating i:nth-child(-n+\"+ (rating + 1) +\")\").addClass(\"fa-star\").removeClass(\"fa-star-o\");\n \t};\n+\n+\t$scope.showLegacyConsoleDisabled = function () {\n+\t\tSweetAlert.Warning({\n+\t\t\ttitle: \"Legacy Console Disabled\",\n+\t\t\ttext: \"The old console has been disabled. In order to enable it, set te property [legacyConsole.enabled] to true.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5fd9704fe5334451582eb516b782d9b8e65030"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19f66f70e9b79b0136f44b62e91f4eae2daa0174", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/19f66f70e9b79b0136f44b62e91f4eae2daa0174", "committedDate": "2020-05-08T12:17:01Z", "message": "Rename and move flowdiagram xslts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "739eaaca1f35b2aae1752bf1348dbb16c0a0b3e8", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/739eaaca1f35b2aae1752bf1348dbb16c0a0b3e8", "committedDate": "2020-05-08T12:17:20Z", "message": "Rename legacy to struts console"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5c4c92427b9f2aa01c5b69d7c2a563ee4b3c232", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/c5c4c92427b9f2aa01c5b69d7c2a563ee4b3c232", "committedDate": "2020-05-08T12:18:29Z", "message": "Fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36561157ea4fb0936db8118af35cd3f5ce57656e", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/36561157ea4fb0936db8118af35cd3f5ce57656e", "committedDate": "2020-05-08T12:26:55Z", "message": "Make sure restservicedispatcher doesn't freak out"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MjMzNzI0", "url": "https://github.com/ibissource/iaf/pull/679#pullrequestreview-408233724", "createdAt": "2020-05-08T13:22:36Z", "commit": {"oid": "36561157ea4fb0936db8118af35cd3f5ce57656e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1357, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}