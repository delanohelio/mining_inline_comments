{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2NjUyMDA4", "number": 1165, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNzoyMjo0NlrOEwG3Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwOTo1MDo1M1rOEwKqEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4ODc5NTg2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/nl/nn/adapterframework/http/rest/ApiServiceDispatcher.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNzoyMjo0NlrOHldrvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNzoyMjo0NlrOHldrvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTA0NTY5Mw==", "bodyText": "What is ref is null?", "url": "https://github.com/ibissource/iaf/pull/1165#discussion_r509045693", "createdAt": "2020-10-21T07:22:46Z", "author": {"login": "nielsm5"}, "path": "core/src/main/java/nl/nn/adapterframework/http/rest/ApiServiceDispatcher.java", "diffHunk": "@@ -242,6 +242,8 @@ private JsonObjectBuilder mapResponses(IAdapter adapter, MediaTypes contentType,\n \t\t\t\tif(schema == null) {\n \t\t\t\t\tcontent.addNull(contentType.getContentType());\n \t\t\t\t} else {\n+\t\t\t\t\t// JsonObjectBuilder add method consumes the schema\n+\t\t\t\t\tschema.add(\"schema\", Json.createObjectBuilder().add(\"$ref\", \"#/components/schemas/\"+ref));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d3e026a04a29afb5dbfe8ddde972c890a213a8b"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTQxNzEyOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/nl/nn/adapterframework/http/rest/ApiServiceDispatcher.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwOTo1MDo1M1rOHljsLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwOTo1MDo1M1rOHljsLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE0NDExMA==", "bodyText": "In the spirit of 'we want enums', could you refactor the ApiListener a bit?\nReplace the getProduces() and getConsumes with getProducesEnum() and getConsumesEnum. So you don't have to convert the strings back to enums on line 186 and 190?", "url": "https://github.com/ibissource/iaf/pull/1165#discussion_r509144110", "createdAt": "2020-10-21T09:50:53Z", "author": {"login": "nielsm5"}, "path": "core/src/main/java/nl/nn/adapterframework/http/rest/ApiServiceDispatcher.java", "diffHunk": "@@ -180,7 +180,12 @@ protected JsonObject generateOpenApiJsonSchema(Collection<ApiDispatchConfig> cli\n \t\t\t\t\t\tmethodBuilder.add(\"summary\", adapter.getDescription());\n \t\t\t\t\t}\n \t\t\t\t\tmethodBuilder.add(\"operationId\", adapter.getName());\n-\n+\t\t\t\t\tPipeLine pipeline = adapter.getPipeLine();\n+\t\t\t\t\tJson2XmlValidator validator = getJsonValidator(pipeline);\n+\t\t\t\t\tif(validator != null && StringUtils.isNotEmpty(validator.getRoot())) {\n+\t\t\t\t\t\tMediaTypes consumes = MediaTypes.valueOf(listener.getConsumes());\n+\t\t\t\t\t\tmethodBuilder.add(\"requestBody\", mapRequest(consumes, validator.getRoot()));\n+\t\t\t\t\t}\n \t\t\t\t\t//ContentType may have more parameters such as charset and formdata-boundry\n \t\t\t\t\tMediaTypes produces = MediaTypes.valueOf(listener.getProduces());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "74d76f45907c084cd53d7f2b3faa5d46f4fb2283"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 579, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}