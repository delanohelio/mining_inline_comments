{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMzUxOTIy", "number": 584, "title": "Add resend/remove selected messages to GUI 3.0", "bodyText": "", "createdAt": "2020-04-07T15:48:31Z", "url": "https://github.com/ibissource/iaf/pull/584", "merged": true, "mergeCommit": {"oid": "e5d89090e9a86daf391d9b065d60706b3f21c74b"}, "closed": true, "closedAt": "2020-04-15T14:13:10Z", "author": {"login": "nielsm5"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVVTRggH2gAyNDAwMzUxOTIyOmY4MjdlMjA4ZGQ2ZjVkYjkxMzUzMGI2MzM4NzBlMTQ1ODQzMGY2YTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX4vglgFqTM5Mzc5NjY4Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f827e208dd6f5db913530b633870e1458430f6a1", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/f827e208dd6f5db913530b633870e1458430f6a1", "committedDate": "2020-04-07T15:47:33Z", "message": "Add resend/remove selected messages to GUI 3.0"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNTE2Nzk0", "url": "https://github.com/ibissource/iaf/pull/584#pullrequestreview-390516794", "createdAt": "2020-04-09T06:18:58Z", "commit": {"oid": "f827e208dd6f5db913530b633870e1458430f6a1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNjoxODo1OFrOGDK-5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNjoxOTo0MlrOGDK_5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk3ODg1Mw==", "bodyText": "Het lijkt me een goed idee om in de cookie uitleg te vermelden waar elk cookie precies voor gebruikt wordt,\nzodat je snapt waar je ja of nee tegen zegt.", "url": "https://github.com/ibissource/iaf/pull/584#discussion_r405978853", "createdAt": "2020-04-09T06:18:58Z", "author": {"login": "gvanbrakel"}, "path": "webapp/src/main/webapp/iaf/gui/js/controllers.js", "diffHunk": "@@ -1163,26 +1163,52 @@ angular.module('iaf.beheerconsole')\n \t};\n }])\n \n-.controller('AdapterErrorStorageCtrl', ['$scope', 'Api', '$compile', function($scope, Api, $compile) {\n+.controller('AdapterErrorStorageCtrl', ['$scope', 'Api', '$compile', 'Cookies', function($scope, Api, $compile, Cookies) {\n \t$scope.closeNotes();\n+\t$scope.selectedMessages = [];\n \n-\tvar a =  '<a ui-sref=\"pages.errorstorage.view({adapter:adapterName,receiver:receiverName,messageId:message.id})\" class=\"btn btn-info btn-xs\" type=\"button\"><i class=\"fa fa-file-text-o\"></i> View</a>';\n+\tvar a =  '<input icheck type=\"checkbox\" ng-model=\"selectedMessages[message.id]\"/>';\n+\t\ta += '<div ng-show=\"!selectedMessages[message.id]\">';\n+\t\ta += '<a ui-sref=\"pages.errorstorage.view({adapter:adapterName,receiver:receiverName,messageId:message.id})\" class=\"btn btn-info btn-xs\" type=\"button\"><i class=\"fa fa-file-text-o\"></i> View</a>';\n \t\ta += '<button ladda=\"message.resending\" data-style=\"slide-down\" title=\"Resend Message\" ng-click=\"resendMessage(message)\" class=\"btn btn-warning btn-xs\" type=\"button\"><i class=\"fa fa-repeat\"></i> Resend</button>';\n \t\ta += '<button ladda=\"message.deleting\" data-style=\"slide-down\" title=\"Delete Message\" ng-click=\"deleteMessage(message)\" class=\"btn btn-danger btn-xs\" type=\"button\"><i class=\"fa fa-times\"></i> Delete</button>';\n \t\ta += '<button title=\"Download Message\" ng-click=\"downloadMessage(message.id)\" class=\"btn btn-info btn-xs\" type=\"button\"><i class=\"fa fa-arrow-circle-o-down\"></i> Download</button>';\n+\t\ta += '</div';\n \n \tvar columns = [\n-\t\t{ \"data\": null, defaultContent: a, className: \"m-b-xxs\", bSortable: false},\n-\t\t{ \"data\": \"id\", bSortable: false },\n-\t\t{ \"data\": \"insertDate\", className: \"date\" },\n-\t\t{ \"data\": \"host\", bSortable: false },\n-\t\t{ \"data\": \"originalId\", bSortable: false },\n-\t\t{ \"data\": \"correlationId\", bSortable: false },\n-\t\t{ \"data\": \"comment\", bSortable: false },\n-\t\t{ \"data\": \"expiryDate\", className: \"date\", bSortable: false },\n-\t\t{ \"data\": \"label\", bSortable: false },\n+\t\t{ \"data\": null, defaultContent: a, className: \"m-b-xxs storageActions\", bSortable: false},\n+\t\t{ \"name\": \"id\", \"data\": \"id\", bSortable: false },\n+\t\t{ \"name\": \"insertDate\", \"data\": \"insertDate\", className: \"date\" },\n+\t\t{ \"name\": \"host\", \"data\": \"host\", bSortable: false },\n+\t\t{ \"name\": \"originalId\", \"data\": \"originalId\", bSortable: false },\n+\t\t{ \"name\": \"correlationId\", \"data\": \"correlationId\", bSortable: false },\n+\t\t{ \"name\": \"comment\", \"data\": \"comment\", bSortable: false },\n+\t\t{ \"name\": \"expiryDate\", \"data\": \"expiryDate\", className: \"date\", bSortable: false },\n+\t\t{ \"name\": \"label\", \"data\": \"label\", bSortable: false },\n \t];\n \n+\tvar filterCookie = Cookies.get(\"errorstorageFilter\");\n+\tif(filterCookie) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f827e208dd6f5db913530b633870e1458430f6a1"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk3OTExMQ==", "bodyText": "Hier van maken 'unable to send all messages'", "url": "https://github.com/ibissource/iaf/pull/584#discussion_r405979111", "createdAt": "2020-04-09T06:19:42Z", "author": {"login": "gvanbrakel"}, "path": "webapp/src/main/webapp/iaf/gui/js/controllers.js", "diffHunk": "@@ -1237,8 +1264,70 @@ angular.module('iaf.beheerconsole')\n \t\tlabel: \"\",\n \t};\n \n+\t$scope.updateFilter = function(column) {\n+\t\tCookies.set(\"errorstorageFilter\", $scope.displayColumn);\n+\n+\t\tvar table = $('#datatable').DataTable();\n+\t\tif(table) {\n+\t\t\tvar tableColumn = table.column(column+\":name\");\n+\t\t\tif(tableColumn && tableColumn.length == 1)\n+\t\t\t\ttableColumn.visible( $scope.displayColumn[column] );\n+\t\t\ttable.draw();\n+\t\t}\n+\t}\n+\n \t$scope.resendMessage = $scope.doResendMessage;\n \t$scope.deleteMessage = $scope.doDeleteMessage;\n+\n+\t$scope.selectAll = function() {\n+\t\tfor(i in $scope.selectedMessages) {\n+\t\t\t$scope.selectedMessages[i] = true;\n+\t\t}\n+\t}\n+\t$scope.unselectAll = function() {\n+\t\tfor(i in $scope.selectedMessages) {\n+\t\t\t$scope.selectedMessages[i] = false;\n+\t\t}\n+\t}\n+\n+\t$scope.messagesResending = false;\n+\t$scope.messagesDeleting = false;\n+\tfunction getFormData() {\n+\t\tvar messageIds = [];\n+\t\tfor(i in $scope.selectedMessages) {\n+\t\t\tif($scope.selectedMessages[i]) {\n+\t\t\t\tmessageIds.push(i);\n+\t\t\t}\n+\t\t}\n+\n+\t\tvar fd = new FormData();\n+\t\tfd.append(\"messageIds\", messageIds);\n+\t\treturn fd;\n+\t}\n+\t$scope.resendMessages = function() {\n+\t\t$scope.messagesResending = true;\n+\t\tApi.Post($scope.base_url, getFormData(), function() {\n+\t\t\t$scope.messagesResending = false;\n+\t\t\t$scope.addNote(\"success\", \"Successfully resent messages\");\n+\t\t\t$scope.updateTable();\n+\t\t}, function(data) {\n+\t\t\t$scope.messagesResending = false;\n+\t\t\t$scope.addNote(\"danger\", \"Something went wrong, unable to resend messages!\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f827e208dd6f5db913530b633870e1458430f6a1"}, "originalPosition": 124}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d19f70a058a8005301b79b4530a7a0fe902f2db", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/3d19f70a058a8005301b79b4530a7a0fe902f2db", "committedDate": "2020-04-15T13:33:58Z", "message": "Add more cookies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNzk2Njg3", "url": "https://github.com/ibissource/iaf/pull/584#pullrequestreview-393796687", "createdAt": "2020-04-15T13:54:56Z", "commit": {"oid": "3d19f70a058a8005301b79b4530a7a0fe902f2db"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxMzo1NDo1NlrOGF63ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxMzo1NDo1NlrOGF63ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODg2MDYxMQ==", "bodyText": "En hoe kan ik nou zien dat de cookies die in deze change zitten geclassificeerd zijn als 'Personalization Cookies', en dat ze niet gezet worden als ik het vinkje daarvoor heb uitgezet?", "url": "https://github.com/ibissource/iaf/pull/584#discussion_r408860611", "createdAt": "2020-04-15T13:54:56Z", "author": {"login": "gvanbrakel"}, "path": "webapp/src/main/webapp/iaf/gui/views/common/cookieModal.html", "diffHunk": "@@ -3,25 +3,28 @@\n \t\t<h4 class=\"modal-title\"><i class=\"fa fa-info\"></i> This website uses cookies!</h4>\n \t</div>\n \t<div class=\"modal-body\">\n-\t\t<h3>How We Use Cookies</h3>\n-\t\t<p>\n-\t\t\tAs is common practice with almost all professional websites, this site uses cookies to improve your browsing experience.\n-\t\t\tYou can untick the below checkboxes to prevent certain cookies from being stored however this may downgrade or \n-\t\t\t'break' certain elements of the sites functionality.\n-\t\t\tIt is recommended that you leave on all cookies if you are not sure whether you need them or not.\n-\t\t</p>\n-\t\t<h3>Our Cookies</h3>\n+\t\t<h3>Necessary Cookies</h3>\n \t\t<p>\n \t\t\tIn order to provide you with a great experience on this site we provide the functionality to set your preferences \n \t\t\tfor how this site runs when you use it. In order to remember your preferences we need to set cookies so that this \n \t\t\tinformation can be called whenever you interact with a page is affected by your preferences.\n \t\t</p>\n+\t\t<h3>Functional Cookies</h3>\n \t\t<p>\n \t\t\tFrom time to time we test new features and make subtle changes to the way that the site is delivered. When we \n \t\t\tare still testing new features these cookies may be used to ensure that you receive a consistent experience \n \t\t\twhilst on the site whilst ensuring we understand which optimisations our users appreciate the most.\n+\t\t\tUnticking this may downgrade or 'break' certain elements of the sites functionality.\n+\t\t</p>\n+\t\t<h3>Personalization Cookies</h3>\n+\t\t<p>\n+\t\t\tYour own personal settings such as:\n+\t\t\t<ul>\n+\t\t\t\t<li>Your last executed query</li>\n+\t\t\t\t<li>Columns you have hidden on the ErrorStorage</li>\n+\t\t\t</ul>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d19f70a058a8005301b79b4530a7a0fe902f2db"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1313, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}