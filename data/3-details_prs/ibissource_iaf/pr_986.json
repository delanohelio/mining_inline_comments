{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3ODYzMTkw", "number": 986, "title": "Fix V8 IllegalThread Access", "bodyText": "", "createdAt": "2020-08-14T08:58:02Z", "url": "https://github.com/ibissource/iaf/pull/986", "merged": true, "mergeCommit": {"oid": "216a8ae3dc43f2b275675aeff95c639e7cd12366"}, "closed": true, "closedAt": "2020-09-08T12:23:23Z", "author": {"login": "nielsm5"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-wvOqgH2gAyNDY3ODYzMTkwOjM1YmM1ODI4NWIyMDgwZGNiMTU5ZmVjM2Y1ODc2MTE2ODM2MGJhMGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdG2ri2gFqTQ4NDA3ODAwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "35bc58285b2080dcb159fec3f58761168360ba0f", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/35bc58285b2080dcb159fec3f58761168360ba0f", "committedDate": "2020-08-14T08:56:25Z", "message": "Fix V8 threadaccess"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MDE1ODQy", "url": "https://github.com/ibissource/iaf/pull/986#pullrequestreview-469015842", "createdAt": "2020-08-18T06:08:37Z", "commit": {"oid": "35bc58285b2080dcb159fec3f58761168360ba0f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwNjowODozN1rOHCEp1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwNjoxMToxN1rOHCEtOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNTQ0NQ==", "bodyText": "waarom niet: log.error(\"Caught exception in handling API call\", exception); ?", "url": "https://github.com/ibissource/iaf/pull/986#discussion_r471935445", "createdAt": "2020-08-18T06:08:37Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/api/ApiExceptionHandler.java", "diffHunk": "@@ -44,6 +50,8 @@ public Response toResponse(Exception exception) {\n \t\t\treturn ((ApiException) exception).getResponse();\n \t\t}\n \n+\t\tlog.error(exception.getLocalizedMessage(), exception);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35bc58285b2080dcb159fec3f58761168360ba0f"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNTcyNA==", "bodyText": "Waar is dit nodig?", "url": "https://github.com/ibissource/iaf/pull/986#discussion_r471935724", "createdAt": "2020-08-18T06:09:29Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/StreamUtil.java", "diffHunk": "@@ -147,6 +147,11 @@ public static Reader getCharsetDetectingInputStreamReader(InputStream inputStrea\n \t\tBOMInputStream bOMInputStream = new BOMInputStream(inputStream,ByteOrderMark.UTF_8, ByteOrderMark.UTF_16LE, ByteOrderMark.UTF_16BE);\n \t\tByteOrderMark bom = bOMInputStream.getBOM();\n \t\tString charsetName = bom == null ? defaultCharset : bom.getCharsetName();\n+\n+\t\tif(StringUtils.isEmpty(charsetName)) {\n+\t\t\tcharsetName = StreamUtil.DEFAULT_INPUT_STREAM_ENCODING;\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35bc58285b2080dcb159fec3f58761168360ba0f"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNjMxNQ==", "bodyText": "Waarom zit dit in een ThreadLocal?", "url": "https://github.com/ibissource/iaf/pull/986#discussion_r471936315", "createdAt": "2020-08-18T06:11:17Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/flow/V8FlowGenerator.java", "diffHunk": "@@ -31,13 +31,13 @@\n public class V8FlowGenerator implements IFlowGenerator {\n \tprivate static Logger log = LogUtil.getLogger(V8FlowGenerator.class);\n \n-\tprivate GraphvizEngine engine;\n+\tprivate ThreadLocal<GraphvizEngine> engines = new ThreadLocal<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35bc58285b2080dcb159fec3f58761168360ba0f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88a76fa64fe6cbf33ef6c8942aaa68aaedf33ba4", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/88a76fa64fe6cbf33ef6c8942aaa68aaedf33ba4", "committedDate": "2020-09-01T09:01:39Z", "message": "Create timer based IFlowEngine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34475e2bef3fe775d1bd476f7b00f4b99a1b17cd", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/34475e2bef3fe775d1bd476f7b00f4b99a1b17cd", "committedDate": "2020-09-01T09:02:07Z", "message": "Remove sysout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff21ed031658705012e66fef9880f81904e2d611", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/ff21ed031658705012e66fef9880f81904e2d611", "committedDate": "2020-09-01T11:05:29Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b189e95b21cd6d609e28af8d057f3a96bb120fc", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/8b189e95b21cd6d609e28af8d057f3a96bb120fc", "committedDate": "2020-09-07T11:00:10Z", "message": "Add SoftReference to threadlocals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82169034c80c5c5f204bc860da19e47528df1634", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/82169034c80c5c5f204bc860da19e47528df1634", "committedDate": "2020-09-07T11:13:56Z", "message": "Change exception message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzODg0NzMx", "url": "https://github.com/ibissource/iaf/pull/986#pullrequestreview-483884731", "createdAt": "2020-09-08T07:57:12Z", "commit": {"oid": "82169034c80c5c5f204bc860da19e47528df1634"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNzo1NzoxM1rOHORMiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNzo1NzoxM1rOHORMiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDcyMzg0OQ==", "bodyText": "Is het zeker dat het resultaat van getFlowGenerator hier nooit null is?", "url": "https://github.com/ibissource/iaf/pull/986#discussion_r484723849", "createdAt": "2020-09-08T07:57:13Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/util/flow/FlowDiagramManager.java", "diffHunk": "@@ -248,7 +280,7 @@ private void generateFlowDiagram(String name, String dot, File destination) thro\n \t\tlong start = System.currentTimeMillis();\n \n \t\ttry (FileOutputStream outputStream = new FileOutputStream(destination)) {\n-\t\t\tgenerator.generateFlow(name, dot, outputStream);\n+\t\t\tgetFlowGenerator().generateFlow(name, dot, outputStream);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82169034c80c5c5f204bc860da19e47528df1634"}, "originalPosition": 133}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MDc4MDA0", "url": "https://github.com/ibissource/iaf/pull/986#pullrequestreview-484078004", "createdAt": "2020-09-08T12:23:13Z", "commit": {"oid": "82169034c80c5c5f204bc860da19e47528df1634"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1173, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}