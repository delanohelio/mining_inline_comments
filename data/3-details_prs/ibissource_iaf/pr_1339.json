{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwMDQ0NzMw", "number": 1339, "title": "Imp #1215 soap wrapper using message", "bodyText": "", "createdAt": "2020-12-15T07:34:59Z", "url": "https://github.com/ibissource/iaf/pull/1339", "merged": true, "mergeCommit": {"oid": "1f266c24f6049a83a35220bc50f7e91b0a6e2d68"}, "closed": true, "closedAt": "2020-12-16T07:20:07Z", "author": {"login": "gvanbrakel"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmHM1tgH2gAyNTQwMDQ0NzMwOjA3NGY0Nzk0NWQxMjZkNTFkNWE1OTAwM2Q2NDNkOWZkYmZkOTRhMWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmdXgogFqTU1MjY3MDU1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "074f47945d126d51d5a59003d643d9fdbfd94a1f", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/074f47945d126d51d5a59003d643d9fdbfd94a1f", "committedDate": "2020-12-14T15:09:43Z", "message": "Use Message for SoapWrapper unwrap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bacc60ebebcdb8097d55e71cddb40e6dbc506c95", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/bacc60ebebcdb8097d55e71cddb40e6dbc506c95", "committedDate": "2020-12-14T22:01:52Z", "message": "SenderPipe fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b8100db4d2afc84955b041d045c881020e285f8", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/2b8100db4d2afc84955b041d045c881020e285f8", "committedDate": "2020-12-15T07:25:03Z", "message": "SoapWrapper using Message for direction wrap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b735bcf66cd3850632520319992ba76f0127ab77", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/b735bcf66cd3850632520319992ba76f0127ab77", "committedDate": "2020-12-15T07:34:24Z", "message": "more updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81237fa8316f081c5cd95f83f39e9b2e2da2c8e9", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/81237fa8316f081c5cd95f83f39e9b2e2da2c8e9", "committedDate": "2020-12-15T07:50:24Z", "message": "Fix issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzA0OTM5", "url": "https://github.com/ibissource/iaf/pull/1339#pullrequestreview-552304939", "createdAt": "2020-12-15T10:23:00Z", "commit": {"oid": "81237fa8316f081c5cd95f83f39e9b2e2da2c8e9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMDoyMzowMFrOIGDlRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMDoyNToxMFrOIGDrlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzIyMTA2MQ==", "bodyText": "Gaat dit wel goed? getResponseBody kan een java.io.IOException: Stream closed exceptie gooien bij het lezen van een foutive response.\nIn getResponseBodyAsString zit hiervoor een try/catch die silent null terug geeft. Nu krijg je een exceptie in een exceptie", "url": "https://github.com/ibissource/iaf/pull/1339#discussion_r543221061", "createdAt": "2020-12-15T10:23:00Z", "author": {"login": "nielsm5"}, "path": "core/src/main/java/nl/nn/adapterframework/http/WebServiceSender.java", "diffHunk": "@@ -132,19 +132,20 @@ protected HttpRequestBase getMethod(URI uri, Message message, ParameterValueList\n \t\t}\n \t\tif (log.isDebugEnabled()) log.debug(getLogPrefix()+\"SOAPMSG [\" + soapmsg + \"]\");\n \n-\t\tHttpRequestBase method = super.getMethod(uri, new Message(soapmsg), parameters, session);\n+\t\tHttpRequestBase method = super.getMethod(uri, soapmsg, parameters, session);\n \t\tlog.debug(getLogPrefix()+\"setting SOAPAction header [\"+soapActionURI+\"]\");\n \t\tmethod.setHeader(\"SOAPAction\", soapActionURI);\n \t\treturn method;\n \t}\n \n \t@Override\n \tprotected Message extractResult(HttpResponseHandler responseHandler, IPipeLineSession session) throws SenderException, IOException {\n-\t\tString httpResult = null;\n+\t\tMessage httpResult = null;\n \t\ttry {\n-\t\t\thttpResult = super.extractResult(responseHandler, session).asString();\n+\t\t\thttpResult = super.extractResult(responseHandler, session);\n+\t\t\thttpResult.preserve();\n \t\t} catch (SenderException e) {\n-\t\t\tsoapWrapper.checkForSoapFault(getResponseBodyAsString(responseHandler), e);\n+\t\t\tsoapWrapper.checkForSoapFault(getResponseBody(responseHandler), e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81237fa8316f081c5cd95f83f39e9b2e2da2c8e9"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzIyMjY3OQ==", "bodyText": "de responseBody moet hier persistent zijn, anders gaan hier fouten ontstaan. Misschien is het handig de tests aan te passen, aangezien dit niet getest wordt!", "url": "https://github.com/ibissource/iaf/pull/1339#discussion_r543222679", "createdAt": "2020-12-15T10:25:10Z", "author": {"login": "nielsm5"}, "path": "core/src/main/java/nl/nn/adapterframework/soap/SoapWrapper.java", "diffHunk": "@@ -101,7 +97,7 @@ public static SoapWrapper getInstance() throws ConfigurationException {\n \t\treturn self;\n \t}\n \n-\tpublic void checkForSoapFault(String responseBody, Throwable nested) throws SenderException {\n+\tpublic void checkForSoapFault(Message responseBody, Throwable nested) throws SenderException {\n \t\tString faultString = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81237fa8316f081c5cd95f83f39e9b2e2da2c8e9"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b92cc91d371d38321076f269ef22ec108ff2f8e", "author": {"user": {"login": "gvanbrakel", "name": "Gerrit van Brakel"}}, "url": "https://github.com/ibissource/iaf/commit/3b92cc91d371d38321076f269ef22ec108ff2f8e", "committedDate": "2020-12-15T14:09:22Z", "message": "Fix problems"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4841815a015201f057a2c7c1dda876043fded905", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/4841815a015201f057a2c7c1dda876043fded905", "committedDate": "2020-12-15T15:30:16Z", "message": "Fix cmis module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7112cd7fbf325361f574523752214881eae1f0b1", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/7112cd7fbf325361f574523752214881eae1f0b1", "committedDate": "2020-12-15T15:37:19Z", "message": "Fix WSS SoapFault exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cb8b35a67cd4aaacc7ecacce5df8deb80d29599", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/9cb8b35a67cd4aaacc7ecacce5df8deb80d29599", "committedDate": "2020-12-15T15:39:28Z", "message": "Fix NPE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92700d23fd1f53efdcd18ef2c3e10b9c719ea0e0", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/92700d23fd1f53efdcd18ef2c3e10b9c719ea0e0", "committedDate": "2020-12-15T16:58:40Z", "message": "Remove getResponseBodyAsString"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNjcwNTU1", "url": "https://github.com/ibissource/iaf/pull/1339#pullrequestreview-552670555", "createdAt": "2020-12-15T16:59:17Z", "commit": {"oid": "9cb8b35a67cd4aaacc7ecacce5df8deb80d29599"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 944, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}