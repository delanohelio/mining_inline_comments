{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0NTYzNzQw", "number": 962, "title": "Add ability to log out of the GUI 3.0", "bodyText": "", "createdAt": "2020-07-21T15:00:20Z", "url": "https://github.com/ibissource/iaf/pull/962", "merged": true, "mergeCommit": {"oid": "647e3a2e0883c9cfac11e69e14480f5c58a16d1a"}, "closed": true, "closedAt": "2020-07-22T07:26:54Z", "author": {"login": "nielsm5"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3HjOwAH2gAyNDU0NTYzNzQwOjExZWI2MTM5NTgxYjI4ZmUxM2ZlNzE4MmIxMzNmMWRmZWY2MTAyMWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3Vq3wgFqTQ1MzA1OTk5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "11eb6139581b28fe13fe7182b133f1dfef61021b", "author": {"user": {"login": "nielsm5", "name": "Niels"}}, "url": "https://github.com/ibissource/iaf/commit/11eb6139581b28fe13fe7182b133f1dfef61021b", "committedDate": "2020-07-21T14:59:44Z", "message": "Add ability to log out of the GUI 3.0"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzMDE1NjQ4", "url": "https://github.com/ibissource/iaf/pull/962#pullrequestreview-453015648", "createdAt": "2020-07-22T05:59:32Z", "commit": {"oid": "11eb6139581b28fe13fe7182b133f1dfef61021b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwNTo1OTozMlrOG1T1og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwNTo1OTozMlrOG1T1og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU1MjczOA==", "bodyText": "Ik denk dat 204 No Content hier meer op z'n plaats is.", "url": "https://github.com/ibissource/iaf/pull/962#discussion_r458552738", "createdAt": "2020-07-22T05:59:32Z", "author": {"login": "gvanbrakel"}, "path": "core/src/main/java/nl/nn/adapterframework/webcontrol/api/Authentication.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+Copyright 2020 WeAreFrank!\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+*/\n+package nl.nn.adapterframework.webcontrol.api;\n+\n+import javax.annotation.security.PermitAll;\n+import javax.servlet.ServletException;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import javax.ws.rs.GET;\n+import javax.ws.rs.Path;\n+import javax.ws.rs.Produces;\n+import javax.ws.rs.core.Context;\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.Response;\n+import javax.ws.rs.core.Response.Status;\n+\n+import org.apache.logging.log4j.Logger;\n+\n+import nl.nn.adapterframework.util.LogUtil;\n+\n+@Path(\"/\")\n+public class Authentication {\n+\t@Context HttpServletRequest httpServletRequest;\n+\t@Context HttpServletResponse httpServletResponse;\n+\n+\tprotected Logger log = LogUtil.getLogger(this);\n+\n+\t@GET\n+\t@PermitAll\n+\t@Path(\"/logout\")\n+\t@Produces(MediaType.APPLICATION_JSON)\n+\tpublic Response logout() {\n+\n+\t\tif(httpServletRequest.getUserPrincipal() != null) {\n+\t\t\tString user = httpServletRequest.getUserPrincipal().getName();\n+\t\t\ttry {\n+\t\t\t\thttpServletRequest.logout();\n+\t\t\t\tlog.debug(\"successfully logged out user [\"+user+\"]\");\n+\t\t\t} catch (ServletException e) {\n+\t\t\t\tthrow new ApiException(e);\n+\t\t\t}\n+\t\t} else {\n+\t\t\tlog.debug(\"unable to log out user, not logged in\");\n+\t\t}\n+\n+\t\thttpServletResponse.setHeader(\"Refresh\", \"5\");\n+\t\treturn Response.status(Status.UNAUTHORIZED).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11eb6139581b28fe13fe7182b133f1dfef61021b"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzMDU5OTkz", "url": "https://github.com/ibissource/iaf/pull/962#pullrequestreview-453059993", "createdAt": "2020-07-22T07:26:45Z", "commit": {"oid": "11eb6139581b28fe13fe7182b133f1dfef61021b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1152, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}