{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNDg5NTk4", "number": 1298, "title": "DBZ-1840 Re-instantiating pausing between readPending() calls without event", "bodyText": "https://issues.redhat.com/browse/DBZ-1840\nNote this means to that WAL offsets cannot be acknowledged in cases\nwhere a null message is received from the server (e.g. wal2json for\nDDL events). But as we cannot tell apart null events from the server\nfrom readPending() simply having no events to read, the current\nlogic renders the pausing between two read calls without events\nobsolete, so that's the lesser evil\n@jpechane, @Naros, still doing some more testing, but pushing it here for feedback. Best review ignoring whitespace changes. Thx!", "createdAt": "2020-03-02T16:44:12Z", "url": "https://github.com/debezium/debezium/pull/1298", "merged": true, "mergeCommit": {"oid": "c5422e6b3170398bdccb2392db01d56f74c99f69"}, "closed": true, "closedAt": "2020-03-03T10:45:55Z", "author": {"login": "gunnarmorling"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJ8qYoAFqTM2NzczNjA1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKAADbgBqjMwOTE2MTYwMzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NzM2MDU5", "url": "https://github.com/debezium/debezium/pull/1298#pullrequestreview-367736059", "createdAt": "2020-03-03T06:52:00Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwNjo1MjowMFrOFw6DiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwNjo1MjowMFrOFw6DiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgyNzE0NA==", "bodyText": "@gunnarmorling Lookign at the code I'd propose a small change in formatting.\nLet's extract stream.readPending to set a local variable messageProcessed and then chane the if statement to logic\nif (messageProcessed) {\n// add comment\n}\nelse {\n}\n\nI think it would improve reasoning about the code, WDYT?\nFunctionally I am fine with the change", "url": "https://github.com/debezium/debezium/pull/1298#discussion_r386827144", "createdAt": "2020-03-03T06:52:00Z", "author": {"login": "jpechane"}, "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/PostgresStreamingChangeEventSource.java", "diffHunk": "@@ -119,21 +119,19 @@ public void execute(ChangeEventSourceContext context) throws InterruptedExceptio\n                 int noMessageIterations = 0;\n                 if (!stream.readPending(message -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NzkwNTUz", "url": "https://github.com/debezium/debezium/pull/1298#pullrequestreview-367790553", "createdAt": "2020-03-03T08:46:45Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35299d58d98edf648e9f26a683d588a64181d6dd", "author": {"user": {"login": "gunnarmorling", "name": "Gunnar Morling"}}, "url": "https://github.com/debezium/debezium/commit/35299d58d98edf648e9f26a683d588a64181d6dd", "committedDate": "2020-03-03T10:45:11Z", "message": "DBZ-1840 Not passing null to replication message processor;\n\nNote this means to that WAL offsets cannot be acknowledged in cases\nwhere a null message is received from the server (e.g. wal2json for\nDDL events). But as we cannot tell apart null events from the server\nfrom readPending() simply having no events to read, the current\nlogic renders the pausing between two read calls without events\nobsolete, so that's the lesser evil"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "35299d58d98edf648e9f26a683d588a64181d6dd", "author": {"user": {"login": "gunnarmorling", "name": "Gunnar Morling"}}, "url": "https://github.com/debezium/debezium/commit/35299d58d98edf648e9f26a683d588a64181d6dd", "committedDate": "2020-03-03T10:45:11Z", "message": "DBZ-1840 Not passing null to replication message processor;\n\nNote this means to that WAL offsets cannot be acknowledged in cases\nwhere a null message is received from the server (e.g. wal2json for\nDDL events). But as we cannot tell apart null events from the server\nfrom readPending() simply having no events to read, the current\nlogic renders the pausing between two read calls without events\nobsolete, so that's the lesser evil"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2090, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}