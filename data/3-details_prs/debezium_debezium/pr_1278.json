{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NzYxNjE2", "number": 1278, "title": "DBZ-1817 CI job definition for OpenShift tests", "bodyText": "Two job definitions and related pipelies.\nDownstream preparation job\n\nTakes our internal builds a pushes them to private org in Quay\nBuilds connect image on top of productised AMQ Streams and our productised artefacts and produces an image in Quay\n\nOpenShift test Pipeline\n\nAble to run openshift tests for upstream and downstream", "createdAt": "2020-02-20T13:41:17Z", "url": "https://github.com/debezium/debezium/pull/1278", "merged": true, "mergeCommit": {"oid": "fd8fa846eab215460139ba46c62494674ec3b51f"}, "closed": true, "closedAt": "2020-03-17T05:24:57Z", "author": {"login": "jcechace"}, "timelineItems": {"totalCount": 47, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGLZFdgBqjMwNTYxMzAxOTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOP070gBqjMxMzM3MjIwNTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMTY4NTcy", "url": "https://github.com/debezium/debezium/pull/1278#pullrequestreview-363168572", "createdAt": "2020-02-24T04:48:12Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODoxM1rOFtVpbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODoxM1rOFtVpbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4NDkxMQ==", "bodyText": "Should not be spaces eroud =?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r383084911", "createdAt": "2020-02-24T04:48:13Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "diffHunk": "@@ -0,0 +1,102 @@\n+pipeline {\n+    agent {\n+        label 'Slave'\n+    }\n+\n+    stages {\n+        stage('Checkout') {\n+            when {\n+                expression { !params.PRODUCT_BUILD }\n+            }\n+            steps {\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${DBZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${DBZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'debezium']],\n+                ])\n+\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${STRZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${STRZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'strimzi']],\n+                ])\n+            }\n+        }\n+\n+        stage('Configure') {\n+            steps {\n+                script {\n+                    env.OCP_PROJECT_DEBEZIUM=\"debezium-${BUILD_NUMBER}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMTY4NjYx", "url": "https://github.com/debezium/debezium/pull/1278#pullrequestreview-363168661", "createdAt": "2020-02-24T04:48:48Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODo0OFrOFtVpzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODo0OFrOFtVpzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4NTAwNA==", "bodyText": "Why is this in two different sh steps?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r383085004", "createdAt": "2020-02-24T04:48:48Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "diffHunk": "@@ -0,0 +1,102 @@\n+pipeline {\n+    agent {\n+        label 'Slave'\n+    }\n+\n+    stages {\n+        stage('Checkout') {\n+            when {\n+                expression { !params.PRODUCT_BUILD }\n+            }\n+            steps {\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${DBZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${DBZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'debezium']],\n+                ])\n+\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${STRZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${STRZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'strimzi']],\n+                ])\n+            }\n+        }\n+\n+        stage('Configure') {\n+            steps {\n+                script {\n+                    env.OCP_PROJECT_DEBEZIUM=\"debezium-${BUILD_NUMBER}\"\n+                    env.OCP_PROJECT_MYSQL=\"debezium-${BUILD_NUMBER}-mysql\"\n+                    env.OCP_PROJECT_POSTGRESQL=\"debezium-${BUILD_NUMBER}-postgresql\"\n+                }\n+                withCredentials([\n+                        usernamePassword(credentialsId: \"${OCP_CREDENTIALS}\", usernameVariable: 'OCP_USERNAME', passwordVariable: 'OCP_PASSWORD'),\n+                ]) {\n+                    sh '''\n+                    set -x            \n+                    oc login ${OCP_URL} -u \"${OCP_USERNAME}\" --password=\"${OCP_PASSWORD}\" --insecure-skip-tls-verify=true >/dev/null\n+                    oc new-project ${OCP_PROJECT_DEBEZIUM}\n+                    oc new-project ${OCP_PROJECT_MYSQL}\n+                    oc new-project ${OCP_PROJECT_POSTGRESQL}\n+                    '''\n+                    sh '''", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 47}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MjYyODA4", "url": "https://github.com/debezium/debezium/pull/1278#pullrequestreview-375262808", "createdAt": "2020-03-16T14:20:22Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDoyMDoyM1rOF22YgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDoyMDoyM1rOF22YgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA1ODQzMw==", "bodyText": "Could the job (https://github.com/debezium/debezium/blob/master/jenkins-jobs/sync-images.yaml) be updated to use this script and extended to provide all-tags copy like this script https://github.com/debezium/docker-images/blob/master/image-sync/sync.sh ?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393058433", "createdAt": "2020-03-16T14:20:23Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/scripts/copy-images.sh", "diffHunk": "@@ -0,0 +1,55 @@\n+#! /usr/bin/env bash", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MjgzODc3", "url": "https://github.com/debezium/debezium/pull/1278#pullrequestreview-375283877", "createdAt": "2020-03-16T14:42:59Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDo0Mjo1OVrOF23hww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDo0Mjo1OVrOF23hww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA3NzE4Nw==", "bodyText": "Does this file belong to this PR?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393077187", "createdAt": "2020-03-16T14:42:59Z", "author": {"login": "jpechane"}, "path": "debezium-testing/mysql_repl.yaml", "diffHunk": "@@ -0,0 +1,140 @@\n+apiVersion: v1", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3c9fcb8f0fbfe15187d624aca28b65ae51ae563", "author": {"user": {"login": "jcechace", "name": "Jakub Cechacek"}}, "url": "https://github.com/debezium/debezium/commit/a3c9fcb8f0fbfe15187d624aca28b65ae51ae563", "committedDate": "2020-03-16T15:27:15Z", "message": "DBZ-1817 Jenkins job definition and pipeline for openshift tests\n\nRefactored image properties"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "a3c9fcb8f0fbfe15187d624aca28b65ae51ae563", "author": {"user": {"login": "jcechace", "name": "Jakub Cechacek"}}, "url": "https://github.com/debezium/debezium/commit/a3c9fcb8f0fbfe15187d624aca28b65ae51ae563", "committedDate": "2020-03-16T15:27:15Z", "message": "DBZ-1817 Jenkins job definition and pipeline for openshift tests\n\nRefactored image properties"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2073, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}