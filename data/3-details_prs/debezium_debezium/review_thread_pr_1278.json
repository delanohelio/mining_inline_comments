{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NzYxNjE2", "number": 1278, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODoxM1rODiNghA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDo0Mjo1OVrODoXVZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MTk5NDkyOnYy", "diffSide": "RIGHT", "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODoxM1rOFtVpbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNTowOTowNlrOFtkBJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4NDkxMQ==", "bodyText": "Should not be spaces eroud =?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r383084911", "createdAt": "2020-02-24T04:48:13Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "diffHunk": "@@ -0,0 +1,102 @@\n+pipeline {\n+    agent {\n+        label 'Slave'\n+    }\n+\n+    stages {\n+        stage('Checkout') {\n+            when {\n+                expression { !params.PRODUCT_BUILD }\n+            }\n+            steps {\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${DBZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${DBZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'debezium']],\n+                ])\n+\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${STRZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${STRZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'strimzi']],\n+                ])\n+            }\n+        }\n+\n+        stage('Configure') {\n+            steps {\n+                script {\n+                    env.OCP_PROJECT_DEBEZIUM=\"debezium-${BUILD_NUMBER}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzMyMDM1OA==", "bodyText": "Doesn't matter but added :)", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r383320358", "createdAt": "2020-02-24T15:09:06Z", "author": {"login": "jcechace"}, "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "diffHunk": "@@ -0,0 +1,102 @@\n+pipeline {\n+    agent {\n+        label 'Slave'\n+    }\n+\n+    stages {\n+        stage('Checkout') {\n+            when {\n+                expression { !params.PRODUCT_BUILD }\n+            }\n+            steps {\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${DBZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${DBZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'debezium']],\n+                ])\n+\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${STRZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${STRZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'strimzi']],\n+                ])\n+            }\n+        }\n+\n+        stage('Configure') {\n+            steps {\n+                script {\n+                    env.OCP_PROJECT_DEBEZIUM=\"debezium-${BUILD_NUMBER}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4NDkxMQ=="}, "originalCommit": null, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MTk5NTYyOnYy", "diffSide": "RIGHT", "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwNDo0ODo0OFrOFtVpzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToxMDo0MFrOFtkEpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4NTAwNA==", "bodyText": "Why is this in two different sh steps?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r383085004", "createdAt": "2020-02-24T04:48:48Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "diffHunk": "@@ -0,0 +1,102 @@\n+pipeline {\n+    agent {\n+        label 'Slave'\n+    }\n+\n+    stages {\n+        stage('Checkout') {\n+            when {\n+                expression { !params.PRODUCT_BUILD }\n+            }\n+            steps {\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${DBZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${DBZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'debezium']],\n+                ])\n+\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${STRZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${STRZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'strimzi']],\n+                ])\n+            }\n+        }\n+\n+        stage('Configure') {\n+            steps {\n+                script {\n+                    env.OCP_PROJECT_DEBEZIUM=\"debezium-${BUILD_NUMBER}\"\n+                    env.OCP_PROJECT_MYSQL=\"debezium-${BUILD_NUMBER}-mysql\"\n+                    env.OCP_PROJECT_POSTGRESQL=\"debezium-${BUILD_NUMBER}-postgresql\"\n+                }\n+                withCredentials([\n+                        usernamePassword(credentialsId: \"${OCP_CREDENTIALS}\", usernameVariable: 'OCP_USERNAME', passwordVariable: 'OCP_PASSWORD'),\n+                ]) {\n+                    sh '''\n+                    set -x            \n+                    oc login ${OCP_URL} -u \"${OCP_USERNAME}\" --password=\"${OCP_PASSWORD}\" --insecure-skip-tls-verify=true >/dev/null\n+                    oc new-project ${OCP_PROJECT_DEBEZIUM}\n+                    oc new-project ${OCP_PROJECT_MYSQL}\n+                    oc new-project ${OCP_PROJECT_POSTGRESQL}\n+                    '''\n+                    sh '''", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzMyMTI1NQ==", "bodyText": "Just that these are two distinct operations so I used separate sh steps as a way to logically divide them.", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r383321255", "createdAt": "2020-02-24T15:10:40Z", "author": {"login": "jcechace"}, "path": "jenkins-jobs/pipelines/openshift_pipeline.groovy", "diffHunk": "@@ -0,0 +1,102 @@\n+pipeline {\n+    agent {\n+        label 'Slave'\n+    }\n+\n+    stages {\n+        stage('Checkout') {\n+            when {\n+                expression { !params.PRODUCT_BUILD }\n+            }\n+            steps {\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${DBZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${DBZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'debezium']],\n+                ])\n+\n+                checkout([\n+                        $class           : 'GitSCM',\n+                        branches         : [[name: \"${STRZ_GIT_BRANCH}\"]],\n+                        userRemoteConfigs: [[url: \"${STRZ_GIT_REPOSITORY}\"]],\n+                        extensions       : [[$class           : 'RelativeTargetDirectory',\n+                                             relativeTargetDir: 'strimzi']],\n+                ])\n+            }\n+        }\n+\n+        stage('Configure') {\n+            steps {\n+                script {\n+                    env.OCP_PROJECT_DEBEZIUM=\"debezium-${BUILD_NUMBER}\"\n+                    env.OCP_PROJECT_MYSQL=\"debezium-${BUILD_NUMBER}-mysql\"\n+                    env.OCP_PROJECT_POSTGRESQL=\"debezium-${BUILD_NUMBER}-postgresql\"\n+                }\n+                withCredentials([\n+                        usernamePassword(credentialsId: \"${OCP_CREDENTIALS}\", usernameVariable: 'OCP_USERNAME', passwordVariable: 'OCP_PASSWORD'),\n+                ]) {\n+                    sh '''\n+                    set -x            \n+                    oc login ${OCP_URL} -u \"${OCP_USERNAME}\" --password=\"${OCP_PASSWORD}\" --insecure-skip-tls-verify=true >/dev/null\n+                    oc new-project ${OCP_PROJECT_DEBEZIUM}\n+                    oc new-project ${OCP_PROJECT_MYSQL}\n+                    oc new-project ${OCP_PROJECT_POSTGRESQL}\n+                    '''\n+                    sh '''", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA4NTAwNA=="}, "originalCommit": null, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNjQwMzU0OnYy", "diffSide": "RIGHT", "path": "jenkins-jobs/scripts/copy-images.sh", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDoyMDoyM1rOF22YgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNTozMjozMlrOF25sDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA1ODQzMw==", "bodyText": "Could the job (https://github.com/debezium/debezium/blob/master/jenkins-jobs/sync-images.yaml) be updated to use this script and extended to provide all-tags copy like this script https://github.com/debezium/docker-images/blob/master/image-sync/sync.sh ?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393058433", "createdAt": "2020-03-16T14:20:23Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/scripts/copy-images.sh", "diffHunk": "@@ -0,0 +1,55 @@\n+#! /usr/bin/env bash", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzEwODE0NQ==", "bodyText": "I'm not quite sure I follow what you mean", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393108145", "createdAt": "2020-03-16T15:26:22Z", "author": {"login": "jcechace"}, "path": "jenkins-jobs/scripts/copy-images.sh", "diffHunk": "@@ -0,0 +1,55 @@\n+#! /usr/bin/env bash", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA1ODQzMw=="}, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzExMjU5MQ==", "bodyText": "Well, we have a job that syncs Docker Hub images to Quay.io - effectivelly doing more or less the same your script does. It is more adnnced in ability to copy all tags but otherwise much more limited.\nSo I was think about using your script to do the same task.", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393112591", "createdAt": "2020-03-16T15:32:32Z", "author": {"login": "jpechane"}, "path": "jenkins-jobs/scripts/copy-images.sh", "diffHunk": "@@ -0,0 +1,55 @@\n+#! /usr/bin/env bash", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA1ODQzMw=="}, "originalCommit": null, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNjUxOTQyOnYy", "diffSide": "RIGHT", "path": "debezium-testing/mysql_repl.yaml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDo0Mjo1OVrOF23hww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNToyNTowNlrOF25XCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA3NzE4Nw==", "bodyText": "Does this file belong to this PR?", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393077187", "createdAt": "2020-03-16T14:42:59Z", "author": {"login": "jpechane"}, "path": "debezium-testing/mysql_repl.yaml", "diffHunk": "@@ -0,0 +1,140 @@\n+apiVersion: v1", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzEwNzIwOQ==", "bodyText": "No it doesn't.... that's a rogue k8 descriptor :)", "url": "https://github.com/debezium/debezium/pull/1278#discussion_r393107209", "createdAt": "2020-03-16T15:25:06Z", "author": {"login": "jcechace"}, "path": "debezium-testing/mysql_repl.yaml", "diffHunk": "@@ -0,0 +1,140 @@\n+apiVersion: v1", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA3NzE4Nw=="}, "originalCommit": null, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4415, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}