{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MzI0NzUy", "number": 1654, "title": "DBZ-2275: Updated default database history DML filter default to handle additional RDS statements", "bodyText": "https://issues.redhat.com/browse/DBZ-2275\nAdded two more regular expressions to the default database history DML filter. These are intended to catch and filter out INSERT into mysql.rds_monitor... statements that RDS may write in the binlog.\nAlso added a new unit test that checks that the regular expressions do catch some example statements. This unit test loads the value for the internal.database.history.ddl.filter from a properties file, since setting the regular expressions via Java string literals requires escaping certain characters that can be error-prone.", "createdAt": "2020-06-24T16:43:51Z", "url": "https://github.com/debezium/debezium/pull/1654", "merged": true, "mergeCommit": {"oid": "5860812a6368f6e41d772a146e6426eb70ca2ac6"}, "closed": true, "closedAt": "2020-06-25T18:57:50Z", "author": {"login": "rhauch"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcucxFMgH2gAyNDM5MzI0NzUyOjc3Y2E2OGViNTk1YWQ0NjA1NzhhZDRlYmY4ZTc3YTdkN2U3NzBhMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuxhJSgH2gAyNDM5MzI0NzUyOjA4MDQ0ZWUzZWY0MTk1NjA2ZTM3ZGU5ZmZkMzNkMzAzY2NiZGEzNDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "77ca68eb595ad460578ad4ebf8e77a7d7e770a22", "author": {"user": {"login": "rhauch", "name": "Randall Hauch"}}, "url": "https://github.com/debezium/debezium/commit/77ca68eb595ad460578ad4ebf8e77a7d7e770a22", "committedDate": "2020-06-24T16:37:33Z", "message": "DBZ-2275: Updated default database history DML filter default to handle additional RDS statements\n\nAdded two more regular expressions to the default database history DML filter. These are intended to catch and filter out `INSERT into mysql.rds_monitor\u2026` statements that RDS may write in the binlog.\n\nAdded a new unit test that checks that the regular expressions do catch some example statements."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MjEwMzI1", "url": "https://github.com/debezium/debezium/pull/1654#pullrequestreview-437210325", "createdAt": "2020-06-25T06:47:00Z", "commit": {"oid": "77ca68eb595ad460578ad4ebf8e77a7d7e770a22"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwNjo0NzowMFrOGotdQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwNjo0NzowMFrOGotdQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM0MDk5NQ==", "bodyText": "Why is that you read an explicit value from the properties file? Wouldn't it make more sense to assert that the default value (as per your change below) excludes those tables?", "url": "https://github.com/debezium/debezium/pull/1654#discussion_r445340995", "createdAt": "2020-06-25T06:47:00Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/MySqlTaskContextTest.java", "diffHunk": "@@ -119,6 +120,20 @@ public void shouldCreateTaskFromConfigurationWithWhenNeededSnapshotMode() throws\n         assertThat(context.isSnapshotNeverAllowed()).isEqualTo(false);\n     }\n \n+    @Test\n+    public void shouldFilterInternalDmlStatements() throws Exception {\n+        // Load from a properties file to eliminate risk of improper escaping in Java literals\n+        Properties props = new Properties();\n+        props.load(Testing.Files.readResourceAsStream(\"dml-filter.properties\"));\n+        config = simpleConfig().with(MySqlConnectorConfig.SNAPSHOT_MODE, SnapshotMode.WHEN_NEEDED)\n+                .with(\"internal.database.history.ddl.filter\", props.get(\"internal.database.history.ddl.filter\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77ca68eb595ad460578ad4ebf8e77a7d7e770a22"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f82fb4b5a4582f464a12a1312c43fe4d213609f", "author": {"user": {"login": "rhauch", "name": "Randall Hauch"}}, "url": "https://github.com/debezium/debezium/commit/1f82fb4b5a4582f464a12a1312c43fe4d213609f", "committedDate": "2020-06-25T14:47:38Z", "message": "DBZ-2275: Simplified DML filter test to use default and added more conditions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08044ee3ef4195606e37de9ffd33d303ccbda345", "author": {"user": {"login": "rhauch", "name": "Randall Hauch"}}, "url": "https://github.com/debezium/debezium/commit/08044ee3ef4195606e37de9ffd33d303ccbda345", "committedDate": "2020-06-25T16:48:09Z", "message": "DBZ-2275: Remove unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2460, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}