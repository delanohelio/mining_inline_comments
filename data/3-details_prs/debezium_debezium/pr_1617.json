{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MDAzOTcy", "number": 1617, "title": "DBZ-2216 Fix transaction-id resolution with MongoDB 4.2", "bodyText": "https://issues.redhat.com/browse/DBZ-2216", "createdAt": "2020-06-17T17:48:29Z", "url": "https://github.com/debezium/debezium/pull/1617", "merged": true, "mergeCommit": {"oid": "56f911aedac4f6e057fc285d99a46dec60b11c21"}, "closed": true, "closedAt": "2020-06-18T16:20:53Z", "author": {"login": "Naros"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsNjwJAH2gAyNDM2MDAzOTcyOmQ2NzJkYmI1MDQ4ZDhkNjE0MGYxZTc4YzIyZDFkZjg4NzY4ZDEzZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsf_p0ABqjM0NTg2NDU3OTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d672dbb5048d8d6140f1e78c22d1df88768d13d6", "author": {"user": {"login": "Naros", "name": "Chris Cranford"}}, "url": "https://github.com/debezium/debezium/commit/d672dbb5048d8d6140f1e78c22d1df88768d13d6", "committedDate": "2020-06-17T17:46:34Z", "message": "DBZ-2216 Add MongoDB 4.2 to CI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4166e095567072dbe3758feaadd9e06ca518dbe6", "author": {"user": {"login": "Naros", "name": "Chris Cranford"}}, "url": "https://github.com/debezium/debezium/commit/4166e095567072dbe3758feaadd9e06ca518dbe6", "committedDate": "2020-06-17T17:47:45Z", "message": "DBZ-2216 Fix transaction-id resolution with MongoDB 4.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a2ea3ccf67cdf7f40a780adc197c06b08854933", "author": {"user": {"login": "Naros", "name": "Chris Cranford"}}, "url": "https://github.com/debezium/debezium/commit/0a2ea3ccf67cdf7f40a780adc197c06b08854933", "committedDate": "2020-06-17T19:19:00Z", "message": "DBZ-2216 Fix backward compatibility failure with V1 source block"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68480c5d870ed476bd21430015ce4b18c326befe", "author": {"user": {"login": "Naros", "name": "Chris Cranford"}}, "url": "https://github.com/debezium/debezium/commit/68480c5d870ed476bd21430015ce4b18c326befe", "committedDate": "2020-06-17T21:10:40Z", "message": "DBZ-2216 Fix transaction-id resolution logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41efc68a17e5f5affb24ed1ce08f1d67f2eb948b", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/41efc68a17e5f5affb24ed1ce08f1d67f2eb948b", "committedDate": "2020-06-18T04:27:42Z", "message": "DBZ-2216 Formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca8c8ef2f4f897b9f1fbf83d8277c4357523fa2f", "author": {"user": {"login": "gunnarmorling", "name": "Gunnar Morling"}}, "url": "https://github.com/debezium/debezium/commit/ca8c8ef2f4f897b9f1fbf83d8277c4357523fa2f", "committedDate": "2020-06-18T08:25:39Z", "message": "DBZ-2216 Reducing log level to stay below on max output threshold on CI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab", "author": {"user": {"login": "gunnarmorling", "name": "Gunnar Morling"}}, "url": "https://github.com/debezium/debezium/commit/7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab", "committedDate": "2020-06-18T09:00:05Z", "message": "DBZ-2216 Doc update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMDg3NTgy", "url": "https://github.com/debezium/debezium/pull/1617#pullrequestreview-433087582", "createdAt": "2020-06-18T09:07:44Z", "commit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOTowNzo0NFrOGlmhYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOTowNzo0NFrOGlmhYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MTYzNQ==", "bodyText": "Above (in getTransactionId()) the new field takes precedence. IIUC, the fields are mutually exclusive, but let's align on one way or the other consistently.\nUpdate: Pushed a commit for this.", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442081635", "createdAt": "2020-06-18T09:07:44Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "diffHunk": "@@ -402,6 +401,15 @@ protected MongoDbOffsetContext initializeOffsets(MongoDbConnectorConfig connecto\n         return new MongoDbOffsetContext(new SourceInfo(connectorConfig), new TransactionContext(), positions);\n     }\n \n+    private static String getTransactionId(Document event) {\n+        final Long operationId = event.getLong(SourceInfo.OPERATION_ID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMDg5NTEz", "url": "https://github.com/debezium/debezium/pull/1617#pullrequestreview-433089513", "createdAt": "2020-06-18T09:10:11Z", "commit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOToxMDoxMVrOGlmnYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOToxMDoxMVrOGlmnYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MzE2OA==", "bodyText": "Where is the \"session\" term coming from? Isn't this id unique on a global level?", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442083168", "createdAt": "2020-06-18T09:10:11Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoUtil.java", "diffHunk": "@@ -219,6 +220,21 @@ public static ServerAddress parseAddress(String addressStr) {\n         return null;\n     }\n \n+    /**\n+     * Helper function to extract the session transaction-id from an oplog event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f00e3b95ae86853dcc815fab78bbcecb849f785c", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/f00e3b95ae86853dcc815fab78bbcecb849f785c", "committedDate": "2020-06-18T15:15:11Z", "message": "DBZ-2216 Use real txId in docs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "f00e3b95ae86853dcc815fab78bbcecb849f785c", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/f00e3b95ae86853dcc815fab78bbcecb849f785c", "committedDate": "2020-06-18T15:15:11Z", "message": "DBZ-2216 Use real txId in docs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2610, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}