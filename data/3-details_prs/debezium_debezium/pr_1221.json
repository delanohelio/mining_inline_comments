{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1ODA4ODU4", "number": 1221, "title": "DBZ-1052 Transaction metadata", "bodyText": "https://issues.redhat.com/browse/DBZ-1052", "createdAt": "2020-01-22T11:41:30Z", "url": "https://github.com/debezium/debezium/pull/1221", "merged": true, "mergeCommit": {"oid": "34d297912356e24dc4742649269c3d913a48fa24"}, "closed": true, "closedAt": "2020-02-03T08:29:11Z", "author": {"login": "jpechane"}, "timelineItems": {"totalCount": 36, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb80a_oABqjI5Njk3NjE0Njk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcAmmnNgBqjMwMDA4NjEyOTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "1a38b5bb321791975eddbdf018b95b6b07d60240", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/1a38b5bb321791975eddbdf018b95b6b07d60240", "committedDate": "2020-01-22T12:19:10Z", "message": "DBZ-1052 Transaction metadata for SQL Server"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MzAzNTY3", "url": "https://github.com/debezium/debezium/pull/1221#pullrequestreview-349303567", "createdAt": "2020-01-28T11:28:48Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMToyODo0OFrOFihrYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMjoyNzoxNVrOFijKww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc0NzY4Mw==", "bodyText": "That's unused.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r371747683", "createdAt": "2020-01-28T11:28:48Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/TransactionMetadataIT.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright Debezium Authors.\n+ *\n+ * Licensed under the Apache Software License version 2.0, available at http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+package io.debezium.connector.postgresql;\n+\n+import java.sql.SQLException;\n+import java.util.List;\n+import java.util.concurrent.TimeUnit;\n+\n+import org.apache.kafka.connect.source.SourceRecord;\n+import org.fest.assertions.Assertions;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TestRule;\n+\n+import io.debezium.config.Configuration;\n+import io.debezium.connector.postgresql.PostgresConnectorConfig.SnapshotMode;\n+import io.debezium.connector.postgresql.junit.SkipTestDependingOnDecoderPluginNameRule;\n+import io.debezium.embedded.AbstractConnectorTest;\n+import io.debezium.util.Testing;\n+\n+public class TransactionMetadataIT extends AbstractConnectorTest {\n+\n+    private static final String INSERT_STMT = \"INSERT INTO s1.a (aa) VALUES (1);\" +\n+            \"INSERT INTO s2.a (aa) VALUES (1);\";\n+    private static final String SETUP_TABLES_STMT = \"DROP SCHEMA IF EXISTS s1 CASCADE;\" +\n+            \"DROP SCHEMA IF EXISTS s2 CASCADE;\" +\n+            \"CREATE SCHEMA s1; \" +\n+            \"CREATE SCHEMA s2; \" +\n+            \"CREATE TABLE s1.a (pk SERIAL, aa integer, PRIMARY KEY(pk));\" +\n+            \"CREATE TABLE s2.a (pk SERIAL, aa integer, bb varchar(20), PRIMARY KEY(pk));\" +\n+            INSERT_STMT;\n+    private PostgresConnector connector;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc2NTk3OA==", "bodyText": "As that's a user-facing topic -- unlike heartbeats -- I'd suggest to stick to the established naming pattern for topics and make it <logical name>.transactions, e.g. dbserver1.transactions.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r371765978", "createdAt": "2020-01-28T12:12:56Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-sqlserver/src/test/java/io/debezium/connector/sqlserver/SqlServerConnectorIT.java", "diffHunk": "@@ -379,6 +379,70 @@ public void update() throws Exception {\n         stopConnector();\n     }\n \n+    @Test\n+    public void transactionMetadata() throws Exception {\n+        final int RECORDS_PER_TABLE = 5;\n+        final int ID_START = 10;\n+        final Configuration config = TestHelper.defaultConfig()\n+                .with(SqlServerConnectorConfig.SNAPSHOT_MODE, SnapshotMode.INITIAL)\n+                .with(SqlServerConnectorConfig.PROVIDE_TRANSACTION_METADATA, true)\n+                .build();\n+\n+        start(SqlServerConnector.class, config);\n+        assertConnectorIsRunning();\n+\n+        Testing.Print.enable();\n+        // Wait for snapshot completion\n+        consumeRecordsByTopic(1);\n+\n+        connection.setAutoCommit(false);\n+        final String[] inserts = new String[RECORDS_PER_TABLE * 2];\n+        for (int i = 0; i < RECORDS_PER_TABLE; i++) {\n+            final int id = ID_START + i;\n+            inserts[2 * i] = \"INSERT INTO tablea VALUES(\" + id + \", 'a')\";\n+            inserts[2 * i + 1] = \"INSERT INTO tableb VALUES(\" + id + \", 'b')\";\n+        }\n+        connection.execute(inserts);\n+        connection.setAutoCommit(true);\n+\n+        connection.execute(\"INSERT INTO tableb VALUES(1000, 'b')\");\n+\n+        // BEGIN, data, END, BEGIN, data\n+        final SourceRecords records = consumeRecordsByTopic(1 + RECORDS_PER_TABLE * 2 + 1 + 1 + 1);\n+        final List<SourceRecord> tableA = records.recordsForTopic(\"server1.dbo.tablea\");\n+        final List<SourceRecord> tableB = records.recordsForTopic(\"server1.dbo.tableb\");\n+        final List<SourceRecord> tx = records.recordsForTopic(\"__debezium.transaction.server1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc3MTg0NQ==", "bodyText": "Have you tested this? I'd expect that the nested attributes will need proper handling, i.e. prefixing them with with some constant literal as they are all put into one flat namespace. That said I'm a bit dubious about the nested structure begin with. This ties into my question about the purpose of these attributes in change events themselves. I kinda thought we'd only need the TX id, in which case the question of nesting is a moot point.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r371771845", "createdAt": "2020-01-28T12:26:39Z", "author": {"login": "gunnarmorling"}, "path": "debezium-core/src/main/java/io/debezium/converters/CloudEventsConverter.java", "diffHunk": "@@ -431,6 +431,9 @@ else if (schema.type() == Type.INT8 || schema.type() == Type.INT16 || schema.typ\n         else if (schema.type() == Type.STRING || schema.type() == Type.INT64) {\n             ceExtensionSchema = SchemaBuilder.string();\n         }\n+        else if (schema.type() == Type.STRUCT) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc3MjA5OQ==", "bodyText": "Please add a comment, as it's a public contract and it'll be beneficial for us, too.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r371772099", "createdAt": "2020-01-28T12:27:15Z", "author": {"login": "gunnarmorling"}, "path": "debezium-core/src/main/java/io/debezium/pipeline/spi/OffsetContext.java", "diffHunk": "@@ -69,4 +70,6 @@\n      * Records the name of the collection and the timestamp of the last event\n      */\n     void event(DataCollectionId collectionId, Instant timestamp);\n+\n+    TransactionContext getTransactionContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNjMyNDgw", "url": "https://github.com/debezium/debezium/pull/1221#pullrequestreview-350632480", "createdAt": "2020-01-30T07:54:41Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwNzo1NDo0MlrOFjh90Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQwNzo1OToyNVrOFjiEXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgwMDk3Nw==", "bodyText": "This situation of COMMIT and next BEGIN sharing the same LSN sounds really weird. Is this something you actually observed, too, @jpechane ?", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r372800977", "createdAt": "2020-01-30T07:54:42Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/connection/pgoutput/PgOutputMessageDecoder.java", "diffHunk": "@@ -130,13 +131,6 @@ public boolean shouldMessageBeSkipped(ByteBuffer buffer, Long lastReceivedLsn, L\n                     // same session a `R` message was followed by an insert/update/delete message.\n                     // @formatter:on\n                 case COMMIT:\n-                    // For now skip these message types so that the LSN associated with the message won't\n-                    // be flushed back to PostgreSQL. There is a potential LSN assignment concern with\n-                    // ReplicationConnectionIT#testHowRelationMessagesAreReceived where the first COMMIT", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgwMTIwMA==", "bodyText": "Ooops. Good spot.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r372801200", "createdAt": "2020-01-30T07:55:15Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/PostgresConnectorIT.java", "diffHunk": "@@ -1369,11 +1369,13 @@ public void shouldConsumeEventsWithMaskedColumns() throws Exception {\n         stopConnector();\n     }\n \n+    @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgwMTkzMg==", "bodyText": "Good; that should help with other non-CDC events, too.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r372801932", "createdAt": "2020-01-30T07:57:25Z", "author": {"login": "gunnarmorling"}, "path": "debezium-core/src/main/java/io/debezium/converters/CloudEventsConverter.java", "diffHunk": "@@ -167,6 +170,10 @@ public void configure(Map<String, ?> configs, boolean isKey) {\n         if (schema == null || value == null) {\n             return null;\n         }\n+        if (!schema.name().endsWith(\".Envelope\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgwMjY1Mg==", "bodyText": "Can you also add (or update) the example event shown in the converter docs?", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r372802652", "createdAt": "2020-01-30T07:59:25Z", "author": {"login": "gunnarmorling"}, "path": "debezium-core/src/main/java/io/debezium/converters/CloudEventsConverter.java", "diffHunk": "@@ -68,6 +70,7 @@\n public class CloudEventsConverter implements Converter {\n \n     private static final String EXTENSION_NAME_PREFIX = \"iodebezium\";\n+    private static final String TX_ATTRIBUTE_PREFIX = \"tx\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "e53bf32c0e1cbae7503138a52073a6267fc68bc3", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/e53bf32c0e1cbae7503138a52073a6267fc68bc3", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Transaction metadata for SQL Server"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35a26452bc11df57015387f3e5a76595f18bab31", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/35a26452bc11df57015387f3e5a76595f18bab31", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Transaction metadata for Postgres/pgoutput"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21148195b05f2bdcc2f1b11a7c44e09ae1a45890", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/21148195b05f2bdcc2f1b11a7c44e09ae1a45890", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Transaction metadata for Postgres/wal2json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6935db3a0a0a41124f7a3636a2304318a0d26f7", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/a6935db3a0a0a41124f7a3636a2304318a0d26f7", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Test for limited Postgres/protobuf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b281619a0b9f69436370e7175ba5320c31c5ecb", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/4b281619a0b9f69436370e7175ba5320c31c5ecb", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Skip CE for transaction struct"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f90beea0de3bda14ac8c1a1f91e9c765d593c43f", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/f90beea0de3bda14ac8c1a1f91e9c765d593c43f", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Fix test for offset size"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ccc5281fd74b5c7d96a1befc1fcade76e49d618", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/2ccc5281fd74b5c7d96a1befc1fcade76e49d618", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Support for full Postgres/protobuf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "799dfb2cf00401ec7b0c6b5712ca5d5207211f73", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/799dfb2cf00401ec7b0c6b5712ca5d5207211f73", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Remove unused fields; added JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e85f723117f768a45e97d0e58747d2086fc0880", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/7e85f723117f768a45e97d0e58747d2086fc0880", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Change TX topic name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be098b746591fff70112df45b0b7d568508c331b", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/be098b746591fff70112df45b0b7d568508c331b", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Remove suprfluous test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "585cf3eaecd466d9254998a53ad86b83d6691baa", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/585cf3eaecd466d9254998a53ad86b83d6691baa", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Transaction block moved to envelope"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "264f7a6e585eef1f9a46ea93e89a9b33dec3e8d5", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/264f7a6e585eef1f9a46ea93e89a9b33dec3e8d5", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Add counts per table to END"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac702618b8b2e44f72e2ddcde72a946ed8a8e14e", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/ac702618b8b2e44f72e2ddcde72a946ed8a8e14e", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 CE support for tx metadata in data messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d845dd9febae9ce0bccc4d3bf785073ec9b5c49", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/1d845dd9febae9ce0bccc4d3bf785073ec9b5c49", "committedDate": "2020-01-30T14:04:22Z", "message": "DBZ-1052 Add tx enable option to connector definitions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMDI5OTc4", "url": "https://github.com/debezium/debezium/pull/1221#pullrequestreview-351029978", "createdAt": "2020-01-30T18:04:42Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxODowNDo0MlrOFj0mEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxODowNDo0MlrOFj0mEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzEwNjE5NA==", "bodyText": "There is iodebeziumtxId already (see above). That's really what I'm a bit concerned about -- the redundancy of this new info. I don't have a good answer right now. Maybe we should deprecate and eventually remove the current txId attribute in the source block?", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r373106194", "createdAt": "2020-01-30T18:04:42Z", "author": {"login": "gunnarmorling"}, "path": "documentation/modules/ROOT/pages/integrations/cloudevents.adoc", "diffHunk": "@@ -97,6 +101,9 @@ Alternatively, Avro can be used as content type for the `data` attribute:\n   \"iodebeziumtxId\" : \"578\",\n   \"iodebeziumlsn\" : \"33227720\",\n   \"iodebeziumxmin\" : null,\n+  \"iodebeziumtxid\": \"589\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 26}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ab3f7b0bad35d0def908f5d48ffc67f7b5eab55", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/1ab3f7b0bad35d0def908f5d48ffc67f7b5eab55", "committedDate": "2020-01-31T04:59:28Z", "message": "DBZ-1052 Docs for CE and postgres"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "1ab3f7b0bad35d0def908f5d48ffc67f7b5eab55", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/1ab3f7b0bad35d0def908f5d48ffc67f7b5eab55", "committedDate": "2020-01-31T04:59:28Z", "message": "DBZ-1052 Docs for CE and postgres"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/2f41544b8777e819091e17c4d2b132bba9b746e3", "committedDate": "2020-01-31T08:31:46Z", "message": "DBZ-1052 Expand known protobuf messages list"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/2f41544b8777e819091e17c4d2b132bba9b746e3", "committedDate": "2020-01-31T08:31:46Z", "message": "DBZ-1052 Expand known protobuf messages list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDYyNDE2", "url": "https://github.com/debezium/debezium/pull/1221#pullrequestreview-351462416", "createdAt": "2020-01-31T12:05:03Z", "commit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMjowNTowM1rOFkJdJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMjowNTowM1rOFkJdJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ0Nzk3NQ==", "bodyText": "Isn't the early return a problem as we'd miss the update of lastCompletelyProcessedLsn below?", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r373447975", "createdAt": "2020-01-31T12:05:03Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/PostgresStreamingChangeEventSource.java", "diffHunk": "@@ -126,15 +128,33 @@ public void execute(ChangeEventSourceContext context) throws InterruptedExceptio\n                         dispatcher.dispatchHeartbeatEvent(offsetContext);\n                         return;\n                     }\n+                    if (TransactionMessage.isTransactionalMessage(message) && !connectorConfig.shouldProvideTransactionMetadata()) {\n+                        LOGGER.trace(\"Received transactional message {}\", message);\n+                        return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDY0NTY3", "url": "https://github.com/debezium/debezium/pull/1221#pullrequestreview-351464567", "createdAt": "2020-01-31T12:09:52Z", "commit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMjowOTo1MlrOFkJjtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQxMjowOTo1MlrOFkJjtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ0OTY1Mw==", "bodyText": "Ok, so I'm still not happy about this; but no blocker for now. I've added it to DBZ-1701 to get rid of iodebeziumtxId if iodebeziumtxid is present.", "url": "https://github.com/debezium/debezium/pull/1221#discussion_r373449653", "createdAt": "2020-01-31T12:09:52Z", "author": {"login": "gunnarmorling"}, "path": "documentation/modules/ROOT/pages/integrations/cloudevents.adoc", "diffHunk": "@@ -97,6 +101,9 @@ Alternatively, Avro can be used as content type for the `data` attribute:\n   \"iodebeziumtxId\" : \"578\",\n   \"iodebeziumlsn\" : \"33227720\",\n   \"iodebeziumxmin\" : null,\n+  \"iodebeziumtxid\": \"578\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "662195b4690e15e729851d28504b767154db4379", "author": {"user": {"login": "gunnarmorling", "name": "Gunnar Morling"}}, "url": "https://github.com/debezium/debezium/commit/662195b4690e15e729851d28504b767154db4379", "committedDate": "2020-01-31T12:12:24Z", "message": "DBZ-1052 Misc. clean-up\n\n* Doc updates\n* Changed static method to instance"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNDY3MjYx", "url": "https://github.com/debezium/debezium/pull/1221#pullrequestreview-351467261", "createdAt": "2020-01-31T12:15:31Z", "commit": {"oid": "2f41544b8777e819091e17c4d2b132bba9b746e3"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b16e612f47873eb0aa15e558a0c5074a21c6e84d", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/b16e612f47873eb0aa15e558a0c5074a21c6e84d", "committedDate": "2020-01-31T13:05:56Z", "message": "DBZ-1052 Docs for Oracle and SQL Server"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9641575d0669336be686e4f452f0caaad4b0ed7f", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/9641575d0669336be686e4f452f0caaad4b0ed7f", "committedDate": "2020-01-31T13:07:13Z", "message": "DBZ-1052 Flush LSN for skipped tx messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e41122237e706a282911f8ef3b52558a49b6472", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/6e41122237e706a282911f8ef3b52558a49b6472", "committedDate": "2020-02-03T06:04:27Z", "message": "DBZ-1052 Stabilize test for changed heartbeats"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "6e41122237e706a282911f8ef3b52558a49b6472", "author": {"user": {"login": "jpechane", "name": "Jiri Pechanec"}}, "url": "https://github.com/debezium/debezium/commit/6e41122237e706a282911f8ef3b52558a49b6472", "committedDate": "2020-02-03T06:04:27Z", "message": "DBZ-1052 Stabilize test for changed heartbeats"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2204, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}