{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4OTYzNjgx", "number": 1701, "title": "DBZ-2318 add column check constraints and JSON validation check constraints to debezium-ddl-parser ANTLR v4 MySQL grammar", "bodyText": "fixes https://issues.redhat.com/browse/DBZ-2318", "createdAt": "2020-07-14T15:45:59Z", "url": "https://github.com/debezium/debezium/pull/1701", "merged": true, "mergeCommit": {"oid": "24adef37cc852d6bd9385ab56a262d5232178c39"}, "closed": true, "closedAt": "2020-07-16T04:55:27Z", "author": {"login": "rk3rn3r"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc03_OhgH2gAyNDQ4OTYzNjgxOjg5OWEwOTkzYzRiNWZlMjdkODQ1NDVmM2VhYzc5NzVhZWRjNWZhZTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1H-_CAFqTQ0ODgyMjUzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6", "author": {"user": {"login": "rk3rn3r", "name": "Ren\u00e9 Kerner"}}, "url": "https://github.com/debezium/debezium/commit/899a0993c4b5fe27d84545f3eac7975aedc5fae6", "committedDate": "2020-07-14T15:43:59Z", "message": "DBZ-2318 add column check constraints and JSON validation check constraints to debezium-ddl-parser ANTLR v4 MySQL grammar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NzEwMDUw", "url": "https://github.com/debezium/debezium/pull/1701#pullrequestreview-448710050", "createdAt": "2020-07-15T07:49:30Z", "commit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNzo0OTozMFrOGxyZxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNzo0OTozMFrOGxyZxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg1OTIwNQ==", "bodyText": "If there's something MariaDB-specific, could you please mark it with a comment (there's some examples where we already do this).", "url": "https://github.com/debezium/debezium/pull/1701#discussion_r454859205", "createdAt": "2020-07-15T07:49:30Z", "author": {"login": "gunnarmorling"}, "path": "debezium-ddl-parser/src/main/antlr4/io/debezium/ddl/parser/mysql/generated/MySqlParser.g4", "diffHunk": "@@ -2574,5 +2576,5 @@ functionNameBase\n     | VALIDATE_PASSWORD_STRENGTH | VERSION | VISIBLE\n     | WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS | WEEK | WEEKDAY\n     | WEEKOFYEAR | WEIGHT_STRING | WITHIN | YEAR | YEARWEEK\n-    | Y_FUNCTION | X_FUNCTION\n+    | Y_FUNCTION | X_FUNCTION | JSON_VALID | JSON_SCHEMA_VALID", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4ODIyMzQ2", "url": "https://github.com/debezium/debezium/pull/1701#pullrequestreview-448822346", "createdAt": "2020-07-15T10:21:55Z", "commit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDoyMTo1NVrOGx31YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDoyMTo1NVrOGx31YQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk0ODE5Mw==", "bodyText": "here is one of the comment you were looking for. I think they best fit here. WDYT @gunnarmorling ?", "url": "https://github.com/debezium/debezium/pull/1701#discussion_r454948193", "createdAt": "2020-07-15T10:21:55Z", "author": {"login": "rk3rn3r"}, "path": "debezium-ddl-parser/src/test/resources/mysql/examples/ddl_create.sql", "diffHunk": "@@ -184,3 +184,32 @@ BEGIN\n     RETURN result;\n END;\n #end\n+#begin\n+-- From MariaDB 10.4.3, the JSON_VALID function is automatically used as a CHECK constraint for the JSON data type alias in order to ensure that a valid json document is inserted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4ODIyNTM5", "url": "https://github.com/debezium/debezium/pull/1701#pullrequestreview-448822539", "createdAt": "2020-07-15T10:22:12Z", "commit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDoyMjoxMlrOGx318A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDoyMjoxMlrOGx318A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk0ODMzNg==", "bodyText": "and the other one @gunnarmorling.", "url": "https://github.com/debezium/debezium/pull/1701#discussion_r454948336", "createdAt": "2020-07-15T10:22:12Z", "author": {"login": "rk3rn3r"}, "path": "debezium-ddl-parser/src/test/resources/mysql/examples/ddl_create.sql", "diffHunk": "@@ -184,3 +184,32 @@ BEGIN\n     RETURN result;\n END;\n #end\n+#begin\n+-- From MariaDB 10.4.3, the JSON_VALID function is automatically used as a CHECK constraint for the JSON data type alias in order to ensure that a valid json document is inserted.\n+-- src: https://mariadb.com/kb/en/json_valid/\n+CREATE TABLE `global_priv` (\n+    `Host` CHAR(60) COLLATE utf8_bin NOT NULL DEFAULT '',\n+    `User` CHAR(80) COLLATE utf8_bin NOT NULL DEFAULT '',\n+    `Privilege` LONGTEXT CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL DEFAULT '{}' CHECK (json_valid(`Privilege`)),\n+    PRIMARY KEY (`Host`,`User`)\n+) ENGINE=Aria DEFAULT CHARSET=utf8 COLLATE=utf8_bin PAGE_CHECKSUM=1 TRANSACTIONAL=1 COMMENT='Users and global privileges';\n+#end\n+#begin\n+-- https://dev.mysql.com/doc/refman/8.0/en/json-validation-functions.html#json-validation-functions-constraints", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "899a0993c4b5fe27d84545f3eac7975aedc5fae6"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2496, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}