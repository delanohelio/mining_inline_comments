{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MDAzOTcy", "number": 1617, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOTowNzo0NFrOEGqnLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOToxMDoxMVrOEGqrEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NDI1MDcwOnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOTowNzo0NFrOGlmhYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNDoxNDoxNlrOGlxVDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MTYzNQ==", "bodyText": "Above (in getTransactionId()) the new field takes precedence. IIUC, the fields are mutually exclusive, but let's align on one way or the other consistently.\nUpdate: Pushed a commit for this.", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442081635", "createdAt": "2020-06-18T09:07:44Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "diffHunk": "@@ -402,6 +401,15 @@ protected MongoDbOffsetContext initializeOffsets(MongoDbConnectorConfig connecto\n         return new MongoDbOffsetContext(new SourceInfo(connectorConfig), new TransactionContext(), positions);\n     }\n \n+    private static String getTransactionId(Document event) {\n+        final Long operationId = event.getLong(SourceInfo.OPERATION_ID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MjcwOA==", "bodyText": "Btw. how does txNumber relate/compare to ord? It seems like it's kinda the same?", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442082708", "createdAt": "2020-06-18T09:09:24Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "diffHunk": "@@ -402,6 +401,15 @@ protected MongoDbOffsetContext initializeOffsets(MongoDbConnectorConfig connecto\n         return new MongoDbOffsetContext(new SourceInfo(connectorConfig), new TransactionContext(), positions);\n     }\n \n+    private static String getTransactionId(Document event) {\n+        final Long operationId = event.getLong(SourceInfo.OPERATION_ID);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MTYzNQ=="}, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI0MzM2OQ==", "bodyText": "I would say that txnNumber more closely related to tord rather than ord because the former represents the position within a transaction in which the entry took place.", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442243369", "createdAt": "2020-06-18T13:53:36Z", "author": {"login": "Naros"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "diffHunk": "@@ -402,6 +401,15 @@ protected MongoDbOffsetContext initializeOffsets(MongoDbConnectorConfig connecto\n         return new MongoDbOffsetContext(new SourceInfo(connectorConfig), new TransactionContext(), positions);\n     }\n \n+    private static String getTransactionId(Document event) {\n+        final Long operationId = event.getLong(SourceInfo.OPERATION_ID);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MTYzNQ=="}, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI1ODcwMA==", "bodyText": "@Naros, so what's the difference between ord and tord then? I didn't even know there'd be those two :)", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442258700", "createdAt": "2020-06-18T14:14:16Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "diffHunk": "@@ -402,6 +401,15 @@ protected MongoDbOffsetContext initializeOffsets(MongoDbConnectorConfig connecto\n         return new MongoDbOffsetContext(new SourceInfo(connectorConfig), new TransactionContext(), positions);\n     }\n \n+    private static String getTransactionId(Document event) {\n+        final Long operationId = event.getLong(SourceInfo.OPERATION_ID);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MTYzNQ=="}, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NDI2MDY3OnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoUtil.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOToxMDoxMVrOGlmnYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNDoxNTozMlrOGlxYwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MzE2OA==", "bodyText": "Where is the \"session\" term coming from? Isn't this id unique on a global level?", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442083168", "createdAt": "2020-06-18T09:10:11Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoUtil.java", "diffHunk": "@@ -219,6 +220,21 @@ public static ServerAddress parseAddress(String addressStr) {\n         return null;\n     }\n \n+    /**\n+     * Helper function to extract the session transaction-id from an oplog event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI0ODQxMg==", "bodyText": "The \"session\" term is what Mongo uses to refer to lsid, aka Logical Session ID.\nThis value is the same across all transactions and operations.  This is why the combination of both the lsid and the txnNumber are important because the txnNumber field merely starts at 1 and increments for every operation/transaction that happens.\nIf the client disconnects & re-connects, it gets a new lsid and txnNumber will start from 1 again and continue to increase per transaction scoped operation.", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442248412", "createdAt": "2020-06-18T13:59:59Z", "author": {"login": "Naros"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoUtil.java", "diffHunk": "@@ -219,6 +220,21 @@ public static ServerAddress parseAddress(String addressStr) {\n         return null;\n     }\n \n+    /**\n+     * Helper function to extract the session transaction-id from an oplog event.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MzE2OA=="}, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI1OTY0OA==", "bodyText": "What/who is the \"client\" in this context? It's not Debezium, right? I.e. if we crash and don't commit offsets and re-read specific log sections a second time, we'd see the same lsid and txnNumber as before, correct?", "url": "https://github.com/debezium/debezium/pull/1617#discussion_r442259648", "createdAt": "2020-06-18T14:15:32Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoUtil.java", "diffHunk": "@@ -219,6 +220,21 @@ public static ServerAddress parseAddress(String addressStr) {\n         return null;\n     }\n \n+    /**\n+     * Helper function to extract the session transaction-id from an oplog event.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MzE2OA=="}, "originalCommit": {"oid": "7afefa6fe6ba37cc7f5841bc535b24a1bb2916ab"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4298, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}