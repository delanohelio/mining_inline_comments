{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MTgwMjc3", "number": 1383, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTozMzo1OVrODui40Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNzowMDoyOFrODvbGTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMTMyNjg5OnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTozMzo1OVrOGAlgig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNjo1NDo1OFrOGB1XLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2NzcyMg==", "bodyText": "Thinking about it, I suppose this will impact the matrix job for Kafka versions on CI? Might need to have two flavours of this test which are enabled based on the tested Kafka version. WDYT?", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r403267722", "createdAt": "2020-04-03T19:33:59Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "diffHunk": "@@ -230,7 +230,9 @@ public void shouldFailWhenTheSchemaLooksValidButDoesNotHaveTheCorrectFields() {\n                 valueSchema,\n                 value);\n \n-        exceptionRule.expect(NullPointerException.class);\n+        // Prior to AK 2.4.1, this threw a NullPointerException\n+        // As of AK 2.4.1, this now causes an IllegalArgumentException\n+        exceptionRule.expect(IllegalArgumentException.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "17864e8f9b50e0df8860f6bfb3214663f2381980"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA3NDc5Mw==", "bodyText": "I agree, but I took a slightly different approach and added a Testing.Kafka interface that allows us to test the major/minor/patch version in code and branch accordingly.  If we find we need more of this moving forward we can look into formalizing this into an annotation or something at that point.", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r404074793", "createdAt": "2020-04-06T13:06:36Z", "author": {"login": "Naros"}, "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "diffHunk": "@@ -230,7 +230,9 @@ public void shouldFailWhenTheSchemaLooksValidButDoesNotHaveTheCorrectFields() {\n                 valueSchema,\n                 value);\n \n-        exceptionRule.expect(NullPointerException.class);\n+        // Prior to AK 2.4.1, this threw a NullPointerException\n+        // As of AK 2.4.1, this now causes an IllegalArgumentException\n+        exceptionRule.expect(IllegalArgumentException.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2NzcyMg=="}, "originalCommit": {"oid": "17864e8f9b50e0df8860f6bfb3214663f2381980"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI4NDYzNg==", "bodyText": "After discussion with @jpechane we felt it was better to use annotations instead so I added the SkipWhenKafkaVersion annotation and its supporting files so we can use this in other spots going forward in tests.", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r404284636", "createdAt": "2020-04-06T18:00:55Z", "author": {"login": "Naros"}, "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "diffHunk": "@@ -230,7 +230,9 @@ public void shouldFailWhenTheSchemaLooksValidButDoesNotHaveTheCorrectFields() {\n                 valueSchema,\n                 value);\n \n-        exceptionRule.expect(NullPointerException.class);\n+        // Prior to AK 2.4.1, this threw a NullPointerException\n+        // As of AK 2.4.1, this now causes an IllegalArgumentException\n+        exceptionRule.expect(IllegalArgumentException.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2NzcyMg=="}, "originalCommit": {"oid": "17864e8f9b50e0df8860f6bfb3214663f2381980"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU3NjA0Nw==", "bodyText": "Nice!", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r404576047", "createdAt": "2020-04-07T06:54:58Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "diffHunk": "@@ -230,7 +230,9 @@ public void shouldFailWhenTheSchemaLooksValidButDoesNotHaveTheCorrectFields() {\n                 valueSchema,\n                 value);\n \n-        exceptionRule.expect(NullPointerException.class);\n+        // Prior to AK 2.4.1, this threw a NullPointerException\n+        // As of AK 2.4.1, this now causes an IllegalArgumentException\n+        exceptionRule.expect(IllegalArgumentException.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2NzcyMg=="}, "originalCommit": {"oid": "17864e8f9b50e0df8860f6bfb3214663f2381980"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDUyNDA2OnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNjo1NjozMlrOGB1Z3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNjo1NjozMlrOGB1Z3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU3NjczMg==", "bodyText": "LOL, feeling kinda guilty now about having done this change upstream, seeing the cost here ;)", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r404576732", "createdAt": "2020-04-07T06:56:32Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/transforms/ExtractNewDocumentStateTest.java", "diffHunk": "@@ -237,4 +247,39 @@ public void shouldFailWhenTheSchemaLooksValidButDoesNotHaveTheCorrectFields() {\n \n         assertThat(transformed).isNull();\n     }\n+\n+    @Test\n+    @FixFor(\"DBZ-1430\")\n+    @SkipWhenKafkaVersion(check = LESS_THAN, value = KAFKA_241, description = \"Kafka throws NullPointerException prior to 2.4.1\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3be41a87299a6aa318f2413c2c6bfafa1bb8c57c"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDUzNjQ2OnYy", "diffSide": "LEFT", "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/OutboxEventRouterIT.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNzowMDoyOFrOGB1hQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMzowODoxOFrOGCCq8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU3ODYyNA==", "bodyText": "That's interesting. It looks like we should exclue this (transitive) dependency, as we effectively have Jackson twice on the (test) classpath. Logged as https://issues.redhat.com/browse/DBZ-1943; could you take a look? Thanks!", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r404578624", "createdAt": "2020-04-07T07:00:28Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/OutboxEventRouterIT.java", "diffHunk": "@@ -23,12 +23,13 @@\n import org.apache.kafka.connect.header.Header;\n import org.apache.kafka.connect.header.Headers;\n import org.apache.kafka.connect.source.SourceRecord;\n-import org.codehaus.jackson.JsonNode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3be41a87299a6aa318f2413c2c6bfafa1bb8c57c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc5NDA5OQ==", "bodyText": "Ah; good catch.  Will do.", "url": "https://github.com/debezium/debezium/pull/1383#discussion_r404794099", "createdAt": "2020-04-07T13:08:18Z", "author": {"login": "Naros"}, "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/OutboxEventRouterIT.java", "diffHunk": "@@ -23,12 +23,13 @@\n import org.apache.kafka.connect.header.Header;\n import org.apache.kafka.connect.header.Headers;\n import org.apache.kafka.connect.source.SourceRecord;\n-import org.codehaus.jackson.JsonNode;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU3ODYyNA=="}, "originalCommit": {"oid": "3be41a87299a6aa318f2413c2c6bfafa1bb8c57c"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4361, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}