{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5MTIyNzgz", "number": 1725, "title": "DBZ-2383 OpenShift tests for DB2 connector", "bodyText": "DB2 connector tests with OpenShift.", "createdAt": "2020-07-30T12:16:27Z", "url": "https://github.com/debezium/debezium/pull/1725", "merged": true, "mergeCommit": {"oid": "d5b3684c7ed5b4455c819685e87d4ac2f481850d"}, "closed": true, "closedAt": "2020-09-23T19:01:32Z", "author": {"login": "jcechace"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5-zlAgFqTQ1ODM1Mjc0NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLv17vgBqjM3OTkyMDQxNjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MzUyNzQ1", "url": "https://github.com/debezium/debezium/pull/1725#pullrequestreview-458352745", "createdAt": "2020-07-30T12:30:13Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMjozMDoxM1rOG5g5cA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMjozMDoxM1rOG5g5cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk2MTAwOA==", "bodyText": "Hey @SeanRooooney, we could need some helps on Db2 :) Specifically,@jcechace here is looking for a way to ensure the database has started (as a container) in integration tests before running any test. I.e. some readiness probe of sort. We do specific selects e.g. for Postgres in order to achieve that, and are looking for any Db2 equivalent. Thanks for any advise.", "url": "https://github.com/debezium/debezium/pull/1725#discussion_r462961008", "createdAt": "2020-07-30T12:30:13Z", "author": {"login": "gunnarmorling"}, "path": "debezium-testing/debezium-testing-openshift/src/main/java/io/debezium/testing/openshift/tools/databases/db2/DB2Controller.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Copyright Debezium Authors.\n+ *\n+ * Licensed under the Apache Software License version 2.0, available at http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package io.debezium.testing.openshift.tools.databases.db2;\n+\n+import io.debezium.testing.openshift.tools.ConfigProperties;\n+import io.debezium.testing.openshift.tools.WaitConditions;\n+import io.debezium.testing.openshift.tools.databases.DatabaseInitListener;\n+import io.debezium.testing.openshift.tools.databases.SqlDatabaseClient;\n+import io.debezium.testing.openshift.tools.databases.SqlDatabaseController;\n+import io.fabric8.kubernetes.api.model.Pod;\n+import io.fabric8.kubernetes.api.model.Service;\n+import io.fabric8.kubernetes.api.model.apps.Deployment;\n+import io.fabric8.kubernetes.client.dsl.ExecWatch;\n+import io.fabric8.openshift.client.OpenShiftClient;\n+import org.awaitility.Awaitility;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.net.URISyntaxException;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.sql.Connection;\n+import java.sql.DriverManager;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.sql.Statement;\n+import java.util.List;\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+import static io.debezium.testing.openshift.tools.ConfigProperties.DATABASE_DB2_DBZ_DBNAME;\n+import static io.debezium.testing.openshift.tools.ConfigProperties.DATABASE_DB2_DBZ_PASSWORD;\n+import static io.debezium.testing.openshift.tools.ConfigProperties.DATABASE_DB2_DBZ_USERNAME;\n+import static io.debezium.testing.openshift.tools.ConfigProperties.DATABASE_POSTGRESQL_DBZ_DBNAME;\n+import static org.awaitility.Awaitility.await;\n+\n+/**\n+ *\n+ * @author Jakub Cechacek\n+ */\n+public class DB2Controller extends SqlDatabaseController {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(DB2Controller.class);\n+    private static final String READINESS_SQL_SELECT = \"SELECT 1 FROM DB2INST1.CUSTOMERS;\";\n+\n+    public DB2Controller(Deployment deployment, List<Service> services, String dbType, OpenShiftClient ocp) {\n+        super(deployment, services, dbType, ocp);\n+    }\n+\n+\n+    public void initialize() {\n+        LOGGER.info(\"Waiting until DB2 instance is ready\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 55}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "db2ec4e993f183e8f4ea3bea2d7389aef3e4bac1", "author": {"user": {"login": "jcechace", "name": "Jakub Cechacek"}}, "url": "https://github.com/debezium/debezium/commit/db2ec4e993f183e8f4ea3bea2d7389aef3e4bac1", "committedDate": "2020-09-23T17:14:31Z", "message": "DBZ-2383 OpenShift tests for DB2 connector"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "db2ec4e993f183e8f4ea3bea2d7389aef3e4bac1", "author": {"user": {"login": "jcechace", "name": "Jakub Cechacek"}}, "url": "https://github.com/debezium/debezium/commit/db2ec4e993f183e8f4ea3bea2d7389aef3e4bac1", "committedDate": "2020-09-23T17:14:31Z", "message": "DBZ-2383 OpenShift tests for DB2 connector"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2539, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}