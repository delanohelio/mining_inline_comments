{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5ODc4MTc5", "number": 1348, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo1MTowM1rODox67Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QyMDo1ODoyM1rODo4sDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MDg3NTMzOnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbEventMetadataProvider.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo1MTowM1rOF3iiEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo1MTowM1rOF3iiEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4MTc3Nw==", "bodyText": "This looks a bit suspicious; shouldn't at least the var name (txOrder) be adjusted, too?", "url": "https://github.com/debezium/debezium/pull/1348#discussion_r393781777", "createdAt": "2020-03-17T15:51:03Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbEventMetadataProvider.java", "diffHunk": "@@ -59,7 +59,7 @@ public String getTransactionId(DataCollectionId source, OffsetContext offset, Ob\n         if (source == null) {\n             return null;\n         }\n-        final Long txOrder = sourceInfo.getInt64(SourceInfo.TX_ORD);\n+        final Long txOrder = sourceInfo.getInt64(SourceInfo.OPERATION_ID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bad0852b531153d86ad1ed905e320edd3b896cc4"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MTE0MDM5OnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNjo1MzoxMVrOF3lPSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNjo1MzoxMVrOF3lPSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgyNjEyMg==", "bodyText": "Maybe extract \"h\" into a constant, to give it some meaning?", "url": "https://github.com/debezium/debezium/pull/1348#discussion_r393826122", "createdAt": "2020-03-17T16:53:11Z", "author": {"login": "gunnarmorling"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbStreamingChangeEventSource.java", "diffHunk": "@@ -300,7 +300,7 @@ private boolean handleOplogEvent(ServerAddress primaryAddress, Document event, D\n                 return true;\n             }\n             try {\n-                dispatcher.dispatchTransactionStartedEvent(Long.toString(txOrder), oplogContext.getOffset());\n+                dispatcher.dispatchTransactionStartedEvent(Long.toString(event.getLong(\"h\")), oplogContext.getOffset());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bad0852b531153d86ad1ed905e320edd3b896cc4"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MTk4NDEzOnYy", "diffSide": "RIGHT", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbEventMetadataProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QyMDo1ODoyM1rOF3tzYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNDo0NjoxOVrOF4IXtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzk2NjQzMg==", "bodyText": "Isn't the units for the \"sec\" field second, not microseconds?", "url": "https://github.com/debezium/debezium/pull/1348#discussion_r393966432", "createdAt": "2020-03-17T20:58:23Z", "author": {"login": "jgraf50"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbEventMetadataProvider.java", "diffHunk": "@@ -32,6 +33,10 @@ public Instant getEventTimestamp(DataCollectionId source, OffsetContext offset,\n         if (source == null) {\n             return null;\n         }\n+        if (sourceInfo.schema().field(SourceInfo.TIMESTAMP) != null) {\n+            final Integer timestamp = sourceInfo.getInt32(SourceInfo.TIMESTAMP);\n+            return timestamp == null ? null : Conversions.toInstantFromMicros(timestamp);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cfeb90066ece01f4212b821cf6eb4241ea01380"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQwMTcxNw==", "bodyText": "You're absolutely correct, the time value in the source-info block is seconds since epoch and so this should be changed.", "url": "https://github.com/debezium/debezium/pull/1348#discussion_r394401717", "createdAt": "2020-03-18T14:46:19Z", "author": {"login": "Naros"}, "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbEventMetadataProvider.java", "diffHunk": "@@ -32,6 +33,10 @@ public Instant getEventTimestamp(DataCollectionId source, OffsetContext offset,\n         if (source == null) {\n             return null;\n         }\n+        if (sourceInfo.schema().field(SourceInfo.TIMESTAMP) != null) {\n+            final Integer timestamp = sourceInfo.getInt32(SourceInfo.TIMESTAMP);\n+            return timestamp == null ? null : Conversions.toInstantFromMicros(timestamp);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzk2NjQzMg=="}, "originalCommit": {"oid": "1cfeb90066ece01f4212b821cf6eb4241ea01380"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4471, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}