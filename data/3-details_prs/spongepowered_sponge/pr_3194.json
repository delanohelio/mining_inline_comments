{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMzI2Nzc1", "number": 3194, "title": "Fix case-sensitivity bug in SpongeUserStorageService#match(String)", "bodyText": "The current implementation of SpongeUserStorageService#match(String) converts the provided lastKnownName to lowercase but does not convert the GameProfile name to lowercase before comparing it. This means that GameProfile names with uppercase characters will never match the lowercase lastKnownName.", "createdAt": "2020-10-30T23:16:43Z", "url": "https://github.com/SpongePowered/Sponge/pull/3194", "merged": true, "mergeCommit": {"oid": "f3182f7447d20a6d3394c20fb8a5f9b141557d48"}, "closed": true, "closedAt": "2020-11-01T11:15:09Z", "author": {"login": "alexstaeding"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXxOSjgFqTUyMTEwMjE2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYI_RVAFqTUyMTE5MzQxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMTAyMTYy", "url": "https://github.com/SpongePowered/Sponge/pull/3194#pullrequestreview-521102162", "createdAt": "2020-10-31T01:38:27Z", "commit": {"oid": "5503f3b353a9dab257dd16d029b05cf97715370f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMTozODoyN1rOHrkABw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMTozODoyN1rOHrkABw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQ0MDY0Nw==", "bodyText": "You're changing this from immediately breaking out of optional-world to being half optional-style and half not.\nEither do something like name.get().toLowerCase(Locale.ROOT).startsWith(lastKnownName), or continue the Optional chain so it terminates with an orElse(false), removing any use of isPresent or get.", "url": "https://github.com/SpongePowered/Sponge/pull/3194#discussion_r515440647", "createdAt": "2020-10-31T01:38:27Z", "author": {"login": "zml2008"}, "path": "src/main/java/org/spongepowered/common/service/user/SpongeUserStorageService.java", "diffHunk": "@@ -113,7 +113,8 @@ public boolean delete(User user) {\n         Collection<GameProfile> allProfiles = UserDiscoverer.getAllProfiles();\n         Collection<GameProfile> matching = Sets.newHashSet();\n         for (GameProfile profile : allProfiles) {\n-            if (profile.getName().isPresent() && profile.getName().get().startsWith(lastKnownName)) {\n+            Optional<String> name = profile.getName().map(n -> n.toLowerCase(Locale.ROOT));\n+            if (name.isPresent() && name.get().startsWith(lastKnownName)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5503f3b353a9dab257dd16d029b05cf97715370f"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fa48ca4fc8f89f3f0e96adbb83302ecf0d76dfd", "author": {"user": {"login": "alexstaeding", "name": "Alexander Staeding"}}, "url": "https://github.com/SpongePowered/Sponge/commit/8fa48ca4fc8f89f3f0e96adbb83302ecf0d76dfd", "committedDate": "2020-10-31T12:00:40Z", "message": "Convert GameProfile names to lowercase before comparing with lowercase lastKnownName"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5503f3b353a9dab257dd16d029b05cf97715370f", "author": {"user": {"login": "alexstaeding", "name": "Alexander Staeding"}}, "url": "https://github.com/SpongePowered/Sponge/commit/5503f3b353a9dab257dd16d029b05cf97715370f", "committedDate": "2020-10-30T22:44:17Z", "message": "Convert GameProfile names to lowercase before comparing with lowercase lastKnownName"}, "afterCommit": {"oid": "8fa48ca4fc8f89f3f0e96adbb83302ecf0d76dfd", "author": {"user": {"login": "alexstaeding", "name": "Alexander Staeding"}}, "url": "https://github.com/SpongePowered/Sponge/commit/8fa48ca4fc8f89f3f0e96adbb83302ecf0d76dfd", "committedDate": "2020-10-31T12:00:40Z", "message": "Convert GameProfile names to lowercase before comparing with lowercase lastKnownName"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMTkzNDE5", "url": "https://github.com/SpongePowered/Sponge/pull/3194#pullrequestreview-521193419", "createdAt": "2020-11-01T05:19:46Z", "commit": {"oid": "8fa48ca4fc8f89f3f0e96adbb83302ecf0d76dfd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 759, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}