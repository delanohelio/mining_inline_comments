{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MjM1MTg3", "number": 2462, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNVQwNzo0MTowN1rODV1JyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNVQwNzo0MTowN1rODV1JyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0MjE3NTQ0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/spongepowered/common/mixin/core/world/chunk/ChunkMixin.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNVQwNzo0MTowN1rOFaQWBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNVQxODowMTozMVrOFaSWzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NTA3OA==", "bodyText": "Wouldn't it just make more sense to check if existing != null? Or are you using the transaction as a check if we're capturing in the first place before checking if the capture had captured a tile entity to be removed?", "url": "https://github.com/SpongePowered/Sponge/pull/2462#discussion_r363075078", "createdAt": "2020-01-05T07:41:07Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/world/chunk/ChunkMixin.java", "diffHunk": "@@ -545,7 +545,7 @@ public IBlockState setBlockState(final BlockPos pos, final IBlockState state) {\n             // Sponge End\n             TileEntity tileentity = this.getTileEntity(pos, net.minecraft.world.chunk.Chunk.EnumCreateEntityType.CHECK);\n \n-            if (tileentity == null) {\n+            if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ae1dab9039b4e72edd52743c962bf42350219a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NjA4OA==", "bodyText": "@gabizou The capture of the removal here L434.\nAffect the selection of this if expression", "url": "https://github.com/SpongePowered/Sponge/pull/2462#discussion_r363076088", "createdAt": "2020-01-05T08:05:16Z", "author": {"login": "ginyai"}, "path": "src/main/java/org/spongepowered/common/mixin/core/world/chunk/ChunkMixin.java", "diffHunk": "@@ -545,7 +545,7 @@ public IBlockState setBlockState(final BlockPos pos, final IBlockState state) {\n             // Sponge End\n             TileEntity tileentity = this.getTileEntity(pos, net.minecraft.world.chunk.Chunk.EnumCreateEntityType.CHECK);\n \n-            if (tileentity == null) {\n+            if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NTA3OA=="}, "originalCommit": {"oid": "6ae1dab9039b4e72edd52743c962bf42350219a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NjMwNA==", "bodyText": "Ok so it's bundling the combined check that required the tile entity being queued for removal in the first place. Can you comment that in the change then (since tileentity == null is the only vanilla check, by adding the transaction check it's now sponge modified). I try to keep this method commented about its changes compared to the original code to avoid confusion between updates and when reading the method to see where sponge is making a change compared to the original engine code.", "url": "https://github.com/SpongePowered/Sponge/pull/2462#discussion_r363076304", "createdAt": "2020-01-05T08:09:16Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/world/chunk/ChunkMixin.java", "diffHunk": "@@ -545,7 +545,7 @@ public IBlockState setBlockState(final BlockPos pos, final IBlockState state) {\n             // Sponge End\n             TileEntity tileentity = this.getTileEntity(pos, net.minecraft.world.chunk.Chunk.EnumCreateEntityType.CHECK);\n \n-            if (tileentity == null) {\n+            if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NTA3OA=="}, "originalCommit": {"oid": "6ae1dab9039b4e72edd52743c962bf42350219a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NzY2MQ==", "bodyText": "@gabizou like this?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {\n          \n          \n            \n                        // Sponge Start - Additional check for the tile entity being queued for removal.\n          \n          \n            \n                        // if (tileentity == null) { // Sponge\n          \n          \n            \n                        if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {", "url": "https://github.com/SpongePowered/Sponge/pull/2462#discussion_r363077661", "createdAt": "2020-01-05T08:36:52Z", "author": {"login": "ginyai"}, "path": "src/main/java/org/spongepowered/common/mixin/core/world/chunk/ChunkMixin.java", "diffHunk": "@@ -545,7 +545,7 @@ public IBlockState setBlockState(final BlockPos pos, final IBlockState state) {\n             // Sponge End\n             TileEntity tileentity = this.getTileEntity(pos, net.minecraft.world.chunk.Chunk.EnumCreateEntityType.CHECK);\n \n-            if (tileentity == null) {\n+            if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NTA3OA=="}, "originalCommit": {"oid": "6ae1dab9039b4e72edd52743c962bf42350219a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzEwODA0NQ==", "bodyText": "Edited suggestion\nThe suggestion sounds fine, but if you're doing a //Sponge Start, then it'd make sense to modify the later // Sponge Start since Sponge's modifications are starting earlier.", "url": "https://github.com/SpongePowered/Sponge/pull/2462#discussion_r363108045", "createdAt": "2020-01-05T18:01:31Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/world/chunk/ChunkMixin.java", "diffHunk": "@@ -545,7 +545,7 @@ public IBlockState setBlockState(final BlockPos pos, final IBlockState state) {\n             // Sponge End\n             TileEntity tileentity = this.getTileEntity(pos, net.minecraft.world.chunk.Chunk.EnumCreateEntityType.CHECK);\n \n-            if (tileentity == null) {\n+            if (tileentity == null || (transaction != null && transaction.queuedRemoval != null)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NTA3OA=="}, "originalCommit": {"oid": "6ae1dab9039b4e72edd52743c962bf42350219a2"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2678, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}