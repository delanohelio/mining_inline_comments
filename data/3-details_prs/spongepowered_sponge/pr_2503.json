{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1MTg2NDY3", "number": 2503, "title": "Begin cleanup of core plugin entity mixins", "bodyText": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile\nCleans up quite a chunk of core entity mixins so more of it can compile.", "createdAt": "2020-02-14T02:53:53Z", "url": "https://github.com/SpongePowered/Sponge/pull/2503", "merged": true, "mergeCommit": {"oid": "454e93dd9dd3a1f6fed51d17450ae64a9435fb6f"}, "closed": true, "closedAt": "2020-02-23T02:32:59Z", "author": {"login": "i509VCB"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEGu9TAFqTM1ODY5MDE0NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcG28TTABqjMwNjI4MjY2MjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NjkwMTQ0", "url": "https://github.com/SpongePowered/Sponge/pull/2503#pullrequestreview-358690144", "createdAt": "2020-02-14T03:12:30Z", "commit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwMzoxMjozMFrOFpqfZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwMzoxMjozMFrOFpqfZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjEwMA==", "bodyText": "Could you maybe move these to the Constants class?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232100", "createdAt": "2020-02-14T03:12:30Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -203,7 +191,7 @@\n         final EntityTypeBridge entityTypeBridge = (EntityTypeBridge) entityType;\n         if (!entityTypeBridge.bridge$checkedDamageEntity()) {\n             try {\n-                final String mapping = SpongeImplHooks.isDeobfuscatedEnvironment() ? \"damageEntity\" : \"func_70665_d\";\n+                final String mapping = SpongeImplHooks.isDeobfuscatedEnvironment() ? \"attackEntityFrom\" : \"func_70097_a\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 122}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NjkwMzM2", "url": "https://github.com/SpongePowered/Sponge/pull/2503#pullrequestreview-358690336", "createdAt": "2020-02-14T03:13:12Z", "commit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwMzoxMzoxM1rOFpqf8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwMzoxMzoxM1rOFpqf8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjI0MQ==", "bodyText": "final Vec3d vec3d", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232241", "createdAt": "2020-02-14T03:13:13Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -301,15 +289,15 @@ public void dismountRidingEntity() {\n     @Override\n     public boolean bridge$removePassengers(final DismountType type) {\n         boolean dismount = false;\n-        for (int i = this.riddenByEntities.size() - 1; i >= 0; --i) {\n-            dismount = ((EntityMixin) (Object) this.riddenByEntities.get(i)).spongeImpl$dismountRidingEntity(type) || dismount;\n+        for (int i = this.passengers.size() - 1; i >= 0; --i) {\n+            dismount = ((EntityMixin) (Object) this.passengers.get(i)).spongeImpl$dismountRidingEntity(type) || dismount;\n         }\n         return dismount;\n     }\n \n     @Inject(method = \"move\", at = @At(\"HEAD\"), cancellable = true)\n-    private void spongeImpl$onSpongeMoveEntity(final MoverType type, final double x, final double y, final double z, final CallbackInfo ci) {\n-        if (!this.world.isRemote && !SpongeHooks.checkEntitySpeed(((Entity) (Object) this), x, y, z)) {\n+    private void spongeImpl$onSpongeMoveEntity(final MoverType type, Vec3d vec3d, final CallbackInfo ci) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 209}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NjkwNzU4", "url": "https://github.com/SpongePowered/Sponge/pull/2503#pullrequestreview-358690758", "createdAt": "2020-02-14T03:15:18Z", "commit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 54, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwMzoxNToxOVrOFpqhUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwMzo0MToxNFrOFpq0dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjU5NA==", "bodyText": "If you're moving this to a new line, change the at = @At to new line, so like:\n@Redirect(method = \"doBlockCollisions,\n    at = @At(value = \"INVOKE\",\n        target = \"Lnet/n....\"\n    )\n)\nThis way it's clearer, at least it's the format I'm trying to migrate the codebase to.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232594", "createdAt": "2020-02-14T03:15:19Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -558,21 +544,22 @@ private void onSpongeReadFromNBT(final CompoundNBT compound, final CallbackInfo\n \n     }\n \n-    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/state/IBlockState;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n-    private void spongeImpl$onEntityCollideWithBlockState(\n-        final Block block, final net.minecraft.world.World world, final BlockPos pos, final BlockState state, final Entity entity) {\n+    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\",\n+        target = \"Lnet/minecraft/block/BlockState;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 268}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjYzMA==", "bodyText": "s/spongeImpl/impl", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232630", "createdAt": "2020-02-14T03:15:32Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -558,21 +544,22 @@ private void onSpongeReadFromNBT(final CompoundNBT compound, final CallbackInfo\n \n     }\n \n-    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/state/IBlockState;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n-    private void spongeImpl$onEntityCollideWithBlockState(\n-        final Block block, final net.minecraft.world.World world, final BlockPos pos, final BlockState state, final Entity entity) {\n+    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\",\n+        target = \"Lnet/minecraft/block/BlockState;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n+    private void spongeImpl$onEntityCollideWithBlockState(BlockState blockState, net.minecraft.world.World worldIn, BlockPos pos, Entity entityIn) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 269}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjgzMQ==", "bodyText": "Leave out the comment. It's a recognized 1.14 change to call the methods on BlockState instead of the parent Block.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232831", "createdAt": "2020-02-14T03:16:29Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -558,21 +544,22 @@ private void onSpongeReadFromNBT(final CompoundNBT compound, final CallbackInfo\n \n     }\n \n-    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/state/IBlockState;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n-    private void spongeImpl$onEntityCollideWithBlockState(\n-        final Block block, final net.minecraft.world.World world, final BlockPos pos, final BlockState state, final Entity entity) {\n+    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\",\n+        target = \"Lnet/minecraft/block/BlockState;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n+    private void spongeImpl$onEntityCollideWithBlockState(BlockState blockState, net.minecraft.world.World worldIn, BlockPos pos, Entity entityIn) {\n         // if block can't collide, return\n-        if (!((BlockBridge) block).bridge$hasCollideWithStateLogic()) {\n+        if (!((BlockBridge) blockState.getBlock()).bridge$hasCollideWithStateLogic()) {\n             return;\n         }\n \n         if (world.isRemote) {\n-            block.onEntityCollision(world, pos, state, entity);\n+            // In 1.14, why are we calling the state instead? You will notice these methods are deprecated on block since you are supposed to call the state method instead, the methods aren't actually deprecated.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 278}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjkxNQ==", "bodyText": "Do we need to pass in the block anymore?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232915", "createdAt": "2020-02-14T03:16:51Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -558,21 +544,22 @@ private void onSpongeReadFromNBT(final CompoundNBT compound, final CallbackInfo\n \n     }\n \n-    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/Block;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/state/IBlockState;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n-    private void spongeImpl$onEntityCollideWithBlockState(\n-        final Block block, final net.minecraft.world.World world, final BlockPos pos, final BlockState state, final Entity entity) {\n+    @Redirect(method = \"doBlockCollisions\", at = @At(value = \"INVOKE\",\n+        target = \"Lnet/minecraft/block/BlockState;onEntityCollision(Lnet/minecraft/world/World;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/entity/Entity;)V\")) // doBlockCollisions\n+    private void spongeImpl$onEntityCollideWithBlockState(BlockState blockState, net.minecraft.world.World worldIn, BlockPos pos, Entity entityIn) {\n         // if block can't collide, return\n-        if (!((BlockBridge) block).bridge$hasCollideWithStateLogic()) {\n+        if (!((BlockBridge) blockState.getBlock()).bridge$hasCollideWithStateLogic()) {\n             return;\n         }\n \n         if (world.isRemote) {\n-            block.onEntityCollision(world, pos, state, entity);\n+            // In 1.14, why are we calling the state instead? You will notice these methods are deprecated on block since you are supposed to call the state method instead, the methods aren't actually deprecated.\n+            blockState.onEntityCollision(world, pos, entityIn);\n             return;\n         }\n \n-        if (!SpongeCommonEventFactory.handleCollideBlockEvent(block, world, pos, state, entity, Direction.NONE)) {\n-            block.onEntityCollision(world, pos, state, entity);\n+        if (!SpongeCommonEventFactory.handleCollideBlockEvent(blockState.getBlock(), world, pos, blockState, entityIn, Direction.NONE)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 285}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMjk5Mg==", "bodyText": "Fix the method name with impl$ prefix.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379232992", "createdAt": "2020-02-14T03:17:14Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -672,48 +659,48 @@ private boolean spongeApplyEntityCollisionCheckVanish(final Entity entity) {\n         return entity.noClip || ((VanishableBridge) entity).bridge$isVanished();\n     }\n \n-    @Redirect(method = \"doWaterSplashEffect\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;spawnParticle(Lnet/minecraft/util/EnumParticleTypes;DDDDDD[I)V\"))\n-    private void spawnParticle(final net.minecraft.world.World world, final EnumParticleTypes particleTypes, final double xCoord, final double yCoord, final double zCoord,\n-        final double xOffset, final double yOffset, final double zOffset, final int... p_175688_14_) {\n+    @Redirect(method = \"doWaterSplashEffect\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;addParticle(Lnet/minecraft/particles/IParticleData;DDDDDD)V\"))\n+    private void spawnParticle(final net.minecraft.world.World world, final IParticleData particleTypes, final double xCoord, final double yCoord, final double zCoord,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 313}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMzAzMA==", "bodyText": "Same here, fix the prefixing.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379233030", "createdAt": "2020-02-14T03:17:25Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -672,48 +659,48 @@ private boolean spongeApplyEntityCollisionCheckVanish(final Entity entity) {\n         return entity.noClip || ((VanishableBridge) entity).bridge$isVanished();\n     }\n \n-    @Redirect(method = \"doWaterSplashEffect\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;spawnParticle(Lnet/minecraft/util/EnumParticleTypes;DDDDDD[I)V\"))\n-    private void spawnParticle(final net.minecraft.world.World world, final EnumParticleTypes particleTypes, final double xCoord, final double yCoord, final double zCoord,\n-        final double xOffset, final double yOffset, final double zOffset, final int... p_175688_14_) {\n+    @Redirect(method = \"doWaterSplashEffect\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;addParticle(Lnet/minecraft/particles/IParticleData;DDDDDD)V\"))\n+    private void spawnParticle(final net.minecraft.world.World world, final IParticleData particleTypes, final double xCoord, final double yCoord, final double zCoord,\n+                               final double xOffset, final double yOffset, final double zOffset) {\n         if (!this.vanish$isVanished) {\n-            this.world.spawnParticle(particleTypes, xCoord, yCoord, zCoord, xOffset, yOffset, zOffset, p_175688_14_);\n+            this.world.addParticle(particleTypes, xCoord, yCoord, zCoord, xOffset, yOffset, zOffset);\n         }\n     }\n \n-    @Redirect(method = \"createRunningParticles\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;spawnParticle(Lnet/minecraft/util/EnumParticleTypes;DDDDDD[I)V\"))\n-    private void runningSpawnParticle(final net.minecraft.world.World world, final EnumParticleTypes particleTypes, final double xCoord, final double yCoord, final double zCoord,\n-        final double xOffset, final double yOffset, final double zOffset, final int... p_175688_14_) {\n+    @Redirect(method = \"createRunningParticles\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;addParticle(Lnet/minecraft/particles/IParticleData;DDDDDD)V\"))\n+    private void runningSpawnParticle(final net.minecraft.world.World world, final IParticleData particleTypes, final double xCoord, final double yCoord, final double zCoord,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 325}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMzQ1OA==", "bodyText": "Add a TODO for me to review this bit of code, it might be refactored into oblivion later when entity capturing is reviewed.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379233458", "createdAt": "2020-02-14T03:19:32Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -743,7 +730,7 @@ public ItemEntity entityDropItem(final ItemStack stack, final float offsetY) {\n             } else {\n                 final ItemEntity entityitem = new ItemEntity(this.world, this.posX, this.posY + (double) offsetY, this.posZ, stack);\n                 entityitem.setDefaultPickupDelay();\n-                this.world.addEntity0(entityitem);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 374}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMzU5Nw==", "bodyText": "Is it on EntityTypeBridge? Did you add that or is that being inherited from TimingsHolder (or whatever the interface is)?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379233597", "createdAt": "2020-02-14T03:20:22Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -754,12 +741,12 @@ public ItemEntity entityDropItem(final ItemStack stack, final float offsetY) {\n     @Nullable\n     @Override\n     public BlockPos bridge$getLastCollidedBlockPos() {\n-        return this.lastCollidedBlockPos;\n+        return this.impl$lastCollidedBlockPos;\n     }\n \n     @Override\n     public Timing bridge$getTimingsHandler() {\n-        return this.entityType.getTimingsHandler();\n+        return ((EntityTypeBridge) this.shadow$getType()).bridge$getTimings();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 390}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMzc1NQ==", "bodyText": "Fix the method name here please.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379233755", "createdAt": "2020-02-14T03:21:05Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -330,7 +333,7 @@ private EntityDeathContext createOrNullDeathPhase(final boolean isMainThread, fi\n         return null;\n     }\n \n-    @Redirect(method = \"applyPotionDamageCalculations\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLivingBase;isPotionActive(Lnet/minecraft/potion/Potion;)Z\") )\n+    @Redirect(method = \"applyPotionDamageCalculations\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;isPotionActive(Lnet/minecraft/potion/Effect;)Z\") )\n     private boolean onIsPotionActive(final LivingEntity entityIn, final Effect potion) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDAzMw==", "bodyText": "Should be shadow$ prefixed if it's calling a shadow method (Yes, I know this is an overwrite).", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234033", "createdAt": "2020-02-14T03:22:28Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -385,7 +388,7 @@ public boolean attackEntityFrom(final DamageSource source, final float amount) {\n             return false;\n         }\n         // Sponge end\n-        if (this.isEntityInvulnerable(source)) {\n+        if (this.isInvulnerableTo(source)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDA1OA==", "bodyText": "Same here", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234058", "createdAt": "2020-02-14T03:22:36Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -590,7 +593,7 @@ private void spawnItemParticle(final World world, final EnumParticleTypes partic\n     @SuppressWarnings(\"ConstantConditions\")\n     @Override\n     public boolean bridge$damageEntityHook(final DamageSource damageSource, float damage) {\n-        if (!this.isEntityInvulnerable(damageSource)) {\n+        if (!this.isInvulnerableTo(damageSource)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDE5MQ==", "bodyText": "Fix the method name for this, don't keep it same named with the added prefix.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234191", "createdAt": "2020-02-14T03:23:13Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -872,7 +875,7 @@ private void causeTrackDeathUpdate(final LivingEntity entityLivingBase) {\n         }\n     }\n \n-    @Redirect(method = \"onDeathUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLivingBase;getExperiencePoints(Lnet/minecraft/entity/player/EntityPlayer;)I\"))\n+    @Redirect(method = \"onDeathUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;getExperiencePoints(Lnet/minecraft/entity/player/PlayerEntity;)I\"))\n     private int onGetExperiencePoints(final LivingEntity entity, final PlayerEntity attackingPlayer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDIwOA==", "bodyText": "Prefix the method name.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234208", "createdAt": "2020-02-14T03:23:21Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -889,7 +892,7 @@ public void onEntityItemPickup(final Entity entityItem, final int unused, final\n         }\n     }\n \n-    @Inject(method = \"onItemUseFinish\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLivingBase;resetActiveHand()V\"))\n+    @Inject(method = \"onItemUseFinish\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;resetActiveHand()V\"))\n     private void updateHealthForUseFinish(final CallbackInfo ci) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 124}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDI1Mg==", "bodyText": "Same here.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234252", "createdAt": "2020-02-14T03:23:32Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -901,7 +904,7 @@ private void updateHealthForUseFinish(final CallbackInfo ci) {\n     // Start implementation of UseItemstackEvent\n \n     @Inject(method = \"setActiveHand\", cancellable = true, locals = LocalCapture.CAPTURE_FAILHARD,\n-            at = @At(value = \"FIELD\", target = \"Lnet/minecraft/entity/EntityLivingBase;activeItemStack:Lnet/minecraft/item/ItemStack;\"))\n+            at = @At(value = \"FIELD\", target = \"Lnet/minecraft/entity/LivingEntity;activeItemStack:Lnet/minecraft/item/ItemStack;\"))\n     private void onSetActiveItemStack(final Hand hand, final CallbackInfo ci, final ItemStack stack) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 133}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDI4MQ==", "bodyText": "Same here.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234281", "createdAt": "2020-02-14T03:23:42Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -950,7 +953,7 @@ private void addSelfToFrame(final CauseStackManager.StackFrame frame, final Item\n     }\n \n     @Redirect(method = \"updateActiveHand\",\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLivingBase;getItemInUseCount()I\", ordinal = 0))\n+            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;getItemInUseCount()I\", ordinal = 0))\n     private int onGetRemainingItemDuration(final LivingEntity self) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDMwNA==", "bodyText": "Same here.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234304", "createdAt": "2020-02-14T03:23:50Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/LivingEntityMixin.java", "diffHunk": "@@ -982,7 +985,7 @@ private int onGetRemainingItemDuration(final LivingEntity self) {\n \n     @SuppressWarnings(\"ConstantConditions\")\n     @Inject(method = \"onItemUseFinish\", cancellable = true,\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLivingBase;updateItemUse(Lnet/minecraft/item/ItemStack;I)V\"))\n+            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;updateItemUse(Lnet/minecraft/item/ItemStack;I)V\"))\n     private void onUpdateItemUse(final CallbackInfo ci) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDM1MQ==", "bodyText": "Fix the prefix, should be impl$.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234351", "createdAt": "2020-02-14T03:24:03Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/MobEntityMixin.java", "diffHunk": "@@ -72,39 +72,39 @@\n @Mixin(MobEntity.class)\n public abstract class MobEntityMixin extends LivingEntityMixin {\n \n-    @Shadow @Final protected GoalSelector tasks;\n-    @Shadow @Final protected GoalSelector targetTasks;\n+    @Shadow @Final protected GoalSelector goalSelector;\n+    @Shadow @Final protected GoalSelector targetSelector;\n     @Shadow @Nullable private LivingEntity attackTarget;\n \n     @Shadow public abstract boolean isAIDisabled();\n-    @Shadow @Nullable public abstract net.minecraft.entity.Entity getLeashHolder();\n-    @Shadow protected abstract void initEntityAI();\n+    @Shadow @Nullable public abstract net.minecraft.entity.Entity shadow$getLeashHolder();\n+    @Shadow protected abstract void shadow$registerGoals();\n \n-    @Redirect(method = \"<init>\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLiving;initEntityAI()V\"))\n-    private void spongeImpl$initializeAI(final MobEntity this$0) {\n+    @Redirect(method = \"<init>\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/MobEntity;registerGoals()V\"))\n+    private void spongeImpl$registerGoals(final MobEntity this$0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDQ5MA==", "bodyText": "Split out the target and opcode to new lines for shorter line lengths.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234490", "createdAt": "2020-02-14T03:24:44Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/MobEntityMixin.java", "diffHunk": "@@ -138,10 +138,10 @@ private void callLeashEvent(final PlayerEntity playerIn, final Hand hand, final\n     }\n \n     @Inject(method = \"clearLeashed\",\n-        at = @At(value = \"FIELD\", target = \"Lnet/minecraft/entity/EntityLiving;isLeashed:Z\", opcode = Opcodes.PUTFIELD),\n+        at = @At(value = \"FIELD\", target = \"Lnet/minecraft/entity/MobEntity;leashHolder:Lnet/minecraft/entity/Entity;\", opcode = Opcodes.PUTFIELD),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDUzMQ==", "bodyText": "Fix method prefixing..", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234531", "createdAt": "2020-02-14T03:24:57Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/MobEntityMixin.java", "diffHunk": "@@ -267,7 +267,7 @@ public LivingEntity getAttackTarget() {\n      * @param thisEntity\n      * @return\n      */\n-    @Redirect(method = \"onLivingUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityLiving;canPickUpLoot()Z\"))\n+    @Redirect(method = \"livingTick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/MobEntity;canPickUpLoot()Z\"))\n     private boolean onCanGrief(final MobEntity thisEntity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDYyMw==", "bodyText": "Fix the prefix to impl", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234623", "createdAt": "2020-02-14T03:25:26Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/effect/LightningBoltEntityMixin.java", "diffHunk": "@@ -63,8 +63,8 @@\n         return this.spongeImpl$strikeBlockAndAddSnapshot(world, pos, blockState);\n     }\n \n-    @Redirect(method = \"onUpdate()V\", at = @At(value = \"INVOKE\",\n-            target = \"Lnet/minecraft/world/World;setBlockState(Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/state/IBlockState;)Z\"))\n+    @Redirect(method = \"igniteBlocks(I)V\", at = @At(value = \"INVOKE\",\n+            target = \"Lnet/minecraft/world/World;setBlockState(Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;)Z\"))\n     private boolean spongeImpl$throwEventForChangingBlockDuringUpdate(final net.minecraft.world.World world, final BlockPos pos, final BlockState blockState) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDc5OA==", "bodyText": "Just leave a comment at the end what the func should be called..", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234798", "createdAt": "2020-02-14T03:26:12Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ArmorStandEntityMixin.java", "diffHunk": "@@ -49,7 +49,7 @@\n @Mixin(ArmorStandEntity.class)\n public abstract class ArmorStandEntityMixin extends LivingEntityMixin {\n \n-    @Shadow protected abstract void damageArmorStand(float damage);\n+    @Shadow protected abstract void shadow$func_213817_e(DamageSource damageSource, float damage);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDkzOQ==", "bodyText": "Don't change from Lclass/path;method()return, keep it prefixed with L and split the method with ;", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234939", "createdAt": "2020-02-14T03:26:48Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ArmorStandEntityMixin.java", "diffHunk": "@@ -64,49 +64,49 @@ private void fireDestroyDamageEvent(final DamageSource source, final CallbackInf\n                 cir.setReturnValue(false);\n             }\n             if (event.getFinalDamage() < this.getHealth()) {\n-                this.damageArmorStand((float) event.getFinalDamage());\n+                this.shadow$func_213817_e(source, (float) event.getFinalDamage());\n                 cir.setReturnValue(false);\n             }\n         }\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"FIELD\", target = \"Lnet/minecraft/util/DamageSource;OUT_OF_WORLD:Lnet/minecraft/util/DamageSource;\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;setDead()V\", ordinal = 0),\n+            at = @At(value = \"INVOKE\", target = \"net/minecraft/entity/item/ArmorStandEntity.remove()V\", ordinal = 0),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNDk4NQ==", "bodyText": "Fix this method with the prefix.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379234985", "createdAt": "2020-02-14T03:27:03Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ArmorStandEntityMixin.java", "diffHunk": "@@ -64,49 +64,49 @@ private void fireDestroyDamageEvent(final DamageSource source, final CallbackInf\n                 cir.setReturnValue(false);\n             }\n             if (event.getFinalDamage() < this.getHealth()) {\n-                this.damageArmorStand((float) event.getFinalDamage());\n+                this.shadow$func_213817_e(source, (float) event.getFinalDamage());\n                 cir.setReturnValue(false);\n             }\n         }\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"FIELD\", target = \"Lnet/minecraft/util/DamageSource;OUT_OF_WORLD:Lnet/minecraft/util/DamageSource;\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;setDead()V\", ordinal = 0),\n+            at = @At(value = \"INVOKE\", target = \"net/minecraft/entity/item/ArmorStandEntity.remove()V\", ordinal = 0),\n             cancellable = true)\n     private void fireDamageEventOutOfWorld(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {\n         this.fireDestroyDamageEvent(source, cir);\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"INVOKE\", target = \"Lnet/minecraft/util/DamageSource;isExplosion()Z\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;dropContents()V\"),\n+            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ArmorStandEntity;func_213816_g(Lnet/minecraft/util/DamageSource;)V\"),\n             cancellable = true)\n     private void fireDamageEventExplosion(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTAyNg==", "bodyText": "Multiline this annotation, it's too long now.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235026", "createdAt": "2020-02-14T03:27:18Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ArmorStandEntityMixin.java", "diffHunk": "@@ -64,49 +64,49 @@ private void fireDestroyDamageEvent(final DamageSource source, final CallbackInf\n                 cir.setReturnValue(false);\n             }\n             if (event.getFinalDamage() < this.getHealth()) {\n-                this.damageArmorStand((float) event.getFinalDamage());\n+                this.shadow$func_213817_e(source, (float) event.getFinalDamage());\n                 cir.setReturnValue(false);\n             }\n         }\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"FIELD\", target = \"Lnet/minecraft/util/DamageSource;OUT_OF_WORLD:Lnet/minecraft/util/DamageSource;\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;setDead()V\", ordinal = 0),\n+            at = @At(value = \"INVOKE\", target = \"net/minecraft/entity/item/ArmorStandEntity.remove()V\", ordinal = 0),\n             cancellable = true)\n     private void fireDamageEventOutOfWorld(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {\n         this.fireDestroyDamageEvent(source, cir);\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"INVOKE\", target = \"Lnet/minecraft/util/DamageSource;isExplosion()Z\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;dropContents()V\"),\n+            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ArmorStandEntity;func_213816_g(Lnet/minecraft/util/DamageSource;)V\"),\n             cancellable = true)\n     private void fireDamageEventExplosion(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {\n         this.fireDestroyDamageEvent(source, cir);\n     }\n \n-    @Redirect(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;damageArmorStand(F)V\"))\n-    private void fireDamageEventDamage(final ArmorStandEntity self, final float effectiveAmount, final DamageSource source, final float originalAmount) {\n+    @Redirect(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ArmorStandEntity;func_213817_e(Lnet/minecraft/util/DamageSource;F)V\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTA1OQ==", "bodyText": "Change the prefix with impl$.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235059", "createdAt": "2020-02-14T03:27:31Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ArmorStandEntityMixin.java", "diffHunk": "@@ -64,49 +64,49 @@ private void fireDestroyDamageEvent(final DamageSource source, final CallbackInf\n                 cir.setReturnValue(false);\n             }\n             if (event.getFinalDamage() < this.getHealth()) {\n-                this.damageArmorStand((float) event.getFinalDamage());\n+                this.shadow$func_213817_e(source, (float) event.getFinalDamage());\n                 cir.setReturnValue(false);\n             }\n         }\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"FIELD\", target = \"Lnet/minecraft/util/DamageSource;OUT_OF_WORLD:Lnet/minecraft/util/DamageSource;\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;setDead()V\", ordinal = 0),\n+            at = @At(value = \"INVOKE\", target = \"net/minecraft/entity/item/ArmorStandEntity.remove()V\", ordinal = 0),\n             cancellable = true)\n     private void fireDamageEventOutOfWorld(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {\n         this.fireDestroyDamageEvent(source, cir);\n     }\n \n     @Inject(method = \"attackEntityFrom\",\n             slice = @Slice(from = @At(value = \"INVOKE\", target = \"Lnet/minecraft/util/DamageSource;isExplosion()Z\")),\n-            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;dropContents()V\"),\n+            at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ArmorStandEntity;func_213816_g(Lnet/minecraft/util/DamageSource;)V\"),\n             cancellable = true)\n     private void fireDamageEventExplosion(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {\n         this.fireDestroyDamageEvent(source, cir);\n     }\n \n-    @Redirect(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;damageArmorStand(F)V\"))\n-    private void fireDamageEventDamage(final ArmorStandEntity self, final float effectiveAmount, final DamageSource source, final float originalAmount) {\n+    @Redirect(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ArmorStandEntity;func_213817_e(Lnet/minecraft/util/DamageSource;F)V\"))\n+    private void fireDamageEventDamage(final ArmorStandEntity self, final DamageSource source, final float amount) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTEwNw==", "bodyText": "Too long, multi-line the annotation.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235107", "createdAt": "2020-02-14T03:27:45Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ArmorStandEntityMixin.java", "diffHunk": "@@ -122,7 +122,7 @@ private void fireDamageEventFirstPunch(final DamageSource source, final float am\n         }\n     }\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityArmorStand;dropBlock()V\"),\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ArmorStandEntity;func_213815_f(Lnet/minecraft/util/DamageSource;)V\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTMwMA==", "bodyText": "It's returning an Entity, not DimensionType.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235300", "createdAt": "2020-02-14T03:28:32Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/EnderPearlEntityMixin.java", "diffHunk": "@@ -96,11 +97,13 @@ private boolean onEnderPearlImpact(final ServerPlayerEntity player) {\n \n     /**\n      * @author Zidane - June 2019 - 1.12.2\n+     * @author i509VCB - Feb 2020 - 1.14.4\n      * @reason Only have this ender pearl remove the thrower references if we actually changed dimension\n+     * @return Change to use DimensionType", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTQwMg==", "bodyText": "Is this a vanilla method, or sponge-added method? If it's a vanilla method, and it's overriding a @Shadow'ed method, it should be prefixed appropriately", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235402", "createdAt": "2020-02-14T03:29:12Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/EnderPearlEntityMixin.java", "diffHunk": "@@ -96,11 +97,13 @@ private boolean onEnderPearlImpact(final ServerPlayerEntity player) {\n \n     /**\n      * @author Zidane - June 2019 - 1.12.2\n+     * @author i509VCB - Feb 2020 - 1.14.4\n      * @reason Only have this ender pearl remove the thrower references if we actually changed dimension\n+     * @return Change to use DimensionType\n      */\n     @Override\n     @Nullable\n-    public Entity changeDimension(final int dimensionIn) {\n+    public Entity changeDimension(DimensionType dimensionIn) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTQ4NQ==", "bodyText": "Fix the method prefix and method name, onExplode makes little to no sense of what it's doing.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235485", "createdAt": "2020-02-14T03:29:45Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/FireworkRocketEntityMixin.java", "diffHunk": "@@ -111,7 +111,7 @@\n     }\n \n     @SuppressWarnings(\"deprecation\")\n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;setEntityState\"\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;setEntityState\"\n                                                                        + \"(Lnet/minecraft/entity/Entity;B)V\"))\n     private void onExplode(final World world, final Entity self, final byte state) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTU0Mg==", "bodyText": "Unify the string target value and multi-line the annotation instead.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235542", "createdAt": "2020-02-14T03:30:08Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/FireworkRocketEntityMixin.java", "diffHunk": "@@ -111,7 +111,7 @@\n     }\n \n     @SuppressWarnings(\"deprecation\")\n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;setEntityState\"\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/world/World;setEntityState\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTU3MA==", "bodyText": "Fix the method prefix and name.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235570", "createdAt": "2020-02-14T03:30:18Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/FireworkRocketEntityMixin.java", "diffHunk": "@@ -130,7 +130,7 @@ private void onExplode(final World world, final Entity self, final byte state) {\n     }\n \n     @SuppressWarnings(\"deprecation\")\n-    @Inject(method = \"onUpdate\", at = @At(\"RETURN\"))\n+    @Inject(method = \"tick()V\", at = @At(\"RETURN\"))\n     private void onUpdate(final CallbackInfo ci) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTYyNw==", "bodyText": "Prefix with impl$.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235627", "createdAt": "2020-02-14T03:30:34Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/HangingEntityMixin.java", "diffHunk": "@@ -55,33 +55,33 @@\n public abstract class HangingEntityMixin extends EntityMixin {\n \n     @Shadow @Nullable public Direction facingDirection;\n-    @Shadow public abstract boolean onValidSurface();\n+    @Shadow public abstract boolean shadow$onValidSurface();\n \n-    private boolean ignorePhysics = false;\n+    private boolean impl$ignorePhysics = false;\n \n     /**\n      * Called to update the entity's position/logic.\n      */\n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityHanging;onValidSurface()Z\"))\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/HangingEntity;onValidSurface()Z\"))\n     private boolean checkIfOnValidSurfaceAndIgnoresPhysics(HangingEntity entityHanging) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTY4Mg==", "bodyText": "s/spongeImpl/impl", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235682", "createdAt": "2020-02-14T03:30:50Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/HangingEntityMixin.java", "diffHunk": "@@ -55,33 +55,33 @@\n public abstract class HangingEntityMixin extends EntityMixin {\n \n     @Shadow @Nullable public Direction facingDirection;\n-    @Shadow public abstract boolean onValidSurface();\n+    @Shadow public abstract boolean shadow$onValidSurface();\n \n-    private boolean ignorePhysics = false;\n+    private boolean impl$ignorePhysics = false;\n \n     /**\n      * Called to update the entity's position/logic.\n      */\n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityHanging;onValidSurface()Z\"))\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/HangingEntity;onValidSurface()Z\"))\n     private boolean checkIfOnValidSurfaceAndIgnoresPhysics(HangingEntity entityHanging) {\n-        return this.onValidSurface() && !this.ignorePhysics;\n+        return this.shadow$onValidSurface() && !this.impl$ignorePhysics;\n     }\n \n     @Override\n     public void spongeImpl$writeToSpongeCompound(CompoundNBT compound) {\n         super.spongeImpl$writeToSpongeCompound(compound);\n-        compound.putBoolean(\"ignorePhysics\", this.ignorePhysics);\n+        compound.putBoolean(\"ignorePhysics\", this.impl$ignorePhysics);\n     }\n \n     @Override\n     public void spongeImpl$readFromSpongeCompound(CompoundNBT compound) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTcxMA==", "bodyText": "Same here. Fix prefix.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235710", "createdAt": "2020-02-14T03:30:59Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/HangingEntityMixin.java", "diffHunk": "@@ -55,33 +55,33 @@\n public abstract class HangingEntityMixin extends EntityMixin {\n \n     @Shadow @Nullable public Direction facingDirection;\n-    @Shadow public abstract boolean onValidSurface();\n+    @Shadow public abstract boolean shadow$onValidSurface();\n \n-    private boolean ignorePhysics = false;\n+    private boolean impl$ignorePhysics = false;\n \n     /**\n      * Called to update the entity's position/logic.\n      */\n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityHanging;onValidSurface()Z\"))\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/HangingEntity;onValidSurface()Z\"))\n     private boolean checkIfOnValidSurfaceAndIgnoresPhysics(HangingEntity entityHanging) {\n-        return this.onValidSurface() && !this.ignorePhysics;\n+        return this.shadow$onValidSurface() && !this.impl$ignorePhysics;\n     }\n \n     @Override\n     public void spongeImpl$writeToSpongeCompound(CompoundNBT compound) {\n         super.spongeImpl$writeToSpongeCompound(compound);\n-        compound.putBoolean(\"ignorePhysics\", this.ignorePhysics);\n+        compound.putBoolean(\"ignorePhysics\", this.impl$ignorePhysics);\n     }\n \n     @Override\n     public void spongeImpl$readFromSpongeCompound(CompoundNBT compound) {\n         super.spongeImpl$readFromSpongeCompound(compound);\n         if (compound.contains(\"ignorePhysics\")) {\n-            this.ignorePhysics = compound.getBoolean(\"ignorePhysics\");\n+            this.impl$ignorePhysics = compound.getBoolean(\"ignorePhysics\");\n         }\n     }\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/EntityHanging;setDead()V\"), cancellable = true)\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/HangingEntity;remove()V\"), cancellable = true)\n     private void onAttackEntityFrom(DamageSource source, float amount, CallbackInfoReturnable<Boolean> cir) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTg1Nw==", "bodyText": "Fix the method name.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235857", "createdAt": "2020-02-14T03:31:42Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ItemFrameEntityMixin.java", "diffHunk": "@@ -46,10 +46,9 @@\n @Mixin(ItemFrameEntity.class)\n public abstract class ItemFrameEntityMixin extends HangingEntityMixin {\n \n-    @Shadow public abstract void setDisplayedItem(@Nullable net.minecraft.item.ItemStack p_82334_1_);\n+    @Shadow public abstract void shadow$setDisplayedItem(@Nullable net.minecraft.item.ItemStack p_82334_1_);\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityItemFrame;dropItemOrSelf\"\n-      + \"(Lnet/minecraft/entity/Entity;Z)V\"), cancellable = true)\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ItemFrameEntity;dropItemOrSelf(Lnet/minecraft/entity/Entity;Z)V\"), cancellable = true)\n     private void onAttackEntityFrom(DamageSource source, float amount, CallbackInfoReturnable<Boolean> cir) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTg4OQ==", "bodyText": "Multi-line the annotation..", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235889", "createdAt": "2020-02-14T03:31:51Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/ItemFrameEntityMixin.java", "diffHunk": "@@ -46,10 +46,9 @@\n @Mixin(ItemFrameEntity.class)\n public abstract class ItemFrameEntityMixin extends HangingEntityMixin {\n \n-    @Shadow public abstract void setDisplayedItem(@Nullable net.minecraft.item.ItemStack p_82334_1_);\n+    @Shadow public abstract void shadow$setDisplayedItem(@Nullable net.minecraft.item.ItemStack p_82334_1_);\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityItemFrame;dropItemOrSelf\"\n-      + \"(Lnet/minecraft/entity/Entity;Z)V\"), cancellable = true)\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/ItemFrameEntity;dropItemOrSelf(Lnet/minecraft/entity/Entity;Z)V\"), cancellable = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTk1OA==", "bodyText": "Change method name.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235958", "createdAt": "2020-02-14T03:32:11Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/TNTEntityMixin.java", "diffHunk": "@@ -123,7 +123,7 @@\n     }\n \n \n-    @Inject(method = \"onUpdate\", at = @At(\"RETURN\"))\n+    @Inject(method = \"tick()V\", at = @At(\"RETURN\"))\n     private void onSpongeUpdateTNTPushPrime(final CallbackInfo ci) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNTk5Mw==", "bodyText": "Multi-line annotation.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379235993", "createdAt": "2020-02-14T03:32:23Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/minecart/AbstractMinecartEntityMixin.java", "diffHunk": "@@ -85,12 +85,12 @@ private double onDecelerateZ(final double defaultValue) {\n         return this.impl$derailedMod.getZ();\n     }\n \n-    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecart;isBeingRidden()Z\"))\n+    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/AbstractEntityMinecart;isBeingRidden()Z\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjAwOQ==", "bodyText": "Change method name with prefix.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236009", "createdAt": "2020-02-14T03:32:32Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/minecart/AbstractMinecartEntityMixin.java", "diffHunk": "@@ -85,12 +85,12 @@ private double onDecelerateZ(final double defaultValue) {\n         return this.impl$derailedMod.getZ();\n     }\n \n-    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecart;isBeingRidden()Z\"))\n+    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/AbstractEntityMinecart;isBeingRidden()Z\"))\n     private boolean onIsRidden(final AbstractMinecartEntity self) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjAzNw==", "bodyText": "Multi-line appropriately.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236037", "createdAt": "2020-02-14T03:32:44Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/minecart/AbstractMinecartEntityMixin.java", "diffHunk": "@@ -85,12 +85,12 @@ private double onDecelerateZ(final double defaultValue) {\n         return this.impl$derailedMod.getZ();\n     }\n \n-    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecart;isBeingRidden()Z\"))\n+    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/AbstractEntityMinecart;isBeingRidden()Z\"))\n     private boolean onIsRidden(final AbstractMinecartEntity self) {\n-        return !this.impl$slowWhenEmpty || this.isBeingRidden();\n+        return !this.impl$slowWhenEmpty || this.shadow$isBeingRidden();\n     }\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecart;removePassengers()V\"),\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/AbstractEntityMinecart;removePassengers()V\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjA3NQ==", "bodyText": "Change prefix and method name..", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236075", "createdAt": "2020-02-14T03:32:55Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/minecart/AbstractMinecartEntityMixin.java", "diffHunk": "@@ -85,12 +85,12 @@ private double onDecelerateZ(final double defaultValue) {\n         return this.impl$derailedMod.getZ();\n     }\n \n-    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecart;isBeingRidden()Z\"))\n+    @Redirect(method = \"applyDrag\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/AbstractEntityMinecart;isBeingRidden()Z\"))\n     private boolean onIsRidden(final AbstractMinecartEntity self) {\n-        return !this.impl$slowWhenEmpty || this.isBeingRidden();\n+        return !this.impl$slowWhenEmpty || this.shadow$isBeingRidden();\n     }\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecart;removePassengers()V\"),\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/AbstractEntityMinecart;removePassengers()V\"),\n       cancellable = true)\n     private void onAttackEntityFrom(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjEyMw==", "bodyText": "Same as the other instance comment, you're not returning a DimensionType.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236123", "createdAt": "2020-02-14T03:33:19Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/minecart/ContainerMinecartEntityMixin.java", "diffHunk": "@@ -38,11 +39,13 @@\n \n     /**\n      * @author Zidane - June 2019 - 1.12.2\n+     * @author i509VCB - Feb 2020 - 1.14.4\n      * @reason Only have this Minecart not drop contents if we actually changed dimension\n+     * @return Change to use DimensionType", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjE2Nw==", "bodyText": "Fix method name.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236167", "createdAt": "2020-02-14T03:33:33Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/item/minecart/TNTMinecartEntityMixin.java", "diffHunk": "@@ -157,7 +157,7 @@ private void postExplode(final CallbackInfo ci) {\n         }\n     }\n \n-    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/EntityMinecartTNT;explodeCart(D)V\"))\n+    @Inject(method = \"attackEntityFrom\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/item/minecart/TNTMinecartEntity;explodeCart(D)V\"))\n     private void onAttackEntityFrom(final DamageSource source, final float amount, final CallbackInfoReturnable<Boolean> cir) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjI3MA==", "bodyText": "Your change should be after mine since yours came after.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236270", "createdAt": "2020-02-14T03:34:09Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/VillagerEntityMixin.java", "diffHunk": "@@ -24,121 +24,74 @@\n  */\n package org.spongepowered.common.mixin.core.entity.merchant.villager;\n \n-import static com.google.common.base.Preconditions.checkNotNull;\n-import static com.google.common.base.Preconditions.checkState;\n-\n+import com.google.common.collect.Sets;\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerData;\n import net.minecraft.entity.merchant.villager.VillagerEntity;\n-import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.inventory.Inventory;\n-import net.minecraft.village.MerchantRecipeList;\n-import org.spongepowered.api.data.type.Career;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n import org.spongepowered.api.data.type.Profession;\n import org.spongepowered.api.entity.living.trader.Villager;\n import org.spongepowered.api.item.merchant.TradeOffer;\n import org.spongepowered.api.item.merchant.TradeOfferGenerator;\n import org.spongepowered.api.item.merchant.VillagerRegistry;\n-import org.spongepowered.asm.mixin.Final;\n import org.spongepowered.asm.mixin.Mixin;\n-import org.spongepowered.asm.mixin.Overwrite;\n import org.spongepowered.asm.mixin.Shadow;\n-import org.spongepowered.asm.mixin.injection.At;\n-import org.spongepowered.asm.mixin.injection.Inject;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n-import org.spongepowered.common.SpongeImplHooks;\n-import org.spongepowered.common.bridge.entity.merchant.villager.VillagerEntityBridge;\n-import org.spongepowered.common.data.type.SpongeEntityMetadataType;\n-import org.spongepowered.common.inventory.lens.impl.collections.SlotLensCollection;\n-import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n import org.spongepowered.common.registry.SpongeVillagerRegistry;\n \n+import java.util.ArrayList;\n import java.util.List;\n-import java.util.Optional;\n-import java.util.Random;\n-\n-import javax.annotation.Nullable;\n+import java.util.Set;\n \n @SuppressWarnings(\"rawtypes\")\n @Mixin(VillagerEntity.class)\n-public abstract class VillagerEntityMixin extends AgeableEntityMixin implements VillagerEntityBridge {\n-\n-    @Shadow private int careerId; // careerId\n-    @Shadow private int careerLevel; // careerLevel\n-    @Shadow @Nullable private MerchantRecipeList buyingList; // buyingList\n-    @Shadow @Final private Inventory villagerInventory; // villagerInventory\n-\n-    @Shadow public abstract void setProfession(int professionId); // setProfession\n-    @Shadow public abstract MerchantRecipeList getRecipes(PlayerEntity player);\n-\n-    @Nullable private Profession impl$profession;\n-\n-    @Inject(method = \"setProfession(I)V\", at = @At(\"RETURN\"))\n-    private void onSetProfession(final int professionId, final CallbackInfo ci) {\n-        this.impl$profession = SpongeImplHooks.validateProfession(professionId);\n+public abstract class VillagerEntityMixin extends AbstractVillagerEntity {\n+    public VillagerEntityMixin() {\n+        super(null, null);\n     }\n \n-    @Override\n-    public Career bridge$getCareer() {\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-        if (this.careerId == 0 || this.careerId > careers.size()) {\n-            this.careerId = new Random().nextInt(careers.size()) + 1;\n-        }\n-        this.getRecipes(null);\n-        return careers.get(this.careerId - 1);\n-    }\n-\n-    @Override\n-    public Optional<Profession> bridge$getProfessionOptional() {\n-        return Optional.ofNullable(this.impl$profession);\n-    }\n-\n-    @Override\n-    public void bridge$setProfession(final Profession profession) {\n-        this.impl$profession = checkNotNull(profession, \"VillagerProfession cannot be null!\");\n-    }\n-\n-    @Override\n-    public void bridge$setCareer(final Career career) {\n-        this.setProfession(((SpongeEntityMetadataType) career.getProfession()).type);\n-        this.buyingList = null;\n-        this.careerId = ((SpongeCareer) career).type + 1;\n-        this.careerLevel = 1;\n-        this.getRecipes(null);\n-    }\n+    @Shadow public abstract VillagerData shadow$getVillagerData();\n \n     /**\n+     * @author i509VCB - Feb 12, 2020 - 1.14.4\n+     * @reason Call trade mutators when adding offers. This covers both Wandering Traders and Villagers.\n+     *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjMwNw==", "bodyText": "This is no longer an overwrite, or is it?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236307", "createdAt": "2020-02-14T03:34:23Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/VillagerEntityMixin.java", "diffHunk": "@@ -24,121 +24,74 @@\n  */\n package org.spongepowered.common.mixin.core.entity.merchant.villager;\n \n-import static com.google.common.base.Preconditions.checkNotNull;\n-import static com.google.common.base.Preconditions.checkState;\n-\n+import com.google.common.collect.Sets;\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerData;\n import net.minecraft.entity.merchant.villager.VillagerEntity;\n-import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.inventory.Inventory;\n-import net.minecraft.village.MerchantRecipeList;\n-import org.spongepowered.api.data.type.Career;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n import org.spongepowered.api.data.type.Profession;\n import org.spongepowered.api.entity.living.trader.Villager;\n import org.spongepowered.api.item.merchant.TradeOffer;\n import org.spongepowered.api.item.merchant.TradeOfferGenerator;\n import org.spongepowered.api.item.merchant.VillagerRegistry;\n-import org.spongepowered.asm.mixin.Final;\n import org.spongepowered.asm.mixin.Mixin;\n-import org.spongepowered.asm.mixin.Overwrite;\n import org.spongepowered.asm.mixin.Shadow;\n-import org.spongepowered.asm.mixin.injection.At;\n-import org.spongepowered.asm.mixin.injection.Inject;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n-import org.spongepowered.common.SpongeImplHooks;\n-import org.spongepowered.common.bridge.entity.merchant.villager.VillagerEntityBridge;\n-import org.spongepowered.common.data.type.SpongeEntityMetadataType;\n-import org.spongepowered.common.inventory.lens.impl.collections.SlotLensCollection;\n-import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n import org.spongepowered.common.registry.SpongeVillagerRegistry;\n \n+import java.util.ArrayList;\n import java.util.List;\n-import java.util.Optional;\n-import java.util.Random;\n-\n-import javax.annotation.Nullable;\n+import java.util.Set;\n \n @SuppressWarnings(\"rawtypes\")\n @Mixin(VillagerEntity.class)\n-public abstract class VillagerEntityMixin extends AgeableEntityMixin implements VillagerEntityBridge {\n-\n-    @Shadow private int careerId; // careerId\n-    @Shadow private int careerLevel; // careerLevel\n-    @Shadow @Nullable private MerchantRecipeList buyingList; // buyingList\n-    @Shadow @Final private Inventory villagerInventory; // villagerInventory\n-\n-    @Shadow public abstract void setProfession(int professionId); // setProfession\n-    @Shadow public abstract MerchantRecipeList getRecipes(PlayerEntity player);\n-\n-    @Nullable private Profession impl$profession;\n-\n-    @Inject(method = \"setProfession(I)V\", at = @At(\"RETURN\"))\n-    private void onSetProfession(final int professionId, final CallbackInfo ci) {\n-        this.impl$profession = SpongeImplHooks.validateProfession(professionId);\n+public abstract class VillagerEntityMixin extends AbstractVillagerEntity {\n+    public VillagerEntityMixin() {\n+        super(null, null);\n     }\n \n-    @Override\n-    public Career bridge$getCareer() {\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-        if (this.careerId == 0 || this.careerId > careers.size()) {\n-            this.careerId = new Random().nextInt(careers.size()) + 1;\n-        }\n-        this.getRecipes(null);\n-        return careers.get(this.careerId - 1);\n-    }\n-\n-    @Override\n-    public Optional<Profession> bridge$getProfessionOptional() {\n-        return Optional.ofNullable(this.impl$profession);\n-    }\n-\n-    @Override\n-    public void bridge$setProfession(final Profession profession) {\n-        this.impl$profession = checkNotNull(profession, \"VillagerProfession cannot be null!\");\n-    }\n-\n-    @Override\n-    public void bridge$setCareer(final Career career) {\n-        this.setProfession(((SpongeEntityMetadataType) career.getProfession()).type);\n-        this.buyingList = null;\n-        this.careerId = ((SpongeCareer) career).type + 1;\n-        this.careerLevel = 1;\n-        this.getRecipes(null);\n-    }\n+    @Shadow public abstract VillagerData shadow$getVillagerData();\n \n     /**\n+     * @author i509VCB - Feb 12, 2020 - 1.14.4\n+     * @reason Call trade mutators when adding offers. This covers both Wandering Traders and Villagers.\n+     *\n      * @author gabizou - January 13th, 2016\n      * @reason This overwrites the current method using the multi-dimension array with", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 102}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjQxNg==", "bodyText": "There's no casting going on? What's the comment doing?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236416", "createdAt": "2020-02-14T03:35:07Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/VillagerEntityMixin.java", "diffHunk": "@@ -24,121 +24,74 @@\n  */\n package org.spongepowered.common.mixin.core.entity.merchant.villager;\n \n-import static com.google.common.base.Preconditions.checkNotNull;\n-import static com.google.common.base.Preconditions.checkState;\n-\n+import com.google.common.collect.Sets;\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerData;\n import net.minecraft.entity.merchant.villager.VillagerEntity;\n-import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.inventory.Inventory;\n-import net.minecraft.village.MerchantRecipeList;\n-import org.spongepowered.api.data.type.Career;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n import org.spongepowered.api.data.type.Profession;\n import org.spongepowered.api.entity.living.trader.Villager;\n import org.spongepowered.api.item.merchant.TradeOffer;\n import org.spongepowered.api.item.merchant.TradeOfferGenerator;\n import org.spongepowered.api.item.merchant.VillagerRegistry;\n-import org.spongepowered.asm.mixin.Final;\n import org.spongepowered.asm.mixin.Mixin;\n-import org.spongepowered.asm.mixin.Overwrite;\n import org.spongepowered.asm.mixin.Shadow;\n-import org.spongepowered.asm.mixin.injection.At;\n-import org.spongepowered.asm.mixin.injection.Inject;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n-import org.spongepowered.common.SpongeImplHooks;\n-import org.spongepowered.common.bridge.entity.merchant.villager.VillagerEntityBridge;\n-import org.spongepowered.common.data.type.SpongeEntityMetadataType;\n-import org.spongepowered.common.inventory.lens.impl.collections.SlotLensCollection;\n-import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n import org.spongepowered.common.registry.SpongeVillagerRegistry;\n \n+import java.util.ArrayList;\n import java.util.List;\n-import java.util.Optional;\n-import java.util.Random;\n-\n-import javax.annotation.Nullable;\n+import java.util.Set;\n \n @SuppressWarnings(\"rawtypes\")\n @Mixin(VillagerEntity.class)\n-public abstract class VillagerEntityMixin extends AgeableEntityMixin implements VillagerEntityBridge {\n-\n-    @Shadow private int careerId; // careerId\n-    @Shadow private int careerLevel; // careerLevel\n-    @Shadow @Nullable private MerchantRecipeList buyingList; // buyingList\n-    @Shadow @Final private Inventory villagerInventory; // villagerInventory\n-\n-    @Shadow public abstract void setProfession(int professionId); // setProfession\n-    @Shadow public abstract MerchantRecipeList getRecipes(PlayerEntity player);\n-\n-    @Nullable private Profession impl$profession;\n-\n-    @Inject(method = \"setProfession(I)V\", at = @At(\"RETURN\"))\n-    private void onSetProfession(final int professionId, final CallbackInfo ci) {\n-        this.impl$profession = SpongeImplHooks.validateProfession(professionId);\n+public abstract class VillagerEntityMixin extends AbstractVillagerEntity {\n+    public VillagerEntityMixin() {\n+        super(null, null);\n     }\n \n-    @Override\n-    public Career bridge$getCareer() {\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-        if (this.careerId == 0 || this.careerId > careers.size()) {\n-            this.careerId = new Random().nextInt(careers.size()) + 1;\n-        }\n-        this.getRecipes(null);\n-        return careers.get(this.careerId - 1);\n-    }\n-\n-    @Override\n-    public Optional<Profession> bridge$getProfessionOptional() {\n-        return Optional.ofNullable(this.impl$profession);\n-    }\n-\n-    @Override\n-    public void bridge$setProfession(final Profession profession) {\n-        this.impl$profession = checkNotNull(profession, \"VillagerProfession cannot be null!\");\n-    }\n-\n-    @Override\n-    public void bridge$setCareer(final Career career) {\n-        this.setProfession(((SpongeEntityMetadataType) career.getProfession()).type);\n-        this.buyingList = null;\n-        this.careerId = ((SpongeCareer) career).type + 1;\n-        this.careerLevel = 1;\n-        this.getRecipes(null);\n-    }\n+    @Shadow public abstract VillagerData shadow$getVillagerData();\n \n     /**\n+     * @author i509VCB - Feb 12, 2020 - 1.14.4\n+     * @reason Call trade mutators when adding offers. This covers both Wandering Traders and Villagers.\n+     *\n      * @author gabizou - January 13th, 2016\n      * @reason This overwrites the current method using the multi-dimension array with\n      * our {@link VillagerRegistry} to handle career levels and registrations\n      * for {@link TradeOfferGenerator}s. Note that this takes over entirely\n      * whatever vanilla does, but this allows for maximum customization for\n      * plugins to handle gracefully.\n      */\n-    @SuppressWarnings(\"unchecked\")\n-    @Overwrite\n-    private void populateBuyingList() { // populateBuyingList\n-        // Sponge\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-\n-        // EntityVillager.ITradeList[][][] aentityvillager$itradelist = DEFAULT_TRADE_LIST_MAP[this.getProfession()];\n-\n-        if (this.careerId != 0 && this.careerLevel != 0) {\n-            ++this.careerLevel;\n+    @Override\n+    public void addTrades(MerchantOffers givenMerchantOffers, VillagerTrades.ITrade[] newTrades, int maxNumbers) {\n+        Set<Integer> set = Sets.newHashSet();\n+        if (newTrades.length > maxNumbers) {\n+            while(set.size() < maxNumbers) {\n+                set.add(this.rand.nextInt(newTrades.length));\n+            }\n         } else {\n-            // Sponge change aentityvillager$itradelist to use this.profession.getCareers()\n-            this.careerId = this.rand.nextInt(careers.size()) + 1;\n-            this.careerLevel = 1;\n+            for(int i = 0; i < newTrades.length; ++i) {\n+                set.add(i);\n+            }\n         }\n \n-        if (this.buyingList == null) {\n-            this.buyingList = new MerchantRecipeList();\n+        List<MerchantOffer> newOffers = new ArrayList<>(); // Sponge - Create temporary list to store the new offers\n+\n+        for(Integer integer : set) {\n+            VillagerTrades.ITrade villagertrades$itrade = newTrades[integer];\n+            MerchantOffer merchantoffer = villagertrades$itrade.getOffer(this, this.rand); // Sponge - cast \"this\" to Abstract Villager Entity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjUyMw==", "bodyText": "Could this have been replaced with a Redirect on the addAll?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236523", "createdAt": "2020-02-14T03:35:46Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/VillagerEntityMixin.java", "diffHunk": "@@ -24,121 +24,74 @@\n  */\n package org.spongepowered.common.mixin.core.entity.merchant.villager;\n \n-import static com.google.common.base.Preconditions.checkNotNull;\n-import static com.google.common.base.Preconditions.checkState;\n-\n+import com.google.common.collect.Sets;\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerData;\n import net.minecraft.entity.merchant.villager.VillagerEntity;\n-import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.inventory.Inventory;\n-import net.minecraft.village.MerchantRecipeList;\n-import org.spongepowered.api.data.type.Career;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n import org.spongepowered.api.data.type.Profession;\n import org.spongepowered.api.entity.living.trader.Villager;\n import org.spongepowered.api.item.merchant.TradeOffer;\n import org.spongepowered.api.item.merchant.TradeOfferGenerator;\n import org.spongepowered.api.item.merchant.VillagerRegistry;\n-import org.spongepowered.asm.mixin.Final;\n import org.spongepowered.asm.mixin.Mixin;\n-import org.spongepowered.asm.mixin.Overwrite;\n import org.spongepowered.asm.mixin.Shadow;\n-import org.spongepowered.asm.mixin.injection.At;\n-import org.spongepowered.asm.mixin.injection.Inject;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n-import org.spongepowered.common.SpongeImplHooks;\n-import org.spongepowered.common.bridge.entity.merchant.villager.VillagerEntityBridge;\n-import org.spongepowered.common.data.type.SpongeEntityMetadataType;\n-import org.spongepowered.common.inventory.lens.impl.collections.SlotLensCollection;\n-import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n import org.spongepowered.common.registry.SpongeVillagerRegistry;\n \n+import java.util.ArrayList;\n import java.util.List;\n-import java.util.Optional;\n-import java.util.Random;\n-\n-import javax.annotation.Nullable;\n+import java.util.Set;\n \n @SuppressWarnings(\"rawtypes\")\n @Mixin(VillagerEntity.class)\n-public abstract class VillagerEntityMixin extends AgeableEntityMixin implements VillagerEntityBridge {\n-\n-    @Shadow private int careerId; // careerId\n-    @Shadow private int careerLevel; // careerLevel\n-    @Shadow @Nullable private MerchantRecipeList buyingList; // buyingList\n-    @Shadow @Final private Inventory villagerInventory; // villagerInventory\n-\n-    @Shadow public abstract void setProfession(int professionId); // setProfession\n-    @Shadow public abstract MerchantRecipeList getRecipes(PlayerEntity player);\n-\n-    @Nullable private Profession impl$profession;\n-\n-    @Inject(method = \"setProfession(I)V\", at = @At(\"RETURN\"))\n-    private void onSetProfession(final int professionId, final CallbackInfo ci) {\n-        this.impl$profession = SpongeImplHooks.validateProfession(professionId);\n+public abstract class VillagerEntityMixin extends AbstractVillagerEntity {\n+    public VillagerEntityMixin() {\n+        super(null, null);\n     }\n \n-    @Override\n-    public Career bridge$getCareer() {\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-        if (this.careerId == 0 || this.careerId > careers.size()) {\n-            this.careerId = new Random().nextInt(careers.size()) + 1;\n-        }\n-        this.getRecipes(null);\n-        return careers.get(this.careerId - 1);\n-    }\n-\n-    @Override\n-    public Optional<Profession> bridge$getProfessionOptional() {\n-        return Optional.ofNullable(this.impl$profession);\n-    }\n-\n-    @Override\n-    public void bridge$setProfession(final Profession profession) {\n-        this.impl$profession = checkNotNull(profession, \"VillagerProfession cannot be null!\");\n-    }\n-\n-    @Override\n-    public void bridge$setCareer(final Career career) {\n-        this.setProfession(((SpongeEntityMetadataType) career.getProfession()).type);\n-        this.buyingList = null;\n-        this.careerId = ((SpongeCareer) career).type + 1;\n-        this.careerLevel = 1;\n-        this.getRecipes(null);\n-    }\n+    @Shadow public abstract VillagerData shadow$getVillagerData();\n \n     /**\n+     * @author i509VCB - Feb 12, 2020 - 1.14.4\n+     * @reason Call trade mutators when adding offers. This covers both Wandering Traders and Villagers.\n+     *\n      * @author gabizou - January 13th, 2016\n      * @reason This overwrites the current method using the multi-dimension array with\n      * our {@link VillagerRegistry} to handle career levels and registrations\n      * for {@link TradeOfferGenerator}s. Note that this takes over entirely\n      * whatever vanilla does, but this allows for maximum customization for\n      * plugins to handle gracefully.\n      */\n-    @SuppressWarnings(\"unchecked\")\n-    @Overwrite\n-    private void populateBuyingList() { // populateBuyingList\n-        // Sponge\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-\n-        // EntityVillager.ITradeList[][][] aentityvillager$itradelist = DEFAULT_TRADE_LIST_MAP[this.getProfession()];\n-\n-        if (this.careerId != 0 && this.careerLevel != 0) {\n-            ++this.careerLevel;\n+    @Override\n+    public void addTrades(MerchantOffers givenMerchantOffers, VillagerTrades.ITrade[] newTrades, int maxNumbers) {\n+        Set<Integer> set = Sets.newHashSet();\n+        if (newTrades.length > maxNumbers) {\n+            while(set.size() < maxNumbers) {\n+                set.add(this.rand.nextInt(newTrades.length));\n+            }\n         } else {\n-            // Sponge change aentityvillager$itradelist to use this.profession.getCareers()\n-            this.careerId = this.rand.nextInt(careers.size()) + 1;\n-            this.careerLevel = 1;\n+            for(int i = 0; i < newTrades.length; ++i) {\n+                set.add(i);\n+            }\n         }\n \n-        if (this.buyingList == null) {\n-            this.buyingList = new MerchantRecipeList();\n+        List<MerchantOffer> newOffers = new ArrayList<>(); // Sponge - Create temporary list to store the new offers\n+\n+        for(Integer integer : set) {\n+            VillagerTrades.ITrade villagertrades$itrade = newTrades[integer];\n+            MerchantOffer merchantoffer = villagertrades$itrade.getOffer(this, this.rand); // Sponge - cast \"this\" to Abstract Villager Entity\n+            if (merchantoffer != null) {\n+                // Sponge - Add to newOffers list instead\n+                //givenMerchantOffers.add(merchantoffer);\n+                newOffers.add(merchantoffer);\n+            }\n         }\n \n-        // Sponge start - use our own registry stuffs\n-        checkState(this.careerId <= careers.size(), \"The villager career id is out of bounds fo the available Careers! Found: \" + this.careerId\n-                                                    + \" when the current maximum is: \" + careers.size());\n-        final Career careerLevel = careers.get(this.careerId - 1);\n-        SpongeVillagerRegistry.getInstance().populateOffers((Villager) this, (List<TradeOffer>) (List<?>) this.buyingList, careerLevel, this.careerLevel, this.rand);\n-        // Sponge end\n+        // Sponge - start - fire off the trade offer mutators for the new trades\n+        SpongeVillagerRegistry.getInstance().populateOffers((Villager) this, (List<TradeOffer>) (List<?>) newOffers, (Profession) this.shadow$getVillagerData().getProfession(), this.shadow$getVillagerData().getLevel(), this.rand);\n+        givenMerchantOffers.addAll(newOffers); // Finally add the mutated offers to the trade offer map.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 156}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNjk3Nw==", "bodyText": "Let me think about this change, because it might be possible to pass in a copy of the MerchantOffers at the head of the method (by using a @ModifyVariable and doing an injection at the end of the method, allowing us to throw a \"here's a copy of the changes\", or even redirecting the add() to add to our own list, and then at the tail, doing the event processing.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379236977", "createdAt": "2020-02-14T03:38:17Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/VillagerEntityMixin.java", "diffHunk": "@@ -24,121 +24,74 @@\n  */\n package org.spongepowered.common.mixin.core.entity.merchant.villager;\n \n-import static com.google.common.base.Preconditions.checkNotNull;\n-import static com.google.common.base.Preconditions.checkState;\n-\n+import com.google.common.collect.Sets;\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerData;\n import net.minecraft.entity.merchant.villager.VillagerEntity;\n-import net.minecraft.entity.player.PlayerEntity;\n-import net.minecraft.inventory.Inventory;\n-import net.minecraft.village.MerchantRecipeList;\n-import org.spongepowered.api.data.type.Career;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n import org.spongepowered.api.data.type.Profession;\n import org.spongepowered.api.entity.living.trader.Villager;\n import org.spongepowered.api.item.merchant.TradeOffer;\n import org.spongepowered.api.item.merchant.TradeOfferGenerator;\n import org.spongepowered.api.item.merchant.VillagerRegistry;\n-import org.spongepowered.asm.mixin.Final;\n import org.spongepowered.asm.mixin.Mixin;\n-import org.spongepowered.asm.mixin.Overwrite;\n import org.spongepowered.asm.mixin.Shadow;\n-import org.spongepowered.asm.mixin.injection.At;\n-import org.spongepowered.asm.mixin.injection.Inject;\n-import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n-import org.spongepowered.common.SpongeImplHooks;\n-import org.spongepowered.common.bridge.entity.merchant.villager.VillagerEntityBridge;\n-import org.spongepowered.common.data.type.SpongeEntityMetadataType;\n-import org.spongepowered.common.inventory.lens.impl.collections.SlotLensCollection;\n-import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n import org.spongepowered.common.registry.SpongeVillagerRegistry;\n \n+import java.util.ArrayList;\n import java.util.List;\n-import java.util.Optional;\n-import java.util.Random;\n-\n-import javax.annotation.Nullable;\n+import java.util.Set;\n \n @SuppressWarnings(\"rawtypes\")\n @Mixin(VillagerEntity.class)\n-public abstract class VillagerEntityMixin extends AgeableEntityMixin implements VillagerEntityBridge {\n-\n-    @Shadow private int careerId; // careerId\n-    @Shadow private int careerLevel; // careerLevel\n-    @Shadow @Nullable private MerchantRecipeList buyingList; // buyingList\n-    @Shadow @Final private Inventory villagerInventory; // villagerInventory\n-\n-    @Shadow public abstract void setProfession(int professionId); // setProfession\n-    @Shadow public abstract MerchantRecipeList getRecipes(PlayerEntity player);\n-\n-    @Nullable private Profession impl$profession;\n-\n-    @Inject(method = \"setProfession(I)V\", at = @At(\"RETURN\"))\n-    private void onSetProfession(final int professionId, final CallbackInfo ci) {\n-        this.impl$profession = SpongeImplHooks.validateProfession(professionId);\n+public abstract class VillagerEntityMixin extends AbstractVillagerEntity {\n+    public VillagerEntityMixin() {\n+        super(null, null);\n     }\n \n-    @Override\n-    public Career bridge$getCareer() {\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-        if (this.careerId == 0 || this.careerId > careers.size()) {\n-            this.careerId = new Random().nextInt(careers.size()) + 1;\n-        }\n-        this.getRecipes(null);\n-        return careers.get(this.careerId - 1);\n-    }\n-\n-    @Override\n-    public Optional<Profession> bridge$getProfessionOptional() {\n-        return Optional.ofNullable(this.impl$profession);\n-    }\n-\n-    @Override\n-    public void bridge$setProfession(final Profession profession) {\n-        this.impl$profession = checkNotNull(profession, \"VillagerProfession cannot be null!\");\n-    }\n-\n-    @Override\n-    public void bridge$setCareer(final Career career) {\n-        this.setProfession(((SpongeEntityMetadataType) career.getProfession()).type);\n-        this.buyingList = null;\n-        this.careerId = ((SpongeCareer) career).type + 1;\n-        this.careerLevel = 1;\n-        this.getRecipes(null);\n-    }\n+    @Shadow public abstract VillagerData shadow$getVillagerData();\n \n     /**\n+     * @author i509VCB - Feb 12, 2020 - 1.14.4\n+     * @reason Call trade mutators when adding offers. This covers both Wandering Traders and Villagers.\n+     *\n      * @author gabizou - January 13th, 2016\n      * @reason This overwrites the current method using the multi-dimension array with\n      * our {@link VillagerRegistry} to handle career levels and registrations\n      * for {@link TradeOfferGenerator}s. Note that this takes over entirely\n      * whatever vanilla does, but this allows for maximum customization for\n      * plugins to handle gracefully.\n      */\n-    @SuppressWarnings(\"unchecked\")\n-    @Overwrite\n-    private void populateBuyingList() { // populateBuyingList\n-        // Sponge\n-        final List<Career> careers = (List<Career>) this.impl$profession.getCareers();\n-\n-        // EntityVillager.ITradeList[][][] aentityvillager$itradelist = DEFAULT_TRADE_LIST_MAP[this.getProfession()];\n-\n-        if (this.careerId != 0 && this.careerLevel != 0) {\n-            ++this.careerLevel;\n+    @Override\n+    public void addTrades(MerchantOffers givenMerchantOffers, VillagerTrades.ITrade[] newTrades, int maxNumbers) {\n+        Set<Integer> set = Sets.newHashSet();\n+        if (newTrades.length > maxNumbers) {\n+            while(set.size() < maxNumbers) {\n+                set.add(this.rand.nextInt(newTrades.length));\n+            }\n         } else {\n-            // Sponge change aentityvillager$itradelist to use this.profession.getCareers()\n-            this.careerId = this.rand.nextInt(careers.size()) + 1;\n-            this.careerLevel = 1;\n+            for(int i = 0; i < newTrades.length; ++i) {\n+                set.add(i);\n+            }\n         }\n \n-        if (this.buyingList == null) {\n-            this.buyingList = new MerchantRecipeList();\n+        List<MerchantOffer> newOffers = new ArrayList<>(); // Sponge - Create temporary list to store the new offers\n+\n+        for(Integer integer : set) {\n+            VillagerTrades.ITrade villagertrades$itrade = newTrades[integer];\n+            MerchantOffer merchantoffer = villagertrades$itrade.getOffer(this, this.rand); // Sponge - cast \"this\" to Abstract Villager Entity\n+            if (merchantoffer != null) {\n+                // Sponge - Add to newOffers list instead\n+                //givenMerchantOffers.add(merchantoffer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 143}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNzAyNg==", "bodyText": "Change method name with prefix.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379237026", "createdAt": "2020-02-14T03:38:33Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/monster/EndermanEntity_PlaceBlockGoalMixin.java", "diffHunk": "@@ -63,24 +63,25 @@\n      * @author gabizou - July 26th, 2018\n      * @reason Adds sanity check for calling a change block event pre\n      *\n-     * @param entityEnderman The enderman doing griefing\n+     * @param endermanEntity The enderman doing griefing\n      * @return The block state that can be placed, or null if the enderman can't grief\n      */\n     @Redirect(\n         method = \"shouldExecute\",\n         at = @At(\n             value = \"INVOKE\",\n-            target = \"Lnet/minecraft/entity/monster/EntityEnderman;getHeldBlockState()Lnet/minecraft/block/state/IBlockState;\"\n+            target = \"Lnet/minecraft/entity/monster/EndermanEntity;getHeldBlockState()Lnet/minecraft/block/BlockState;\"\n         )\n     )\n     @Nullable\n-    private BlockState onCanGrief(final EndermanEntity entityEnderman) {\n-        final BlockState heldBlockState = entityEnderman.getHeldBlockState();\n+    private BlockState onCanGrief(final EndermanEntity endermanEntity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNzEwOQ==", "bodyText": "Multiline this annotation. Also, is it required to have all the parameters?", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379237109", "createdAt": "2020-02-14T03:38:59Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/monster/EndermanEntity_PlaceBlockGoalMixin.java", "diffHunk": "@@ -92,10 +93,10 @@ private BlockState onCanGrief(final EndermanEntity entityEnderman) {\n      * @param state The new state\n      * @return True if the state is a full cube, and the event didnt get cancelled\n      */\n-    @Redirect(method = \"canPlaceBlock\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/state/IBlockState;isFullCube()Z\"))\n+    @Redirect(method = \"func_220836_a(Lnet/minecraft/world/IWorldReader;Lnet/minecraft/util/math/BlockPos;Lnet/minecraft/block/BlockState;Lnet/minecraft/block/BlockState;Lnet/minecraft/block/BlockState;Lnet/minecraft/util/math/BlockPos;)Z\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/state/IBlockState;isFullCube()Z\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNzIzMQ==", "bodyText": "Fix method name with prefix..", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379237231", "createdAt": "2020-02-14T03:39:41Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/monster/SilverfishEntity_HideInStoneGoalMixin.java", "diffHunk": "@@ -42,7 +42,7 @@ public SilverfishEntity_HideInStoneGoalMixin(CreatureEntity creatureIn, double s\n     }\n \n     @Redirect(method = \"shouldExecute\",\n-        at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/BlockSilverfish;canContainSilverfish(Lnet/minecraft/block/state/IBlockState;)Z\"))\n+        at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/block/SilverfishBlock;canContainSilverfish(Lnet/minecraft/block/BlockState;)Z\"))\n     private boolean onCanGrief(final BlockState blockState) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNzMyNA==", "bodyText": "Might want to multi-line.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379237324", "createdAt": "2020-02-14T03:40:20Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/projectile/ThrowableEntityMixin.java", "diffHunk": "@@ -61,9 +61,9 @@\n         ProjectileSourceSerializer.writeSourceToNbt(compound, ((Projectile) this).getShooter(), this.thrower);\n     }\n \n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/projectile/EntityThrowable;onImpact(Lnet/minecraft/util/math/RayTraceResult;)V\"))\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/projectile/ThrowableEntity;onImpact(Lnet/minecraft/util/math/RayTraceResult;)V\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNzM0NQ==", "bodyText": "Change method name and prefix..", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379237345", "createdAt": "2020-02-14T03:40:27Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/projectile/ThrowableEntityMixin.java", "diffHunk": "@@ -61,9 +61,9 @@\n         ProjectileSourceSerializer.writeSourceToNbt(compound, ((Projectile) this).getShooter(), this.thrower);\n     }\n \n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/projectile/EntityThrowable;onImpact(Lnet/minecraft/util/math/RayTraceResult;)V\"))\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/projectile/ThrowableEntity;onImpact(Lnet/minecraft/util/math/RayTraceResult;)V\"))\n     public void onProjectileImpact(ThrowableEntity projectile, RayTraceResult movingObjectPosition) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzNzQ5NQ==", "bodyText": "TODO will need to change to a SpongeImplHooks.isMainThread or WorldBridge.bridge$isFake() for the world.isRemote.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r379237495", "createdAt": "2020-02-14T03:41:14Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/projectile/ThrowableEntityMixin.java", "diffHunk": "@@ -61,9 +61,9 @@\n         ProjectileSourceSerializer.writeSourceToNbt(compound, ((Projectile) this).getShooter(), this.thrower);\n     }\n \n-    @Redirect(method = \"onUpdate\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/projectile/EntityThrowable;onImpact(Lnet/minecraft/util/math/RayTraceResult;)V\"))\n+    @Redirect(method = \"tick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/projectile/ThrowableEntity;onImpact(Lnet/minecraft/util/math/RayTraceResult;)V\"))\n     public void onProjectileImpact(ThrowableEntity projectile, RayTraceResult movingObjectPosition) {\n-        if (this.world.isRemote || movingObjectPosition.typeOfHit == RayTraceResult.Type.MISS) {\n+        if (this.world.isRemote || movingObjectPosition.getType() == RayTraceResult.Type.MISS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/28e7257e4dae66eaae78d8cae681fc70e99a5ef9", "committedDate": "2020-02-13T01:00:23Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}, "afterCommit": {"oid": "a9896ac8e37b1b0f38a79fbb4d01272c7767ab1d", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/a9896ac8e37b1b0f38a79fbb4d01272c7767ab1d", "committedDate": "2020-02-18T04:04:11Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9896ac8e37b1b0f38a79fbb4d01272c7767ab1d", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/a9896ac8e37b1b0f38a79fbb4d01272c7767ab1d", "committedDate": "2020-02-18T04:04:11Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}, "afterCommit": {"oid": "735f108ed788a97a7a8309ee70453e48fdcf0594", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/735f108ed788a97a7a8309ee70453e48fdcf0594", "committedDate": "2020-02-18T04:05:28Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "735f108ed788a97a7a8309ee70453e48fdcf0594", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/735f108ed788a97a7a8309ee70453e48fdcf0594", "committedDate": "2020-02-18T04:05:28Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}, "afterCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/92a4e950408beab4785ef89b99ea8115af0e1d54", "committedDate": "2020-02-19T01:07:51Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNDAxMjI2", "url": "https://github.com/SpongePowered/Sponge/pull/2503#pullrequestreview-362401226", "createdAt": "2020-02-21T05:04:04Z", "commit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwNTowNDowNFrOFsryrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwNToyMjo1MlrOFssAMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5OTE0OA==", "bodyText": "extra spaces unnecessary", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382399148", "createdAt": "2020-02-21T05:04:04Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -152,47 +143,61 @@\n     @Shadow public int fire;\n     @Shadow public int hurtResistantTime;\n     @Shadow protected EntityDataManager dataManager;\n-    @Shadow public int dimension;\n+    @Shadow public DimensionType dimension;\n     @Shadow private boolean invulnerable;\n-\n-    @Shadow public abstract void setPosition(double x, double y, double z);\n-    @Shadow public abstract void setDead();\n-    @Shadow public abstract int getAir();\n-    @Shadow public abstract void setAir(int air);\n-    @Shadow public abstract float getEyeHeight();\n-    @Shadow public abstract void setCustomNameTag(String name);\n-    @Shadow public abstract UUID getUniqueID();\n-    @Shadow public abstract AxisAlignedBB getEntityBoundingBox();\n-    @Shadow public abstract void setFire(int seconds);\n-    @Shadow public abstract CompoundNBT writeToNBT(CompoundNBT compound);\n+    @Shadow @Final private EntityType<?> type;\n+\n+    @Shadow public abstract void shadow$remove();\n+    @Shadow public abstract int shadow$getAir();\n+    @Shadow public abstract void shadow$setAir(int air);\n+    @Shadow public abstract void shadow$setCustomName(@Nullable ITextComponent name);\n+    @Shadow public abstract UUID shadow$getUniqueID();\n+    @Shadow public abstract AxisAlignedBB shadow$getBoundingBox();\n+    @Shadow public abstract void shadow$setFire(int seconds);\n     @Shadow public abstract boolean attackEntityFrom(DamageSource source, float amount);\n-    @Shadow public abstract int getEntityId();\n-    @Shadow public abstract boolean isBeingRidden();\n-    @Shadow public abstract SoundCategory getSoundCategory();\n-    @Shadow public abstract List<Entity> shadow$getPassengers();\n+    @Shadow public abstract int shadow$getEntityId();\n+    @Shadow public abstract boolean shadow$isBeingRidden();\n     @Shadow public abstract Entity getRidingEntity();\n-    @Shadow public abstract void setItemStackToSlot(EquipmentSlotType slotIn, ItemStack stack);\n-    @Shadow public abstract void playSound(SoundEvent soundIn, float volume, float pitch);\n-    @Shadow public abstract boolean isEntityInvulnerable(DamageSource source);\n-    @Shadow public abstract boolean isSprinting();\n-    @Shadow public abstract boolean shadow$isInWater();\n-    @Shadow public abstract boolean isRiding();\n-    @Shadow public abstract boolean isOnSameTeam(Entity entityIn);\n-    @Shadow public abstract double getDistanceSq(Entity entityIn);\n+    @Shadow public abstract void shadow$playSound(SoundEvent soundIn, float volume, float pitch);\n     @Shadow public abstract void setLocationAndAngles(double x, double y, double z, float yaw, float pitch);\n-    @Shadow public abstract void setPositionAndUpdate(double x, double y, double z);\n-    @Shadow protected abstract void removePassenger(Entity passenger);\n-    @Shadow protected abstract void setSize(float width, float height);\n-    @Shadow protected abstract void applyEnchantments(LivingEntity entityLivingBaseIn, Entity entityIn);\n-    @Shadow public abstract void extinguish();\n-    @Shadow protected abstract void setFlag(int flag, boolean set);\n-    @Shadow @Nullable public Entity changeDimension(final int dimension) { return null; } // Shadow\n-    @Shadow public abstract boolean isInvisible();\n-    @Shadow public abstract void setInvisible(boolean invisible);\n-    @Shadow public abstract int getMaxAir();\n-    @Shadow protected abstract int getFireImmuneTicks();\n-\n-    private int customFireImmuneTicks = this.getFireImmuneTicks();\n+    @Shadow protected abstract void shadow$removePassenger(Entity passenger);\n+    @Shadow @Nullable public Entity shadow$changeDimension(DimensionType dimension) { return null; } // Shadow\n+    @Shadow public abstract boolean shadow$isInvisible();\n+    @Shadow public abstract void shadow$setInvisible(boolean invisible);\n+    @Shadow protected abstract int shadow$getFireImmuneTicks();\n+    @Shadow public abstract EntityType<?> shadow$getType();\n+    @Shadow public abstract boolean shadow$isInvulnerableTo(DamageSource source);\n+    @Shadow public abstract float shadow$getEyeHeight();\n+    @Shadow protected abstract void shadow$setFlag(int flag, boolean set);\n+    @Shadow public abstract void shadow$extinguish();\n+    @Shadow public abstract void shadow$setPosition(double x, double y, double z);\n+    @Shadow public abstract void shadow$setMotion(Vec3d motionIn);\n+    @Shadow public abstract void shadow$setMotion(double x, double y, double z);\n+    @Shadow public abstract boolean shadow$isSprinting();\n+    @Shadow public abstract Vec3d shadow$getMotion();\n+    @Shadow public abstract boolean shadow$isOnSameTeam(Entity entityIn);\n+    @Shadow public abstract double shadow$getDistanceSq(Entity entityIn);\n+    @Shadow @Nullable public abstract ItemEntity shadow$entityDropItem(IItemProvider itemIn, int offset);\n+    @Shadow public abstract boolean shadow$isInWater();\n+    @Shadow public abstract boolean shadow$isPassenger();\n+    @Shadow @Nullable public abstract Team shadow$getTeam();\n+\n+    @Shadow public abstract void shadow$setPositionAndUpdate(double x, double y, double z);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM5OTc3NQ==", "bodyText": "I see, I stand corrected. I was vaguely remembering timings to be instanced based on the bridge interface separate from the targeted bridges, but that's a separate story", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382399775", "createdAt": "2020-02-21T05:07:49Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/EntityMixin.java", "diffHunk": "@@ -754,12 +741,12 @@ public ItemEntity entityDropItem(final ItemStack stack, final float offsetY) {\n     @Nullable\n     @Override\n     public BlockPos bridge$getLastCollidedBlockPos() {\n-        return this.lastCollidedBlockPos;\n+        return this.impl$lastCollidedBlockPos;\n     }\n \n     @Override\n     public Timing bridge$getTimingsHandler() {\n-        return this.entityType.getTimingsHandler();\n+        return ((EntityTypeBridge) this.shadow$getType()).bridge$getTimings();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTIzMzU5Nw=="}, "originalCommit": {"oid": "28e7257e4dae66eaae78d8cae681fc70e99a5ef9"}, "originalPosition": 390}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMDE4OA==", "bodyText": "Yes, but that can be put up as an issue to remind us later.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382400188", "createdAt": "2020-02-21T05:10:09Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/AbstractVillagerEntityMixin.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * This file is part of Sponge, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.common.mixin.core.entity.merchant.villager;\n+\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n+import org.spongepowered.api.data.type.Profession;\n+import org.spongepowered.api.entity.living.trader.Villager;\n+import org.spongepowered.api.item.merchant.TradeOffer;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.Redirect;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n+import org.spongepowered.common.registry.SpongeVillagerRegistry;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Mixin(AbstractVillagerEntity.class)\n+public abstract class AbstractVillagerEntityMixin extends AgeableEntityMixin {\n+    private List<MerchantOffer> impl$newOffers = new ArrayList<>();\n+\n+    /**\n+     * @author i509VCB - February 17th, 2020 - 1.14.4\n+     *\n+     * @reason Here we apply the Trade Mutators. For a villager we will apply our mutators and then add them to the villager's merchant offers.\n+     * If a wandering trader is the subject here, we do nothing since that merchant would already have it's new merchant offers.\n+     *\n+     * @todo: Do we want to support Trade Mutators on Wandering Trader's TradeOffers?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMDU1Ng==", "bodyText": "So there's a bit of a elegant hack to doing this:\nYou can redirect to do the same as the original method, and then override this injection method in VillagerEntityMixin to do all this logic that otherwise you'd be doing.\nI do this with WorldMixin_Tracker and ServerWorldMixin_Tracker to do extra logic only on server worlds for injections that are in the subclass.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382400556", "createdAt": "2020-02-21T05:12:04Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/AbstractVillagerEntityMixin.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * This file is part of Sponge, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.common.mixin.core.entity.merchant.villager;\n+\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n+import org.spongepowered.api.data.type.Profession;\n+import org.spongepowered.api.entity.living.trader.Villager;\n+import org.spongepowered.api.item.merchant.TradeOffer;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.Redirect;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n+import org.spongepowered.common.registry.SpongeVillagerRegistry;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Mixin(AbstractVillagerEntity.class)\n+public abstract class AbstractVillagerEntityMixin extends AgeableEntityMixin {\n+    private List<MerchantOffer> impl$newOffers = new ArrayList<>();\n+\n+    /**\n+     * @author i509VCB - February 17th, 2020 - 1.14.4\n+     *\n+     * @reason Here we apply the Trade Mutators. For a villager we will apply our mutators and then add them to the villager's merchant offers.\n+     * If a wandering trader is the subject here, we do nothing since that merchant would already have it's new merchant offers.\n+     *\n+     * @todo: Do we want to support Trade Mutators on Wandering Trader's TradeOffers?\n+     *\n+     * @param givenMerchantOffers The merchant's current merchant offers.\n+     * @param newTrades The trade factories representing the new trades this villager will receive.\n+     * @param maxNumbers The maximum amount of trades for this villager to receive.\n+     * @param ci CallbackInfo.\n+     */\n+    @Inject(method = \"addTrades(Lnet/minecraft/item/MerchantOffers;[Lnet/minecraft/entity/merchant/villager/VillagerTrades$ITrade;I)V\", at = @At(\"TAIL\"))\n+    private void impl$addAndApplyTradeMutators(MerchantOffers givenMerchantOffers, VillagerTrades.ITrade[] newTrades, int maxNumbers, CallbackInfo ci) {\n+        if ((Object) this instanceof VillagerEntity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMDYzNA==", "bodyText": "Same with this, if the logic is specific to VillagerEntity, it can be overridden in the mixin", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382400634", "createdAt": "2020-02-21T05:12:29Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/merchant/villager/AbstractVillagerEntityMixin.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * This file is part of Sponge, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.common.mixin.core.entity.merchant.villager;\n+\n+import net.minecraft.entity.merchant.villager.AbstractVillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerEntity;\n+import net.minecraft.entity.merchant.villager.VillagerTrades;\n+import net.minecraft.item.MerchantOffer;\n+import net.minecraft.item.MerchantOffers;\n+import org.spongepowered.api.data.type.Profession;\n+import org.spongepowered.api.entity.living.trader.Villager;\n+import org.spongepowered.api.item.merchant.TradeOffer;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.Redirect;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+import org.spongepowered.common.mixin.core.entity.AgeableEntityMixin;\n+import org.spongepowered.common.registry.SpongeVillagerRegistry;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+@Mixin(AbstractVillagerEntity.class)\n+public abstract class AbstractVillagerEntityMixin extends AgeableEntityMixin {\n+    private List<MerchantOffer> impl$newOffers = new ArrayList<>();\n+\n+    /**\n+     * @author i509VCB - February 17th, 2020 - 1.14.4\n+     *\n+     * @reason Here we apply the Trade Mutators. For a villager we will apply our mutators and then add them to the villager's merchant offers.\n+     * If a wandering trader is the subject here, we do nothing since that merchant would already have it's new merchant offers.\n+     *\n+     * @todo: Do we want to support Trade Mutators on Wandering Trader's TradeOffers?\n+     *\n+     * @param givenMerchantOffers The merchant's current merchant offers.\n+     * @param newTrades The trade factories representing the new trades this villager will receive.\n+     * @param maxNumbers The maximum amount of trades for this villager to receive.\n+     * @param ci CallbackInfo.\n+     */\n+    @Inject(method = \"addTrades(Lnet/minecraft/item/MerchantOffers;[Lnet/minecraft/entity/merchant/villager/VillagerTrades$ITrade;I)V\", at = @At(\"TAIL\"))\n+    private void impl$addAndApplyTradeMutators(MerchantOffers givenMerchantOffers, VillagerTrades.ITrade[] newTrades, int maxNumbers, CallbackInfo ci) {\n+        if ((Object) this instanceof VillagerEntity) {\n+            VillagerEntity villager = (VillagerEntity) (Object) this;\n+            SpongeVillagerRegistry.getInstance().populateOffers((Villager) this, (List<TradeOffer>) (List<?>) impl$newOffers, (Profession) villager.getVillagerData().getProfession(), villager.getVillagerData().getLevel(), this.rand);\n+            givenMerchantOffers.addAll(this.impl$newOffers); // Finally add the mutated offers to the trade offer map.\n+            this.impl$newOffers.clear(); // And clean up our temp values\n+        }\n+    }\n+\n+    /**\n+     * @author i509VCB - February 17th, 2020 - 1.14.4\n+     *\n+     * @reason In order to apply the Trade mutators, we need to redirect addition to the MerchantOffers till the all offers have been \"created\".\n+     * @param merchantOffers The current offers the villager has.\n+     * @param offer The merchant offer to add.\n+     * @return true.\n+     */\n+    @Redirect(method = \"addTrades(Lnet/minecraft/item/MerchantOffers;[Lnet/minecraft/entity/merchant/villager/VillagerTrades$ITrade;I)V\",\n+        at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/item/MerchantOffers;add(Lnet/minecraft/item/MerchantOffer;)Z\")\n+    )\n+    private boolean impl$addNewOfferToTempMap(MerchantOffers merchantOffers, MerchantOffer offer) {\n+        if ((Object) this instanceof VillagerEntity) { // Currently only villagers support trade mutators.\n+            return this.impl$newOffers.add(offer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMDc2NQ==", "bodyText": "The constant here should be shoved into the related (or new) Constants nested class.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382400765", "createdAt": "2020-02-21T05:13:18Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/monster/CreeperEntityMixin.java", "diffHunk": "@@ -55,15 +57,15 @@\n     @Shadow private int fuseTime;\n     @Shadow private int explosionRadius;\n \n-    @Shadow public abstract void ignite();\n-    @Shadow public abstract int getCreeperState();\n-    @Shadow public abstract void setCreeperState(int state);\n-    @Shadow private void explode() { } // explode\n+    @Shadow public abstract void shadow$ignite();\n+    @Shadow public abstract int shadow$getCreeperState();\n+    @Shadow public abstract void shadow$setCreeperState(int state);\n+    @Shadow private void shadow$explode() { } // explode\n \n-    private int fuseDuration = 30;\n-    private boolean interactPrimeCancelled;\n-    private boolean stateDirty;\n-    private boolean detonationCancelled;\n+    private int impl$fuseDuration = 30;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMDgxNw==", "bodyText": "Fix the method name/prefixing here please", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382400817", "createdAt": "2020-02-21T05:13:42Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/monster/CreeperEntityMixin.java", "diffHunk": "@@ -147,36 +149,39 @@ private void postStateChange(final int state, final CallbackInfo ci) {\n                 .shouldPlaySmoke(smoking)\n                 .shouldBreakBlocks(smoking && ((GrieferBridge) this).bridge$canGrief()))\n                 .orElseGet(() -> {\n-                    this.detonationCancelled = true;\n+                    this.impl$detonationCancelled = true;\n                     return null;\n                 });\n     }\n \n     @Inject(method = \"explode\", at = @At(\"RETURN\"))\n     private void postExplode(final CallbackInfo ci) {\n-        if (this.detonationCancelled) {\n-            this.detonationCancelled = this.isDead = false;\n+        if (this.impl$detonationCancelled) {\n+            this.impl$detonationCancelled = this.isDead = false;\n         }\n     }\n \n-    @Redirect(method = \"processInteract\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/monster/EntityCreeper;ignite()V\"))\n+    @Redirect(method = \"processInteract\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/monster/CreeperEntity;ignite()V\"))\n     private void onInteractIgnite(final CreeperEntity self) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMTMyMg==", "bodyText": "Space between shadow and non-shadow fields please", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382401322", "createdAt": "2020-02-21T05:16:17Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/player/PlayerEntityMixin.java", "diffHunk": "@@ -130,46 +129,47 @@\n     @Shadow public int experienceLevel;\n     @Shadow public int experienceTotal;\n     @Shadow public float experience;\n-    @Shadow public PlayerAbilities capabilities;\n+    @Shadow public PlayerAbilities abilities;\n     @Shadow public net.minecraft.entity.player.PlayerInventory inventory;\n-    @Shadow public BlockPos bedLocation;\n-\n-    @Shadow public abstract boolean isPlayerSleeping();\n-    @Shadow public abstract boolean isSpectator();\n-    @Shadow public abstract int xpBarCap();\n-    @Shadow public abstract float getCooledAttackStrength(float adjustTicks);\n-    @Shadow public abstract float getAIMoveSpeed();\n-    @Shadow public abstract void onCriticalHit(net.minecraft.entity.Entity entityHit);\n-    @Shadow public abstract void onEnchantmentCritical(net.minecraft.entity.Entity entityHit); // onEnchantmentCritical\n-    @Shadow public abstract void addExhaustion(float p_71020_1_);\n-    @Shadow public abstract void addStat(@Nullable Stat stat, int amount);\n-    @Shadow public abstract void addStat(Stat stat);\n-    @Shadow public abstract void resetCooldown();\n-    @Shadow public abstract void spawnSweepParticles(); //spawnSweepParticles()\n-    @Shadow public abstract void takeStat(Stat stat);\n-    @Shadow protected abstract void destroyVanishingCursedItems(); // Filter vanishing curse enchanted items\n-    @Shadow public void wakeUpPlayer(final boolean immediately, final boolean updateWorldFlag, final boolean setSpawn) {};\n-    @Shadow @Nullable public abstract ItemEntity dropItem(boolean dropAll); // Overridden in EntityPlayerMPMixin for tracking\n-    @Shadow public abstract FoodStats getFoodStats();\n-    @Shadow public abstract GameProfile getGameProfile();\n-    @Shadow public abstract Scoreboard getWorldScoreboard();\n-    @Shadow public abstract String shadow$getName();\n-    @Shadow @Nullable public abstract Team getTeam();\n-    @Shadow public abstract void addExperienceLevel(int levels);\n-    @Shadow public abstract void addScore(int scoreIn);\n-\n-    @Shadow protected abstract void spawnShoulderEntities();\n-    @Shadow public abstract boolean isCreative();\n-\n-    @Shadow public boolean canAttackPlayer(final PlayerEntity other) {\n+    @Shadow public BlockPos spawnPos;\n+\n+    @Shadow public abstract boolean shadow$isSpectator();\n+    @Shadow public abstract int shadow$xpBarCap();\n+    @Shadow public abstract float shadow$getCooledAttackStrength(float adjustTicks);\n+    @Shadow public abstract float shadow$getAIMoveSpeed();\n+    @Shadow public abstract void shadow$onCriticalHit(net.minecraft.entity.Entity entityHit);\n+    @Shadow public abstract void shadow$onEnchantmentCritical(net.minecraft.entity.Entity entityHit); // onEnchantmentCritical\n+    @Shadow public abstract void shadow$addExhaustion(float p_71020_1_);\n+    @Shadow public abstract void shadow$addStat(ResourceLocation stat, int amount);\n+    @Shadow public abstract void shadow$addStat(@Nullable Stat stat, int amount);\n+    @Shadow public abstract void shadow$addStat(ResourceLocation stat);\n+    @Shadow public abstract void shadow$resetCooldown();\n+    @Shadow public abstract void shadow$spawnSweepParticles(); //spawnSweepParticles()\n+    @Shadow public abstract void shadow$takeStat(Stat stat);\n+    @Shadow protected abstract void shadow$destroyVanishingCursedItems(); // Filter vanishing curse enchanted items\n+    @Shadow public void shadow$wakeUpPlayer(final boolean immediately, final boolean updateWorldFlag, final boolean setSpawn) {};\n+    @Shadow @Nullable public abstract ItemEntity shadow$dropItem(boolean dropAll); // Overridden in EntityPlayerMPMixin for tracking\n+    @Shadow @Nullable public abstract ItemEntity shadow$dropItem(final ItemStack droppedItem, final boolean dropAround, final boolean traceItem);\n+    @Shadow public abstract FoodStats shadow$getFoodStats();\n+    @Shadow public abstract GameProfile shadow$getGameProfile();\n+    @Shadow public abstract Scoreboard shadow$getWorldScoreboard();\n+    @Shadow public abstract void shadow$addExperienceLevel(int levels);\n+    @Shadow public abstract void shadow$addScore(int scoreIn);\n+    @Shadow protected abstract void shadow$spawnShoulderEntities();\n+    @Shadow public abstract boolean shadow$isCreative();\n+    @Shadow public boolean shadow$canAttackPlayer(final PlayerEntity other) {\n         return false;\n     }\n+    @Shadow public abstract SoundCategory shadow$getSoundCategory();\n \n-    private boolean affectsSpawning = true;\n-    private Vector3d targetedLocation = VecHelper.toVector3d(this.world.getSpawnPoint());\n-    private boolean dontRecalculateExperience;\n-    private boolean shouldRestoreInventory = false;\n-    protected final boolean isFake = SpongeImplHooks.isFakePlayer((PlayerEntity) (Object) this);\n+    @Shadow public abstract String shadow$getScoreboardName();\n+\n+    @Shadow public Container openContainer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMTkwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Redirect(method = \"canPlayerEdit\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/item/ItemStack;canPlaceOn(Lnet/minecraft/tags/NetworkTagManager;Lnet/minecraft/util/CachedBlockInfo;)Z\"))\n          \n          \n            \n                @Redirect(method = \"canPlayerEdit\",\n          \n          \n            \n                    at = @At(value = \"INVOKE\", \n          \n          \n            \n                        target = \"Lnet/minecraft/item/ItemStack;canPlaceOn(Lnet/minecraft/tags/NetworkTagManager;Lnet/minecraft/util/CachedBlockInfo;)Z\"))", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382401906", "createdAt": "2020-02-21T05:19:00Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/player/PlayerEntityMixin.java", "diffHunk": "@@ -407,20 +406,21 @@ private void spongePlaySound(final World world, final PlayerEntity player, final\n      * however, sometimes that isn't enough.\n      *\n      * @param stack The item stack in use\n-     * @param block The target block\n+     * @param tagManager The tag manager\n+     * @param cachedBlockInfo The cached block info.\n      * @param pos The target position\n      * @param facing The facing direction of the player\n      * @param sameStack The very same stack as the first parameter\n      * @return Check if the player is a fake player, if it is, then just do\n      *  the same return, otherwise, throw an event first and then return if the\n      *  event is cancelled, or the stack.canPlaceOn\n      */\n-    @Redirect(method = \"canPlayerEdit\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/item/ItemStack;canPlaceOn(Lnet/minecraft/block/Block;)Z\"))\n-    private boolean canEditSpongeThrowChangePreEvent(\n-        final ItemStack stack, final Block block, final BlockPos pos, final Direction facing, final ItemStack sameStack) {\n+    @Redirect(method = \"canPlayerEdit\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/item/ItemStack;canPlaceOn(Lnet/minecraft/tags/NetworkTagManager;Lnet/minecraft/util/CachedBlockInfo;)Z\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 399}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMjE3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                Vec3d targetMotion = targetEntity.getMotion();\n          \n          \n            \n                                final Vec3d targetMotion = targetEntity.getMotion();", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382402175", "createdAt": "2020-02-21T05:20:38Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/core/entity/player/PlayerEntityMixin.java", "diffHunk": "@@ -788,9 +774,7 @@ public void attackTargetEntityWithCurrentItem(final Entity targetEntity) {\n                         }\n                     }\n \n-                    final double targetMotionX = targetEntity.motionX;\n-                    final double targetMotionY = targetEntity.motionY;\n-                    final double targetMotionZ = targetEntity.motionZ;\n+                    Vec3d targetMotion = targetEntity.getMotion();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 672}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMjQ4Nw==", "bodyText": "don't just check if the world is remote, we have a better check: !((WorldBridge) this.world).bridge$isFake()", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382402487", "createdAt": "2020-02-21T05:22:09Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/tracker/entity/LivingEntityMixin_Tracker.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * This file is part of Sponge, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.common.mixin.tracker.entity;\n+\n+import net.minecraft.entity.Entity;\n+import net.minecraft.entity.LivingEntity;\n+import org.spongepowered.api.Sponge;\n+import org.spongepowered.api.event.CauseStackManager;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Redirect;\n+import org.spongepowered.common.event.tracking.PhaseContext;\n+import org.spongepowered.common.event.tracking.PhaseTracker;\n+import org.spongepowered.common.event.tracking.phase.entity.EntityPhase;\n+\n+@Mixin(LivingEntity.class)\n+public abstract class LivingEntityMixin_Tracker extends Entity {\n+    @Shadow protected abstract void shadow$onDeathUpdate();\n+\n+    public LivingEntityMixin_Tracker() {\n+        super(null, null);\n+    }\n+\n+    /**\n+     * @author i509VCB - February 17th, 2020 - 1.14.4\n+     *\n+     * @reason Enter phase state on entity death.\n+     * @param livingEntity The entity which is dying.\n+     */\n+    @Redirect(method = \"baseTick()V\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/LivingEntity;onDeathUpdate()V\"))\n+    private void tracker$enterPhaseOnDeath(final LivingEntity livingEntity) {\n+        if (!this.world.isRemote) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMjYwOQ==", "bodyText": "Can extend EntityMixin from core, or if there's one in the tracker package.", "url": "https://github.com/SpongePowered/Sponge/pull/2503#discussion_r382402609", "createdAt": "2020-02-21T05:22:52Z", "author": {"login": "gabizou"}, "path": "src/main/java/org/spongepowered/common/mixin/tracker/entity/LivingEntityMixin_Tracker.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * This file is part of Sponge, licensed under the MIT License (MIT).\n+ *\n+ * Copyright (c) SpongePowered <https://www.spongepowered.org>\n+ * Copyright (c) contributors\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+package org.spongepowered.common.mixin.tracker.entity;\n+\n+import net.minecraft.entity.Entity;\n+import net.minecraft.entity.LivingEntity;\n+import org.spongepowered.api.Sponge;\n+import org.spongepowered.api.event.CauseStackManager;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Redirect;\n+import org.spongepowered.common.event.tracking.PhaseContext;\n+import org.spongepowered.common.event.tracking.PhaseTracker;\n+import org.spongepowered.common.event.tracking.phase.entity.EntityPhase;\n+\n+@Mixin(LivingEntity.class)\n+public abstract class LivingEntityMixin_Tracker extends Entity {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "92a4e950408beab4785ef89b99ea8115af0e1d54", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/92a4e950408beab4785ef89b99ea8115af0e1d54", "committedDate": "2020-02-19T01:07:51Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}, "afterCommit": {"oid": "1538ebb199ccc72b37f95778fa8e39d58f50dbc2", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/1538ebb199ccc72b37f95778fa8e39d58f50dbc2", "committedDate": "2020-02-22T04:46:01Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1538ebb199ccc72b37f95778fa8e39d58f50dbc2", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/1538ebb199ccc72b37f95778fa8e39d58f50dbc2", "committedDate": "2020-02-22T04:46:01Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}, "afterCommit": {"oid": "70b13023b87c95bd8f6e7065655947903a035a21", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/70b13023b87c95bd8f6e7065655947903a035a21", "committedDate": "2020-02-22T16:27:12Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e5938cf08afd45082efeec2b8c29d8ea8a52125", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/7e5938cf08afd45082efeec2b8c29d8ea8a52125", "committedDate": "2020-02-22T16:30:09Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70b13023b87c95bd8f6e7065655947903a035a21", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/70b13023b87c95bd8f6e7065655947903a035a21", "committedDate": "2020-02-22T16:27:12Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}, "afterCommit": {"oid": "7e5938cf08afd45082efeec2b8c29d8ea8a52125", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/SpongePowered/Sponge/commit/7e5938cf08afd45082efeec2b8c29d8ea8a52125", "committedDate": "2020-02-22T16:30:09Z", "message": "Make references to GameRules refer to actual RuleKey rather than string constant, clean up and make most of core entity mixins compile"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 853, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}