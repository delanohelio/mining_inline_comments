{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMzI2Nzc1", "number": 3194, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMTozODoyN1rOE0ACxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMTozODoyN1rOE0ACxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTYyMTE3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/spongepowered/common/service/user/SpongeUserStorageService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwMTozODoyN1rOHrkABw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMVQwNTo1ODoyMVrOHrlOSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQ0MDY0Nw==", "bodyText": "You're changing this from immediately breaking out of optional-world to being half optional-style and half not.\nEither do something like name.get().toLowerCase(Locale.ROOT).startsWith(lastKnownName), or continue the Optional chain so it terminates with an orElse(false), removing any use of isPresent or get.", "url": "https://github.com/SpongePowered/Sponge/pull/3194#discussion_r515440647", "createdAt": "2020-10-31T01:38:27Z", "author": {"login": "zml2008"}, "path": "src/main/java/org/spongepowered/common/service/user/SpongeUserStorageService.java", "diffHunk": "@@ -113,7 +113,8 @@ public boolean delete(User user) {\n         Collection<GameProfile> allProfiles = UserDiscoverer.getAllProfiles();\n         Collection<GameProfile> matching = Sets.newHashSet();\n         for (GameProfile profile : allProfiles) {\n-            if (profile.getName().isPresent() && profile.getName().get().startsWith(lastKnownName)) {\n+            Optional<String> name = profile.getName().map(n -> n.toLowerCase(Locale.ROOT));\n+            if (name.isPresent() && name.get().startsWith(lastKnownName)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5503f3b353a9dab257dd16d029b05cf97715370f"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQ2MDY4MA==", "bodyText": "Initially I was going to continue with .filter(n -> n.startsWith(lastKnownName)) but variables in the lambda need to be effectively final. I'll just change it to the first option you suggested.", "url": "https://github.com/SpongePowered/Sponge/pull/3194#discussion_r515460680", "createdAt": "2020-10-31T05:58:21Z", "author": {"login": "alexstaeding"}, "path": "src/main/java/org/spongepowered/common/service/user/SpongeUserStorageService.java", "diffHunk": "@@ -113,7 +113,8 @@ public boolean delete(User user) {\n         Collection<GameProfile> allProfiles = UserDiscoverer.getAllProfiles();\n         Collection<GameProfile> matching = Sets.newHashSet();\n         for (GameProfile profile : allProfiles) {\n-            if (profile.getName().isPresent() && profile.getName().get().startsWith(lastKnownName)) {\n+            Optional<String> name = profile.getName().map(n -> n.toLowerCase(Locale.ROOT));\n+            if (name.isPresent() && name.get().startsWith(lastKnownName)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQ0MDY0Nw=="}, "originalCommit": {"oid": "5503f3b353a9dab257dd16d029b05cf97715370f"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2510, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}