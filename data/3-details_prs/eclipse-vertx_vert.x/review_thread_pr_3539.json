{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NDgwMTIx", "number": 3539, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjo0NDoxMFrOEans3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjo0NDoxMFrOEans3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MzQ4ODk1OnYy", "diffSide": "RIGHT", "path": "src/main/java/io/vertx/core/dns/impl/DnsClientImpl.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjo0NDoxMFrOHEKfwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNjoxMTo1MlrOHEzHGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyODMyMg==", "bodyText": "why do we need to add a trailing dot and lower case the query ?", "url": "https://github.com/eclipse-vertx/vert.x/pull/3539#discussion_r474128322", "createdAt": "2020-08-20T16:44:10Z", "author": {"login": "vietj"}, "path": "src/main/java/io/vertx/core/dns/impl/DnsClientImpl.java", "diffHunk": "@@ -279,6 +279,14 @@ public DnsClient reverseLookup(String address, Handler<AsyncResult<String>> hand\n     return promise.future();\n   }\n \n+  private long dnsMessageId(int id, String query) {\n+    query = query.toLowerCase();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4173feacd13acafa68bce1757dfc9abdf88fa512"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE2MzM4NA==", "bodyText": "The trailing dot is from the DNS spec. And we can see it in Netty Codec, they are adding the trailing dot in the decode domain name function, so we need to add it when it's not present (we see the dot even with dig command line).\nI thought DNS servers were also insensitive to the case, but apparently not, so I can remove the toLowerCase()", "url": "https://github.com/eclipse-vertx/vert.x/pull/3539#discussion_r474163384", "createdAt": "2020-08-20T17:43:53Z", "author": {"login": "Joxit"}, "path": "src/main/java/io/vertx/core/dns/impl/DnsClientImpl.java", "diffHunk": "@@ -279,6 +279,14 @@ public DnsClient reverseLookup(String address, Handler<AsyncResult<String>> hand\n     return promise.future();\n   }\n \n+  private long dnsMessageId(int id, String query) {\n+    query = query.toLowerCase();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyODMyMg=="}, "originalCommit": {"oid": "4173feacd13acafa68bce1757dfc9abdf88fa512"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDUzNzgyMg==", "bodyText": "I see, in this case I think we should in the client itself add a trailing dot to our queries when they are performed instead of having the encoder do it for us, e.g in the Query constructor, that would be more clear rather than doing it when computing the message id.", "url": "https://github.com/eclipse-vertx/vert.x/pull/3539#discussion_r474537822", "createdAt": "2020-08-21T08:48:45Z", "author": {"login": "vietj"}, "path": "src/main/java/io/vertx/core/dns/impl/DnsClientImpl.java", "diffHunk": "@@ -279,6 +279,14 @@ public DnsClient reverseLookup(String address, Handler<AsyncResult<String>> hand\n     return promise.future();\n   }\n \n+  private long dnsMessageId(int id, String query) {\n+    query = query.toLowerCase();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyODMyMg=="}, "originalCommit": {"oid": "4173feacd13acafa68bce1757dfc9abdf88fa512"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc5Mzc1NA==", "bodyText": "I agree ! Updated :)", "url": "https://github.com/eclipse-vertx/vert.x/pull/3539#discussion_r474793754", "createdAt": "2020-08-21T16:11:52Z", "author": {"login": "Joxit"}, "path": "src/main/java/io/vertx/core/dns/impl/DnsClientImpl.java", "diffHunk": "@@ -279,6 +279,14 @@ public DnsClient reverseLookup(String address, Handler<AsyncResult<String>> hand\n     return promise.future();\n   }\n \n+  private long dnsMessageId(int id, String query) {\n+    query = query.toLowerCase();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyODMyMg=="}, "originalCommit": {"oid": "4173feacd13acafa68bce1757dfc9abdf88fa512"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4520, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}