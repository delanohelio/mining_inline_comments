{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4ODk2Nzcz", "number": 3498, "title": "HTTP client improvements", "bodyText": "fixes #3500 and #3501", "createdAt": "2020-07-14T13:54:33Z", "url": "https://github.com/eclipse-vertx/vert.x/pull/3498", "merged": true, "mergeCommit": {"oid": "74b0f80acbaacae99be022b9458cc456c6a18ad1"}, "closed": true, "closedAt": "2020-07-21T08:12:38Z", "author": {"login": "vietj"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc02em7gBqjM1NDQyOTYxNzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3BVesgH2gAyNDQ4ODk2NzczOmNjODU0N2Q0NDNkODAxMjQyYjMwZjgyODdhOTQxMTIxMGYwYTQ1ZjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f390c1d86372a610a86a68231b6d1d9a4940952", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/6f390c1d86372a610a86a68231b6d1d9a4940952", "committedDate": "2020-07-14T13:28:25Z", "message": "HttpClient does not create anymore lazy HTTP requests"}, "afterCommit": {"oid": "be669a5a7559b354ae20c55297ca98e407aa0297", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/be669a5a7559b354ae20c55297ca98e407aa0297", "committedDate": "2020-07-14T13:58:13Z", "message": "HttpClient does not create anymore lazy HTTP requests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "54ef75fe0baf9d930bd664fd723e86c96fcb7f41", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/54ef75fe0baf9d930bd664fd723e86c96fcb7f41", "committedDate": "2020-07-17T08:13:35Z", "message": "Decouple HTTP client internal from API request/response"}, "afterCommit": {"oid": "b4933d95352350dfc9116f395272c1f0f787c3ee", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/b4933d95352350dfc9116f395272c1f0f787c3ee", "committedDate": "2020-07-17T08:21:36Z", "message": "Decouple HTTP client internal from API request/response"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b4933d95352350dfc9116f395272c1f0f787c3ee", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/b4933d95352350dfc9116f395272c1f0f787c3ee", "committedDate": "2020-07-17T08:21:36Z", "message": "Decouple HTTP client internal from API request/response"}, "afterCommit": {"oid": "996811152e3eafa8cdde3383f36ea70ef08757ba", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/996811152e3eafa8cdde3383f36ea70ef08757ba", "committedDate": "2020-07-17T09:48:13Z", "message": "Decouple HTTP client internal from API request/response"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "996811152e3eafa8cdde3383f36ea70ef08757ba", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/996811152e3eafa8cdde3383f36ea70ef08757ba", "committedDate": "2020-07-17T09:48:13Z", "message": "Decouple HTTP client internal from API request/response"}, "afterCommit": {"oid": "2be077ab4772087657fd5f171be30fc6c601452e", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/2be077ab4772087657fd5f171be30fc6c601452e", "committedDate": "2020-07-17T11:46:26Z", "message": "Some cleanup and improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNjUxNTUz", "url": "https://github.com/eclipse-vertx/vert.x/pull/3498#pullrequestreview-450651553", "createdAt": "2020-07-17T13:21:45Z", "commit": {"oid": "36dbbb8d7b882c208e50940ecb7edd730f5f5bfc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzoyMTo0NVrOGzSwYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzoyMTo0NVrOGzSwYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQzNzg1OQ==", "bodyText": "2020 \ud83d\ude09", "url": "https://github.com/eclipse-vertx/vert.x/pull/3498#discussion_r456437859", "createdAt": "2020-07-17T13:21:45Z", "author": {"login": "jponge"}, "path": "src/main/java/io/vertx/core/http/impl/HttpClientPush.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright (c) 2011-2019 Contributors to the Eclipse Foundation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36dbbb8d7b882c208e50940ecb7edd730f5f5bfc"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b36c7a489edaa8506babb898828b9708be3db995", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/b36c7a489edaa8506babb898828b9708be3db995", "committedDate": "2020-07-18T07:45:43Z", "message": "HttpClient does not create anymore lazy HTTP requests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1eb45a93a354902c1a131380f00cb9f4e0b8e5dd", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/1eb45a93a354902c1a131380f00cb9f4e0b8e5dd", "committedDate": "2020-07-18T07:45:43Z", "message": "Decouple HTTP client internal from API request/response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79727b4308b17c184fe82d0087ea5f8d696f3d13", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/79727b4308b17c184fe82d0087ea5f8d696f3d13", "committedDate": "2020-07-18T07:45:43Z", "message": "Some cleanup and improvements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3aa1b40a025dfc44c818a0c59fc62ab401f8438a", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/3aa1b40a025dfc44c818a0c59fc62ab401f8438a", "committedDate": "2020-07-18T07:45:43Z", "message": "Minor cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "969b6bbf5e48a242847d08b88c8121204323c6f1", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/969b6bbf5e48a242847d08b88c8121204323c6f1", "committedDate": "2020-07-18T07:45:43Z", "message": "Use context for request timeout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b1b44c96b5d9af615b0babbc3f3496403d392e6", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/4b1b44c96b5d9af615b0babbc3f3496403d392e6", "committedDate": "2020-07-18T07:45:43Z", "message": "Update copyright date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39593df11aabbdb08ebfbeb208a586c00e006eb2", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/39593df11aabbdb08ebfbeb208a586c00e006eb2", "committedDate": "2020-07-18T15:27:02Z", "message": "Improvement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMzgzOTgz", "url": "https://github.com/eclipse-vertx/vert.x/pull/3498#pullrequestreview-451383983", "createdAt": "2020-07-20T08:08:21Z", "commit": {"oid": "005c7cade9b17bd971b2b061e5b2d67b21af5919"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwODowODoyMVrOGz-qVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwODoxNjo0MFrOGz_CbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1NzIwNw==", "bodyText": "Update or remove?", "url": "https://github.com/eclipse-vertx/vert.x/pull/3498#discussion_r457157207", "createdAt": "2020-07-20T08:08:21Z", "author": {"login": "tsegismont"}, "path": "src/test/java/io/vertx/core/spi/tracing/HttpTracerTestBase.java", "diffHunk": "@@ -156,8 +160,8 @@ public Object sendRequest(Context context, Object request, String operation, BiC\n       public void receiveResponse(Context context, Object response, Object payload, Throwable failure, TagExtractor tagExtractor) {\n         assertSame(val, context.getLocal(key));\n         assertTrue(context.removeLocal(key));\n-        assertNotNull(response);\n-        assertTrue(response instanceof HttpClientResponse);\n+//        assertNotNull(response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "005c7cade9b17bd971b2b061e5b2d67b21af5919"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE2MzM3Mg==", "bodyText": "todo, fail ?", "url": "https://github.com/eclipse-vertx/vert.x/pull/3498#discussion_r457163372", "createdAt": "2020-07-20T08:16:40Z", "author": {"login": "tsegismont"}, "path": "src/main/java/io/vertx/core/http/impl/VertxHttp2Stream.java", "diffHunk": "@@ -210,10 +212,20 @@ final void writeData(ByteBuf chunk, boolean end, Handler<AsyncResult<Void>> hand\n     }\n   }\n \n-  void doWriteData(ByteBuf chunk, boolean end, Handler<AsyncResult<Void>> handler) {\n-    bytesWritten += chunk.readableBytes();\n-    FutureListener<Void> promise = handler == null ? null : context.promise(handler);\n-    conn.handler.writeData(stream, chunk, end, promise);\n+  void doWriteData(ByteBuf buf, boolean end, Handler<AsyncResult<Void>> handler) {\n+    ByteBuf chunk;\n+    if (buf == null && end) {\n+      chunk = Unpooled.EMPTY_BUFFER;\n+    } else {\n+      chunk = buf;\n+    }\n+    if (chunk != null) {\n+      bytesWritten += chunk.readableBytes();\n+      FutureListener<Void> promise = handler == null ? null : context.promise(handler);\n+      conn.handler.writeData(stream, chunk, end, promise);\n+    } else {\n+      // todo ??????????", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "005c7cade9b17bd971b2b061e5b2d67b21af5919"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc829a2d8a13dcb81108c279113e28218f2456dc", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/cc829a2d8a13dcb81108c279113e28218f2456dc", "committedDate": "2020-07-20T13:56:50Z", "message": "HttpClient redirect handler should return RequestOptions instead of an HttpClientRequest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fff420e6ba054cf3aada16b563d1553b2718cc4", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/7fff420e6ba054cf3aada16b563d1553b2718cc4", "committedDate": "2020-07-20T14:40:26Z", "message": "Rework HTTP client setimout"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "005c7cade9b17bd971b2b061e5b2d67b21af5919", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/005c7cade9b17bd971b2b061e5b2d67b21af5919", "committedDate": "2020-07-17T15:05:40Z", "message": "Update copyright date"}, "afterCommit": {"oid": "7fff420e6ba054cf3aada16b563d1553b2718cc4", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/7fff420e6ba054cf3aada16b563d1553b2718cc4", "committedDate": "2020-07-20T14:40:26Z", "message": "Rework HTTP client setimout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e01b6945677937ad22c09d1a6bd813ba845f8c2d", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/e01b6945677937ad22c09d1a6bd813ba845f8c2d", "committedDate": "2020-07-21T06:47:20Z", "message": "Make sure we don't write a null buffer when the stream is not ended"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "237576cdf955bf25b76967554070ba47d7813be2", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/237576cdf955bf25b76967554070ba47d7813be2", "committedDate": "2020-07-21T07:09:35Z", "message": "Fix incorrect test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d4ba8b834d5fdd798a403e53cf13a74f3a98931", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/0d4ba8b834d5fdd798a403e53cf13a74f3a98931", "committedDate": "2020-07-21T07:33:10Z", "message": "HTTP/2 connection handler should be set after the handler has been added to the pipeline as we might need to use it before the settings frame has been read"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47d29071fb04c83e94198a467ba09885a3b37ff5", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/47d29071fb04c83e94198a467ba09885a3b37ff5", "committedDate": "2020-07-21T07:37:26Z", "message": "HttpTracerTestBase should use now the correct types for client request/response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc8547d443d801242b30f8287a9411210f0a45f3", "author": {"user": {"login": "vietj", "name": "Julien Viet"}}, "url": "https://github.com/eclipse-vertx/vert.x/commit/cc8547d443d801242b30f8287a9411210f0a45f3", "committedDate": "2020-07-21T07:45:17Z", "message": "Make timeout fields private"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1687, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}