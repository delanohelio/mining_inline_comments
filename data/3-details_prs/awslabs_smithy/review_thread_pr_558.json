{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0Mzg2Mzk4", "number": 558, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTowOTo1OVrOEisWOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoxOTozMFrOEjzZ1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODEzNjI2OnYy", "diffSide": "RIGHT", "path": "smithy-build/src/main/java/software/amazon/smithy/build/plugins/RemoveSharedShapesPlugin.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMTowOTo1OVrOHQt87w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoxNzoyNlrOHSS_tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI5MjE0Mw==", "bodyText": "Why not call this RemoveTraitShapes / \"remove-trait-shapes\"?", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r487292143", "createdAt": "2020-09-11T21:09:59Z", "author": {"login": "mtdowling"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/plugins/RemoveSharedShapesPlugin.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.plugins;\n+\n+import software.amazon.smithy.build.PluginContext;\n+import software.amazon.smithy.build.SmithyBuildPlugin;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.node.Node;\n+import software.amazon.smithy.model.shapes.ModelSerializer;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+public final class RemoveSharedShapesPlugin implements SmithyBuildPlugin {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe2fafdc8b121e3ee3ce0146d5deafb493a03ee5"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMwNzcxNA==", "bodyText": "Fixed.  This evolved a bit and I didn't update the naming.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r487307714", "createdAt": "2020-09-11T21:54:36Z", "author": {"login": "srchase"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/plugins/RemoveSharedShapesPlugin.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.plugins;\n+\n+import software.amazon.smithy.build.PluginContext;\n+import software.amazon.smithy.build.SmithyBuildPlugin;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.node.Node;\n+import software.amazon.smithy.model.shapes.ModelSerializer;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+public final class RemoveSharedShapesPlugin implements SmithyBuildPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI5MjE0Mw=="}, "originalCommit": {"oid": "fe2fafdc8b121e3ee3ce0146d5deafb493a03ee5"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI4NTI3OQ==", "bodyText": "This should probably be a ProjectionTransformer and not a SmithyBuildPlugin since it needs to modify a model and not necessarily create its own artifacts.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r488285279", "createdAt": "2020-09-14T23:02:55Z", "author": {"login": "mtdowling"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/plugins/RemoveSharedShapesPlugin.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.plugins;\n+\n+import software.amazon.smithy.build.PluginContext;\n+import software.amazon.smithy.build.SmithyBuildPlugin;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.node.Node;\n+import software.amazon.smithy.model.shapes.ModelSerializer;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+public final class RemoveSharedShapesPlugin implements SmithyBuildPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI5MjE0Mw=="}, "originalCommit": {"oid": "fe2fafdc8b121e3ee3ce0146d5deafb493a03ee5"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk0NzYzOA==", "bodyText": "This has been reworked and is now a transformer.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r488947638", "createdAt": "2020-09-15T20:17:26Z", "author": {"login": "srchase"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/plugins/RemoveSharedShapesPlugin.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.plugins;\n+\n+import software.amazon.smithy.build.PluginContext;\n+import software.amazon.smithy.build.SmithyBuildPlugin;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.node.Node;\n+import software.amazon.smithy.model.shapes.ModelSerializer;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+public final class RemoveSharedShapesPlugin implements SmithyBuildPlugin {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI5MjE0Mw=="}, "originalCommit": {"oid": "fe2fafdc8b121e3ee3ce0146d5deafb493a03ee5"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTM1MzQ5OnYy", "diffSide": "RIGHT", "path": "smithy-build/src/main/java/software/amazon/smithy/build/transforms/RemoveTraitDefinitions.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyNjo0OFrOHSTTSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMzozNDozOVrOHSaz7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1MjY0OA==", "bodyText": "This probably doesn't need the BackwardCompatHelper since it's new.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r488952648", "createdAt": "2020-09-15T20:26:48Z", "author": {"login": "mtdowling"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/transforms/RemoveTraitDefinitions.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.transforms;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.function.Predicate;\n+import java.util.logging.Logger;\n+import software.amazon.smithy.build.TransformContext;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.shapes.Shape;\n+import software.amazon.smithy.model.traits.TraitDefinition;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+/**\n+ * {@code removeTraitShapes} removes all trait definitions from a model,\n+ * but leaves if the trait definition contains any of the provided\n+ * {@code tags}.\n+ *\n+ * <p>This transformer will not remove prelude trait definitions.\n+ */\n+public final class RemoveTraitDefinitions extends BackwardCompatHelper<RemoveTraitDefinitions.Config> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e532889cded9c00c1ab940e5aed556241f416b88"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA3NTY5Mw==", "bodyText": "Fixed.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r489075693", "createdAt": "2020-09-15T23:34:39Z", "author": {"login": "srchase"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/transforms/RemoveTraitDefinitions.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.transforms;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.function.Predicate;\n+import java.util.logging.Logger;\n+import software.amazon.smithy.build.TransformContext;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.shapes.Shape;\n+import software.amazon.smithy.model.traits.TraitDefinition;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+/**\n+ * {@code removeTraitShapes} removes all trait definitions from a model,\n+ * but leaves if the trait definition contains any of the provided\n+ * {@code tags}.\n+ *\n+ * <p>This transformer will not remove prelude trait definitions.\n+ */\n+public final class RemoveTraitDefinitions extends BackwardCompatHelper<RemoveTraitDefinitions.Config> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1MjY0OA=="}, "originalCommit": {"oid": "e532889cded9c00c1ab940e5aed556241f416b88"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTM2MTg1OnYy", "diffSide": "RIGHT", "path": "smithy-build/src/main/java/software/amazon/smithy/build/transforms/RemoveTraitDefinitions.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyOToyOVrOHSTYsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyOToyOVrOHSTYsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1NDAzNQ==", "bodyText": "I don't see how this would work if, say, a trait shape is removed that is a structure that references other shapes that were removed. It might be better to instead filter before removing trait shapes rather than re-add. (e.g., maybe you can add a Predicate to the getModelWithoutTraitShapes method.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r488954035", "createdAt": "2020-09-15T20:29:29Z", "author": {"login": "mtdowling"}, "path": "smithy-build/src/main/java/software/amazon/smithy/build/transforms/RemoveTraitDefinitions.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.smithy.build.transforms;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.function.Predicate;\n+import java.util.logging.Logger;\n+import software.amazon.smithy.build.TransformContext;\n+import software.amazon.smithy.model.Model;\n+import software.amazon.smithy.model.shapes.Shape;\n+import software.amazon.smithy.model.traits.TraitDefinition;\n+import software.amazon.smithy.model.transform.ModelTransformer;\n+\n+/**\n+ * {@code removeTraitShapes} removes all trait definitions from a model,\n+ * but leaves if the trait definition contains any of the provided\n+ * {@code tags}.\n+ *\n+ * <p>This transformer will not remove prelude trait definitions.\n+ */\n+public final class RemoveTraitDefinitions extends BackwardCompatHelper<RemoveTraitDefinitions.Config> {\n+\n+    private static final Logger LOGGER = Logger.getLogger(RemoveTraitDefinitions.class.getName());\n+\n+    /**\n+     * {@code removeTraitShapes} configuration settings.\n+     */\n+    public static final class Config {\n+\n+        private Set<String> exportTagged = Collections.emptySet();\n+\n+        /**\n+         * You can <em>export</em> trait definitions by applying specific tags\n+         * to the trait definition and adding the list of export tags as an\n+         * argument to the transformer.\n+         *\n+         * @param exportByTags Tags that cause trait definitions to be\n+         *                     exported.\n+         */\n+        public void setExportTagged(Set<String> exportByTags) {\n+            this.exportTagged = exportByTags;\n+        }\n+\n+        /**\n+         * Gets the set of tags that are used to export trait definitions.\n+         *\n+         * @return the tags that are used to export trait definitions.\n+         */\n+        public Set<String> getExportTagged() {\n+            return exportTagged;\n+        }\n+    }\n+\n+    @Override\n+    String getBackwardCompatibleNameMapping() {\n+        return \"removeTraitDefinitions\";\n+    }\n+\n+    @Override\n+    public Class<Config> getConfigType() {\n+        return Config.class;\n+    }\n+\n+    @Override\n+    protected Model transformWithConfig(TransformContext context, Config config) {\n+        Model model = context.getModel();\n+        ModelTransformer transformer = context.getTransformer();\n+\n+        Model modelWithoutTraitDefinitions = transformer.getModelWithoutTraitShapes(model);\n+\n+        // If no export tags have been configured, we can return the scrubbed model directly.\n+        if (config.getExportTagged().isEmpty()) {\n+            return modelWithoutTraitDefinitions;\n+        }\n+\n+        Predicate<Shape> keepTraitDefsByTag = trait -> config.getExportTagged().stream().anyMatch(trait::hasTag);\n+        Model.Builder builder = modelWithoutTraitDefinitions.toBuilder();\n+\n+        // Add trait definitions back to scrubbed model.\n+        model.shapes()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e532889cded9c00c1ab940e5aed556241f416b88"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTc3MTg4OnYy", "diffSide": "RIGHT", "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ModelTransformer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoxODowMlrOHSXjQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoxODowMlrOHSXjQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAyMjI3NA==", "bodyText": "model.base?", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r489022274", "createdAt": "2020-09-15T22:18:02Z", "author": {"login": "mtdowling"}, "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ModelTransformer.java", "diffHunk": "@@ -387,6 +406,20 @@ public Model scrubTraitDefinitions(Model model) {\n      * @return Returns a model that contains matching shapes.\n      */\n     public Model getModelWithoutTraitShapes(Model model) {\n+        return getModelWithoutTraitShapes(model, FunctionalUtils.alwaysTrue());\n+    }\n+\n+    /**\n+     * Gets all shapes from a model where shapes that define traits or shapes\n+     * that are only used as part of a trait definition have been removed.\n+     *\n+     * @param model Model that contains shapes.\n+     * @param keepFilter Predicate function that accepts a trait shape (that\n+     *  has the {@link TraitDefinition} trait) and returns true to remove the\n+     *  definition or false to keep the definition in the model.base.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad77f6a229b46a7f1ffc0c6a21bacb038f4eb2b7"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTc3NjM0OnYy", "diffSide": "RIGHT", "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ScrubTraitDefinitions.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoxOTowN1rOHSXmhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoxOTowN1rOHSXmhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAyMzExMA==", "bodyText": "Can this filtering be done all on a single stream instead of needing to make two sets?", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r489023110", "createdAt": "2020-09-15T22:19:07Z", "author": {"login": "mtdowling"}, "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ScrubTraitDefinitions.java", "diffHunk": "@@ -42,14 +45,21 @@\n  */\n final class ScrubTraitDefinitions {\n     Model transform(ModelTransformer transformer, Model model) {\n+        return transform(transformer, model, FunctionalUtils.alwaysTrue());\n+    }\n+\n+    Model transform(ModelTransformer transformer, Model model, Predicate<Shape> keepFilter) {\n         // Find all trait definition shapes and private shapes in the prelude.\n-        Set<Shape> toMark = Stream.concat(\n+        Set<Shape> traitDefinitions = Stream.concat(\n                 model.shapes().filter(shape -> shape.hasTrait(TraitDefinition.class)),\n                 model.shapes().filter(shape -> Prelude.isPreludeShape(shape) && shape.hasTrait(PrivateTrait.class))\n         ).collect(Collectors.toSet());\n \n+        // Filter any trait definitions from being marked for removal that we want to retain.\n+        Set<Shape> toMark = traitDefinitions.stream().filter(keepFilter).collect(Collectors.toSet());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad77f6a229b46a7f1ffc0c6a21bacb038f4eb2b7"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTc3ODEyOnYy", "diffSide": "RIGHT", "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ModelTransformer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoxOTozMFrOHSXnuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMzozNToxMFrOHSa0kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAyMzQxOQ==", "bodyText": "s/Swagger/OpenAPI", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r489023419", "createdAt": "2020-09-15T22:19:30Z", "author": {"login": "mtdowling"}, "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ModelTransformer.java", "diffHunk": "@@ -376,7 +376,26 @@ public Model removeUnreferencedTraitDefinitions(Model model, Predicate<Shape> ke\n      * @return Returns the transformed model.base.\n      */\n     public Model scrubTraitDefinitions(Model model) {\n-        return new ScrubTraitDefinitions().transform(this, model);\n+        return scrubTraitDefinitions(model, FunctionalUtils.alwaysTrue());\n+    }\n+\n+    /**\n+     * Removes trait definitions from a model and all shapes that are\n+     * only connected to the graph either directly or transitively by a\n+     * trait definition shape.\n+     *\n+     * <p>This can be useful when serializing a Smithy model to a format that\n+     * does not include trait definitions and the shapes used by trait definitions\n+     * would have no meaning (e.g., Swagger).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad77f6a229b46a7f1ffc0c6a21bacb038f4eb2b7"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA3NTg1OA==", "bodyText": "Fixed this and a couple other Swagger references.", "url": "https://github.com/awslabs/smithy/pull/558#discussion_r489075858", "createdAt": "2020-09-15T23:35:10Z", "author": {"login": "srchase"}, "path": "smithy-model/src/main/java/software/amazon/smithy/model/transform/ModelTransformer.java", "diffHunk": "@@ -376,7 +376,26 @@ public Model removeUnreferencedTraitDefinitions(Model model, Predicate<Shape> ke\n      * @return Returns the transformed model.base.\n      */\n     public Model scrubTraitDefinitions(Model model) {\n-        return new ScrubTraitDefinitions().transform(this, model);\n+        return scrubTraitDefinitions(model, FunctionalUtils.alwaysTrue());\n+    }\n+\n+    /**\n+     * Removes trait definitions from a model and all shapes that are\n+     * only connected to the graph either directly or transitively by a\n+     * trait definition shape.\n+     *\n+     * <p>This can be useful when serializing a Smithy model to a format that\n+     * does not include trait definitions and the shapes used by trait definitions\n+     * would have no meaning (e.g., Swagger).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAyMzQxOQ=="}, "originalCommit": {"oid": "ad77f6a229b46a7f1ffc0c6a21bacb038f4eb2b7"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3742, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}