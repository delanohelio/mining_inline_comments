{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5ODQxOTI0", "number": 893, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOTo1Nzo0MlrODvSGGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOTo1Nzo0MlrODvSGGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwOTA2MTM2OnYy", "diffSide": "RIGHT", "path": "fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/query/plan/RecordQueryPlanner.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOTo1Nzo0MlrOGBnoEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowMzoyM1rOGBnz5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1MDk5Mg==", "bodyText": "For master (versus patch release), do we want this to be the only definition of normalizeAndOr? Or just live with this until a more major overhaul?\nWe could also take this as a clean merge from the release branch and do that separately.", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/893#discussion_r404350992", "createdAt": "2020-04-06T19:57:42Z", "author": {"login": "MMcM"}, "path": "fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/query/plan/RecordQueryPlanner.java", "diffHunk": "@@ -1284,20 +1284,49 @@ private QueryComponent normalizeAndOr(AndComponent and) {\n             QueryComponent child1 = and.getChildren().get(0);\n             QueryComponent child2 = and.getChildren().get(1);\n             if (child1 instanceof OrComponent && Query.isSingleFieldComparison(child2)) {\n-                return OrComponent.from(distributeAnd(child2, ((OrComponent)child1).getChildren()));\n+                return OrComponent.from(distributeAnd(Collections.singletonList(child2), ((OrComponent)child1).getChildren()));\n             }\n             if (child2 instanceof OrComponent && Query.isSingleFieldComparison(child1)) {\n-                return OrComponent.from(distributeAnd(child1, ((OrComponent)child2).getChildren()));\n+                return OrComponent.from(distributeAnd(Collections.singletonList(child1), ((OrComponent)child2).getChildren()));\n             }\n         }\n         return and;\n     }\n \n-    private List<QueryComponent> distributeAnd(QueryComponent component, List<QueryComponent> children) {\n+    private QueryComponent normalizeAndOrForInAsOr(@Nonnull QueryComponent component) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "babfb8e5915230e10c446cd25cb2850bc2f67a6e"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NDAyMg==", "bodyText": "I'd be up for changing this in master, but I think I'd rather do a clean merge. I opened #894 to track this.", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/893#discussion_r404354022", "createdAt": "2020-04-06T20:03:23Z", "author": {"login": "nschiefer"}, "path": "fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/query/plan/RecordQueryPlanner.java", "diffHunk": "@@ -1284,20 +1284,49 @@ private QueryComponent normalizeAndOr(AndComponent and) {\n             QueryComponent child1 = and.getChildren().get(0);\n             QueryComponent child2 = and.getChildren().get(1);\n             if (child1 instanceof OrComponent && Query.isSingleFieldComparison(child2)) {\n-                return OrComponent.from(distributeAnd(child2, ((OrComponent)child1).getChildren()));\n+                return OrComponent.from(distributeAnd(Collections.singletonList(child2), ((OrComponent)child1).getChildren()));\n             }\n             if (child2 instanceof OrComponent && Query.isSingleFieldComparison(child1)) {\n-                return OrComponent.from(distributeAnd(child1, ((OrComponent)child2).getChildren()));\n+                return OrComponent.from(distributeAnd(Collections.singletonList(child1), ((OrComponent)child2).getChildren()));\n             }\n         }\n         return and;\n     }\n \n-    private List<QueryComponent> distributeAnd(QueryComponent component, List<QueryComponent> children) {\n+    private QueryComponent normalizeAndOrForInAsOr(@Nonnull QueryComponent component) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1MDk5Mg=="}, "originalCommit": {"oid": "babfb8e5915230e10c446cd25cb2850bc2f67a6e"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4864, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}