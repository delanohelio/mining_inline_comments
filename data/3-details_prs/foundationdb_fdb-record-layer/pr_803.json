{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NTM1MzA3", "number": 803, "title": "Resolves #801: Support for aggregate event metrics", "bodyText": "", "createdAt": "2020-01-19T13:38:25Z", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803", "merged": true, "mergeCommit": {"oid": "1d54cf94a12a67000f019f4ec12a203eb7f95f43"}, "closed": true, "closedAt": "2020-02-14T18:01:04Z", "author": {"login": "scgray"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8h-f3gFqTM0NTkxNTM3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcETcIRAFqTM1OTEyMDA0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1OTE1Mzcw", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#pullrequestreview-345915370", "createdAt": "2020-01-21T14:25:31Z", "commit": {"oid": "ffcd2e4f6d8c7f7be0104c110a0e8da3c31ea8f5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ffcd2e4f6d8c7f7be0104c110a0e8da3c31ea8f5", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/ffcd2e4f6d8c7f7be0104c110a0e8da3c31ea8f5", "committedDate": "2020-01-19T13:32:43Z", "message": "Resolves #801: Support for aggregate event metrics"}, "afterCommit": {"oid": "fe33ba3faa1d6bc6d6fbd133b6894200b2399019", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/fe33ba3faa1d6bc6d6fbd133b6894200b2399019", "committedDate": "2020-01-22T14:55:18Z", "message": "Resolves #801: Support for aggregate event metrics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e630d0e4af23f8eb5f4faae4d5188885fcda346c", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/e630d0e4af23f8eb5f4faae4d5188885fcda346c", "committedDate": "2020-02-12T11:57:40Z", "message": "Resolves #801: Support for aggregate event metrics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9599fe40d36528bc622e55ea5ba7ecaed5506daf", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/9599fe40d36528bc622e55ea5ba7ecaed5506daf", "committedDate": "2020-02-12T11:57:40Z", "message": "Make PMD checks happy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "782a33dad95985fc149e45518b9ebea607884fe9", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/782a33dad95985fc149e45518b9ebea607884fe9", "committedDate": "2020-02-10T16:53:06Z", "message": "Make PMD checks happy"}, "afterCommit": {"oid": "9599fe40d36528bc622e55ea5ba7ecaed5506daf", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/9599fe40d36528bc622e55ea5ba7ecaed5506daf", "committedDate": "2020-02-12T11:57:40Z", "message": "Make PMD checks happy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4Mjg5NTM1", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#pullrequestreview-358289535", "createdAt": "2020-02-13T15:04:46Z", "commit": {"oid": "9599fe40d36528bc622e55ea5ba7ecaed5506daf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNTowNDo0NlrOFpXRKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNTowNDo0NlrOFpXRKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkxNzE2MQ==", "bodyText": "The aggregated time value for some of these will double count things that run in parallel or nested within one another. I'm not sure how easy it is to avoid being thrown off by that.", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#discussion_r378917161", "createdAt": "2020-02-13T15:04:46Z", "author": {"login": "MMcM"}, "path": "fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBStoreTimer.java", "diffHunk": "@@ -224,6 +238,76 @@ public String logKey() {\n         }\n     }\n \n+    /**\n+     * An aggregate over other count events.\n+     */\n+    public enum EventAggregates implements Aggregate, Event {\n+        COMMITS(\"commits\",\n+                Events.COMMIT,\n+                Events.COMMIT_FAILURE),\n+        READS(\"reads\",\n+                Events.LOAD_META_DATA,\n+                Events.LOAD_RECORD_STORE_STATE,\n+                Events.LOAD_RECORD_STORE_INFO,\n+                Events.LOAD_RECORD_STORE_INDEX_META_DATA,\n+                Events.LOAD_RECORD,\n+                Events.SCAN_RECORDS,\n+                Events.SCAN_INDEX_KEYS,\n+                Events.DIRECTORY_READ,\n+                Events.SCOPED_DIRECTORY_LAYER_READ,\n+                Events.EXTENDED_DIRECTORY_LAYER_READ,\n+                Events.INTERNING_LAYER_READ,\n+                Events.LOAD_BOUNDARY_KEYS,\n+                Events.READ_SAMPLE_KEY),\n+        WRITES(\"writes\",\n+                Events.SAVE_META_DATA,\n+                Events.LOAD_RECORD_STORE_INFO,\n+                Events.SAVE_RECORD,\n+                Events.SAVE_INDEX_ENTRY,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9599fe40d36528bc622e55ea5ba7ecaed5506daf"}, "originalPosition": 80}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee817c302d9ad53c51ad902cd7869882234eb0c2", "author": {"user": null}, "url": "https://github.com/FoundationDB/fdb-record-layer/commit/ee817c302d9ad53c51ad902cd7869882234eb0c2", "committedDate": "2020-02-13T16:15:29Z", "message": "Remove confusing READ/WRITES/DELETES aggregates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MTIwMDQ3", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#pullrequestreview-359120047", "createdAt": "2020-02-14T18:00:42Z", "commit": {"oid": "ee817c302d9ad53c51ad902cd7869882234eb0c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2749, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}