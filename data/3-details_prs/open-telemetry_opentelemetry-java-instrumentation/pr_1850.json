{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0NDAzNTc5", "number": 1850, "title": "Instrument spring batch chunk", "bodyText": "Continuation of #1843, #1852", "createdAt": "2020-12-08T12:03:14Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1850", "merged": true, "mergeCommit": {"oid": "5ef915879162bcccd0f3727d25bb735816263188"}, "closed": true, "closedAt": "2020-12-18T11:11:55Z", "author": {"login": "mateuszrzeszutek"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkJu8oABqjQwODQ2NTEwMTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnQg00gFqTU1NTE2NjQ3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "002e76fe82c6758cbb44a1161ba0dd5777001fb4", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/002e76fe82c6758cbb44a1161ba0dd5777001fb4", "committedDate": "2020-12-08T12:00:45Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "69406b8b9c2913d29281db5677f945c3d8dae6b4", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/69406b8b9c2913d29281db5677f945c3d8dae6b4", "committedDate": "2020-12-08T12:58:44Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "69406b8b9c2913d29281db5677f945c3d8dae6b4", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/69406b8b9c2913d29281db5677f945c3d8dae6b4", "committedDate": "2020-12-08T12:58:44Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "3465e336363b0ae06c92601c450fffd6b789debf", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3465e336363b0ae06c92601c450fffd6b789debf", "committedDate": "2020-12-08T14:44:42Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3465e336363b0ae06c92601c450fffd6b789debf", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3465e336363b0ae06c92601c450fffd6b789debf", "committedDate": "2020-12-08T14:44:42Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "7f84685dd55a2b9421f730f9df77ed8445257ae4", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/7f84685dd55a2b9421f730f9df77ed8445257ae4", "committedDate": "2020-12-09T11:11:38Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f84685dd55a2b9421f730f9df77ed8445257ae4", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/7f84685dd55a2b9421f730f9df77ed8445257ae4", "committedDate": "2020-12-09T11:11:38Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "a411a75e877485c842604c58b9fc4b60946eea52", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a411a75e877485c842604c58b9fc4b60946eea52", "committedDate": "2020-12-14T13:06:58Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a411a75e877485c842604c58b9fc4b60946eea52", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a411a75e877485c842604c58b9fc4b60946eea52", "committedDate": "2020-12-14T13:06:58Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "45c007fee65f52840d561101bf50539cd7983480", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/45c007fee65f52840d561101bf50539cd7983480", "committedDate": "2020-12-14T15:29:57Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "45c007fee65f52840d561101bf50539cd7983480", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/45c007fee65f52840d561101bf50539cd7983480", "committedDate": "2020-12-14T15:29:57Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "01125dea7d1f48e57a5ee74494e85a3ef0156ecd", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/01125dea7d1f48e57a5ee74494e85a3ef0156ecd", "committedDate": "2020-12-15T12:10:29Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01125dea7d1f48e57a5ee74494e85a3ef0156ecd", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/01125dea7d1f48e57a5ee74494e85a3ef0156ecd", "committedDate": "2020-12-15T12:10:29Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "a5cdb1aac2496cf09011d52fb7d56f60e3c8863d", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a5cdb1aac2496cf09011d52fb7d56f60e3c8863d", "committedDate": "2020-12-15T13:18:21Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a5cdb1aac2496cf09011d52fb7d56f60e3c8863d", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a5cdb1aac2496cf09011d52fb7d56f60e3c8863d", "committedDate": "2020-12-15T13:18:21Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "114f7120e11105e8e7dab92a24a5650dd9aeb8c9", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/114f7120e11105e8e7dab92a24a5650dd9aeb8c9", "committedDate": "2020-12-15T14:55:24Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "114f7120e11105e8e7dab92a24a5650dd9aeb8c9", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/114f7120e11105e8e7dab92a24a5650dd9aeb8c9", "committedDate": "2020-12-15T14:55:24Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "03e77d1eebcdcff8917299cf24169594a6bba74d", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/03e77d1eebcdcff8917299cf24169594a6bba74d", "committedDate": "2020-12-15T17:08:54Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03e77d1eebcdcff8917299cf24169594a6bba74d", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/03e77d1eebcdcff8917299cf24169594a6bba74d", "committedDate": "2020-12-15T17:08:54Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "ba12145a91c148776b07eb2b665f6251dbafb947", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ba12145a91c148776b07eb2b665f6251dbafb947", "committedDate": "2020-12-16T11:31:31Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba12145a91c148776b07eb2b665f6251dbafb947", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/ba12145a91c148776b07eb2b665f6251dbafb947", "committedDate": "2020-12-16T11:31:31Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "5585abec835762a37aef47333e9c092f80283cc8", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5585abec835762a37aef47333e9c092f80283cc8", "committedDate": "2020-12-16T11:33:30Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37750308ddab684aba5c6fcaf49a3d84a215edf6", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/37750308ddab684aba5c6fcaf49a3d84a215edf6", "committedDate": "2020-12-17T09:57:19Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5585abec835762a37aef47333e9c092f80283cc8", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5585abec835762a37aef47333e9c092f80283cc8", "committedDate": "2020-12-16T11:33:30Z", "message": "Instrument spring-batch: chunk"}, "afterCommit": {"oid": "37750308ddab684aba5c6fcaf49a3d84a215edf6", "author": {"user": {"login": "mateuszrzeszutek", "name": "Mateusz Rzeszutek"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/37750308ddab684aba5c6fcaf49a3d84a215edf6", "committedDate": "2020-12-17T09:57:19Z", "message": "Instrument spring-batch: chunk"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0NjA4MjYw", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1850#pullrequestreview-554608260", "createdAt": "2020-12-17T13:36:14Z", "commit": {"oid": "37750308ddab684aba5c6fcaf49a3d84a215edf6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MTY2NDc4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1850#pullrequestreview-555166478", "createdAt": "2020-12-18T04:34:04Z", "commit": {"oid": "37750308ddab684aba5c6fcaf49a3d84a215edf6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwNDozNDowNVrOIISxaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwNDozNDowNVrOIISxaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTU2NzA4MQ==", "bodyText": "What's the use case for this flag by the way? It seems like it'd be nice if we can decide one or the other is better and stick with it", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1850#discussion_r545567081", "createdAt": "2020-12-18T04:34:05Z", "author": {"login": "anuraaga"}, "path": "instrumentation/spring/spring-batch-3.0/javaagent/src/main/java/io/opentelemetry/javaagent/instrumentation/spring/batch/chunk/ChunkExecutionTracer.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package io.opentelemetry.javaagent.instrumentation.spring.batch.chunk;\n+\n+import static io.opentelemetry.api.trace.Span.Kind.INTERNAL;\n+import static io.opentelemetry.javaagent.instrumentation.spring.batch.SpringBatchInstrumentationConfig.shouldCreateRootSpanForChunk;\n+\n+import io.opentelemetry.api.trace.Span;\n+import io.opentelemetry.api.trace.SpanBuilder;\n+import io.opentelemetry.api.trace.SpanContext;\n+import io.opentelemetry.context.Context;\n+import io.opentelemetry.instrumentation.api.tracer.BaseTracer;\n+import org.springframework.batch.core.scope.context.ChunkContext;\n+\n+public class ChunkExecutionTracer extends BaseTracer {\n+  private static final ChunkExecutionTracer TRACER = new ChunkExecutionTracer();\n+\n+  public static ChunkExecutionTracer tracer() {\n+    return TRACER;\n+  }\n+\n+  public Context startSpan(ChunkContext chunkContext) {\n+    String jobName = chunkContext.getStepContext().getJobName();\n+    String stepName = chunkContext.getStepContext().getStepName();\n+    SpanBuilder spanBuilder =\n+        tracer.spanBuilder(\"BatchJob \" + jobName + \".\" + stepName + \".Chunk\").setSpanKind(INTERNAL);\n+    if (shouldCreateRootSpanForChunk()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37750308ddab684aba5c6fcaf49a3d84a215edf6"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2156, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}