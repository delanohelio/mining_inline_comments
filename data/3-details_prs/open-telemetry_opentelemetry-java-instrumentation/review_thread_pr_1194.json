{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1NTk0ODM5", "number": 1194, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QxMzoyNjoxM1rOEi38IQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwMTo0MDoyMVrOEi73Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MDAzNTUzOnYy", "diffSide": "RIGHT", "path": "instrumentation/spring/spring-webflux-5.0/auto/src/test/resources/logback.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QxMzoyNjoxM1rOHQ8bvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwMTo1MjoxNlrOHRBgsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUyOTQwNw==", "bodyText": "Do we need these individual configuration files then?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487529407", "createdAt": "2020-09-13T13:26:13Z", "author": {"login": "iNikem"}, "path": "instrumentation/spring/spring-webflux-5.0/auto/src/test/resources/logback.xml", "diffHunk": "@@ -13,6 +13,6 @@\n     <appender-ref ref=\"console\"/>\n   </root>\n \n-  <logger name=\"io.opentelemetry.auto\" level=\"debug\"/>\n+  <logger name=\"io.opentelemetry\" level=\"debug\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "402b374548e4540fdc94ca8062302d86fae8bcdd"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMjU5NQ==", "bodyText": "ya, they are needed because these tests run Spring Boot, which overrides the logging level we set in AgentTestRunner. I added a comment to clarify.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487612595", "createdAt": "2020-09-14T01:52:16Z", "author": {"login": "trask"}, "path": "instrumentation/spring/spring-webflux-5.0/auto/src/test/resources/logback.xml", "diffHunk": "@@ -13,6 +13,6 @@\n     <appender-ref ref=\"console\"/>\n   </root>\n \n-  <logger name=\"io.opentelemetry.auto\" level=\"debug\"/>\n+  <logger name=\"io.opentelemetry\" level=\"debug\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUyOTQwNw=="}, "originalCommit": {"oid": "402b374548e4540fdc94ca8062302d86fae8bcdd"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MDY3ODAyOnYy", "diffSide": "RIGHT", "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwMTo0MDoyMVrOHRBXdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNTowMTowOVrOHRD8nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA==", "bodyText": "cc: @tylerbenson, I think this will fix that Cassandra test for you (DataDog/dd-trace-java#1802)", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487610230", "createdAt": "2020-09-14T01:40:21Z", "author": {"login": "trask"}, "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0NjE4Mw==", "bodyText": "Can you add to the PR description what happened?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487646183", "createdAt": "2020-09-14T04:33:42Z", "author": {"login": "anuraaga"}, "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, "originalCommit": {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY0ODE5MQ==", "bodyText": "\ud83d\udc4d done, it's a weird one, i can add more details if it is unclear", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487648191", "createdAt": "2020-09-14T04:42:57Z", "author": {"login": "trask"}, "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, "originalCommit": {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MDYxNA==", "bodyText": "Hmm - not too clear to me still but not sure if it ever would. Main question for me is why we didn't need that before all of our package renaming. Is it because instead of io.opentelemetry.javaagent we switched to the more generic io.opentelemetry?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487650614", "createdAt": "2020-09-14T04:53:08Z", "author": {"login": "anuraaga"}, "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, "originalCommit": {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MTYyNw==", "bodyText": "oh ya, scroll up just a bit, this code is inside of a conditional if (log.isDebugEnabled()) { which wasn't triggered until I fixed the debug logging in AgentTestRunner", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487651627", "createdAt": "2020-09-14T04:57:11Z", "author": {"login": "trask"}, "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, "originalCommit": {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MjUxMQ==", "bodyText": "as far as why we didn't need RedefinitionStrategy.DiscoveryStrategy.Reiterating, it's probably still not needed in prod situations because there aren't many classes already loaded when we install the agent, but it's different in tests where we apply instrumentation to some already loaded classes. in particular we already load guava classes, which is what caused the test issue with the Cassandra ListenableFuture test", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1194#discussion_r487652511", "createdAt": "2020-09-14T05:01:09Z", "author": {"login": "trask"}, "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/AgentInstaller.java", "diffHunk": "@@ -125,6 +125,7 @@ public static ResettableClassFileTransformer installBytebuddyAgent(\n       agentBuilder =\n           agentBuilder\n               .with(AgentBuilder.RedefinitionStrategy.RETRANSFORMATION)\n+              .with(AgentBuilder.RedefinitionStrategy.DiscoveryStrategy.Reiterating.INSTANCE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDIzMA=="}, "originalCommit": {"oid": "f5ac8f9c37a7b3703129dd9a72ee77dd8caf340a"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4906, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}