{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NTEzODQy", "number": 456, "title": "Merge changes from dd-trace-java 0.53.0", "bodyText": "https://github.com/DataDog/dd-trace-java/releases/tag/v0.53.0", "createdAt": "2020-05-30T19:57:06Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/456", "merged": true, "mergeCommit": {"oid": "96fa7b8c31fdfb056bbe2c18a319d821c85b215f"}, "closed": true, "closedAt": "2020-06-02T15:20:55Z", "author": {"login": "trask"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmjev4AFqTQyMTQ1OTExNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnWexVgFqTQyMjc4NzA3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDU5MTE2", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/456#pullrequestreview-421459116", "createdAt": "2020-05-31T03:51:39Z", "commit": {"oid": "51297ce023d962a5ce51ad998d0d08f2e598aedc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQwMzo1MTozOVrOGc2i1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQwMzo1MTozOVrOGc2i1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkwNjk2NQ==", "bodyText": "I am not sure about this attribute:\n\nIs this naming convention consistent? Do we already have attributes with names in snake_case?\nShould we produce \"derived\" attributes? Instead of 2 separate attributes \"startTime\" and \"produceTime\".\nIn any case would like to see at least a comment, explaining its meaning.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/456#discussion_r432906965", "createdAt": "2020-05-31T03:51:39Z", "author": {"login": "iNikem"}, "path": "instrumentation/kafka-clients-0.11/src/main/java/io/opentelemetry/auto/instrumentation/kafkaclients/KafkaDecorator.java", "diffHunk": "@@ -47,16 +48,21 @@ public String spanNameOnProduce(final ProducerRecord record) {\n     return \"destination\";\n   }\n \n-  public void onConsume(final Span span, final ConsumerRecord record) {\n+  public void onConsume(final Span span, final long startTimeMillis, final ConsumerRecord record) {\n     span.setAttribute(\"partition\", record.partition());\n     span.setAttribute(\"offset\", record.offset());\n+    // don't record a duration if the message was sent from an old Kafka client\n+    if (record.timestampType() != TimestampType.NO_TIMESTAMP_TYPE) {\n+      final long produceTime = record.timestamp();\n+      span.setAttribute(\"record.queue_time_ms\", Math.max(0L, startTimeMillis - produceTime));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51297ce023d962a5ce51ad998d0d08f2e598aedc"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b95290eb001acf8599b6d368d199c3c195a092d1", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/b95290eb001acf8599b6d368d199c3c195a092d1", "committedDate": "2020-06-01T22:18:56Z", "message": "Add time in queue (DataDog/dd-trace-java#1481)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "582610072e223a09c5b195fa67d7cd3c132b5d9b", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/582610072e223a09c5b195fa67d7cd3c132b5d9b", "committedDate": "2020-06-01T22:18:56Z", "message": "Replace Set<Integer> with BitSet for HTTP statuses (DataDog/dd-trace-java#1496)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4eb52066823dbf2ef5c6c6a1aa505b0bc987e43", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/e4eb52066823dbf2ef5c6c6a1aa505b0bc987e43", "committedDate": "2020-06-01T22:18:56Z", "message": "Minor upgrades (DataDog/dd-trace-java#1495)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ec8e3513049fb75625c2efd17963fa738b661f2", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/9ec8e3513049fb75625c2efd17963fa738b661f2", "committedDate": "2020-06-01T22:18:56Z", "message": "Allow user to disable kafka time in queue tag (DataDog/dd-trace-java#1487)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b71b0aa8c96b29864a8de02e6bbff7247b0ea252", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/b71b0aa8c96b29864a8de02e6bbff7247b0ea252", "committedDate": "2020-06-01T22:18:57Z", "message": "Register WeakMapProvider earlier in AgentInstaller (DataDog/dd-trace-java#1480)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f0c4b949275f06b37f15b978bb98b1579abb80f", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/8f0c4b949275f06b37f15b978bb98b1579abb80f", "committedDate": "2020-06-01T22:18:57Z", "message": "Update codenarc (DataDog/dd-trace-java#1500)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51297ce023d962a5ce51ad998d0d08f2e598aedc", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/51297ce023d962a5ce51ad998d0d08f2e598aedc", "committedDate": "2020-05-30T19:41:41Z", "message": "Update codenarc (DataDog/dd-trace-java#1500)"}, "afterCommit": {"oid": "8f0c4b949275f06b37f15b978bb98b1579abb80f", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/8f0c4b949275f06b37f15b978bb98b1579abb80f", "committedDate": "2020-06-01T22:18:57Z", "message": "Update codenarc (DataDog/dd-trace-java#1500)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzg3MDcy", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/456#pullrequestreview-422787072", "createdAt": "2020-06-02T15:20:39Z", "commit": {"oid": "8f0c4b949275f06b37f15b978bb98b1579abb80f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3183, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}