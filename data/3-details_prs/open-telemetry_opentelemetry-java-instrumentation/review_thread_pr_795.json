{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NzA1ODU0", "number": 795, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwNjowMjo1MVrOESHXkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwNjozMDoyMVrOESHfMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDMwNTQ1OnYy", "diffSide": "RIGHT", "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/instrumentation/api/SpanWithScope.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwNjowMjo1MVrOG3Jr2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwNjoxMToxMFrOG3Ju1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ4MzU0Ng==", "bodyText": "Don't think this is the old pattern, though it's not a big deal to document in detail either I think.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/795#discussion_r460483546", "createdAt": "2020-07-26T06:02:51Z", "author": {"login": "anuraaga"}, "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/instrumentation/api/SpanWithScope.java", "diffHunk": "@@ -19,7 +19,62 @@\n import io.opentelemetry.context.Scope;\n import io.opentelemetry.trace.Span;\n \n-// intentionally (for now) not implementing Closeable since not clear what it would close\n+/**\n+ * This is deprecated.\n+ *\n+ * <p>Originally, we used {@code SpanWithScope} to pass the {@link Span} and {@link Scope} between\n+ * {@code @Advice.OnMethodEnter} and {@code @Advice.OnMethodExit}, e.g.\n+ *\n+ * <pre>\n+ *   &#64;Advice.OnMethodEnter(...)\n+ *   public static CallDepth onEnter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0952cce0525562ed745fe59d7542552e371fb61b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ4NDMxMA==", "bodyText": "thx! bad copy-paste \ud83d\ude02", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/795#discussion_r460484310", "createdAt": "2020-07-26T06:11:10Z", "author": {"login": "trask"}, "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/instrumentation/api/SpanWithScope.java", "diffHunk": "@@ -19,7 +19,62 @@\n import io.opentelemetry.context.Scope;\n import io.opentelemetry.trace.Span;\n \n-// intentionally (for now) not implementing Closeable since not clear what it would close\n+/**\n+ * This is deprecated.\n+ *\n+ * <p>Originally, we used {@code SpanWithScope} to pass the {@link Span} and {@link Scope} between\n+ * {@code @Advice.OnMethodEnter} and {@code @Advice.OnMethodExit}, e.g.\n+ *\n+ * <pre>\n+ *   &#64;Advice.OnMethodEnter(...)\n+ *   public static CallDepth onEnter(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ4MzU0Ng=="}, "originalCommit": {"oid": "0952cce0525562ed745fe59d7542552e371fb61b"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDMyNDk3OnYy", "diffSide": "RIGHT", "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/instrumentation/api/SpanWithScope.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwNjozMDoyMVrOG3J1GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwNjozMDoyMVrOG3J1GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ4NTkxMw==", "bodyText": "I think it deserves the explanation: why are we migrating? What was bad with old approach? Document your decisions, not actions :)", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/795#discussion_r460485913", "createdAt": "2020-07-26T06:30:21Z", "author": {"login": "iNikem"}, "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/instrumentation/api/SpanWithScope.java", "diffHunk": "@@ -19,7 +19,59 @@\n import io.opentelemetry.context.Scope;\n import io.opentelemetry.trace.Span;\n \n-// intentionally (for now) not implementing Closeable since not clear what it would close\n+/**\n+ * This is deprecated.\n+ *\n+ * <p>Originally, we used {@code SpanWithScope} to pass the {@link Span} and {@link Scope} between\n+ * {@code @Advice.OnMethodEnter} and {@code @Advice.OnMethodExit}, e.g.\n+ *\n+ * <pre>\n+ *   &#64;Advice.OnMethodEnter(...)\n+ *     public static SpanWithScope onEnter(...) {\n+ *     ...\n+ *     Span span = ...\n+ *     return new SpanWithScope(span, currentContextWith(span));\n+ *   }\n+ *\n+ *   &#64;Advice.OnMethodExit(...)\n+ *   public static void stopSpan(\n+ *       ...\n+ *       &#64;Advice.Enter final SpanWithScope spanWithScope) {\n+ *     Span span = spanWithScope.getSpan();\n+ *     ...\n+ *     span.end();\n+ *     spanWithScope.closeScope();\n+ *   }\n+ * </pre>\n+ *\n+ * But we are (slowly) migrating to a new style using {@code @Advice.Local} that doesn't require", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c32d1fa881439da74b5a68bf2c5163e526323af9"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 152, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}