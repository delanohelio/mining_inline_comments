{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0NDU2MDQy", "number": 1398, "title": "Add operation and collection attributes for MongoDB spans", "bodyText": "This change introduces db.operation and db.mongodb.collection attributes to the mongo client instrumentation. Because there is no common functionality for db.operation in DatabaseClientTracer we are just overriding onConnect to add mongo specific attributes.\nIn the future, this should be refactored when db.operation is added across all db instrumetnation.\nFixes #1278", "createdAt": "2020-10-15T23:37:22Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1398", "merged": true, "mergeCommit": {"oid": "69ea2f7491260e2eeb66c3efd1a1c9fb215f4c69"}, "closed": true, "closedAt": "2020-10-19T06:20:47Z", "author": {"login": "jamal"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdS5LfsgH2gAyNTA0NDU2MDQyOjg4YTA2NDE1ZTUxMGM4YTEzYTUwMGY2ZDcxNGY3YmI3YjI4ZThlNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdT-EVtgFqTUxMTQzOTYwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "88a06415e510c8a13a500f6d714f7bb7b28e8e65", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/88a06415e510c8a13a500f6d714f7bb7b28e8e65", "committedDate": "2020-10-15T22:05:01Z", "message": "Add mongodb attributes for operation and collection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8836c71a27ccf74d523129d25208cddf9fc7fd08", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/8836c71a27ccf74d523129d25208cddf9fc7fd08", "committedDate": "2020-10-15T23:09:55Z", "message": "Switch to using SemanticAttributes.MONGODB_COLLECTION"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e92fb143e0512a4df2038858fed322ab98c84b9", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3e92fb143e0512a4df2038858fed322ab98c84b9", "committedDate": "2020-10-15T23:20:16Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fc15f094de9a39548be50d274d1208f0e4c4efe", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/0fc15f094de9a39548be50d274d1208f0e4c4efe", "committedDate": "2020-10-15T23:32:42Z", "message": "Fix import order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNzExMTE5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1398#pullrequestreview-510711119", "createdAt": "2020-10-16T18:30:55Z", "commit": {"oid": "0fc15f094de9a39548be50d274d1208f0e4c4efe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxODozMDo1NVrOHjLtAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxODozMDo1NVrOHjLtAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY1Mzk1Mg==", "bodyText": "if we swap args moving operation and collection before the Closure, then could still use the groovy closure syntax", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1398#discussion_r506653952", "createdAt": "2020-10-16T18:30:55Z", "author": {"login": "trask"}, "path": "instrumentation/mongo/mongo-async-3.3/src/test/groovy/MongoAsyncClientTest.groovy", "diffHunk": "@@ -59,11 +59,11 @@ class MongoAsyncClientTest extends MongoBaseTest {\n     then:\n     assertTraces(1) {\n       trace(0, 1) {\n-        mongoSpan(it, 0) {\n+        mongoSpan(it, 0, {\n           assert it.replaceAll(\" \", \"\") == \"{\\\"create\\\":\\\"$collectionName\\\",\\\"capped\\\":\\\"?\\\"}\" ||\n             it == \"{\\\"create\\\": \\\"$collectionName\\\", \\\"capped\\\": \\\"?\\\", \\\"\\$db\\\": \\\"?\\\", \\\"\\$readPreference\\\": {\\\"mode\\\": \\\"?\\\"}}\"\n           true\n-        }\n+        }, \"create\", collectionName)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fc15f094de9a39548be50d274d1208f0e4c4efe"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "927d44a715a6300f12d58ead9975653af82252ed", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/927d44a715a6300f12d58ead9975653af82252ed", "committedDate": "2020-10-17T00:50:01Z", "message": "Fix formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26fff3b98318127a628b826e91294a1725b72d7e", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/26fff3b98318127a628b826e91294a1725b72d7e", "committedDate": "2020-10-17T01:18:29Z", "message": "Update tests to keep more readable closure syntax"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c53885e2be01f20bee6c2af9c94b33472120b97e", "author": {"user": {"login": "jamal", "name": "Jamal Fanaian"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/c53885e2be01f20bee6c2af9c94b33472120b97e", "committedDate": "2020-10-17T02:09:22Z", "message": "Run spotlessApply"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwOTI2MDQ1", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1398#pullrequestreview-510926045", "createdAt": "2020-10-17T04:45:05Z", "commit": {"oid": "c53885e2be01f20bee6c2af9c94b33472120b97e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNDM5NjAz", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1398#pullrequestreview-511439603", "createdAt": "2020-10-19T06:20:39Z", "commit": {"oid": "c53885e2be01f20bee6c2af9c94b33472120b97e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2343, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}