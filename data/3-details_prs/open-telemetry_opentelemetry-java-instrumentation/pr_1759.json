{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3MTY4Mjcx", "number": 1759, "title": "Add an AWS SDK type instrumentation on an 'entry point' type of class\u2026", "bodyText": "\u2026 to ensure helper resources are injected before clients are made.\nWorking on #1643 brought to light that currently the AWS SDK type instrumentation runs too late since it only matches against MakeHttpRequestStage currently, something that happens during an SDK request. So the resource helper which registers our tracer only gets added after the first request is made, missing the first SDK client that is constructed. This currently isn't triggered by unit tests since the resource ends up on the classpath anyways without any injection.", "createdAt": "2020-11-25T05:54:20Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1759", "merged": true, "mergeCommit": {"oid": "9802539b07d4258eac88188caed67d05104c95e5"}, "closed": true, "closedAt": "2020-11-25T09:21:07Z", "author": {"login": "anuraaga"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf32CCgH2gAyNTI3MTY4MjcxOmE4MDBkYjI2MTliNDZiMmY5NTU5NTNmMzk3ZjlmZWFmN2Y3YjI0Njg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdf6maIAFqTUzODI4MjkyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a800db2619b46b2f955953f397f9feaf7f7b2468", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a800db2619b46b2f955953f397f9feaf7f7b2468", "committedDate": "2020-11-25T05:52:41Z", "message": "Add an AWS SDK type instrumentation on an 'entry point' type of class to ensure helper resources are injected before clients are made."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MTc3Mzk5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1759#pullrequestreview-538177399", "createdAt": "2020-11-25T05:58:57Z", "commit": {"oid": "a800db2619b46b2f955953f397f9feaf7f7b2468"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNTo1ODo1OFrOH5kQuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNTo1ODo1OFrOH5kQuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEyNDk4NQ==", "bodyText": "to avoid race condition with #1752\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            final class AwsSdkInitializationInstrumentation implements TypeInstrumentation {\n          \n          \n            \n            public class AwsSdkInitializationInstrumentation implements TypeInstrumentation {", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1759#discussion_r530124985", "createdAt": "2020-11-25T05:58:58Z", "author": {"login": "trask"}, "path": "instrumentation/aws-sdk/aws-sdk-2.2/javaagent/src/main/java/io/opentelemetry/javaagent/instrumentation/awssdk/v2_2/AwsSdkInitializationInstrumentation.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package io.opentelemetry.javaagent.instrumentation.awssdk.v2_2;\n+\n+import static net.bytebuddy.matcher.ElementMatchers.named;\n+\n+import io.opentelemetry.javaagent.tooling.TypeInstrumentation;\n+import java.util.Collections;\n+import java.util.Map;\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.description.type.TypeDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+\n+final class AwsSdkInitializationInstrumentation implements TypeInstrumentation {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a800db2619b46b2f955953f397f9feaf7f7b2468"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "534ddaf5248476da7cd5b3412ae12608e53a4eae", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/534ddaf5248476da7cd5b3412ae12608e53a4eae", "committedDate": "2020-11-25T07:09:33Z", "message": "Update instrumentation/aws-sdk/aws-sdk-2.2/javaagent/src/main/java/io/opentelemetry/javaagent/instrumentation/awssdk/v2_2/AwsSdkInitializationInstrumentation.java\n\nCo-authored-by: Trask Stalnaker <trask.stalnaker@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MjgyOTIw", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1759#pullrequestreview-538282920", "createdAt": "2020-11-25T09:05:20Z", "commit": {"oid": "534ddaf5248476da7cd5b3412ae12608e53a4eae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2076, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}