{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4ODIyNzgz", "number": 109, "title": "Bring back Kafka Streams, RabbitMQ, and AWS Java SDK 2.2 instrumentation", "bodyText": "See #50", "createdAt": "2020-01-29T23:49:07Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/109", "merged": true, "mergeCommit": {"oid": "54cb6dc538ed10092105121040218dc0d7f2fd24"}, "closed": true, "closedAt": "2020-02-04T18:41:40Z", "author": {"login": "trask"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_OzwxAH2gAyMzY4ODIyNzgzOmE0NmRiMGZhNDI2Y2Q0MjEwMWE2Mzc2NjNjMTYxYjMxZDJkMTFlNGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBGBFIgFqTM1MzIxMDI1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a46db0fa426cd42101a637663c161b31d2d11e4e", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a46db0fa426cd42101a637663c161b31d2d11e4e", "committedDate": "2020-01-29T23:47:22Z", "message": "Bring back Kafka Streams instrumentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2bee6ed38e1bbe1d238686f09d713351afcb130", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/c2bee6ed38e1bbe1d238686f09d713351afcb130", "committedDate": "2020-01-29T23:47:22Z", "message": "Bring back AWS Java SDK 2.2 instrumentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc00e32c341ff18c31d5f20bfbe1d00b0b9817e5", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/fc00e32c341ff18c31d5f20bfbe1d00b0b9817e5", "committedDate": "2020-01-30T00:35:32Z", "message": "Bring back RabbitMQ instrumentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c3d0e28ed4218f4150306ffc4a5c6521cfcccf7", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3c3d0e28ed4218f4150306ffc4a5c6521cfcccf7", "committedDate": "2020-02-01T21:11:22Z", "message": "Merge remote-tracking branch 'upstream/master' into bring-back-some-instrumentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55299a5ddbb04f8b1fc1b6560f8c1c36c8b42f3c", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/55299a5ddbb04f8b1fc1b6560f8c1c36c8b42f3c", "committedDate": "2020-02-01T21:43:11Z", "message": "Fix merge"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMTkwMjYx", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/109#pullrequestreview-351190261", "createdAt": "2020-01-30T22:35:48Z", "commit": {"oid": "fc00e32c341ff18c31d5f20bfbe1d00b0b9817e5"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQyMjozNTo0OFrOFj8N9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQyMjozNzoxMFrOFj8QFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIzMTA5NQ==", "bodyText": "I think this is acceptable and probably a better option than relying on activeSpan().  Any risk of this getting out of sync somehow?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/109#discussion_r373231095", "createdAt": "2020-01-30T22:35:48Z", "author": {"login": "tylerbenson"}, "path": "instrumentation/kafka-streams-0.11/src/main/java/io/opentelemetry/auto/instrumentation/kafka_streams/KafkaStreamsProcessorInstrumentation.java", "diffHunk": "@@ -35,6 +32,10 @@\n   // Also this instrumentation doesn't define 'producer' making it 'asymmetric' - resulting\n   // in awkward tests and traces. We may want to revisit this in the future.\n \n+  public static class SpanScopeHolder {\n+    public static final ThreadLocal<SpanScopePair> CURRENT = new ThreadLocal<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc00e32c341ff18c31d5f20bfbe1d00b0b9817e5"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIzMTYzOA==", "bodyText": "Static import CURRENT", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/109#discussion_r373231638", "createdAt": "2020-01-30T22:37:10Z", "author": {"login": "tylerbenson"}, "path": "instrumentation/aws-java-sdk-2.2/src/main/java/io/opentelemetry/auto/instrumentation/aws/v2/AwsHttpClientInstrumentation.java", "diffHunk": "@@ -58,8 +57,9 @@\n     @Advice.OnMethodEnter(suppress = Throwable.class)\n     public static boolean methodEnter(@Advice.This final Object thiz) {\n       if (thiz instanceof MakeAsyncHttpRequestStage) {\n-        final AgentScope scope = activeScope();\n+        final Scope scope = TracingExecutionInterceptor.ScopeHolder.CURRENT.get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc00e32c341ff18c31d5f20bfbe1d00b0b9817e5"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f214ebec206b86f2da4fb511c0587b7e77de573", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/6f214ebec206b86f2da4fb511c0587b7e77de573", "committedDate": "2020-02-03T20:42:33Z", "message": "Static import CURRENT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3275f0b927c4f38c7ace89cf8170cb2c953d26cb", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3275f0b927c4f38c7ace89cf8170cb2c953d26cb", "committedDate": "2020-02-03T20:44:25Z", "message": "Merge branch 'master' into bring-back-some-instrumentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ba43410f7df187b19a36bfd401da54f38024452", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3ba43410f7df187b19a36bfd401da54f38024452", "committedDate": "2020-02-03T21:44:46Z", "message": "Remove outdated comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d39d0858a4a480f44af5b5f1c4062337c724e873", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/d39d0858a4a480f44af5b5f1c4062337c724e873", "committedDate": "2020-02-03T23:03:48Z", "message": "Make kafka streams instrumentation more future proof"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38c829efeafe7280cea94352e4e0be67f45070ed", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/38c829efeafe7280cea94352e4e0be67f45070ed", "committedDate": "2020-02-04T00:46:24Z", "message": "Fix muzzle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b8dc605fb9374abfdbb91c4d5b06744daaed6c9", "author": {"user": {"login": "trask", "name": "Trask Stalnaker"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3b8dc605fb9374abfdbb91c4d5b06744daaed6c9", "committedDate": "2020-02-04T17:34:20Z", "message": "Simplify"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMjEwMjU2", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/109#pullrequestreview-353210256", "createdAt": "2020-02-04T18:40:37Z", "commit": {"oid": "3b8dc605fb9374abfdbb91c4d5b06744daaed6c9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3378, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}