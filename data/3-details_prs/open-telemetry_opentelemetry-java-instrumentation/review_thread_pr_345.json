{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3OTg5OTE0", "number": 345, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMjo1MzozMVrOD1kFVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMjo1MzozMVrOD1kFVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NDkyMzA5OnYy", "diffSide": "RIGHT", "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "isResolved": false, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMjo1MzozMVrOGLEFSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMDowMzo0OVrOGLnReg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              static {\n          \n          \n            \n                ConfigUtils.updateConfig {\n          \n          \n            \n                  System.clearProperty(\"ota.trace.annotations\")\n          \n          \n            \n                  System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n          \n          \n            \n                }\n          \n          \n            \n              }\n          \n          \n            \n            \n          \n          \n            \n              def specCleanup() {\n          \n          \n            \n                ConfigUtils.updateConfig {\n          \n          \n            \n                  System.clearProperty(\"ota.trace.classes.exclude\")\n          \n          \n            \n                }\n          \n          \n            \n              }\n          \n      \n    \n    \n  \n\nIs this needed?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414254409", "createdAt": "2020-04-24T02:53:31Z", "author": {"login": "trask"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI3NjQ4Mg==", "bodyText": "Specifying ota.trace.classes.exclude will stop instrumenting this test class itself. For me it polluted the log during test run. And I assume it adds some overhead to test running as well. I think all tests would benefit from this exclusion.\nHaving non-empty ota.trace.annotations will turn off default annotations list and this will result in this test failing.\nThus I think this configuration should stay.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414276482", "createdAt": "2020-04-24T04:05:40Z", "author": {"login": "iNikem"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ=="}, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI3OTk5Mw==", "bodyText": "Ah, makes sense. Can that change be made globally in AgentTestRunner (with a comment, so we don't accidentally remove it later thinking it's not needed)? Also, maybe this change would be better in a separate PR?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414279993", "createdAt": "2020-04-24T04:16:22Z", "author": {"login": "trask"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ=="}, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI4MDk5OA==", "bodyText": "So I will leave this PR as it is and will do a new PR where I will add ota.trace.classes.exclude to AgentTestRunner? Sounds good.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414280998", "createdAt": "2020-04-24T04:19:35Z", "author": {"login": "iNikem"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ=="}, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI4MTM1Mw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414281353", "createdAt": "2020-04-24T04:20:57Z", "author": {"login": "trask"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ=="}, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDUzNTI0NQ==", "bodyText": "@trask Unfortunately it turns out that we cannot just globally apply class exclusion for all test classes. Some of them, e.g. ExecutorInstrumentationTest expect that their inner classes get instrumented during test. So that would require reviewing existing test and stricter rules for future ones. Will drop this until the benefit is clear.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414535245", "createdAt": "2020-04-24T12:25:01Z", "author": {"login": "iNikem"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ=="}, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDgzMDk3MA==", "bodyText": "ok, makes sense. do u mind removing, or adding a comment explaining, the usage in TraceProvidersTest.groovy then?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/345#discussion_r414830970", "createdAt": "2020-04-24T20:03:49Z", "author": {"login": "trask"}, "path": "instrumentation/trace-annotation/src/test/groovy/TraceProvidersTest.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import io.opentelemetry.auto.test.AgentTestRunner\n+import io.opentelemetry.auto.test.utils.ConfigUtils\n+import io.opentelemetry.test.annotation.SayTracedHello\n+\n+/**\n+ * This test verifies that Otel supports various 3rd-party trace annotations\n+ */\n+class TraceProvidersTest extends AgentTestRunner {\n+\n+  static {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.annotations\")\n+      System.setProperty(\"ota.trace.classes.exclude\", TraceProvidersTest.name + \"*\")\n+    }\n+  }\n+\n+  def specCleanup() {\n+    ConfigUtils.updateConfig {\n+      System.clearProperty(\"ota.trace.classes.exclude\")\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI1NDQwOQ=="}, "originalCommit": {"oid": "82754fef823f59d48e32fb22d2ae826d98c10e0f"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 536, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}