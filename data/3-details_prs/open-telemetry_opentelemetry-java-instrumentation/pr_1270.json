{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzNzQ3NjA2", "number": 1270, "title": "Add high level Muzzle docs", "bodyText": "Updates #536", "createdAt": "2020-09-27T16:57:29Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270", "merged": true, "mergeCommit": {"oid": "f48579a84f5fff22b3973d9b12c46d8cccef13cd"}, "closed": true, "closedAt": "2020-09-29T19:46:08Z", "author": {"login": "pavolloffay"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNEBvFAFqTQ5NzEwMzcyMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNrjtDABqjM4MjA4MzU5OTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MTAzNzIw", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497103720", "createdAt": "2020-09-27T19:14:39Z", "commit": {"oid": "434b0d2c03240bd525af615073ae719f185f5045"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxOToxNDozOVrOHYpV3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxOToxNjoyMFrOHYpWlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTYwNTIxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            on the application classpath. The Muzzle can prevent loading an instrumentation\n          \n          \n            \n            on the application classpath. The Muzzle will prevent loading an instrumentation", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r495605212", "createdAt": "2020-09-27T19:14:39Z", "author": {"login": "trask"}, "path": "buildSrc/muzzle.md", "diffHunk": "@@ -0,0 +1,27 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle can prevent loading an instrumentation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "434b0d2c03240bd525af615073ae719f185f5045"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTYwNTI5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            At build time the Muzzle gradle plugin generates matcher for 3rd party APIs used by the agent.\n          \n          \n            \n            At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r495605295", "createdAt": "2020-09-27T19:15:22Z", "author": {"login": "trask"}, "path": "buildSrc/muzzle.md", "diffHunk": "@@ -0,0 +1,27 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle can prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates matcher for 3rd party APIs used by the agent.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "434b0d2c03240bd525af615073ae719f185f5045"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTYwNTM5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            and symbols at the application classpath. Before inspecting the classpath\n          \n          \n            \n            and symbols in the application class loader. Before inspecting the class loader", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r495605399", "createdAt": "2020-09-27T19:16:20Z", "author": {"login": "trask"}, "path": "buildSrc/muzzle.md", "diffHunk": "@@ -0,0 +1,27 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle can prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols at the application classpath. Before inspecting the classpath", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "434b0d2c03240bd525af615073ae719f185f5045"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MjE5NDA4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497219408", "createdAt": "2020-09-28T06:33:26Z", "commit": {"oid": "434b0d2c03240bd525af615073ae719f185f5045"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c905927675d119b60e7da77c3d8c88e14a219670", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/c905927675d119b60e7da77c3d8c88e14a219670", "committedDate": "2020-09-28T06:34:34Z", "message": "Review comments\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}, "afterCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/264109fd69c3adea808dc35cdf596b6d30f0b503", "committedDate": "2020-09-28T06:35:41Z", "message": "Review comments\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MjIxNTE4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497221518", "createdAt": "2020-09-28T06:37:48Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNjozNzo0OFrOHYwMBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNjozNzo0OFrOHYwMBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxNzM4Mg==", "bodyText": "Is this correct? In this location there is MuzzleGradlePlugin but it more seems like ByteBuddy plugin as it implements bytebuddy plugin interface.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r495717382", "createdAt": "2020-09-28T06:37:48Z", "author": {"login": "pavolloffay"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`\n+as a performance optimization. If the symbols do not match the instrumentation\n+is not loaded.\n+\n+## Muzzle gradle plugin\n+\n+The `printReferences` task prints 3rd party API references in a given module.\n+\n+```bash\n+./gradlew :instrumentation:google-http-client-1.19:printReferences\n+```\n+\n+## Muzzle location\n+\n+* `buildSrc` - Muzzle Gradle plugin\n+* `agent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/muzzle` - Muzzle ByteBuddy plugin", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MjcwMTU4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497270158", "createdAt": "2020-09-28T07:57:54Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNzo1Nzo1NVrOHYydHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNzo1Nzo1NVrOHYydHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTc1NDUyNg==", "bodyText": "Do you mean classLoaderMatcher?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r495754526", "createdAt": "2020-09-28T07:57:55Z", "author": {"login": "iNikem"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NjAyOTM5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497602939", "createdAt": "2020-09-28T14:47:23Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDo0NzoyNFrOHZBNaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDo0NzoyNFrOHZBNaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTk5NjI2NA==", "bodyText": "This part of muzzle isn't really documented above.  This plugin is responsible for downloading the range of libraries from Maven Central and verifying expected compatibility.  If a new incompatible version is published, this is what will break the build.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r495996264", "createdAt": "2020-09-28T14:47:24Z", "author": {"login": "tylerbenson"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`\n+as a performance optimization. If the symbols do not match the instrumentation\n+is not loaded.\n+\n+## Muzzle gradle plugin\n+\n+The `printReferences` task prints 3rd party API references in a given module.\n+\n+```bash\n+./gradlew :instrumentation:google-http-client-1.19:printReferences\n+```\n+\n+## Muzzle location\n+\n+* `buildSrc` - Muzzle Gradle plugin", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NjQxMzI3", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497641327", "createdAt": "2020-09-28T15:21:59Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNToyMTo1OVrOHZDkkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNToyMTo1OVrOHZDkkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzNDk2MQ==", "bodyText": "It prints all references that are collected & later validated by muzzle -- not only the 3rd party ones.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r496034961", "createdAt": "2020-09-28T15:21:59Z", "author": {"login": "mateuszrzeszutek"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`\n+as a performance optimization. If the symbols do not match the instrumentation\n+is not loaded.\n+\n+## Muzzle gradle plugin\n+\n+The `printReferences` task prints 3rd party API references in a given module.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NjQzNTAy", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497643502", "createdAt": "2020-09-28T15:24:10Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNToyNDoxMVrOHZDulA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNToyNDoxMVrOHZDulA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzNzUyNA==", "bodyText": "Muzzle actually collects symbols from advice classes -- values of the map returned by transformers() method. Muzzle by itself calls neither classLoaderMatcher() nor typeMatcher().", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r496037524", "createdAt": "2020-09-28T15:24:11Z", "author": {"login": "mateuszrzeszutek"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NjU3ODU0", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497657854", "createdAt": "2020-09-28T15:39:22Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTozOToyMlrOHZEZUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTozOToyMlrOHZEZUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA0ODQ2Ng==", "bodyText": "Can you add a sentence explaining where do the symbols come from?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n          \n          \n            \n            The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n          \n          \n            \n            At build time, for each instrumentation the Muzzle ByteBuddy plugin collects symbols referring to both internal and 3rd party APIs used by the currently processed instrumentation. The reference collection process starts from advice classes - values of the map returned by the `Instrumenter.Default#transformers()` method.\n          \n          \n            \n            All those references are then used to create a `ReferenceMatcher` instance.\n          \n          \n            \n            The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r496048466", "createdAt": "2020-09-28T15:39:22Z", "author": {"login": "mateuszrzeszutek"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NjYxNTU5", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497661559", "createdAt": "2020-09-28T15:43:38Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3OTY3NzQ2", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-497967746", "createdAt": "2020-09-28T23:36:55Z", "commit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQyMzozNjo1NlrOHZTTag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQyMzo0OTowOFrOHZThmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjI5MjcxNA==", "bodyText": "this is nice, i'm not sure about \"internal\" APIs though, we do currently, but hopefully we won't after #1233?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r496292714", "createdAt": "2020-09-28T23:36:56Z", "author": {"login": "trask"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA0ODQ2Ng=="}, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjI5NjAyNw==", "bodyText": "another suggestion \ud83d\ude04\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            and symbols in the application class loader. Before inspecting the class loader\n          \n          \n            \n            the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`\n          \n          \n            \n            as a performance optimization. If the symbols do not match the instrumentation\n          \n          \n            \n            is not loaded.\n          \n          \n            \n            and symbols in the application class loader. If the symbols do not match the instrumentation is not loaded.\n          \n          \n            \n            Because the muzzle matcher is expensive, it is only performed after a match has been made by the `classLoaderMatcher()` and `typeMatcher()` matchers.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r496296027", "createdAt": "2020-09-28T23:47:57Z", "author": {"login": "trask"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`\n+as a performance optimization. If the symbols do not match the instrumentation\n+is not loaded.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjI5NjM0Nw==", "bodyText": "I'm hoping we can optimize it to only check 3rd party ones", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#discussion_r496296347", "createdAt": "2020-09-28T23:49:08Z", "author": {"login": "trask"}, "path": "docs/contributing/muzzle.md", "diffHunk": "@@ -0,0 +1,32 @@\n+# Muzzle\n+\n+Muzzle is a feature of the Java agent that ensures API compatibility\n+between libraries/symbols on the application classpath and APIs of instrumented\n+3rd party libraries used by the Agent. In other words the Muzzle ensures\n+that the API symbols used by the Agent are compatible with API symbols\n+on the application classpath. The Muzzle will prevent loading an instrumentation\n+if the APIs do not match.\n+\n+## How does it work\n+\n+At build time the Muzzle gradle plugin generates a matcher for 3rd party APIs used by the agent.\n+The matcher is stored in the instrumentation class in method `ReferenceMatcher getInstrumentationMuzzle()`.\n+\n+At runtime the Muzzle checks API compatibility between symbols used by the Agent\n+and symbols in the application class loader. Before inspecting the class loader\n+the Muzzle plugin checks symbols defined in `SomeInstrumentation.typeMatcher()`\n+as a performance optimization. If the symbols do not match the instrumentation\n+is not loaded.\n+\n+## Muzzle gradle plugin\n+\n+The `printReferences` task prints 3rd party API references in a given module.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzNDk2MQ=="}, "originalCommit": {"oid": "264109fd69c3adea808dc35cdf596b6d30f0b503"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NjcwMDAy", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1270#pullrequestreview-498670002", "createdAt": "2020-09-29T16:26:41Z", "commit": {"oid": "56e5f656e084262dc31a5fb29e7c27110f1d2f29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b65bb0d67b48c080652bc3bf21af59ad8785e2b8", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/b65bb0d67b48c080652bc3bf21af59ad8785e2b8", "committedDate": "2020-09-29T17:23:02Z", "message": "Add high level muzzle docs\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fbb9ca48925c28694c46188f4b159cfdc5cd75b", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/9fbb9ca48925c28694c46188f4b159cfdc5cd75b", "committedDate": "2020-09-29T17:23:02Z", "message": "docs\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94e70eee36df1a56a8b650533eb9faac62cae23e", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/94e70eee36df1a56a8b650533eb9faac62cae23e", "committedDate": "2020-09-29T17:23:02Z", "message": "Review comments\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bdb30b9b4ecd2c1828a3d89d0722f05bc0a63ac", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/0bdb30b9b4ecd2c1828a3d89d0722f05bc0a63ac", "committedDate": "2020-09-29T17:23:02Z", "message": "Review comments\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e531e97fbcafbe339db30ead1ffc45a9d12d9ce1", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/e531e97fbcafbe339db30ead1ffc45a9d12d9ce1", "committedDate": "2020-09-29T17:23:02Z", "message": "style\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56e5f656e084262dc31a5fb29e7c27110f1d2f29", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/56e5f656e084262dc31a5fb29e7c27110f1d2f29", "committedDate": "2020-09-29T06:41:15Z", "message": "Review comments\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}, "afterCommit": {"oid": "e531e97fbcafbe339db30ead1ffc45a9d12d9ce1", "author": {"user": {"login": "pavolloffay", "name": "Pavol Loffay"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/e531e97fbcafbe339db30ead1ffc45a9d12d9ce1", "committedDate": "2020-09-29T17:23:02Z", "message": "style\n\nSigned-off-by: Pavol Loffay <ploffay@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2656, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}