{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzMTM2NDcy", "number": 1383, "title": "Add server interceptor to end in javaagent because they are run in re\u2026", "bodyText": "\u2026verse order.\n/cc @asarkar This fixes the javaagent which also made the wrong assumption that server interceptors are run in order. But you may be able to get some inspiration from the unit test changes.", "createdAt": "2020-10-14T06:16:07Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1383", "merged": true, "mergeCommit": {"oid": "30e75c6d6d1b13b8b08874e5d7bc641fcd9a683f"}, "closed": true, "closedAt": "2020-10-14T23:50:15Z", "author": {"login": "anuraaga"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSW_dhAH2gAyNTAzMTM2NDcyOjNmNGU3MGRkODBiZTQyNzkxN2IzZmVkZTAxZTNjZmY4YTUyODBhZjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSlRargFqTUwODgyNjA4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3f4e70dd80be427917b3fede01e3cff8a5280af6", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3f4e70dd80be427917b3fede01e3cff8a5280af6", "committedDate": "2020-10-14T06:15:06Z", "message": "Add server interceptor to end in javaagent because they are run in reverse order."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDI0NjA0", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1383#pullrequestreview-508024604", "createdAt": "2020-10-14T06:17:27Z", "commit": {"oid": "3f4e70dd80be427917b3fede01e3cff8a5280af6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjoxNzoyOFrOHhDwlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwNjoxNzoyOFrOHhDwlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQyNjY0NQ==", "bodyText": "This was wrong in my previous change, naturally just like TracingServerInterceptor, any interceptor that modifies context must use Contexts.interceptCall to make sure it's propagated.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1383#discussion_r504426645", "createdAt": "2020-10-14T06:17:28Z", "author": {"login": "anuraaga"}, "path": "instrumentation/grpc-1.5/testing/src/main/groovy/io/opentelemetry/instrumentation/grpc/v1_5/AbstractGrpcTest.groovy", "diffHunk": "@@ -323,25 +324,26 @@ abstract class AbstractGrpcTest extends InstrumentationSpecification {\n     def port = PortUtils.randomOpenPort()\n     Server server\n     server = configureServer(ServerBuilder.forPort(port)\n-      .addService(greeter))\n+      .addService(greeter)\n       .intercept(new ServerInterceptor() {\n         @Override\n         <ReqT, RespT> ServerCall.Listener<ReqT> interceptCall(ServerCall<ReqT, RespT> call, Metadata headers, ServerCallHandler<ReqT, RespT> next) {\n-          def ctx = Context.current().withValue(key, \"meow\")\n-          def oldCtx = ctx.attach()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f4e70dd80be427917b3fede01e3cff8a5280af6"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDYzMDI1", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1383#pullrequestreview-508063025", "createdAt": "2020-10-14T07:25:26Z", "commit": {"oid": "3f4e70dd80be427917b3fede01e3cff8a5280af6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MjEyOTAz", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1383#pullrequestreview-508212903", "createdAt": "2020-10-14T10:35:28Z", "commit": {"oid": "3f4e70dd80be427917b3fede01e3cff8a5280af6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4ODI2MDg1", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1383#pullrequestreview-508826085", "createdAt": "2020-10-14T22:53:23Z", "commit": {"oid": "3f4e70dd80be427917b3fede01e3cff8a5280af6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2323, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}