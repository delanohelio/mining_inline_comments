{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0Nzc4ODg4", "number": 1403, "title": "ipv6 support for modified-URL-like", "bodyText": "Closes #1223", "createdAt": "2020-10-16T11:33:52Z", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1403", "merged": true, "mergeCommit": {"oid": "df2b6638fea0c0f93b7446f5f11a05bd1fa87e0c"}, "closed": true, "closedAt": "2020-10-19T14:30:51Z", "author": {"login": "imavroukakis"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTEs3GgH2gAyNTA0Nzc4ODg4OjRlNGQ2MThlNjk5M2QxOGE1ODVhNzBhYzY2MWY2NzMwNGRhMzY1ZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdT97E8AFqTUxMTQzNTAxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4e4d618e6993d18a585a70ac661f67304da365d6", "author": {"user": {"login": "imavroukakis", "name": "Ioannis Mavroukakis"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/4e4d618e6993d18a585a70ac661f67304da365d6", "committedDate": "2020-10-16T11:30:25Z", "message": "ipv6 support for modified-URL-like"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95650a2a45c0069d31b58396793c32fbf1122104", "author": {"user": {"login": "imavroukakis", "name": "Ioannis Mavroukakis"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/95650a2a45c0069d31b58396793c32fbf1122104", "committedDate": "2020-10-16T12:30:22Z", "message": "add a \"pure\" v6 address to the tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72c56b6e8eec78a15c19a81086375af0ebc1510d", "author": {"user": {"login": "imavroukakis", "name": "Ioannis Mavroukakis"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/72c56b6e8eec78a15c19a81086375af0ebc1510d", "committedDate": "2020-10-16T12:39:34Z", "message": "wrap the regex pattern"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83e3c1f4eeefc42d83def6d2a2670f68fa4223ab", "author": {"user": {"login": "imavroukakis", "name": "Ioannis Mavroukakis"}}, "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/83e3c1f4eeefc42d83def6d2a2670f68fa4223ab", "committedDate": "2020-10-16T14:11:40Z", "message": "individually comment the regex parts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwODE2NTI4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1403#pullrequestreview-510816528", "createdAt": "2020-10-16T21:48:27Z", "commit": {"oid": "83e3c1f4eeefc42d83def6d2a2670f68fa4223ab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNDM1MDEy", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1403#pullrequestreview-511435012", "createdAt": "2020-10-19T06:09:39Z", "commit": {"oid": "83e3c1f4eeefc42d83def6d2a2670f68fa4223ab"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwNjowOTozOVrOHj-0rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwNjowOTozOVrOHj-0rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQ5MTUwMw==", "bodyText": "There cannot be port in this case?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1403#discussion_r507491503", "createdAt": "2020-10-19T06:09:39Z", "author": {"login": "iNikem"}, "path": "instrumentation/jdbc/src/main/java/io/opentelemetry/javaagent/instrumentation/jdbc/JDBCConnectionUrlParser.java", "diffHunk": "@@ -159,7 +188,19 @@\n         serverName = serverName.substring(0, instanceLoc);\n       }\n \n-      int portLoc = serverName.indexOf(\":\");\n+      Matcher ipv6Matcher = IPv6.matcher(serverName);\n+      boolean isIpv6 = ipv6Matcher.find();\n+\n+      int portLoc = -1;\n+      if (isIpv6) {\n+        if (serverName.startsWith(\"[\")) {\n+          portLoc = serverName.indexOf(\"]:\") + 1;\n+        } else {\n+          serverName = \"[\" + serverName + \"]\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83e3c1f4eeefc42d83def6d2a2670f68fa4223ab"}, "originalPosition": 56}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2349, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}