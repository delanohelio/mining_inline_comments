{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMjg5NTAz", "number": 878, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzoxMToyM1rOEUr_dQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjo1MjozOFrOEUyHgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMTI3NzMzOnYy", "diffSide": "RIGHT", "path": "gradle/instrumentation-library.gradle", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzoxMToyM1rOG7Brvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMToxMjowNlrOG7I4aQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU0Njc1MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n              api deps.opentelemetrySdk\n          \n      \n    \n    \n  \n\n@trask Would it make sense to add this dependency or do we leave it up to users add the sdk dependency?", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464546751", "createdAt": "2020-08-03T17:11:23Z", "author": {"login": "mabdinur"}, "path": "gradle/instrumentation-library.gradle", "diffHunk": "@@ -15,7 +15,9 @@ dependencies {\n   // TODO(anuraaga): We currently include common instrumentation logic like decorators in the\n   // bootstrap, but we need to move it out so manual instrumentation does not depend on code from\n   // the agent, like Agent.\n-  api project(':auto-bootstrap')\n+  api project(':auto-bootstrap'){\n+    exclude group: 'org.slf4j', module: 'slf4j-simple'\n+  }\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2ea1c44d7c55e514b2b6defc428113b8b6bd7ca"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY2NDY4MQ==", "bodyText": "i think leave it to users, since they have to pull in sdk to configure exporters anyways", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464664681", "createdAt": "2020-08-03T21:12:06Z", "author": {"login": "trask"}, "path": "gradle/instrumentation-library.gradle", "diffHunk": "@@ -15,7 +15,9 @@ dependencies {\n   // TODO(anuraaga): We currently include common instrumentation logic like decorators in the\n   // bootstrap, but we need to move it out so manual instrumentation does not depend on code from\n   // the agent, like Agent.\n-  api project(':auto-bootstrap')\n+  api project(':auto-bootstrap'){\n+    exclude group: 'org.slf4j', module: 'slf4j-simple'\n+  }\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU0Njc1MQ=="}, "originalCommit": {"oid": "d2ea1c44d7c55e514b2b6defc428113b8b6bd7ca"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMjA3NzM0OnYy", "diffSide": "RIGHT", "path": "instrumentation-core/servlet/servlet.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMToyODoxN1rOG7JUPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMToyODoxN1rOG7JUPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY3MTgwNQ==", "bodyText": "i think the shadow jar is only for use by the corresponding auto-instrumentation modules, so i think we don't want to publish the shadow jar for anything under :instrumentation-core\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              noShadowPublish = false", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464671805", "createdAt": "2020-08-03T21:28:17Z", "author": {"login": "trask"}, "path": "instrumentation-core/servlet/servlet.gradle", "diffHunk": "@@ -1,14 +1,11 @@\n-group = 'io.opentelemetry.instrumentation'\n-\n-apply from: \"$rootDir/gradle/java.gradle\"\n-apply from: \"$rootDir/gradle/publish.gradle\"\n+ext {\n+  noShadowPublish = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6421aaae9022f118a1dc12f9b8125073402d6a16"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMjI1OTgyOnYy", "diffSide": "RIGHT", "path": "instrumentation-core/servlet/servlet.gradle", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjo0Mjo0N1rOG7LBLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjo0Mjo0N1rOG7LBLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY5OTY5NQ==", "bodyText": "this is used by servlet auto-instrumentation. and i think you'll also need to update those auto-instrumentation to use configuration: 'shadow', and use shaded package name\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              javaSubPackage = ''\n          \n          \n            \n              javaSubPackage = 'servlet'", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464699695", "createdAt": "2020-08-03T22:42:47Z", "author": {"login": "trask"}, "path": "instrumentation-core/servlet/servlet.gradle", "diffHunk": "@@ -1,14 +1,10 @@\n-group = 'io.opentelemetry.instrumentation'\n-\n-apply from: \"$rootDir/gradle/java.gradle\"\n-apply from: \"$rootDir/gradle/publish.gradle\"\n+ext {\n+  javaSubPackage = ''", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMjI4MDQ2OnYy", "diffSide": "RIGHT", "path": "instrumentation-core/spring/spring-web-3.1/spring-web-3.1.gradle", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjo1MjoyNFrOG7LNMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQwMDowODoyOVrOG7MlPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjc3MQ==", "bodyText": "maybe something more explicit which disables the shadowJar task in instrumentation-library.gradle, e.g.\nwe could also have lack of javaSubPackage disable the shadowJar task, but don't want people to accidentally forget about shading these dependencies for auto-instrumentation, so think maybe this is safer\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ext {\n          \n          \n            \n              javaSubPackage = ''\n          \n          \n            \n            }\n          \n          \n            \n              noShadow = true", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464702771", "createdAt": "2020-08-03T22:52:24Z", "author": {"login": "trask"}, "path": "instrumentation-core/spring/spring-web-3.1/spring-web-3.1.gradle", "diffHunk": "@@ -1,25 +1,9 @@\n-group = 'io.opentelemetry.instrumentation'\n+ext {\n+  javaSubPackage = ''\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwNjcxMg==", "bodyText": "oh sorry, i accidentally removed the surrounding ext { ... }", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464706712", "createdAt": "2020-08-03T23:05:15Z", "author": {"login": "trask"}, "path": "instrumentation-core/spring/spring-web-3.1/spring-web-3.1.gradle", "diffHunk": "@@ -1,25 +1,9 @@\n-group = 'io.opentelemetry.instrumentation'\n+ext {\n+  javaSubPackage = ''\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjc3MQ=="}, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcyMTQyOQ==", "bodyText": "I run into this error when I don't define javaSubPackage:\nA problem occurred evaluating script.\n> Could not get unknown property 'javaSubPackage'\n\nIs there a way to disable the shadowJar configuration in instrumentation-library.gradle so that I don't run into this compile time error? A work around would be to just set javaSubPackage to an empty string but that doesn't seem ideal.", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464721429", "createdAt": "2020-08-03T23:53:49Z", "author": {"login": "mabdinur"}, "path": "instrumentation-core/spring/spring-web-3.1/spring-web-3.1.gradle", "diffHunk": "@@ -1,25 +1,9 @@\n-group = 'io.opentelemetry.instrumentation'\n+ext {\n+  javaSubPackage = ''\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjc3MQ=="}, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcyMzc4NQ==", "bodyText": "there may be a better way, but wrapping parts of instrumentation-library.gradle in conditionals seems to do the trick:\nif (!ext.properties.noShadow) {\n  apply plugin: 'com.github.johnrengelman.shadow'\n}\n\nif (!ext.properties.noShadow) {\n  shadowJar {\n    archiveClassifier = 'agent'\n\n    configurations = []\n\n    relocate \"io.opentelemetry.instrumentation.${javaSubPackage}\", \"io.opentelemetry.auto.instrumentation.${javaSubPackage}.shaded\"\n  }\n}", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464723785", "createdAt": "2020-08-04T00:02:28Z", "author": {"login": "trask"}, "path": "instrumentation-core/spring/spring-web-3.1/spring-web-3.1.gradle", "diffHunk": "@@ -1,25 +1,9 @@\n-group = 'io.opentelemetry.instrumentation'\n+ext {\n+  javaSubPackage = ''\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjc3MQ=="}, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcyNTMxMQ==", "bodyText": "Awesome thanks!", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464725311", "createdAt": "2020-08-04T00:08:29Z", "author": {"login": "mabdinur"}, "path": "instrumentation-core/spring/spring-web-3.1/spring-web-3.1.gradle", "diffHunk": "@@ -1,25 +1,9 @@\n-group = 'io.opentelemetry.instrumentation'\n+ext {\n+  javaSubPackage = ''\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjc3MQ=="}, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMjI4MDk3OnYy", "diffSide": "RIGHT", "path": "instrumentation-core/spring/spring-webmvc-3.1/spring-webmvc-3.1.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjo1MjozOFrOG7LNfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMjo1MjozOFrOG7LNfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwMjg0NA==", "bodyText": "same comment as above", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/878#discussion_r464702844", "createdAt": "2020-08-03T22:52:38Z", "author": {"login": "trask"}, "path": "instrumentation-core/spring/spring-webmvc-3.1/spring-webmvc-3.1.gradle", "diffHunk": "@@ -1,24 +1,12 @@\n-group = 'io.opentelemetry.instrumentation'\n-\n-apply from: \"$rootDir/gradle/java.gradle\"\n-apply from: \"$rootDir/gradle/publish.gradle\"\n+ext {\n+  javaSubPackage = ''\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c44c408fc0066526d51e56bdcee7c7190c596f6"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 208, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}