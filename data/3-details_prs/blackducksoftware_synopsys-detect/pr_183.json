{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3OTY2NTM4", "number": 183, "title": "Status json code locations", "bodyText": "FormattedOutputManager, from which we generate the status.json file, now collects code location data from all tools (as opposed to just Detectors).\nThe manager used to store a BdioCodeLocationResult, but only used the values from its code location map (the string names associated with DetectCodeLocations).  It now just holds a Set of those names.  Due to this, it now listens to a different Event to collect them.\nTicket: IDETECT-2035", "createdAt": "2020-06-04T16:53:42Z", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183", "merged": true, "mergeCommit": {"oid": "a19768f37c93a9f20c341018fa53b1b0a1ef93c9"}, "closed": true, "closedAt": "2020-06-12T16:10:17Z", "author": {"login": "crowleySynopsys"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnclQjAH2gAyNDI3OTY2NTM4OjczZDc3MjE1ZTY0MDRjODYzMTRiOWRjODZhZWUzZDZkOGViOTkzYmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpogOtgH2gAyNDI3OTY2NTM4Ojc3ODBkMjRjMDNiMjBlYWFjNjU1YmRiMzM0NTBkNGM3OWNhN2RmYjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "73d77215e6404c86314b9dc86aee3d6d8eb993be", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/73d77215e6404c86314b9dc86aee3d6d8eb993be", "committedDate": "2020-06-02T22:27:10Z", "message": "feat: Incorporate code location data from all tools into status.json file (IDETECT-2035)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bceb8e6212fed3082d20be6ad97643970517f875", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/bceb8e6212fed3082d20be6ad97643970517f875", "committedDate": "2020-06-04T16:38:45Z", "message": "fix: Revert BazelExtractor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f5b0dc60a91e1f1c15d9faaeb3e635c1b408072", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/1f5b0dc60a91e1f1c15d9faaeb3e635c1b408072", "committedDate": "2020-06-04T16:45:48Z", "message": "fix: Remove unnecessary comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NjYyNDAx", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183#pullrequestreview-424662401", "createdAt": "2020-06-04T17:15:22Z", "commit": {"oid": "1f5b0dc60a91e1f1c15d9faaeb3e635c1b408072"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzoxNToyMlrOGfP3fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzoxNToyMlrOGfP3fA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxOTAwNA==", "bodyText": "I don't like that this is called \"collectCodeLocationNames\" when it really \"creates\" code location names.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183#discussion_r435419004", "createdAt": "2020-06-04T17:15:22Z", "author": {"login": "taikuukaits"}, "path": "src/main/java/com/synopsys/integration/detect/lifecycle/run/RunManager.java", "diffHunk": "@@ -409,4 +414,14 @@ private void runBlackDuckProduct(final ProductRunData productRunData, final Dete\n         }\n     }\n \n+    private Set<String> collectCodeLocationNames(DetectableToolResult detectableToolResult, CodeLocationNameManager codeLocationNameManager, DirectoryManager directoryManager) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f5b0dc60a91e1f1c15d9faaeb3e635c1b408072"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NjYzMTE5", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183#pullrequestreview-424663119", "createdAt": "2020-06-04T17:16:16Z", "commit": {"oid": "1f5b0dc60a91e1f1c15d9faaeb3e635c1b408072"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzoxNjoxNlrOGfP5jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzoxNjoxNlrOGfP5jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxOTUzNQ==", "bodyText": "This isn't after calculation though, this is after we add it to wait data. Doesn't seem like the event matches up.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183#discussion_r435419535", "createdAt": "2020-06-04T17:16:16Z", "author": {"login": "taikuukaits"}, "path": "src/main/java/com/synopsys/integration/detect/workflow/blackduck/CodeLocationWaitData.java", "diffHunk": "@@ -24,19 +24,26 @@\n \n import java.util.Date;\n import java.util.HashSet;\n+import java.util.List;\n import java.util.Set;\n \n import com.synopsys.integration.blackduck.codelocation.CodeLocationCreationData;\n import com.synopsys.integration.blackduck.service.model.NotificationTaskRange;\n+import com.synopsys.integration.detect.workflow.event.Event;\n+import com.synopsys.integration.detect.workflow.event.EventSystem;\n \n public class CodeLocationWaitData {\n     private NotificationTaskRange notificationRange;\n     private Set<String> codeLocationNames = new HashSet<>();\n     private int expectedNotificationCount = 0;\n \n-    public void addWaitForCreationData(CodeLocationCreationData codeLocationCreationData) {\n+    public void addWaitForCreationData(CodeLocationCreationData codeLocationCreationData, EventSystem eventSystem) {\n         expectedNotificationCount += codeLocationCreationData.getOutput().getExpectedNotificationCount();\n-        codeLocationNames.addAll(codeLocationCreationData.getOutput().getSuccessfulCodeLocationNames());\n+\n+        Set<String> codeLocationNames = codeLocationCreationData.getOutput().getSuccessfulCodeLocationNames();\n+        this.codeLocationNames.addAll(codeLocationNames);\n+        eventSystem.publishEvent(Event.CodeLocationNamesCalculated, codeLocationNames);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f5b0dc60a91e1f1c15d9faaeb3e635c1b408072"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77f5bc128db3ea50db4eca2b4b70abec3af00b35", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/77f5bc128db3ea50db4eca2b4b70abec3af00b35", "committedDate": "2020-06-05T14:29:01Z", "message": "fix: Renamed collectCodeLocationNames to createCodeLocationNames"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8a6789d12b30cbc88cf39e7ea167867ceb0b358", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/a8a6789d12b30cbc88cf39e7ea167867ceb0b358", "committedDate": "2020-06-05T17:19:50Z", "message": "style: renamed Event.CodeLocationNamesCalculated Event.CodeLocationNamesAdded -> , CodeLocationWaitData -> CodeLocationWaitController"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MzM4Mjc2", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183#pullrequestreview-427338276", "createdAt": "2020-06-09T16:27:59Z", "commit": {"oid": "a8a6789d12b30cbc88cf39e7ea167867ceb0b358"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNjoyNzo1OVrOGhStdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNjoyNzo1OVrOGhStdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2Mjc0MQ==", "bodyText": "Shouldn't this be renamed to codeLocationsAdded?", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/183#discussion_r437562741", "createdAt": "2020-06-09T16:27:59Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/detect/workflow/report/output/FormattedOutputManager.java", "diffHunk": "@@ -130,8 +130,8 @@ private void detectorsComplete(final DetectorToolResult detectorToolResult) {\n         this.detectorToolResult = detectorToolResult;\n     }\n \n-    private void codeLocationsCalculated(final BdioCodeLocationResult bdioCodeLocationResult) {\n-        this.bdioCodeLocationResult = bdioCodeLocationResult;\n+    private void codeLocationsCalculated(final Collection<String> codeLocations) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8a6789d12b30cbc88cf39e7ea167867ceb0b358"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1c95687a4c3d578ed9cb626bbf816d5bd6cb657", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/c1c95687a4c3d578ed9cb626bbf816d5bd6cb657", "committedDate": "2020-06-09T17:12:39Z", "message": "refactor: Renamed FormattedOutputManager.codeLocationsCalculated to FormattedOutputManager.codeLocationsAdded"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f431ae1bcb91f141782eda213a2479dd2ef3852", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/8f431ae1bcb91f141782eda213a2479dd2ef3852", "committedDate": "2020-06-09T17:24:18Z", "message": "Merge branch 'master' into statusJsonCodeLocations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7780d24c03b20eaac655bdb33450d4c79ca7dfb5", "author": {"user": {"login": "crowleySynopsys", "name": null}}, "url": "https://github.com/blackducksoftware/synopsys-detect/commit/7780d24c03b20eaac655bdb33450d4c79ca7dfb5", "committedDate": "2020-06-09T17:28:23Z", "message": "fix: Resolving errors from merge conflict resolutions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3322, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}