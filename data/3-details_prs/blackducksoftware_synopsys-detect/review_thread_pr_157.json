{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NDA2OTMx", "number": 157, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODoyMjo0NVrOD05rlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowNzoxMlrOD19PNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2Nzk3NTg5OnYy", "diffSide": "RIGHT", "path": "configuration/src/main/java/com/synopsys/integration/configuration/source/SpringConfigurationPropertySource.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODoyMjo0NVrOGKEqyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMToxNDozNVrOGLpesw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNTQzMg==", "bodyText": "I'd like to see this and it's calling method to return Optional<SpringConfigurationPropertySource> since we are explicitly returning null in some cases. If refactoring it now will cause a lot of changes can you put in a TODO?", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413215432", "createdAt": "2020-04-22T18:22:45Z", "author": {"login": "JakeMathews"}, "path": "configuration/src/main/java/com/synopsys/integration/configuration/source/SpringConfigurationPropertySource.java", "diffHunk": "@@ -85,6 +74,21 @@ public SpringConfigurationPropertySource(final String name, final IterableConfig\n \n     }\n \n+    private static SpringConfigurationPropertySource getPropertySource(ConfigurableEnvironment configurableEnvironment, boolean ignoreUnknown, ConfigurationPropertySource configurationPropertySource) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDAzMDM0MQ==", "bodyText": "@JakeMathews to clarify, you'd want fromConfigurableEnvironment to return Optional<List> or List<Optional>?", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r414030341", "createdAt": "2020-04-23T18:33:29Z", "author": {"login": "crowleySynopsys"}, "path": "configuration/src/main/java/com/synopsys/integration/configuration/source/SpringConfigurationPropertySource.java", "diffHunk": "@@ -85,6 +74,21 @@ public SpringConfigurationPropertySource(final String name, final IterableConfig\n \n     }\n \n+    private static SpringConfigurationPropertySource getPropertySource(ConfigurableEnvironment configurableEnvironment, boolean ignoreUnknown, ConfigurationPropertySource configurationPropertySource) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNTQzMg=="}, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2NzEyMw==", "bodyText": "I'd want getPropertySource to return Optional<SpringConfigurationPropertySource> since that method could return null.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r414867123", "createdAt": "2020-04-24T21:14:35Z", "author": {"login": "JakeMathews"}, "path": "configuration/src/main/java/com/synopsys/integration/configuration/source/SpringConfigurationPropertySource.java", "diffHunk": "@@ -85,6 +74,21 @@ public SpringConfigurationPropertySource(final String name, final IterableConfig\n \n     }\n \n+    private static SpringConfigurationPropertySource getPropertySource(ConfigurableEnvironment configurableEnvironment, boolean ignoreUnknown, ConfigurationPropertySource configurationPropertySource) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNTQzMg=="}, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2Nzk4NTcxOnYy", "diffSide": "RIGHT", "path": "detectable/src/main/java/com/synopsys/integration/detectable/SingleDetectableApplication.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODoyNTowMlrOGKEwlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMToyMzoyMVrOGKMcjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNjkxOQ==", "bodyText": "I'd argue these sample application classes should be removed. @taikuukaits is there value in maintaining these?", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413216919", "createdAt": "2020-04-22T18:25:02Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/SingleDetectableApplication.java", "diffHunk": "@@ -49,7 +47,9 @@\n //This sample application will an example detectable tool and execute it against the current folder.\n public class SingleDetectableApplication {\n     public static void main(final String[] args) {\n-\n+        /*\n+            Empty main method\n+         */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM0Mjg2Mg==", "bodyText": "Sort of but we can get rid of them. The goal is to eventually make a full detectable library but we might not even end up using these for that.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413342862", "createdAt": "2020-04-22T21:23:21Z", "author": {"login": "taikuukaits"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/SingleDetectableApplication.java", "diffHunk": "@@ -49,7 +47,9 @@\n //This sample application will an example detectable tool and execute it against the current folder.\n public class SingleDetectableApplication {\n     public static void main(final String[] args) {\n-\n+        /*\n+            Empty main method\n+         */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNjkxOQ=="}, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2Nzk5MDA5OnYy", "diffSide": "RIGHT", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectable/file/impl/SimpleFileFinder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODoyNjowM1rOGKEzJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODoyNjowM1rOGKEzJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNzU3Mg==", "bodyText": "With this many arguments, perhaps this needs more refactoring than just moving it to another method.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413217572", "createdAt": "2020-04-22T18:26:03Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectable/file/impl/SimpleFileFinder.java", "diffHunk": "@@ -44,22 +44,28 @@\n         }\n         final File[] allFiles = directoryToSearch.listFiles();\n         if (allFiles != null) {\n-            for (final File file : allFiles) {\n-                final boolean matches = filenameFilter.accept(directoryToSearch, file.getName());\n-                if (matches) {\n-                    foundFiles.add(file);\n-                }\n-                if (!matches || findInsideMatchingDirectories) {\n-                    if (file.isDirectory() && !Files.isSymbolicLink(file.toPath())) {\n-                        foundFiles.addAll(findFiles(file, filenameFilter, depth - 1, findInsideMatchingDirectories));\n-                    }\n-                }\n-            }\n+            foundFiles.addAll(extractFileMathces(allFiles, directoryToSearch, filenameFilter, depth, findInsideMatchingDirectories));\n         }\n \n         return foundFiles;\n     }\n \n+    private List<File> extractFileMathces(final File[] allFiles, final File directoryToSearch, final FilenameFilter filenameFilter, final int depth, final boolean findInsideMatchingDirectories) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2Nzk5NzAwOnYy", "diffSide": "RIGHT", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/nuget/model/NugetContainer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODoyNzo0MVrOGKE3Vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDoxNDo1N1rOGKJqFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxODY0Ng==", "bodyText": "Does this change the result of toString()?", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413218646", "createdAt": "2020-04-22T18:27:41Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/nuget/model/NugetContainer.java", "diffHunk": "@@ -56,6 +56,6 @@\n \n     @Override\n     public String toString() {\n-        return ReflectionToStringBuilder.toString(this, RecursiveToStringStyle.JSON_STYLE);\n+        return ReflectionToStringBuilder.toString(this, ToStringStyle.JSON_STYLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI5NzE3Mg==", "bodyText": "No change", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413297172", "createdAt": "2020-04-22T20:14:57Z", "author": {"login": "crowleySynopsys"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/nuget/model/NugetContainer.java", "diffHunk": "@@ -56,6 +56,6 @@\n \n     @Override\n     public String toString() {\n-        return ReflectionToStringBuilder.toString(this, RecursiveToStringStyle.JSON_STYLE);\n+        return ReflectionToStringBuilder.toString(this, ToStringStyle.JSON_STYLE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxODY0Ng=="}, "originalCommit": {"oid": "0788cf2b50ad7f3ad05816a8079d1b1a62cff98a"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2ODEwNjU5OnYy", "diffSide": "RIGHT", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODo1Mjo0NVrOGKF5oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMToxMzoyMFrOGLpb8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNTYxNw==", "bodyText": "Doing this will cause us to iterate over every line multiple times. Yarn.lock files very easily exceed 20k lines. Not sure what the performance impact this will cause, but that's why there was one loop before that would continue if the line didn't matter.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413235617", "createdAt": "2020-04-22T18:52:45Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer getIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)\n+                   .findFirst()\n+                   .map(line -> cleanedYarnLockFileAsList.indexOf(line))\n+                   .orElse(-1);\n+    }\n+\n+    @NotNull\n+    private List<String> getCleaned(final List<String> yarnLockFileAsList) {\n+        return yarnLockFileAsList\n+                   .stream()\n+                   .filter(StringUtils::isNotBlank)\n+                   .filter(line -> !line.trim().startsWith(COMMENT_PREFIX))\n+                   .collect(Collectors.toList());\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMzMzEzOA==", "bodyText": "Hmmm so this was the result of some pair refactoring I did with @ekerwin.  We both thought that this refactor was clearer as to what the class is actually doing when it parses, and is cognitively less complex.  The performance concern is justified, though.  Perhaps the impact of that needs to be investigated...", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413333138", "createdAt": "2020-04-22T21:06:45Z", "author": {"login": "crowleySynopsys"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer getIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)\n+                   .findFirst()\n+                   .map(line -> cleanedYarnLockFileAsList.indexOf(line))\n+                   .orElse(-1);\n+    }\n+\n+    @NotNull\n+    private List<String> getCleaned(final List<String> yarnLockFileAsList) {\n+        return yarnLockFileAsList\n+                   .stream()\n+                   .filter(StringUtils::isNotBlank)\n+                   .filter(line -> !line.trim().startsWith(COMMENT_PREFIX))\n+                   .collect(Collectors.toList());\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNTYxNw=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM0NDMzMg==", "bodyText": "I think lower cognitive complexity should be preferred unless performance has been demonstrated to be a problem.\nI don't like the method names, 'get' and 'set' should be reserved for getters and setters IMO. Something like filterCleanedLines or findIndexOfFirstLevelZeroLine would be preferred.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413344332", "createdAt": "2020-04-22T21:25:54Z", "author": {"login": "taikuukaits"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer getIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)\n+                   .findFirst()\n+                   .map(line -> cleanedYarnLockFileAsList.indexOf(line))\n+                   .orElse(-1);\n+    }\n+\n+    @NotNull\n+    private List<String> getCleaned(final List<String> yarnLockFileAsList) {\n+        return yarnLockFileAsList\n+                   .stream()\n+                   .filter(StringUtils::isNotBlank)\n+                   .filter(line -> !line.trim().startsWith(COMMENT_PREFIX))\n+                   .collect(Collectors.toList());\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNTYxNw=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM0NDc2OA==", "bodyText": "I agree it's certainly easier to read. But yes I think further investigation is needed.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413344768", "createdAt": "2020-04-22T21:26:35Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer getIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)\n+                   .findFirst()\n+                   .map(line -> cleanedYarnLockFileAsList.indexOf(line))\n+                   .orElse(-1);\n+    }\n+\n+    @NotNull\n+    private List<String> getCleaned(final List<String> yarnLockFileAsList) {\n+        return yarnLockFileAsList\n+                   .stream()\n+                   .filter(StringUtils::isNotBlank)\n+                   .filter(line -> !line.trim().startsWith(COMMENT_PREFIX))\n+                   .collect(Collectors.toList());\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNTYxNw=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDE0MzUwOQ==", "bodyText": "@JakeMathews just tried running Detect on projects with a 20,000+ line yarn.lock file and a 7 line yarn.lock file, respectively, and the run times were 11s and 6s, respectively", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r414143509", "createdAt": "2020-04-23T21:41:35Z", "author": {"login": "crowleySynopsys"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer getIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)\n+                   .findFirst()\n+                   .map(line -> cleanedYarnLockFileAsList.indexOf(line))\n+                   .orElse(-1);\n+    }\n+\n+    @NotNull\n+    private List<String> getCleaned(final List<String> yarnLockFileAsList) {\n+        return yarnLockFileAsList\n+                   .stream()\n+                   .filter(StringUtils::isNotBlank)\n+                   .filter(line -> !line.trim().startsWith(COMMENT_PREFIX))\n+                   .collect(Collectors.toList());\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNTYxNw=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2NjQxNw==", "bodyText": "We are good then.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r414866417", "createdAt": "2020-04-24T21:13:20Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer getIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)\n+                   .findFirst()\n+                   .map(line -> cleanedYarnLockFileAsList.indexOf(line))\n+                   .orElse(-1);\n+    }\n+\n+    @NotNull\n+    private List<String> getCleaned(final List<String> yarnLockFileAsList) {\n+        return yarnLockFileAsList\n+                   .stream()\n+                   .filter(StringUtils::isNotBlank)\n+                   .filter(line -> !line.trim().startsWith(COMMENT_PREFIX))\n+                   .collect(Collectors.toList());\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNTYxNw=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2ODExNjk0OnYy", "diffSide": "LEFT", "path": "src/main/java/com/synopsys/integration/detect/interactive/mode/InteractiveMode.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODo1NToxMVrOGKF_8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMToxNDozMVrOGKMIcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNzIzNQ==", "bodyText": "I think null may mean no user input here. Can you just verify the code calling this isn't expecting a null.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413237235", "createdAt": "2020-04-22T18:55:11Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/detect/interactive/mode/InteractiveMode.java", "diffHunk": "@@ -108,7 +108,7 @@ public Boolean askYesOrNoWithMessage(final String question, final String message\n             attempts += 1;\n             printStream.println(\"Please answer yes or no.\");\n         }\n-        return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMzNzcxMw==", "bodyText": "When I looked at usages of AskYesOrNo, the only checks that are done are \"if ()\" which I feel like actually makes more sense with a boolean returned anyways", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413337713", "createdAt": "2020-04-22T21:14:31Z", "author": {"login": "crowleySynopsys"}, "path": "src/main/java/com/synopsys/integration/detect/interactive/mode/InteractiveMode.java", "diffHunk": "@@ -108,7 +108,7 @@ public Boolean askYesOrNoWithMessage(final String question, final String message\n             attempts += 1;\n             printStream.println(\"Please answer yes or no.\");\n         }\n-        return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIzNzIzNQ=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2ODEzNjM3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/detect/lifecycle/run/RunManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODo1ODoxOVrOGKGMhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMToxNzoxMFrOGKMOvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0MDQ1NA==", "bodyText": "Why was this not converted to\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (detectorToolResult.getFailedDetectorTypes().size() > 0) {\n          \n          \n            \n                        if (!detectorToolResult.getFailedDetectorTypes().isEmpty()) {\n          \n      \n    \n    \n  \n\nlike in DetectorEvaluator", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413240454", "createdAt": "2020-04-22T18:58:19Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/detect/lifecycle/run/RunManager.java", "diffHunk": "@@ -235,10 +235,10 @@ private UniversalToolsResult runUniversalProjectTools(final PropertyConfiguratio\n             final DetectorTool detectorTool = new DetectorTool(new DetectorFinder(), extractionEnvironmentProvider, eventSystem, codeLocationConverter);\n             final DetectorToolResult detectorToolResult = detectorTool.performDetectors(directoryManager.getSourceDirectory(), detectRuleSet, finderOptions, detectorEvaluationOptions, projectBomTool, requiredDetectors);\n \n-            detectorToolResult.bomToolProjectNameVersion.ifPresent(it -> runResult.addToolNameVersion(DetectTool.DETECTOR, new NameVersion(it.getName(), it.getVersion())));\n-            runResult.addDetectCodeLocations(detectorToolResult.bomToolCodeLocations);\n+            detectorToolResult.getBomToolProjectNameVersion().ifPresent(it -> runResult.addToolNameVersion(DetectTool.DETECTOR, new NameVersion(it.getName(), it.getVersion())));\n+            runResult.addDetectCodeLocations(detectorToolResult.getBomToolCodeLocations());\n \n-            if (detectorToolResult.failedDetectorTypes.size() > 0) {\n+            if (detectorToolResult.getFailedDetectorTypes().size() > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMzOTMyNg==", "bodyText": "It wasn't a smell I was looking at, I just changed it when I noticed it on my own so I guess I did it inconsistently.  I'll edit that though", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413339326", "createdAt": "2020-04-22T21:17:10Z", "author": {"login": "crowleySynopsys"}, "path": "src/main/java/com/synopsys/integration/detect/lifecycle/run/RunManager.java", "diffHunk": "@@ -235,10 +235,10 @@ private UniversalToolsResult runUniversalProjectTools(final PropertyConfiguratio\n             final DetectorTool detectorTool = new DetectorTool(new DetectorFinder(), extractionEnvironmentProvider, eventSystem, codeLocationConverter);\n             final DetectorToolResult detectorToolResult = detectorTool.performDetectors(directoryManager.getSourceDirectory(), detectRuleSet, finderOptions, detectorEvaluationOptions, projectBomTool, requiredDetectors);\n \n-            detectorToolResult.bomToolProjectNameVersion.ifPresent(it -> runResult.addToolNameVersion(DetectTool.DETECTOR, new NameVersion(it.getName(), it.getVersion())));\n-            runResult.addDetectCodeLocations(detectorToolResult.bomToolCodeLocations);\n+            detectorToolResult.getBomToolProjectNameVersion().ifPresent(it -> runResult.addToolNameVersion(DetectTool.DETECTOR, new NameVersion(it.getName(), it.getVersion())));\n+            runResult.addDetectCodeLocations(detectorToolResult.getBomToolCodeLocations());\n \n-            if (detectorToolResult.failedDetectorTypes.size() > 0) {\n+            if (detectorToolResult.getFailedDetectorTypes().size() > 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0MDQ1NA=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2ODE0MDAxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorTool.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODo1OToxMVrOGKGOow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMToxOTowMFrOGKMSug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0MDk5NQ==", "bodyText": "This looks like an accidental side effect of the refactor.", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413240995", "createdAt": "2020-04-22T18:59:11Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorTool.java", "diffHunk": "@@ -77,20 +77,12 @@ public DetectorTool(final DetectorFinder detectorFinder, final ExtractionEnviron\n     public DetectorToolResult performDetectors(final File directory, final DetectorRuleSet detectorRuleSet, final DetectorFinderOptions detectorFinderOptions, final DetectorEvaluationOptions evaluationOptions, final String projectDetector,\n         final List<DetectorType> requiredDetectors)\n         throws DetectUserFriendlyException {\n-        logger.debug(\"Initializing detector system.\");\n-        final Optional<DetectorEvaluationTree> possibleRootEvaluation;\n-        try {\n-            logger.debug(\"Starting detector file system traversal.\");\n-            possibleRootEvaluation = detectorFinder.findDetectors(directory, detectorRuleSet, detectorFinderOptions);\n-\n-        } catch (final DetectorFinderDirectoryListException e) {\n-            throw new DetectUserFriendlyException(\"Detect was unable to list a directory while searching for detectors.\", e, ExitCodeType.FAILURE_DETECTOR);\n-        }\n+        Optional<DetectorEvaluationTree> possibleRootEvaluation = intializeDetectorSystem(directory, detectorRuleSet, detectorFinderOptions);\n \n         if (!possibleRootEvaluation.isPresent()) {\n             logger.error(\"The source directory could not be searched for detectors - detector tool failed.\");\n             logger.error(\"Please ensure the provided source path is a directory and detect has access.\");\n-            eventSystem.publishEvent(Event.ExitCode, new ExitCodeRequest(ExitCodeType.FAILURE_CONFIGURATION, \"Detector tool failed to run on the configured source path.\"));\n+            eventSystem.publishEvent(Event.ExitCode, new ExitCodeRequest(ExitCodeType.FAILURE_CONFIGURATION, \"DETECTOR tool failed to run on the configured source path.\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM0MDM0Ng==", "bodyText": "ugh, thought I caught all of those.  nice spot", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413340346", "createdAt": "2020-04-22T21:19:00Z", "author": {"login": "crowleySynopsys"}, "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorTool.java", "diffHunk": "@@ -77,20 +77,12 @@ public DetectorTool(final DetectorFinder detectorFinder, final ExtractionEnviron\n     public DetectorToolResult performDetectors(final File directory, final DetectorRuleSet detectorRuleSet, final DetectorFinderOptions detectorFinderOptions, final DetectorEvaluationOptions evaluationOptions, final String projectDetector,\n         final List<DetectorType> requiredDetectors)\n         throws DetectUserFriendlyException {\n-        logger.debug(\"Initializing detector system.\");\n-        final Optional<DetectorEvaluationTree> possibleRootEvaluation;\n-        try {\n-            logger.debug(\"Starting detector file system traversal.\");\n-            possibleRootEvaluation = detectorFinder.findDetectors(directory, detectorRuleSet, detectorFinderOptions);\n-\n-        } catch (final DetectorFinderDirectoryListException e) {\n-            throw new DetectUserFriendlyException(\"Detect was unable to list a directory while searching for detectors.\", e, ExitCodeType.FAILURE_DETECTOR);\n-        }\n+        Optional<DetectorEvaluationTree> possibleRootEvaluation = intializeDetectorSystem(directory, detectorRuleSet, detectorFinderOptions);\n \n         if (!possibleRootEvaluation.isPresent()) {\n             logger.error(\"The source directory could not be searched for detectors - detector tool failed.\");\n             logger.error(\"Please ensure the provided source path is a directory and detect has access.\");\n-            eventSystem.publishEvent(Event.ExitCode, new ExitCodeRequest(ExitCodeType.FAILURE_CONFIGURATION, \"Detector tool failed to run on the configured source path.\"));\n+            eventSystem.publishEvent(Event.ExitCode, new ExitCodeRequest(ExitCodeType.FAILURE_CONFIGURATION, \"DETECTOR tool failed to run on the configured source path.\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0MDk5NQ=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2ODE1Mjk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/detect/workflow/diagnostic/DiagnosticLogUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTowMTo1NVrOGKGWDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMTozNTozNFrOGKM3tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0Mjg5Mw==", "bodyText": "If this is returning a ch.qos.logback.classic.Logger why are we using the logger name from slf4j?", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413242893", "createdAt": "2020-04-22T19:01:55Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/detect/workflow/diagnostic/DiagnosticLogUtil.java", "diffHunk": "@@ -37,6 +35,6 @@\n     }\n \n     public static ch.qos.logback.classic.Logger getRootLogger() {\n-        return getLogger(ch.qos.logback.classic.Logger.ROOT_LOGGER_NAME);\n+        return getLogger(org.slf4j.Logger.ROOT_LOGGER_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM0OTgxNA==", "bodyText": "the logger type we are using here implements slf4j, and that's where is gets ROOT_LOGGER_NAME from.  sonarCloud had issue with referencing a value from an implemented class that it does not override", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r413349814", "createdAt": "2020-04-22T21:35:34Z", "author": {"login": "crowleySynopsys"}, "path": "src/main/java/com/synopsys/integration/detect/workflow/diagnostic/DiagnosticLogUtil.java", "diffHunk": "@@ -37,6 +35,6 @@\n     }\n \n     public static ch.qos.logback.classic.Logger getRootLogger() {\n-        return getLogger(ch.qos.logback.classic.Logger.ROOT_LOGGER_NAME);\n+        return getLogger(org.slf4j.Logger.ROOT_LOGGER_NAME);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0Mjg5Mw=="}, "originalCommit": {"oid": "96145f931c8de874260bb6cfe301a0ddb3b81394"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3OTA0MzAzOnYy", "diffSide": "RIGHT", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowNjo0NVrOGLpQVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowNjo0NVrOGLpQVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2MzQ0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                               .filter(this::isLevel0)\n          \n          \n            \n                               .filter(line -> countIndent(line) == 0)", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r414863447", "createdAt": "2020-04-24T21:06:45Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -73,6 +80,25 @@ public YarnLock parseYarnLock(final List<String> yarnLockFileAsList) {\n         return new YarnLock(entries);\n     }\n \n+    @NotNull\n+    private Integer findIndexOfFirstLevelZeroLine(final List<String> cleanedYarnLockFileAsList) {\n+        return cleanedYarnLockFileAsList\n+                   .stream()\n+                   .filter(this::isLevel0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7822f3d3945588d3cdc76256f05c06ca5a77e082"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3OTA0NDM5OnYy", "diffSide": "RIGHT", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowNzoxMlrOGLpRJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowNzoxMlrOGLpRJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2MzY1NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n                private boolean isLevel0(String line) {\n          \n          \n            \n                    int level = countIndent(line);\n          \n          \n            \n                    return level == 0;\n          \n          \n            \n                }", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/157#discussion_r414863655", "createdAt": "2020-04-24T21:07:12Z", "author": {"login": "JakeMathews"}, "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/yarn/parse/YarnLockParser.java", "diffHunk": "@@ -115,8 +141,13 @@ public YarnLockEntryId parseSingleEntry(String entry) {\n         }\n     }\n \n-    private String getVersionFromLine(final String line) {\n+    private String parseVersionFromLine(final String line) {\n         final String rawVersion = line.substring(VERSION_PREFIX.length(), line.lastIndexOf(VERSION_SUFFIX));\n         return removeWrappingQuotes(rawVersion);\n     }\n-}\n+\n+    private boolean isLevel0(String line) {\n+        int level = countIndent(line);\n+        return level == 0;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7822f3d3945588d3cdc76256f05c06ca5a77e082"}, "originalPosition": 118}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1591, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}