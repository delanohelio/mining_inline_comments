{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMzk4OTAw", "number": 5953, "title": "6413 Throttle number of Extracted Content node refreshes to once every 5 seconds.", "bodyText": "", "createdAt": "2020-06-08T21:10:49Z", "url": "https://github.com/sleuthkit/autopsy/pull/5953", "merged": true, "mergeCommit": {"oid": "9dcabc97a52c0b0f3eb89ce900100f6e33726569"}, "closed": true, "closedAt": "2020-06-25T15:16:20Z", "author": {"login": "esaunders"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnVGyegH2gAyNDMxMzk4OTAwOjBhZTQ1MTBiMThmMTU0YzM5MjkyYjM0NDFhMWQxNmY3MDcwMTRjMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuZJ2XgH2gAyNDMxMzk4OTAwOjU4M2NjZjIyZTE0ODEzNGNjYTQzYzE3N2RjMDFjZTQwZTIyNGIwMmE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0ae4510b18f154c39292b3441a1d16f707014c10", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/0ae4510b18f154c39292b3441a1d16f707014c10", "committedDate": "2020-06-02T13:44:33Z", "message": "Throttle number of Extracted Content node refreshes to once every 5 seconds."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2495deb56e3d8a24b2c6b63f2ec9acd5598f67e9", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/2495deb56e3d8a24b2c6b63f2ec9acd5598f67e9", "committedDate": "2020-06-02T15:25:48Z", "message": "Merge branch 'develop' of github.com:sleuthkit/autopsy into 6413-throttle-refresh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf929f1cd214be7e53729a611cd861adbe755102", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/bf929f1cd214be7e53729a611cd861adbe755102", "committedDate": "2020-06-08T21:05:55Z", "message": "Second pass at refresh throttling."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "752538e76ac792903021dee25e96b188c9650ea7", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/752538e76ac792903021dee25e96b188c9650ea7", "committedDate": "2020-06-09T16:40:42Z", "message": "Changed module event refresh. Added comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "751edacd7f03cda91412a5a7547cc0717a1e8ff5", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/751edacd7f03cda91412a5a7547cc0717a1e8ff5", "committedDate": "2020-06-09T16:41:44Z", "message": "Removed unneeded import."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef4269933d6c8e467143b700e472d9f0b50605bb", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/ef4269933d6c8e467143b700e472d9f0b50605bb", "committedDate": "2020-06-10T17:59:34Z", "message": "Changed to first check every event to see if it would result in a refresh."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60dae2406f988ffec3e7d00101d8b97ea1c50cb7", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/60dae2406f988ffec3e7d00101d8b97ea1c50cb7", "committedDate": "2020-06-10T18:02:54Z", "message": "Make FileTypesByExtension use RefreshThrottler."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e4b6d28156d1fa3c2227330dd84127a2dcc1dba", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/1e4b6d28156d1fa3c2227330dd84127a2dcc1dba", "committedDate": "2020-06-10T18:39:09Z", "message": "Shut Codacy up."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjczMzU0", "url": "https://github.com/sleuthkit/autopsy/pull/5953#pullrequestreview-435273354", "createdAt": "2020-06-22T21:05:28Z", "commit": {"oid": "1e4b6d28156d1fa3c2227330dd84127a2dcc1dba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMTowNToyOFrOGnQ-ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMTowNToyOFrOGnQ-ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgyNTg1MA==", "bodyText": "There is a typo on this line.", "url": "https://github.com/sleuthkit/autopsy/pull/5953#discussion_r443825850", "createdAt": "2020-06-22T21:05:28Z", "author": {"login": "rcordovano"}, "path": "Core/src/org/sleuthkit/autopsy/datamodel/RefreshThrottler.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2011-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.datamodel;\n+\n+import com.google.common.util.concurrent.ThreadFactoryBuilder;\n+import java.beans.PropertyChangeEvent;\n+import java.beans.PropertyChangeListener;\n+import java.util.EnumSet;\n+import java.util.Set;\n+import java.util.concurrent.ScheduledThreadPoolExecutor;\n+import java.util.concurrent.TimeUnit;\n+import java.util.concurrent.atomic.AtomicReference;\n+import org.sleuthkit.autopsy.ingest.IngestManager;\n+\n+/**\n+ * Utility class that can be used by UI nodes to reduce the number of\n+ * potentially expensive UI refresh events when DATA_ADDED and CONTENT_CHANGED\n+ * ingest manager events are received.\n+ */\n+class RefreshThrottler {\n+\n+    /**\n+     * The Refresher interface needs to be implemented by ChildFactory instances\n+     * that wish to take advantage of throttled refresh functionality.\n+     */\n+    interface Refresher {\n+\n+        /**\n+         * The RefreshThrottler calls this method when the RefreshTask runs.\n+         *\n+         */\n+        void refresh();\n+\n+        /**\n+         * Determine whether the given event should result in a refresh.\n+         *\n+         * @param evt\n+         *\n+         * @return true if event should trigger a refresh, otherwise false.\n+         */\n+        boolean isRefreshRequired(PropertyChangeEvent evt);\n+    }\n+\n+    static ScheduledThreadPoolExecutor refreshExecutor = new ScheduledThreadPoolExecutor(1, new ThreadFactoryBuilder().setNameFormat(\"Node Refresh Thread\").build());\n+    // Keep a thread safe reference to the current refresh task (if any)\n+    private final AtomicReference<RefreshTask> refreshTaskRef;\n+\n+    // The factory instance that will be called when a refresh is due.\n+    private final Refresher refresher;\n+\n+    private static final long MIN_SECONDS_BETWEEN_RERFESH = 5;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e4b6d28156d1fa3c2227330dd84127a2dcc1dba"}, "originalPosition": 67}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "583ccf22e148134cca43c177dc01ce40e224b02a", "author": {"user": {"login": "esaunders", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/583ccf22e148134cca43c177dc01ce40e224b02a", "committedDate": "2020-06-24T12:24:59Z", "message": "Fix typo."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2612, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}