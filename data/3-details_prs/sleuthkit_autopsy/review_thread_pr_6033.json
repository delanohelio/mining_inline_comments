{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNTQ3MjQ5", "number": 6033, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODowNzowOVrOEJxZww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoyMDoyMlrOEMOntg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjgyMDUxOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/casemodule/AddImageTask.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODowNzowOVrOGqcTOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODowNzowOVrOGqcTOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE1NzA0OA==", "bodyText": "More info in the message, please.", "url": "https://github.com/sleuthkit/autopsy/pull/6033#discussion_r447157048", "createdAt": "2020-06-29T18:07:09Z", "author": {"login": "rcordovano"}, "path": "Core/src/org/sleuthkit/autopsy/casemodule/AddImageTask.java", "diffHunk": "@@ -92,7 +92,7 @@ public void run() {\n         try {\n             currentCase = Case.getCurrentCaseThrows();\n         } catch (NoCurrentCaseException ex) {\n-            logger.log(Level.SEVERE, String.format(\"Failed to add image data source at %s, no current case\", imageDetails.imagePath), ex);\n+            logger.log(Level.SEVERE, String.format(\"Failed to start AddImageTask, no current case\"), ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2674bacd539fc7da46134f8c196febc3079c76a6"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjkwNjMzOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/casemodule/ImageDSProcessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODozMDo0MFrOGqdHHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODozMDo0MFrOGqdHHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE3MDMzMg==", "bodyText": "Let's indulge in a little code duplication for clarity, since by the time you get to this method, you have to keep looking back at the callers.\nWe can also give this another name to ease the cognitive burden of the overloads. Something like doAddImageProcess() or addImage() or addFilesForImage() whatever.", "url": "https://github.com/sleuthkit/autopsy/pull/6033#discussion_r447170332", "createdAt": "2020-06-29T18:30:40Z", "author": {"login": "rcordovano"}, "path": "Core/src/org/sleuthkit/autopsy/casemodule/ImageDSProcessor.java", "diffHunk": "@@ -296,10 +315,27 @@ public void run(String deviceId, String imagePath, String timeZone, boolean igno\n      * @param callback             Callback to call when processing is done.\n      */\n     private void run(String deviceId, String imagePath, int sectorSize, String timeZone, boolean ignoreFatOrphanFiles, String md5, String sha1, String sha256, DataSourceProcessorProgressMonitor progressMonitor, DataSourceProcessorCallback callback) {\n-        if (ingestStream == null) {\n-            ingestStream = new DefaultIngestStream();\n-        }\n-        addImageTask = new AddImageTask(new AddImageTask.ImageDetails(deviceId, imagePath, sectorSize, timeZone, ignoreFatOrphanFiles, md5, sha1, sha256, null), \n+\n+\t// If the data source or ingest stream haven't been initialized yet, do it now.\n+    if (ingestStream == null) {\n+        ingestStream = new DefaultIngestStream();\n+    }\n+    if (image == null) {\n+\t    try {\n+            image = SleuthkitJNI.addImageToDatabase(Case.getCurrentCase().getSleuthkitCase(),\n+                new String[]{imagePath}, sectorSize,\n+                timeZone, md5, sha1, sha256, deviceId);\n+            } catch (TskCoreException ex) {\n+            logger.log(Level.SEVERE, \"Error adding data source with path \" + imagePath + \" to database\", ex);\n+            final List<String> errors = new ArrayList<>();\n+            errors.add(ex.getMessage());\n+            callback.done(DataSourceProcessorCallback.DataSourceProcessorResult.CRITICAL_ERRORS, errors, new ArrayList<>());\n+            return;\n+\t    }\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2674bacd539fc7da46134f8c196febc3079c76a6"}, "originalPosition": 127}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMjU1ODQxOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/casemodule/ImageDSProcessor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoxMzozN1rOGuN9Vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoxMzozN1rOGuN9Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTExNjM3NA==", "bodyText": "This comment is not accurate.", "url": "https://github.com/sleuthkit/autopsy/pull/6033#discussion_r451116374", "createdAt": "2020-07-07T20:13:37Z", "author": {"login": "rcordovano"}, "path": "Core/src/org/sleuthkit/autopsy/casemodule/ImageDSProcessor.java", "diffHunk": "@@ -295,11 +341,28 @@ public void run(String deviceId, String imagePath, String timeZone, boolean igno\n      *                             during processing.\n      * @param callback             Callback to call when processing is done.\n      */\n-    private void run(String deviceId, String imagePath, int sectorSize, String timeZone, boolean ignoreFatOrphanFiles, String md5, String sha1, String sha256, DataSourceProcessorProgressMonitor progressMonitor, DataSourceProcessorCallback callback) {\n-        if (ingestStream == null) {\n-            ingestStream = new DefaultIngestStream();\n-        }\n-        addImageTask = new AddImageTask(new AddImageTask.ImageDetails(deviceId, imagePath, sectorSize, timeZone, ignoreFatOrphanFiles, md5, sha1, sha256, null), \n+    private void doAddImageProcess(String deviceId, String imagePath, int sectorSize, String timeZone, boolean ignoreFatOrphanFiles, String md5, String sha1, String sha256, DataSourceProcessorProgressMonitor progressMonitor, DataSourceProcessorCallback callback) {\n+\n+\t// If the data source or ingest stream haven't been initialized yet, do it now.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d90a9cae2f11e588e4bf3e2cd76e95953c3ad37"}, "originalPosition": 156}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMjU3OTEwOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/ingest/IngestJob.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoyMDoyMlrOGuOKQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoyMDoyMlrOGuOKQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTExOTY4Mw==", "bodyText": "Please restore the period, thanks!", "url": "https://github.com/sleuthkit/autopsy/pull/6033#discussion_r451119683", "createdAt": "2020-07-07T20:20:22Z", "author": {"login": "rcordovano"}, "path": "Core/src/org/sleuthkit/autopsy/ingest/IngestJob.java", "diffHunk": "@@ -116,16 +115,17 @@ public String getDisplayName() {\n     }\n     \n     /**\n-     * Constructs an ingest job that analyzes one data source using an\n-     * ingest stream.\n+     * Constructs an ingest job that analyzes one data source, possibly using\n+     * an ingest stream", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d90a9cae2f11e588e4bf3e2cd76e95953c3ad37"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 565, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}