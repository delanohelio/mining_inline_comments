{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNDY0MjE3", "number": 5668, "reviewThreads": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyMTo1OVrODljVig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMjo1OTo0NFrODn0rww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzAyODU4OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyMTo1OVrOFygw7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMzoyOTozOVrOFy4tPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwOTkzMw==", "bodyText": "Could this be an enum? Then we could use case statements later.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388509933", "createdAt": "2020-03-05T19:21:59Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Central Repository\n+ *\n+ * Copyright 2015-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+/**\n+ * the database choices available for central repo\n+ */\n+public class CentralRepoDbChoice {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODYxOTM5Mg==", "bodyText": "Yes, I could do that.  Part of my concern with using enum's was that I was sticking at least some data into each of these items.  Is that a problem or should I just move forward with an enum?", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388619392", "createdAt": "2020-03-05T23:09:09Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Central Repository\n+ *\n+ * Copyright 2015-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+/**\n+ * the database choices available for central repo\n+ */\n+public class CentralRepoDbChoice {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwOTkzMw=="}, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwMjIwNA==", "bodyText": "nevermind.  I got over my mental block.  I think this is a lot more ergonomic.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388902204", "createdAt": "2020-03-06T13:29:39Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Central Repository\n+ *\n+ * Copyright 2015-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+/**\n+ * the database choices available for central repo\n+ */\n+public class CentralRepoDbChoice {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUwOTkzMw=="}, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzAzMDY0OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyMjozOVrOFygyKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyMjozOVrOFygyKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxMDI0OQ==", "bodyText": "Perhaps UI_CHOICES? To make it more clear", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388510249", "createdAt": "2020-03-05T19:22:39Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Central Repository\n+ *\n+ * Copyright 2015-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+/**\n+ * the database choices available for central repo\n+ */\n+public class CentralRepoDbChoice {\n+    public static final CentralRepoDbChoice DISABLED = new CentralRepoDbChoice(\"Disabled\", CentralRepoPlatforms.DISABLED);\n+\n+    public static final CentralRepoDbChoice SQLITE = new CentralRepoDbChoice(\"Sqlite\", \"SQLite\", CentralRepoPlatforms.SQLITE);\n+\n+    public static final CentralRepoDbChoice POSTGRESQL_MULTIUSER = \n+        new CentralRepoDbChoice(\"PostgreSQL_Multiuser\", \"PostgreSQL using multi-user settings\", CentralRepoPlatforms.POSTGRESQL);\n+\n+    public static final CentralRepoDbChoice POSTGRESQL_CUSTOM = \n+        new CentralRepoDbChoice(\"PostgreSQL\", \"Custom PostgreSQL\", CentralRepoPlatforms.POSTGRESQL);\n+\n+    public static final CentralRepoDbChoice[] CHOICES = new CentralRepoDbChoice[]{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzAzMzMxOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyMzoyMFrOFygzuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyMzoyMFrOFygzuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxMDY0OQ==", "bodyText": "I think since this isn't a constant it should be normal lower case", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388510649", "createdAt": "2020-03-05T19:23:20Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbManager.java", "diffHunk": "@@ -34,6 +35,45 @@\n \n     private static final String CENTRAL_REPO_DB_NAME = \"central_repository\";\n \n+\n+\n+    private static volatile CentralRepoDbChoice SAVED_CHOICE = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzAzNzQyOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyNDoyOFrOFyg2Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOToyNDoyOFrOFyg2Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxMTI5OA==", "bodyText": "If the second string is displayed in the UI, it should be in a bundle message", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388511298", "createdAt": "2020-03-05T19:24:28Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbChoice.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Central Repository\n+ *\n+ * Copyright 2015-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+/**\n+ * the database choices available for central repo\n+ */\n+public class CentralRepoDbChoice {\n+    public static final CentralRepoDbChoice DISABLED = new CentralRepoDbChoice(\"Disabled\", CentralRepoPlatforms.DISABLED);\n+\n+    public static final CentralRepoDbChoice SQLITE = new CentralRepoDbChoice(\"Sqlite\", \"SQLite\", CentralRepoPlatforms.SQLITE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzA3Njk0OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTozNjozNVrOFyhPNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNDoxMzo0N1rOFy6DzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxNzY4Nw==", "bodyText": "Should we do more than just log an error if these parameters are invalid? There may be empty fields in the settings object. If this is what we want to do, add a comment that this is what's happening.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388517687", "createdAt": "2020-03-05T19:36:35Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2012-2020 Basis Technology Corp.\n+ *\n+ * Copyright 2012 42six Solutions.\n+ * Contact: aebadirad <at> 42six <dot> com\n+ * Project Contact/Architect: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.logging.Level;\n+import org.sleuthkit.autopsy.core.UserPreferences;\n+import org.sleuthkit.autopsy.core.UserPreferencesException;\n+import org.sleuthkit.autopsy.coreutils.Logger;\n+import org.sleuthkit.autopsy.coreutils.ModuleSettings;\n+import org.sleuthkit.autopsy.coreutils.TextConverter;\n+import org.sleuthkit.autopsy.coreutils.TextConverterException;\n+import org.sleuthkit.datamodel.CaseDbConnectionInfo;\n+\n+/**\n+ * handles saving and loading of postgres settings for central repo\n+ */\n+public class CentralRepoPostgresSettingsUtil {\n+    private final static Logger LOGGER = Logger.getLogger(CentralRepoPostgresSettingsUtil.class.getName());\n+    \n+    private final static String DEFAULT_HOST = \"\"; // NON-NLS\n+    private final static int DEFAULT_PORT = 5432;\n+    private final static String DEFAULT_DBNAME = \"central_repository\"; // NON-NLS\n+    private final static String DEFAULT_USERNAME = \"\";\n+    private final static String DEFAULT_PASSWORD = \"\";\n+\n+    private static final String PASSWORD_KEY = \"db.postgresql.password\";\n+    private static final String BULK_THRESHOLD_KEY = \"db.postgresql.bulkThreshold\";\n+    private static final String PORT_KEY = \"db.postgresql.port\";\n+    private static final String USER_KEY = \"db.postgresql.user\";\n+    private static final String DBNAME_KEY = \"db.postgresql.dbName\";\n+    private static final String HOST_KEY = \"db.postgresql.host\";\n+\n+    private static final String MODULE_KEY = \"CentralRepository\";\n+\n+    \n+    \n+    private static String valOrDefault(String val, String defaultVal) {\n+        if (val == null || val.isEmpty())\n+            return defaultVal;\n+        \n+        return val;\n+    }\n+    \n+    private static int valOrDefault(String val, int defaultVal, Integer min, Integer max) {\n+        try {\n+            if (val == null || val.isEmpty()) {\n+                return defaultVal;\n+            } else {\n+                int retVal = Integer.parseInt(val);\n+                if ((min != null && retVal < min) || (max != null && retVal > max)) {\n+                    return defaultVal;\n+                }\n+                else {\n+                    return retVal;\n+                }\n+            }\n+        } catch (NumberFormatException ex) {\n+            return defaultVal;\n+        }\n+    }\n+    \n+    private static void handleTry(TryHandler handler) {\n+        try {\n+            handler.operation();\n+        }\n+        catch (CentralRepoException e) {\n+            LOGGER.log(Level.WARNING, \"There was an error in converting central repo postgres settings\", e);\n+        }\n+    }\n+    \n+    /**\n+     * an action that potentially throws an exception\n+     */\n+    private interface TryHandler {\n+        void operation() throws CentralRepoException;\n+    }\n+    \n+    \n+    public static PostgresConnectionSettings loadMultiUserSettings() {\n+        PostgresConnectionSettings settings = new PostgresConnectionSettings();\n+        \n+        CaseDbConnectionInfo muConn;\n+        try {\n+            muConn = UserPreferences.getDatabaseConnectionInfo();\n+        } catch (UserPreferencesException ex) {\n+            LOGGER.log(Level.SEVERE, \"Failed to import settings from multi-user settings.\", ex);\n+            return settings;\n+        }\n+        \n+        handleTry(() -> settings.setHost(valOrDefault(muConn.getHost(), DEFAULT_HOST)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODU2NTg2Nw==", "bodyText": "My goal for this and the other thing you mentioned in this file was to preserve the the same behavior here: https://github.com/sleuthkit/autopsy/blob/develop/Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/PostgresCentralRepoSettings.java#L73.  Would it be worth changing right now or should this wait for another time?", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388565867", "createdAt": "2020-03-05T21:07:22Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2012-2020 Basis Technology Corp.\n+ *\n+ * Copyright 2012 42six Solutions.\n+ * Contact: aebadirad <at> 42six <dot> com\n+ * Project Contact/Architect: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.logging.Level;\n+import org.sleuthkit.autopsy.core.UserPreferences;\n+import org.sleuthkit.autopsy.core.UserPreferencesException;\n+import org.sleuthkit.autopsy.coreutils.Logger;\n+import org.sleuthkit.autopsy.coreutils.ModuleSettings;\n+import org.sleuthkit.autopsy.coreutils.TextConverter;\n+import org.sleuthkit.autopsy.coreutils.TextConverterException;\n+import org.sleuthkit.datamodel.CaseDbConnectionInfo;\n+\n+/**\n+ * handles saving and loading of postgres settings for central repo\n+ */\n+public class CentralRepoPostgresSettingsUtil {\n+    private final static Logger LOGGER = Logger.getLogger(CentralRepoPostgresSettingsUtil.class.getName());\n+    \n+    private final static String DEFAULT_HOST = \"\"; // NON-NLS\n+    private final static int DEFAULT_PORT = 5432;\n+    private final static String DEFAULT_DBNAME = \"central_repository\"; // NON-NLS\n+    private final static String DEFAULT_USERNAME = \"\";\n+    private final static String DEFAULT_PASSWORD = \"\";\n+\n+    private static final String PASSWORD_KEY = \"db.postgresql.password\";\n+    private static final String BULK_THRESHOLD_KEY = \"db.postgresql.bulkThreshold\";\n+    private static final String PORT_KEY = \"db.postgresql.port\";\n+    private static final String USER_KEY = \"db.postgresql.user\";\n+    private static final String DBNAME_KEY = \"db.postgresql.dbName\";\n+    private static final String HOST_KEY = \"db.postgresql.host\";\n+\n+    private static final String MODULE_KEY = \"CentralRepository\";\n+\n+    \n+    \n+    private static String valOrDefault(String val, String defaultVal) {\n+        if (val == null || val.isEmpty())\n+            return defaultVal;\n+        \n+        return val;\n+    }\n+    \n+    private static int valOrDefault(String val, int defaultVal, Integer min, Integer max) {\n+        try {\n+            if (val == null || val.isEmpty()) {\n+                return defaultVal;\n+            } else {\n+                int retVal = Integer.parseInt(val);\n+                if ((min != null && retVal < min) || (max != null && retVal > max)) {\n+                    return defaultVal;\n+                }\n+                else {\n+                    return retVal;\n+                }\n+            }\n+        } catch (NumberFormatException ex) {\n+            return defaultVal;\n+        }\n+    }\n+    \n+    private static void handleTry(TryHandler handler) {\n+        try {\n+            handler.operation();\n+        }\n+        catch (CentralRepoException e) {\n+            LOGGER.log(Level.WARNING, \"There was an error in converting central repo postgres settings\", e);\n+        }\n+    }\n+    \n+    /**\n+     * an action that potentially throws an exception\n+     */\n+    private interface TryHandler {\n+        void operation() throws CentralRepoException;\n+    }\n+    \n+    \n+    public static PostgresConnectionSettings loadMultiUserSettings() {\n+        PostgresConnectionSettings settings = new PostgresConnectionSettings();\n+        \n+        CaseDbConnectionInfo muConn;\n+        try {\n+            muConn = UserPreferences.getDatabaseConnectionInfo();\n+        } catch (UserPreferencesException ex) {\n+            LOGGER.log(Level.SEVERE, \"Failed to import settings from multi-user settings.\", ex);\n+            return settings;\n+        }\n+        \n+        handleTry(() -> settings.setHost(valOrDefault(muConn.getHost(), DEFAULT_HOST)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxNzY4Nw=="}, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwNTAyMg==", "bodyText": "I don't think you've quite preserved that logic, though I may be reading it wrong. It seems like in your new code if the exception gets thrown the field doesn't get saved to the default.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388905022", "createdAt": "2020-03-06T13:35:30Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2012-2020 Basis Technology Corp.\n+ *\n+ * Copyright 2012 42six Solutions.\n+ * Contact: aebadirad <at> 42six <dot> com\n+ * Project Contact/Architect: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.logging.Level;\n+import org.sleuthkit.autopsy.core.UserPreferences;\n+import org.sleuthkit.autopsy.core.UserPreferencesException;\n+import org.sleuthkit.autopsy.coreutils.Logger;\n+import org.sleuthkit.autopsy.coreutils.ModuleSettings;\n+import org.sleuthkit.autopsy.coreutils.TextConverter;\n+import org.sleuthkit.autopsy.coreutils.TextConverterException;\n+import org.sleuthkit.datamodel.CaseDbConnectionInfo;\n+\n+/**\n+ * handles saving and loading of postgres settings for central repo\n+ */\n+public class CentralRepoPostgresSettingsUtil {\n+    private final static Logger LOGGER = Logger.getLogger(CentralRepoPostgresSettingsUtil.class.getName());\n+    \n+    private final static String DEFAULT_HOST = \"\"; // NON-NLS\n+    private final static int DEFAULT_PORT = 5432;\n+    private final static String DEFAULT_DBNAME = \"central_repository\"; // NON-NLS\n+    private final static String DEFAULT_USERNAME = \"\";\n+    private final static String DEFAULT_PASSWORD = \"\";\n+\n+    private static final String PASSWORD_KEY = \"db.postgresql.password\";\n+    private static final String BULK_THRESHOLD_KEY = \"db.postgresql.bulkThreshold\";\n+    private static final String PORT_KEY = \"db.postgresql.port\";\n+    private static final String USER_KEY = \"db.postgresql.user\";\n+    private static final String DBNAME_KEY = \"db.postgresql.dbName\";\n+    private static final String HOST_KEY = \"db.postgresql.host\";\n+\n+    private static final String MODULE_KEY = \"CentralRepository\";\n+\n+    \n+    \n+    private static String valOrDefault(String val, String defaultVal) {\n+        if (val == null || val.isEmpty())\n+            return defaultVal;\n+        \n+        return val;\n+    }\n+    \n+    private static int valOrDefault(String val, int defaultVal, Integer min, Integer max) {\n+        try {\n+            if (val == null || val.isEmpty()) {\n+                return defaultVal;\n+            } else {\n+                int retVal = Integer.parseInt(val);\n+                if ((min != null && retVal < min) || (max != null && retVal > max)) {\n+                    return defaultVal;\n+                }\n+                else {\n+                    return retVal;\n+                }\n+            }\n+        } catch (NumberFormatException ex) {\n+            return defaultVal;\n+        }\n+    }\n+    \n+    private static void handleTry(TryHandler handler) {\n+        try {\n+            handler.operation();\n+        }\n+        catch (CentralRepoException e) {\n+            LOGGER.log(Level.WARNING, \"There was an error in converting central repo postgres settings\", e);\n+        }\n+    }\n+    \n+    /**\n+     * an action that potentially throws an exception\n+     */\n+    private interface TryHandler {\n+        void operation() throws CentralRepoException;\n+    }\n+    \n+    \n+    public static PostgresConnectionSettings loadMultiUserSettings() {\n+        PostgresConnectionSettings settings = new PostgresConnectionSettings();\n+        \n+        CaseDbConnectionInfo muConn;\n+        try {\n+            muConn = UserPreferences.getDatabaseConnectionInfo();\n+        } catch (UserPreferencesException ex) {\n+            LOGGER.log(Level.SEVERE, \"Failed to import settings from multi-user settings.\", ex);\n+            return settings;\n+        }\n+        \n+        handleTry(() -> settings.setHost(valOrDefault(muConn.getHost(), DEFAULT_HOST)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxNzY4Nw=="}, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkyNDM2NQ==", "bodyText": "Oh okay.  I'll fix that.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388924365", "createdAt": "2020-03-06T14:13:47Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2012-2020 Basis Technology Corp.\n+ *\n+ * Copyright 2012 42six Solutions.\n+ * Contact: aebadirad <at> 42six <dot> com\n+ * Project Contact/Architect: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.logging.Level;\n+import org.sleuthkit.autopsy.core.UserPreferences;\n+import org.sleuthkit.autopsy.core.UserPreferencesException;\n+import org.sleuthkit.autopsy.coreutils.Logger;\n+import org.sleuthkit.autopsy.coreutils.ModuleSettings;\n+import org.sleuthkit.autopsy.coreutils.TextConverter;\n+import org.sleuthkit.autopsy.coreutils.TextConverterException;\n+import org.sleuthkit.datamodel.CaseDbConnectionInfo;\n+\n+/**\n+ * handles saving and loading of postgres settings for central repo\n+ */\n+public class CentralRepoPostgresSettingsUtil {\n+    private final static Logger LOGGER = Logger.getLogger(CentralRepoPostgresSettingsUtil.class.getName());\n+    \n+    private final static String DEFAULT_HOST = \"\"; // NON-NLS\n+    private final static int DEFAULT_PORT = 5432;\n+    private final static String DEFAULT_DBNAME = \"central_repository\"; // NON-NLS\n+    private final static String DEFAULT_USERNAME = \"\";\n+    private final static String DEFAULT_PASSWORD = \"\";\n+\n+    private static final String PASSWORD_KEY = \"db.postgresql.password\";\n+    private static final String BULK_THRESHOLD_KEY = \"db.postgresql.bulkThreshold\";\n+    private static final String PORT_KEY = \"db.postgresql.port\";\n+    private static final String USER_KEY = \"db.postgresql.user\";\n+    private static final String DBNAME_KEY = \"db.postgresql.dbName\";\n+    private static final String HOST_KEY = \"db.postgresql.host\";\n+\n+    private static final String MODULE_KEY = \"CentralRepository\";\n+\n+    \n+    \n+    private static String valOrDefault(String val, String defaultVal) {\n+        if (val == null || val.isEmpty())\n+            return defaultVal;\n+        \n+        return val;\n+    }\n+    \n+    private static int valOrDefault(String val, int defaultVal, Integer min, Integer max) {\n+        try {\n+            if (val == null || val.isEmpty()) {\n+                return defaultVal;\n+            } else {\n+                int retVal = Integer.parseInt(val);\n+                if ((min != null && retVal < min) || (max != null && retVal > max)) {\n+                    return defaultVal;\n+                }\n+                else {\n+                    return retVal;\n+                }\n+            }\n+        } catch (NumberFormatException ex) {\n+            return defaultVal;\n+        }\n+    }\n+    \n+    private static void handleTry(TryHandler handler) {\n+        try {\n+            handler.operation();\n+        }\n+        catch (CentralRepoException e) {\n+            LOGGER.log(Level.WARNING, \"There was an error in converting central repo postgres settings\", e);\n+        }\n+    }\n+    \n+    /**\n+     * an action that potentially throws an exception\n+     */\n+    private interface TryHandler {\n+        void operation() throws CentralRepoException;\n+    }\n+    \n+    \n+    public static PostgresConnectionSettings loadMultiUserSettings() {\n+        PostgresConnectionSettings settings = new PostgresConnectionSettings();\n+        \n+        CaseDbConnectionInfo muConn;\n+        try {\n+            muConn = UserPreferences.getDatabaseConnectionInfo();\n+        } catch (UserPreferencesException ex) {\n+            LOGGER.log(Level.SEVERE, \"Failed to import settings from multi-user settings.\", ex);\n+            return settings;\n+        }\n+        \n+        handleTry(() -> settings.setHost(valOrDefault(muConn.getHost(), DEFAULT_HOST)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxNzY4Nw=="}, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 112}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzA4Mjk2OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTozODoxN1rOFyhS4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTozODoxN1rOFyhS4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUxODYyNA==", "bodyText": "This could use a comment and a more descriptive name. As it stands, logException() would be more accurate.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388518624", "createdAt": "2020-03-05T19:38:17Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2012-2020 Basis Technology Corp.\n+ *\n+ * Copyright 2012 42six Solutions.\n+ * Contact: aebadirad <at> 42six <dot> com\n+ * Project Contact/Architect: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.logging.Level;\n+import org.sleuthkit.autopsy.core.UserPreferences;\n+import org.sleuthkit.autopsy.core.UserPreferencesException;\n+import org.sleuthkit.autopsy.coreutils.Logger;\n+import org.sleuthkit.autopsy.coreutils.ModuleSettings;\n+import org.sleuthkit.autopsy.coreutils.TextConverter;\n+import org.sleuthkit.autopsy.coreutils.TextConverterException;\n+import org.sleuthkit.datamodel.CaseDbConnectionInfo;\n+\n+/**\n+ * handles saving and loading of postgres settings for central repo\n+ */\n+public class CentralRepoPostgresSettingsUtil {\n+    private final static Logger LOGGER = Logger.getLogger(CentralRepoPostgresSettingsUtil.class.getName());\n+    \n+    private final static String DEFAULT_HOST = \"\"; // NON-NLS\n+    private final static int DEFAULT_PORT = 5432;\n+    private final static String DEFAULT_DBNAME = \"central_repository\"; // NON-NLS\n+    private final static String DEFAULT_USERNAME = \"\";\n+    private final static String DEFAULT_PASSWORD = \"\";\n+\n+    private static final String PASSWORD_KEY = \"db.postgresql.password\";\n+    private static final String BULK_THRESHOLD_KEY = \"db.postgresql.bulkThreshold\";\n+    private static final String PORT_KEY = \"db.postgresql.port\";\n+    private static final String USER_KEY = \"db.postgresql.user\";\n+    private static final String DBNAME_KEY = \"db.postgresql.dbName\";\n+    private static final String HOST_KEY = \"db.postgresql.host\";\n+\n+    private static final String MODULE_KEY = \"CentralRepository\";\n+\n+    \n+    \n+    private static String valOrDefault(String val, String defaultVal) {\n+        if (val == null || val.isEmpty())\n+            return defaultVal;\n+        \n+        return val;\n+    }\n+    \n+    private static int valOrDefault(String val, int defaultVal, Integer min, Integer max) {\n+        try {\n+            if (val == null || val.isEmpty()) {\n+                return defaultVal;\n+            } else {\n+                int retVal = Integer.parseInt(val);\n+                if ((min != null && retVal < min) || (max != null && retVal > max)) {\n+                    return defaultVal;\n+                }\n+                else {\n+                    return retVal;\n+                }\n+            }\n+        } catch (NumberFormatException ex) {\n+            return defaultVal;\n+        }\n+    }\n+    \n+    private static void handleTry(TryHandler handler) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzEwMDQxOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0MzoyN1rOFyhd-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0MzoyN1rOFyhd-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUyMTQ2NA==", "bodyText": "In the previous section this is a warning and the default password is used. Why is it different here? Also if the error is \"SEVERE\" we probably shouldn't just log it and continue on.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388521464", "createdAt": "2020-03-05T19:43:27Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoPostgresSettingsUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2012-2020 Basis Technology Corp.\n+ *\n+ * Copyright 2012 42six Solutions.\n+ * Contact: aebadirad <at> 42six <dot> com\n+ * Project Contact/Architect: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.logging.Level;\n+import org.sleuthkit.autopsy.core.UserPreferences;\n+import org.sleuthkit.autopsy.core.UserPreferencesException;\n+import org.sleuthkit.autopsy.coreutils.Logger;\n+import org.sleuthkit.autopsy.coreutils.ModuleSettings;\n+import org.sleuthkit.autopsy.coreutils.TextConverter;\n+import org.sleuthkit.autopsy.coreutils.TextConverterException;\n+import org.sleuthkit.datamodel.CaseDbConnectionInfo;\n+\n+/**\n+ * handles saving and loading of postgres settings for central repo\n+ */\n+public class CentralRepoPostgresSettingsUtil {\n+    private final static Logger LOGGER = Logger.getLogger(CentralRepoPostgresSettingsUtil.class.getName());\n+    \n+    private final static String DEFAULT_HOST = \"\"; // NON-NLS\n+    private final static int DEFAULT_PORT = 5432;\n+    private final static String DEFAULT_DBNAME = \"central_repository\"; // NON-NLS\n+    private final static String DEFAULT_USERNAME = \"\";\n+    private final static String DEFAULT_PASSWORD = \"\";\n+\n+    private static final String PASSWORD_KEY = \"db.postgresql.password\";\n+    private static final String BULK_THRESHOLD_KEY = \"db.postgresql.bulkThreshold\";\n+    private static final String PORT_KEY = \"db.postgresql.port\";\n+    private static final String USER_KEY = \"db.postgresql.user\";\n+    private static final String DBNAME_KEY = \"db.postgresql.dbName\";\n+    private static final String HOST_KEY = \"db.postgresql.host\";\n+\n+    private static final String MODULE_KEY = \"CentralRepository\";\n+\n+    \n+    \n+    private static String valOrDefault(String val, String defaultVal) {\n+        if (val == null || val.isEmpty())\n+            return defaultVal;\n+        \n+        return val;\n+    }\n+    \n+    private static int valOrDefault(String val, int defaultVal, Integer min, Integer max) {\n+        try {\n+            if (val == null || val.isEmpty()) {\n+                return defaultVal;\n+            } else {\n+                int retVal = Integer.parseInt(val);\n+                if ((min != null && retVal < min) || (max != null && retVal > max)) {\n+                    return defaultVal;\n+                }\n+                else {\n+                    return retVal;\n+                }\n+            }\n+        } catch (NumberFormatException ex) {\n+            return defaultVal;\n+        }\n+    }\n+    \n+    private static void handleTry(TryHandler handler) {\n+        try {\n+            handler.operation();\n+        }\n+        catch (CentralRepoException e) {\n+            LOGGER.log(Level.WARNING, \"There was an error in converting central repo postgres settings\", e);\n+        }\n+    }\n+    \n+    /**\n+     * an action that potentially throws an exception\n+     */\n+    private interface TryHandler {\n+        void operation() throws CentralRepoException;\n+    }\n+    \n+    \n+    public static PostgresConnectionSettings loadMultiUserSettings() {\n+        PostgresConnectionSettings settings = new PostgresConnectionSettings();\n+        \n+        CaseDbConnectionInfo muConn;\n+        try {\n+            muConn = UserPreferences.getDatabaseConnectionInfo();\n+        } catch (UserPreferencesException ex) {\n+            LOGGER.log(Level.SEVERE, \"Failed to import settings from multi-user settings.\", ex);\n+            return settings;\n+        }\n+        \n+        handleTry(() -> settings.setHost(valOrDefault(muConn.getHost(), DEFAULT_HOST)));\n+        handleTry(() -> settings.setDbName(DEFAULT_DBNAME));\n+        handleTry(() -> settings.setUserName(valOrDefault(muConn.getUserName(), DEFAULT_USERNAME)));\n+        \n+        handleTry(() -> settings.setPort(valOrDefault(muConn.getPort(), DEFAULT_PORT, 1, 65535)));\n+        handleTry(() -> settings.setBulkThreshold(RdbmsCentralRepo.DEFAULT_BULK_THRESHHOLD));\n+        \n+        handleTry(() -> settings.setPassword(valOrDefault(muConn.getPassword(), DEFAULT_PASSWORD)));\n+        \n+        return settings;\n+    }\n+    \n+    \n+    public static PostgresConnectionSettings loadCustomSettings() {\n+        PostgresConnectionSettings settings = new PostgresConnectionSettings();\n+        Map<String, String> keyVals = ModuleSettings.getConfigSettings(MODULE_KEY);\n+        \n+        \n+        handleTry(() -> settings.setHost(valOrDefault(keyVals.get(HOST_KEY), DEFAULT_HOST)));\n+        handleTry(() -> settings.setDbName(valOrDefault(keyVals.get(DBNAME_KEY), DEFAULT_DBNAME)));\n+        handleTry(() -> settings.setUserName(valOrDefault(keyVals.get(USER_KEY), DEFAULT_USERNAME)));\n+        \n+        handleTry(() -> settings.setPort(valOrDefault(keyVals.get(PORT_KEY), DEFAULT_PORT, 1, 65535)));\n+        handleTry(() -> settings.setBulkThreshold(valOrDefault(keyVals.get(BULK_THRESHOLD_KEY), RdbmsCentralRepo.DEFAULT_BULK_THRESHHOLD, 1, null)));\n+        \n+        String passwordHex = keyVals.get(PASSWORD_KEY);\n+        String password;\n+        try {\n+            password = TextConverter.convertHexTextToText(passwordHex);\n+        } catch (TextConverterException ex) {\n+            LOGGER.log(Level.WARNING, \"Failed to convert password from hex text to text.\", ex);\n+            password = DEFAULT_PASSWORD;\n+        }\n+        \n+        final String finalPassword = password;\n+        \n+        handleTry(() -> settings.setPassword(finalPassword));\n+        return settings;\n+    }\n+\n+    public static void saveCustomSettings(PostgresConnectionSettings settings) {\n+        Map<String, String> map = new HashMap<String, String>();\n+        map.put(HOST_KEY, settings.getHost());\n+        map.put(PORT_KEY, Integer.toString(settings.getPort()));\n+        map.put(DBNAME_KEY, settings.getDbName());\n+        map.put(BULK_THRESHOLD_KEY, Integer.toString(settings.getBulkThreshold()));\n+        map.put(USER_KEY, settings.getUserName());\n+        try {\n+            map.put(PASSWORD_KEY, TextConverter.convertTextToHexText(settings.getPassword())); // NON-NLS\n+        } catch (TextConverterException ex) {\n+            LOGGER.log(Level.SEVERE, \"Failed to convert password from text to hex text.\", ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 162}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzEwNjU0OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/PostgresSettingsLoader.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0NToxM1rOFyhh3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0NToxM1rOFyhh3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUyMjQ2MA==", "bodyText": "These names could be a bit more descriptive.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388522460", "createdAt": "2020-03-05T19:45:13Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/PostgresSettingsLoader.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Central Repository\n+ *\n+ * Copyright 2015-2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.centralrepository.datamodel;\n+\n+/**\n+ * interface to load or save postgres settings\n+ */\n+public interface PostgresSettingsLoader {\n+    PostgresConnectionSettings loadSettings();\n+    void saveSettings(PostgresConnectionSettings settings);\n+    \n+    PostgresSettingsLoader CUSTOM_LOADER = new Custom();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzExNjI2OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/core/UserPreferences.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0NzozMlrOFyhnbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMjo0MDoxMFrOFy3XuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUyMzg4NQ==", "bodyText": "Why is this in this PR?", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388523885", "createdAt": "2020-03-05T19:47:32Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/core/UserPreferences.java", "diffHunk": "@@ -75,6 +75,7 @@\n     public static final String SHOW_ONLY_CURRENT_USER_TAGS = \"ShowOnlyCurrentUserTags\";\n     public static final String HIDE_SCO_COLUMNS = \"HideCentralRepoCommentsAndOccurrences\"; //The key for this setting pre-dates the settings current functionality //NON-NLS\n     public static final String DISPLAY_TRANSLATED_NAMES = \"DisplayTranslatedNames\";\n+    private static final boolean DISPLAY_TRANSLATED_NAMES_DEFAULT = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg4MDMxMg==", "bodyText": "Sorry about that.  I'll correct it.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388880312", "createdAt": "2020-03-06T12:40:10Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/core/UserPreferences.java", "diffHunk": "@@ -75,6 +75,7 @@\n     public static final String SHOW_ONLY_CURRENT_USER_TAGS = \"ShowOnlyCurrentUserTags\";\n     public static final String HIDE_SCO_COLUMNS = \"HideCentralRepoCommentsAndOccurrences\"; //The key for this setting pre-dates the settings current functionality //NON-NLS\n     public static final String DISPLAY_TRANSLATED_NAMES = \"DisplayTranslatedNames\";\n+    private static final boolean DISPLAY_TRANSLATED_NAMES_DEFAULT = true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUyMzg4NQ=="}, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNzExODI2OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/PostgresCentralRepoSettings.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0ODowOVrOFyhoyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxOTo0ODowOVrOFyhoyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODUyNDIzMg==", "bodyText": "I don't think you named this, but an underscore would really help readability for \"TESTEDOK\"", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r388524232", "createdAt": "2020-03-05T19:48:09Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/PostgresCentralRepoSettings.java", "diffHunk": "@@ -377,95 +305,72 @@ public void setPort(int port) throws CentralRepoException {\n      * @return the dbName\n      */\n     public String getDbName() {\n-        return dbName.toLowerCase();\n+        return connSettings.getDbName() == null ? null : connSettings.getDbName().toLowerCase();\n     }\n \n     /**\n      * @param dbName the dbName to set\n      */\n     public void setDbName(String dbName) throws CentralRepoException {\n-        if (dbName == null || dbName.isEmpty()) {\n-            throw new CentralRepoException(\"Invalid database name. Cannot be empty.\"); // NON-NLS\n-        } else if (!Pattern.matches(DB_NAMES_REGEX, dbName)) {\n-            throw new CentralRepoException(\"Invalid database name. Name must start with a lowercase letter and can only contain lowercase letters, numbers, and '_'.\"); // NON-NLS\n-        }\n-\n-        this.dbName = dbName.toLowerCase();\n+        connSettings.setDbName(dbName);\n     }\n \n     /**\n      * @return the bulkThreshold\n      */\n     int getBulkThreshold() {\n-        return bulkThreshold;\n+        return connSettings.getBulkThreshold();\n     }\n \n     /**\n      * @param bulkThreshold the bulkThreshold to set\n      */\n     public void setBulkThreshold(int bulkThreshold) throws CentralRepoException {\n-        if (bulkThreshold > 0) {\n-            this.bulkThreshold = bulkThreshold;\n-        } else {\n-            throw new CentralRepoException(\"Invalid bulk threshold.\"); // NON-NLS\n-        }\n+        connSettings.setBulkThreshold(bulkThreshold);\n     }\n \n     /**\n      * @return the userName\n      */\n     public String getUserName() {\n-        return userName;\n+        return connSettings.getUserName();\n     }\n \n     /**\n      * @param userName the userName to set\n      */\n     public void setUserName(String userName) throws CentralRepoException {\n-        if (userName == null || userName.isEmpty()) {\n-            throw new CentralRepoException(\"Invalid user name. Cannot be empty.\"); // NON-NLS\n-        } else if (!Pattern.matches(DB_USER_NAMES_REGEX, userName)) {\n-            throw new CentralRepoException(\"Invalid user name. Name must start with a letter and can only contain letters, numbers, and '_'.\"); // NON-NLS\n-        }\n-        this.userName = userName;\n+        connSettings.setUserName(userName);\n     }\n \n     /**\n      * @return the password\n      */\n     public String getPassword() {\n-        return password;\n+        return connSettings.getPassword();\n     }\n \n     /**\n      * @param password the password to set\n      */\n     public void setPassword(String password) throws CentralRepoException {\n-        if (password == null || password.isEmpty()) {\n-            throw new CentralRepoException(\"Invalid user password. Cannot be empty.\"); // NON-NLS\n-        }\n-        this.password = password;\n+        connSettings.setPassword(password);\n     }\n \n-    /**\n-     * @return the VALIDATION_QUERY\n-     */\n-    String getValidationQuery() {\n-        return VALIDATION_QUERY;\n-    }\n-\n-    /**\n-     * @return the POSTGRES_DRIVER\n-     */\n-    String getDriver() {\n-        return JDBC_DRIVER;\n-    }\n-\n-    /**\n-     * @return the JDBC_BASE_URI\n-     */\n-    String getJDBCBaseURI() {\n-        return JDBC_BASE_URI;\n+    @Override\n+    public DatabaseTestResult testStatus() {\n+        if (verifyConnection()) {\n+            if (verifyDatabaseExists()) {\n+                if (verifyDatabaseSchema()) {\n+                    return DatabaseTestResult.TESTEDOK;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da9059ed0c8a20777a7bdfdfe32586cb040cf87a"}, "originalPosition": 363}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNDQxMzIzOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/datamodel/AbstractAbstractFileNode.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxMjowMDoyNlrOFzkSjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxMjowMDoyNlrOFzkSjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTYxNjI3MA==", "bodyText": "Still have a translation change here.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r389616270", "createdAt": "2020-03-09T12:00:26Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/datamodel/AbstractAbstractFileNode.java", "diffHunk": "@@ -105,7 +105,7 @@\n                             this.content.getName(), this.content.getId()), ex);\n         }\n \n-        if (UserPreferences.displayTranslatedFileNames()) {\n+        if (TextTranslationService.getInstance().hasProvider() && UserPreferences.displayTranslatedFileNames()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c80f75e9a92c43cb84c6f1624111eea76f3387fe"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNDQ2OTEwOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/optionspanel/GlobalSettingsPanel.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxMjoyMDozNVrOFzk0kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxMjo0MzoyNlrOFzleyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTYyNDk3Nw==", "bodyText": "Would it be possible to implement PropertyChangeListener here instead of writing your own?", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r389624977", "createdAt": "2020-03-09T12:20:35Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/optionspanel/GlobalSettingsPanel.java", "diffHunk": "@@ -33,33 +33,58 @@\n import org.sleuthkit.autopsy.casemodule.Case;\n import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoDbManager;\n import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoException;\n+import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoPlatforms;\n import org.sleuthkit.autopsy.corecomponents.OptionsPanel;\n import org.sleuthkit.autopsy.events.AutopsyEvent;\n import org.sleuthkit.autopsy.ingest.IngestManager;\n import org.sleuthkit.autopsy.ingest.IngestModuleGlobalSettingsPanel;\n-import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoPlatforms;\n-import static org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoPlatforms.DISABLED;\n+import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoDbChoice;\n import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoDbUtil;\n import org.sleuthkit.autopsy.centralrepository.datamodel.PostgresCentralRepoSettings;\n import org.sleuthkit.autopsy.centralrepository.datamodel.SqliteCentralRepoSettings;\n+import java.awt.Component;\n+import java.util.logging.Level;\n \n /**\n  * Main settings panel for the Central Repository\n  */\n @SuppressWarnings(\"PMD.SingularField\") // UI widgets cause lots of false positives\n public final class GlobalSettingsPanel extends IngestModuleGlobalSettingsPanel implements OptionsPanel {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afddb61e7aecd4012a324de3f15faa1fbfe8507e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTYzNTc4Ng==", "bodyText": "Sure.  I will fix that.", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r389635786", "createdAt": "2020-03-09T12:43:26Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/optionspanel/GlobalSettingsPanel.java", "diffHunk": "@@ -33,33 +33,58 @@\n import org.sleuthkit.autopsy.casemodule.Case;\n import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoDbManager;\n import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoException;\n+import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoPlatforms;\n import org.sleuthkit.autopsy.corecomponents.OptionsPanel;\n import org.sleuthkit.autopsy.events.AutopsyEvent;\n import org.sleuthkit.autopsy.ingest.IngestManager;\n import org.sleuthkit.autopsy.ingest.IngestModuleGlobalSettingsPanel;\n-import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoPlatforms;\n-import static org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoPlatforms.DISABLED;\n+import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoDbChoice;\n import org.sleuthkit.autopsy.centralrepository.datamodel.CentralRepoDbUtil;\n import org.sleuthkit.autopsy.centralrepository.datamodel.PostgresCentralRepoSettings;\n import org.sleuthkit.autopsy.centralrepository.datamodel.SqliteCentralRepoSettings;\n+import java.awt.Component;\n+import java.util.logging.Level;\n \n /**\n  * Main settings panel for the Central Repository\n  */\n @SuppressWarnings(\"PMD.SingularField\") // UI widgets cause lots of false positives\n public final class GlobalSettingsPanel extends IngestModuleGlobalSettingsPanel implements OptionsPanel {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTYyNDk3Nw=="}, "originalCommit": {"oid": "afddb61e7aecd4012a324de3f15faa1fbfe8507e"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMDgzNzEwOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMjo1ODoxMVrOF2Cp8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMjo1ODoxMVrOF2Cp8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIxMDkzMQ==", "bodyText": "Random \"if\" here", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r392210931", "createdAt": "2020-03-13T12:58:11Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbManager.java", "diffHunk": "@@ -216,38 +365,45 @@ public boolean wasConfigurationChanged() {\n         return configurationChanged;\n     }\n \n-    private CentralRepoDbSettings getSelectedSettings() throws CentralRepoException {\n-        switch (selectedPlatform) {\n-            case POSTGRESQL:\n-                return dbSettingsPostgres;\n-            case SQLITE:\n-                return dbSettingsSqlite;\n-            case DISABLED:\n-                return null;\n-            default:\n-                throw new CentralRepoException(\"Unknown database type: \" + selectedPlatform);\n-        }\n+    private CentralRepoDbConnectivityManager getSelectedSettings() throws CentralRepoException {\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_MULTIUSER)\n+            return dbSettingsMultiUser;\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_CUSTOM)\n+            return dbSettingsPostgres;\n+        if (selectedDbChoice == CentralRepoDbChoice.SQLITE)\n+            return dbSettingsSqlite;\n+        if (selectedDbChoice == CentralRepoDbChoice.DISABLED)\n+            return null;\n+        \n+            throw new CentralRepoException(\"Unknown database type: \" + selectedDbChoice);\n     }\n \n     private RdbmsCentralRepoFactory getDbFactory() throws CentralRepoException {\n-        switch (selectedPlatform) {\n-            case POSTGRESQL:\n-                return new RdbmsCentralRepoFactory(selectedPlatform, dbSettingsPostgres);\n-            case SQLITE:\n-                return new RdbmsCentralRepoFactory(selectedPlatform, dbSettingsSqlite);\n-            case DISABLED:\n-                return null;\n-            default:\n-                throw new CentralRepoException(\"Unknown database type: \" + selectedPlatform);\n-        }\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_MULTIUSER)\n+            return new RdbmsCentralRepoFactory(CentralRepoPlatforms.POSTGRESQL, dbSettingsMultiUser);\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_CUSTOM)\n+            return new RdbmsCentralRepoFactory(CentralRepoPlatforms.POSTGRESQL, dbSettingsPostgres);\n+        if (selectedDbChoice == CentralRepoDbChoice.SQLITE)\n+            return new RdbmsCentralRepoFactory(CentralRepoPlatforms.SQLITE, dbSettingsSqlite);\n+        if (selectedDbChoice == CentralRepoDbChoice.DISABLED)\n+            return null;\n+        \n+        throw new CentralRepoException(\"Unknown database type: \" + selectedDbChoice);\n     }\n \n+    /**\n+     * create central repo database if it does not already exist\n+     * @return      true if successful; false if unsuccessful\n+     * @throws CentralRepoException     if ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67e06fd853c36e5d7c063b3708000312dbf69f6b"}, "originalPosition": 287}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMDg0MjI3OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMjo1OTo0NFrOF2CtOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxMjo1OTo0NFrOF2CtOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIxMTc2OA==", "bodyText": "Can you switch to capitalizing your comments per Richard's style email?", "url": "https://github.com/sleuthkit/autopsy/pull/5668#discussion_r392211768", "createdAt": "2020-03-13T12:59:44Z", "author": {"login": "APriestman"}, "path": "Core/src/org/sleuthkit/autopsy/centralrepository/datamodel/CentralRepoDbManager.java", "diffHunk": "@@ -216,38 +365,45 @@ public boolean wasConfigurationChanged() {\n         return configurationChanged;\n     }\n \n-    private CentralRepoDbSettings getSelectedSettings() throws CentralRepoException {\n-        switch (selectedPlatform) {\n-            case POSTGRESQL:\n-                return dbSettingsPostgres;\n-            case SQLITE:\n-                return dbSettingsSqlite;\n-            case DISABLED:\n-                return null;\n-            default:\n-                throw new CentralRepoException(\"Unknown database type: \" + selectedPlatform);\n-        }\n+    private CentralRepoDbConnectivityManager getSelectedSettings() throws CentralRepoException {\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_MULTIUSER)\n+            return dbSettingsMultiUser;\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_CUSTOM)\n+            return dbSettingsPostgres;\n+        if (selectedDbChoice == CentralRepoDbChoice.SQLITE)\n+            return dbSettingsSqlite;\n+        if (selectedDbChoice == CentralRepoDbChoice.DISABLED)\n+            return null;\n+        \n+            throw new CentralRepoException(\"Unknown database type: \" + selectedDbChoice);\n     }\n \n     private RdbmsCentralRepoFactory getDbFactory() throws CentralRepoException {\n-        switch (selectedPlatform) {\n-            case POSTGRESQL:\n-                return new RdbmsCentralRepoFactory(selectedPlatform, dbSettingsPostgres);\n-            case SQLITE:\n-                return new RdbmsCentralRepoFactory(selectedPlatform, dbSettingsSqlite);\n-            case DISABLED:\n-                return null;\n-            default:\n-                throw new CentralRepoException(\"Unknown database type: \" + selectedPlatform);\n-        }\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_MULTIUSER)\n+            return new RdbmsCentralRepoFactory(CentralRepoPlatforms.POSTGRESQL, dbSettingsMultiUser);\n+        if (selectedDbChoice == CentralRepoDbChoice.POSTGRESQL_CUSTOM)\n+            return new RdbmsCentralRepoFactory(CentralRepoPlatforms.POSTGRESQL, dbSettingsPostgres);\n+        if (selectedDbChoice == CentralRepoDbChoice.SQLITE)\n+            return new RdbmsCentralRepoFactory(CentralRepoPlatforms.SQLITE, dbSettingsSqlite);\n+        if (selectedDbChoice == CentralRepoDbChoice.DISABLED)\n+            return null;\n+        \n+        throw new CentralRepoException(\"Unknown database type: \" + selectedDbChoice);\n     }\n \n+    /**\n+     * create central repo database if it does not already exist", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67e06fd853c36e5d7c063b3708000312dbf69f6b"}, "originalPosition": 285}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 749, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}