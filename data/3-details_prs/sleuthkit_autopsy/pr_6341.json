{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzMTY5NjI0", "number": 6341, "title": "6890-Additional-errors-when-ingesting-multi-user-case", "bodyText": "Added path to help narrow file search and removed wildcard's from browser files that do not need them.", "createdAt": "2020-09-25T15:59:07Z", "url": "https://github.com/sleuthkit/autopsy/pull/6341", "merged": true, "mergeCommit": {"oid": "0d8539400835be977947acb34e4b8bba93082009"}, "closed": true, "closedAt": "2020-10-05T21:28:23Z", "author": {"login": "markmckinnon"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMX7EsAH2gAyNDkzMTY5NjI0OmYxYWEzYzNkYjVlYzQwYTMxYjhkOTAwYmI4OWRmMGNjM2U4MTFjZWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPm6HPAFqTUwMjI1NDMwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f1aa3c3db5ec40a31b8d900bb89df0cc3e811ced", "author": {"user": {"login": "markmckinnon", "name": "Mark McKinnon"}}, "url": "https://github.com/sleuthkit/autopsy/commit/f1aa3c3db5ec40a31b8d900bb89df0cc3e811ced", "committedDate": "2020-09-25T15:56:40Z", "message": "Update Chromium.java\n\nAdded path to help narrow file search and removed wildcard's from browser files that do not need them."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8090150d38b2ed158080e8999b0ec7c5b7b6636", "author": {"user": {"login": "markmckinnon", "name": "Mark McKinnon"}}, "url": "https://github.com/sleuthkit/autopsy/commit/b8090150d38b2ed158080e8999b0ec7c5b7b6636", "committedDate": "2020-09-25T19:09:03Z", "message": "Update Chromium.java\n\nSee what codacy will come back with"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4", "author": {"user": {"login": "markmckinnon", "name": "Mark McKinnon"}}, "url": "https://github.com/sleuthkit/autopsy/commit/cf5ae9154227b1a9b42eab97464a925d561457a4", "committedDate": "2020-09-25T19:53:51Z", "message": "Update Chromium.java\n\nAddress Codacy Issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTk3MTY1", "url": "https://github.com/sleuthkit/autopsy/pull/6341#pullrequestreview-500597165", "createdAt": "2020-10-01T18:07:26Z", "commit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowNzoyNlrOHbVktw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowNzoyNlrOHbVktw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyNzA2Mw==", "bodyText": "Just because I'm wondering - why are these bundle messages?", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498427063", "createdAt": "2020-10-01T18:07:26Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -81,21 +81,27 @@\n     private static final String WEBFORM_ADDRESS_QUERY_V8X = \"SELECT first_name, middle_name, last_name, full_name, street_address, city, state, zipcode, country_code, number, email, date_modified, use_date, use_count\" +\n                                                             \" FROM autofill_profiles, autofill_profile_names, autofill_profile_emails, autofill_profile_phones\" +\n                                                             \" WHERE autofill_profiles.guid = autofill_profile_names.guid AND autofill_profiles.guid = autofill_profile_emails.guid AND autofill_profiles.guid = autofill_profile_phones.guid\";\n+    private static final String HISTORY_FILE_NAME = \"History\";\n+    private static final String BOOKMARK_FILE_NAME = \"Bookmarks\";\n+    private static final String COOKIE_FILE_NAME = \"Cookies\";\n+    private static final String LOGIN_DATA_FILE_NAME = \"Login Data\";\n+    private static final String WEB_DATA_FILE_NAME = \"Web Data\";\n+\n+    \n     private final Logger logger = Logger.getLogger(this.getClass().getName());\n     private Content dataSource;\n     private IngestJobContext context;\n \n     private static final Map<String, String> BROWSERS_MAP = ImmutableMap.<String, String>builder()  \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Microsoft.Edge\"), \"Microsoft/Edge\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Yandex\"), \"YandexBrowser\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Opera\"), \"Opera Software\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.SalamWeb\"), \"SalamWeb\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\"), \"UCBrowser\")\n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Brave\"), \"BraveSoftware\")\n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Google.Chrome\"), \"Chrome\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Microsoft.Edge\"), \"Microsoft/Edge/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Yandex\"), \"YandexBrowser/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Opera\"), \"Opera Software/Opera Stable\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.SalamWeb\"), \"SalamWeb/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\"), \"UCBrowser/User Data%/Default\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Brave\"), \"BraveSoftware/Brave-Browser/User Data/Default\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Google.Chrome\"), \"Chrome/User Data/Default\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTk4NjM3", "url": "https://github.com/sleuthkit/autopsy/pull/6341#pullrequestreview-500598637", "createdAt": "2020-10-01T18:09:28Z", "commit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowOToyOFrOHbVo9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowOToyOFrOHbVo9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyODE0OQ==", "bodyText": "Should this be .equals() instead? There are several of these.", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498428149", "createdAt": "2020-10-01T18:09:28Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -174,8 +180,12 @@ public void process(Content dataSource, IngestJobContext context, DataSourceInge\n     private void getHistory(String browser, String browserLocation) {\n         FileManager fileManager = currentCase.getServices().getFileManager();\n         List<AbstractFile> historyFiles;\n+        String historyFileName = HISTORY_FILE_NAME;\n+        if (browser == NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjAwMzY5", "url": "https://github.com/sleuthkit/autopsy/pull/6341#pullrequestreview-500600369", "createdAt": "2020-10-01T18:11:50Z", "commit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODoxMTo1MFrOHbVtuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODoxMTo1MFrOHbVtuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyOTM2OA==", "bodyText": "This comment seems strangely placed - at this point the cookieFileName may not have any % at all if it wasn't the UC browser", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498429368", "createdAt": "2020-10-01T18:11:50Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -410,8 +424,14 @@ private void getCookie(String browser, String browserLocation) {\n \n         FileManager fileManager = currentCase.getServices().getFileManager();\n         List<AbstractFile> cookiesFiles;\n+        String cookieFileName = COOKIE_FILE_NAME;\n+        if (browser == NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\")) {\n+            cookieFileName = \"%\" + COOKIE_FILE_NAME + \"%\";\n+        }\n         try {\n-            cookiesFiles = fileManager.findFiles(dataSource, \"%Cookies%\", browserLocation); //NON-NLS\n+            // Wildcard on front and back of Cookies as there are Cookie files that start with something else\n+            // ie: UC browser has \"Extension Cookies.9\" as well as Cookies", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 75}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de62de9a8f5c522d3ff5ab09fcde56134ffc07b0", "author": {"user": {"login": "markmckinnon", "name": "Mark McKinnon"}}, "url": "https://github.com/sleuthkit/autopsy/commit/de62de9a8f5c522d3ff5ab09fcde56134ffc07b0", "committedDate": "2020-10-01T20:20:23Z", "message": "Address reviewer comments\n\nAddress reviewer comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjU0MzA3", "url": "https://github.com/sleuthkit/autopsy/pull/6341#pullrequestreview-502254307", "createdAt": "2020-10-05T17:05:58Z", "commit": {"oid": "de62de9a8f5c522d3ff5ab09fcde56134ffc07b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2855, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}