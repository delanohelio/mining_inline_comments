{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NzA2NTY0", "number": 6494, "title": "7002 domain names", "bodyText": "", "createdAt": "2020-11-24T19:30:19Z", "url": "https://github.com/sleuthkit/autopsy/pull/6494", "merged": true, "mergeCommit": {"oid": "206f0976b0af37e5167e3cad774a92c182cd1858"}, "closed": true, "closedAt": "2020-12-02T15:16:59Z", "author": {"login": "gdicristofaro"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdftUpXAH2gAyNTI2NzA2NTY0OmE4NDNkMzRiMmM4ODNmYzI3ZTljNWIwYjZmYzg3NzEwYjJjNWQzMTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiOn7ygH2gAyNTI2NzA2NTY0OmJiNGYwZDA3NTFjNGUyZGMzYTRmNTcyM2RlOGZlNjMwMmQ3MWJkZmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a843d34b2c883fc27e9c5b0b6fc87710b2c5d313", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/a843d34b2c883fc27e9c5b0b6fc87710b2c5d313", "committedDate": "2020-11-24T17:37:10Z", "message": "domain categorization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2396d2224af53c7779c12caf9cbce049703c0ed4", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/2396d2224af53c7779c12caf9cbce049703c0ed4", "committedDate": "2020-11-24T19:10:10Z", "message": "fix for issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/95b9e51362c08033b5502f232ab6e383869e7bc8", "committedDate": "2020-11-24T19:29:51Z", "message": "formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxMTYzNDc2", "url": "https://github.com/sleuthkit/autopsy/pull/6494#pullrequestreview-541163476", "createdAt": "2020-11-30T18:06:02Z", "commit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODowNjowM1rOH8HSAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODowNzozMFrOH8HVeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5NTkwNg==", "bodyText": "Reader should be closed.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532795906", "createdAt": "2020-11-30T18:06:03Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {\n+\n+    /**\n+     * This is a node in the trie. Children in the hashmap are identified by\n+     * token. So for example, for a domain google.co.uk, the top level category\n+     * would have an entry for \"uk\" linking to a domain category with \"co\".\n+     */\n+    private static class DomainCategory extends HashMap<String, DomainCategory> {\n+\n+        private DomainCategory getOrAddChild(String childKey) {\n+            DomainCategory cat = this.get(childKey);\n+            if (cat == null) {\n+                cat = new DomainCategory();\n+                this.put(childKey, cat);\n+            }\n+\n+            return cat;\n+        }\n+    }\n+\n+    // Character for joining domain segments.\n+    private static final String JOINER = \".\";\n+    // delimiter when used with regex\n+    private static final String DELIMITER = \"\\\\\" + JOINER;\n+\n+    // taken from https://publicsuffix.org/list/public_suffix_list.dat\n+    // file containing line seperated suffixes\n+    private static final String DOMAIN_LIST = \"public_suffix_list.dat\";\n+\n+    // token for comments\n+    private static final String COMMENT_TOKEN = \"//\";\n+\n+    // singleton instance of this class.\n+    private static DomainCategorizer categorizer = null;\n+\n+    /**\n+     * Returns the singleton instance of this class.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException\n+     */\n+    static DomainCategorizer getInstance() throws IOException {\n+        if (categorizer == null) {\n+            categorizer = load();\n+        }\n+\n+        return categorizer;\n+    }\n+\n+    /**\n+     * Loads a DomainCategorizer instance using the public suffix list.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException If there is an error reading the file.\n+     */\n+    private static DomainCategorizer load() throws IOException {\n+        InputStream is = DomainCategorizer.class.getResourceAsStream(DOMAIN_LIST);\n+        BufferedReader reader = new BufferedReader(new InputStreamReader(is));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5Njc5Mw==", "bodyText": "This file will become public API. Could we move it someplace else?", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532796793", "createdAt": "2020-11-30T18:07:30Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/public_suffix_list.dat", "diffHunk": "@@ -0,0 +1,13494 @@\n+// This Source Code Form is subject to the terms of the Mozilla Public", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxMjIwMzAx", "url": "https://github.com/sleuthkit/autopsy/pull/6494#pullrequestreview-541220301", "createdAt": "2020-11-30T19:22:55Z", "commit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxOToyMjo1NVrOH8KE2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxOToyMjo1NVrOH8KE2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0MTY4OA==", "bodyText": "This isn't really categorization and will be confusing with some of our other uses of categorization. We should call this something like DomainTokenizer.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532841688", "createdAt": "2020-11-30T19:22:55Z", "author": {"login": "bcarrier"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7736629de14b4ce4b53af07c73ca7625b391656e", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/7736629de14b4ce4b53af07c73ca7625b391656e", "committedDate": "2020-11-30T19:48:49Z", "message": "naming updates, close resources, NPE fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e270cc0e3363465137ec745103cdcb7c72a7355", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/1e270cc0e3363465137ec745103cdcb7c72a7355", "committedDate": "2020-12-01T13:52:12Z", "message": "fixes for domain rules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a5e224228bdc96d5815075d29ac1cc5609c81d2", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/4a5e224228bdc96d5815075d29ac1cc5609c81d2", "committedDate": "2020-12-01T20:13:17Z", "message": "Merge branch 'develop' of github.com:sleuthkit/autopsy into 7002-domainNames"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/cb1736f33398ae63741d28dcd308c264d462ff11", "committedDate": "2020-12-01T20:44:11Z", "message": "fix for more domains"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzUwMjAy", "url": "https://github.com/sleuthkit/autopsy/pull/6494#pullrequestreview-542350202", "createdAt": "2020-12-01T22:28:37Z", "commit": {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjoyODozN1rOH9CYKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjoyODozN1rOH9CYKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc2NDEzNg==", "bodyText": "Oh, just noticed this. This is not the right logger, should be the coreutils one.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r533764136", "createdAt": "2020-12-01T22:28:37Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/NetworkUtils.java", "diffHunk": "@@ -18,21 +18,25 @@\n  */\n package org.sleuthkit.autopsy.coreutils;\n \n+import java.io.IOException;\n import java.net.MalformedURLException;\n import java.net.URL;\n import java.net.UnknownHostException;\n-import java.util.StringTokenizer;\n+import java.util.logging.Level;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzgwNjkw", "url": "https://github.com/sleuthkit/autopsy/pull/6494#pullrequestreview-542380690", "createdAt": "2020-12-01T23:23:55Z", "commit": {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb4f0d0751c4e2dc3a4f5723de8fe6302d71bdfd", "author": {"user": {"login": "gdicristofaro", "name": "Greg DiCristofaro"}}, "url": "https://github.com/sleuthkit/autopsy/commit/bb4f0d0751c4e2dc3a4f5723de8fe6302d71bdfd", "committedDate": "2020-12-02T13:32:57Z", "message": "lower case normalization"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2840, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}