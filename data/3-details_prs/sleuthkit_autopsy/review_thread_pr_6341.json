{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzMTY5NjI0", "number": 6341, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowNzoyNlrOEplN4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODoxMTo1MFrOEplTRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMDM2ODM0OnYy", "diffSide": "RIGHT", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowNzoyNlrOHbVktw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoyMToyMFrOHbZkSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyNzA2Mw==", "bodyText": "Just because I'm wondering - why are these bundle messages?", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498427063", "createdAt": "2020-10-01T18:07:26Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -81,21 +81,27 @@\n     private static final String WEBFORM_ADDRESS_QUERY_V8X = \"SELECT first_name, middle_name, last_name, full_name, street_address, city, state, zipcode, country_code, number, email, date_modified, use_date, use_count\" +\n                                                             \" FROM autofill_profiles, autofill_profile_names, autofill_profile_emails, autofill_profile_phones\" +\n                                                             \" WHERE autofill_profiles.guid = autofill_profile_names.guid AND autofill_profiles.guid = autofill_profile_emails.guid AND autofill_profiles.guid = autofill_profile_phones.guid\";\n+    private static final String HISTORY_FILE_NAME = \"History\";\n+    private static final String BOOKMARK_FILE_NAME = \"Bookmarks\";\n+    private static final String COOKIE_FILE_NAME = \"Cookies\";\n+    private static final String LOGIN_DATA_FILE_NAME = \"Login Data\";\n+    private static final String WEB_DATA_FILE_NAME = \"Web Data\";\n+\n+    \n     private final Logger logger = Logger.getLogger(this.getClass().getName());\n     private Content dataSource;\n     private IngestJobContext context;\n \n     private static final Map<String, String> BROWSERS_MAP = ImmutableMap.<String, String>builder()  \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Microsoft.Edge\"), \"Microsoft/Edge\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Yandex\"), \"YandexBrowser\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Opera\"), \"Opera Software\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.SalamWeb\"), \"SalamWeb\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\"), \"UCBrowser\")\n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Brave\"), \"BraveSoftware\")\n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Google.Chrome\"), \"Chrome\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Microsoft.Edge\"), \"Microsoft/Edge/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Yandex\"), \"YandexBrowser/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Opera\"), \"Opera Software/Opera Stable\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.SalamWeb\"), \"SalamWeb/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\"), \"UCBrowser/User Data%/Default\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Brave\"), \"BraveSoftware/Brave-Browser/User Data/Default\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Google.Chrome\"), \"Chrome/User Data/Default\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ5MjQ5MA==", "bodyText": "Not sure why.  Removed them to just be straight text now.", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498492490", "createdAt": "2020-10-01T20:21:20Z", "author": {"login": "markmckinnon"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -81,21 +81,27 @@\n     private static final String WEBFORM_ADDRESS_QUERY_V8X = \"SELECT first_name, middle_name, last_name, full_name, street_address, city, state, zipcode, country_code, number, email, date_modified, use_date, use_count\" +\n                                                             \" FROM autofill_profiles, autofill_profile_names, autofill_profile_emails, autofill_profile_phones\" +\n                                                             \" WHERE autofill_profiles.guid = autofill_profile_names.guid AND autofill_profiles.guid = autofill_profile_emails.guid AND autofill_profiles.guid = autofill_profile_phones.guid\";\n+    private static final String HISTORY_FILE_NAME = \"History\";\n+    private static final String BOOKMARK_FILE_NAME = \"Bookmarks\";\n+    private static final String COOKIE_FILE_NAME = \"Cookies\";\n+    private static final String LOGIN_DATA_FILE_NAME = \"Login Data\";\n+    private static final String WEB_DATA_FILE_NAME = \"Web Data\";\n+\n+    \n     private final Logger logger = Logger.getLogger(this.getClass().getName());\n     private Content dataSource;\n     private IngestJobContext context;\n \n     private static final Map<String, String> BROWSERS_MAP = ImmutableMap.<String, String>builder()  \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Microsoft.Edge\"), \"Microsoft/Edge\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Yandex\"), \"YandexBrowser\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Opera\"), \"Opera Software\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.SalamWeb\"), \"SalamWeb\") \n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\"), \"UCBrowser\")\n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Brave\"), \"BraveSoftware\")\n-            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Google.Chrome\"), \"Chrome\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Microsoft.Edge\"), \"Microsoft/Edge/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Yandex\"), \"YandexBrowser/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Opera\"), \"Opera Software/Opera Stable\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.SalamWeb\"), \"SalamWeb/User Data/Default\") \n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\"), \"UCBrowser/User Data%/Default\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Brave\"), \"BraveSoftware/Brave-Browser/User Data/Default\")\n+            .put(NbBundle.getMessage(Chromium.class, \"Browser.name.Google.Chrome\"), \"Chrome/User Data/Default\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyNzA2Mw=="}, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMDM3NTAxOnYy", "diffSide": "RIGHT", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODowOToyOFrOHbVo9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoyMTo1OFrOHbZlZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyODE0OQ==", "bodyText": "Should this be .equals() instead? There are several of these.", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498428149", "createdAt": "2020-10-01T18:09:28Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -174,8 +180,12 @@ public void process(Content dataSource, IngestJobContext context, DataSourceInge\n     private void getHistory(String browser, String browserLocation) {\n         FileManager fileManager = currentCase.getServices().getFileManager();\n         List<AbstractFile> historyFiles;\n+        String historyFileName = HISTORY_FILE_NAME;\n+        if (browser == NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ5Mjc3Mg==", "bodyText": "Changed to .equals() where needed.", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498492772", "createdAt": "2020-10-01T20:21:58Z", "author": {"login": "markmckinnon"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -174,8 +180,12 @@ public void process(Content dataSource, IngestJobContext context, DataSourceInge\n     private void getHistory(String browser, String browserLocation) {\n         FileManager fileManager = currentCase.getServices().getFileManager();\n         List<AbstractFile> historyFiles;\n+        String historyFileName = HISTORY_FILE_NAME;\n+        if (browser == NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyODE0OQ=="}, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMDM4MjEzOnYy", "diffSide": "RIGHT", "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxODoxMTo1MFrOHbVtuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoyMTo0MFrOHbZk5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyOTM2OA==", "bodyText": "This comment seems strangely placed - at this point the cookieFileName may not have any % at all if it wasn't the UC browser", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498429368", "createdAt": "2020-10-01T18:11:50Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -410,8 +424,14 @@ private void getCookie(String browser, String browserLocation) {\n \n         FileManager fileManager = currentCase.getServices().getFileManager();\n         List<AbstractFile> cookiesFiles;\n+        String cookieFileName = COOKIE_FILE_NAME;\n+        if (browser == NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\")) {\n+            cookieFileName = \"%\" + COOKIE_FILE_NAME + \"%\";\n+        }\n         try {\n-            cookiesFiles = fileManager.findFiles(dataSource, \"%Cookies%\", browserLocation); //NON-NLS\n+            // Wildcard on front and back of Cookies as there are Cookie files that start with something else\n+            // ie: UC browser has \"Extension Cookies.9\" as well as Cookies", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ5MjY0Nw==", "bodyText": "Moved comment to better place", "url": "https://github.com/sleuthkit/autopsy/pull/6341#discussion_r498492647", "createdAt": "2020-10-01T20:21:40Z", "author": {"login": "markmckinnon"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/Chromium.java", "diffHunk": "@@ -410,8 +424,14 @@ private void getCookie(String browser, String browserLocation) {\n \n         FileManager fileManager = currentCase.getServices().getFileManager();\n         List<AbstractFile> cookiesFiles;\n+        String cookieFileName = COOKIE_FILE_NAME;\n+        if (browser == NbBundle.getMessage(Chromium.class, \"Browser.name.UC.Browser\")) {\n+            cookieFileName = \"%\" + COOKIE_FILE_NAME + \"%\";\n+        }\n         try {\n-            cookiesFiles = fileManager.findFiles(dataSource, \"%Cookies%\", browserLocation); //NON-NLS\n+            // Wildcard on front and back of Cookies as there are Cookie files that start with something else\n+            // ie: UC browser has \"Extension Cookies.9\" as well as Cookies", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQyOTM2OA=="}, "originalCommit": {"oid": "cf5ae9154227b1a9b42eab97464a925d561457a4"}, "originalPosition": 75}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 846, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}