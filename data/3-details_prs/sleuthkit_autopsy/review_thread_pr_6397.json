{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1OTcxMTA0", "number": 6397, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowNToxMlrOE2NF1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowOToxNlrOE2NKwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjczMDQ0OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowNToxMlrOHu6FMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwMDo0Njo0OVrOH2IIwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0ODE0NA==", "bodyText": "Missing method header", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r518948144", "createdAt": "2020-11-06T19:05:12Z", "author": {"login": "kellykelly3"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -112,65 +120,134 @@ public void startUp(IngestJobContext context) throws IngestModuleException {\n     @Override\n     public ProcessResult process(Content dataSource, DataSourceIngestModuleProgress statusHelper) {\n \n-        if (!(context.getDataSource() instanceof LocalFilesDataSource)) {\n-            return ProcessResult.OK;\n+        Case currentCase = Case.getCurrentCase();\n+        Path tempOutputPath = Paths.get(currentCase.getTempDirectory(), ILEAPP, ILEAPP_FS + dataSource.getId());\n+        try {\n+            Files.createDirectories(tempOutputPath);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error creating iLeapp output directory %s\", tempOutputPath.toString()), ex);\n+            return ProcessResult.ERROR;\n+        }\n+\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+        ProcessBuilder iLeappCommand = buildiLeappListCommand(tempOutputPath);\n+        try {\n+            int result = ExecUtil.execute(iLeappCommand, new DataSourceIngestModuleProcessTerminator(context, true));\n+            if (result != 0) {\n+                logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program getting file paths to search for result is %d\", result));\n+                return ProcessResult.ERROR;\n+            }\n+            iLeappPathsToProcess = loadIleappPathFile(tempOutputPath);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program getting file paths to search\"), ex);\n+            return ProcessResult.ERROR;\n         }\n \n         statusHelper.progress(Bundle.ILeappAnalyzerIngestModule_starting_iLeapp(), 0);\n \n-        List<AbstractFile> iLeappFilesToProcess = findiLeappFilesToProcess(dataSource);\n+        List<AbstractFile> iLeappFilesToProcess = new ArrayList<>();\n \n-        statusHelper.switchToDeterminate(iLeappFilesToProcess.size());\n+        if (!(context.getDataSource() instanceof LocalFilesDataSource)) {\n+            extractFilesFromImage(dataSource, iLeappPathsToProcess, tempOutputPath);\n+            statusHelper.switchToDeterminate(iLeappFilesToProcess.size());\n+            processILeappFs(dataSource, currentCase, statusHelper, tempOutputPath.toString());\n+        } else {\n+            iLeappFilesToProcess = findiLeappFilesToProcess(dataSource);\n+            statusHelper.switchToDeterminate(iLeappFilesToProcess.size());\n+\n+            Integer filesProcessedCount = 0;\n+            for (AbstractFile iLeappFile : iLeappFilesToProcess) {\n+                processILeappFile(dataSource, currentCase, statusHelper, filesProcessedCount, iLeappFile);\n+                filesProcessedCount++;\n+            }\n+            // Process the logical image as a fs in iLeapp to make sure this is not a logical fs that was added\n+            extractFilesFromImage(dataSource, iLeappPathsToProcess, tempOutputPath);\n+            processILeappFs(dataSource, currentCase, statusHelper, tempOutputPath.toString());\n+        }\n \n-        Integer filesProcessedCount = 0;\n+        IngestMessage message = IngestMessage.createMessage(IngestMessage.MessageType.DATA,\n+                Bundle.ILeappAnalyzerIngestModule_has_run(),\n+                Bundle.ILeappAnalyzerIngestModule_completed());\n+        IngestServices.getInstance().postMessage(message);\n+        return ProcessResult.OK;\n+    }\n \n-        Case currentCase = Case.getCurrentCase();\n-        for (AbstractFile iLeappFile : iLeappFilesToProcess) {\n+    private void processILeappFile(Content dataSource, Case currentCase, DataSourceIngestModuleProgress statusHelper, int filesProcessedCount,\n+            AbstractFile iLeappFile) {\n+        String currentTime = new SimpleDateFormat(\"yyyy-MM-dd HH-mm-ss z\", Locale.US).format(System.currentTimeMillis());//NON-NLS\n+        Path moduleOutputPath = Paths.get(currentCase.getModuleDirectory(), ILEAPP, currentTime);\n+        try {\n+            Files.createDirectories(moduleOutputPath);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error creating iLeapp output directory %s\", moduleOutputPath.toString()), ex);\n+            return;\n+        }\n \n-            String currentTime = new SimpleDateFormat(\"yyyy-MM-dd HH-mm-ss z\", Locale.US).format(System.currentTimeMillis());//NON-NLS\n-            Path moduleOutputPath = Paths.get(currentCase.getModuleDirectory(), ILEAPP, currentTime);\n-            try {\n-                Files.createDirectories(moduleOutputPath);\n-            } catch (IOException ex) {\n-                logger.log(Level.SEVERE, String.format(\"Error creating iLeapp output directory %s\", moduleOutputPath.toString()), ex);\n-                return ProcessResult.ERROR;\n+        statusHelper.progress(NbBundle.getMessage(this.getClass(), \"ILeappAnalyzerIngestModule.processing.file\", iLeappFile.getName()), filesProcessedCount);\n+        ProcessBuilder iLeappCommand = buildiLeappCommand(moduleOutputPath, iLeappFile.getLocalAbsPath(), iLeappFile.getNameExtension());\n+        try {\n+            int result = ExecUtil.execute(iLeappCommand, new DataSourceIngestModuleProcessTerminator(context, true));\n+            if (result != 0) {\n+                logger.log(Level.WARNING, String.format(\"Error when trying to execute iLeapp program getting file paths to search for result is %d\", result));\n+                return;\n             }\n \n-            statusHelper.progress(NbBundle.getMessage(this.getClass(), \"ILeappAnalyzerIngestModule.processing.file\", iLeappFile.getName()), filesProcessedCount);\n-            ProcessBuilder iLeappCommand = buildiLeappCommand(moduleOutputPath, iLeappFile.getLocalAbsPath(), iLeappFile.getNameExtension());\n-            try {\n-                int result = ExecUtil.execute(iLeappCommand, new DataSourceIngestModuleProcessTerminator(context, true));\n-                if (result != 0) {\n-                    // ignore if there is an error and continue to try and process the next file if there is one\n-                    continue;\n-                }\n+            addILeappReportToReports(moduleOutputPath, currentCase);\n \n-                addILeappReportToReports(moduleOutputPath, currentCase);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program against file %s\", iLeappFile.getLocalAbsPath()), ex);\n+            return;\n+        }\n \n-            } catch (IOException ex) {\n-                logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program against file %s\", iLeappFile.getLocalAbsPath()), ex);\n-                return ProcessResult.ERROR;\n-            }\n+        if (context.dataSourceIngestIsCancelled()) {\n+            logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n+            return;\n+        }\n \n-            if (context.dataSourceIngestIsCancelled()) {\n-                logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n-                return ProcessResult.OK;\n-            }\n+        ProcessResult fileProcessorResult = iLeappFileProcessor.processFiles(dataSource, moduleOutputPath, iLeappFile);\n+\n+        if (fileProcessorResult == ProcessResult.ERROR) {\n+            return;\n+        }\n+    }\n \n-            ProcessResult fileProcessorResult = iLeappFileProcessor.processFiles(dataSource, moduleOutputPath, iLeappFile);\n+    private void processILeappFs(Content dataSource, Case currentCase, DataSourceIngestModuleProgress statusHelper, String directoryToProcess) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 183}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUxODQ2NQ==", "bodyText": "Done", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r526518465", "createdAt": "2020-11-19T00:46:49Z", "author": {"login": "markmckinnon"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -112,65 +120,134 @@ public void startUp(IngestJobContext context) throws IngestModuleException {\n     @Override\n     public ProcessResult process(Content dataSource, DataSourceIngestModuleProgress statusHelper) {\n \n-        if (!(context.getDataSource() instanceof LocalFilesDataSource)) {\n-            return ProcessResult.OK;\n+        Case currentCase = Case.getCurrentCase();\n+        Path tempOutputPath = Paths.get(currentCase.getTempDirectory(), ILEAPP, ILEAPP_FS + dataSource.getId());\n+        try {\n+            Files.createDirectories(tempOutputPath);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error creating iLeapp output directory %s\", tempOutputPath.toString()), ex);\n+            return ProcessResult.ERROR;\n+        }\n+\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+        ProcessBuilder iLeappCommand = buildiLeappListCommand(tempOutputPath);\n+        try {\n+            int result = ExecUtil.execute(iLeappCommand, new DataSourceIngestModuleProcessTerminator(context, true));\n+            if (result != 0) {\n+                logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program getting file paths to search for result is %d\", result));\n+                return ProcessResult.ERROR;\n+            }\n+            iLeappPathsToProcess = loadIleappPathFile(tempOutputPath);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program getting file paths to search\"), ex);\n+            return ProcessResult.ERROR;\n         }\n \n         statusHelper.progress(Bundle.ILeappAnalyzerIngestModule_starting_iLeapp(), 0);\n \n-        List<AbstractFile> iLeappFilesToProcess = findiLeappFilesToProcess(dataSource);\n+        List<AbstractFile> iLeappFilesToProcess = new ArrayList<>();\n \n-        statusHelper.switchToDeterminate(iLeappFilesToProcess.size());\n+        if (!(context.getDataSource() instanceof LocalFilesDataSource)) {\n+            extractFilesFromImage(dataSource, iLeappPathsToProcess, tempOutputPath);\n+            statusHelper.switchToDeterminate(iLeappFilesToProcess.size());\n+            processILeappFs(dataSource, currentCase, statusHelper, tempOutputPath.toString());\n+        } else {\n+            iLeappFilesToProcess = findiLeappFilesToProcess(dataSource);\n+            statusHelper.switchToDeterminate(iLeappFilesToProcess.size());\n+\n+            Integer filesProcessedCount = 0;\n+            for (AbstractFile iLeappFile : iLeappFilesToProcess) {\n+                processILeappFile(dataSource, currentCase, statusHelper, filesProcessedCount, iLeappFile);\n+                filesProcessedCount++;\n+            }\n+            // Process the logical image as a fs in iLeapp to make sure this is not a logical fs that was added\n+            extractFilesFromImage(dataSource, iLeappPathsToProcess, tempOutputPath);\n+            processILeappFs(dataSource, currentCase, statusHelper, tempOutputPath.toString());\n+        }\n \n-        Integer filesProcessedCount = 0;\n+        IngestMessage message = IngestMessage.createMessage(IngestMessage.MessageType.DATA,\n+                Bundle.ILeappAnalyzerIngestModule_has_run(),\n+                Bundle.ILeappAnalyzerIngestModule_completed());\n+        IngestServices.getInstance().postMessage(message);\n+        return ProcessResult.OK;\n+    }\n \n-        Case currentCase = Case.getCurrentCase();\n-        for (AbstractFile iLeappFile : iLeappFilesToProcess) {\n+    private void processILeappFile(Content dataSource, Case currentCase, DataSourceIngestModuleProgress statusHelper, int filesProcessedCount,\n+            AbstractFile iLeappFile) {\n+        String currentTime = new SimpleDateFormat(\"yyyy-MM-dd HH-mm-ss z\", Locale.US).format(System.currentTimeMillis());//NON-NLS\n+        Path moduleOutputPath = Paths.get(currentCase.getModuleDirectory(), ILEAPP, currentTime);\n+        try {\n+            Files.createDirectories(moduleOutputPath);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error creating iLeapp output directory %s\", moduleOutputPath.toString()), ex);\n+            return;\n+        }\n \n-            String currentTime = new SimpleDateFormat(\"yyyy-MM-dd HH-mm-ss z\", Locale.US).format(System.currentTimeMillis());//NON-NLS\n-            Path moduleOutputPath = Paths.get(currentCase.getModuleDirectory(), ILEAPP, currentTime);\n-            try {\n-                Files.createDirectories(moduleOutputPath);\n-            } catch (IOException ex) {\n-                logger.log(Level.SEVERE, String.format(\"Error creating iLeapp output directory %s\", moduleOutputPath.toString()), ex);\n-                return ProcessResult.ERROR;\n+        statusHelper.progress(NbBundle.getMessage(this.getClass(), \"ILeappAnalyzerIngestModule.processing.file\", iLeappFile.getName()), filesProcessedCount);\n+        ProcessBuilder iLeappCommand = buildiLeappCommand(moduleOutputPath, iLeappFile.getLocalAbsPath(), iLeappFile.getNameExtension());\n+        try {\n+            int result = ExecUtil.execute(iLeappCommand, new DataSourceIngestModuleProcessTerminator(context, true));\n+            if (result != 0) {\n+                logger.log(Level.WARNING, String.format(\"Error when trying to execute iLeapp program getting file paths to search for result is %d\", result));\n+                return;\n             }\n \n-            statusHelper.progress(NbBundle.getMessage(this.getClass(), \"ILeappAnalyzerIngestModule.processing.file\", iLeappFile.getName()), filesProcessedCount);\n-            ProcessBuilder iLeappCommand = buildiLeappCommand(moduleOutputPath, iLeappFile.getLocalAbsPath(), iLeappFile.getNameExtension());\n-            try {\n-                int result = ExecUtil.execute(iLeappCommand, new DataSourceIngestModuleProcessTerminator(context, true));\n-                if (result != 0) {\n-                    // ignore if there is an error and continue to try and process the next file if there is one\n-                    continue;\n-                }\n+            addILeappReportToReports(moduleOutputPath, currentCase);\n \n-                addILeappReportToReports(moduleOutputPath, currentCase);\n+        } catch (IOException ex) {\n+            logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program against file %s\", iLeappFile.getLocalAbsPath()), ex);\n+            return;\n+        }\n \n-            } catch (IOException ex) {\n-                logger.log(Level.SEVERE, String.format(\"Error when trying to execute iLeapp program against file %s\", iLeappFile.getLocalAbsPath()), ex);\n-                return ProcessResult.ERROR;\n-            }\n+        if (context.dataSourceIngestIsCancelled()) {\n+            logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n+            return;\n+        }\n \n-            if (context.dataSourceIngestIsCancelled()) {\n-                logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n-                return ProcessResult.OK;\n-            }\n+        ProcessResult fileProcessorResult = iLeappFileProcessor.processFiles(dataSource, moduleOutputPath, iLeappFile);\n+\n+        if (fileProcessorResult == ProcessResult.ERROR) {\n+            return;\n+        }\n+    }\n \n-            ProcessResult fileProcessorResult = iLeappFileProcessor.processFiles(dataSource, moduleOutputPath, iLeappFile);\n+    private void processILeappFs(Content dataSource, Case currentCase, DataSourceIngestModuleProgress statusHelper, String directoryToProcess) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0ODE0NA=="}, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 183}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjczNTE0OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowNjo0NlrOHu6INA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwMDo0Njo1N1rOH2II9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0ODkxNg==", "bodyText": "Method header.", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r518948916", "createdAt": "2020-11-06T19:06:46Z", "author": {"login": "kellykelly3"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -221,10 +298,21 @@ private ProcessBuilder buildiLeappCommand(Path moduleOutputPath, String sourceFi\n         return processBuilder;\n     }\n \n+    private ProcessBuilder buildiLeappListCommand(Path moduleOutputPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 252}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUxODUxNg==", "bodyText": "Done", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r526518516", "createdAt": "2020-11-19T00:46:57Z", "author": {"login": "markmckinnon"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -221,10 +298,21 @@ private ProcessBuilder buildiLeappCommand(Path moduleOutputPath, String sourceFi\n         return processBuilder;\n     }\n \n+    private ProcessBuilder buildiLeappListCommand(Path moduleOutputPath) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0ODkxNg=="}, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 252}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjczOTk1OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowODoyNlrOHu6LPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwMDo0NzowNVrOH2IJJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0OTY5Mg==", "bodyText": "Add @param to method header.", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r518949692", "createdAt": "2020-11-06T19:08:26Z", "author": {"login": "kellykelly3"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 300}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUxODU2NA==", "bodyText": "Done", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r526518564", "createdAt": "2020-11-19T00:47:05Z", "author": {"login": "markmckinnon"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0OTY5Mg=="}, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 300}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1Mjc0MTQ3OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowODo1MlrOHu6MCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwMDo0NzoxM1rOH2IJXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0OTg5OA==", "bodyText": "method header.", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r518949898", "createdAt": "2020-11-06T19:08:52Z", "author": {"login": "kellykelly3"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+\n+        Path filePath = Paths.get(moduleOutputPath.toString(), ILEAPP_PATHS_FILE);\n+\n+        try (BufferedReader reader = new BufferedReader(new FileReader(filePath.toString()))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                if (line.contains(\"path list generation\") || line.length() < 2) {\n+                    line = reader.readLine();\n+                    continue;\n+                }\n+                iLeappPathsToProcess.add(line.trim());\n+                line = reader.readLine();\n+            }\n+        }\n+\n+        return iLeappPathsToProcess;\n+    }\n+\n+    private void extractFilesFromImage(Content dataSource, List<String> iLeappPathsToProcess, Path moduleOutputPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 320}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUxODYyMg==", "bodyText": "Done", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r526518622", "createdAt": "2020-11-19T00:47:13Z", "author": {"login": "markmckinnon"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+\n+        Path filePath = Paths.get(moduleOutputPath.toString(), ILEAPP_PATHS_FILE);\n+\n+        try (BufferedReader reader = new BufferedReader(new FileReader(filePath.toString()))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                if (line.contains(\"path list generation\") || line.length() < 2) {\n+                    line = reader.readLine();\n+                    continue;\n+                }\n+                iLeappPathsToProcess.add(line.trim());\n+                line = reader.readLine();\n+            }\n+        }\n+\n+        return iLeappPathsToProcess;\n+    }\n+\n+    private void extractFilesFromImage(Content dataSource, List<String> iLeappPathsToProcess, Path moduleOutputPath) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk0OTg5OA=="}, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 320}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1Mjc0MjYzOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowOTowOVrOHu6Mqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwMDo0NzoyN1rOH2IJrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MDA1OQ==", "bodyText": "method header", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r518950059", "createdAt": "2020-11-06T19:09:09Z", "author": {"login": "kellykelly3"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+\n+        Path filePath = Paths.get(moduleOutputPath.toString(), ILEAPP_PATHS_FILE);\n+\n+        try (BufferedReader reader = new BufferedReader(new FileReader(filePath.toString()))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                if (line.contains(\"path list generation\") || line.length() < 2) {\n+                    line = reader.readLine();\n+                    continue;\n+                }\n+                iLeappPathsToProcess.add(line.trim());\n+                line = reader.readLine();\n+            }\n+        }\n+\n+        return iLeappPathsToProcess;\n+    }\n+\n+    private void extractFilesFromImage(Content dataSource, List<String> iLeappPathsToProcess, Path moduleOutputPath) {\n+        FileManager fileManager = getCurrentCase().getServices().getFileManager();\n+\n+        for (String fullFilePath : iLeappPathsToProcess) {\n+\n+            if (context.dataSourceIngestIsCancelled()) {\n+                logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n+                break;\n+            }\n+\n+            String ffp = fullFilePath.replaceAll(\"\\\\*\", \"%\");\n+            ffp = FilenameUtils.normalize(ffp, true);\n+            String fileName = FilenameUtils.getName(ffp);\n+            String filePath = FilenameUtils.getPath(ffp);\n+\n+            List<AbstractFile> iLeappFiles = new ArrayList<>();\n+            try {\n+                if (filePath.isEmpty()) {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName); //NON-NLS                \n+                } else {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName, filePath); //NON-NLS\n+                }\n+            } catch (TskCoreException ex) {\n+                logger.log(Level.WARNING, \"No files found to process\"); //NON-NLS\n+                return;\n+            }\n+\n+            for (AbstractFile iLeappFile : iLeappFiles) {\n+                Path parentPath = Paths.get(moduleOutputPath.toString(), iLeappFile.getParentPath());\n+                File fileParentPath = new File(parentPath.toString());\n+\n+                extractFileToOutput(dataSource, iLeappFile, fileParentPath, parentPath);\n+            }\n+        }\n+    }\n+\n+    private void extractFileToOutput(Content dataSource, AbstractFile iLeappFile, File fileParentPath, Path parentPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 356}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUxODcwMQ==", "bodyText": "Done", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r526518701", "createdAt": "2020-11-19T00:47:27Z", "author": {"login": "markmckinnon"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+\n+        Path filePath = Paths.get(moduleOutputPath.toString(), ILEAPP_PATHS_FILE);\n+\n+        try (BufferedReader reader = new BufferedReader(new FileReader(filePath.toString()))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                if (line.contains(\"path list generation\") || line.length() < 2) {\n+                    line = reader.readLine();\n+                    continue;\n+                }\n+                iLeappPathsToProcess.add(line.trim());\n+                line = reader.readLine();\n+            }\n+        }\n+\n+        return iLeappPathsToProcess;\n+    }\n+\n+    private void extractFilesFromImage(Content dataSource, List<String> iLeappPathsToProcess, Path moduleOutputPath) {\n+        FileManager fileManager = getCurrentCase().getServices().getFileManager();\n+\n+        for (String fullFilePath : iLeappPathsToProcess) {\n+\n+            if (context.dataSourceIngestIsCancelled()) {\n+                logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n+                break;\n+            }\n+\n+            String ffp = fullFilePath.replaceAll(\"\\\\*\", \"%\");\n+            ffp = FilenameUtils.normalize(ffp, true);\n+            String fileName = FilenameUtils.getName(ffp);\n+            String filePath = FilenameUtils.getPath(ffp);\n+\n+            List<AbstractFile> iLeappFiles = new ArrayList<>();\n+            try {\n+                if (filePath.isEmpty()) {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName); //NON-NLS                \n+                } else {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName, filePath); //NON-NLS\n+                }\n+            } catch (TskCoreException ex) {\n+                logger.log(Level.WARNING, \"No files found to process\"); //NON-NLS\n+                return;\n+            }\n+\n+            for (AbstractFile iLeappFile : iLeappFiles) {\n+                Path parentPath = Paths.get(moduleOutputPath.toString(), iLeappFile.getParentPath());\n+                File fileParentPath = new File(parentPath.toString());\n+\n+                extractFileToOutput(dataSource, iLeappFile, fileParentPath, parentPath);\n+            }\n+        }\n+    }\n+\n+    private void extractFileToOutput(Content dataSource, AbstractFile iLeappFile, File fileParentPath, Path parentPath) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MDA1OQ=="}, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 356}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1Mjc0MzA1OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxOTowOToxN1rOHu6M5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwMDo0NzozNFrOH2IJzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MDExNg==", "bodyText": "method header.", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r518950116", "createdAt": "2020-11-06T19:09:17Z", "author": {"login": "kellykelly3"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+\n+        Path filePath = Paths.get(moduleOutputPath.toString(), ILEAPP_PATHS_FILE);\n+\n+        try (BufferedReader reader = new BufferedReader(new FileReader(filePath.toString()))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                if (line.contains(\"path list generation\") || line.length() < 2) {\n+                    line = reader.readLine();\n+                    continue;\n+                }\n+                iLeappPathsToProcess.add(line.trim());\n+                line = reader.readLine();\n+            }\n+        }\n+\n+        return iLeappPathsToProcess;\n+    }\n+\n+    private void extractFilesFromImage(Content dataSource, List<String> iLeappPathsToProcess, Path moduleOutputPath) {\n+        FileManager fileManager = getCurrentCase().getServices().getFileManager();\n+\n+        for (String fullFilePath : iLeappPathsToProcess) {\n+\n+            if (context.dataSourceIngestIsCancelled()) {\n+                logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n+                break;\n+            }\n+\n+            String ffp = fullFilePath.replaceAll(\"\\\\*\", \"%\");\n+            ffp = FilenameUtils.normalize(ffp, true);\n+            String fileName = FilenameUtils.getName(ffp);\n+            String filePath = FilenameUtils.getPath(ffp);\n+\n+            List<AbstractFile> iLeappFiles = new ArrayList<>();\n+            try {\n+                if (filePath.isEmpty()) {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName); //NON-NLS                \n+                } else {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName, filePath); //NON-NLS\n+                }\n+            } catch (TskCoreException ex) {\n+                logger.log(Level.WARNING, \"No files found to process\"); //NON-NLS\n+                return;\n+            }\n+\n+            for (AbstractFile iLeappFile : iLeappFiles) {\n+                Path parentPath = Paths.get(moduleOutputPath.toString(), iLeappFile.getParentPath());\n+                File fileParentPath = new File(parentPath.toString());\n+\n+                extractFileToOutput(dataSource, iLeappFile, fileParentPath, parentPath);\n+            }\n+        }\n+    }\n+\n+    private void extractFileToOutput(Content dataSource, AbstractFile iLeappFile, File fileParentPath, Path parentPath) {\n+        if (fileParentPath.exists()) {\n+                    if (!iLeappFile.isDir()) {\n+                        writeiLeappFile(dataSource, iLeappFile, fileParentPath.toString());\n+                    } else {\n+                        try {\n+                            Files.createDirectories(Paths.get(parentPath.toString(), iLeappFile.getName()));\n+                        } catch (IOException ex) {\n+                            logger.log(Level.INFO, String.format(\"Error creating iLeapp output directory %s\", parentPath.toString()), ex);\n+                        }\n+                    }\n+                } else {\n+                    try {\n+                        Files.createDirectories(parentPath);\n+                    } catch (IOException ex) {\n+                        logger.log(Level.INFO, String.format(\"Error creating iLeapp output directory %s\", parentPath.toString()), ex);\n+                    }\n+                    if (!iLeappFile.isDir()) {\n+                        writeiLeappFile(dataSource, iLeappFile, fileParentPath.toString());\n+                    } else {\n+                        try {\n+                            Files.createDirectories(Paths.get(parentPath.toString(), iLeappFile.getName()));\n+                        } catch (IOException ex) {\n+                            logger.log(Level.INFO, String.format(\"Error creating iLeapp output directory %s\", parentPath.toString()), ex);\n+                        }\n+                    }\n+                }\n+    }\n+    \n+    private void writeiLeappFile(Content dataSource, AbstractFile iLeappFile, String parentPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 385}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUxODczMw==", "bodyText": "Done", "url": "https://github.com/sleuthkit/autopsy/pull/6397#discussion_r526518733", "createdAt": "2020-11-19T00:47:34Z", "author": {"login": "markmckinnon"}, "path": "Core/src/org/sleuthkit/autopsy/modules/ileappanalyzer/ILeappAnalyzerIngestModule.java", "diffHunk": "@@ -264,4 +357,109 @@ private void addILeappReportToReports(Path iLeappOutputDir, Case currentCase) {\n \n     }\n \n+    /*\n+     * Reads the iLeapp paths file to get the paths that we want to extract\n+     *\n+     */\n+    private List<String> loadIleappPathFile(Path moduleOutputPath) throws FileNotFoundException, IOException {\n+        List<String> iLeappPathsToProcess = new ArrayList<>();\n+\n+        Path filePath = Paths.get(moduleOutputPath.toString(), ILEAPP_PATHS_FILE);\n+\n+        try (BufferedReader reader = new BufferedReader(new FileReader(filePath.toString()))) {\n+            String line = reader.readLine();\n+            while (line != null) {\n+                if (line.contains(\"path list generation\") || line.length() < 2) {\n+                    line = reader.readLine();\n+                    continue;\n+                }\n+                iLeappPathsToProcess.add(line.trim());\n+                line = reader.readLine();\n+            }\n+        }\n+\n+        return iLeappPathsToProcess;\n+    }\n+\n+    private void extractFilesFromImage(Content dataSource, List<String> iLeappPathsToProcess, Path moduleOutputPath) {\n+        FileManager fileManager = getCurrentCase().getServices().getFileManager();\n+\n+        for (String fullFilePath : iLeappPathsToProcess) {\n+\n+            if (context.dataSourceIngestIsCancelled()) {\n+                logger.log(Level.INFO, \"ILeapp Analyser ingest module run was canceled\"); //NON-NLS\n+                break;\n+            }\n+\n+            String ffp = fullFilePath.replaceAll(\"\\\\*\", \"%\");\n+            ffp = FilenameUtils.normalize(ffp, true);\n+            String fileName = FilenameUtils.getName(ffp);\n+            String filePath = FilenameUtils.getPath(ffp);\n+\n+            List<AbstractFile> iLeappFiles = new ArrayList<>();\n+            try {\n+                if (filePath.isEmpty()) {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName); //NON-NLS                \n+                } else {\n+                    iLeappFiles = fileManager.findFiles(dataSource, fileName, filePath); //NON-NLS\n+                }\n+            } catch (TskCoreException ex) {\n+                logger.log(Level.WARNING, \"No files found to process\"); //NON-NLS\n+                return;\n+            }\n+\n+            for (AbstractFile iLeappFile : iLeappFiles) {\n+                Path parentPath = Paths.get(moduleOutputPath.toString(), iLeappFile.getParentPath());\n+                File fileParentPath = new File(parentPath.toString());\n+\n+                extractFileToOutput(dataSource, iLeappFile, fileParentPath, parentPath);\n+            }\n+        }\n+    }\n+\n+    private void extractFileToOutput(Content dataSource, AbstractFile iLeappFile, File fileParentPath, Path parentPath) {\n+        if (fileParentPath.exists()) {\n+                    if (!iLeappFile.isDir()) {\n+                        writeiLeappFile(dataSource, iLeappFile, fileParentPath.toString());\n+                    } else {\n+                        try {\n+                            Files.createDirectories(Paths.get(parentPath.toString(), iLeappFile.getName()));\n+                        } catch (IOException ex) {\n+                            logger.log(Level.INFO, String.format(\"Error creating iLeapp output directory %s\", parentPath.toString()), ex);\n+                        }\n+                    }\n+                } else {\n+                    try {\n+                        Files.createDirectories(parentPath);\n+                    } catch (IOException ex) {\n+                        logger.log(Level.INFO, String.format(\"Error creating iLeapp output directory %s\", parentPath.toString()), ex);\n+                    }\n+                    if (!iLeappFile.isDir()) {\n+                        writeiLeappFile(dataSource, iLeappFile, fileParentPath.toString());\n+                    } else {\n+                        try {\n+                            Files.createDirectories(Paths.get(parentPath.toString(), iLeappFile.getName()));\n+                        } catch (IOException ex) {\n+                            logger.log(Level.INFO, String.format(\"Error creating iLeapp output directory %s\", parentPath.toString()), ex);\n+                        }\n+                    }\n+                }\n+    }\n+    \n+    private void writeiLeappFile(Content dataSource, AbstractFile iLeappFile, String parentPath) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk1MDExNg=="}, "originalCommit": {"oid": "a1a20e6bc06c6c0a91fb1e502e2b66fb3b4d115c"}, "originalPosition": 385}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 853, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}