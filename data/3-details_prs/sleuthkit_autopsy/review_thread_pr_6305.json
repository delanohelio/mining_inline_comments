{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNDY5OTY2", "number": 6305, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDo0OTo0NFrOEmo8Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxOTo0MDoyNFrOEnMT3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4OTUyMTU5OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDo0OTo0NFrOHWyYmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNTozNzowNFrOHW0oKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY1NjIxOQ==", "bodyText": "I don't think we should run the CR for every query.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493656219", "createdAt": "2020-09-23T14:49:44Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -59,23 +59,25 @@\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException {\n \n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting\n+        DiscoveryAttributes.FrequencyAttribute freqAttr = new DiscoveryAttributes.FrequencyAttribute();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5Mjk2OQ==", "bodyText": "With your solution below this will be removed.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493692969", "createdAt": "2020-09-23T15:37:04Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -59,23 +59,25 @@\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException {\n \n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting\n+        DiscoveryAttributes.FrequencyAttribute freqAttr = new DiscoveryAttributes.FrequencyAttribute();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY1NjIxOQ=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4OTUzNjczOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDo1MjozNVrOHWyh5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNToyNjo1MlrOHW0KcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY1ODU5Nw==", "bodyText": "I think the mistake here on my part was not adding attributes to results before running the filters. So, I think this block of code should be moved before the filters are applied. That way, only the frequency attribute will run when it's selected.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493658597", "createdAt": "2020-09-23T14:52:35Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -59,23 +59,25 @@\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException {\n \n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting\n+        DiscoveryAttributes.FrequencyAttribute freqAttr = new DiscoveryAttributes.FrequencyAttribute();\n+        freqAttr.addAttributeToResults(domainResults, key.getSleuthkitCase(), key.getCentralRepository());\n         // Apply secondary in memory filters\n         for (AbstractFilter filter : key.getFilters()) {\n             if (filter.useAlternateFilter()) {\n                 domainResults = filter.applyAlternateFilter(domainResults, key.getSleuthkitCase(), key.getCentralRepository());\n             }\n         }\n-        \n+\n         // Grouping by CR Frequency, for example, will require further processing\n         // in order to make the correct decision. The attribute types that require\n         // more information implement their logic by overriding `addAttributeToResults`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4NTM2MA==", "bodyText": "Definitely a better solution thank you, I just tossed in what I was doing for files and should of spent more time and figured out out how to re-arrange the code.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493685360", "createdAt": "2020-09-23T15:26:52Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -59,23 +59,25 @@\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException {\n \n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting\n+        DiscoveryAttributes.FrequencyAttribute freqAttr = new DiscoveryAttributes.FrequencyAttribute();\n+        freqAttr.addAttributeToResults(domainResults, key.getSleuthkitCase(), key.getCentralRepository());\n         // Apply secondary in memory filters\n         for (AbstractFilter filter : key.getFilters()) {\n             if (filter.useAlternateFilter()) {\n                 domainResults = filter.applyAlternateFilter(domainResults, key.getSleuthkitCase(), key.getCentralRepository());\n             }\n         }\n-        \n+\n         // Grouping by CR Frequency, for example, will require further processing\n         // in order to make the correct decision. The attribute types that require\n         // more information implement their logic by overriding `addAttributeToResults`.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY1ODU5Nw=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4OTU0NzUxOnYy", "diffSide": "LEFT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDo1NDozOFrOHWyodw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNToyODowNFrOHW0OYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2MDI3OQ==", "bodyText": "I think this should stay, so that if only the frequency filter is selected it'll work.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493660279", "createdAt": "2020-09-23T14:54:38Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "diffHunk": "@@ -649,10 +652,6 @@ public boolean useAlternateFilter() {\n         @Override\n         public List<Result> applyAlternateFilter(List<Result> currentResults, SleuthkitCase caseDb,\n                 CentralRepository centralRepoDb) throws DiscoveryException {\n-            // Set the frequency for each file", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4NjM2OA==", "bodyText": "With your above change of re-ordering code yes it will be necessary to keep this.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493686368", "createdAt": "2020-09-23T15:28:04Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "diffHunk": "@@ -649,10 +652,6 @@ public boolean useAlternateFilter() {\n         @Override\n         public List<Result> applyAlternateFilter(List<Result> currentResults, SleuthkitCase caseDb,\n                 CentralRepository centralRepoDb) throws DiscoveryException {\n-            // Set the frequency for each file", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2MDI3OQ=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4OTU1NTQ1OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDo1NjowOFrOHWytYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMTo1OToyOFrOHXCdSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2MTUzNw==", "bodyText": "Wouldn't you need to do this https://github.com/sleuthkit/autopsy/blob/develop/Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java#L73, before applying filters? Also just for grouping in general if the selected attribute needs it.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493661537", "createdAt": "2020-09-23T14:56:08Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "diffHunk": "@@ -116,6 +116,9 @@\n             resultList.add(new ResultFile(abstractFile));\n         }\n \n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5NjYxMw==", "bodyText": "We are currently adding the grouping and sorting attributes right before we group and sort in FileSearch.runFileSearch so my comment was very misleading by mentioning that it could also be used by grouping and sorting.\nI can pass along the additional arguments for grouping and sorting to this SearchFiltering.runQueries and then to this method getResultList and move the adding of grouping and sorting attributes into this method to re-order in a similar fashion to your fix for the Domain Search.\nThank you.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493696613", "createdAt": "2020-09-23T15:42:15Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "diffHunk": "@@ -116,6 +116,9 @@\n             resultList.add(new ResultFile(abstractFile));\n         }\n \n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2MTUzNw=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzcwNjkyNA==", "bodyText": "Or wait need to think about this, I can't remember what moving it will get me.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493706924", "createdAt": "2020-09-23T15:56:21Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "diffHunk": "@@ -116,6 +116,9 @@\n             resultList.add(new ResultFile(abstractFile));\n         }\n \n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2MTUzNw=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxOTU2Mg==", "bodyText": "Yeah didn't need to be moved apparently not initializing the frequency variable to unknown for file results was basically the entire problem with file based other occurrences.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493919562", "createdAt": "2020-09-23T21:59:28Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/SearchFiltering.java", "diffHunk": "@@ -116,6 +116,9 @@\n             resultList.add(new ResultFile(abstractFile));\n         }\n \n+        //manually add the attributes for filters which use alternate non filters and could be used by grouping or sorting", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2MTUzNw=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4OTU3NTk5OnYy", "diffSide": "LEFT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DiscoveryAttributes.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNTowMDowOVrOHWy6Iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDoxMjowMVrOHXc5xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2NDgwMw==", "bodyText": "This is important for not re-calculating frequencies. I think it should stay.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493664803", "createdAt": "2020-09-23T15:00:09Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DiscoveryAttributes.java", "diffHunk": "@@ -258,37 +258,33 @@ private void processResultFilesForCR(List<Result> results,\n             Set<String> hashesToLookUp = new HashSet<>();\n             List<ResultDomain> domainsToQuery = new ArrayList<>();\n             for (Result result : results) {\n-                if (result.getKnown() == TskData.FileKnown.KNOWN) {\n-                    result.setFrequency(SearchData.Frequency.KNOWN);\n-                }\n-\n-                if (result.getType() != SearchData.Type.DOMAIN) {\n-                    ResultFile file = (ResultFile) result;\n-                    if (file.getFrequency() == SearchData.Frequency.UNKNOWN\n-                            && file.getFirstInstance().getMd5Hash() != null\n-                            && !file.getFirstInstance().getMd5Hash().isEmpty()) {\n-                        hashesToLookUp.add(file.getFirstInstance().getMd5Hash());\n-                        currentFiles.add(file);\n+                // If frequency was already calculated, skip...\n+                if (result.getFrequency() == SearchData.Frequency.UNKNOWN) {\n+                    if (result.getKnown() == TskData.FileKnown.KNOWN) {\n+                        result.setFrequency(SearchData.Frequency.KNOWN);\n                     }\n \n-                    if (hashesToLookUp.size() >= BATCH_SIZE) {\n-                        computeFrequency(hashesToLookUp, currentFiles, centralRepoDb);\n+                    if (result.getType() != SearchData.Type.DOMAIN) {\n+                        ResultFile file = (ResultFile) result;\n+                        if (file.getFirstInstance().getMd5Hash() != null\n+                                && !file.getFirstInstance().getMd5Hash().isEmpty()) {\n+                            hashesToLookUp.add(file.getFirstInstance().getMd5Hash());\n+                            currentFiles.add(file);\n+                        }\n \n-                        hashesToLookUp.clear();\n-                        currentFiles.clear();\n-                    }\n-                } else {\n-                    ResultDomain domainInstance = (ResultDomain) result;\n-                    if (domainInstance.getFrequency() != SearchData.Frequency.UNKNOWN) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4MzM2OA==", "bodyText": "This check was moved earlier to line 262 as a conditional just inside the for the loop wrapping everything so that frequencies won't be recalculated for files either.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r493683368", "createdAt": "2020-09-23T15:24:13Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DiscoveryAttributes.java", "diffHunk": "@@ -258,37 +258,33 @@ private void processResultFilesForCR(List<Result> results,\n             Set<String> hashesToLookUp = new HashSet<>();\n             List<ResultDomain> domainsToQuery = new ArrayList<>();\n             for (Result result : results) {\n-                if (result.getKnown() == TskData.FileKnown.KNOWN) {\n-                    result.setFrequency(SearchData.Frequency.KNOWN);\n-                }\n-\n-                if (result.getType() != SearchData.Type.DOMAIN) {\n-                    ResultFile file = (ResultFile) result;\n-                    if (file.getFrequency() == SearchData.Frequency.UNKNOWN\n-                            && file.getFirstInstance().getMd5Hash() != null\n-                            && !file.getFirstInstance().getMd5Hash().isEmpty()) {\n-                        hashesToLookUp.add(file.getFirstInstance().getMd5Hash());\n-                        currentFiles.add(file);\n+                // If frequency was already calculated, skip...\n+                if (result.getFrequency() == SearchData.Frequency.UNKNOWN) {\n+                    if (result.getKnown() == TskData.FileKnown.KNOWN) {\n+                        result.setFrequency(SearchData.Frequency.KNOWN);\n                     }\n \n-                    if (hashesToLookUp.size() >= BATCH_SIZE) {\n-                        computeFrequency(hashesToLookUp, currentFiles, centralRepoDb);\n+                    if (result.getType() != SearchData.Type.DOMAIN) {\n+                        ResultFile file = (ResultFile) result;\n+                        if (file.getFirstInstance().getMd5Hash() != null\n+                                && !file.getFirstInstance().getMd5Hash().isEmpty()) {\n+                            hashesToLookUp.add(file.getFirstInstance().getMd5Hash());\n+                            currentFiles.add(file);\n+                        }\n \n-                        hashesToLookUp.clear();\n-                        currentFiles.clear();\n-                    }\n-                } else {\n-                    ResultDomain domainInstance = (ResultDomain) result;\n-                    if (domainInstance.getFrequency() != SearchData.Frequency.UNKNOWN) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2NDgwMw=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM1MjgzOQ==", "bodyText": "I missed that, thanks", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r494352839", "createdAt": "2020-09-24T14:12:01Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DiscoveryAttributes.java", "diffHunk": "@@ -258,37 +258,33 @@ private void processResultFilesForCR(List<Result> results,\n             Set<String> hashesToLookUp = new HashSet<>();\n             List<ResultDomain> domainsToQuery = new ArrayList<>();\n             for (Result result : results) {\n-                if (result.getKnown() == TskData.FileKnown.KNOWN) {\n-                    result.setFrequency(SearchData.Frequency.KNOWN);\n-                }\n-\n-                if (result.getType() != SearchData.Type.DOMAIN) {\n-                    ResultFile file = (ResultFile) result;\n-                    if (file.getFrequency() == SearchData.Frequency.UNKNOWN\n-                            && file.getFirstInstance().getMd5Hash() != null\n-                            && !file.getFirstInstance().getMd5Hash().isEmpty()) {\n-                        hashesToLookUp.add(file.getFirstInstance().getMd5Hash());\n-                        currentFiles.add(file);\n+                // If frequency was already calculated, skip...\n+                if (result.getFrequency() == SearchData.Frequency.UNKNOWN) {\n+                    if (result.getKnown() == TskData.FileKnown.KNOWN) {\n+                        result.setFrequency(SearchData.Frequency.KNOWN);\n                     }\n \n-                    if (hashesToLookUp.size() >= BATCH_SIZE) {\n-                        computeFrequency(hashesToLookUp, currentFiles, centralRepoDb);\n+                    if (result.getType() != SearchData.Type.DOMAIN) {\n+                        ResultFile file = (ResultFile) result;\n+                        if (file.getFirstInstance().getMd5Hash() != null\n+                                && !file.getFirstInstance().getMd5Hash().isEmpty()) {\n+                            hashesToLookUp.add(file.getFirstInstance().getMd5Hash());\n+                            currentFiles.add(file);\n+                        }\n \n-                        hashesToLookUp.clear();\n-                        currentFiles.clear();\n-                    }\n-                } else {\n-                    ResultDomain domainInstance = (ResultDomain) result;\n-                    if (domainInstance.getFrequency() != SearchData.Frequency.UNKNOWN) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY2NDgwMw=="}, "originalCommit": {"oid": "8cb278473dfdffdc36e2e52d3f47917764e67227"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5Mzk3Njk4OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDoxMDo0OVrOHXc2gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDozOToyMVrOHXeM5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM1MjAwMA==", "bodyText": "There was a thread interrupt check here that got removed with the merge conflict.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r494352000", "createdAt": "2020-09-24T14:10:49Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -57,36 +57,35 @@\n \n     @Override\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException, InterruptedException {\n-\n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n         // Apply secondary in memory filters\n         for (AbstractFilter filter : key.getFilters()) {\n             if(Thread.currentThread().isInterrupted()) {\n                 throw new InterruptedException();\n-            }\n-            \n+            }      \n             if (filter.useAlternateFilter()) {\n                 domainResults = filter.applyAlternateFilter(domainResults, key.getSleuthkitCase(), key.getCentralRepository());\n             }\n         }\n-        \n         // Grouping by CR Frequency, for example, will require further processing\n         // in order to make the correct decision. The attribute types that require\n         // more information implement their logic by overriding `addAttributeToResults`.\n         List<AttributeType> searchAttributes = new ArrayList<>();\n         searchAttributes.add(key.getGroupAttributeType());\n         searchAttributes.addAll(key.getFileSortingMethod().getRequiredAttributes());\n-        \n         for (AttributeType attr : searchAttributes) {\n             if(Thread.currentThread().isInterrupted()) {\n                 throw new InterruptedException();\n-            }\n-            \n+            }       \n             attr.addAttributeToResults(domainResults, \n                     key.getSleuthkitCase(), key.getCentralRepository());\n         }\n-\n+        // Apply secondary in memory filters\n+        for (AbstractFilter filter : key.getFilters()) {\n+            if (filter.useAlternateFilter()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb57c45be5cdfdf7713f0eba14729664e514b9aa"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM3NDExNg==", "bodyText": "woops, good catch. Thank you", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r494374116", "createdAt": "2020-09-24T14:39:21Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -57,36 +57,35 @@\n \n     @Override\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException, InterruptedException {\n-\n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n         // Apply secondary in memory filters\n         for (AbstractFilter filter : key.getFilters()) {\n             if(Thread.currentThread().isInterrupted()) {\n                 throw new InterruptedException();\n-            }\n-            \n+            }      \n             if (filter.useAlternateFilter()) {\n                 domainResults = filter.applyAlternateFilter(domainResults, key.getSleuthkitCase(), key.getCentralRepository());\n             }\n         }\n-        \n         // Grouping by CR Frequency, for example, will require further processing\n         // in order to make the correct decision. The attribute types that require\n         // more information implement their logic by overriding `addAttributeToResults`.\n         List<AttributeType> searchAttributes = new ArrayList<>();\n         searchAttributes.add(key.getGroupAttributeType());\n         searchAttributes.addAll(key.getFileSortingMethod().getRequiredAttributes());\n-        \n         for (AttributeType attr : searchAttributes) {\n             if(Thread.currentThread().isInterrupted()) {\n                 throw new InterruptedException();\n-            }\n-            \n+            }       \n             attr.addAttributeToResults(domainResults, \n                     key.getSleuthkitCase(), key.getCentralRepository());\n         }\n-\n+        // Apply secondary in memory filters\n+        for (AbstractFilter filter : key.getFilters()) {\n+            if (filter.useAlternateFilter()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM1MjAwMA=="}, "originalCommit": {"oid": "fb57c45be5cdfdf7713f0eba14729664e514b9aa"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5NTMxNjEyOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxOTo0MDoyNFrOHXp8XA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDoyNDo0NVrOHXrV2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU2NjQ5Mg==", "bodyText": "This code is now duplicated.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r494566492", "createdAt": "2020-09-24T19:40:24Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -57,36 +57,38 @@\n \n     @Override\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException, InterruptedException {\n-\n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n         // Apply secondary in memory filters\n         for (AbstractFilter filter : key.getFilters()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ad93614adda628edbd2d61574770af1228088f6"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU4OTQwMA==", "bodyText": "it appears this happened at the same time as the deleted conditional, and all revolves around me botching that merge conflict resolution.\nWill fix, thank you for catching, apologies for the headache.", "url": "https://github.com/sleuthkit/autopsy/pull/6305#discussion_r494589400", "createdAt": "2020-09-24T20:24:45Z", "author": {"login": "wschaeferB"}, "path": "Core/src/org/sleuthkit/autopsy/discovery/search/DomainSearchCacheLoader.java", "diffHunk": "@@ -57,36 +57,38 @@\n \n     @Override\n     public Map<GroupKey, List<Result>> load(SearchKey key) throws DiscoveryException, SQLException, TskCoreException, InterruptedException {\n-\n         List<Result> domainResults = getResultDomainsFromDatabase(key);\n-\n         // Apply secondary in memory filters\n         for (AbstractFilter filter : key.getFilters()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU2NjQ5Mg=="}, "originalCommit": {"oid": "8ad93614adda628edbd2d61574770af1228088f6"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 842, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}