{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzNDg2ODY3", "number": 6474, "title": "6994 get or add artifact type change", "bodyText": "", "createdAt": "2020-11-18T21:29:57Z", "url": "https://github.com/sleuthkit/autopsy/pull/6474", "merged": true, "mergeCommit": {"oid": "69462b3385b3f796322d106bbda7695e667123c3"}, "closed": true, "closedAt": "2020-11-19T17:20:17Z", "author": {"login": "kellykelly3"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddMgWVAH2gAyNTIzNDg2ODY3OjIwMWYyNWVjZmE1ODVmOWMxOTYyNTBhOWU4M2ZhNjAyZDJiM2M2ODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeFAFjgFqTUzNDYwMTcwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "201f25ecfa585f9c196250a9e83fa602d2b3c685", "author": {"user": {"login": "kellykelly3", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/201f25ecfa585f9c196250a9e83fa602d2b3c685", "committedDate": "2020-11-16T22:15:14Z", "message": "Switched addArtifactAttributeType to getOrAddAttributeType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ed5712d868214c9616ce1e8a35ecce0c95267db", "author": {"user": {"login": "kellykelly3", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/6ed5712d868214c9616ce1e8a35ecce0c95267db", "committedDate": "2020-11-18T21:29:36Z", "message": "Switched addXXXType to getOrAddXXXType"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NTMyNDg4", "url": "https://github.com/sleuthkit/autopsy/pull/6474#pullrequestreview-534532488", "createdAt": "2020-11-19T14:59:14Z", "commit": {"oid": "6ed5712d868214c9616ce1e8a35ecce0c95267db"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDo1OToxNFrOH2irZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTowMDoyMVrOH2ivOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk1MzMxNw==", "bodyText": "Do we need to log the exception here? I would expect the calling code to handle it.", "url": "https://github.com/sleuthkit/autopsy/pull/6474#discussion_r526953317", "createdAt": "2020-11-19T14:59:14Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -1961,18 +1963,13 @@ void createShellBagArtifacts(AbstractFile regFile, List<ShellBag> shellbags) thr\n      */\n     private BlackboardArtifact.Type getShellBagArtifact() throws TskCoreException {\n         if (shellBagArtifactType == null) {\n-            shellBagArtifactType = tskCase.getArtifactType(SHELLBAG_ARTIFACT_NAME);\n-\n-            if (shellBagArtifactType == null) {\n-                try {\n-                    tskCase.addBlackboardArtifactType(SHELLBAG_ARTIFACT_NAME, Bundle.Shellbag_Artifact_Display_Name()); //NON-NLS\n-                } catch (TskDataException ex) {\n-                    // Artifact already exists\n-                    logger.log(Level.INFO, String.format(\"%s may have already been defined for this case\", SHELLBAG_ARTIFACT_NAME));\n-                }\n-\n-                shellBagArtifactType = tskCase.getArtifactType(SHELLBAG_ARTIFACT_NAME);\n-            }\n+            try {\n+                shellBagArtifactType = tskCase.getBlackboard().getOrAddArtifactType(SHELLBAG_ARTIFACT_NAME, Bundle.Shellbag_Artifact_Display_Name());\n+            } catch (BlackboardException ex) {\n+                String msg = String.format(\"Failed to get shell bag artifact type\", SHELLBAG_ARTIFACT_NAME);\n+                logger.log(Level.SEVERE, msg, ex);\n+                throw new TskCoreException(msg, ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ed5712d868214c9616ce1e8a35ecce0c95267db"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk1Mzg1OA==", "bodyText": "I'm assuming that should be \"custom\"?", "url": "https://github.com/sleuthkit/autopsy/pull/6474#discussion_r526953858", "createdAt": "2020-11-19T14:59:53Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -1989,12 +1986,12 @@ void createShellBagArtifacts(AbstractFile regFile, List<ShellBag> shellbags) thr\n     private BlackboardAttribute.Type getLastWriteAttribute() throws TskCoreException {\n         if (shellBagLastWriteAttributeType == null) {\n             try {\n-                shellBagLastWriteAttributeType = tskCase.addArtifactAttributeType(SHELLBAG_ATTRIBUTE_LAST_WRITE,\n+                shellBagLastWriteAttributeType = tskCase.getBlackboard().getOrAddAttributeType(SHELLBAG_ATTRIBUTE_LAST_WRITE,\n                         BlackboardAttribute.TSK_BLACKBOARD_ATTRIBUTE_VALUE_TYPE.DATETIME,\n                         Bundle.Shellbag_Last_Write_Attribute_Display_Name());\n-            } catch (TskDataException ex) {\n+            } catch (BlackboardException ex) {\n                 // Attribute already exists get it from the case\n-                shellBagLastWriteAttributeType = tskCase.getAttributeType(SHELLBAG_ATTRIBUTE_LAST_WRITE);\n+                throw new TskCoreException(String.format(\"Failed to get costume attribute %s\", SHELLBAG_ATTRIBUTE_LAST_WRITE), ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ed5712d868214c9616ce1e8a35ecce0c95267db"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk1NDI5Nw==", "bodyText": "Typo on attribute", "url": "https://github.com/sleuthkit/autopsy/pull/6474#discussion_r526954297", "createdAt": "2020-11-19T15:00:21Z", "author": {"login": "APriestman"}, "path": "RecentActivity/src/org/sleuthkit/autopsy/recentactivity/ExtractRegistry.java", "diffHunk": "@@ -2011,12 +2008,11 @@ void createShellBagArtifacts(AbstractFile regFile, List<ShellBag> shellbags) thr\n     private BlackboardAttribute.Type getKeyAttribute() throws TskCoreException {\n         if (shellBagKeyAttributeType == null) {\n             try {\n-                shellBagKeyAttributeType = tskCase.addArtifactAttributeType(SHELLBAG_ATTRIBUTE_KEY,\n+                shellBagKeyAttributeType = tskCase.getBlackboard().getOrAddAttributeType(SHELLBAG_ATTRIBUTE_KEY,\n                         BlackboardAttribute.TSK_BLACKBOARD_ATTRIBUTE_VALUE_TYPE.STRING,\n                         Bundle.Shellbag_Key_Attribute_Display_Name());\n-            } catch (TskDataException ex) {\n-                // The attribute already exists get it from the case\n-                shellBagKeyAttributeType = tskCase.getAttributeType(SHELLBAG_ATTRIBUTE_KEY);\n+            } catch (BlackboardException ex) {\n+                throw new TskCoreException(String.format(\"Failed to get key attriubte %s\", SHELLBAG_ATTRIBUTE_KEY), ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ed5712d868214c9616ce1e8a35ecce0c95267db"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6ca1359e5c072bf5d4704e75aae7dad4b0e3d5a", "author": {"user": {"login": "kellykelly3", "name": null}}, "url": "https://github.com/sleuthkit/autopsy/commit/a6ca1359e5c072bf5d4704e75aae7dad4b0e3d5a", "committedDate": "2020-11-19T15:30:55Z", "message": "Handled review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NjAxNzA1", "url": "https://github.com/sleuthkit/autopsy/pull/6474#pullrequestreview-534601705", "createdAt": "2020-11-19T16:04:35Z", "commit": {"oid": "a6ca1359e5c072bf5d4704e75aae7dad4b0e3d5a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2833, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}