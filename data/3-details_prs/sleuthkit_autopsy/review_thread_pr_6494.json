{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NzA2NTY0", "number": 6494, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODowNjowM1rOE-xpZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjoyODozN1rOE_XYhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MjYwNTgwOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODowNjowM1rOH8HSAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxOToyNzoyMFrOH8KPEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5NTkwNg==", "bodyText": "Reader should be closed.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532795906", "createdAt": "2020-11-30T18:06:03Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {\n+\n+    /**\n+     * This is a node in the trie. Children in the hashmap are identified by\n+     * token. So for example, for a domain google.co.uk, the top level category\n+     * would have an entry for \"uk\" linking to a domain category with \"co\".\n+     */\n+    private static class DomainCategory extends HashMap<String, DomainCategory> {\n+\n+        private DomainCategory getOrAddChild(String childKey) {\n+            DomainCategory cat = this.get(childKey);\n+            if (cat == null) {\n+                cat = new DomainCategory();\n+                this.put(childKey, cat);\n+            }\n+\n+            return cat;\n+        }\n+    }\n+\n+    // Character for joining domain segments.\n+    private static final String JOINER = \".\";\n+    // delimiter when used with regex\n+    private static final String DELIMITER = \"\\\\\" + JOINER;\n+\n+    // taken from https://publicsuffix.org/list/public_suffix_list.dat\n+    // file containing line seperated suffixes\n+    private static final String DOMAIN_LIST = \"public_suffix_list.dat\";\n+\n+    // token for comments\n+    private static final String COMMENT_TOKEN = \"//\";\n+\n+    // singleton instance of this class.\n+    private static DomainCategorizer categorizer = null;\n+\n+    /**\n+     * Returns the singleton instance of this class.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException\n+     */\n+    static DomainCategorizer getInstance() throws IOException {\n+        if (categorizer == null) {\n+            categorizer = load();\n+        }\n+\n+        return categorizer;\n+    }\n+\n+    /**\n+     * Loads a DomainCategorizer instance using the public suffix list.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException If there is an error reading the file.\n+     */\n+    private static DomainCategorizer load() throws IOException {\n+        InputStream is = DomainCategorizer.class.getResourceAsStream(DOMAIN_LIST);\n+        BufferedReader reader = new BufferedReader(new InputStreamReader(is));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0NDMwNg==", "bodyText": "Will do.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532844306", "createdAt": "2020-11-30T19:27:20Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {\n+\n+    /**\n+     * This is a node in the trie. Children in the hashmap are identified by\n+     * token. So for example, for a domain google.co.uk, the top level category\n+     * would have an entry for \"uk\" linking to a domain category with \"co\".\n+     */\n+    private static class DomainCategory extends HashMap<String, DomainCategory> {\n+\n+        private DomainCategory getOrAddChild(String childKey) {\n+            DomainCategory cat = this.get(childKey);\n+            if (cat == null) {\n+                cat = new DomainCategory();\n+                this.put(childKey, cat);\n+            }\n+\n+            return cat;\n+        }\n+    }\n+\n+    // Character for joining domain segments.\n+    private static final String JOINER = \".\";\n+    // delimiter when used with regex\n+    private static final String DELIMITER = \"\\\\\" + JOINER;\n+\n+    // taken from https://publicsuffix.org/list/public_suffix_list.dat\n+    // file containing line seperated suffixes\n+    private static final String DOMAIN_LIST = \"public_suffix_list.dat\";\n+\n+    // token for comments\n+    private static final String COMMENT_TOKEN = \"//\";\n+\n+    // singleton instance of this class.\n+    private static DomainCategorizer categorizer = null;\n+\n+    /**\n+     * Returns the singleton instance of this class.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException\n+     */\n+    static DomainCategorizer getInstance() throws IOException {\n+        if (categorizer == null) {\n+            categorizer = load();\n+        }\n+\n+        return categorizer;\n+    }\n+\n+    /**\n+     * Loads a DomainCategorizer instance using the public suffix list.\n+     *\n+     * @return The DomainCategorizer instance.\n+     * @throws IOException If there is an error reading the file.\n+     */\n+    private static DomainCategorizer load() throws IOException {\n+        InputStream is = DomainCategorizer.class.getResourceAsStream(DOMAIN_LIST);\n+        BufferedReader reader = new BufferedReader(new InputStreamReader(is));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5NTkwNg=="}, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MjYxMTY0OnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/coreutils/public_suffix_list.dat", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODowNzozMFrOH8HVeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODowNzozMFrOH8HVeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjc5Njc5Mw==", "bodyText": "This file will become public API. Could we move it someplace else?", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532796793", "createdAt": "2020-11-30T18:07:30Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/public_suffix_list.dat", "diffHunk": "@@ -0,0 +1,13494 @@\n+// This Source Code Form is subject to the terms of the Mozilla Public", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MjkwNDczOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxOToyMjo1NVrOH8KE2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxOToyNzoyOVrOH8KPew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0MTY4OA==", "bodyText": "This isn't really categorization and will be confusing with some of our other uses of categorization. We should call this something like DomainTokenizer.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532841688", "createdAt": "2020-11-30T19:22:55Z", "author": {"login": "bcarrier"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0NDQxMQ==", "bodyText": "Sounds good.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r532844411", "createdAt": "2020-11-30T19:27:29Z", "author": {"login": "gdicristofaro"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/DomainCategorizer.java", "diffHunk": "@@ -0,0 +1,173 @@\n+/*\n+ * Autopsy Forensic Browser\n+ *\n+ * Copyright 2020 Basis Technology Corp.\n+ * Contact: carrier <at> sleuthkit <dot> org\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.sleuthkit.autopsy.coreutils;\n+\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+import org.apache.commons.lang3.StringUtils;\n+\n+/**\n+ * Attempts to get the domain from a url/domain provided removing the\n+ * subdomain(s).\n+ */\n+class DomainCategorizer {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0MTY4OA=="}, "originalCommit": {"oid": "95b9e51362c08033b5502f232ab6e383869e7bc8"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0ODc4ODUyOnYy", "diffSide": "RIGHT", "path": "Core/src/org/sleuthkit/autopsy/coreutils/NetworkUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjoyODozN1rOH9CYKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMzoyMzo0M1rOH9D8dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc2NDEzNg==", "bodyText": "Oh, just noticed this. This is not the right logger, should be the coreutils one.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r533764136", "createdAt": "2020-12-01T22:28:37Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/NetworkUtils.java", "diffHunk": "@@ -18,21 +18,25 @@\n  */\n package org.sleuthkit.autopsy.coreutils;\n \n+import java.io.IOException;\n import java.net.MalformedURLException;\n import java.net.URL;\n import java.net.UnknownHostException;\n-import java.util.StringTokenizer;\n+import java.util.logging.Level;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc4OTgxNQ==", "bodyText": "This is the logging level, not logger. My mistake.", "url": "https://github.com/sleuthkit/autopsy/pull/6494#discussion_r533789815", "createdAt": "2020-12-01T23:23:43Z", "author": {"login": "dannysmyda"}, "path": "Core/src/org/sleuthkit/autopsy/coreutils/NetworkUtils.java", "diffHunk": "@@ -18,21 +18,25 @@\n  */\n package org.sleuthkit.autopsy.coreutils;\n \n+import java.io.IOException;\n import java.net.MalformedURLException;\n import java.net.URL;\n import java.net.UnknownHostException;\n-import java.util.StringTokenizer;\n+import java.util.logging.Level;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc2NDEzNg=="}, "originalCommit": {"oid": "cb1736f33398ae63741d28dcd308c264d462ff11"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 825, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}