{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzMjQ3ODM1", "number": 1402, "reviewThreads": {"totalCount": 34, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxODo0NFrODxshig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMzowMlrODzpedA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM2Mjk4OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxODo0NFrOGFT2Dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxODo0NFrOGFT2Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyMTE5OQ==", "bodyText": "Altered the code to throw RuntimeException.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408221199", "createdAt": "2020-04-14T15:18:44Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/**\n+ * Copyright (c) 2013, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.emf.common.util.URI;\n+import org.eclipse.emf.ecore.resource.Resource;\n+import org.eclipse.emf.ecore.resource.ResourceSet;\n+import org.eclipse.jdt.core.IJavaProject;\n+import org.eclipse.xtext.common.types.access.jdt.IJavaProjectProvider;\n+import org.eclipse.xtext.common.types.access.jdt.JdtTypeProviderFactory;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.resource.XtextResource;\n+import org.eclipse.xtext.resource.XtextResourceSet;\n+import org.eclipse.xtext.ui.testing.util.JavaProjectSetupUtil;\n+import org.eclipse.xtext.ui.testing.util.ResourceLoadHelper;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Injector;\n+import com.google.inject.Provider;\n+\n+/**\n+ * @since 2.12\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractContentAssistTest implements ResourceLoadHelper, IJavaProjectProvider {\n+\n+\t@Inject\n+\tprivate Provider<XtextResourceSet> resourceSetProvider;\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprivate Injector injector;\n+\n+\tprivate static IJavaProject javaProject;\n+\n+\t@BeforeClass\n+\t@BeforeAll\n+\tpublic static void setUp() throws CoreException {\n+\t\tjavaProject = JavaProjectSetupUtil.createJavaProject(\"contentAssistTest\");\n+\t}\n+\n+\t@AfterClass\n+\t@AfterAll\n+\tpublic static void tearDown() throws CoreException {\n+\t\tIProject project = AbstractContentAssistTest.javaProject.getProject();\n+\t\tproject.delete(true, new NullProgressMonitor());\n+\t}\n+\n+\t@Override\n+\tpublic XtextResource getResourceFor(InputStream stream) {\n+\t\tXtextResourceSet resourceSet = resourceSetProvider.get();\n+\t\tinitializeTypeProvider(resourceSet);\n+\t\ttry {\n+\t\t\tURI resourceUri = URI.createURI(\"Test.\" + fileExtensionProvider.getPrimaryFileExtension());\n+\t\t\tResource resource = resourceSet.createResource(resourceUri);\n+\t\t\tresource.load(stream, null);\n+\t\t\treturn (XtextResource) resource;\n+\t\t} catch (IOException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM2NTQ5OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxOToxNlrOGFT3mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxOToxNlrOGFT3mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyMTU5NQ==", "bodyText": "This method now throws a CoreException", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408221595", "createdAt": "2020-04-14T15:19:16Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/**\n+ * Copyright (c) 2013, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.emf.common.util.URI;\n+import org.eclipse.emf.ecore.resource.Resource;\n+import org.eclipse.emf.ecore.resource.ResourceSet;\n+import org.eclipse.jdt.core.IJavaProject;\n+import org.eclipse.xtext.common.types.access.jdt.IJavaProjectProvider;\n+import org.eclipse.xtext.common.types.access.jdt.JdtTypeProviderFactory;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.resource.XtextResource;\n+import org.eclipse.xtext.resource.XtextResourceSet;\n+import org.eclipse.xtext.ui.testing.util.JavaProjectSetupUtil;\n+import org.eclipse.xtext.ui.testing.util.ResourceLoadHelper;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Injector;\n+import com.google.inject.Provider;\n+\n+/**\n+ * @since 2.12\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractContentAssistTest implements ResourceLoadHelper, IJavaProjectProvider {\n+\n+\t@Inject\n+\tprivate Provider<XtextResourceSet> resourceSetProvider;\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprivate Injector injector;\n+\n+\tprivate static IJavaProject javaProject;\n+\n+\t@BeforeClass\n+\t@BeforeAll\n+\tpublic static void setUp() throws CoreException {\n+\t\tjavaProject = JavaProjectSetupUtil.createJavaProject(\"contentAssistTest\");\n+\t}\n+\n+\t@AfterClass\n+\t@AfterAll\n+\tpublic static void tearDown() throws CoreException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM2NjEzOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxOToyNVrOGFT4CA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxOToyNVrOGFT4CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyMTcwNA==", "bodyText": "This method now throws a CoreException", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408221704", "createdAt": "2020-04-14T15:19:25Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/**\n+ * Copyright (c) 2013, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.emf.common.util.URI;\n+import org.eclipse.emf.ecore.resource.Resource;\n+import org.eclipse.emf.ecore.resource.ResourceSet;\n+import org.eclipse.jdt.core.IJavaProject;\n+import org.eclipse.xtext.common.types.access.jdt.IJavaProjectProvider;\n+import org.eclipse.xtext.common.types.access.jdt.JdtTypeProviderFactory;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.resource.XtextResource;\n+import org.eclipse.xtext.resource.XtextResourceSet;\n+import org.eclipse.xtext.ui.testing.util.JavaProjectSetupUtil;\n+import org.eclipse.xtext.ui.testing.util.ResourceLoadHelper;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Injector;\n+import com.google.inject.Provider;\n+\n+/**\n+ * @since 2.12\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractContentAssistTest implements ResourceLoadHelper, IJavaProjectProvider {\n+\n+\t@Inject\n+\tprivate Provider<XtextResourceSet> resourceSetProvider;\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprivate Injector injector;\n+\n+\tprivate static IJavaProject javaProject;\n+\n+\t@BeforeClass\n+\t@BeforeAll\n+\tpublic static void setUp() throws CoreException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM4NjY0OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyMzo1MVrOGFUFJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjozNToxOVrOGGWiww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNTA2MA==", "bodyText": "Added this line to ensure that the test fails if an exception is thrown, and a proper error message is provided to the user.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408225060", "createdAt": "2020-04-14T15:23:51Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tfail(\"Error opening editor associated with the file \" + file.getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxMzk4Nw==", "bodyText": "Please propagate the exception as a RuntimeException with the suggested message instead. Otherwise the root cause may get lost.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409313987", "createdAt": "2020-04-16T06:35:19Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tfail(\"Error opening editor associated with the file \" + file.getName());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNTA2MA=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM4OTgwOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNDozMlrOGFUHOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNDozMlrOGFUHOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNTU5Mw==", "bodyText": "Throwing a RuntimeException here.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408225593", "createdAt": "2020-04-14T15:24:32Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tfail(\"Error opening editor associated with the file \" + file.getName());\n+\t\t}\n+\t}\n+\n+\tprotected void assertSelectedText(AbstractTextEditor textEditor, CharSequence expectedSelectedText) {\n+\t\tISelection selection = textEditor.getSelectionProvider().getSelection();\n+\t\tString actualSelectedText = ((ITextSelection) selection).getText();\n+\t\tassertEquals(expectedSelectedText, actualSelectedText);\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replace(c(), \"\");\n+\t}\n+\n+\tprotected IFile createFile(String content) {\n+\t\ttry {\n+\t\t\treturn IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content);\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM5NjEzOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNTo1NFrOGFULOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjozOTowN1rOGGWpJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNjYxOA==", "bodyText": "The TODO was already there. Please suggest if there is a better way to deal with this situation. I'll make the required change.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408226618", "createdAt": "2020-04-14T15:25:54Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNTYyMg==", "bodyText": "Ok.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409315622", "createdAt": "2020-04-16T06:39:07Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNjYxOA=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDM5OTk1OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNjozOFrOGFUNmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNjozOFrOGFUNmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNzIyNQ==", "bodyText": "Throwing a RuntimeException here.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408227225", "createdAt": "2020-04-14T15:26:38Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution\n+\t\t\t * to set the Xtext nature on the test project.\n+\t\t\t */\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQwMDc2OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNjo0NlrOGFUOGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNjo0NlrOGFUOGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyNzM1NQ==", "bodyText": "Throwing a RuntimeException here.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408227355", "createdAt": "2020-04-14T15:26:46Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution\n+\t\t\t * to set the Xtext nature on the test project.\n+\t\t\t */\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 108}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQwNjQ4OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyNzo1MVrOGFURmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0MzowOVrOGGWvrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyODI1MA==", "bodyText": "I believe we should log a message here. @szarnekow what do you think?", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408228250", "createdAt": "2020-04-14T15:27:51Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution\n+\t\t\t * to set the Xtext nature on the test project.\n+\t\t\t */\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected void foldingRegionsArePresent(IXtextDocument document, CharSequence expected) {\n+\t\tassertEquals(expected.toString().trim(), insertFoldingRegionMarkers(document));\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document) {\n+\t\tString lineSeparator = System.lineSeparator();\n+\t\tList<String> lines = Arrays.asList(document.get().split(lineSeparator));\n+\t\ttry {\n+\t\t\tfor (FoldedPosition foldingRegion : foldingRegionProvider.getFoldingRegions(document)) {\n+\t\t\t\t// Insert the beginning folding region marker at the beginning of the corresponding line\n+\t\t\t\tint startLine = document.getLineOfOffset(foldingRegion.offset);\n+\t\t\t\tlines.set(startLine, b() + lines.get(startLine));\n+\n+\t\t\t\t// Insert the end folding region marker at the end of the corresponding line\n+\t\t\t\tint endLine = document.getLineOfOffset(foldingRegion.offset + foldingRegion.length) - 1;\n+\t\t\t\tlines.set(endLine, lines.get(endLine) + e());\n+\t\t\t}\n+\t\t} catch (BadLocationException e) {\n+\t\t\t//Log an exception here???", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 130}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNzI5Mw==", "bodyText": "The test should fail if the exception is thrown, e.g. throw new RuntimeException(e)", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409317293", "createdAt": "2020-04-16T06:43:09Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution\n+\t\t\t * to set the Xtext nature on the test project.\n+\t\t\t */\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected void foldingRegionsArePresent(IXtextDocument document, CharSequence expected) {\n+\t\tassertEquals(expected.toString().trim(), insertFoldingRegionMarkers(document));\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document) {\n+\t\tString lineSeparator = System.lineSeparator();\n+\t\tList<String> lines = Arrays.asList(document.get().split(lineSeparator));\n+\t\ttry {\n+\t\t\tfor (FoldedPosition foldingRegion : foldingRegionProvider.getFoldingRegions(document)) {\n+\t\t\t\t// Insert the beginning folding region marker at the beginning of the corresponding line\n+\t\t\t\tint startLine = document.getLineOfOffset(foldingRegion.offset);\n+\t\t\t\tlines.set(startLine, b() + lines.get(startLine));\n+\n+\t\t\t\t// Insert the end folding region marker at the end of the corresponding line\n+\t\t\t\tint endLine = document.getLineOfOffset(foldingRegion.offset + foldingRegion.length) - 1;\n+\t\t\t\tlines.set(endLine, lines.get(endLine) + e());\n+\t\t\t}\n+\t\t} catch (BadLocationException e) {\n+\t\t\t//Log an exception here???", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyODI1MA=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 130}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQxMDk1OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToyODo0M1rOGFUUbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOTo1OTozOVrOGHbWGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyODk3NQ==", "bodyText": "Throwing a RuntimeException here.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408228975", "createdAt": "2020-04-14T15:28:43Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxODUzMg==", "bodyText": "Duplicated code. Can we extract the common logic to some base class or utitlity?", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409318532", "createdAt": "2020-04-16T06:46:11Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyODk3NQ=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ0MTI0MA==", "bodyText": "PS - https://github.com/eclipse/xtext-eclipse/pull/1402/files#diff-c376f0d7106ef132b9b489fd869fddf1R80", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410441240", "createdAt": "2020-04-17T19:59:39Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyODk3NQ=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQxNzEzOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMDowNFrOGFUYmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0ODoyNFrOGGW4CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMDA0Mw==", "bodyText": "I am not sure how I could replace the call to #newLineIfNotEmpty(), which is why I have kept this code as it is.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408230043", "createdAt": "2020-04-14T15:30:04Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"HoverTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"hover\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected XtextEditor openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tsyncUtil.waitForBuild(new NullProgressMonitor());\n+\t\t\treturn openEditor(dslFile);\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected BrowserInformationControlInput hoveringOver(IFile dslFile, IRegion hoverRegion) {\n+\t\tXtextEditor editor = openInEditor(dslFile);\n+\t\tObject hoverInfo = ((ITextHoverExtension2) eObjectHover).getHoverInfo2(editor.getInternalSourceViewer(), hoverRegion);\n+\t\treturn (BrowserInformationControlInput) hoverInfo;\n+\t}\n+\n+\tprotected void hoverPopupHasContent(BrowserInformationControlInput info, String expectedHoverContent) {\n+\t\tassertNotNull(\"No hover found!\", info);\n+\n+\t\tString actualHoverContent = info.getHtml();\n+\t\tStringConcatenation builder = new StringConcatenation();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxOTQzMg==", "bodyText": "See suggestion from the other file. String.format(..) should be fine.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409319432", "createdAt": "2020-04-16T06:48:24Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"HoverTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"hover\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected XtextEditor openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tsyncUtil.waitForBuild(new NullProgressMonitor());\n+\t\t\treturn openEditor(dslFile);\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected BrowserInformationControlInput hoveringOver(IFile dslFile, IRegion hoverRegion) {\n+\t\tXtextEditor editor = openInEditor(dslFile);\n+\t\tObject hoverInfo = ((ITextHoverExtension2) eObjectHover).getHoverInfo2(editor.getInternalSourceViewer(), hoverRegion);\n+\t\treturn (BrowserInformationControlInput) hoverInfo;\n+\t}\n+\n+\tprotected void hoverPopupHasContent(BrowserInformationControlInput info, String expectedHoverContent) {\n+\t\tassertNotNull(\"No hover found!\", info);\n+\n+\t\tString actualHoverContent = info.getHtml();\n+\t\tStringConcatenation builder = new StringConcatenation();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMDA0Mw=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 121}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQxODk3OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMDoyOFrOGFUZwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMDoyOFrOGFUZwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMDMzOA==", "bodyText": "Throwing a RuntimeException here.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408230338", "createdAt": "2020-04-14T15:30:28Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"HoverTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"hover\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected XtextEditor openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tsyncUtil.waitForBuild(new NullProgressMonitor());\n+\t\t\treturn openEditor(dslFile);\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 107}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQyMDU4OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMDo1MFrOGFUayg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMDo1MFrOGFUayg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMDYwMg==", "bodyText": "Throwing a RuntimeException here.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408230602", "createdAt": "2020-04-14T15:30:50Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQyMzMzOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMTozMVrOGFUclQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MTozMVrOGGW9aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMTA2MQ==", "bodyText": "I believe we should log a message here. @szarnekow what do you think?", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408231061", "createdAt": "2020-04-14T15:31:31Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMDgwOA==", "bodyText": "throw new RuntimeException", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409320808", "createdAt": "2020-04-16T06:51:31Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMTA2MQ=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 114}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDQyNDc3OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTozMTo1MVrOGFUdkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MjozN1rOGGW_Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMTMxMw==", "bodyText": "I believe we should log a message here, and return a null value. @szarnekow what do you think?", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r408231313", "createdAt": "2020-04-14T15:31:51Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?\n+\t\t}\n+\t\temptyMessages.add(\"(no markers found)\");\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile(String type, String... attributes) {\n+\t\ttry {\n+\t\t\treturn withMarkers(file.findMarkers(type, true, IResource.DEPTH_INFINITE), attributes);\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception and return null or throw RuntimeException?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 124}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMTI5OQ==", "bodyText": "throw new RuntimeExceptin", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409321299", "createdAt": "2020-04-16T06:52:37Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?\n+\t\t}\n+\t\temptyMessages.add(\"(no markers found)\");\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile(String type, String... attributes) {\n+\t\ttry {\n+\t\t\treturn withMarkers(file.findMarkers(type, true, IResource.DEPTH_INFINITE), attributes);\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception and return null or throw RuntimeException?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIzMTMxMw=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 124}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTMwMzgxOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjozNDoyOFrOGGWhXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjozNDoyOFrOGGWhXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxMzYzMA==", "bodyText": "Return type can be relaxed to List<String>", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409313630", "createdAt": "2020-04-16T06:34:28Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/**\n+ * Copyright (c) 2013, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.emf.common.util.URI;\n+import org.eclipse.emf.ecore.resource.Resource;\n+import org.eclipse.emf.ecore.resource.ResourceSet;\n+import org.eclipse.jdt.core.IJavaProject;\n+import org.eclipse.xtext.common.types.access.jdt.IJavaProjectProvider;\n+import org.eclipse.xtext.common.types.access.jdt.JdtTypeProviderFactory;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.resource.XtextResource;\n+import org.eclipse.xtext.resource.XtextResourceSet;\n+import org.eclipse.xtext.ui.testing.util.JavaProjectSetupUtil;\n+import org.eclipse.xtext.ui.testing.util.ResourceLoadHelper;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Injector;\n+import com.google.inject.Provider;\n+\n+/**\n+ * @since 2.12\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractContentAssistTest implements ResourceLoadHelper, IJavaProjectProvider {\n+\n+\t@Inject\n+\tprivate Provider<XtextResourceSet> resourceSetProvider;\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprivate Injector injector;\n+\n+\tprivate static IJavaProject javaProject;\n+\n+\t@BeforeClass\n+\t@BeforeAll\n+\tpublic static void setUp() throws CoreException {\n+\t\tjavaProject = JavaProjectSetupUtil.createJavaProject(\"contentAssistTest\");\n+\t}\n+\n+\t@AfterClass\n+\t@AfterAll\n+\tpublic static void tearDown() throws CoreException {\n+\t\tIProject project = AbstractContentAssistTest.javaProject.getProject();\n+\t\tproject.delete(true, new NullProgressMonitor());\n+\t}\n+\n+\t@Override\n+\tpublic XtextResource getResourceFor(InputStream stream) {\n+\t\tXtextResourceSet resourceSet = resourceSetProvider.get();\n+\t\tinitializeTypeProvider(resourceSet);\n+\t\ttry {\n+\t\t\tURI resourceUri = URI.createURI(\"Test.\" + fileExtensionProvider.getPrimaryFileExtension());\n+\t\t\tResource resource = resourceSet.createResource(resourceUri);\n+\t\t\tresource.load(stream, null);\n+\t\t\treturn (XtextResource) resource;\n+\t\t} catch (IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic IJavaProject getJavaProject(ResourceSet resourceSet) {\n+\t\treturn javaProject;\n+\t}\n+\n+\tprotected ArrayList<String> expect(String[]... arrays) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTMxMTk3OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjozNzoyMVrOGGWmHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDowOTo0MVrOGH1eVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNDg0Ng==", "bodyText": "fail(String.format(\"The input text \\n---\\n%s\\n---\\nmust contain the '%s' special symbol ...\", text, c()\"));", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409314846", "createdAt": "2020-04-16T06:37:21Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tfail(\"Error opening editor associated with the file \" + file.getName());\n+\t\t}\n+\t}\n+\n+\tprotected void assertSelectedText(AbstractTextEditor textEditor, CharSequence expectedSelectedText) {\n+\t\tISelection selection = textEditor.getSelectionProvider().getSelection();\n+\t\tString actualSelectedText = ((ITextSelection) selection).getText();\n+\t\tassertEquals(expectedSelectedText, actualSelectedText);\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replace(c(), \"\");\n+\t}\n+\n+\tprotected IFile createFile(String content) {\n+\t\ttry {\n+\t\t\treturn IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content);\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"Test\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"Foo\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected int getCursorPosition(CharSequence text) {\n+\t\tint cursorPosition = text.toString().indexOf(c());\n+\t\tif (cursorPosition == -1) {\n+\t\t\tStringConcatenation builder = new StringConcatenation();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyODY1Ng==", "bodyText": "Sorry, what does --- mean?", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410428656", "createdAt": "2020-04-17T19:32:20Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tfail(\"Error opening editor associated with the file \" + file.getName());\n+\t\t}\n+\t}\n+\n+\tprotected void assertSelectedText(AbstractTextEditor textEditor, CharSequence expectedSelectedText) {\n+\t\tISelection selection = textEditor.getSelectionProvider().getSelection();\n+\t\tString actualSelectedText = ((ITextSelection) selection).getText();\n+\t\tassertEquals(expectedSelectedText, actualSelectedText);\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replace(c(), \"\");\n+\t}\n+\n+\tprotected IFile createFile(String content) {\n+\t\ttry {\n+\t\t\treturn IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content);\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"Test\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"Foo\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected int getCursorPosition(CharSequence text) {\n+\t\tint cursorPosition = text.toString().indexOf(c());\n+\t\tif (cursorPosition == -1) {\n+\t\t\tStringConcatenation builder = new StringConcatenation();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNDg0Ng=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2OTMzNA==", "bodyText": "I meant this as a delimiter to delimit the model text from the other part of the error message.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410869334", "createdAt": "2020-04-19T10:09:41Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tfail(\"Error opening editor associated with the file \" + file.getName());\n+\t\t}\n+\t}\n+\n+\tprotected void assertSelectedText(AbstractTextEditor textEditor, CharSequence expectedSelectedText) {\n+\t\tISelection selection = textEditor.getSelectionProvider().getSelection();\n+\t\tString actualSelectedText = ((ITextSelection) selection).getText();\n+\t\tassertEquals(expectedSelectedText, actualSelectedText);\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replace(c(), \"\");\n+\t}\n+\n+\tprotected IFile createFile(String content) {\n+\t\ttry {\n+\t\t\treturn IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content);\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"Test\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"Foo\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected int getCursorPosition(CharSequence text) {\n+\t\tint cursorPosition = text.toString().indexOf(c());\n+\t\tif (cursorPosition == -1) {\n+\t\t\tStringConcatenation builder = new StringConcatenation();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNDg0Ng=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTMyNjE4OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0MjozNFrOGGWupw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQwNzoxOTowOVrOGHoyZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNzAzMQ==", "bodyText": "This System.lineSeparator can be a source of frustation on windows vs linux. Better use document.getLineDelimiter and if it is null, assume that there is only a single line in the document.\nI think I'd like an overload String insertFoldingRegionMarkers(IXtextDOcument doc, String lineSeparator) { .. } that is used from here with the documents line delimiter as default (if any), and a fallback to document.getLegalLineDelimiters()[0]", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409317031", "createdAt": "2020-04-16T06:42:34Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution\n+\t\t\t * to set the Xtext nature on the test project.\n+\t\t\t */\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected void foldingRegionsArePresent(IXtextDocument document, CharSequence expected) {\n+\t\tassertEquals(expected.toString().trim(), insertFoldingRegionMarkers(document));\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document) {\n+\t\tString lineSeparator = System.lineSeparator();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY2MTQ3OA==", "bodyText": "Added a new method insertFoldingRegionMarkers(IXtextDOcument doc, String lineSeparator). Also checking if the document is empty before calling document.getLineDelimiter(0). Please check.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410661478", "createdAt": "2020-04-18T07:19:09Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tfoldingRegionsArePresent(openInEditor(dslFile(charSequence)), charSequence);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence text) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), getContent(text));\n+\n+\t\t\t/*\n+\t\t\t * TODO: find a better (with good performance) solution\n+\t\t\t * to set the Xtext nature on the test project.\n+\t\t\t */\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected void foldingRegionsArePresent(IXtextDocument document, CharSequence expected) {\n+\t\tassertEquals(expected.toString().trim(), insertFoldingRegionMarkers(document));\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document) {\n+\t\tString lineSeparator = System.lineSeparator();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNzAzMQ=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 117}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTMzNDg1OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0NTo0OFrOGGWz8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0NTo0OFrOGGWz8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxODM4NA==", "bodyText": "There is no it", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409318384", "createdAt": "2020-04-16T06:45:48Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTMzNzE3OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0Njo0NVrOGGW1ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMDowMTozM1rOGHbZLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxODc2Mg==", "bodyText": "Not related to this PR, but SyncUtil is a little nasty.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409318762", "createdAt": "2020-04-16T06:46:45Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ0MjAzMA==", "bodyText": "Removed.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410442030", "createdAt": "2020-04-17T20:01:33Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxODc2Mg=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTMzOTcwOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0Nzo0MVrOGGW25w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0Nzo0MVrOGGW25w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxOTE0Mw==", "bodyText": "Use org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil.waitForBuild() instead.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409319143", "createdAt": "2020-04-16T06:47:41Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtend2.lib.StringConcatenation;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.XtextProjectHelper;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.refactoring.ui.SyncUtil;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected SyncUtil syncUtil;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param it\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\thoverPopupHasContent(hoveringOver(dslFile(charSequence), hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected IFile dslFile(CharSequence content) {\n+\t\ttry {\n+\t\t\tIFile file = IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content.toString());\n+\t\t\tIProject project = file.getProject();\n+\t\t\tif (!project.hasNature(XtextProjectHelper.NATURE_ID)) {\n+\t\t\t\tIResourcesSetupUtil.addNature(project, XtextProjectHelper.NATURE_ID);\n+\t\t\t}\n+\t\t\treturn file;\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"HoverTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"hover\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected XtextEditor openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tsyncUtil.waitForBuild(new NullProgressMonitor());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 104}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTM0NTgxOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0OTo0MFrOGGW6ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo0OTo0MFrOGGW6ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMDAzNw==", "bodyText": "Unnecessary type argument, use diamond op instead.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409320037", "createdAt": "2020-04-16T06:49:40Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 103}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTM0OTUxOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MTowNFrOGGW8sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxOTozOToyMFrOGHaxgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMDYyNA==", "bodyText": "Either String.join(\", \", transformed) or write the text into a StringBuilder directly rather than creating a list of strings to concat that subsequently.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409320624", "createdAt": "2020-04-16T06:51:04Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQzMTg3Mg==", "bodyText": "Tx for your suggestion. I'll use String.join(\", \", transformed). It is a better alternative to the tedious transformed.stream().collect(Collectors.joining(\", \")).", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410431872", "createdAt": "2020-04-17T19:39:20Z", "author": {"login": "nbhusare"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMDYyNA=="}, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 108}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTM1NjQ1OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MzoyNFrOGGXA1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MzoyNFrOGGXA1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMTY4NA==", "bodyText": "Cosmetics: Comparator.comparing(SimpleEntry::getKey)", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409321684", "createdAt": "2020-04-16T06:53:24Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?\n+\t\t}\n+\t\temptyMessages.add(\"(no markers found)\");\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile(String type, String... attributes) {\n+\t\ttry {\n+\t\t\treturn withMarkers(file.findMarkers(type, true, IResource.DEPTH_INFINITE), attributes);\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception and return null or throw RuntimeException?\n+\t\t\treturn null;\n+\t\t}\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile() {\n+\t\treturn withMarkersFromFile(MarkerTypes.FAST_VALIDATION, IMarker.MESSAGE);\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\tString contents = getContents();\n+\t\tregions.sort(Comparator.comparing((region) -> Integer.valueOf(region.start)));\n+\n+\t\tList<SimpleEntry<Integer, CommentedRegion>> sorted = new ArrayList<>();\n+\t\tfor (int index = 0; index < regions.size(); index++) {\n+\t\t\tsorted.add(new SimpleEntry<Integer, CommentedRegion>(index, regions.get(index)));\n+\t\t}\n+\n+\t\tList<SimpleEntry<Integer, String>> locations = new ArrayList<>();\n+\t\tsorted.stream().forEach(s -> {\n+\t\t\tlocations.add(new SimpleEntry<Integer, String>(s.getValue().start, \"<\" + s.getKey() + \"<\"));\n+\t\t\tlocations.add(new SimpleEntry<Integer, String>(s.getValue().end, \">\" + s.getKey() + \">\"));\n+\t\t});\n+\t\tlocations.sort(Comparator.comparing((location) -> location.getKey()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 148}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTM1NzU0OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1Mzo0NFrOGGXBcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1Mzo0NFrOGGXBcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMTg0MQ==", "bodyText": "Unnecessary type arguments, new SimpleEntry<>(..) should be sufficient.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409321841", "createdAt": "2020-04-16T06:53:44Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?\n+\t\t}\n+\t\temptyMessages.add(\"(no markers found)\");\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile(String type, String... attributes) {\n+\t\ttry {\n+\t\t\treturn withMarkers(file.findMarkers(type, true, IResource.DEPTH_INFINITE), attributes);\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception and return null or throw RuntimeException?\n+\t\t\treturn null;\n+\t\t}\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile() {\n+\t\treturn withMarkersFromFile(MarkerTypes.FAST_VALIDATION, IMarker.MESSAGE);\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\tString contents = getContents();\n+\t\tregions.sort(Comparator.comparing((region) -> Integer.valueOf(region.start)));\n+\n+\t\tList<SimpleEntry<Integer, CommentedRegion>> sorted = new ArrayList<>();\n+\t\tfor (int index = 0; index < regions.size(); index++) {\n+\t\t\tsorted.add(new SimpleEntry<Integer, CommentedRegion>(index, regions.get(index)));\n+\t\t}\n+\n+\t\tList<SimpleEntry<Integer, String>> locations = new ArrayList<>();\n+\t\tsorted.stream().forEach(s -> {\n+\t\t\tlocations.add(new SimpleEntry<Integer, String>(s.getValue().start, \"<\" + s.getKey() + \"<\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 145}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTM2MDExOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1NDo0MFrOGGXC-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1NDo0MFrOGGXC-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMjIzNA==", "bodyText": "Comparator.comparingInt(region->region.start)", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409322234", "createdAt": "2020-04-16T06:54:40Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?\n+\t\t}\n+\t\temptyMessages.add(\"(no markers found)\");\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile(String type, String... attributes) {\n+\t\ttry {\n+\t\t\treturn withMarkers(file.findMarkers(type, true, IResource.DEPTH_INFINITE), attributes);\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception and return null or throw RuntimeException?\n+\t\t\treturn null;\n+\t\t}\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile() {\n+\t\treturn withMarkersFromFile(MarkerTypes.FAST_VALIDATION, IMarker.MESSAGE);\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\tString contents = getContents();\n+\t\tregions.sort(Comparator.comparing((region) -> Integer.valueOf(region.start)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 136}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTM5OTQzOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNzowODoxMFrOGGXbBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNzowODoxMFrOGGXbBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyODM5MQ==", "bodyText": "Typo: length", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409328391", "createdAt": "2020-04-16T07:08:10Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {\n+\t\t\t\treturn contents;\n+\t\t\t}\n+\n+\t\t\tif (file != null) {\n+\t\t\t\treturn IResourcesSetupUtil.fileToString(file);\n+\t\t\t}\n+\n+\t\t\treturn null;\n+\t\t} catch (CoreException | IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tpublic void setContents(String contents) {\n+\t\tthis.contents = contents;\n+\t}\n+\n+\tpublic IFile getFile() {\n+\t\treturn file;\n+\t}\n+\n+\tpublic void setFile(IFile file) {\n+\t\tthis.file = file;\n+\t}\n+\n+\tpublic List<CommentedRegion> getRegions() {\n+\t\treturn regions;\n+\t}\n+\n+\tpublic List<String> getEmptyMessage() {\n+\t\treturn emptyMessages;\n+\t}\n+\n+\tpublic AnnotatedTextToString withFile(IFile file) {\n+\t\tthis.file = file;\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers) {\n+\t\treturn withMarkers(markers, IMarker.MESSAGE);\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkers(IMarker[] markers, String... attributes) {\n+\t\ttry {\n+\t\t\tfor (IMarker marker : markers) {\n+\t\t\t\tList<String> transformed = new ArrayList<String>(attributes.length);\n+\t\t\t\tfor (String attribute : attributes) {\n+\t\t\t\t\ttransformed.add(attribute + \"=\" + marker.getAttribute(attribute));\n+\t\t\t\t}\n+\n+\t\t\t\tString comment = transformed.stream().collect(Collectors.joining(\", \"));\n+\t\t\t\tInteger offset = (Integer) marker.getAttribute(IMarker.CHAR_START);\n+\t\t\t\tInteger length = (Integer) marker.getAttribute(IMarker.CHAR_END);\n+\t\t\t\tregions.add(new CommentedRegion(offset, length, comment));\n+\t\t\t}\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception?\n+\t\t}\n+\t\temptyMessages.add(\"(no markers found)\");\n+\t\treturn this;\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile(String type, String... attributes) {\n+\t\ttry {\n+\t\t\treturn withMarkers(file.findMarkers(type, true, IResource.DEPTH_INFINITE), attributes);\n+\t\t} catch (CoreException e) {\n+\t\t\t// Log the exception and return null or throw RuntimeException?\n+\t\t\treturn null;\n+\t\t}\n+\t}\n+\n+\tpublic AnnotatedTextToString withMarkersFromFile() {\n+\t\treturn withMarkersFromFile(MarkerTypes.FAST_VALIDATION, IMarker.MESSAGE);\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\tString contents = getContents();\n+\t\tregions.sort(Comparator.comparing((region) -> Integer.valueOf(region.start)));\n+\n+\t\tList<SimpleEntry<Integer, CommentedRegion>> sorted = new ArrayList<>();\n+\t\tfor (int index = 0; index < regions.size(); index++) {\n+\t\t\tsorted.add(new SimpleEntry<Integer, CommentedRegion>(index, regions.get(index)));\n+\t\t}\n+\n+\t\tList<SimpleEntry<Integer, String>> locations = new ArrayList<>();\n+\t\tsorted.stream().forEach(s -> {\n+\t\t\tlocations.add(new SimpleEntry<Integer, String>(s.getValue().start, \"<\" + s.getKey() + \"<\"));\n+\t\t\tlocations.add(new SimpleEntry<Integer, String>(s.getValue().end, \">\" + s.getKey() + \">\"));\n+\t\t});\n+\t\tlocations.sort(Comparator.comparing((location) -> location.getKey()));\n+\n+\t\tStringBuilder result = new StringBuilder();\n+\t\tint lastOffset = 0;\n+\t\tfor (int i = 0; i < locations.size(); i++) {\n+\t\t\tSimpleEntry<Integer, String> location = locations.get(i);\n+\t\t\tInteger offset = location.getKey();\n+\t\t\tString comment = location.getValue();\n+\t\t\tresult.append(contents.substring(lastOffset, offset));\n+\t\t\tresult.append(comment);\n+\t\t\tlastOffset = offset;\n+\t\t}\n+\n+\t\tresult.append(contents.substring(lastOffset, contents.length()));\n+\t\tString[] resultsArray = result.toString().replace(\"\\t\", \"    \").split(\"\\r?\\n\");\n+\t\tint maxLineLenght = Arrays.stream(resultsArray).map(r -> r.length()).reduce(Integer::max).get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 163}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTczNjU5OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwODozOToxMFrOGGatBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwODozOToxMFrOGGatBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM4MjE1MA==", "bodyText": "Use List on the left hand side", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409382150", "createdAt": "2020-04-16T08:39:10Z", "author": {"login": "tivervac"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractContentAssistTest.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/**\n+ * Copyright (c) 2013, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+\n+import org.eclipse.core.resources.IProject;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.emf.common.util.URI;\n+import org.eclipse.emf.ecore.resource.Resource;\n+import org.eclipse.emf.ecore.resource.ResourceSet;\n+import org.eclipse.jdt.core.IJavaProject;\n+import org.eclipse.xtext.common.types.access.jdt.IJavaProjectProvider;\n+import org.eclipse.xtext.common.types.access.jdt.JdtTypeProviderFactory;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.resource.XtextResource;\n+import org.eclipse.xtext.resource.XtextResourceSet;\n+import org.eclipse.xtext.ui.testing.util.JavaProjectSetupUtil;\n+import org.eclipse.xtext.ui.testing.util.ResourceLoadHelper;\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Injector;\n+import com.google.inject.Provider;\n+\n+/**\n+ * @since 2.12\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractContentAssistTest implements ResourceLoadHelper, IJavaProjectProvider {\n+\n+\t@Inject\n+\tprivate Provider<XtextResourceSet> resourceSetProvider;\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprivate Injector injector;\n+\n+\tprivate static IJavaProject javaProject;\n+\n+\t@BeforeClass\n+\t@BeforeAll\n+\tpublic static void setUp() throws CoreException {\n+\t\tjavaProject = JavaProjectSetupUtil.createJavaProject(\"contentAssistTest\");\n+\t}\n+\n+\t@AfterClass\n+\t@AfterAll\n+\tpublic static void tearDown() throws CoreException {\n+\t\tIProject project = AbstractContentAssistTest.javaProject.getProject();\n+\t\tproject.delete(true, new NullProgressMonitor());\n+\t}\n+\n+\t@Override\n+\tpublic XtextResource getResourceFor(InputStream stream) {\n+\t\tXtextResourceSet resourceSet = resourceSetProvider.get();\n+\t\tinitializeTypeProvider(resourceSet);\n+\t\ttry {\n+\t\t\tURI resourceUri = URI.createURI(\"Test.\" + fileExtensionProvider.getPrimaryFileExtension());\n+\t\t\tResource resource = resourceSet.createResource(resourceUri);\n+\t\t\tresource.load(stream, null);\n+\t\t\treturn (XtextResource) resource;\n+\t\t} catch (IOException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic IJavaProject getJavaProject(ResourceSet resourceSet) {\n+\t\treturn javaProject;\n+\t}\n+\n+\tprotected ArrayList<String> expect(String[]... arrays) {\n+\t\tArrayList<String> expectation = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 89}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MTc1MjU3OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwODo0MzoyM1rOGGa3IA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwODo0MzoyM1rOGGa3IA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM4NDczNg==", "bodyText": "You can move this outside of the the try", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r409384736", "createdAt": "2020-04-16T08:43:23Z", "author": {"login": "tivervac"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/util/AnnotatedTextToString.java", "diffHunk": "@@ -0,0 +1,187 @@\n+/**\n+ * Copyright (c) 2017, 2020 TypeFox GmbH (http://www.typefox.io) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing.util;\n+\n+import java.io.IOException;\n+import java.util.AbstractMap.SimpleEntry;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Comparator;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.resources.IMarker;\n+import org.eclipse.core.resources.IResource;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.xtext.ui.MarkerTypes;\n+\n+import com.google.common.base.Strings;\n+\n+/**\n+ * @author Moritz Eysholdt - Initial contribution and API\n+ */\n+public class AnnotatedTextToString {\n+\n+\tprotected static class CommentedRegion {\n+\n+\t\tprivate final int start;\n+\n+\t\tprivate final int end;\n+\n+\t\tprivate final String text;\n+\n+\t\tpublic CommentedRegion(int start, int end, String text) {\n+\t\t\tthis.start = start;\n+\t\t\tthis.end = end;\n+\t\t\tthis.text = text;\n+\t\t}\n+\t}\n+\n+\tprivate String contents;\n+\n+\tprivate IFile file;\n+\n+\tprivate List<CommentedRegion> regions = new ArrayList<>();\n+\n+\tprivate List<String> emptyMessages = new ArrayList<>();\n+\n+\tpublic String getContents() {\n+\t\ttry {\n+\t\t\tif (contents != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "029e22fac107ce60942a74d50468e08b88756d13"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1MTg4MTAzOnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDoxMjoxNlrOGH1f9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDoxMjoxNlrOGH1f9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2OTc1MQ==", "bodyText": "getLineDelimiter is document to return null if the line does not have a delimiter. I'd rather fix this here than in the overload below.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410869751", "createdAt": "2020-04-19T10:12:16Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,128 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tIFile file = dslFile(getProjectName(), getFileName(), getFileExtension(), charSequence);\n+\t\tfoldingRegionsArePresent(openInEditor(file), charSequence);\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected void foldingRegionsArePresent(IXtextDocument document, CharSequence expected) {\n+\t\tassertEquals(expected.toString().trim(), insertFoldingRegionMarkers(document));\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document) {\n+\t\tif (document.getLength() == 0) { // The document is empty\n+\t\t\treturn null;\n+\t\t}\n+\n+\t\ttry {\n+\t\t\tString lineSeparator = document.getLineDelimiter(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc95010dec392f8bfb6b0b9ad4202f0caa92fb6a"}, "originalPosition": 100}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1MTg4MTQ0OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDoxMjozMVrOGH1gIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDoxMjozMVrOGH1gIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2OTc5NA==", "bodyText": "This method should assume that lineSeparator is not null.", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r410869794", "createdAt": "2020-04-19T10:12:31Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,128 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tIFile file = dslFile(getProjectName(), getFileName(), getFileExtension(), charSequence);\n+\t\tfoldingRegionsArePresent(openInEditor(file), charSequence);\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");\n+\t}\n+\n+\tprotected IXtextDocument openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIXtextDocument document = openEditor(dslFile).getDocument();\n+\t\t\tassertNotNull(document);\n+\t\t\treturn document;\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected void foldingRegionsArePresent(IXtextDocument document, CharSequence expected) {\n+\t\tassertEquals(expected.toString().trim(), insertFoldingRegionMarkers(document));\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document) {\n+\t\tif (document.getLength() == 0) { // The document is empty\n+\t\t\treturn null;\n+\t\t}\n+\n+\t\ttry {\n+\t\t\tString lineSeparator = document.getLineDelimiter(0);\n+\t\t\treturn insertFoldingRegionMarkers(document, lineSeparator);\n+\t\t} catch (BadLocationException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String insertFoldingRegionMarkers(IXtextDocument document, String lineSeparator) {\n+\t\tif (lineSeparator == null) { // The document contains a single line", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc95010dec392f8bfb6b0b9ad4202f0caa92fb6a"}, "originalPosition": 108}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NDgyNzM0OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMTowMlrOGIMzFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMTowMlrOGIMzFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI1MTQ3OQ==", "bodyText": "Space after newline will be irritating. -> \\n%s\\n would be prefered", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r411251479", "createdAt": "2020-04-20T10:01:02Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractEditorDoubleClickTextSelectionTest.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.CoreException;\n+import org.eclipse.jface.text.ITextSelection;\n+import org.eclipse.jface.text.source.ISourceViewer;\n+import org.eclipse.jface.viewers.ISelection;\n+import org.eclipse.swt.SWT;\n+import org.eclipse.swt.widgets.Event;\n+import org.eclipse.ui.texteditor.AbstractTextEditor;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.14\n+ */\n+public abstract class AbstractEditorDoubleClickTextSelectionTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprivate FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the current cursor position.\n+\t */\n+\tpublic String c() {\n+\t\treturn \"|\";\n+\t}\n+\n+\t/**\n+\t * @param charSequence\n+\t *            The editor's input text. The text must contain the {@link #c} special symbol indicating the current cursor position.\n+\t * \n+\t * @param expected\n+\t *            The text that is expected to be selected after double clicking in the Xtext editor on the current cursor position.\n+\t */\n+\tpublic void assertSelectedTextAfterDoubleClicking(CharSequence charSequence, String expected) {\n+\t\tIFile file = createFile(getContent(charSequence));\n+\t\ttry {\n+\t\t\tXtextEditor xtextEditor = openEditor(file);\n+\t\t\txtextEditor = doubleClick(xtextEditor, getCursorPosition(charSequence));\n+\t\t\tassertSelectedText(xtextEditor, expected);\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(\"Error opening editor associated with the file \" + file.getName());\n+\t\t}\n+\t}\n+\n+\tprotected void assertSelectedText(AbstractTextEditor textEditor, CharSequence expectedSelectedText) {\n+\t\tISelection selection = textEditor.getSelectionProvider().getSelection();\n+\t\tString actualSelectedText = ((ITextSelection) selection).getText();\n+\t\tassertEquals(expectedSelectedText, actualSelectedText);\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replace(c(), \"\");\n+\t}\n+\n+\tprotected IFile createFile(String content) {\n+\t\ttry {\n+\t\t\treturn IResourcesSetupUtil.createFile(getProjectName(), getFileName(), getFileExtension(), content);\n+\t\t} catch (InvocationTargetException | CoreException | InterruptedException e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"Test\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"Foo\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected int getCursorPosition(CharSequence text) {\n+\t\tint cursorPosition = text.toString().indexOf(c());\n+\t\tif (cursorPosition == -1) {\n+\t\t\tString message = \"The input text\\n %s \\nmust contain the '%s' special symbol indicating the current cursor position!\\n\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb69e4f47a61c536b8af4925a3c596abdf3576c0"}, "originalPosition": 95}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NDgzMTY2OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMjowNVrOGIM1ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMjowNVrOGIM1ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI1MjEyNg==", "bodyText": "\\n \\t -> please use \\n%s\\n instead", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r411252126", "createdAt": "2020-04-20T10:02:05Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractHoverTest.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/**\n+ * Copyright (c) 2018, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.core.runtime.NullProgressMonitor;\n+import org.eclipse.jface.internal.text.html.BrowserInformationControlInput;\n+import org.eclipse.jface.text.IRegion;\n+import org.eclipse.jface.text.ITextHoverExtension2;\n+import org.eclipse.jface.text.Region;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.XtextEditor;\n+import org.eclipse.xtext.ui.editor.hover.IEObjectHover;\n+import org.eclipse.xtext.ui.testing.util.IResourcesSetupUtil;\n+\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * \n+ * @since 2.16\n+ */\n+@SuppressWarnings(\"restriction\")\n+public abstract class AbstractHoverTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected IEObjectHover eObjectHover;\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific text in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverText\n+\t *            the text you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, String hoverText, String hoverContent) {\n+\t\tRegion region = new Region(charSequence.toString().indexOf(hoverText), hoverText.length());\n+\t\thasHoverOver(charSequence, region, hoverContent);\n+\t}\n+\n+\t/**\n+\t * Test that the expected text appears in a popup window while hovering over a specific region in a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            the initial DSL text.\n+\t * @param hoverRegion\n+\t *            the region you are hovering over.\n+\t * @param hoverContent\n+\t *            the text that is expected to be part of the hover popup.\n+\t */\n+\tpublic void hasHoverOver(CharSequence charSequence, IRegion hoverRegion, String hoverContent) {\n+\t\tIFile file = dslFile(getProjectName(), getFileName(), getFileExtension(), charSequence);\n+\t\thoverPopupHasContent(hoveringOver(file, hoverRegion), hoverContent);\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"HoverTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"hover\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected XtextEditor openInEditor(IFile dslFile) {\n+\t\ttry {\n+\t\t\tIResourcesSetupUtil.waitForBuild(new NullProgressMonitor());\n+\t\t\treturn openEditor(dslFile);\n+\t\t} catch (Exception e) {\n+\t\t\tthrow new RuntimeException(e);\n+\t\t}\n+\t}\n+\n+\tprotected BrowserInformationControlInput hoveringOver(IFile dslFile, IRegion hoverRegion) {\n+\t\tXtextEditor editor = openInEditor(dslFile);\n+\t\tObject hoverInfo = ((ITextHoverExtension2) eObjectHover).getHoverInfo2(editor.getInternalSourceViewer(), hoverRegion);\n+\t\treturn (BrowserInformationControlInput) hoverInfo;\n+\t}\n+\n+\tprotected void hoverPopupHasContent(BrowserInformationControlInput info, String expectedHoverContent) {\n+\t\tassertNotNull(\"No hover found!\", info);\n+\n+\t\tString actualHoverContent = info.getHtml();\n+\t\tString message = \"Could not find the text '%s' in the hover popup:\\n \\t%s\\n\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb69e4f47a61c536b8af4925a3c596abdf3576c0"}, "originalPosition": 99}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NDgzNTA4OnYy", "diffSide": "RIGHT", "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMzowMlrOGIM32w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDowMzowMlrOGIM32w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI1MjY5OQ==", "bodyText": "Can be simplified to text.replace(b(), \"\").replace(e(), \"\")", "url": "https://github.com/eclipse/xtext-eclipse/pull/1402#discussion_r411252699", "createdAt": "2020-04-20T10:03:02Z", "author": {"login": "szarnekow"}, "path": "org.eclipse.xtext.ui.testing/src/org/eclipse/xtext/ui/testing/AbstractFoldingTest.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/**\n+ * Copyright (c) 2019, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.ui.testing;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.regex.Pattern;\n+\n+import org.eclipse.core.resources.IFile;\n+import org.eclipse.jface.text.BadLocationException;\n+import org.eclipse.xtext.resource.FileExtensionProvider;\n+import org.eclipse.xtext.ui.editor.folding.FoldedPosition;\n+import org.eclipse.xtext.ui.editor.folding.IFoldingRegionProvider;\n+import org.eclipse.xtext.ui.editor.model.IXtextDocument;\n+\n+import com.google.common.annotations.Beta;\n+import com.google.common.base.Joiner;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author miklossy - Initial contribution and API\n+ * @since 2.19\n+ */\n+@Beta\n+public abstract class AbstractFoldingTest extends AbstractEditorTest {\n+\n+\t@Inject\n+\tprotected FileExtensionProvider fileExtensionProvider;\n+\n+\t@Inject\n+\tprotected IFoldingRegionProvider foldingRegionProvider;\n+\n+\t/**\n+\t * @return the special symbol indicating the beginning of a folding region.\n+\t */\n+\tpublic String b() {\n+\t\treturn \"[>\";\n+\t}\n+\n+\t/**\n+\t * @return the special symbol indicating the end of a folding region.\n+\t */\n+\tpublic String e() {\n+\t\treturn \"<]\";\n+\t}\n+\n+\t/**\n+\t * Test that the expected folding regions are present on a given DSL text.\n+\t * \n+\t * @param charSequence\n+\t *            The DSL text where the expected folding regions are enclosed by the {@link #b() b} and {@link #e() e} symbols.\n+\t */\n+\tpublic void testFoldingRegions(CharSequence charSequence) {\n+\t\tIFile file = dslFile(getProjectName(), getFileName(), getFileExtension(), charSequence);\n+\t\tfoldingRegionsArePresent(openInEditor(file), charSequence);\n+\t}\n+\n+\tprotected String getProjectName() {\n+\t\treturn \"FoldingTestProject\";\n+\t}\n+\n+\tprotected String getFileName() {\n+\t\treturn \"folding\";\n+\t}\n+\n+\tprotected String getFileExtension() {\n+\t\treturn fileExtensionProvider.getPrimaryFileExtension();\n+\t}\n+\n+\tprotected String getContent(CharSequence text) {\n+\t\treturn text.toString().replaceAll(Pattern.quote(b()), \"\").replaceAll(Pattern.quote(e()), \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb69e4f47a61c536b8af4925a3c596abdf3576c0"}, "originalPosition": 77}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 832, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}