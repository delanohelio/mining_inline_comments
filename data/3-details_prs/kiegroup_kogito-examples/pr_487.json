{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NTg4MjY4", "number": 487, "title": "KOGITO-3994 Use Qute templating to handle Data Index config", "bodyText": "", "createdAt": "2020-12-14T15:36:43Z", "url": "https://github.com/kiegroup/kogito-examples/pull/487", "merged": true, "mergeCommit": {"oid": "c997f82130aee9b1d2f9e59dca53e1914f820516"}, "closed": true, "closedAt": "2020-12-16T00:39:38Z", "author": {"login": "cristianonicolai"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmHmJ1ABqjQxMDk5MTI0OTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmgy8lAFqTU1Mjg2MzE0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de4b8ed46364140cae7bd53380d24dc9ad8d0df9", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/de4b8ed46364140cae7bd53380d24dc9ad8d0df9", "committedDate": "2020-12-14T15:35:45Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}, "afterCommit": {"oid": "7fe830e3353905857fc745e722f8663570483691", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/7fe830e3353905857fc745e722f8663570483691", "committedDate": "2020-12-14T15:37:10Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTc5NDY2", "url": "https://github.com/kiegroup/kogito-examples/pull/487#pullrequestreview-552179466", "createdAt": "2020-12-15T07:47:00Z", "commit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTk0MDgx", "url": "https://github.com/kiegroup/kogito-examples/pull/487#pullrequestreview-552194081", "createdAt": "2020-12-15T08:10:03Z", "commit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwODoxMToxNlrOIF-DSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwODoxMTozNVrOIF-EIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzEzMDQ0MQ==", "bodyText": "maybe rename to indexTpl", "url": "https://github.com/kiegroup/kogito-examples/pull/487#discussion_r543130441", "createdAt": "2020-12-15T08:11:16Z", "author": {"login": "radtriste"}, "path": "kogito-travel-agency/extended/travels/src/main/java/org/kie/kogito/app/VertxRouter.java", "diffHunk": "@@ -15,57 +15,29 @@\n  */\n package org.kie.kogito.app;\n \n-import java.net.URL;\n-\n-import javax.annotation.PostConstruct;\n import javax.enterprise.context.ApplicationScoped;\n import javax.enterprise.event.Observes;\n import javax.inject.Inject;\n \n-import io.vertx.core.Vertx;\n-import io.vertx.core.buffer.Buffer;\n+import io.quarkus.qute.Template;\n import io.vertx.ext.web.Router;\n import io.vertx.ext.web.handler.FaviconHandler;\n import io.vertx.ext.web.handler.LoggerHandler;\n import io.vertx.ext.web.handler.StaticHandler;\n-import org.eclipse.microprofile.config.inject.ConfigProperty;\n \n import static io.vertx.core.http.HttpMethod.GET;\n-import static java.nio.charset.StandardCharsets.UTF_8;\n \n @ApplicationScoped\n public class VertxRouter {\n \n     @Inject\n-    @ConfigProperty(name = \"kogito.dataindex.http.url\", defaultValue = \"http://localhost:8180\")\n-    String dataIndexHttpURL;\n-\n-    @Inject\n-    @ConfigProperty(name = \"kogito.dataindex.ws.url\", defaultValue = \"ws://localhost:8180\")\n-    String dataIndexWsURL;\n-\n-    @Inject\n-    Vertx vertx;\n-\n-    private Buffer resource;\n-\n-    @PostConstruct\n-    public void init() {\n-        try {\n-            resource = Buffer.buffer(vertx.fileSystem()\n-                                             .readFileBlocking(\"META-INF/resources/index.html\")\n-                                             .toString(UTF_8)\n-                                             .replace(\"__GRAPHQL_HTTP_ENDPOINT__\", \"\\\"\" + dataIndexHttpURL + \"/graphql\\\"\")\n-                                             .replace(\"__GRAPHQL_WS_ENDPOINT__\", \"\\\"\" + dataIndexWsURL + \"/graphql\\\"\"));\n-        } catch (Exception e) {\n-            throw new RuntimeException(e);\n-        }\n-    }\n+    Template index;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzEzMDY1Nw==", "bodyText": "maybe rename template -> indexPage", "url": "https://github.com/kiegroup/kogito-examples/pull/487#discussion_r543130657", "createdAt": "2020-12-15T08:11:35Z", "author": {"login": "radtriste"}, "path": "kogito-travel-agency/extended/travels/src/main/java/org/kie/kogito/app/VertxRouter.java", "diffHunk": "@@ -15,57 +15,29 @@\n  */\n package org.kie.kogito.app;\n \n-import java.net.URL;\n-\n-import javax.annotation.PostConstruct;\n import javax.enterprise.context.ApplicationScoped;\n import javax.enterprise.event.Observes;\n import javax.inject.Inject;\n \n-import io.vertx.core.Vertx;\n-import io.vertx.core.buffer.Buffer;\n+import io.quarkus.qute.Template;\n import io.vertx.ext.web.Router;\n import io.vertx.ext.web.handler.FaviconHandler;\n import io.vertx.ext.web.handler.LoggerHandler;\n import io.vertx.ext.web.handler.StaticHandler;\n-import org.eclipse.microprofile.config.inject.ConfigProperty;\n \n import static io.vertx.core.http.HttpMethod.GET;\n-import static java.nio.charset.StandardCharsets.UTF_8;\n \n @ApplicationScoped\n public class VertxRouter {\n \n     @Inject\n-    @ConfigProperty(name = \"kogito.dataindex.http.url\", defaultValue = \"http://localhost:8180\")\n-    String dataIndexHttpURL;\n-\n-    @Inject\n-    @ConfigProperty(name = \"kogito.dataindex.ws.url\", defaultValue = \"ws://localhost:8180\")\n-    String dataIndexWsURL;\n-\n-    @Inject\n-    Vertx vertx;\n-\n-    private Buffer resource;\n-\n-    @PostConstruct\n-    public void init() {\n-        try {\n-            resource = Buffer.buffer(vertx.fileSystem()\n-                                             .readFileBlocking(\"META-INF/resources/index.html\")\n-                                             .toString(UTF_8)\n-                                             .replace(\"__GRAPHQL_HTTP_ENDPOINT__\", \"\\\"\" + dataIndexHttpURL + \"/graphql\\\"\")\n-                                             .replace(\"__GRAPHQL_WS_ENDPOINT__\", \"\\\"\" + dataIndexWsURL + \"/graphql\\\"\"));\n-        } catch (Exception e) {\n-            throw new RuntimeException(e);\n-        }\n-    }\n+    Template index;\n \n     void setupRouter(@Observes Router router) {\n         router.route().handler(LoggerHandler.create());\n         router.route().handler(FaviconHandler.create());\n         router.route().handler(StaticHandler.create());\n-        router.route(GET, \"/\").handler(ctx -> ctx.response().end(resource));\n+        String template = index.render();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "originalPosition": 58}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMjY3ODk5", "url": "https://github.com/kiegroup/kogito-examples/pull/487#pullrequestreview-552267899", "createdAt": "2020-12-15T09:41:18Z", "commit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwOTo0MToxOFrOIGBv3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwOTo0MToxOFrOIGBv3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzE5MTAwNQ==", "bodyText": "Nitpicking too.. but could we have graphql as const?", "url": "https://github.com/kiegroup/kogito-examples/pull/487#discussion_r543191005", "createdAt": "2020-12-15T09:41:18Z", "author": {"login": "pefernan"}, "path": "kogito-travel-agency/extended/travels/src/main/resources/templates/index.html", "diffHunk": "@@ -55,7 +71,7 @@ <h1>Travels</h1>\n </div>\n </div>\n <script>\n-    var graphql = __GRAPHQL_HTTP_ENDPOINT__;\n+    var graphql = '{config:property('kogito.dataindex.http.url') or 'http://localhost:8180'}/graphql';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMjY4MjAz", "url": "https://github.com/kiegroup/kogito-examples/pull/487#pullrequestreview-552268203", "createdAt": "2020-12-15T09:41:38Z", "commit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwOTo0MTozOVrOIGBw3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwOTo0MTozOVrOIGBw3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzE5MTI2MA==", "bodyText": "Same", "url": "https://github.com/kiegroup/kogito-examples/pull/487#discussion_r543191260", "createdAt": "2020-12-15T09:41:39Z", "author": {"login": "pefernan"}, "path": "kogito-travel-agency/extended/visas/src/main/resources/templates/index.html", "diffHunk": "@@ -48,7 +64,7 @@ <h1>Visa applications</h1>\n </div>\n </div>\n <script>\n-    var graphql = __GRAPHQL_HTTP_ENDPOINT__;\n+    var graphql = '{config:property('kogito.dataindex.http.url') or 'http://localhost:8180'}/graphql';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fe830e3353905857fc745e722f8663570483691"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7fe830e3353905857fc745e722f8663570483691", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/7fe830e3353905857fc745e722f8663570483691", "committedDate": "2020-12-14T15:37:10Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}, "afterCommit": {"oid": "35422faa9156fbb5ccb737652f8c7170b12a42ef", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/35422faa9156fbb5ccb737652f8c7170b12a42ef", "committedDate": "2020-12-15T11:38:18Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "35422faa9156fbb5ccb737652f8c7170b12a42ef", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/35422faa9156fbb5ccb737652f8c7170b12a42ef", "committedDate": "2020-12-15T11:38:18Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}, "afterCommit": {"oid": "df61ce1e9ae1f51b74378da7d89f5f0482ccb134", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/df61ce1e9ae1f51b74378da7d89f5f0482ccb134", "committedDate": "2020-12-15T11:52:24Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNDQxMTA2", "url": "https://github.com/kiegroup/kogito-examples/pull/487#pullrequestreview-552441106", "createdAt": "2020-12-15T13:21:04Z", "commit": {"oid": "df61ce1e9ae1f51b74378da7d89f5f0482ccb134"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10f79e059c8189729cbfddcd2eea81090deaab04", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/10f79e059c8189729cbfddcd2eea81090deaab04", "committedDate": "2020-12-15T14:24:40Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df61ce1e9ae1f51b74378da7d89f5f0482ccb134", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/df61ce1e9ae1f51b74378da7d89f5f0482ccb134", "committedDate": "2020-12-15T11:52:24Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}, "afterCommit": {"oid": "10f79e059c8189729cbfddcd2eea81090deaab04", "author": {"user": {"login": "cristianonicolai", "name": "Cristiano Nicolai"}}, "url": "https://github.com/kiegroup/kogito-examples/commit/10f79e059c8189729cbfddcd2eea81090deaab04", "committedDate": "2020-12-15T14:24:40Z", "message": "KOGITO-3994 Use Qute templating to handle Data Index config"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyODYzMTQx", "url": "https://github.com/kiegroup/kogito-examples/pull/487#pullrequestreview-552863141", "createdAt": "2020-12-15T20:58:58Z", "commit": {"oid": "10f79e059c8189729cbfddcd2eea81090deaab04"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4305, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}