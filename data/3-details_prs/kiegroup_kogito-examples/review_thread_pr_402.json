{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1OTI4ODQy", "number": 402, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozMDoyM1rOEvSjtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozNToxMlrOEvSrBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDIyNTgwOnYy", "diffSide": "RIGHT", "path": "Jenkinsfile.deploy", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozMDoyM1rOHkL99Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjo0ODozMVrOHkMqbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwNjg2OQ==", "bodyText": "we should delete this before merge IMO", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507706869", "createdAt": "2020-10-19T12:30:23Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -97,7 +98,10 @@ pipeline {\n                         if(params.MAVEN_DEPENDENCIES_REPOSITORY != ''){\n                             sh \"sed -i 's|<repositories>|<repositories><repository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></repository>|g' ${MAVEN_SETTINGS_FILE}\"\n                             sh \"sed -i 's|<pluginRepositories>|<pluginRepositories><pluginRepository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></pluginRepository>|g' ${MAVEN_SETTINGS_FILE}\"\n-                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\" // Done to allow Maven to download release artificats from MAVEN_DEPENDENCIES_REPOSITORY\n+                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\" // Done to allow Maven to download release artifacts from MAVEN_DEPENDENCIES_REPOSITORY\n+\n+                            echo 'Resulting maven settings.xml:'\n+                            sh \"cat ${MAVEN_SETTINGS_FILE}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxNjA3OQ==", "bodyText": "It's easy to it put back. But seeing the content of his file may be handy: I noticed that after rerunning this pipeline (as a stage of the release pipeline), I had the same repository added multiple times. The settings.xml file must have been cached somewhere.", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507716079", "createdAt": "2020-10-19T12:45:26Z", "author": {"login": "rsynek"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -97,7 +98,10 @@ pipeline {\n                         if(params.MAVEN_DEPENDENCIES_REPOSITORY != ''){\n                             sh \"sed -i 's|<repositories>|<repositories><repository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></repository>|g' ${MAVEN_SETTINGS_FILE}\"\n                             sh \"sed -i 's|<pluginRepositories>|<pluginRepositories><pluginRepository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></pluginRepository>|g' ${MAVEN_SETTINGS_FILE}\"\n-                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\" // Done to allow Maven to download release artificats from MAVEN_DEPENDENCIES_REPOSITORY\n+                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\" // Done to allow Maven to download release artifacts from MAVEN_DEPENDENCIES_REPOSITORY\n+\n+                            echo 'Resulting maven settings.xml:'\n+                            sh \"cat ${MAVEN_SETTINGS_FILE}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwNjg2OQ=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxODI1Mw==", "bodyText": "weird as cleanWs() in post -> always should clean it...", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507718253", "createdAt": "2020-10-19T12:48:31Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -97,7 +98,10 @@ pipeline {\n                         if(params.MAVEN_DEPENDENCIES_REPOSITORY != ''){\n                             sh \"sed -i 's|<repositories>|<repositories><repository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></repository>|g' ${MAVEN_SETTINGS_FILE}\"\n                             sh \"sed -i 's|<pluginRepositories>|<pluginRepositories><pluginRepository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></pluginRepository>|g' ${MAVEN_SETTINGS_FILE}\"\n-                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\" // Done to allow Maven to download release artificats from MAVEN_DEPENDENCIES_REPOSITORY\n+                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\" // Done to allow Maven to download release artifacts from MAVEN_DEPENDENCIES_REPOSITORY\n+\n+                            echo 'Resulting maven settings.xml:'\n+                            sh \"cat ${MAVEN_SETTINGS_FILE}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwNjg2OQ=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDIzNDU3OnYy", "diffSide": "RIGHT", "path": "Jenkinsfile.promote", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozMjoyOFrOHkMDIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNjo1NDozMFrOHkYG1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwODE5Mw==", "bodyText": "kogito-runtimes should already be in deployed repository. you should not need them here. they should be downloaded. (staging repository should be promoted to central already)", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507708193", "createdAt": "2020-10-19T12:32:28Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.promote", "diffHunk": "@@ -96,9 +97,14 @@ pipeline {\n             }\n             steps {\n                 script {\n+                    dir('kogito-runtimes') { // kogito-examples depend on kogito-bom", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcxMjQ2NQ==", "bodyText": "Truth; for testing it doesn't work though - the testing nexus would have to be added to the settings.xml for the next build.\nTODO: remove before merging (for testing purpose only)", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507712465", "createdAt": "2020-10-19T12:39:27Z", "author": {"login": "rsynek"}, "path": "Jenkinsfile.promote", "diffHunk": "@@ -96,9 +97,14 @@ pipeline {\n             }\n             steps {\n                 script {\n+                    dir('kogito-runtimes') { // kogito-examples depend on kogito-bom", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwODE5Mw=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwNTc1MQ==", "bodyText": "ah now I understand. there is a bug in runtimes which should deploy snapshot artifact after the set next snapshot ... gonna quickly make a fix ;)", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507905751", "createdAt": "2020-10-19T16:54:30Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.promote", "diffHunk": "@@ -96,9 +97,14 @@ pipeline {\n             }\n             steps {\n                 script {\n+                    dir('kogito-runtimes') { // kogito-examples depend on kogito-bom", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwODE5Mw=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDI0MjgzOnYy", "diffSide": "RIGHT", "path": "Jenkinsfile.deploy", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozNDo0NFrOHkMIPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozNDo0NFrOHkMIPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwOTUwMg==", "bodyText": "maybe we should save to deployment.properties this version if specified", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507709502", "createdAt": "2020-10-19T12:34:44Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -32,6 +32,7 @@ pipeline {\n         // Release information\n         booleanParam(name: 'RELEASE', defaultValue: false, description: 'Is this build for a release?')\n         string(name: 'PROJECT_VERSION', defaultValue: '', description: 'Optional if not RELEASE. If RELEASE, cannot be empty.')\n+        string(name: 'OPTAPLANNER_VERSION', defaultValue: '', description: 'Optional if not RELEASE. If RELEASE, cannot be empty.')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDI0NDUzOnYy", "diffSide": "RIGHT", "path": "Jenkinsfile.deploy", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMjozNToxMlrOHkMJWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQwOTo0MjoyM1rOHkzwXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwOTc4Nw==", "bodyText": "what happen if params.OPTAPLANNER_VERSION is empty ?", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507709787", "createdAt": "2020-10-19T12:35:12Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -112,6 +116,7 @@ pipeline {\n                 dir('kogito-examples') {\n                     script {\n                         maven.mvnVersionsSet(getProjectVersion())\n+                        updateOptaPlannerVersion(getOptaPlannerVersion())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcyMDM1NQ==", "bodyText": "I would love to test if the JBoss Nexus was working. I assume when nothing in, then nothing out, but will test it once it's possible.", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r507720355", "createdAt": "2020-10-19T12:51:37Z", "author": {"login": "rsynek"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -112,6 +116,7 @@ pipeline {\n                 dir('kogito-examples') {\n                     script {\n                         maven.mvnVersionsSet(getProjectVersion())\n+                        updateOptaPlannerVersion(getOptaPlannerVersion())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwOTc4Nw=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODM0ODAzMQ==", "bodyText": "The set-property puts there an empty string if the property is not provided. Added assert to the initialize stage to make sure the property is always set in case of a release.", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r508348031", "createdAt": "2020-10-20T09:26:19Z", "author": {"login": "rsynek"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -112,6 +116,7 @@ pipeline {\n                 dir('kogito-examples') {\n                     script {\n                         maven.mvnVersionsSet(getProjectVersion())\n+                        updateOptaPlannerVersion(getOptaPlannerVersion())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwOTc4Nw=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODM1ODc0OQ==", "bodyText": "I'd rather not have a strong dependency on examples deploy for a release on optaplanner version.\nI would just put an if condition for the update if not empty.\nThis is up to the release (or any calling) pipeline to decide to give the optaplanner version or not.", "url": "https://github.com/kiegroup/kogito-examples/pull/402#discussion_r508358749", "createdAt": "2020-10-20T09:42:23Z", "author": {"login": "radtriste"}, "path": "Jenkinsfile.deploy", "diffHunk": "@@ -112,6 +116,7 @@ pipeline {\n                 dir('kogito-examples') {\n                     script {\n                         maven.mvnVersionsSet(getProjectVersion())\n+                        updateOptaPlannerVersion(getOptaPlannerVersion())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcwOTc4Nw=="}, "originalCommit": {"oid": "b50d245fa6f7a483f8a7e48818b668fb914535ee"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 340, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}