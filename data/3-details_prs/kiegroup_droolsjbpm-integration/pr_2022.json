{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NjE2NDky", "number": 2022, "title": "[JBPM-9015] KIE-Server rendererd forms bind data to incorrect process variable names", "bodyText": "Associate the model with the top nested form field binding name", "createdAt": "2020-02-20T08:25:48Z", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022", "merged": true, "mergeCommit": {"oid": "1b42ad1f1009442f13a500842c97b16e19d06648"}, "closed": true, "closedAt": "2020-03-09T08:37:56Z", "author": {"login": "elguardian"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGHaYrgFqTM2MTczMjM2Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcICUfWAFqTM2NDY5MzE2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzMyMzYz", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#pullrequestreview-361732363", "createdAt": "2020-02-20T09:06:58Z", "commit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowNjo1OFrOFsLQsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowNzo0M1rOFsLSTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjE2Mw==", "bodyText": "could we use this org.kie.server.services.jbpm.ui.form.render.model.FormInstance.getNestedForm(String) instead here?\nmeaning topLevelForm..getNestedForm(form.getId())", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381866163", "createdAt": "2020-02-20T09:06:58Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjU3Mg==", "bodyText": "this would be ideal to be already added to the FormModel class next to classname and name. Have you looked if this can be achieved?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381866572", "createdAt": "2020-02-20T09:07:43Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();\n+            jsonTemplate.append(\"'\");\n+            if (fieldForm.isPresent()) {\n+                jsonTemplate.append(fieldForm.get().getBinding());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7e923ede34e3aed75b2ab133cd2b4c745ec1364", "author": {"user": null}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/c7e923ede34e3aed75b2ab133cd2b4c745ec1364", "committedDate": "2020-02-20T14:27:38Z", "message": "[JBPM-9015] KIE-Server rendererd forms bind data to incorrect process variable names\n\nAssociate the model with the top nested form field binding name"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb", "author": {"user": null}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/1285834db829434f945a93c1cca9b9d60bb807fb", "committedDate": "2020-02-20T08:24:38Z", "message": "[JBPM-9015] KIE-Server rendererd forms bind data to incorrect process variable names\n\nAssociate the model with the top nested form field binding name"}, "afterCommit": {"oid": "c7e923ede34e3aed75b2ab133cd2b4c745ec1364", "author": {"user": null}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/c7e923ede34e3aed75b2ab133cd2b4c745ec1364", "committedDate": "2020-02-20T14:27:38Z", "message": "[JBPM-9015] KIE-Server rendererd forms bind data to incorrect process variable names\n\nAssociate the model with the top nested form field binding name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjkzMTYx", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#pullrequestreview-364693161", "createdAt": "2020-02-26T08:19:40Z", "commit": {"oid": "c7e923ede34e3aed75b2ab133cd2b4c745ec1364"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1353, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}