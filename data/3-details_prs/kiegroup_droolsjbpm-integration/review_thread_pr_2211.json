{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczOTU0NDI3", "number": 2211, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoyNDo0MVrOEgG1Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoyNTozM1rOEgG2lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMTAxODE1OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoyNDo0MVrOHMygCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwOToxODozMFrOHNGS4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3MjM2MQ==", "bodyText": "Not used, remove it", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#discussion_r483172361", "createdAt": "2020-09-03T18:24:41Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "diffHunk": "@@ -101,6 +101,7 @@\n import org.kie.internal.runtime.conf.NamedObjectModel;\n import org.kie.internal.runtime.conf.ObjectModel;\n import org.kie.internal.runtime.conf.RuntimeStrategy;\n+import org.kie.internal.runtime.manager.deploy.DeploymentDescriptorImpl;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ5NjY3Mw==", "bodyText": "done", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#discussion_r483496673", "createdAt": "2020-09-04T09:18:30Z", "author": {"login": "elguardian"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "diffHunk": "@@ -101,6 +101,7 @@\n import org.kie.internal.runtime.conf.NamedObjectModel;\n import org.kie.internal.runtime.conf.ObjectModel;\n import org.kie.internal.runtime.conf.RuntimeStrategy;\n+import org.kie.internal.runtime.manager.deploy.DeploymentDescriptorImpl;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3MjM2MQ=="}, "originalCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMTAyMTY3OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoyNTozM1rOHMyiJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwOToxODoyNVrOHNGSug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3MjkwMA==", "bodyText": "even if the list is empty, add(0, model) would add it in the first position, is this if-else worth it?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#discussion_r483172900", "createdAt": "2020-09-03T18:25:33Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "diffHunk": "@@ -708,12 +709,19 @@ protected void addAsyncHandler(final KModuleDeploymentUnit unit, final InternalK\n     protected void addTaskBAMEventListener(final KModuleDeploymentUnit unit, final InternalKieContainer kieContainer) {\n         final DeploymentDescriptor descriptor = getDeploymentDescriptor(unit, kieContainer);\n         if (descriptor.getAuditMode() != AuditMode.NONE) {\n-            descriptor.getBuilder().addTaskEventListener(\n-                    new ObjectModel(\n+            List<ObjectModel> oldList = descriptor.getTaskEventListeners();\n+            ObjectModel model = new ObjectModel(\n                             \"mvel\",\n                             \"new org.jbpm.services.task.lifecycle.listeners.BAMTaskEventListener(false)\"\n-                    )\n             );\n+            if(!oldList.contains(model)) {\n+                if(!oldList.isEmpty()) {\n+                    oldList.add(0, model);\n+                } else {\n+                    oldList.add(model);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ5NjYzNA==", "bodyText": "done", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#discussion_r483496634", "createdAt": "2020-09-04T09:18:25Z", "author": {"login": "elguardian"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "diffHunk": "@@ -708,12 +709,19 @@ protected void addAsyncHandler(final KModuleDeploymentUnit unit, final InternalK\n     protected void addTaskBAMEventListener(final KModuleDeploymentUnit unit, final InternalKieContainer kieContainer) {\n         final DeploymentDescriptor descriptor = getDeploymentDescriptor(unit, kieContainer);\n         if (descriptor.getAuditMode() != AuditMode.NONE) {\n-            descriptor.getBuilder().addTaskEventListener(\n-                    new ObjectModel(\n+            List<ObjectModel> oldList = descriptor.getTaskEventListeners();\n+            ObjectModel model = new ObjectModel(\n                             \"mvel\",\n                             \"new org.jbpm.services.task.lifecycle.listeners.BAMTaskEventListener(false)\"\n-                    )\n             );\n+            if(!oldList.contains(model)) {\n+                if(!oldList.isEmpty()) {\n+                    oldList.add(0, model);\n+                } else {\n+                    oldList.add(model);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3MjkwMA=="}, "originalCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2084, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}