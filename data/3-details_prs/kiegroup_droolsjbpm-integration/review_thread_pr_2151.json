{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MTYxMTIw", "number": 2151, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODowOToxOVrOEOkyjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDoyMzozNVrOEPJ3Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzE4Mjg2OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-remote/kie-server-client/src/main/java/org/kie/server/client/impl/CaseServicesClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODowOToxOVrOGxzEkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODowOToxOVrOGxzEkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg3MDE2MA==", "bodyText": "Maybe you can reuse the getAdditionalParams method as we have for this as above? Something like below\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (queryString.isEmpty()) {\n          \n          \n            \n                                queryString+= \"?withData=true\";\n          \n          \n            \n                            } else {\n          \n          \n            \n                                queryString+= \"&withData=true\";\n          \n          \n            \n                            }\n          \n          \n            \n                            queryString = getAdditionalParams(queryString, \"withData\", Collections.singletonList(withData));\n          \n      \n    \n    \n  \n\nIf above suggestion is not suitable, then I would suggest to add this check queryString != null in the condition (queryString.isEmpty()), so we make the code more robust. Right now queryString won't be null but maybe in future getAdditionalParams or getSortingQueryString methods may change their implementation and return a null instead.\nWhat do you think?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r454870160", "createdAt": "2020-07-15T08:09:19Z", "author": {"login": "afalhambra"}, "path": "kie-server-parent/kie-server-remote/kie-server-client/src/main/java/org/kie/server/client/impl/CaseServicesClientImpl.java", "diffHunk": "@@ -878,16 +878,26 @@ public void removeComment(String containerId, String caseId, String commentId) {\n         return getCaseInstances(null, page, pageSize, sort, sortOrder);\n     }\n \n-    @Override\n     public List<CaseInstance> getCaseInstances(List<String> status, Integer page, Integer pageSize, String sort, boolean sortOrder) {\n+        return getCaseInstances (status, page, pageSize, sort, sortOrder, false);\n+    }\n+\n+    @Override\n+    public List<CaseInstance> getCaseInstances(List<String> status, Integer page, Integer pageSize, String sort, boolean sortOrder, boolean withData) {\n         CaseInstanceList list = null;\n         if( config.isRest() ) {\n             Map<String, Object> valuesMap = new HashMap<String, Object>();\n \n             String queryString = getPagingQueryString(\"\", page, pageSize);\n             queryString = getAdditionalParams(queryString, \"status\", status);\n             queryString = getSortingQueryString(queryString, sort, sortOrder);\n-\n+            if (withData) {\n+                if (queryString.isEmpty()) {\n+                    queryString+= \"?withData=true\";\n+                } else {\n+                    queryString+= \"&withData=true\";\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cda48fa737b1c6ff3a6d7eb58d75d46fa771e0"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzI2MDg1OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/main/java/org/kie/server/remote/rest/casemgmt/CaseQueryResource.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODoyOTo1MlrOGxz0dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODoyOTo1MlrOGxz0dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4MjQyMg==", "bodyText": "I know you haven't changed this, but I think it's a good chance now to solve this small issue.\nWe are trying to print out 2 values bug we are passing 3 in the log, thus it makes log output not really useful. Should be something like:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    logger.debug(\"About to look for case instances by data item name {} with status {}\", dataItemName, dataItemValue, status);\n          \n          \n            \n                                    logger.debug(\"About to look for case instances by data item name {} with status {}\", dataItemName, status);", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r454882422", "createdAt": "2020-07-15T08:29:52Z", "author": {"login": "afalhambra"}, "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/main/java/org/kie/server/remote/rest/casemgmt/CaseQueryResource.java", "diffHunk": "@@ -120,17 +121,17 @@ public Response getCaseInstances(@javax.ws.rs.core.Context HttpHeaders headers,\n                     CaseInstanceList responseObject = null;\n                     if (dataItemName != null && !dataItemName.isEmpty() && dataItemValue != null && !dataItemValue.isEmpty()) {\n                         logger.debug(\"About to look for case instances by data item name {} and value {} with status {}\", dataItemName, dataItemValue, status);\n-                        responseObject = this.caseManagementRuntimeDataServiceBase.getCaseInstancesByCaseFileData(dataItemName, dataItemValue, status, page, pageSize, sort, sortOrder);\n+                        responseObject = this.caseManagementRuntimeDataServiceBase.getCaseInstancesByCaseFileData(dataItemName, dataItemValue, status, page, pageSize, sort, sortOrder, withData);\n                     } else if (dataItemName != null && !dataItemName.isEmpty()) {\n                         logger.debug(\"About to look for case instances by data item name {} with status {}\", dataItemName, dataItemValue, status);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cda48fa737b1c6ff3a6d7eb58d75d46fa771e0"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzMwMDc3OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/test/java/org/kie/server/remote/rest/casemgmt/CaseQueryResourceTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODo0MDozM1rOGx0NFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDoxNzoyNlrOGx3sOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4ODcyNw==", "bodyText": "This change is not really needed, isn't it?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r454888727", "createdAt": "2020-07-15T08:40:33Z", "author": {"login": "afalhambra"}, "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/test/java/org/kie/server/remote/rest/casemgmt/CaseQueryResourceTest.java", "diffHunk": "@@ -80,10 +81,10 @@ public void testGetCaseInstances(){\n         boolean sortOrder = true;\n         when(runtimeDataService.getCaseInstances(status, page, pageSize, sort, sortOrder)).thenReturn(new CaseInstanceList());\n \n-        caseQueryResource.getCaseInstances(httpHeaders, null, null, null, status, page, pageSize, sort, sortOrder);\n+        caseQueryResource.getCaseInstances(httpHeaders, null, null, null, status, page, pageSize, sort, sortOrder, false);\n \n         verify(kieServerRegistry).getContainer(\"\");\n-        verify(runtimeDataService).getCaseInstancesAnyRole(status, page, pageSize, sort, sortOrder);\n+        verify(runtimeDataService).getCaseInstancesAnyRole(status, page, pageSize, sort, sortOrder, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cda48fa737b1c6ff3a6d7eb58d75d46fa771e0"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk0NTg1MQ==", "bodyText": "no, this is not needed, rolling back to previous one", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r454945851", "createdAt": "2020-07-15T10:17:26Z", "author": {"login": "fjtirado"}, "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/test/java/org/kie/server/remote/rest/casemgmt/CaseQueryResourceTest.java", "diffHunk": "@@ -80,10 +81,10 @@ public void testGetCaseInstances(){\n         boolean sortOrder = true;\n         when(runtimeDataService.getCaseInstances(status, page, pageSize, sort, sortOrder)).thenReturn(new CaseInstanceList());\n \n-        caseQueryResource.getCaseInstances(httpHeaders, null, null, null, status, page, pageSize, sort, sortOrder);\n+        caseQueryResource.getCaseInstances(httpHeaders, null, null, null, status, page, pageSize, sort, sortOrder, false);\n \n         verify(kieServerRegistry).getContainer(\"\");\n-        verify(runtimeDataService).getCaseInstancesAnyRole(status, page, pageSize, sort, sortOrder);\n+        verify(runtimeDataService).getCaseInstancesAnyRole(status, page, pageSize, sort, sortOrder, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4ODcyNw=="}, "originalCommit": {"oid": "65cda48fa737b1c6ff3a6d7eb58d75d46fa771e0"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzM4OTQ2OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-tests/kie-server-integ-tests-all/src/test/java/org/kie/server/integrationtests/jbpm/cases/CaseRuntimeDataServiceIntegrationTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTowMjoyOVrOGx1DRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTowMjoyOVrOGx1DRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwMjU5Nw==", "bodyText": "Maybe it would good to add another test in this class for calling the new overloaded method getCaseInstancesOwnedBy", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r454902597", "createdAt": "2020-07-15T09:02:29Z", "author": {"login": "afalhambra"}, "path": "kie-server-parent/kie-server-tests/kie-server-integ-tests-all/src/test/java/org/kie/server/integrationtests/jbpm/cases/CaseRuntimeDataServiceIntegrationTest.java", "diffHunk": "@@ -525,6 +525,20 @@ public void testGetCaseInstancesByStatusSorting() {\n         assertEquals(hrCaseId, caseInstances.get(0).getCaseId());\n         assertEquals(claimCaseId, caseInstances.get(1).getCaseId());\n     }\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cda48fa737b1c6ff3a6d7eb58d75d46fa771e0"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzQwOTU2OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/test/java/org/kie/server/remote/rest/casemgmt/CaseQueryResourceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTowODoxMlrOGx1QAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTowODoxMlrOGx1QAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwNTg1Ng==", "bodyText": "I think it would be good to add a test method here for calling method getCaseInstances for calling the underling new overloaded method getCaseInstancesAnyRole withData=true", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r454905856", "createdAt": "2020-07-15T09:08:12Z", "author": {"login": "afalhambra"}, "path": "kie-server-parent/kie-server-remote/kie-server-rest/kie-server-rest-case-mgmt/src/test/java/org/kie/server/remote/rest/casemgmt/CaseQueryResourceTest.java", "diffHunk": "@@ -17,10 +17,10 @@\n package org.kie.server.remote.rest.casemgmt;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cda48fa737b1c6ff3a6d7eb58d75d46fa771e0"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MzI1NTA1OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-remote/kie-server-client/src/main/java/org/kie/server/client/impl/CaseServicesClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDoyMzoxNFrOGytYXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDoyMzoxNFrOGytYXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgyNTUwMA==", "bodyText": "Arrays should not be created for varargs parameters\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                (KieServerCommand) new DescriptorCommand(\"CaseQueryService\", \"getCaseInstancesAnyRole\", new Object[]{safeList(status), page, pageSize, sort, sortOrder, withData})) );\n          \n          \n            \n                                (KieServerCommand) new DescriptorCommand(\"CaseQueryService\", \"getCaseInstancesAnyRole\", safeList(status), page, pageSize, sort, sortOrder, withData)) );", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r455825500", "createdAt": "2020-07-16T14:23:14Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-remote/kie-server-client/src/main/java/org/kie/server/client/impl/CaseServicesClientImpl.java", "diffHunk": "@@ -878,22 +878,26 @@ public void removeComment(String containerId, String caseId, String commentId) {\n         return getCaseInstances(null, page, pageSize, sort, sortOrder);\n     }\n \n-    @Override\n     public List<CaseInstance> getCaseInstances(List<String> status, Integer page, Integer pageSize, String sort, boolean sortOrder) {\n+        return getCaseInstances (status, page, pageSize, sort, sortOrder, false);\n+    }\n+\n+    @Override\n+    public List<CaseInstance> getCaseInstances(List<String> status, Integer page, Integer pageSize, String sort, boolean sortOrder, boolean withData) {\n         CaseInstanceList list = null;\n         if( config.isRest() ) {\n             Map<String, Object> valuesMap = new HashMap<String, Object>();\n \n             String queryString = getPagingQueryString(\"\", page, pageSize);\n             queryString = getAdditionalParams(queryString, \"status\", status);\n             queryString = getSortingQueryString(queryString, sort, sortOrder);\n-\n+            queryString = getAdditionalParams(queryString, \"withData\", Collections.singletonList(withData));\n             list = makeHttpGetRequestAndCreateCustomResponse(\n                     build(loadBalancer.getUrl(), CASE_QUERY_URI + \"/\" + CASE_ALL_INSTANCES_GET_URI, valuesMap) + queryString, CaseInstanceList.class);\n \n         } else {\n             CommandScript script = new CommandScript( Collections.singletonList(\n-                    (KieServerCommand) new DescriptorCommand(\"CaseQueryService\", \"getCaseInstancesAnyRole\", new Object[]{safeList(status), page, pageSize, sort, sortOrder})) );\n+                    (KieServerCommand) new DescriptorCommand(\"CaseQueryService\", \"getCaseInstancesAnyRole\", new Object[]{safeList(status), page, pageSize, sort, sortOrder, withData})) );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2335c9836cd61782e8b9fbf6d2b008c5118750d"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MzI1NjU4OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-remote/kie-server-client/src/main/java/org/kie/server/client/impl/CaseServicesClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDoyMzozNVrOGytZUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDoyMzozNVrOGytZUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgyNTc0NA==", "bodyText": "Same here", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2151#discussion_r455825744", "createdAt": "2020-07-16T14:23:35Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-remote/kie-server-client/src/main/java/org/kie/server/client/impl/CaseServicesClientImpl.java", "diffHunk": "@@ -918,20 +922,26 @@ public void removeComment(String containerId, String caseId, String commentId) {\n \n     @Override\n     public List<CaseInstance> getCaseInstancesOwnedBy(String owner, List<String> status, Integer page, Integer pageSize, String sort, boolean sortOrder) {\n+        return getCaseInstancesOwnedBy(owner, status, page, pageSize, sort,  sortOrder, false);\n+    }\n+\n+    @Override\n+    public List<CaseInstance> getCaseInstancesOwnedBy(String owner, List<String> status, Integer page, Integer pageSize, String sort, boolean sortOrder, boolean withData) {\n         CaseInstanceList list = null;\n         if( config.isRest() ) {\n             Map<String, Object> valuesMap = new HashMap<String, Object>();\n \n             String queryString = getPagingQueryString(\"?owner=\"+owner, page, pageSize);\n             queryString = getAdditionalParams(queryString, \"status\", status);\n             queryString = getSortingQueryString(queryString, sort, sortOrder);\n+            queryString = getAdditionalParams(queryString, \"withData\", Collections.singletonList(withData));\n \n             list = makeHttpGetRequestAndCreateCustomResponse(\n                     build(loadBalancer.getUrl(), CASE_QUERY_URI + \"/\" + CASE_ALL_INSTANCES_GET_URI, valuesMap) + queryString, CaseInstanceList.class);\n \n         } else {\n             CommandScript script = new CommandScript( Collections.singletonList(\n-                    (KieServerCommand) new DescriptorCommand(\"CaseQueryService\", \"getCaseInstancesOwnedBy\", new Object[]{owner, safeList(status), page, pageSize, sort, sortOrder})) );\n+                    (KieServerCommand) new DescriptorCommand(\"CaseQueryService\", \"getCaseInstancesOwnedBy\", new Object[]{owner, safeList(status), page, pageSize, sort, sortOrder, withData})) );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2335c9836cd61782e8b9fbf6d2b008c5118750d"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2035, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}