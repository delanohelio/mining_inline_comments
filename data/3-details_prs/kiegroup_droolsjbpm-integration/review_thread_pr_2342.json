{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxMjc0NjIy", "number": 2342, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOTo0NjoyMVrOFGngaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOTo0NjoyMVrOFGngaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDgzMDQ5OnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-services/kie-server-services-kafka/src/main/java/org/kie/server/services/jbpm/kafka/KafkaServerExtension.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOTo0NjoyMVrOIHtIFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNjozNjo0NVrOIH-R2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDk1MDI5NQ==", "bodyText": "This change tries to cover an edge case. System property enable when onDeploy/onActivate is called, but disable when onUndeploy/onDeactivate is invoked. This will  leak to a subscripton \"leak\". In order to avoid that, at the cost of sacrificing a bit of performance (not much in any case), it is better to clean always", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2342#discussion_r544950295", "createdAt": "2020-12-17T09:46:21Z", "author": {"login": "fjtirado"}, "path": "kie-server-parent/kie-server-services/kie-server-services-kafka/src/main/java/org/kie/server/services/jbpm/kafka/KafkaServerExtension.java", "diffHunk": "@@ -272,12 +264,8 @@ private void updateTopics(String deploymentId, ProcessDefinition processDefiniti\n     }\n \n     private void removeTopics(String deploymentId, ProcessDefinition processDefinition) {\n-        if (processSignals()) {\n-            removeTopics(topic2Signal, deploymentId, processDefinition.getSignalsDesc());\n-        }\n-        if (processMessages()) {\n-            removeTopics(topic2Message, deploymentId, processDefinition.getMessagesDesc());\n-        }\n+        removeTopics(topic2Signal, deploymentId, processDefinition.getSignalsDesc());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "349283d4cd378f75d2d5731528375ee44caec570"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTIzMTMyMw==", "bodyText": "OK, agreed; it's very weird but not impossible. Anyway, performance impact is minimum and removing topics is during undeployment.", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2342#discussion_r545231323", "createdAt": "2020-12-17T16:36:45Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-services/kie-server-services-kafka/src/main/java/org/kie/server/services/jbpm/kafka/KafkaServerExtension.java", "diffHunk": "@@ -272,12 +264,8 @@ private void updateTopics(String deploymentId, ProcessDefinition processDefiniti\n     }\n \n     private void removeTopics(String deploymentId, ProcessDefinition processDefinition) {\n-        if (processSignals()) {\n-            removeTopics(topic2Signal, deploymentId, processDefinition.getSignalsDesc());\n-        }\n-        if (processMessages()) {\n-            removeTopics(topic2Message, deploymentId, processDefinition.getMessagesDesc());\n-        }\n+        removeTopics(topic2Signal, deploymentId, processDefinition.getSignalsDesc());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDk1MDI5NQ=="}, "originalCommit": {"oid": "349283d4cd378f75d2d5731528375ee44caec570"}, "originalPosition": 63}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1897, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}