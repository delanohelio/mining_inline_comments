{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczOTU0NDI3", "number": 2211, "title": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from t\u2026", "bodyText": "Jira: https://issues.redhat.com/browse/JBPM-9310", "createdAt": "2020-08-26T14:40:09Z", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211", "merged": true, "mergeCommit": {"oid": "1d4d22c37101f81f280a5d61f2bd62e6ee5ae10c"}, "closed": true, "closedAt": "2020-09-07T09:47:45Z", "author": {"login": "elguardian"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEiGreAH2gAyNDczOTU0NDI3OmVkY2NmNzdmZDYwMTc4NTk3MTY1OGJjZDFjZWU2ZWFkYzBlMjgzNjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFVBArAFqTQ4MjEwNDk2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368", "author": {"user": null}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/edccf77fd601785971658bcd1cee6eadc0e28368", "committedDate": "2020-09-01T07:17:00Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b44fafcc995598a7b43c8a2e1afa6e002bfb857f", "author": {"user": null}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/b44fafcc995598a7b43c8a2e1afa6e002bfb857f", "committedDate": "2020-08-26T14:38:52Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}, "afterCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368", "author": {"user": null}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/edccf77fd601785971658bcd1cee6eadc0e28368", "committedDate": "2020-09-01T07:17:00Z", "message": "[JBPM-9310] Warning in BAMTaskEventListener if task is skipped from task event listener"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNzUxMjEy", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#pullrequestreview-480751212", "createdAt": "2020-09-02T12:05:07Z", "commit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDk0NjEw", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#pullrequestreview-482094610", "createdAt": "2020-09-03T18:24:41Z", "commit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoyNDo0MVrOHMygCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODoyNTozM1rOHMyiJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3MjM2MQ==", "bodyText": "Not used, remove it", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#discussion_r483172361", "createdAt": "2020-09-03T18:24:41Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "diffHunk": "@@ -101,6 +101,7 @@\n import org.kie.internal.runtime.conf.NamedObjectModel;\n import org.kie.internal.runtime.conf.ObjectModel;\n import org.kie.internal.runtime.conf.RuntimeStrategy;\n+import org.kie.internal.runtime.manager.deploy.DeploymentDescriptorImpl;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3MjkwMA==", "bodyText": "even if the list is empty, add(0, model) would add it in the first position, is this if-else worth it?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#discussion_r483172900", "createdAt": "2020-09-03T18:25:33Z", "author": {"login": "gmunozfe"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm/src/main/java/org/kie/server/services/jbpm/JbpmKieServerExtension.java", "diffHunk": "@@ -708,12 +709,19 @@ protected void addAsyncHandler(final KModuleDeploymentUnit unit, final InternalK\n     protected void addTaskBAMEventListener(final KModuleDeploymentUnit unit, final InternalKieContainer kieContainer) {\n         final DeploymentDescriptor descriptor = getDeploymentDescriptor(unit, kieContainer);\n         if (descriptor.getAuditMode() != AuditMode.NONE) {\n-            descriptor.getBuilder().addTaskEventListener(\n-                    new ObjectModel(\n+            List<ObjectModel> oldList = descriptor.getTaskEventListeners();\n+            ObjectModel model = new ObjectModel(\n                             \"mvel\",\n                             \"new org.jbpm.services.task.lifecycle.listeners.BAMTaskEventListener(false)\"\n-                    )\n             );\n+            if(!oldList.contains(model)) {\n+                if(!oldList.isEmpty()) {\n+                    oldList.add(0, model);\n+                } else {\n+                    oldList.add(model);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMTA0OTY0", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2211#pullrequestreview-482104964", "createdAt": "2020-09-03T18:35:58Z", "commit": {"oid": "edccf77fd601785971658bcd1cee6eadc0e28368"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1341, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}