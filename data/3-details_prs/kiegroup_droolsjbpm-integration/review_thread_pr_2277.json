{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNjE4MTI0", "number": 2277, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMDowNlrOEss3TA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTo1ODozNlrOEtjeeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MzA3ODUyOnYy", "diffSide": "RIGHT", "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/GenerateANCMojo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMDowNlrOHgFjOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMDowNlrOHgFjOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwNzQxOA==", "bodyText": "you might want to \"move up\" similarly to here: \n  \n    \n      droolsjbpm-integration/kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java\n    \n    \n        Lines 63 to 68\n      in\n      32f44c7\n    \n    \n    \n    \n\n        \n          \n           @Parameter(property = \"validateDMN\", defaultValue = \"VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE\") \n        \n\n        \n          \n           private String validateDMN; \n        \n\n        \n          \n            \n        \n\n        \n          \n           protected String getValidateDMN() { \n        \n\n        \n          \n               return validateDMN; \n        \n\n        \n          \n           }", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503407418", "createdAt": "2020-10-12T16:30:06Z", "author": {"login": "tarilabs"}, "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/GenerateANCMojo.java", "diffHunk": "@@ -0,0 +1,192 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.maven.plugin;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.nio.file.StandardOpenOption;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.apache.maven.artifact.Artifact;\n+import org.apache.maven.artifact.DependencyResolutionRequiredException;\n+import org.apache.maven.artifact.resolver.filter.CumulativeScopeArtifactFilter;\n+import org.apache.maven.execution.MavenSession;\n+import org.apache.maven.plugin.MojoExecutionException;\n+import org.apache.maven.plugins.annotations.LifecyclePhase;\n+import org.apache.maven.plugins.annotations.Mojo;\n+import org.apache.maven.plugins.annotations.Parameter;\n+import org.apache.maven.plugins.annotations.ResolutionScope;\n+import org.apache.maven.project.MavenProject;\n+import org.drools.ancompiler.CompiledNetworkSource;\n+import org.drools.ancompiler.ObjectTypeNodeCompiler;\n+import org.drools.compiler.kproject.ReleaseIdImpl;\n+import org.drools.core.impl.InternalKnowledgeBase;\n+import org.drools.modelcompiler.CanonicalKieModule;\n+import org.kie.api.KieServices;\n+import org.kie.api.runtime.KieContainer;\n+\n+import static org.kie.maven.plugin.ExecModelMode.ancEnabled;\n+import static org.kie.maven.plugin.ExecModelMode.isModelCompilerInClassPath;\n+\n+@Mojo(name = \"generateANC\",\n+        requiresDependencyResolution = ResolutionScope.NONE,\n+        defaultPhase = LifecyclePhase.COMPILE)\n+public class GenerateANCMojo extends AbstractDMNValidationAwareMojo {\n+\n+    @Parameter(defaultValue = \"${session}\", required = true, readonly = true)\n+    private MavenSession mavenSession;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.directory}\")\n+    private File targetDirectory;\n+\n+    @Parameter(required = true, defaultValue = \"${project.basedir}\")\n+    private File projectDir;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.testSourceDirectory}\")\n+    private File testDir;\n+\n+    @Parameter\n+    private Map<String, String> properties;\n+\n+    @Parameter(required = true, defaultValue = \"${project}\")\n+    private MavenProject project;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.outputDirectory}\")\n+    private File outputDirectory;\n+\n+    @Parameter(property = \"generateModel\", defaultValue = \"YES_WITHDRL\")\n+    private String generateModel;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MzA4MTU5OnYy", "diffSide": "LEFT", "path": "kie-plugins-testing/src/test/projects/kjar-9-declared-types/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMTowMFrOHgFlLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMTowMFrOHgFlLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwNzkxOA==", "bodyText": "this file modification is not necessary", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503407918", "createdAt": "2020-10-12T16:31:00Z", "author": {"login": "tarilabs"}, "path": "kie-plugins-testing/src/test/projects/kjar-9-declared-types/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <maven.compiler.source>1.8</maven.compiler.source>\n     <maven.compiler.target>1.8</maven.compiler.target>\n   </properties>\n-  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MzA4Mjk0OnYy", "diffSide": "RIGHT", "path": "kie-plugins-testing/src/test/resources/logback-test.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMToyN1rOHgFmBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODoyMTozMlrOHhHrhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwODEzNA==", "bodyText": "are you sure you want to leave this as debug?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              <logger name=\"org.drools.ancompiler\" level=\"debug\"/>\n          \n          \n            \n              <logger name=\"org.drools.ancompiler\" level=\"INFO\"/>", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503408134", "createdAt": "2020-10-12T16:31:27Z", "author": {"login": "tarilabs"}, "path": "kie-plugins-testing/src/test/resources/logback-test.xml", "diffHunk": "@@ -12,6 +12,7 @@\n \n   <logger name=\"org.drools.compiler.xpath.tobeinstrumented\" level=\"INFO\"/>\n   <logger name=\"org.kie\" level=\"INFO\"/>\n+  <logger name=\"org.drools.ancompiler\" level=\"debug\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5MDg4Nw==", "bodyText": "Yes it doesn't generate much output", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r504490887", "createdAt": "2020-10-14T08:21:32Z", "author": {"login": "lucamolteni"}, "path": "kie-plugins-testing/src/test/resources/logback-test.xml", "diffHunk": "@@ -12,6 +12,7 @@\n \n   <logger name=\"org.drools.compiler.xpath.tobeinstrumented\" level=\"INFO\"/>\n   <logger name=\"org.kie\" level=\"INFO\"/>\n+  <logger name=\"org.drools.ancompiler\" level=\"debug\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwODEzNA=="}, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NTM5MDAwOnYy", "diffSide": "RIGHT", "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODoxOTozOFrOHga6zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODoxOTozOFrOHga6zQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc1NzUxNw==", "bodyText": "please 1 move up more. This class is called ...DMNValidationAware...\nKindly consider move this stuff up to AbstractKieMojo", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503757517", "createdAt": "2020-10-13T08:19:38Z", "author": {"login": "tarilabs"}, "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java", "diffHunk": "@@ -63,10 +65,21 @@\n     @Parameter(property = \"validateDMN\", defaultValue = \"VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE\")\n     private String validateDMN;\n \n+    @Parameter(property = \"generateModel\", defaultValue = \"YES_WITHDRL\") // DROOLS-5663 align kie-maven-plugin default value for generateModel configuration flag\n+    private String generateModel;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c8b5bf3e33c9174311569ab8153ef52892c669f"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2MjAyNjE2OnYy", "diffSide": "RIGHT", "path": "kie-maven-plugin/src/main/resources/META-INF/plexus/components.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTo1ODozNlrOHhaKXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwOTowNjowNlrOHh90eA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc5MzY5Mg==", "bodyText": "Are you sure build is not the last one?\nBtw I think we should review this mechanism, now we have three maven:compile steps \ud83e\udd14", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r504793692", "createdAt": "2020-10-14T15:58:36Z", "author": {"login": "danielezonca"}, "path": "kie-maven-plugin/src/main/resources/META-INF/plexus/components.xml", "diffHunk": "@@ -9,7 +9,16 @@\n             <configuration>\n                 <phases>\n                     <process-resources>org.apache.maven.plugins:maven-resources-plugin:resources,org.kie:kie-maven-plugin:validateDMN</process-resources>\n-                    <compile>org.apache.maven.plugins:maven-compiler-plugin:compile,org.kie:kie-maven-plugin:generateModel,org.kie:kie-maven-plugin:generateDMNModel,org.kie:kie-maven-plugin:generatePMMLModel,org.apache.maven.plugins:maven-compiler-plugin:compile,org.kie:kie-maven-plugin:build</compile>\n+                    <compile>\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile,\n+                        org.kie:kie-maven-plugin:generateModel,\n+                        org.kie:kie-maven-plugin:generateDMNModel,\n+                        org.kie:kie-maven-plugin:generatePMMLModel,\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile,\n+                        org.kie:kie-maven-plugin:build,\n+                        org.kie:kie-maven-plugin:generateANC,\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTM3NzkxMg==", "bodyText": "I know, but unfortunately ANC compiler needs the rete and the rete is only created at runtime. Then it has to generate those classes and compile them.", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r505377912", "createdAt": "2020-10-15T09:06:06Z", "author": {"login": "lucamolteni"}, "path": "kie-maven-plugin/src/main/resources/META-INF/plexus/components.xml", "diffHunk": "@@ -9,7 +9,16 @@\n             <configuration>\n                 <phases>\n                     <process-resources>org.apache.maven.plugins:maven-resources-plugin:resources,org.kie:kie-maven-plugin:validateDMN</process-resources>\n-                    <compile>org.apache.maven.plugins:maven-compiler-plugin:compile,org.kie:kie-maven-plugin:generateModel,org.kie:kie-maven-plugin:generateDMNModel,org.kie:kie-maven-plugin:generatePMMLModel,org.apache.maven.plugins:maven-compiler-plugin:compile,org.kie:kie-maven-plugin:build</compile>\n+                    <compile>\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile,\n+                        org.kie:kie-maven-plugin:generateModel,\n+                        org.kie:kie-maven-plugin:generateDMNModel,\n+                        org.kie:kie-maven-plugin:generatePMMLModel,\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile,\n+                        org.kie:kie-maven-plugin:build,\n+                        org.kie:kie-maven-plugin:generateANC,\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc5MzY5Mg=="}, "originalCommit": {"oid": "9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1967, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}