{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NjE2NDky", "number": 2022, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowNjo1OFrODhcYIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowNzo0M1rODhcZOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2Mzk0NTMwOnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowNjo1OFrOFsLQsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNDoxODozNFrOFsVDPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjE2Mw==", "bodyText": "could we use this org.kie.server.services.jbpm.ui.form.render.model.FormInstance.getNestedForm(String) instead here?\nmeaning topLevelForm..getNestedForm(form.getId())", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381866163", "createdAt": "2020-02-20T09:06:58Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg5NjQwMg==", "bodyText": "I am lost with this comment.\nfieldForm.getNestedForm().equals(form.getId()) is not equivalent to\ntopLevelForm..getNestedForm(form.getId())\nwhat exactly you want to change ?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381896402", "createdAt": "2020-02-20T10:00:35Z", "author": {"login": "elguardian"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjE2Mw=="}, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk1MDYwNw==", "bodyText": "wouldn't getNestedForm return the form or null for given formId? U mean to replace the entire stream, filter, etc", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381950607", "createdAt": "2020-02-20T11:48:27Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjE2Mw=="}, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyNTU3MA==", "bodyText": "The idea is to find the binding in the top level form. Each field has the nested form id that belongs to (AFAIK)", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r382025570", "createdAt": "2020-02-20T14:16:58Z", "author": {"login": "elguardian"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjE2Mw=="}, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyNjU1OA==", "bodyText": "there should be a resolver that can look through all children forms so might be able to find any that is defined for the top level one", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r382026558", "createdAt": "2020-02-20T14:18:34Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjE2Mw=="}, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2Mzk0ODEwOnYy", "diffSide": "RIGHT", "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowNzo0M1rOFsLSTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMTo0ODo0NFrOFsQbMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjU3Mg==", "bodyText": "this would be ideal to be already added to the FormModel class next to classname and name. Have you looked if this can be achieved?", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381866572", "createdAt": "2020-02-20T09:07:43Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();\n+            jsonTemplate.append(\"'\");\n+            if (fieldForm.isPresent()) {\n+                jsonTemplate.append(fieldForm.get().getBinding());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg5NjY2MA==", "bodyText": "The problem is that FormModel is \"clean\" in the sense that the binding is introduced in the top level form and not here so you only have local information. Those comes from unmarshalling files.", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381896660", "createdAt": "2020-02-20T10:01:03Z", "author": {"login": "elguardian"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();\n+            jsonTemplate.append(\"'\");\n+            if (fieldForm.isPresent()) {\n+                jsonTemplate.append(fieldForm.get().getBinding());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjU3Mg=="}, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk1MDc3MA==", "bodyText": "ok, fair enough", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2022#discussion_r381950770", "createdAt": "2020-02-20T11:48:44Z", "author": {"login": "mswiderski"}, "path": "kie-server-parent/kie-server-services/kie-server-services-jbpm-ui/src/main/java/org/kie/server/services/jbpm/ui/form/render/AbstractFormRenderer.java", "diffHunk": "@@ -293,16 +293,21 @@ protected void processFormLayout(FormInstance topLevelForm,\n             List<String> scriptDataList) {\n         FormLayout layout = form.getLayout();\n         \n+\n         if (form.getModel().getClassName() != null && wrapJson) {\n-            jsonTemplate                \n-                .append(\"'\")\n-                .append(form.getModel().getName())\n-                .append(\"' : \")\n-                .append(\"{\")\n-                .append(\"'\")\n-                .append(form.getModel().getClassName())                \n-                .append(\"' : \")\n-                .append(\"{\");\n+            Optional<FormField> fieldForm = topLevelForm.getFields().stream().filter(e -> e.getNestedForm().equals(form.getId())).findAny();\n+            jsonTemplate.append(\"'\");\n+            if (fieldForm.isPresent()) {\n+                jsonTemplate.append(fieldForm.get().getBinding());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NjU3Mg=="}, "originalCommit": {"oid": "1285834db829434f945a93c1cca9b9d60bb807fb"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2093, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}