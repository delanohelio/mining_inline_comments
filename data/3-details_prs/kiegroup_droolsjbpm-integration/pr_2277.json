{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNjE4MTI0", "number": 2277, "title": "[DROOLS-5658] [DROOLS-4844] [DROOLS-5657] [DROOLS-2836] [DROOLS-5699] ", "bodyText": "Thank you for submitting this pull request\nJIRA: (please edit the JIRA link if it exists)\nhttps://issues.redhat.com/browse/DROOLS-5658\nhttps://issues.redhat.com/browse/DROOLS-2836\nhttps://issues.redhat.com/browse/DROOLS-5657\nhttps://issues.redhat.com/browse/DROOLS-4844\nreferenced Pull Requests: (please edit the URLs of referenced pullrequests if they exist)\nkiegroup/droolsjbpm-build-bootstrap#1498\nkiegroup/drools#3159\nkiegroup/droolsjbpm-knowledge#471\n#2277\n\n\nHow to retest this PR or trigger a specific build:\n\n\n\na pull request please add comment: Jenkins retest this\n\n\na full downstream build please add comment: Jenkins run fdb\n\n\na compile downstream build please  add comment: Jenkins run cdb\n\n\na full production downstream build please add comment: Jenkins execute product fdb\n\n\nan upstream build please add comment: Jenkins run upstream", "createdAt": "2020-10-12T14:33:02Z", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277", "merged": true, "mergeCommit": {"oid": "b42772a53bece9d1b62f1839d3b6a03803022ab4"}, "closed": true, "closedAt": "2020-10-15T15:42:35Z", "author": {"login": "lucamolteni"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR2o29gFqTUwNjc2Mzk1NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSx85QAFqTUwOTM4OTYxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzYzOTU0", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-506763954", "createdAt": "2020-10-12T16:30:05Z", "commit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMDowNlrOHgFjOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjozMToyN1rOHgFmBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwNzQxOA==", "bodyText": "you might want to \"move up\" similarly to here: \n  \n    \n      droolsjbpm-integration/kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java\n    \n    \n        Lines 63 to 68\n      in\n      32f44c7\n    \n    \n    \n    \n\n        \n          \n           @Parameter(property = \"validateDMN\", defaultValue = \"VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE\") \n        \n\n        \n          \n           private String validateDMN; \n        \n\n        \n          \n            \n        \n\n        \n          \n           protected String getValidateDMN() { \n        \n\n        \n          \n               return validateDMN; \n        \n\n        \n          \n           }", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503407418", "createdAt": "2020-10-12T16:30:06Z", "author": {"login": "tarilabs"}, "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/GenerateANCMojo.java", "diffHunk": "@@ -0,0 +1,192 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.maven.plugin;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.nio.file.StandardOpenOption;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.apache.maven.artifact.Artifact;\n+import org.apache.maven.artifact.DependencyResolutionRequiredException;\n+import org.apache.maven.artifact.resolver.filter.CumulativeScopeArtifactFilter;\n+import org.apache.maven.execution.MavenSession;\n+import org.apache.maven.plugin.MojoExecutionException;\n+import org.apache.maven.plugins.annotations.LifecyclePhase;\n+import org.apache.maven.plugins.annotations.Mojo;\n+import org.apache.maven.plugins.annotations.Parameter;\n+import org.apache.maven.plugins.annotations.ResolutionScope;\n+import org.apache.maven.project.MavenProject;\n+import org.drools.ancompiler.CompiledNetworkSource;\n+import org.drools.ancompiler.ObjectTypeNodeCompiler;\n+import org.drools.compiler.kproject.ReleaseIdImpl;\n+import org.drools.core.impl.InternalKnowledgeBase;\n+import org.drools.modelcompiler.CanonicalKieModule;\n+import org.kie.api.KieServices;\n+import org.kie.api.runtime.KieContainer;\n+\n+import static org.kie.maven.plugin.ExecModelMode.ancEnabled;\n+import static org.kie.maven.plugin.ExecModelMode.isModelCompilerInClassPath;\n+\n+@Mojo(name = \"generateANC\",\n+        requiresDependencyResolution = ResolutionScope.NONE,\n+        defaultPhase = LifecyclePhase.COMPILE)\n+public class GenerateANCMojo extends AbstractDMNValidationAwareMojo {\n+\n+    @Parameter(defaultValue = \"${session}\", required = true, readonly = true)\n+    private MavenSession mavenSession;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.directory}\")\n+    private File targetDirectory;\n+\n+    @Parameter(required = true, defaultValue = \"${project.basedir}\")\n+    private File projectDir;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.testSourceDirectory}\")\n+    private File testDir;\n+\n+    @Parameter\n+    private Map<String, String> properties;\n+\n+    @Parameter(required = true, defaultValue = \"${project}\")\n+    private MavenProject project;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.outputDirectory}\")\n+    private File outputDirectory;\n+\n+    @Parameter(property = \"generateModel\", defaultValue = \"YES_WITHDRL\")\n+    private String generateModel;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwNzkxOA==", "bodyText": "this file modification is not necessary", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503407918", "createdAt": "2020-10-12T16:31:00Z", "author": {"login": "tarilabs"}, "path": "kie-plugins-testing/src/test/projects/kjar-9-declared-types/pom.xml", "diffHunk": "@@ -29,7 +29,7 @@\n     <maven.compiler.source>1.8</maven.compiler.source>\n     <maven.compiler.target>1.8</maven.compiler.target>\n   </properties>\n-  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwODEzNA==", "bodyText": "are you sure you want to leave this as debug?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              <logger name=\"org.drools.ancompiler\" level=\"debug\"/>\n          \n          \n            \n              <logger name=\"org.drools.ancompiler\" level=\"INFO\"/>", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503408134", "createdAt": "2020-10-12T16:31:27Z", "author": {"login": "tarilabs"}, "path": "kie-plugins-testing/src/test/resources/logback-test.xml", "diffHunk": "@@ -12,6 +12,7 @@\n \n   <logger name=\"org.drools.compiler.xpath.tobeinstrumented\" level=\"INFO\"/>\n   <logger name=\"org.kie\" level=\"INFO\"/>\n+  <logger name=\"org.drools.ancompiler\" level=\"debug\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MTgyODU0", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-507182854", "createdAt": "2020-10-13T08:19:38Z", "commit": {"oid": "6c8b5bf3e33c9174311569ab8153ef52892c669f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODoxOTozOFrOHga6zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODoxOTozOFrOHga6zQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc1NzUxNw==", "bodyText": "please 1 move up more. This class is called ...DMNValidationAware...\nKindly consider move this stuff up to AbstractKieMojo", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503757517", "createdAt": "2020-10-13T08:19:38Z", "author": {"login": "tarilabs"}, "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java", "diffHunk": "@@ -63,10 +65,21 @@\n     @Parameter(property = \"validateDMN\", defaultValue = \"VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE\")\n     private String validateDMN;\n \n+    @Parameter(property = \"generateModel\", defaultValue = \"YES_WITHDRL\") // DROOLS-5663 align kie-maven-plugin default value for generateModel configuration flag\n+    private String generateModel;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c8b5bf3e33c9174311569ab8153ef52892c669f"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDk4OTky", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-508098992", "createdAt": "2020-10-14T08:13:50Z", "commit": {"oid": "6c8b5bf3e33c9174311569ab8153ef52892c669f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MTQ3NTAy", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-508147502", "createdAt": "2020-10-14T09:12:10Z", "commit": {"oid": "6c8b5bf3e33c9174311569ab8153ef52892c669f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MjkxODQz", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-508291843", "createdAt": "2020-10-14T12:29:15Z", "commit": {"oid": "9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NDk5MTk2", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-508499196", "createdAt": "2020-10-14T15:58:36Z", "commit": {"oid": "9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTo1ODozNlrOHhaKXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNTo1ODozNlrOHhaKXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc5MzY5Mg==", "bodyText": "Are you sure build is not the last one?\nBtw I think we should review this mechanism, now we have three maven:compile steps \ud83e\udd14", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r504793692", "createdAt": "2020-10-14T15:58:36Z", "author": {"login": "danielezonca"}, "path": "kie-maven-plugin/src/main/resources/META-INF/plexus/components.xml", "diffHunk": "@@ -9,7 +9,16 @@\n             <configuration>\n                 <phases>\n                     <process-resources>org.apache.maven.plugins:maven-resources-plugin:resources,org.kie:kie-maven-plugin:validateDMN</process-resources>\n-                    <compile>org.apache.maven.plugins:maven-compiler-plugin:compile,org.kie:kie-maven-plugin:generateModel,org.kie:kie-maven-plugin:generateDMNModel,org.kie:kie-maven-plugin:generatePMMLModel,org.apache.maven.plugins:maven-compiler-plugin:compile,org.kie:kie-maven-plugin:build</compile>\n+                    <compile>\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile,\n+                        org.kie:kie-maven-plugin:generateModel,\n+                        org.kie:kie-maven-plugin:generateDMNModel,\n+                        org.kie:kie-maven-plugin:generatePMMLModel,\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile,\n+                        org.kie:kie-maven-plugin:build,\n+                        org.kie:kie-maven-plugin:generateANC,\n+                        org.apache.maven.plugins:maven-compiler-plugin:compile", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95b12462c084b47abd6d6a11bd0d65042a598bac", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/95b12462c084b47abd6d6a11bd0d65042a598bac", "committedDate": "2020-10-15T07:56:18Z", "message": "First experiment with alpha newtwork compiler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af80dd43673a808e4289a230a6a3b862b3c1751c", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/af80dd43673a808e4289a230a6a3b862b3c1751c", "committedDate": "2020-10-15T07:56:18Z", "message": "Experiment with another callback to create the KieBase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "547e5a4e439730ac3fc27b13529445266e2622ae", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/547e5a4e439730ac3fc27b13529445266e2622ae", "committedDate": "2020-10-15T07:56:18Z", "message": "Revert \"Experiment with another callback to create the KieBase\"\n\nThis reverts commit 2dcaa1df"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17921d08d15dca88cf6a5ff50a3d087acccf5de3", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/17921d08d15dca88cf6a5ff50a3d087acccf5de3", "committedDate": "2020-10-15T07:56:18Z", "message": "Generation of compiled alpha network without compiling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e9c155bab39d8bf4ae297b1b115aa2f0a1e6306", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/0e9c155bab39d8bf4ae297b1b115aa2f0a1e6306", "committedDate": "2020-10-15T07:56:18Z", "message": "Also compiling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bfcc8896a0896480df0efcacc4a88334e1b055e", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2bfcc8896a0896480df0efcacc4a88334e1b055e", "committedDate": "2020-10-15T07:56:18Z", "message": "Fixed name change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f33cd17f6d2a3640653579ca91c1e0389a502dc", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/0f33cd17f6d2a3640653579ca91c1e0389a502dc", "committedDate": "2020-10-15T07:56:18Z", "message": "Refacotr GenerateANCMojo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a957bd142dbe044f49e8eb2f996cf359a18a0978", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/a957bd142dbe044f49e8eb2f996cf359a18a0978", "committedDate": "2020-10-15T07:56:18Z", "message": "First version of testing in kie-maven-plugin, test not running"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "124a3ba88fc6d380f29a7d2d93702fee70982830", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/124a3ba88fc6d380f29a7d2d93702fee70982830", "committedDate": "2020-10-15T07:56:18Z", "message": "Fix plugin testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "491d1ff9adcbe2e1a5bad95d15573b21799850c8", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/491d1ff9adcbe2e1a5bad95d15573b21799850c8", "committedDate": "2020-10-15T07:56:18Z", "message": "Reverted useless edits"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13668c91cc13ed35a1e82c548a6dd06bb0c704a0", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/13668c91cc13ed35a1e82c548a6dd06bb0c704a0", "committedDate": "2020-10-15T07:56:18Z", "message": "Abstract generate model option to super class to avoid default duplication"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e24f54fb712c62d70d9720eba6f7af613413930", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2e24f54fb712c62d70d9720eba6f7af613413930", "committedDate": "2020-10-15T07:56:18Z", "message": "PMMLModel after DMNModel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/9b31b4cc0d12f6ae0083ad25e054fd8c0c91d090", "committedDate": "2020-10-14T10:29:46Z", "message": "PMMLModel after DMNModel"}, "afterCommit": {"oid": "2e24f54fb712c62d70d9720eba6f7af613413930", "author": {"user": {"login": "lucamolteni", "name": "Luca Molteni"}}, "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2e24f54fb712c62d70d9720eba6f7af613413930", "committedDate": "2020-10-15T07:56:18Z", "message": "PMMLModel after DMNModel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Mzg5NjE2", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#pullrequestreview-509389616", "createdAt": "2020-10-15T13:39:44Z", "commit": {"oid": "2e24f54fb712c62d70d9720eba6f7af613413930"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1212, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}