{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3MDAwMzc5", "number": 4672, "title": "Refactor offer/trade related classes in core and desktop", "bodyText": "These refactoring changes are for reducing existing and potential duplication coming with the addition of new trading protocol support in the gRPC API.  Some minor styling and logic simplification changes are also included.\n\n\nConvert OfferUtil to injected singleton, and move various offer related utility methods into it.\n\n\nDelete both MakerFeeProvider classes, which were wrappers around the same static old OfferUtil method.\n\n\nInject OfferUtil into CreateOfferDataModel, CreateOfferViewModel,  TakeOfferDataModel, TakeOfferViewModel, MutableOfferDataModel,  MutableOfferViewModel, OfferDataModel, EditOfferDataModel,  EditOfferViewModel\n\n\nRefactor TakeOfferViewModel\nUse OfferUtil, remove unused fields & methods.\nMade minor logic simplification, style and formatting changes.\n\n\nMutableOfferDataModel\nMade minor logic simplification, style and formatting changes.\n\n\nMutableOfferView uses new paymentAccount.isHalCashAccount().\n\n\nMutableOfferViewModel\nRefactored to use new VolumeUtil, CoinUtil, OfferUtil.\nRemoved unused fields & accessors.\nMade minor style change.\n\n\nRefactored OfferDataModel to use new OfferUtil\n\n\nRefactor CreateOfferService\nInject and use OfferUtil\nMove some utility methods to OfferUtil\nRemove unused fields\n\n\nOffer\nRefactored to use new VolumeUtil for volume calculations.\nMade stateProperty and errorMessageProperty fields private.\n\n\nPaymentAccount\nMoved isHalCashAccount type check to this class.\nMoved getTradeCurrency logic to this class.\n\n\nContract, TradeStatistics2, TradeStatistics3\nRefactored to use new VolumeUtil for volume calculations.\n\n\nTrade\nRefactored to use new VolumeUtil for volume calculations.\nMade minor logic simplification, style and formatting changes.\n\n\nCoinUtil\nMoved some coin utility methods into this class\n\n\nCoinUtilTest\nMoved (coin related) tests from CoinCryptoUtilsTest and OfferUtilTest\ninto CoinUtilTest, and deleted OfferUtilTest, CoinCryptoUtilsTest.\n\n\nAdjust create and edit offer tests to model refactoring", "createdAt": "2020-10-20T18:13:29Z", "url": "https://github.com/bisq-network/bisq/pull/4672", "merged": true, "mergeCommit": {"oid": "b9e1398e295d9ae287875f7a22b3d5cef6be88ef"}, "closed": true, "closedAt": "2020-10-21T18:06:48Z", "author": {"login": "ghubstan"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUcxIyAH2gAyNTA3MDAwMzc5OmFiNmJlMjM1MTYyNzY0ZDNhM2FmMGEzYWQ0YjQ1YTRjYTM4NjQ4NDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUxXc2gFqTUxNDA0MTU5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ab6be235162764d3a3af0a3ad4b45a4ca3864848", "author": {"user": {"login": "ghubstan", "name": "Stan"}}, "url": "https://github.com/bisq-network/bisq/commit/ab6be235162764d3a3af0a3ad4b45a4ca3864848", "committedDate": "2020-10-20T18:06:44Z", "message": "Refactor offer/trade related classes in core and desktop\n\nThese refactoring changes are for reducing existing and potential\nduplication coming with the addition of new trading protocol support\nin the gRPC API.  Some minor styling and logic simplification changes\nare also include.\n\n- Convert OfferUtil to injected singleton, and move various offer related\n  utility methods into it.\n\n- Delete both MakerFeeProvider classes, which were wrappers around the same\n  static old OfferUtil method.\n\n- Inject OfferUtil into CreateOfferDataModel, CreateOfferViewModel,\n  TakeOfferDataModel, TakeOfferViewModel, MutableOfferDataModel,\n  MutableOfferViewModel, OfferDataModel, EditOfferDataModel,\n  EditOfferViewModel\n\n- Refactor TakeOfferViewModel\n\n\tUse OfferUtil, remove unused fields & methods.\n\tMade minor logic simplification, style and formatting changes.\n\n- MutableOfferDataModel\n\n\tMade minor logic simplification, style and formatting changes.\n\n- MutableOfferView uses new paymentAccount.isHalCashAccount().\n\n- MutableOfferViewModel\n\n\tRefactored to use new VolumeUtil, CoinUtil, OfferUtil.\n\tRemoved unused fields & accessors.\n\tMade minor style change.\n\n- Refactored OfferDataModel to use new OfferUtil\n\n- Refactor CreateOfferService\n\n\tInject and use OfferUtil\n\tMove some utility methods to OfferUtil\n\tRemove unused fields\n\n- Offer\n\n\tRefactored to use new VolumeUtil for volume calculations.\n\tMade stateProperty and errorMessageProperty fields private.\n\n- PaymentAccount\n\n\tMoved isHalCashAccount type check to this class.\n\tMoved getTradeCurrency logic to this class.\n\n- Contract, radeStatistics2, TradeStatistics3\n\n\tRefactored to use new VolumeUtil for volume calculations.\n\n- Trade\n\n\tRefactored to use new VolumeUtil for volume calculations.\n\tMade minor logic simplification, style and formatting changes.\n\n- CoinUtil\n\n\tMoved some coin utility methods into this class\n\n- CoinUtilTest\n\n\tMoved (coin related) tests from CoinCryptoUtilsTest and OfferUtilTest\n\tinto CoinUtilTest, and deleted OfferUtilTest, CoinCryptoUtilsTest.\n\n- Adjust create and edit offer tests to model refactoring"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNzI3MDA3", "url": "https://github.com/bisq-network/bisq/pull/4672#pullrequestreview-513727007", "createdAt": "2020-10-21T14:07:07Z", "commit": {"oid": "ab6be235162764d3a3af0a3ad4b45a4ca3864848"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNDowNzowN1rOHluTnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNDowNzowN1rOHluTnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTMxODA0NQ==", "bodyText": "Shouldn't these be isNonZero...?", "url": "https://github.com/bisq-network/bisq/pull/4672#discussion_r509318045", "createdAt": "2020-10-21T14:07:07Z", "author": {"login": "sqrrm"}, "path": "desktop/src/main/java/bisq/desktop/main/offer/MutableOfferDataModel.java", "diffHunk": "@@ -133,6 +133,9 @@\n     protected boolean allowAmountUpdate = true;\n     private final TradeStatisticsManager tradeStatisticsManager;\n \n+    private final Predicate<ObjectProperty<Coin>> isPositiveAmount = (c) -> c.get() != null && !c.get().isZero();\n+    private final Predicate<ObjectProperty<Price>> isPositivePrice = (p) -> p.get() != null && !p.get().isZero();\n+    private final Predicate<ObjectProperty<Volume>> isPositiveVolume = (v) -> v.get() != null && !v.get().isZero();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6be235162764d3a3af0a3ad4b45a4ca3864848"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MDQxNTk5", "url": "https://github.com/bisq-network/bisq/pull/4672#pullrequestreview-514041599", "createdAt": "2020-10-21T18:06:41Z", "commit": {"oid": "ab6be235162764d3a3af0a3ad4b45a4ca3864848"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3129, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}