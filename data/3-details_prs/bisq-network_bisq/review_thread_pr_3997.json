{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MjUwNDg1", "number": 3997, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMzozNVrODh5N4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDo1MzoyOVrODiWtEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2ODY3MDQzOnYy", "diffSide": "RIGHT", "path": "pricenode/install_pricenode_debian.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMzozNVrOFs4fNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMzozNVrOFs4fNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNzE1OA==", "bodyText": "Should be \"Access your pricenode\".", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382607158", "createdAt": "2020-02-21T14:23:35Z", "author": {"login": "cbeams"}, "path": "pricenode/install_pricenode_debian.sh", "diffHunk": "@@ -0,0 +1,89 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+echo \"[*] Bisq bisq-pricenode installation script\"\n+\n+##### change as necessary for your system\n+\n+SYSTEMD_SERVICE_HOME=/etc/systemd/system\n+#SYSTEMD_ENV_HOME=/etc/default\n+\n+ROOT_USER=root\n+ROOT_GROUP=root\n+#ROOT_HOME=/root\n+\n+BISQ_USER=bisq\n+BISQ_GROUP=bisq\n+BISQ_HOME=/bisq\n+\n+BISQ_REPO_URL=https://github.com/bisq-network/bisq\n+BISQ_REPO_NAME=bisq\n+BISQ_REPO_TAG=master\n+BISQ_LATEST_RELEASE=$(curl -s https://api.github.com/repos/bisq-network/bisq/releases/latest|grep tag_name|head -1|cut -d '\"' -f4)\n+BISQ_TORHS=pricenode\n+\n+TOR_PKG=\"tor\"\n+#TOR_USER=debian-tor\n+TOR_GROUP=debian-tor\n+TOR_CONF=/etc/tor/torrc\n+TOR_RESOURCES=/var/lib/tor\n+\n+#####\n+\n+echo \"[*] Upgrading apt packages\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get update -q\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get upgrade -qq -y\n+\n+echo \"[*] Installing Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get install -qq -y \"${TOR_PKG}\"\n+\n+echo \"[*] Adding Tor configuration\"\n+if ! grep \"${BISQ_TORHS}\" /etc/tor/torrc >/dev/null 2>&1;then\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceDir ${TOR_RESOURCES}/${BISQ_TORHS}/ >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServicePort 80 127.0.0.1:8080 >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceVersion 2 >> ${TOR_CONF}\"\n+fi\n+\n+echo \"[*] Creating Bisq user with Tor access\"\n+sudo -H -i -u \"${ROOT_USER}\" useradd -d \"${BISQ_HOME}\" -G \"${TOR_GROUP}\" \"${BISQ_USER}\"\n+\n+echo \"[*] Creating Bisq homedir\"\n+sudo -H -i -u \"${ROOT_USER}\" mkdir -p \"${BISQ_HOME}\"\n+sudo -H -i -u \"${ROOT_USER}\" chown \"${BISQ_USER}\":\"${BISQ_GROUP}\" ${BISQ_HOME}\n+\n+echo \"[*] Cloning Bisq repo\"\n+sudo -H -i -u \"${BISQ_USER}\" git config --global advice.detachedHead false\n+sudo -H -i -u \"${BISQ_USER}\" git clone --branch \"${BISQ_REPO_TAG}\" \"${BISQ_REPO_URL}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}\"\n+\n+echo \"[*] Installing OpenJDK 10.0.2 from Bisq repo\"\n+sudo -H -i -u \"${ROOT_USER}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}/scripts/install_java.sh\"\n+\n+echo \"[*] Checking out Bisq ${BISQ_LATEST_RELEASE}\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && git checkout ${BISQ_LATEST_RELEASE}\"\n+\n+echo \"[*] Building Bisq from source\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue\n+\n+echo \"[*] Installing bisq-pricenode systemd service\"\n+sudo -H -i -u \"${ROOT_USER}\" install -c -o \"${ROOT_USER}\" -g \"${ROOT_GROUP}\" -m 644 \"${BISQ_HOME}/${BISQ_REPO_NAME}/pricenode/bisq-pricenode.service\" \"${SYSTEMD_SERVICE_HOME}\"\n+\n+echo \"[*] Reloading systemd daemon configuration\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl daemon-reload\n+\n+echo \"[*] Enabling bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl enable bisq-pricenode.service\n+\n+echo \"[*] Starting bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl start bisq-pricenode.service\n+sleep 5\n+sudo -H -i -u \"${ROOT_USER}\" journalctl --no-pager --unit bisq-pricenode\n+\n+echo \"[*] Restarting Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" service tor restart\n+sleep 5\n+\n+echo '[*] Done!'\n+echo -n '[*] Access your explorer at http://'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deacffbdb823346a8dc66e8655c8b220b6918879"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2ODY3NDI5OnYy", "diffSide": "RIGHT", "path": "pricenode/install_pricenode_debian.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNDozOVrOFs4hpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNDozOVrOFs4hpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNzc4MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            echo -n '[*] Access your explorer at http://'\n          \n          \n            \n            echo -n '[*] Access your pricenode at http://'", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382607781", "createdAt": "2020-02-21T14:24:39Z", "author": {"login": "wiz"}, "path": "pricenode/install_pricenode_debian.sh", "diffHunk": "@@ -0,0 +1,89 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+echo \"[*] Bisq bisq-pricenode installation script\"\n+\n+##### change as necessary for your system\n+\n+SYSTEMD_SERVICE_HOME=/etc/systemd/system\n+#SYSTEMD_ENV_HOME=/etc/default\n+\n+ROOT_USER=root\n+ROOT_GROUP=root\n+#ROOT_HOME=/root\n+\n+BISQ_USER=bisq\n+BISQ_GROUP=bisq\n+BISQ_HOME=/bisq\n+\n+BISQ_REPO_URL=https://github.com/bisq-network/bisq\n+BISQ_REPO_NAME=bisq\n+BISQ_REPO_TAG=master\n+BISQ_LATEST_RELEASE=$(curl -s https://api.github.com/repos/bisq-network/bisq/releases/latest|grep tag_name|head -1|cut -d '\"' -f4)\n+BISQ_TORHS=pricenode\n+\n+TOR_PKG=\"tor\"\n+#TOR_USER=debian-tor\n+TOR_GROUP=debian-tor\n+TOR_CONF=/etc/tor/torrc\n+TOR_RESOURCES=/var/lib/tor\n+\n+#####\n+\n+echo \"[*] Upgrading apt packages\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get update -q\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get upgrade -qq -y\n+\n+echo \"[*] Installing Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get install -qq -y \"${TOR_PKG}\"\n+\n+echo \"[*] Adding Tor configuration\"\n+if ! grep \"${BISQ_TORHS}\" /etc/tor/torrc >/dev/null 2>&1;then\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceDir ${TOR_RESOURCES}/${BISQ_TORHS}/ >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServicePort 80 127.0.0.1:8080 >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceVersion 2 >> ${TOR_CONF}\"\n+fi\n+\n+echo \"[*] Creating Bisq user with Tor access\"\n+sudo -H -i -u \"${ROOT_USER}\" useradd -d \"${BISQ_HOME}\" -G \"${TOR_GROUP}\" \"${BISQ_USER}\"\n+\n+echo \"[*] Creating Bisq homedir\"\n+sudo -H -i -u \"${ROOT_USER}\" mkdir -p \"${BISQ_HOME}\"\n+sudo -H -i -u \"${ROOT_USER}\" chown \"${BISQ_USER}\":\"${BISQ_GROUP}\" ${BISQ_HOME}\n+\n+echo \"[*] Cloning Bisq repo\"\n+sudo -H -i -u \"${BISQ_USER}\" git config --global advice.detachedHead false\n+sudo -H -i -u \"${BISQ_USER}\" git clone --branch \"${BISQ_REPO_TAG}\" \"${BISQ_REPO_URL}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}\"\n+\n+echo \"[*] Installing OpenJDK 10.0.2 from Bisq repo\"\n+sudo -H -i -u \"${ROOT_USER}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}/scripts/install_java.sh\"\n+\n+echo \"[*] Checking out Bisq ${BISQ_LATEST_RELEASE}\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && git checkout ${BISQ_LATEST_RELEASE}\"\n+\n+echo \"[*] Building Bisq from source\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue\n+\n+echo \"[*] Installing bisq-pricenode systemd service\"\n+sudo -H -i -u \"${ROOT_USER}\" install -c -o \"${ROOT_USER}\" -g \"${ROOT_GROUP}\" -m 644 \"${BISQ_HOME}/${BISQ_REPO_NAME}/pricenode/bisq-pricenode.service\" \"${SYSTEMD_SERVICE_HOME}\"\n+\n+echo \"[*] Reloading systemd daemon configuration\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl daemon-reload\n+\n+echo \"[*] Enabling bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl enable bisq-pricenode.service\n+\n+echo \"[*] Starting bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl start bisq-pricenode.service\n+sleep 5\n+sudo -H -i -u \"${ROOT_USER}\" journalctl --no-pager --unit bisq-pricenode\n+\n+echo \"[*] Restarting Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" service tor restart\n+sleep 5\n+\n+echo '[*] Done!'\n+echo -n '[*] Access your explorer at http://'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deacffbdb823346a8dc66e8655c8b220b6918879"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDYwNzA0OnYy", "diffSide": "RIGHT", "path": "monitor/install_collectd_debian.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxNTo1NFrOFtKsvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxNTo1NFrOFtKsvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkwNTUzMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            service bisq status >/dev/null 2>&1\n          \n          \n            \n            set +e\n          \n          \n            \n            service bisq status >/dev/null 2>&1", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382905533", "createdAt": "2020-02-22T11:15:54Z", "author": {"login": "wiz"}, "path": "monitor/install_collectd_debian.sh", "diffHunk": "@@ -50,7 +52,10 @@ sudo -H -i -u \"${ROOT_USER}\" systemctl enable nginx.service\n sudo -H -i -u \"${ROOT_USER}\" systemctl enable collectd.service\n \n echo \"[*] Restarting services\"\n-sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq.service\n+service bisq status >/dev/null 2>&1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f180cd7ae91e267761666d1abfedf9c716961c80"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDYwNzg4OnYy", "diffSide": "RIGHT", "path": "pricenode/bisq-pricenode.service", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxODowMFrOFtKtJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxODowMFrOFtKtJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkwNTYzOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            Environment=\"JAVA_OPTS=-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=true -Dcom.sun.management.jmxremote.port=6969 -Dcom.sun.management.jmxremote.rmi.port=6969 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false\"", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382905639", "createdAt": "2020-02-22T11:18:00Z", "author": {"login": "wiz"}, "path": "pricenode/bisq-pricenode.service", "diffHunk": "@@ -0,0 +1,22 @@\n+[Unit]\n+Description=Bisq Price Node\n+After=network.target\n+\n+[Service]\n+Environment=\"BITCOIN_AVG_PUBKEY=__BITCOIN_AVG_PUBKEY__\"\n+Environment=\"BITCOIN_AVG_PRIVKEY=__BITCOIN_AVG_PRIVKEY__\"\n+ExecStart=/usr/bin/java -jar /bisq/bisq/lib/pricenode-0.7.2-SNAPSHOT.jar 2 2\n+ExecStop=/bin/kill -TERM ${MAINPID}\n+Restart=on-failure\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb5b0ce80721f397378489e8297b853f6dd37996"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDYwOTgxOnYy", "diffSide": "RIGHT", "path": "monitor/install_collectd_debian.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToyMjozOFrOFtKuIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToyMjozOFrOFtKuIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkwNTg4OA==", "bodyText": "this lets errors slip through and leave operators in the believe that everything is fine.\nSomething like this may do it. I am pretty sure though that if I really want to break it I still can.\nset +e\nservice bisq status >/dev/null 2>&1\n[ $? != 4 ] && set -e && sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq.service\nset +e\nservice bisq-pricenode status >/dev/null 2>&1\n[ $? != 4 ] && set -e && sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq-pricenode.service\nset -e", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382905888", "createdAt": "2020-02-22T11:22:38Z", "author": {"login": "freimair"}, "path": "monitor/install_collectd_debian.sh", "diffHunk": "@@ -50,7 +52,11 @@ sudo -H -i -u \"${ROOT_USER}\" systemctl enable nginx.service\n sudo -H -i -u \"${ROOT_USER}\" systemctl enable collectd.service\n \n echo \"[*] Restarting services\"\n-sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq.service\n+set +e", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb5b0ce80721f397378489e8297b853f6dd37996"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MzMxODc1OnYy", "diffSide": "RIGHT", "path": "pricenode/bisq-pricenode.service", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDowNToxNFrOFthtAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDowNToxNFrOFthtAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzI4MjQzMw==", "bodyText": "Is there a specific reason not to use the start script /bisq/bisq/bisq-pricenode for the price node?\nAs there is a specific version hard coded in the service file seems like we might risk missing updating the bisq.service file and thus, producing maintenance issues and efforts.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ExecStart=/usr/bin/java -jar /bisq/bisq/lib/pricenode-0.7.2-SNAPSHOT.jar 2 2\n          \n          \n            \n            ExecStart=/bisq/bisq/bisq-pricenode 2 2", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r383282433", "createdAt": "2020-02-24T14:05:14Z", "author": {"login": "freimair"}, "path": "pricenode/bisq-pricenode.service", "diffHunk": "@@ -0,0 +1,21 @@\n+[Unit]\n+Description=Bisq Price Node\n+After=network.target\n+\n+[Service]\n+EnvironmentFile=/etc/default/bisq-pricenode.env\n+ExecStart=/usr/bin/java -jar /bisq/bisq/lib/pricenode-0.7.2-SNAPSHOT.jar 2 2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MzUwMTYwOnYy", "diffSide": "RIGHT", "path": "pricenode/install_pricenode_debian.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDo1MzoyOVrOFtjbhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDo1MzoyOVrOFtjbhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzMxMDcyNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue\n          \n          \n            \n            sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew :pricenode:installDist  -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r383310725", "createdAt": "2020-02-24T14:53:29Z", "author": {"login": "freimair"}, "path": "pricenode/install_pricenode_debian.sh", "diffHunk": "@@ -0,0 +1,90 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+echo \"[*] Bisq bisq-pricenode installation script\"\n+\n+##### change as necessary for your system\n+\n+SYSTEMD_SERVICE_HOME=/etc/systemd/system\n+SYSTEMD_ENV_HOME=/etc/default\n+\n+ROOT_USER=root\n+ROOT_GROUP=root\n+#ROOT_HOME=/root\n+\n+BISQ_USER=bisq\n+BISQ_GROUP=bisq\n+BISQ_HOME=/bisq\n+\n+BISQ_REPO_URL=https://github.com/bisq-network/bisq\n+BISQ_REPO_NAME=bisq\n+BISQ_REPO_TAG=master\n+BISQ_LATEST_RELEASE=$(curl -s https://api.github.com/repos/bisq-network/bisq/releases/latest|grep tag_name|head -1|cut -d '\"' -f4)\n+BISQ_TORHS=pricenode\n+\n+TOR_PKG=\"tor\"\n+#TOR_USER=debian-tor\n+TOR_GROUP=debian-tor\n+TOR_CONF=/etc/tor/torrc\n+TOR_RESOURCES=/var/lib/tor\n+\n+#####\n+\n+echo \"[*] Upgrading apt packages\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get update -q\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get upgrade -qq -y\n+\n+echo \"[*] Installing Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get install -qq -y \"${TOR_PKG}\"\n+\n+echo \"[*] Adding Tor configuration\"\n+if ! grep \"${BISQ_TORHS}\" /etc/tor/torrc >/dev/null 2>&1;then\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceDir ${TOR_RESOURCES}/${BISQ_TORHS}/ >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServicePort 80 127.0.0.1:8080 >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceVersion 2 >> ${TOR_CONF}\"\n+fi\n+\n+echo \"[*] Creating Bisq user with Tor access\"\n+sudo -H -i -u \"${ROOT_USER}\" useradd -d \"${BISQ_HOME}\" -G \"${TOR_GROUP}\" \"${BISQ_USER}\"\n+\n+echo \"[*] Creating Bisq homedir\"\n+sudo -H -i -u \"${ROOT_USER}\" mkdir -p \"${BISQ_HOME}\"\n+sudo -H -i -u \"${ROOT_USER}\" chown \"${BISQ_USER}\":\"${BISQ_GROUP}\" ${BISQ_HOME}\n+\n+echo \"[*] Cloning Bisq repo\"\n+sudo -H -i -u \"${BISQ_USER}\" git config --global advice.detachedHead false\n+sudo -H -i -u \"${BISQ_USER}\" git clone --branch \"${BISQ_REPO_TAG}\" \"${BISQ_REPO_URL}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}\"\n+\n+echo \"[*] Installing OpenJDK 10.0.2 from Bisq repo\"\n+sudo -H -i -u \"${ROOT_USER}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}/scripts/install_java.sh\"\n+\n+echo \"[*] Checking out Bisq ${BISQ_LATEST_RELEASE}\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && git checkout ${BISQ_LATEST_RELEASE}\"\n+\n+echo \"[*] Building Bisq from source\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2537, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}