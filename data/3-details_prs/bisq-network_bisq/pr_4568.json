{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NDcwMTY0", "number": 4568, "title": "Add segwit support to the BTC wallet", "bodyText": "This is just the BTC wallet.\nTrade protocol keeps using legacy addresses.\nThis PR does not require a hardfork.", "createdAt": "2020-09-29T00:24:21Z", "url": "https://github.com/bisq-network/bisq/pull/4568", "merged": true, "mergeCommit": {"oid": "35e0c34c74be94c7b7cfe8f10ca1ee67412e35e3"}, "closed": true, "closedAt": "2020-10-08T22:22:14Z", "author": {"login": "oscarguindzberg"}, "timelineItems": {"totalCount": 44, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNpG_wABqjM4MTk5NTE1Njk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQpOKYAFqTUwNTIwNjMxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb6990c6199dd28ff08314f346a6babeb74e6684", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/bb6990c6199dd28ff08314f346a6babeb74e6684", "committedDate": "2020-09-29T00:20:11Z", "message": "Remove unused import"}, "afterCommit": {"oid": "b6462cf6031c44305454ef58f14b60e455027556", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/b6462cf6031c44305454ef58f14b60e455027556", "committedDate": "2020-09-29T14:31:40Z", "message": "Remove unused import"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6462cf6031c44305454ef58f14b60e455027556", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/b6462cf6031c44305454ef58f14b60e455027556", "committedDate": "2020-09-29T14:31:40Z", "message": "Remove unused import"}, "afterCommit": {"oid": "f09d829523003bc38f4dbb1b838247fa858b19f9", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/f09d829523003bc38f4dbb1b838247fa858b19f9", "committedDate": "2020-10-01T15:17:17Z", "message": "Enable reusing unused AVAILABLE entries"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f09d829523003bc38f4dbb1b838247fa858b19f9", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/f09d829523003bc38f4dbb1b838247fa858b19f9", "committedDate": "2020-10-01T15:17:17Z", "message": "Enable reusing unused AVAILABLE entries"}, "afterCommit": {"oid": "40d67ba19496c2baa1d14504143e49b1b0fac446", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/40d67ba19496c2baa1d14504143e49b1b0fac446", "committedDate": "2020-10-01T16:04:44Z", "message": "Enable reusing unused AVAILABLE entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjY1NTcw", "url": "https://github.com/bisq-network/bisq/pull/4568#pullrequestreview-500665570", "createdAt": "2020-10-01T19:45:31Z", "commit": {"oid": "8c57d74cbb2cba5732f0b6ad1caa9b00f7a4ba77"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c57d74cbb2cba5732f0b6ad1caa9b00f7a4ba77", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/8c57d74cbb2cba5732f0b6ad1caa9b00f7a4ba77", "committedDate": "2020-10-01T16:15:02Z", "message": "Make codacy happy"}, "afterCommit": {"oid": "a4b8b086c9b8774c66735ec082c82b65298d561e", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/a4b8b086c9b8774c66735ec082c82b65298d561e", "committedDate": "2020-10-01T19:56:32Z", "message": "Make codacy happy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4b8b086c9b8774c66735ec082c82b65298d561e", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/a4b8b086c9b8774c66735ec082c82b65298d561e", "committedDate": "2020-10-01T19:56:32Z", "message": "Make codacy happy"}, "afterCommit": {"oid": "778a7aaa47ca164867e3cad779ceaebf7b485aaa", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/778a7aaa47ca164867e3cad779ceaebf7b485aaa", "committedDate": "2020-10-02T13:46:14Z", "message": "Make codacy happy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "778a7aaa47ca164867e3cad779ceaebf7b485aaa", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/778a7aaa47ca164867e3cad779ceaebf7b485aaa", "committedDate": "2020-10-02T13:46:14Z", "message": "Make codacy happy"}, "afterCommit": {"oid": "d1e3e0977209b51d11314f81787161cafdc2dbb9", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/d1e3e0977209b51d11314f81787161cafdc2dbb9", "committedDate": "2020-10-05T15:49:24Z", "message": "Make codacy happy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjcyMzQw", "url": "https://github.com/bisq-network/bisq/pull/4568#pullrequestreview-502272340", "createdAt": "2020-10-05T17:30:47Z", "commit": {"oid": "5f2416aecf7cadeef473bb610cfc9448daaa749d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNzozMDo0OFrOHcm7pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNzo0MDoxOVrOHcnPNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MDAzOA==", "bodyText": "Is that never called from a trade protocol entry? e.g. the one for the multisig.", "url": "https://github.com/bisq-network/bisq/pull/4568#discussion_r499760038", "createdAt": "2020-10-05T17:30:48Z", "author": {"login": "chimp1984"}, "path": "core/src/main/java/bisq/core/btc/wallet/BtcWalletService.java", "diffHunk": "@@ -584,23 +584,13 @@ public AddressEntry getOrCreateAddressEntry(String offerId, AddressEntry.Context\n             if (emptyAvailableAddressEntry.isPresent()) {\n                 return addressEntryList.swapAvailableToAddressEntryWithOfferId(emptyAvailableAddressEntry.get(), context, offerId);\n             } else {\n-                AddressEntry entry = new AddressEntry(wallet.freshReceiveKey(), context, offerId);\n+                AddressEntry entry = new AddressEntry(wallet.freshReceiveKey(), context, offerId, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f2416aecf7cadeef473bb610cfc9448daaa749d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MzM5NQ==", "bodyText": "Instead of depositTx.getInputs().size()-1) I would suggest to make a local var from the getTransactionInput(depositTx, getMakersScriptSigProgram(transactionInput), buyerInputs.get(i)) we add earlier so its more clear. Maybe even do the check before adding, technically no difference but somehow more clean if the input gets completely defined before added.", "url": "https://github.com/bisq-network/bisq/pull/4568#discussion_r499763395", "createdAt": "2020-10-05T17:37:09Z", "author": {"login": "chimp1984"}, "path": "core/src/main/java/bisq/core/btc/wallet/TradeWalletService.java", "diffHunk": "@@ -601,6 +603,9 @@ public Transaction takerSignsDepositTx(boolean takerIsSeller,\n             for (int i = 0; i < buyerInputs.size(); i++) {\n                 TransactionInput transactionInput = makersDepositTx.getInputs().get(i);\n                 depositTx.addInput(getTransactionInput(depositTx, getMakersScriptSigProgram(transactionInput), buyerInputs.get(i)));\n+                if (!TransactionWitness.EMPTY.equals(transactionInput.getWitness())) {\n+                    depositTx.getInput(depositTx.getInputs().size()-1).setWitness(transactionInput.getWitness());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c28ff3d28de4e2e621ec63c4826f6e034d2239f"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NTA0NQ==", "bodyText": "As we do not support now segwit in the trade process, is that change needed at all? I dont see a risk to have it there but maybe better to leave all that out until we start adding segwit support to the trade protocol? Not sure if you started already in more pleaces to add support which do not interfere (as we discussed it is our strategy to add as much as possible without activating segwit in trade protocol...), so if you have started that process already all find, otherwise if its a single change it would be maybe more clear to start after the release with that process...", "url": "https://github.com/bisq-network/bisq/pull/4568#discussion_r499765045", "createdAt": "2020-10-05T17:40:19Z", "author": {"login": "chimp1984"}, "path": "core/src/main/java/bisq/core/btc/wallet/TradeWalletService.java", "diffHunk": "@@ -601,6 +603,9 @@ public Transaction takerSignsDepositTx(boolean takerIsSeller,\n             for (int i = 0; i < buyerInputs.size(); i++) {\n                 TransactionInput transactionInput = makersDepositTx.getInputs().get(i);\n                 depositTx.addInput(getTransactionInput(depositTx, getMakersScriptSigProgram(transactionInput), buyerInputs.get(i)));\n+                if (!TransactionWitness.EMPTY.equals(transactionInput.getWitness())) {\n+                    depositTx.getInput(depositTx.getInputs().size()-1).setWitness(transactionInput.getWitness());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MzM5NQ=="}, "originalCommit": {"oid": "6c28ff3d28de4e2e621ec63c4826f6e034d2239f"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b772f6cbca7dae6f301336a24c1b8abc0f7deab", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/3b772f6cbca7dae6f301336a24c1b8abc0f7deab", "committedDate": "2020-10-08T19:05:23Z", "message": "Use bitcoinj 0.15.8 (commit a733034)"}, "afterCommit": {"oid": "4fabbdf356ff58ad0f71377342e7f24bbeaa45e0", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/4fabbdf356ff58ad0f71377342e7f24bbeaa45e0", "committedDate": "2020-10-08T19:25:41Z", "message": "Do a backup of the wallet before segwit migration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f13a7b164cebf632d198be65aa2f4ad746c993fc", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/f13a7b164cebf632d198be65aa2f4ad746c993fc", "committedDate": "2020-10-08T19:33:48Z", "message": "Create a P2WPKH keychain for new btc wallets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd286600697f6cffc76ea9b84b0f6b6d3fe4e041", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/cd286600697f6cffc76ea9b84b0f6b6d3fe4e041", "committedDate": "2020-10-08T19:33:49Z", "message": "Add a P2WPKH keychain for existing wallets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ced357ce258a1538b592b5f00e703eab12619e1e", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/ced357ce258a1538b592b5f00e703eab12619e1e", "committedDate": "2020-10-08T19:33:49Z", "message": "AddressEntry: Add boolean segwit flag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e85c66b8103940975ae3562110c5ea50137fc368", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/e85c66b8103940975ae3562110c5ea50137fc368", "committedDate": "2020-10-08T19:33:49Z", "message": "Stop using LegacyAddress for btc addresses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c7f3456b6561811cc1c5f3a90b39f5ce9a3733b", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/0c7f3456b6561811cc1c5f3a90b39f5ce9a3733b", "committedDate": "2020-10-08T19:33:50Z", "message": "Fix log msg in BtcCoinSelector"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f4c66f43d723f597e9646479d3776419681dc7e", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/0f4c66f43d723f597e9646479d3776419681dc7e", "committedDate": "2020-10-08T19:33:50Z", "message": "Comment out segwit BSQ account path\n\nSegwit is not used for BSQ"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25515710ab724203690de8d7057d7bbd6903a094", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/25515710ab724203690de8d7057d7bbd6903a094", "committedDate": "2020-10-08T19:33:51Z", "message": "TradeWalletService: adapt to segwit wallet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8b755794e2d7e0fb2e541a5635d35c138c8ff6f", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/d8b755794e2d7e0fb2e541a5635d35c138c8ff6f", "committedDate": "2020-10-08T19:33:51Z", "message": "WalletService: adapt to segwit wallet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3708485f950912d18a9d62c992d35c9e175e90c", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/a3708485f950912d18a9d62c992d35c9e175e90c", "committedDate": "2020-10-08T19:33:51Z", "message": "New AddressEntry: use different script types\n\nUse P2WPKH for AVAILABLE context and P2PKH for the rest.\nDisable reusing unused AVAILABLE entries until segwit support is\nmandatory in Bisq."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9cc28f65a701288097fe166d6b68ace0a75574c", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/a9cc28f65a701288097fe166d6b68ace0a75574c", "committedDate": "2020-10-08T19:33:52Z", "message": "AddressEntryList: arbitrator entry use P2PKH"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9f5d92941c49ecc24949c4b20b6b4c70de69729", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/f9f5d92941c49ecc24949c4b20b6b4c70de69729", "committedDate": "2020-10-08T19:33:52Z", "message": "Add segwit/legacy checbox for address creation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f3c585c350320be1547bb7b47963b385dad736d", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/1f3c585c350320be1547bb7b47963b385dad736d", "committedDate": "2020-10-08T19:33:52Z", "message": "Serialize tx without segwit\n\nThis is for backwards compatibility with bisq nodes that have not\nupgraded to bitcoinj 0.15."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58afc00282d26fc0d8f92937b4fb955f31a269d4", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/58afc00282d26fc0d8f92937b4fb955f31a269d4", "committedDate": "2020-10-08T19:33:53Z", "message": "Don't create an extra address at startup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2f74f025093ed2bfa71cf5d0b7922691f435484", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/e2f74f025093ed2bfa71cf5d0b7922691f435484", "committedDate": "2020-10-08T19:33:53Z", "message": "Don't create a wallet address when not needed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1aeedd98b9eec683202b6210511fa5ce87cae0d", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/d1aeedd98b9eec683202b6210511fa5ce87cae0d", "committedDate": "2020-10-08T19:33:53Z", "message": "Remove unused WalletService.findKeyFromPubKeyHash()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78a2a43d48cea65688e0946c8b8bac3ebac66fc3", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/78a2a43d48cea65688e0946c8b8bac3ebac66fc3", "committedDate": "2020-10-08T19:33:54Z", "message": "Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01455d2b209cc49a4f3688add3e481422c1bb3a2", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/01455d2b209cc49a4f3688add3e481422c1bb3a2", "committedDate": "2020-10-08T19:33:54Z", "message": "Enable reusing unused AVAILABLE entries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a2c0ad75a8b49748b687f7171281d189b333d37", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/4a2c0ad75a8b49748b687f7171281d189b333d37", "committedDate": "2020-10-08T19:33:54Z", "message": "Make codacy happy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86ddd06e276f02cd07a137214b851666926acc69", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/86ddd06e276f02cd07a137214b851666926acc69", "committedDate": "2020-10-08T19:33:55Z", "message": "Validate AddressEntry.segwit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9e404f0e25a8d14fd57eecea1850e97f7f5cc65", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/b9e404f0e25a8d14fd57eecea1850e97f7f5cc65", "committedDate": "2020-10-08T19:33:55Z", "message": "Make it clear segwit is not used for the trade protocol yet."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5524ba3e97d98f7f4559625ee1e83307596f1efe", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/5524ba3e97d98f7f4559625ee1e83307596f1efe", "committedDate": "2020-10-08T19:33:55Z", "message": "BtcWalletService.getFreshAddressEntry(): code clean up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1aaf3e4eb9770d6a551001428e2599aa0616f61", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/d1aaf3e4eb9770d6a551001428e2599aa0616f61", "committedDate": "2020-10-08T19:33:56Z", "message": "Construct dummy outputs with LegacyAddress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3554e190842d100d2fb9f111a9219fea75024231", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/3554e190842d100d2fb9f111a9219fea75024231", "committedDate": "2020-10-08T19:33:56Z", "message": "setWitness(): Code clean up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "499d7b7d35683b4f0747e9a674887c9329cc08c3", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/499d7b7d35683b4f0747e9a674887c9329cc08c3", "committedDate": "2020-10-08T19:33:56Z", "message": "Use try-with-resources"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d82c01670ba2943ef700d2e4116a0f649eb1b46", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/1d82c01670ba2943ef700d2e4116a0f649eb1b46", "committedDate": "2020-10-08T19:33:57Z", "message": "Improve error handling for P2WPKH"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "694446c296466904aa748f45db78b73d854d7d1e", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/694446c296466904aa748f45db78b73d854d7d1e", "committedDate": "2020-10-08T19:33:57Z", "message": "Switch back to LegacyAddress for fee estimation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a747e83211492a8d10ef4ce59d3c4cab99074948", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/a747e83211492a8d10ef4ce59d3c4cab99074948", "committedDate": "2020-10-08T19:33:57Z", "message": "Fix add segwit keychain for encrypted wallet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "417daf56926c9f6a4c65dc0adfad473712ea0ddb", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/417daf56926c9f6a4c65dc0adfad473712ea0ddb", "committedDate": "2020-10-08T19:33:58Z", "message": "Use bitcoinj 0.15.8 (commit a733034)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87da2ae349cee0d7733adbfbe290cc38dfc0e657", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/87da2ae349cee0d7733adbfbe290cc38dfc0e657", "committedDate": "2020-10-08T19:33:58Z", "message": "Do a backup of the wallet before segwit migration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4fabbdf356ff58ad0f71377342e7f24bbeaa45e0", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/4fabbdf356ff58ad0f71377342e7f24bbeaa45e0", "committedDate": "2020-10-08T19:25:41Z", "message": "Do a backup of the wallet before segwit migration"}, "afterCommit": {"oid": "87da2ae349cee0d7733adbfbe290cc38dfc0e657", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/87da2ae349cee0d7733adbfbe290cc38dfc0e657", "committedDate": "2020-10-08T19:33:58Z", "message": "Do a backup of the wallet before segwit migration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MTI5MzQ0", "url": "https://github.com/bisq-network/bisq/pull/4568#pullrequestreview-505129344", "createdAt": "2020-10-08T20:10:50Z", "commit": {"oid": "a747e83211492a8d10ef4ce59d3c4cab99074948"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQyMDoxMDo1MFrOHeuscg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQyMDoxMDo1MFrOHeuscg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk4NDM3MA==", "bodyText": "I think we should add a if(newValue) to make it more clear/safe. As we change only once from false to true it would not matter but feels more correct.", "url": "https://github.com/bisq-network/bisq/pull/4568#discussion_r501984370", "createdAt": "2020-10-08T20:10:50Z", "author": {"login": "chimp1984"}, "path": "core/src/main/java/bisq/core/btc/setup/WalletConfig.java", "diffHunk": "@@ -293,25 +301,34 @@ protected void startUp() throws Exception {\n             vPeerGroup.addWallet(vBsqWallet);\n             onSetupCompleted();\n \n-            Futures.addCallback((ListenableFuture<?>) vPeerGroup.startAsync(), new FutureCallback<Object>() {\n-                @Override\n-                public void onSuccess(@Nullable Object result) {\n-                    //completeExtensionInitiations(vPeerGroup);\n-                    DownloadProgressTracker tracker = downloadListener == null ? new DownloadProgressTracker() : downloadListener;\n-                    vPeerGroup.startBlockChainDownload(tracker);\n-                }\n-\n-                @Override\n-                public void onFailure(Throwable t) {\n-                    throw new RuntimeException(t);\n+            if (migratedWalletToSegwit.get()) {\n+                startPeerGroup();\n+            } else {\n+                migratedWalletToSegwit.addListener((observable, oldValue, newValue) -> startPeerGroup());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a747e83211492a8d10ef4ce59d3c4cab99074948"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MTMyNjgz", "url": "https://github.com/bisq-network/bisq/pull/4568#pullrequestreview-505132683", "createdAt": "2020-10-08T20:15:48Z", "commit": {"oid": "87da2ae349cee0d7733adbfbe290cc38dfc0e657"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "261e0ec714027be657ba7d1125ac65bd81b0135f", "author": {"user": {"login": "oscarguindzberg", "name": "Oscar Guindzberg"}}, "url": "https://github.com/bisq-network/bisq/commit/261e0ec714027be657ba7d1125ac65bd81b0135f", "committedDate": "2020-10-08T20:26:24Z", "message": "Check migratedWalletToSegwit is true"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MTU1MjY1", "url": "https://github.com/bisq-network/bisq/pull/4568#pullrequestreview-505155265", "createdAt": "2020-10-08T20:49:46Z", "commit": {"oid": "261e0ec714027be657ba7d1125ac65bd81b0135f"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MjA2MzE5", "url": "https://github.com/bisq-network/bisq/pull/4568#pullrequestreview-505206319", "createdAt": "2020-10-08T22:21:36Z", "commit": {"oid": "261e0ec714027be657ba7d1125ac65bd81b0135f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3079, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}