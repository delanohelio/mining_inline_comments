{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NDcyMjM4", "number": 4045, "title": "Allow IPv6 connections to Bitcoin nodes", "bodyText": "Fixes #3990\nCurrently bisq desktop does not accept IPv6 addresses in the settings for custom nodes or via the --btcNodes command line option.\nWhile the address format is already validated in desktop / GUIUtil, the separation of address and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored, regardless of whether they are entered via the GUI or command line.\nThis change fixes the code in BtcNodes::fromFullAddress to identify an IPv6 address as being surrounded by square brackets.\n\nIPv6 addresses are a sequence of hexadecimal and ':' characters enclosed by square brackets, followed by an optional colon and port number\nOnion addresses are a sequence of alphanumeric characters followed by .onion and an optional colon and port number\nIPv4 addresses are a sequence of numeric and '.' characters followed by an optional colon and port number\n\nTesting:\nthe following use case tests were identified and checked:\n\nonion address no port\nonion address with port\nIPv4 address no port\nIPv4 address with port\nIPv6 address no port\nIPv6 address with port\ncombination of all the above types\ninvalid input", "createdAt": "2020-03-11T04:04:14Z", "url": "https://github.com/bisq-network/bisq/pull/4045", "merged": true, "mergeCommit": {"oid": "17bb7b4ba6f35ea29032293000582b31aed76ddf"}, "closed": true, "closedAt": "2020-03-20T15:12:36Z", "author": {"login": "jmacxx"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOP6w3gBqjMxMzM3NTA1NDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPiAUaAFqTM3ODU2OTEzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad61947b5357a05dfabf5beca9f38eca244af835", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/ad61947b5357a05dfabf5beca9f38eca244af835", "committedDate": "2020-03-11T13:38:20Z", "message": "allow IPv6 response (16 byte) from Tor DNS lookup"}, "afterCommit": {"oid": "1d2f5be5bcd51b10707d76d546ca70f718600a3b", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/1d2f5be5bcd51b10707d76d546ca70f718600a3b", "committedDate": "2020-03-16T15:29:04Z", "message": "fix #3990"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d2f5be5bcd51b10707d76d546ca70f718600a3b", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/1d2f5be5bcd51b10707d76d546ca70f718600a3b", "committedDate": "2020-03-16T15:29:04Z", "message": "fix #3990"}, "afterCommit": {"oid": "d5c639e7305a987d63dda51b94f0ce71eea3a5e0", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/d5c639e7305a987d63dda51b94f0ce71eea3a5e0", "committedDate": "2020-03-16T15:33:09Z", "message": "Allow IPv6 connections to Bitcoin nodes (fixes #3990)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MzUxODc3", "url": "https://github.com/bisq-network/bisq/pull/4045#pullrequestreview-375351877", "createdAt": "2020-03-16T15:55:52Z", "commit": {"oid": "d5c639e7305a987d63dda51b94f0ce71eea3a5e0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9d83adfe6eb40a1a12649cfaa3325e6d8700c4a9", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/9d83adfe6eb40a1a12649cfaa3325e6d8700c4a9", "committedDate": "2020-03-17T15:01:20Z", "message": "Changes requested after wiz review"}, "afterCommit": {"oid": "f94f70efe9afd44ebff20953f62286b71bad70fa", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/f94f70efe9afd44ebff20953f62286b71bad70fa", "committedDate": "2020-03-17T15:12:58Z", "message": "Allow IPv6 connections to Bitcoin nodes (fixes #3990)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MTM5MTU3", "url": "https://github.com/bisq-network/bisq/pull/4045#pullrequestreview-376139157", "createdAt": "2020-03-17T15:23:08Z", "commit": {"oid": "f94f70efe9afd44ebff20953f62286b71bad70fa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNToyMzowOFrOF3hOVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNToyMzowOFrOF3hOVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc2MDM0Mg==", "bodyText": "Is there a drawback when we set this as default for all nodes?", "url": "https://github.com/bisq-network/bisq/pull/4045#discussion_r393760342", "createdAt": "2020-03-17T15:23:08Z", "author": {"login": "ripcurlx"}, "path": "common/src/main/java/bisq/common/setup/CommonSetup.java", "diffHunk": "@@ -38,6 +38,9 @@ public static void setup(UncaughtExceptionHandler uncaughtExceptionHandler) {\n \n         if (Utilities.isLinux())\n             System.setProperty(\"prism.lcdtext\", \"false\");\n+\n+        // #3990 allow IPv6 custom Bitcoin node in settings by hostname\n+        System.setProperty(\"java.net.preferIPv6Addresses\", \"true\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f94f70efe9afd44ebff20953f62286b71bad70fa"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f94f70efe9afd44ebff20953f62286b71bad70fa", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/f94f70efe9afd44ebff20953f62286b71bad70fa", "committedDate": "2020-03-17T15:12:58Z", "message": "Allow IPv6 connections to Bitcoin nodes (fixes #3990)"}, "afterCommit": {"oid": "26d34b7b6f504247c2d14547013418df9ed0f35d", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/26d34b7b6f504247c2d14547013418df9ed0f35d", "committedDate": "2020-03-18T16:00:09Z", "message": "Allow IPv6 connections to Bitcoin nodes (fixes #3990)\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.  For clearnet use, we tell Java that IPv6 is prefered\nvia setting the property `java.net.preferIPv6Addresses`."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTAxOTI2", "url": "https://github.com/bisq-network/bisq/pull/4045#pullrequestreview-377101926", "createdAt": "2020-03-18T17:50:02Z", "commit": {"oid": "26d34b7b6f504247c2d14547013418df9ed0f35d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTU5NDA5", "url": "https://github.com/bisq-network/bisq/pull/4045#pullrequestreview-377159409", "createdAt": "2020-03-18T19:10:01Z", "commit": {"oid": "dd46bf8440aa322f38793b2be8dbc3168283a23b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c130b1022401a6c5df7683df609d729fbf3c6e86", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/c130b1022401a6c5df7683df609d729fbf3c6e86", "committedDate": "2020-03-19T13:06:34Z", "message": "New command line option: useIPv6ForBtc=true"}, "afterCommit": {"oid": "dd46bf8440aa322f38793b2be8dbc3168283a23b", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/dd46bf8440aa322f38793b2be8dbc3168283a23b", "committedDate": "2020-03-18T18:12:35Z", "message": "Bugfix in detection of hostnames with port"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c708d3fe518fa6c2c88555f0e3df97264ef9194", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/5c708d3fe518fa6c2c88555f0e3df97264ef9194", "committedDate": "2020-03-19T19:13:56Z", "message": "remove silly Java.net flag"}, "afterCommit": {"oid": "098f4f479a97c087919bc639e52dd7850f05e535", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/098f4f479a97c087919bc639e52dd7850f05e535", "committedDate": "2020-03-19T19:15:32Z", "message": "Allow IPv6 connections to Bitcoin nodes (fixes #3990)\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.  For clearnet use, we tell Java that IPv6 is prefered\nvia setting the property `java.net.preferIPv6Addresses`."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1a8d944bf8e3561a79802c055d8325716b09983", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/b1a8d944bf8e3561a79802c055d8325716b09983", "committedDate": "2020-03-19T19:20:50Z", "message": "Allow IPv6 connections to Bitcoin nodes\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.\n\nFixes #3990"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "098f4f479a97c087919bc639e52dd7850f05e535", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/098f4f479a97c087919bc639e52dd7850f05e535", "committedDate": "2020-03-19T19:15:32Z", "message": "Allow IPv6 connections to Bitcoin nodes (fixes #3990)\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.  For clearnet use, we tell Java that IPv6 is prefered\nvia setting the property `java.net.preferIPv6Addresses`."}, "afterCommit": {"oid": "607dbec30c04752752150682362c0553d8a82a1f", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/607dbec30c04752752150682362c0553d8a82a1f", "committedDate": "2020-03-19T19:17:57Z", "message": "Allow IPv6 connections to Bitcoin nodes\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.  For clearnet use, we tell Java that IPv6 is prefered\nvia setting the property `java.net.preferIPv6Addresses`.\n\nFixes #3990"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "607dbec30c04752752150682362c0553d8a82a1f", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/607dbec30c04752752150682362c0553d8a82a1f", "committedDate": "2020-03-19T19:17:57Z", "message": "Allow IPv6 connections to Bitcoin nodes\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.  For clearnet use, we tell Java that IPv6 is prefered\nvia setting the property `java.net.preferIPv6Addresses`.\n\nFixes #3990"}, "afterCommit": {"oid": "b1a8d944bf8e3561a79802c055d8325716b09983", "author": {"user": {"login": "jmacxx", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/b1a8d944bf8e3561a79802c055d8325716b09983", "committedDate": "2020-03-19T19:20:50Z", "message": "Allow IPv6 connections to Bitcoin nodes\n\nCurrently bisq desktop does not accept IPv6 addresses in the settings for\ncustom nodes or via the --btcNodes command line option.  The separation of\naddress and port is handled incorrectly in core / BtcNodes::fromFullAddress.\nThis results in IPv6 addresses being ignored.  Where Tor is enabled for\nBitcoin connections, we need to handle the IPv6 address response\nfrom Tor DNS lookup.\n\nFixes #3990"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MDQxNjM5", "url": "https://github.com/bisq-network/bisq/pull/4045#pullrequestreview-378041639", "createdAt": "2020-03-19T19:46:53Z", "commit": {"oid": "b1a8d944bf8e3561a79802c055d8325716b09983"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NTY5MTM3", "url": "https://github.com/bisq-network/bisq/pull/4045#pullrequestreview-378569137", "createdAt": "2020-03-20T15:12:04Z", "commit": {"oid": "b1a8d944bf8e3561a79802c055d8325716b09983"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3340, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}