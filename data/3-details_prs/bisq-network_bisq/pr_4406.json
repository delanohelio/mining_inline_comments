{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MDY1NDgz", "number": 4406, "title": "Update GUI labels to reflect multiple rate providers", "bodyText": "Update the Bisq GUI labels to better indicate the source of the exchange rate data.\nThe areas changed are:\n\nlabels in the top-right box showing the exchange rate\nlabel in the About view\n\n1) Top right box / The shown text for fiat and alts:\n\n1) Top right box / The tooltip for fiat and alts:\n\n\n2) About view / Source of market prices under Data Providers\n\n\nAddresses bisq-network/projects#35\nRelated to #4315", "createdAt": "2020-08-08T19:21:11Z", "url": "https://github.com/bisq-network/bisq/pull/4406", "merged": true, "mergeCommit": {"oid": "6ed770491cf92c65e02d9caed5de22e3d730c273"}, "closed": true, "closedAt": "2020-08-20T09:21:45Z", "author": {"login": "cd2357"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc886V3AH2gAyNDY1MDY1NDgzOmI4YTc2YjBlOTI1MWJkZjQxOGE4MTg0ODE1YmRjOWRiMmVkZGY3YmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAsrmigFqTQ3MTQxMzgyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b8a76b0e9251bdf418a8184815bdc9db2eddf7bb", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/b8a76b0e9251bdf418a8184815bdc9db2eddf7bb", "committedDate": "2020-08-08T17:59:34Z", "message": "Update top-right bar references to price source\n\nUpdate the displayed text, as well as the tooltip, of the price box in\nthe top right bar. It now indicates that the price data is provided by\nBisq pricenodes (for for fiat, as well as for alts)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "189431ed7ea72930f000bbee4b24aa8cbf440e35", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/189431ed7ea72930f000bbee4b24aa8cbf440e35", "committedDate": "2020-08-08T19:00:45Z", "message": "Correctly map lastRequest timestamp\n\nThe lastRequest timestamp is changed to show the last request to a\npricenode.\n\nThe previous approach of using the \"last provider request timestamp\"\ndoes not make sense in the new setup. Each currency rate is based on\nrates from several providers, each with their own \"request timestamps\".\nIn addition, the pricenode returns the timestamp each rate was\ncalculated. On top of that comes the timestamp when the Bisq node\nqueries the pricenode.\n\nSince what is most relevant for the Bisq node is the \"freshness\" of a\nspecific rate, the timestamp most indicative of that is the moment when\nthe pricenode is queried."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a4c11cb350d58a5c3111c3eb096a78c9e4ce641", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/2a4c11cb350d58a5c3111c3eb096a78c9e4ce641", "committedDate": "2020-08-08T19:02:57Z", "message": "Remove unused methods\n\nRemoved getters for the BA and CMC timestamps, both of which are not\nused anymore."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f73f4174dd77e222e02cab3e510287d9e14eef6c", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/f73f4174dd77e222e02cab3e510287d9e14eef6c", "committedDate": "2020-08-08T19:04:17Z", "message": "Rename method\n\nRename method to remove reference to the BA provider."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "584e516fc445ca920be14cb5aaa696daea2af32c", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/584e516fc445ca920be14cb5aaa696daea2af32c", "committedDate": "2020-08-08T19:14:23Z", "message": "Rename timestamp field\n\nRename timestamp field which implied it represents an epoch value in\nseconds, but the way it was used to build a Date object showed that it\nactually expected a millis value."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODI0NDQ3", "url": "https://github.com/bisq-network/bisq/pull/4406#pullrequestreview-463824447", "createdAt": "2020-08-08T20:05:26Z", "commit": {"oid": "584e516fc445ca920be14cb5aaa696daea2af32c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQyMDowNToyN1rOG916Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQyMDowNToyN1rOG916Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ5OTU4Ng==", "bodyText": "Hold on a second, this isn't just changing labels, you're actually changing code here. It looks like you're replacing the timestamp of the actual price data, with the timestamp Bisq updated it from the Pricenode, which is incorrect. This behavior needs to be preserved, for example if a pricenode has an issue and doesn't get data updates, the local Bisq node needs to be able to detect that it's old data and switch to a different Pricenode with recently updated data.", "url": "https://github.com/bisq-network/bisq/pull/4406#discussion_r467499586", "createdAt": "2020-08-08T20:05:27Z", "author": {"login": "wiz"}, "path": "core/src/main/java/bisq/core/provider/price/PriceFeedService.java", "diffHunk": "@@ -400,7 +384,12 @@ public void onSuccess(@Nullable Tuple2<Map<String, Long>, Map<String, MarketPric\n                 UserThread.execute(() -> {\n                     checkNotNull(result, \"Result must not be null at requestAllPrices\");\n                     timeStampMap = result.first;\n-                    epochInSecondAtLastRequest = timeStampMap.get(\"btcAverageTs\");\n+\n+                    // Each currency rate has a different timestamp, depending on when\n+                    // the pricenode aggregate rate was calculated\n+                    // However, the request timestamp is when the pricenode was queried\n+                    epochInMillisAtLastRequest = System.currentTimeMillis();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "584e516fc445ca920be14cb5aaa696daea2af32c"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f534939b35f8f63e0a47dce6df8fe3069673c08c", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/f534939b35f8f63e0a47dce6df8fe3069673c08c", "committedDate": "2020-08-09T11:13:10Z", "message": "Update labels to indicate Bisq Price Index\n\nUpdate top-right status box and tooltip labels to indicate the price is\nbased on the Bisq Price Index."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ddb2c2ca2938cb443f4df635f7947feb1db83b3", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/2ddb2c2ca2938cb443f4df635f7947feb1db83b3", "committedDate": "2020-08-09T11:52:57Z", "message": "Update top-right tooltip timestamp\n\nUpdate timestamp shown in top-right tooltip, to indicate the point in\ntime when that specific exchange rate was retrieved (from an Exchange,\nif only one exchange supported for that currency) or when it was\ncalculated (by the pricenode, based on inputs from multiple exchanges)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef5b80440cda2eee7de2f5c155eedfaf042cb3dd", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/ef5b80440cda2eee7de2f5c155eedfaf042cb3dd", "committedDate": "2020-08-09T13:28:09Z", "message": "Update exchange rate info in About view\n\nUpdate field describing the source of the shown exchange rates,\nindicating that the Bisq Price Index is used."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5fa0fe676ed53111ef5610838ff3e9d6615de4d3", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/5fa0fe676ed53111ef5610838ff3e9d6615de4d3", "committedDate": "2020-08-09T13:26:22Z", "message": "Update displayStrings_zh-hans.properties"}, "afterCommit": {"oid": "ef5b80440cda2eee7de2f5c155eedfaf042cb3dd", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/ef5b80440cda2eee7de2f5c155eedfaf042cb3dd", "committedDate": "2020-08-09T13:28:09Z", "message": "Update exchange rate info in About view\n\nUpdate field describing the source of the shown exchange rates,\nindicating that the Bisq Price Index is used."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODg3Mzk0", "url": "https://github.com/bisq-network/bisq/pull/4406#pullrequestreview-463887394", "createdAt": "2020-08-09T16:36:43Z", "commit": {"oid": "ef5b80440cda2eee7de2f5c155eedfaf042cb3dd"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODkzMTQ4", "url": "https://github.com/bisq-network/bisq/pull/4406#pullrequestreview-463893148", "createdAt": "2020-08-09T18:12:23Z", "commit": {"oid": "ef5b80440cda2eee7de2f5c155eedfaf042cb3dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQxODoxMjoyM1rOG98zSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQxODoxMjoyM1rOG98zSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzYxMjQ5MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            setting.about.apisWithFee=Bisq uses 3rd party APIs for Fiat and Altcoin market prices as well as for mining fee estimation.\n          \n          \n            \n            setting.about.apis=Bisq uses 3rd party APIs for Fiat and Altcoin market prices.\n          \n          \n            \n            +setting.about.apisWithFee=Bisq uses Bisq Price Indices for Fiat and Altcoin market prices, and Bisq Mempool Nodes for mining fee estimation.\n          \n          \n            \n            +setting.about.apis=Bisq uses Bisq Price Indices for Fiat and Altcoin market prices.", "url": "https://github.com/bisq-network/bisq/pull/4406#discussion_r467612490", "createdAt": "2020-08-09T18:12:23Z", "author": {"login": "wiz"}, "path": "core/src/main/resources/i18n/displayStrings.properties", "diffHunk": "@@ -1166,7 +1165,6 @@ setting.about.providers=Data providers\n setting.about.apisWithFee=Bisq uses 3rd party APIs for Fiat and Altcoin market prices as well as for mining fee estimation.\n setting.about.apis=Bisq uses 3rd party APIs for Fiat and Altcoin market prices.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef5b80440cda2eee7de2f5c155eedfaf042cb3dd"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdc624277958636b2a8c497b0926be87530becd9", "author": {"user": {"login": "cd2357", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/cdc624277958636b2a8c497b0926be87530becd9", "committedDate": "2020-08-09T18:13:37Z", "message": "Update core/src/main/resources/i18n/displayStrings.properties\n\nCo-authored-by: wiz <j@wiz.biz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NDIwMjAw", "url": "https://github.com/bisq-network/bisq/pull/4406#pullrequestreview-469420200", "createdAt": "2020-08-18T12:47:37Z", "commit": {"oid": "cdc624277958636b2a8c497b0926be87530becd9"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNDEzODI1", "url": "https://github.com/bisq-network/bisq/pull/4406#pullrequestreview-471413825", "createdAt": "2020-08-20T09:20:41Z", "commit": {"oid": "cdc624277958636b2a8c497b0926be87530becd9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3245, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}