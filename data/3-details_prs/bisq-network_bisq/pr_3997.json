{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MjUwNDg1", "number": 3997, "title": "Add pricenode one-command installer script, systemd service, README", "bodyText": "", "createdAt": "2020-02-21T12:05:07Z", "url": "https://github.com/bisq-network/bisq/pull/3997", "merged": true, "mergeCommit": {"oid": "21101f460c5d2136c8d28f5be95efaafb707581e"}, "closed": true, "closedAt": "2020-02-26T11:16:27Z", "author": {"login": "wiz"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGfMISAFqTM2MjYwNjU2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIE0jfAFqTM2NDgxNDk1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNjA2NTYx", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-362606561", "createdAt": "2020-02-21T12:49:56Z", "commit": {"oid": "4f7b17425b334e629dcf37fa31262dd3cca9d538"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNjYyNjUz", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-362662653", "createdAt": "2020-02-21T14:23:34Z", "commit": {"oid": "deacffbdb823346a8dc66e8655c8b220b6918879"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMzozNVrOFs4fNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMzozNVrOFs4fNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNzE1OA==", "bodyText": "Should be \"Access your pricenode\".", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382607158", "createdAt": "2020-02-21T14:23:35Z", "author": {"login": "cbeams"}, "path": "pricenode/install_pricenode_debian.sh", "diffHunk": "@@ -0,0 +1,89 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+echo \"[*] Bisq bisq-pricenode installation script\"\n+\n+##### change as necessary for your system\n+\n+SYSTEMD_SERVICE_HOME=/etc/systemd/system\n+#SYSTEMD_ENV_HOME=/etc/default\n+\n+ROOT_USER=root\n+ROOT_GROUP=root\n+#ROOT_HOME=/root\n+\n+BISQ_USER=bisq\n+BISQ_GROUP=bisq\n+BISQ_HOME=/bisq\n+\n+BISQ_REPO_URL=https://github.com/bisq-network/bisq\n+BISQ_REPO_NAME=bisq\n+BISQ_REPO_TAG=master\n+BISQ_LATEST_RELEASE=$(curl -s https://api.github.com/repos/bisq-network/bisq/releases/latest|grep tag_name|head -1|cut -d '\"' -f4)\n+BISQ_TORHS=pricenode\n+\n+TOR_PKG=\"tor\"\n+#TOR_USER=debian-tor\n+TOR_GROUP=debian-tor\n+TOR_CONF=/etc/tor/torrc\n+TOR_RESOURCES=/var/lib/tor\n+\n+#####\n+\n+echo \"[*] Upgrading apt packages\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get update -q\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get upgrade -qq -y\n+\n+echo \"[*] Installing Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get install -qq -y \"${TOR_PKG}\"\n+\n+echo \"[*] Adding Tor configuration\"\n+if ! grep \"${BISQ_TORHS}\" /etc/tor/torrc >/dev/null 2>&1;then\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceDir ${TOR_RESOURCES}/${BISQ_TORHS}/ >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServicePort 80 127.0.0.1:8080 >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceVersion 2 >> ${TOR_CONF}\"\n+fi\n+\n+echo \"[*] Creating Bisq user with Tor access\"\n+sudo -H -i -u \"${ROOT_USER}\" useradd -d \"${BISQ_HOME}\" -G \"${TOR_GROUP}\" \"${BISQ_USER}\"\n+\n+echo \"[*] Creating Bisq homedir\"\n+sudo -H -i -u \"${ROOT_USER}\" mkdir -p \"${BISQ_HOME}\"\n+sudo -H -i -u \"${ROOT_USER}\" chown \"${BISQ_USER}\":\"${BISQ_GROUP}\" ${BISQ_HOME}\n+\n+echo \"[*] Cloning Bisq repo\"\n+sudo -H -i -u \"${BISQ_USER}\" git config --global advice.detachedHead false\n+sudo -H -i -u \"${BISQ_USER}\" git clone --branch \"${BISQ_REPO_TAG}\" \"${BISQ_REPO_URL}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}\"\n+\n+echo \"[*] Installing OpenJDK 10.0.2 from Bisq repo\"\n+sudo -H -i -u \"${ROOT_USER}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}/scripts/install_java.sh\"\n+\n+echo \"[*] Checking out Bisq ${BISQ_LATEST_RELEASE}\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && git checkout ${BISQ_LATEST_RELEASE}\"\n+\n+echo \"[*] Building Bisq from source\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue\n+\n+echo \"[*] Installing bisq-pricenode systemd service\"\n+sudo -H -i -u \"${ROOT_USER}\" install -c -o \"${ROOT_USER}\" -g \"${ROOT_GROUP}\" -m 644 \"${BISQ_HOME}/${BISQ_REPO_NAME}/pricenode/bisq-pricenode.service\" \"${SYSTEMD_SERVICE_HOME}\"\n+\n+echo \"[*] Reloading systemd daemon configuration\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl daemon-reload\n+\n+echo \"[*] Enabling bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl enable bisq-pricenode.service\n+\n+echo \"[*] Starting bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl start bisq-pricenode.service\n+sleep 5\n+sudo -H -i -u \"${ROOT_USER}\" journalctl --no-pager --unit bisq-pricenode\n+\n+echo \"[*] Restarting Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" service tor restart\n+sleep 5\n+\n+echo '[*] Done!'\n+echo -n '[*] Access your explorer at http://'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deacffbdb823346a8dc66e8655c8b220b6918879"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNjYzNDUy", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-362663452", "createdAt": "2020-02-21T14:24:39Z", "commit": {"oid": "deacffbdb823346a8dc66e8655c8b220b6918879"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNDozOVrOFs4hpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNDozOVrOFs4hpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNzc4MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            echo -n '[*] Access your explorer at http://'\n          \n          \n            \n            echo -n '[*] Access your pricenode at http://'", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382607781", "createdAt": "2020-02-21T14:24:39Z", "author": {"login": "wiz"}, "path": "pricenode/install_pricenode_debian.sh", "diffHunk": "@@ -0,0 +1,89 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+echo \"[*] Bisq bisq-pricenode installation script\"\n+\n+##### change as necessary for your system\n+\n+SYSTEMD_SERVICE_HOME=/etc/systemd/system\n+#SYSTEMD_ENV_HOME=/etc/default\n+\n+ROOT_USER=root\n+ROOT_GROUP=root\n+#ROOT_HOME=/root\n+\n+BISQ_USER=bisq\n+BISQ_GROUP=bisq\n+BISQ_HOME=/bisq\n+\n+BISQ_REPO_URL=https://github.com/bisq-network/bisq\n+BISQ_REPO_NAME=bisq\n+BISQ_REPO_TAG=master\n+BISQ_LATEST_RELEASE=$(curl -s https://api.github.com/repos/bisq-network/bisq/releases/latest|grep tag_name|head -1|cut -d '\"' -f4)\n+BISQ_TORHS=pricenode\n+\n+TOR_PKG=\"tor\"\n+#TOR_USER=debian-tor\n+TOR_GROUP=debian-tor\n+TOR_CONF=/etc/tor/torrc\n+TOR_RESOURCES=/var/lib/tor\n+\n+#####\n+\n+echo \"[*] Upgrading apt packages\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get update -q\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get upgrade -qq -y\n+\n+echo \"[*] Installing Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get install -qq -y \"${TOR_PKG}\"\n+\n+echo \"[*] Adding Tor configuration\"\n+if ! grep \"${BISQ_TORHS}\" /etc/tor/torrc >/dev/null 2>&1;then\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceDir ${TOR_RESOURCES}/${BISQ_TORHS}/ >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServicePort 80 127.0.0.1:8080 >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceVersion 2 >> ${TOR_CONF}\"\n+fi\n+\n+echo \"[*] Creating Bisq user with Tor access\"\n+sudo -H -i -u \"${ROOT_USER}\" useradd -d \"${BISQ_HOME}\" -G \"${TOR_GROUP}\" \"${BISQ_USER}\"\n+\n+echo \"[*] Creating Bisq homedir\"\n+sudo -H -i -u \"${ROOT_USER}\" mkdir -p \"${BISQ_HOME}\"\n+sudo -H -i -u \"${ROOT_USER}\" chown \"${BISQ_USER}\":\"${BISQ_GROUP}\" ${BISQ_HOME}\n+\n+echo \"[*] Cloning Bisq repo\"\n+sudo -H -i -u \"${BISQ_USER}\" git config --global advice.detachedHead false\n+sudo -H -i -u \"${BISQ_USER}\" git clone --branch \"${BISQ_REPO_TAG}\" \"${BISQ_REPO_URL}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}\"\n+\n+echo \"[*] Installing OpenJDK 10.0.2 from Bisq repo\"\n+sudo -H -i -u \"${ROOT_USER}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}/scripts/install_java.sh\"\n+\n+echo \"[*] Checking out Bisq ${BISQ_LATEST_RELEASE}\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && git checkout ${BISQ_LATEST_RELEASE}\"\n+\n+echo \"[*] Building Bisq from source\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue\n+\n+echo \"[*] Installing bisq-pricenode systemd service\"\n+sudo -H -i -u \"${ROOT_USER}\" install -c -o \"${ROOT_USER}\" -g \"${ROOT_GROUP}\" -m 644 \"${BISQ_HOME}/${BISQ_REPO_NAME}/pricenode/bisq-pricenode.service\" \"${SYSTEMD_SERVICE_HOME}\"\n+\n+echo \"[*] Reloading systemd daemon configuration\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl daemon-reload\n+\n+echo \"[*] Enabling bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl enable bisq-pricenode.service\n+\n+echo \"[*] Starting bisq-pricenode service\"\n+sudo -H -i -u \"${ROOT_USER}\" systemctl start bisq-pricenode.service\n+sleep 5\n+sudo -H -i -u \"${ROOT_USER}\" journalctl --no-pager --unit bisq-pricenode\n+\n+echo \"[*] Restarting Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" service tor restart\n+sleep 5\n+\n+echo '[*] Done!'\n+echo -n '[*] Access your explorer at http://'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "deacffbdb823346a8dc66e8655c8b220b6918879"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDIzODU0", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363023854", "createdAt": "2020-02-22T11:15:54Z", "commit": {"oid": "f180cd7ae91e267761666d1abfedf9c716961c80"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxNTo1NFrOFtKsvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxNTo1NFrOFtKsvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkwNTUzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            service bisq status >/dev/null 2>&1\n          \n          \n            \n            set +e\n          \n          \n            \n            service bisq status >/dev/null 2>&1", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382905533", "createdAt": "2020-02-22T11:15:54Z", "author": {"login": "wiz"}, "path": "monitor/install_collectd_debian.sh", "diffHunk": "@@ -50,7 +52,10 @@ sudo -H -i -u \"${ROOT_USER}\" systemctl enable nginx.service\n sudo -H -i -u \"${ROOT_USER}\" systemctl enable collectd.service\n \n echo \"[*] Restarting services\"\n-sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq.service\n+service bisq status >/dev/null 2>&1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f180cd7ae91e267761666d1abfedf9c716961c80"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDIzOTM3", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363023937", "createdAt": "2020-02-22T11:18:00Z", "commit": {"oid": "fb5b0ce80721f397378489e8297b853f6dd37996"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxODowMFrOFtKtJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToxODowMFrOFtKtJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkwNTYzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            Environment=\"JAVA_OPTS=-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=true -Dcom.sun.management.jmxremote.port=6969 -Dcom.sun.management.jmxremote.rmi.port=6969 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false\"", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382905639", "createdAt": "2020-02-22T11:18:00Z", "author": {"login": "wiz"}, "path": "pricenode/bisq-pricenode.service", "diffHunk": "@@ -0,0 +1,22 @@\n+[Unit]\n+Description=Bisq Price Node\n+After=network.target\n+\n+[Service]\n+Environment=\"BITCOIN_AVG_PUBKEY=__BITCOIN_AVG_PUBKEY__\"\n+Environment=\"BITCOIN_AVG_PRIVKEY=__BITCOIN_AVG_PRIVKEY__\"\n+ExecStart=/usr/bin/java -jar /bisq/bisq/lib/pricenode-0.7.2-SNAPSHOT.jar 2 2\n+ExecStop=/bin/kill -TERM ${MAINPID}\n+Restart=on-failure\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb5b0ce80721f397378489e8297b853f6dd37996"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDI0MTI0", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363024124", "createdAt": "2020-02-22T11:22:37Z", "commit": {"oid": "fb5b0ce80721f397378489e8297b853f6dd37996"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToyMjozOFrOFtKuIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxMToyMjozOFrOFtKuIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkwNTg4OA==", "bodyText": "this lets errors slip through and leave operators in the believe that everything is fine.\nSomething like this may do it. I am pretty sure though that if I really want to break it I still can.\nset +e\nservice bisq status >/dev/null 2>&1\n[ $? != 4 ] && set -e && sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq.service\nset +e\nservice bisq-pricenode status >/dev/null 2>&1\n[ $? != 4 ] && set -e && sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq-pricenode.service\nset -e", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r382905888", "createdAt": "2020-02-22T11:22:38Z", "author": {"login": "freimair"}, "path": "monitor/install_collectd_debian.sh", "diffHunk": "@@ -50,7 +52,11 @@ sudo -H -i -u \"${ROOT_USER}\" systemctl enable nginx.service\n sudo -H -i -u \"${ROOT_USER}\" systemctl enable collectd.service\n \n echo \"[*] Restarting services\"\n-sudo -H -i -u \"${ROOT_USER}\" systemctl restart bisq.service\n+set +e", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb5b0ce80721f397378489e8297b853f6dd37996"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eca27f7b5f43322533ca3bf0b0ef845df687788e", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/eca27f7b5f43322533ca3bf0b0ef845df687788e", "committedDate": "2020-02-22T11:18:36Z", "message": "Update pricenode/bisq-pricenode.service"}, "afterCommit": {"oid": "c23f0321f09af79bcd340482277dd4724883341b", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/c23f0321f09af79bcd340482277dd4724883341b", "committedDate": "2020-02-22T11:27:53Z", "message": "Modify collectd installer to use either bisq or bisq-pricenode services"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDI0NDA4", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363024408", "createdAt": "2020-02-22T11:30:12Z", "commit": {"oid": "c23f0321f09af79bcd340482277dd4724883341b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDI0NDIz", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363024423", "createdAt": "2020-02-22T11:30:32Z", "commit": {"oid": "c23f0321f09af79bcd340482277dd4724883341b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDMwNjcz", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363030673", "createdAt": "2020-02-22T14:10:43Z", "commit": {"oid": "8816690dddb2b541eba6b64e550e3e2090edaed4"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/3df64b2115cdf5eac8db1ce0ff708be78e091254", "committedDate": "2020-02-22T14:34:42Z", "message": "Add pricenode one-command installer script, systemd service, README"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8816690dddb2b541eba6b64e550e3e2090edaed4", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/8816690dddb2b541eba6b64e550e3e2090edaed4", "committedDate": "2020-02-22T12:02:29Z", "message": "More pricenode monitoring related changes requested by @freimair"}, "afterCommit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/3df64b2115cdf5eac8db1ce0ff708be78e091254", "committedDate": "2020-02-22T14:34:42Z", "message": "Add pricenode one-command installer script, systemd service, README"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMzk5OTgx", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363399981", "createdAt": "2020-02-24T13:49:33Z", "commit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNDEwNTY4", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363410568", "createdAt": "2020-02-24T14:05:14Z", "commit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDowNToxNFrOFthtAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDowNToxNFrOFthtAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzI4MjQzMw==", "bodyText": "Is there a specific reason not to use the start script /bisq/bisq/bisq-pricenode for the price node?\nAs there is a specific version hard coded in the service file seems like we might risk missing updating the bisq.service file and thus, producing maintenance issues and efforts.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ExecStart=/usr/bin/java -jar /bisq/bisq/lib/pricenode-0.7.2-SNAPSHOT.jar 2 2\n          \n          \n            \n            ExecStart=/bisq/bisq/bisq-pricenode 2 2", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r383282433", "createdAt": "2020-02-24T14:05:14Z", "author": {"login": "freimair"}, "path": "pricenode/bisq-pricenode.service", "diffHunk": "@@ -0,0 +1,21 @@\n+[Unit]\n+Description=Bisq Price Node\n+After=network.target\n+\n+[Service]\n+EnvironmentFile=/etc/default/bisq-pricenode.env\n+ExecStart=/usr/bin/java -jar /bisq/bisq/lib/pricenode-0.7.2-SNAPSHOT.jar 2 2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNDQ2NzM5", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-363446739", "createdAt": "2020-02-24T14:53:29Z", "commit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDo1MzoyOVrOFtjbhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDo1MzoyOVrOFtjbhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzMxMDcyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue\n          \n          \n            \n            sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew :pricenode:installDist  -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue", "url": "https://github.com/bisq-network/bisq/pull/3997#discussion_r383310725", "createdAt": "2020-02-24T14:53:29Z", "author": {"login": "freimair"}, "path": "pricenode/install_pricenode_debian.sh", "diffHunk": "@@ -0,0 +1,90 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+echo \"[*] Bisq bisq-pricenode installation script\"\n+\n+##### change as necessary for your system\n+\n+SYSTEMD_SERVICE_HOME=/etc/systemd/system\n+SYSTEMD_ENV_HOME=/etc/default\n+\n+ROOT_USER=root\n+ROOT_GROUP=root\n+#ROOT_HOME=/root\n+\n+BISQ_USER=bisq\n+BISQ_GROUP=bisq\n+BISQ_HOME=/bisq\n+\n+BISQ_REPO_URL=https://github.com/bisq-network/bisq\n+BISQ_REPO_NAME=bisq\n+BISQ_REPO_TAG=master\n+BISQ_LATEST_RELEASE=$(curl -s https://api.github.com/repos/bisq-network/bisq/releases/latest|grep tag_name|head -1|cut -d '\"' -f4)\n+BISQ_TORHS=pricenode\n+\n+TOR_PKG=\"tor\"\n+#TOR_USER=debian-tor\n+TOR_GROUP=debian-tor\n+TOR_CONF=/etc/tor/torrc\n+TOR_RESOURCES=/var/lib/tor\n+\n+#####\n+\n+echo \"[*] Upgrading apt packages\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get update -q\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get upgrade -qq -y\n+\n+echo \"[*] Installing Tor\"\n+sudo -H -i -u \"${ROOT_USER}\" DEBIAN_FRONTEND=noninteractive apt-get install -qq -y \"${TOR_PKG}\"\n+\n+echo \"[*] Adding Tor configuration\"\n+if ! grep \"${BISQ_TORHS}\" /etc/tor/torrc >/dev/null 2>&1;then\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceDir ${TOR_RESOURCES}/${BISQ_TORHS}/ >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServicePort 80 127.0.0.1:8080 >> ${TOR_CONF}\"\n+  sudo -H -i -u \"${ROOT_USER}\" sh -c \"echo HiddenServiceVersion 2 >> ${TOR_CONF}\"\n+fi\n+\n+echo \"[*] Creating Bisq user with Tor access\"\n+sudo -H -i -u \"${ROOT_USER}\" useradd -d \"${BISQ_HOME}\" -G \"${TOR_GROUP}\" \"${BISQ_USER}\"\n+\n+echo \"[*] Creating Bisq homedir\"\n+sudo -H -i -u \"${ROOT_USER}\" mkdir -p \"${BISQ_HOME}\"\n+sudo -H -i -u \"${ROOT_USER}\" chown \"${BISQ_USER}\":\"${BISQ_GROUP}\" ${BISQ_HOME}\n+\n+echo \"[*] Cloning Bisq repo\"\n+sudo -H -i -u \"${BISQ_USER}\" git config --global advice.detachedHead false\n+sudo -H -i -u \"${BISQ_USER}\" git clone --branch \"${BISQ_REPO_TAG}\" \"${BISQ_REPO_URL}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}\"\n+\n+echo \"[*] Installing OpenJDK 10.0.2 from Bisq repo\"\n+sudo -H -i -u \"${ROOT_USER}\" \"${BISQ_HOME}/${BISQ_REPO_NAME}/scripts/install_java.sh\"\n+\n+echo \"[*] Checking out Bisq ${BISQ_LATEST_RELEASE}\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && git checkout ${BISQ_LATEST_RELEASE}\"\n+\n+echo \"[*] Building Bisq from source\"\n+sudo -H -i -u \"${BISQ_USER}\" sh -c \"cd ${BISQ_HOME}/${BISQ_REPO_NAME} && ./gradlew build -x test < /dev/null\" # redirect from /dev/null is necessary to workaround gradlew non-interactive shell hanging issue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df64b2115cdf5eac8db1ce0ff708be78e091254"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6f2106205b1997751cf12b29346b5864e800ce7", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/f6f2106205b1997751cf12b29346b5864e800ce7", "committedDate": "2020-02-24T15:06:41Z", "message": "Update pricenode/bisq-pricenode.service\n\nCo-Authored-By: Florian Reimair <office@florianreimair.at>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fb89892b0ddae91064ebd4321d81535ed59b241", "author": {"user": {"login": "wiz", "name": null}}, "url": "https://github.com/bisq-network/bisq/commit/2fb89892b0ddae91064ebd4321d81535ed59b241", "committedDate": "2020-02-24T15:07:44Z", "message": "Update pricenode/install_pricenode_debian.sh\n\nCo-Authored-By: Florian Reimair <office@florianreimair.at>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MDE5OTYw", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-364019960", "createdAt": "2020-02-25T10:13:53Z", "commit": {"oid": "2fb89892b0ddae91064ebd4321d81535ed59b241"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODE0OTUx", "url": "https://github.com/bisq-network/bisq/pull/3997#pullrequestreview-364814951", "createdAt": "2020-02-26T11:14:30Z", "commit": {"oid": "2fb89892b0ddae91064ebd4321d81535ed59b241"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3331, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}