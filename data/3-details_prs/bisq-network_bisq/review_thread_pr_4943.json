{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MDU4NDIx", "number": 4943, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozNDowN1rOFFEtDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozNDowN1rOFFEtDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwODY0MjY4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/bisq/core/btc/wallet/http/MemPoolSpaceTxBroadcaster.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozNDowN1rOIFZLqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNzozODo0OVrOIFcNYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNjM3OA==", "bodyText": "Instead of checking for that exact message, maybe just checking for a substring of \\\"code\\\":-27 is better, since the exact string might change in future releases of Bitcoin Core RPC", "url": "https://github.com/bisq-network/bisq/pull/4943#discussion_r542526378", "createdAt": "2020-12-14T16:34:07Z", "author": {"login": "wiz"}, "path": "core/src/main/java/bisq/core/btc/wallet/http/MemPoolSpaceTxBroadcaster.java", "diffHunk": "@@ -115,8 +114,21 @@ public void onSuccess(String txId) {\n             }\n \n             public void onFailure(@NotNull Throwable throwable) {\n-                log.warn(\"Broadcast of raw tx with txId {} to {} failed. Error={}\",\n-                        txIdToSend, url, throwable.toString());\n+                Throwable cause = throwable.getCause();\n+                if (cause instanceof HttpException) {\n+                    int responseCode = ((HttpException) cause).getResponseCode();\n+                    String message = cause.getMessage();\n+                    if (responseCode == 400 && message.equals(\"sendrawtransaction RPC error: {\\\"code\\\":-27,\\\"message\\\":\\\"Transaction already in block chain\\\"}\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "300671abb2c1407c1959994edaac441e37ec0b09"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU2MTI2MA==", "bodyText": "ok. do you have a list of other return codes/messages?", "url": "https://github.com/bisq-network/bisq/pull/4943#discussion_r542561260", "createdAt": "2020-12-14T17:18:42Z", "author": {"login": "chimp1984"}, "path": "core/src/main/java/bisq/core/btc/wallet/http/MemPoolSpaceTxBroadcaster.java", "diffHunk": "@@ -115,8 +114,21 @@ public void onSuccess(String txId) {\n             }\n \n             public void onFailure(@NotNull Throwable throwable) {\n-                log.warn(\"Broadcast of raw tx with txId {} to {} failed. Error={}\",\n-                        txIdToSend, url, throwable.toString());\n+                Throwable cause = throwable.getCause();\n+                if (cause instanceof HttpException) {\n+                    int responseCode = ((HttpException) cause).getResponseCode();\n+                    String message = cause.getMessage();\n+                    if (responseCode == 400 && message.equals(\"sendrawtransaction RPC error: {\\\"code\\\":-27,\\\"message\\\":\\\"Transaction already in block chain\\\"}\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNjM3OA=="}, "originalCommit": {"oid": "300671abb2c1407c1959994edaac441e37ec0b09"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU3NTk2OA==", "bodyText": "https://github.com/bitcoin/bitcoin/blob/master/src/rpc/protocol.h", "url": "https://github.com/bisq-network/bisq/pull/4943#discussion_r542575968", "createdAt": "2020-12-14T17:38:49Z", "author": {"login": "wiz"}, "path": "core/src/main/java/bisq/core/btc/wallet/http/MemPoolSpaceTxBroadcaster.java", "diffHunk": "@@ -115,8 +114,21 @@ public void onSuccess(String txId) {\n             }\n \n             public void onFailure(@NotNull Throwable throwable) {\n-                log.warn(\"Broadcast of raw tx with txId {} to {} failed. Error={}\",\n-                        txIdToSend, url, throwable.toString());\n+                Throwable cause = throwable.getCause();\n+                if (cause instanceof HttpException) {\n+                    int responseCode = ((HttpException) cause).getResponseCode();\n+                    String message = cause.getMessage();\n+                    if (responseCode == 400 && message.equals(\"sendrawtransaction RPC error: {\\\"code\\\":-27,\\\"message\\\":\\\"Transaction already in block chain\\\"}\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNjM3OA=="}, "originalCommit": {"oid": "300671abb2c1407c1959994edaac441e37ec0b09"}, "originalPosition": 56}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2652, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}