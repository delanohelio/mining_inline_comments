{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0Njg0NDMz", "number": 4308, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNTo0NTozNVrOEHoRgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNTo0OTowN1rOEHoXbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NDM1MzI5OnYy", "diffSide": "RIGHT", "path": "cli/src/main/java/bisq/cli/CliMain.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNTo0NTozNVrOGnGkQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNTo0NzoyNlrOGnvhLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NTIzMw==", "bodyText": "These size-based checks don't actually know which argument was ommitted. We might (or might not) go for more interesting interfaces in the future, but in this case we only know that not all arguments were passed.", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r443655233", "createdAt": "2020-06-22T15:45:35Z", "author": {"login": "dmos62"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY3MDQ1OQ==", "bodyText": "The original motivation for doing it this way was to keep it as simple as possible because this is/was a reference implementation only, to show others how to build their own gRPC CLI.  This isn't the final word on the issue, so let's leave it open.", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r443670459", "createdAt": "2020-06-22T16:08:14Z", "author": {"login": "ghubstan"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NTIzMw=="}, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDEyMzc5Nw==", "bodyText": "I'm not sure I follow. I'll try to rephrase. My concern here is that this behaviour is incorrect in some cases. Suppose you call createpaymentacct with arguments account name, account number (fiat currency omitted). It will output \"no fiat currency specified\", which is correct. But, if you call it with arguments account name, fiat currency (account number omitted), it will output \"no fiat currency specified\", which is incorrect. Or am I mistaken?", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r444123797", "createdAt": "2020-06-23T10:29:02Z", "author": {"login": "dmos62"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NTIzMw=="}, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI1OTU1OQ==", "bodyText": "I will replace this code that assumes correct param order, with a simple argument count check.   The change will be made in the latest PR of this long PR chain:  PR 4329.", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r444259559", "createdAt": "2020-06-23T14:17:41Z", "author": {"login": "ghubstan"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NTIzMw=="}, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDMyNjE4OA==", "bodyText": "The requested change is in commit 9691f35 , part of PR 4329", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r444326188", "createdAt": "2020-06-23T15:47:26Z", "author": {"login": "ghubstan"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NTIzMw=="}, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NDM2ODQ3OnYy", "diffSide": "RIGHT", "path": "cli/src/main/java/bisq/cli/CliMain.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNTo0OTowN1rOGnGtnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxODoxNDowNlrOGnL0FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NzYyOQ==", "bodyText": ".toUpperCase() seems misplaced here. It would soon get repetive. Whether the underlying logic differentiates between capitalizations is a low-level implementation detail and would do better at the lowest practical level.", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r443657629", "createdAt": "2020-06-22T15:49:07Z", "author": {"login": "dmos62"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");\n+\n+                    var fiatCurrencyCode = nonOptionArgs.get(3).toUpperCase();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY3MTA5Nw==", "bodyText": "Agreed.  I will fix this.", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r443671097", "createdAt": "2020-06-22T16:09:15Z", "author": {"login": "ghubstan"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");\n+\n+                    var fiatCurrencyCode = nonOptionArgs.get(3).toUpperCase();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NzYyOQ=="}, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0MTIwNQ==", "bodyText": "This is fixed in commit 61285a7, part of PR 4329.", "url": "https://github.com/bisq-network/bisq/pull/4308#discussion_r443741205", "createdAt": "2020-06-22T18:14:06Z", "author": {"login": "ghubstan"}, "path": "cli/src/main/java/bisq/cli/CliMain.java", "diffHunk": "@@ -152,6 +160,46 @@ public static void run(String[] args) {\n                     out.println(btcBalance);\n                     return;\n                 }\n+                case getaddressbalance: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no address specified\");\n+\n+                    var request = GetAddressBalanceRequest.newBuilder()\n+                            .setAddress(nonOptionArgs.get(1)).build();\n+                    var reply = walletService.getAddressBalance(request);\n+                    out.println(reply.getAddressBalanceInfo());\n+                    return;\n+                }\n+                case getfundingaddresses: {\n+                    var request = GetFundingAddressesRequest.newBuilder().build();\n+                    var reply = walletService.getFundingAddresses(request);\n+                    out.println(reply.getFundingAddressesInfo());\n+                    return;\n+                }\n+                case createpaymentacct: {\n+                    if (nonOptionArgs.size() < 2)\n+                        throw new IllegalArgumentException(\"no account name specified\");\n+\n+                    var accountName = nonOptionArgs.get(1);\n+\n+                    if (nonOptionArgs.size() < 3)\n+                        throw new IllegalArgumentException(\"no account number specified\");\n+\n+                    var accountNumber = nonOptionArgs.get(2);\n+\n+                    if (nonOptionArgs.size() < 4)\n+                        throw new IllegalArgumentException(\"no fiat currency specified\");\n+\n+                    var fiatCurrencyCode = nonOptionArgs.get(3).toUpperCase();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY1NzYyOQ=="}, "originalCommit": {"oid": "a7542e98bf62d86bc3486e1d4d925a9a0a64d8c6"}, "originalPosition": 69}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2468, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}