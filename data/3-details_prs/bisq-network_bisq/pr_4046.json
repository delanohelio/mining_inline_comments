{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NjM5OTQ2", "number": 4046, "title": "Add holder name for new Faster Payments accounts", "bodyText": "Use excludeFromJsonDataMap to add an optional owner full name property to Faster Payments (GBP) accounts, without affecting the trade JSON contract (for backwards compatibility). This is to fix #3976, that some banks have started checking the recipient name.\nThis uses the new map key: public static final String HOLDER_NAME = \"holderName\";\nMake the full name a non-optional field for new accounts, but display the details for old Faster Payments accounts in exactly the same way as before, only showing the extra field in the info popup, account and trade step views when it is present.\nAlso update the now misleading payment instructions in the buyer popup. With the change, it shows as:\n\nAlso add a popup to advise the user to recreate their Faster Payments account.\nMake an info popup open in the take/create offer view, upon choosing to take or make a new offer, to instruct the user to recreate their old Faster Payments account with an owner full name (and preserved salt). Also show the popup upon manual selection of any old (i.e. missing full name) Faster Payments account from the trading account combo box, analogously to the ClearXchange (Zelle) warning popup logic.\n\nI've also copied/overwritten the two new/updated English resource bundle strings into the non-English resource files, so that the translations stay in sync with the updated information. (As it is a UK-only payment method, the non-English translations are probably not all that important anyway.)\n--\nFinally, I removed some redundant null-handling of the excludeFromJsonDataMap field\nand constructor parameters. This touched all the PaymentAccountPayload subclasses, which was quite a lot of files (although fairly trivial changes).", "createdAt": "2020-03-11T11:42:15Z", "url": "https://github.com/bisq-network/bisq/pull/4046", "merged": true, "mergeCommit": {"oid": "b321cd9272a5b7a6453f6643dca265b846c0b551"}, "closed": true, "closedAt": "2020-03-27T09:03:48Z", "author": {"login": "stejbac"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLTl5FAH2gAyMzg2NjM5OTQ2OmNiYjU5YzE1NWI2ODhjZjUxNDMzYjVmNDA3MGY3MGFhM2QzZmIyNGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRs6ypAFqTM4MjY3OTI0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbb59c155b688cf51433b5f4070f70aa3d3fb24f", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/cbb59c155b688cf51433b5f4070f70aa3d3fb24f", "committedDate": "2020-03-07T12:08:50Z", "message": "Remove redundant @Nullable from account payload excludeFromJsonDataMap\n\nSince this map is final and every PaymentAccountPayload constructor\ninitialises it to something nonnull, the @Nullable field annotation is\nredundant, so remove it.\n\nFurther simplify the code by passing an empty map into the constructor\ndirectly from each subclass constructor, rather than mapping empties to\nnulls from each 'proto.getExcludeFromJsonDataMap()' result, then mapping\nnulls back to empties in the base constructor. This is safe, since\ngetExcludeFromJsonDataMap() always returns a nonnull map.\n\nFinally, tidy the code slightly by replacing 'Charset.forName(\"UTF-8\")'\nwith StandardCharsets.UTF_8 in each PaymentAccountPayload subclass."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a829969089d7d4acb9968856c31a2e91d37ab5fe", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/a829969089d7d4acb9968856c31a2e91d37ab5fe", "committedDate": "2020-03-11T11:15:12Z", "message": "Add holder name for new Faster Payments accounts\n\nUse excludeFromJsonDataMap to add an optional owner full name property\nto Faster Payments (GBP) accounts, without affecting the trade JSON\ncontract (for backwards compatibility). This is to fix #3976, that some\nbanks have started checking the recipient name.\n\nMake the name a non-optional field for _new_ accounts, but display the\ndetails for old Faster Payments accounts in exactly the same way as\nbefore, only showing the extra field in the info popup, account and\ntrade step views when it is present.\n\nAlso update the now misleading payment instructions in the buyer popup.\nTODO: Update translations (which probably aren't needed anyway)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a957fb167a15f43204b0f2ee212d471ba7a0caab", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/a957fb167a15f43204b0f2ee212d471ba7a0caab", "committedDate": "2020-03-25T09:48:06Z", "message": "Add popup to advise user to recreate Faster Payments account\n\nOpen an info popup in the take/create offer view, upon choosing to take\nor make a new offer, to instruct the user to recreate their old Faster\nPayments account with an owner full name (and preserved salt). Also show\nthe popup upon manual selection of any old (i.e. missing full name)\nFaster Payments account from the trading account combo box, analogously\nto the ClearXchange (Zelle) warning popup logic.\n\n(Also eliminate slight differences between the private\n'maybeShow[ClearXchange|FasterPayments]Warning' methods in TakeOfferView\nand MutableOfferView, to make the code easier to deduplicate in future.)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTIwMTM1", "url": "https://github.com/bisq-network/bisq/pull/4046#pullrequestreview-382120135", "createdAt": "2020-03-26T15:23:26Z", "commit": {"oid": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNToyMzoyNlrOF8MQ5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNToyMzoyNlrOF8MQ5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1OTgxNA==", "bodyText": "If this field is shown during the trade process it creates unnecessary scrolling.\n\nI'd just change line 54-55 to\naddCompactTopLabelTextField(gridPane, gridRow, 1, Res.get(\"payment.accountNr\"),\n                ((FasterPaymentsAccountPayload) paymentAccountPayload).getAccountNr());\n\nwhich puts sort code and account nr next to each other.\n\nThat would work for both cases.", "url": "https://github.com/bisq-network/bisq/pull/4046#discussion_r398659814", "createdAt": "2020-03-26T15:23:26Z", "author": {"login": "ripcurlx"}, "path": "desktop/src/main/java/bisq/desktop/components/paymentmethods/FasterPaymentsForm.java", "diffHunk": "@@ -44,6 +44,10 @@\n \n     public static int addFormForBuyer(GridPane gridPane, int gridRow,\n                                       PaymentAccountPayload paymentAccountPayload) {\n+        if (!((FasterPaymentsAccountPayload) paymentAccountPayload).getHolderName().isEmpty()) {\n+            addCompactTopLabelTextField(gridPane, ++gridRow, Res.get(\"payment.account.owner\"),\n+                    ((FasterPaymentsAccountPayload) paymentAccountPayload).getHolderName());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNjAwNTMx", "url": "https://github.com/bisq-network/bisq/pull/4046#pullrequestreview-382600531", "createdAt": "2020-03-27T06:12:06Z", "commit": {"oid": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwNjoxMjowNlrOF8kUCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwNjoxMjoxMVrOF8kUHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTA1MzgzNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              The UK sort code and account number used to be sufficient for a Faster Payment transfer, but since then some banks \\\n          \n          \n            \n              have started verifying the receiver's name. For this reason, accounts created in old Bisq clients do not provide the \\\n          \n          \n            \n              trade partner with an owner full name. Please use trade chat to avoid any issues in such cases.\n          \n          \n            \n              Faster Payment accounts created in old Bisq clients do not provide the receiver's name, \\\n          \n          \n            \n              so please use trade chat to obtain it (if needed).", "url": "https://github.com/bisq-network/bisq/pull/4046#discussion_r399053834", "createdAt": "2020-03-27T06:12:06Z", "author": {"login": "m52go"}, "path": "core/src/main/resources/i18n/displayStrings.properties", "diffHunk": "@@ -622,8 +622,9 @@ portfolio.pending.step2_buyer.halCashInfo.msg=You need to send a text message wi\n   trade ID ({0}) to the BTC seller.\\nThe seller''s mobile nr. is {1}.\\n\\n\\\n   Did you send the code to the seller?\n portfolio.pending.step2_buyer.fasterPaymentsHolderNameInfo=Some banks might require the receiver's name. \\\n-  The UK sort code and account number is sufficient for a Faster Payment transfer and the receivers name is not verified \\\n-  by any of the banks.\n+  The UK sort code and account number used to be sufficient for a Faster Payment transfer, but since then some banks \\\n+  have started verifying the receiver's name. For this reason, accounts created in old Bisq clients do not provide the \\\n+  trade partner with an owner full name. Please use trade chat to avoid any issues in such cases.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTA1Mzg1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            payment.fasterPayments.newRequirements.info=When using Faster Payments some banks have started verifying the receiver''s \\\n          \n          \n            \n              full name. Your current Faster Payments account only specifies a UK bank account number and sort code. This used to be \\\n          \n          \n            \n              sufficient, but may not be now for some sender''s banks. New Faster Payments accounts in Bisq now include an owner \\\n          \n          \n            \n              full name. Please consider recreating your account in Bisq to provide future {0} buyers with a recipient name.\\n\\n\\\n          \n          \n            \n              When recreating a Faster Payments account, take care to copy the account age verification salt from your old account \\\n          \n          \n            \n              and use the same sort code and account number. (The owner full name or account name need not be the same, however.) \\\n          \n          \n            \n              This preserves the public hash, so that the new account need not be aged or signed from scratch.\n          \n          \n            \n            payment.fasterPayments.newRequirements.info=Some banks have started verifying the receiver''s \\\n          \n          \n            \n              full name for Faster Payments transfers. Your current Faster Payments account does not specify a full name.\\n\\n \\\n          \n          \n            \n              Please consider recreating your Faster Payments account in Bisq to provide future {0} buyers with a full name.\\n\\n\\\n          \n          \n            \n              When you recreate the account, make sure to copy the precise sort code, account number, and account age \\\n          \n          \n            \n              verification salt values from your old account to your new account. This will ensure your existing account's age and \\\n          \n          \n            \n              signing status are preserved.", "url": "https://github.com/bisq-network/bisq/pull/4046#discussion_r399053855", "createdAt": "2020-03-27T06:12:11Z", "author": {"login": "m52go"}, "path": "core/src/main/resources/i18n/displayStrings.properties", "diffHunk": "@@ -3019,7 +3020,13 @@ If you have not fulfilled the above requirements you will lose your security dep\n   For the {0} seller it is highly recommended \\\n to get in contact with the {1} buyer by using the provided email address or mobile number to verify that he or she \\\n   is really the owner of the Zelle (ClearXchange) account.\n-\n+payment.fasterPayments.newRequirements.info=When using Faster Payments some banks have started verifying the receiver''s \\\n+  full name. Your current Faster Payments account only specifies a UK bank account number and sort code. This used to be \\\n+  sufficient, but may not be now for some sender''s banks. New Faster Payments accounts in Bisq now include an owner \\\n+  full name. Please consider recreating your account in Bisq to provide future {0} buyers with a recipient name.\\n\\n\\\n+  When recreating a Faster Payments account, take care to copy the account age verification salt from your old account \\\n+  and use the same sort code and account number. (The owner full name or account name need not be the same, however.) \\\n+  This preserves the public hash, so that the new account need not be aged or signed from scratch.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/0ec168bc0d6ad45e3ba475679ba8610dbd53a512", "committedDate": "2020-03-25T12:36:16Z", "message": "Update translations for Faster Payments resource keys\n\nUse stub English placeholders for the following new/updated resource\nkeys, to ensure the translations remain in sync:\n\n  payment.fasterPayments.newRequirements.info\n  portfolio.pending.step2_buyer.fasterPaymentsHolderNameInfo\n\n(Note: Faster Payments is specific to the UK anyway.)"}, "afterCommit": {"oid": "e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "committedDate": "2020-03-27T06:12:38Z", "message": "Improve layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d84130ff5b82b4a236ad4b540e975db566f23f80", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/d84130ff5b82b4a236ad4b540e975db566f23f80", "committedDate": "2020-03-27T08:08:21Z", "message": "Improve popup text + layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)\n\nAlso apply the suggested popup text simplifications."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "committedDate": "2020-03-27T06:12:38Z", "message": "Improve layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)"}, "afterCommit": {"oid": "d84130ff5b82b4a236ad4b540e975db566f23f80", "author": {"user": {"login": "stejbac", "name": "Steven Barclay"}}, "url": "https://github.com/bisq-network/bisq/commit/d84130ff5b82b4a236ad4b540e975db566f23f80", "committedDate": "2020-03-27T08:08:21Z", "message": "Improve popup text + layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)\n\nAlso apply the suggested popup text simplifications."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNjc5MjQ3", "url": "https://github.com/bisq-network/bisq/pull/4046#pullrequestreview-382679247", "createdAt": "2020-03-27T09:02:50Z", "commit": {"oid": "d84130ff5b82b4a236ad4b540e975db566f23f80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3344, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}