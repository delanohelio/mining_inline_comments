{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4NTA4Nzk1", "number": 1180, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0Mjo0NVrOE99yYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0NDo0MlrOE990qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzNDEwOTEzOnYy", "diffSide": "RIGHT", "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/SetContextSteps.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0Mjo0NVrOH67Xxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0Mjo0NVrOH67Xxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU1MjE5OA==", "bodyText": "\"Switching to '{}' web view found by the index {}\"", "url": "https://github.com/vividus-framework/vividus/pull/1180#discussion_r531552198", "createdAt": "2020-11-27T11:42:45Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/SetContextSteps.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.mobileapp.steps;\n+\n+import static java.util.function.Predicate.not;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.jbehave.core.annotations.When;\n+import org.openqa.selenium.ContextAware;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.vividus.selenium.IWebDriverProvider;\n+import org.vividus.selenium.manager.IGenericWebDriverManager;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class SetContextSteps\n+{\n+    private static final Logger LOGGER = LoggerFactory.getLogger(SetContextSteps.class);\n+\n+    private final IWebDriverProvider webDriverProvider;\n+    private final ISoftAssert softAssert;\n+\n+    public SetContextSteps(IWebDriverProvider webDriverProvider, ISoftAssert softAssert)\n+    {\n+        this.webDriverProvider = webDriverProvider;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Switches context to a mobile application context\n+     */\n+    @When(\"I switch to native context\")\n+    public void switchToNativeContext()\n+    {\n+        getContextAware().context(IGenericWebDriverManager.NATIVE_APP_CONTEXT);\n+    }\n+\n+    /**\n+     * Switches context to a web view with the <b>index</b>, index number starts from 1.\n+     * @param index index of web view\n+     */\n+    @When(\"I switch to web view with index `$index`\")\n+    public void switchToWebView(int index)\n+    {\n+        List<String> webViews = getWebViews();\n+        if (webViews.isEmpty())\n+        {\n+            softAssert.recordFailedAssertion(\"No web views found\");\n+            return;\n+        }\n+\n+        LOGGER.atInfo().addArgument(webViews::toString).log(\"Web views found: {}\");\n+\n+        int webViewIndex = index - 1;\n+        int size = webViews.size();\n+        if (webViewIndex >= 0 && webViewIndex < size)\n+        {\n+            String webview = webViews.get(webViewIndex);\n+            LOGGER.atInfo().addArgument(webview::toString)\n+                           .addArgument(index)\n+                           .log(\"Switching to '{}' web view by index {}\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "badbb090c026fab2639357beb8e5b36424c88327"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzNDExMjk3OnYy", "diffSide": "RIGHT", "path": "docs/modules/plugins/pages/plugin-mobile-app.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0NDowNFrOH67aJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0NDowNFrOH67aJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU1MjgwNQ==", "bodyText": "Switches context to a web view by the index, it starts from 1.", "url": "https://github.com/vividus-framework/vividus/pull/1180#discussion_r531552805", "createdAt": "2020-11-27T11:44:04Z", "author": {"login": "valfirst"}, "path": "docs/modules/plugins/pages/plugin-mobile-app.adoc", "diffHunk": "@@ -533,4 +533,44 @@ When I select $direction value with `$offset` offset in picker wheel located `$l\n When I select next value with `0.1` offset in picker wheel located `xpath(//XCUIElementTypePickerWheel)->filter.index(3)`\n ----\n \n+=== Switch to web view\n+\n+Switches context to a web view by index, the index number starts from 1.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "badbb090c026fab2639357beb8e5b36424c88327"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzNDExNDk4OnYy", "diffSide": "RIGHT", "path": "docs/modules/plugins/pages/plugin-mobile-app.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0NDo0MlrOH67bXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTo0NDo0MlrOH67bXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU1MzExNw==", "bodyText": "Switches context to a mobile native context", "url": "https://github.com/vividus-framework/vividus/pull/1180#discussion_r531553117", "createdAt": "2020-11-27T11:44:42Z", "author": {"login": "valfirst"}, "path": "docs/modules/plugins/pages/plugin-mobile-app.adoc", "diffHunk": "@@ -533,4 +533,44 @@ When I select $direction value with `$offset` offset in picker wheel located `$l\n When I select next value with `0.1` offset in picker wheel located `xpath(//XCUIElementTypePickerWheel)->filter.index(3)`\n ----\n \n+=== Switch to web view\n+\n+Switches context to a web view by index, the index number starts from 1.\n+\n+See http://appium.io/docs/en/writing-running-appium/web/hybrid/[Automating hybrid apps] for more information.\n+\n+[source,gherkin]\n+----\n+When I switch to web view with index `$index`\n+----\n+\n+. `$index` - index of a web view\n+\n+.Switch to web view\n+[source,gherkin]\n+----\n+Then number of elements found by `xpath(html)` is equal to `0`\n+When I switch to web view with index `1`\n+Then number of elements found by `xpath(html)` is equal to `1`\n+----\n+\n+=== Switch to native context\n+\n+Switches context to a mobile application context", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "badbb090c026fab2639357beb8e5b36424c88327"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4957, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}