{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0OTk5MTE1", "number": 318, "title": "Add steps to work with excel in HTTP response", "bodyText": "Then response contains excel sheet with index `index` and records:records\nThen response contains excel sheet with name `name` and records:records", "createdAt": "2020-02-13T17:33:11Z", "url": "https://github.com/vividus-framework/vividus/pull/318", "merged": true, "mergeCommit": {"oid": "46af6773489ad41ddf6b38ab94d2701320a00e35"}, "closed": true, "closedAt": "2020-02-17T06:52:42Z", "author": {"login": "uarlouski"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcD-mjogBqjMwMzU4ODE2NDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFHmJFAFqTM1OTUxNTQwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dca79df06cc9a55e0937014896109b19af48f050", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/dca79df06cc9a55e0937014896109b19af48f050", "committedDate": "2020-02-13T17:32:10Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "4f79e5bd215b9617e7a0cbc20bad4126ab582cc3", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/4f79e5bd215b9617e7a0cbc20bad4126ab582cc3", "committedDate": "2020-02-13T17:41:05Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f79e5bd215b9617e7a0cbc20bad4126ab582cc3", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/4f79e5bd215b9617e7a0cbc20bad4126ab582cc3", "committedDate": "2020-02-13T17:41:05Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "099465670ca331b040a847cc4a6e77b05990bd25", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/099465670ca331b040a847cc4a6e77b05990bd25", "committedDate": "2020-02-13T17:45:37Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "099465670ca331b040a847cc4a6e77b05990bd25", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/099465670ca331b040a847cc4a6e77b05990bd25", "committedDate": "2020-02-13T17:45:37Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "a375a0661639122bd8f239d832ba5983c9e3ed22", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/a375a0661639122bd8f239d832ba5983c9e3ed22", "committedDate": "2020-02-13T17:56:24Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NDY0NTE1", "url": "https://github.com/vividus-framework/vividus/pull/318#pullrequestreview-358464515", "createdAt": "2020-02-13T18:48:40Z", "commit": {"oid": "a375a0661639122bd8f239d832ba5983c9e3ed22"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxODo0ODo0MFrOFpfcUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxODo0OToxNFrOFpfdgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA1MTA5MQ==", "bodyText": "it should be vice versa: plugin-excel should depend on plugin-rest-api", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379051091", "createdAt": "2020-02-13T18:48:40Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-rest-api/build.gradle", "diffHunk": "@@ -12,6 +12,8 @@ dependencies {\n     implementation project(':vividus-test-context')\n     implementation project(':vividus-util')\n \n+    implementation project(':vividus-plugin-excel')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a375a0661639122bd8f239d832ba5983c9e3ed22"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA1MTM5NQ==", "bodyText": "plugin-rest-api should know nothing about excel, the same for all other classes", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379051395", "createdAt": "2020-02-13T18:49:14Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-rest-api/src/main/java/org/vividus/bdd/model/CellRecord.java", "diffHunk": "@@ -0,0 +1,49 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.model;\n+\n+import java.util.Optional;\n+import java.util.regex.Pattern;\n+\n+import org.jbehave.core.annotations.AsParameters;\n+\n+@AsParameters\n+public class CellRecord", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a375a0661639122bd8f239d832ba5983c9e3ed22"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a375a0661639122bd8f239d832ba5983c9e3ed22", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/a375a0661639122bd8f239d832ba5983c9e3ed22", "committedDate": "2020-02-13T17:56:24Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "13e1eea6c741bebe929c8874167b7b3410380064", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/13e1eea6c741bebe929c8874167b7b3410380064", "committedDate": "2020-02-14T07:05:10Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "13e1eea6c741bebe929c8874167b7b3410380064", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/13e1eea6c741bebe929c8874167b7b3410380064", "committedDate": "2020-02-14T07:05:10Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "1138a91f801b8dc41933e56b0fcd55157e49ad1e", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/1138a91f801b8dc41933e56b0fcd55157e49ad1e", "committedDate": "2020-02-14T07:07:42Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1138a91f801b8dc41933e56b0fcd55157e49ad1e", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/1138a91f801b8dc41933e56b0fcd55157e49ad1e", "committedDate": "2020-02-14T07:07:42Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "54a422a464591db3686a36e7ba130e8d37264cbe", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/54a422a464591db3686a36e7ba130e8d37264cbe", "committedDate": "2020-02-14T07:57:00Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "54a422a464591db3686a36e7ba130e8d37264cbe", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/54a422a464591db3686a36e7ba130e8d37264cbe", "committedDate": "2020-02-14T07:57:00Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/9ac1f46136e94acf092059fbee0e232c4179299f", "committedDate": "2020-02-14T08:51:16Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4ODY0NTA0", "url": "https://github.com/vividus-framework/vividus/pull/318#pullrequestreview-358864504", "createdAt": "2020-02-14T11:00:31Z", "commit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTowMDozMVrOFpy_pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTowODo0NlrOFpzNDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM3MTQyOA==", "bodyText": "the the -> in the", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379371428", "createdAt": "2020-02-14T11:00:31Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-excel/src/main/java/org/vividus/bdd/steps/ExcelResponseValidationSteps.java", "diffHunk": "@@ -0,0 +1,156 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.steps;\n+\n+import static java.util.Map.entry;\n+\n+import java.util.List;\n+import java.util.Map.Entry;\n+import java.util.Optional;\n+import java.util.function.Function;\n+import java.util.function.Predicate;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+import org.apache.poi.ss.usermodel.Sheet;\n+import org.jbehave.core.annotations.Then;\n+import org.vividus.bdd.model.CellRecord;\n+import org.vividus.excel.ExcelSheetParser;\n+import org.vividus.excel.ExcelSheetsExtractor;\n+import org.vividus.excel.IExcelSheetParser;\n+import org.vividus.excel.IExcelSheetParser.CellValue;\n+import org.vividus.excel.IExcelSheetsExtractor;\n+import org.vividus.excel.WorkbookParsingException;\n+import org.vividus.http.HttpTestContext;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class ExcelResponseValidationSteps\n+{\n+    private final HttpTestContext httpTestContext;\n+    private final ISoftAssert softAssert;\n+\n+    public ExcelResponseValidationSteps(HttpTestContext httpTestContext, ISoftAssert softAssert)\n+    {\n+        this.httpTestContext = httpTestContext;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with index <b>index</b> and records <b>records</b>\n+     * @param index Index of the sheet (0-based)\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with index `2` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with index `$index` and records:$records\")\n+    public void excelSheetWithIndexHasRecords(int index, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(index), \"index \" + index);\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with name <b>name</b> and records <b>records</b>\n+     * @param name Name of the sheet\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with name `products_140220` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with name `$name` and records:$records\")\n+    public void excelSheetWithNameHasRecords(String name, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(name), \"name \" + name);\n+    }\n+\n+    private void checkRecords(List<CellRecord> records, Function<IExcelSheetsExtractor, Optional<Sheet>> sheetMapper,\n+            String errorKey)\n+    {\n+        sheetMapper.apply(getExtractor()).ifPresentOrElse(s ->\n+        {\n+            IExcelSheetParser parser = new ExcelSheetParser(s);\n+            List<Entry<CellValue, Optional<Pattern>>> failedRecords = records.stream()\n+                .map(r -> parser.getDataFromRange(r.getCellsRange())\n+                        .stream()\n+                        .map(cv -> entry(cv, r.getValueRegex())))\n+                .flatMap(Function.identity())\n+                .filter(filterMatched())\n+                .collect(Collectors.toList());\n+            if (failedRecords.isEmpty())\n+            {\n+                softAssert.recordPassedAssertion(\"All records were found the the document\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM3MTYxMw==", "bodyText": "add cell range to the assertion message", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379371613", "createdAt": "2020-02-14T11:00:59Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-excel/src/main/java/org/vividus/bdd/steps/ExcelResponseValidationSteps.java", "diffHunk": "@@ -0,0 +1,156 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.steps;\n+\n+import static java.util.Map.entry;\n+\n+import java.util.List;\n+import java.util.Map.Entry;\n+import java.util.Optional;\n+import java.util.function.Function;\n+import java.util.function.Predicate;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+import org.apache.poi.ss.usermodel.Sheet;\n+import org.jbehave.core.annotations.Then;\n+import org.vividus.bdd.model.CellRecord;\n+import org.vividus.excel.ExcelSheetParser;\n+import org.vividus.excel.ExcelSheetsExtractor;\n+import org.vividus.excel.IExcelSheetParser;\n+import org.vividus.excel.IExcelSheetParser.CellValue;\n+import org.vividus.excel.IExcelSheetsExtractor;\n+import org.vividus.excel.WorkbookParsingException;\n+import org.vividus.http.HttpTestContext;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class ExcelResponseValidationSteps\n+{\n+    private final HttpTestContext httpTestContext;\n+    private final ISoftAssert softAssert;\n+\n+    public ExcelResponseValidationSteps(HttpTestContext httpTestContext, ISoftAssert softAssert)\n+    {\n+        this.httpTestContext = httpTestContext;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with index <b>index</b> and records <b>records</b>\n+     * @param index Index of the sheet (0-based)\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with index `2` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with index `$index` and records:$records\")\n+    public void excelSheetWithIndexHasRecords(int index, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(index), \"index \" + index);\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with name <b>name</b> and records <b>records</b>\n+     * @param name Name of the sheet\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with name `products_140220` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with name `$name` and records:$records\")\n+    public void excelSheetWithNameHasRecords(String name, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(name), \"name \" + name);\n+    }\n+\n+    private void checkRecords(List<CellRecord> records, Function<IExcelSheetsExtractor, Optional<Sheet>> sheetMapper,\n+            String errorKey)\n+    {\n+        sheetMapper.apply(getExtractor()).ifPresentOrElse(s ->\n+        {\n+            IExcelSheetParser parser = new ExcelSheetParser(s);\n+            List<Entry<CellValue, Optional<Pattern>>> failedRecords = records.stream()\n+                .map(r -> parser.getDataFromRange(r.getCellsRange())\n+                        .stream()\n+                        .map(cv -> entry(cv, r.getValueRegex())))\n+                .flatMap(Function.identity())\n+                .filter(filterMatched())\n+                .collect(Collectors.toList());\n+            if (failedRecords.isEmpty())\n+            {\n+                softAssert.recordPassedAssertion(\"All records were found the the document\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM3MjQ1Ng==", "bodyText": "why not to use assertion mechanism? (instead of building own message)", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379372456", "createdAt": "2020-02-14T11:02:55Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-excel/src/main/java/org/vividus/bdd/steps/ExcelResponseValidationSteps.java", "diffHunk": "@@ -0,0 +1,156 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.steps;\n+\n+import static java.util.Map.entry;\n+\n+import java.util.List;\n+import java.util.Map.Entry;\n+import java.util.Optional;\n+import java.util.function.Function;\n+import java.util.function.Predicate;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+import org.apache.poi.ss.usermodel.Sheet;\n+import org.jbehave.core.annotations.Then;\n+import org.vividus.bdd.model.CellRecord;\n+import org.vividus.excel.ExcelSheetParser;\n+import org.vividus.excel.ExcelSheetsExtractor;\n+import org.vividus.excel.IExcelSheetParser;\n+import org.vividus.excel.IExcelSheetParser.CellValue;\n+import org.vividus.excel.IExcelSheetsExtractor;\n+import org.vividus.excel.WorkbookParsingException;\n+import org.vividus.http.HttpTestContext;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class ExcelResponseValidationSteps\n+{\n+    private final HttpTestContext httpTestContext;\n+    private final ISoftAssert softAssert;\n+\n+    public ExcelResponseValidationSteps(HttpTestContext httpTestContext, ISoftAssert softAssert)\n+    {\n+        this.httpTestContext = httpTestContext;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with index <b>index</b> and records <b>records</b>\n+     * @param index Index of the sheet (0-based)\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with index `2` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with index `$index` and records:$records\")\n+    public void excelSheetWithIndexHasRecords(int index, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(index), \"index \" + index);\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with name <b>name</b> and records <b>records</b>\n+     * @param name Name of the sheet\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with name `products_140220` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with name `$name` and records:$records\")\n+    public void excelSheetWithNameHasRecords(String name, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(name), \"name \" + name);\n+    }\n+\n+    private void checkRecords(List<CellRecord> records, Function<IExcelSheetsExtractor, Optional<Sheet>> sheetMapper,\n+            String errorKey)\n+    {\n+        sheetMapper.apply(getExtractor()).ifPresentOrElse(s ->\n+        {\n+            IExcelSheetParser parser = new ExcelSheetParser(s);\n+            List<Entry<CellValue, Optional<Pattern>>> failedRecords = records.stream()\n+                .map(r -> parser.getDataFromRange(r.getCellsRange())\n+                        .stream()\n+                        .map(cv -> entry(cv, r.getValueRegex())))\n+                .flatMap(Function.identity())\n+                .filter(filterMatched())\n+                .collect(Collectors.toList());\n+            if (failedRecords.isEmpty())\n+            {\n+                softAssert.recordPassedAssertion(\"All records were found the the document\");\n+                return;\n+            }\n+            failedRecords.forEach(e ->\n+            {\n+                CellValue cellValue = e.getKey();\n+                String message = String.format(\"Cell at address '%s' and value '%s' is expected to %s\",\n+                        cellValue.getAddress(), cellValue.getValue(),\n+                        e.getValue().map(Pattern::pattern).map(\"match \"::concat).orElse(\"be empty\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM3NDQzMg==", "bodyText": "return !pattern.isEmpty() || cellValue.getValue() != null;", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379374432", "createdAt": "2020-02-14T11:07:44Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-excel/src/main/java/org/vividus/bdd/steps/ExcelResponseValidationSteps.java", "diffHunk": "@@ -0,0 +1,156 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.steps;\n+\n+import static java.util.Map.entry;\n+\n+import java.util.List;\n+import java.util.Map.Entry;\n+import java.util.Optional;\n+import java.util.function.Function;\n+import java.util.function.Predicate;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+\n+import org.apache.poi.ss.usermodel.Sheet;\n+import org.jbehave.core.annotations.Then;\n+import org.vividus.bdd.model.CellRecord;\n+import org.vividus.excel.ExcelSheetParser;\n+import org.vividus.excel.ExcelSheetsExtractor;\n+import org.vividus.excel.IExcelSheetParser;\n+import org.vividus.excel.IExcelSheetParser.CellValue;\n+import org.vividus.excel.IExcelSheetsExtractor;\n+import org.vividus.excel.WorkbookParsingException;\n+import org.vividus.http.HttpTestContext;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class ExcelResponseValidationSteps\n+{\n+    private final HttpTestContext httpTestContext;\n+    private final ISoftAssert softAssert;\n+\n+    public ExcelResponseValidationSteps(HttpTestContext httpTestContext, ISoftAssert softAssert)\n+    {\n+        this.httpTestContext = httpTestContext;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with index <b>index</b> and records <b>records</b>\n+     * @param index Index of the sheet (0-based)\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with index `2` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with index `$index` and records:$records\")\n+    public void excelSheetWithIndexHasRecords(int index, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(index), \"index \" + index);\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with name <b>name</b> and records <b>records</b>\n+     * @param name Name of the sheet\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with name `products_140220` and records:\n+     * |cellRange|valueRegex      |<br>\n+     * |A1:E8    |\\\\w+            |<br>\n+     * |D11:H25  |                |<br>\n+     * |A1:H1    |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with name `$name` and records:$records\")\n+    public void excelSheetWithNameHasRecords(String name, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(name), \"name \" + name);\n+    }\n+\n+    private void checkRecords(List<CellRecord> records, Function<IExcelSheetsExtractor, Optional<Sheet>> sheetMapper,\n+            String errorKey)\n+    {\n+        sheetMapper.apply(getExtractor()).ifPresentOrElse(s ->\n+        {\n+            IExcelSheetParser parser = new ExcelSheetParser(s);\n+            List<Entry<CellValue, Optional<Pattern>>> failedRecords = records.stream()\n+                .map(r -> parser.getDataFromRange(r.getCellsRange())\n+                        .stream()\n+                        .map(cv -> entry(cv, r.getValueRegex())))\n+                .flatMap(Function.identity())\n+                .filter(filterMatched())\n+                .collect(Collectors.toList());\n+            if (failedRecords.isEmpty())\n+            {\n+                softAssert.recordPassedAssertion(\"All records were found the the document\");\n+                return;\n+            }\n+            failedRecords.forEach(e ->\n+            {\n+                CellValue cellValue = e.getKey();\n+                String message = String.format(\"Cell at address '%s' and value '%s' is expected to %s\",\n+                        cellValue.getAddress(), cellValue.getValue(),\n+                        e.getValue().map(Pattern::pattern).map(\"match \"::concat).orElse(\"be empty\"));\n+                softAssert.recordFailedAssertion(message);\n+            });\n+        }, () -> softAssert.recordFailedAssertion(String.format(\"Sheet with the %s doesn't exist\", errorKey)));\n+    }\n+\n+    private IExcelSheetsExtractor getExtractor()\n+    {\n+        try\n+        {\n+            return new ExcelSheetsExtractor(httpTestContext.getResponse().getResponseBody());\n+        }\n+        catch (WorkbookParsingException e)\n+        {\n+            throw new IllegalStateException(e);\n+        }\n+    }\n+\n+    private static Predicate<Entry<CellValue, Optional<Pattern>>> filterMatched()\n+    {\n+        return e ->\n+        {\n+            Optional<Pattern> pattern = e.getValue();\n+            CellValue cellValue = e.getKey();\n+            if (pattern.isPresent() && cellValue.getValue() != null)\n+            {\n+                return !pattern.get().asMatchPredicate().test(cellValue.getValue());\n+            }\n+            if (pattern.isEmpty() && cellValue.getValue() == null)\n+            {\n+                return false;\n+            }\n+            return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f"}, "originalPosition": 153}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM3NDg2Mw==", "bodyText": "move outside interface", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379374863", "createdAt": "2020-02-14T11:08:46Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-excel/src/main/java/org/vividus/excel/IExcelSheetParser.java", "diffHunk": "@@ -37,7 +37,29 @@\n \n     Sheet getSheet();\n \n-    List<String> getDataFromRange(String range);\n+    List<CellValue> getDataFromRange(String range);\n \n     String getDataFromCell(String cellAddress);\n+\n+    class CellValue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9ac1f46136e94acf092059fbee0e232c4179299f", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/9ac1f46136e94acf092059fbee0e232c4179299f", "committedDate": "2020-02-14T08:51:16Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "57867ed9a503bf274e1e8aca6daa0ad0cc60feee", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/57867ed9a503bf274e1e8aca6daa0ad0cc60feee", "committedDate": "2020-02-15T12:32:35Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57867ed9a503bf274e1e8aca6daa0ad0cc60feee", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/57867ed9a503bf274e1e8aca6daa0ad0cc60feee", "committedDate": "2020-02-15T12:32:35Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "68e74baa5ba8102c710112e9a12c2065a3fde38e", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/68e74baa5ba8102c710112e9a12c2065a3fde38e", "committedDate": "2020-02-15T12:35:40Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MzkxODIw", "url": "https://github.com/vividus-framework/vividus/pull/318#pullrequestreview-359391820", "createdAt": "2020-02-16T09:46:32Z", "commit": {"oid": "68e74baa5ba8102c710112e9a12c2065a3fde38e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQwOTo0NjozMlrOFqSopg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQwOTo0NzozNFrOFqSo1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg4OTgzMA==", "bodyText": "This step can be moved to Before Story steps and Examples won't be needed", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379889830", "createdAt": "2020-02-16T09:46:32Z", "author": {"login": "valfirst"}, "path": "vividus-tests/src/main/resources/story/integration/ExcelSteps.story", "diffHunk": "@@ -0,0 +1,25 @@\n+Meta:\n+    @group vividus-plugin-excel\n+\n+Lifecycle:\n+Examples:\n+{transformer=FROM_LANDSCAPE}\n+|excelURL|https://github.com/vividus-framework/vividus/blob/master/vividus-plugin-excel/src/test/resources/TestTemplate.xlsx?raw=true|\n+\n+Scenario: Step verification 'Then response contains excel sheet with index `$index` and records:$records'\n+When I issue a HTTP GET request for a resource with the URL '<excelURL>'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68e74baa5ba8102c710112e9a12c2065a3fde38e"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg4OTg3Nw==", "bodyText": "we usually use present simple in the assertions", "url": "https://github.com/vividus-framework/vividus/pull/318#discussion_r379889877", "createdAt": "2020-02-16T09:47:34Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-excel/src/main/java/org/vividus/bdd/steps/ExcelResponseValidationSteps.java", "diffHunk": "@@ -0,0 +1,165 @@\n+/*\n+ * Copyright 2019-2020 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.vividus.bdd.steps;\n+\n+import static java.lang.String.format;\n+import static java.util.Map.entry;\n+\n+import java.util.List;\n+import java.util.Map.Entry;\n+import java.util.Optional;\n+import java.util.function.Function;\n+import java.util.function.Predicate;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import org.apache.poi.ss.usermodel.Sheet;\n+import org.hamcrest.Matcher;\n+import org.hamcrest.Matchers;\n+import org.hamcrest.core.IsNull;\n+import org.jbehave.core.annotations.Then;\n+import org.vividus.bdd.model.CellRecord;\n+import org.vividus.bdd.model.CellValue;\n+import org.vividus.excel.ExcelSheetParser;\n+import org.vividus.excel.ExcelSheetsExtractor;\n+import org.vividus.excel.IExcelSheetParser;\n+import org.vividus.excel.IExcelSheetsExtractor;\n+import org.vividus.excel.WorkbookParsingException;\n+import org.vividus.http.HttpTestContext;\n+import org.vividus.softassert.ISoftAssert;\n+\n+public class ExcelResponseValidationSteps\n+{\n+    private final HttpTestContext httpTestContext;\n+    private final ISoftAssert softAssert;\n+\n+    public ExcelResponseValidationSteps(HttpTestContext httpTestContext, ISoftAssert softAssert)\n+    {\n+        this.httpTestContext = httpTestContext;\n+        this.softAssert = softAssert;\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with index <b>index</b> and records <b>records</b>\n+     * @param index Index of the sheet (0-based)\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with index `2` and records:\n+     * |cellsRange|valueRegex      |<br>\n+     * |A1:E8     |\\\\w+            |<br>\n+     * |D11:H25   |                |<br>\n+     * |A1:H1     |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with index `$index` and records:$records\")\n+    public void excelSheetWithIndexHasRecords(int index, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(index), \"index \" + index);\n+    }\n+\n+    /**\n+     * Checks that API response contains excel sheet with name <b>name</b> and records <b>records</b>\n+     * @param name Name of the sheet\n+     * @param records Table of records with specified <b>cellsRange</b> and <b>valueRegex</b> that should be\n+     * matched against cells in excel sheet:\n+     * <ul>\n+     * <li>cellsRange - range of cells (e.g. \"B1:D8\", \"A1\", \"C1:C5\").\n+     * <li>valueRegex - regular expression to match a value against</li>\n+     * </ul>\n+     * <code>\n+     * Then response contains excel sheet with name `products_140220` and records:\n+     * |cellsRange|valueRegex      |<br>\n+     * |A1:E8     |\\\\w+            |<br>\n+     * |D11:H25   |                |<br>\n+     * |A1:H1     |header_\\\\d+_\\\\w+|<br>\n+     * </code>\n+     */\n+    @Then(\"response contains excel sheet with name `$name` and records:$records\")\n+    public void excelSheetWithNameHasRecords(String name, List<CellRecord> records)\n+    {\n+        checkRecords(records, e -> e.getSheet(name), \"name \" + name);\n+    }\n+\n+    private void checkRecords(List<CellRecord> records, Function<IExcelSheetsExtractor, Optional<Sheet>> sheetMapper,\n+            String errorKey)\n+    {\n+        sheetMapper.apply(getExtractor()).ifPresentOrElse(s ->\n+        {\n+            IExcelSheetParser parser = new ExcelSheetParser(s);\n+            records.stream()\n+                .map(r -> parser.getDataFromRange(r.getCellsRange())\n+                        .stream()\n+                        .map(cv -> entry(cv, r.getValueRegex())))\n+                .flatMap(Function.identity())\n+                .filter(filterMatched())\n+                .collect(Collectors.collectingAndThen(Collectors.toList(), v ->\n+                {\n+                    reportResults(records.stream().map(CellRecord::getCellsRange), v);\n+                    return null;\n+                }));\n+        }, () -> softAssert.recordFailedAssertion(format(\"Sheet with the %s doesn't exist\", errorKey)));\n+    }\n+\n+    private void reportResults(Stream<String> ranges, List<Entry<CellValue, Optional<Pattern>>> failedRecords)\n+    {\n+        if (failedRecords.isEmpty())\n+        {\n+            softAssert.recordPassedAssertion(format(\"All records at ranges %s were matched in the document\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68e74baa5ba8102c710112e9a12c2065a3fde38e"}, "originalPosition": 127}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffce5bc2d35af9b3e7fb9411109b131ad8bfa219", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/ffce5bc2d35af9b3e7fb9411109b131ad8bfa219", "committedDate": "2020-02-17T04:19:09Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68e74baa5ba8102c710112e9a12c2065a3fde38e", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/68e74baa5ba8102c710112e9a12c2065a3fde38e", "committedDate": "2020-02-15T12:35:40Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}, "afterCommit": {"oid": "ffce5bc2d35af9b3e7fb9411109b131ad8bfa219", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/ffce5bc2d35af9b3e7fb9411109b131ad8bfa219", "committedDate": "2020-02-17T04:19:09Z", "message": "Add steps to work with excel in HTTP response\n- Then response contains excel sheet with index \\`index\\` and records:records\n- Then response contains excel sheet with name \\`name\\` and records:records"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NTEwOTc4", "url": "https://github.com/vividus-framework/vividus/pull/318#pullrequestreview-359510978", "createdAt": "2020-02-17T06:31:09Z", "commit": {"oid": "ffce5bc2d35af9b3e7fb9411109b131ad8bfa219"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NTE1NDA4", "url": "https://github.com/vividus-framework/vividus/pull/318#pullrequestreview-359515408", "createdAt": "2020-02-17T06:46:42Z", "commit": {"oid": "ffce5bc2d35af9b3e7fb9411109b131ad8bfa219"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 328, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}