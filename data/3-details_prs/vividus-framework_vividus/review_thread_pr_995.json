{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NjA3NDQ2", "number": 995, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NDo1OFrOEqx25A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjowNzoxOFrOEq0QYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMjkyNTE2OnYy", "diffSide": "RIGHT", "path": "docs/modules/plugins/pages/plugin-mobile-app.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NDo1OFrOHdLeHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NDo1OFrOHdLeHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM1ODY4Nw==", "bodyText": "what about merging 2 [WARNING] and moving items to list?\nalso please describe the reason, why it should be so", "url": "https://github.com/vividus-framework/vividus/pull/995#discussion_r500358687", "createdAt": "2020-10-06T14:54:58Z", "author": {"login": "valfirst"}, "path": "docs/modules/plugins/pages/plugin-mobile-app.adoc", "diffHunk": "@@ -243,6 +243,9 @@ Types the text into the element located by the locator.\n [WARNING]\n Existing text is re-written by the text passed into the step\n \n+[WARNING]\n+The `mobile-application.hide-keyboard-using-native-call` property must be set to `false` for iOS Real Devices", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b87a8f0318ce03e48f240f6c7cdad6451d39d"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMjkyNzMwOnYy", "diffSide": "RIGHT", "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NToxOVrOHdLfbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NToxOVrOHdLfbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM1OTAyMA==", "bodyText": "move to the end of fields list", "url": "https://github.com/vividus-framework/vividus/pull/995#discussion_r500359020", "createdAt": "2020-10-06T14:55:19Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "diffHunk": "@@ -18,16 +18,32 @@\n \n import org.openqa.selenium.WebElement;\n import org.vividus.selenium.IWebDriverProvider;\n+import org.vividus.selenium.manager.GenericWebDriverManager;\n+import org.vividus.ui.action.ISearchActions;\n+import org.vividus.ui.action.search.Locator;\n+import org.vividus.ui.action.search.SearchParameters;\n+import org.vividus.ui.action.search.Visibility;\n+import org.vividus.ui.mobile.action.search.AppiumLocatorType;\n \n import io.appium.java_client.HidesKeyboard;\n \n public class KeyboardActions\n {\n+    private boolean hideKeyboardUsingNativeCall;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b87a8f0318ce03e48f240f6c7cdad6451d39d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMjkzODUyOnYy", "diffSide": "RIGHT", "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NzowM1rOHdLmKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1NzowM1rOHdLmKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM2MDc0Nw==", "bodyText": "java.util.Optional#ifPresentOrElse ?", "url": "https://github.com/vividus-framework/vividus/pull/995#discussion_r500360747", "createdAt": "2020-10-06T14:57:03Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "diffHunk": "@@ -44,6 +60,16 @@ public KeyboardActions(IWebDriverProvider webDriverProvider)\n     public void typeText(WebElement element, String text)\n     {\n         element.sendKeys(text);\n+        // https://github.com/appium/WebDriverAgent/blob/master/WebDriverAgentLib/Commands/FBCustomCommands.m#L107\n+        if (genericWebDriverManager.isIOSNativeApp() && !hideKeyboardUsingNativeCall)\n+        {\n+            Locator keyboardReturnLocator = new Locator(AppiumLocatorType.XPATH, new SearchParameters(\n+                    \"//XCUIElementTypeKeyboard//XCUIElementTypeButton[@name='Return']\", Visibility.VISIBLE, false));\n+            WebElement returnButton = searchActions.findElement(keyboardReturnLocator).orElseThrow(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b87a8f0318ce03e48f240f6c7cdad6451d39d"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMjk0MzgxOnYy", "diffSide": "RIGHT", "path": "vividus-plugin-mobile-app/src/main/resources/properties/profile/mobile_app/profile.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1Nzo1MFrOHdLpcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNDo1Nzo1MFrOHdLpcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM2MTU4Nw==", "bodyText": "it is not an attribute of mobile application", "url": "https://github.com/vividus-framework/vividus/pull/995#discussion_r500361587", "createdAt": "2020-10-06T14:57:50Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/resources/properties/profile/mobile_app/profile.properties", "diffHunk": "@@ -4,3 +4,4 @@ mobile-app=true\n mobile-application.session-scope=story\n mobile-application.swipe.stabilization-duration=PT1S\n mobile-application.swipe.limit=10\n+mobile-application.hide-keyboard-using-native-call=true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b87a8f0318ce03e48f240f6c7cdad6451d39d"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMzMxODEwOnYy", "diffSide": "RIGHT", "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjowNzoxOFrOHdPStw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNjoxMzo1NlrOHdPi5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyMTMwMw==", "bodyText": "if (genericWebDriverManager.isIOSNativeApp() && realDevice)\n{\n...\nreturn;\n}\nelse\n{\nwebDriverProvider.getUnwrapped(HidesKeyboard.class).hideKeyboard();\n}", "url": "https://github.com/vividus-framework/vividus/pull/995#discussion_r500421303", "createdAt": "2020-10-06T16:07:18Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "diffHunk": "@@ -44,6 +60,17 @@ public KeyboardActions(IWebDriverProvider webDriverProvider)\n     public void typeText(WebElement element, String text)\n     {\n         element.sendKeys(text);\n+        // https://github.com/appium/WebDriverAgent/blob/master/WebDriverAgentLib/Commands/FBCustomCommands.m#L107\n+        if (genericWebDriverManager.isIOSNativeApp() && realDevice)\n+        {\n+            Locator keyboardReturnLocator = new Locator(AppiumLocatorType.XPATH, new SearchParameters(\n+                    \"//XCUIElementTypeKeyboard//XCUIElementTypeButton[@name='Return']\", Visibility.VISIBLE, false));\n+            searchActions.findElement(keyboardReturnLocator).ifPresentOrElse(touchActions::tap, () ->\n+            {\n+                throw new IllegalStateException(\"Unable to find 'Return' button to close the keyboard\");\n+            });\n+            return;\n+        }\n         webDriverProvider.getUnwrapped(HidesKeyboard.class).hideKeyboard();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96d59a96b574656438e0291b8276d8cb1d789942"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyNTQ0Nw==", "bodyText": "Fixed, but why not to reduce number of lines by using return?", "url": "https://github.com/vividus-framework/vividus/pull/995#discussion_r500425447", "createdAt": "2020-10-06T16:13:56Z", "author": {"login": "uarlouski"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/mobileapp/action/KeyboardActions.java", "diffHunk": "@@ -44,6 +60,17 @@ public KeyboardActions(IWebDriverProvider webDriverProvider)\n     public void typeText(WebElement element, String text)\n     {\n         element.sendKeys(text);\n+        // https://github.com/appium/WebDriverAgent/blob/master/WebDriverAgentLib/Commands/FBCustomCommands.m#L107\n+        if (genericWebDriverManager.isIOSNativeApp() && realDevice)\n+        {\n+            Locator keyboardReturnLocator = new Locator(AppiumLocatorType.XPATH, new SearchParameters(\n+                    \"//XCUIElementTypeKeyboard//XCUIElementTypeButton[@name='Return']\", Visibility.VISIBLE, false));\n+            searchActions.findElement(keyboardReturnLocator).ifPresentOrElse(touchActions::tap, () ->\n+            {\n+                throw new IllegalStateException(\"Unable to find 'Return' button to close the keyboard\");\n+            });\n+            return;\n+        }\n         webDriverProvider.getUnwrapped(HidesKeyboard.class).hideKeyboard();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQyMTMwMw=="}, "originalCommit": {"oid": "96d59a96b574656438e0291b8276d8cb1d789942"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 168, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}