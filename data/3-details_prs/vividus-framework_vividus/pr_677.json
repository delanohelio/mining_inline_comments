{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1MDcyNjAw", "number": 677, "title": "[plugin-rest-api] Add step to change cookie value", "bodyText": "Fixes #660", "createdAt": "2020-06-16T08:57:10Z", "url": "https://github.com/vividus-framework/vividus/pull/677", "merged": true, "mergeCommit": {"oid": "0f699b82b62e6da88405ccff4988f3d34e925b06"}, "closed": true, "closedAt": "2020-06-18T20:34:00Z", "author": {"login": "EDbarvinsky"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcryGOsgFqTQzMTMyODc0OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsj8FFgFqTQzMzU5OTIwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxMzI4NzQ4", "url": "https://github.com/vividus-framework/vividus/pull/677#pullrequestreview-431328748", "createdAt": "2020-06-16T09:34:23Z", "commit": {"oid": "2fd0f4116811850568b8562ac6545d968f3b932b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTozNDoyNFrOGkTSUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwOTo0Njo0N1rOGkTvcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcxNzkwNw==", "bodyText": "If several cookies with the same name exist in cookie store, the value will be changed for all of them", "url": "https://github.com/vividus-framework/vividus/pull/677#discussion_r440717907", "createdAt": "2020-06-16T09:34:24Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-rest-api/src/main/java/org/vividus/bdd/steps/api/HttpCookieSteps.java", "diffHunk": "@@ -89,4 +92,40 @@ public void saveHttpCookieIntoVariable(String cookieName, Set<VariableScope> sco\n             }\n         }\n     }\n+\n+    /**\n+     * Change cookie value.\n+     * If present several cookies with the same name will be changed value for all of them,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fd0f4116811850568b8562ac6545d968f3b932b"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcyMjMyNA==", "bodyText": "move the assertion to a new method, that's going to be a method with single line of code, but it will improve overall code readability", "url": "https://github.com/vividus-framework/vividus/pull/677#discussion_r440722324", "createdAt": "2020-06-16T09:41:39Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-rest-api/src/main/java/org/vividus/bdd/steps/api/HttpCookieSteps.java", "diffHunk": "@@ -89,4 +92,40 @@ public void saveHttpCookieIntoVariable(String cookieName, Set<VariableScope> sco\n             }\n         }\n     }\n+\n+    /**\n+     * Change cookie value.\n+     * If present several cookies with the same name will be changed value for all of them,\n+     *\n+     * @param cookieName     name of cookie\n+     * @param newCookieValue value to set\n+     */\n+    @When(\"I change value of all HTTP cookies with name `$cookieName` to `$newCookieValue`\")\n+    public void changeHttpCookieValue(String cookieName, String newCookieValue)\n+    {\n+        List<Cookie> cookies = findCookiesBy(FILTER_BY_NAME, cookieName);\n+        if (softAssert.assertThat(String.format(NUMBER_OF_COOKIES_WITH_NAME, cookieName), cookies.size(),\n+                greaterThan(0)))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fd0f4116811850568b8562ac6545d968f3b932b"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDcyNTM2Mg==", "bodyText": "use another cookieName to make sure the previous scenario doesn't affect this one", "url": "https://github.com/vividus-framework/vividus/pull/677#discussion_r440725362", "createdAt": "2020-06-16T09:46:47Z", "author": {"login": "valfirst"}, "path": "vividus-tests/src/main/resources/story/integration/HttpCookieSteps.story", "diffHunk": "@@ -7,3 +7,9 @@ Scenario: Verify step: \"When I save value of HTTP cookie with name $cookieName t\n When I send HTTP GET to the relative URL '/cookies/set?cookieName=cookieValue'\n When I save value of HTTP cookie with name `cookieName` to SCENARIO variable `value`\n Then `${value}` is equal to `cookieValue`\n+\n+Scenario: Verify step: \"I change value of all HTTP cookies with name `$cookieName` to `$newCookieValue`\"\n+When I send HTTP GET to the relative URL '/cookies/set?cookieName=cookieValue'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fd0f4116811850568b8562ac6545d968f3b932b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMDg2ODU2", "url": "https://github.com/vividus-framework/vividus/pull/677#pullrequestreview-433086856", "createdAt": "2020-06-18T09:06:55Z", "commit": {"oid": "6d1109dc24ca88549cae5c78c099cda4104aea99"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOTowNjo1NVrOGlmfIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwOTowNjo1NVrOGlmfIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA4MTA1OQ==", "bodyText": "it can be inlined now", "url": "https://github.com/vividus-framework/vividus/pull/677#discussion_r442081059", "createdAt": "2020-06-18T09:06:55Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-rest-api/src/main/java/org/vividus/bdd/steps/api/HttpCookieSteps.java", "diffHunk": "@@ -34,6 +36,10 @@\n public class HttpCookieSteps\n {\n     private static final Logger LOGGER = LoggerFactory.getLogger(HttpCookieSteps.class);\n+    private static final BiPredicate<Cookie, String> FILTER_BY_NAME = (cookie, cookieName) -> cookie.getName()\n+            .equals(cookieName);\n+    private static final String NUMBER_OF_COOKIES_WITH_NAME = \"Number of cookies with name '%s'\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d1109dc24ca88549cae5c78c099cda4104aea99"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aba9974408b323594bfc0681e25d1a2b806f1a95", "author": {"user": {"login": "EDbarvinsky", "name": "Yauheni Barvinski"}}, "url": "https://github.com/vividus-framework/vividus/commit/aba9974408b323594bfc0681e25d1a2b806f1a95", "committedDate": "2020-06-18T13:45:49Z", "message": "[plugin-rest-api] Add step to change cookie value"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTk5MjA4", "url": "https://github.com/vividus-framework/vividus/pull/677#pullrequestreview-433599208", "createdAt": "2020-06-18T19:51:03Z", "commit": {"oid": "aba9974408b323594bfc0681e25d1a2b806f1a95"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 244, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}