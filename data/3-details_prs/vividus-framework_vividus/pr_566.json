{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NjE5ODky", "number": 566, "title": "[plugin-web-app] Fix scrolling script", "bodyText": "Script scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback", "createdAt": "2020-05-12T10:02:24Z", "url": "https://github.com/vividus-framework/vividus/pull/566", "merged": true, "mergeCommit": {"oid": "da006e34c543eab7b812f71fa8fa94f394873cab"}, "closed": true, "closedAt": "2020-05-12T15:22:45Z", "author": {"login": "ikalinin1"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgiHwPABqjMzMjY5MzAzOTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcglCZjAFqTQxMDA5Mjk0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a92343edc5e44781ba27483488d983194b49643d", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/a92343edc5e44781ba27483488d983194b49643d", "committedDate": "2020-05-12T10:01:50Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}, "afterCommit": {"oid": "fe4bb1c7d39fc97eb6782a80e62ac8923e8a49ee", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/fe4bb1c7d39fc97eb6782a80e62ac8923e8a49ee", "committedDate": "2020-05-12T10:49:57Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fe4bb1c7d39fc97eb6782a80e62ac8923e8a49ee", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/fe4bb1c7d39fc97eb6782a80e62ac8923e8a49ee", "committedDate": "2020-05-12T10:49:57Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}, "afterCommit": {"oid": "2d91dadb59ec7a42c7696680fd9d5265df725b69", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/2d91dadb59ec7a42c7696680fd9d5265df725b69", "committedDate": "2020-05-12T11:22:35Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5OTczODI3", "url": "https://github.com/vividus-framework/vividus/pull/566#pullrequestreview-409973827", "createdAt": "2020-05-12T12:07:57Z", "commit": {"oid": "2d91dadb59ec7a42c7696680fd9d5265df725b69"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowNzo1N1rOGUDb0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowNzo1N1rOGUDb0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY4MDk3Ng==", "bodyText": "please indent the line", "url": "https://github.com/vividus-framework/vividus/pull/566#discussion_r423680976", "createdAt": "2020-05-12T12:07:57Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-web-app/src/main/resources/org/vividus/ui/web/action/scroll-element-into-viewport-center.js", "diffHunk": "@@ -1,20 +1,32 @@\n var elementToScroll = arguments[0];\n var exit = arguments[arguments.length-1];\n-(scrollElementIntoViewportCenter = function() {\n-    var currentWindow = window;\n-    try {\n-        // Check, if we have an access to top level document\n-        window.top.document;\n-        while (currentWindow !== window.top) {\n-            elementToScroll = currentWindow.frameElement;\n-            currentWindow = currentWindow.parent;\n-        }\n-        currentWindow.scrollBy(0, elementToScroll.getBoundingClientRect().top - currentWindow.innerHeight * 0.25);\n-        setTimeout(scrollElementIntoViewportCenter, 500);\n-    }\n-    catch(e) {\n-        // swallow error quietly\n+var waitForScroll;\n+var currentWindow = window;\n+\n+try {\n+    // Check, if we have an access to top level document\n+    window.top.document;\n+    while (currentWindow !== window.top) {\n+        elementToScroll = currentWindow.frameElement;\n+        currentWindow = currentWindow.parent;\n     }\n-    exit();\n-}) ();\n+    currentWindow.addEventListener('scroll', clearTimeoutAndWait, false);\n+    currentWindow.scrollBy(0, elementToScroll.getBoundingClientRect().top - currentWindow.innerHeight * 0.25);\n+}\n+catch(e) {\n+    // swallow error quietly\n+}\n+\n+function wait() {\n+waitForScroll =  setTimeout(function() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d91dadb59ec7a42c7696680fd9d5265df725b69"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "947695b42ba0050e092c927c21a3594b4f1a1d98", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/947695b42ba0050e092c927c21a3594b4f1a1d98", "committedDate": "2020-05-12T14:18:23Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2d91dadb59ec7a42c7696680fd9d5265df725b69", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/2d91dadb59ec7a42c7696680fd9d5265df725b69", "committedDate": "2020-05-12T11:22:35Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}, "afterCommit": {"oid": "947695b42ba0050e092c927c21a3594b4f1a1d98", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/947695b42ba0050e092c927c21a3594b4f1a1d98", "committedDate": "2020-05-12T14:18:23Z", "message": "[plugin-web-app] Fix scrolling script\n\nScript scrolling element into viewport center was executed endlessly with timeout 500 seconds;\nThe strategy brokes the tests for example in the case when the user clicked anchor link, the page has never scrolled to the anchor because of the script;\nNew approach: Add scroll waiting listener -> Wait for the scroll end -> remove listener -> call selenium exit callback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDkyOTQy", "url": "https://github.com/vividus-framework/vividus/pull/566#pullrequestreview-410092942", "createdAt": "2020-05-12T14:20:46Z", "commit": {"oid": "947695b42ba0050e092c927c21a3594b4f1a1d98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 187, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}