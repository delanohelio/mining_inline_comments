{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2NTg1ODcz", "number": 685, "title": "[plugin-web-app] Supply meaningful message in case when context eleme\u2026", "bodyText": "\u2026nt becomes stale", "createdAt": "2020-06-18T16:05:16Z", "url": "https://github.com/vividus-framework/vividus/pull/685", "merged": true, "mergeCommit": {"oid": "7c1979e3fe4d9456b7f87a8e942406d66ef5f9f1"}, "closed": true, "closedAt": "2020-06-19T09:39:04Z", "author": {"login": "ikalinin1"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsguDigBqjM0NTg5MDQ2MTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsuuNDgFqTQzMzg5NTE4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fbfb749a9ee8c1b15a976f98cb38e5936e62899b", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/fbfb749a9ee8c1b15a976f98cb38e5936e62899b", "committedDate": "2020-06-18T16:04:50Z", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale"}, "afterCommit": {"oid": "1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "committedDate": "2020-06-18T16:05:53Z", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTUwMjM4", "url": "https://github.com/vividus-framework/vividus/pull/685#pullrequestreview-433550238", "createdAt": "2020-06-18T18:40:09Z", "commit": {"oid": "1aeacdabe6d0baac9fca4c19d6388b21eed2212c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo0MDowOVrOGl7pcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo0MDowOVrOGl7pcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyNzc2Mw==", "bodyText": "would not line breaks make the message readable?", "url": "https://github.com/vividus-framework/vividus/pull/685#discussion_r442427763", "createdAt": "2020-06-18T18:40:09Z", "author": {"login": "uarlouski"}, "path": "vividus-plugin-web-app/src/main/java/org/vividus/ui/web/action/ExpectedSearchContextConditions.java", "diffHunk": "@@ -17,28 +17,56 @@\n package org.vividus.ui.web.action;\n \n import java.util.List;\n+import java.util.function.Supplier;\n \n import org.openqa.selenium.By;\n import org.openqa.selenium.SearchContext;\n+import org.openqa.selenium.StaleElementReferenceException;\n import org.openqa.selenium.WebElement;\n \n public final class ExpectedSearchContextConditions extends AbstractExpectedConditions<By>\n {\n     @Override\n     protected List<WebElement> findElements(SearchContext searchContext, By by)\n     {\n-        return searchContext.findElements(by);\n+        return searchInforming(() -> searchContext.findElements(by));\n     }\n \n     @Override\n     protected WebElement findElement(SearchContext searchContext, By by)\n     {\n-        return searchContext.findElement(by);\n+        return searchInforming(() -> searchContext.findElement(by));\n+    }\n+\n+    private <E> E searchInforming(Supplier<E> search)\n+    {\n+        try\n+        {\n+            return search.get();\n+        }\n+        catch (StaleElementReferenceException toWrap)\n+        {\n+            throw new StaleContextException(toWrap);\n+        }\n     }\n \n     @Override\n     protected String toStringParameters(By locator)\n     {\n         return \"located by \" + locator;\n     }\n+\n+    public static class StaleContextException extends StaleElementReferenceException\n+    {\n+        private static final long serialVersionUID = 2449857900556530700L;\n+\n+        private StaleContextException(Throwable throwable)\n+        {\n+            super(\"Search context used for search is stale. \"\n+                + \"Please double check the tests. \"\n+                + \"You have a few options: \"\n+                + \"1. reset context; \"\n+                + \"2. Synchronize the tests to wait for context's stabilization;\", throwable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1aeacdabe6d0baac9fca4c19d6388b21eed2212c"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b54fced859b54d10f8028f0cc5d0587acf6c6d40", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/b54fced859b54d10f8028f0cc5d0587acf6c6d40", "committedDate": "2020-06-19T06:51:41Z", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/1aeacdabe6d0baac9fca4c19d6388b21eed2212c", "committedDate": "2020-06-18T16:05:53Z", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale"}, "afterCommit": {"oid": "b54fced859b54d10f8028f0cc5d0587acf6c6d40", "author": {"user": {"login": "ikalinin1", "name": "Ivan Kalinin"}}, "url": "https://github.com/vividus-framework/vividus/commit/b54fced859b54d10f8028f0cc5d0587acf6c6d40", "committedDate": "2020-06-19T06:51:41Z", "message": "[plugin-web-app] Supply meaningful message in case when context element becomes stale"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODYyMTM0", "url": "https://github.com/vividus-framework/vividus/pull/685#pullrequestreview-433862134", "createdAt": "2020-06-19T07:31:13Z", "commit": {"oid": "b54fced859b54d10f8028f0cc5d0587acf6c6d40"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODk1MTgy", "url": "https://github.com/vividus-framework/vividus/pull/685#pullrequestreview-433895182", "createdAt": "2020-06-19T08:24:51Z", "commit": {"oid": "b54fced859b54d10f8028f0cc5d0587acf6c6d40"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 253, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}