{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0NjkwNTI5", "number": 1267, "title": "[plugin-mobile-app] Adjust element position on screen after swipe to it", "bodyText": "", "createdAt": "2020-12-23T10:09:24Z", "url": "https://github.com/vividus-framework/vividus/pull/1267", "merged": true, "mergeCommit": {"oid": "4772861a53bde05013d30552dfe16d50ebd69729"}, "closed": true, "closedAt": "2020-12-24T07:49:04Z", "author": {"login": "uarlouski"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdo8oePgFqTU1Nzc4MTI2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpOuYsAFqTU1ODM4ODk1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NzgxMjYw", "url": "https://github.com/vividus-framework/vividus/pull/1267#pullrequestreview-557781260", "createdAt": "2020-12-23T10:28:55Z", "commit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMDoyODo1NlrOIKgeNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMDozMjowOVrOIKgjLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4ODY5NQ==", "bodyText": "adjustVerticalPosition", "url": "https://github.com/vividus-framework/vividus/pull/1267#discussion_r547888695", "createdAt": "2020-12-23T10:28:56Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/TouchSteps.java", "diffHunk": "@@ -139,8 +145,34 @@ public void swipeToElement(SwipeDirection direction, Locator locator, Duration d\n             });\n         }\n \n-        baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n-                ComparisonRule.EQUAL_TO, 1);\n+        if (baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n+                ComparisonRule.EQUAL_TO, 1))\n+        {\n+            adjustElementPosition(elements.get(0), duration);\n+        }\n+    }\n+\n+    private void adjustElementPosition(WebElement element, Duration duration)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4ODg3OQ==", "bodyText": "duration -> swipeDuration", "url": "https://github.com/vividus-framework/vividus/pull/1267#discussion_r547888879", "createdAt": "2020-12-23T10:29:20Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/TouchSteps.java", "diffHunk": "@@ -139,8 +145,34 @@ public void swipeToElement(SwipeDirection direction, Locator locator, Duration d\n             });\n         }\n \n-        baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n-                ComparisonRule.EQUAL_TO, 1);\n+        if (baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n+                ComparisonRule.EQUAL_TO, 1))\n+        {\n+            adjustElementPosition(elements.get(0), duration);\n+        }\n+    }\n+\n+    private void adjustElementPosition(WebElement element, Duration duration)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4OTQxMg==", "bodyText": "(windowSizeHeight - visibilityIndent) - is calculated twice", "url": "https://github.com/vividus-framework/vividus/pull/1267#discussion_r547889412", "createdAt": "2020-12-23T10:30:48Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/TouchSteps.java", "diffHunk": "@@ -139,8 +145,34 @@ public void swipeToElement(SwipeDirection direction, Locator locator, Duration d\n             });\n         }\n \n-        baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n-                ComparisonRule.EQUAL_TO, 1);\n+        if (baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n+                ComparisonRule.EQUAL_TO, 1))\n+        {\n+            adjustElementPosition(elements.get(0), duration);\n+        }\n+    }\n+\n+    private void adjustElementPosition(WebElement element, Duration duration)\n+    {\n+        int windowSizeHeight = genericWebDriverManager.getSize().getHeight();\n+        int windowCenterY = windowSizeHeight / 2;\n+        int visibilityIndent = (int) (VISIBILITY_INDENT_COEFFICIENT * windowSizeHeight);\n+        int elementTopCoordinateY = element.getLocation().getY();\n+\n+        if (elementTopCoordinateY < visibilityIndent)\n+        {\n+            performSwipe(windowCenterY, visibilityIndent - elementTopCoordinateY, duration);\n+        }\n+        else if (elementTopCoordinateY > windowSizeHeight - visibilityIndent)\n+        {\n+            performSwipe(windowCenterY, Math.negateExact(elementTopCoordinateY - (windowSizeHeight - visibilityIndent)),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4OTg0MA==", "bodyText": "what about moving this method to TouchActions and naming performVerticalSwipe", "url": "https://github.com/vividus-framework/vividus/pull/1267#discussion_r547889840", "createdAt": "2020-12-23T10:31:52Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/TouchSteps.java", "diffHunk": "@@ -139,8 +145,34 @@ public void swipeToElement(SwipeDirection direction, Locator locator, Duration d\n             });\n         }\n \n-        baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n-                ComparisonRule.EQUAL_TO, 1);\n+        if (baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n+                ComparisonRule.EQUAL_TO, 1))\n+        {\n+            adjustElementPosition(elements.get(0), duration);\n+        }\n+    }\n+\n+    private void adjustElementPosition(WebElement element, Duration duration)\n+    {\n+        int windowSizeHeight = genericWebDriverManager.getSize().getHeight();\n+        int windowCenterY = windowSizeHeight / 2;\n+        int visibilityIndent = (int) (VISIBILITY_INDENT_COEFFICIENT * windowSizeHeight);\n+        int elementTopCoordinateY = element.getLocation().getY();\n+\n+        if (elementTopCoordinateY < visibilityIndent)\n+        {\n+            performSwipe(windowCenterY, visibilityIndent - elementTopCoordinateY, duration);\n+        }\n+        else if (elementTopCoordinateY > windowSizeHeight - visibilityIndent)\n+        {\n+            performSwipe(windowCenterY, Math.negateExact(elementTopCoordinateY - (windowSizeHeight - visibilityIndent)),\n+                    duration);\n+        }\n+    }\n+\n+    private void performSwipe(int centerY, int offset, Duration duration)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg4OTk2NA==", "bodyText": "centerY -> startY ?", "url": "https://github.com/vividus-framework/vividus/pull/1267#discussion_r547889964", "createdAt": "2020-12-23T10:32:09Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/steps/TouchSteps.java", "diffHunk": "@@ -139,8 +145,34 @@ public void swipeToElement(SwipeDirection direction, Locator locator, Duration d\n             });\n         }\n \n-        baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n-                ComparisonRule.EQUAL_TO, 1);\n+        if (baseValidations.assertElementsNumber(String.format(\"The element by locator %s exists\", locator), elements,\n+                ComparisonRule.EQUAL_TO, 1))\n+        {\n+            adjustElementPosition(elements.get(0), duration);\n+        }\n+    }\n+\n+    private void adjustElementPosition(WebElement element, Duration duration)\n+    {\n+        int windowSizeHeight = genericWebDriverManager.getSize().getHeight();\n+        int windowCenterY = windowSizeHeight / 2;\n+        int visibilityIndent = (int) (VISIBILITY_INDENT_COEFFICIENT * windowSizeHeight);\n+        int elementTopCoordinateY = element.getLocation().getY();\n+\n+        if (elementTopCoordinateY < visibilityIndent)\n+        {\n+            performSwipe(windowCenterY, visibilityIndent - elementTopCoordinateY, duration);\n+        }\n+        else if (elementTopCoordinateY > windowSizeHeight - visibilityIndent)\n+        {\n+            performSwipe(windowCenterY, Math.negateExact(elementTopCoordinateY - (windowSizeHeight - visibilityIndent)),\n+                    duration);\n+        }\n+    }\n+\n+    private void performSwipe(int centerY, int offset, Duration duration)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "originalPosition": 69}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3Nzg1MDg0", "url": "https://github.com/vividus-framework/vividus/pull/1267#pullrequestreview-557785084", "createdAt": "2020-12-23T10:36:29Z", "commit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMDozNjozMFrOIKgqAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxMDozNjozMFrOIKgqAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg5MTcxMw==", "bodyText": "why is it needed?", "url": "https://github.com/vividus-framework/vividus/pull/1267#discussion_r547891713", "createdAt": "2020-12-23T10:36:30Z", "author": {"login": "valfirst"}, "path": "vividus-plugin-mobile-app/src/main/java/org/vividus/bdd/mobileapp/model/SwipeCoordinates.java", "diffHunk": "@@ -38,4 +40,25 @@ public Point getEnd()\n     {\n         return end;\n     }\n+\n+    @Override\n+    public int hashCode()\n+    {\n+        return Objects.hash(end, start);\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "965b9d2e009ec951cc1b7b900a4864301d9a4d3b", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/965b9d2e009ec951cc1b7b900a4864301d9a4d3b", "committedDate": "2020-12-23T10:08:26Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}, "afterCommit": {"oid": "2a32edc2df1aa3d2518f3422b752848f76a38578", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/2a32edc2df1aa3d2518f3422b752848f76a38578", "committedDate": "2020-12-23T11:30:51Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a32edc2df1aa3d2518f3422b752848f76a38578", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/2a32edc2df1aa3d2518f3422b752848f76a38578", "committedDate": "2020-12-23T11:30:51Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}, "afterCommit": {"oid": "b8d486080c60d02368dfb346f6ec6119cef67860", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/b8d486080c60d02368dfb346f6ec6119cef67860", "committedDate": "2020-12-23T12:32:14Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8d486080c60d02368dfb346f6ec6119cef67860", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/b8d486080c60d02368dfb346f6ec6119cef67860", "committedDate": "2020-12-23T12:32:14Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}, "afterCommit": {"oid": "5797545e14b69ec4440e01dceedcdc3b33c4385d", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/5797545e14b69ec4440e01dceedcdc3b33c4385d", "committedDate": "2020-12-23T13:20:13Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3ODkwMDk0", "url": "https://github.com/vividus-framework/vividus/pull/1267#pullrequestreview-557890094", "createdAt": "2020-12-23T14:09:42Z", "commit": {"oid": "5797545e14b69ec4440e01dceedcdc3b33c4385d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75f01d706decae2d54ee5518cade6f2f2c83bde4", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/75f01d706decae2d54ee5518cade6f2f2c83bde4", "committedDate": "2020-12-23T19:09:04Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5797545e14b69ec4440e01dceedcdc3b33c4385d", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/5797545e14b69ec4440e01dceedcdc3b33c4385d", "committedDate": "2020-12-23T13:20:13Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}, "afterCommit": {"oid": "75f01d706decae2d54ee5518cade6f2f2c83bde4", "author": {"user": {"login": "uarlouski", "name": "Uladzislau Arlouski"}}, "url": "https://github.com/vividus-framework/vividus/commit/75f01d706decae2d54ee5518cade6f2f2c83bde4", "committedDate": "2020-12-23T19:09:04Z", "message": "[plugin-mobile-app] Adjust element position on screen after swipe to it"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4Mzg4OTU3", "url": "https://github.com/vividus-framework/vividus/pull/1267#pullrequestreview-558388957", "createdAt": "2020-12-24T07:37:28Z", "commit": {"oid": "75f01d706decae2d54ee5518cade6f2f2c83bde4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4701, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}