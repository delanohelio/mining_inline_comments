{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3ODYxNDk4", "number": 391, "title": "Recreate story manager right before batch execution", "bodyText": "JBehaveJUnitRunner may initialize story manager with default PerformableTree and\nEmebedderControls, so story manager should be re-created before actual batch execution\nIssues fixed by this change:\n\nFixes #376 (root cause: batch embedder controls are ignored by story manager)\nWarnings like\n2020-03-13 18:06:25,876 SpringContextShutdownHook WARN Unable to register Log4j shutdown hook because JVM is shutting down. Using SimpleLogger\n\nThe root cause of this warning is skipped reporting of AfterStories when single batch is used. (Allure report is generated in AfterStories by default or in JVM shutdown hook in case of premature end of test execution. When Allure JVM shutdown hook is triggered, Log4j JVM hook is already finished and Log4j is shutdown, as result Allure reporter can't log anything)", "createdAt": "2020-03-13T16:12:32Z", "url": "https://github.com/vividus-framework/vividus/pull/391", "merged": true, "mergeCommit": {"oid": "be031b70c78c351e7bcea9d8443d85d70e2277d5"}, "closed": true, "closedAt": "2020-03-15T09:29:42Z", "author": {"login": "valfirst"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNVjH0ABqjMxMjc5NjAyMDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcN1vMigBqjMxMzAyODkxOTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2534449335c2f11905ab1f9167af3a34653a4c83", "author": {"user": {"login": "valfirst", "name": "Valery Yatsynovich"}}, "url": "https://github.com/vividus-framework/vividus/commit/2534449335c2f11905ab1f9167af3a34653a4c83", "committedDate": "2020-03-13T16:10:58Z", "message": "Recreate story manager right before batch execution\n\nJBehaveJUnitRunner may initialize story manager with default PerformableTree and\nEmebedderControls, so story manager should be re-created before actual batch execution"}, "afterCommit": {"oid": "67c024ac7cad6191dc40a35436da5435a6ba78da", "author": {"user": {"login": "valfirst", "name": "Valery Yatsynovich"}}, "url": "https://github.com/vividus-framework/vividus/commit/67c024ac7cad6191dc40a35436da5435a6ba78da", "committedDate": "2020-03-13T19:33:09Z", "message": "Recreate story manager right before batch execution\n\nJBehaveJUnitRunner may initialize story manager with default PerformableTree and\nEmebedderControls, so story manager should be re-created before actual batch execution"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NzAyNDI4", "url": "https://github.com/vividus-framework/vividus/pull/391#pullrequestreview-374702428", "createdAt": "2020-03-14T06:31:46Z", "commit": {"oid": "67c024ac7cad6191dc40a35436da5435a6ba78da"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwNjozMTo0NlrOF2YFaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwNjozMTo0NlrOF2YFaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2MjAyNQ==", "bodyText": "noisy changes", "url": "https://github.com/vividus-framework/vividus/pull/391#discussion_r392562025", "createdAt": "2020-03-14T06:31:46Z", "author": {"login": "uarlouski"}, "path": "vividus-bdd-engine/src/test/java/org/vividus/bdd/BatchedEmbedderTests.java", "diffHunk": "@@ -248,9 +244,31 @@ private void mockBatchExecutionConfiguration()\n \n     private boolean assertEmbedderControls(EmbedderControls controls)\n     {\n-        return controls.threads() == THREADS\n-                && \"3600\".equals(controls.storyTimeouts())\n-                && controls.ignoreFailureInStories()\n-                && !controls.generateViewAfterStories();\n+        return controls.threads() == THREADS && \"3600\".equals(controls.storyTimeouts()) && controls\n+                .ignoreFailureInStories() && !controls.generateViewAfterStories();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67c024ac7cad6191dc40a35436da5435a6ba78da"}, "originalPosition": 150}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NzAyNDQw", "url": "https://github.com/vividus-framework/vividus/pull/391#pullrequestreview-374702440", "createdAt": "2020-03-14T06:32:05Z", "commit": {"oid": "67c024ac7cad6191dc40a35436da5435a6ba78da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NzAzMDYy", "url": "https://github.com/vividus-framework/vividus/pull/391#pullrequestreview-374703062", "createdAt": "2020-03-14T06:46:49Z", "commit": {"oid": "67c024ac7cad6191dc40a35436da5435a6ba78da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0911dd29d04484bf492fe2c1126deac379d33508", "author": {"user": {"login": "valfirst", "name": "Valery Yatsynovich"}}, "url": "https://github.com/vividus-framework/vividus/commit/0911dd29d04484bf492fe2c1126deac379d33508", "committedDate": "2020-03-15T09:03:23Z", "message": "Recreate story manager right before batch execution\n\nJBehaveJUnitRunner may initialize story manager with default PerformableTree and\nEmebedderControls, so story manager should be re-created before actual batch execution"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "67c024ac7cad6191dc40a35436da5435a6ba78da", "author": {"user": {"login": "valfirst", "name": "Valery Yatsynovich"}}, "url": "https://github.com/vividus-framework/vividus/commit/67c024ac7cad6191dc40a35436da5435a6ba78da", "committedDate": "2020-03-13T19:33:09Z", "message": "Recreate story manager right before batch execution\n\nJBehaveJUnitRunner may initialize story manager with default PerformableTree and\nEmebedderControls, so story manager should be re-created before actual batch execution"}, "afterCommit": {"oid": "0911dd29d04484bf492fe2c1126deac379d33508", "author": {"user": {"login": "valfirst", "name": "Valery Yatsynovich"}}, "url": "https://github.com/vividus-framework/vividus/commit/0911dd29d04484bf492fe2c1126deac379d33508", "committedDate": "2020-03-15T09:03:23Z", "message": "Recreate story manager right before batch execution\n\nJBehaveJUnitRunner may initialize story manager with default PerformableTree and\nEmebedderControls, so story manager should be re-created before actual batch execution"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 370, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}