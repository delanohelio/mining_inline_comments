{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMTExNjYz", "number": 1516, "title": "Add a requireNonNull to ensure the extension XML serializer is not null when writeExtension() is called", "bodyText": "Signed-off-by: RALAMBOTIANA MIORA miora.ralambotiana@rte-france.com\nPlease check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nNo\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nBug fix: ensure that extension XML serializer is not null when writeExtension is called\nBug fix: filter extensions which are not in options during XML export\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\nNo\nOther information:\nIf you agree with these fixes, they should be also merged for release 3.7.0", "createdAt": "2020-10-13T08:52:03Z", "url": "https://github.com/powsybl/powsybl-core/pull/1516", "merged": true, "mergeCommit": {"oid": "d9670c9db6805910c4845a148f468acf2ab1ff8a"}, "closed": true, "closedAt": "2020-10-15T12:57:11Z", "author": {"login": "MioRtia"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSEmtBAH2gAyNTAyMTExNjYzOjE3MWU0MzFjYzZhMDBmZjgyNjA5ODRlZTYyMzAzMTA1MWVjMjIwNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSxJaVAH2gAyNTAyMTExNjYzOjMxYjVmOGMwZGJjZTNkOTE1YzI0NWU0NjVhZTg2YzU5OWZjYjk0YTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "171e431cc6a00ff8260984ee623031051ec22057", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/171e431cc6a00ff8260984ee623031051ec22057", "committedDate": "2020-10-13T08:49:46Z", "message": "Add a requireNonNull to ensure the extension XML serializer is not null when writeExtension() is called + filter extensions not in options during export\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjE4MDAz", "url": "https://github.com/powsybl/powsybl-core/pull/1516#pullrequestreview-507218003", "createdAt": "2020-10-13T09:00:09Z", "commit": {"oid": "171e431cc6a00ff8260984ee623031051ec22057"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwOTowMDoxMFrOHgcmsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwOToxMzozNlrOHgdJUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc4NTEzOQ==", "bodyText": "This test is already performed in getExtensionXmlSerializer\n    private static ExtensionXmlSerializer getExtensionXmlSerializer(ExportOptions options, Extension<? extends Identifiable<?>> extension) {\n        if (options.withExtension(extension.getName())) {\n        ....\n        }\n     }", "url": "https://github.com/powsybl/powsybl-core/pull/1516#discussion_r503785139", "createdAt": "2020-10-13T09:00:10Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -216,6 +216,7 @@ private static void writeExtensions(Network n, NetworkXmlWriterContext context,\n \n             Collection<? extends Extension<? extends Identifiable<?>>> extensions = identifiable.getExtensions().stream()\n                     .filter(e -> getExtensionXmlSerializer(options, e) != null)\n+                    .filter(e -> context.getOptions().withExtension(e.getName()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "171e431cc6a00ff8260984ee623031051ec22057"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc5NDAwMw==", "bodyText": "Objects.requireNonNull throws a NullPointerException: do we need a more specific exception like it's thrown in getExtensionXmlSerializer?\nI think we never have a null extensionXmlSerializer there. The getExtensionXmlSerializer return null in two cases:\n\nthe extension should not be serialized (no data for the current variant). It never happens because these extensions are filtered in writeExtensions\nthe extension is skipped (options). It never happens because these extensions are filtered in writeExtensions\n\nFrom my point of view, we should throw an AssertionError here with an explicit message if the serializer is null because something really unexpected happened", "url": "https://github.com/powsybl/powsybl-core/pull/1516#discussion_r503794003", "createdAt": "2020-10-13T09:13:36Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -150,7 +150,7 @@ private static void writeExtensionNamespaces(Network n, ExportOptions options, X\n \n     private static void writeExtension(Extension<? extends Identifiable<?>> extension, NetworkXmlWriterContext context) throws XMLStreamException {\n         XMLStreamWriter writer = context.getExtensionsWriter();\n-        ExtensionXmlSerializer extensionXmlSerializer = getExtensionXmlSerializer(context.getOptions(), extension);\n+        ExtensionXmlSerializer extensionXmlSerializer = Objects.requireNonNull(getExtensionXmlSerializer(context.getOptions(), extension));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "171e431cc6a00ff8260984ee623031051ec22057"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53ea0f1a628718f4eeacdfa8ca0d7521fd0ba780", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/53ea0f1a628718f4eeacdfa8ca0d7521fd0ba780", "committedDate": "2020-10-13T09:20:55Z", "message": "Don't make the same check twice\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dece4d24a5a018454ab531fbb6fb4423282133c0", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/dece4d24a5a018454ab531fbb6fb4423282133c0", "committedDate": "2020-10-13T12:15:59Z", "message": "Replace requireNonNull by a check that throws an AssertionException\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MzIyNjQ4", "url": "https://github.com/powsybl/powsybl-core/pull/1516#pullrequestreview-509322648", "createdAt": "2020-10-15T12:27:32Z", "commit": {"oid": "dece4d24a5a018454ab531fbb6fb4423282133c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5302cf75c532ff0e964be68ad33448f7bb859068", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/5302cf75c532ff0e964be68ad33448f7bb859068", "committedDate": "2020-10-15T12:27:36Z", "message": "Merge branch 'master' into fix_extensions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31b5f8c0dbce3d915c245e465ae86c599fcb94a1", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/31b5f8c0dbce3d915c245e465ae86c599fcb94a1", "committedDate": "2020-10-15T12:43:30Z", "message": "Merge branch 'master' into fix_extensions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4056, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}