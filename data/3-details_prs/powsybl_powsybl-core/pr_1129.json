{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1NzY4NDk4", "number": 1129, "title": "Allow to write IIDM-XML files in previous versions", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ?\nNo\nWhat kind of change does this PR introduce?\nFeature\nWhat is the current behavior?\nIIDM-XML files can only be written in current IIDM-XML version (i.e. 1.1)\nWhat is the new behavior (if this is a feature change)?\nIIDM-XML files can now be written in current and previous IIDM-XML versions (i.e. 1.0 and 1.1)\nDoes this PR introduce a breaking change or deprecate an API?\nNo\nOther information:\n\u26a0\ufe0f Network extensions cannot for the moment be written in previous versions, it will be implemented in another PR", "createdAt": "2020-01-22T10:12:06Z", "url": "https://github.com/powsybl/powsybl-core/pull/1129", "merged": true, "mergeCommit": {"oid": "efaba7eaa754f9590bf4d20d622fb454d299ebb7"}, "closed": true, "closedAt": "2020-01-31T15:31:37Z", "author": {"login": "MioRtia"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb80204ABqjI5Njk4NDkxNDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_wX0WgH2gAyMzY1NzY4NDk4OmFkYTc0YTBkZDVhOWY2OTZlYjQ0ZWRkNGI1OTc3ZmI4MmVhZWQzZWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "13adfa76df63b8a8dcca3c3bd0536f763512417f", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/13adfa76df63b8a8dcca3c3bd0536f763512417f", "committedDate": "2020-01-22T10:09:08Z", "message": "Update tests to test the new feature\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "f64b765196418055360206a626077997bd3ebc7c", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/f64b765196418055360206a626077997bd3ebc7c", "committedDate": "2020-01-22T12:25:21Z", "message": "add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b54ca27c78079c4fcf0d9f9f85e4e3746dc55f8", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/1b54ca27c78079c4fcf0d9f9f85e4e3746dc55f8", "committedDate": "2020-01-22T12:26:00Z", "message": "correct checkstyle\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/20e2f4833a4bdf60255d37ce3dafe41a6b10afa3", "committedDate": "2020-01-23T14:07:50Z", "message": "add new mechanisms\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NTUxOTg1", "url": "https://github.com/powsybl/powsybl-core/pull/1129#pullrequestreview-348551985", "createdAt": "2020-01-27T10:12:36Z", "commit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMDoxMjozN1rOFh9dUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMDoxNzozNFrOFh9mVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE1NDI1Ng==", "bodyText": "Implement this in the opposite way: the constructor with the biggest number of parameter should contain the logic. The other constructor(s) should call it with default values", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371154256", "createdAt": "2020-01-27T10:12:37Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-converter-api/src/main/java/com/powsybl/iidm/export/ExportOptions.java", "diffHunk": "@@ -50,6 +52,11 @@ public ExportOptions(boolean withBranchSV, boolean indent, boolean onlyMainCc, T\n         this.throwExceptionIfExtensionNotFound = throwExceptionIfExtensionNotFound;\n     }\n \n+    public ExportOptions(boolean withBranchSV, boolean indent, boolean onlyMainCc, TopologyLevel topologyLevel, boolean throwExceptionIfExtensionNotFound, String version) {\n+        this(withBranchSV, indent, onlyMainCc, topologyLevel, throwExceptionIfExtensionNotFound);\n+        this.version = version;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE1NDY1Ng==", "bodyText": "Not sure this should be deprecated: for most people, export network using the current version is OK?", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371154656", "createdAt": "2020-01-27T10:13:28Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -153,31 +151,47 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n                 double value = XmlUtil.readOptionalDoubleAttribute(reader, \"value\", Double.MAX_VALUE);\n                 boolean fictitious = XmlUtil.readOptionalBoolAttribute(reader, \"fictitious\", false);\n                 adder.beginTemporaryLimit()\n-                    .setName(name)\n-                    .setAcceptableDuration(acceptableDuration)\n-                    .setValue(value)\n-                    .setFictitious(fictitious)\n-                    .endTemporaryLimit();\n+                        .setName(name)\n+                        .setAcceptableDuration(acceptableDuration)\n+                        .setValue(value)\n+                        .setFictitious(fictitious)\n+                        .endTemporaryLimit();\n             }\n         });\n         adder.add();\n     }\n \n+    /**\n+     * @deprecated Use {@link #writeCurrentLimits(Integer, CurrentLimits, XMLStreamWriter, IidmXmlVersion)} instead.\n+     */\n+    @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE1NDg0NA==", "bodyText": "Assert that it's not null", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371154844", "createdAt": "2020-01-27T10:13:53Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractNetworkXmlContext.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.xml;\n+\n+import com.powsybl.iidm.AbstractConverterContext;\n+import com.powsybl.iidm.anonymizer.Anonymizer;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public abstract class AbstractNetworkXmlContext<T> extends AbstractConverterContext<T> {\n+\n+    private final IidmXmlVersion version;\n+\n+    AbstractNetworkXmlContext(Anonymizer anonymizer, IidmXmlVersion version) {\n+        super(anonymizer);\n+        this.version = version;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE1NTg3NQ==", "bodyText": "Maybe you should also introduce RATIO_TAP_CHANGER_2 and RATIO_TAP_CHANGER_3 even there is no duplication yet", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371155875", "createdAt": "2020-01-27T10:16:03Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/ThreeWindingsTransformerXml.java", "diffHunk": "@@ -22,6 +22,11 @@\n \n     static final String ROOT_ELEMENT_NAME = \"threeWindingsTransformer\";\n \n+    private static final String RATIO_TAP_CHANGER_1 = \"ratioTapChanger1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE1NjU2Ng==", "bodyText": "Why don't you use the default Runnable? Maybe for exception handling? In that case, I think we have an UncheckedXmlStreamException", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371156566", "createdAt": "2020-01-27T10:17:34Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -7,17 +7,29 @@\n package com.powsybl.iidm.xml.util;\n \n import com.powsybl.commons.PowsyblException;\n+import com.powsybl.commons.xml.XmlUtil;\n+import com.powsybl.iidm.xml.AbstractNetworkXmlContext;\n import com.powsybl.iidm.xml.IidmXmlVersion;\n import com.powsybl.iidm.xml.NetworkXmlReaderContext;\n+import com.powsybl.iidm.xml.NetworkXmlWriterContext;\n+\n+import javax.xml.stream.XMLStreamException;\n+import java.util.Objects;\n \n /**\n  * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n  */\n public final class IidmXmlUtil {\n \n+    public interface IidmXmlRunnable {\n+        void run() throws XMLStreamException;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3"}, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "20e2f4833a4bdf60255d37ce3dafe41a6b10afa3", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/20e2f4833a4bdf60255d37ce3dafe41a6b10afa3", "committedDate": "2020-01-23T14:07:50Z", "message": "add new mechanisms\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "cbbc53abc52ac078cc15a74ae99eed757ee6e9de", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/cbbc53abc52ac078cc15a74ae99eed757ee6e9de", "committedDate": "2020-01-27T14:16:42Z", "message": "corrections\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTgzNDE1", "url": "https://github.com/powsybl/powsybl-core/pull/1129#pullrequestreview-349183415", "createdAt": "2020-01-28T08:03:13Z", "commit": {"oid": "ef4e77fb5531cfb003de37424ec3354e389920c8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwODowMzoxM1rOFib39Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwODowNToxM1rOFib6lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY1MjU5Nw==", "bodyText": "To be discussed: I'm not sure we should allow null values", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371652597", "createdAt": "2020-01-28T08:03:13Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-converter-api/src/main/java/com/powsybl/iidm/export/ExportOptions.java", "diffHunk": "@@ -39,15 +39,22 @@\n \n     private boolean throwExceptionIfExtensionNotFound = false;\n \n+    private String version;\n+\n     public ExportOptions() {\n     }\n \n     public ExportOptions(boolean withBranchSV, boolean indent, boolean onlyMainCc, TopologyLevel topologyLevel, boolean throwExceptionIfExtensionNotFound) {\n+        this(withBranchSV, indent, onlyMainCc, topologyLevel, throwExceptionIfExtensionNotFound, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef4e77fb5531cfb003de37424ec3354e389920c8"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY1MzI3MQ==", "bodyText": "To be discussed: I fact, I have a doubt now... This method is not really public, but private package... maybe you were right yesterday when I asked you to remove the deprecated. I think we should even break the API and make this method private package.\nIs this method still used?", "url": "https://github.com/powsybl/powsybl-core/pull/1129#discussion_r371653271", "createdAt": "2020-01-28T08:05:13Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AbstractConnectableXml.java", "diffHunk": "@@ -153,31 +151,39 @@ public static void readCurrentLimits(Integer index, Supplier<CurrentLimitsAdder>\n                 double value = XmlUtil.readOptionalDoubleAttribute(reader, \"value\", Double.MAX_VALUE);\n                 boolean fictitious = XmlUtil.readOptionalBoolAttribute(reader, \"fictitious\", false);\n                 adder.beginTemporaryLimit()\n-                    .setName(name)\n-                    .setAcceptableDuration(acceptableDuration)\n-                    .setValue(value)\n-                    .setFictitious(fictitious)\n-                    .endTemporaryLimit();\n+                        .setName(name)\n+                        .setAcceptableDuration(acceptableDuration)\n+                        .setValue(value)\n+                        .setFictitious(fictitious)\n+                        .endTemporaryLimit();\n             }\n         });\n         adder.add();\n     }\n \n     public static void writeCurrentLimits(Integer index, CurrentLimits limits, XMLStreamWriter writer) throws XMLStreamException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef4e77fb5531cfb003de37424ec3354e389920c8"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d405b3528f109e5a6bbadc8c85d215af95839b71", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/d405b3528f109e5a6bbadc8c85d215af95839b71", "committedDate": "2020-01-31T14:49:05Z", "message": "Allow writing IIDM-XML files in previous versions (not only current one)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "317258cac8718b802eb52786ee2fb389d1fb7b1d", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/317258cac8718b802eb52786ee2fb389d1fb7b1d", "committedDate": "2020-01-31T14:49:06Z", "message": "Update tests to test the new feature\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72f8ed27d5a824a861a9272c6232b32f55627d79", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/72f8ed27d5a824a861a9272c6232b32f55627d79", "committedDate": "2020-01-31T14:49:06Z", "message": "add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "887e2ab660bee8f1a9c71340f441df473f5b8fd0", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/887e2ab660bee8f1a9c71340f441df473f5b8fd0", "committedDate": "2020-01-31T14:49:06Z", "message": "correct checkstyle\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be06de27684686c0bcbe2ff753be596cc9a5c158", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/be06de27684686c0bcbe2ff753be596cc9a5c158", "committedDate": "2020-01-31T14:49:06Z", "message": "add new mechanisms\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7350520a760fb411aa4547bb0cba8791c304205c", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/7350520a760fb411aa4547bb0cba8791c304205c", "committedDate": "2020-01-31T14:49:06Z", "message": "corrections\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bed74fdfb731cd9802730e5566f3a00a0426498d", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/bed74fdfb731cd9802730e5566f3a00a0426498d", "committedDate": "2020-01-31T14:49:06Z", "message": "corrections\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16022487668317214fb94690db9f9e7633ca37d7", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/16022487668317214fb94690db9f9e7633ca37d7", "committedDate": "2020-01-31T14:49:06Z", "message": "deprecate writeCurrentLimits without IidmXmlVersion parameter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef4e77fb5531cfb003de37424ec3354e389920c8", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/ef4e77fb5531cfb003de37424ec3354e389920c8", "committedDate": "2020-01-27T14:37:30Z", "message": "corrections\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "16022487668317214fb94690db9f9e7633ca37d7", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/16022487668317214fb94690db9f9e7633ca37d7", "committedDate": "2020-01-31T14:49:06Z", "message": "deprecate writeCurrentLimits without IidmXmlVersion parameter\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ada74a0dd5a9f696eb44edd4b5977fb82eaed3ea", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/ada74a0dd5a9f696eb44edd4b5977fb82eaed3ea", "committedDate": "2020-01-31T14:53:37Z", "message": "Merge branch 'master' into xiidm_write_versionable"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4360, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}