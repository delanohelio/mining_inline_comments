{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMTkwNTI5", "number": 1402, "title": "Add the possibility to associate a type to an alias (indicating what it corresponds to)", "bodyText": "Signed-off-by: RALAMBOTIANA MIORA miora.ralambotiana@rte-france.com\nPlease check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nNo\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nFeature\nWhat is the current behavior? (You can also link to an open issue here)\nWhen adding an alias, there is no indication of what the alias' origin is.\nWhat is the new behavior (if this is a feature change)?\nA type string can be associated to the alias, providing more information of where the alias comes from or what it indicates.\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\nNo\nOther information:\nSome fixes on the XIIDM serialization of aliases have been done too. If there is some discussion about this PR, I can move them to another one.\n@geofjamg Is this behavior easily reproducible with the persistent implementation?", "createdAt": "2020-07-17T15:09:11Z", "url": "https://github.com/powsybl/powsybl-core/pull/1402", "merged": true, "mergeCommit": {"oid": "eb320d5c327938bfdff438f4508212522e1e459e"}, "closed": true, "closedAt": "2020-09-08T09:27:28Z", "author": {"login": "MioRtia"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3Z9KcgBqjM1NzU1MzM1OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFmgXWAH2gAyNDUxMTkwNTI5OmQ1ZmQ0ZWFiNjA2MDMwNzRjNjY0MWM4OWQ1OTUyNTkyNmMyM2UzYjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c754104ecddba7f8e9f059c51a9c102d511fdea", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/2c754104ecddba7f8e9f059c51a9c102d511fdea", "committedDate": "2020-07-20T12:00:48Z", "message": "Correct code smell\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "0c227ddc75a4756d5d77ec28b842756db94e44e0", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/0c227ddc75a4756d5d77ec28b842756db94e44e0", "committedDate": "2020-07-22T12:20:43Z", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c227ddc75a4756d5d77ec28b842756db94e44e0", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/0c227ddc75a4756d5d77ec28b842756db94e44e0", "committedDate": "2020-07-22T12:20:43Z", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/464872b5323550e9ba392bb691a6cc31ce7342be", "committedDate": "2020-07-23T13:34:33Z", "message": "Serialization is now in XIIDM 1.4\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NjE2MDUx", "url": "https://github.com/powsybl/powsybl-core/pull/1402#pullrequestreview-457616051", "createdAt": "2020-07-29T15:05:17Z", "commit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNzA2MjQ3", "url": "https://github.com/powsybl/powsybl-core/pull/1402#pullrequestreview-460706247", "createdAt": "2020-08-04T10:55:21Z", "commit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMDo1NToyMVrOG7bVRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMDo1NzoyMlrOG7bZAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2Njk4Mg==", "bodyText": "We could just have one map for that ?  Set<String> aliases is now useless?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r464966982", "createdAt": "2020-08-04T10:55:21Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -24,10 +25,11 @@\n \n     protected boolean fictitious = false;\n \n-    protected Set<String> aliases = new TreeSet<>();\n-\n     protected final Properties properties = new Properties();\n \n+    private final Set<String> aliases = new TreeSet<>();\n+    private final Map<String, String> aliasesTypeByAlias = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2NzkzOA==", "bodyText": "This is a very inefficient implementation. It depends how it is used but we have to be aware of potential performance issue using this method. Is it really needed?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r464967938", "createdAt": "2020-08-04T10:57:22Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -58,17 +60,43 @@ public String getNameOrId() {\n         return Collections.unmodifiableSet(aliases);\n     }\n \n+    @Override\n+    public Set<String> getAliases(String aliasType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3d2452c8204ea788b38272bf6751a7386bc98c7", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/e3d2452c8204ea788b38272bf6751a7386bc98c7", "committedDate": "2020-09-03T12:50:09Z", "message": "Add the possibility to associate a type to an alias (indicating what it corresponds to)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9223f01ebf9800b35be2e6fd30ef17cd42ed66c9", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/9223f01ebf9800b35be2e6fd30ef17cd42ed66c9", "committedDate": "2020-09-03T12:50:09Z", "message": "Throw an exception if trying to retrieve the type of a non existent alias\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "628175257acb321bae360a18b29d0b860da7ad56", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/628175257acb321bae360a18b29d0b860da7ad56", "committedDate": "2020-09-03T12:50:09Z", "message": "Add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be0cddfe1f533a6a7623b970b9deae1e3e7464fa", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/be0cddfe1f533a6a7623b970b9deae1e3e7464fa", "committedDate": "2020-09-03T12:50:10Z", "message": "Update XIIDM serialization\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de4a342ec7635a757c2ab0dea818a78159c6c336", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/de4a342ec7635a757c2ab0dea818a78159c6c336", "committedDate": "2020-09-03T12:50:10Z", "message": "Update tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c642f747cdaac6169d4f076f094fc0658dae3528", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/c642f747cdaac6169d4f076f094fc0658dae3528", "committedDate": "2020-09-03T12:50:10Z", "message": "Correction getAliases by type\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e3c0772181332980c3741a9a92e172debbdfdd8", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/0e3c0772181332980c3741a9a92e172debbdfdd8", "committedDate": "2020-09-03T12:50:10Z", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79ea484f3d9632149475b0ba970f597227b74769", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/79ea484f3d9632149475b0ba970f597227b74769", "committedDate": "2020-09-03T12:50:10Z", "message": "Serialization is now in XIIDM 1.4\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14c9ba0b39c1a4abe3705e5849596cbf5e34e639", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/14c9ba0b39c1a4abe3705e5849596cbf5e34e639", "committedDate": "2020-09-03T12:50:10Z", "message": "Only using a map, not a set (reviewer's comment)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80ec26db9c2842c273bf0ad130a0ec1de26887b9", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/80ec26db9c2842c273bf0ad130a0ec1de26887b9", "committedDate": "2020-09-03T12:50:10Z", "message": "Change IIDM API for aliases\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "committedDate": "2020-09-03T12:50:10Z", "message": "Implement for MergingView\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3cfa796f1895d92ac5c7e65ae7c7b6097cc4371a", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/3cfa796f1895d92ac5c7e65ae7c7b6097cc4371a", "committedDate": "2020-09-01T08:16:31Z", "message": "Implement for MergingView\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "committedDate": "2020-09-03T12:50:10Z", "message": "Implement for MergingView\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxODk4MzU4", "url": "https://github.com/powsybl/powsybl-core/pull/1402#pullrequestreview-481898358", "createdAt": "2020-09-03T14:29:54Z", "commit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDoyOTo1NFrOHMpWGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDo0NjozMVrOHMqKYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMjM2MQ==", "bodyText": "-> alias", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483022361", "createdAt": "2020-09-03T14:29:54Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA5NA==", "bodyText": "Maybe just specify what should be the impl behaviour if an alias with the same type already exists or another alias with same value already exists? Exception?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483024094", "createdAt": "2020-09-03T14:32:01Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.\n      */\n     default void addAlias(String alias) {\n     }\n \n+    /**\n+     * Add an alias to the object. Aliases must be unique in associated Network, and different", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDUzNQ==", "bodyText": "Maybe just specify what should be the impl behaviour if another alias with same value already exists or an IIDM is? Exception?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483024535", "createdAt": "2020-09-03T14:32:36Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNzI0Mg==", "bodyText": "Also you can specify that aliasType with a null value is supported and means no alias", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483027242", "createdAt": "2020-09-03T14:35:10Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.\n      */\n     default void addAlias(String alias) {\n     }\n \n+    /**\n+     * Add an alias to the object. Aliases must be unique in associated Network, and different", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA5NA=="}, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAzNTc0Ng==", "bodyText": "Just a thought but it is very dangerous to have only for shunt kind of duplication of alias management. It is because of model sub element?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483035746", "createdAt": "2020-09-03T14:46:31Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/ShuntXml.java", "diffHunk": "@@ -149,8 +147,9 @@ protected void readElement(String id, ShuntCompensatorAdder adder, NetworkXmlRea\n                     break;\n                 case AliasesXml.ALIAS:\n                     IidmXmlUtil.assertMinimumVersion(ROOT_ELEMENT_NAME, AliasesXml.ALIAS, IidmXmlUtil.ErrorMessage.NOT_SUPPORTED, IidmXmlVersion.V_1_3, context);\n+                    String aliasType = context.getReader().getAttributeValue(null, \"type\");\n                     String alias = context.getAnonymizer().deanonymizeString(context.getReader().getElementText());\n-                    aliases.add(alias);\n+                    aliases.put(alias, aliasType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5fd4eab60603074c6641c89d59525926c23e3b0", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/d5fd4eab60603074c6641c89d59525926c23e3b0", "committedDate": "2020-09-04T14:58:36Z", "message": "Complete the javadoc\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4132, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}