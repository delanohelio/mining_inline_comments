{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMTkwNTI5", "number": 1402, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMDo1NToyMVrOEU8rOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDo0NjozMVrOEgBqGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNDAxMDgxOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMDo1NToyMVrOG7bVRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMDo1NToyMVrOG7bVRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2Njk4Mg==", "bodyText": "We could just have one map for that ?  Set<String> aliases is now useless?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r464966982", "createdAt": "2020-08-04T10:55:21Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -24,10 +25,11 @@\n \n     protected boolean fictitious = false;\n \n-    protected Set<String> aliases = new TreeSet<>();\n-\n     protected final Properties properties = new Properties();\n \n+    private final Set<String> aliases = new TreeSet<>();\n+    private final Map<String, String> aliasesTypeByAlias = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNDAxNjkyOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMDo1NzoyMlrOG7bZAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTowNzoyMFrOHD2EOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2NzkzOA==", "bodyText": "This is a very inefficient implementation. It depends how it is used but we have to be aware of potential performance issue using this method. Is it really needed?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r464967938", "createdAt": "2020-08-04T10:57:22Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -58,17 +60,43 @@ public String getNameOrId() {\n         return Collections.unmodifiableSet(aliases);\n     }\n \n+    @Override\n+    public Set<String> getAliases(String aliasType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc5MzU5Mg==", "bodyText": "I made a draft PR #1447 to show how aliases' types can be used in CGMES update and you're right: we don't really need this method (or at least not in this form). Types are actually unique for one identifiable if they are not null in this use case (in the example, a switch can only have one alias associated with a \"terminal1\" type). I need to rethink how to do this.", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r473793592", "createdAt": "2020-08-20T09:07:20Z", "author": {"login": "miovd"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -58,17 +60,43 @@ public String getNameOrId() {\n         return Collections.unmodifiableSet(aliases);\n     }\n \n+    @Override\n+    public Set<String> getAliases(String aliasType) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2NzkzOA=="}, "originalCommit": {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMDA4NTEzOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDoyOTo1NFrOHMpWGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDoyOTo1NFrOHMpWGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMjM2MQ==", "bodyText": "-> alias", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483022361", "createdAt": "2020-09-03T14:29:54Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMDA5NjUyOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDozMjowMVrOHMpc3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDozNToxMFrOHMppKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA5NA==", "bodyText": "Maybe just specify what should be the impl behaviour if an alias with the same type already exists or another alias with same value already exists? Exception?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483024094", "createdAt": "2020-09-03T14:32:01Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.\n      */\n     default void addAlias(String alias) {\n     }\n \n+    /**\n+     * Add an alias to the object. Aliases must be unique in associated Network, and different", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNzI0Mg==", "bodyText": "Also you can specify that aliasType with a null value is supported and means no alias", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483027242", "createdAt": "2020-09-03T14:35:10Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.\n      */\n     default void addAlias(String alias) {\n     }\n \n+    /**\n+     * Add an alias to the object. Aliases must be unique in associated Network, and different", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA5NA=="}, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMDA5OTI3OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDozMjozNlrOHMpelw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDozMjozNlrOHMpelw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDUzNQ==", "bodyText": "Maybe just specify what should be the impl behaviour if another alias with same value already exists or an IIDM is? Exception?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483024535", "createdAt": "2020-09-03T14:32:36Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMDE3MDUxOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/ShuntXml.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDo0NjozMVrOHMqKYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMTo1NToyMlrOHNKujw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAzNTc0Ng==", "bodyText": "Just a thought but it is very dangerous to have only for shunt kind of duplication of alias management. It is because of model sub element?", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483035746", "createdAt": "2020-09-03T14:46:31Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/ShuntXml.java", "diffHunk": "@@ -149,8 +147,9 @@ protected void readElement(String id, ShuntCompensatorAdder adder, NetworkXmlRea\n                     break;\n                 case AliasesXml.ALIAS:\n                     IidmXmlUtil.assertMinimumVersion(ROOT_ELEMENT_NAME, AliasesXml.ALIAS, IidmXmlUtil.ErrorMessage.NOT_SUPPORTED, IidmXmlVersion.V_1_3, context);\n+                    String aliasType = context.getReader().getAttributeValue(null, \"type\");\n                     String alias = context.getAnonymizer().deanonymizeString(context.getReader().getElementText());\n-                    aliases.add(alias);\n+                    aliases.put(alias, aliasType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU2OTI5NQ==", "bodyText": "Yes because shunts are the only equipment who needs its sub element to be created (other equipment can be created without their sub elements).", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483569295", "createdAt": "2020-09-04T11:55:22Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/ShuntXml.java", "diffHunk": "@@ -149,8 +147,9 @@ protected void readElement(String id, ShuntCompensatorAdder adder, NetworkXmlRea\n                     break;\n                 case AliasesXml.ALIAS:\n                     IidmXmlUtil.assertMinimumVersion(ROOT_ELEMENT_NAME, AliasesXml.ALIAS, IidmXmlUtil.ErrorMessage.NOT_SUPPORTED, IidmXmlVersion.V_1_3, context);\n+                    String aliasType = context.getReader().getAttributeValue(null, \"type\");\n                     String alias = context.getAnonymizer().deanonymizeString(context.getReader().getElementText());\n-                    aliases.add(alias);\n+                    aliases.put(alias, aliasType);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAzNTc0Ng=="}, "originalCommit": {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4995, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}