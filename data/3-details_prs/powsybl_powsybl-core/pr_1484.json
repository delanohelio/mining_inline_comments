{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMzMwNzkz", "number": 1484, "title": "Regulating control adjustments to export SSH", "bodyText": "Signed-off-by: Jos\u00e9 Antonio Marqu\u00e9s marquesja@aia.es\nPlease check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nFeature\nWhat is the current behavior? (You can also link to an open issue here)\nThe regulating control is discarded if targetV is <= 0\nWhat is the new behavior (if this is a feature change)?\nThe regulating control is kept as disabled and a warning is emitted if targetV is <= 0\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\n(if any of the questions/checkboxes don't apply, please delete them entirely)\nSome tests have been adjusted to the new behaviour.\nSome unnecessary methods have been deleted. They were necessary to support the old transformer conversion.", "createdAt": "2020-09-24T10:00:31Z", "url": "https://github.com/powsybl/powsybl-core/pull/1484", "merged": true, "mergeCommit": {"oid": "6c1592303a52c7c3ee0f349800a91c744337cf5b"}, "closed": true, "closedAt": "2020-09-25T08:34:56Z", "author": {"login": "marqueslanauja"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdL93YRAH2gAyNDkyMzMwNzkzOjZmNWE0ZDg5MmIzM2Y2ZGNiMjlmNWJjNTgzYjJmNzBmMjA2NWVmYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMRZ7bAFqTQ5NjIwOTMyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4", "author": {"user": {"login": "marqueslanauja", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4", "committedDate": "2020-09-24T09:35:06Z", "message": "Regulating control adjustments\n\nSigned-off-by: Jos\u00e9 Antonio Marqu\u00e9s <marquesja@aia.es>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NzA2MjM3", "url": "https://github.com/powsybl/powsybl-core/pull/1484#pullrequestreview-495706237", "createdAt": "2020-09-24T15:40:38Z", "commit": {"oid": "6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NzQwMDY0", "url": "https://github.com/powsybl/powsybl-core/pull/1484#pullrequestreview-495740064", "createdAt": "2020-09-24T16:18:11Z", "commit": {"oid": "6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNjoxODoxMVrOHXinQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNjoyMDo0NVrOHXit_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ0NjQwMw==", "bodyText": "Was this method never used?", "url": "https://github.com/powsybl/powsybl-core/pull/1484#discussion_r494446403", "createdAt": "2020-09-24T16:18:11Z", "author": {"login": "MioRtia"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/RegulatingControlMappingForTransformers.java", "diffHunk": "@@ -36,49 +34,13 @@\n         t3xMapping = new HashMap<>();\n     }\n \n-    public void add(String transformerId, String rtcId, PropertyBag rtc, PropertyBag ptc) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ0NjkyNA==", "bodyText": "Same question", "url": "https://github.com/powsybl/powsybl-core/pull/1484#discussion_r494446924", "createdAt": "2020-09-24T16:18:56Z", "author": {"login": "MioRtia"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/RegulatingControlMappingForTransformers.java", "diffHunk": "@@ -36,49 +34,13 @@\n         t3xMapping = new HashMap<>();\n     }\n \n-    public void add(String transformerId, String rtcId, PropertyBag rtc, PropertyBag ptc) {\n-        if (t2xMapping.containsKey(transformerId)) {\n-            throw new CgmesModelException(\"Transformer already added, Transformer id: \" + transformerId);\n-        }\n-\n-        CgmesRegulatingControlRatio rcRtc = null;\n-        if (rtc != null) {\n-            rcRtc = buildRegulatingControlRatio(rtcId, rtc);\n-        }\n-\n-        CgmesRegulatingControlPhase rcPtc = null;\n-        if (ptc != null) {\n-            rcPtc = buildRegulatingControlPhase(ptc);\n-        }\n-\n-        add(transformerId, rcRtc, rcPtc);\n-    }\n-\n     public void add(String transformerId, CgmesRegulatingControlRatio rcRtc, CgmesRegulatingControlPhase rcPtc) {\n         CgmesRegulatingControlForTwoWindingsTransformer rc = new CgmesRegulatingControlForTwoWindingsTransformer();\n         rc.ratioTapChanger = rcRtc;\n         rc.phaseTapChanger = rcPtc;\n         t2xMapping.put(transformerId, rc);\n     }\n \n-    public void add(String transformerId, String rtcId2, PropertyBag rtc2, String rtcId3, PropertyBag rtc3) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ0ODEyNQ==", "bodyText": "In this case, maybe set targetValue to 0? I'm not sure if ValidationUtil will not throw an exception otherwise (and specify in the log)", "url": "https://github.com/powsybl/powsybl-core/pull/1484#discussion_r494448125", "createdAt": "2020-09-24T16:20:45Z", "author": {"login": "MioRtia"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/RegulatingControlMappingForTransformers.java", "diffHunk": "@@ -249,18 +195,19 @@ private boolean setRtcRegulatingControlVoltage(String rtcId, boolean regulating,\n             return false;\n         }\n \n-        // Even if regulating is false, we reset the target voltage if it is not valid\n-        if (control.targetValue <= 0) {\n-            context.ignored(rtcId,\n+        // We always keep the targetValue\n+        // It targetValue is not valid, emit a warning and deactivate regulating control\n+        boolean validTargetValue = control.targetValue > 0;\n+        if (!validTargetValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f5a4d892b33f6dcb29f5bc583b2f70f2065efa4"}, "originalPosition": 109}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f420f0524d80ea23a8db20895066fe0f8c8d3aae", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/f420f0524d80ea23a8db20895066fe0f8c8d3aae", "committedDate": "2020-09-25T06:11:59Z", "message": "Merge branch 'master' into regulatingControl_adjustments_to_export_SSH"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MjA5MzI1", "url": "https://github.com/powsybl/powsybl-core/pull/1484#pullrequestreview-496209325", "createdAt": "2020-09-25T08:21:02Z", "commit": {"oid": "f420f0524d80ea23a8db20895066fe0f8c8d3aae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4191, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}