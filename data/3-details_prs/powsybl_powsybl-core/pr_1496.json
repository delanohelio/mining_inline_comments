{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2ODA1OTcy", "number": 1496, "title": "[IIDM] Allow to reuse DanglingLineAdder twice", "bodyText": "Signed-off-by: Thomas ADAM tadam@silicom.fr\nPlease check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\n'#1489'\nOther information:\nOnly Dangling part of issue is done on this PR", "createdAt": "2020-10-02T09:56:11Z", "url": "https://github.com/powsybl/powsybl-core/pull/1496", "merged": true, "mergeCommit": {"oid": "c59498306d7ea35d5556e31bc5824e33d37a0c03"}, "closed": true, "closedAt": "2020-10-15T08:55:04Z", "author": {"login": "tadam50"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOisvcgH2gAyNDk2ODA1OTcyOmVlZDQyY2U1MWM4ZDE0MmIwZWMxMmIzMTQ2YmY1MDliNjYxOWI5ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdStQrYgH2gAyNDk2ODA1OTcyOmQzYTIxMTk1NGVhMDFiZDg0NDUyY2JhNmE1ODFlOTJlMjg4N2UxNjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eed42ce51c8d142b0ec12b3146bf509b6619b982", "author": {"user": {"login": "tadam50", "name": "Thomas ADAM"}}, "url": "https://github.com/powsybl/powsybl-core/commit/eed42ce51c8d142b0ec12b3146bf509b6619b982", "committedDate": "2020-10-02T09:37:49Z", "message": "Build new Generation if needed on each DanglingLineAdder.add\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a227bf9e4383b76a8d70da6bb9972d955cc313b", "author": {"user": {"login": "tadam50", "name": "Thomas ADAM"}}, "url": "https://github.com/powsybl/powsybl-core/commit/7a227bf9e4383b76a8d70da6bb9972d955cc313b", "committedDate": "2020-10-02T15:15:42Z", "message": "Rebuild\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNzY5NTYx", "url": "https://github.com/powsybl/powsybl-core/pull/1496#pullrequestreview-501769561", "createdAt": "2020-10-05T07:08:01Z", "commit": {"oid": "7a227bf9e4383b76a8d70da6bb9972d955cc313b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNzowODowMVrOHcP46A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNzowOToyN1rOHcP7UA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM4MjUwNA==", "bodyText": "assertNotSame? Both could be equal (you're lucky because of the default implementation, but I could consider two generations equals if the have the same characteristics, but not attached to the same danglingLine).", "url": "https://github.com/powsybl/powsybl-core/pull/1496#discussion_r499382504", "createdAt": "2020-10-05T07:08:01Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-tck/src/test/java/com/powsybl/iidm/network/tck/AbstractDanglingLineTest.java", "diffHunk": "@@ -274,6 +274,10 @@ public void withRegulatingCapabilityTests() {\n                 .add();\n         assertNotNull(generation.getReactiveLimits());\n         assertTrue(generation.getReactiveLimits() instanceof MinMaxReactiveLimits);\n+\n+        // Test if new Generation is instantiate at each add\n+        DanglingLine dl2 = adder.setId(id + \"_2\").add();\n+        assertNotEquals(dl.getGeneration(), dl2.getGeneration());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a227bf9e4383b76a8d70da6bb9972d955cc313b"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM4MzEyMA==", "bodyText": "This is arguable: I think we should keep the tests here: It's not possible to update the GenerationAdder after you have called the add(). So you should be noticed that it's not complete when we consider it should be fully completed.\n@MioRtia @tadam50 What do you think?", "url": "https://github.com/powsybl/powsybl-core/pull/1496#discussion_r499383120", "createdAt": "2020-10-05T07:09:27Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/DanglingLineAdderImpl.java", "diffHunk": "@@ -64,10 +64,6 @@ public GenerationAdder setTargetV(double targetV) {\n \n         @Override\n         public DanglingLineAdder add() {\n-            ValidationUtil.checkActivePowerLimits(DanglingLineAdderImpl.this, minP, maxP);\n-            ValidationUtil.checkActivePowerSetpoint(DanglingLineAdderImpl.this, targetP);\n-            ValidationUtil.checkVoltageControl(DanglingLineAdderImpl.this, voltageRegulationOn, targetV, targetQ);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a227bf9e4383b76a8d70da6bb9972d955cc313b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32fdc3479e89b26e7c5fa36d96a885bae3c2cbd0", "author": {"user": {"login": "tadam50", "name": "Thomas ADAM"}}, "url": "https://github.com/powsybl/powsybl-core/commit/32fdc3479e89b26e7c5fa36d96a885bae3c2cbd0", "committedDate": "2020-10-05T07:43:10Z", "message": "Taking PR remarks into account\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NzE0NzU1", "url": "https://github.com/powsybl/powsybl-core/pull/1496#pullrequestreview-505714755", "createdAt": "2020-10-09T14:17:04Z", "commit": {"oid": "32fdc3479e89b26e7c5fa36d96a885bae3c2cbd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxNDoxNzowNFrOHfLqUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxNDoxNzowNFrOHfLqUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ1ODk2Mw==", "bodyText": "not sure this is correct: I would write\nreturn new GenerationAdderImpl(this);\n\nAnd in the GenerationAdder::add method, I would set the generationAdder of the parent. I don't know if it changes something, but it's seems better to me that the DanglingLineAdder is modified only once the GenerationAdder has been filled.", "url": "https://github.com/powsybl/powsybl-core/pull/1496#discussion_r502458963", "createdAt": "2020-10-09T14:17:04Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/DanglingLineAdderImpl.java", "diffHunk": "@@ -148,7 +147,8 @@ public DanglingLineAdder setUcteXnodeCode(String ucteXnodeCode) {\n \n     @Override\n     public GenerationAdder newGeneration() {\n-        return new GenerationAdderImpl();\n+        generationAdder = new GenerationAdderImpl();\n+        return generationAdder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32fdc3479e89b26e7c5fa36d96a885bae3c2cbd0"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1badc5ce3474106b6b4aacf8ce0e02e8cb4436e2", "author": {"user": {"login": "tadam50", "name": "Thomas ADAM"}}, "url": "https://github.com/powsybl/powsybl-core/commit/1badc5ce3474106b6b4aacf8ce0e02e8cb4436e2", "committedDate": "2020-10-13T08:21:31Z", "message": "Move internal adder set into add method\n\nSigned-off-by: Thomas ADAM <tadam@silicom.fr>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MTI0MjQ0", "url": "https://github.com/powsybl/powsybl-core/pull/1496#pullrequestreview-509124244", "createdAt": "2020-10-15T08:11:44Z", "commit": {"oid": "1badc5ce3474106b6b4aacf8ce0e02e8cb4436e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3a211954ea01bd84452cba6a581e92e2887e160", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/d3a211954ea01bd84452cba6a581e92e2887e160", "committedDate": "2020-10-15T08:11:49Z", "message": "Merge branch 'master' into issue_1489_danglinglines"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4041, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}