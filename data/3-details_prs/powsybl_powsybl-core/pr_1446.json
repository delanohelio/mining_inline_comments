{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwMDIwMzg5", "number": 1446, "title": "Empty extension should not be serialized", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nNo\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nIf extension is empty then it is not serialized.\nWhat is the current behavior? (You can also link to an open issue here)\nAn extension could be empty for multivariant extensions and thus serialized with an empty body.\nWhat is the new behavior (if this is a feature change)?\nAn empty extension is not serialized\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\n(if any of the questions/checkboxes don't apply, please delete them entirely)", "createdAt": "2020-08-19T08:55:41Z", "url": "https://github.com/powsybl/powsybl-core/pull/1446", "merged": true, "mergeCommit": {"oid": "23b9d45deb57009eda67d1a70dc420a3a183ad82"}, "closed": true, "closedAt": "2020-10-01T13:55:32Z", "author": {"login": "flo-dup"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAwDyegFqTQ3MTYwMDQ4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdORJc0gH2gAyNDcwMDIwMzg5OjFlZjI4ZmE3OTcxMjZlM2FmNTk4M2FlMTY3ZjA0OTQ0MjIzMGI1OWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNjAwNDg4", "url": "https://github.com/powsybl/powsybl-core/pull/1446#pullrequestreview-471600488", "createdAt": "2020-08-20T13:16:49Z", "commit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNzc0ODM2", "url": "https://github.com/powsybl/powsybl-core/pull/1446#pullrequestreview-492774836", "createdAt": "2020-09-21T16:13:46Z", "commit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjoxMzo0NlrOHVYfJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjoxODoxN1rOHVYqYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4MzMzNQ==", "bodyText": "This method sounds very strange. I'm not convinced this method is well placed. For serialization purpose, why the serializer is not responsible to determine if an extension should be serialized or not?", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r492183335", "createdAt": "2020-09-21T16:13:46Z", "author": {"login": "mathbagu"}, "path": "commons/src/main/java/com/powsybl/commons/extensions/Extension.java", "diffHunk": "@@ -33,4 +33,12 @@\n      */\n     void setExtendable(T extendable);\n \n+    /**\n+     * Return whether the extension is empty (and thus should not be serialized)\n+     *\n+     * @return true if the extension is empty, false otherwise\n+     */\n+    default boolean isEmpty() {\n+        return false;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4NTA2Mg==", "bodyText": "I think this method should be define on the SlackTerminal API, not for the all extensions (that could concern everything in powsybl, not necessarily IIDM extensions)", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r492185062", "createdAt": "2020-09-21T16:16:29Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/extensions/SlackTerminalImpl.java", "diffHunk": "@@ -46,7 +46,7 @@ public SlackTerminal setTerminal(Terminal terminal) {\n     }\n \n     @Override\n-    public boolean isCleanable() {\n+    public boolean isEmpty() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4NTQzMw==", "bodyText": "I would use the serializer to check if an extension should be serialized or not.", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r492185433", "createdAt": "2020-09-21T16:17:06Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -79,9 +79,7 @@ private NetworkXml() {\n     private static Set<String> getNetworkExtensions(Network n) {\n         Set<String> extensions = new TreeSet<>();\n         for (Identifiable<?> identifiable : n.getIdentifiables()) {\n-            for (Extension<? extends Identifiable<?>> extension : identifiable.getExtensions()) {\n-                extensions.add(extension.getName());\n-            }\n+            identifiable.getExtensions().stream().filter(e -> !e.isEmpty()).forEach(e -> extensions.add(e.getName()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4NTk4MQ==", "bodyText": "I think we really need to cache the extension list for an identifiable, to not iterate several times over the same list.", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r492185981", "createdAt": "2020-09-21T16:17:53Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -217,15 +215,14 @@ private static void writeExtensions(Network n, NetworkXmlWriterContext context,\n \n             Collection<? extends Extension<? extends Identifiable<?>>> extensions = identifiable.getExtensions().stream()\n                     .filter(e -> options.withExtension(e.getName()))\n+                    .filter(e -> !e.isEmpty())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE4NjIwOQ==", "bodyText": "This is a regression?", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r492186209", "createdAt": "2020-09-21T16:18:17Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -217,15 +215,14 @@ private static void writeExtensions(Network n, NetworkXmlWriterContext context,\n \n             Collection<? extends Extension<? extends Identifiable<?>>> extensions = identifiable.getExtensions().stream()\n                     .filter(e -> options.withExtension(e.getName()))\n+                    .filter(e -> !e.isEmpty())\n                     .filter(e -> getExtensionXmlSerializer(options, e.getName()) != null)\n                     .collect(Collectors.toList());\n             if (!extensions.isEmpty()) {\n                 context.getExtensionsWriter().writeStartElement(context.getVersion().getNamespaceURI(), EXTENSION_ELEMENT_NAME);\n                 context.getExtensionsWriter().writeAttribute(ID, context.getAnonymizer().anonymizeString(identifiable.getId()));\n                 for (Extension<? extends Identifiable<?>> extension : extensions) {\n-                    if (options.withExtension(extension.getName())) {\n-                        writeExtension(extension, context);\n-                    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58799132ca069718b4b52ad9c0f71b636ad1911b"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3bdc05e497b62237140a8ef8997118b45918f8d9", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/3bdc05e497b62237140a8ef8997118b45918f8d9", "committedDate": "2020-09-28T11:50:43Z", "message": "Refactoring of writing the network xml\n\n- separates context creation / writing document start / streamWriter init.\n- including the extensions serializers in the context\n- correcting code smell\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}, "afterCommit": {"oid": "4ea8fa01137e34e543284dcb1a7a936142bac766", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/4ea8fa01137e34e543284dcb1a7a936142bac766", "committedDate": "2020-09-28T12:33:50Z", "message": "Update xml test file\n\nDue to rebase\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3aacdeb0221e846c1625efc03a1ed4752ce47b57", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/3aacdeb0221e846c1625efc03a1ed4752ce47b57", "committedDate": "2020-09-28T12:59:21Z", "message": "Adding the isEmpty method for extensions\n\nIf extension isEmpty then it is not serialized.\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dea2b5d54966aafa1b99cc8cfe6ee8cdbeb80c38", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/dea2b5d54966aafa1b99cc8cfe6ee8cdbeb80c38", "committedDate": "2020-09-28T12:59:21Z", "message": "Activating SlackTerminal serialization\n\nUnit tests activated and corrected.\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b19f69e0fb88d83ed86ce62c7aa0831d5ed80de", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/3b19f69e0fb88d83ed86ce62c7aa0831d5ed80de", "committedDate": "2020-09-28T12:59:21Z", "message": "Updating ieee xiidm reference test files\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef11d91671da492a68fd41ee87a2ec37d1dae43a", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/ef11d91671da492a68fd41ee87a2ec37d1dae43a", "committedDate": "2020-09-28T12:59:21Z", "message": "Extension interface: isEmpty method removed\n\nReplaced by isEmptySerialization in ExtensionXmlSerializer\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c01106060c6b8be0b944d693cfdee7eb10e93d4", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/5c01106060c6b8be0b944d693cfdee7eb10e93d4", "committedDate": "2020-09-28T12:59:21Z", "message": "Refactoring for caching the extension list\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f00cfaa1da9110184a7ac758e34157bf51a640c5", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/f00cfaa1da9110184a7ac758e34157bf51a640c5", "committedDate": "2020-09-28T12:59:22Z", "message": "Computing only once the list of extensions for an identifiable\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c710783aff7ac2bdf6557c604157d9d1573ff847", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/c710783aff7ac2bdf6557c604157d9d1573ff847", "committedDate": "2020-09-28T13:10:11Z", "message": "Refactoring of writing the network xml\n\n- separates context creation / writing document start / streamWriter init.\n- including the extensions serializers in the context\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c142ee6208b327b425a7138d3980ec7b595b43d4", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/c142ee6208b327b425a7138d3980ec7b595b43d4", "committedDate": "2020-09-28T13:10:11Z", "message": "Update xml test file\n\nDue to rebase\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ea8fa01137e34e543284dcb1a7a936142bac766", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/4ea8fa01137e34e543284dcb1a7a936142bac766", "committedDate": "2020-09-28T12:33:50Z", "message": "Update xml test file\n\nDue to rebase\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}, "afterCommit": {"oid": "c142ee6208b327b425a7138d3980ec7b595b43d4", "author": {"user": {"login": "flo-dup", "name": "Florian Dupuy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/c142ee6208b327b425a7138d3980ec7b595b43d4", "committedDate": "2020-09-28T13:10:11Z", "message": "Update xml test file\n\nDue to rebase\n\nSigned-off-by: Florian Dupuy <florian.dupuy@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NTc0NTY2", "url": "https://github.com/powsybl/powsybl-core/pull/1446#pullrequestreview-498574566", "createdAt": "2020-09-29T15:02:41Z", "commit": {"oid": "c142ee6208b327b425a7138d3980ec7b595b43d4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/bca616d1c3d612de2590d56e1fae619c91e75e87", "committedDate": "2020-09-30T15:32:35Z", "message": "Fix implementation\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NTcxMzI2", "url": "https://github.com/powsybl/powsybl-core/pull/1446#pullrequestreview-499571326", "createdAt": "2020-09-30T15:45:10Z", "commit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMDY3MjIy", "url": "https://github.com/powsybl/powsybl-core/pull/1446#pullrequestreview-500067222", "createdAt": "2020-10-01T07:17:37Z", "commit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQwNzoxNzozN1rOHa9cXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQwNzoyOToxNVrOHa90FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODAzMTcxMQ==", "bodyText": "I think we should also check here options.withExtension(e.getName()), otherwise we might end up declaring the namespace of an extension which is not exported", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r498031711", "createdAt": "2020-10-01T07:17:37Z", "author": {"login": "flo-dup"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -183,16 +166,27 @@ private static void writeExtension(Extension<? extends Identifiable<?>> extensio\n         }\n     }\n \n-    private static ExtensionXmlSerializer getExtensionXmlSerializer(ExportOptions options, String extensionName) {\n+    private static ExtensionXmlSerializer getExtensionXmlSerializer(ExportOptions options, Extension<? extends Identifiable<?>> extension) {\n         ExtensionXmlSerializer extensionXmlSerializer = options.isThrowExceptionIfExtensionNotFound()\n-                ? EXTENSIONS_SUPPLIER.get().findProviderOrThrowException(extensionName)\n-                : EXTENSIONS_SUPPLIER.get().findProvider(extensionName);\n+                ? EXTENSIONS_SUPPLIER.get().findProviderOrThrowException(extension.getName())\n+                : EXTENSIONS_SUPPLIER.get().findProvider(extension.getName());\n         if (extensionXmlSerializer == null) {\n-            LOGGER.warn(\"No Extension XML Serializer for {}\", extensionName);\n+            if (options.isThrowExceptionIfExtensionNotFound()) {\n+                throw new PowsyblException(\"XmlSerializer for\" + extension.getName() + \"not found\");\n+            } else {\n+                LOGGER.warn(\"No Extension XML Serializer for {}\", extension.getName());\n+            }\n+        } else if (!extensionXmlSerializer.isSerializable(extension)) {\n+            return null;\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODAzMzUzMg==", "bodyText": "No need to test it as it is already filtered out above", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r498033532", "createdAt": "2020-10-01T07:21:20Z", "author": {"login": "flo-dup"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -209,19 +203,24 @@ private static String getNamespaceUri(ExtensionXmlSerializer extensionXmlSeriali\n                 .orElseGet(extensionXmlSerializer::getNamespaceUri);\n     }\n \n-    private static void writeExtensions(Network n, NetworkXmlWriterContext context) throws XMLStreamException {\n+    private static void writeExtensions(Network n, NetworkXmlWriterContext context, ExportOptions options) throws XMLStreamException {\n \n-        for (Identifiable<?> identifiable : IidmXmlUtil.sorted(n.getIdentifiables(), context.getOptions())) {\n+        for (Identifiable<?> identifiable : IidmXmlUtil.sorted(n.getIdentifiables(), options)) {\n             if (!context.isExportedEquipment(identifiable)) {\n                 continue;\n             }\n \n-            Map<Extension<? extends Identifiable<?>>, ExtensionXmlSerializer> identifExtnSerializers = context.getExtensionXmlSerializers().get(identifiable);\n-            if (!identifExtnSerializers.isEmpty()) {\n+            Collection<? extends Extension<? extends Identifiable<?>>> extensions = identifiable.getExtensions().stream()\n+                    .filter(e -> options.withExtension(e.getName()))\n+                    .filter(e -> getExtensionXmlSerializer(options, e) != null)\n+                    .collect(Collectors.toList());\n+            if (!extensions.isEmpty()) {\n                 context.getExtensionsWriter().writeStartElement(context.getVersion().getNamespaceURI(), EXTENSION_ELEMENT_NAME);\n                 context.getExtensionsWriter().writeAttribute(ID, context.getAnonymizer().anonymizeString(identifiable.getId()));\n-                for (Extension<? extends Identifiable<?>> extension : IidmXmlUtil.sortedExtensions(identifExtnSerializers.keySet(), context.getOptions())) {\n-                    writeExtension(extension, identifExtnSerializers.get(extension), context);\n+                for (Extension<? extends Identifiable<?>> extension : IidmXmlUtil.sortedExtensions(extensions, options)) {\n+                    if (options.withExtension(extension.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "originalPosition": 150}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODAzNzc4MQ==", "bodyText": "This filter can be removed if we check it in getExtensionXmlSerializer", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r498037781", "createdAt": "2020-10-01T07:29:15Z", "author": {"login": "flo-dup"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/NetworkXml.java", "diffHunk": "@@ -209,19 +203,24 @@ private static String getNamespaceUri(ExtensionXmlSerializer extensionXmlSeriali\n                 .orElseGet(extensionXmlSerializer::getNamespaceUri);\n     }\n \n-    private static void writeExtensions(Network n, NetworkXmlWriterContext context) throws XMLStreamException {\n+    private static void writeExtensions(Network n, NetworkXmlWriterContext context, ExportOptions options) throws XMLStreamException {\n \n-        for (Identifiable<?> identifiable : IidmXmlUtil.sorted(n.getIdentifiables(), context.getOptions())) {\n+        for (Identifiable<?> identifiable : IidmXmlUtil.sorted(n.getIdentifiables(), options)) {\n             if (!context.isExportedEquipment(identifiable)) {\n                 continue;\n             }\n \n-            Map<Extension<? extends Identifiable<?>>, ExtensionXmlSerializer> identifExtnSerializers = context.getExtensionXmlSerializers().get(identifiable);\n-            if (!identifExtnSerializers.isEmpty()) {\n+            Collection<? extends Extension<? extends Identifiable<?>>> extensions = identifiable.getExtensions().stream()\n+                    .filter(e -> options.withExtension(e.getName()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "originalPosition": 141}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMTY3NDA5", "url": "https://github.com/powsybl/powsybl-core/pull/1446#pullrequestreview-500167409", "createdAt": "2020-10-01T09:29:30Z", "commit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQwOToyOTozMFrOHbCGkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQwOToyOTozMFrOHbCGkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODEwODA0OA==", "bodyText": "Isn't mockito-core enough? If yes, use the ${mockito.version}", "url": "https://github.com/powsybl/powsybl-core/pull/1446#discussion_r498108048", "createdAt": "2020-10-01T09:29:30Z", "author": {"login": "MioRtia"}, "path": "commons/pom.xml", "diffHunk": "@@ -140,6 +140,12 @@\n             <artifactId>xmlunit-core</artifactId>\n             <scope>test</scope>\n         </dependency>\n+        <dependency>\n+            <groupId>org.mockito</groupId>\n+            <artifactId>mockito-all</artifactId>\n+            <version>1.10.19</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bca616d1c3d612de2590d56e1fae619c91e75e87"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2132c56539f57d2cb8bdb1c2f14f15f9d7b77703", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/2132c56539f57d2cb8bdb1c2f14f15f9d7b77703", "committedDate": "2020-10-01T10:27:49Z", "message": "Review fixes\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4686fe079585bea1c349cb7709a6c9639214d129", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/4686fe079585bea1c349cb7709a6c9639214d129", "committedDate": "2020-10-01T10:54:44Z", "message": "Small fix\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ef28fa797126e3af5983ae167f049442230b59c", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/1ef28fa797126e3af5983ae167f049442230b59c", "committedDate": "2020-10-01T13:10:53Z", "message": "Merge branch 'master' into empty_extension"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4141, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}