{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1MTk5ODMx", "number": 1562, "title": "Improve ShuntCompensatorAdder implementation", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nN/A\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nRefactoring\nWhat is the current behavior? (You can also link to an open issue here)\nThe design of the ShuntCompensatorAdderImpl is a bit weird and difficult to implement in C++.\nWhat is the new behavior (if this is a feature change)?\nWe change a little bit the implementation to set the model after the ShuntCompensator creation. We also ensure that the model is set only once.\nI also fix the setGeneration method to add a similar check.\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\n(if any of the questions/checkboxes don't apply, please delete them entirely)", "createdAt": "2020-12-09T13:58:54Z", "url": "https://github.com/powsybl/powsybl-core/pull/1562", "merged": true, "mergeCommit": {"oid": "deccef1546c47969f8b3b91009bda14d1cd34489"}, "closed": true, "closedAt": "2020-12-14T07:26:28Z", "author": {"login": "mathbagu"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkfJhbAH2gAyNTM1MTk5ODMxOmU1ZjhiNzFmYWJkOTQxZTYwN2JhNzk3MTA5ZDhmODExNmZlMzNhMWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlLZtMAH2gAyNTM1MTk5ODMxOjUwMWRmYTU5ZGRhYTEyYjZjZDlkYjNmMzQzMmMzZmVkZjBjZDMyOWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e5f8b71fabd941e607ba797109d8f8116fe33a1e", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/e5f8b71fabd941e607ba797109d8f8116fe33a1e", "committedDate": "2020-12-09T13:55:58Z", "message": "Improve ShuntCompensatorAdder implementation\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MDkxMTc1", "url": "https://github.com/powsybl/powsybl-core/pull/1562#pullrequestreview-549091175", "createdAt": "2020-12-10T11:12:43Z", "commit": {"oid": "e5f8b71fabd941e607ba797109d8f8116fe33a1e"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxMToxMjo0M1rOIDECgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDowMjowMlrOIDKtRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDA4MjgxOQ==", "bodyText": "We can use Supplier<String> attribute as following :\nshuntCompensator.notifyUpdate(() -> getAttributeName(index, \"b\"), oldValue, this.b);", "url": "https://github.com/powsybl/powsybl-core/pull/1562#discussion_r540082819", "createdAt": "2020-12-10T11:12:43Z", "author": {"login": "tadam50"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorNonLinearModelImpl.java", "diffHunk": "@@ -43,7 +47,7 @@ public Section setB(double b) {\n             ValidationUtil.checkB(shuntCompensator, b);\n             double oldValue = this.b;\n             this.b = b;\n-            shuntCompensator.notifyUpdate(notifyUpdateSection(index, \"b\"), oldValue, this.b);\n+            shuntCompensator.notifyUpdate(getAttributeName(index, \"b\"), oldValue, this.b);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5f8b71fabd941e607ba797109d8f8116fe33a1e"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDA4MzA4OQ==", "bodyText": "We can use Supplier<String> attribute as following :\nshuntCompensator.notifyUpdate(() -> getAttributeName(index, \"g\"), oldValue, this.g);", "url": "https://github.com/powsybl/powsybl-core/pull/1562#discussion_r540083089", "createdAt": "2020-12-10T11:13:12Z", "author": {"login": "tadam50"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorNonLinearModelImpl.java", "diffHunk": "@@ -57,34 +61,22 @@ public Section setG(double g) {\n             ValidationUtil.checkG(shuntCompensator, g);\n             double oldValue = this.g;\n             this.g = g;\n-            shuntCompensator.notifyUpdate(notifyUpdateSection(index, \"g\"), oldValue, this.g);\n+            shuntCompensator.notifyUpdate(getAttributeName(index, \"g\"), oldValue, this.g);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5f8b71fabd941e607ba797109d8f8116fe33a1e"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDE5MjA2OA==", "bodyText": "Make it fluent, can be usefull ?", "url": "https://github.com/powsybl/powsybl-core/pull/1562#discussion_r540192068", "createdAt": "2020-12-10T14:02:02Z", "author": {"login": "tadam50"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/ShuntCompensatorImpl.java", "diffHunk": "@@ -59,9 +60,11 @@\n         }\n     }\n \n-    private AbstractShuntCompensatorModel attach(AbstractShuntCompensatorModel model) {\n-        model.setShuntCompensator(this);\n-        return model;\n+    void setModel(ShuntCompensatorModelExt model) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5f8b71fabd941e607ba797109d8f8116fe33a1e"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbd3ed6c5229a138414e8c9fbe3b32813ef4a642", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/cbd3ed6c5229a138414e8c9fbe3b32813ef4a642", "committedDate": "2020-12-11T08:09:59Z", "message": "Review fix\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5c58b12ab989894b11938dc6c282b6cba28b70f", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/c5c58b12ab989894b11938dc6c282b6cba28b70f", "committedDate": "2020-12-11T11:04:22Z", "message": "Fix shunt implementation\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMDk3Njcw", "url": "https://github.com/powsybl/powsybl-core/pull/1562#pullrequestreview-550097670", "createdAt": "2020-12-11T13:30:26Z", "commit": {"oid": "c5c58b12ab989894b11938dc6c282b6cba28b70f"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "501dfa59ddaa12b6cd9db3f3432c3fedf0cd329e", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/501dfa59ddaa12b6cd9db3f3432c3fedf0cd329e", "committedDate": "2020-12-11T17:29:28Z", "message": "Merge branch 'master' into fix-shunt-adder"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4086, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}