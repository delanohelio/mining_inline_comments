{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NTgzNzU0", "number": 1262, "title": "Validations around HVDC lines in IIDM", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nThe documentation in the website will follow in the Following days.\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nNo issue.\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nIt adds some validations around HVDC lines in the internal model.\nWhat is the current behavior? (You can also link to an open issue here)\nNo check about the sign of active power setpoint, no hupper limits for powerFactor and lossFactor. These two factors are ratios (whitout units) but could be set in percents without new checks.\nWhat is the new behavior (if this is a feature change)?\nThe active power setpoint cannot be negative. Ratios could not be more than 3. This number is arbitrary.\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\nI think that the AMPL conversion has to be fixed. I have made a fix for the CGMES conversion for active power setpoint. The factors management have to be reviewed.", "createdAt": "2020-04-06T11:40:00Z", "url": "https://github.com/powsybl/powsybl-core/pull/1262", "merged": true, "mergeCommit": {"oid": "91f36632f20f2c68577c3d44c09ddb29b3909885"}, "closed": true, "closedAt": "2020-04-07T09:21:58Z", "author": {"login": "annetill"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcU9EAQgH2gAyMzk5NTgzNzU0OmE2ZTc4OTczMjQ2NmY2ODVkZDc2NDEwMWY5YzFhZDFhMmRhYWExMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVPcq5gH2gAyMzk5NTgzNzU0OjJkMjEwZDQzMDRmYTAyZWNmOTgzOTQzZmRiZjE2YTQzMWIwNWU3MDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a6e789732466f685dd764101f9c1ad1a2daaa128", "author": {"user": null}, "url": "https://github.com/powsybl/powsybl-core/commit/a6e789732466f685dd764101f9c1ad1a2daaa128", "committedDate": "2020-04-06T11:33:09Z", "message": "* Add a validation in iidm to avoid negative active power setpoint in a hvdc line.\n* Try to introduce a hupper limit to ratios.\n\nSigned-off-by: Anne Tilloy <atilloy@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b92173dcc4adf1c6c3389df9deef6813375a0b5", "author": {"user": null}, "url": "https://github.com/powsybl/powsybl-core/commit/9b92173dcc4adf1c6c3389df9deef6813375a0b5", "committedDate": "2020-04-06T11:50:18Z", "message": "Fix.\n\nSigned-off-by: Anne Tilloy <atilloy@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14ebade6a134d5e4defc48c971a156f635bd0542", "author": {"user": null}, "url": "https://github.com/powsybl/powsybl-core/commit/14ebade6a134d5e4defc48c971a156f635bd0542", "committedDate": "2020-04-06T12:58:37Z", "message": "maxP should be positive for an HVDC line.\n* Fix CGMES conversion\n* Fix tests.\n\nSigned-off-by: Anne Tilloy <atilloy@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NjUxMTY2", "url": "https://github.com/powsybl/powsybl-core/pull/1262#pullrequestreview-388651166", "createdAt": "2020-04-06T22:04:51Z", "commit": {"oid": "14ebade6a134d5e4defc48c971a156f635bd0542"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjowNDo1MVrOGBroYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjowNDo1MVrOGBroYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQxNjYxMQ==", "bodyText": "The power factor is defined as the ratio of the active power to the apparent power\npowerFactor = P/ Math.hypot(P, Q)\nso the powerFactor is a number in the closed interval [-1,1], -1 <= powerFactor <= 1", "url": "https://github.com/powsybl/powsybl-core/pull/1262#discussion_r404416611", "createdAt": "2020-04-06T22:04:51Z", "author": {"login": "marqueslanauja"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ValidationUtil.java", "diffHunk": "@@ -365,6 +381,8 @@ public static void checkConvertersMode(Validable validable, HvdcLine.ConvertersM\n     public static void checkPowerFactor(Validable validable, double powerFactor) {\n         if (Double.isNaN(powerFactor)) {\n             throw new ValidationException(validable, \"power factor is invalid\");\n+        } else if (Math.abs(powerFactor) > 3) {\n+            throw new ValidationException(validable, \"power factor is invalid, it should be a ratio\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14ebade6a134d5e4defc48c971a156f635bd0542"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NjUyNzAz", "url": "https://github.com/powsybl/powsybl-core/pull/1262#pullrequestreview-388652703", "createdAt": "2020-04-06T22:07:45Z", "commit": {"oid": "14ebade6a134d5e4defc48c971a156f635bd0542"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjowNzo0NVrOGBrtcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjowNzo0NVrOGBrtcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQxNzkwNw==", "bodyText": "The lossFactor is defined and calculated as a percentage, so 0 <= lossFactor <= 100", "url": "https://github.com/powsybl/powsybl-core/pull/1262#discussion_r404417907", "createdAt": "2020-04-06T22:07:45Z", "author": {"login": "marqueslanauja"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ValidationUtil.java", "diffHunk": "@@ -385,6 +403,8 @@ public static void checkLossFactor(Validable validable, float lossFactor) {\n             throw new ValidationException(validable, \"loss factor is invalid\");\n         } else if (lossFactor < 0) {\n             throw new ValidationException(validable, \"loss factor must be >= 0\");\n+        } else if (lossFactor > 3) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14ebade6a134d5e4defc48c971a156f635bd0542"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "415f437ed036cd1fc6fb2078cd8d7be25394885b", "author": {"user": null}, "url": "https://github.com/powsybl/powsybl-core/commit/415f437ed036cd1fc6fb2078cd8d7be25394885b", "committedDate": "2020-04-07T07:02:30Z", "message": "Fix hupper limits of lossFactor and powerFactor.\n\nSigned-off-by: Anne Tilloy <atilloy@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e835b33b8016892b40c54ed4ce554259a78cba59", "author": {"user": null}, "url": "https://github.com/powsybl/powsybl-core/commit/e835b33b8016892b40c54ed4ce554259a78cba59", "committedDate": "2020-04-07T07:09:13Z", "message": "Revert.\n\nSigned-off-by: Anne Tilloy <atilloy@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4ODg5NDQ2", "url": "https://github.com/powsybl/powsybl-core/pull/1262#pullrequestreview-388889446", "createdAt": "2020-04-07T08:20:29Z", "commit": {"oid": "e835b33b8016892b40c54ed4ce554259a78cba59"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4OTE2MDY4", "url": "https://github.com/powsybl/powsybl-core/pull/1262#pullrequestreview-388916068", "createdAt": "2020-04-07T08:54:32Z", "commit": {"oid": "e835b33b8016892b40c54ed4ce554259a78cba59"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo1NDozMlrOGB5qbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo1NDozMlrOGB5qbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY0NjUxMQ==", "bodyText": "If the power factor is between -1 and 1, we should also check the lower bound", "url": "https://github.com/powsybl/powsybl-core/pull/1262#discussion_r404646511", "createdAt": "2020-04-07T08:54:32Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/ValidationUtil.java", "diffHunk": "@@ -365,6 +381,8 @@ public static void checkConvertersMode(Validable validable, HvdcLine.ConvertersM\n     public static void checkPowerFactor(Validable validable, double powerFactor) {\n         if (Double.isNaN(powerFactor)) {\n             throw new ValidationException(validable, \"power factor is invalid\");\n+        } else if (Math.abs(powerFactor) > 1) {\n+            throw new ValidationException(validable, \"power factor is invalid, it should be between -1 and 1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e835b33b8016892b40c54ed4ce554259a78cba59"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d210d4304fa02ecf983943fdbf16a431b05e707", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/2d210d4304fa02ecf983943fdbf16a431b05e707", "committedDate": "2020-04-07T08:58:23Z", "message": "Merge branch 'master' into hvdc-validation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4219, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}