{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyODY2MTEz", "number": 1345, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDowNzo1N1rOEEs2vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjowMTozMlrOEEwBrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMzY0NjcxOnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-dsl/src/main/java/com/powsybl/dynamicsimulation/groovy/DynamicModelExtension.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDowNzo1N1rOGifFuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDo0MToxM1rOGiggHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxNDEzNg==", "bodyText": "To be consistent with the curves this class should be named DynamicModelGroovyExtension", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438814136", "createdAt": "2020-06-11T14:07:57Z", "author": {"login": "agnesLeroy"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/main/java/com/powsybl/dynamicsimulation/groovy/DynamicModelExtension.java", "diffHunk": "@@ -0,0 +1,16 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation.groovy;\n+\n+import com.powsybl.dynamicsimulation.DynamicModel;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public interface DynamicModelExtension extends GroovyExtension<DynamicModel> {\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4c31ed5dc66c25fb8087d42afb24c402e3151c1"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzNzI3OQ==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438837279", "createdAt": "2020-06-11T14:41:13Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/main/java/com/powsybl/dynamicsimulation/groovy/DynamicModelExtension.java", "diffHunk": "@@ -0,0 +1,16 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation.groovy;\n+\n+import com.powsybl.dynamicsimulation.DynamicModel;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public interface DynamicModelExtension extends GroovyExtension<DynamicModel> {\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxNDEzNg=="}, "originalCommit": {"oid": "a4c31ed5dc66c25fb8087d42afb24c402e3151c1"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMzY1MTkzOnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/groovy/com/powsybl/dynamicsimulation/groovy/DummyDynamicModelExtension.groovy", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDowOToxOVrOGifJLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNToxMjo1NlrOGih2yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxNTAyMg==", "bodyText": "Same remark as above, this class should be named DummyDynamicModelGroovyExtension.", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438815022", "createdAt": "2020-06-11T14:09:19Z", "author": {"login": "agnesLeroy"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/groovy/com/powsybl/dynamicsimulation/groovy/DummyDynamicModelExtension.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.dynamicsimulation.groovy\n+\n+import java.util.function.Consumer\n+\n+import com.google.auto.service.AutoService\n+import com.powsybl.dsl.DslException\n+import com.powsybl.dynamicsimulation.DynamicModel\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+@AutoService(DynamicModelExtension.class)\n+class DummyDynamicModelExtension implements DynamicModelExtension {\n+\n+    static class DummyDynamicModelSpec {\n+        String id\n+        String parameterSetId\n+        String parameterSetFile\n+        \n+        void id(String id) {\n+            this.id = id\n+        }\n+\n+        void parameterSetId(String parameterSetId) {\n+            this.parameterSetId = parameterSetId\n+        }\n+\n+        void parameterSetFile(String parameterSetFile) {\n+            this.parameterSetFile = parameterSetFile\n+        }\n+    }\n+\n+    void load(Binding binding, Consumer<DynamicModel> consumer) {\n+        binding.dummyDynamicModel = { Closure<Void> closure ->\n+            def cloned = closure.clone()\n+\n+            DummyDynamicModelSpec dynamicModelSpec = new DummyDynamicModelSpec()\n+\n+            cloned.delegate = dynamicModelSpec\n+            cloned()\n+            if (!dynamicModelSpec.id) {\n+                throw new DslException(\"'id' field is not set\")\n+            }\n+            if (!dynamicModelSpec.parameterSetId) {\n+                throw new DslException(\"'parameterSetId' field is not set\")\n+            }\n+            if (!dynamicModelSpec.parameterSetFile) {\n+                throw new DslException(\"'parameterSetFile' field is not set\")\n+            }\n+\n+            consumer.accept(new DummyDynamicModel(dynamicModelSpec.id, dynamicModelSpec.parameterSetId, dynamicModelSpec.parameterSetFile))\n+        }\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4c31ed5dc66c25fb8087d42afb24c402e3151c1"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg1OTQ2Ng==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438859466", "createdAt": "2020-06-11T15:12:56Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/groovy/com/powsybl/dynamicsimulation/groovy/DummyDynamicModelExtension.groovy", "diffHunk": "@@ -0,0 +1,60 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.dynamicsimulation.groovy\n+\n+import java.util.function.Consumer\n+\n+import com.google.auto.service.AutoService\n+import com.powsybl.dsl.DslException\n+import com.powsybl.dynamicsimulation.DynamicModel\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+@AutoService(DynamicModelExtension.class)\n+class DummyDynamicModelExtension implements DynamicModelExtension {\n+\n+    static class DummyDynamicModelSpec {\n+        String id\n+        String parameterSetId\n+        String parameterSetFile\n+        \n+        void id(String id) {\n+            this.id = id\n+        }\n+\n+        void parameterSetId(String parameterSetId) {\n+            this.parameterSetId = parameterSetId\n+        }\n+\n+        void parameterSetFile(String parameterSetFile) {\n+            this.parameterSetFile = parameterSetFile\n+        }\n+    }\n+\n+    void load(Binding binding, Consumer<DynamicModel> consumer) {\n+        binding.dummyDynamicModel = { Closure<Void> closure ->\n+            def cloned = closure.clone()\n+\n+            DummyDynamicModelSpec dynamicModelSpec = new DummyDynamicModelSpec()\n+\n+            cloned.delegate = dynamicModelSpec\n+            cloned()\n+            if (!dynamicModelSpec.id) {\n+                throw new DslException(\"'id' field is not set\")\n+            }\n+            if (!dynamicModelSpec.parameterSetId) {\n+                throw new DslException(\"'parameterSetId' field is not set\")\n+            }\n+            if (!dynamicModelSpec.parameterSetFile) {\n+                throw new DslException(\"'parameterSetFile' field is not set\")\n+            }\n+\n+            consumer.accept(new DummyDynamicModel(dynamicModelSpec.id, dynamicModelSpec.parameterSetId, dynamicModelSpec.parameterSetFile))\n+        }\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgxNTAyMg=="}, "originalCommit": {"oid": "a4c31ed5dc66c25fb8087d42afb24c402e3151c1"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMzY4MjEzOnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/java/com/powsybl/dynamicsimulation/groovy/DummyDynamicModel.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDoxNjozMFrOGifcuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNToxMjo0MFrOGih2Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgyMDAyNQ==", "bodyText": "Why do we have the parameterSetFile here? I was expecting to have only an Id (that will be either the static Id o the dynamic model Id) and a parameter Id. Am I wrong?", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438820025", "createdAt": "2020-06-11T14:16:30Z", "author": {"login": "agnesLeroy"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/java/com/powsybl/dynamicsimulation/groovy/DummyDynamicModel.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation.groovy;\n+\n+import java.util.Objects;\n+\n+import com.powsybl.dynamicsimulation.DynamicModel;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public class DummyDynamicModel implements DynamicModel {\n+\n+    private final String id;\n+\n+    private final String parameterSetId;\n+\n+    private final String parameterSetFile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4c31ed5dc66c25fb8087d42afb24c402e3151c1"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg1OTI3MQ==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438859271", "createdAt": "2020-06-11T15:12:40Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/java/com/powsybl/dynamicsimulation/groovy/DummyDynamicModel.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation.groovy;\n+\n+import java.util.Objects;\n+\n+import com.powsybl.dynamicsimulation.DynamicModel;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public class DummyDynamicModel implements DynamicModel {\n+\n+    private final String id;\n+\n+    private final String parameterSetId;\n+\n+    private final String parameterSetFile;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgyMDAyNQ=="}, "originalCommit": {"oid": "a4c31ed5dc66c25fb8087d42afb24c402e3151c1"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNDE0OTE0OnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-api/src/main/java/com/powsybl/dynamicsimulation/MappingSupplier.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNTo1NzoxMlrOGikIeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzoyNzozNFrOGi55-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5Njc2MQ==", "bodyText": "I'm not sure the name of this class is clear enough: we do not know the purpose of the mapping.\nDo we really want this empty method? Does it make sense to have an empty mapping? It seems to be used in the unit-test, so maybe we should remove this method from the API and move it to the test sources", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438896761", "createdAt": "2020-06-11T15:57:12Z", "author": {"login": "mathbagu"}, "path": "dynamic-simulation/dynamic-simulation-api/src/main/java/com/powsybl/dynamicsimulation/MappingSupplier.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation;\n+\n+import java.util.Collections;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public interface MappingSupplier extends SimulatorInputSupplier<DynamicModel> {\n+\n+    static MappingSupplier empty() {\n+        return network -> Collections.emptyList();\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkxMzU0OA==", "bodyText": "Yes I agree it should be moved to the test sources", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438913548", "createdAt": "2020-06-11T16:23:28Z", "author": {"login": "agnesLeroy"}, "path": "dynamic-simulation/dynamic-simulation-api/src/main/java/com/powsybl/dynamicsimulation/MappingSupplier.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation;\n+\n+import java.util.Collections;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public interface MappingSupplier extends SimulatorInputSupplier<DynamicModel> {\n+\n+    static MappingSupplier empty() {\n+        return network -> Collections.emptyList();\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5Njc2MQ=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMDQzNg==", "bodyText": "Agree on the comments about the name of the class. @mathbagu suggestion of renaming from MappingSupplier to DynamicModelsSupplier is ok for me", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438930436", "createdAt": "2020-06-11T16:52:03Z", "author": {"login": "zamarrenolm"}, "path": "dynamic-simulation/dynamic-simulation-api/src/main/java/com/powsybl/dynamicsimulation/MappingSupplier.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation;\n+\n+import java.util.Collections;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public interface MappingSupplier extends SimulatorInputSupplier<DynamicModel> {\n+\n+    static MappingSupplier empty() {\n+        return network -> Collections.emptyList();\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5Njc2MQ=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MzQ5Nw==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r439253497", "createdAt": "2020-06-12T07:27:34Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-api/src/main/java/com/powsybl/dynamicsimulation/MappingSupplier.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation;\n+\n+import java.util.Collections;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public interface MappingSupplier extends SimulatorInputSupplier<DynamicModel> {\n+\n+    static MappingSupplier empty() {\n+        return network -> Collections.emptyList();\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5Njc2MQ=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNDE1NDEwOnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-dsl/src/main/java/com/powsybl/dynamicsimulation/groovy/GroovyMappingSupplier.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNTo1ODoyNVrOGikLuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzoyNzo0NVrOGi56SA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5NzU5NQ==", "bodyText": "Same remark about the name of the class", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438897595", "createdAt": "2020-06-11T15:58:25Z", "author": {"login": "mathbagu"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/main/java/com/powsybl/dynamicsimulation/groovy/GroovyMappingSupplier.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation.groovy;\n+\n+import java.nio.file.Path;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+\n+import org.codehaus.groovy.control.CompilerConfiguration;\n+\n+import com.powsybl.dsl.ExpressionDslLoader;\n+import com.powsybl.dsl.GroovyScripts;\n+import com.powsybl.dynamicsimulation.DynamicModel;\n+import com.powsybl.dynamicsimulation.MappingSupplier;\n+import com.powsybl.iidm.network.Network;\n+\n+import groovy.lang.Binding;\n+import groovy.lang.GroovyCodeSource;\n+import groovy.lang.GroovyShell;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public class GroovyMappingSupplier implements MappingSupplier {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MzU3Ng==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r439253576", "createdAt": "2020-06-12T07:27:45Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/main/java/com/powsybl/dynamicsimulation/groovy/GroovyMappingSupplier.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.dynamicsimulation.groovy;\n+\n+import java.nio.file.Path;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+\n+import org.codehaus.groovy.control.CompilerConfiguration;\n+\n+import com.powsybl.dsl.ExpressionDslLoader;\n+import com.powsybl.dsl.GroovyScripts;\n+import com.powsybl.dynamicsimulation.DynamicModel;\n+import com.powsybl.dynamicsimulation.MappingSupplier;\n+import com.powsybl.iidm.network.Network;\n+\n+import groovy.lang.Binding;\n+import groovy.lang.GroovyCodeSource;\n+import groovy.lang.GroovyShell;\n+\n+/**\n+ * @author Marcos de Miguel <demiguelm at aia.es>\n+ */\n+public class GroovyMappingSupplier implements MappingSupplier {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5NzU5NQ=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNDE2MTkyOnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/resources/mapping.groovy", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjowMDoyNFrOGikQ6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzoyOTo1N1rOGi59-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5ODkyMQ==", "bodyText": "You should adapt the logger name.", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438898921", "createdAt": "2020-06-11T16:00:24Z", "author": {"login": "mathbagu"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/resources/mapping.groovy", "diffHunk": "@@ -0,0 +1,25 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+import com.powsybl.iidm.network.Generator\n+import com.powsybl.iidm.network.Load\n+import org.slf4j.Logger\n+import org.slf4j.LoggerFactory\n+\n+Logger logger = LoggerFactory.getLogger(\"com.powsybl.dynamicsimulation.groovy.GroovyCurvesProvider\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1NDUyMA==", "bodyText": "Done.\nShould we change \"GroovyCurvesProvider\" to \"GroovyCurvesSupplier\" in curves.groovy?", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r439254520", "createdAt": "2020-06-12T07:29:57Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-dsl/src/test/resources/mapping.groovy", "diffHunk": "@@ -0,0 +1,25 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+import com.powsybl.iidm.network.Generator\n+import com.powsybl.iidm.network.Load\n+import org.slf4j.Logger\n+import org.slf4j.LoggerFactory\n+\n+Logger logger = LoggerFactory.getLogger(\"com.powsybl.dynamicsimulation.groovy.GroovyCurvesProvider\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5ODkyMQ=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNDE2MzY3OnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjowMDo0OVrOGikSCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzozMDowN1rOGi5-Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTIwOQ==", "bodyText": "we should also change this option's name", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438899209", "createdAt": "2020-06-11T16:00:49Z", "author": {"login": "mathbagu"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -45,6 +48,7 @@\n public class DynamicSimulationTool implements Tool {\n \n     private static final String CASE_FILE = \"case-file\";\n+    private static final String MAPPING_FILE = \"mapping-file\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1NDYwMw==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r439254603", "createdAt": "2020-06-12T07:30:07Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -45,6 +48,7 @@\n public class DynamicSimulationTool implements Tool {\n \n     private static final String CASE_FILE = \"case-file\";\n+    private static final String MAPPING_FILE = \"mapping-file\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTIwOQ=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNDE2NTE3OnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjowMToxMlrOGikS9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzozMToxNlrOGi6ATw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTQ0Ng==", "bodyText": "And give more detail in the description", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438899446", "createdAt": "2020-06-11T16:01:12Z", "author": {"login": "mathbagu"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -78,6 +82,12 @@ public Options getOptions() {\n                     .argName(\"FILE\")\n                     .required()\n                     .build());\n+                options.addOption(Option.builder().longOpt(MAPPING_FILE)\n+                    .desc(\"mapping description as Groovy file\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkxNDYyOQ==", "bodyText": "Would \"Dynamic models description as a Groovy file: defines the dynamic models to be associated to chosen equipments of the network\" be enough?", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438914629", "createdAt": "2020-06-11T16:25:13Z", "author": {"login": "agnesLeroy"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -78,6 +82,12 @@ public Options getOptions() {\n                     .argName(\"FILE\")\n                     .required()\n                     .build());\n+                options.addOption(Option.builder().longOpt(MAPPING_FILE)\n+                    .desc(\"mapping description as Groovy file\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTQ0Ng=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1NTExOQ==", "bodyText": "Description changed by Agnes proposal", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r439255119", "createdAt": "2020-06-12T07:31:16Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -78,6 +82,12 @@ public Options getOptions() {\n                     .argName(\"FILE\")\n                     .required()\n                     .build());\n+                options.addOption(Option.builder().longOpt(MAPPING_FILE)\n+                    .desc(\"mapping description as Groovy file\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTQ0Ng=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNDE2NjIzOnYy", "diffSide": "RIGHT", "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjowMTozMlrOGikTxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwNzozMToyOFrOGi6AmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTY1Mg==", "bodyText": "This option is required so this test is useless.", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r438899652", "createdAt": "2020-06-11T16:01:32Z", "author": {"login": "mathbagu"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -131,6 +141,12 @@ public void run(CommandLine line, ToolRunningContext context) throws Exception {\n \n         DynamicSimulation.Runner runner = DynamicSimulation.find();\n \n+        MappingSupplier mappingSupplier = MappingSupplier.empty();\n+        if (line.hasOption(MAPPING_FILE)) {\n+            Path mappingFile = context.getFileSystem().getPath(line.getOptionValue(MAPPING_FILE));\n+            mappingSupplier = createMappingSupplier(mappingFile, runner.getName());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1NTE5Mw==", "bodyText": "Done", "url": "https://github.com/powsybl/powsybl-core/pull/1345#discussion_r439255193", "createdAt": "2020-06-12T07:31:28Z", "author": {"login": "marcosmc"}, "path": "dynamic-simulation/dynamic-simulation-tool/src/main/java/com/powsybl/dynamicsimulation/tool/DynamicSimulationTool.java", "diffHunk": "@@ -131,6 +141,12 @@ public void run(CommandLine line, ToolRunningContext context) throws Exception {\n \n         DynamicSimulation.Runner runner = DynamicSimulation.find();\n \n+        MappingSupplier mappingSupplier = MappingSupplier.empty();\n+        if (line.hasOption(MAPPING_FILE)) {\n+            Path mappingFile = context.getFileSystem().getPath(line.getOptionValue(MAPPING_FILE));\n+            mappingSupplier = createMappingSupplier(mappingFile, runner.getName());\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg5OTY1Mg=="}, "originalCommit": {"oid": "20bafe32614e3fdd69b26fca690637d614820d90"}, "originalPosition": 42}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}