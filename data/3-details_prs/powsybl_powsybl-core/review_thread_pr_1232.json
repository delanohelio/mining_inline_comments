{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNTUzMDg5", "number": 1232, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyMjowNVrODqUKJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyMjowNVrODqUKJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1Njk3MDYwOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/MergingViewIndex.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyMjowNVrOF5-99g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwOTo1MjoxNFrOF9iAgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg==", "bodyText": "Why calling getLines() or getDanglingLines() is not sufficient there?", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r396344822", "createdAt": "2020-03-23T10:22:05Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/MergingViewIndex.java", "diffHunk": "@@ -132,6 +132,29 @@ Identifiable getIdentifiable(final Identifiable identifiable) {\n         return getIdentifiableStream().collect(Collectors.toList());\n     }\n \n+    /** @return all Adapters according to all Connectables of a given type */\n+    <C extends Connectable> Collection<C> getConnectables(Class<C> clazz) {\n+        // Search Connectables of a given type into merging & working networks\n+        if (clazz.isAssignableFrom(Line.class)) {\n+            return getLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());\n+        } else if (clazz.isAssignableFrom(DanglingLine.class)) {\n+            return getDanglingLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61ce12768df37c8dbd63370a09f77b02a20de3d4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUwMDQ5MQ==", "bodyText": "We can not being sure that the returned stream will be of clazz instance. For example, if class is TieLine.class, TieLine.class is assignable from Line.class but the returned stream must still be filtered and cast to return only TieLines.", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r396500491", "createdAt": "2020-03-23T14:39:58Z", "author": {"login": "miovd"}, "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/MergingViewIndex.java", "diffHunk": "@@ -132,6 +132,29 @@ Identifiable getIdentifiable(final Identifiable identifiable) {\n         return getIdentifiableStream().collect(Collectors.toList());\n     }\n \n+    /** @return all Adapters according to all Connectables of a given type */\n+    <C extends Connectable> Collection<C> getConnectables(Class<C> clazz) {\n+        // Search Connectables of a given type into merging & working networks\n+        if (clazz.isAssignableFrom(Line.class)) {\n+            return getLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());\n+        } else if (clazz.isAssignableFrom(DanglingLine.class)) {\n+            return getDanglingLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg=="}, "originalCommit": {"oid": "61ce12768df37c8dbd63370a09f77b02a20de3d4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3NDQyNA==", "bodyText": "Looking to the NetworkImpl, getLines() returns both Line and TieLine objects. The NetworkImpl::getConnectableStream(Line.class) return lines and tie lines:\n    @Override\n    public <C extends Connectable> Stream<C> getConnectableStream(Class<C> clazz) {\n        return index.getAll().stream().filter(clazz::isInstance).map(clazz::cast);\n    }\n\nIn case of the merging view, the getLine() should return lines, tie tiles and merged lines. I think the getLines() method is OK\nFor the danglingLines() method, it should return all the unmerged dangling lines. Once again, I think the getDanglingLines() method is OK\nLast remark, this TieLine.class.isAssignableFrom(Line.class) test returns false. So I still think you can simply call getLines() and getDanglingLines().", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r399974424", "createdAt": "2020-03-30T07:19:27Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/MergingViewIndex.java", "diffHunk": "@@ -132,6 +132,29 @@ Identifiable getIdentifiable(final Identifiable identifiable) {\n         return getIdentifiableStream().collect(Collectors.toList());\n     }\n \n+    /** @return all Adapters according to all Connectables of a given type */\n+    <C extends Connectable> Collection<C> getConnectables(Class<C> clazz) {\n+        // Search Connectables of a given type into merging & working networks\n+        if (clazz.isAssignableFrom(Line.class)) {\n+            return getLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());\n+        } else if (clazz.isAssignableFrom(DanglingLine.class)) {\n+            return getDanglingLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg=="}, "originalCommit": {"oid": "61ce12768df37c8dbd63370a09f77b02a20de3d4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA2NDY0MA==", "bodyText": "Last remark, this TieLine.class.isAssignableFrom(Line.class) test returns false. So I still think you can simply call getLines() and getDanglingLines().\n\nOkay, I corrected it in the last commit.\n\nIn case of the merging view, the getLine() should return lines, tie tiles and merged lines. I think the getLines() method is OK\nFor the danglingLines() method, it should return all the unmerged dangling lines. Once again, I think the getDanglingLines() method is OK\n\nI agree. However, when trying to retrieve a subclass of Line (in the example in the tests added in the last commit, MergedLine), it may be necessary to call getLines first and then filter and cast. What do you think?", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r400064640", "createdAt": "2020-03-30T09:52:14Z", "author": {"login": "miovd"}, "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/MergingViewIndex.java", "diffHunk": "@@ -132,6 +132,29 @@ Identifiable getIdentifiable(final Identifiable identifiable) {\n         return getIdentifiableStream().collect(Collectors.toList());\n     }\n \n+    /** @return all Adapters according to all Connectables of a given type */\n+    <C extends Connectable> Collection<C> getConnectables(Class<C> clazz) {\n+        // Search Connectables of a given type into merging & working networks\n+        if (clazz.isAssignableFrom(Line.class)) {\n+            return getLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());\n+        } else if (clazz.isAssignableFrom(DanglingLine.class)) {\n+            return getDanglingLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg=="}, "originalCommit": {"oid": "61ce12768df37c8dbd63370a09f77b02a20de3d4"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 121, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}