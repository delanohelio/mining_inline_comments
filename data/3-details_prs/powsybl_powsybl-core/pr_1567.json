{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2NjY5MzIw", "number": 1567, "title": "UCTE: quality of datasets and calculations support", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\n#1167\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nI have added some logs at 2 levels :\n\nIIDM level after import and before export ;\nUcte model level ;\n\nWhat is the current behavior? (You can also link to an open issue here)\nSome logs are missing. The exhaustive list is here: https://eepublicdownloads.entsoe.eu/clean-documents/Publications/SOC/Continental_Europe/150420_quality_of_datasets_and_calculations_3rd_edition.pdf\nWhat is the new behavior (if this is a feature change)?\nSome logs have been added but the list is not complete because we need to perform some checks at raw model level to detect syntaxe errors.\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\n(if any of the questions/checkboxes don't apply, please delete them entirely)", "createdAt": "2020-12-11T08:45:24Z", "url": "https://github.com/powsybl/powsybl-core/pull/1567", "merged": true, "mergeCommit": {"oid": "5a53e97fd15de72751b2f273e83af8bd59c2fb3a"}, "closed": true, "closedAt": "2021-01-20T09:31:38Z", "author": {"login": "annetill"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlDk8XAH2gAyNTM2NjY5MzIwOjkwMzljMjc3Y2ZhZjIwODdiZjQ3NzFiNDA3MDYxNTlhNDJhY2FhMjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdx8iLzAFqTU3MjAyODcyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/9039c277cfaf2087bf4771b40706159a42acaa21", "committedDate": "2020-12-11T08:22:30Z", "message": "Adds logs.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMjQ1Njgy", "url": "https://github.com/powsybl/powsybl-core/pull/1567#pullrequestreview-550245682", "createdAt": "2020-12-11T16:23:01Z", "commit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNjoyMzowMVrOIEADIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNjoyMzowMVrOIEADIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTA2NjAxOQ==", "bodyText": "angle instead of phase?", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r541066019", "createdAt": "2020-12-11T16:23:01Z", "author": {"login": "benrejebmoh"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteValidation.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.network;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    public static final double ZERO_EPS = 1e-4;\n+    public static final double REACTANCE_EPS = 0.05;\n+\n+    private UcteValidation() {\n+    }\n+\n+    // Data: line characteristics\n+    public static void checkValidLineCharacteristics(UcteLine line) {\n+        switch (line.getStatus()) {\n+            case EQUIVALENT_ELEMENT_IN_OPERATION:\n+            case EQUIVALENT_ELEMENT_OUT_OF_OPERATION:\n+            case REAL_ELEMENT_IN_OPERATION:\n+            case REAL_ELEMENT_OUT_OF_OPERATION:\n+                if (line.getResistance() < ZERO_EPS) {\n+                    LOGGER.error(\"Real line resistance cannot be negative\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero. For lines this value must be larger than 0.05 ohm\");\n+                }\n+                break;\n+            case BUSBAR_COUPLER_IN_OPERATION:\n+            case BUSBAR_COUPLER_OUT_OF_OPERATION:\n+                if (Math.abs(line.getResistance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler resistance must be zero\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero\");\n+                }\n+                if (Math.abs(line.getSusceptance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler susceptance must be zero\");\n+                }\n+            default:\n+        }\n+    }\n+\n+    // Data: transformer characteristics\n+    public static void checkValidTransformerCharacteristics(UcteTransformer ucteTransformer) {\n+        if (ucteTransformer.getNominalPower() > ZERO_EPS) {\n+            LOGGER.error(\"Value must be positive, blank and zero is not allowed\");\n+        }\n+        if (ucteTransformer.getResistance() > ZERO_EPS) {\n+            LOGGER.error(\"Blank is not allowed, real transformer resistance must be greater than or equal to zero\");\n+        }\n+        if (ucteTransformer.getReactance() > REACTANCE_EPS) {\n+            LOGGER.error(\"Blank is not allowed, absolute value of reactance must be greater than 0.05 ohm\");\n+        }\n+        if (ucteTransformer.getSusceptance() > ZERO_EPS) {\n+            LOGGER.warn(\"Blank is not allowed\");\n+        }\n+        if (ucteTransformer.getConductance() > ZERO_EPS) {\n+            LOGGER.warn(\"Transformer shunt conductance must be greater than or equal to zero\");\n+        }\n+    }\n+\n+    // Data: transformer regulation\n+    // Phase regulation\n+    public static void checkPhaseRegulation(UctePhaseRegulation uctePhaseRegulation) {\n+        if (uctePhaseRegulation.getDu() < ZERO_EPS || uctePhaseRegulation.getDu() > 6) {\n+            LOGGER.warn(\"For LTCs, transformer phase regulation voltage per tap should not be zero. Its absolute value should not be above 6 %\");\n+        }\n+        if (uctePhaseRegulation.getN() < ZERO_EPS || uctePhaseRegulation.getDu() > 35) {\n+            LOGGER.warn(\"The number of phase regulating taps cannot be negative and cannot exceed 35\");\n+        }\n+    }\n+\n+    // Angle regulation\n+    public static void checkAngleRegulation(UcteAngleRegulation ucteAngleRegulation) {\n+        if (ucteAngleRegulation.getDu() < ZERO_EPS || ucteAngleRegulation.getDu() > 6) {\n+            LOGGER.warn(\"For LTCs, transformer phase regulation voltage per tap should not be zero. Its absolute value should not be above 6 %\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 87}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MzgwNzU0", "url": "https://github.com/powsybl/powsybl-core/pull/1567#pullrequestreview-554380754", "createdAt": "2020-12-17T08:38:58Z", "commit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwODozODo1OFrOIHqZOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwODo0NDoyMFrOIHqmXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNTUzMQ==", "bodyText": "This log doesn't give enough information: If plenty of my buses have a bad nominalVoltage, I won't be able to find which one. You have to add contextual information in the log such as the busId, the nominal voltage, the lower et upper bound.", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544905531", "createdAt": "2020-12-17T08:38:58Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/util/UcteValidation.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.converter.util;\n+\n+import com.powsybl.iidm.network.*;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    private UcteValidation() {\n+    }\n+\n+    public static void run(Network network) {\n+        checkNodesReferenceVoltage(network);\n+        checkGenerators(network);\n+        checkTransformers(network);\n+    }\n+\n+    // Data: node voltage\n+    private static void checkNodesReferenceVoltage(Network network) {\n+        double nominalVoltage;\n+        double voltage;\n+        for (Bus bus : network.getBusView().getBuses()) {\n+            nominalVoltage = bus.getVoltageLevel().getNominalV();\n+            voltage = bus.getV();\n+            if (voltage < 0.8 * nominalVoltage || voltage > 1.2 * nominalVoltage) {\n+                LOGGER.warn(\"Wrong value for reference voltage\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNjA3Nw==", "bodyText": "Do not use magic numbers in the code: use constant instead that could be easily change to update the whole code", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544906077", "createdAt": "2020-12-17T08:39:47Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/util/UcteValidation.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.converter.util;\n+\n+import com.powsybl.iidm.network.*;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    private UcteValidation() {\n+    }\n+\n+    public static void run(Network network) {\n+        checkNodesReferenceVoltage(network);\n+        checkGenerators(network);\n+        checkTransformers(network);\n+    }\n+\n+    // Data: node voltage\n+    private static void checkNodesReferenceVoltage(Network network) {\n+        double nominalVoltage;\n+        double voltage;\n+        for (Bus bus : network.getBusView().getBuses()) {\n+            nominalVoltage = bus.getVoltageLevel().getNominalV();\n+            voltage = bus.getV();\n+            if (voltage < 0.8 * nominalVoltage || voltage > 1.2 * nominalVoltage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNjE4Mg==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544906182", "createdAt": "2020-12-17T08:39:59Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/util/UcteValidation.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.converter.util;\n+\n+import com.powsybl.iidm.network.*;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    private UcteValidation() {\n+    }\n+\n+    public static void run(Network network) {\n+        checkNodesReferenceVoltage(network);\n+        checkGenerators(network);\n+        checkTransformers(network);\n+    }\n+\n+    // Data: node voltage\n+    private static void checkNodesReferenceVoltage(Network network) {\n+        double nominalVoltage;\n+        double voltage;\n+        for (Bus bus : network.getBusView().getBuses()) {\n+            nominalVoltage = bus.getVoltageLevel().getNominalV();\n+            voltage = bus.getV();\n+            if (voltage < 0.8 * nominalVoltage || voltage > 1.2 * nominalVoltage) {\n+                LOGGER.warn(\"Wrong value for reference voltage\");\n+            }\n+        }\n+    }\n+\n+    private static void checkGenerators(Network network) {\n+        for (Generator generator : network.getGenerators()) {\n+            if (generator.isVoltageRegulatorOn()) {\n+                double targetVoltage = generator.getTargetV();\n+                double nominalVoltage = generator.getRegulatingTerminal().getVoltageLevel().getNominalV();\n+                if (nominalVoltage > 110 && (targetVoltage < 0.8 * nominalVoltage || targetVoltage > 1.2 * nominalVoltage)) {\n+                    LOGGER.warn(\"Wrong value for reference voltage\");\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNjM2MA==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544906360", "createdAt": "2020-12-17T08:40:19Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/util/UcteValidation.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.converter.util;\n+\n+import com.powsybl.iidm.network.*;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    private UcteValidation() {\n+    }\n+\n+    public static void run(Network network) {\n+        checkNodesReferenceVoltage(network);\n+        checkGenerators(network);\n+        checkTransformers(network);\n+    }\n+\n+    // Data: node voltage\n+    private static void checkNodesReferenceVoltage(Network network) {\n+        double nominalVoltage;\n+        double voltage;\n+        for (Bus bus : network.getBusView().getBuses()) {\n+            nominalVoltage = bus.getVoltageLevel().getNominalV();\n+            voltage = bus.getV();\n+            if (voltage < 0.8 * nominalVoltage || voltage > 1.2 * nominalVoltage) {\n+                LOGGER.warn(\"Wrong value for reference voltage\");\n+            }\n+        }\n+    }\n+\n+    private static void checkGenerators(Network network) {\n+        for (Generator generator : network.getGenerators()) {\n+            if (generator.isVoltageRegulatorOn()) {\n+                double targetVoltage = generator.getTargetV();\n+                double nominalVoltage = generator.getRegulatingTerminal().getVoltageLevel().getNominalV();\n+                if (nominalVoltage > 110 && (targetVoltage < 0.8 * nominalVoltage || targetVoltage > 1.2 * nominalVoltage)) {\n+                    LOGGER.warn(\"Wrong value for reference voltage\");\n+                }\n+            }\n+        }\n+    }\n+\n+    // Data: transformer voltage\n+    private static void checkTransformers(Network network) {\n+        for (TwoWindingsTransformer twt : network.getTwoWindingsTransformers()) {\n+            RatioTapChanger rtc = twt.getRatioTapChanger();\n+            if (rtc != null && rtc.isRegulating()) {\n+                double targetVoltage = rtc.getTargetV();\n+                double nominalVoltage = rtc.getRegulationTerminal().getVoltageLevel().getNominalV();\n+                if (nominalVoltage > 110 && (targetVoltage < 0.8 * nominalVoltage || targetVoltage > 1.2 * nominalVoltage)) {\n+                    LOGGER.warn(\"Wrong value for reference voltage\");\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNjc3Nw==", "bodyText": "I would call the check inside the line.fix() method.", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544906777", "createdAt": "2020-12-17T08:41:01Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteNetworkImpl.java", "diffHunk": "@@ -116,12 +116,22 @@ public void fix() {\n             node.fix();\n         }\n         for (UcteLine line : lines.values()) {\n+            UcteValidation.checkValidLineCharacteristics(line);\n             line.fix();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNjg3OQ==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544906879", "createdAt": "2020-12-17T08:41:13Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteNetworkImpl.java", "diffHunk": "@@ -116,12 +116,22 @@ public void fix() {\n             node.fix();\n         }\n         for (UcteLine line : lines.values()) {\n+            UcteValidation.checkValidLineCharacteristics(line);\n             line.fix();\n         }\n         for (UcteTransformer transfo : transformers.values()) {\n+            UcteValidation.checkValidTransformerCharacteristics(transfo);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNjk0Nw==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544906947", "createdAt": "2020-12-17T08:41:20Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteNetworkImpl.java", "diffHunk": "@@ -116,12 +116,22 @@ public void fix() {\n             node.fix();\n         }\n         for (UcteLine line : lines.values()) {\n+            UcteValidation.checkValidLineCharacteristics(line);\n             line.fix();\n         }\n         for (UcteTransformer transfo : transformers.values()) {\n+            UcteValidation.checkValidTransformerCharacteristics(transfo);\n             transfo.fix();\n         }\n         for (UcteRegulation regulation : regulations.values()) {\n+            UctePhaseRegulation phaseRegulation = regulation.getPhaseRegulation();\n+            UcteAngleRegulation angleRegulation = regulation.getAngleRegulation();\n+            if (phaseRegulation != null) {\n+                UcteValidation.checkPhaseRegulation(phaseRegulation);\n+            }\n+            if (angleRegulation != null) {\n+                UcteValidation.checkAngleRegulation(angleRegulation);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwNzE1NQ==", "bodyText": "From my point of view it's strange to have two different classes for UCTE validation. I'm pretty sure you can implement all the checks directly on the UCTE model", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544907155", "createdAt": "2020-12-17T08:41:38Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteValidation.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.network;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwODA2NQ==", "bodyText": "You have to do something in the default: in that specific case, throw an assertion error because we don't expect another line.status value.", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544908065", "createdAt": "2020-12-17T08:43:02Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteValidation.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.network;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    public static final double ZERO_EPS = 1e-4;\n+    public static final double REACTANCE_EPS = 0.05;\n+\n+    private UcteValidation() {\n+    }\n+\n+    // Data: line characteristics\n+    public static void checkValidLineCharacteristics(UcteLine line) {\n+        switch (line.getStatus()) {\n+            case EQUIVALENT_ELEMENT_IN_OPERATION:\n+            case EQUIVALENT_ELEMENT_OUT_OF_OPERATION:\n+            case REAL_ELEMENT_IN_OPERATION:\n+            case REAL_ELEMENT_OUT_OF_OPERATION:\n+                if (line.getResistance() < ZERO_EPS) {\n+                    LOGGER.error(\"Real line resistance cannot be negative\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero. For lines this value must be larger than 0.05 ohm\");\n+                }\n+                break;\n+            case BUSBAR_COUPLER_IN_OPERATION:\n+            case BUSBAR_COUPLER_OUT_OF_OPERATION:\n+                if (Math.abs(line.getResistance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler resistance must be zero\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero\");\n+                }\n+                if (Math.abs(line.getSusceptance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler susceptance must be zero\");\n+                }\n+            default:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwODI2MQ==", "bodyText": "All these logs don't give enough contextual information", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544908261", "createdAt": "2020-12-17T08:43:22Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteValidation.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.network;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    public static final double ZERO_EPS = 1e-4;\n+    public static final double REACTANCE_EPS = 0.05;\n+\n+    private UcteValidation() {\n+    }\n+\n+    // Data: line characteristics\n+    public static void checkValidLineCharacteristics(UcteLine line) {\n+        switch (line.getStatus()) {\n+            case EQUIVALENT_ELEMENT_IN_OPERATION:\n+            case EQUIVALENT_ELEMENT_OUT_OF_OPERATION:\n+            case REAL_ELEMENT_IN_OPERATION:\n+            case REAL_ELEMENT_OUT_OF_OPERATION:\n+                if (line.getResistance() < ZERO_EPS) {\n+                    LOGGER.error(\"Real line resistance cannot be negative\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero. For lines this value must be larger than 0.05 ohm\");\n+                }\n+                break;\n+            case BUSBAR_COUPLER_IN_OPERATION:\n+            case BUSBAR_COUPLER_OUT_OF_OPERATION:\n+                if (Math.abs(line.getResistance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler resistance must be zero\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero\");\n+                }\n+                if (Math.abs(line.getSusceptance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler susceptance must be zero\");\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwODM2NQ==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544908365", "createdAt": "2020-12-17T08:43:33Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteValidation.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.network;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    public static final double ZERO_EPS = 1e-4;\n+    public static final double REACTANCE_EPS = 0.05;\n+\n+    private UcteValidation() {\n+    }\n+\n+    // Data: line characteristics\n+    public static void checkValidLineCharacteristics(UcteLine line) {\n+        switch (line.getStatus()) {\n+            case EQUIVALENT_ELEMENT_IN_OPERATION:\n+            case EQUIVALENT_ELEMENT_OUT_OF_OPERATION:\n+            case REAL_ELEMENT_IN_OPERATION:\n+            case REAL_ELEMENT_OUT_OF_OPERATION:\n+                if (line.getResistance() < ZERO_EPS) {\n+                    LOGGER.error(\"Real line resistance cannot be negative\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero. For lines this value must be larger than 0.05 ohm\");\n+                }\n+                break;\n+            case BUSBAR_COUPLER_IN_OPERATION:\n+            case BUSBAR_COUPLER_OUT_OF_OPERATION:\n+                if (Math.abs(line.getResistance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler resistance must be zero\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero\");\n+                }\n+                if (Math.abs(line.getSusceptance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler susceptance must be zero\");\n+                }\n+            default:\n+        }\n+    }\n+\n+    // Data: transformer characteristics\n+    public static void checkValidTransformerCharacteristics(UcteTransformer ucteTransformer) {\n+        if (ucteTransformer.getNominalPower() > ZERO_EPS) {\n+            LOGGER.error(\"Value must be positive, blank and zero is not allowed\");\n+        }\n+        if (ucteTransformer.getResistance() > ZERO_EPS) {\n+            LOGGER.error(\"Blank is not allowed, real transformer resistance must be greater than or equal to zero\");\n+        }\n+        if (ucteTransformer.getReactance() > REACTANCE_EPS) {\n+            LOGGER.error(\"Blank is not allowed, absolute value of reactance must be greater than 0.05 ohm\");\n+        }\n+        if (ucteTransformer.getSusceptance() > ZERO_EPS) {\n+            LOGGER.warn(\"Blank is not allowed\");\n+        }\n+        if (ucteTransformer.getConductance() > ZERO_EPS) {\n+            LOGGER.warn(\"Transformer shunt conductance must be greater than or equal to zero\");\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkwODg5Mg==", "bodyText": "Same remark about all messages", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r544908892", "createdAt": "2020-12-17T08:44:20Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-network/src/main/java/com/powsybl/ucte/network/UcteValidation.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.ucte.network;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * @author Anne Tilloy {@literal <anne.tilloy at rte-france.com>}\n+ */\n+public final class UcteValidation {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(UcteValidation.class);\n+\n+    public static final double ZERO_EPS = 1e-4;\n+    public static final double REACTANCE_EPS = 0.05;\n+\n+    private UcteValidation() {\n+    }\n+\n+    // Data: line characteristics\n+    public static void checkValidLineCharacteristics(UcteLine line) {\n+        switch (line.getStatus()) {\n+            case EQUIVALENT_ELEMENT_IN_OPERATION:\n+            case EQUIVALENT_ELEMENT_OUT_OF_OPERATION:\n+            case REAL_ELEMENT_IN_OPERATION:\n+            case REAL_ELEMENT_OUT_OF_OPERATION:\n+                if (line.getResistance() < ZERO_EPS) {\n+                    LOGGER.error(\"Real line resistance cannot be negative\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero. For lines this value must be larger than 0.05 ohm\");\n+                }\n+                break;\n+            case BUSBAR_COUPLER_IN_OPERATION:\n+            case BUSBAR_COUPLER_OUT_OF_OPERATION:\n+                if (Math.abs(line.getResistance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler resistance must be zero\");\n+                }\n+                if (Math.abs(line.getReactance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler reactance must be zero\");\n+                }\n+                if (Math.abs(line.getSusceptance()) > ZERO_EPS) {\n+                    LOGGER.warn(\"Busbar coupler susceptance must be zero\");\n+                }\n+            default:\n+        }\n+    }\n+\n+    // Data: transformer characteristics\n+    public static void checkValidTransformerCharacteristics(UcteTransformer ucteTransformer) {\n+        if (ucteTransformer.getNominalPower() > ZERO_EPS) {\n+            LOGGER.error(\"Value must be positive, blank and zero is not allowed\");\n+        }\n+        if (ucteTransformer.getResistance() > ZERO_EPS) {\n+            LOGGER.error(\"Blank is not allowed, real transformer resistance must be greater than or equal to zero\");\n+        }\n+        if (ucteTransformer.getReactance() > REACTANCE_EPS) {\n+            LOGGER.error(\"Blank is not allowed, absolute value of reactance must be greater than 0.05 ohm\");\n+        }\n+        if (ucteTransformer.getSusceptance() > ZERO_EPS) {\n+            LOGGER.warn(\"Blank is not allowed\");\n+        }\n+        if (ucteTransformer.getConductance() > ZERO_EPS) {\n+            LOGGER.warn(\"Transformer shunt conductance must be greater than or equal to zero\");\n+        }\n+    }\n+\n+    // Data: transformer regulation\n+    // Phase regulation\n+    public static void checkPhaseRegulation(UctePhaseRegulation uctePhaseRegulation) {\n+        if (uctePhaseRegulation.getDu() < ZERO_EPS || uctePhaseRegulation.getDu() > 6) {\n+            LOGGER.warn(\"For LTCs, transformer phase regulation voltage per tap should not be zero. Its absolute value should not be above 6 %\");\n+        }\n+        if (uctePhaseRegulation.getN() < ZERO_EPS || uctePhaseRegulation.getDu() > 35) {\n+            LOGGER.warn(\"The number of phase regulating taps cannot be negative and cannot exceed 35\");\n+        }\n+    }\n+\n+    // Angle regulation\n+    public static void checkAngleRegulation(UcteAngleRegulation ucteAngleRegulation) {\n+        if (ucteAngleRegulation.getDu() < ZERO_EPS || ucteAngleRegulation.getDu() > 6) {\n+            LOGGER.warn(\"For LTCs, transformer phase regulation voltage per tap should not be zero. Its absolute value should not be above 6 %\");\n+        }\n+        if (ucteAngleRegulation.getN() < ZERO_EPS || ucteAngleRegulation.getDu() > 35) {\n+            LOGGER.warn(\"The value cannot be negative and cannot exceed 35\");\n+        }\n+        if (Math.abs(ucteAngleRegulation.getTheta()) > 180) {\n+            LOGGER.warn(\"The absolute value of the angle cannot exceed 180\u00b0\");\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9039c277cfaf2087bf4771b40706159a42acaa21"}, "originalPosition": 95}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "319b6afcddcdbb61f37ac61c0cfcaa128c709e2b", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/319b6afcddcdbb61f37ac61c0cfcaa128c709e2b", "committedDate": "2020-12-17T09:04:10Z", "message": "Add the UcteLogger utility class\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aeb6355a6f5d2cdfc5e28243d947f411ec1631e3", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/aeb6355a6f5d2cdfc5e28243d947f411ec1631e3", "committedDate": "2020-12-17T16:13:57Z", "message": "Fixes after review.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c0572708ec26b0b98d3b997cb4d162fc4a6d171", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/4c0572708ec26b0b98d3b997cb4d162fc4a6d171", "committedDate": "2020-12-17T16:40:52Z", "message": "Add a check on order code.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63843895155be732c4d77d2a536be5ca26a06ff7", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/63843895155be732c4d77d2a536be5ca26a06ff7", "committedDate": "2020-12-17T17:13:44Z", "message": "Add unit test.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26412206feb7781893e20957947f54c2e4ac8e06", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/26412206feb7781893e20957947f54c2e4ac8e06", "committedDate": "2020-12-17T17:51:41Z", "message": "Merge.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b3699b23aeebfd8afa3275bc9e45a4347ac4021", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/5b3699b23aeebfd8afa3275bc9e45a4347ac4021", "committedDate": "2020-12-17T18:45:45Z", "message": "Fix code smells.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4107efa009093c8709ddd3383be72afee77694e7", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/4107efa009093c8709ddd3383be72afee77694e7", "committedDate": "2021-01-04T16:41:41Z", "message": "Merge branch 'master' into quality-ucte"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "011160fec45ada12efd0ee07b77d7adac0237310", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/011160fec45ada12efd0ee07b77d7adac0237310", "committedDate": "2021-01-04T16:58:52Z", "message": "Remove check on bus voltage.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/841893bca1f2284a873a847e504736fd89c97bc2", "committedDate": "2021-01-05T16:34:01Z", "message": "Remove totally checks done on IIDM model.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY4MTY3Njgx", "url": "https://github.com/powsybl/powsybl-core/pull/1567#pullrequestreview-568167681", "createdAt": "2021-01-14T12:00:16Z", "commit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNFQxMjowMDoxNlrOIThm9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNFQxMjowMjozNVrOIThr9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM0NDUwMQ==", "bodyText": "include minus sign here (and use directly generatorP as targetP", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r557344501", "createdAt": "2021-01-14T12:00:16Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -233,6 +233,15 @@ private static void createGenerator(UcteNode ucteNode, VoltageLevel voltageLevel\n             }\n         }\n \n+        float generatorP = 0;\n+        if (isValueValid(ucteNode.getActivePowerGeneration())) {\n+            generatorP = ucteNode.getActivePowerGeneration();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM0NDYyNg==", "bodyText": "include minus sign here (and use directly generatorQ as targetQ", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r557344626", "createdAt": "2021-01-14T12:00:30Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -233,6 +233,15 @@ private static void createGenerator(UcteNode ucteNode, VoltageLevel voltageLevel\n             }\n         }\n \n+        float generatorP = 0;\n+        if (isValueValid(ucteNode.getActivePowerGeneration())) {\n+            generatorP = ucteNode.getActivePowerGeneration();\n+        }\n+        float generatorQ = 0;\n+        if (isValueValid(ucteNode.getReactivePowerGeneration())) {\n+            generatorQ = ucteNode.getReactivePowerGeneration();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM0NTEwNg==", "bodyText": "add \"ohm in pattern, not in variable:\nLOGGER.info(\"Create coupler '{}' from low impedance line ({} ohm)\", ucteLine.getId(), z);", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r557345106", "createdAt": "2021-01-14T12:01:18Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -341,7 +350,7 @@ private static void createCouplerFromLowImpedanceLine(Network network, UcteLine\n                                                           UcteNodeCode nodeCode1, UcteNodeCode nodeCode2,\n                                                           UcteVoltageLevel ucteVoltageLevel1, UcteVoltageLevel ucteVoltageLevel2,\n                                                           boolean connected, double z) {\n-        LOGGER.info(\"Create coupler '{}' from low impedance line ({})\", ucteLine.getId(), z);\n+        LOGGER.info(\"Create coupler '{}' from low impedance line ({})\", ucteLine.getId(), z + \" ohm\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM0NTYxMw==", "bodyText": "invalid instead of unvalid", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r557345613", "createdAt": "2021-01-14T12:02:17Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/test/java/com/powsybl/ucte/converter/UcteExporterTest.java", "diffHunk": "@@ -173,4 +173,24 @@ public void testXnodeTransformer() throws IOException {\n         testExporter(network, \"/xNodeTransformer.uct\");\n     }\n \n+    @Test\n+    public void testValidationUtil() throws IOException {\n+        Network network = loadNetworkFromResourceFile(\"/expectedExport.uct\");\n+        for (Bus bus : network.getBusView().getBuses()) {\n+            bus.setV(bus.getVoltageLevel().getNominalV() * 1.4);\n+        }\n+        for (Generator gen : network.getGenerators()) {\n+            if (gen.isVoltageRegulatorOn()) {\n+                gen.setTargetV(gen.getRegulatingTerminal().getVoltageLevel().getNominalV() * 1.4);\n+            }\n+        }\n+        for (TwoWindingsTransformer twt : network.getTwoWindingsTransformers()) {\n+            RatioTapChanger rtc = twt.getRatioTapChanger();\n+            if (rtc != null && rtc.isRegulating()) {\n+                rtc.setTargetV(rtc.getRegulationTerminal().getVoltageLevel().getNominalV() * 1.4);\n+            }\n+        }\n+        testExporter(network, \"/unvalidVoltageReference.uct\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM0NTcyMw==", "bodyText": "invalid instead of unvalid", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r557345723", "createdAt": "2021-01-14T12:02:30Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/test/java/com/powsybl/ucte/converter/UcteImporterTest.java", "diffHunk": "@@ -183,5 +183,17 @@ public void testXnodeTransformer() {\n         Network network = new UcteImporter().importData(dataSource, null);\n         assertEquals(2, network.getBusBreakerView().getBusStream().count());\n     }\n+\n+    @Test\n+    public void testUnvalidRegulation() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM0NTc4Mw==", "bodyText": "invalid instead of unvalid", "url": "https://github.com/powsybl/powsybl-core/pull/1567#discussion_r557345783", "createdAt": "2021-01-14T12:02:35Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/test/java/com/powsybl/ucte/converter/UcteImporterTest.java", "diffHunk": "@@ -183,5 +183,17 @@ public void testXnodeTransformer() {\n         Network network = new UcteImporter().importData(dataSource, null);\n         assertEquals(2, network.getBusBreakerView().getBusStream().count());\n     }\n+\n+    @Test\n+    public void testUnvalidRegulation() {\n+        ResourceDataSource dataSource = new ResourceDataSource(\"unvalidRegulationNetwork\", new ResourceSet(\"/\", \"unvalidRegulationNetwork.uct\"));\n+        Network network = new UcteImporter().importData(dataSource, null);\n+    }\n+\n+    @Test\n+    public void testUnvalidVoltageReference() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "841893bca1f2284a873a847e504736fd89c97bc2"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6fba189dc25f7105b6ef89edebb86bb1db370e", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/1e6fba189dc25f7105b6ef89edebb86bb1db370e", "committedDate": "2021-01-14T13:34:33Z", "message": "Fix after review.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f61151d269e671e383db6267a22ee8647b1051c3", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/f61151d269e671e383db6267a22ee8647b1051c3", "committedDate": "2021-01-20T08:27:40Z", "message": "Merge.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d377174b86a069d5edf55ca5ece7820fffe22c74", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/d377174b86a069d5edf55ca5ece7820fffe22c74", "committedDate": "2021-01-20T09:00:26Z", "message": "Fixes after review.\n\nSigned-off-by: Anne Tilloy <anne.tilloy@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ba0af0da5f715953b0fd459695119ad17a59cec", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/3ba0af0da5f715953b0fd459695119ad17a59cec", "committedDate": "2021-01-20T09:15:44Z", "message": "Reviewer's comment: hide the checks in fix() method\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcyMDI4NzI3", "url": "https://github.com/powsybl/powsybl-core/pull/1567#pullrequestreview-572028727", "createdAt": "2021-01-20T09:31:10Z", "commit": {"oid": "3ba0af0da5f715953b0fd459695119ad17a59cec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4090, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}