{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MDMxMzg2", "number": 1500, "title": "CGMES conversion performance improvement: avoid duplicated queries", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nA performance improvement in the CGMES conversion\nWhat is the current behavior? (You can also link to an open issue here)\nQueries that obtain terminals and nodes from the triplestore are run twice during the conversion process. For terminals, the results were already available in the CGMES model.\nWhat is the new behavior (if this is a feature change)?\nConnectivity and Topological nodes have been cached explicitly in separate collections. Cached (computed) terminals are used from the CGMES model instead of re-querying the triplestore.\nOther information:\nWall time measurement for CGMES conversion unit tests has improved by 6%. Wall time measurement for a set of real-world test cases (load and convert to IIDM) has improved by 14%.", "createdAt": "2020-10-02T17:08:36Z", "url": "https://github.com/powsybl/powsybl-core/pull/1500", "merged": true, "mergeCommit": {"oid": "6eeb3715af0eb679f12866a89aeef1d4b96b0980"}, "closed": true, "closedAt": "2020-10-27T09:00:03Z", "author": {"login": "zamarrenolm"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOjFO1AH2gAyNDk3MDMxMzg2OmVlZjFhMzdjNTBhOWMwZmJhY2NhMjQxMmExMWE1NDZmMDYzNzc4YjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWlDAAAFqTUxNzQ2ODIwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eef1a37c50a9c0fbacca2412a11a546f063778b1", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/eef1a37c50a9c0fbacca2412a11a546f063778b1", "committedDate": "2020-10-02T10:04:34Z", "message": "used cached terminals and nodes instead of re-running the queries against triplestore\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bed42459c36dc177f0f30cd31edc3128e2b47c10", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/bed42459c36dc177f0f30cd31edc3128e2b47c10", "committedDate": "2020-10-08T10:39:19Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ead62f96c61ec76436dfed70b45884ca9f516a7", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/7ead62f96c61ec76436dfed70b45884ca9f516a7", "committedDate": "2020-10-08T13:45:20Z", "message": "fix code smell (protected constructor for abstract class)\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbf83241c2d38b99d4c04a83c8455a60b953333e", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/bbf83241c2d38b99d4c04a83c8455a60b953333e", "committedDate": "2020-10-08T13:45:34Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6656a0278ac325cc426370450d6f5fb4e3c2be73", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/6656a0278ac325cc426370450d6f5fb4e3c2be73", "committedDate": "2020-10-09T06:32:52Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b341e1fcc220c30be5ebb7ea78fa539a8a2caec", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/7b341e1fcc220c30be5ebb7ea78fa539a8a2caec", "committedDate": "2020-10-13T09:54:56Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09ce15d3989c5546ae7cdfe4f013ad6de27b5af6", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/09ce15d3989c5546ae7cdfe4f013ad6de27b5af6", "committedDate": "2020-10-15T10:10:22Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42c738df5c0f64c4949b38ac3ee10117a0bc84b4", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/42c738df5c0f64c4949b38ac3ee10117a0bc84b4", "committedDate": "2020-10-15T13:22:56Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d10e0c3dfdc287cccfa066ba340009d823c0499", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/3d10e0c3dfdc287cccfa066ba340009d823c0499", "committedDate": "2020-10-15T15:52:16Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55ca5c75c596817d0c78cfb01facef7f4059a670", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/55ca5c75c596817d0c78cfb01facef7f4059a670", "committedDate": "2020-10-16T13:27:32Z", "message": "convert zero impedance lines inside a voltage level to fictitious switches\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69bf0ba9c2450249bd0f7ea48e85b5533ea55cab", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/69bf0ba9c2450249bd0f7ea48e85b5533ea55cab", "committedDate": "2020-10-19T07:28:20Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNzUwNjI0", "url": "https://github.com/powsybl/powsybl-core/pull/1500#pullrequestreview-511750624", "createdAt": "2020-10-19T13:19:35Z", "commit": {"oid": "69bf0ba9c2450249bd0f7ea48e85b5533ea55cab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMzoxOTozNVrOHkN5wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMzoxOTozNVrOHkN5wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzczODU2MA==", "bodyText": "Thanks @zamarrenolm, it works well with a conversion into a switch when wa are inside the same voltage level. But I wonder if we should prefer an internal connexion to a swicth. The next step could be to make our internal connexion identifiable. @mathbagu seems to prefer an internal connection to preserve graph analysis.", "url": "https://github.com/powsybl/powsybl-core/pull/1500#discussion_r507738560", "createdAt": "2020-10-19T13:19:35Z", "author": {"login": "annetill"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/ACLineSegmentConversion.java", "diffHunk": "@@ -71,19 +69,46 @@ private void convertLine() {\n         double x = p.asDouble(\"x\");\n         double bch = p.asDouble(\"bch\");\n         double gch = p.asDouble(\"gch\", 0.0);\n-        final LineAdder adder = context.network().newLine()\n-                .setEnsureIdUnicity(false)\n-                .setR(r)\n-                .setX(x)\n-                .setG1(gch / 2)\n-                .setG2(gch / 2)\n-                .setB1(bch / 2)\n-                .setB2(bch / 2);\n-        identify(adder);\n-        connect(adder);\n-        final Line l = adder.add();\n-        addAliases(l);\n-        convertedTerminals(l.getTerminal1(), l.getTerminal2());\n+        if (isZeroImpedanceInsideVoltageLevel(r, x, bch, gch)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69bf0ba9c2450249bd0f7ea48e85b5533ea55cab"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NjQxMDQ2", "url": "https://github.com/powsybl/powsybl-core/pull/1500#pullrequestreview-515641046", "createdAt": "2020-10-23T12:58:02Z", "commit": {"oid": "69bf0ba9c2450249bd0f7ea48e85b5533ea55cab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "687bd6a99d2cf20221a79c8baa76b43da4bed220", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/687bd6a99d2cf20221a79c8baa76b43da4bed220", "committedDate": "2020-10-26T17:39:45Z", "message": "add unit test\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59a048150fb8b92114118c5cbeea118d83c88f76", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/59a048150fb8b92114118c5cbeea118d83c88f76", "committedDate": "2020-10-27T06:26:46Z", "message": "Merge branch 'master' into cgmes_use_cached_nodes_terminals"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NDU5NzAw", "url": "https://github.com/powsybl/powsybl-core/pull/1500#pullrequestreview-517459700", "createdAt": "2020-10-27T08:43:03Z", "commit": {"oid": "59a048150fb8b92114118c5cbeea118d83c88f76"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NDY4MjAy", "url": "https://github.com/powsybl/powsybl-core/pull/1500#pullrequestreview-517468202", "createdAt": "2020-10-27T08:53:20Z", "commit": {"oid": "59a048150fb8b92114118c5cbeea118d83c88f76"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4046, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}