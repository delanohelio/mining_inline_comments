{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNzA5MzUz", "number": 1319, "reviewThreads": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNzo1NzoxNVrOD_-gtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTo1OToyMVrOEPMkfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDExMDYzOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNzo1NzoxNVrOGa9sKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwNzo1NzoxNVrOGa9sKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyNjg5MQ==", "bodyText": "@MioRtia do you confirm that we decided recently (2 or 3 weeks ago) to change the strategy for the default implementation of new methods to throw less exceptions?\nIf it's the case I propose:\n\ngetAliases -> return an empty set\naddAlias -> silently ignore\nremoveAlias -> silently ignore\nhasAliases -> return false", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430926891", "createdAt": "2020-05-27T07:57:15Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -41,6 +38,35 @@ default String getName() {\n         return getNameOrId();\n     }\n \n+    /**\n+     * Get the aliases of the object.\n+     */\n+    default Set<String> getAliases() {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+    /**\n+     * Add an alias to the object. Aliases must be unique in associated Network, and different\n+     * from any identifiable ID.\n+     */\n+    default void addAlias(String alias) {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+    /**\n+     * Remove an alias of the object.\n+     */\n+    default void removeAlias(String alias) {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+    /**\n+     * Return true if identifiable has aliases.\n+     */\n+    default boolean hasAliases() {\n+        throw new UnsupportedOperationException();\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDEyMDY1OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Network.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODowMDowMlrOGa9yog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwOTowOTowOVrOGbAWbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyODU0Ng==", "bodyText": "Do we really need this method: what is the risk to change the behavior of the getIdentifiable(String id) if we consider aliases like unique IDs. At the end, all the user code would use this new method, don't they?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430928546", "createdAt": "2020-05-27T08:00:02Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Network.java", "diffHunk": "@@ -661,12 +661,22 @@ default HvdcLine getHvdcLine(HvdcConverterStation converterStation) {\n     HvdcLineAdder newHvdcLine();\n \n     /**\n-     * Get a equipment.\n+     * Get an equipment by its ID.\n      *\n      * @param id the id of the equipment\n      */\n     Identifiable<?> getIdentifiable(String id);\n \n+    /**\n+     * Get an equipment by its ID or eventually an alias.\n+     *\n+     * @param idOrAlias the id or an alias of the equipment\n+     * @param searchInAlias if true then searches in the alias and the IDs. If false, searches only by ID.\n+     */\n+    default Identifiable<?> getIdentifiable(String idOrAlias, boolean searchInAlias) {\n+        throw new UnsupportedOperationException();\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk0OTEyMA==", "bodyText": "I do not know if it may be interesting to search objects by ID uniquely.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430949120", "createdAt": "2020-05-27T08:35:07Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Network.java", "diffHunk": "@@ -661,12 +661,22 @@ default HvdcLine getHvdcLine(HvdcConverterStation converterStation) {\n     HvdcLineAdder newHvdcLine();\n \n     /**\n-     * Get a equipment.\n+     * Get an equipment by its ID.\n      *\n      * @param id the id of the equipment\n      */\n     Identifiable<?> getIdentifiable(String id);\n \n+    /**\n+     * Get an equipment by its ID or eventually an alias.\n+     *\n+     * @param idOrAlias the id or an alias of the equipment\n+     * @param searchInAlias if true then searches in the alias and the IDs. If false, searches only by ID.\n+     */\n+    default Identifiable<?> getIdentifiable(String idOrAlias, boolean searchInAlias) {\n+        throw new UnsupportedOperationException();\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyODU0Ng=="}, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3MDQ3Ng==", "bodyText": "As searching also with alias could impact performance, it might be interesting to keep the possibility to only seach with primary id", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430970476", "createdAt": "2020-05-27T09:09:09Z", "author": {"login": "geofjamg"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Network.java", "diffHunk": "@@ -661,12 +661,22 @@ default HvdcLine getHvdcLine(HvdcConverterStation converterStation) {\n     HvdcLineAdder newHvdcLine();\n \n     /**\n-     * Get a equipment.\n+     * Get an equipment by its ID.\n      *\n      * @param id the id of the equipment\n      */\n     Identifiable<?> getIdentifiable(String id);\n \n+    /**\n+     * Get an equipment by its ID or eventually an alias.\n+     *\n+     * @param idOrAlias the id or an alias of the equipment\n+     * @param searchInAlias if true then searches in the alias and the IDs. If false, searches only by ID.\n+     */\n+    default Identifiable<?> getIdentifiable(String idOrAlias, boolean searchInAlias) {\n+        throw new UnsupportedOperationException();\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyODU0Ng=="}, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDEyODQzOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODowMjoyOFrOGa93zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMTowMDozOVrOGbELcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyOTg3MA==", "bodyText": "From my point of view, we should automatically add the ids of the half line when a TieLine is created, not only in the merge function. Is there a risk to do it automatically in the add() method of the TieLineAdder?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430929870", "createdAt": "2020-05-27T08:02:28Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "diffHunk": "@@ -1101,13 +1111,15 @@ private void replaceDanglingLineByLine(List<MergedLine> lines, Multimap<Boundary\n             l.getTerminal1().setP(mergedLine.p1).setQ(mergedLine.q1);\n             l.getTerminal2().setP(mergedLine.p2).setQ(mergedLine.q2);\n             mergedLine.properties.forEach((key, val) -> l.setProperty(key.toString(), val.toString()));\n+            mergedLine.aliases.forEach(l::addAlias);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzMzIwMg==", "bodyText": "Actually, the TieLineAdder does not have access to the aliases of the half lines, only the IDs. So a dedicated line for merging aliases is still needed.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r431033202", "createdAt": "2020-05-27T11:00:39Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "diffHunk": "@@ -1101,13 +1111,15 @@ private void replaceDanglingLineByLine(List<MergedLine> lines, Multimap<Boundary\n             l.getTerminal1().setP(mergedLine.p1).setQ(mergedLine.q1);\n             l.getTerminal2().setP(mergedLine.p2).setQ(mergedLine.q2);\n             mergedLine.properties.forEach((key, val) -> l.setProperty(key.toString(), val.toString()));\n+            mergedLine.aliases.forEach(l::addAlias);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkyOTg3MA=="}, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDE0NDYxOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODowNzoyMVrOGa-CWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODowNzoyMVrOGa-CWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzMjU3MA==", "bodyText": "You should test if the object that already exists in the map is not the same than the obj argument, and silently ignore it. You could be possible to write something like this:\naddAlias(obj, \"alias\"); // works because \"alias\" is not used\naddAlias(obj, \"alias\"); // works because \"alias\" is already an alias of obj\naddAlias(obj2, \"alias\"); // fails because \"alias\" is already an alias of obj, and obj != obj2", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430932570", "createdAt": "2020-05-27T08:07:21Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "diffHunk": "@@ -50,14 +53,53 @@ void checkAndAdd(Identifiable<?> obj) {\n         all.add(obj);\n     }\n \n+    void addAlias(Identifiable<?> obj, String alias) {\n+        if (objectsById.containsKey(alias)) {\n+            Identifiable<?> aliasConflict = objectsById.get(alias);\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        } else if (idByAlias.containsKey(alias)) {\n+            Identifiable<?> aliasConflict = objectsById.get(idByAlias.get(alias));\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        }\n+        idByAlias.put(alias, obj.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDE1MjI2OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AliasesXml.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODowOToyOVrOGa-HMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODowOToyOVrOGa-HMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzMzgxMA==", "bodyText": "Remove this test: a for loop on an empty list is OK", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430933810", "createdAt": "2020-05-27T08:09:29Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/AliasesXml.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.xml;\n+\n+import com.powsybl.iidm.network.Identifiable;\n+\n+import javax.xml.stream.XMLStreamException;\n+\n+/**\n+ * @author Sebastien Murgey <sebastien.murgey at rte-france.com>\n+ */\n+public final class AliasesXml {\n+\n+    static final String ALIAS = \"alias\";\n+\n+    public static void write(Identifiable<?> identifiable, NetworkXmlWriterContext context) throws XMLStreamException {\n+        if (identifiable.hasAliases()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDE1ODExOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/java/com/powsybl/iidm/xml/TieLineWithAliasesXmlTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODoxMTowOVrOGa-K7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODoxMTowOVrOGa-K7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzNDc2NQ==", "bodyText": "Impostor! \ud83e\udd23", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430934765", "createdAt": "2020-05-27T08:11:09Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/java/com/powsybl/iidm/xml/TieLineWithAliasesXmlTest.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright (c) 2019, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.iidm.xml;\n+\n+import org.junit.Test;\n+\n+import java.io.IOException;\n+\n+/**\n+ * @author Mathieu Bague <mathieu.bague@rte-france.com>\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NDE2NTUzOnYy", "diffSide": "RIGHT", "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwODoxMzoyMFrOGa-PtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODowMTozM1rOGbp95g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzNTk4OQ==", "bodyText": "Is really what you want? Maybe the elementName should be an alias, maybe \"VL1 VL2 order\" should be another one.\nMaybe it could be nice to create a function for that", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r430935989", "createdAt": "2020-05-27T08:13:20Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -258,6 +258,9 @@ private static void createDanglingLine(UcteLine ucteLine, boolean connected,\n                 .setQ0(q0)\n                 .setUcteXnodeCode(xnode.getCode().toString())\n                 .add();\n+        if (ucteLine.getElementName() != null && !ucteLine.getElementName().isEmpty()) {\n+            dl.addAlias(String.format(\"%s %s %s\", ucteLine.getId().getNodeCode1().toString(), ucteLine.getId().getNodeCode2().toString(), ucteLine.getElementName()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA1MTA1MQ==", "bodyText": "As \"node1/node1/order\" is already the id, no need of it as an alias.\nThe element name cannot be an alias itself, cause TSOs usually use it as a kind of order code (you can have same element name for different lines)", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r431051051", "createdAt": "2020-05-27T11:37:35Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -258,6 +258,9 @@ private static void createDanglingLine(UcteLine ucteLine, boolean connected,\n                 .setQ0(q0)\n                 .setUcteXnodeCode(xnode.getCode().toString())\n                 .add();\n+        if (ucteLine.getElementName() != null && !ucteLine.getElementName().isEmpty()) {\n+            dl.addAlias(String.format(\"%s %s %s\", ucteLine.getId().getNodeCode1().toString(), ucteLine.getId().getNodeCode2().toString(), ucteLine.getElementName()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzNTk4OQ=="}, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY0NDcwMw==", "bodyText": "I know, it is the reason why I suggest \"VL1 VL2 co\" to complement the \"node1 node2 co\". If I remember, that was a way to reference equipments in UCTE process. Maybe it's not the case anymore.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r431644703", "createdAt": "2020-05-28T07:47:31Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -258,6 +258,9 @@ private static void createDanglingLine(UcteLine ucteLine, boolean connected,\n                 .setQ0(q0)\n                 .setUcteXnodeCode(xnode.getCode().toString())\n                 .add();\n+        if (ucteLine.getElementName() != null && !ucteLine.getElementName().isEmpty()) {\n+            dl.addAlias(String.format(\"%s %s %s\", ucteLine.getId().getNodeCode1().toString(), ucteLine.getId().getNodeCode2().toString(), ucteLine.getElementName()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzNTk4OQ=="}, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY1MjMyNg==", "bodyText": "Good remark, it's true that sometimes the node code is replaced by * in the input.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r431652326", "createdAt": "2020-05-28T08:01:33Z", "author": {"login": "murgeyseb"}, "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -258,6 +258,9 @@ private static void createDanglingLine(UcteLine ucteLine, boolean connected,\n                 .setQ0(q0)\n                 .setUcteXnodeCode(xnode.getCode().toString())\n                 .add();\n+        if (ucteLine.getElementName() != null && !ucteLine.getElementName().isEmpty()) {\n+            dl.addAlias(String.format(\"%s %s %s\", ucteLine.getId().getNodeCode1().toString(), ucteLine.getId().getNodeCode2().toString(), ucteLine.getElementName()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkzNTk4OQ=="}, "originalCommit": {"oid": "2b49777ba791b911e76d984078a3094c523f9134"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjU4NDEwOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Network.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjowMjo1NVrOGtUamw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjowMjo1NVrOGtUamw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE3MzU5NQ==", "bodyText": "There is a small typo here\n\nor ana alias", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450173595", "createdAt": "2020-07-06T12:02:55Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Network.java", "diffHunk": "@@ -261,7 +261,7 @@ static PrettyNetworkFactory with(String name) {\n     /**\n      * Get a substation voltage level.\n      *\n-     * @param id the id of the substation voltage level\n+     * @param id the id or ana alias of the substation voltage level", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjU4Njc3OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjowMzo1MlrOGtUcTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwNzozMToyMVrOGtyZmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE3NDAyOA==", "bodyText": "Is there a reason why you choose a TreeSet instead of a HashSet. Does the order important for you? Maybe for the XML round trip?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450174028", "createdAt": "2020-07-06T12:03:52Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -24,6 +24,8 @@\n \n     protected boolean fictitious = false;\n \n+    protected Set<String> aliases = new TreeSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY2NDg1OA==", "bodyText": "I do not remember if it was for ensuring that roundtrip test work... Usually, I would sa that order is not important but it may be nice to keep aliases sorted, as you said for consistency in XML I/O. However, it may not impact a lot the performances as there is no reason, in current use case, that an Identifiable would have thousands of aliases...", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450664858", "createdAt": "2020-07-07T07:31:21Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -24,6 +24,8 @@\n \n     protected boolean fictitious = false;\n \n+    protected Set<String> aliases = new TreeSet<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE3NDAyOA=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjcwOTU1OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0MTo0MVrOGtVmfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwODowOTo0MFrOGvuD1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5MzAyMQ==", "bodyText": "Should we change the mergeability check to consider also aliases?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450193021", "createdAt": "2020-07-06T12:41:41Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "diffHunk": "@@ -966,6 +966,11 @@ private void mergeDanglingLines(List<MergedLine> lines, DanglingLine dl1, Dangli\n         if (dl1 != null) {\n             MergedLine l = new MergedLine();\n             l.id = dl1.getId().compareTo(dl2.getId()) < 0 ? dl1.getId() + \" + \" + dl2.getId() : dl2.getId() + \" + \" + dl1.getId();\n+            l.aliases = new HashSet<>();\n+            l.aliases.add(dl1.getId());\n+            l.aliases.add(dl2.getId());\n+            l.aliases.addAll(dl1.getAliases());\n+            l.aliases.addAll(dl2.getAliases());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY2NzI4NA==", "bodyText": "Should we enforce consistency (no duplicate aliases) or remove them in case of conflict during merging ?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450667284", "createdAt": "2020-07-07T07:36:14Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "diffHunk": "@@ -966,6 +966,11 @@ private void mergeDanglingLines(List<MergedLine> lines, DanglingLine dl1, Dangli\n         if (dl1 != null) {\n             MergedLine l = new MergedLine();\n             l.id = dl1.getId().compareTo(dl2.getId()) < 0 ? dl1.getId() + \" + \" + dl2.getId() : dl2.getId() + \" + \" + dl1.getId();\n+            l.aliases = new HashSet<>();\n+            l.aliases.add(dl1.getId());\n+            l.aliases.add(dl2.getId());\n+            l.aliases.addAll(dl1.getAliases());\n+            l.aliases.addAll(dl2.getAliases());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5MzAyMQ=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY5MDkwMw==", "bodyText": "What is the current behavior if you try to add an existing alias to another identifiable? If I remember well, an exception is thrown. So I think we should consider the network are not mergeable, specially if we consider alias as a kind of identifier.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r452690903", "createdAt": "2020-07-10T08:09:40Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkImpl.java", "diffHunk": "@@ -966,6 +966,11 @@ private void mergeDanglingLines(List<MergedLine> lines, DanglingLine dl1, Dangli\n         if (dl1 != null) {\n             MergedLine l = new MergedLine();\n             l.id = dl1.getId().compareTo(dl2.getId()) < 0 ? dl1.getId() + \" + \" + dl2.getId() : dl2.getId() + \" + \" + dl1.getId();\n+            l.aliases = new HashSet<>();\n+            l.aliases.add(dl1.getId());\n+            l.aliases.add(dl2.getId());\n+            l.aliases.addAll(dl1.getAliases());\n+            l.aliases.addAll(dl2.getAliases());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5MzAyMQ=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjcxOTE4OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0NDozNFrOGtVsWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0NDozNFrOGtVsWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NDUyMQ==", "bodyText": "It's not efficient: you search for the object 3 times. If the map is huge, it could lead to bad performance issue.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450194521", "createdAt": "2020-07-06T12:44:34Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "diffHunk": "@@ -50,14 +53,54 @@ void checkAndAdd(Identifiable<?> obj) {\n         all.add(obj);\n     }\n \n-    Identifiable get(String id) {\n+    boolean addAlias(Identifiable<?> obj, String alias) {\n+        if (objectsById.containsKey(alias)) {\n+            if (objectsById.get(alias).equals(obj)) {\n+                // Silently ignore affecting the objects id to its own aliases\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(alias);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjcyMDM3OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0NDo1NVrOGtVtDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0NDo1NVrOGtVtDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NDcwMA==", "bodyText": "Same kind of remark there", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450194700", "createdAt": "2020-07-06T12:44:55Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "diffHunk": "@@ -50,14 +53,54 @@ void checkAndAdd(Identifiable<?> obj) {\n         all.add(obj);\n     }\n \n-    Identifiable get(String id) {\n+    boolean addAlias(Identifiable<?> obj, String alias) {\n+        if (objectsById.containsKey(alias)) {\n+            if (objectsById.get(alias).equals(obj)) {\n+                // Silently ignore affecting the objects id to its own aliases\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(alias);\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        } else if (idByAlias.containsKey(alias)) {\n+            if (objectsById.get(idByAlias.get(alias)).equals(obj)) {\n+                // Silently ignore affecting the same alias twice to an object\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(idByAlias.get(alias));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjcyNTk5OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0NjozM1rOGtVwgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0NjozM1rOGtVwgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NTU4NA==", "bodyText": "Performance: you are searching for the same object multiple times.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450195584", "createdAt": "2020-07-06T12:46:33Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "diffHunk": "@@ -50,14 +53,54 @@ void checkAndAdd(Identifiable<?> obj) {\n         all.add(obj);\n     }\n \n-    Identifiable get(String id) {\n+    boolean addAlias(Identifiable<?> obj, String alias) {\n+        if (objectsById.containsKey(alias)) {\n+            if (objectsById.get(alias).equals(obj)) {\n+                // Silently ignore affecting the objects id to its own aliases\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(alias);\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        } else if (idByAlias.containsKey(alias)) {\n+            if (objectsById.get(idByAlias.get(alias)).equals(obj)) {\n+                // Silently ignore affecting the same alias twice to an object\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(idByAlias.get(alias));\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        }\n+        idByAlias.put(alias, obj.getId());\n+        return true;\n+    }\n+\n+    public <I extends Identifiable<I>> void removeAlias(Identifiable<?> obj, String alias) {\n+        if (!idByAlias.containsKey(alias)) {\n+            throw new PowsyblException(String.format(\"No alias '%s' found in the network\", alias));\n+        } else if (!idByAlias.get(alias).equals(obj.getId())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjczMjUyOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0ODoxOVrOGtV0aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwNzo0MDowMFrOGtyq9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NjU4Nw==", "bodyText": "That means it's not possible to use the ID of an object as one of its alias. I know it doesn't make any sense, but if it's allowed by the code, does it work properly?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450196587", "createdAt": "2020-07-06T12:48:19Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "diffHunk": "@@ -50,14 +53,54 @@ void checkAndAdd(Identifiable<?> obj) {\n         all.add(obj);\n     }\n \n-    Identifiable get(String id) {\n+    boolean addAlias(Identifiable<?> obj, String alias) {\n+        if (objectsById.containsKey(alias)) {\n+            if (objectsById.get(alias).equals(obj)) {\n+                // Silently ignore affecting the objects id to its own aliases\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(alias);\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        } else if (idByAlias.containsKey(alias)) {\n+            if (objectsById.get(idByAlias.get(alias)).equals(obj)) {\n+                // Silently ignore affecting the same alias twice to an object\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(idByAlias.get(alias));\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        }\n+        idByAlias.put(alias, obj.getId());\n+        return true;\n+    }\n+\n+    public <I extends Identifiable<I>> void removeAlias(Identifiable<?> obj, String alias) {\n+        if (!idByAlias.containsKey(alias)) {\n+            throw new PowsyblException(String.format(\"No alias '%s' found in the network\", alias));\n+        } else if (!idByAlias.get(alias).equals(obj.getId())) {\n+            throw new PowsyblException(String.format(\"Alias '%s' do not correspond to object '%s'\", alias, obj.getId()));\n+        } else {\n+            idByAlias.remove(alias);\n+        }\n+    }\n+\n+    Identifiable get(String idOrAlias) {\n+        String id = idByAlias.getOrDefault(idOrAlias, idOrAlias);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY2OTMwMQ==", "bodyText": "In current implementation, ID is not in the alias list, but as it is the ID, it works to retrieve the object using the ID", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450669301", "createdAt": "2020-07-07T07:40:00Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/NetworkIndex.java", "diffHunk": "@@ -50,14 +53,54 @@ void checkAndAdd(Identifiable<?> obj) {\n         all.add(obj);\n     }\n \n-    Identifiable get(String id) {\n+    boolean addAlias(Identifiable<?> obj, String alias) {\n+        if (objectsById.containsKey(alias)) {\n+            if (objectsById.get(alias).equals(obj)) {\n+                // Silently ignore affecting the objects id to its own aliases\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(alias);\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        } else if (idByAlias.containsKey(alias)) {\n+            if (objectsById.get(idByAlias.get(alias)).equals(obj)) {\n+                // Silently ignore affecting the same alias twice to an object\n+                return false;\n+            }\n+            Identifiable<?> aliasConflict = objectsById.get(idByAlias.get(alias));\n+            String message = String.format(\"Object (%s) with alias '%s' cannot be created because alias already refers to object (%s) with ID '%s'\",\n+                    obj.getClass(),\n+                    alias,\n+                    aliasConflict.getClass(),\n+                    aliasConflict.getId());\n+            throw new PowsyblException(message);\n+        }\n+        idByAlias.put(alias, obj.getId());\n+        return true;\n+    }\n+\n+    public <I extends Identifiable<I>> void removeAlias(Identifiable<?> obj, String alias) {\n+        if (!idByAlias.containsKey(alias)) {\n+            throw new PowsyblException(String.format(\"No alias '%s' found in the network\", alias));\n+        } else if (!idByAlias.get(alias).equals(obj.getId())) {\n+            throw new PowsyblException(String.format(\"Alias '%s' do not correspond to object '%s'\", alias, obj.getId()));\n+        } else {\n+            idByAlias.remove(alias);\n+        }\n+    }\n+\n+    Identifiable get(String idOrAlias) {\n+        String id = idByAlias.getOrDefault(idOrAlias, idOrAlias);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NjU4Nw=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjczNjk5OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/test/java/com/powsybl/iidm/network/impl/AliasesTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo0OTozNFrOGtV3Dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwNzo0MjowN1rOGtyvHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NzI2Mg==", "bodyText": "Could you please add a test where you try to add as an alias the ID of an identifiable, and ensure you can get the object.", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450197262", "createdAt": "2020-07-06T12:49:34Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-impl/src/test/java/com/powsybl/iidm/network/impl/AliasesTest.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.commons.PowsyblException;\n+import com.powsybl.iidm.network.Generator;\n+import com.powsybl.iidm.network.Load;\n+import com.powsybl.iidm.network.Network;\n+import com.powsybl.iidm.network.test.NetworkTest1Factory;\n+import org.junit.Test;\n+\n+import static org.junit.Assert.*;\n+\n+/**\n+ * @author Sebastien Murgey <sebastien.murgey at rte-france.com>\n+ */\n+public class AliasesTest {\n+    @Test\n+    public void canAddAliases() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"Load alias\");\n+\n+        assertEquals(1, load.getAliases().size());\n+        assertTrue(load.getAliases().contains(\"Load alias\"));\n+        assertNotNull(network.getLoad(\"Load alias\"));\n+        assertEquals(network.getLoad(\"Load alias\"), load);\n+    }\n+\n+    @Test\n+    public void canRemoveAliases() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"Load alias\");\n+\n+        assertEquals(1, load.getAliases().size());\n+        assertTrue(load.getAliases().contains(\"Load alias\"));\n+\n+        load.removeAlias(\"Load alias\");\n+        assertTrue(load.getAliases().isEmpty());\n+    }\n+\n+    @Test\n+    public void silentlyIgnoreAffectingObjectsIdAsAlias() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+    }\n+\n+    @Test\n+    public void silentlyIgnoreAffectingTwiceSameIdToAnObject() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"Load alias\");\n+        load.addAlias(\"Load alias\");\n+\n+        assertEquals(1, load.getAliases().size());\n+        assertTrue(load.getAliases().contains(\"Load alias\"));\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void failWhenDuplicatedAlias() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        Generator generator = network.getGenerator(\"generator1\");\n+        load.addAlias(\"Alias\");\n+        generator.addAlias(\"Alias\");\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void failWhenAliasEqualToAnId() {\n+        Network network = NetworkTest1Factory.create();\n+        Generator generator = network.getGenerator(\"generator1\");\n+        generator.addAlias(\"load1\");\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void failWhenRemovingNonExistingAlias() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        load.removeAlias(\"Load alias\");\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY3MDM2NQ==", "bodyText": "The ID of the identifiable you are adding an alias to, or of another identifiable ?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450670365", "createdAt": "2020-07-07T07:42:07Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-impl/src/test/java/com/powsybl/iidm/network/impl/AliasesTest.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.iidm.network.impl;\n+\n+import com.powsybl.commons.PowsyblException;\n+import com.powsybl.iidm.network.Generator;\n+import com.powsybl.iidm.network.Load;\n+import com.powsybl.iidm.network.Network;\n+import com.powsybl.iidm.network.test.NetworkTest1Factory;\n+import org.junit.Test;\n+\n+import static org.junit.Assert.*;\n+\n+/**\n+ * @author Sebastien Murgey <sebastien.murgey at rte-france.com>\n+ */\n+public class AliasesTest {\n+    @Test\n+    public void canAddAliases() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"Load alias\");\n+\n+        assertEquals(1, load.getAliases().size());\n+        assertTrue(load.getAliases().contains(\"Load alias\"));\n+        assertNotNull(network.getLoad(\"Load alias\"));\n+        assertEquals(network.getLoad(\"Load alias\"), load);\n+    }\n+\n+    @Test\n+    public void canRemoveAliases() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"Load alias\");\n+\n+        assertEquals(1, load.getAliases().size());\n+        assertTrue(load.getAliases().contains(\"Load alias\"));\n+\n+        load.removeAlias(\"Load alias\");\n+        assertTrue(load.getAliases().isEmpty());\n+    }\n+\n+    @Test\n+    public void silentlyIgnoreAffectingObjectsIdAsAlias() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+    }\n+\n+    @Test\n+    public void silentlyIgnoreAffectingTwiceSameIdToAnObject() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        assertTrue(load.getAliases().isEmpty());\n+        load.addAlias(\"Load alias\");\n+        load.addAlias(\"Load alias\");\n+\n+        assertEquals(1, load.getAliases().size());\n+        assertTrue(load.getAliases().contains(\"Load alias\"));\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void failWhenDuplicatedAlias() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        Generator generator = network.getGenerator(\"generator1\");\n+        load.addAlias(\"Alias\");\n+        generator.addAlias(\"Alias\");\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void failWhenAliasEqualToAnId() {\n+        Network network = NetworkTest1Factory.create();\n+        Generator generator = network.getGenerator(\"generator1\");\n+        generator.addAlias(\"load1\");\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void failWhenRemovingNonExistingAlias() {\n+        Network network = NetworkTest1Factory.create();\n+        Load load = network.getLoad(\"load1\");\n+        load.removeAlias(\"Load alias\");\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5NzI2Mg=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjc0MjI4OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/java/com/powsybl/iidm/xml/TieLineWithAliasesXmlTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo1MDo1NVrOGtV6HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwODoxOTo0NFrOGvuW1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5ODA0NA==", "bodyText": "Both are redundant?", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450198044", "createdAt": "2020-07-06T12:50:55Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/java/com/powsybl/iidm/xml/TieLineWithAliasesXmlTest.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.iidm.xml;\n+\n+import org.junit.Test;\n+\n+import java.io.IOException;\n+\n+/**\n+ * @author Sebastien Murgey <sebastien.murgey@rte-france.com>\n+ */\n+public class TieLineWithAliasesXmlTest extends AbstractXmlConverterTest {\n+\n+    @Test\n+    public void test() throws IOException {\n+        roundTripVersionedXmlTest(\"tielineWithAliases.xml\", IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+\n+        // Tests for backward compatibility\n+        roundTripVersionedXmlFromMinToCurrentVersionTest(\"tielineWithAliases.xml\", IidmXmlVersion.V_1_3);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY3MDk4Nw==", "bodyText": "Not in next version of IIDM. If I understand well, second call does not run CURRENT_IIDM_XML_VERSION", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450670987", "createdAt": "2020-07-07T07:43:17Z", "author": {"login": "murgeyseb"}, "path": "iidm/iidm-xml-converter/src/test/java/com/powsybl/iidm/xml/TieLineWithAliasesXmlTest.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.iidm.xml;\n+\n+import org.junit.Test;\n+\n+import java.io.IOException;\n+\n+/**\n+ * @author Sebastien Murgey <sebastien.murgey@rte-france.com>\n+ */\n+public class TieLineWithAliasesXmlTest extends AbstractXmlConverterTest {\n+\n+    @Test\n+    public void test() throws IOException {\n+        roundTripVersionedXmlTest(\"tielineWithAliases.xml\", IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+\n+        // Tests for backward compatibility\n+        roundTripVersionedXmlFromMinToCurrentVersionTest(\"tielineWithAliases.xml\", IidmXmlVersion.V_1_3);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5ODA0NA=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY5NTc2NQ==", "bodyText": "You right, the current_version is ignored. I ask to @MioRtia if the expected behavior", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r452695765", "createdAt": "2020-07-10T08:19:44Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/java/com/powsybl/iidm/xml/TieLineWithAliasesXmlTest.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+\n+package com.powsybl.iidm.xml;\n+\n+import org.junit.Test;\n+\n+import java.io.IOException;\n+\n+/**\n+ * @author Sebastien Murgey <sebastien.murgey@rte-france.com>\n+ */\n+public class TieLineWithAliasesXmlTest extends AbstractXmlConverterTest {\n+\n+    @Test\n+    public void test() throws IOException {\n+        roundTripVersionedXmlTest(\"tielineWithAliases.xml\", IidmXmlConstants.CURRENT_IIDM_XML_VERSION);\n+\n+        // Tests for backward compatibility\n+        roundTripVersionedXmlFromMinToCurrentVersionTest(\"tielineWithAliases.xml\", IidmXmlVersion.V_1_3);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5ODA0NA=="}, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNjc0MzYyOnYy", "diffSide": "RIGHT", "path": "ucte/ucte-util/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo1MToxN1rOGtV65g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxMjo1MToxN1rOGtV65g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE5ODI0Ng==", "bodyText": "Add an empty line", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r450198246", "createdAt": "2020-07-06T12:51:17Z", "author": {"login": "mathbagu"}, "path": "ucte/ucte-util/pom.xml", "diffHunk": "@@ -0,0 +1,52 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>com.powsybl</groupId>\n+        <artifactId>powsybl-ucte</artifactId>\n+        <version>3.5.0-SNAPSHOT</version>\n+    </parent>\n+\n+    <artifactId>powsybl-ucte-util</artifactId>\n+    <name>UCTE utilities</name>\n+    <description>Utility classes for UCTE formatted network and files</description>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>${project.groupId}</groupId>\n+            <artifactId>powsybl-iidm-api</artifactId>\n+            <version>${project.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>${project.groupId}</groupId>\n+            <artifactId>powsybl-ucte-network</artifactId>\n+            <version>${project.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>${project.groupId}</groupId>\n+            <artifactId>powsybl-config-test</artifactId>\n+            <version>${project.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>${project.groupId}</groupId>\n+            <artifactId>powsybl-iidm-impl</artifactId>\n+            <version>${project.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>${project.groupId}</groupId>\n+            <artifactId>powsybl-ucte-converter</artifactId>\n+            <version>${project.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>junit</groupId>\n+            <artifactId>junit</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+    </dependencies>\n+</project>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ac04dd93098c9b97fcfbc0c9bd2f1f20d62433a"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MzYwMjcwOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTozNzoxMlrOGywwZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTozNzoxMlrOGywwZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg4MDgwNw==", "bodyText": "I think you should return an unmodifable copy", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r455880807", "createdAt": "2020-07-16T15:37:12Z", "author": {"login": "miovd"}, "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -51,6 +53,29 @@ public String getNameOrId() {\n         return name != null ? name : id;\n     }\n \n+    @Override\n+    public Set<String> getAliases() {\n+        return aliases;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83c1f2d58e407b30b4ff9aeed152179bcc4570cf"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MzcwMDQ0OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-impl/src/test/java/com/powsybl/iidm/network/impl/VariantManagerImplTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTo1OToyMVrOGyxtDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTo1OToyMVrOGyxtDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg5NjMzMg==", "bodyText": "Same remark", "url": "https://github.com/powsybl/powsybl-core/pull/1319#discussion_r455896332", "createdAt": "2020-07-16T15:59:21Z", "author": {"login": "miovd"}, "path": "iidm/iidm-impl/src/test/java/com/powsybl/iidm/network/impl/VariantManagerImplTest.java", "diffHunk": "@@ -58,6 +60,11 @@ public String getNameOrId() {\n             return id;\n         }\n \n+        @Override\n+        public Set<String> getAliases() {\n+            return aliases;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83c1f2d58e407b30b4ff9aeed152179bcc4570cf"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 110, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}