{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MDg3MzQz", "number": 1424, "title": "CGMES rdf4j update", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nN/A\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nUpdate RDF4J dependency.\nWhat is the current behavior? (You can also link to an open issue here)\nWe use an old version of RDF4J that is not ready for Java 11 and is not compatible with last version of springs.\nWhat is the new behavior (if this is a feature change)?\nWe use the latest release, but it completely changed the optimization plan of the queries. Some queries have to be fixed to have the same performance than before.\nQuery for operationalLimits was rewritten to avoid introducing new scopes (unions). Instead, we have used optionals. The performance with unions was very bad for some real-world cases that have a big number of limits defined at Equipment level. The good performance of the revised query has been verified also against RDF4J v2.4.\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\nThe use of the cache for all query results is not recommended a will be removed before final publish of this PR.\nA related PR #1500 has been made to avoid running some selected queries multiple times (terminals, connectivityNodes, topologicalNodes).", "createdAt": "2020-08-06T15:06:38Z", "url": "https://github.com/powsybl/powsybl-core/pull/1424", "merged": true, "mergeCommit": {"oid": "5f6fa83c7ab718c2ab007063d0a329c1b50e6200"}, "closed": true, "closedAt": "2020-10-15T12:40:46Z", "author": {"login": "mathbagu"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc76IZogH2gAyNDY0MDg3MzQzOjgyYzAyMDk1NThkYjg1NTRkMjUxMjBjOTFmMTgwYTI2ZTI4NmM1ZmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSxEJagFqTUwOTMzMDc3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "82c0209558db8554d25120c91f180a26e286c5fd", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/82c0209558db8554d25120c91f180a26e286c5fd", "committedDate": "2020-08-05T12:11:17Z", "message": "Update RDF4J version to v3.3.0\n- update queries due to the new RDF4J optimization plan\n- add caching in CgmesModelTripleStore for query results\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf986889c6f5e65169cd23e1730a5981d93743cf", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/bf986889c6f5e65169cd23e1730a5981d93743cf", "committedDate": "2020-08-06T12:37:06Z", "message": "Improve query performance\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a6cb3816f059070302215728bad9910663340ff", "author": {"user": {"login": "mathbagu", "name": "Mathieu BAGUE"}}, "url": "https://github.com/powsybl/powsybl-core/commit/7a6cb3816f059070302215728bad9910663340ff", "committedDate": "2020-08-06T12:59:30Z", "message": "Fix unit tests\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NDA0NjU5", "url": "https://github.com/powsybl/powsybl-core/pull/1424#pullrequestreview-469404659", "createdAt": "2020-08-18T12:31:42Z", "commit": {"oid": "7a6cb3816f059070302215728bad9910663340ff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMjozMTo0MlrOHCRNqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMjozMTo0MlrOHCRNqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE0MTIyNA==", "bodyText": "Not sure why this change occurred. I will look into it.", "url": "https://github.com/powsybl/powsybl-core/pull/1424#discussion_r472141224", "createdAt": "2020-08-18T12:31:42Z", "author": {"login": "MioRtia"}, "path": "cgmes/cgmes-conformity/src/test/java/com/powsybl/cgmes/conformity/test/CgmesConformity1NetworkCatalog.java", "diffHunk": "@@ -912,12 +912,12 @@ public static Network microType4BE() {\n                 .setG1(0)\n                 .setB2(0)\n                 .setG2(0)\n-                .setConnectableBus1(busAnvers225.getId())\n-                .setBus1(busAnvers225.getId())\n-                .setVoltageLevel1(vlAnvers225.getId())\n-                .setConnectableBus2(busAnvers220.getId())\n-                .setBus2(busAnvers220.getId())\n-                .setVoltageLevel2(vlAnvers220.getId())\n+                .setConnectableBus1(busAnvers220.getId())\n+                .setBus1(busAnvers220.getId())\n+                .setVoltageLevel1(vlAnvers220.getId())\n+                .setConnectableBus2(busAnvers225.getId())\n+                .setBus2(busAnvers225.getId())\n+                .setVoltageLevel2(vlAnvers225.getId())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a6cb3816f059070302215728bad9910663340ff"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84e50b0f1ecc500816bcf29bf691f11e63c33c44", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/84e50b0f1ecc500816bcf29bf691f11e63c33c44", "committedDate": "2020-10-01T08:53:02Z", "message": "Merge branch 'master' into cgmes-rdj4j-update\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7433050ae9d758c08c140c0dec8419f9a55c19c", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/f7433050ae9d758c08c140c0dec8419f9a55c19c", "committedDate": "2020-10-01T18:33:25Z", "message": "Merge branch 'master' into cgmes-rdj4j-update\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f4cd57b74fc86a59302419fc8d2ffc4386339dc", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/3f4cd57b74fc86a59302419fc8d2ffc4386339dc", "committedDate": "2020-10-08T14:51:47Z", "message": "Merge branch 'master' into cgmes-rdj4j-update\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58e150328f6b8b5669a18af394d31a90843fc29c", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/58e150328f6b8b5669a18af394d31a90843fc29c", "committedDate": "2020-10-08T15:16:42Z", "message": "replace query for operational limits: use optionals instead of unions to avoid new scopes\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cbba7c5ca5d64adfed2a645a98c7de50814835b", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/9cbba7c5ca5d64adfed2a645a98c7de50814835b", "committedDate": "2020-10-08T15:53:04Z", "message": "remove cache of all query results (CGMES model will selectively cache required data)\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52bf28a8460784d2403c974f784131b079201f20", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/52bf28a8460784d2403c974f784131b079201f20", "committedDate": "2020-10-08T16:14:42Z", "message": "fix code smell (toString not required)\n\nSigned-off-by: Luma <zamarrenolm@aia.es>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0OTc0MDk2", "url": "https://github.com/powsybl/powsybl-core/pull/1424#pullrequestreview-504974096", "createdAt": "2020-10-08T16:45:33Z", "commit": {"oid": "52bf28a8460784d2403c974f784131b079201f20"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24dbc05533b5be46e964842a365f32c107db46e5", "author": {"user": {"login": "zamarrenolm", "name": "Luma"}}, "url": "https://github.com/powsybl/powsybl-core/commit/24dbc05533b5be46e964842a365f32c107db46e5", "committedDate": "2020-10-13T09:55:02Z", "message": "Merge branch 'master' into cgmes-rdj4j-update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47d2eded641ab65e34fb88cbc2b7edf5c278d7e6", "author": {"user": {"login": "annetill", "name": "Anne Tilloy"}}, "url": "https://github.com/powsybl/powsybl-core/commit/47d2eded641ab65e34fb88cbc2b7edf5c278d7e6", "committedDate": "2020-10-15T11:47:43Z", "message": "Merge branch 'master' into cgmes-rdj4j-update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MzI0NjAy", "url": "https://github.com/powsybl/powsybl-core/pull/1424#pullrequestreview-509324602", "createdAt": "2020-10-15T12:29:57Z", "commit": {"oid": "47d2eded641ab65e34fb88cbc2b7edf5c278d7e6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MzMwNzc2", "url": "https://github.com/powsybl/powsybl-core/pull/1424#pullrequestreview-509330776", "createdAt": "2020-10-15T12:37:45Z", "commit": {"oid": "47d2eded641ab65e34fb88cbc2b7edf5c278d7e6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4135, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}