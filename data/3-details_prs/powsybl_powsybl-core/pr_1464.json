{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyMDE5NDI5", "number": 1464, "title": "Introduce CimCharacteristics extension and use in CGMES import", "bodyText": "Please check if the PR fulfills these requirements (please use '[x]' to check the checkboxes, or submit the PR and then click the checkboxes)\n\n The commit message follows our guidelines\n Tests for the changes have been added (for bug fixes / features)\n Docs have been added / updated (for bug fixes / features)\n\nDoes this PR already have an issue describing the problem ? If so, link to this issue using '#XXX' and skip the rest\nNo\nWhat kind of change does this PR introduce? (Bug fix, feature, docs update, ...)\nFeature\nWhat is the current behavior? (You can also link to an open issue here)\nCIM version and topology are only accessible in the CgmesModel\nWhat is the new behavior (if this is a feature change)?\nCIM version and topology are stored in CIMCharacteristics if the CGMES if from a CIM file (not fake or custom).\nDoes this PR introduce a breaking change or deprecate an API? If yes, check the following:\n\n The Breaking Change or Deprecated label has been added\n The migration guide has been updated in the github wiki (What changes might users need to make in their application due to this PR?)\n\nOther information:\n(if any of the questions/checkboxes don't apply, please delete them entirely)", "createdAt": "2020-09-08T12:51:37Z", "url": "https://github.com/powsybl/powsybl-core/pull/1464", "merged": true, "mergeCommit": {"oid": "b6aff4e2101310583a902484eac7336fbd770dba"}, "closed": true, "closedAt": "2020-09-11T07:44:03Z", "author": {"login": "MioRtia"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdG3GtIgH2gAyNDgyMDE5NDI5OjI0MDZiYThkNzdlMGQ5MjM4OWYwZmY2ZTNlMmUyZGQzM2I1N2EwMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHwdteAFqTQ4NjU0NzA5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2406ba8d77e0d92389f0ff6e3e2e2dd33b57a001", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/2406ba8d77e0d92389f0ff6e3e2e2dd33b57a001", "committedDate": "2020-09-08T12:52:53Z", "message": "Introduce new extension CIMCharacteristics\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\ntmp\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5062f7de7b31f08fe679316ebc754b919b2fa0d8", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/5062f7de7b31f08fe679316ebc754b919b2fa0d8", "committedDate": "2020-09-08T12:52:54Z", "message": "Add XML Serializer\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6c32534f89fa930bf99a375c05f770c6e9da115", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/e6c32534f89fa930bf99a375c05f770c6e9da115", "committedDate": "2020-09-08T12:52:54Z", "message": "Add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/938fb21ff62e384e0862d43fc8462be4025c5c67", "committedDate": "2020-09-08T12:52:54Z", "message": "Use extension in CGMES import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c7f9d76497563e94106a65a543778a5f5dead39c", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/c7f9d76497563e94106a65a543778a5f5dead39c", "committedDate": "2020-09-08T12:51:10Z", "message": "Use extension in CGMES import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}, "afterCommit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/938fb21ff62e384e0862d43fc8462be4025c5c67", "committedDate": "2020-09-08T12:52:54Z", "message": "Use extension in CGMES import\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0ODA0MTk0", "url": "https://github.com/powsybl/powsybl-core/pull/1464#pullrequestreview-484804194", "createdAt": "2020-09-09T09:00:43Z", "commit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwOTowMDo0M1rOHO9vkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwOTowMDo0M1rOHO9vkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1MzcxMg==", "bodyText": "A drawback of using here the expected exception annotation is that it doesn't ensure that the exception is thrown by the call which you expect will throw the exception (if create() throws a PowsyblException the test remains passed)", "url": "https://github.com/powsybl/powsybl-core/pull/1464#discussion_r485453712", "createdAt": "2020-09-09T09:00:43Z", "author": {"login": "flo-dup"}, "path": "cgmes/cgmes-conversion/src/test/java/com/powsybl/cgmes/conversion/extensions/CIMCharacteristicsTest.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.cgmes.conversion.extensions;\n+\n+import com.powsybl.cgmes.conversion.elements.CgmesTopologyKind;\n+import com.powsybl.commons.PowsyblException;\n+import com.powsybl.iidm.network.Network;\n+import com.powsybl.iidm.network.test.EurostagTutorialExample1Factory;\n+import org.junit.Test;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNotNull;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public class CIMCharacteristicsTest {\n+\n+    @Test\n+    public void test() {\n+        Network network = EurostagTutorialExample1Factory.create();\n+        network.newExtension(CIMCharacteristicsAdder.class)\n+                .setTopologyKind(CgmesTopologyKind.NODE_BREAKER)\n+                .setCimVersion(16)\n+                .add();\n+        CIMCharacteristics extension = network.getExtension(CIMCharacteristics.class);\n+        assertNotNull(extension);\n+        assertEquals(CgmesTopologyKind.NODE_BREAKER, extension.getTopologyKind());\n+        assertEquals(16, extension.getCimVersion());\n+    }\n+\n+    @Test(expected = PowsyblException.class)\n+    public void invalid() {\n+        EurostagTutorialExample1Factory.create().newExtension(CIMCharacteristicsAdder.class).add();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1Njc4NjIz", "url": "https://github.com/powsybl/powsybl-core/pull/1464#pullrequestreview-485678623", "createdAt": "2020-09-10T08:03:26Z", "commit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODowMzoyNlrOHPn3pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODowMzoyNlrOHPn3pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE0MzkwOA==", "bodyText": "I think that you should call your extension it CimCharacteristics. For CGMES, we in general choose Cgmes instead of CGMES. What do you think ?", "url": "https://github.com/powsybl/powsybl-core/pull/1464#discussion_r486143908", "createdAt": "2020-09-10T08:03:26Z", "author": {"login": "annetill"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/extensions/CIMCharacteristics.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright (c) 2020, RTE (http://www.rte-france.com)\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ */\n+package com.powsybl.cgmes.conversion.extensions;\n+\n+import com.powsybl.cgmes.conversion.elements.CgmesTopologyKind;\n+import com.powsybl.commons.extensions.Extension;\n+import com.powsybl.iidm.network.Network;\n+\n+/**\n+ * @author Miora Ralambotiana <miora.ralambotiana at rte-france.com>\n+ */\n+public interface CIMCharacteristics extends Extension<Network> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1Njg0MTI5", "url": "https://github.com/powsybl/powsybl-core/pull/1464#pullrequestreview-485684129", "createdAt": "2020-09-10T08:07:08Z", "commit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODowNzowOFrOHPn_6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwODowNzowOFrOHPn_6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE0NjAyNA==", "bodyText": "The id is the id of what ?", "url": "https://github.com/powsybl/powsybl-core/pull/1464#discussion_r486146024", "createdAt": "2020-09-10T08:07:08Z", "author": {"login": "annetill"}, "path": "cgmes/cgmes-conversion/src/test/resources/extensions/eurostag_cim_characteristics.xml", "diffHunk": "@@ -0,0 +1,45 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<iidm:network xmlns:iidm=\"http://www.powsybl.org/schema/iidm/1_4\" xmlns:cc=\"http://www.powsybl.org/schema/iidm/ext/cim_characteristics/1_0\" id=\"sim1\" caseDate=\"2020-09-08T14:28:13.738+02:00\" forecastDistance=\"0\" sourceFormat=\"test\">\n+    <iidm:substation id=\"P1\" country=\"FR\" tso=\"RTE\" geographicalTags=\"A\">\n+        <iidm:voltageLevel id=\"VLGEN\" nominalV=\"24.0\" topologyKind=\"BUS_BREAKER\">\n+            <iidm:busBreakerTopology>\n+                <iidm:bus id=\"NGEN\"/>\n+            </iidm:busBreakerTopology>\n+            <iidm:generator id=\"GEN\" energySource=\"OTHER\" minP=\"-9999.99\" maxP=\"9999.99\" voltageRegulatorOn=\"true\" targetP=\"607.0\" targetV=\"24.5\" targetQ=\"301.0\" bus=\"NGEN\" connectableBus=\"NGEN\">\n+                <iidm:minMaxReactiveLimits minQ=\"-9999.99\" maxQ=\"9999.99\"/>\n+            </iidm:generator>\n+        </iidm:voltageLevel>\n+        <iidm:voltageLevel id=\"VLHV1\" nominalV=\"380.0\" topologyKind=\"BUS_BREAKER\">\n+            <iidm:busBreakerTopology>\n+                <iidm:bus id=\"NHV1\"/>\n+            </iidm:busBreakerTopology>\n+        </iidm:voltageLevel>\n+        <iidm:twoWindingsTransformer id=\"NGEN_NHV1\" r=\"0.26658461538461536\" x=\"11.104492831516762\" g=\"0.0\" b=\"0.0\" ratedU1=\"24.0\" ratedU2=\"400.0\" bus1=\"NGEN\" connectableBus1=\"NGEN\" voltageLevelId1=\"VLGEN\" bus2=\"NHV1\" connectableBus2=\"NHV1\" voltageLevelId2=\"VLHV1\"/>\n+    </iidm:substation>\n+    <iidm:substation id=\"P2\" country=\"FR\" tso=\"RTE\" geographicalTags=\"B\">\n+        <iidm:voltageLevel id=\"VLHV2\" nominalV=\"380.0\" topologyKind=\"BUS_BREAKER\">\n+            <iidm:busBreakerTopology>\n+                <iidm:bus id=\"NHV2\"/>\n+            </iidm:busBreakerTopology>\n+        </iidm:voltageLevel>\n+        <iidm:voltageLevel id=\"VLLOAD\" nominalV=\"150.0\" topologyKind=\"BUS_BREAKER\">\n+            <iidm:busBreakerTopology>\n+                <iidm:bus id=\"NLOAD\"/>\n+            </iidm:busBreakerTopology>\n+            <iidm:load id=\"LOAD\" loadType=\"UNDEFINED\" p0=\"600.0\" q0=\"200.0\" bus=\"NLOAD\" connectableBus=\"NLOAD\"/>\n+        </iidm:voltageLevel>\n+        <iidm:twoWindingsTransformer id=\"NHV2_NLOAD\" r=\"0.04724999999999999\" x=\"4.049724365620455\" g=\"0.0\" b=\"0.0\" ratedU1=\"400.0\" ratedU2=\"158.0\" bus1=\"NHV2\" connectableBus1=\"NHV2\" voltageLevelId1=\"VLHV2\" bus2=\"NLOAD\" connectableBus2=\"NLOAD\" voltageLevelId2=\"VLLOAD\">\n+            <iidm:ratioTapChanger lowTapPosition=\"0\" tapPosition=\"1\" targetDeadband=\"0.0\" loadTapChangingCapabilities=\"true\" regulating=\"true\" targetV=\"158.0\">\n+                <iidm:terminalRef id=\"NHV2_NLOAD\" side=\"TWO\"/>\n+                <iidm:step r=\"0.0\" x=\"0.0\" g=\"0.0\" b=\"0.0\" rho=\"0.8505666905244191\"/>\n+                <iidm:step r=\"0.0\" x=\"0.0\" g=\"0.0\" b=\"0.0\" rho=\"1.0006666666666666\"/>\n+                <iidm:step r=\"0.0\" x=\"0.0\" g=\"0.0\" b=\"0.0\" rho=\"1.150766642808914\"/>\n+            </iidm:ratioTapChanger>\n+        </iidm:twoWindingsTransformer>\n+    </iidm:substation>\n+    <iidm:line id=\"NHV1_NHV2_1\" r=\"3.0\" x=\"33.0\" g1=\"0.0\" b1=\"1.93E-4\" g2=\"0.0\" b2=\"1.93E-4\" bus1=\"NHV1\" connectableBus1=\"NHV1\" voltageLevelId1=\"VLHV1\" bus2=\"NHV2\" connectableBus2=\"NHV2\" voltageLevelId2=\"VLHV2\"/>\n+    <iidm:line id=\"NHV1_NHV2_2\" r=\"3.0\" x=\"33.0\" g1=\"0.0\" b1=\"1.93E-4\" g2=\"0.0\" b2=\"1.93E-4\" bus1=\"NHV1\" connectableBus1=\"NHV1\" voltageLevelId1=\"VLHV1\" bus2=\"NHV2\" connectableBus2=\"NHV2\" voltageLevelId2=\"VLHV2\"/>\n+    <iidm:extension id=\"sim1\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1Njg4NzY4", "url": "https://github.com/powsybl/powsybl-core/pull/1464#pullrequestreview-485688768", "createdAt": "2020-09-10T08:13:00Z", "commit": {"oid": "938fb21ff62e384e0862d43fc8462be4025c5c67"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e97f80449e66348fc6d0cd4a4ec8e8b59efdb524", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/e97f80449e66348fc6d0cd4a4ec8e8b59efdb524", "committedDate": "2020-09-10T14:32:58Z", "message": "Add rule to test (reviewer's comment)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4637bdd5984bba4befb55bc04c5c53762b2dd3a5", "author": {"user": {"login": "MioRtia", "name": null}}, "url": "https://github.com/powsybl/powsybl-core/commit/4637bdd5984bba4befb55bc04c5c53762b2dd3a5", "committedDate": "2020-09-10T14:43:45Z", "message": "Rename CIMCharacteristics as CimCharacteristics (reviewer's comment)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MDI4MzIx", "url": "https://github.com/powsybl/powsybl-core/pull/1464#pullrequestreview-486028321", "createdAt": "2020-09-10T15:00:08Z", "commit": {"oid": "4637bdd5984bba4befb55bc04c5c53762b2dd3a5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2NTQ3MDk5", "url": "https://github.com/powsybl/powsybl-core/pull/1464#pullrequestreview-486547099", "createdAt": "2020-09-11T07:42:36Z", "commit": {"oid": "4637bdd5984bba4befb55bc04c5c53762b2dd3a5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4160, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}