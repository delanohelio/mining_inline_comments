{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNTcyMDQx", "number": 1233, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyNDoxMFrODqUNFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyNDozMlrODsitJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1Njk3ODE0OnYy", "diffSide": "RIGHT", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyNDoxMFrOF5_CtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyNDoxMFrOF5_CtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NjAzNg==", "bodyText": "Not related to this PR, but this TODO could be removed.", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r396346036", "createdAt": "2020-03-23T10:24:10Z", "author": {"login": "mathbagu"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -68,34 +69,34 @@ private VoltageLevel newBoundarySubstationVoltageLevel() {\n         String substationName = \"boundary\";\n         String vlName = \"boundary\";\n         return context.network()\n-                .newSubstation()\n-                .setId(context.namingStrategy().getId(\"Substation\", substationId))\n-                .setName(substationName)\n-                // TODO(mathbagu): Country should be optional. This will be done in another PR.\n-                // A non-null country code must be set\n-                // This is an arbitrary country code, Bangladesh code BD also matches with\n-                // BounDary\n-                .setCountry(boundaryCountryCode())\n-                .add()\n-                .newVoltageLevel()\n-                .setId(context.namingStrategy().getId(\"VoltageLevel\", vlId))\n-                .setName(vlName)\n-                .setNominalV(nominalVoltage)\n-                .setTopologyKind(context.nodeBreaker() ? TopologyKind.NODE_BREAKER : TopologyKind.BUS_BREAKER)\n-                .add();\n+            .newSubstation()\n+            .setId(context.namingStrategy().getId(\"Substation\", substationId))\n+            .setName(substationName)\n+            // TODO(mathbagu): Country should be optional. This will be done in another PR.\n+            // A non-null country code must be set\n+            // This is an arbitrary country code, Bangladesh code BD also matches with\n+            // BounDary", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e566a1709c4d16801bfd9858b95cb2501e83a2"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1Njk5MDc5OnYy", "diffSide": "RIGHT", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDoyNzo0N1rOF5_LOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyMzo1NFrOF9coeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0ODIxOQ==", "bodyText": "Not related to this PR, but CalculatedBus and ConfiguredBus are implementation specific and should not appear in this message", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r396348219", "createdAt": "2020-03-23T10:27:47Z", "author": {"login": "mathbagu"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -186,12 +191,19 @@ public void setVoltageAngleNodeBreaker() {\n                 return;\n             }\n             LOG.warn(\n-                    \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n-                    bus, id);\n+                \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e566a1709c4d16801bfd9858b95cb2501e83a2"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTEyNTE3Mg==", "bodyText": "What error message do you suggest?", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r399125172", "createdAt": "2020-03-27T09:11:57Z", "author": {"login": "miovd"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -186,12 +191,19 @@ public void setVoltageAngleNodeBreaker() {\n                 return;\n             }\n             LOG.warn(\n-                    \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n-                    bus, id);\n+                \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0ODIxOQ=="}, "originalCommit": {"oid": "78e566a1709c4d16801bfd9858b95cb2501e83a2"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3NjU2OA==", "bodyText": "Somethink like that:\n\nCan't find a bus from the Bus View to set Voltage and Angle, we use the bus {} from the Bus/Breaker view. Connectivity node {}", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r399976568", "createdAt": "2020-03-30T07:23:54Z", "author": {"login": "mathbagu"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -186,12 +191,19 @@ public void setVoltageAngleNodeBreaker() {\n                 return;\n             }\n             LOG.warn(\n-                    \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n-                    bus, id);\n+                \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0ODIxOQ=="}, "originalCommit": {"oid": "78e566a1709c4d16801bfd9858b95cb2501e83a2"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzAxNTg4OnYy", "diffSide": "RIGHT", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDozNDowOFrOF5_a3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwOToxMTo1NFrOF8oqmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM1MjIyMg==", "bodyText": "Not sure we should assume that, or we should update the documentation.\nAnyway, is it the best way to check if a terminal is associated to this node: maybe we should add a convenient method to get an Optional<Terminal> from a node?", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r396352222", "createdAt": "2020-03-23T10:34:08Z", "author": {"login": "mathbagu"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -186,12 +191,19 @@ public void setVoltageAngleNodeBreaker() {\n                 return;\n             }\n             LOG.warn(\n-                    \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n-                    bus, id);\n+                \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n+                bus, id);\n         }\n         setVoltageAngle(bus);\n     }\n \n+    private boolean iidmNodeIsValid(VoltageLevel.NodeBreakerView topo, int iidmNode) {\n+        // A node is valid only if it has some equipment attached\n+        // The list of valid nodes is obtained from the node-breaker view\n+        // We assume the returned list is sorted", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78e566a1709c4d16801bfd9858b95cb2501e83a2"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTEyNTE0NQ==", "bodyText": "It is not enough because a node is still valid if an internal connection or a switch is attached to it (with no terminal)... I added a convenient method to check if there is any equipment attached to the node at NodeBreakerView level to delete this method.", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r399125145", "createdAt": "2020-03-27T09:11:54Z", "author": {"login": "miovd"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -186,12 +191,19 @@ public void setVoltageAngleNodeBreaker() {\n                 return;\n             }\n             LOG.warn(\n-                    \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n-                    bus, id);\n+                \"Can't find a calculated Bus to set Voltage, Angle, but found a configured Bus {}. Connectivity node {}\",\n+                bus, id);\n         }\n         setVoltageAngle(bus);\n     }\n \n+    private boolean iidmNodeIsValid(VoltageLevel.NodeBreakerView topo, int iidmNode) {\n+        // A node is valid only if it has some equipment attached\n+        // The list of valid nodes is obtained from the node-breaker view\n+        // We assume the returned list is sorted", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM1MjIyMg=="}, "originalCommit": {"oid": "78e566a1709c4d16801bfd9858b95cb2501e83a2"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MDMyNTQ4OnYy", "diffSide": "LEFT", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyNDozMlrOF9cpuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyNDozMlrOF9cpuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3Njg4OA==", "bodyText": "@zamarrenolm you should configure your IDE to set to 8 spaces the continuous indentation.", "url": "https://github.com/powsybl/powsybl-core/pull/1233#discussion_r399976888", "createdAt": "2020-03-30T07:24:32Z", "author": {"login": "mathbagu"}, "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/elements/NodeConversion.java", "diffHunk": "@@ -68,34 +68,30 @@ private VoltageLevel newBoundarySubstationVoltageLevel() {\n         String substationName = \"boundary\";\n         String vlName = \"boundary\";\n         return context.network()\n-                .newSubstation()\n-                .setId(context.namingStrategy().getId(\"Substation\", substationId))\n-                .setName(substationName)\n-                // TODO(mathbagu): Country should be optional. This will be done in another PR.\n-                // A non-null country code must be set\n-                // This is an arbitrary country code, Bangladesh code BD also matches with\n-                // BounDary\n-                .setCountry(boundaryCountryCode())\n-                .add()\n-                .newVoltageLevel()\n-                .setId(context.namingStrategy().getId(\"VoltageLevel\", vlId))\n-                .setName(vlName)\n-                .setNominalV(nominalVoltage)\n-                .setTopologyKind(context.nodeBreaker() ? TopologyKind.NODE_BREAKER : TopologyKind.BUS_BREAKER)\n-                .add();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adea2815fde8320896fc6bd093d1c23b89f074ec"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 125, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}