{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MzI4NTAw", "number": 1170, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyNzo1NlrODiPXGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowOToyNFrODio9ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjI5ODUxOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyNzo1NlrOFtYVOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0NTo0MVrOFvSuhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyODg5MA==", "bodyText": "We should assert that the minimum version is 1.1, because this is not allowed in 1.0", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383128890", "createdAt": "2020-02-24T08:27:56Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "diffHunk": "@@ -235,6 +256,25 @@ protected void readSubElements(VoltageLevel vl, NetworkXmlReaderContext context)\n                                 NodeBreakerViewInternalConnectionXml.INSTANCE.read(vl, context);\n                                 break;\n \n+                            case BusXml.ROOT_ELEMENT_NAME:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDIxMg==", "bodyText": "Done.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134212", "createdAt": "2020-02-27T13:45:41Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "diffHunk": "@@ -235,6 +256,25 @@ protected void readSubElements(VoltageLevel vl, NetworkXmlReaderContext context)\n                                 NodeBreakerViewInternalConnectionXml.INSTANCE.read(vl, context);\n                                 break;\n \n+                            case BusXml.ROOT_ELEMENT_NAME:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyODg5MA=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjMwMTczOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/LccRoundTripRef.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyOToxNVrOFtYXDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0NjowNVrOFvSvaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTM1OQ==", "bodyText": "If there is no V and/or theta, should we serialize buses?", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383129359", "createdAt": "2020-02-24T08:29:15Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/LccRoundTripRef.xml", "diffHunk": "@@ -20,8 +20,9 @@\n                 <iidm:switch id=\"BK2\" name=\"Breaker\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"3\" node2=\"4\"/>\n                 <iidm:switch id=\"DISC_BBS1_BK3\" name=\"Disconnector\" kind=\"DISCONNECTOR\" retained=\"false\" open=\"false\" node1=\"0\" node2=\"5\"/>\n                 <iidm:switch id=\"BK3\" name=\"Breaker\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"5\" node2=\"6\"/>\n+                <iidm:bus nodes=\"0,1,2,3,4,5,6\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDQ0MQ==", "bodyText": "Line deleted.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134441", "createdAt": "2020-02-27T13:46:05Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/LccRoundTripRef.xml", "diffHunk": "@@ -20,8 +20,9 @@\n                 <iidm:switch id=\"BK2\" name=\"Breaker\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"3\" node2=\"4\"/>\n                 <iidm:switch id=\"DISC_BBS1_BK3\" name=\"Disconnector\" kind=\"DISCONNECTOR\" retained=\"false\" open=\"false\" node1=\"0\" node2=\"5\"/>\n                 <iidm:switch id=\"BK3\" name=\"Breaker\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"5\" node2=\"6\"/>\n+                <iidm:bus nodes=\"0,1,2,3,4,5,6\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTM1OQ=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjMwMjQ1OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/VscRoundTripRef.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODoyOTozOVrOFtYXgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0NjoyMlrOFvSwLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTQ3NQ==", "bodyText": "It's strange that the order of the two attributes is changing", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383129475", "createdAt": "2020-02-24T08:29:39Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/VscRoundTripRef.xml", "diffHunk": "@@ -5,7 +5,7 @@\n             <iidm:busBreakerTopology>\n                 <iidm:bus id=\"B1\"/>\n             </iidm:busBreakerTopology>\n-            <iidm:vscConverterStation id=\"C1\" name=\"Converter1\" lossFactor=\"0.011\" voltageRegulatorOn=\"true\" voltageSetpoint=\"405.0\" bus=\"B1\" connectableBus=\"B1\" p=\"100.0\" q=\"50.0\">\n+            <iidm:vscConverterStation id=\"C1\" name=\"Converter1\" voltageRegulatorOn=\"true\" lossFactor=\"0.011\" voltageSetpoint=\"405.0\" bus=\"B1\" connectableBus=\"B1\" p=\"100.0\" q=\"50.0\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDYzOQ==", "bodyText": "Revert.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134639", "createdAt": "2020-02-27T13:46:22Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/VscRoundTripRef.xml", "diffHunk": "@@ -5,7 +5,7 @@\n             <iidm:busBreakerTopology>\n                 <iidm:bus id=\"B1\"/>\n             </iidm:busBreakerTopology>\n-            <iidm:vscConverterStation id=\"C1\" name=\"Converter1\" lossFactor=\"0.011\" voltageRegulatorOn=\"true\" voltageSetpoint=\"405.0\" bus=\"B1\" connectableBus=\"B1\" p=\"100.0\" q=\"50.0\">\n+            <iidm:vscConverterStation id=\"C1\" name=\"Converter1\" voltageRegulatorOn=\"true\" lossFactor=\"0.011\" voltageSetpoint=\"405.0\" bus=\"B1\" connectableBus=\"B1\" p=\"100.0\" q=\"50.0\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTQ3NQ=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjMwMzA1OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/VscRoundTripRef.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODozMDowMFrOFtYX4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0NjozM1rOFvSwkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTU3MQ==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383129571", "createdAt": "2020-02-24T08:30:00Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/VscRoundTripRef.xml", "diffHunk": "@@ -19,8 +19,9 @@\n                 <iidm:busbarSection id=\"BBS1\" name=\"BusbarSection\" node=\"0\"/>\n                 <iidm:switch id=\"DISC_BBS1_BK1\" name=\"Disconnector\" kind=\"DISCONNECTOR\" retained=\"false\" open=\"false\" node1=\"0\" node2=\"1\"/>\n                 <iidm:switch id=\"BK1\" name=\"Breaker\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"1\" node2=\"2\"/>\n+                <iidm:bus nodes=\"0,1,2\"/>\n             </iidm:nodeBreakerTopology>\n-            <iidm:vscConverterStation id=\"C2\" name=\"Converter2\" lossFactor=\"0.011\" voltageRegulatorOn=\"false\" reactivePowerSetpoint=\"123.0\" node=\"2\">\n+            <iidm:vscConverterStation id=\"C2\" name=\"Converter2\" voltageRegulatorOn=\"false\" lossFactor=\"0.011\" reactivePowerSetpoint=\"123.0\" node=\"2\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDczNg==", "bodyText": "Revert.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134736", "createdAt": "2020-02-27T13:46:33Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/VscRoundTripRef.xml", "diffHunk": "@@ -19,8 +19,9 @@\n                 <iidm:busbarSection id=\"BBS1\" name=\"BusbarSection\" node=\"0\"/>\n                 <iidm:switch id=\"DISC_BBS1_BK1\" name=\"Disconnector\" kind=\"DISCONNECTOR\" retained=\"false\" open=\"false\" node1=\"0\" node2=\"1\"/>\n                 <iidm:switch id=\"BK1\" name=\"Breaker\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"1\" node2=\"2\"/>\n+                <iidm:bus nodes=\"0,1,2\"/>\n             </iidm:nodeBreakerTopology>\n-            <iidm:vscConverterStation id=\"C2\" name=\"Converter2\" lossFactor=\"0.011\" voltageRegulatorOn=\"false\" reactivePowerSetpoint=\"123.0\" node=\"2\">\n+            <iidm:vscConverterStation id=\"C2\" name=\"Converter2\" voltageRegulatorOn=\"false\" lossFactor=\"0.011\" reactivePowerSetpoint=\"123.0\" node=\"2\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTU3MQ=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjMwMzQ4OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/fictitiousSwitchRef.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODozMDoxMlrOFtYYHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0Njo0MVrOFvSw1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTYyOA==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383129628", "createdAt": "2020-02-24T08:30:12Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/fictitiousSwitchRef.xml", "diffHunk": "@@ -45,6 +46,8 @@\n                 <iidm:switch id=\"BV\" name=\"BW\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"17\" node2=\"18\"/>\n                 <iidm:switch id=\"BX\" name=\"BY\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"19\" node2=\"20\"/>\n                 <iidm:switch id=\"BZ\" name=\"CA\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"21\" node2=\"22\"/>\n+                <iidm:bus v=\"236.44736\" angle=\"15.250391\" nodes=\"0,1,6,7,8,9,10,15,16,17,18,19,20,21,22\"/>\n+                <iidm:bus nodes=\"3,4,5\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDgwNw==", "bodyText": "Line deleted.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134807", "createdAt": "2020-02-27T13:46:41Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/fictitiousSwitchRef.xml", "diffHunk": "@@ -45,6 +46,8 @@\n                 <iidm:switch id=\"BV\" name=\"BW\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"17\" node2=\"18\"/>\n                 <iidm:switch id=\"BX\" name=\"BY\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"19\" node2=\"20\"/>\n                 <iidm:switch id=\"BZ\" name=\"CA\" kind=\"BREAKER\" retained=\"true\" open=\"false\" node1=\"21\" node2=\"22\"/>\n+                <iidm:bus v=\"236.44736\" angle=\"15.250391\" nodes=\"0,1,6,7,8,9,10,15,16,17,18,19,20,21,22\"/>\n+                <iidm:bus nodes=\"3,4,5\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTYyOA=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjMwMzk4OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/internalConnections.xiidm", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODozMDoyNFrOFtYYYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0Njo0OFrOFvSxEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTY5Ng==", "bodyText": "Same remark here", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383129696", "createdAt": "2020-02-24T08:30:24Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/internalConnections.xiidm", "diffHunk": "@@ -7,6 +7,7 @@\n                 <iidm:switch id=\"br1\" kind=\"BREAKER\" retained=\"false\" open=\"false\" node1=\"1\" node2=\"2\"/>\n                 <iidm:internalConnection node1=\"0\" node2=\"1\"/>\n                 <iidm:internalConnection node1=\"3\" node2=\"4\"/>\n+                <iidm:bus nodes=\"0,1,2\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDg2Ng==", "bodyText": "Line deleted.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134866", "createdAt": "2020-02-27T13:46:48Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/internalConnections.xiidm", "diffHunk": "@@ -7,6 +7,7 @@\n                 <iidm:switch id=\"br1\" kind=\"BREAKER\" retained=\"false\" open=\"false\" node1=\"1\" node2=\"2\"/>\n                 <iidm:internalConnection node1=\"0\" node2=\"1\"/>\n                 <iidm:internalConnection node1=\"3\" node2=\"4\"/>\n+                <iidm:bus nodes=\"0,1,2\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTY5Ng=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MjMwNDI1OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/internalConnections.xiidm", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODozMDozMVrOFtYYhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0Njo1NVrOFvSxXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTczMw==", "bodyText": "Same remark", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383129733", "createdAt": "2020-02-24T08:30:31Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/internalConnections.xiidm", "diffHunk": "@@ -20,6 +21,7 @@\n                 <iidm:switch id=\"br2\" kind=\"BREAKER\" retained=\"false\" open=\"false\" node1=\"1\" node2=\"2\"/>\n                 <iidm:internalConnection node1=\"0\" node2=\"1\"/>\n                 <iidm:internalConnection node1=\"3\" node2=\"4\"/>\n+                <iidm:bus nodes=\"0,1,2\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNDk0Mg==", "bodyText": "Line deleted.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385134942", "createdAt": "2020-02-27T13:46:55Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/test/resources/V1_1/internalConnections.xiidm", "diffHunk": "@@ -20,6 +21,7 @@\n                 <iidm:switch id=\"br2\" kind=\"BREAKER\" retained=\"false\" open=\"false\" node1=\"1\" node2=\"2\"/>\n                 <iidm:internalConnection node1=\"0\" node2=\"1\"/>\n                 <iidm:internalConnection node1=\"3\" node2=\"4\"/>\n+                <iidm:bus nodes=\"0,1,2\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEyOTczMw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjM1MzI5OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/util/Networks.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwOTozNDoxMlrOFt-rxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0NzowNVrOFvSxvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc1NzI1Mg==", "bodyText": "Maybe add in the javadoc that if no bus is associated to a node, it is not included in any list.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383757252", "createdAt": "2020-02-25T09:34:12Z", "author": {"login": "miovd"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/util/Networks.java", "diffHunk": "@@ -344,4 +341,70 @@ public static void printGeneratorsSetpointDiff(Network network, Logger logger) {\n         }\n     }\n \n+    /**\n+     * Return the list of nodes (N/B topology) for each bus of a the Bus view", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNTAzOQ==", "bodyText": "Done.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385135039", "createdAt": "2020-02-27T13:47:05Z", "author": {"login": "annetill"}, "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/util/Networks.java", "diffHunk": "@@ -344,4 +341,70 @@ public static void printGeneratorsSetpointDiff(Network network, Logger logger) {\n         }\n     }\n \n+    /**\n+     * Return the list of nodes (N/B topology) for each bus of a the Bus view", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc1NzI1Mg=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjQzMzQ0OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwOTo1MzoxNFrOFt_e1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0NzozOFrOFvSy2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3MDMyNA==", "bodyText": "You can replace this by a forEach and an intermediary method writeCalculatedBus(Bus, Set<Integer>, NetworkXmlWriterContext) (with a stream, it will also be easier to filter bus with a voltage or angle non NaN).", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383770324", "createdAt": "2020-02-25T09:53:14Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "diffHunk": "@@ -84,6 +90,21 @@ private void writeNodeBreakerTopology(VoltageLevel vl, NetworkXmlWriterContext c\n             NodeBreakerViewSwitchXml.INSTANCE.write(sw, vl, context);\n         }\n         writeNodeBreakerTopologyInternalConnections(vl, context);\n+\n+        IidmXmlUtil.runFromMinimumVersion(IidmXmlVersion.V_1_1, context, () -> {\n+            Map<String, Set<Integer>> nodesByBus = Networks.getNodesByBus(vl);\n+            for (Bus bus : vl.getBusView().getBuses()) {\n+                try {\n+                    context.getWriter().writeEmptyElement(context.getVersion().getNamespaceURI(), \"bus\");\n+                    XmlUtil.writeDouble(\"v\", bus.getV(), context.getWriter());\n+                    XmlUtil.writeDouble(\"angle\", bus.getAngle(), context.getWriter());\n+                    Set<Integer> nodes = nodesByBus.get(bus.getId());\n+                    context.getWriter().writeAttribute(\"nodes\", StringUtils.join(nodes.toArray(), ','));\n+                } catch (XMLStreamException e) {\n+                    throw new UncheckedXmlStreamException(e);\n+                }\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAzOTgyMA==", "bodyText": "This method could be declared as a static method in BusXml.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r384039820", "createdAt": "2020-02-25T18:20:13Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "diffHunk": "@@ -84,6 +90,21 @@ private void writeNodeBreakerTopology(VoltageLevel vl, NetworkXmlWriterContext c\n             NodeBreakerViewSwitchXml.INSTANCE.write(sw, vl, context);\n         }\n         writeNodeBreakerTopologyInternalConnections(vl, context);\n+\n+        IidmXmlUtil.runFromMinimumVersion(IidmXmlVersion.V_1_1, context, () -> {\n+            Map<String, Set<Integer>> nodesByBus = Networks.getNodesByBus(vl);\n+            for (Bus bus : vl.getBusView().getBuses()) {\n+                try {\n+                    context.getWriter().writeEmptyElement(context.getVersion().getNamespaceURI(), \"bus\");\n+                    XmlUtil.writeDouble(\"v\", bus.getV(), context.getWriter());\n+                    XmlUtil.writeDouble(\"angle\", bus.getAngle(), context.getWriter());\n+                    Set<Integer> nodes = nodesByBus.get(bus.getId());\n+                    context.getWriter().writeAttribute(\"nodes\", StringUtils.join(nodes.toArray(), ','));\n+                } catch (XMLStreamException e) {\n+                    throw new UncheckedXmlStreamException(e);\n+                }\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3MDMyNA=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNTMyMA==", "bodyText": "Done, but in VoltageLevelXml.java.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385135320", "createdAt": "2020-02-27T13:47:38Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/VoltageLevelXml.java", "diffHunk": "@@ -84,6 +90,21 @@ private void writeNodeBreakerTopology(VoltageLevel vl, NetworkXmlWriterContext c\n             NodeBreakerViewSwitchXml.INSTANCE.write(sw, vl, context);\n         }\n         writeNodeBreakerTopologyInternalConnections(vl, context);\n+\n+        IidmXmlUtil.runFromMinimumVersion(IidmXmlVersion.V_1_1, context, () -> {\n+            Map<String, Set<Integer>> nodesByBus = Networks.getNodesByBus(vl);\n+            for (Bus bus : vl.getBusView().getBuses()) {\n+                try {\n+                    context.getWriter().writeEmptyElement(context.getVersion().getNamespaceURI(), \"bus\");\n+                    XmlUtil.writeDouble(\"v\", bus.getV(), context.getWriter());\n+                    XmlUtil.writeDouble(\"angle\", bus.getAngle(), context.getWriter());\n+                    Set<Integer> nodes = nodesByBus.get(bus.getId());\n+                    context.getWriter().writeAttribute(\"nodes\", StringUtils.join(nodes.toArray(), ','));\n+                } catch (XMLStreamException e) {\n+                    throw new UncheckedXmlStreamException(e);\n+                }\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3MDMyNA=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjQ4NTI4OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowNzoxNlrOFt_-jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0ODoyNFrOFvS0rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3ODQ0NA==", "bodyText": "Add javadoc (it should be inspired from assertMinimumVersion javadoc)", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383778444", "createdAt": "2020-02-25T10:07:16Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -34,6 +34,13 @@\n         }\n     }\n \n+    public static <C extends AbstractNetworkXmlContext> void assertMaximumVersion(String rootElementName, String elementName, ErrorMessage type, IidmXmlVersion maxVersion, C context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNTc4OQ==", "bodyText": "Done.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385135789", "createdAt": "2020-02-27T13:48:24Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/util/IidmXmlUtil.java", "diffHunk": "@@ -34,6 +34,13 @@\n         }\n     }\n \n+    public static <C extends AbstractNetworkXmlContext> void assertMaximumVersion(String rootElementName, String elementName, ErrorMessage type, IidmXmlVersion maxVersion, C context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3ODQ0NA=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjQ5MjgyOnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "isResolved": true, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowOToxOFrOFuAC_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzo0OToxMVrOFvS2jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw==", "bodyText": "Use IidmXmlUtil.readOptionalDoubleAttributeUntilMaximumVersion to ensure that maximum version 1.0 is asserted when reading this attribute", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383779583", "createdAt": "2020-02-25T10:09:18Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA0MTU1OQ==", "bodyText": "@MioRtia It looks totally equivalent? Maybe the proposition @annetill mades is better because you clearly see that these two attributes are linked.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r384041559", "createdAt": "2020-02-25T18:23:25Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM1NjI1NQ==", "bodyText": "Not really: here if attributes are present in 1.1, they are not read but the import does not notice the file is invalid (unless there is validation after import) which contradicts what we did elsewhere. If we want to throw an exception if the attributes are present for version >= 1.1, a check outside the runUntilMaximumVersion method should be done.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r384356255", "createdAt": "2020-02-26T09:05:28Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM2OTY0MA==", "bodyText": "In IIDM v1.0, if I put a dummy attribute on an equipment, let's say the busbar section, the code will never throw an exception because we never assert that it's a valid/invalid attribute. This is the responsibility of the XSD to assert that the attribute is not valid. But, you're right, it's not totally equivalent to what we did elsewhere.\nYou cannot simply replace readOptionDoubleAttribute by readOptionalDoubleAttributeUntilMaximumVersion in the lambda, because the runnable is run only if the version is 1.0. This piece of code should be rewritten. What you propose is (pseudo-java-code):\n// Read v or throw if attribute is not expected\ndouble v = IidmXmlUtil.readOptionalDoubleAttributeUntilMaximumVersion(IidmXmlVersion.V_1_0, \"v\");\n// Read angle or throw if attribute is not expected\ndouble angle = IidmXmlUtil.readOptionalDoubleAttributeUntilMaximumVersion(IidmXmlVersion.V_1_0, \"angle\");\nif (IidmVersionXml == IidmXmlVersion.V_1_0) {\n// if (!Double.isNan(v) || !Double.isNaN(angle)) {\n            context.getEndTasks().add(() -> {\n                Bus b = bbs.getTerminal().getBusView().getBus();\n                if (b != null) {\n                    b.setV(v).setAngle(angle);\n                }\n            });\n}", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r384369640", "createdAt": "2020-02-26T09:30:00Z", "author": {"login": "mathbagu"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDM3MzA5Ng==", "bodyText": "Yes, we should do something like that to be consistent with other compatibility checks.", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r384373096", "createdAt": "2020-02-26T09:36:07Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEyNjMxMw==", "bodyText": "After some thinking, I think what we should do is:\n\nassert the version when there is a deletion or an addition of an XML element\nnot assert anything where there is a deletion or an addition of an XML attribute\n\nI will make the modification for the reading of T3W for this.\nSo @annetill you can keep your original code", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385126313", "createdAt": "2020-02-27T13:31:17Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEzNjI2OQ==", "bodyText": "Ok !", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385136269", "createdAt": "2020-02-27T13:49:11Z", "author": {"login": "annetill"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTU4Mw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NjQ5MzE1OnYy", "diffSide": "RIGHT", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowOToyNFrOFuADNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMzozMTozOVrOFvSQgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTYzNw==", "bodyText": "Same remark", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r383779637", "createdAt": "2020-02-25T10:09:24Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n+            double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEyNjUzMQ==", "bodyText": "Same as above, you can ignore this comment", "url": "https://github.com/powsybl/powsybl-core/pull/1170#discussion_r385126531", "createdAt": "2020-02-27T13:31:39Z", "author": {"login": "miovd"}, "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/BusbarSectionXml.java", "diffHunk": "@@ -49,16 +57,20 @@ protected BusbarSectionAdder createAdder(VoltageLevel vl) {\n     @Override\n     protected BusbarSection readRootElementAttributes(BusbarSectionAdder adder, NetworkXmlReaderContext context) {\n         int node = XmlUtil.readIntAttribute(context.getReader(), \"node\");\n-        double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n-        double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");\n         BusbarSection bbs = adder.setNode(node)\n                 .add();\n-        context.getEndTasks().add(() -> {\n-            Bus b = bbs.getTerminal().getBusView().getBus();\n-            if (b != null) {\n-                b.setV(v).setAngle(angle);\n-            }\n+\n+        IidmXmlUtil.runUntilMaximumVersion(IidmXmlVersion.V_1_0, context, () -> {\n+            double v = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"v\");\n+            double angle = XmlUtil.readOptionalDoubleAttribute(context.getReader(), \"angle\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3OTYzNw=="}, "originalCommit": {"oid": "684b3a3f78808e72c65b34e6defe0c4aad855118"}, "originalPosition": 47}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 71, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}