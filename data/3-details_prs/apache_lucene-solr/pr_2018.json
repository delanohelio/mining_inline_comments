{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3OTA4NzQ1", "number": 2018, "title": "LUCENE-9582: rename VectorValues.ScoreFunction to SearchStrategy", "bodyText": "This is - renaming as the title says, plus a light refactoring, and adding o.a.l.util.VectorUtil to house the score function implementations.", "createdAt": "2020-10-21T22:55:19Z", "url": "https://github.com/apache/lucene-solr/pull/2018", "merged": true, "mergeCommit": {"oid": "840a353bc7062c1ab8fc0ab7ebeaa68ccf97fac1"}, "closed": true, "closedAt": "2020-10-23T21:39:34Z", "author": {"login": "msokolov"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdU1TyRAH2gAyNTA3OTA4NzQ1OjJlNWM1NTk1OWQyMTkzNWE3NDU0MTAwMTFhMWVlMTg1NWJkM2RlOWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVdhymAH2gAyNTA3OTA4NzQ1OjY0ZWU5ZWI0MjA4YmRlNzcwMzQ0MjNlZGIyMWE1OThlY2U2YWIyYTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e5c55959d21935a745410011a1ee1855bd3de9e", "author": {"user": null}, "url": "https://github.com/apache/lucene-solr/commit/2e5c55959d21935a745410011a1ee1855bd3de9e", "committedDate": "2020-10-21T22:42:18Z", "message": "LUCENE-9582: rename VectorValues.ScoreFunction to SearchStrategy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDI2MjQ5", "url": "https://github.com/apache/lucene-solr/pull/2018#pullrequestreview-515026249", "createdAt": "2020-10-22T18:54:07Z", "commit": {"oid": "2e5c55959d21935a745410011a1ee1855bd3de9e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxODo1NDowN1rOHmveeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxODo1NDowN1rOHmveeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM4NTc4Ng==", "bodyText": "Should we add a light unit test for these utility methods?", "url": "https://github.com/apache/lucene-solr/pull/2018#discussion_r510385786", "createdAt": "2020-10-22T18:54:07Z", "author": {"login": "jtibshirani"}, "path": "lucene/core/src/java/org/apache/lucene/util/VectorUtil.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.lucene.util;\n+ \n+/**\n+ * Utilities for computations with numeric arrays\n+ */\n+public final class VectorUtil {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e5c55959d21935a745410011a1ee1855bd3de9e"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c41dc86f94b86b6b727a7377d925dc5d341fe894", "author": {"user": null}, "url": "https://github.com/apache/lucene-solr/commit/c41dc86f94b86b6b727a7377d925dc5d341fe894", "committedDate": "2020-10-23T14:19:27Z", "message": "add TestVectorUtil"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1OTM0MDU3", "url": "https://github.com/apache/lucene-solr/pull/2018#pullrequestreview-515934057", "createdAt": "2020-10-23T19:03:10Z", "commit": {"oid": "c41dc86f94b86b6b727a7377d925dc5d341fe894"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxOTowMzoxMVrOHnaTew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxOToxMjowMlrOHnaoeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTA4NzQ4Mw==", "bodyText": "Just noticed this rename seems accidental.", "url": "https://github.com/apache/lucene-solr/pull/2018#discussion_r511087483", "createdAt": "2020-10-23T19:03:11Z", "author": {"login": "jtibshirani"}, "path": "lucene/queries/src/java/org/apache/lucene/queries/intervals/IntervalQuery.java", "diffHunk": "@@ -99,7 +99,7 @@ public IntervalQuery(String field, IntervalsSource intervalsSource, float pivot,\n   private IntervalQuery(String field, IntervalsSource intervalsSource, IntervalScoreFunction scoreFunction) {\n     Objects.requireNonNull(field, \"null field aren't accepted\");\n     Objects.requireNonNull(intervalsSource, \"null intervalsSource aren't accepted\");\n-    Objects.requireNonNull(scoreFunction, \"null scoreFunction aren't accepted\");\n+    Objects.requireNonNull(scoreFunction, \"null searchStrategy aren't accepted\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41dc86f94b86b6b727a7377d925dc5d341fe894"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTA5Mjg1Nw==", "bodyText": "Small comment: I don't think you mean MSE here since it's not a mean, it could be 'squared distance' ?", "url": "https://github.com/apache/lucene-solr/pull/2018#discussion_r511092857", "createdAt": "2020-10-23T19:12:02Z", "author": {"login": "jtibshirani"}, "path": "lucene/core/src/test/org/apache/lucene/util/TestVectorUtil.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.lucene.util;\n+\n+public class TestVectorUtil extends LuceneTestCase {\n+\n+  public void testBasicDotProduct() {\n+    assertEquals(5, VectorUtil.dotProduct(new float[]{1, 2, 3}, new float[]{-10, 0, 5}), 0);\n+  }\n+\n+  public void testSelfDotProduct() {\n+    // the dot product of a vector with itself is equal to the sum of the squares of its components\n+    float[] v = randomVector();\n+    assertEquals(l2(v), VectorUtil.dotProduct(v, v), 1e-5);\n+  }\n+\n+  public void testOrthogonalDotProduct() {\n+    // the dot product of two perpendicular vectors is 0\n+    float[] v = new float[2];\n+    v[0] = random().nextInt(100);\n+    v[1] = random().nextInt(100);\n+    float[] u = new float[2];\n+    u[0] = v[1];\n+    u[1] = -v[0];\n+    assertEquals(0, VectorUtil.dotProduct(u, v), 1e-5);\n+  }\n+\n+  public void testSelfSquareSum() {\n+    // the l2 distance of a vector with itself is zero\n+    float[] v = randomVector();\n+    assertEquals(0, VectorUtil.squareSum(v, v), 1e-5);\n+  }\n+\n+  public void testBasicSquareSum() {\n+    assertEquals(12, VectorUtil.squareSum(new float[]{1, 2, 3}, new float[]{-1, 0, 5}), 0);\n+  }\n+\n+  public void testRandomSquareSum() {\n+    // the MSE of a vector with its inverse is equal to four times the sum of squares of its components", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41dc86f94b86b6b727a7377d925dc5d341fe894"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60624fa59254b1fe5fb1e2b092964eb59e5e5d0e", "author": {"user": null}, "url": "https://github.com/apache/lucene-solr/commit/60624fa59254b1fe5fb1e2b092964eb59e5e5d0e", "committedDate": "2020-10-23T21:29:17Z", "message": "address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64ee9eb4208bde77034423edb21a598ece6ab2a5", "author": {"user": null}, "url": "https://github.com/apache/lucene-solr/commit/64ee9eb4208bde77034423edb21a598ece6ab2a5", "committedDate": "2020-10-23T21:33:48Z", "message": "renamed squareSum to squareDistance"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2507, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}