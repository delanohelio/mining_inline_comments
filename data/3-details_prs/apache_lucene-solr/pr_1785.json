{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNjUzMzIy", "number": 1785, "title": "Update Circuit Breaker configured as a standard plugin", "bodyText": "This commit refactors circuit breaker configurations to use PluginInfo and reduce the footprint on SolrConfig.", "createdAt": "2020-08-26T05:21:46Z", "url": "https://github.com/apache/lucene-solr/pull/1785", "merged": true, "mergeCommit": {"oid": "6a7da3cd508f5b1e445df08aa2f1fa926d586e99"}, "closed": true, "closedAt": "2020-08-27T08:36:23Z", "author": {"login": "atris"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCkdb0gH2gAyNDczNjUzMzIyOmU0YWU1NGIxMjUwZjM0ZThiZTA2MjU0NWNjYWRiYWQyZjEwNDhkMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdC7_63AH2gAyNDczNjUzMzIyOjAwOTQzNjBmNmNlNjhmZWY0MTYxNTc3NGNmY2Y0MmMwNWIzMjRkNjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e4ae54b1250f34e8be062545ccadbad2f1048d2a", "author": {"user": {"login": "atris", "name": "Atri Sharma"}}, "url": "https://github.com/apache/lucene-solr/commit/e4ae54b1250f34e8be062545ccadbad2f1048d2a", "committedDate": "2020-08-26T04:53:49Z", "message": "Update Circuit Breaker Configuration to Use Plugins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a80bcc731beb99f9c254488410b7ad9c42faaf16", "author": {"user": {"login": "atris", "name": "Atri Sharma"}}, "url": "https://github.com/apache/lucene-solr/commit/a80bcc731beb99f9c254488410b7ad9c42faaf16", "committedDate": "2020-08-26T05:32:03Z", "message": "Fix precommit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b3c1671c2ec35669a81a5b83ceb227afaf7aa78", "author": {"user": {"login": "atris", "name": "Atri Sharma"}}, "url": "https://github.com/apache/lucene-solr/commit/8b3c1671c2ec35669a81a5b83ceb227afaf7aa78", "committedDate": "2020-08-26T05:43:47Z", "message": "More precommit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MjY4MTI2", "url": "https://github.com/apache/lucene-solr/pull/1785#pullrequestreview-475268126", "createdAt": "2020-08-26T08:30:58Z", "commit": {"oid": "8b3c1671c2ec35669a81a5b83ceb227afaf7aa78"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMDo1OFrOHHBl5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMzoyOFrOHHBsBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzEyODE2NQ==", "bodyText": "Make CircuitBreakerManager implement PluginInfoInitialized", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r477128165", "createdAt": "2020-08-26T08:30:58Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/java/org/apache/solr/core/SolrCore.java", "diffHunk": "@@ -1174,7 +1174,8 @@ private SolrCoreMetricManager initCoreMetricManager(SolrConfig config) {\n   }\n \n   private CircuitBreakerManager initCircuitBreakerManager() {\n-    CircuitBreakerManager circuitBreakerManager = CircuitBreakerManager.build(solrConfig);\n+    final PluginInfo info = solrConfig.getPluginInfo(CircuitBreakerManager.class.getName());\n+    CircuitBreakerManager circuitBreakerManager = CircuitBreakerManager.build(info.initArgs);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b3c1671c2ec35669a81a5b83ceb227afaf7aa78"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzEyOTczNA==", "bodyText": "standard syntax for enabled is\n<circuitBreaker class=\"solr.CircuitBreakerManager\" enabled=\"true\">", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r477129734", "createdAt": "2020-08-26T08:33:28Z", "author": {"login": "noblepaul"}, "path": "solr/solr-ref-guide/src/query-settings-in-solrconfig.adoc", "diffHunk": "@@ -172,24 +172,54 @@ This parameter sets the maximum number of documents to cache for any entry in th\n <queryResultMaxDocsCached>200</queryResultMaxDocsCached>\n ----\n \n-=== useCircuitBreakers\n+=== circuitBreaker\n \n-Global control flag for enabling circuit breakers.\n+This set of configurations control the behaviour of circuit breakers.\n \n [source,xml]\n ----\n-<useCircuitBreakers>true</useCircuitBreakers>\n+<circuitBreaker class=\"solr.CircuitBreakerManager\">\n+  <!-- All specific configs in this section -->\n+</circuitBreaker>\n ----\n \n-=== memoryCircuitBreakerThresholdPct\n+To control whether Circuit Breakers are globally enabled, use the following flag:\n+\n+[source,xml]\n+----\n+<str name=\"enabled\">true</str>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b3c1671c2ec35669a81a5b83ceb227afaf7aa78"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f1a9e37c234d3b9fcb3dc257c0cd04cf4f5476f", "author": {"user": {"login": "atris", "name": "Atri Sharma"}}, "url": "https://github.com/apache/lucene-solr/commit/2f1a9e37c234d3b9fcb3dc257c0cd04cf4f5476f", "committedDate": "2020-08-26T11:14:26Z", "message": "Update per comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40ea9508cee3f002d5e6f4582919983d469b53d4", "author": {"user": {"login": "atris", "name": "Atri Sharma"}}, "url": "https://github.com/apache/lucene-solr/commit/40ea9508cee3f002d5e6f4582919983d469b53d4", "committedDate": "2020-08-26T14:06:04Z", "message": "Update docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NjUzMzY4", "url": "https://github.com/apache/lucene-solr/pull/1785#pullrequestreview-475653368", "createdAt": "2020-08-26T16:21:32Z", "commit": {"oid": "40ea9508cee3f002d5e6f4582919983d469b53d4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjoyMTozMlrOHHT06A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjoyMTozMlrOHHT06A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQyNjkyMA==", "bodyText": "can we avoid adding new suppress to the code please?", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r477426920", "createdAt": "2020-08-26T16:21:32Z", "author": {"login": "madrob"}, "path": "solr/core/src/java/org/apache/solr/util/circuitbreaker/CircuitBreakerManager.java", "diffHunk": "@@ -121,19 +135,41 @@ public static String toErrorMessage(List<CircuitBreaker> circuitBreakerList) {\n    *\n    * Any default circuit breakers should be registered here.\n    */\n-  public static CircuitBreakerManager build(SolrConfig solrConfig) {\n-    CircuitBreakerManager circuitBreakerManager = new CircuitBreakerManager(solrConfig.useCircuitBreakers);\n-\n-    // Install the default circuit breakers\n-    CircuitBreaker memoryCircuitBreaker = new MemoryCircuitBreaker(solrConfig);\n-    CircuitBreaker cpuCircuitBreaker = new CPUCircuitBreaker(solrConfig);\n+  @SuppressWarnings({\"rawtypes\"})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40ea9508cee3f002d5e6f4582919983d469b53d4"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0094360f6ce68fef41615774cfcf42c05b324d69", "author": {"user": {"login": "atris", "name": "Atri Sharma"}}, "url": "https://github.com/apache/lucene-solr/commit/0094360f6ce68fef41615774cfcf42c05b324d69", "committedDate": "2020-08-27T08:19:18Z", "message": "Update args input"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2407, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}