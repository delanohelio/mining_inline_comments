{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1MjE1MjIy", "number": 1932, "title": "Reuse crypto keys in reference impl", "bodyText": "The key pair generation is expensive and instead of disabling public key handler We should just reuse a single key pair in the entire test suite.", "createdAt": "2020-09-30T02:37:12Z", "url": "https://github.com/apache/lucene-solr/pull/1932", "merged": true, "mergeCommit": {"oid": "083cd54feef1294979b5570779ac5e9ed9d98cfe"}, "closed": true, "closedAt": "2020-10-09T04:09:09Z", "author": {"login": "noblepaul"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNzd0pgH2gAyNDk1MjE1MjIyOmE5NGYwMmQ0NmNhYWE1MGQxZGE1MDE5OWNmNWFjMTIzYmU5NGI4MTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQuL1bgH2gAyNDk1MjE1MjIyOjg1NjZmMjhlNTNjZmU2Mzc4ODBmMDgyN2U4MDM4YWFhNTQwYzE4ZTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815", "author": {"user": {"login": "noblepaul", "name": "Noble Paul"}}, "url": "https://github.com/apache/lucene-solr/commit/a94f02d46caaa50d1da50199cf5ac123be94b815", "committedDate": "2020-09-30T02:35:59Z", "message": "Reuse key pair instead of disabling PublicKeyHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NzA3NDIz", "url": "https://github.com/apache/lucene-solr/pull/1932#pullrequestreview-499707423", "createdAt": "2020-09-30T18:34:24Z", "commit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODozNDoyNFrOHaqY5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODozNDoyNFrOHaqY5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcxOTUyNQ==", "bodyText": "Why not use the key-pair that's already on disk? See https://github.com/apache/lucene-solr/blob/master/solr/test-framework/src/java/org/apache/solr/SolrTestCaseJ4.java#L289-L290", "url": "https://github.com/apache/lucene-solr/pull/1932#discussion_r497719525", "createdAt": "2020-09-30T18:34:24Z", "author": {"login": "madrob"}, "path": "solr/test-framework/src/java/org/apache/solr/SolrTestCase.java", "diffHunk": "@@ -124,6 +126,17 @@\n \n   protected volatile static PerThreadExecService testExecutor;\n \n+  private static final CryptoKeys.RSAKeyPair reusedKeys = new CryptoKeys.RSAKeyPair();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5ODQ0NzU2", "url": "https://github.com/apache/lucene-solr/pull/1932#pullrequestreview-499844756", "createdAt": "2020-09-30T22:04:02Z", "commit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMjowNDowMlrOHaw8xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMjowNDowMlrOHaw8xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgyNzAxMg==", "bodyText": "Looks like I had this reversed. We should likely enable reuse below in the non Nightly run and disable for the closer to prod Nightly run.", "url": "https://github.com/apache/lucene-solr/pull/1932#discussion_r497827012", "createdAt": "2020-09-30T22:04:02Z", "author": {"login": "markrmiller"}, "path": "solr/test-framework/src/java/org/apache/solr/SolrTestCase.java", "diffHunk": "@@ -225,7 +238,7 @@ public static void setDefaultConfigDirSysPropIfNotSet() throws Exception {\n     System.setProperty(\"solr.clustering.enabled\", \"false\");\n     System.setProperty(\"solr.peerSync.useRangeVersions\", String.valueOf(random().nextBoolean()));\n     System.setProperty(\"zookeeper.nio.directBufferBytes\", Integer.toString(32 * 1024 * 2));\n-    System.setProperty(\"solr.disablePublicKeyHandler\", \"true\");\n+    enableReuseOfCryptoKeys();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5ODQ1Nzc4", "url": "https://github.com/apache/lucene-solr/pull/1932#pullrequestreview-499845778", "createdAt": "2020-09-30T22:06:07Z", "commit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMjowNjowN1rOHaxAFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMjowNjowN1rOHaxAFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgyNzg2MQ==", "bodyText": "Let's enable reuse here instead.", "url": "https://github.com/apache/lucene-solr/pull/1932#discussion_r497827861", "createdAt": "2020-09-30T22:06:07Z", "author": {"login": "markrmiller"}, "path": "solr/test-framework/src/java/org/apache/solr/SolrTestCase.java", "diffHunk": "@@ -225,7 +238,7 @@ public static void setDefaultConfigDirSysPropIfNotSet() throws Exception {\n     System.setProperty(\"solr.clustering.enabled\", \"false\");\n     System.setProperty(\"solr.peerSync.useRangeVersions\", String.valueOf(random().nextBoolean()));\n     System.setProperty(\"zookeeper.nio.directBufferBytes\", Integer.toString(32 * 1024 * 2));\n-    System.setProperty(\"solr.disablePublicKeyHandler\", \"true\");\n+    enableReuseOfCryptoKeys();\n \n     if (!TEST_NIGHTLY) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94f02d46caaa50d1da50199cf5ac123be94b815"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8566f28e53cfe637880f0827e8038aaa540c18e1", "author": {"user": {"login": "noblepaul", "name": "Noble Paul"}}, "url": "https://github.com/apache/lucene-solr/commit/8566f28e53cfe637880f0827e8038aaa540c18e1", "committedDate": "2020-10-09T04:08:35Z", "message": "read from provided public/private keys in tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2664, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}