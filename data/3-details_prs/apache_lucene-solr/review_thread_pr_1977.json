{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNzExNzE2", "number": 1977, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMjozNDo1MFrOEszPVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMjozNDo1MFrOEszPVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NDEyMzA4OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/handler/admin/ConfigSetsHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMjozNDo1MFrOHgPTSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMzoxNjowOFrOHgQGHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU2NzE3OQ==", "bodyText": "should we error instead of silently ignoring the cleanup param? it defaults to false, so someone must have explicitly set it to true", "url": "https://github.com/apache/lucene-solr/pull/1977#discussion_r503567179", "createdAt": "2020-10-12T22:34:50Z", "author": {"login": "tflobbe"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ConfigSetsHandler.java", "diffHunk": "@@ -170,10 +170,14 @@ private void handleConfigUploadRequest(SolrQueryRequest req, SolrQueryResponse r\n \n     boolean overwritesExisting = zkClient.exists(configPathInZk, true);\n \n-    if (overwritesExisting && !req.getParams().getBool(ConfigSetParams.OVERWRITE, false)) {\n-      throw new SolrException(ErrorCode.BAD_REQUEST,\n-          \"The configuration \" + configSetName + \" already exists in zookeeper\");\n-    }\n+    // Get upload parameters\n+    String singleFilePath = req.getParams().get(ConfigSetParams.FILE_PATH, \"\");\n+    boolean allowOverwrite = req.getParams().getBool(ConfigSetParams.OVERWRITE, false);\n+    // Cleanup is not allowed while using singleFilePath upload\n+    boolean cleanup = singleFilePath.isEmpty() && req.getParams().getBool(ConfigSetParams.CLEANUP, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d45fac6cb4cf116d0cb2d067812514d4133c7e7"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU4MDE4OQ==", "bodyText": "Added error handling for that and cases where a bad filePath is given.", "url": "https://github.com/apache/lucene-solr/pull/1977#discussion_r503580189", "createdAt": "2020-10-12T23:16:08Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ConfigSetsHandler.java", "diffHunk": "@@ -170,10 +170,14 @@ private void handleConfigUploadRequest(SolrQueryRequest req, SolrQueryResponse r\n \n     boolean overwritesExisting = zkClient.exists(configPathInZk, true);\n \n-    if (overwritesExisting && !req.getParams().getBool(ConfigSetParams.OVERWRITE, false)) {\n-      throw new SolrException(ErrorCode.BAD_REQUEST,\n-          \"The configuration \" + configSetName + \" already exists in zookeeper\");\n-    }\n+    // Get upload parameters\n+    String singleFilePath = req.getParams().get(ConfigSetParams.FILE_PATH, \"\");\n+    boolean allowOverwrite = req.getParams().getBool(ConfigSetParams.OVERWRITE, false);\n+    // Cleanup is not allowed while using singleFilePath upload\n+    boolean cleanup = singleFilePath.isEmpty() && req.getParams().getBool(ConfigSetParams.CLEANUP, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU2NzE3OQ=="}, "originalCommit": {"oid": "5d45fac6cb4cf116d0cb2d067812514d4133c7e7"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1145, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}