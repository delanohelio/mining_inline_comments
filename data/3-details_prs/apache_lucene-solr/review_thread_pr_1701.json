{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3NDYwNDU0", "number": 1701, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo1MjozOFrOESvT4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwODozNzoxNlrOETJ2Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MDg0OTYzOnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/handler/admin/ZookeeperStatusHandler.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo1MjozOFrOG4FWFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwODoyODozNlrOG4uHIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ2MTAxNQ==", "bodyText": "This is not bullet proof if e.g. user has clientPort=1234 in zoo.cfg and in zkHost connection string. Then we'll add a warning that dynamic config differs from zkHost, which is not entirely true since we just lack the port part. We have no way from client to read the clientPort from server except from connecting to the server with 4LW ont the clientPort which is a chicken and egg. This hack will make the comparison work for default port, which is a compromise.", "url": "https://github.com/apache/lucene-solr/pull/1701#discussion_r461461015", "createdAt": "2020-07-28T09:52:38Z", "author": {"login": "janhoy"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ZookeeperStatusHandler.java", "diffHunk": "@@ -112,15 +112,21 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n           .map(h -> h.resolveClientPortAddress() + \":\" + h.clientPort)\n           .sorted().collect(Collectors.toList());\n       List<String> dynamicHosts = zkDynamicConfig.getServers().stream()\n-          .map(h -> h.resolveClientPortAddress() + \":\" + h.clientPort)\n+          .map(h -> h.resolveClientPortAddress() + \":\" + (h.clientPort != null ? h.clientPort : \"2181\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6328d2053b8b87309d2c2a55cfcf8ba3ff267818"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc3NzE3Mg==", "bodyText": "Maybe instead of defaulting to 2181, we default to hostsFromConnectionString.getServers().get(0).clientPort? I imagine that would match a vast majority of scenarios.", "url": "https://github.com/apache/lucene-solr/pull/1701#discussion_r461777172", "createdAt": "2020-07-28T18:12:49Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ZookeeperStatusHandler.java", "diffHunk": "@@ -112,15 +112,21 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n           .map(h -> h.resolveClientPortAddress() + \":\" + h.clientPort)\n           .sorted().collect(Collectors.toList());\n       List<String> dynamicHosts = zkDynamicConfig.getServers().stream()\n-          .map(h -> h.resolveClientPortAddress() + \":\" + h.clientPort)\n+          .map(h -> h.resolveClientPortAddress() + \":\" + (h.clientPort != null ? h.clientPort : \"2181\"))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ2MTAxNQ=="}, "originalCommit": {"oid": "6328d2053b8b87309d2c2a55cfcf8ba3ff267818"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjEyODkzMA==", "bodyText": "Agree, I'll do that change and merge", "url": "https://github.com/apache/lucene-solr/pull/1701#discussion_r462128930", "createdAt": "2020-07-29T08:28:36Z", "author": {"login": "janhoy"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ZookeeperStatusHandler.java", "diffHunk": "@@ -112,15 +112,21 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n           .map(h -> h.resolveClientPortAddress() + \":\" + h.clientPort)\n           .sorted().collect(Collectors.toList());\n       List<String> dynamicHosts = zkDynamicConfig.getServers().stream()\n-          .map(h -> h.resolveClientPortAddress() + \":\" + h.clientPort)\n+          .map(h -> h.resolveClientPortAddress() + \":\" + (h.clientPort != null ? h.clientPort : \"2181\"))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ2MTAxNQ=="}, "originalCommit": {"oid": "6328d2053b8b87309d2c2a55cfcf8ba3ff267818"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTE5NzcxOnYy", "diffSide": "RIGHT", "path": "solr/CHANGES.txt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwODozNzoxNlrOG4ucog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwODozNzoxNlrOG4ucog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjEzNDQzNA==", "bodyText": "@janhoy Typo in Nu[m]berFormatException", "url": "https://github.com/apache/lucene-solr/pull/1701#discussion_r462134434", "createdAt": "2020-07-29T08:37:16Z", "author": {"login": "henrik242"}, "path": "solr/CHANGES.txt", "diffHunk": "@@ -164,6 +164,13 @@ Other Changes\n \n * SOLR-11868: Deprecate CloudSolrClient.setIdField, use information from Zookeeper (Erick Erickson)\n \n+==================  8.6.1 ==================\n+\n+Bug Fixes\n+---------------------\n+\n+* SOLR-14671: Parsing dynamic ZK config sometimes cause NuberFormatException (janhoy)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5593b7e437ecd55f99170364112c0fd96d71ede9"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1394, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}