{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNjUzMzIy", "number": 1785, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMDo1OFrOEceIIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjoyMTozMlrOEcpqmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4Mjg5MTg2OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/core/SolrCore.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMDo1OFrOHHBl5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMDo1OFrOHHBl5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzEyODE2NQ==", "bodyText": "Make CircuitBreakerManager implement PluginInfoInitialized", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r477128165", "createdAt": "2020-08-26T08:30:58Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/java/org/apache/solr/core/SolrCore.java", "diffHunk": "@@ -1174,7 +1174,8 @@ private SolrCoreMetricManager initCoreMetricManager(SolrConfig config) {\n   }\n \n   private CircuitBreakerManager initCircuitBreakerManager() {\n-    CircuitBreakerManager circuitBreakerManager = CircuitBreakerManager.build(solrConfig);\n+    final PluginInfo info = solrConfig.getPluginInfo(CircuitBreakerManager.class.getName());\n+    CircuitBreakerManager circuitBreakerManager = CircuitBreakerManager.build(info.initArgs);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b3c1671c2ec35669a81a5b83ceb227afaf7aa78"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MjkwMTc3OnYy", "diffSide": "RIGHT", "path": "solr/solr-ref-guide/src/query-settings-in-solrconfig.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMzoyOFrOHHBsBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwODozMzoyOFrOHHBsBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzEyOTczNA==", "bodyText": "standard syntax for enabled is\n<circuitBreaker class=\"solr.CircuitBreakerManager\" enabled=\"true\">", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r477129734", "createdAt": "2020-08-26T08:33:28Z", "author": {"login": "noblepaul"}, "path": "solr/solr-ref-guide/src/query-settings-in-solrconfig.adoc", "diffHunk": "@@ -172,24 +172,54 @@ This parameter sets the maximum number of documents to cache for any entry in th\n <queryResultMaxDocsCached>200</queryResultMaxDocsCached>\n ----\n \n-=== useCircuitBreakers\n+=== circuitBreaker\n \n-Global control flag for enabling circuit breakers.\n+This set of configurations control the behaviour of circuit breakers.\n \n [source,xml]\n ----\n-<useCircuitBreakers>true</useCircuitBreakers>\n+<circuitBreaker class=\"solr.CircuitBreakerManager\">\n+  <!-- All specific configs in this section -->\n+</circuitBreaker>\n ----\n \n-=== memoryCircuitBreakerThresholdPct\n+To control whether Circuit Breakers are globally enabled, use the following flag:\n+\n+[source,xml]\n+----\n+<str name=\"enabled\">true</str>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b3c1671c2ec35669a81a5b83ceb227afaf7aa78"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NDc4MjMzOnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/util/circuitbreaker/CircuitBreakerManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjoyMTozMlrOHHT06A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwODoyMjo1MFrOHIFqdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQyNjkyMA==", "bodyText": "can we avoid adding new suppress to the code please?", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r477426920", "createdAt": "2020-08-26T16:21:32Z", "author": {"login": "madrob"}, "path": "solr/core/src/java/org/apache/solr/util/circuitbreaker/CircuitBreakerManager.java", "diffHunk": "@@ -121,19 +135,41 @@ public static String toErrorMessage(List<CircuitBreaker> circuitBreakerList) {\n    *\n    * Any default circuit breakers should be registered here.\n    */\n-  public static CircuitBreakerManager build(SolrConfig solrConfig) {\n-    CircuitBreakerManager circuitBreakerManager = new CircuitBreakerManager(solrConfig.useCircuitBreakers);\n-\n-    // Install the default circuit breakers\n-    CircuitBreaker memoryCircuitBreaker = new MemoryCircuitBreaker(solrConfig);\n-    CircuitBreaker cpuCircuitBreaker = new CPUCircuitBreaker(solrConfig);\n+  @SuppressWarnings({\"rawtypes\"})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40ea9508cee3f002d5e6f4582919983d469b53d4"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI0MzQ0NQ==", "bodyText": "Unfortunately, that is the way NamedArgs are structured in PluginInfo -- we need to fix that before we remove this warning. I will follow up.", "url": "https://github.com/apache/lucene-solr/pull/1785#discussion_r478243445", "createdAt": "2020-08-27T08:22:50Z", "author": {"login": "atris"}, "path": "solr/core/src/java/org/apache/solr/util/circuitbreaker/CircuitBreakerManager.java", "diffHunk": "@@ -121,19 +135,41 @@ public static String toErrorMessage(List<CircuitBreaker> circuitBreakerList) {\n    *\n    * Any default circuit breakers should be registered here.\n    */\n-  public static CircuitBreakerManager build(SolrConfig solrConfig) {\n-    CircuitBreakerManager circuitBreakerManager = new CircuitBreakerManager(solrConfig.useCircuitBreakers);\n-\n-    // Install the default circuit breakers\n-    CircuitBreaker memoryCircuitBreaker = new MemoryCircuitBreaker(solrConfig);\n-    CircuitBreaker cpuCircuitBreaker = new CPUCircuitBreaker(solrConfig);\n+  @SuppressWarnings({\"rawtypes\"})", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQyNjkyMA=="}, "originalCommit": {"oid": "40ea9508cee3f002d5e6f4582919983d469b53d4"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1330, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}