{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMTQ0ODYy", "number": 1359, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOToyODo0NlrODpP-rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMDowMzoyNlrODpUcOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NTgwMDE0OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOToyODo0NlrOF4T0Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOToyODo0NlrOF4T0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU4OTIzNQ==", "bodyText": "If directory hash was not computed I would throw IllegalStateException instead of returning false. This will help identify the programming error faster.", "url": "https://github.com/apache/lucene-solr/pull/1359#discussion_r394589235", "createdAt": "2020-03-18T19:28:46Z", "author": {"login": "mbwaheed"}, "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "diffHunk": "@@ -214,23 +228,23 @@ public String getDirectoryHash() {\n \n   /**\n    * Returns <code>true</code> if the contents of the directory passed into this method is identical to the contents of\n-   * the directory of the Solr core of this instance, taken at instance creation time.<p>\n+   * the directory of the Solr core of this instance, taken at instance creation time. If the directory hash was not \n+   * computed at the instance creation time, then this returns <code>false</code>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68988462cb3472345a60c914c8423b63f6e879c3"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NTgxMTY0OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/store/blob/process/CorePullTask.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOTozMjozNFrOF4T7ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxOTozMjozNFrOF4T7ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU5MTEzNA==", "bodyText": "Maybe add a short comment explaining the passed value of captureDirHash. Same comment for BlobStoreUtils.java and CorePusher.java.", "url": "https://github.com/apache/lucene-solr/pull/1359#discussion_r394591134", "createdAt": "2020-03-18T19:32:34Z", "author": {"login": "mbwaheed"}, "path": "solr/core/src/java/org/apache/solr/store/blob/process/CorePullTask.java", "diffHunk": "@@ -286,7 +286,7 @@ void pullCoreFromBlob(boolean isLeaderPulling) throws InterruptedException {\n       }\n \n       // Get local metadata + resolve with blob metadata. Given we're doing a pull, don't need to reserve commit point\n-      ServerSideMetadata serverMetadata = new ServerSideMetadata(pullCoreInfo.getCoreName(), storeManager.getCoreContainer(), false);\n+      ServerSideMetadata serverMetadata = new ServerSideMetadata(pullCoreInfo.getCoreName(), storeManager.getCoreContainer(), false, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68988462cb3472345a60c914c8423b63f6e879c3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NjUxNTM4OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMzo1NToxNlrOF4a4ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMDowMjo0MlrOF4bBBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcwNTAzNA==", "bodyText": "typo: is=if?", "url": "https://github.com/apache/lucene-solr/pull/1359#discussion_r394705034", "createdAt": "2020-03-18T23:55:16Z", "author": {"login": "mbwaheed"}, "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "diffHunk": "@@ -212,9 +212,12 @@ public long getGeneration() {\n   }\n \n   /**\n-   * @return Null if the directory hash was not computed for the given Core \n+   * @throw IllegalStateException is this instance was not created with a computed directoryHash ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c52294675d52b408a98d227dfa9a40a36b237440"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcwNzIwNg==", "bodyText": "Actually I don't see this method being used any where. It'll be better to delete the method.", "url": "https://github.com/apache/lucene-solr/pull/1359#discussion_r394707206", "createdAt": "2020-03-19T00:02:42Z", "author": {"login": "mbwaheed"}, "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "diffHunk": "@@ -212,9 +212,12 @@ public long getGeneration() {\n   }\n \n   /**\n-   * @return Null if the directory hash was not computed for the given Core \n+   * @throw IllegalStateException is this instance was not created with a computed directoryHash ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcwNTAzNA=="}, "originalCommit": {"oid": "c52294675d52b408a98d227dfa9a40a36b237440"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NjUzMTE0OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMDowMzoyNlrOF4bCBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMDowMzoyNlrOF4bCBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcwNzQ2MQ==", "bodyText": "typo is=if?", "url": "https://github.com/apache/lucene-solr/pull/1359#discussion_r394707461", "createdAt": "2020-03-19T00:03:26Z", "author": {"login": "mbwaheed"}, "path": "solr/core/src/java/org/apache/solr/store/blob/metadata/ServerSideMetadata.java", "diffHunk": "@@ -229,13 +232,18 @@ public String getDirectoryHash() {\n   /**\n    * Returns <code>true</code> if the contents of the directory passed into this method is identical to the contents of\n    * the directory of the Solr core of this instance, taken at instance creation time. If the directory hash was not \n-   * computed at the instance creation time, then this returns <code>false</code>\n+   * computed at the instance creation time, then we throw an IllegalStateException indicating a programming error.\n    *\n    * Passing in the Directory (expected to be the directory of the same core used during construction) because it seems\n    * safer than trying to get it again here...\n+   * \n+   * @throw IllegalStateException is this instance was not created with a computed directoryHash ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c52294675d52b408a98d227dfa9a40a36b237440"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 875, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}