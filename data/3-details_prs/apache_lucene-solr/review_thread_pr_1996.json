{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0OTk3NDE0", "number": 1996, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwMTo0OTo1OVrOEu3l_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjo0MTowOVrOEv4YyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3NTgwNzk5OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "isResolved": true, "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwMTo0OTo1OVrOHjhGyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMDoyNjozOFrOHmDm7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ==", "bodyText": "Let's use a proper REST mechanism here\npath =\"/cluster/configs/{configname}/*", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r507004619", "createdAt": "2020-10-18T01:49:59Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzgxNDA5MQ==", "bodyText": "Would you be ok with /cluster/configs/{configname}/files/*? That's very restful, since it would be updating the * file under the {configname} config", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r507814091", "createdAt": "2020-10-19T14:47:56Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwNzIwOQ==", "bodyText": "I've updated the PR to reflect this new API.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r507907209", "createdAt": "2020-10-19T16:56:41Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODExNjU4Mw==", "bodyText": "I'm Ok with both\n/cluster/configs/{configname}/files/*\nand\n/cluster/configs/{configname}/*\n@janhoy @dsmiley @sigram  WDYT?", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508116583", "createdAt": "2020-10-19T23:18:28Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODE4NjYxNw==", "bodyText": "I don't see the point of the \"/files/\" component of the path.  The files within the configSet are directly in it, so I think it should be that way.  I think of this very much like a file in a folder, where the folder is the configSet.\nJust checking that we support nested structure within the configSet?", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508186617", "createdAt": "2020-10-20T03:25:19Z", "author": {"login": "dsmiley"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODIwMzQzMA==", "bodyText": "We do support the nested structure.\nThe /files/ part defines what the * after it is, and allows us to extend in the future. For example possible adding a /cluster/configs/{configname}/properties PUT action to update the properties for that config. It fits pretty well in the guidelines.\nIt's not that important to me though if y'all agree with taking it out.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508203430", "createdAt": "2020-10-20T04:34:27Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODIwODU2Ng==", "bodyText": "Just checking that we support nested structure within the configSet?\n\nWe could. But, I'm OK to add support for that later", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508208566", "createdAt": "2020-10-20T04:54:29Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ3NTE4NQ==", "bodyText": "To support properties manipulation in the future, I think that could be done via a POST to the particular path to the properties file in the configSet (I forget if it exists already or maybe should be exactly params.json) with commands in the JSON to delete/set/update etc.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508475185", "createdAt": "2020-10-20T12:53:58Z", "author": {"login": "dsmiley"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODUwOTUxMg==", "bodyText": "Ok sounds good, that would certainly work. I'll take out the /files/ part of the path, and update the PR and Jira.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508509512", "createdAt": "2020-10-20T13:37:18Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE0NTM5MQ==", "bodyText": "I'm not a REST specialist but I think I would prefer to leave the files component of the path in. Wouldn't this allow changing other things in the future and make the API more self describing?\nWould it really be easy to add it later?\nIf we wanted to add properties for example, how to tell if /cluster/configs/{configname}/properties/whatever is a property whatever or if properties/whatever is actually a file?", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r509145391", "createdAt": "2020-10-21T09:52:51Z", "author": {"login": "murblanc"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE0NjcxMA==", "bodyText": "Also \"file\" is a pretty generic abstraction that can represent many things (a schema, properties, synonyms etc). We might eventually want to address such ressources by what they actually are (schema, properties, synonyms) rather than by the way in which they are stored (files).", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r509146710", "createdAt": "2020-10-21T09:54:45Z", "author": {"login": "murblanc"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTUzNjkwMQ==", "bodyText": "I agree @murblanc, it lets us future-proof the API even if we don't have current plans on expanding beyond files.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r509536901", "createdAt": "2020-10-21T18:09:01Z", "author": {"login": "HoustonPutman"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTU2MjkwMQ==", "bodyText": "All very debatable of course.  Removing \"/files/\" doesn't prevent expanding beyond files, it's just that, for example, if we add a POST to say /configsetname/properties then we can't have a file named simply \"properties\".  I will shed no tear  over this loss :-).  I like the simplicity of not having the needless \"/files/\".", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r509562901", "createdAt": "2020-10-21T18:36:41Z", "author": {"login": "dsmiley"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYyOTc0MQ==", "bodyText": "@dsmiley, can users of Solr pick random names for some ConfigSet files? I believe code will be easier to understand/maintain if we don't have to parse file names to detect if they are files or some other form of separator (and then the API would be inconsistent: files will not have its /files segment in the path whereas properties will be defined after /properties).\nExamples in https://restfulapi.net/resource-naming/ would be a vote for keeping /files in the path IMO.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r509629741", "createdAt": "2020-10-21T19:54:23Z", "author": {"login": "murblanc"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY2NzA1Mw==", "bodyText": "People can add basically whatever named files they want and reference them from the primary config files (e.g. solrconfig.xml).  This discussion is similar to field naming in our schema.  Some names are special, like _version_.  If you try to have your own field named as such, then you're asking for trouble.  Likewise, we might suggest that users avoid file names with a leading underscore.  Simple enough and keeps the \"/files\" verbosity out.  Also there is a difference in HTTP verbs... in this issue here we're using PUT to put a file.  But for an interactive editing of config elements, that would use POST.", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r509667053", "createdAt": "2020-10-21T20:26:38Z", "author": {"login": "dsmiley"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDYxOQ=="}, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3NTgwODM2OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwMTo1MDoxMlrOHjhG8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwMTo1MDoxMlrOHjhG8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAwNDY1Ng==", "bodyText": "same as above", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r507004656", "createdAt": "2020-10-18T01:50:12Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/java/org/apache/solr/handler/ClusterAPI.java", "diffHunk": "@@ -133,6 +134,62 @@ public void create(PayloadObj<CreateConfigInfo> obj) throws Exception {\n \n   }\n \n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void uploadConfigSetWithOverwrite(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"),\n+            ConfigSetParams.OVERWRITE, true,\n+            ConfigSetParams.CLEANUP, req.getParams().getBool(ConfigSetParams.CLEANUP, false));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = POST,\n+      path =   \"/cluster/configs/{name}/file\",\n+      permission = CONFIG_EDIT_PERM\n+  )\n+  public void insertIntoConfigSet(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception {\n+    String path = req.getParams().get(ConfigSetParams.PATH);\n+    if (path == null || path.isBlank()) {\n+      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, \"In order to insert a file into a configSet, a valid 'path' parameter must be provided.\");\n+    }\n+    req = wrapParams(req,\n+            \"action\", ConfigSetParams.ConfigSetAction.UPLOAD.toString(),\n+            CommonParams.NAME, req.getPathTemplateValues().get(\"name\"));\n+    configSetsHandler.handleRequestBody(req, rsp);\n+  }\n+\n+  @EndPoint(method = PUT,\n+      path =   \"/cluster/configs/{name}/file\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37c2a5f63b88111fdffc28ce361045346760f4c1"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4NjQyMzc2OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/handler/admin/ConfigSetsHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjo0MTowOVrOHlHYFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNjo0MTowOVrOHlHYFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY4MDIxMg==", "bodyText": "Can we just use a boolean here?", "url": "https://github.com/apache/lucene-solr/pull/1996#discussion_r508680212", "createdAt": "2020-10-20T16:41:09Z", "author": {"login": "anshumg"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ConfigSetsHandler.java", "diffHunk": "@@ -230,7 +231,9 @@ private void handleConfigUploadRequest(SolrQueryRequest req, SolrQueryResponse r\n \n     ZipInputStream zis = new ZipInputStream(inputStream, StandardCharsets.UTF_8);\n     ZipEntry zipEntry = null;\n+    int entryCount = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7750043e74cbc51284eb336edc4759487f07cff8"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1161, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}