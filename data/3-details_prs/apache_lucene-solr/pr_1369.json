{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxODAwMjk5", "number": 1369, "title": "SOLR-14213: Allow enabling shared store to be scriptable", "bodyText": "Enhancing the configuration section to allow shared storage feature to be enabled via system properties vs just checking for presence of  section in solr.xml.\n<sharedStore>\n  <bool name=\"sharedStoreEnabled\">${sharedStoreEnabled:false}</bool>\n</sharedStore>\n\nShared storage is now only enabled if cloud mode is on,  section is present, and the field sharedStoreEnabled is present and set to true. If  is present but the field isn't, startup fails. The field supports system properties overriding whatever default is specified. This can be passed in via the solr binary such as\nbin/solr start -e cloud -noprompt -DsharedStoreEnabled=true\nor set by specifying the environment variable SHARE_STORE_ENABLED.", "createdAt": "2020-03-21T01:52:42Z", "url": "https://github.com/apache/lucene-solr/pull/1369", "merged": true, "mergeCommit": {"oid": "58d61b366d158dbf5404199a69ff3fa78b6f74d5"}, "closed": true, "closedAt": "2020-03-24T00:35:38Z", "author": {"login": "andyvuong"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPrDVDAH2gAyMzkxODAwMjk5OjBkZDIzMTUzMjI4NzkxNGE0NTMxNjQ3NTNmODM0OWQ4ZWYxN2FmOGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRisobgFqTM4MjQxOTg2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0dd231532287914a453164753f8349d8ef17af8b", "author": {"user": {"login": "andyvuong", "name": "Andy Vuong"}}, "url": "https://github.com/apache/lucene-solr/commit/0dd231532287914a453164753f8349d8ef17af8b", "committedDate": "2020-03-21T01:44:30Z", "message": "Allow enabling shared store to be scriptable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5Njg1MzM3", "url": "https://github.com/apache/lucene-solr/pull/1369#pullrequestreview-379685337", "createdAt": "2020-03-23T18:00:51Z", "commit": {"oid": "0dd231532287914a453164753f8349d8ef17af8b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxODowMDo1MVrOF6RiTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxODowMDo1MVrOF6RiTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjY0OTAzNg==", "bodyText": "fyi I moved the actual initialization method from SharedStoreConfig to SolrXmlConfig to avoid duplicating the existing field extraction methods or changing their visibility and so it aligns with how the rest of the section objects are being created. I've kept the SharedStoreConfig since I anticipate we'll start using it once we complete the enabling configurable's work.", "url": "https://github.com/apache/lucene-solr/pull/1369#discussion_r396649036", "createdAt": "2020-03-23T18:00:51Z", "author": {"login": "andyvuong"}, "path": "solr/core/src/java/org/apache/solr/core/SolrXmlConfig.java", "diffHunk": "@@ -568,4 +568,17 @@ private static PluginInfo getTracerPluginInfo(XmlConfigFile config) {\n     Node node = config.getNode(\"solr/tracerConfig\", false);\n     return (node == null) ? null : new PluginInfo(node, \"tracerConfig\", false, true);\n   }\n+  \n+  private static SharedStoreConfig loadSharedStoreConfig(NamedList<Object> nl) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dd231532287914a453164753f8349d8ef17af8b"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDE5ODYz", "url": "https://github.com/apache/lucene-solr/pull/1369#pullrequestreview-382419863", "createdAt": "2020-03-26T21:05:27Z", "commit": {"oid": "0dd231532287914a453164753f8349d8ef17af8b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTowNToyN1rOF8adlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTowODoxMVrOF8aiyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5MjQzNg==", "bodyText": "Why not SHARED_STORE_ENABLED?", "url": "https://github.com/apache/lucene-solr/pull/1369#discussion_r398892436", "createdAt": "2020-03-26T21:05:27Z", "author": {"login": "mbwaheed"}, "path": "solr/bin/solr", "diffHunk": "@@ -1975,6 +1975,10 @@ if [ \"$SOLR_MODE\" == 'solrcloud' ]; then\n \n     CLOUD_MODE_OPTS+=('-DzkRun')\n   fi\n+  \n+  if [ -n \"$SHARE_STORE_ENABLED\" ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dd231532287914a453164753f8349d8ef17af8b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg5Mzc3MA==", "bodyText": "Maybe it works for now, but later we might want to properly add an enabled property to SharedStoreConfig and create SharedStoreConfig even enabled is false.", "url": "https://github.com/apache/lucene-solr/pull/1369#discussion_r398893770", "createdAt": "2020-03-26T21:08:11Z", "author": {"login": "mbwaheed"}, "path": "solr/core/src/java/org/apache/solr/core/SolrXmlConfig.java", "diffHunk": "@@ -568,4 +568,17 @@ private static PluginInfo getTracerPluginInfo(XmlConfigFile config) {\n     Node node = config.getNode(\"solr/tracerConfig\", false);\n     return (node == null) ? null : new PluginInfo(node, \"tracerConfig\", false, true);\n   }\n+  \n+  private static SharedStoreConfig loadSharedStoreConfig(NamedList<Object> nl) {\n+    if (nl == null) {\n+      // shared store is not configured\n+      return null;\n+    } \n+    boolean enabled = Boolean.parseBoolean(\n+        required(\"sharedStore\", \"sharedStoreEnabled\", removeValue(nl, \"sharedStoreEnabled\")));\n+    if (enabled) {\n+      return new SharedStoreConfig();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dd231532287914a453164753f8349d8ef17af8b"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2223, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}