{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NzU1MDEw", "number": 1825, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo1MToxMFrOEjLVyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzowMDo0N1rOEjr2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzIxNDE2OnYy", "diffSide": "RIGHT", "path": "solr/solrj/src/java/org/apache/solr/client/solrj/impl/BaseCloudSolrClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo1MToxMFrOHRYxnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjozOTowNVrOHRdiFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5Mzc1Nw==", "bodyText": "Since you add  - retrying to the info logging above, maybe add something like  - max retries hit here", "url": "https://github.com/apache/lucene-solr/pull/1825#discussion_r487993757", "createdAt": "2020-09-14T14:51:10Z", "author": {"login": "HoustonPutman"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/impl/BaseCloudSolrClient.java", "diffHunk": "@@ -994,12 +991,15 @@ public RouteException(ErrorCode errorCode, NamedList<Throwable> throwables, Map<\n           // and we could not get any information from the server\n           //it is probably not worth trying again and again because\n           // the state would not have been updated\n-          log.info(\"trying request again\");\n+          log.info(\"Request to collection {} failed due to ({}) {}, retry={} commError={} errorCode={} - retrying\",\n+              inputCollections, errorCode, rootCause, retryCount, wasCommError, errorCode);\n           return requestWithRetryOnStaleState(request, retryCount + 1, inputCollections);\n         }\n       } else {\n         log.info(\"request was not communication error it seems\");\n       }\n+      log.error(\"Request to collection {} failed due to ({}) {}, retry={} commError={} errorCode={} \",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25552353f79be86b119dd994490d0619d73480f8"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA3MTcwMA==", "bodyText": "max retries hit is a little tricky to determine exactly since e.g. commError and other things influence the logic. But inclusion of MAX_STALE_RETRIES in the logging could make it clear(er) when \"max retries hit\" was likely the case.", "url": "https://github.com/apache/lucene-solr/pull/1825#discussion_r488071700", "createdAt": "2020-09-14T16:39:05Z", "author": {"login": "cpoerschke"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/impl/BaseCloudSolrClient.java", "diffHunk": "@@ -994,12 +991,15 @@ public RouteException(ErrorCode errorCode, NamedList<Throwable> throwables, Map<\n           // and we could not get any information from the server\n           //it is probably not worth trying again and again because\n           // the state would not have been updated\n-          log.info(\"trying request again\");\n+          log.info(\"Request to collection {} failed due to ({}) {}, retry={} commError={} errorCode={} - retrying\",\n+              inputCollections, errorCode, rootCause, retryCount, wasCommError, errorCode);\n           return requestWithRetryOnStaleState(request, retryCount + 1, inputCollections);\n         }\n       } else {\n         log.info(\"request was not communication error it seems\");\n       }\n+      log.error(\"Request to collection {} failed due to ({}) {}, retry={} commError={} errorCode={} \",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5Mzc1Nw=="}, "originalCommit": {"oid": "25552353f79be86b119dd994490d0619d73480f8"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1ODU0MDA4OnYy", "diffSide": "RIGHT", "path": "solr/solrj/src/java/org/apache/solr/client/solrj/impl/BaseCloudSolrClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzowMDo0N1rOHSLT6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzowMDo0N1rOHSLT6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyMTczNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  log.error(\"Request to collection {} failed due to ({}) {}, retry={} maxRetries={} commError={} errorCode={} \",\n          \n          \n            \n                  log.info(\"Request to collection {} failed due to ({}) {}, retry={} maxRetries={} commError={} errorCode={} \",\n          \n      \n    \n    \n  \n\n@noblepaul - is this what you had in mind when you wrote \"switch this to INFO\" on the https://issues.apache.org/jira/browse/SOLR-14828 ticket? Or would you prefer keeping the logging at line 973 only but as INFO instead of ERROR?", "url": "https://github.com/apache/lucene-solr/pull/1825#discussion_r488821736", "createdAt": "2020-09-15T17:00:47Z", "author": {"login": "cpoerschke"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/impl/BaseCloudSolrClient.java", "diffHunk": "@@ -994,12 +991,15 @@ public RouteException(ErrorCode errorCode, NamedList<Throwable> throwables, Map<\n           // and we could not get any information from the server\n           //it is probably not worth trying again and again because\n           // the state would not have been updated\n-          log.info(\"trying request again\");\n+          log.info(\"Request to collection {} failed due to ({}) {}, retry={} maxRetries={} commError={} errorCode={} - retrying\",\n+              inputCollections, errorCode, rootCause, retryCount, MAX_STALE_RETRIES, wasCommError, errorCode);\n           return requestWithRetryOnStaleState(request, retryCount + 1, inputCollections);\n         }\n       } else {\n         log.info(\"request was not communication error it seems\");\n       }\n+      log.error(\"Request to collection {} failed due to ({}) {}, retry={} maxRetries={} commError={} errorCode={} \",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4990ee038cf02833736a968faf80105e0dd68cf"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1178, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}