{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2MzcxMjY2", "number": 1740, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxODozMzoxMFrOEYLsXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxODozMzoxMFrOEYLsXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzNzkyODYwOnYy", "diffSide": "RIGHT", "path": "lucene/analysis/common/src/java/org/apache/lucene/analysis/miscellaneous/WordDelimiterFilter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxODozMzoxMFrOHAYfdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxODozMzoxMFrOHAYfdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDE2MzMxOQ==", "bodyText": "@bruno-roustant pointed out to me that the existing comparison here looks faulty -- notice it's doing the later position due to the swap of \"j\" and \"i\".  This is how it was before.  I think it's wrong, and makes me suspect that it's likely this comparison yields a zero.  If true, this is more evidence that suggest the sort can merely look at start & end offsets.", "url": "https://github.com/apache/lucene-solr/pull/1740#discussion_r470163319", "createdAt": "2020-08-13T18:33:10Z", "author": {"login": "dsmiley"}, "path": "lucene/analysis/common/src/java/org/apache/lucene/analysis/miscellaneous/WordDelimiterFilter.java", "diffHunk": "@@ -398,10 +399,20 @@ public void reset() throws IOException {\n   private class OffsetSorter extends InPlaceMergeSorter {\n     @Override\n     protected int compare(int i, int j) {\n+      // earlier start offset\n       int cmp = Integer.compare(startOff[i], startOff[j]);\n-      if (cmp == 0) {\n-        cmp = Integer.compare(posInc[j], posInc[i]);\n+      if (cmp != 0) {\n+        return cmp;\n       }\n+      \n+      // earlier position\n+      cmp = Integer.compare(posInc[j], posInc[i]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8be34cd3337bb5b9e7a4e892130f2e3cb7e9c28b"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1298, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}