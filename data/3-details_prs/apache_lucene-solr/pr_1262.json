{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1NzcxMzIx", "number": 1262, "title": "LUCENE-9220: regenerate all stemmers/stopwords/test data from snowball 2.0", "bodyText": "Instead of patching them after-the-fact (both manually and\nautomatically over the years) we patch the generator.\nThis is easier to maintain than patches/changes against generated code.\nSee LUCENE-9220 for more information.\nThere is a remaining nocommit, test data. Also need to hook in and test\nthe new languages that are added here.", "createdAt": "2020-02-16T00:19:11Z", "url": "https://github.com/apache/lucene-solr/pull/1262", "merged": true, "mergeCommit": {"oid": "0203815ab2bf72a77fe8f58daa0e6e269e00e9a8"}, "closed": true, "closedAt": "2020-02-17T17:38:02Z", "author": {"login": "rmuir"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEtKSwgH2gAyMzc1NzcxMzIxOmZjMjI5YjE3MDE5N2UzN2ZmY2JkYjMzMGU3NjU3OTM5OTc5YTdkZWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFP7VGgH2gAyMzc1NzcxMzIxOjZkZmExY2QzYTY0M2NlNTU5YTIyM2I4OWMyMDZlMTc4YjY0NjkxZjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc229b170197e37ffcbdb330e7657939979a7def", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/fc229b170197e37ffcbdb330e7657939979a7def", "committedDate": "2020-02-15T23:58:45Z", "message": "LUCENE-9220 regenerate all stemmers from snowball 2.0\n\nInstead of patching them after-the-fact (both manually and\nautomatically over the years) we patch the generator.\n\nThis is easier to maintain than patches/changes against generated code.\nSee LUCENE-9220 for more information.\n\nThere is a remaining nocommit, test data. Also need to hook in and test\nthe new languages that are added here."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9a285c857e632a32f7762c49d2ab8363ae8c876", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/d9a285c857e632a32f7762c49d2ab8363ae8c876", "committedDate": "2020-02-16T04:17:38Z", "message": "LUCENE-9220: automate generation of (bsd license-only, sampled) test data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03aebecf98acab31c608dbcdbf8b5c038c3c02f7", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/03aebecf98acab31c608dbcdbf8b5c038c3c02f7", "committedDate": "2020-02-16T05:36:15Z", "message": "LUCENE-9220: regenerate all snowball stopfiles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ced733fc3a2b7db61b6d96e5399ae2a2918d3ba", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/8ced733fc3a2b7db61b6d96e5399ae2a2918d3ba", "committedDate": "2020-02-16T05:54:23Z", "message": "LUCENE-9220: teach gradle the new snowball-generated boilerplate, too"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a9fd22e167f7982117db366ae6f27b82ffd77c1", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/8a9fd22e167f7982117db366ae6f27b82ffd77c1", "committedDate": "2020-02-16T14:33:55Z", "message": "LUCENE-9220: add snowball regeneration task to gradle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "affb5966838692348e129121bcef928b77af21d6", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/affb5966838692348e129121bcef928b77af21d6", "committedDate": "2020-02-16T15:49:10Z", "message": "LUCENE-9220: just fixup tabs/indentation rather than slow reformatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39746be9370e8e98bb8826d6376b86f2cbe7508b", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/39746be9370e8e98bb8826d6376b86f2cbe7508b", "committedDate": "2020-02-16T15:56:20Z", "message": "LUCENE-9220: tone down debugging now that this works"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7502f591010699ba7bcb486e0e16fdb5574c6c38", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/7502f591010699ba7bcb486e0e16fdb5574c6c38", "committedDate": "2020-02-16T16:01:23Z", "message": "LUCENE-9220: add license header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/37ec6d0c8279512a75995273d961877f740c9e2b", "committedDate": "2020-02-16T16:31:39Z", "message": "LUCENE-9220: ensure all languages are tested via TestSnowball and TestRandomChains"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5Njc4ODAx", "url": "https://github.com/apache/lucene-solr/pull/1262#pullrequestreview-359678801", "createdAt": "2020-02-17T11:50:01Z", "commit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "state": "APPROVED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMTo1MDowMVrOFqhvpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMTo1NjoyNFrOFqh6lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzNzM4MQ==", "bodyText": "the latter could be defined relative to snowballWorkDir (${snowballWorkDir}/stemmers)?", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380137381", "createdAt": "2020-02-17T11:50:01Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.gradle", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  ext {\n+    snowballWorkDir    = file(\"${buildDir}/snowball\")\n+    snowballStemmerDir = file(\"${buildDir}/snowball/stemmers\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzODEwNA==", "bodyText": "The \"cleanXXX\" is a rule in gradle... don't know if it's not going to clash with something. Perhaps rename to \"recompileSnowballCheckout\" or something like this?", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380138104", "createdAt": "2020-02-17T11:51:45Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.gradle", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  ext {\n+    snowballWorkDir    = file(\"${buildDir}/snowball\")\n+    snowballStemmerDir = file(\"${buildDir}/snowball/stemmers\")\n+    snowballPatchedDir = file(\"${buildDir}/snowball/patched\")\n+    snowballWebsiteDir = file(\"${buildDir}/snowball/website\")\n+    snowballDataDir    = file(\"${buildDir}/snowball/data\")\n+  }\n+\n+  task snowball()  {\n+    description \"Regenerate snowball-based sources, stopwords, and tests for ...lucene/analysis.\"\n+    group \"generation\"\n+\n+    dependsOn \":lucene:analysis:common:snowballGen\"\n+  }\n+\n+  task downloadSnowballStemmers(type: Download) {\n+    def stemmerZip = file(\"${snowballWorkDir}/stemmers.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball/archive/53739a805cfa6c77ff8496dc711dc1c106d987c1.zip\"\n+    dest stemmerZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/stemmers.json\")\n+\n+    doLast {\n+      ant.unzip(src: stemmerZip, dest: snowballStemmerDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballWebsite(type: Download) {\n+    def websiteZip = file(\"${snowballWorkDir}/website.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-website/archive/ff891e74f08e7315523ee3c0cad55bb1b7831b9d.zip\"\n+    dest websiteZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/website.json\")\n+\n+    doLast {\n+      ant.unzip(src: websiteZip, dest: snowballWebsiteDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballData(type: Download) {\n+    def dataZip = file(\"${snowballWorkDir}/data.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-data/archive/9145f8732ec952c8a3d1066be251da198a8bc792.zip\"\n+    dest dataZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/data.json\")\n+\n+    doLast {\n+      ant.unzip(src: dataZip, dest: snowballDataDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task cleanSnowballCheckout(type: Delete) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzODU1OQ==", "bodyText": "Oh. Could also be a doFirst { project.delete snowballPatchedDir } on the downloadSnowballStemmers?", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380138559", "createdAt": "2020-02-17T11:52:39Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.gradle", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  ext {\n+    snowballWorkDir    = file(\"${buildDir}/snowball\")\n+    snowballStemmerDir = file(\"${buildDir}/snowball/stemmers\")\n+    snowballPatchedDir = file(\"${buildDir}/snowball/patched\")\n+    snowballWebsiteDir = file(\"${buildDir}/snowball/website\")\n+    snowballDataDir    = file(\"${buildDir}/snowball/data\")\n+  }\n+\n+  task snowball()  {\n+    description \"Regenerate snowball-based sources, stopwords, and tests for ...lucene/analysis.\"\n+    group \"generation\"\n+\n+    dependsOn \":lucene:analysis:common:snowballGen\"\n+  }\n+\n+  task downloadSnowballStemmers(type: Download) {\n+    def stemmerZip = file(\"${snowballWorkDir}/stemmers.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball/archive/53739a805cfa6c77ff8496dc711dc1c106d987c1.zip\"\n+    dest stemmerZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/stemmers.json\")\n+\n+    doLast {\n+      ant.unzip(src: stemmerZip, dest: snowballStemmerDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballWebsite(type: Download) {\n+    def websiteZip = file(\"${snowballWorkDir}/website.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-website/archive/ff891e74f08e7315523ee3c0cad55bb1b7831b9d.zip\"\n+    dest websiteZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/website.json\")\n+\n+    doLast {\n+      ant.unzip(src: websiteZip, dest: snowballWebsiteDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballData(type: Download) {\n+    def dataZip = file(\"${snowballWorkDir}/data.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-data/archive/9145f8732ec952c8a3d1066be251da198a8bc792.zip\"\n+    dest dataZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/data.json\")\n+\n+    doLast {\n+      ant.unzip(src: dataZip, dest: snowballDataDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task cleanSnowballCheckout(type: Delete) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzODEwNA=="}, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzODg4MA==", "bodyText": "ant.patch just redirects to local filesystem patch command (doesn't work on Windows). Sigh. Fine with me though.", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380138880", "createdAt": "2020-02-17T11:53:23Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.gradle", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  ext {\n+    snowballWorkDir    = file(\"${buildDir}/snowball\")\n+    snowballStemmerDir = file(\"${buildDir}/snowball/stemmers\")\n+    snowballPatchedDir = file(\"${buildDir}/snowball/patched\")\n+    snowballWebsiteDir = file(\"${buildDir}/snowball/website\")\n+    snowballDataDir    = file(\"${buildDir}/snowball/data\")\n+  }\n+\n+  task snowball()  {\n+    description \"Regenerate snowball-based sources, stopwords, and tests for ...lucene/analysis.\"\n+    group \"generation\"\n+\n+    dependsOn \":lucene:analysis:common:snowballGen\"\n+  }\n+\n+  task downloadSnowballStemmers(type: Download) {\n+    def stemmerZip = file(\"${snowballWorkDir}/stemmers.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball/archive/53739a805cfa6c77ff8496dc711dc1c106d987c1.zip\"\n+    dest stemmerZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/stemmers.json\")\n+\n+    doLast {\n+      ant.unzip(src: stemmerZip, dest: snowballStemmerDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballWebsite(type: Download) {\n+    def websiteZip = file(\"${snowballWorkDir}/website.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-website/archive/ff891e74f08e7315523ee3c0cad55bb1b7831b9d.zip\"\n+    dest websiteZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/website.json\")\n+\n+    doLast {\n+      ant.unzip(src: websiteZip, dest: snowballWebsiteDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballData(type: Download) {\n+    def dataZip = file(\"${snowballWorkDir}/data.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-data/archive/9145f8732ec952c8a3d1066be251da198a8bc792.zip\"\n+    dest dataZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/data.json\")\n+\n+    doLast {\n+      ant.unzip(src: dataZip, dest: snowballDataDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task cleanSnowballCheckout(type: Delete) {\n+    dependsOn downloadSnowballStemmers\n+    delete snowballPatchedDir\n+  }\n+\n+  task patchSnowball(type: Copy) {\n+    dependsOn cleanSnowballCheckout\n+\n+    from fileTree(snowballStemmerDir) {\n+      include '**/*'\n+    }\n+    into snowballPatchedDir\n+\n+    doLast {\n+      ant.patch(patchfile: rootProject.file(\"gradle/generation/snowball.patch\"), dir: snowballPatchedDir, strip: \"1\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzOTM3Nw==", "bodyText": "Why not move all these tasks into lucene:analysis:common configuration? Are they reused anywhere else? If not then it'd make everything local to the project.", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380139377", "createdAt": "2020-02-17T11:54:33Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.gradle", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  ext {\n+    snowballWorkDir    = file(\"${buildDir}/snowball\")\n+    snowballStemmerDir = file(\"${buildDir}/snowball/stemmers\")\n+    snowballPatchedDir = file(\"${buildDir}/snowball/patched\")\n+    snowballWebsiteDir = file(\"${buildDir}/snowball/website\")\n+    snowballDataDir    = file(\"${buildDir}/snowball/data\")\n+  }\n+\n+  task snowball()  {\n+    description \"Regenerate snowball-based sources, stopwords, and tests for ...lucene/analysis.\"\n+    group \"generation\"\n+\n+    dependsOn \":lucene:analysis:common:snowballGen\"\n+  }\n+\n+  task downloadSnowballStemmers(type: Download) {\n+    def stemmerZip = file(\"${snowballWorkDir}/stemmers.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball/archive/53739a805cfa6c77ff8496dc711dc1c106d987c1.zip\"\n+    dest stemmerZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/stemmers.json\")\n+\n+    doLast {\n+      ant.unzip(src: stemmerZip, dest: snowballStemmerDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballWebsite(type: Download) {\n+    def websiteZip = file(\"${snowballWorkDir}/website.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-website/archive/ff891e74f08e7315523ee3c0cad55bb1b7831b9d.zip\"\n+    dest websiteZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/website.json\")\n+\n+    doLast {\n+      ant.unzip(src: websiteZip, dest: snowballWebsiteDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballData(type: Download) {\n+    def dataZip = file(\"${snowballWorkDir}/data.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-data/archive/9145f8732ec952c8a3d1066be251da198a8bc792.zip\"\n+    dest dataZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/data.json\")\n+\n+    doLast {\n+      ant.unzip(src: dataZip, dest: snowballDataDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task cleanSnowballCheckout(type: Delete) {\n+    dependsOn downloadSnowballStemmers\n+    delete snowballPatchedDir\n+  }\n+\n+  task patchSnowball(type: Copy) {\n+    dependsOn cleanSnowballCheckout\n+\n+    from fileTree(snowballStemmerDir) {\n+      include '**/*'\n+    }\n+    into snowballPatchedDir\n+\n+    doLast {\n+      ant.patch(patchfile: rootProject.file(\"gradle/generation/snowball.patch\"), dir: snowballPatchedDir, strip: \"1\")\n+    }\n+  }\n+}\n+\n+configure(project(\":lucene:analysis:common\")) {\n+  task snowballGen() {\n+    description \"Patch and Regenerate snowball sources, stopwords, and tests\"\n+    group \"generation\"\n+    dependsOn rootProject.patchSnowball", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzOTc2Ng==", "bodyText": "Love the old school (sed). :)", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380139766", "createdAt": "2020-02-17T11:55:26Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.sh", "diffHunk": "@@ -0,0 +1,122 @@\n+#!/usr/bin/env bash\n+\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+# remove this script when problems are fixed\n+SRCDIR=$1\n+WWWSRCDIR=$2\n+TESTSRCDIR=$3\n+PROJECTDIR=$4\n+DESTDIR=\"${PROJECTDIR}/src/java/org/tartarus/snowball\"\n+WWWDSTDIR=\"${PROJECTDIR}/src/resources/org/apache/lucene/analysis/snowball\"\n+TESTDSTDIR=\"${PROJECTDIR}/src/test/org/apache/lucene/analysis/snowball\"\n+\n+trap 'echo \"usage: ./snowball.sh <snowball> <snowball-website> <snowball-data> <analysis-common>\" && exit 2' ERR\n+test $# -eq 4\n+\n+trap 'echo \"*** BUILD FAILED ***\" $BASH_SOURCE:$LINENO: error: \"$BASH_COMMAND\" returned $?' ERR\n+set -eEuo pipefail\n+\n+# reformats file indentation to kill the crazy space/tabs mix.\n+# prevents early blindness !\n+function reformat_java() {\n+  # convert tabs to 8 spaces, then reduce indent from 4 space to 2 space\n+  sed --in-place -e 's/\\t/        /g' -e 's/    /  /g' $1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDE0MDE4Mg==", "bodyText": "Thanks for cleaning these up from ant.", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380140182", "createdAt": "2020-02-17T11:56:24Z", "author": {"login": "dweiss"}, "path": "lucene/analysis/common/build.xml", "diffHunk": "@@ -124,14 +122,4 @@\n \n   <target name=\"regenerate\" depends=\"jflex,unicode-data\"/>\n \n-  <target name=\"patch-snowball\" description=\"Patches all snowball programs in '${snowball.programs.dir}' to make them work with MethodHandles\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "600bb7e5d7764f5e1346d411a6928246be01258b", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/600bb7e5d7764f5e1346d411a6928246be01258b", "committedDate": "2020-02-17T12:23:33Z", "message": "LUCENE-9220: move all this stuff to lucene/analysis/common, leaving just one task at the root that depends on it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f43c5a3322feb2a6391da83c5ad34e2b4fa2a03", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/9f43c5a3322feb2a6391da83c5ad34e2b4fa2a03", "committedDate": "2020-02-17T12:37:09Z", "message": "LUCENE-9220: remove confusingly-named gradle task and replace with a doFirst"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1d8745b3efbb6584de42a7140aa21ea60030f75", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/d1d8745b3efbb6584de42a7140aa21ea60030f75", "committedDate": "2020-02-17T14:14:49Z", "message": "LUCENE-9220: make generation of test data reproducible across different OS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a250c4c7198c3ce7138f8ef50a0f7dcf90877f6d", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/a250c4c7198c3ce7138f8ef50a0f7dcf90877f6d", "committedDate": "2020-02-17T14:31:02Z", "message": "LUCENE-9220: use perl (snowball Makefile already requires it) instead of sed, to avoid system differences"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NzY0ODkw", "url": "https://github.com/apache/lucene-solr/pull/1262#pullrequestreview-359764890", "createdAt": "2020-02-17T14:16:05Z", "commit": {"oid": "9f43c5a3322feb2a6391da83c5ad34e2b4fa2a03"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDoxNjowNVrOFql7Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDoxNjowNVrOFql7Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIwNTg2Mg==", "bodyText": "Declare inputs on the zip and move applying the patch to inside the download task action (you don't even have to copy the unpacked folder then), execute patching in doLast; if it fails the entire task won't be up-to-date (will be re-run)? Just a thought.", "url": "https://github.com/apache/lucene-solr/pull/1262#discussion_r380205862", "createdAt": "2020-02-17T14:16:05Z", "author": {"login": "dweiss"}, "path": "gradle/generation/snowball.gradle", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  ext {\n+    snowballWorkDir    = file(\"${buildDir}/snowball\")\n+    snowballStemmerDir = file(\"${buildDir}/snowball/stemmers\")\n+    snowballPatchedDir = file(\"${buildDir}/snowball/patched\")\n+    snowballWebsiteDir = file(\"${buildDir}/snowball/website\")\n+    snowballDataDir    = file(\"${buildDir}/snowball/data\")\n+  }\n+\n+  task snowball()  {\n+    description \"Regenerate snowball-based sources, stopwords, and tests for ...lucene/analysis.\"\n+    group \"generation\"\n+\n+    dependsOn \":lucene:analysis:common:snowballGen\"\n+  }\n+\n+  task downloadSnowballStemmers(type: Download) {\n+    def stemmerZip = file(\"${snowballWorkDir}/stemmers.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball/archive/53739a805cfa6c77ff8496dc711dc1c106d987c1.zip\"\n+    dest stemmerZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/stemmers.json\")\n+\n+    doLast {\n+      ant.unzip(src: stemmerZip, dest: snowballStemmerDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballWebsite(type: Download) {\n+    def websiteZip = file(\"${snowballWorkDir}/website.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-website/archive/ff891e74f08e7315523ee3c0cad55bb1b7831b9d.zip\"\n+    dest websiteZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/website.json\")\n+\n+    doLast {\n+      ant.unzip(src: websiteZip, dest: snowballWebsiteDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task downloadSnowballData(type: Download) {\n+    def dataZip = file(\"${snowballWorkDir}/data.zip\")\n+\n+    src \"https://github.com/snowballstem/snowball-data/archive/9145f8732ec952c8a3d1066be251da198a8bc792.zip\"\n+    dest dataZip\n+    onlyIfModified true\n+    useETag \"all\"\n+    cachedETagsFile file(\"${snowballWorkDir}/data.json\")\n+\n+    doLast {\n+      ant.unzip(src: dataZip, dest: snowballDataDir, overwrite: \"true\") {\n+        ant.cutdirsmapper(dirs: \"1\")\n+      }\n+    }\n+  }\n+\n+  task cleanSnowballCheckout(type: Delete) {\n+    dependsOn downloadSnowballStemmers\n+    delete snowballPatchedDir\n+  }\n+\n+  task patchSnowball(type: Copy) {\n+    dependsOn cleanSnowballCheckout\n+\n+    from fileTree(snowballStemmerDir) {\n+      include '**/*'\n+    }\n+    into snowballPatchedDir\n+\n+    doLast {\n+      ant.patch(patchfile: rootProject.file(\"gradle/generation/snowball.patch\"), dir: snowballPatchedDir, strip: \"1\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEzODg4MA=="}, "originalCommit": {"oid": "37ec6d0c8279512a75995273d961877f740c9e2b"}, "originalPosition": 98}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b38a876f5b3a1accd50c1a4d76361729747cb1bb", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/b38a876f5b3a1accd50c1a4d76361729747cb1bb", "committedDate": "2020-02-17T15:23:54Z", "message": "LUCENE-9220: simplify by naming directories by commit hash, adding input dependency of patch file, etc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86e2c8311c1255779c6c0b29c4c25488738088c0", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/86e2c8311c1255779c6c0b29c4c25488738088c0", "committedDate": "2020-02-17T15:47:38Z", "message": "LUCENE-9220: use more robust download (in case of kill -9 or jvm crash)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76ed7d2cc3a4ed0681b262385d59127b2377a75f", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/76ed7d2cc3a4ed0681b262385d59127b2377a75f", "committedDate": "2020-02-17T16:13:44Z", "message": "LUCENE-9220: simplify regeneration logic, handle if language gets deleted, etc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dfa1cd3a643ce559a223b89c206e178b64691f4", "author": {"user": {"login": "rmuir", "name": "Robert Muir"}}, "url": "https://github.com/apache/lucene-solr/commit/6dfa1cd3a643ce559a223b89c206e178b64691f4", "committedDate": "2020-02-17T16:29:05Z", "message": "LUCENE-9220: add CHANGES.txt entry"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2331, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}