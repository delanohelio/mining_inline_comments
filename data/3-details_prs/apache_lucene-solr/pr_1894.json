{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5ODQxNjI1", "number": 1894, "title": "SOLR-14878: Expose solr.xml's coreRootDirectory property via the System Settings API", "bodyText": "Description\nEven if coreRootDirectory was set in solr.xml, external applications could not access it through the API. It was not exposed. This means it is not possible to run a command such as bin/solr create_core -c test as the code that pre-populates the core directory is doing it in the wrong place (if at all).\nSolution\nExpose the property if it is defined and is different from solr_home\nChecklist\nPlease review the following and check all that apply:\n\n I have reviewed the guidelines for How to Contribute and my code conforms to the standards described there to the best of my ability.\n I have created a Jira issue and added the issue ID to my pull request title.\n I have given Solr maintainers access to contribute to my PR branch. (optional but recommended)\n I have developed this patch against the master branch.\n I have run ./gradlew check.", "createdAt": "2020-09-20T01:07:46Z", "url": "https://github.com/apache/lucene-solr/pull/1894", "merged": true, "mergeCommit": {"oid": "f6e8bc8c31fac48d8196cd8a94de743e755597df"}, "closed": true, "closedAt": "2020-09-20T02:07:03Z", "author": {"login": "arafalov"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKkJOOAH2gAyNDg5ODQxNjI1OmQ2MjYyY2I4ZmRiNzYxNjZiZDYyMWUwOGE1ZDgwMjI5ZWIyMjZjZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLHbN8AFqTQ5Mjg2MTMwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d6262cb8fdb76166bd621e08a5d80229eb226cd2", "author": {"user": {"login": "arafalov", "name": "Alexandre Rafalovitch"}}, "url": "https://github.com/apache/lucene-solr/commit/d6262cb8fdb76166bd621e08a5d80229eb226cd2", "committedDate": "2020-09-20T01:03:08Z", "message": "Added property"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyODYxMzA3", "url": "https://github.com/apache/lucene-solr/pull/1894#pullrequestreview-492861307", "createdAt": "2020-09-21T18:08:28Z", "commit": {"oid": "d6262cb8fdb76166bd621e08a5d80229eb226cd2"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxODowODoyOVrOHVcqqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxODowOToyMFrOHVcsZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI1MTgxOQ==", "bodyText": "coreRootDirectory is always non-null.  I don't like null checks that are unnecessary; it may feel \"safe\" but slightly obscures code clarity and suggests possibilities that are impossibilities.", "url": "https://github.com/apache/lucene-solr/pull/1894#discussion_r492251819", "createdAt": "2020-09-21T18:08:29Z", "author": {"login": "dsmiley"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler.java", "diffHunk": "@@ -139,8 +140,19 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n     if (solrCloudMode) {\n       rsp.add(\"zkHost\", getCoreContainer(req, core).getZkController().getZkServerAddress());\n     }\n-    if (cc != null)\n-      rsp.add( \"solr_home\", cc.getSolrHome());\n+    if (cc != null) {\n+      String solrHome = cc.getSolrHome();\n+      rsp.add(\"solr_home\", solrHome);\n+\n+      Path coreRootDirectory = cc.getCoreRootDirectory();\n+      if (coreRootDirectory != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6262cb8fdb76166bd621e08a5d80229eb226cd2"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI1MjI2MQ==", "bodyText": "I disagree with this condition.  I think this should always emitted no matter where it is.  It's more helpful on consumers to depend on its existence rather than having it vary in some cases but not others.", "url": "https://github.com/apache/lucene-solr/pull/1894#discussion_r492252261", "createdAt": "2020-09-21T18:09:20Z", "author": {"login": "dsmiley"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler.java", "diffHunk": "@@ -139,8 +140,19 @@ public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throw\n     if (solrCloudMode) {\n       rsp.add(\"zkHost\", getCoreContainer(req, core).getZkController().getZkServerAddress());\n     }\n-    if (cc != null)\n-      rsp.add( \"solr_home\", cc.getSolrHome());\n+    if (cc != null) {\n+      String solrHome = cc.getSolrHome();\n+      rsp.add(\"solr_home\", solrHome);\n+\n+      Path coreRootDirectory = cc.getCoreRootDirectory();\n+      if (coreRootDirectory != null) {\n+        String coreRootDirectoryString = coreRootDirectory.toString();\n+        if (!coreRootDirectoryString.equals(solrHome)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6262cb8fdb76166bd621e08a5d80229eb226cd2"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2288, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}