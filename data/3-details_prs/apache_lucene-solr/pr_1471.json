{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExODU4OTg3", "number": 1471, "title": "SOLR-14014 PR Against Master", "bodyText": "Description\nI added a system property to allow users to disable the Solr Admin UI on start.\nSolution\nI added this property, which accepts a boolean value, to SOLR_START_OPTS and START_OPTS.\nTests\nNot easily testable in the current project.\nChecklist\nPlease review the following and check all that apply:\n\n I have reviewed the guidelines for How to Contribute and my code conforms to the standards described there to the best of my ability.\n I have created a Jira issue and added the issue ID to my pull request title.\n I have given Solr maintainers access to contribute to my PR branch. (optional but recommended)\n I have developed this patch against the master branch.\n I have run ant precommit and the appropriate test suite.\n I have added tests for my changes.\n I have added documentation for the Ref Guide (for Solr changes only).", "createdAt": "2020-04-30T21:58:03Z", "url": "https://github.com/apache/lucene-solr/pull/1471", "merged": true, "mergeCommit": {"oid": "6f775bfa69db5b2488ac3070e1da657919c816b9"}, "closed": true, "closedAt": "2020-05-04T21:51:32Z", "author": {"login": "MarcusSorealheis"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbfAS4gH2gAyNDExODU4OTg3OjI2Yzc0ZDA5NTRjZWVlODU2NmUyNzE1MWI0MmZmYjk4MWEyZjgxYmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceFCXPgFqTQwNTMwMDY1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "26c74d0954ceee8566e27151b42ffb981a2f81bb", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/26c74d0954ceee8566e27151b42ffb981a2f81bb", "committedDate": "2020-04-26T18:29:25Z", "message": "Fix typo in `cloud-scripts` path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dd4a84b3255afea970bb72d1d18716573b4ae13", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/9dd4a84b3255afea970bb72d1d18716573b4ae13", "committedDate": "2020-04-28T22:34:28Z", "message": "t push :Merge branch 'master' of github.com:MarcusSorealheis/lucene-solr\n\n* 'master' of github.com:MarcusSorealheis/lucene-solr:\n  Fix typo in `cloud-scripts` path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fbeb9d42095bcdc2cfd687efc15c27bc9f2fe77", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/4fbeb9d42095bcdc2cfd687efc15c27bc9f2fe77", "committedDate": "2020-04-30T21:40:51Z", "message": "Merge remote-tracking branch 'upstream/master'\n\n* upstream/master:\n  SOLR-14237: Fix HDFS nightly test failure\n  LUCENE-9278: concatenate paths for sourcepath using path separator rather than whitespace (which causes invalid option to be passed to javadoc).\n  LUCENE-9333: Add gradle task to compile changes.txt to a html (#1468)\n  update CHANGES for #807\n  Fix tests to survive nightly runs with many documents\n  SOLR-14173: Don't use JQuery-Slim as it breaks the sidebar sub-menu system.\n  SOLR-14237: A new panel with security info in admin UI's dashboard\n  SOLR-14237: A new panel with security info in admin UI's dashboard\n  LUCENE-7788: fail precommit on unparameterised log messages and examine for wasted work/objects\n  SOLR-14173: Change left nav item highlighting to fix menu jumpiness when hovering/selecting\n  LUCENE-9349: TermInSetQuery should use consumeMatchingTerms in visit() (#1465)\n  LUCENE-9089: update FST usage example"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55b0c109d4438937dc8719159f90e0cfbcbc34ec", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/55b0c109d4438937dc8719159f90e0cfbcbc34ec", "committedDate": "2020-04-30T21:54:08Z", "message": "create a revised PR against master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "896b1454a722a7f96a83a120122d3b55b1a73678", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/896b1454a722a7f96a83a120122d3b55b1a73678", "committedDate": "2020-05-01T07:15:50Z", "message": "fix imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MjYwOTk1", "url": "https://github.com/apache/lucene-solr/pull/1471#pullrequestreview-404260995", "createdAt": "2020-05-01T16:36:17Z", "commit": {"oid": "896b1454a722a7f96a83a120122d3b55b1a73678"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNjozNjoxN1rOGPOtCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNjo0Mjo1NlrOGPO4Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODYyMjczMQ==", "bodyText": "This clobbers the previous START_OPTS", "url": "https://github.com/apache/lucene-solr/pull/1471#discussion_r418622731", "createdAt": "2020-05-01T16:36:17Z", "author": {"login": "madrob"}, "path": "solr/bin/solr.cmd", "diffHunk": "@@ -1288,6 +1295,7 @@ REM '-OmitStackTraceInFastThrow' ensures stack traces in errors,\n REM users who don't care about useful error msgs can override in SOLR_OPTS with +OmitStackTraceInFastThrow\n set \"START_OPTS=%START_OPTS% -XX:-OmitStackTraceInFastThrow\"\n set START_OPTS=%START_OPTS% !GC_TUNE! %GC_LOG_OPTS%\n+set START_OPTS=-DdisableAdminUI=%DISABLE_ADMIN_UI%", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "896b1454a722a7f96a83a120122d3b55b1a73678"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODYyMzA3MA==", "bodyText": "It doesn't look like this property is ever passed to the run command?", "url": "https://github.com/apache/lucene-solr/pull/1471#discussion_r418623070", "createdAt": "2020-05-01T16:37:00Z", "author": {"login": "madrob"}, "path": "solr/bin/solr", "diffHunk": "@@ -2097,6 +2097,14 @@ else\n   SECURITY_MANAGER_OPTS=()\n fi\n \n+# Enable ADMIN UI by default, and give the option for users to disable it\n+if [ \"$SOLR_ADMIN_UI_DISABLED\" == \"true\" ]; then\n+  SOLR_ADMIN_UI=\"-DdisableAdminUI=true\"\n+  echo -e \"ADMIN UI Disabled\"\n+else\n+  SOLR_ADMIN_UI=\"-DdisableAdminUI=false\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "896b1454a722a7f96a83a120122d3b55b1a73678"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODYyMzQxNA==", "bodyText": "nit: did you mean to move these imports around?", "url": "https://github.com/apache/lucene-solr/pull/1471#discussion_r418623414", "createdAt": "2020-05-01T16:37:40Z", "author": {"login": "madrob"}, "path": "solr/core/src/java/org/apache/solr/servlet/LoadAdminUiServlet.java", "diffHunk": "@@ -15,6 +15,13 @@\n  * limitations under the License.\n  */\n package org.apache.solr.servlet;\n+import javax.servlet.http.HttpServletRequest;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "896b1454a722a7f96a83a120122d3b55b1a73678"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODYyNTU4Mw==", "bodyText": "Would this make sense to do before the close shield methods?", "url": "https://github.com/apache/lucene-solr/pull/1471#discussion_r418625583", "createdAt": "2020-05-01T16:42:56Z", "author": {"login": "madrob"}, "path": "solr/core/src/java/org/apache/solr/servlet/LoadAdminUiServlet.java", "diffHunk": "@@ -24,29 +31,26 @@\n import org.apache.solr.core.CoreContainer;\n import org.apache.solr.core.SolrCore;\n \n-import javax.servlet.http.HttpServletRequest;\n-import javax.servlet.http.HttpServletResponse;\n-\n-import java.io.IOException;\n-import java.io.InputStream;\n-import java.io.OutputStreamWriter;\n-import java.io.Writer;\n-import java.nio.charset.StandardCharsets;\n-\n /**\n  * A simple servlet to load the Solr Admin UI\n  * \n  * @since solr 4.0\n  */\n public final class LoadAdminUiServlet extends BaseSolrServlet {\n \n+  // check system properties for whether or not admin UI is disabled, default is false\n+  private static final boolean disabled = Boolean.parseBoolean(System.getProperty(\"disableAdminUI\", \"false\"));\n+\n   @Override\n-  public void doGet(HttpServletRequest _request,\n-                    HttpServletResponse _response)\n-      throws IOException {\n+  public void doGet(HttpServletRequest _request, HttpServletResponse _response) throws IOException {\n     HttpServletRequest request = SolrDispatchFilter.closeShield(_request, false);\n     HttpServletResponse response = SolrDispatchFilter.closeShield(_response, false);\n-    \n+\n+    if(disabled){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "896b1454a722a7f96a83a120122d3b55b1a73678"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dedcdfe8b9af18d1a4662937be96b4d710963826", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/dedcdfe8b9af18d1a4662937be96b4d710963826", "committedDate": "2020-05-01T17:27:13Z", "message": "add back in the SOLR OPT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eeced031ad207628ec467a53a046278962f53d7b", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/eeced031ad207628ec467a53a046278962f53d7b", "committedDate": "2020-05-01T17:54:55Z", "message": "fix windows start opts."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5024ec3f1a33da33bf6f78fafb8ce944311530c7", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/5024ec3f1a33da33bf6f78fafb8ce944311530c7", "committedDate": "2020-05-01T23:43:29Z", "message": "block the HTTPServletResponse before closeShield"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88040a2ee364ebf08857907c76d998036811ec13", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/88040a2ee364ebf08857907c76d998036811ec13", "committedDate": "2020-05-04T17:30:21Z", "message": "fixing docs so that people do not try to add -D java option."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f12cbe92a2f04e0a88a3750367dd46a8acaf0d92", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/f12cbe92a2f04e0a88a3750367dd46a8acaf0d92", "committedDate": "2020-05-04T17:34:58Z", "message": "remove the directives for how to start the app with java properties explicitly."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d30a14f5622377f028d2320d9c647943d9dd4787", "author": {"user": {"login": "MarcusSorealheis", "name": "Marcus"}}, "url": "https://github.com/apache/lucene-solr/commit/d30a14f5622377f028d2320d9c647943d9dd4787", "committedDate": "2020-05-04T17:41:46Z", "message": "add set prefix for Windows."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MjI3Njg4", "url": "https://github.com/apache/lucene-solr/pull/1471#pullrequestreview-405227688", "createdAt": "2020-05-04T18:12:11Z", "commit": {"oid": "d30a14f5622377f028d2320d9c647943d9dd4787"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MzAwNjUy", "url": "https://github.com/apache/lucene-solr/pull/1471#pullrequestreview-405300652", "createdAt": "2020-05-04T19:55:55Z", "commit": {"oid": "d30a14f5622377f028d2320d9c647943d9dd4787"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2140, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}