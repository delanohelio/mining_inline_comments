{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxOTMxNjA1", "number": 1774, "title": "SOLR-14774: Create HealthCheckHandler in CoreContainer", "bodyText": "This allows users to plug-in different implementations of the handler (they must extend HealthCheckHandler)\nThis PR also removes the HealthCheckHandler from the implicit SolrCore plugins", "createdAt": "2020-08-22T03:57:03Z", "url": "https://github.com/apache/lucene-solr/pull/1774", "merged": true, "mergeCommit": {"oid": "59d087f0b391b740491839acb48390f3d08030de"}, "closed": true, "closedAt": "2020-08-28T22:59:57Z", "author": {"login": "tflobbe"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBd1HCgFqTQ3Mjk0Mzk5Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDcLXjABqjM3MDU3NDI0NDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyOTQzOTk3", "url": "https://github.com/apache/lucene-solr/pull/1774#pullrequestreview-472943997", "createdAt": "2020-08-22T18:36:25Z", "commit": {"oid": "7ffaaf6c5466a874144f6b8b5b50fff9f543c284"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQxODozNjoyNVrOHFG66Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQxODozNjoyNVrOHFG66Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTExODMxMw==", "bodyText": "why are we calling loader.newInstance directly instead of createHandler?", "url": "https://github.com/apache/lucene-solr/pull/1774#discussion_r475118313", "createdAt": "2020-08-22T18:36:25Z", "author": {"login": "madrob"}, "path": "solr/core/src/java/org/apache/solr/core/CoreContainer.java", "diffHunk": "@@ -719,6 +719,7 @@ public void load() {\n     createHandler(ZK_PATH, ZookeeperInfoHandler.class.getName(), ZookeeperInfoHandler.class);\n     createHandler(ZK_STATUS_PATH, ZookeeperStatusHandler.class.getName(), ZookeeperStatusHandler.class);\n     collectionsHandler = createHandler(COLLECTIONS_HANDLER_PATH, cfg.getCollectionsHandlerClass(), CollectionsHandler.class);\n+    healthCheckHandler = loader.newInstance(cfg.getHealthCheckHandlerClass(), HealthCheckHandler.class, null, new Class<?>[]{CoreContainer.class}, new Object[]{this});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffaaf6c5466a874144f6b8b5b50fff9f543c284"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNDA3ODc4", "url": "https://github.com/apache/lucene-solr/pull/1774#pullrequestreview-473407878", "createdAt": "2020-08-24T12:16:57Z", "commit": {"oid": "7ffaaf6c5466a874144f6b8b5b50fff9f543c284"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMjoxNjo1N1rOHFhrrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMjoxNjo1N1rOHFhrrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU1Njc4Mw==", "bodyText": "throw new IllegalStateException(\"HealthCheckHandler needs to be initialized before creating InfoHandler\");\n\nHow about also having a \"HealthCheckHandler then InfoHandler order matters because ...\" style comment in CoreContainer?", "url": "https://github.com/apache/lucene-solr/pull/1774#discussion_r475556783", "createdAt": "2020-08-24T12:16:57Z", "author": {"login": "cpoerschke"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/InfoHandler.java", "diffHunk": "@@ -50,7 +50,10 @@ public InfoHandler(final CoreContainer coreContainer) {\n     handlers.put(\"properties\", new PropertiesRequestHandler());\n     handlers.put(\"logging\", new LoggingHandler(coreContainer));\n     handlers.put(\"system\", new SystemInfoHandler(coreContainer));\n-    handlers.put(\"health\", new HealthCheckHandler(coreContainer));\n+    if (coreContainer.getHealthCheckHandler() == null) {\n+      throw new IllegalStateException(\"HealthCheckHandler needs to be initialized before creating InfoHandler\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffaaf6c5466a874144f6b8b5b50fff9f543c284"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f253fabee825633f6768962d7d1c42eab1663a82", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/f253fabee825633f6768962d7d1c42eab1663a82", "committedDate": "2020-08-28T21:46:14Z", "message": "Create HealthCheckHandler in CoreContainer\n\nThis allows users to plug-in different implementations of the handler (they must extend HealthCheckHandler)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40753066375834f08e102e566eab848bd80f8599", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/40753066375834f08e102e566eab848bd80f8599", "committedDate": "2020-08-28T21:46:14Z", "message": "Add comment about Handler ordering"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b21bc1fdb3c60b00ca9601a31a8fbbe284ee7ad", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/9b21bc1fdb3c60b00ca9601a31a8fbbe284ee7ad", "committedDate": "2020-08-28T21:46:14Z", "message": "Update ref guide"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02b32fcc50b4b45c653e040a027237f63e6f49b8", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/02b32fcc50b4b45c653e040a027237f63e6f49b8", "committedDate": "2020-08-28T21:46:14Z", "message": "Improve comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1729322ca26fee4510d35f9a366d5c41b171bd9a", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/1729322ca26fee4510d35f9a366d5c41b171bd9a", "committedDate": "2020-08-28T21:48:24Z", "message": "Add CHANGES entry"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "132f83d24be08a19708885ed48e125227b570f35", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/132f83d24be08a19708885ed48e125227b570f35", "committedDate": "2020-08-26T22:28:13Z", "message": "Improve comments"}, "afterCommit": {"oid": "1729322ca26fee4510d35f9a366d5c41b171bd9a", "author": {"user": {"login": "tflobbe", "name": "Tomas Fernandez Lobbe"}}, "url": "https://github.com/apache/lucene-solr/commit/1729322ca26fee4510d35f9a366d5c41b171bd9a", "committedDate": "2020-08-28T21:48:24Z", "message": "Add CHANGES entry"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2397, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}