{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNzE2ODM2", "number": 1251, "title": "LUCENE-9134: Port ant-regenerate tasks to Gradle build (util and packed)", "bodyText": "This should be the final patch. It turned out to be a 5 minute task to put the hard-coded path in the Ant build so I did that too.\nI'll commit in a few and close this JIRA.", "createdAt": "2020-02-11T15:18:07Z", "url": "https://github.com/apache/lucene-solr/pull/1251", "merged": true, "mergeCommit": {"oid": "f9357ab0d210302aacaea9ac8c4d8f4d59d1585f"}, "closed": true, "closedAt": "2020-02-11T23:56:12Z", "author": {"login": "ErickErickson"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7Xt35gH2gAyMzczNzE2ODM2OmJlOTM5ZmY5ZGNjZjZkY2IzMDEyNzQ1Yzg3ZjMxZjdlMDRkN2JlOGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDTk4SAH2gAyMzczNzE2ODM2OjQ0YmM1MTIwMmZhZmNkZTUzOTFmNDZjZDhiMWJkZWUzZGVmNzMyODU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be939ff9dccf6dcb3012745c87f31f7e04d7be8c", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/be939ff9dccf6dcb3012745c87f31f7e04d7be8c", "committedDate": "2020-01-17T23:54:23Z", "message": "LUCENE-9134: Port ant-regenerate tasks to Gradle build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28c4921b481b02b22c567a25e47816394393c09d", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/28c4921b481b02b22c567a25e47816394393c09d", "committedDate": "2020-01-19T00:31:01Z", "message": "LUCENE-9134: Port ant-regenerate tasks to Gradle build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb6f91eb1952aac85c59bce63edddd9b6cb33e60", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/bb6f91eb1952aac85c59bce63edddd9b6cb33e60", "committedDate": "2020-01-21T13:36:18Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca4cdd06461c729550c22a029d52ae7cbb547c6a", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/ca4cdd06461c729550c22a029d52ae7cbb547c6a", "committedDate": "2020-01-21T13:37:37Z", "message": "Revert \"LUCENE-9134: Port ant-regenerate tasks to Gradle build\"\n\nThis reverts commit 28c4921b"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc70b04d9ab1fb0a73ab2e3c92b1526f611b3c2d", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/dc70b04d9ab1fb0a73ab2e3c92b1526f611b3c2d", "committedDate": "2020-01-21T13:37:58Z", "message": "Revert \"LUCENE-9134: Port ant-regenerate tasks to Gradle build\"\n\nThis reverts commit be939ff9"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dfdc2cefac4c070082c8852b061418581c5a201", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/9dfdc2cefac4c070082c8852b061418581c5a201", "committedDate": "2020-01-21T13:38:38Z", "message": "Rolling back so I can have a master in sync with upstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec0e34031da53a82e8ae912a233ab87242a6f75d", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/ec0e34031da53a82e8ae912a233ab87242a6f75d", "committedDate": "2020-01-22T16:12:33Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "856f7541c85643b28b10a00fc934671c5188835f", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/856f7541c85643b28b10a00fc934671c5188835f", "committedDate": "2020-01-25T23:01:55Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0574da242fbdafcd431f1d4d558814202a6e9da4", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/0574da242fbdafcd431f1d4d558814202a6e9da4", "committedDate": "2020-01-26T12:55:41Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "540b43be2111c4373117bda2b07619f8eaeafb70", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/540b43be2111c4373117bda2b07619f8eaeafb70", "committedDate": "2020-01-26T21:31:39Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d29a17f8dfe406674632b31747463f673af20b18", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/d29a17f8dfe406674632b31747463f673af20b18", "committedDate": "2020-01-27T23:16:55Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f409c51c53f25d3c166dcd342a250aa31f80126", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/0f409c51c53f25d3c166dcd342a250aa31f80126", "committedDate": "2020-01-30T00:39:39Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4575f02f3d37bfafafc5776f25822bcc4bf8b99a", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/4575f02f3d37bfafafc5776f25822bcc4bf8b99a", "committedDate": "2020-01-30T15:47:49Z", "message": "merged from upstream.\n\nSquashed commit of the following:\n\ncommit 4b5105e16798daec9f68ac333661efe1eb6d867b\nAuthor: Robert Muir <rmuir@apache.org>\nDate:   Thu Jan 30 08:26:26 2020 -0500\n\n    LUCENE-9193: heap allocations for tests.profile\n\n    Can be a bit noisier than cpu sampling, due to how threads are allocated\n    in tests... maybe we can improve that in the future.\n\ncommit 3a8ed5e8ed12d4d3a166eff0e5a978021c764ab7\nAuthor: Dawid Weiss <dweiss@apache.org>\nDate:   Thu Jan 30 13:45:15 2020 +0100\n\n    LUCENE-9134: add python-based regeneration of HTMLCharacterEntities.jflex inside jflexHTMLStripCharFilter.\n\ncommit 043dd207b6b0914a0ac0c0d41184dbba4575cf95\nAuthor: Dawid Weiss <dweiss@apache.org>\nDate:   Thu Jan 30 12:50:50 2020 +0100\n\n    LUCENE-9080: this jflex file got corrupted somehow during previous commit. I regenerated it with ant, along with the final java file. I also added a crlf normalization, encoding and forced-regeneration to ant because it didn't work before.\n\ncommit 13e2094804e338b7b4faffd93803f833eb259fed\nAuthor: Adrien Grand <jpountz@gmail.com>\nDate:   Thu Jan 30 10:37:39 2020 +0100\n\n    LUCENE-4702: Improve performance for fuzzy queries.\n\n    Fuzzy queries with an edit distance of 1 or 2 must visit all blocks whose prefix\n    length is 1 or 2. By not compressing those, we can trade very little space (a\n    couple MBs in the case of the wikibigall index) for better query efficiency.\n\ncommit a9482911a8251e7d414b08bffce497ab2b2f07c2\nAuthor: Ignacio Vera <ivera@apache.org>\nDate:   Thu Jan 30 08:03:22 2020 +0100\n\n    LUCENE-9141: Simplify LatLonShapeXQuery API by adding a new abstract class called LatLonGeometry. (#1170)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b536c3b9d177b12b973aa902c7e47474f0a39b7", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/7b536c3b9d177b12b973aa902c7e47474f0a39b7", "committedDate": "2020-01-30T15:56:52Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87361658b056558929bcc33d9ba55b5312f62d59", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/87361658b056558929bcc33d9ba55b5312f62d59", "committedDate": "2020-01-31T22:11:21Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a09e366714a921d489869eefb59f71aab313e0c", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/7a09e366714a921d489869eefb59f71aab313e0c", "committedDate": "2020-02-03T13:53:26Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41f78f3d78e6c7b55156a3bb560d4b1acaa3a599", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/41f78f3d78e6c7b55156a3bb560d4b1acaa3a599", "committedDate": "2020-02-04T13:56:07Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce2dc9bb72464544dc1aa1faa1cafaf0f4214560", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/ce2dc9bb72464544dc1aa1faa1cafaf0f4214560", "committedDate": "2020-02-04T14:19:04Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33e6384faf5d9d4c5c5dcf8bd8cabe98cdff3695", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/33e6384faf5d9d4c5c5dcf8bd8cabe98cdff3695", "committedDate": "2020-02-05T00:52:53Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c1e87de708581a9c608a6c711e498de1a4c5a86", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/0c1e87de708581a9c608a6c711e498de1a4c5a86", "committedDate": "2020-02-05T13:53:22Z", "message": "LUCENE-9134: Port ant-regenerate tasks to Gradle build (util regeneration)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b2c9528c7bdb678a1bfdd3e99a3d6b844d98202", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/6b2c9528c7bdb678a1bfdd3e99a3d6b844d98202", "committedDate": "2020-02-10T23:26:53Z", "message": "LUCENE-9134: Port ant-regenerate tasks to Gradle build utils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4b3d9450930714b65c74fc3761eeca948a7cf88", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/a4b3d9450930714b65c74fc3761eeca948a7cf88", "committedDate": "2020-02-11T15:14:30Z", "message": "LUCENE-9134: Port ant-regenerate tasks to Gradle build (automata and packed regeneration)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NzU3MjQ4", "url": "https://github.com/apache/lucene-solr/pull/1251#pullrequestreview-356757248", "createdAt": "2020-02-11T15:35:03Z", "commit": {"oid": "a4b3d9450930714b65c74fc3761eeca948a7cf88"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNTozNTowM1rOFoNvCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNTozNTowM1rOFoNvCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzcxMjM5Mg==", "bodyText": "I'll put this lf in", "url": "https://github.com/apache/lucene-solr/pull/1251#discussion_r377712392", "createdAt": "2020-02-11T15:35:03Z", "author": {"login": "ErickErickson"}, "path": "gradle/generation/util.gradle", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+apply plugin: \"de.undercouch.download\"\n+\n+configure(rootProject) {\n+  configurations {\n+    utilgen\n+  }\n+\n+  task utilgen {\n+    description \"Regenerate sources for ...lucene/util/automaton and ...lucene/util/packed.\"\n+    group \"generation\"\n+\n+    dependsOn \":lucene:core:utilGenPacked\"\n+    dependsOn \":lucene:core:utilGenLev\"\n+  }\n+}\n+\n+def momanDir = new File(buildDir, \"moman\").getAbsolutePath()\n+task installMoman(type: Download) {\n+\n+  def momanZip = new File(momanDir, \"moman.zip\").getAbsolutePath()\n+\n+  src \"https://bitbucket.org/jpbarrette/moman/get/5c5c2a1e4dea.zip\"\n+  dest momanZip\n+  onlyIfModified true\n+\n+  doLast {\n+    logger.lifecycle(\"Downloading moman to: ${buildDir}\")\n+    ant.unzip(src: momanZip, dest: momanDir, overwrite: \"true\") {\n+      ant.cutdirsmapper(dirs: \"1\")\n+    }\n+  }\n+}\n+\n+configure(project(\":lucene:core\")) {\n+  task utilGenPacked(dependsOn: installMoman) {\n+    description \"Regenerate util/PackedBulkOperationsPacked*.java and Packed64SingleBlock.java\"\n+    group \"generation\"\n+\n+    def workDir = \"src/java/org/apache/lucene/util/packed\"\n+\n+    doLast {\n+      ['gen_BulkOperation.py', 'gen_Packed64SingleBlock.py'].each { prog ->\n+        logger.lifecycle(\"Executing: ${prog} in ${workDir}\")\n+        project.exec {\n+          workingDir workDir\n+          executable \"python\"\n+          args = ['-B', \"${prog}\"]\n+        }\n+      }\n+      // Correct line endings for Windows.\n+      project.ant.fixcrlf(\n+          srcDir: workDir,\n+          includes: 'Packed64SingleBlock.java, BulkOperation*.java',\n+          encoding: 'UTF-8',\n+          eol: 'lf'\n+      )\n+    }\n+  }\n+\n+  task utilGenLev(dependsOn: installMoman) {\n+    description \"Regenerate util/automaton Lev*ParametricDescription.java\"\n+    group \"generation\"\n+\n+    doLast {\n+      def workDir = 'src/java/org/apache/lucene/util/automaton'\n+\n+      ['1', '2'].each { num ->\n+        ['True', 'False'].each { transpose ->\n+          project.exec {\n+            workingDir workDir\n+            executable \"python\"\n+            args = ['-B', 'createLevAutomata.py', num, transpose, \"${momanDir}/finenight/python\"]\n+          }\n+        }\n+      }\n+      project.ant.fixcrlf(\n+          srcDir: workDir,\n+          includes: '*ParametricDescription.java',\n+          encoding: 'UTF-8',\n+          eol: 'lf'\n+      )\n+    }\n+  }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4b3d9450930714b65c74fc3761eeca948a7cf88"}, "originalPosition": 100}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44bc51202fafcde5391f46cd8b1bdee3def73285", "author": {"user": {"login": "ErickErickson", "name": "Erick Erickson "}}, "url": "https://github.com/apache/lucene-solr/commit/44bc51202fafcde5391f46cd8b1bdee3def73285", "committedDate": "2020-02-11T15:36:20Z", "message": "LUCENE-9134: fixed no lf at end of file"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2315, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}