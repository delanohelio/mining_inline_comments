{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyODQ4MzYx", "number": 1716, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNTo0MjoxN1rOEVDs9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoyOTowNFrOEV8cGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTE2MjEzOnYy", "diffSide": "RIGHT", "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNTo0MjoxN1rOG7mS5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNTo0MjoxN1rOG7mS5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NjU5OQ==", "bodyText": "I brought this back in from the revert because it looks like an improvement that was unrelated to the default policy.\nI'm happy to remove it if y'all think I should.", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r465146599", "createdAt": "2020-08-04T15:42:17Z", "author": {"login": "HoustonPutman"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "diffHunk": "@@ -686,7 +686,7 @@ boolean isShardAbsent() {\n       for (Row r : session.matrix) {\n         computedValueEvaluator.node = r.node;\n         SealedClause sealedClause = getSealedClause(computedValueEvaluator);\n-        if (!sealedClause.getGlobalTag().isPass(r)) {\n+        if (r.isLive() && !sealedClause.getGlobalTag().isPass(r)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf2b30bcb19e6b97310af76cf6d48488d52f2122"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNzE4Nzk1OnYy", "diffSide": "RIGHT", "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwNDoxNToxNlrOG75hTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzowNjoxNVrOG8SyBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ2MTU4Mg==", "bodyText": "The other caveat is probably that they shouldn't run this command if they have been actively using autoscaling cluster policies before they upgraded to 8.6.0", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r465461582", "createdAt": "2020-08-05T04:15:16Z", "author": {"login": "gus-asf"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -34,17 +34,24 @@ Detailed steps for upgrading a Solr cluster are in the section <<upgrading-a-sol\n \n If you are upgrading from 7.x, see the section <<Upgrading from 7.x Releases>> below.\n \n-=== Solr 8.6.1\n+=== Solr 8.6.1 (Upgrading from 8.6.0 only)\n \n *Autoscaling*\n \n * As mentioned in the 8.6 upgrade notes, a default autoscaling policy was provided starting in 8.6.0.\n This default autoscaling policy resulted in increasingly slow collection creation calls in large clusters (50+ collections).\n +\n In 8.6.1 the default autoscaling policy has been removed, and clouds will not use autoscaling unless a policy has explicitly been created.\n-In order to fix the performance degradations introduced in 8.6.0, merely upgrade to 8.6.1.\n+If your cloud has been upgraded to 8.6.0 and you wish to fix this performance degredations, upgrade to 8.6.1 and remove the default cluster policy via the following command.\n+Replace `localhost:8983` with your Solr endpoint.\n++\n+```\n+curl -X POST -H 'Content-type:application/json'  -d '{set-cluster-policy : []}' http://localhost:8983/api/cluster/autoscaling", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af7c31321199ef583601836fdcd0b149425d8eb2"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgwNjY1NA==", "bodyText": "I tried to make this more clear. Let me know if you think my wording is off", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r465806654", "createdAt": "2020-08-05T15:20:38Z", "author": {"login": "HoustonPutman"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -34,17 +34,24 @@ Detailed steps for upgrading a Solr cluster are in the section <<upgrading-a-sol\n \n If you are upgrading from 7.x, see the section <<Upgrading from 7.x Releases>> below.\n \n-=== Solr 8.6.1\n+=== Solr 8.6.1 (Upgrading from 8.6.0 only)\n \n *Autoscaling*\n \n * As mentioned in the 8.6 upgrade notes, a default autoscaling policy was provided starting in 8.6.0.\n This default autoscaling policy resulted in increasingly slow collection creation calls in large clusters (50+ collections).\n +\n In 8.6.1 the default autoscaling policy has been removed, and clouds will not use autoscaling unless a policy has explicitly been created.\n-In order to fix the performance degradations introduced in 8.6.0, merely upgrade to 8.6.1.\n+If your cloud has been upgraded to 8.6.0 and you wish to fix this performance degredations, upgrade to 8.6.1 and remove the default cluster policy via the following command.\n+Replace `localhost:8983` with your Solr endpoint.\n++\n+```\n+curl -X POST -H 'Content-type:application/json'  -d '{set-cluster-policy : []}' http://localhost:8983/api/cluster/autoscaling", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ2MTU4Mg=="}, "originalCommit": {"oid": "af7c31321199ef583601836fdcd0b149425d8eb2"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg3NTQ2MQ==", "bodyText": "Yeah that looks better :)", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r465875461", "createdAt": "2020-08-05T17:06:15Z", "author": {"login": "gus-asf"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -34,17 +34,24 @@ Detailed steps for upgrading a Solr cluster are in the section <<upgrading-a-sol\n \n If you are upgrading from 7.x, see the section <<Upgrading from 7.x Releases>> below.\n \n-=== Solr 8.6.1\n+=== Solr 8.6.1 (Upgrading from 8.6.0 only)\n \n *Autoscaling*\n \n * As mentioned in the 8.6 upgrade notes, a default autoscaling policy was provided starting in 8.6.0.\n This default autoscaling policy resulted in increasingly slow collection creation calls in large clusters (50+ collections).\n +\n In 8.6.1 the default autoscaling policy has been removed, and clouds will not use autoscaling unless a policy has explicitly been created.\n-In order to fix the performance degradations introduced in 8.6.0, merely upgrade to 8.6.1.\n+If your cloud has been upgraded to 8.6.0 and you wish to fix this performance degredations, upgrade to 8.6.1 and remove the default cluster policy via the following command.\n+Replace `localhost:8983` with your Solr endpoint.\n++\n+```\n+curl -X POST -H 'Content-type:application/json'  -d '{set-cluster-policy : []}' http://localhost:8983/api/cluster/autoscaling", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ2MTU4Mg=="}, "originalCommit": {"oid": "af7c31321199ef583601836fdcd0b149425d8eb2"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwOTc4NDE4OnYy", "diffSide": "RIGHT", "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjo1ODo1M1rOG8ShBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDowNzoyOVrOG9CgRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg3MTEwOQ==", "bodyText": "from my very limited understanding of this code it appears that something like\n    if (globalTagName.isPresent()) {\n      validateGlobalTag(m, globalTagName.get());\n      globalTag = parse(globalTagName.get(), m);\n ...\nand \n...\n  private void validateGlobalTag(Map<String, Object> m, String tagName) {\n    if (m.size() > 2) {\n      if (!m.containsKey(\"strict\") || m.size() > 3) {\n        throw new RuntimeException(\"Only, 'strict' and one extra tag supported for the tag \" + tagName + \" in \" + toJSONString(m));\n      }\n    }\n  }\n\nwould be the real intention here... but it would be great if @sigram could confirm that.", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r465871109", "createdAt": "2020-08-05T16:58:53Z", "author": {"login": "gus-asf"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "diffHunk": "@@ -117,10 +117,10 @@ private Clause(Map<String, Object> m) {\n     strict = Boolean.parseBoolean(String.valueOf(m.getOrDefault(\"strict\", \"true\")));\n     Optional<String> globalTagName = m.keySet().stream().filter(Policy.GLOBAL_ONLY_TAGS::contains).findFirst();\n     if (globalTagName.isPresent()) {\n-      globalTag = parse(globalTagName.get(), m);\n-      if (m.size() > 2) {\n-        throw new RuntimeException(\"Only one extra tag supported for the tag \" + globalTagName.get() + \" in \" + toJSONString(m));\n+      if (m.size() > 3) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwNTM0OQ==", "bodyText": "@gus-asf yes, that's the intent, though your pseudo-code is still incorrect - if there's no strict tag then m.size() > 2 is already an error. In other words, for global tags we expect exactly 2 keys (tag and operand), with optional third key strict.", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466605349", "createdAt": "2020-08-06T18:27:21Z", "author": {"login": "sigram"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "diffHunk": "@@ -117,10 +117,10 @@ private Clause(Map<String, Object> m) {\n     strict = Boolean.parseBoolean(String.valueOf(m.getOrDefault(\"strict\", \"true\")));\n     Optional<String> globalTagName = m.keySet().stream().filter(Policy.GLOBAL_ONLY_TAGS::contains).findFirst();\n     if (globalTagName.isPresent()) {\n-      globalTag = parse(globalTagName.get(), m);\n-      if (m.size() > 2) {\n-        throw new RuntimeException(\"Only one extra tag supported for the tag \" + globalTagName.get() + \" in \" + toJSONString(m));\n+      if (m.size() > 3) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg3MTEwOQ=="}, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY1NzM0OA==", "bodyText": "I think that's the logic Gus used. It's equivalent to:\nprivate void validateGlobalTag(Map<String, Object> m, String tagName) {\n    if (m.size() > 2) {\n      if (!(m.containsKey(\"strict\") && m.size() == 3)) {\n        throw new RuntimeException(\"Only, 'strict' and one extra tag supported for the tag \" + tagName + \" in \" + toJSONString(m));\n      }\n    }\n  }\nThis will error unless there are exactly 3 keys and once of them is strict.", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466657348", "createdAt": "2020-08-06T20:07:29Z", "author": {"login": "HoustonPutman"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "diffHunk": "@@ -117,10 +117,10 @@ private Clause(Map<String, Object> m) {\n     strict = Boolean.parseBoolean(String.valueOf(m.getOrDefault(\"strict\", \"true\")));\n     Optional<String> globalTagName = m.keySet().stream().filter(Policy.GLOBAL_ONLY_TAGS::contains).findFirst();\n     if (globalTagName.isPresent()) {\n-      globalTag = parse(globalTagName.get(), m);\n-      if (m.size() > 2) {\n-        throw new RuntimeException(\"Only one extra tag supported for the tag \" + globalTagName.get() + \" in \" + toJSONString(m));\n+      if (m.size() > 3) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg3MTEwOQ=="}, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDQwMDcxOnYy", "diffSide": "RIGHT", "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoxMjoxOVrOG8-1ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxOTozOTo1MVrOG9Bp8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NzIyMA==", "bodyText": "Setting preferences to [] actually removes the default preferences that have always been implicitly present, so this changes the behavior as compared with 8.5 and earlier. We should only reset the cluster_policy to [].", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466597220", "createdAt": "2020-08-06T18:12:19Z", "author": {"login": "sigram"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -34,17 +34,29 @@ Detailed steps for upgrading a Solr cluster are in the section <<upgrading-a-sol\n \n If you are upgrading from 7.x, see the section <<Upgrading from 7.x Releases>> below.\n \n-=== Solr 8.6.1\n+=== Solr 8.6.1 (Upgrading from 8.6.0 only)\n+\n+See the https://cwiki.apache.org/confluence/display/SOLR/ReleaseNote861[8.6.1 Release Notes^]\n+for an overview of the fixes included in Solr 8.6.1.\n+\n+When upgrading to 8.6.1 users should be aware of the following major changes from 8.6.0.\n \n *Autoscaling*\n \n * As mentioned in the 8.6 upgrade notes, a default autoscaling policy was provided starting in 8.6.0.\n This default autoscaling policy resulted in increasingly slow collection creation calls in large clusters (50+ collections).\n +\n In 8.6.1 the default autoscaling policy has been removed, and clouds will not use autoscaling unless a policy has explicitly been created.\n-In order to fix the performance degradations introduced in 8.6.0, merely upgrade to 8.6.1.\n+If your cloud is running 8.6.0 and **not using an explicit autoscaling policy**, upgrade to 8.6.1 and remove the default cluster policy and preferences via the following command.\n+Replace `localhost:8983` with your Solr endpoint.\n++\n+```\n+curl -X POST -H 'Content-type:application/json'  -d '{set-cluster-policy : [], set-cluster-preferences : []}' http://localhost:8983/api/cluster/autoscaling", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY0MzQ0Mg==", "bodyText": "Hmmm, I'm a bit confused about that. So if I spin up a new cloud with 8.5, I don't see a cluster-preferences. It basically looks the same as a 8.6.1 cloud that has the above command run. So if we reverted the change of the defaulting patch, shouldn't a 8.5 cloud and 8.6.1 cloud with identical autoscaling.json ZNodes behave the same?", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466643442", "createdAt": "2020-08-06T19:39:51Z", "author": {"login": "HoustonPutman"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -34,17 +34,29 @@ Detailed steps for upgrading a Solr cluster are in the section <<upgrading-a-sol\n \n If you are upgrading from 7.x, see the section <<Upgrading from 7.x Releases>> below.\n \n-=== Solr 8.6.1\n+=== Solr 8.6.1 (Upgrading from 8.6.0 only)\n+\n+See the https://cwiki.apache.org/confluence/display/SOLR/ReleaseNote861[8.6.1 Release Notes^]\n+for an overview of the fixes included in Solr 8.6.1.\n+\n+When upgrading to 8.6.1 users should be aware of the following major changes from 8.6.0.\n \n *Autoscaling*\n \n * As mentioned in the 8.6 upgrade notes, a default autoscaling policy was provided starting in 8.6.0.\n This default autoscaling policy resulted in increasingly slow collection creation calls in large clusters (50+ collections).\n +\n In 8.6.1 the default autoscaling policy has been removed, and clouds will not use autoscaling unless a policy has explicitly been created.\n-In order to fix the performance degradations introduced in 8.6.0, merely upgrade to 8.6.1.\n+If your cloud is running 8.6.0 and **not using an explicit autoscaling policy**, upgrade to 8.6.1 and remove the default cluster policy and preferences via the following command.\n+Replace `localhost:8983` with your Solr endpoint.\n++\n+```\n+curl -X POST -H 'Content-type:application/json'  -d '{set-cluster-policy : [], set-cluster-preferences : []}' http://localhost:8983/api/cluster/autoscaling", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NzIyMA=="}, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDQxMjcwOnYy", "diffSide": "RIGHT", "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoxNTo0NlrOG8-8vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDozMzo0M1rOG9DS2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5OTEwMA==", "bodyText": "This statement conflicts with the statement above. 8.5.x and 8.6.1 includes default preferences but not the default policy.", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466599100", "createdAt": "2020-08-06T18:15:46Z", "author": {"login": "sigram"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -72,7 +84,9 @@ More information about this new feature is available in the section <<common-que\n \n *Autoscaling*\n \n-* Solr now includes a default autoscaling policy.\n+* **NOTE: The default autoscaling policy has been removed as of 8.6.1**\n++\n+Solr now includes a default autoscaling policy.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY3MDI5OA==", "bodyText": "Fresh install of 8.5.2 gives me:\n{\n  \"triggers\":{\n    \".auto_add_replicas\":{\n      \"name\":\".auto_add_replicas\",\n      \"event\":\"nodeLost\",\n      \"waitFor\":120,\n      \"enabled\":true,\n      \"actions\":[\n        {\n          \"name\":\"auto_add_replicas_plan\",\n          \"class\":\"solr.AutoAddReplicasPlanAction\"},\n        {\n          \"name\":\"execute_plan\",\n          \"class\":\"solr.ExecutePlanAction\"}]},\n    \".scheduled_maintenance\":{\n      \"name\":\".scheduled_maintenance\",\n      \"event\":\"scheduled\",\n      \"startTime\":\"NOW\",\n      \"every\":\"+1DAY\",\n      \"enabled\":true,\n      \"actions\":[\n        {\n          \"name\":\"inactive_shard_plan\",\n          \"class\":\"solr.InactiveShardPlanAction\"},\n        {\n          \"name\":\"inactive_markers_plan\",\n          \"class\":\"solr.InactiveMarkersPlanAction\"},\n        {\n          \"name\":\"execute_plan\",\n          \"class\":\"solr.ExecutePlanAction\"}]}},\n  \"listeners\":{\n    \".auto_add_replicas.system\":{\n      \"beforeAction\":[],\n      \"afterAction\":[],\n      \"stage\":[\n        \"STARTED\",\n        \"ABORTED\",\n        \"SUCCEEDED\",\n        \"FAILED\",\n        \"BEFORE_ACTION\",\n        \"AFTER_ACTION\",\n        \"IGNORED\"],\n      \"trigger\":\".auto_add_replicas\",\n      \"class\":\"org.apache.solr.cloud.autoscaling.SystemLogListener\"},\n    \".scheduled_maintenance.system\":{\n      \"beforeAction\":[],\n      \"afterAction\":[],\n      \"stage\":[\n        \"STARTED\",\n        \"ABORTED\",\n        \"SUCCEEDED\",\n        \"FAILED\",\n        \"BEFORE_ACTION\",\n        \"AFTER_ACTION\",\n        \"IGNORED\"],\n      \"trigger\":\".scheduled_maintenance\",\n      \"class\":\"org.apache.solr.cloud.autoscaling.SystemLogListener\"}},\n  \"properties\":{}}", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466670298", "createdAt": "2020-08-06T20:33:43Z", "author": {"login": "gus-asf"}, "path": "solr/solr-ref-guide/src/solr-upgrade-notes.adoc", "diffHunk": "@@ -72,7 +84,9 @@ More information about this new feature is available in the section <<common-que\n \n *Autoscaling*\n \n-* Solr now includes a default autoscaling policy.\n+* **NOTE: The default autoscaling policy has been removed as of 8.6.1**\n++\n+Solr now includes a default autoscaling policy.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5OTEwMA=="}, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDQ1NDg5OnYy", "diffSide": "RIGHT", "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoyODoxMFrOG8_Wyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoyODoxMFrOG8_Wyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwNTc3MA==", "bodyText": "+1, this was a genuine bug in 8.5.", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466605770", "createdAt": "2020-08-06T18:28:10Z", "author": {"login": "sigram"}, "path": "solr/solrj/src/java/org/apache/solr/client/solrj/cloud/autoscaling/Clause.java", "diffHunk": "@@ -686,7 +686,7 @@ boolean isShardAbsent() {\n       for (Row r : session.matrix) {\n         computedValueEvaluator.node = r.node;\n         SealedClause sealedClause = getSealedClause(computedValueEvaluator);\n-        if (!sealedClause.getGlobalTag().isPass(r)) {\n+        if (r.isLive() && !sealedClause.getGlobalTag().isPass(r)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDQ1Nzg0OnYy", "diffSide": "RIGHT", "path": "solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimScenario.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoyOTowNFrOG8_YsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoyOTowNFrOG8_YsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYwNjI1Ng==", "bodyText": "+1, this fixed a genuine bug in < 8.6.0", "url": "https://github.com/apache/lucene-solr/pull/1716#discussion_r466606256", "createdAt": "2020-08-06T18:29:04Z", "author": {"login": "sigram"}, "path": "solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimScenario.java", "diffHunk": "@@ -814,7 +814,9 @@ public void execute(SimScenario scenario) throws Exception {\n         values.put(key, val);\n       }\n       for (String node : nodes) {\n-        scenario.cluster.getSimNodeStateProvider().simSetNodeValues(node, values);\n+        Map<String, Object> newValues = new HashMap<>(scenario.cluster.getSimNodeStateProvider().simGetNodeValues(node));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7a3884ffb9ce3f244c1a08e9b5681f7e440705"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1261, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}