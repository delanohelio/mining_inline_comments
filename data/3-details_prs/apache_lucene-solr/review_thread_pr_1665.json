{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NzMyOTg3", "number": 1665, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNzoyMjozN1rOENemBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNzoyMjozN1rOENemBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyNTY4MTk3OnYy", "diffSide": "RIGHT", "path": "solr/core/src/test/org/apache/solr/response/TestPushWriter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNzoyMjozN1rOGwLHdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNzo1MTo0M1rOGwLQCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2Njk2NA==", "bodyText": "what is this LocalSolrQueryRequest for?", "url": "https://github.com/apache/lucene-solr/pull/1665#discussion_r453166964", "createdAt": "2020-07-11T07:22:37Z", "author": {"login": "noblepaul"}, "path": "solr/core/src/test/org/apache/solr/response/TestPushWriter.java", "diffHunk": "@@ -45,26 +46,47 @@\n \n   public void testStandardResponse() throws IOException {\n     ByteArrayOutputStream baos = new ByteArrayOutputStream();\n-    OutputStreamWriter osw = new OutputStreamWriter(baos, StandardCharsets.UTF_8);\n-    PushWriter pw = new JSONWriter(osw,\n-        new LocalSolrQueryRequest(null, new ModifiableSolrParams()), new SolrQueryResponse());\n-    writeData(pw);\n-    osw.flush();\n-    if (log.isInfoEnabled()) {\n-      log.info(\"{}\", new String(baos.toByteArray(), StandardCharsets.UTF_8));\n+    Map m;\n+    try (OutputStreamWriter osw = new OutputStreamWriter(baos, StandardCharsets.UTF_8)) {\n+      JSONWriter pw = new JSONWriter(osw,\n+          new LocalSolrQueryRequest(null, new ModifiableSolrParams()), new SolrQueryResponse());\n+      writeData(null, pw);\n+      osw.flush();\n+      if (log.isInfoEnabled()) {\n+        log.info(\"{}\", new String(baos.toByteArray(), StandardCharsets.UTF_8));\n+      }\n+      m = (Map) Utils.fromJSON(baos.toByteArray());\n+      checkValues(m);\n     }\n-    @SuppressWarnings({\"rawtypes\"})\n-    Map m = (Map) Utils.fromJSON(baos.toByteArray());\n-    checkValues(m);\n+\n     try (JavaBinCodec jbc = new JavaBinCodec(baos= new ByteArrayOutputStream(), null)) {\n       writeData(jbc);\n-      try (JavaBinCodec jbcUn = new JavaBinCodec()) {\n-        m = (Map) jbcUn.unmarshal(new ByteArrayInputStream(baos.toByteArray()));\n-      }\n+      m = (Map) Utils.fromJavabin(baos.toByteArray());\n     }\n     checkValues(m);\n   }\n \n+  public void testXmlWriter() throws Exception {\n+    try (ByteArrayOutputStream baos = new ByteArrayOutputStream();\n+        OutputStreamWriter osw = new OutputStreamWriter(baos, StandardCharsets.UTF_8)) {\n+      XMLWriter xml = new XMLWriter(osw,\n+          new LocalSolrQueryRequest(null, new ModifiableSolrParams()), new SolrQueryResponse());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7346409465cfc2d44e153b1ff592f36d32c6f66"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2OTE2MA==", "bodyText": "XmlWriter takes SolrQueryRequest as one of the arg. so, I have created localSolrQueryRequest", "url": "https://github.com/apache/lucene-solr/pull/1665#discussion_r453169160", "createdAt": "2020-07-11T07:51:43Z", "author": {"login": "munendrasn"}, "path": "solr/core/src/test/org/apache/solr/response/TestPushWriter.java", "diffHunk": "@@ -45,26 +46,47 @@\n \n   public void testStandardResponse() throws IOException {\n     ByteArrayOutputStream baos = new ByteArrayOutputStream();\n-    OutputStreamWriter osw = new OutputStreamWriter(baos, StandardCharsets.UTF_8);\n-    PushWriter pw = new JSONWriter(osw,\n-        new LocalSolrQueryRequest(null, new ModifiableSolrParams()), new SolrQueryResponse());\n-    writeData(pw);\n-    osw.flush();\n-    if (log.isInfoEnabled()) {\n-      log.info(\"{}\", new String(baos.toByteArray(), StandardCharsets.UTF_8));\n+    Map m;\n+    try (OutputStreamWriter osw = new OutputStreamWriter(baos, StandardCharsets.UTF_8)) {\n+      JSONWriter pw = new JSONWriter(osw,\n+          new LocalSolrQueryRequest(null, new ModifiableSolrParams()), new SolrQueryResponse());\n+      writeData(null, pw);\n+      osw.flush();\n+      if (log.isInfoEnabled()) {\n+        log.info(\"{}\", new String(baos.toByteArray(), StandardCharsets.UTF_8));\n+      }\n+      m = (Map) Utils.fromJSON(baos.toByteArray());\n+      checkValues(m);\n     }\n-    @SuppressWarnings({\"rawtypes\"})\n-    Map m = (Map) Utils.fromJSON(baos.toByteArray());\n-    checkValues(m);\n+\n     try (JavaBinCodec jbc = new JavaBinCodec(baos= new ByteArrayOutputStream(), null)) {\n       writeData(jbc);\n-      try (JavaBinCodec jbcUn = new JavaBinCodec()) {\n-        m = (Map) jbcUn.unmarshal(new ByteArrayInputStream(baos.toByteArray()));\n-      }\n+      m = (Map) Utils.fromJavabin(baos.toByteArray());\n     }\n     checkValues(m);\n   }\n \n+  public void testXmlWriter() throws Exception {\n+    try (ByteArrayOutputStream baos = new ByteArrayOutputStream();\n+        OutputStreamWriter osw = new OutputStreamWriter(baos, StandardCharsets.UTF_8)) {\n+      XMLWriter xml = new XMLWriter(osw,\n+          new LocalSolrQueryRequest(null, new ModifiableSolrParams()), new SolrQueryResponse());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2Njk2NA=="}, "originalCommit": {"oid": "d7346409465cfc2d44e153b1ff592f36d32c6f66"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1363, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}