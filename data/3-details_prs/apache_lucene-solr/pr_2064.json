{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1ODk4NDMz", "number": 2064, "title": "LUCENE-9600: Clean up package name conflicts between misc and core modules", "bodyText": "This refactors misc module to resolve package name conflicts between misc and lucene-core.\n\nmoves o.a.l.document, o.a.l.index, o.a.l.search, o.a.l.store, o.a.l.util, and their sub-packages under o.a.l.misc.\nmade some refactorings to remove unnecessary accesses to package-private methods in lucene-core.\nmade methods in o.a.l.index.DocHelper and o.a.l.util.FSTTester in test-framework publicly accessible for unit testing.\nlucene-core isn't touched.", "createdAt": "2020-11-05T08:50:14Z", "url": "https://github.com/apache/lucene-solr/pull/2064", "merged": true, "mergeCommit": {"oid": "d1110394e9c963c999b261b8ac6dac1df518628d"}, "closed": true, "closedAt": "2020-11-10T13:24:49Z", "author": {"login": "mocobeta"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZeIu9AH2gAyNTE1ODk4NDMzOjM1NGRjY2JjYmJjYzc5YWM5ODFjNWZlN2M1MDZkNWM1ZTYyOWM3YmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbJCdEgH2gAyNTE1ODk4NDMzOjJiOGE0N2I0ZWZjZDNjYTNlOGNhNGU4NzFkOTAxMTA3OTRlMDI1ODA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf", "committedDate": "2020-11-05T08:32:02Z", "message": "LUCENE-9660: clean up split pacages in misc module"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDQ3MjMx", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524047231", "createdAt": "2020-11-05T08:58:47Z", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwODo1ODo0OFrOHt5Ybw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwODo1ODo0OFrOHt5Ybw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg4ODExMQ==", "bodyText": "SegmentInfos.remove(int) isn't accessible from external packages. This method call can be switched to SegmentInfo.remove(SegmentCommitInfo); that is already opened to public.", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r517888111", "createdAt": "2020-11-05T08:58:48Z", "author": {"login": "mocobeta"}, "path": "lucene/misc/src/java/org/apache/lucene/misc/index/IndexSplitter.java", "diffHunk": "@@ -123,8 +118,8 @@ private SegmentCommitInfo getInfo(String name) {\n \n   public void remove(String[] segs) throws IOException {\n     for (String n : segs) {\n-      int idx = getIdx(n);\n-      infos.remove(idx);\n+      SegmentCommitInfo info = getInfo(n);\n+      infos.remove(info);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDUxOTA2", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524051906", "createdAt": "2020-11-05T09:04:24Z", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOTowNDoyNVrOHt5l9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOTowNDoyNVrOHt5l9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5MTU3NA==", "bodyText": "BaseCompositeReader.getSequentialSubReaders() is a protected method so it cannot be directly called from here. A wrapper method is needed to move this class to o.a.l.misc.index from o.a.l.index.", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r517891574", "createdAt": "2020-11-05T09:04:25Z", "author": {"login": "mocobeta"}, "path": "lucene/misc/src/java/org/apache/lucene/misc/index/MultiPassIndexSplitter.java", "diffHunk": "@@ -101,7 +111,7 @@ public void split(IndexReader in, Directory[] outputs, boolean seq) throws IOExc\n           .setOpenMode(OpenMode.CREATE));\n       System.err.println(\"Writing part \" + (i + 1) + \" ...\");\n       // pass the subreaders directly, as our wrapper's numDocs/hasDeletetions are not up-to-date\n-      final List<? extends FakeDeleteLeafIndexReader> sr = input.getSequentialSubReaders();\n+      final List<? extends FakeDeleteLeafIndexReader> sr = input.getSequentialSubReadersWrapper();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDU2ODQ4", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524056848", "createdAt": "2020-11-05T09:10:24Z", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMDoyNVrOHt50Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMDoyNVrOHt50Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5NTI1OA==", "bodyText": "IndexWriter.getReader() is package-private so it cannot be accessed from here. It would be better that we omit this assertion (it seems these lines are not the main part of the test anyway), instead of opening IW.getReader() up to public?", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r517895258", "createdAt": "2020-11-05T09:10:25Z", "author": {"login": "mocobeta"}, "path": "lucene/misc/src/test/org/apache/lucene/misc/index/TestIndexSplitter.java", "diffHunk": "@@ -60,9 +67,9 @@ public void test() throws Exception {\n       iw.addDocument(doc);\n     }\n     iw.commit();\n-    DirectoryReader iwReader = iw.getReader();\n-    assertEquals(3, iwReader.leaves().size());\n-    iwReader.close();\n+    //DirectoryReader iwReader = iw.getReader();\n+    //assertEquals(3, iwReader.leaves().size());\n+    //iwReader.close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDU5NDQz", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524059443", "createdAt": "2020-11-05T09:13:28Z", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMzoyOFrOHt58Lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMzoyOFrOHt58Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5NzI2Mg==", "bodyText": "Looks like this should be publicly accessible for tests in any modules?", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r517897262", "createdAt": "2020-11-05T09:13:28Z", "author": {"login": "mocobeta"}, "path": "lucene/test-framework/src/java/org/apache/lucene/util/fst/FSTTester.java", "diffHunk": "@@ -95,7 +95,7 @@ private static BytesRef toBytesRef(IntsRef ir) {\n     return br;\n   }\n \n-  static String getRandomString(Random random) {\n+  public static String getRandomString(Random random) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDU5NTQz", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524059543", "createdAt": "2020-11-05T09:13:36Z", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMzozNlrOHt58hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMzozNlrOHt58hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5NzM1MA==", "bodyText": "Looks like this should be publicly accessible for tests in any modules?", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r517897350", "createdAt": "2020-11-05T09:13:36Z", "author": {"login": "mocobeta"}, "path": "lucene/test-framework/src/java/org/apache/lucene/util/fst/FSTTester.java", "diffHunk": "@@ -121,7 +121,7 @@ static String simpleRandomString(Random r) {\n     return new String(buffer, 0, end);\n   }\n \n-  static IntsRef toIntsRef(String s, int inputMode) {\n+  public static IntsRef toIntsRef(String s, int inputMode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDU5NzU5", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524059759", "createdAt": "2020-11-05T09:13:53Z", "commit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMzo1M1rOHt59Ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxMzo1M1rOHt59Ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5NzUzMQ==", "bodyText": "Looks like this should be publicly accessible for tests in any modules?", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r517897531", "createdAt": "2020-11-05T09:13:53Z", "author": {"login": "mocobeta"}, "path": "lucene/test-framework/src/java/org/apache/lucene/index/DocHelper.java", "diffHunk": "@@ -35,7 +35,8 @@\n import org.apache.lucene.search.similarities.Similarity;\n import org.apache.lucene.store.Directory;\n \n-class DocHelper {\n+/** Helper functions for tests that handles documents */\n+public class DocHelper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4858a5d8347c72364c4a6572345a3fc52f43cc77", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/4858a5d8347c72364c4a6572345a3fc52f43cc77", "committedDate": "2020-11-05T09:30:33Z", "message": "use DirectoryReader.open(iw) instead of IndexWriter.getReader()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0Mjc0NzQ1", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-524274745", "createdAt": "2020-11-05T13:47:11Z", "commit": {"oid": "4858a5d8347c72364c4a6572345a3fc52f43cc77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "381a3727894febf8a4caec973d4b435cc02a5380", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/381a3727894febf8a4caec973d4b435cc02a5380", "committedDate": "2020-11-05T23:49:59Z", "message": "move InetAddressPoint and InetAddressRange to core."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1Mzk3NDEx", "url": "https://github.com/apache/lucene-solr/pull/2064#pullrequestreview-525397411", "createdAt": "2020-11-06T18:31:45Z", "commit": {"oid": "381a3727894febf8a4caec973d4b435cc02a5380"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODozMTo0NVrOHu5DMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODozMTo0NVrOHu5DMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkzMTI1MQ==", "bodyText": "If you're going to make this method public... I think even a tiny bit of documentation would be helpful.  Like maybe recommend callers consider the methods Dawid mentioned in RandomizedTesting instead.  After all, we're only making this public for some test in misc to call it.  We aren't signaling to all of Lucene, Solr, and any of the plugin writers, that we've got some awesome random string generating that everyone should use :-)\nFWIW I prefer that we maintain less code and use whatever's in RandomizedTesting when possible, but I won't stand in the way of your judgement here.", "url": "https://github.com/apache/lucene-solr/pull/2064#discussion_r518931251", "createdAt": "2020-11-06T18:31:45Z", "author": {"login": "dsmiley"}, "path": "lucene/test-framework/src/java/org/apache/lucene/util/fst/FSTTester.java", "diffHunk": "@@ -95,7 +95,7 @@ private static BytesRef toBytesRef(IntsRef ir) {\n     return br;\n   }\n \n-  static String getRandomString(Random random) {\n+  public static String getRandomString(Random random) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5NzI2Mg=="}, "originalCommit": {"oid": "354dccbcbbcc79ac981c5fe7c506d5c5e629c7bf"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0d97b595f8d01f81db6d1f068aa8ae11d47887e", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/a0d97b595f8d01f81db6d1f068aa8ae11d47887e", "committedDate": "2020-11-08T11:30:59Z", "message": "add note to FSTTester.getRandomString()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f8d50c75bbd1588a9ad227360ebea571cf0a4a5", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/3f8d50c75bbd1588a9ad227360ebea571cf0a4a5", "committedDate": "2020-11-10T12:59:15Z", "message": "Merge branch 'master' into jira/LUCENE-9600"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c6fa54f1b282706f27ae27575824bd43ad003c7", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/2c6fa54f1b282706f27ae27575824bd43ad003c7", "committedDate": "2020-11-10T13:00:37Z", "message": "add CHANGES"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b8a47b4efcd3ca3e8ca4e871d90110794e02580", "author": {"user": {"login": "mocobeta", "name": "Tomoko Uchida"}}, "url": "https://github.com/apache/lucene-solr/commit/2b8a47b4efcd3ca3e8ca4e871d90110794e02580", "committedDate": "2020-11-10T13:05:01Z", "message": "add MIGRATE entry"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2570, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}