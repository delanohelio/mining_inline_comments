{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNzExNzE2", "number": 1977, "title": "SOLR-14907: Support single file upload/overwrite in configSet API", "bodyText": "https://issues.apache.org/jira/browse/SOLR-14907", "createdAt": "2020-10-12T17:32:10Z", "url": "https://github.com/apache/lucene-solr/pull/1977", "merged": true, "mergeCommit": {"oid": "bcd9cbec95507d19f17b459ea2f4b96d5de9486e"}, "closed": true, "closedAt": "2020-10-13T20:51:22Z", "author": {"login": "HoustonPutman"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR3aqdgH2gAyNTAxNzExNzE2OjllNzNmNDA0MmE2NGQ1MGE0MjA0NzY4YmVjNDc0ZDcwY2VhZGFmNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSNACqgH2gAyNTAxNzExNzE2OjM0YzIyYTA3NDUxMWI0ZTM0ZDAxNDY5ZGI5MzU0Njg0ZjZkNTMxNTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9e73f4042a64d50a4204768bec474d70ceadaf54", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/9e73f4042a64d50a4204768bec474d70ceadaf54", "committedDate": "2020-10-12T17:27:51Z", "message": "SOLR-14907: Support single file upload/overwrite in configSet API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d45fac6cb4cf116d0cb2d067812514d4133c7e7", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/5d45fac6cb4cf116d0cb2d067812514d4133c7e7", "committedDate": "2020-10-12T18:14:27Z", "message": "Fix filePath parameter in tests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2OTU2MzM4", "url": "https://github.com/apache/lucene-solr/pull/1977#pullrequestreview-506956338", "createdAt": "2020-10-12T22:34:50Z", "commit": {"oid": "5d45fac6cb4cf116d0cb2d067812514d4133c7e7"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMjozNDo1MFrOHgPTSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQyMjozNDo1MFrOHgPTSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU2NzE3OQ==", "bodyText": "should we error instead of silently ignoring the cleanup param? it defaults to false, so someone must have explicitly set it to true", "url": "https://github.com/apache/lucene-solr/pull/1977#discussion_r503567179", "createdAt": "2020-10-12T22:34:50Z", "author": {"login": "tflobbe"}, "path": "solr/core/src/java/org/apache/solr/handler/admin/ConfigSetsHandler.java", "diffHunk": "@@ -170,10 +170,14 @@ private void handleConfigUploadRequest(SolrQueryRequest req, SolrQueryResponse r\n \n     boolean overwritesExisting = zkClient.exists(configPathInZk, true);\n \n-    if (overwritesExisting && !req.getParams().getBool(ConfigSetParams.OVERWRITE, false)) {\n-      throw new SolrException(ErrorCode.BAD_REQUEST,\n-          \"The configuration \" + configSetName + \" already exists in zookeeper\");\n-    }\n+    // Get upload parameters\n+    String singleFilePath = req.getParams().get(ConfigSetParams.FILE_PATH, \"\");\n+    boolean allowOverwrite = req.getParams().getBool(ConfigSetParams.OVERWRITE, false);\n+    // Cleanup is not allowed while using singleFilePath upload\n+    boolean cleanup = singleFilePath.isEmpty() && req.getParams().getBool(ConfigSetParams.CLEANUP, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d45fac6cb4cf116d0cb2d067812514d4133c7e7"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbfc89e2183ca54a6b01fa3b918e94ded4cca929", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/dbfc89e2183ca54a6b01fa3b918e94ded4cca929", "committedDate": "2020-10-12T23:15:34Z", "message": "Adding extra error handling."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc37f0fa49e395a942b2b9fbacf342faa1d03bda", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/bc37f0fa49e395a942b2b9fbacf342faa1d03bda", "committedDate": "2020-10-12T23:18:34Z", "message": "Update configsets-api.adoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ae14110391fbd2d2ceb6d2a295296f1402bcffa", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/1ae14110391fbd2d2ceb6d2a295296f1402bcffa", "committedDate": "2020-10-12T23:26:30Z", "message": "Moved creation of baseZnode after error checking for security purposes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a58a9dd874cfd900ed1dd9bc216ae0629c9abc5f", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/a58a9dd874cfd900ed1dd9bc216ae0629c9abc5f", "committedDate": "2020-10-12T23:53:58Z", "message": "Securing configSets on badZip upload."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34c22a074511b4e34d01469db9354684f6d53155", "author": {"user": {"login": "HoustonPutman", "name": "Houston Putman"}}, "url": "https://github.com/apache/lucene-solr/commit/34c22a074511b4e34d01469db9354684f6d53155", "committedDate": "2020-10-13T18:36:41Z", "message": "Adding docs for overwrite with filePath."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2729, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}