{"pr_number": 4030, "pr_title": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not retur\u2026", "pr_createdAt": "2020-02-05T16:27:25Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4030", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM3ODkzNQ==", "url": "https://github.com/geoserver/geoserver/pull/4030#discussion_r375378935", "bodyText": "If my memory serves me well, if a metric is not available in a certain environment (for example the machine doesn't provide a network sensor) the the metric will not be collected. Hence, checking that available metrics have a value makes sense, but checking the size probably not \ud83d\ude31.", "author": "nmco", "createdAt": "2020-02-05T16:51:41Z", "path": "src/restconfig/src/test/java/org/geoserver/rest/system/status/MonitorRestTest.java", "diffHunk": "@@ -69,6 +74,41 @@ public void testJsonCallback() throws Exception {\n         assertTrue(metrics.getMetrics().size() >= MetricInfo.values().length);\n     }\n \n+    @Test\n+    public void testJsonValueFieldIsEncoded() throws Exception {\n+        MockHttpServletResponse response =\n+                getAsServletResponse(RestBaseController.ROOT_PATH + \"/about/system-status.json\");\n+        assertEquals(200, response.getStatus());\n+        assertEquals(\"application/json\", response.getContentType());\n+        JSONArray array =\n+                ((JSONObject)\n+                                ((JSONObject) JSONSerializer.toJSON(response.getContentAsString()))\n+                                        .get(\"metrics\"))\n+                        .getJSONArray(\"metric\");\n+        assertTrue(array.size() == MetricInfo.values().length);\n+        for (int i = 0; i < array.size(); i++) {", "originalCommit": "f185cd2d26538561fe3a297d54694dabc0b57e1b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTY4NjY1Mg==", "url": "https://github.com/geoserver/geoserver/pull/4030#discussion_r375686652", "bodyText": "Thanks for your review @nmco, this has  been fixed", "author": "taba90", "createdAt": "2020-02-06T08:05:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM3ODkzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTcxNjA4OA==", "url": "https://github.com/geoserver/geoserver/pull/4030#discussion_r375716088", "bodyText": "Great, thx!", "author": "nmco", "createdAt": "2020-02-06T09:14:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM3ODkzNQ=="}], "type": "inlineReview"}, {"oid": "78a62f7c8d02b3cfbbf1650a315b96ffc8f44ed4", "url": "https://github.com/geoserver/geoserver/commit/78a62f7c8d02b3cfbbf1650a315b96ffc8f44ed4", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-05T17:03:49Z", "type": "forcePushed"}, {"oid": "8f785d6b13cb94c20a271d3cf26d71f0bcfc78fd", "url": "https://github.com/geoserver/geoserver/commit/8f785d6b13cb94c20a271d3cf26d71f0bcfc78fd", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T08:01:24Z", "type": "forcePushed"}, {"oid": "21a9aec16adc5e376c4411d522643eba8f3f6967", "url": "https://github.com/geoserver/geoserver/commit/21a9aec16adc5e376c4411d522643eba8f3f6967", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T08:30:19Z", "type": "forcePushed"}, {"oid": "e9c527ce25f88958eb0cdf0c1ddd9d780f1ab7cd", "url": "https://github.com/geoserver/geoserver/commit/e9c527ce25f88958eb0cdf0c1ddd9d780f1ab7cd", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T08:58:28Z", "type": "forcePushed"}, {"oid": "1247af34f2f254913b75b4f33a7a4f99c95f11ae", "url": "https://github.com/geoserver/geoserver/commit/1247af34f2f254913b75b4f33a7a4f99c95f11ae", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T10:29:27Z", "type": "forcePushed"}, {"oid": "bb51fd0b3c5fa2967c3bc3fe533cabe048220bd1", "url": "https://github.com/geoserver/geoserver/commit/bb51fd0b3c5fa2967c3bc3fe533cabe048220bd1", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T11:54:50Z", "type": "forcePushed"}, {"oid": "6ec9362697986e7582493403385fe7aae10b6354", "url": "https://github.com/geoserver/geoserver/commit/6ec9362697986e7582493403385fe7aae10b6354", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T12:46:19Z", "type": "forcePushed"}, {"oid": "8c607e35df08da40ec1d408c8865281254cc8fb5", "url": "https://github.com/geoserver/geoserver/commit/8c607e35df08da40ec1d408c8865281254cc8fb5", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T15:31:56Z", "type": "forcePushed"}, {"oid": "341e3be5a4db2c2461b3b510a542ba344bc1c2c3", "url": "https://github.com/geoserver/geoserver/commit/341e3be5a4db2c2461b3b510a542ba344bc1c2c3", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T16:23:04Z", "type": "forcePushed"}, {"oid": "0d1ae08b3fe495bba535d75a135d158e7d472b2a", "url": "https://github.com/geoserver/geoserver/commit/0d1ae08b3fe495bba535d75a135d158e7d472b2a", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-06T16:52:30Z", "type": "forcePushed"}, {"oid": "494aa6ab8d92f5d3ccac9199081e17041b3e27ad", "url": "https://github.com/geoserver/geoserver/commit/494aa6ab8d92f5d3ccac9199081e17041b3e27ad", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-07T08:02:59Z", "type": "forcePushed"}, {"oid": "76a2c5108e7693cd600dfbb1766859e7557df6b4", "url": "https://github.com/geoserver/geoserver/commit/76a2c5108e7693cd600dfbb1766859e7557df6b4", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-07T08:12:50Z", "type": "forcePushed"}, {"oid": "75a9631eed66034fa57ab3be6a7d22db40869443", "url": "https://github.com/geoserver/geoserver/commit/75a9631eed66034fa57ab3be6a7d22db40869443", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-07T08:33:22Z", "type": "forcePushed"}, {"oid": "2fb0727e2e9728e2057f66990b3ae433ed94ff3a", "url": "https://github.com/geoserver/geoserver/commit/2fb0727e2e9728e2057f66990b3ae433ed94ff3a", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-07T12:01:28Z", "type": "commit"}, {"oid": "2fb0727e2e9728e2057f66990b3ae433ed94ff3a", "url": "https://github.com/geoserver/geoserver/commit/2fb0727e2e9728e2057f66990b3ae433ed94ff3a", "message": "[GEOS-9485] GeoServer system-status {json,xml} endpoints do not return values anymore", "committedDate": "2020-02-07T12:01:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA5NTMyMw==", "url": "https://github.com/geoserver/geoserver/pull/4030#discussion_r377095323", "bodyText": "This was removed in https://github.com/geoserver/geoserver/pull/3590/files#diff-1e72fa7cb4d8fce2c903e9686f4533d6L41\nWhat's going on? :-D", "author": "aaime", "createdAt": "2020-02-10T14:29:18Z", "path": "src/main/src/main/java/org/geoserver/system/status/MetricValue.java", "diffHunk": "@@ -34,6 +34,8 @@\n \n     int priority;\n \n+    ValueHolder holder;", "originalCommit": "2fb0727e2e9728e2057f66990b3ae433ed94ff3a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA4NzU1Mg==", "url": "https://github.com/geoserver/geoserver/pull/4030#discussion_r378087552", "bodyText": "@aaime  the removal of ValueHolder caused metric values to not be included in json and xml output format, so I put them back", "author": "taba90", "createdAt": "2020-02-12T07:57:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA5NTMyMw=="}], "type": "inlineReview"}]}