{"pr_number": 4186, "pr_title": "review build_release script and assembly definitions", "pr_createdAt": "2020-04-13T23:37:56Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4186", "timeline": [{"oid": "a6e1046f44838e84d20d62803164944d76e2b146", "url": "https://github.com/geoserver/geoserver/commit/a6e1046f44838e84d20d62803164944d76e2b146", "message": "release checks\n\n* [x] revise extension content based on RC review\n* [x] break community and communityRelease out into profiles\n\nSigned-off-by: Jody Garnett <jody.garnett@gmail.com>", "committedDate": "2020-04-13T23:06:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4MDU1Mg==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407780552", "bodyText": "You should remove ext-python.xml just above as well (I couldn't comment on the actual line since it wasn't near enough any changes)", "author": "tbarsballe", "createdAt": "2020-04-13T23:39:29Z", "path": "src/community/pom.xml", "diffHunk": "@@ -73,7 +66,6 @@\n           <descriptor>release/ext-jdbcstore.xml</descriptor>", "originalCommit": "a6e1046f44838e84d20d62803164944d76e2b146", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyMTYxMg==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407821612", "bodyText": "Done, moved it down to the appropriate profile.", "author": "jodygarnett", "createdAt": "2020-04-14T02:02:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4MDU1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4MTI4Ng==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407781286", "bodyText": "I don't think this is going to work how you want it to without significant revisions to src/community/release/pom.xml, since it is used for assembly and depends upon everything in communityRelease at the top level", "author": "tbarsballe", "createdAt": "2020-04-13T23:41:34Z", "path": "src/community/pom.xml", "diffHunk": "@@ -321,6 +320,21 @@\n       <modules>\n         <module>script</module>\n       </modules>\n+      <build>\n+       <plugins>\n+         <plugin>\n+          <artifactId>maven-assembly-plugin</artifactId>\n+          <version>3.2.0</version>\n+          <configuration>\n+            <descriptors>\n+              <descriptor>release/ext-groovy.xml</descriptor>\n+              <descriptor>release/ext-javascript.xml</descriptor>\n+              <descriptor>release/ext-python.xml</descriptor>", "originalCommit": "a6e1046f44838e84d20d62803164944d76e2b146", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgxNjM5MA==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407816390", "bodyText": "I saw the profile names used in release/pom.xml and used the same names here.", "author": "jodygarnett", "createdAt": "2020-04-14T01:43:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4MTI4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4Mjg2MQ==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407782861", "bodyText": "This looks to be close to what is neccessary for individual assembly, but does not appear to be the same number of modules that you added release descriptors to in the community pom; spatialite at least appears to be missing (so assembly would fail)", "author": "tbarsballe", "createdAt": "2020-04-13T23:46:16Z", "path": "src/community/release/pom.xml", "diffHunk": "@@ -440,4 +403,74 @@\n    </plugin>\n   </plugins>\n  </build>\n+ \n+ <!-- profiles for individual modules -->\n+ <profiles>\n+   <profile>\n+     <id>rest-ext</id>\n+     <activation>\n+       <property><name>rest-ext</name></property>\n+     </activation>\n+     <dependencies>\n+       <dependency>\n+         <groupId>org.geoserver.community</groupId>\n+         <artifactId>gs-rest-ext</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+     </dependencies>\n+   </profile>\n+   <profile>\n+     <id>script</id>\n+     <activation>\n+       <property><name>script</name></property>\n+     </activation>\n+     <dependencies>\n+       <dependency>\n+         <groupId>org.geoserver.script</groupId>\n+         <artifactId>gs-script-py</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+       <dependency>\n+         <groupId>org.geoserver.script</groupId>\n+         <artifactId>gs-script-js</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+       <dependency>\n+         <groupId>org.geoserver.script</groupId>\n+         <artifactId>gs-script-groovy</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+     </dependencies>\n+   </profile>\n+   <profile>\n+     <id>monitor-hibernate</id>\n+     <dependencies>\n+       <dependency>\n+        <groupId>org.geoserver.community</groupId>\n+        <artifactId>gs-monitor-hibernate</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+     </dependencies>\n+   </profile>\n+   <profile>\n+     <id>geogig</id>\n+     <dependencies>\n+       <dependency>\n+         <groupId>org.geoserver.community</groupId>\n+         <artifactId>gs-geogig</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+    </dependencies>\n+   </profile>\n+   <profile>\n+     <id>rest-upload</id>\n+     <dependencies>\n+       <dependency>\n+         <groupId>org.geoserver.community</groupId>\n+         <artifactId>gs-rest-upload</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+     </dependencies>\n+   </profile>\n+ </profiles>", "originalCommit": "a6e1046f44838e84d20d62803164944d76e2b146", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgxODM4OQ==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407818389", "bodyText": "As you noted the codebase was in consistent previously.\ngs-spatialite was not mentioned anywhere here before, I can add it back as a profile, if only as a starting point for anyone wishing to restore it.", "author": "jodygarnett", "createdAt": "2020-04-14T01:50:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4Mjg2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4Mzc2Mg==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407783762", "bodyText": "As per the commented out lines above, script-js and script-groovy don't work at all, so this doesn't help for building script-py very much.", "author": "tbarsballe", "createdAt": "2020-04-13T23:49:02Z", "path": "src/community/release/pom.xml", "diffHunk": "@@ -440,4 +403,74 @@\n    </plugin>\n   </plugins>\n  </build>\n+ \n+ <!-- profiles for individual modules -->\n+ <profiles>\n+   <profile>\n+     <id>rest-ext</id>\n+     <activation>\n+       <property><name>rest-ext</name></property>\n+     </activation>\n+     <dependencies>\n+       <dependency>\n+         <groupId>org.geoserver.community</groupId>\n+         <artifactId>gs-rest-ext</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+     </dependencies>\n+   </profile>\n+   <profile>\n+     <id>script</id>\n+     <activation>\n+       <property><name>script</name></property>\n+     </activation>\n+     <dependencies>\n+       <dependency>\n+         <groupId>org.geoserver.script</groupId>\n+         <artifactId>gs-script-py</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+       <dependency>\n+         <groupId>org.geoserver.script</groupId>\n+         <artifactId>gs-script-js</artifactId>\n+         <version>${project.version}</version>\n+       </dependency>\n+       <dependency>\n+         <groupId>org.geoserver.script</groupId>\n+         <artifactId>gs-script-groovy</artifactId>\n+         <version>${project.version}</version>", "originalCommit": "a6e1046f44838e84d20d62803164944d76e2b146", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgxNjY5Nw==", "url": "https://github.com/geoserver/geoserver/pull/4186#discussion_r407816697", "bodyText": "No it does not, but it does place them all into the same profile.", "author": "jodygarnett", "createdAt": "2020-04-14T01:44:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4Mzc2Mg=="}], "type": "inlineReview"}, {"oid": "8e11215681e30edf2a668e57f274feefa5846a5e", "url": "https://github.com/geoserver/geoserver/commit/8e11215681e30edf2a668e57f274feefa5846a5e", "message": "remove output directory prefix and include readme.txt\n\nSigned-off-by: Jody Garnett <jody.garnett@gmail.com>", "committedDate": "2020-04-14T00:22:20Z", "type": "commit"}, {"oid": "a7140ec0902ca92fcef102580f86bb5c6347541f", "url": "https://github.com/geoserver/geoserver/commit/a7140ec0902ca92fcef102580f86bb5c6347541f", "message": "Include readme in htmld doc download\n\nSigned-off-by: Jody Garnett <jody.garnett@gmail.com>", "committedDate": "2020-04-14T00:49:30Z", "type": "commit"}, {"oid": "7e2df86c2cec7f5a475d08761632902572de2025", "url": "https://github.com/geoserver/geoserver/commit/7e2df86c2cec7f5a475d08761632902572de2025", "message": "revise based on feedback\n\nSigned-off-by: Jody Garnett <jody.garnett@gmail.com>", "committedDate": "2020-04-14T02:01:26Z", "type": "commit"}]}