{"pr_number": 4444, "pr_title": "[GEOS-9710] WFS-templating module should support env parametrization also for portions of xpath [GEOS-9714] Wfs-templating plugin silently fails if the bacwkard mapping path provided in filter is not valid", "pr_createdAt": "2020-07-31T14:46:51Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4444", "timeline": [{"oid": "d37604ed7506e865ebeff53cd3725daa5d62de68", "url": "https://github.com/geoserver/geoserver/commit/d37604ed7506e865ebeff53cd3725daa5d62de68", "message": "[GEOS-9710] WFS-templating module should support env parametrization also for portions of xpath", "committedDate": "2020-07-31T15:01:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQzMzA2OA==", "url": "https://github.com/geoserver/geoserver/pull/4444#discussion_r464433068", "bodyText": "A class that's both a Function and a PropertyName is, I believe, something we haven't seen before. Seems pretty similar to \"FilterFunction_property\" down in Geotools, which also allows to dynamically reference a property, and which has received special treatment to work with the various visitors correctly.\nNow, this is just an output format, so there is no data access and the many DuplicatingFilterVisitor subclasses being involved into it. If it actually adds something (namespaces for example?) then I would clearly document it as something specific to this module, that should not be used anywhere else, and point people to \"FilterFunction_property\" for general usage. As another option, the existing \"FilterFunction_property\" function could be expanded to support what's missing here.", "author": "aaime", "createdAt": "2020-08-03T14:01:42Z", "path": "src/community/wfs-templating/src/main/java/org/geoserver/wfstemplating/expressions/XpathFunction.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package org.geoserver.wfstemplating.expressions;\n+\n+import static org.geotools.filter.capability.FunctionNameImpl.parameter;\n+\n+import org.geotools.filter.AttributeExpressionImpl;\n+import org.geotools.filter.FunctionExpressionImpl;\n+import org.geotools.filter.capability.FunctionNameImpl;\n+import org.opengis.filter.capability.FunctionName;\n+import org.opengis.filter.expression.ExpressionVisitor;\n+import org.opengis.filter.expression.PropertyName;\n+import org.xml.sax.helpers.NamespaceSupport;\n+\n+public class XpathFunction extends FunctionExpressionImpl implements PropertyName {", "originalCommit": "d37604ed7506e865ebeff53cd3725daa5d62de68", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkxNzcyNQ==", "url": "https://github.com/geoserver/geoserver/pull/4444#discussion_r467917725", "bodyText": "@aaime thanks for your point I've updated the documentation pointing the FilterFunction_property", "author": "taba90", "createdAt": "2020-08-10T13:51:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQzMzA2OA=="}], "type": "inlineReview"}, {"oid": "b986732a51e775a896710f326989056970c7ee1d", "url": "https://github.com/geoserver/geoserver/commit/b986732a51e775a896710f326989056970c7ee1d", "message": "[GEOS-9710] WFS-templating module should support env parametrization also for portions of xpath", "committedDate": "2020-08-07T14:34:48Z", "type": "commit"}, {"oid": "4352db6be2dd1633d91fc5aa93c265e7759d93f4", "url": "https://github.com/geoserver/geoserver/commit/4352db6be2dd1633d91fc5aa93c265e7759d93f4", "message": "added documentation pointing to the property function for general usage", "committedDate": "2020-08-07T14:47:41Z", "type": "forcePushed"}, {"oid": "c7d16020698e827e910f09990797b45934905207", "url": "https://github.com/geoserver/geoserver/commit/c7d16020698e827e910f09990797b45934905207", "message": "added documentation pointing to the property function for general usage", "committedDate": "2020-08-10T14:00:43Z", "type": "commit"}, {"oid": "c7d16020698e827e910f09990797b45934905207", "url": "https://github.com/geoserver/geoserver/commit/c7d16020698e827e910f09990797b45934905207", "message": "added documentation pointing to the property function for general usage", "committedDate": "2020-08-10T14:00:43Z", "type": "forcePushed"}, {"oid": "b8af32b8cbbac2579f688ab0b613efc33456a5ac", "url": "https://github.com/geoserver/geoserver/commit/b8af32b8cbbac2579f688ab0b613efc33456a5ac", "message": "[GEOS-9714] Wfs-templating plugin silently fails if the bacwkard mapping path provided in filter is not valid", "committedDate": "2020-08-11T10:26:57Z", "type": "forcePushed"}, {"oid": "e7cd0cef303d374cb372ceeeafd0395047223c87", "url": "https://github.com/geoserver/geoserver/commit/e7cd0cef303d374cb372ceeeafd0395047223c87", "message": "[GEOS-9714] Wfs-templating plugin silently fails if the bacwkard mapping path provided in filter is not valid", "committedDate": "2020-08-13T13:04:25Z", "type": "commit"}, {"oid": "e7cd0cef303d374cb372ceeeafd0395047223c87", "url": "https://github.com/geoserver/geoserver/commit/e7cd0cef303d374cb372ceeeafd0395047223c87", "message": "[GEOS-9714] Wfs-templating plugin silently fails if the bacwkard mapping path provided in filter is not valid", "committedDate": "2020-08-13T13:04:25Z", "type": "forcePushed"}]}