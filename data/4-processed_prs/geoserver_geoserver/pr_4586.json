{"pr_number": 4586, "pr_title": "[GEOS-9805] Support transforming CAS response custom attributes into roles", "pr_createdAt": "2020-11-26T17:25:50Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4586", "timeline": [{"oid": "b7c6847ce3e1dc57e6f29470db0d67cabea178f4", "url": "https://github.com/geoserver/geoserver/commit/b7c6847ce3e1dc57e6f29470db0d67cabea178f4", "message": "[GEOS-9805] Support transforming CAS response custom attributes into roles", "committedDate": "2020-11-27T10:24:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYwNTQzMA==", "url": "https://github.com/geoserver/geoserver/pull/4586#discussion_r531605430", "bodyText": "Not really and issue, but for completeness I guess that would be good to complete the principal roles list by using the RoleCalculator\nRoleCalculator calc =\n                        new RoleCalculator(getSecurityManager().getActiveRoleService());\n\nIn order to be sure we add all the roles associated to the current user accordingly to the active role service too.", "author": "afabiani", "createdAt": "2020-11-27T13:34:43Z", "path": "src/extension/security/cas/src/main/java/org/geoserver/security/cas/GeoServerCasAuthenticationFilter.java", "diffHunk": "@@ -258,4 +270,63 @@ public void logout(\n             Authentication authentication) {\n         request.setAttribute(GeoServerLogoutFilter.LOGOUT_REDIRECT_ATTR, casLogoutURL);\n     }\n+\n+    @Override\n+    protected Collection<GeoServerRole> getRoles(HttpServletRequest request, String principal)", "originalCommit": "b7c6847ce3e1dc57e6f29470db0d67cabea178f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcxMTE5Mw==", "url": "https://github.com/geoserver/geoserver/pull/4586#discussion_r531711193", "bodyText": "Interesting, I had no idea this class existed. The base class does not do anything with the RoleCalculator, but maybe it should not be done when picking roles from a specific role service or a specific user group service.\nReading from the headers does nothing either, but I see the J2EE auth (another subclass of the pre authenticated filter) using it.... adding it in the \"roles from custom attributes\" path only, don't want to touch the base classes.", "author": "aaime", "createdAt": "2020-11-27T17:33:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYwNTQzMA=="}], "type": "inlineReview"}, {"oid": "e4e35d5f0e56fdc06b3c044bc8518b17baa15cd7", "url": "https://github.com/geoserver/geoserver/commit/e4e35d5f0e56fdc06b3c044bc8518b17baa15cd7", "message": "[GEOS-9805] Support transforming CAS response custom attributes into roles", "committedDate": "2020-11-30T10:33:50Z", "type": "commit"}, {"oid": "9997963851d541befb2b24e96d051ecc2ad929b3", "url": "https://github.com/geoserver/geoserver/commit/9997963851d541befb2b24e96d051ecc2ad929b3", "message": "Following up with review", "committedDate": "2020-11-30T10:33:50Z", "type": "forcePushed"}, {"oid": "c9e85f7c95c31968879b245a685b83f3d53024cc", "url": "https://github.com/geoserver/geoserver/commit/c9e85f7c95c31968879b245a685b83f3d53024cc", "message": "Following up with review", "committedDate": "2020-11-30T11:04:04Z", "type": "forcePushed"}, {"oid": "383722b83d67f7ba2738b23c66484534d5c9258a", "url": "https://github.com/geoserver/geoserver/commit/383722b83d67f7ba2738b23c66484534d5c9258a", "message": "Following up with review", "committedDate": "2020-11-30T11:24:44Z", "type": "commit"}, {"oid": "383722b83d67f7ba2738b23c66484534d5c9258a", "url": "https://github.com/geoserver/geoserver/commit/383722b83d67f7ba2738b23c66484534d5c9258a", "message": "Following up with review", "committedDate": "2020-11-30T11:24:44Z", "type": "forcePushed"}]}