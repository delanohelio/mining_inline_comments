{"pr_number": 4381, "pr_title": "[GEOS-8282] Catalog Mode in Data Security doesn't work for insert and update transactions", "pr_createdAt": "2020-07-03T17:34:38Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4381", "timeline": [{"oid": "da77aa1b98f975318f8a26335cde7df5c965b016", "url": "https://github.com/geoserver/geoserver/commit/da77aa1b98f975318f8a26335cde7df5c965b016", "message": "[GEOS-8282] Catalog Mode in Data Security doesn't work for insert and update transactions", "committedDate": "2020-07-03T17:33:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE4MDk3MQ==", "url": "https://github.com/geoserver/geoserver/pull/4381#discussion_r460180971", "bodyText": "I see it was always hiding.", "author": "nmco", "createdAt": "2020-07-24T17:09:04Z", "path": "src/main/src/main/java/org/geoserver/security/WrapperPolicy.java", "diffHunk": "@@ -33,7 +33,11 @@ public static final WrapperPolicy readOnlyHide(AccessLimits limits) {\n     }\n \n     public static final WrapperPolicy readWrite(AccessLimits limits) {\n-        return new WrapperPolicy(AccessLevel.READ_WRITE, Response.HIDE, limits);\n+        Response respone =\n+                limits == null || limits.getMode() == CatalogMode.HIDE\n+                        ? Response.HIDE\n+                        : Response.CHALLENGE;\n+        return new WrapperPolicy(AccessLevel.READ_WRITE, respone, limits);", "originalCommit": "da77aa1b98f975318f8a26335cde7df5c965b016", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE4MTA2MQ==", "url": "https://github.com/geoserver/geoserver/pull/4381#discussion_r460181061", "bodyText": "Nice.", "author": "nmco", "createdAt": "2020-07-24T17:09:15Z", "path": "src/wfs/src/main/java/org/geoserver/wfs/Transaction.java", "diffHunk": "@@ -298,6 +299,11 @@ protected TransactionResponse execute(TransactionRequest request) throws Excepti\n         } catch (WFSTransactionException e) {\n             LOGGER.log(Level.SEVERE, \"Transaction failed\", e);\n \n+            // don't process security exceptions, we want them to go up and change the way the\n+            // response is presented to the user, e.g., challenge authentication or describe access\n+            // was denied\n+            if (Dispatcher.isSecurityException(e.getCause())) throw e;", "originalCommit": "da77aa1b98f975318f8a26335cde7df5c965b016", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}