{"pr_number": 3311, "pr_title": "Anti Xray: Obfuscate blocks touching lava feature", "pr_createdAt": "2020-05-07T13:19:10Z", "pr_url": "https://github.com/PaperMC/Paper/pull/3311", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ5OTY1Mw==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421499653", "bodyText": "Use default values here and reference the variable as defaults when getting the values.\nEDIT: You apparently can't resolve conversations in reviews, so ignore this :)", "author": "Proximyst", "createdAt": "2020-05-07T13:23:28Z", "path": "Spigot-Server-Patches/0384-Anti-Xray.patch", "diffHunk": "@@ -28,6 +28,7 @@ index 48676152152faf7a7b9524ac37d8b4a8c32c4e2c..ca2ac17747d4f2acf1df056759c5c182\n +    public EngineMode engineMode;", "originalCommit": "2af5c94726db0fb035772cca25c5d3ee1a91e97a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMTM1OA==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421501358", "bodyText": "There is no distinction, it is author preference. Given the rest of antixray config is written this way I see no reason he needs to change it now.", "author": "zachbr", "createdAt": "2020-05-07T13:25:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ5OTY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMjU3Nw==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421502577", "bodyText": "Was under the impression that was the \"standard\" :p", "author": "Proximyst", "createdAt": "2020-05-07T13:27:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ5OTY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwODMzNA==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421508334", "bodyText": "Not sure why this is necessary suddenly. Most other config options also don't do this. Also this can be done in another PR if needed. Edit: didn't reload recent comments.", "author": "stonar96", "createdAt": "2020-05-07T13:35:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ5OTY1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUyOTgyOA==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421529828", "bodyText": "as said its not a standard, either way is fine. I personally do mine with the other pattern as sometimes what default you use in the method code might vary (for migrations).\nAdditionally, the method might be a little more complex and big, so I find it easier to view the defaults in the initializer of the variable.\nbut no reason to update pr over this, both is valid.", "author": "aikar", "createdAt": "2020-05-07T14:04:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ5OTY1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMDMxMg==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421500312", "bodyText": "Is changing default behaviour after so many versions a good idea?", "author": "Proximyst", "createdAt": "2020-05-07T13:24:24Z", "path": "Spigot-Server-Patches/0384-Anti-Xray.patch", "diffHunk": "@@ -38,6 +39,7 @@ index 48676152152faf7a7b9524ac37d8b4a8c32c4e2c..ca2ac17747d4f2acf1df056759c5c182\n +        maxChunkSectionIndex = getInt(\"anti-xray.max-chunk-section-index\", 3);\n +        maxChunkSectionIndex = maxChunkSectionIndex > 15 ? 15 : maxChunkSectionIndex;\n +        updateRadius = getInt(\"anti-xray.update-radius\", 2);\n++        lavaObscures = getBoolean(\"anti-xray.lava-obscures\", true);", "originalCommit": "2af5c94726db0fb035772cca25c5d3ee1a91e97a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMzY0Mg==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421503642", "bodyText": "Aikar on Discord: lava-obscures: true, default on is reasonable here", "author": "stonar96", "createdAt": "2020-05-07T13:29:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMDMxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMzcwMA==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r421503700", "bodyText": "Yes, defaults represent what majority will want. majority will clearly want this.", "author": "aikar", "createdAt": "2020-05-07T13:29:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTUwMDMxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5NzMwNw==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r429897307", "bodyText": "Comparing against stationary lava is not enough. The top-most stationary lava block will reveal 2 top texels (not fill the block fully).\nThere are 2 ores that are visible this way using the default vanilla texture pack: Emerald and Nether Quartz ore. Not to mention custom modpacks that may make other ores visible in this case by drawing ore textures closer to the block edges.\nWhether or not custom legitimate texture packs should be considered is up to debate. But I believe current patch will wrongly hide Emerald/Quartz ore, if so - it's hiding otherwise visible ores.", "author": "VADemon", "createdAt": "2020-05-25T12:00:31Z", "path": "Spigot-Server-Patches/0384-Anti-Xray.patch", "diffHunk": "@@ -208,7 +210,8 @@ index 0000000000000000000000000000000000000000..9c017eb027ce52ea6a2414af2d0190b3\n +\n +            if (blockData != null) {\n +                solidGlobal[i] = blockData.getBlock().isOccluding(blockData, emptyChunk, zeroPos)\n-+                    && blockData.getBlock() != Blocks.SPAWNER && blockData.getBlock() != Blocks.BARRIER && blockData.getBlock() != Blocks.SHULKER_BOX;\n++                    && blockData.getBlock() != Blocks.SPAWNER && blockData.getBlock() != Blocks.BARRIER && blockData.getBlock() != Blocks.SHULKER_BOX || paperWorldConfig.lavaObscures && blockData == Blocks.LAVA.getBlockData();\n++                // Comparing blockData == Blocks.LAVA.getBlockData() instead of blockData.getBlock() == Blocks.LAVA ensures that only \"stationary lava\" is used", "originalCommit": "94a8ee47f18efa81ee78a89bbabbd535f651b6b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5OTUxMA==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r429899510", "bodyText": "The top 2 pixels was brought up on Discord, and ultimately it was disregarded as changing how anti x-ray works at all is not worth it for a not so common issue. You're always able to disable this feature and rather just use moderators.", "author": "Proximyst", "createdAt": "2020-05-25T12:05:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5NzMwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5OTY0Ng==", "url": "https://github.com/PaperMC/Paper/pull/3311#discussion_r429899646", "bodyText": "This is known and has already been discussed. (See #2940.) Won't (and can't) fix. Server owners must decide if they want this feature and also take look at the notes in the commit messages.", "author": "stonar96", "createdAt": "2020-05-25T12:05:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5NzMwNw=="}], "type": "inlineReview"}, {"oid": "9843c4f5c0fbd4f288f1df667bb489f2d3bed212", "url": "https://github.com/PaperMC/Paper/commit/9843c4f5c0fbd4f288f1df667bb489f2d3bed212", "message": "Set lava-obscures to false by default\n\nServer owners should also modify their hidden-blocks list when enabling this\noption, such that it only contains ores with stone texture at the upper edges.", "committedDate": "2020-06-09T01:34:01Z", "type": "forcePushed"}, {"oid": "42f9cbccccf05e270f670857c7e7375f2085f93b", "url": "https://github.com/PaperMC/Paper/commit/42f9cbccccf05e270f670857c7e7375f2085f93b", "message": "Set lava-obscures to false by default\n\nServer owners should also modify their hidden-blocks list when enabling this\noption, such that it only contains ores with stone texture at the upper edges.", "committedDate": "2020-09-29T10:54:22Z", "type": "forcePushed"}, {"oid": "1d66b6264b189a54bd6bbe1828d33a2838641d80", "url": "https://github.com/PaperMC/Paper/commit/1d66b6264b189a54bd6bbe1828d33a2838641d80", "message": "Obfuscate blocks touching lava\n\nResolves #2940.\nObfuscating blocks touching lava can be disabled by setting the new config\noption anti-xray.lava-obscures in the paper world config to false.\nClearing lava with a bucket or replacing it by a transparent block already\ntriggers block updates for nearby blocks.", "committedDate": "2020-10-16T20:08:43Z", "type": "commit"}, {"oid": "722805a40e1f2b742ed3f3bbb813fa678afe0fc9", "url": "https://github.com/PaperMC/Paper/commit/722805a40e1f2b742ed3f3bbb813fa678afe0fc9", "message": "Set lava-obscures to false by default\n\nServer owners should also modify their hidden-blocks list when enabling this\noption, such that it only contains ores with stone texture at the upper edges.", "committedDate": "2020-10-16T20:17:38Z", "type": "commit"}, {"oid": "722805a40e1f2b742ed3f3bbb813fa678afe0fc9", "url": "https://github.com/PaperMC/Paper/commit/722805a40e1f2b742ed3f3bbb813fa678afe0fc9", "message": "Set lava-obscures to false by default\n\nServer owners should also modify their hidden-blocks list when enabling this\noption, such that it only contains ores with stone texture at the upper edges.", "committedDate": "2020-10-16T20:17:38Z", "type": "forcePushed"}]}