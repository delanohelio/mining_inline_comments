{"pr_number": 4230, "pr_title": "Add PlayerShearBlockEvent", "pr_createdAt": "2020-08-27T19:41:45Z", "pr_url": "https://github.com/PaperMC/Paper/pull/4230", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4MTE5Ng==", "url": "https://github.com/PaperMC/Paper/pull/4230#discussion_r479481196", "bodyText": "io.papermc.paper.event.block", "author": "Proximyst", "createdAt": "2020-08-28T18:55:23Z", "path": "Spigot-API-Patches/0222-Add-PlayerShearBlockEvent.patch", "diffHunk": "@@ -0,0 +1,123 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: JRoy <joshroy126@gmail.com>\n+Date: Thu, 27 Aug 2020 12:32:35 -0400\n+Subject: [PATCH] Add PlayerShearBlockEvent\n+\n+\n+diff --git a/src/main/java/com/destroystokyo/paper/event/block/PlayerShearBlockEvent.java b/src/main/java/com/destroystokyo/paper/event/block/PlayerShearBlockEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..3b5dedb1da85a21ebeda5842226307623c9aa249\n+--- /dev/null\n++++ b/src/main/java/com/destroystokyo/paper/event/block/PlayerShearBlockEvent.java\n+@@ -0,0 +1,111 @@\n++package com.destroystokyo.paper.event.block;", "originalCommit": "37143b8a7fa8cad0f7b017a8255e7ac0443ca380", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "15b95425193f605ae0aba7618044803a92197872", "url": "https://github.com/PaperMC/Paper/commit/15b95425193f605ae0aba7618044803a92197872", "message": "Rebuild Patches", "committedDate": "2020-10-12T15:39:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM2OTEwOQ==", "url": "https://github.com/PaperMC/Paper/pull/4230#discussion_r504369109", "bodyText": "Please keep the OBF helper to the first example right above it,\nhttps://github.com/PaperMC/Paper/blob/master/CONTRIBUTING.md#obfuscation-helpers\nThis just creates extra noisy diffs", "author": "electronicboy", "createdAt": "2020-10-14T02:51:33Z", "path": "Spigot-Server-Patches/0592-Add-PlayerShearBlockEvent.patch", "diffHunk": "@@ -0,0 +1,94 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: JRoy <joshroy126@gmail.com>\n+Date: Thu, 27 Aug 2020 15:02:48 -0400\n+Subject: [PATCH] Add PlayerShearBlockEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/BlockBeehive.java b/src/main/java/net/minecraft/server/BlockBeehive.java\n+index 7e2c63e4731ac2d234d5f90eb80d314cdede07ca..b95c602e89aa1dd55b1c76cce26d48943abf4cff 100644\n+--- a/src/main/java/net/minecraft/server/BlockBeehive.java\n++++ b/src/main/java/net/minecraft/server/BlockBeehive.java\n+@@ -1,5 +1,7 @@\n+ package net.minecraft.server;\n+ \n++import io.papermc.paper.event.block.PlayerShearBlockEvent; // Paper - PlayerShearBlockEvent namespace conflicts\n++\n+ import java.util.Iterator;\n+ import java.util.List;\n+ import java.util.Random;\n+@@ -63,7 +65,13 @@ public class BlockBeehive extends BlockTileEntity {\n+     }\n+ \n+     public static void a(World world, BlockPosition blockposition) {\n+-        a(world, blockposition, new ItemStack(Items.HONEYCOMB, 3));", "originalCommit": "15b95425193f605ae0aba7618044803a92197872", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjE2NDY0MQ==", "url": "https://github.com/PaperMC/Paper/pull/4230#discussion_r532164641", "bodyText": "Looking back at this, this was the \"wrong\" change, if you just want an OBFHELPER, it should be added to Block, so that that a method is mapped (ideally in MCUtils for later calls) for anything that wants to call it, as this is not so much an obfhelper here but a behavioral change to the method in the name of an obfhelper, beyond that, looks ok", "author": "electronicboy", "createdAt": "2020-11-29T06:46:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM2OTEwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM2OTU2OA==", "url": "https://github.com/PaperMC/Paper/pull/4230#discussion_r504369568", "bodyText": "This shouldn't be nullable, ex; making blocks which don't drop items, drop items", "author": "electronicboy", "createdAt": "2020-10-14T02:53:36Z", "path": "Spigot-API-Patches/0231-Add-PlayerShearBlockEvent.patch", "diffHunk": "@@ -0,0 +1,123 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: JRoy <joshroy126@gmail.com>\n+Date: Thu, 27 Aug 2020 12:32:35 -0400\n+Subject: [PATCH] Add PlayerShearBlockEvent\n+\n+\n+diff --git a/src/main/java/io/papermc/paper/event/block/PlayerShearBlockEvent.java b/src/main/java/io/papermc/paper/event/block/PlayerShearBlockEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..7d945de6394cf73dc47c715eb865477fde62d1fa\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/block/PlayerShearBlockEvent.java\n+@@ -0,0 +1,111 @@\n++package io.papermc.paper.event.block;\n++\n++import org.bukkit.block.Block;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.Cancellable;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.player.PlayerEvent;\n++import org.bukkit.inventory.EquipmentSlot;\n++import org.bukkit.inventory.ItemStack;\n++import org.jetbrains.annotations.NotNull;\n++import org.jetbrains.annotations.Nullable;\n++\n++import java.util.List;\n++\n++/**\n++ * Called when a player uses sheers on a block.\n++ * <p>\n++ * This event is <b>not</b> called when breaking blocks with shears but instead only when a\n++ * player uses the sheer item on a block to garner drops from said block and/or change its state.\n++ * <p>\n++ * Examples include shearing a pumpkin to turn it into a carved pumpkin or shearing a beehive to get honeycomb.\n++ */\n++public class PlayerShearBlockEvent extends PlayerEvent implements Cancellable {\n++    private static final HandlerList handlers = new HandlerList();\n++    private boolean cancelled = false;\n++    private final Block block;\n++    private final ItemStack item;\n++    private final EquipmentSlot hand;\n++    private final List<ItemStack> drops;\n++\n++    public PlayerShearBlockEvent(@NotNull Player who, @NotNull Block block, @NotNull ItemStack item, @NotNull EquipmentSlot hand, @Nullable List<ItemStack> drops) {\n++        super(who);\n++        this.block = block;\n++        this.item = item;\n++        this.hand = hand;\n++        this.drops = drops;\n++    }\n++\n++    /**\n++     * Gets the block being sheared in this event.\n++     *\n++     * @return The {@link Block} which block is being sheared in this event.\n++     */\n++    @NotNull\n++    public Block getBlock() {\n++        return block;\n++    }\n++\n++    /**\n++     * Gets the item used to shear the block.\n++     *\n++     * @return The {@link ItemStack} of the shears.\n++     */\n++    @NotNull\n++    public ItemStack getItem() {\n++        return item;\n++    }\n++\n++    /**\n++     * Gets the hand used to shear the block.\n++     *\n++     * @return Either {@link EquipmentSlot#HAND} OR {@link EquipmentSlot#OFF_HAND}.\n++     */\n++    @NotNull\n++    public EquipmentSlot getHand() {\n++        return hand;\n++    }\n++\n++    /**\n++     * Gets the resulting drops of this event.\n++     *\n++     * This may return null in the future if Mojang adds a use for shears that do not drop items.\n++     *\n++     * @return A {@link List list} of {@link ItemStack items} that will be dropped as result of this event.\n++     */\n++    @Nullable\n++    public List<ItemStack> getDrops() {\n++        return drops;", "originalCommit": "15b95425193f605ae0aba7618044803a92197872", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM4NDM4OQ==", "url": "https://github.com/PaperMC/Paper/pull/4230#discussion_r504384389", "bodyText": "No idea why I made this nullable as it's never null 0_o", "author": "JRoy", "createdAt": "2020-10-14T03:49:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM2OTU2OA=="}], "type": "inlineReview"}, {"oid": "bc9af6a4b96243fad2e5d284bb3c723a0c25fd94", "url": "https://github.com/PaperMC/Paper/commit/bc9af6a4b96243fad2e5d284bb3c723a0c25fd94", "message": "Review Changes", "committedDate": "2020-10-14T03:56:10Z", "type": "forcePushed"}, {"oid": "d640004d81bbf02eabb06306bb5a0cd5edc670f9", "url": "https://github.com/PaperMC/Paper/commit/d640004d81bbf02eabb06306bb5a0cd5edc670f9", "message": "Add PlayerShearBlockEvent", "committedDate": "2020-12-02T22:57:23Z", "type": "forcePushed"}, {"oid": "b0bfe130d6558dfc27d5f337e8f931be37e3035b", "url": "https://github.com/PaperMC/Paper/commit/b0bfe130d6558dfc27d5f337e8f931be37e3035b", "message": "Add PlayerShearBlockEvent", "committedDate": "2020-12-02T23:00:39Z", "type": "commit"}, {"oid": "b0bfe130d6558dfc27d5f337e8f931be37e3035b", "url": "https://github.com/PaperMC/Paper/commit/b0bfe130d6558dfc27d5f337e8f931be37e3035b", "message": "Add PlayerShearBlockEvent", "committedDate": "2020-12-02T23:00:39Z", "type": "forcePushed"}]}