{"pr_number": 3946, "pr_title": "Add getDestroySpeed to Block API", "pr_createdAt": "2020-07-19T00:32:03Z", "pr_url": "https://github.com/PaperMC/Paper/pull/3946", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0MjU4NQ==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r456842585", "bodyText": "what the hell is this naming convention", "author": "Proximyst", "createdAt": "2020-07-19T00:36:44Z", "path": "Spigot-Server-Patches/0546-Add-Destroy-Speed-API.patch", "diffHunk": "@@ -0,0 +1,51 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Ineusia <ineusia@yahoo.com>\n+Date: Sat, 18 Jul 2020 18:49:56 -0500\n+Subject: [PATCH] Add Destroy Speed API\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+index 9b0e868f006a34b47ef9a48c7ea844be8122c291..f3443d2d07cd03412d28460ca8607b465c2cc3d9 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n++++ b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+@@ -5,24 +5,8 @@ import java.util.Collection;\n+ import java.util.Collections;\n+ import java.util.List;\n+ import java.util.stream.Collectors;\n+-import net.minecraft.server.AxisAlignedBB;\n+-import net.minecraft.server.BiomeBase;\n+-import net.minecraft.server.BlockPosition;\n+-import net.minecraft.server.BlockRedstoneWire;\n+-import net.minecraft.server.BlockTileEntity;\n+-import net.minecraft.server.Blocks;\n+-import net.minecraft.server.EnumDirection;\n+-import net.minecraft.server.EnumSkyBlock;\n+-import net.minecraft.server.GeneratorAccess;\n+-import net.minecraft.server.IBlockData;\n+-import net.minecraft.server.IRegistry;\n+-import net.minecraft.server.MinecraftKey;\n+-import net.minecraft.server.MovingObjectPosition;\n+-import net.minecraft.server.RayTrace;\n+-import net.minecraft.server.TileEntity;\n+-import net.minecraft.server.Vec3D;\n+-import net.minecraft.server.VoxelShape;\n+-import net.minecraft.server.WorldServer;\n++\n++import net.minecraft.server.*;\n+ import org.apache.commons.lang.Validate;\n+ import org.bukkit.Chunk;\n+ import org.bukkit.FluidCollisionMode;\n+@@ -732,5 +716,13 @@ public class CraftBlock implements Block {\n+     public com.destroystokyo.paper.block.BlockSoundGroup getSoundGroup() {\n+         return new com.destroystokyo.paper.block.CraftBlockSoundGroup(getNMSBlock().getBlockData().getStepSound());\n+     }\n++\n++    @Override\n++    public float getDestroySpeed(ItemStack itemStack) {\n++        net.minecraft.server.ItemStack NMSItemStack = CraftItemStack.asNMSCopy(itemStack);", "originalCommit": "b45e88c4710054824448d57dc2ef2a63bc7051a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0NjE5NQ==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r456846195", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +import net.minecraft.server.Item;", "author": "JRoy", "createdAt": "2020-07-19T01:32:33Z", "path": "Spigot-Server-Patches/0546-Add-Destroy-Speed-API.patch", "diffHunk": "@@ -0,0 +1,40 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Ineusia <ineusia@yahoo.com>\n+Date: Sat, 18 Jul 2020 18:49:56 -0500\n+Subject: [PATCH] Add Destroy Speed API\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+index 9b0e868f006a34b47ef9a48c7ea844be8122c291..dc5a253cd03ccdddedba8cd48005bb62568aa4ca 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n++++ b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+@@ -5,6 +5,7 @@ import java.util.Collection;\n+ import java.util.Collections;\n+ import java.util.List;\n+ import java.util.stream.Collectors;\n++\n+ import net.minecraft.server.AxisAlignedBB;\n+ import net.minecraft.server.BiomeBase;\n+ import net.minecraft.server.BlockPosition;\n+@@ -16,6 +17,7 @@ import net.minecraft.server.EnumSkyBlock;\n+ import net.minecraft.server.GeneratorAccess;\n+ import net.minecraft.server.IBlockData;\n+ import net.minecraft.server.IRegistry;\n++import net.minecraft.server.Item;", "originalCommit": "e085bb3c9f3cb84cee027ba1c3098eb6ffb9465e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU2MTI3MA==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r458561270", "bodyText": "doesnt look like this belongs here, as dont even see it used.", "author": "aikar", "createdAt": "2020-07-22T06:23:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0NjE5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU2NTE5Nw==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r458565197", "bodyText": "leftover from putting JRoy's suggestion into the patch properly, evidently im very bad at watching imports", "author": "Ineusia", "createdAt": "2020-07-22T06:33:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0NjE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0NjI2MQ==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r456846261", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +        Item item = nmsItemStack.getItem();\n          \n          \n            \n            +\n          \n          \n            \n            +        return item.getDestroySpeed(nmsItemStack, this.getNMSBlock().getBlockData());\n          \n          \n            \n            +        return nmsItemStack.getItem().getDestroySpeed(nmsItemStack, this.getNMSBlock().getBlockData());", "author": "JRoy", "createdAt": "2020-07-19T01:33:33Z", "path": "Spigot-Server-Patches/0546-Add-Destroy-Speed-API.patch", "diffHunk": "@@ -0,0 +1,40 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Ineusia <ineusia@yahoo.com>\n+Date: Sat, 18 Jul 2020 18:49:56 -0500\n+Subject: [PATCH] Add Destroy Speed API\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+index 9b0e868f006a34b47ef9a48c7ea844be8122c291..dc5a253cd03ccdddedba8cd48005bb62568aa4ca 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n++++ b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+@@ -5,6 +5,7 @@ import java.util.Collection;\n+ import java.util.Collections;\n+ import java.util.List;\n+ import java.util.stream.Collectors;\n++\n+ import net.minecraft.server.AxisAlignedBB;\n+ import net.minecraft.server.BiomeBase;\n+ import net.minecraft.server.BlockPosition;\n+@@ -16,6 +17,7 @@ import net.minecraft.server.EnumSkyBlock;\n+ import net.minecraft.server.GeneratorAccess;\n+ import net.minecraft.server.IBlockData;\n+ import net.minecraft.server.IRegistry;\n++import net.minecraft.server.Item;\n+ import net.minecraft.server.MinecraftKey;\n+ import net.minecraft.server.MovingObjectPosition;\n+ import net.minecraft.server.RayTrace;\n+@@ -732,5 +734,13 @@ public class CraftBlock implements Block {\n+     public com.destroystokyo.paper.block.BlockSoundGroup getSoundGroup() {\n+         return new com.destroystokyo.paper.block.CraftBlockSoundGroup(getNMSBlock().getBlockData().getStepSound());\n+     }\n++\n++    @Override\n++    public float getDestroySpeed(ItemStack itemStack) {\n++        net.minecraft.server.ItemStack nmsItemStack = CraftItemStack.asNMSCopy(itemStack);\n++        Item item = nmsItemStack.getItem();\n++\n++        return item.getDestroySpeed(nmsItemStack, this.getNMSBlock().getBlockData());", "originalCommit": "e085bb3c9f3cb84cee027ba1c3098eb6ffb9465e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODc5NjM4OA==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r458796388", "bodyText": "Remove whitespace", "author": "JRoy", "createdAt": "2020-07-22T13:36:04Z", "path": "Spigot-Server-Patches/0546-Add-Destroy-Speed-API.patch", "diffHunk": "@@ -0,0 +1,30 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Ineusia <ineusia@yahoo.com>\n+Date: Sat, 18 Jul 2020 18:49:56 -0500\n+Subject: [PATCH] Add Destroy Speed API\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+index 9b0e868f006a34b47ef9a48c7ea844be8122c291..f7c91b7cbe77bff00dc9c34501384739bb58b6b0 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n++++ b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+@@ -5,6 +5,7 @@ import java.util.Collection;\n+ import java.util.Collections;\n+ import java.util.List;\n+ import java.util.stream.Collectors;\n++", "originalCommit": "6c881b48b3bee5c72505cf30cbe1b3a9768183cf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODgwMg==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r515668802", "bodyText": "does this need to be a copy here? wouldn't a normal getHandle call work?", "author": "MiniDigger", "createdAt": "2020-11-01T20:35:34Z", "path": "Spigot-Server-Patches/0594-Add-Destroy-Speed-API.patch", "diffHunk": "@@ -0,0 +1,22 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Ineusia <ineusia@yahoo.com>\n+Date: Mon, 26 Oct 2020 11:48:06 -0500\n+Subject: [PATCH] Add Destroy Speed API\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+index 3baf7b75c65c9beba40945ba904315251b5b7a64..514fad341b5a67cd2d401c91041f567c21280d44 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n++++ b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java\n+@@ -757,5 +757,11 @@ public class CraftBlock implements Block {\n+     public String getTranslationKey() {\n+         return org.bukkit.Bukkit.getUnsafe().getTranslationKey(this);\n+     }\n++    \n++    @Override\n++    public float getDestroySpeed(ItemStack itemStack) {\n++        net.minecraft.server.ItemStack nmsItemStack = CraftItemStack.asNMSCopy(itemStack);", "originalCommit": "655ce0b23e049e35266729d2682217c3a52c15a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2OTE2OQ==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r515669169", "bodyText": "getDestroySpeed(new ItemStack(Material.STONE)) - woops we can't cast to CraftItemStack for its #getHandle anymore!", "author": "Proximyst", "createdAt": "2020-11-01T20:39:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODgwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk3MDEyMw==", "url": "https://github.com/PaperMC/Paper/pull/3946#discussion_r526970123", "bodyText": "can we check if its craft first and avoid clone if it is? while im sure its not hot, not a super fan of unnecessary cloning", "author": "aikar", "createdAt": "2020-11-19T15:20:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2ODgwMg=="}], "type": "inlineReview"}, {"oid": "e484c0c0d9e4df4c9fe90e77129d25c4550abda8", "url": "https://github.com/PaperMC/Paper/commit/e484c0c0d9e4df4c9fe90e77129d25c4550abda8", "message": "Add getDestroySpeed to Block API\n\nCo-authored-by: MiniDigger <admin@minidigger.me>", "committedDate": "2020-11-28T22:51:38Z", "type": "commit"}]}