{"pr_number": 4914, "pr_title": "Adjust bStats data sending delay", "pr_createdAt": "2020-12-19T13:58:41Z", "pr_url": "https://github.com/PaperMC/Paper/pull/4914", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMxNTkzNg==", "url": "https://github.com/PaperMC/Paper/pull/4914#discussion_r546315936", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +        // WARNING: You must not modify and part of this Metrics class, including the submit delay or frequency!\n          \n          \n            \n            +        // WARNING: You must not modify any part of this Metrics class, including the submit delay or frequency!", "author": "kashike", "createdAt": "2020-12-20T03:39:01Z", "path": "Spigot-Server-Patches/0005-Paper-Metrics.patch", "diffHunk": "@@ -107,16 +113,16 @@ index 0000000000000000000000000000000000000000..e4923ca371012188793b284cb0ed4280\n +     * Starts the Scheduler which submits our data every 30 minutes.\n +     */\n +    private void startSubmitting() {\n-+        final Timer timer = new Timer(true);\n-+        timer.scheduleAtFixedRate(new TimerTask() {\n-+            @Override\n-+            public void run() {\n-+                submitData();\n-+            }\n-+        }, 1000 * 60 * 5, 1000 * 60 * 30);\n-+        // Submit the data every 30 minutes, first time after 5 minutes to give other plugins enough time to start\n-+        // WARNING: Changing the frequency has no effect but your plugin WILL be blocked/deleted!\n-+        // WARNING: Just don't do it!\n++        final Runnable submitTask = this::submitData;\n++\n++        // Many servers tend to restart at a fixed time at xx:00 which causes an uneven distribution of requests on the\n++        // bStats backend. To circumvent this problem, we introduce some randomness into the initial and second delay.\n++        // WARNING: You must not modify and part of this Metrics class, including the submit delay or frequency!", "originalCommit": "0a64b744fb4c079ad6f7a911cd9ab6630424fbeb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM5MjA4Mg==", "url": "https://github.com/PaperMC/Paper/pull/4914#discussion_r546392082", "bodyText": "Fixed", "author": "Bastian", "createdAt": "2020-12-20T15:33:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMxNTkzNg=="}], "type": "inlineReview"}, {"oid": "bae0d8c3b22b75f15e60044dccb8a2ef865eefe5", "url": "https://github.com/PaperMC/Paper/commit/bae0d8c3b22b75f15e60044dccb8a2ef865eefe5", "message": "Adjust bStats data sending delay\n\nMany servers tend to restart at a fixed time at xx:00 which causes an\nuneven distribution of requests on the bStats backend. To circumvent\nthis problem, this commit introduces some randomness to the initial\nand second delay.", "committedDate": "2020-12-20T15:32:03Z", "type": "commit"}, {"oid": "bae0d8c3b22b75f15e60044dccb8a2ef865eefe5", "url": "https://github.com/PaperMC/Paper/commit/bae0d8c3b22b75f15e60044dccb8a2ef865eefe5", "message": "Adjust bStats data sending delay\n\nMany servers tend to restart at a fixed time at xx:00 which causes an\nuneven distribution of requests on the bStats backend. To circumvent\nthis problem, this commit introduces some randomness to the initial\nand second delay.", "committedDate": "2020-12-20T15:32:03Z", "type": "forcePushed"}]}