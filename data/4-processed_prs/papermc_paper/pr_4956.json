{"pr_number": 4956, "pr_title": "Add sendOpLevel API", "pr_createdAt": "2020-12-29T14:05:32Z", "pr_url": "https://github.com/PaperMC/Paper/pull/4956", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgxMzQ4OA==", "url": "https://github.com/PaperMC/Paper/pull/4956#discussion_r550813488", "bodyText": "PlayerList#a(EntityPlayer entityplayer, int i)\nWe'd likely be better off exposing that vs hard coding the packet out of bounds, otherwise the value may change etc and we wouldn't know, much easier to just expose existing logic, imho; Would just need a means to disable the perm recalc checks", "author": "electronicboy", "createdAt": "2021-01-01T22:19:25Z", "path": "Spigot-Server-Patches/0625-Add-sendOpLevel-API.patch", "diffHunk": "@@ -0,0 +1,27 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: Mariell Hoversholm <proximyst@proximyst.com>\n+Date: Tue, 29 Dec 2020 15:03:03 +0100\n+Subject: [PATCH] Add sendOpLevel API\n+\n+\n+diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java\n+index 58caa3240b90cdc661e1e32e3f5c312ed62c3c21..8362448aad77dff572f8e6fb30db1cb3ce953936 100644\n+--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java\n++++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java\n+@@ -2100,6 +2100,16 @@ public class CraftPlayer extends CraftHumanEntity implements Player {\n+             ? (org.bukkit.entity.Firework) entity.getBukkitEntity()\n+             : null;\n+     }\n++\n++    // This sends a packet with a status described here: https://wiki.vg/Entity_statuses#Player\n++    private static final byte ENTITY_STATUS_PACKET_OPERATOR_LEVEL = 24;\n++    @Override\n++    public void sendOpLevel(byte level) {\n++        Preconditions.checkArgument(level >= 0 && level <= 4, \"Level must be within [0, 4]\");\n++\n++        net.minecraft.server.Packet<?> packet = new net.minecraft.server.PacketPlayOutEntityStatus(this.getHandle(), (byte) (ENTITY_STATUS_PACKET_OPERATOR_LEVEL + level));", "originalCommit": "a43779ad69f395ad80e1e1fe2e641338d91f3751", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c4b53050a10995253ffa37f44f69e4ea947a5d06", "url": "https://github.com/PaperMC/Paper/commit/c4b53050a10995253ffa37f44f69e4ea947a5d06", "message": "Add sendOpLevel API", "committedDate": "2021-01-02T14:43:20Z", "type": "forcePushed"}, {"oid": "402283f365a2d5dd859a8b453e208a6b0b2ec12a", "url": "https://github.com/PaperMC/Paper/commit/402283f365a2d5dd859a8b453e208a6b0b2ec12a", "message": "Add sendOpLevel API", "committedDate": "2021-01-16T17:05:35Z", "type": "commit"}, {"oid": "402283f365a2d5dd859a8b453e208a6b0b2ec12a", "url": "https://github.com/PaperMC/Paper/commit/402283f365a2d5dd859a8b453e208a6b0b2ec12a", "message": "Add sendOpLevel API", "committedDate": "2021-01-16T17:05:35Z", "type": "forcePushed"}]}