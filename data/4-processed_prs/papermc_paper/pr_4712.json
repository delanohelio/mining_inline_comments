{"pr_number": 4712, "pr_title": "PlayerChunkLoadEvent / PlayerChunkUnloadEvent", "pr_createdAt": "2020-10-31T22:19:51Z", "pr_url": "https://github.com/PaperMC/Paper/pull/4712", "timeline": [{"oid": "ae1ab8834472c31327b8bc228f3ae01bb911e938", "url": "https://github.com/PaperMC/Paper/commit/ae1ab8834472c31327b8bc228f3ae01bb911e938", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-10-31T22:30:32Z", "type": "forcePushed"}, {"oid": "a6ccaed1916b01e0ab0d2f469e805b1f5cef6310", "url": "https://github.com/PaperMC/Paper/commit/a6ccaed1916b01e0ab0d2f469e805b1f5cef6310", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-10-31T23:38:16Z", "type": "forcePushed"}, {"oid": "a036bbbd9e46637c538e04ff954fd575d651face", "url": "https://github.com/PaperMC/Paper/commit/a036bbbd9e46637c538e04ff954fd575d651face", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-10-31T23:42:53Z", "type": "forcePushed"}, {"oid": "2bbf5d650ac16995d3541bda442ae2e681acff20", "url": "https://github.com/PaperMC/Paper/commit/2bbf5d650ac16995d3541bda442ae2e681acff20", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-10-31T23:52:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYwNjY3Ng==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515606676", "bodyText": "could prolly replace this and the event factor change with\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +            PlayerEntityReceiveEvent playerEntityReceiveEvent = CraftEventFactory.callPlayerEntityReceiveEvent(this.tracker, entityplayer);\n          \n          \n            \n            +            if (!playerEntityReceiveEvent.isCancelled()) {\n          \n          \n            \n            +            if (!new PlayerChunkReceiveEvent(this.tracker, entityplayer.getBukkitEntity()).callEvent()) {", "author": "MiniDigger", "createdAt": "2020-11-01T10:56:02Z", "path": "Spigot-Server-Patches/0596-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,69 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:11:41 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/EntityTrackerEntry.java b/src/main/java/net/minecraft/server/EntityTrackerEntry.java\n+index 4efc40c01ec12b80bd7cf9d35cf0ea0df973baf7..0a6c42688b979bf7abce7744e70f502a8b41360b 100644\n+--- a/src/main/java/net/minecraft/server/EntityTrackerEntry.java\n++++ b/src/main/java/net/minecraft/server/EntityTrackerEntry.java\n+@@ -17,6 +17,10 @@ import org.bukkit.entity.Player;\n+ import org.bukkit.event.player.PlayerVelocityEvent;\n+ // CraftBukkit end\n+ \n++// Paper  start\n++import org.bukkit.craftbukkit.event.CraftEventFactory;\n++import org.bukkit.event.packet.PlayerEntityReceiveEvent;\n++// Paper  end\n+ public class EntityTrackerEntry {\n+ \n+     private static final Logger LOGGER = LogManager.getLogger();\n+@@ -282,7 +286,16 @@ public class EntityTrackerEntry {\n+         Packet<?> packet = this.tracker.P();\n+ \n+         this.headYaw = MathHelper.d(this.tracker.getHeadRotation() * 256.0F / 360.0F);\n+-        consumer.accept(packet);\n++        // Paper start\n++        if(PlayerEntityReceiveEvent.getHandlerList().getRegisteredListeners().length > 0){\n++            PlayerEntityReceiveEvent playerEntityReceiveEvent = CraftEventFactory.callPlayerEntityReceiveEvent(this.tracker, entityplayer);\n++            if (!playerEntityReceiveEvent.isCancelled()) {", "originalCommit": "2bbf5d650ac16995d3541bda442ae2e681acff20", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNzU5Mg==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515617592", "bodyText": "added", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:43:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYwNjY3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYwNjc1MQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515606751", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +            CraftEventFactory.callPlayerChunkReceiveEvent(chunk, entityplayer);\n          \n          \n            \n            +            new PlayerChunkReceiveEvent(chunk.bukkitChunk, entityplayer.getBukkitEntity()).callEvent()", "author": "MiniDigger", "createdAt": "2020-11-01T10:57:12Z", "path": "Spigot-Server-Patches/0595-added-PlayerChunkReceiveEvent-logic.patch", "diffHunk": "@@ -0,0 +1,72 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:25:16 +0200\n+Subject: [PATCH] added PlayerChunkReceiveEvent logic\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/PlayerChunkMap.java b/src/main/java/net/minecraft/server/PlayerChunkMap.java\n+index 6c399bcea03e839bf2f21e92b5d76d46b7088667..ae4da2a064f11a1c9cf02c1225f058b3285f10f6 100644\n+--- a/src/main/java/net/minecraft/server/PlayerChunkMap.java\n++++ b/src/main/java/net/minecraft/server/PlayerChunkMap.java\n+@@ -52,7 +52,9 @@ import it.unimi.dsi.fastutil.objects.ObjectRBTreeSet; // Paper\n+ import org.apache.commons.lang3.mutable.MutableBoolean;\n+ import org.apache.logging.log4j.LogManager;\n+ import org.apache.logging.log4j.Logger;\n++import org.bukkit.craftbukkit.event.CraftEventFactory; // Paper\n+ import org.bukkit.entity.Player; // CraftBukkit\n++import org.bukkit.event.packet.PlayerChunkReceiveEvent; // Paper\n+ import org.spigotmc.AsyncCatcher;\n+ \n+ public class PlayerChunkMap extends IChunkLoader implements PlayerChunk.d {\n+@@ -2278,7 +2280,11 @@ Sections go from 0..16. Now whenever a section is not empty, it can potentially\n+                 entityplayer.playerConnection.sendPacket(new PacketPlayOutMount(entity1));\n+             }\n+         }\n+-\n++        // Paper start\n++        if(PlayerChunkReceiveEvent.getHandlerList().getRegisteredListeners().length > 0){\n++            CraftEventFactory.callPlayerChunkReceiveEvent(chunk, entityplayer);", "originalCommit": "2bbf5d650ac16995d3541bda442ae2e681acff20", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNzYwOA==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515617608", "bodyText": "added", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:43:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYwNjc1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYwNjgxNw==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515606817", "bodyText": "obfhelper for b maybe?", "author": "MiniDigger", "createdAt": "2020-11-01T10:57:44Z", "path": "Spigot-Server-Patches/0597-add-ability-to-register-attribute-to-entites.patch", "diffHunk": "@@ -0,0 +1,58 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Sat, 24 Oct 2020 16:37:44 +0200\n+Subject: [PATCH] add ability to register attribute to entites\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/AttributeMapBase.java b/src/main/java/net/minecraft/server/AttributeMapBase.java\n+index c57e23e16b79017fe6dc084d634226cfdac772b5..83106091f1f7f38f241ae916544a0acf91f99798 100644\n+--- a/src/main/java/net/minecraft/server/AttributeMapBase.java\n++++ b/src/main/java/net/minecraft/server/AttributeMapBase.java\n+@@ -130,4 +130,10 @@ public class AttributeMapBase {\n+         }\n+ \n+     }\n++    // Paper - start\n++    public void registerAttribute(AttributeBase attributeBase){\n++        net.minecraft.server.AttributeModifiable attributeModifiable = new net.minecraft.server.AttributeModifiable(attributeBase, net.minecraft.server.AttributeModifiable::getAttribute);\n++        b.put(attributeBase, attributeModifiable);", "originalCommit": "2bbf5d650ac16995d3541bda442ae2e681acff20", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "url": "https://github.com/PaperMC/Paper/commit/df4fb194afe6d4b3f384009e056ccd43d3d33db4", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-11-01T12:08:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTIxOQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515615219", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +package org.bukkit.event.packet;\n          \n          \n            \n            +package io.papermc.paper.event.packet;", "author": "Proximyst", "createdAt": "2020-11-01T12:21:01Z", "path": "Spigot-API-Patches/0231-added-PlayerChunkReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,54 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] added PlayerChunkReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..e23bb5de0cd72a8181f7c92a029b7715732a6aa9\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java\n+@@ -0,0 +1,42 @@\n++package org.bukkit.event.packet;", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTI0OQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515615249", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            +package org.bukkit.event.packet;\n          \n          \n            \n            +package io.papermc.paper.event.packet;", "author": "Proximyst", "createdAt": "2020-11-01T12:21:16Z", "path": "Spigot-API-Patches/0232-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,88 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:06:57 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d4709278b139d3b3d84820828d7068de0e78574c\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+@@ -0,0 +1,76 @@\n++package org.bukkit.event.packet;", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTM0Mw==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515615343", "bodyText": "Unused", "author": "Proximyst", "createdAt": "2020-11-01T12:22:09Z", "path": "Spigot-Server-Patches/0596-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,38 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:11:41 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/EntityTrackerEntry.java b/src/main/java/net/minecraft/server/EntityTrackerEntry.java\n+index 4efc40c01ec12b80bd7cf9d35cf0ea0df973baf7..23a13e33fab70a119456954fb490136e8ad9e4b4 100644\n+--- a/src/main/java/net/minecraft/server/EntityTrackerEntry.java\n++++ b/src/main/java/net/minecraft/server/EntityTrackerEntry.java\n+@@ -17,6 +17,10 @@ import org.bukkit.entity.Player;\n+ import org.bukkit.event.player.PlayerVelocityEvent;\n+ // CraftBukkit end\n+ \n++// Paper  start\n++import org.bukkit.craftbukkit.event.CraftEventFactory;", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjE2Ng==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515616166", "bodyText": "rm ws", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:29:36Z", "path": "Spigot-API-Patches/0231-added-PlayerChunkReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,54 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] added PlayerChunkReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..e23bb5de0cd72a8181f7c92a029b7715732a6aa9\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java\n+@@ -0,0 +1,42 @@\n++package org.bukkit.event.packet;\n++", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjQ4MA==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515616480", "bodyText": "Don't remove whitespace where it falls in line with formatting of literally every other Java file in this project.", "author": "Proximyst", "createdAt": "2020-11-01T12:32:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjE2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjE5NQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515616195", "bodyText": "rm ws", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:29:47Z", "path": "Spigot-API-Patches/0231-added-PlayerChunkReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,54 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] added PlayerChunkReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..e23bb5de0cd72a8181f7c92a029b7715732a6aa9\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerChunkReceiveEvent.java\n+@@ -0,0 +1,42 @@\n++package org.bukkit.event.packet;\n++\n++import org.bukkit.Chunk;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.world.ChunkEvent;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called before a {@link org.bukkit.entity.Player} receives a {@link org.bukkit.Chunk}\n++ * used for e.g. Spawning a fake entity when the player receives a chunk\n++ *\n++ * Should only be used for packet/clientside related stuff.\n++ * Not intended for modifying server side.\n++ */\n++public class PlayerChunkReceiveEvent extends ChunkEvent {\n++\n++    private static final HandlerList handlers = new HandlerList();\n++", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjIxMQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515616211", "bodyText": "rm ws", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:29:58Z", "path": "Spigot-API-Patches/0232-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,88 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:06:57 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d4709278b139d3b3d84820828d7068de0e78574c\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+@@ -0,0 +1,76 @@\n++package org.bukkit.event.packet;\n++", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjI4Mw==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515616283", "bodyText": "rm ws", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:30:30Z", "path": "Spigot-API-Patches/0232-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,88 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:06:57 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d4709278b139d3b3d84820828d7068de0e78574c\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+@@ -0,0 +1,76 @@\n++package org.bukkit.event.packet;\n++\n++import org.bukkit.entity.Entity;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.Cancellable;\n++import org.bukkit.event.Event;\n++import org.bukkit.event.HandlerList;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called before a {@link Player} receives a {@link Entity}.\n++ *\n++ * E.g. can be used for the following:\n++ *\n++ * <ul>\n++ *     <li>Hiding all kind of entities by calling {@link Cancellable#setCancelled(boolean)} with value true</li>\n++ *     <li>Disguising entities as others e.g. player npc.\n++ *         Cancel the event and replace it with a playerpacket with the same entity id.\n++ *     </li>\n++ * </ul>\n++ */\n++public class PlayerEntityReceiveEvent extends Event implements Cancellable {\n++\n++    private static final HandlerList handlers = new HandlerList();\n++\n++    private final Player player;\n++\n++    private final Entity entity;\n++\n++    private boolean cancelled;\n++\n++", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNjMwNw==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515616307", "bodyText": "rm ws?", "author": "yannicklamprecht", "createdAt": "2020-11-01T12:30:46Z", "path": "Spigot-API-Patches/0232-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,88 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:06:57 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d4709278b139d3b3d84820828d7068de0e78574c\n+--- /dev/null\n++++ b/src/main/java/org/bukkit/event/packet/PlayerEntityReceiveEvent.java\n+@@ -0,0 +1,76 @@\n++package org.bukkit.event.packet;\n++\n++import org.bukkit.entity.Entity;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.Cancellable;\n++import org.bukkit.event.Event;\n++import org.bukkit.event.HandlerList;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called before a {@link Player} receives a {@link Entity}.\n++ *\n++ * E.g. can be used for the following:\n++ *\n++ * <ul>\n++ *     <li>Hiding all kind of entities by calling {@link Cancellable#setCancelled(boolean)} with value true</li>\n++ *     <li>Disguising entities as others e.g. player npc.\n++ *         Cancel the event and replace it with a playerpacket with the same entity id.\n++ *     </li>\n++ * </ul>\n++ */\n++public class PlayerEntityReceiveEvent extends Event implements Cancellable {\n++\n++    private static final HandlerList handlers = new HandlerList();\n++\n++    private final Player player;\n++", "originalCommit": "df4fb194afe6d4b3f384009e056ccd43d3d33db4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fda829973bb026e570b16b27c9fe5a8aefca4c63", "url": "https://github.com/PaperMC/Paper/commit/fda829973bb026e570b16b27c9fe5a8aefca4c63", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-11-01T12:42:32Z", "type": "forcePushed"}, {"oid": "f0a1199a55919984b33e5b7b07fac83446224130", "url": "https://github.com/PaperMC/Paper/commit/f0a1199a55919984b33e5b7b07fac83446224130", "message": "added PlayerChunkReceiveEvent\n\nadded PlayerEntityReceiveEvent\n\nadded ability to register attribute to entities", "committedDate": "2020-11-01T12:59:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MTc3NA==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515641774", "bodyText": "extends PlayerEvent", "author": "aikar", "createdAt": "2020-11-01T16:24:16Z", "path": "Spigot-API-Patches/0232-added-PlayerEntityReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,84 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 12 Oct 2020 23:06:57 +0200\n+Subject: [PATCH] added PlayerEntityReceiveEvent\n+\n+\n+diff --git a/src/main/java/io/papermc/paper/event/packet/PlayerEntityReceiveEvent.java b/src/main/java/io/papermc/paper/event/packet/PlayerEntityReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..9618b032031920c722b36f59bfbc3d6042d920fb\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/packet/PlayerEntityReceiveEvent.java\n+@@ -0,0 +1,72 @@\n++package io.papermc.paper.event.packet;\n++\n++import org.bukkit.entity.Entity;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.Cancellable;\n++import org.bukkit.event.Event;\n++import org.bukkit.event.HandlerList;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called before a {@link Player} receives a {@link Entity}.\n++ *\n++ * E.g. can be used for the following:\n++ *\n++ * <ul>\n++ *     <li>Hiding all kind of entities by calling {@link Cancellable#setCancelled(boolean)} with value true</li>\n++ *     <li>Disguising entities as others e.g. player npc.\n++ *         Cancel the event and replace it with a playerpacket with the same entity id.\n++ *     </li>\n++ * </ul>\n++ */\n++public class PlayerEntityReceiveEvent extends Event implements Cancellable {", "originalCommit": "f0a1199a55919984b33e5b7b07fac83446224130", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MjA0MQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515642041", "bodyText": "we should also have an untrack event, so maybe this should be PlayerTrackEntityEvent and the other PlayerUntrackEntityEvent", "author": "aikar", "createdAt": "2020-11-01T16:26:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MTc3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2MTY5MQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515661691", "bodyText": "done separate.", "author": "yannicklamprecht", "createdAt": "2020-11-01T19:29:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MTc3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MTkxNQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515641915", "bodyText": "Should also have a PlayerChunkUnloadEvent to complement this. So maybe name this PlayerChunkLoadEvent and PlayerChunkUnloadEvent", "author": "aikar", "createdAt": "2020-11-01T16:25:21Z", "path": "Spigot-API-Patches/0231-added-PlayerChunkReceiveEvent.patch", "diffHunk": "@@ -0,0 +1,53 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] added PlayerChunkReceiveEvent\n+\n+\n+diff --git a/src/main/java/io/papermc/paper/event/packet/PlayerChunkReceiveEvent.java b/src/main/java/io/papermc/paper/event/packet/PlayerChunkReceiveEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d6966e5b613c3a8c7dd3b4595d711ac24c403695\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/packet/PlayerChunkReceiveEvent.java\n+@@ -0,0 +1,41 @@\n++package io.papermc.paper.event.packet;\n++\n++import org.bukkit.Chunk;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.world.ChunkEvent;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called before a {@link org.bukkit.entity.Player} receives a {@link org.bukkit.Chunk}\n++ * used for e.g. Spawning a fake entity when the player receives a chunk\n++ *\n++ * Should only be used for packet/clientside related stuff.\n++ * Not intended for modifying server side.\n++ */\n++public class PlayerChunkReceiveEvent extends ChunkEvent {", "originalCommit": "f0a1199a55919984b33e5b7b07fac83446224130", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NzkyOQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515667929", "bodyText": "Applied.", "author": "yannicklamprecht", "createdAt": "2020-11-01T20:27:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MTkxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MjIwNw==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515642207", "bodyText": "All of these impl patches shouldnt say \"added\",\n\"<EventName>\" by itself is fine or\n\"Player Chunk Load/Unload Events\"\n\"Player Entity Tracking Events\"", "author": "aikar", "createdAt": "2020-11-01T16:27:46Z", "path": "Spigot-Server-Patches/0595-added-PlayerChunkReceiveEvent-logic.patch", "diffHunk": "@@ -0,0 +1,31 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:25:16 +0200\n+Subject: [PATCH] added PlayerChunkReceiveEvent logic", "originalCommit": "f0a1199a55919984b33e5b7b07fac83446224130", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NzkxMg==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r515667912", "bodyText": "Applied.", "author": "yannicklamprecht", "createdAt": "2020-11-01T20:27:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MjIwNw=="}], "type": "inlineReview"}, {"oid": "e2e0011757661e30cb7731991b92e8dd7647b094", "url": "https://github.com/PaperMC/Paper/commit/e2e0011757661e30cb7731991b92e8dd7647b094", "message": "Player Chunk Load/Unload Events", "committedDate": "2020-11-01T17:43:18Z", "type": "forcePushed"}, {"oid": "d69e69392addd37882dcc3b3306b9f5bb4c99fa6", "url": "https://github.com/PaperMC/Paper/commit/d69e69392addd37882dcc3b3306b9f5bb4c99fa6", "message": "Player Chunk Load/Unload Events", "committedDate": "2020-11-01T17:49:16Z", "type": "forcePushed"}, {"oid": "b292195808a275e84379d1d2d6f87f269d5554b7", "url": "https://github.com/PaperMC/Paper/commit/b292195808a275e84379d1d2d6f87f269d5554b7", "message": "Player Chunk Load/Unload Events", "committedDate": "2020-11-01T20:19:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzODQ1NQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r516938455", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            + * used for e.g. Spawning a fake entity when the player receives a chunk\n          \n          \n            \n            + * <p>\n          \n          \n            \n            + * Can for example be used for spawning a fake entity when the player receives a chunk.", "author": "Proximyst", "createdAt": "2020-11-03T20:31:31Z", "path": "Spigot-API-Patches/0232-Player-Chunk-Load-Unload-Events.patch", "diffHunk": "@@ -0,0 +1,99 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] Player Chunk Load/Unload Events\n+\n+\n+diff --git a/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java b/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d6dd7d08ad658f3c66b3808b0f677138c87ebef8\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java\n+@@ -0,0 +1,41 @@\n++package io.papermc.paper.event.packet;\n++\n++import org.bukkit.Chunk;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.world.ChunkEvent;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called when a {@link org.bukkit.entity.Player} receives a {@link org.bukkit.Chunk}\n++ * used for e.g. Spawning a fake entity when the player receives a chunk", "originalCommit": "b292195808a275e84379d1d2d6f87f269d5554b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzODY3OA==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r516938678", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            + * Not intended for modifying server side.\n          \n          \n            \n            + * Not intended for modifying server side state.", "author": "Proximyst", "createdAt": "2020-11-03T20:32:01Z", "path": "Spigot-API-Patches/0232-Player-Chunk-Load-Unload-Events.patch", "diffHunk": "@@ -0,0 +1,99 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] Player Chunk Load/Unload Events\n+\n+\n+diff --git a/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java b/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d6dd7d08ad658f3c66b3808b0f677138c87ebef8\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java\n+@@ -0,0 +1,41 @@\n++package io.papermc.paper.event.packet;\n++\n++import org.bukkit.Chunk;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.world.ChunkEvent;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called when a {@link org.bukkit.entity.Player} receives a {@link org.bukkit.Chunk}\n++ * used for e.g. Spawning a fake entity when the player receives a chunk\n++ *\n++ * Should only be used for packet/clientside related stuff.\n++ * Not intended for modifying server side.", "originalCommit": "b292195808a275e84379d1d2d6f87f269d5554b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzODc4NQ==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r516938785", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            + * Is called when a {@link Player} receives a chunk unload packet\n          \n          \n            \n            + * Is called when a {@link Player} receives a chunk unload packet.", "author": "Proximyst", "createdAt": "2020-11-03T20:32:12Z", "path": "Spigot-API-Patches/0232-Player-Chunk-Load-Unload-Events.patch", "diffHunk": "@@ -0,0 +1,99 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:24:45 +0200\n+Subject: [PATCH] Player Chunk Load/Unload Events\n+\n+\n+diff --git a/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java b/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..d6dd7d08ad658f3c66b3808b0f677138c87ebef8\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/packet/PlayerChunkLoadEvent.java\n+@@ -0,0 +1,41 @@\n++package io.papermc.paper.event.packet;\n++\n++import org.bukkit.Chunk;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.world.ChunkEvent;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called when a {@link org.bukkit.entity.Player} receives a {@link org.bukkit.Chunk}\n++ * used for e.g. Spawning a fake entity when the player receives a chunk\n++ *\n++ * Should only be used for packet/clientside related stuff.\n++ * Not intended for modifying server side.\n++ */\n++public class PlayerChunkLoadEvent extends ChunkEvent {\n++\n++    private static final HandlerList handlers = new HandlerList();\n++    private final Player player;\n++\n++    public PlayerChunkLoadEvent(@NotNull Chunk chunk, @NotNull Player player) {\n++        super(chunk);\n++        this.player = player;\n++    }\n++\n++    @NotNull\n++    @Override\n++    public HandlerList getHandlers() {\n++        return handlers;\n++    }\n++\n++    @NotNull\n++    public Player getPlayer() {\n++        return player;\n++    }\n++\n++    @NotNull\n++    public static HandlerList getHandlerList() {\n++        return handlers;\n++    }\n++}\n+diff --git a/src/main/java/io/papermc/paper/event/packet/PlayerChunkUnloadEvent.java b/src/main/java/io/papermc/paper/event/packet/PlayerChunkUnloadEvent.java\n+new file mode 100644\n+index 0000000000000000000000000000000000000000..8e53f1407bd15d6fb403790110011fe68b6df68b\n+--- /dev/null\n++++ b/src/main/java/io/papermc/paper/event/packet/PlayerChunkUnloadEvent.java\n+@@ -0,0 +1,40 @@\n++package io.papermc.paper.event.packet;\n++\n++import org.bukkit.Chunk;\n++import org.bukkit.entity.Player;\n++import org.bukkit.event.HandlerList;\n++import org.bukkit.event.world.ChunkEvent;\n++import org.jetbrains.annotations.NotNull;\n++\n++/**\n++ * Is called when a {@link Player} receives a chunk unload packet", "originalCommit": "b292195808a275e84379d1d2d6f87f269d5554b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzODg0NA==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r516938844", "bodyText": "Drop this line", "author": "Proximyst", "createdAt": "2020-11-03T20:32:24Z", "path": "Spigot-Server-Patches/0596-Player-Chunk-Load-Unload-Events.patch", "diffHunk": "@@ -0,0 +1,42 @@\n+From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001\n+From: ysl3000 <yannicklamprecht@live.de>\n+Date: Mon, 5 Oct 2020 21:25:16 +0200\n+Subject: [PATCH] Player Chunk Load/Unload Events\n+\n+\n+diff --git a/src/main/java/net/minecraft/server/EntityPlayer.java b/src/main/java/net/minecraft/server/EntityPlayer.java\n+index 8e1655a975af24f6781a95be7030afa8f1b14472..677e30c0ed7dd003adc13220fccd5fb0a6227bf7 100644\n+--- a/src/main/java/net/minecraft/server/EntityPlayer.java\n++++ b/src/main/java/net/minecraft/server/EntityPlayer.java\n+@@ -16,6 +16,9 @@ import java.util.OptionalInt;\n+ import java.util.Random;\n+ import java.util.UUID;\n+ import javax.annotation.Nullable;\n++", "originalCommit": "b292195808a275e84379d1d2d6f87f269d5554b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAxNDQ3Ng==", "url": "https://github.com/PaperMC/Paper/pull/4712#discussion_r517014476", "bodyText": "Done.", "author": "yannicklamprecht", "createdAt": "2020-11-03T23:26:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzODg0NA=="}], "type": "inlineReview"}, {"oid": "933b6aaeb2d2cc133d1364349f4369a61ba6bead", "url": "https://github.com/PaperMC/Paper/commit/933b6aaeb2d2cc133d1364349f4369a61ba6bead", "message": "Player Chunk Load/Unload Events\n\nCo-authored-by: Mariell <proximyst@proximyst.com>", "committedDate": "2020-11-04T11:23:02Z", "type": "forcePushed"}, {"oid": "9c2472eeef5163fe2d4fb6fea52738d11b36f760", "url": "https://github.com/PaperMC/Paper/commit/9c2472eeef5163fe2d4fb6fea52738d11b36f760", "message": "Player Chunk Load/Unload Events\n\nCo-authored-by: Mariell <proximyst@proximyst.com>", "committedDate": "2020-11-04T11:30:54Z", "type": "forcePushed"}, {"oid": "4040d0236dafd4d32e10d3d504e50afb02add6bc", "url": "https://github.com/PaperMC/Paper/commit/4040d0236dafd4d32e10d3d504e50afb02add6bc", "message": "Player Chunk Load/Unload Events\n\nCo-authored-by: Mariell <proximyst@proximyst.com>", "committedDate": "2020-12-16T19:19:03Z", "type": "commit"}, {"oid": "4040d0236dafd4d32e10d3d504e50afb02add6bc", "url": "https://github.com/PaperMC/Paper/commit/4040d0236dafd4d32e10d3d504e50afb02add6bc", "message": "Player Chunk Load/Unload Events\n\nCo-authored-by: Mariell <proximyst@proximyst.com>", "committedDate": "2020-12-16T19:19:03Z", "type": "forcePushed"}]}