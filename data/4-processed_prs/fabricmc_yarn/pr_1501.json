{"pr_number": 1501, "pr_title": "Improvements to lighting engine mappings", "pr_createdAt": "2020-06-24T07:53:10Z", "pr_url": "https://github.com/FabricMC/yarn/pull/1501", "timeline": [{"oid": "ec2053474ff9997ca670d2603eb36a134b873f8b", "url": "https://github.com/FabricMC/yarn/commit/ec2053474ff9997ca670d2603eb36a134b873f8b", "message": "Improvements to lighting engine mappings", "committedDate": "2020-06-24T07:46:14Z", "type": "commit"}, {"oid": "b73c6a3cb3b40805d1cf52eeb87654636680e688", "url": "https://github.com/FabricMC/yarn/commit/b73c6a3cb3b40805d1cf52eeb87654636680e688", "message": "Consistency in ChunkLightProvider", "committedDate": "2020-06-24T07:52:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxMTc5Mg==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r444711792", "bodyText": "I think it's better to leave these as pos rather than blockPos.", "author": "haykam821", "createdAt": "2020-06-24T07:55:32Z", "path": "mappings/net/minecraft/world/chunk/light/ChunkLightProvider.mapping", "diffHunk": "@@ -42,11 +42,13 @@ CLASS net/minecraft/class_3558 net/minecraft/world/chunk/light/ChunkLightProvide\n \t\tARG 5 direction\n \t\tARG 6 opacity2\n \tMETHOD method_20479 getStateForLighting (JLorg/apache/commons/lang3/mutable/MutableInt;)Lnet/minecraft/class_2680;\n-\t\tARG 1 pos\n-\tMETHOD method_20599 setRetainData (Lnet/minecraft/class_1923;Z)V\n+\t\tARG 1 blockPos", "originalCommit": "b73c6a3cb3b40805d1cf52eeb87654636680e688", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxMzE4NQ==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r444713185", "bodyText": "Right- I guess it might be clear enough from the method name. Though just here where there's so many different kinds of pos, where they're all longs, I think it could still be useful to clarify everything? Not sure", "author": "Gegy", "createdAt": "2020-06-24T07:57:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxMTc5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MTgzMw==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446681833", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tARG 1 blockPos\n          \n          \n            \n            \t\tARG 1 pos", "author": "liach", "createdAt": "2020-06-28T18:21:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxMTc5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MTk3Nw==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446681977", "bodyText": "I still think here it's best to clarify everywhere since there's so many different pos parameters that are all longs", "author": "Gegy", "createdAt": "2020-06-28T18:22:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxMTc5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MzE4MA==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446683180", "bodyText": "It returns a BlockState, and you can infer it's a block pos", "author": "liach", "createdAt": "2020-06-28T18:35:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxMTc5Mg=="}], "type": "inlineReview"}, {"oid": "8ee65d7adc7642659e796224a49ea53e0c9b8534", "url": "https://github.com/FabricMC/yarn/commit/8ee65d7adc7642659e796224a49ea53e0c9b8534", "message": "Merge remote-tracking branch 'upstream/1.16.1' into lighting-engine", "committedDate": "2020-06-24T15:44:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NDMyNQ==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446664325", "bodyText": "maybe just\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tMETHOD method_18691 fromWorldPos (J)J\n          \n          \n            \n            \tMETHOD method_18691 fromBlockPos (J)J", "author": "liach", "createdAt": "2020-06-28T15:28:22Z", "path": "mappings/net/minecraft/util/math/ChunkSectionPos.mapping", "diffHunk": "@@ -38,13 +38,13 @@ CLASS net/minecraft/class_4076 net/minecraft/util/math/ChunkSectionPos\n \t\tARG 0 packed\n \tMETHOD method_18687 getSectionZ ()I\n \tMETHOD method_18688 getWorldCoord (I)I\n-\t\tARG 0 chunkCoord\n+\t\tARG 0 sectionCoord\n \tMETHOD method_18689 getY (J)I\n \t\tARG 0 packed\n \tMETHOD method_18690 getZ (J)I\n \t\tARG 0 packed\n-\tMETHOD method_18691 fromGlobalPos (J)J\n-\t\tARG 0 globalLong\n+\tMETHOD method_18691 fromWorldPos (J)J", "originalCommit": "8ee65d7adc7642659e796224a49ea53e0c9b8534", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NTk3NA==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446665974", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tFIELD field_15815 skyLightSectionsToUpdate Lit/unimi/dsi/fastutil/longs/LongSet;\n          \n          \n            \n            \tFIELD field_15815 sectionsToUpdate Lit/unimi/dsi/fastutil/longs/LongSet;", "author": "liach", "createdAt": "2020-06-28T15:44:10Z", "path": "mappings/net/minecraft/world/chunk/light/SkyLightStorage.mapping", "diffHunk": "@@ -1,17 +1,28 @@\n CLASS net/minecraft/class_3569 net/minecraft/world/chunk/light/SkyLightStorage\n-\tFIELD field_15815 pendingSkylightUpdates Lit/unimi/dsi/fastutil/longs/LongSet;\n-\tFIELD field_15817 lightEnabled Lit/unimi/dsi/fastutil/longs/LongSet;\n+\tFIELD field_15815 skyLightSectionsToUpdate Lit/unimi/dsi/fastutil/longs/LongSet;", "originalCommit": "8ee65d7adc7642659e796224a49ea53e0c9b8534", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjAxOA==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446666018", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tFIELD field_15816 skyLightSectionsToRemove Lit/unimi/dsi/fastutil/longs/LongSet;\n          \n          \n            \n            \tFIELD field_15816 sectionsToRemove Lit/unimi/dsi/fastutil/longs/LongSet;\n          \n      \n    \n    \n  \n\nOnly if the sectionsToRemove is private in LightStorage", "author": "liach", "createdAt": "2020-06-28T15:44:36Z", "path": "mappings/net/minecraft/world/chunk/light/SkyLightStorage.mapping", "diffHunk": "@@ -1,17 +1,28 @@\n CLASS net/minecraft/class_3569 net/minecraft/world/chunk/light/SkyLightStorage\n-\tFIELD field_15815 pendingSkylightUpdates Lit/unimi/dsi/fastutil/longs/LongSet;\n-\tFIELD field_15817 lightEnabled Lit/unimi/dsi/fastutil/longs/LongSet;\n+\tFIELD field_15815 skyLightSectionsToUpdate Lit/unimi/dsi/fastutil/longs/LongSet;\n+\tFIELD field_15816 skyLightSectionsToRemove Lit/unimi/dsi/fastutil/longs/LongSet;", "originalCommit": "8ee65d7adc7642659e796224a49ea53e0c9b8534", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY3Nzg5NA==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446677894", "bodyText": "It is private in LightStorage, so could definitely remap; but I'm worried if it could still be confusing?\nAlso, Enigma doesn't like it- if just editing it manually, it shouldn't cause other issues in the toolchain right?", "author": "Gegy", "createdAt": "2020-06-28T17:42:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjAxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY3OTEyMg==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446679122", "bodyText": "Yes, please rename this. Some stuff like codec fields has to be renamed manually for now", "author": "liach", "createdAt": "2020-06-28T17:53:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjAxOA=="}], "type": "inlineReview"}, {"oid": "a4fba985d5a8a40fad3e4f181db11bbdd239e407", "url": "https://github.com/FabricMC/yarn/commit/a4fba985d5a8a40fad3e4f181db11bbdd239e407", "message": "apply some suggestions", "committedDate": "2020-06-28T17:59:38Z", "type": "commit"}, {"oid": "d731403e9f7ece94a32370495c38d30d00da6af2", "url": "https://github.com/FabricMC/yarn/commit/d731403e9f7ece94a32370495c38d30d00da6af2", "message": "remove skyLight prefixes in SkyLightStorage", "committedDate": "2020-06-28T18:01:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MDMxOQ==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446680319", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tCOMMENT The smallest unit within LightStorage is the section. Sections represent a cube of 16x16x16 blocks and their lighting data.\n          \n          \n            \n            \tCOMMENT <p>The smallest unit within LightStorage is the section. Sections represent a cube of 16x16x16 blocks and their lighting data.", "author": "liach", "createdAt": "2020-06-28T18:06:43Z", "path": "mappings/net/minecraft/world/chunk/light/LightStorage.mapping", "diffHunk": "@@ -1,4 +1,15 @@\n CLASS net/minecraft/class_3560 net/minecraft/world/chunk/light/LightStorage\n+\tCOMMENT LightStorage handles the access, storage and propagation of a specific kind of light within the world.\n+\tCOMMENT For example, separate instances will be used to store block light as opposed to sky light.\n+\tCOMMENT\n+\tCOMMENT The smallest unit within LightStorage is the section. Sections represent a cube of 16x16x16 blocks and their lighting data.", "originalCommit": "a4fba985d5a8a40fad3e4f181db11bbdd239e407", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MDM3MA==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446680370", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tCOMMENT To avoid allocations, LightStorage packs all the coordinate arguments into single long values. Extra care should be taken\n          \n          \n            \n            \tCOMMENT <p>To avoid allocations, LightStorage packs all the coordinate arguments into single long values. Extra care should be taken\n          \n      \n    \n    \n  \n\nWithout these paragraph split, the rendered javadoc will just have continuous sentences.", "author": "liach", "createdAt": "2020-06-28T18:07:05Z", "path": "mappings/net/minecraft/world/chunk/light/LightStorage.mapping", "diffHunk": "@@ -1,4 +1,15 @@\n CLASS net/minecraft/class_3560 net/minecraft/world/chunk/light/LightStorage\n+\tCOMMENT LightStorage handles the access, storage and propagation of a specific kind of light within the world.\n+\tCOMMENT For example, separate instances will be used to store block light as opposed to sky light.\n+\tCOMMENT\n+\tCOMMENT The smallest unit within LightStorage is the section. Sections represent a cube of 16x16x16 blocks and their lighting data.\n+\tCOMMENT In turn, 16 sections stacked on top of each other form a column, which are analogous to the standard 16x256x16 world chunks.\n+\tCOMMENT\n+\tCOMMENT To avoid allocations, LightStorage packs all the coordinate arguments into single long values. Extra care should be taken", "originalCommit": "a4fba985d5a8a40fad3e4f181db11bbdd239e407", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MDg4OQ==", "url": "https://github.com/FabricMC/yarn/pull/1501#discussion_r446680889", "bodyText": "Thanks :)", "author": "Gegy", "createdAt": "2020-06-28T18:12:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4MDM3MA=="}], "type": "inlineReview"}, {"oid": "a492559be6b94430cddb6193674fae8d64aab04e", "url": "https://github.com/FabricMC/yarn/commit/a492559be6b94430cddb6193674fae8d64aab04e", "message": "mark paragraphs", "committedDate": "2020-06-28T18:13:24Z", "type": "commit"}, {"oid": "a94906a670c02cccb61990c406f86de3773d13d5", "url": "https://github.com/FabricMC/yarn/commit/a94906a670c02cccb61990c406f86de3773d13d5", "message": "`blockPos` -> `pos`\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>", "committedDate": "2020-07-10T13:14:33Z", "type": "commit"}, {"oid": "bad69b6afe2669dc9f8d543c03d4355d93bdaa42", "url": "https://github.com/FabricMC/yarn/commit/bad69b6afe2669dc9f8d543c03d4355d93bdaa42", "message": "`blockPos` -> `pos`", "committedDate": "2020-07-10T13:15:02Z", "type": "commit"}]}