{"pr_number": 1182, "pr_title": "InfoEnchantment -> EnchantmentLevelEntry (extends WeightedPicker.Entry)", "pr_createdAt": "2020-03-14T06:31:34Z", "pr_url": "https://github.com/FabricMC/yarn/pull/1182", "timeline": [{"oid": "3af6f20b6be3be92336cc5df3724c5c81feda853", "url": "https://github.com/FabricMC/yarn/commit/3af6f20b6be3be92336cc5df3724c5c81feda853", "message": "InfoEnchantment -> EnchantmentsEntry (extends WeightedPicker.Entry)\nEnchantment$Weight -> Enchantment$Rarity\n\nagain time to end that utter nonsense\n\nSigned-off-by: liach <liach@users.noreply.github.com>", "committedDate": "2020-03-14T06:30:51Z", "type": "commit"}, {"oid": "5f2e8d27600c5d5538a5d26a368221c757c0493d", "url": "https://github.com/FabricMC/yarn/commit/5f2e8d27600c5d5538a5d26a368221c757c0493d", "message": "Don't cry at me for not closing #1181 if you get fooled into think this is the actual \"enchantment\"\nthis thing is just a weighted picker entry; even client data gen properties entry (key-value pair) has proper hashCode and equals and this thing doesn't\n\nSigned-off-by: liach <liach@users.noreply.github.com>", "committedDate": "2020-03-14T06:39:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTcwOA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392565708", "bodyText": "I feel like \"Random\" shouldn't be part of the name here, as it might be an implementation detail. I would rather go with something like getEquipmentEnchantedWith, while keeping the new javadocs.", "author": "Earthcomputer", "createdAt": "2020-03-14T07:44:44Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -1,9 +1,19 @@\n CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_17884 (Ljava/util/Map;Lnet/minecraft/class_2487;Lnet/minecraft/class_1887;)V\n \t\tARG 2 enchantment\n-\tMETHOD method_22445 getEnchantments (Lnet/minecraft/class_2499;)Ljava/util/Map;\n+\tMETHOD method_22445 fromTag (Lnet/minecraft/class_2499;)Ljava/util/Map;\n+\t\tCOMMENT Loads enchantments from a list named binary tag.\n \t\tARG 0 tag\n-\tMETHOD method_24365 getMatchingEnchantedEquipment (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;Ljava/util/function/Predicate;)Ljava/util/Map$Entry;\n+\tMETHOD method_24365 getRandomEnchantedEquipment (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;Ljava/util/function/Predicate;)Ljava/util/Map$Entry;", "originalCommit": "5f2e8d27600c5d5538a5d26a368221c757c0493d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU4NzU3MQ==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392587571", "bodyText": "how about getRandom -> choose?", "author": "liach", "createdAt": "2020-03-14T13:14:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTcwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU5ODU1Ng==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392598556", "bodyText": "Renamed. The new name is chooseEquipmentWith", "author": "liach", "createdAt": "2020-03-14T15:57:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTcwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTgwOA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392565808", "bodyText": "Similarly, this could be renamed to getEquipmentEnchantedWith", "author": "Earthcomputer", "createdAt": "2020-03-14T07:46:31Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -18,15 +28,24 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8202 getRiptide (Lnet/minecraft/class_1799;)I\n \t\tARG 0 stack\n \tMETHOD method_8203 getEquipmentLevel (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)I\n-\t\tARG 0 ench\n+\t\tCOMMENT Returns the highest level of the passed enchantment in the enchantment's\n+\t\tCOMMENT applicable equipment slots' item stacks.\n+\t\tARG 0 enchantment\n \t\tARG 1 entity\n \tMETHOD method_8204 getRandomEnchantedEquipment (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)Ljava/util/Map$Entry;", "originalCommit": "5f2e8d27600c5d5538a5d26a368221c757c0493d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU5ODU0MA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392598540", "bodyText": "renamed to chooseEquipmentWith, so you call it like EnchantmentHelper.chooseEquipmentWith(Enchantments.MENDING, entity).", "author": "liach", "createdAt": "2020-03-14T15:57:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTgwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTkyNQ==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392565925", "bodyText": "It's not a seed, it's a seeded Random", "author": "Earthcomputer", "createdAt": "2020-03-14T07:48:59Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -51,48 +74,71 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8219 getProtectionAmount (Ljava/lang/Iterable;Lnet/minecraft/class_1282;)I\n \t\tARG 0 equipment\n \t\tARG 1 source\n-\tMETHOD method_8220 accept (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n-\t\tARG 0 enchantmentHandler\n+\tMETHOD method_8220 process (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n+\t\tARG 0 action\n \t\tARG 1 stack\n \tMETHOD method_8221 hasVanishingCurse (Lnet/minecraft/class_1799;)Z\n \t\tARG 0 stack\n-\tMETHOD method_8222 getEnchantments (Lnet/minecraft/class_1799;)Ljava/util/Map;\n+\tMETHOD method_8222 get (Lnet/minecraft/class_1799;)Ljava/util/Map;\n+\t\tCOMMENT Gets the enchantments on an item stack.\n+\t\tCOMMENT\n+\t\tCOMMENT <p>For enchanted books, it retrieves from the item stack's stored than\n+\t\tCOMMENT regular enchantments.\n \t\tARG 0 stack\n \tMETHOD method_8223 getLuckOfTheSea (Lnet/minecraft/class_1799;)I\n \t\tARG 0 stack\n \tMETHOD method_8224 hasBindingCurse (Lnet/minecraft/class_1799;)Z\n \t\tARG 0 stack\n \tMETHOD method_8225 getLevel (Lnet/minecraft/class_1887;Lnet/minecraft/class_1799;)I\n+\t\tCOMMENT Gets the level of an enchantment on an item stack.\n \t\tARG 0 enchantment\n \t\tARG 1 stack\n \tMETHOD method_8226 getLooting (Lnet/minecraft/class_1309;)I\n \t\tARG 0 entity\n-\tMETHOD method_8227 calculateEnchantmentPower (Ljava/util/Random;IILnet/minecraft/class_1799;)I\n+\tMETHOD method_8227 calculateRequiredExperienceLevel (Ljava/util/Random;IILnet/minecraft/class_1799;)I\n+\t\tCOMMENT Returns the required experience level for an enchanting option in the\n+\t\tCOMMENT enchanting table's screen, or the enchantment screen.\n \t\tARG 0 random\n-\t\tARG 1 num\n-\t\tARG 2 enchantmentPower\n-\t\tARG 3 rstack\n+\t\t\tCOMMENT the seed\n+\t\tARG 1 slotIndex\n+\t\t\tCOMMENT the index of the enchanting option\n+\t\tARG 2 bookshelfCount\n+\t\t\tCOMMENT the number of bookshelves\n+\t\tARG 3 stack\n+\t\t\tCOMMENT the item stack to enchant\n \tMETHOD method_8228 hasChanneling (Lnet/minecraft/class_1799;)Z\n \t\tARG 0 stack\n-\tMETHOD method_8229 getHighestApplicableEnchantmentsAtPower (ILnet/minecraft/class_1799;Z)Ljava/util/List;\n+\tMETHOD method_8229 getPossibleEntries (ILnet/minecraft/class_1799;Z)Ljava/util/List;\n+\t\tCOMMENT Gets all the possible entries for enchanting the {@code stack} at the\n+\t\tCOMMENT given {@code power}.\n \t\tARG 0 power\n \t\tARG 1 stack\n \t\tARG 2 treasureAllowed\n-\tMETHOD method_8230 getEnchantments (Ljava/util/Random;Lnet/minecraft/class_1799;IZ)Ljava/util/List;\n+\tMETHOD method_8230 generateEnchantments (Ljava/util/Random;Lnet/minecraft/class_1799;IZ)Ljava/util/List;\n+\t\tCOMMENT Generate the enchantments for enchanting the {@code stack}.\n \t\tARG 0 random\n \t\tARG 1 stack\n \t\tARG 2 level\n-\t\tARG 3 hasTreasure\n-\tMETHOD method_8231 remove (Ljava/util/List;Lnet/minecraft/class_1889;)V\n-\t\tARG 0 infos\n-\t\tARG 1 info\n+\t\tARG 3 treasureAllowed\n+\tMETHOD method_8231 removeConflicts (Ljava/util/List;Lnet/minecraft/class_1889;)V\n+\t\tCOMMENT Remove entries conflicting with the picked entry from the possible\n+\t\tCOMMENT entries.\n+\t\tARG 0 possibleEntries\n+\t\t\tCOMMENT the possible entries\n+\t\tARG 1 pickedEntry\n+\t\t\tCOMMENT the picked entry\n \tMETHOD method_8232 getDepthStrider (Lnet/minecraft/class_1309;)I\n \t\tARG 0 entity\n \tMETHOD method_8233 enchant (Ljava/util/Random;Lnet/minecraft/class_1799;IZ)Lnet/minecraft/class_1799;\n+\t\tCOMMENT Enchants the {@code target} item stack and returns it.\n \t\tARG 0 random\n+\t\t\tCOMMENT the seed", "originalCommit": "5f2e8d27600c5d5538a5d26a368221c757c0493d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU5ODQ3Mg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392598472", "bodyText": "Yep, redocumented", "author": "liach", "createdAt": "2020-03-14T15:56:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTkyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTk0Mg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392565942", "bodyText": "Perhaps use the singular EnchantmentEntry instead?", "author": "Earthcomputer", "createdAt": "2020-03-14T07:49:24Z", "path": "mappings/net/minecraft/enchantment/EnchantmentsEntry.mapping", "diffHunk": "@@ -0,0 +1,12 @@\n+CLASS net/minecraft/class_1889 net/minecraft/enchantment/EnchantmentsEntry", "originalCommit": "5f2e8d27600c5d5538a5d26a368221c757c0493d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU4NzY4Mg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392587682", "bodyText": "enchantments refers to the nbt list Enchantments or StoredEnchantments. This object is part of that list rather than part of the current Enchantment we have, so I named it with an s.", "author": "liach", "createdAt": "2020-03-14T13:16:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU5ODQ1MA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392598450", "bodyText": "Done, thanks earth!", "author": "liach", "createdAt": "2020-03-14T15:56:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTk0Mg=="}], "type": "inlineReview"}, {"oid": "a541c27dcc2726e8db7eb14edefc271d7d98ff43", "url": "https://github.com/FabricMC/yarn/commit/a541c27dcc2726e8db7eb14edefc271d7d98ff43", "message": "Good suggestions earthcomputer\n\nSigned-off-by: liach <liach@users.noreply.github.com>", "committedDate": "2020-03-14T15:56:18Z", "type": "commit"}, {"oid": "9517c35cdfa06024e423182f2097b43008ac2403", "url": "https://github.com/FabricMC/yarn/commit/9517c35cdfa06024e423182f2097b43008ac2403", "message": "Suggested EnchantmentLevelEntry\n\nSigned-off-by: liach <liach@users.noreply.github.com>", "committedDate": "2020-03-14T21:20:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY3OTI4NQ==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392679285", "bodyText": "I don't think defining immutability has anything to do with hashCode and equals.", "author": "Juuxel", "createdAt": "2020-03-15T14:31:29Z", "path": "mappings/net/minecraft/enchantment/EnchantmentLevelEntry.mapping", "diffHunk": "@@ -0,0 +1,16 @@\n+CLASS net/minecraft/class_1889 net/minecraft/enchantment/EnchantmentLevelEntry\n+\tCOMMENT Represents an entry in an enchantments array, i.e. a pair between\n+\tCOMMENT enchantment and level. This is also a weighted entry and is available\n+\tCOMMENT for the weighted picker to pick from a list.\n+\tCOMMENT\n+\tCOMMENT <p>This is usually used where multiple enchantment to level mappings can\n+\tCOMMENT exist, such as in enchanting logic. In other cases, vanilla prefers\n+\tCOMMENT {@code Map<Enchantment, Integer>} over {@code List<EnchantmentLevelEntry>}.\n+\tCOMMENT\n+\tCOMMENT <p>This class, though effectively immutable, does not override hashCode\n+\tCOMMENT or equals.", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY3OTQ0NA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392679444", "bodyText": "Well, hashCode and equals are unreliable if an object isn't immutbale, i.e. immutability is a prerequisite for useful hashCode/equals", "author": "liach", "createdAt": "2020-03-15T14:33:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY3OTI4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MTI5Mw==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392791293", "bodyText": "Updated to show that these two have no relationship", "author": "liach", "createdAt": "2020-03-16T05:39:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY3OTI4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDIwOA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392684208", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tCOMMENT Loads enchantments from a list named binary tag.\n          \n          \n            \n            \t\tCOMMENT Loads enchantments from a NBT list.\n          \n      \n    \n    \n  \n\nI initially read \"a list named binary tag\" as \"a list named 'binary tag'\"", "author": "Pyrofab", "createdAt": "2020-03-15T15:25:32Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -1,9 +1,22 @@\n CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_17884 (Ljava/util/Map;Lnet/minecraft/class_2487;Lnet/minecraft/class_1887;)V\n \t\tARG 2 enchantment\n-\tMETHOD method_22445 getEnchantments (Lnet/minecraft/class_2499;)Ljava/util/Map;\n+\tMETHOD method_22445 fromTag (Lnet/minecraft/class_2499;)Ljava/util/Map;\n+\t\tCOMMENT Loads enchantments from a list named binary tag.", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwMTQ0Mw==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392701443", "bodyText": "I think 'an NBT list' would be more correct", "author": "2xsaiko", "createdAt": "2020-03-15T18:52:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcxMjcyMw==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392712723", "bodyText": "I hesitated on which to take. \"an NBT list\" does sound better if you say it as an acronym.", "author": "Pyrofab", "createdAt": "2020-03-15T21:06:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MTM1NA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392791354", "bodyText": "Done", "author": "liach", "createdAt": "2020-03-16T05:39:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDIwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM2Nw==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392684367", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tMETHOD method_24365 chooseEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;Ljava/util/function/Predicate;)Ljava/util/Map$Entry;\n          \n          \n            \n            \tMETHOD method_24365 findEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;Ljava/util/function/Predicate;)Ljava/util/Map$Entry;\n          \n      \n    \n    \n  \n\nI think find is more appropriate than choose here.", "author": "Pyrofab", "createdAt": "2020-03-15T15:26:49Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -1,9 +1,22 @@\n CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_17884 (Ljava/util/Map;Lnet/minecraft/class_2487;Lnet/minecraft/class_1887;)V\n \t\tARG 2 enchantment\n-\tMETHOD method_22445 getEnchantments (Lnet/minecraft/class_2499;)Ljava/util/Map;\n+\tMETHOD method_22445 fromTag (Lnet/minecraft/class_2499;)Ljava/util/Map;\n+\t\tCOMMENT Loads enchantments from a list named binary tag.\n \t\tARG 0 tag\n-\tMETHOD method_24365 getMatchingEnchantedEquipment (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;Ljava/util/function/Predicate;)Ljava/util/Map$Entry;\n+\tMETHOD method_24365 chooseEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;Ljava/util/function/Predicate;)Ljava/util/Map$Entry;", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcyODk1OQ==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392728959", "bodyText": "If you use \"find\", I'd call it findRandom (see java stream), which... I like choose better", "author": "liach", "createdAt": "2020-03-15T23:58:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MTg2Mg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392791862", "bodyText": "find fails to indicate the random aspect of this method, while choose can have null result if none of the options can be chosen.", "author": "liach", "createdAt": "2020-03-16T05:42:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4OTMyOQ==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392889329", "bodyText": "If you want to look at java streams, you could call it findAny, it has basically the same behaviour.", "author": "Pyrofab", "createdAt": "2020-03-16T09:40:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzAwNTk3OA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r393005978", "bodyText": "Java's stream findAny is more like entity selector's sort=arbitrary, while this method behaves like sort=random", "author": "liach", "createdAt": "2020-03-16T13:01:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDQxMg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392684412", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tMETHOD method_8204 chooseEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)Ljava/util/Map$Entry;\n          \n          \n            \n            \tMETHOD method_8204 findEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)Ljava/util/Map$Entry;", "author": "Pyrofab", "createdAt": "2020-03-15T15:27:28Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -18,15 +31,28 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8202 getRiptide (Lnet/minecraft/class_1799;)I\n \t\tARG 0 stack\n \tMETHOD method_8203 getEquipmentLevel (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)I\n-\t\tARG 0 ench\n+\t\tCOMMENT Returns the highest level of the passed enchantment in the enchantment's\n+\t\tCOMMENT applicable equipment slots' item stacks.\n+\t\tARG 0 enchantment\n+\t\t\tCOMMENT the enchantment\n+\t\tARG 1 entity\n+\t\t\tCOMMENT the entity whose equipment slots are checked\n+\tMETHOD method_8204 chooseEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)Ljava/util/Map$Entry;", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDYzMw==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392684633", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tMETHOD method_8209 forEach (Lnet/minecraft/class_1890$class_1891;Ljava/lang/Iterable;)V\n          \n          \n            \n            \tMETHOD method_8209 forEachEnchantment (Lnet/minecraft/class_1890$class_1891;Ljava/lang/Iterable;)V\n          \n      \n    \n    \n  \n\nThis method is basically applying an action to every enchantment of every stack in the list.", "author": "Pyrofab", "createdAt": "2020-03-15T15:29:52Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -18,15 +31,28 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8202 getRiptide (Lnet/minecraft/class_1799;)I\n \t\tARG 0 stack\n \tMETHOD method_8203 getEquipmentLevel (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)I\n-\t\tARG 0 ench\n+\t\tCOMMENT Returns the highest level of the passed enchantment in the enchantment's\n+\t\tCOMMENT applicable equipment slots' item stacks.\n+\t\tARG 0 enchantment\n+\t\t\tCOMMENT the enchantment\n+\t\tARG 1 entity\n+\t\t\tCOMMENT the entity whose equipment slots are checked\n+\tMETHOD method_8204 chooseEquipmentWith (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)Ljava/util/Map$Entry;\n+\t\tCOMMENT Returns a pair of an equipment slot and the item stack in the supplied\n+\t\tCOMMENT entity's slot, indicating the item stack has the enchantment supplied.\n+\t\tCOMMENT\n+\t\tCOMMENT <p>If multiple equipment slots' item stacks are valid, a random pair is\n+\t\tCOMMENT returned.\n+\t\tARG 0 enchantment\n+\t\t\tCOMMENT the enchantment the equipped item stack must have\n \t\tARG 1 entity\n-\tMETHOD method_8204 getRandomEnchantedEquipment (Lnet/minecraft/class_1887;Lnet/minecraft/class_1309;)Ljava/util/Map$Entry;\n+\t\t\tCOMMENT the entity to choose equipments from\n \tMETHOD method_8205 getKnockback (Lnet/minecraft/class_1309;)I\n \t\tARG 0 entity\n \tMETHOD method_8206 getLoyalty (Lnet/minecraft/class_1799;)I\n \t\tARG 0 stack\n-\tMETHOD method_8209 accept (Lnet/minecraft/class_1890$class_1891;Ljava/lang/Iterable;)V\n-\t\tARG 0 enchantmentHandler\n+\tMETHOD method_8209 forEach (Lnet/minecraft/class_1890$class_1891;Ljava/lang/Iterable;)V", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcyOTA4OA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392729088", "bodyText": "private helper method, also note the first parameter is explicit EnchantmentHelper.Consumer, so like for each enchantment consumer in iterable", "author": "liach", "createdAt": "2020-03-15T23:59:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDYzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MTM5Mg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392791392", "bodyText": "Done.", "author": "liach", "createdAt": "2020-03-16T05:39:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDYzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDc5Ng==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392684796", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tMETHOD method_8220 process (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n          \n          \n            \n            \tMETHOD method_8220 forEachEnchantment (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n          \n      \n    \n    \n  \n\nThis method is quite similar to the one above, applying an action to every enchantment on the stack.", "author": "Pyrofab", "createdAt": "2020-03-15T15:31:10Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -51,48 +81,71 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8219 getProtectionAmount (Ljava/lang/Iterable;Lnet/minecraft/class_1282;)I\n \t\tARG 0 equipment\n \t\tARG 1 source\n-\tMETHOD method_8220 accept (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n-\t\tARG 0 enchantmentHandler\n+\tMETHOD method_8220 process (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcyOTEyNw==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392729127", "bodyText": "It is like for only one item stack i think \ud83e\udd14", "author": "liach", "createdAt": "2020-03-16T00:00:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDc5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MTQxOA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392791418", "bodyText": "Done.", "author": "liach", "createdAt": "2020-03-16T05:39:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDc5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDk0Ng==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392684946", "bodyText": "Not sure about this change. EnchantmentHelper.get(stack) does not make it immediately clear that we are getting the enchantments on the stack.", "author": "Pyrofab", "createdAt": "2020-03-15T15:32:39Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -51,48 +81,71 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8219 getProtectionAmount (Ljava/lang/Iterable;Lnet/minecraft/class_1282;)I\n \t\tARG 0 equipment\n \t\tARG 1 source\n-\tMETHOD method_8220 accept (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n-\t\tARG 0 enchantmentHandler\n+\tMETHOD method_8220 process (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n+\t\tARG 0 action\n \t\tARG 1 stack\n \tMETHOD method_8221 hasVanishingCurse (Lnet/minecraft/class_1799;)Z\n \t\tARG 0 stack\n-\tMETHOD method_8222 getEnchantments (Lnet/minecraft/class_1799;)Ljava/util/Map;\n+\tMETHOD method_8222 get (Lnet/minecraft/class_1799;)Ljava/util/Map;", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc4OTgyNg==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392789826", "bodyText": "This is on par with EnchantmentHelper.set which already exists.", "author": "liach", "createdAt": "2020-03-16T05:32:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDk0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NTE4NQ==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392685185", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tCOMMENT <p>For enchanted books, it retrieves from the item stack's stored than\n          \n          \n            \n            \t\tCOMMENT regular enchantments.\n          \n          \n            \n            \t\tCOMMENT <p>For enchanted books, it retrieves from the stack's stored enchantments\n          \n          \n            \n            \t\tCOMMENT rather than from the regular enchantments data.\n          \n          \n            \n            \t\tCOMMENT @see EnchantedBookItem#getEnchantmentTag", "author": "Pyrofab", "createdAt": "2020-03-15T15:35:30Z", "path": "mappings/net/minecraft/enchantment/EnchantmentHelper.mapping", "diffHunk": "@@ -51,48 +81,71 @@ CLASS net/minecraft/class_1890 net/minecraft/enchantment/EnchantmentHelper\n \tMETHOD method_8219 getProtectionAmount (Ljava/lang/Iterable;Lnet/minecraft/class_1282;)I\n \t\tARG 0 equipment\n \t\tARG 1 source\n-\tMETHOD method_8220 accept (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n-\t\tARG 0 enchantmentHandler\n+\tMETHOD method_8220 process (Lnet/minecraft/class_1890$class_1891;Lnet/minecraft/class_1799;)V\n+\t\tARG 0 action\n \t\tARG 1 stack\n \tMETHOD method_8221 hasVanishingCurse (Lnet/minecraft/class_1799;)Z\n \t\tARG 0 stack\n-\tMETHOD method_8222 getEnchantments (Lnet/minecraft/class_1799;)Ljava/util/Map;\n+\tMETHOD method_8222 get (Lnet/minecraft/class_1799;)Ljava/util/Map;\n+\t\tCOMMENT Gets the enchantments on an item stack.\n+\t\tCOMMENT\n+\t\tCOMMENT <p>For enchanted books, it retrieves from the item stack's stored than\n+\t\tCOMMENT regular enchantments.", "originalCommit": "9517c35cdfa06024e423182f2097b43008ac2403", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MDc5OA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392790798", "bodyText": "Don't see the point of rephrasing the first part, see tag might be worthy", "author": "liach", "createdAt": "2020-03-16T05:37:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NTE4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc5MTQ4NA==", "url": "https://github.com/FabricMC/yarn/pull/1182#discussion_r392791484", "bodyText": "Only added new see tags for both set and get methods.", "author": "liach", "createdAt": "2020-03-16T05:40:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NTE4NQ=="}], "type": "inlineReview"}, {"oid": "f412e94ae25a600919b5fc8d54169055b6b386c0", "url": "https://github.com/FabricMC/yarn/commit/f412e94ae25a600919b5fc8d54169055b6b386c0", "message": "Selected changes for enchantment helper", "committedDate": "2020-03-16T05:38:05Z", "type": "commit"}, {"oid": "bb757bf80eb1d16b85a456bcfbad23ac6a00aac2", "url": "https://github.com/FabricMC/yarn/commit/bb757bf80eb1d16b85a456bcfbad23ac6a00aac2", "message": "Rephrase to make it less confusing per juuz", "committedDate": "2020-03-16T05:38:58Z", "type": "commit"}]}