{"pr_number": 410, "pr_title": "Do not shutdown logger context during Node close", "pr_createdAt": "2020-04-24T01:11:33Z", "pr_url": "https://github.com/opensearch-project/security/pull/410", "timeline": [{"oid": "41c50d4c2623f87453e095c552c96abafb0416b5", "url": "https://github.com/opensearch-project/security/commit/41c50d4c2623f87453e095c552c96abafb0416b5", "message": "Do not shutdown logger context during Node close", "committedDate": "2020-04-23T22:31:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI0MjI3OA==", "url": "https://github.com/opensearch-project/security/pull/410#discussion_r414242278", "bodyText": "any reason why we are not shutting down this logger context?", "author": "debjanibnrj", "createdAt": "2020-04-24T02:14:04Z", "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/test/helper/cluster/ClusterHelper.java", "diffHunk": "@@ -244,8 +242,6 @@ public final void stopCluster() throws Exception {\n \n     private static void closeNode(Node node) {\n         try {\n-            LoggerContext context = (LoggerContext) LogManager.getContext(false);\n-            Configurator.shutdown(context);", "originalCommit": "41c50d4c2623f87453e095c552c96abafb0416b5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI2MTA5NA==", "url": "https://github.com/opensearch-project/security/pull/410#discussion_r414261094", "bodyText": "The LoggerContext is not cluster specific and it was not created during cluster creation. It must not be shutdown when a node is closed and/or when cluster is stopped. Shutting down LoggerContext may cause a change in Logger levels and missing log messages that may help with troubleshooting unit tests.", "author": "vrozov", "createdAt": "2020-04-24T03:15:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI0MjI3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg1NDE2NA==", "url": "https://github.com/opensearch-project/security/pull/410#discussion_r414854164", "bodyText": "This code is used only by tests . Maybe some tests need this for correct functionality or more verbosity ?\nWhat is the reason for removing this code ? Are there some logs or output missing ?\nDo you have any example of the difference in output \"before/after\" to understand how this change helps ?", "author": "dinusX", "createdAt": "2020-04-24T20:48:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI0MjI3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkyMDE1Ng==", "url": "https://github.com/opensearch-project/security/pull/410#discussion_r414920156", "bodyText": "The code only affects the amount of logging and I would not expect tests to depend on disabling or shutting down logging that makes it less verbose. In addition, the order of tests execution is not defined and one unit test may not rely on another unit test to shutdown the logging context.\nThe easiest way to see the difference is to change cas logger level from error to trace in log4j2-test.properties and run SSLTest or OpenSSLTest (or any other test suite that creates two or more clusters). After the subject code is called, there would be no entries from the cas logger logged.", "author": "vrozov", "createdAt": "2020-04-24T23:39:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI0MjI3OA=="}], "type": "inlineReview"}]}