{"pr_number": 865, "pr_title": "Catch and respond invalid_index_name_exception when an index with invalid name is mentioned", "pr_createdAt": "2020-12-02T04:20:02Z", "pr_url": "https://github.com/opensearch-project/security/pull/865", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMDEwMA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534310100", "bodyText": "Is it necessary to add InvalidIndexNameException to throws?", "author": "vrozov", "createdAt": "2020-12-02T16:34:18Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/privileges/DlsFlsEvaluator.java", "diffHunk": "@@ -67,7 +68,7 @@ public DlsFlsEvaluator(Settings settings, ThreadPool threadPool) {\n     }\n \n     public PrivilegesEvaluatorResponse evaluate(final ActionRequest request, final ClusterService clusterService, final IndexNameExpressionResolver resolver, final Resolved requestedResolved, final User user,\n-                                                final SecurityRoles securityRoles, final PrivilegesEvaluatorResponse presponse) {\n+                                                final SecurityRoles securityRoles, final PrivilegesEvaluatorResponse presponse) throws InvalidIndexNameException {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM4NDMwMw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534384303", "bodyText": "Removed the throws and caught the RuntimeException in OpenDistroSecurityFilter.", "author": "cliu123", "createdAt": "2020-12-02T18:20:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMDEwMA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5ODA3Mg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534398072", "bodyText": "nit: please keep original code style: } catch () { on a single line.", "author": "vrozov", "createdAt": "2020-12-02T18:42:29Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,7 +356,11 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n-        } catch (Throwable e) {\n+        }", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxMjk5NA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534412994", "bodyText": "Done.", "author": "cliu123", "createdAt": "2020-12-02T19:06:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5ODA3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5ODcyMw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534398723", "bodyText": "should it catch ElasticsearchException instead?", "author": "vrozov", "createdAt": "2020-12-02T18:43:37Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,7 +356,11 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n-        } catch (Throwable e) {\n+        }\n+        catch (InvalidIndexNameException err) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxMzEyNw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534413127", "bodyText": "Done.", "author": "cliu123", "createdAt": "2020-12-02T19:06:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5ODcyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5OTE1OQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534399159", "bodyText": "add debug logging of the exception.", "author": "vrozov", "createdAt": "2020-12-02T18:44:22Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,7 +356,11 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n-        } catch (Throwable e) {\n+        }\n+        catch (InvalidIndexNameException err) {\n+            listener.onFailure(err);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxMDI3NQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534410275", "bodyText": "Done.", "author": "cliu123", "createdAt": "2020-12-02T19:01:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5OTE1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534409639", "bodyText": "Can you add a test for the same index name in ticket _##pdt_data ?", "author": "sujithvm", "createdAt": "2020-12-02T19:00:36Z", "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/IndexIntegrationTests.java", "diffHunk": "@@ -473,7 +473,13 @@ public void testCCSIndexResolve() throws Exception {\n \n         res = rh.executeGetRequest(\"/*:.abc-6,.abc-6/_search\", encodeBasicHeader(\"ccsresolv\", \"nagilum\"));\n         Assert.assertEquals(HttpStatus.SC_OK, res.getStatusCode());\n+\n         //TODO: Change for 25.0 to be forbidden (possible bug in ES regarding ccs wildcard)\n+\n+        // invalid_index_name_exception should be thrown and responded when invalid index name is mentioned in requests.\n+        res = rh.executeGetRequest(\"_pdt_data/_search\", encodeBasicHeader(\"ccsresolv\", \"nagilum\"));", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxMjYxMg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534412612", "bodyText": "I tried this, but the # is identified as a fragment and caused  java.lang.IllegalArgumentException: Illegal character in fragment at index.", "author": "cliu123", "createdAt": "2020-12-02T19:05:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUxMDgwNg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534510806", "bodyText": "Was this not the original intention of the ticket? _pdt_data is missing index which is already correctly throwing index not found exception?", "author": "sujithvm", "createdAt": "2020-12-02T22:00:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUyMzQ0OA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534523448", "bodyText": "I agree that this is the particular index name mentioned in the ticket. But ## causes java.net.URISyntaxExceptionat at java.base/java.net.URI.create(URI.java:906). I hope this post helps explain the reason.\nI've changed the index name in the test and added a #.", "author": "cliu123", "createdAt": "2020-12-02T22:26:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzQ3Mw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534547473", "bodyText": "Please check ES behavior without security plugin being installed.", "author": "vrozov", "createdAt": "2020-12-02T23:16:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ2NTM3Mg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r535465372", "bodyText": "Without security plugin being installed, ES behaves in the way that we expect after this fix. It responds invalid_index_name_exception to curl -XGET 'http://localhost:9200/_##pdt_data/_search'.", "author": "cliu123", "createdAt": "2020-12-03T18:10:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkzNDkzNw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r535934937", "bodyText": "Is it possible to add this in the tests?", "author": "sujithvm", "createdAt": "2020-12-04T08:53:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3NzkyMg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536377922", "bodyText": "@sujithvm Like I mentioned in the previous comments, using ## fails the unit test due to java.lang.IllegalArgumentException: Illegal character in fragment at index, which is not related to ES or security plugin.", "author": "cliu123", "createdAt": "2020-12-04T21:03:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM5ODg1MQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536398851", "bodyText": "Applied url encoding to the test. Thanks @sujithvm!", "author": "cliu123", "createdAt": "2020-12-04T21:48:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwOTYzOQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQzMjE5MQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534432191", "bodyText": "Will this log exception? Please provide sample output.", "author": "vrozov", "createdAt": "2020-12-02T19:38:41Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,6 +356,9 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n+        } catch (ElasticsearchException err) {\n+            log.debug(err);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ0NjIxNQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534446215", "bodyText": "Changed it to log exception. The output is: Unexpected exception [_] InvalidIndexNameException[Invalid index name [_], must not start with '_'.] Please let me know if any comments on the exception message.", "author": "cliu123", "createdAt": "2020-12-02T20:02:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQzMjE5MQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0MzM5OA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534543398", "bodyText": "Is this still necessary?", "author": "vrozov", "createdAt": "2020-12-02T23:07:37Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -77,6 +77,7 @@\n import org.elasticsearch.common.util.concurrent.ThreadContext.StoredContext;\n import org.elasticsearch.index.reindex.DeleteByQueryRequest;\n import org.elasticsearch.index.reindex.UpdateByQueryRequest;\n+import org.elasticsearch.indices.InvalidIndexNameException;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU1NzI5MQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534557291", "bodyText": "Removed.", "author": "cliu123", "createdAt": "2020-12-02T23:40:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0MzM5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzEwNQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534547105", "bodyText": "This is an anti-pattern. There is no point to log exception message twice.", "author": "vrozov", "createdAt": "2020-12-02T23:15:18Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,6 +356,9 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n+        } catch (ElasticsearchException err) {\n+            log.error(\"Unexpected exception \"+ err, err);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU1NzE3Nw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534557177", "bodyText": "I followed the existing code style of this line. Does this look better now?", "author": "cliu123", "createdAt": "2020-12-02T23:40:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzEwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU2NTU3NQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534565575", "bodyText": "When logging an exception, it is always better to have stack trace logged as well. It is also necessary to avoid premature string concatenation and rely on place holder instead. I don't think that \"Unexpected\" is the right message here. It is expected for the wrong parameters provided (wrong index name). I also think that logging it at error level is not necessary and debug (or warning) should be sufficient.", "author": "vrozov", "createdAt": "2020-12-03T00:02:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzEwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDczODM5NA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534738394", "bodyText": "Changed the exception logs.", "author": "cliu123", "createdAt": "2020-12-03T06:38:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzEwNQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU5MTg3MQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r534591871", "bodyText": "nit: err -> e", "author": "vrozov", "createdAt": "2020-12-03T01:12:34Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,6 +355,9 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n+        } catch (ElasticsearchException err) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ2OTY3Ng==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r535469676", "bodyText": "Done", "author": "cliu123", "createdAt": "2020-12-03T18:15:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU5MTg3MQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzNzY5NQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536237695", "bodyText": "May task be null?", "author": "vrozov", "createdAt": "2020-12-04T16:51:44Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,6 +355,9 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n+        } catch (ElasticsearchException e) {\n+            log.debug(\"Failed to apply filter. Task id: {} ({}). Action: {}\", task.getId(), task.getDescription(), action, e);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3NzA5OQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536377099", "bodyText": "task is not going to be null here. Otherwise, other usages of task prior to this line in this method would simply complain null pointer exception.", "author": "cliu123", "createdAt": "2020-12-04T21:01:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzNzY5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM5MTYxNA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536391614", "bodyText": "Where previously are we accessing a member of task? null check should be handled in the functions it is passed to", "author": "sujithvm", "createdAt": "2020-12-04T21:31:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzNzY5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQwODYzMg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536408632", "bodyText": "@sujithvm A lot of usages of task in this function, such as here", "author": "cliu123", "createdAt": "2020-12-04T22:00:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzNzY5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQxMzUzNw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536413537", "bodyText": "We are not accessing a member of the object there. Elasticsearch proceed function will handle the null task. Here we are directly accessing a class member task.getId(), task.getDescription()", "author": "sujithvm", "createdAt": "2020-12-04T22:11:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzNzY5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQxNzUyMg==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536417522", "bodyText": "@sujithvm Yes, this is indeed the only place where the members of task are accesses. I've added the null check.", "author": "cliu123", "createdAt": "2020-12-04T22:20:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIzNzY5NQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQyNzY5Ng==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536427696", "bodyText": "Is it possible to create separate test as it is not related to cross cluster search?", "author": "sujithvm", "createdAt": "2020-12-04T22:44:26Z", "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/IndexIntegrationTests.java", "diffHunk": "@@ -473,7 +474,13 @@ public void testCCSIndexResolve() throws Exception {\n \n         res = rh.executeGetRequest(\"/*:.abc-6,.abc-6/_search\", encodeBasicHeader(\"ccsresolv\", \"nagilum\"));\n         Assert.assertEquals(HttpStatus.SC_OK, res.getStatusCode());\n+\n         //TODO: Change for 25.0 to be forbidden (possible bug in ES regarding ccs wildcard)\n+\n+        // invalid_index_name_exception should be thrown and responded when invalid index name is mentioned in requests.\n+        res = rh.executeGetRequest(URLEncoder.encode(\"_##pdt_data/_search\", \"UTF-8\"), encodeBasicHeader(\"ccsresolv\", \"nagilum\"));\n+        Assert.assertEquals(HttpStatus.SC_BAD_REQUEST, res.getStatusCode());\n+        Assert.assertTrue(res.getBody().contains(\"invalid_index_name_exception\"));", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQzMDUwOA==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536430508", "bodyText": "Done", "author": "cliu123", "createdAt": "2020-12-04T22:51:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQyNzY5Ng=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ5MDk1Mw==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536490953", "bodyText": "nit: please follow code style of the file. Even though we don't enforce code style across files in the project, it will be better to keep it the same at least within file/function. In this method } else { should be on the same line as }.", "author": "vrozov", "createdAt": "2020-12-05T03:04:05Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/filter/OpenDistroSecurityFilter.java", "diffHunk": "@@ -355,6 +355,14 @@ public void onFailure(Exception e) {\n                 listener.onFailure(new ElasticsearchSecurityException(err, RestStatus.FORBIDDEN));\n                 return;\n             }\n+        } catch (ElasticsearchException e) {\n+            if (task != null) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ5NDY4NQ==", "url": "https://github.com/opensearch-project/security/pull/865#discussion_r536494685", "bodyText": "Done.", "author": "cliu123", "createdAt": "2020-12-05T03:27:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ5MDk1Mw=="}], "type": "inlineReview"}, {"oid": "e79955c43d7c019b845ea880de8233999b2119c6", "url": "https://github.com/opensearch-project/security/commit/e79955c43d7c019b845ea880de8233999b2119c6", "message": "Catch and respond invalid index name exception when an index with invalid name is mentioned", "committedDate": "2020-12-05T03:26:26Z", "type": "commit"}, {"oid": "e79955c43d7c019b845ea880de8233999b2119c6", "url": "https://github.com/opensearch-project/security/commit/e79955c43d7c019b845ea880de8233999b2119c6", "message": "Catch and respond invalid index name exception when an index with invalid name is mentioned", "committedDate": "2020-12-05T03:26:26Z", "type": "forcePushed"}]}