{"pr_number": 653, "pr_title": "Remove cluster monitor check from audit transport check", "pr_createdAt": "2020-08-19T19:55:13Z", "pr_url": "https://github.com/opensearch-project/security/pull/653", "timeline": [{"oid": "40c7bc1428960d8d30006c53e5b249bfd8a75950", "url": "https://github.com/opensearch-project/security/commit/40c7bc1428960d8d30006c53e5b249bfd8a75950", "message": "Remove cluster monitor check from audit transport check", "committedDate": "2020-08-19T19:53:58Z", "type": "commit"}, {"oid": "1beafcc7623a6c570740ea1b4ff02ecc2ef716c1", "url": "https://github.com/opensearch-project/security/commit/1beafcc7623a6c570740ea1b4ff02ecc2ef716c1", "message": "Fix test", "committedDate": "2020-08-19T20:35:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMyNTUwOQ==", "url": "https://github.com/opensearch-project/security/pull/653#discussion_r473325509", "bodyText": "What are the actions under internal: ?", "author": "hardik-k-shah", "createdAt": "2020-08-19T21:12:43Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -646,19 +646,7 @@ boolean checkTransportFilter(final AuditCategory category, final String action,\n         }\n \n         //skip internals\n-        if(action != null\n-                &&\n-                ( action.startsWith(\"internal:\")\n-                        || action.startsWith(\"cluster:monitor\")\n-                        || action.startsWith(\"indices:monitor\")\n-                )\n-        ) {\n-\n-\n-            //if(log.isTraceEnabled()) {\n-            //    log.trace(\"Skipped audit log message due to category ({}) or action ({}) does not match\", category, action);\n-            //}\n-\n+        if (action != null && action.startsWith(\"internal:\")) {", "originalCommit": "1beafcc7623a6c570740ea1b4ff02ecc2ef716c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ3NzMwMQ==", "url": "https://github.com/opensearch-project/security/pull/653#discussion_r473477301", "bodyText": "Internal actions seem to be used for core ES functionality only and not for user generated actions. Here are some of the internal actions\n\ninternal:coordination/fault_detection/leader_check\ninternal:coordination/fault_detection/follower_check\ninternal:cluster/coordination/join\ninternal:cluster/coordination/join/validate\ninternal:cluster/coordination/start_join\ninternal:cluster/request_pre_vote\ninternal:cluster/coordination/publish_state\ninternal:cluster/coordination/commit_state\ninternal:cluster/node/mapping/refresh\ninternal:cluster/shard/started\ninternal:cluster/shard/failure\ninternal:admin/tasks/ban\ninternal:index/shard/recovery/start_recovery\ninternal:index/shard/recovery/reestablish_recovery\ninternal:index/shard/recovery/filesInfo\ninternal:index/shard/recovery/file_chunk\ninternal:index/shard/recovery/clean_files\ninternal:index/shard/recovery/translog_ops\ninternal:index/shard/recovery/prepare_translog\ninternal:index/shard/recovery/finalize\ninternal:index/shard/recovery/handoff_primary_context\ninternal:index/shard/exists\ninternal:cluster/nodes/indices/shard/store\ninternal:tcp/handshake\ninternal:transport/handshake\ninternal:transport/proxy/\ninternal:cluster/snapshot/update_snapshot_status\ninternal:admin/repository/verify\ninternal:indices/admin/upgrade\ninternal:indices/flush/synced/pre\ninternal:index/seq_no/resync\ninternal:gateway/local/started_shards\ninternal:gateway/local/meta_state\ninternal:gateway/local/allocate_dangled", "author": "sujithvm", "createdAt": "2020-08-20T00:36:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMyNTUwOQ=="}], "type": "inlineReview"}]}