{"pr_number": 470, "pr_title": "SWTBot Fix 3: Improved Workspace Synchronization ", "pr_createdAt": "2020-02-14T13:47:21Z", "pr_url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470", "timeline": [{"oid": "0154f039e1ef6697be01fb6a5a5b527d48b25c79", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/0154f039e1ef6697be01fb6a5a5b527d48b25c79", "message": "Improved Workspace Synchronization - (Task #460)\n\n- Fixed issue with creating new projects not being correctly\nsynchronized with workspace locking.\n- Removed SaveJob since it is not needed anymore.\n- Refactored workspace locked execution in editing domain not to use\ncode from Command Stack anymore. The command stack is checking for a\nsave trigger to be set, and tries to issue a save. Deadlocks may happen\nor race conditions when not correctly setting the save trigger.\n- Improved logging in command stack.\n- Improved save trigger handling in command stack.\n\n---\nTask #460: Try to improve SWTBot stability", "committedDate": "2020-02-14T13:35:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAzNjEyOQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#discussion_r380036129", "bodyText": "Which boolean are we talking about in this comment?", "author": "SaMuellerDLR", "createdAt": "2020-02-17T08:21:26Z", "path": "de.dlr.sc.virsat.project/src/de/dlr/sc/virsat/project/editingDomain/VirSatWorkspaceCommandStack.java", "diffHunk": "@@ -224,20 +227,22 @@ public void setEditingDomain(VirSatTransactionalEditingDomain editingDomain) {\n \t/**\r\n \t * Trigger a save all upon completion of the executing command\r\n \t */\r\n-\tpublic void triggerSaveAll() {\r\n+\tpublic synchronized void triggerSaveAll() {\r\n+\t\tActivator.getDefault().getLog().log(new Status(Status.INFO, Activator.getPluginId(), \"VirSatWorkspaceCommandStack: Save all Triggered by Thread: \" + Thread.currentThread().getName()));\r\n \t\ttriggerSave = true;\r\n \t}\r\n \t\r\n \t/**\r\n \t * Check if the triggerSave flag has been set. If so, ask the editing domain to save everything\r\n \t * and reset the flag.\r\n \t */\r\n-\tprivate void checkTriggerSaveAll() {\r\n+\tprivate synchronized void checkTriggerSaveAll() {\r\n+\t\tActivator.getDefault().getLog().log(new Status(Status.INFO, Activator.getPluginId(), \"VirSatWorkspaceCommandStack: Check for save trigger\"));\r\n \t\tif (triggerSave) {\r\n-\t\t\tActivator.getDefault().getLog().log(new Status(IStatus.INFO, Activator.getPluginId(), \"Executed command triggered save all on editing domain\"));\r\n-\t\t\tVirSatSaveJob saveJob = new VirSatSaveJob(editingDomain, true);\r\n-\t\t\tsaveJob.scheduleIfNoSaveJobPending();\r\n-\t\t\ttriggerSave = false;\r\n+\t\t\tActivator.getDefault().getLog().log(new Status(IStatus.INFO, Activator.getPluginId(), \"VirSatWorkspaceCommandStack: Save tiggered Scheduling Save Job.\"));\r\n+\t\t\t// This boolean has to be reset first, otherwise the save all will be executed in\r", "originalCommit": "0154f039e1ef6697be01fb6a5a5b527d48b25c79", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDE2NzIxNQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#discussion_r380167215", "bodyText": "Has been a deprecated comment. Updated it.", "author": "PhilMFischer", "createdAt": "2020-02-17T12:58:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAzNjEyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUwNTIwOQ==", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/pull/470#discussion_r380505209", "bodyText": "@PhilMFischer I dont see any new commits.", "author": "SaMuellerDLR", "createdAt": "2020-02-18T07:52:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAzNjEyOQ=="}], "type": "inlineReview"}, {"oid": "eb992fd5bfb35ddcf58af78bac6ddda47e35efa9", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/eb992fd5bfb35ddcf58af78bac6ddda47e35efa9", "message": "Merge branch 'development' into feature/task_460-Try_to_improve_SWTBot_III_SaveHandling", "committedDate": "2020-02-17T12:31:38Z", "type": "commit"}, {"oid": "111d36fbd54d183475877365719693a0812ae228", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/111d36fbd54d183475877365719693a0812ae228", "message": "Updated comment due to review - (Task #460)\n\n---\nTask #460: Try to improve SWTBot stability", "committedDate": "2020-02-17T12:54:25Z", "type": "commit"}, {"oid": "0178b11f00dd9fd1085215cf693016104b354811", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/0178b11f00dd9fd1085215cf693016104b354811", "message": "Merge branch 'development' of https://github.com/virtualsatellite/VirtualSatellite4-Core.git into feature/task_460-Try_to_improve_SWTBot_III_SaveHandling", "committedDate": "2020-02-17T12:54:52Z", "type": "commit"}, {"oid": "4bc9e593f3fd4e7270d8bf778040bbec74942bcb", "url": "https://github.com/virtualsatellite/VirtualSatellite4-Core/commit/4bc9e593f3fd4e7270d8bf778040bbec74942bcb", "message": "Merge branch 'feature/task_460-Try_to_improve_SWTBot_III_SaveHandling_Bad' into feature/task_460-Try_to_improve_SWTBot_III_SaveHandling", "committedDate": "2020-02-18T07:56:46Z", "type": "commit"}]}