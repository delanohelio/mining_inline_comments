{"pr_number": 2344, "pr_title": "[JBPM-9529] Business-central REST API is allowing container creation \u2026", "pr_createdAt": "2020-12-18T12:36:15Z", "pr_url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2344", "timeline": [{"oid": "de82dd669e4276c249cabdad834c260125231341", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/de82dd669e4276c249cabdad834c260125231341", "message": "[JBPM-9529] Business-central REST API is allowing container creation with empty container id", "committedDate": "2021-01-07T14:22:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyODQ0Ng==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2344#discussion_r553528446", "bodyText": "Can containerSpec or getID() return a null value?", "author": "adrielparedes", "createdAt": "2021-01-07T19:12:33Z", "path": "kie-server-parent/kie-server-controller/kie-server-controller-impl/src/main/java/org/kie/server/controller/impl/service/SpecManagementServiceImpl.java", "diffHunk": "@@ -58,6 +58,10 @@ public synchronized void saveContainerSpec(String serverTemplateId,\n             throw new KieServerControllerIllegalArgumentException(\"No server template found for id \" + serverTemplateId);\n         }\n \n+        if (containerSpec.getId().isEmpty()) {", "originalCommit": "de82dd669e4276c249cabdad834c260125231341", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzkzNzc1MQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2344#discussion_r553937751", "bodyText": "yes, its possible. Changes done.", "author": "abhijithumbe", "createdAt": "2021-01-08T13:17:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyODQ0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyODgzOQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2344#discussion_r553528839", "bodyText": "Can containerSpec or getID() return a null value?", "author": "adrielparedes", "createdAt": "2021-01-07T19:13:26Z", "path": "kie-server-parent/kie-server-controller/kie-server-controller-impl/src/main/java/org/kie/server/controller/impl/service/SpecManagementServiceImpl.java", "diffHunk": "@@ -94,6 +98,12 @@ public synchronized void updateContainerSpec(String serverTemplateId, String con\n             throw new KieServerControllerIllegalArgumentException(\"No server template found for id \" + serverTemplateId);\n         }\n \n+\n+        if (containerSpec.getId().isEmpty()) {", "originalCommit": "de82dd669e4276c249cabdad834c260125231341", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "40e25a2498df802aa2f0273db106d154102ebcd5", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/40e25a2498df802aa2f0273db106d154102ebcd5", "message": "[JBPM-9529] Business-central REST API is allowing container creation with empty container id", "committedDate": "2021-01-08T13:11:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mzk0MTY0OA==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2344#discussion_r553941648", "bodyText": "In this case if getId() is null it will throw a NPE, you should check if containerSpec.getId()==null before checking getId().isEmpty(). Same in code below. To check what I'm saying add a small test just for null values and you will see that behavior", "author": "adrielparedes", "createdAt": "2021-01-08T13:25:20Z", "path": "kie-server-parent/kie-server-controller/kie-server-controller-impl/src/main/java/org/kie/server/controller/impl/service/SpecManagementServiceImpl.java", "diffHunk": "@@ -58,6 +58,10 @@ public synchronized void saveContainerSpec(String serverTemplateId,\n             throw new KieServerControllerIllegalArgumentException(\"No server template found for id \" + serverTemplateId);\n         }\n \n+        if (containerSpec.getId().isEmpty() || containerSpec.getId()==null ) {", "originalCommit": "40e25a2498df802aa2f0273db106d154102ebcd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mzk3ODc2OQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2344#discussion_r553978769", "bodyText": "Yes, agreed null check should come first.", "author": "abhijithumbe", "createdAt": "2021-01-08T14:36:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mzk0MTY0OA=="}], "type": "inlineReview"}, {"oid": "1e5973d0907e8d94e38319ac1a1382666e264d16", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/1e5973d0907e8d94e38319ac1a1382666e264d16", "message": "[JBPM-9529] Business-central REST API is allowing container creation with empty container id", "committedDate": "2021-01-08T14:31:57Z", "type": "commit"}, {"oid": "1e5973d0907e8d94e38319ac1a1382666e264d16", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/1e5973d0907e8d94e38319ac1a1382666e264d16", "message": "[JBPM-9529] Business-central REST API is allowing container creation with empty container id", "committedDate": "2021-01-08T14:31:57Z", "type": "forcePushed"}]}