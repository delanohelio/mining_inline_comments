{"pr_number": 2287, "pr_title": "[JBPM-9435] /server/state REST endpoint prints kie server user and controller user/password in clear text", "pr_createdAt": "2020-10-19T08:42:17Z", "pr_url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2287", "timeline": [{"oid": "e9954aba64d0000c79482a533fb3ca231d14d601", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/e9954aba64d0000c79482a533fb3ca231d14d601", "message": "[JBPM-9435] /server/state REST endpoint prints kie server user and controller user/password in clear text", "committedDate": "2020-10-19T08:38:19Z", "type": "commit"}, {"oid": "f159fa80d5f21001126af051c948f4f99c343cec", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/f159fa80d5f21001126af051c948f4f99c343cec", "message": "[JBPM-9435] /server/state REST endpoint prints kie server user and controller user/password in clear text", "committedDate": "2020-10-19T08:39:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUyMTEzOQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2287#discussion_r512521139", "bodyText": "It would be safer for avoiding NPE to compare the other way around, though it's not very likely that name is null.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (configItem.getName().equals(KieServerConstants.CFG_KIE_PASSWORD)) {\n          \n          \n            \n                            if (KieServerConstants.CFG_KIE_PASSWORD.equals(configItem.getName())) {", "author": "gmunozfe", "createdAt": "2020-10-27T09:07:37Z", "path": "kie-server-parent/kie-server-services/kie-server-services-common/src/main/java/org/kie/server/services/impl/KieServerImpl.java", "diffHunk": "@@ -1014,8 +1017,29 @@ private void updateExtensions(KieModuleMetaData metadata, KieContainerInstanceIm\n \n     public ServiceResponse<KieServerStateInfo> getServerState() {\n         KieServerStateInfo state = getInternalServerState();\n-        if(state != null) {\n-            return new ServiceResponse<KieServerStateInfo>(ServiceResponse.ResponseType.SUCCESS, \"Successfully loaded server state for server id \" + KieServerEnvironment.getServerId(), state);\n+        if (state != null) {\n+            KieServerConfig kieServerConfig = state.getConfiguration();\n+            List<KieServerConfigItem> kieConfigItems = kieServerConfig.getConfigItems();\n+            ListIterator<KieServerConfigItem> listIterator = kieConfigItems.listIterator();\n+            while (listIterator.hasNext()) {\n+                KieServerConfigItem configItem = listIterator.next();\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_PASSWORD)) {", "originalCommit": "f159fa80d5f21001126af051c948f4f99c343cec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI2ODA5Mg==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2287#discussion_r513268092", "bodyText": "@gmunozfe Thanks you for review. I made suggested changes.", "author": "abhijithumbe", "createdAt": "2020-10-28T08:46:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUyMTEzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUyMTI2NQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2287#discussion_r512521265", "bodyText": "Same here", "author": "gmunozfe", "createdAt": "2020-10-27T09:07:47Z", "path": "kie-server-parent/kie-server-services/kie-server-services-common/src/main/java/org/kie/server/services/impl/KieServerImpl.java", "diffHunk": "@@ -1014,8 +1017,29 @@ private void updateExtensions(KieModuleMetaData metadata, KieContainerInstanceIm\n \n     public ServiceResponse<KieServerStateInfo> getServerState() {\n         KieServerStateInfo state = getInternalServerState();\n-        if(state != null) {\n-            return new ServiceResponse<KieServerStateInfo>(ServiceResponse.ResponseType.SUCCESS, \"Successfully loaded server state for server id \" + KieServerEnvironment.getServerId(), state);\n+        if (state != null) {\n+            KieServerConfig kieServerConfig = state.getConfiguration();\n+            List<KieServerConfigItem> kieConfigItems = kieServerConfig.getConfigItems();\n+            ListIterator<KieServerConfigItem> listIterator = kieConfigItems.listIterator();\n+            while (listIterator.hasNext()) {\n+                KieServerConfigItem configItem = listIterator.next();\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_PASSWORD)) {\n+                    listIterator.remove();\n+                }\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_TOKEN)) {", "originalCommit": "f159fa80d5f21001126af051c948f4f99c343cec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUyMTM1Mg==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2287#discussion_r512521352", "bodyText": "Same here", "author": "gmunozfe", "createdAt": "2020-10-27T09:07:55Z", "path": "kie-server-parent/kie-server-services/kie-server-services-common/src/main/java/org/kie/server/services/impl/KieServerImpl.java", "diffHunk": "@@ -1014,8 +1017,29 @@ private void updateExtensions(KieModuleMetaData metadata, KieContainerInstanceIm\n \n     public ServiceResponse<KieServerStateInfo> getServerState() {\n         KieServerStateInfo state = getInternalServerState();\n-        if(state != null) {\n-            return new ServiceResponse<KieServerStateInfo>(ServiceResponse.ResponseType.SUCCESS, \"Successfully loaded server state for server id \" + KieServerEnvironment.getServerId(), state);\n+        if (state != null) {\n+            KieServerConfig kieServerConfig = state.getConfiguration();\n+            List<KieServerConfigItem> kieConfigItems = kieServerConfig.getConfigItems();\n+            ListIterator<KieServerConfigItem> listIterator = kieConfigItems.listIterator();\n+            while (listIterator.hasNext()) {\n+                KieServerConfigItem configItem = listIterator.next();\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_PASSWORD)) {\n+                    listIterator.remove();\n+                }\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_TOKEN)) {\n+                    listIterator.remove();\n+                }\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_CONTROLLER_PASSWORD)) {", "originalCommit": "f159fa80d5f21001126af051c948f4f99c343cec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUyMTQ0MQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2287#discussion_r512521441", "bodyText": "Same here", "author": "gmunozfe", "createdAt": "2020-10-27T09:08:02Z", "path": "kie-server-parent/kie-server-services/kie-server-services-common/src/main/java/org/kie/server/services/impl/KieServerImpl.java", "diffHunk": "@@ -1014,8 +1017,29 @@ private void updateExtensions(KieModuleMetaData metadata, KieContainerInstanceIm\n \n     public ServiceResponse<KieServerStateInfo> getServerState() {\n         KieServerStateInfo state = getInternalServerState();\n-        if(state != null) {\n-            return new ServiceResponse<KieServerStateInfo>(ServiceResponse.ResponseType.SUCCESS, \"Successfully loaded server state for server id \" + KieServerEnvironment.getServerId(), state);\n+        if (state != null) {\n+            KieServerConfig kieServerConfig = state.getConfiguration();\n+            List<KieServerConfigItem> kieConfigItems = kieServerConfig.getConfigItems();\n+            ListIterator<KieServerConfigItem> listIterator = kieConfigItems.listIterator();\n+            while (listIterator.hasNext()) {\n+                KieServerConfigItem configItem = listIterator.next();\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_PASSWORD)) {\n+                    listIterator.remove();\n+                }\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_TOKEN)) {\n+                    listIterator.remove();\n+                }\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_CONTROLLER_PASSWORD)) {\n+                    listIterator.remove();\n+                }\n+                if (configItem.getName().equals(KieServerConstants.CFG_KIE_CONTROLLER_TOKEN)) {", "originalCommit": "f159fa80d5f21001126af051c948f4f99c343cec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "029389e18b3de70b5e47f52539b0d7bef27e832e", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/029389e18b3de70b5e47f52539b0d7bef27e832e", "message": "[JBPM-9435] /server/state REST endpoint prints kie server user and controller user/password in clear text", "committedDate": "2020-10-28T08:42:11Z", "type": "commit"}]}