{"pr_number": 661, "pr_title": "ovsdb2ddlog: --rw option.", "pr_createdAt": "2020-05-08T20:20:26Z", "pr_url": "https://github.com/vmware/differential-datalog/pull/661", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM1ODQ4MQ==", "url": "https://github.com/vmware/differential-datalog/pull/661#discussion_r422358481", "bodyText": "Since you went to the trouble of defining a type you could probably have defined one with named fields; this would make it easier to read the code. But this is fine, since it's not used that much.", "author": "mbudiu-vmw", "createdAt": "2020-05-08T20:30:46Z", "path": "src/Language/DifferentialDatalog/OVSDB/Compile.hs", "diffHunk": "@@ -85,11 +88,15 @@ data TableKind = TableInput\n                | TableDeltaUpdate\n                deriving(Eq)\n \n+-- | Output relation configuration:\n+-- (name, Left <set_of_readonly_columns> or Right <Set of rw columns>)\n+type OutputRelConfig = (String, Either [String] [String])", "originalCommit": "89457f17ffe7ccc0ed37b24c6f1b5320f1d0398c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM1OTMyMA==", "url": "https://github.com/vmware/differential-datalog/pull/661#discussion_r422359320", "bodyText": "this thing about uuid does not seem to be documented.\nAlso, the name of this function has a negation, it would be nicer if it was GetRWCols instead.", "author": "mbudiu-vmw", "createdAt": "2020-05-08T20:32:49Z", "path": "src/Language/DifferentialDatalog/OVSDB/Compile.hs", "diffHunk": "@@ -306,10 +316,11 @@ uuidCol = TableColumn { columnPos       = nopos\n                       , columnMutable   = Nothing\n                       }\n \n-tableGetNonROCols :: (?outputs::[(String, [String])]) => Table -> [TableColumn]\n+tableGetNonROCols :: (?outputs::[OutputRelConfig]) => Table -> [TableColumn]\n tableGetNonROCols t =\n     case lookup (name t) ?outputs of\n-         Nothing -> ovscols\n-         Just ro -> filter (\\col -> notElem (name col) ro) ovscols\n+         Nothing         -> ovscols\n+         Just (Left ro)  -> filter (\\col -> notElem (name col) ro) ovscols\n+         Just (Right rw) -> filter (\\col -> elem (name col) rw || (name col == \"_uuid\")) ovscols", "originalCommit": "89457f17ffe7ccc0ed37b24c6f1b5320f1d0398c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM2NjU1OA==", "url": "https://github.com/vmware/differential-datalog/pull/661#discussion_r422366558", "bodyText": "this thing about uuid does not seem to be documented.\n\ndone\n\nAlso, the name of this function has a negation, it would be nicer if it was GetRWCols instead.\n\nthere's actually a subtle difference in this case: NonRO means that the column is not labeled as read-only. It can still be read-only if it comes from a read-only table.", "author": "ryzhyk", "createdAt": "2020-05-08T20:48:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM1OTMyMA=="}], "type": "inlineReview"}, {"oid": "28cdc0d01234183d57cb5975eaf343096b71917a", "url": "https://github.com/vmware/differential-datalog/commit/28cdc0d01234183d57cb5975eaf343096b71917a", "message": "ovsdb2ddlog: --rw option.\n\nResolves #659.\n\novsdb2ddlog has a --ro option for tables that are partially read-write.\nOVN has a couple of tables that only have one or two writable columns,\nso it'd be nice to just specify those, e.g. with --rw in place of --ro.\nIt leads to easier maintenance as columns are added.\n\nThis commit introduces --rw option, which is mutually exclusive with\n--ro, i.e., at most one of them can be used for a particular table.", "committedDate": "2020-05-08T20:47:08Z", "type": "commit"}, {"oid": "28cdc0d01234183d57cb5975eaf343096b71917a", "url": "https://github.com/vmware/differential-datalog/commit/28cdc0d01234183d57cb5975eaf343096b71917a", "message": "ovsdb2ddlog: --rw option.\n\nResolves #659.\n\novsdb2ddlog has a --ro option for tables that are partially read-write.\nOVN has a couple of tables that only have one or two writable columns,\nso it'd be nice to just specify those, e.g. with --rw in place of --ro.\nIt leads to easier maintenance as columns are added.\n\nThis commit introduces --rw option, which is mutually exclusive with\n--ro, i.e., at most one of them can be used for a particular table.", "committedDate": "2020-05-08T20:47:08Z", "type": "forcePushed"}]}