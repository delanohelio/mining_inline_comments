{"pr_number": 815, "pr_title": "Windows compatibility.", "pr_createdAt": "2020-11-16T22:42:08Z", "pr_url": "https://github.com/vmware/differential-datalog/pull/815", "timeline": [{"oid": "93968ad644bba115fdc664e2a62b1523490aaee3", "url": "https://github.com/vmware/differential-datalog/commit/93968ad644bba115fdc664e2a62b1523490aaee3", "message": "stack.yml: Upgrade to LTS 16.21.", "committedDate": "2020-11-15T06:32:09Z", "type": "commit"}, {"oid": "cc84748f4bf2bbac471d0c634c5c29bd1875141d", "url": "https://github.com/vmware/differential-datalog/commit/cc84748f4bf2bbac471d0c634c5c29bd1875141d", "message": "Fix warnings by GHC 8.10.2.\n\nI tried the latest nightly GHC, which reports a bunch of new warnings.\nThis commit fixes the warnings.", "committedDate": "2020-11-15T06:32:17Z", "type": "commit"}, {"oid": "3c388bb31c2198fc52c66738122fcc7698957069", "url": "https://github.com/vmware/differential-datalog/commit/3c388bb31c2198fc52c66738122fcc7698957069", "message": "Eliminate the use of MissingH.\n\nThe 'MissingH' package that we relies on for string splitting and\nreplacement depends on 'regex-posix', which does not compile on Windows\n(it can be made to work theoretically, but not worth the effort).  We\nget rid of all uses of 'MissingH' with the help of the 'splitOn'\nfunction from the 'split' package.", "committedDate": "2020-11-15T18:21:51Z", "type": "commit"}, {"oid": "751cd8f7871b414387676b26d2f107bab6be1d0a", "url": "https://github.com/vmware/differential-datalog/commit/751cd8f7871b414387676b26d2f107bab6be1d0a", "message": ".travis.yml: Comment out Python-related commands.\n\nWe are no longer running Souffle tests in Travis.  Comment out\nPython-related stuff to simplify and speedup Travis build.", "committedDate": "2020-11-15T19:33:14Z", "type": "commit"}, {"oid": "fdf4dde6bee0a618a189aadf940d1559bb6b9c25", "url": "https://github.com/vmware/differential-datalog/commit/fdf4dde6bee0a618a189aadf940d1559bb6b9c25", "message": "Windows build on Travis; compatibility fixes.\n\nFixup the test framework and the compiler to deal with the stupidity of\nWindows.", "committedDate": "2020-11-16T22:36:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc3MDEzOA==", "url": "https://github.com/vmware/differential-datalog/pull/815#discussion_r524770138", "bodyText": "is this a bug?", "author": "mbudiu-vmw", "createdAt": "2020-11-16T23:50:25Z", "path": "tools/install-flatbuf.sh", "diffHunk": "@@ -7,20 +7,34 @@ retry() {\n   $cmd || (sleep 2 && $cmd) || (sleep 10 && $cmd)\n }\n \n-fetch_flatbuf() {\n+fetch_flatbuf_unix() {\n     rm -rf flatbuffers\n     mkdir flatbuffers\n     curl -L https://github.com/google/flatbuffers/archive/v1.11.0.tar.gz | tar -zx -C flatbuffers --strip-components 1\n }\n \n+fetch_flatbuf_windows() {\n+    curl -L https://github.com/google/flatbuffers/releases/download/v1.11.0/flatc_windows_exe.zip > fb.zip && unzip fb.zip\n+}\n+\n+echo \"Installing Flatbuf\"\n if [ \"x`flatbuffers/flatc --version`\" != \"xflatc version 1.11.0\" ]; then\n-    echo \"Installing Flatbuf\"\n-    retry fetch_flatbuf\n-    cd flatbuffers\n-    cmake -G \"Unix Makefiles\"\n-    make\n-    cd ..\n+    if ( [ \"$(uname)\" = \"Darwin\" ] || [ \"$(uname)\" = \"Linux\" ] ); then\n+        retry fetch_flatbuf_unix\n+        cd flatbuffers\n+        cmake -G \"Unix Makefiles\"\n+        make\n+        cd ..\n+    else\n+        retry fetch_flatbuf_unix", "originalCommit": "fdf4dde6bee0a618a189aadf940d1559bb6b9c25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDgxMDE4MQ==", "url": "https://github.com/vmware/differential-datalog/pull/815#discussion_r524810181", "bodyText": "Just bad naming.", "author": "ryzhyk", "createdAt": "2020-11-17T00:41:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc3MDEzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc3MDU0Mw==", "url": "https://github.com/vmware/differential-datalog/pull/815#discussion_r524770543", "bodyText": "windows comes with curl?", "author": "mbudiu-vmw", "createdAt": "2020-11-16T23:50:47Z", "path": "tools/install-flatbuf.sh", "diffHunk": "@@ -7,20 +7,34 @@ retry() {\n   $cmd || (sleep 2 && $cmd) || (sleep 10 && $cmd)\n }\n \n-fetch_flatbuf() {\n+fetch_flatbuf_unix() {\n     rm -rf flatbuffers\n     mkdir flatbuffers\n     curl -L https://github.com/google/flatbuffers/archive/v1.11.0.tar.gz | tar -zx -C flatbuffers --strip-components 1\n }\n \n+fetch_flatbuf_windows() {\n+    curl -L https://github.com/google/flatbuffers/releases/download/v1.11.0/flatc_windows_exe.zip > fb.zip && unzip fb.zip", "originalCommit": "fdf4dde6bee0a618a189aadf940d1559bb6b9c25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDgxMDY0Ng==", "url": "https://github.com/vmware/differential-datalog/pull/815#discussion_r524810646", "bodyText": "Travis runs CI script in an environment that does. This is probably not going to work on all flavors of windows.", "author": "ryzhyk", "createdAt": "2020-11-17T00:43:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc3MDU0Mw=="}], "type": "inlineReview"}]}