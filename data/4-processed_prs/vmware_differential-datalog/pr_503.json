{"pr_number": 503, "pr_title": "CI and build_java fixes (see commit comments).", "pr_createdAt": "2020-01-24T21:13:18Z", "pr_url": "https://github.com/vmware/differential-datalog/pull/503", "timeline": [{"oid": "baea528128c62d80c264dbb49946e89135215759", "url": "https://github.com/vmware/differential-datalog/commit/baea528128c62d80c264dbb49946e89135215759", "message": "Dockerfile: install maven.\n\nRequired to build the SQL frontend.", "committedDate": "2020-01-24T18:42:18Z", "type": "commit"}, {"oid": "a1be259e5d73c1702bec5dff6da52ec074449d7c", "url": "https://github.com/vmware/differential-datalog/commit/a1be259e5d73c1702bec5dff6da52ec074449d7c", "message": "build_java.sh: Pass -std=gnu11 to CC.\n\nOlder versions of gcc default to older C standards that do not support\nthe `_Thread_local` attribute, causing compiler to fail on ddlogapi.c.", "committedDate": "2020-01-24T20:12:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg0NDkyNw==", "url": "https://github.com/vmware/differential-datalog/pull/503#discussion_r370844927", "bodyText": "are we using gnu specific extensions?\nwhy not just -std=c11?", "author": "mbudiu-vmw", "createdAt": "2020-01-24T21:14:33Z", "path": "java/build_java.sh", "diffHunk": "@@ -57,7 +57,7 @@ function compile {\n     # Compile Java program\n     javac -encoding utf8 -Xlint:unchecked ${JAVAPROG}\n     # Create a shared library containing all the native code: ddlogapi.c, ${DLPROG}_ddlog.a\n-    ${CC} -shared -fPIC -I${JAVA_HOME}/include -I${JAVA_HOME}/include/${JDK_OS} -I${DLDIR}/${DLPROG}_ddlog -I../../lib ../ddlogapi.c -L${DLDIR}/${DLPROG}_ddlog/target/${BUILD}/ -l${DLPROG}_ddlog -o libddlogapi.${SHLIBEXT}\n+    ${CC} -std=gnu11 -shared -fPIC -I${JAVA_HOME}/include -I${JAVA_HOME}/include/${JDK_OS} -I${DLDIR}/${DLPROG}_ddlog -I../../lib ../ddlogapi.c -L${DLDIR}/${DLPROG}_ddlog/target/${BUILD}/ -l${DLPROG}_ddlog -o libddlogapi.${SHLIBEXT}", "originalCommit": "a1be259e5d73c1702bec5dff6da52ec074449d7c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg0ODkyMQ==", "url": "https://github.com/vmware/differential-datalog/pull/503#discussion_r370848921", "bodyText": "We use strdup, which, as it turns out, is not part of the standard C library and requires GNU extensions.", "author": "ryzhyk", "createdAt": "2020-01-24T21:24:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg0NDkyNw=="}], "type": "inlineReview"}]}