{"pr_number": 832, "pr_title": "Removed excessive indirections from function pointers", "pr_createdAt": "2020-11-30T18:16:38Z", "pr_url": "https://github.com/vmware/differential-datalog/pull/832", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532816064", "bodyText": "This will conflict with the workspace code you added to Compile.hs earlier.  We actually used to have this section here some time ago, but ended up removing it.  I believe the reason was that cargo complained when adding a dependency on the generated Rust project from external crates, as it does not like seeing workspaces anywhere other than in the main crate.\nAlso, this breaks CI build.", "author": "ryzhyk", "createdAt": "2020-11-30T18:39:29Z", "path": "Cargo.toml", "diffHunk": "@@ -0,0 +1,9 @@\n+[workspace]\n+members = [", "originalCommit": "82333a540467af296614e63238ea84e6349b044d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg0Njk0Ng==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532846946", "bodyText": "It shouldn't conflict with the Compile.hs code since generated code should be out-of-tree except in the case of tests, and I may be able to fix those errors by adding exclude = [\"test/*\"] to the root Cargo.toml.\nI personally really want this since it's such a massive QOL improvement (before I had to open rust/template in another dir in order to get things working), and I've even had someone comment to me that they wish this repo had a root file so they could get ide errors", "author": "Kixiron", "createdAt": "2020-11-30T19:31:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg1MTMxNQ==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532851315", "bodyText": "Ok, let's work on the workspace thing then, but I think it can be a separate PR.  I like the other things you did here and would like to merge, but I feel like doing workspaces properly may take some more time.", "author": "ryzhyk", "createdAt": "2020-11-30T19:39:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg1MjA4NA==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532852084", "bodyText": "It shouldn't conflict with the Compile.hs code since generated code should be out-of-tree except in the case of tests, and I may be able to fix those errors by adding exclude = [\"test/*\"] to the root Cargo.toml.\n\nYes, but the generated code will then contain two workspace sections, won't it?", "author": "ryzhyk", "createdAt": "2020-11-30T19:40:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg1ODA4OQ==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532858089", "bodyText": "It won't since this Cargo.toml only affects the source directory of differential-datalog itself, while the generated code (generally elsewhere) has its own, separate workspace", "author": "Kixiron", "createdAt": "2020-11-30T19:49:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg2NTQ2OA==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532865468", "bodyText": "My bad, I only now realized this is a separate .toml. In that case I have no objections as long as we can fix the CI.", "author": "ryzhyk", "createdAt": "2020-11-30T19:55:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjg3MDczMw==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r532870733", "bodyText": "You were indeed correct and it was trickier than I anticipated, so I'll do it separately", "author": "Kixiron", "createdAt": "2020-11-30T20:05:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNjA2NA=="}], "type": "inlineReview"}, {"oid": "7afeab4e7369d31432649622d00745ca92ba0b23", "url": "https://github.com/vmware/differential-datalog/commit/7afeab4e7369d31432649622d00745ca92ba0b23", "message": "Removed excessive indirections from function pointers", "committedDate": "2020-11-30T20:04:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzYwMjc2NA==", "url": "https://github.com/vmware/differential-datalog/pull/832#discussion_r533602764", "bodyText": "Can you please undo this change too?  It upsets older rustc. I have a backwards compatible fix in an upcoming PR.\nOther than this the PR looks great.", "author": "ryzhyk", "createdAt": "2020-12-01T17:44:29Z", "path": "rust/template/distributed_datalog/src/lib.rs", "diffHunk": "@@ -5,7 +5,7 @@\n     future_incompatible,\n     illegal_floating_point_literal_pattern,\n     improper_ctypes,\n-    intra_doc_link_resolution_failure,\n+    broken_intra_doc_links,", "originalCommit": "7afeab4e7369d31432649622d00745ca92ba0b23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f5184d08919869d4b48b677f91b98dbc81d87d41", "url": "https://github.com/vmware/differential-datalog/commit/f5184d08919869d4b48b677f91b98dbc81d87d41", "message": "Removed excessive indirections from function pointers", "committedDate": "2020-12-01T18:49:37Z", "type": "commit"}, {"oid": "f5184d08919869d4b48b677f91b98dbc81d87d41", "url": "https://github.com/vmware/differential-datalog/commit/f5184d08919869d4b48b677f91b98dbc81d87d41", "message": "Removed excessive indirections from function pointers", "committedDate": "2020-12-01T18:49:37Z", "type": "forcePushed"}]}