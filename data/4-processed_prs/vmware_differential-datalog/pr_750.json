{"pr_number": 750, "pr_title": "Allow running rustfmt and generating only Rust flatbuffers bindings", "pr_createdAt": "2020-08-24T22:31:46Z", "pr_url": "https://github.com/vmware/differential-datalog/pull/750", "timeline": [{"oid": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "url": "https://github.com/vmware/differential-datalog/commit/4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "message": "Added option for generating only rust flatbuffers bindings and option to run rustfmt on generated code", "committedDate": "2020-08-24T22:31:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3NjE0NA==", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r475976144", "bodyText": "Just FYI: rustfmt can take many minutes on large generated files.", "author": "ryzhyk", "createdAt": "2020-08-24T23:54:09Z", "path": "app/Main.hs", "diffHunk": "@@ -63,6 +63,8 @@ data TOption = Help\n              | ReValidate\n              | OmitProfile\n              | OmitWorkspace\n+             | RunRustfmt", "originalCommit": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjA2NDMxOQ==", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r476064319", "bodyText": "Definitely, it's just a nice option to provide", "author": "Kixiron", "createdAt": "2020-08-25T02:07:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3NjE0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3OTI2Ng==", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r475979266", "bodyText": "Does this need to be exported?", "author": "ryzhyk", "createdAt": "2020-08-24T23:58:40Z", "path": "src/Language/DifferentialDatalog/FlatBuffer.hs", "diffHunk": "@@ -60,9 +60,11 @@ TODO: Generated Java code structure:\n \n {-# LANGUAGE RecordWildCards, FlexibleContexts, LambdaCase, OverloadedStrings, ImplicitParams, TemplateHaskell #-}\n \n-module Language.DifferentialDatalog.FlatBuffer(\n-    flatBufferValidate,\n-    compileFlatBufferBindings)\n+module Language.DifferentialDatalog.FlatBuffer\n+  ( flatBufferValidate,\n+    compileFlatBufferBindings,\n+    compileFlatBufferRustBindings,", "originalCommit": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjA1ODkyNw==", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r476058927", "bodyText": "It was actually used in a previous iteration and I forgot to change it back, my bad!", "author": "Kixiron", "createdAt": "2020-08-25T01:58:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3OTI2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjA1NjYwNw==", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r476056607", "bodyText": "We should probably also update the --java option description to specify that it implies --rust-flatbuffers.", "author": "ryzhyk", "createdAt": "2020-08-25T01:55:12Z", "path": "app/Main.hs", "diffHunk": "@@ -86,6 +88,8 @@ options = [ Option ['h'] [\"help\"]             (NoArg Help)\n           , Option []    [\"re-validate\"]      (NoArg ReValidate)                \"[developers only] Re-validate the program after type inference and optimization passes.\"\n           , Option []    [\"omit-profile\"]     (NoArg OmitProfile)               \"Skips adding a Cargo profile (silences warnings for some rust builds, included by default)\"\n           , Option []    [\"omit-workspace\"]   (NoArg OmitWorkspace)             \"Skips adding a Cargo workspace (silences errors for some rust builds, included by default)\"\n+          , Option []    [\"run-rustfmt\"]      (NoArg RunRustfmt)                \"Attempts to run rustfmt on the generated code after it's emitted\"\n+          , Option []    [\"rust-flatbuffers\"] (NoArg RustFlatBuffers)           \"Builds flatbuffers bindings for Rust\"", "originalCommit": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "411ba90fb91a488c431d638ae952350afb827e3b", "url": "https://github.com/vmware/differential-datalog/commit/411ba90fb91a488c431d638ae952350afb827e3b", "message": "Removed redundant export", "committedDate": "2020-08-25T01:59:33Z", "type": "commit"}, {"oid": "63b2f03564bc06b7895b60e9ee86a1fffc4d2386", "url": "https://github.com/vmware/differential-datalog/commit/63b2f03564bc06b7895b60e9ee86a1fffc4d2386", "message": "Improved --java cli description", "committedDate": "2020-08-25T02:07:36Z", "type": "commit"}]}