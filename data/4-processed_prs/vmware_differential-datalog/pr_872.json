{"pr_number": 872, "pr_title": "Split tuples, arrays and the C API off from the records file and refactored them", "pr_createdAt": "2020-12-17T19:32:54Z", "pr_url": "https://github.com/vmware/differential-datalog/pull/872", "timeline": [{"oid": "39fed97998e778593dee433e7a965e8b649c230d", "url": "https://github.com/vmware/differential-datalog/commit/39fed97998e778593dee433e7a965e8b649c230d", "message": "Split tuples, arrays and the C API off from the records file and refactored them", "committedDate": "2020-12-17T21:00:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQ0NzMwNg==", "url": "https://github.com/vmware/differential-datalog/pull/872#discussion_r546447306", "bodyText": "This requires Rust 1.48 (https://doc.rust-lang.org/std/primitive.array.html#impl-TryFrom%3CVec%3CT%3E%3E).\nI will roll this back to the old implementation.", "author": "ryzhyk", "createdAt": "2020-12-20T22:46:14Z", "path": "rust/template/differential_datalog/record/arrays.rs", "diffHunk": "@@ -0,0 +1,44 @@\n+//! Implementing `Record`-related traits for Rust arrays\n+\n+use crate::record::{CollectionKind, FromRecord, IntoRecord, Mutator, Record};\n+use std::convert::TryInto;\n+\n+/// Implements `FromRecord`, `IntoRecord` and `Mutator` for arrays\n+// FIXME: Replace this with `min_const_generics` after Rust v1.50\n+//        https://github.com/rust-lang/rust/issues/74878\n+macro_rules! ddlog_array_traits {\n+    ($($length:literal),* $(,)?) => {\n+        $(\n+            impl<T: FromRecord> FromRecord for [T; $length] {\n+                fn from_record(val: &Record) -> Result<Self, String> {\n+                    Vec::from_record(val)?.try_into().map_err(|_| {", "originalCommit": "39fed97998e778593dee433e7a965e8b649c230d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f7dcc30d405fbdcf62e3917cef6af3e2f2966e01", "url": "https://github.com/vmware/differential-datalog/commit/f7dcc30d405fbdcf62e3917cef6af3e2f2966e01", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one.", "committedDate": "2020-12-21T01:14:02Z", "type": "forcePushed"}, {"oid": "e476cac44cf9c80a603791e72b7d2e376e8cbf53", "url": "https://github.com/vmware/differential-datalog/commit/e476cac44cf9c80a603791e72b7d2e376e8cbf53", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one.", "committedDate": "2020-12-22T07:07:06Z", "type": "forcePushed"}, {"oid": "625c3e6e3d9743af816a932060c860205823f505", "url": "https://github.com/vmware/differential-datalog/commit/625c3e6e3d9743af816a932060c860205823f505", "message": "Split tuples, arrays and the C API off from the records file and refactored them", "committedDate": "2020-12-22T20:08:20Z", "type": "commit"}, {"oid": "b18c6f36f93c4f16ff90b8507fc8ccd2befa4fbb", "url": "https://github.com/vmware/differential-datalog/commit/b18c6f36f93c4f16ff90b8507fc8ccd2befa4fbb", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one.", "committedDate": "2020-12-22T20:08:20Z", "type": "commit"}, {"oid": "05a471ebd99892688b564bc8ac7d59161f91a238", "url": "https://github.com/vmware/differential-datalog/commit/05a471ebd99892688b564bc8ac7d59161f91a238", "message": "Move record::c_api back in the main record module.\n\nAfter `record.rs` was split into multiple modules, the C API disappeared\nfrom the compiled .so library.  This is likely due to this compiler bug:\nhttps://github.com/rust-lang/rust/issues/50007\n\nAs a workaround until the bug is fixed, we move the API from `record/c_api.rs`\nto `record/mod.rs`.", "committedDate": "2020-12-22T20:24:18Z", "type": "commit"}, {"oid": "05a471ebd99892688b564bc8ac7d59161f91a238", "url": "https://github.com/vmware/differential-datalog/commit/05a471ebd99892688b564bc8ac7d59161f91a238", "message": "Move record::c_api back in the main record module.\n\nAfter `record.rs` was split into multiple modules, the C API disappeared\nfrom the compiled .so library.  This is likely due to this compiler bug:\nhttps://github.com/rust-lang/rust/issues/50007\n\nAs a workaround until the bug is fixed, we move the API from `record/c_api.rs`\nto `record/mod.rs`.", "committedDate": "2020-12-22T20:24:18Z", "type": "forcePushed"}]}