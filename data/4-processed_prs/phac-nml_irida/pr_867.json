{"pr_number": 867, "pr_title": "Announcements upgrade admin edit & details forms", "pr_createdAt": "2020-11-20T22:01:34Z", "pr_url": "https://github.com/phac-nml/irida/pull/867", "timeline": [{"oid": "a656593a69ac5979595a0f7ab6953cb46160f412", "url": "https://github.com/phac-nml/irida/commit/a656593a69ac5979595a0f7ab6953cb46160f412", "message": "starting to make changes to the edit announcement modal", "committedDate": "2020-11-20T22:00:15Z", "type": "commit"}, {"oid": "6054a01a700dbfdb186e39857d96fd78fe185c54", "url": "https://github.com/phac-nml/irida/commit/6054a01a700dbfdb186e39857d96fd78fe185c54", "message": "fixing tests", "committedDate": "2020-11-23T16:02:15Z", "type": "commit"}, {"oid": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c", "url": "https://github.com/phac-nml/irida/commit/4c19e9dab02c69c91db0a7a0ab4be8d331b8868c", "message": "updating the details page to add new title and priority", "committedDate": "2020-11-23T16:17:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MjI4Nw==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528842287", "bodyText": "Sorry, I'm going to take this opportunity to ask a couple questions. I noticed there are these variables with underscores. Is this Thymeleaf pre-processing?", "author": "ksierks", "createdAt": "2020-11-23T16:38:37Z", "path": "src/main/webapp/pages/announcements/details.html", "diffHunk": "@@ -27,11 +27,27 @@\n                     <h2 class=\"panel-title\" th:text=\"#{announcement.control.details.edit}\"></h2>\n                 </div>\n                 <div class=\"panel-body\">\n-                    <textarea class=\"form-control input-full announcement-input\" type=\"text\" id=\"message\" name=\"message\"\n+                    <div class=\"form-group\">\n+                        <label for=\"title\" th:text=\"#{announcement.control.title}\">__Title__</label>", "originalCommit": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg4MDM1OA==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528880358", "bodyText": "Do you mean the __Title__?  If so that is just me making sure that I do not forget to template them because they look ugly on the page.  Just placeholders.", "author": "joshsadam", "createdAt": "2020-11-23T17:35:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MjI4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg5MDMzNg==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528890336", "bodyText": "Ya, it exists for the cancel and save buttons too.", "author": "ksierks", "createdAt": "2020-11-23T17:51:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MjI4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg5MTY0NA==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528891644", "bodyText": "Yup that is me trying to remind myself not to be forgetful and to add the translations", "author": "joshsadam", "createdAt": "2020-11-23T17:53:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MjI4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MzA2NA==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528843064", "bodyText": "I am trying to keep this page's look and feel consistent, but I have not been able to find the 'input-full' class in the css.", "author": "ksierks", "createdAt": "2020-11-23T16:39:36Z", "path": "src/main/webapp/pages/announcements/details.html", "diffHunk": "@@ -27,11 +27,27 @@\n                     <h2 class=\"panel-title\" th:text=\"#{announcement.control.details.edit}\"></h2>\n                 </div>\n                 <div class=\"panel-body\">\n-                    <textarea class=\"form-control input-full announcement-input\" type=\"text\" id=\"message\" name=\"message\"\n+                    <div class=\"form-group\">\n+                        <label for=\"title\" th:text=\"#{announcement.control.title}\">__Title__</label>\n+                        <input id=\"title\" name=\"title\" type=\"text\"\n+                               class=\"form-control input-full\"\n+                               required=\"required\"\n+                               th:value=\"${announcement.getTitle()}\"\n+                               th:placeholder=\"#{announcement.create.form.placeholder}\" />\n+                    </div>\n+                    <div class=\"form-group\">\n+                        <label for=\"message\" th:text=\"#{announcement.control.message}\">__Message__</label>\n+                        <textarea class=\"form-control input-full announcement-input\" type=\"text\" id=\"message\" name=\"message\"", "originalCommit": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg4MDY3Mg==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528880672", "bodyText": "Well this brings me to my next point.  We need to get rid of this page :)  Let's chat about it.", "author": "joshsadam", "createdAt": "2020-11-23T17:35:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MzA2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTUzNjEyMw==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r529536123", "bodyText": "Okies!", "author": "ksierks", "createdAt": "2020-11-24T13:15:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MzA2NA=="}], "type": "inlineReview"}, {"oid": "4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5", "url": "https://github.com/phac-nml/irida/commit/4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5", "message": "fixing checkbox to defaultChecked", "committedDate": "2020-11-23T16:42:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg4MjQ1Nw==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528882457", "bodyText": "Since this is almost exactly the same as the CreateAnnouncementModal do you think you could refactor to use only one?", "author": "joshsadam", "createdAt": "2020-11-23T17:38:49Z", "path": "src/main/webapp/resources/js/pages/admin/components/announcements/EditAnnouncementModal.jsx", "diffHunk": "@@ -0,0 +1,84 @@\n+import React, { useRef } from \"react\";\n+import { Checkbox, Form, Input, Modal, Space } from \"antd\";\n+import { IconEdit } from \"../../../../components/icons/Icons\";\n+import { FONT_COLOR_PRIMARY } from \"../../../../styles/fonts\";\n+import { MarkdownEditor } from \"../../../../components/markdown/MarkdownEditor\";\n+", "originalCommit": "4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg5MDQ0Nw==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528890447", "bodyText": "Yes. Please see 009862e.", "author": "ksierks", "createdAt": "2020-11-23T17:51:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg4MjQ1Nw=="}], "type": "inlineReview"}, {"oid": "f9c2e7bdb58b19ac7cdcd2dcac654afe4be0e5cf", "url": "https://github.com/phac-nml/irida/commit/f9c2e7bdb58b19ac7cdcd2dcac654afe4be0e5cf", "message": "fixing checkbox and adding missing updates", "committedDate": "2020-11-23T19:15:02Z", "type": "commit"}, {"oid": "009862e53c90db858ad04f9e173c94b034948137", "url": "https://github.com/phac-nml/irida/commit/009862e53c90db858ad04f9e173c94b034948137", "message": "deciding whether refactoring the modal this way makes sense", "committedDate": "2020-11-23T22:43:45Z", "type": "commit"}, {"oid": "f1a74c62c67a1605397aa823087fd8d998c2c306", "url": "https://github.com/phac-nml/irida/commit/f1a74c62c67a1605397aa823087fd8d998c2c306", "message": "undo mistake", "committedDate": "2020-11-23T22:45:57Z", "type": "commit"}, {"oid": "8566243558a6b1847a50561525c6e29a5baf932f", "url": "https://github.com/phac-nml/irida/commit/8566243558a6b1847a50561525c6e29a5baf932f", "message": "updating documentation", "committedDate": "2020-11-24T13:19:02Z", "type": "commit"}, {"oid": "5897b4c13964eae65b317cb9193c6ff2c5e19af5", "url": "https://github.com/phac-nml/irida/commit/5897b4c13964eae65b317cb9193c6ff2c5e19af5", "message": "adding missing message property", "committedDate": "2020-11-24T19:09:57Z", "type": "commit"}, {"oid": "18e9c90ca0dfa67b10f0d5ffaf1305edd5ae5dbd", "url": "https://github.com/phac-nml/irida/commit/18e9c90ca0dfa67b10f0d5ffaf1305edd5ae5dbd", "message": "adding some error handling", "committedDate": "2020-11-27T20:31:56Z", "type": "commit"}, {"oid": "6af0b76923b58311e23decbf635e85b0991eff32", "url": "https://github.com/phac-nml/irida/commit/6af0b76923b58311e23decbf635e85b0991eff32", "message": "putting className back for ok button so submit new announcement tests pass again", "committedDate": "2020-11-27T23:15:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTgwOTE0Ng==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r529809146", "bodyText": "In es6 there is a destructuring syntax for this:\nconst { title, priority } = values;\nor, since you only use those values you can do that right up in the function arguments:\nform.validateFields().then(({ title, priority }) => {\n\t// ...\n});", "author": "joshsadam", "createdAt": "2020-11-24T18:59:08Z", "path": "src/main/webapp/resources/js/pages/admin/components/announcements/AnnouncementModal.jsx", "diffHunk": "@@ -31,9 +35,18 @@ export function CreateAnnouncementModal({\n       const title = values.title;\n       const priority = values.priority;", "originalCommit": "8566243558a6b1847a50561525c6e29a5baf932f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTgxMTEyOA==", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r529811128", "bodyText": "In es6 you never have to do this redundant assignment of object attributes, in this case since title and priority are already defined (and are labelled correct) you could write this as:\nupdateAnnouncement({\n  id: announcement.id,\n  title,\n  message: markdown,\n  priority,\n});\n``", "author": "joshsadam", "createdAt": "2020-11-24T19:02:20Z", "path": "src/main/webapp/resources/js/pages/admin/components/announcements/AnnouncementModal.jsx", "diffHunk": "@@ -31,9 +35,18 @@ export function CreateAnnouncementModal({\n       const title = values.title;\n       const priority = values.priority;\n \n-      createAnnouncement(title, markdown, priority);\n+      if (announcement) {\n+        updateAnnouncement({\n+          id: announcement.id,\n+          title: title,\n+          message: markdown,\n+          priority: priority,\n+        });", "originalCommit": "8566243558a6b1847a50561525c6e29a5baf932f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}