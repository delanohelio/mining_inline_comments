{"pr_number": 873, "pr_title": "Add reference file upload progress", "pr_createdAt": "2020-11-26T19:17:04Z", "pr_url": "https://github.com/phac-nml/irida/pull/873", "timeline": [{"oid": "459c4137e766a27257096a3730bdf2f139686a0b", "url": "https://github.com/phac-nml/irida/commit/459c4137e766a27257096a3730bdf2f139686a0b", "message": "Added progress display for reference file uploads", "committedDate": "2020-11-26T19:15:09Z", "type": "commit"}, {"oid": "a4d3b1c35c0f1e2342e759883fc5358f70282996", "url": "https://github.com/phac-nml/irida/commit/a4d3b1c35c0f1e2342e759883fc5358f70282996", "message": "Merge branch 'development' into add-reference-file-upload-progress", "committedDate": "2020-11-26T19:16:17Z", "type": "commit"}, {"oid": "da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0", "url": "https://github.com/phac-nml/irida/commit/da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0", "message": "Updated CHANGELOG", "committedDate": "2020-11-27T15:00:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMzY4Mw==", "url": "https://github.com/phac-nml/irida/pull/873#discussion_r531703683", "bodyText": "When using await keep to the syntax you like (this is probably how I have been doing it and it is not exactly correct.  Keep the way I have seen you write it, it is much more elegant.  Also, I learned recently that instead of throwing a new error, just return a rejected promise:\nexport async function uploadProjectReferenceFiles(projectId, formData, config) {\n  try {\n    const { data } = await axios.post(\n      setBaseUrl(`ajax/reference-files/project/${projectId}`),\n      formData,\n      config\n    );\n    return data;\n  } catch (e) {\n    return Promise.reject(error.response.data.error);\n  }\n}\nYou can then handle this the same way:\nuploadProjectReferenceFiles(projectId, formData, config)\n  .then(console.log)\n  .catch(console.error);   \nYou should start freaking out on me when I don't do it this way!", "author": "joshsadam", "createdAt": "2020-11-27T17:09:40Z", "path": "src/main/webapp/resources/js/apis/projects/reference-files.js", "diffHunk": "@@ -41,3 +41,23 @@ export async function removeProjectReferenceFile(projectId, fileId) {\n       throw new Error(error.response.data.error);\n     });\n }\n+\n+/**\n+ * Remove the reference file from the project id provided\n+ * @param {projectId} project for which to remove reference file from\n+ * @param {formData} List of files to upload\n+ * @param config Configuration options for upload\n+ * @return {Promise<*>} `data` contains the OK response; `error` contains error information if an error occurred.\n+ */\n+export async function uploadProjectReferenceFiles(projectId, formData, config) {\n+  return await axios\n+    .post(\n+      setBaseUrl(`ajax/reference-files/project/${projectId}`),\n+      formData,\n+      config\n+    )\n+    .then(({ data }) => data)\n+    .catch((error) => {\n+      throw new Error(error.response.data.error);\n+    });", "originalCommit": "da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwNjAyMw==", "url": "https://github.com/phac-nml/irida/pull/873#discussion_r531706023", "bodyText": "Thanks. Yeah I've found myself flip flopping on it too. Oh for sure!", "author": "deepsidhu85", "createdAt": "2020-11-27T17:16:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMzY4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTc0MjA2MA==", "url": "https://github.com/phac-nml/irida/pull/873#discussion_r531742060", "bodyText": "Updated in 496e774", "author": "deepsidhu85", "createdAt": "2020-11-27T19:35:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMzY4Mw=="}], "type": "inlineReview"}, {"oid": "496e77453248495380b0e3afe0eea9b5031b7f33", "url": "https://github.com/phac-nml/irida/commit/496e77453248495380b0e3afe0eea9b5031b7f33", "message": "Updated api call to return a promise.reject instead of throwing new error. Fixed console warnings", "committedDate": "2020-11-27T19:34:34Z", "type": "commit"}, {"oid": "40847b22cc8e70680c848ce10e51587a905a9cc6", "url": "https://github.com/phac-nml/irida/commit/40847b22cc8e70680c848ce10e51587a905a9cc6", "message": "Merged dev and fixed merge conflicts", "committedDate": "2020-11-30T20:51:08Z", "type": "commit"}, {"oid": "813160d548918d2c31ea8c7722f6d928262fb2ca", "url": "https://github.com/phac-nml/irida/commit/813160d548918d2c31ea8c7722f6d928262fb2ca", "message": "Removed custom progress bar and updated progress to show percentage as whole number", "committedDate": "2020-12-01T16:42:57Z", "type": "commit"}, {"oid": "41c5ae0e4ab17dd402a7bed30fa54897758cdb5a", "url": "https://github.com/phac-nml/irida/commit/41c5ae0e4ab17dd402a7bed30fa54897758cdb5a", "message": "Upload list is hidden once uploads are completed or errored", "committedDate": "2020-12-01T20:40:26Z", "type": "commit"}]}