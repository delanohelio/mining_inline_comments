{"pr_number": 824, "pr_title": "Admin Stats UI", "pr_createdAt": "2020-10-08T18:02:41Z", "pr_url": "https://github.com/phac-nml/irida/pull/824", "timeline": [{"oid": "e96fa4e0b25402d3f12f750d03646601afa45f8d", "url": "https://github.com/phac-nml/irida/commit/e96fa4e0b25402d3f12f750d03646601afa45f8d", "message": "Added statistics page with test data for charts", "committedDate": "2020-09-25T17:10:44Z", "type": "commit"}, {"oid": "d78c9c24bd4d22c48011c1f6bb384f6aa3eae66b", "url": "https://github.com/phac-nml/irida/commit/d78c9c24bd4d22c48011c1f6bb384f6aa3eae66b", "message": "Setup the ui for basic statistics and advanced statistics. Added dtos which will be required to send stats data to the ui", "committedDate": "2020-09-30T20:55:59Z", "type": "commit"}, {"oid": "e33646faa7c998bea5e7b2d59b2353c7b8053eab", "url": "https://github.com/phac-nml/irida/commit/e33646faa7c998bea5e7b2d59b2353c7b8053eab", "message": "Refactored code and created constants for statisticTypes and chartTypes. Fixed bug with time period select not defaulting to default time period when a different stat type was viewer", "committedDate": "2020-10-01T16:54:58Z", "type": "commit"}, {"oid": "d50fd90cecace4821e13db39ff2e1d2c90e8fda2", "url": "https://github.com/phac-nml/irida/commit/d50fd90cecace4821e13db39ff2e1d2c90e8fda2", "message": "Merge branch 'admin-statistics/_base' into admin-panel-statistics", "committedDate": "2020-10-02T15:56:43Z", "type": "commit"}, {"oid": "48b9a69cc829a5590073d0a84460bf960ef25745", "url": "https://github.com/phac-nml/irida/commit/48b9a69cc829a5590073d0a84460bf960ef25745", "message": "Removed commented out code, fake data, and removed services from controller", "committedDate": "2020-10-08T14:27:31Z", "type": "commit"}, {"oid": "d0bb4e7accc672aaef6fd75c75d48b184ac5d379", "url": "https://github.com/phac-nml/irida/commit/d0bb4e7accc672aaef6fd75c75d48b184ac5d379", "message": "Merged dev into branch and fixed merge conflicts. Updated BasicStats react component to get basic stats from the adminstatisticscontext", "committedDate": "2020-10-08T15:07:45Z", "type": "commit"}, {"oid": "e5aad97784a388d339785b45facd822113f38db8", "url": "https://github.com/phac-nml/irida/commit/e5aad97784a388d339785b45facd822113f38db8", "message": "Removed Row and Cols and replaced with flex. Added Users Created Statististics", "committedDate": "2020-10-08T17:17:48Z", "type": "commit"}, {"oid": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "url": "https://github.com/phac-nml/irida/commit/4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "message": "Removed dtos not used. Added missing function to context", "committedDate": "2020-10-08T18:11:49Z", "type": "commit"}, {"oid": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "url": "https://github.com/phac-nml/irida/commit/d013a64c4bbff49f15a22e1b73cd95521b88a51b", "message": "Merge branch 'development' into admin-statistics/_ui", "committedDate": "2020-10-08T20:00:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMTg2NA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501921864", "bodyText": "Why scoping to the session?", "author": "joshsadam", "createdAt": "2020-10-08T18:17:54Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@Scope(\"session\")", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NTk0Mw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502465943", "bodyText": "Removed in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:27:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMTg2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMjc1Mw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501922753", "bodyText": "Wouldn't a better URL scheme be top level /ajax/statistics and then every level below would be the specific one (e.g. /projects for /ajax/statistics/projects)?\n``", "author": "joshsadam", "createdAt": "2020-10-08T18:19:24Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@Scope(\"session\")\n+@RequestMapping(\"/ajax/admin\")", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjA0Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466047", "bodyText": "Yup updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:27:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyMjc1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNDcxNw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501924717", "bodyText": "This translation will be in the next PR?", "author": "joshsadam", "createdAt": "2020-10-08T18:22:43Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@Scope(\"session\")\n+@RequestMapping(\"/ajax/admin\")\n+public class AdminStatisticsAjaxController {\n+\n+\t@Autowired\n+\tpublic AdminStatisticsAjaxController() {\n+\t}\n+\n+\t/**\n+\t * Get usage statistics for projects, samples, analyses, and users\n+\t * for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve usage stats for\n+\t * @return dto with usage stats\n+\t */\n+\t@RequestMapping(value = \"/statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved statistics on load\");\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for projects for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated project usage stats for\n+\t * @return dto with updated project usage stats\n+\t */\n+\t@RequestMapping(value = \"/project-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminProjectStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for projects created in the last \" + timePeriod);\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for users for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated user usage stats for\n+\t * @return dto with updated user usage stats\n+\t */\n+\t@RequestMapping(value = \"/user-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminUserStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for users logged in the last \" + timePeriod);\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for analyses for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated analyses usage stats for\n+\t * @return dto with updated analyses usage stats\n+\t */\n+\t@RequestMapping(value = \"/analyses-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminAnalysesStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for analyses run in the last \" + timePeriod);\n+\t}\n+\n+\t/**\n+\t * Get updated usage statistics for samples for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve updated sample usage stats for\n+\t * @return dto with updated sample usage stats\n+\t */\n+\t@RequestMapping(value = \"/sample-statistics\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminSampleStatistics(Long timePeriod) {\n+\t\treturn ResponseEntity.ok(\"Retrieved stats for samples created in the last \" + timePeriod);", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjI2OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466268", "bodyText": "The translations will be added once all the branches are merged in for the statistics", "author": "deepsidhu85", "createdAt": "2020-10-09T14:27:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNDcxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNTU5Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501925597", "bodyText": "Just pondering. \u00a0Wouldn't it be better to get the message (error.response.data) and then throw that in a new Error so it can be caught by the caller?", "author": "joshsadam", "createdAt": "2020-10-08T18:24:09Z", "path": "src/main/webapp/resources/js/apis/admin/admin.js", "diffHunk": "@@ -0,0 +1,74 @@\n+import { setBaseUrl } from \"../../utilities/url-utilities\";\n+import axios from \"axios\";\n+\n+const ADMIN_URL = setBaseUrl(`/ajax/admin`);\n+\n+/*\n+ * Get all the statistics for the admin panel\n+ * @return {Promise<*>} `data` contains the OK response and the details map;\n+ *                      `error` contains error information if an error occurred.\n+ */\n+export async function getAdminStatistics() {\n+  try {\n+    const { data } = await axios.get(`${ADMIN_URL}/statistics`);\n+    return data;\n+  }  catch (error) {\n+    return { error };", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjQ3OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466478", "bodyText": "I was going to deal with the error stuff in another branch but its been updated here ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:28:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNTU5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNzA3Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501927077", "bodyText": "I don't think this actually works does it? \u00a0You are returning the error which I think at this point is the response, not the message. \u00a0See my previous comment on throwing a new error.", "author": "joshsadam", "createdAt": "2020-10-08T18:26:38Z", "path": "src/main/webapp/resources/js/contexts/AdminStatisticsContext.js", "diffHunk": "@@ -0,0 +1,196 @@\n+/*\n+ * This file gets the usage statistics and sets the global state\n+ * for the admin statistics page\n+ */\n+\n+import React, { useEffect, useState } from \"react\";\n+import { notification } from \"antd\";\n+import {\n+  getAdminStatistics,\n+  getUpdatedAdminAnalysesStatistics,\n+  getUpdatedAdminProjectStatistics,\n+  getUpdatedAdminSampleStatistics,\n+  getUpdatedAdminUserStatistics\n+} from \"../apis/admin/admin\";\n+\n+export const timePeriodMap = {\n+  1: \"day\",\n+  7: \"week\",\n+  14: \"2 weeks\",\n+  30: \"month\",\n+  90: \"quarter\",\n+  365: \"year\",\n+  730: \"2 years\",\n+  1825: \"5 years\",\n+  3650: \"10 years\"\n+};\n+\n+export const chartTypes = {\n+  BAR: \"bar\",\n+  COLUMN: \"column\",\n+  DONUT: \"donut\",\n+  LINE: \"line\",\n+  PIE: \"pie\"\n+}\n+\n+export const statisticTypes = {\n+  ANALYSES: \"analyses\",\n+  PROJECTS: \"projects\",\n+  SAMPLES: \"samples\",\n+  USERS: \"users\"\n+}\n+\n+// Default is to display statistics for the last week\n+export const defaultTimePeriod = 7;\n+\n+export const defaultChartType = chartTypes.BAR;\n+\n+const initialContext = {\n+  statistics: {\n+    analysesStats: [{}],\n+    projectStats: [{}],\n+    sampleStats: [{}],\n+    userStats: [{}]\n+  },\n+  basicStats : {\n+    analysesRun: 0,\n+    projectsCreated: 0,\n+    samplesCreated: 0,\n+    usersCreated: 0,\n+    usersLoggedIn: 0\n+  }\n+};\n+\n+const AdminStatisticsContext = React.createContext(initialContext);\n+\n+function AdminStatisticsProvider(props) {\n+  const [adminStatisticsContext, setAdminStatisticsContext] = useState(initialContext);\n+\n+  // Get basic usage stats for the time period\n+  useEffect(() => {\n+    getAdminStatistics(defaultTimePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjU1Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466557", "bodyText": "Updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:28:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNzA3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNzY4NQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r501927685", "bodyText": "Formatting! \u00a0Why would you do this!!!!", "author": "joshsadam", "createdAt": "2020-10-08T18:27:31Z", "path": "src/main/webapp/resources/js/contexts/AdminStatisticsContext.js", "diffHunk": "@@ -0,0 +1,196 @@\n+/*\n+ * This file gets the usage statistics and sets the global state\n+ * for the admin statistics page\n+ */\n+\n+import React, { useEffect, useState } from \"react\";\n+import { notification } from \"antd\";\n+import {\n+  getAdminStatistics,\n+  getUpdatedAdminAnalysesStatistics,\n+  getUpdatedAdminProjectStatistics,\n+  getUpdatedAdminSampleStatistics,\n+  getUpdatedAdminUserStatistics\n+} from \"../apis/admin/admin\";\n+\n+export const timePeriodMap = {\n+  1: \"day\",\n+  7: \"week\",\n+  14: \"2 weeks\",\n+  30: \"month\",\n+  90: \"quarter\",\n+  365: \"year\",\n+  730: \"2 years\",\n+  1825: \"5 years\",\n+  3650: \"10 years\"\n+};\n+\n+export const chartTypes = {\n+  BAR: \"bar\",\n+  COLUMN: \"column\",\n+  DONUT: \"donut\",\n+  LINE: \"line\",\n+  PIE: \"pie\"\n+}\n+\n+export const statisticTypes = {\n+  ANALYSES: \"analyses\",\n+  PROJECTS: \"projects\",\n+  SAMPLES: \"samples\",\n+  USERS: \"users\"\n+}\n+\n+// Default is to display statistics for the last week\n+export const defaultTimePeriod = 7;\n+\n+export const defaultChartType = chartTypes.BAR;\n+\n+const initialContext = {\n+  statistics: {\n+    analysesStats: [{}],\n+    projectStats: [{}],\n+    sampleStats: [{}],\n+    userStats: [{}]\n+  },\n+  basicStats : {\n+    analysesRun: 0,\n+    projectsCreated: 0,\n+    samplesCreated: 0,\n+    usersCreated: 0,\n+    usersLoggedIn: 0\n+  }\n+};\n+\n+const AdminStatisticsContext = React.createContext(initialContext);\n+\n+function AdminStatisticsProvider(props) {\n+  const [adminStatisticsContext, setAdminStatisticsContext] = useState(initialContext);\n+\n+  // Get basic usage stats for the time period\n+  useEffect(() => {\n+    getAdminStatistics(defaultTimePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }, []);\n+\n+  // Get updated project usage stats for the selected time period\n+  function updateProjectStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminProjectStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated user usage stats for the selected time period\n+  function updateUserStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminUserStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated analyses usage stats for the selected time period\n+  function updateAnalysesStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminAnalysesStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated sample usage stats for the selected time period\n+  function updateSampleStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminSampleStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  /*\n+   * Gets the config required for the chart\n+   * @param chartType - The type of chart (bar, column, line, or pie)\n+   * @param data - The data for the chart\n+   * @param statsType - The type of statistics (projects, analyses, samples, users)\n+   * @param timePeriod - The time period for the statistics\n+   */\n+  function getChartConfig(chartType, statsType, timePeriod)\n+  {", "originalCommit": "4735d7d6d72d1e49f5b658fa0cc996e170f3ebf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2Njk0Mg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502466942", "bodyText": "I totally missed that. Probably \"accidentally\" hit the ENTER key :)", "author": "deepsidhu85", "createdAt": "2020-10-09T14:28:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNzY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzA4OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502467088", "bodyText": "Fixed in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:29:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkyNzY4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjMzODg3Ng==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502338876", "bodyText": "Don't leave XML entries with empty bodies in React", "author": "joshsadam", "createdAt": "2020-10-09T10:35:18Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/AdvancedStatistics.jsx", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * This file renders the Advanced Statistics component\n+ * which displays statistics in charts\n+ */\n+\n+import React, { useContext, useEffect, useState } from \"react\";\n+import { Bar, Column, Donut, Line, Pie } from \"@ant-design/charts\";\n+import { Form } from \"antd\";\n+import { TimePeriodSelect } from \"./TimePeriodSelect\";\n+import {\n+  AdminStatisticsContext,\n+  defaultTimePeriod,\n+  defaultChartType,\n+  chartTypes,\n+  statisticTypes\n+} from \"../../../../contexts/AdminStatisticsContext\";\n+import { SPACE_LG } from \"../../../../styles/spacing\";\n+import { ChartTypeButtons } from \"./ChartTypeButtons\";\n+\n+export default function AdvancedStatistics({statType}) {\n+\n+  const {\n+    updateAnalysesStatsTimePeriod,\n+    updateProjectStatsTimePeriod,\n+    updateSampleStatsTimePeriod,\n+    updateUserStatsTimePeriod,\n+    getChartConfig\n+  } = useContext(AdminStatisticsContext);\n+\n+  const [timePeriod, setTimePeriod] = useState(defaultTimePeriod);\n+  const [chartType, setChartType] = useState(defaultChartType);\n+  const [form] = Form.useForm();\n+\n+  useEffect(() => {\n+    setChartType(defaultChartType);\n+    setTimePeriod(defaultTimePeriod);\n+    form.setFieldsValue({\n+      \"time-period\": defaultTimePeriod,\n+    });\n+  }, [statType]);\n+\n+  function updateTimePeriod(currTimePeriod) {\n+    if(statType === statisticTypes.ANALYSES) {\n+      updateAnalysesStatsTimePeriod(timePeriod);\n+    } else if (statType === statisticTypes.PROJECTS) {\n+      updateProjectStatsTimePeriod(timePeriod);\n+    } else if (statType === statisticTypes.SAMPLES) {\n+      updateSampleStatsTimePeriod(timePeriod)\n+    } else if (statType === statisticTypes.USERS) {\n+      updateUserStatsTimePeriod(timePeriod);\n+    }\n+    setTimePeriod(currTimePeriod);\n+  }\n+\n+  function displayChart() {\n+    if(chartType === chartTypes.BAR) {\n+      return <Bar {...getChartConfig(chartType, statType, timePeriod)} ></Bar>;", "originalCommit": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzQyNw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502467427", "bodyText": "Updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:29:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjMzODg3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM2MzAzNQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502363035", "bodyText": "This whole function could probably be simplified to be:\nconst components = {\n    [chartTypes.BAR]: Bar,\n    [chartTypes.COLUMN]: Column,\n    [chartTypes.LINE]: Line,\n    [chartTypes.PIE]: Pie,\n    [chartTypes.DONUT]: Donut,\n  };\n\n  function displayChart() {\n    const Component = components[chartType];\n    return Component ? (\n      <Component {...getChartConfig(chartType, statType, timePeriod)} />\n    ) : null;\n  }", "author": "joshsadam", "createdAt": "2020-10-09T11:26:57Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/AdvancedStatistics.jsx", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * This file renders the Advanced Statistics component\n+ * which displays statistics in charts\n+ */\n+\n+import React, { useContext, useEffect, useState } from \"react\";\n+import { Bar, Column, Donut, Line, Pie } from \"@ant-design/charts\";\n+import { Form } from \"antd\";\n+import { TimePeriodSelect } from \"./TimePeriodSelect\";\n+import {\n+  AdminStatisticsContext,\n+  defaultTimePeriod,\n+  defaultChartType,\n+  chartTypes,\n+  statisticTypes\n+} from \"../../../../contexts/AdminStatisticsContext\";\n+import { SPACE_LG } from \"../../../../styles/spacing\";\n+import { ChartTypeButtons } from \"./ChartTypeButtons\";\n+\n+export default function AdvancedStatistics({statType}) {\n+\n+  const {\n+    updateAnalysesStatsTimePeriod,\n+    updateProjectStatsTimePeriod,\n+    updateSampleStatsTimePeriod,\n+    updateUserStatsTimePeriod,\n+    getChartConfig\n+  } = useContext(AdminStatisticsContext);\n+\n+  const [timePeriod, setTimePeriod] = useState(defaultTimePeriod);\n+  const [chartType, setChartType] = useState(defaultChartType);\n+  const [form] = Form.useForm();\n+\n+  useEffect(() => {\n+    setChartType(defaultChartType);\n+    setTimePeriod(defaultTimePeriod);\n+    form.setFieldsValue({\n+      \"time-period\": defaultTimePeriod,\n+    });\n+  }, [statType]);\n+\n+  function updateTimePeriod(currTimePeriod) {\n+    if(statType === statisticTypes.ANALYSES) {\n+      updateAnalysesStatsTimePeriod(timePeriod);\n+    } else if (statType === statisticTypes.PROJECTS) {\n+      updateProjectStatsTimePeriod(timePeriod);\n+    } else if (statType === statisticTypes.SAMPLES) {\n+      updateSampleStatsTimePeriod(timePeriod)\n+    } else if (statType === statisticTypes.USERS) {\n+      updateUserStatsTimePeriod(timePeriod);\n+    }\n+    setTimePeriod(currTimePeriod);\n+  }\n+\n+  function displayChart() {\n+    if(chartType === chartTypes.BAR) {\n+      return <Bar {...getChartConfig(chartType, statType, timePeriod)} ></Bar>;\n+    } else if (chartType === chartTypes.COLUMN) {\n+      return <Column {...getChartConfig(chartType, statType, timePeriod)} ></Column>;\n+    } else if (chartType === chartTypes.LINE) {\n+      return <Line {...getChartConfig(chartType, statType, timePeriod)} ></Line>;\n+    } else if (chartType === chartTypes.PIE) {\n+      return <Pie {...getChartConfig(chartType, statType, timePeriod)} ></Pie>;\n+    } else if (chartType === chartTypes.DONUT) {\n+      return <Donut {...getChartConfig(chartType, statType, timePeriod)}  />\n+    } else {\n+      return null;\n+    }", "originalCommit": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzMxNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502467314", "bodyText": "Updated in ff7ec15. Learned something new in the process :)", "author": "deepsidhu85", "createdAt": "2020-10-09T14:29:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM2MzAzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM2ODMzNw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502368337", "bodyText": "This is already \"truthy\". \u00a0If you want to force it you could also do `visible: Boolean(data)`", "author": "joshsadam", "createdAt": "2020-10-09T11:38:52Z", "path": "src/main/webapp/resources/js/contexts/AdminStatisticsContext.js", "diffHunk": "@@ -0,0 +1,196 @@\n+/*\n+ * This file gets the usage statistics and sets the global state\n+ * for the admin statistics page\n+ */\n+\n+import React, { useEffect, useState } from \"react\";\n+import { notification } from \"antd\";\n+import {\n+  getAdminStatistics,\n+  getUpdatedAdminAnalysesStatistics,\n+  getUpdatedAdminProjectStatistics,\n+  getUpdatedAdminSampleStatistics,\n+  getUpdatedAdminUserStatistics\n+} from \"../apis/admin/admin\";\n+\n+export const timePeriodMap = {\n+  1: \"day\",\n+  7: \"week\",\n+  14: \"2 weeks\",\n+  30: \"month\",\n+  90: \"quarter\",\n+  365: \"year\",\n+  730: \"2 years\",\n+  1825: \"5 years\",\n+  3650: \"10 years\"\n+};\n+\n+export const chartTypes = {\n+  BAR: \"bar\",\n+  COLUMN: \"column\",\n+  DONUT: \"donut\",\n+  LINE: \"line\",\n+  PIE: \"pie\"\n+}\n+\n+export const statisticTypes = {\n+  ANALYSES: \"analyses\",\n+  PROJECTS: \"projects\",\n+  SAMPLES: \"samples\",\n+  USERS: \"users\"\n+}\n+\n+// Default is to display statistics for the last week\n+export const defaultTimePeriod = 7;\n+\n+export const defaultChartType = chartTypes.BAR;\n+\n+const initialContext = {\n+  statistics: {\n+    analysesStats: [{}],\n+    projectStats: [{}],\n+    sampleStats: [{}],\n+    userStats: [{}]\n+  },\n+  basicStats : {\n+    analysesRun: 0,\n+    projectsCreated: 0,\n+    samplesCreated: 0,\n+    usersCreated: 0,\n+    usersLoggedIn: 0\n+  }\n+};\n+\n+const AdminStatisticsContext = React.createContext(initialContext);\n+\n+function AdminStatisticsProvider(props) {\n+  const [adminStatisticsContext, setAdminStatisticsContext] = useState(initialContext);\n+\n+  // Get basic usage stats for the time period\n+  useEffect(() => {\n+    getAdminStatistics(defaultTimePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }, []);\n+\n+  // Get updated project usage stats for the selected time period\n+  function updateProjectStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminProjectStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated user usage stats for the selected time period\n+  function updateUserStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminUserStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated analyses usage stats for the selected time period\n+  function updateAnalysesStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminAnalysesStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated sample usage stats for the selected time period\n+  function updateSampleStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminSampleStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  /*\n+   * Gets the config required for the chart\n+   * @param chartType - The type of chart (bar, column, line, or pie)\n+   * @param data - The data for the chart\n+   * @param statsType - The type of statistics (projects, analyses, samples, users)\n+   * @param timePeriod - The time period for the statistics\n+   */\n+  function getChartConfig(chartType, statsType, timePeriod)\n+  {\n+    let data = null;\n+    const timePeriodText = timePeriodMap[timePeriod];\n+    const isBarChartType = chartType === chartTypes.BAR;\n+    const isPieDonutChartType = chartType === chartTypes.DONUT || chartType === chartTypes.PIE;\n+\n+    let chartTitle = \"\";\n+    let chartAxisAlias = \"\";\n+\n+    if(statsType === statisticTypes.ANALYSES) {\n+      chartTitle = `Number of analyses run in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Analyses';\n+    } else if (statsType === statisticTypes.PROJECTS) {\n+      chartTitle = `Number of projects created in past ${timePeriodText}`;\n+      chartAxisAlias ='# of Projects';\n+    } else if (statsType === statisticTypes.SAMPLES)\n+    {\n+      chartTitle = `Number of samples created in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Samples';\n+    } else if (statsType === statisticTypes.USERS) {\n+      chartTitle =`Number of users created in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Users';\n+    }\n+\n+\n+    // The configuration required to display a chart\n+    const chartConfig = {\n+      title: { visible: true, text: chartTitle },\n+      forceFit: true,\n+      data: data !== null  ? data : [{key:\"\", value:\"\"}],\n+      padding: 'auto',\n+      xField: isBarChartType ? 'value' : 'key',\n+      yField: isBarChartType ? 'key' : 'value',\n+      meta: { key: { alias: 'Time Period' }, value: { alias: chartAxisAlias } },\n+      angleField:\"value\",\n+      label: {\n+        visible: data !== null ? (isPieDonutChartType ? false : true) : false,\n+        position: isBarChartType ? 'right' : 'middle',\n+        adjustColor: true,\n+        style: { fill: '#0D0E68', fontSize: 12, fontWeight: 600, opacity: 0.3 },\n+      },\n+      colorField: \"key\",\n+      legend: {\n+        visible: data !== null ? true : false,", "originalCommit": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzUwNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502467504", "bodyText": "Updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:29:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM2ODMzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM2OTgyNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502369824", "bodyText": "This could be simplified as: `data: data || [{key:\"\", value:\"\"}],`", "author": "joshsadam", "createdAt": "2020-10-09T11:42:11Z", "path": "src/main/webapp/resources/js/contexts/AdminStatisticsContext.js", "diffHunk": "@@ -0,0 +1,196 @@\n+/*\n+ * This file gets the usage statistics and sets the global state\n+ * for the admin statistics page\n+ */\n+\n+import React, { useEffect, useState } from \"react\";\n+import { notification } from \"antd\";\n+import {\n+  getAdminStatistics,\n+  getUpdatedAdminAnalysesStatistics,\n+  getUpdatedAdminProjectStatistics,\n+  getUpdatedAdminSampleStatistics,\n+  getUpdatedAdminUserStatistics\n+} from \"../apis/admin/admin\";\n+\n+export const timePeriodMap = {\n+  1: \"day\",\n+  7: \"week\",\n+  14: \"2 weeks\",\n+  30: \"month\",\n+  90: \"quarter\",\n+  365: \"year\",\n+  730: \"2 years\",\n+  1825: \"5 years\",\n+  3650: \"10 years\"\n+};\n+\n+export const chartTypes = {\n+  BAR: \"bar\",\n+  COLUMN: \"column\",\n+  DONUT: \"donut\",\n+  LINE: \"line\",\n+  PIE: \"pie\"\n+}\n+\n+export const statisticTypes = {\n+  ANALYSES: \"analyses\",\n+  PROJECTS: \"projects\",\n+  SAMPLES: \"samples\",\n+  USERS: \"users\"\n+}\n+\n+// Default is to display statistics for the last week\n+export const defaultTimePeriod = 7;\n+\n+export const defaultChartType = chartTypes.BAR;\n+\n+const initialContext = {\n+  statistics: {\n+    analysesStats: [{}],\n+    projectStats: [{}],\n+    sampleStats: [{}],\n+    userStats: [{}]\n+  },\n+  basicStats : {\n+    analysesRun: 0,\n+    projectsCreated: 0,\n+    samplesCreated: 0,\n+    usersCreated: 0,\n+    usersLoggedIn: 0\n+  }\n+};\n+\n+const AdminStatisticsContext = React.createContext(initialContext);\n+\n+function AdminStatisticsProvider(props) {\n+  const [adminStatisticsContext, setAdminStatisticsContext] = useState(initialContext);\n+\n+  // Get basic usage stats for the time period\n+  useEffect(() => {\n+    getAdminStatistics(defaultTimePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }, []);\n+\n+  // Get updated project usage stats for the selected time period\n+  function updateProjectStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminProjectStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated user usage stats for the selected time period\n+  function updateUserStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminUserStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated analyses usage stats for the selected time period\n+  function updateAnalysesStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminAnalysesStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated sample usage stats for the selected time period\n+  function updateSampleStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminSampleStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  /*\n+   * Gets the config required for the chart\n+   * @param chartType - The type of chart (bar, column, line, or pie)\n+   * @param data - The data for the chart\n+   * @param statsType - The type of statistics (projects, analyses, samples, users)\n+   * @param timePeriod - The time period for the statistics\n+   */\n+  function getChartConfig(chartType, statsType, timePeriod)\n+  {\n+    let data = null;\n+    const timePeriodText = timePeriodMap[timePeriod];\n+    const isBarChartType = chartType === chartTypes.BAR;\n+    const isPieDonutChartType = chartType === chartTypes.DONUT || chartType === chartTypes.PIE;\n+\n+    let chartTitle = \"\";\n+    let chartAxisAlias = \"\";\n+\n+    if(statsType === statisticTypes.ANALYSES) {\n+      chartTitle = `Number of analyses run in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Analyses';\n+    } else if (statsType === statisticTypes.PROJECTS) {\n+      chartTitle = `Number of projects created in past ${timePeriodText}`;\n+      chartAxisAlias ='# of Projects';\n+    } else if (statsType === statisticTypes.SAMPLES)\n+    {\n+      chartTitle = `Number of samples created in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Samples';\n+    } else if (statsType === statisticTypes.USERS) {\n+      chartTitle =`Number of users created in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Users';\n+    }\n+\n+\n+    // The configuration required to display a chart\n+    const chartConfig = {\n+      title: { visible: true, text: chartTitle },\n+      forceFit: true,\n+      data: data !== null  ? data : [{key:\"\", value:\"\"}],", "originalCommit": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzU2OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502467568", "bodyText": "Updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:29:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM2OTgyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MTY0Ng==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502381646", "bodyText": "I really don't like so many ternary statements, we are starting to see lots of this because we have so many complex objects. \u00a0I think a better way to handle this, and to make it easier to read would be:\nimport merge from \"lodash/merge\";\n\nfunction getChartConfig(chartType, statsType, timePeriod) {\n    let data = null;\n    const timePeriodText = timePeriodMap[timePeriod];\n\n    let title = \"\";\n    let chartAxisAlias = \"\";\n\n    const custom = {\n      [chartTypes.BAR]: {\n        xField: \"value\",\n        yField: \"key\",\n        label: {\n          position: \"right\",\n        },\n      },\n      [chartTypes.DONUT]: {\n        visible: false,\n      },\n      [chartTypes.PIE]: {\n        visible: false,\n      },\n      [chartTypes.COLUMN]: {},\n      [chartTypes.LINE]: {},\n    };\n\n    if (statsType === statisticTypes.ANALYSES) {\n      title = `Number of analyses run in past ${timePeriodText}`;\n      chartAxisAlias = \"# of Analyses\";\n    } else if (statsType === statisticTypes.PROJECTS) {\n      title = `Number of projects created in past ${timePeriodText}`;\n      chartAxisAlias = \"# of Projects\";\n    } else if (statsType === statisticTypes.SAMPLES) {\n      title = `Number of samples created in past ${timePeriodText}`;\n      chartAxisAlias = \"# of Samples\";\n    } else if (statsType === statisticTypes.USERS) {\n      title = `Number of users created in past ${timePeriodText}`;\n      chartAxisAlias = \"# of Users\";\n    }\n\n    const config = {\n      title: { visible: true, title },\n      forceFit: true,\n      data: data || [{ key: \"\", value: \"\" }],\n      padding: \"auto\",\n      xField: \"key\",\n      yField: \"value\",\n      meta: { key: { alias: \"Time Period\" }, value: { alias: chartAxisAlias } },\n      angleField: \"value\",\n      label: {\n        visible: Boolean(data),\n        position: \"middle\",\n        adjustColor: true,\n        style: { fill: \"#0D0E68\", fontSize: 12, fontWeight: 600, opacity: 0.3 },\n      },\n      colorField: \"key\",\n      legend: {\n        visible: Boolean(data),\n        position: \"bottom-center\",\n      },\n      statistic: {\n        visible: Boolean(data),\n        content: {\n          value: \"\",\n          name: \"\",\n        },\n      },\n    };\n\n    return merge(config, [custom[chartType]]);\n}", "author": "joshsadam", "createdAt": "2020-10-09T12:07:01Z", "path": "src/main/webapp/resources/js/contexts/AdminStatisticsContext.js", "diffHunk": "@@ -0,0 +1,196 @@\n+/*\n+ * This file gets the usage statistics and sets the global state\n+ * for the admin statistics page\n+ */\n+\n+import React, { useEffect, useState } from \"react\";\n+import { notification } from \"antd\";\n+import {\n+  getAdminStatistics,\n+  getUpdatedAdminAnalysesStatistics,\n+  getUpdatedAdminProjectStatistics,\n+  getUpdatedAdminSampleStatistics,\n+  getUpdatedAdminUserStatistics\n+} from \"../apis/admin/admin\";\n+\n+export const timePeriodMap = {\n+  1: \"day\",\n+  7: \"week\",\n+  14: \"2 weeks\",\n+  30: \"month\",\n+  90: \"quarter\",\n+  365: \"year\",\n+  730: \"2 years\",\n+  1825: \"5 years\",\n+  3650: \"10 years\"\n+};\n+\n+export const chartTypes = {\n+  BAR: \"bar\",\n+  COLUMN: \"column\",\n+  DONUT: \"donut\",\n+  LINE: \"line\",\n+  PIE: \"pie\"\n+}\n+\n+export const statisticTypes = {\n+  ANALYSES: \"analyses\",\n+  PROJECTS: \"projects\",\n+  SAMPLES: \"samples\",\n+  USERS: \"users\"\n+}\n+\n+// Default is to display statistics for the last week\n+export const defaultTimePeriod = 7;\n+\n+export const defaultChartType = chartTypes.BAR;\n+\n+const initialContext = {\n+  statistics: {\n+    analysesStats: [{}],\n+    projectStats: [{}],\n+    sampleStats: [{}],\n+    userStats: [{}]\n+  },\n+  basicStats : {\n+    analysesRun: 0,\n+    projectsCreated: 0,\n+    samplesCreated: 0,\n+    usersCreated: 0,\n+    usersLoggedIn: 0\n+  }\n+};\n+\n+const AdminStatisticsContext = React.createContext(initialContext);\n+\n+function AdminStatisticsProvider(props) {\n+  const [adminStatisticsContext, setAdminStatisticsContext] = useState(initialContext);\n+\n+  // Get basic usage stats for the time period\n+  useEffect(() => {\n+    getAdminStatistics(defaultTimePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }, []);\n+\n+  // Get updated project usage stats for the selected time period\n+  function updateProjectStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminProjectStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated user usage stats for the selected time period\n+  function updateUserStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminUserStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated analyses usage stats for the selected time period\n+  function updateAnalysesStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminAnalysesStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  // Get updated sample usage stats for the selected time period\n+  function updateSampleStatsTimePeriod(timePeriod) {\n+    getUpdatedAdminSampleStatistics(timePeriod).then(res => {\n+      console.log(res);\n+    }).catch((message) => {\n+      notification.error({ message });\n+    });\n+  }\n+\n+  /*\n+   * Gets the config required for the chart\n+   * @param chartType - The type of chart (bar, column, line, or pie)\n+   * @param data - The data for the chart\n+   * @param statsType - The type of statistics (projects, analyses, samples, users)\n+   * @param timePeriod - The time period for the statistics\n+   */\n+  function getChartConfig(chartType, statsType, timePeriod)\n+  {\n+    let data = null;\n+    const timePeriodText = timePeriodMap[timePeriod];\n+    const isBarChartType = chartType === chartTypes.BAR;\n+    const isPieDonutChartType = chartType === chartTypes.DONUT || chartType === chartTypes.PIE;\n+\n+    let chartTitle = \"\";\n+    let chartAxisAlias = \"\";\n+\n+    if(statsType === statisticTypes.ANALYSES) {\n+      chartTitle = `Number of analyses run in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Analyses';\n+    } else if (statsType === statisticTypes.PROJECTS) {\n+      chartTitle = `Number of projects created in past ${timePeriodText}`;\n+      chartAxisAlias ='# of Projects';\n+    } else if (statsType === statisticTypes.SAMPLES)\n+    {\n+      chartTitle = `Number of samples created in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Samples';\n+    } else if (statsType === statisticTypes.USERS) {\n+      chartTitle =`Number of users created in past ${timePeriodText}`;\n+      chartAxisAlias = '# of Users';\n+    }\n+\n+\n+    // The configuration required to display a chart\n+    const chartConfig = {\n+      title: { visible: true, text: chartTitle },\n+      forceFit: true,\n+      data: data !== null  ? data : [{key:\"\", value:\"\"}],\n+      padding: 'auto',\n+      xField: isBarChartType ? 'value' : 'key',\n+      yField: isBarChartType ? 'key' : 'value',\n+      meta: { key: { alias: 'Time Period' }, value: { alias: chartAxisAlias } },\n+      angleField:\"value\",\n+      label: {\n+        visible: data !== null ? (isPieDonutChartType ? false : true) : false,\n+        position: isBarChartType ? 'right' : 'middle',\n+        adjustColor: true,\n+        style: { fill: '#0D0E68', fontSize: 12, fontWeight: 600, opacity: 0.3 },\n+      },\n+      colorField: \"key\",\n+      legend: {\n+        visible: data !== null ? true : false,\n+        position: 'bottom-center',\n+      },\n+      statistic: {\n+        visible: data !== null ? true : false,\n+        content: {\n+          value: \"\",\n+          name: '',\n+        },\n+      },\n+    };\n+\n+    return chartConfig;", "originalCommit": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MjIwMw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502382203", "bodyText": "I also do not think this needs to be in the context. \u00a0It could be in a separate file and just called. \u00a0I don't think there is anything in here that is directly needed from the context.", "author": "joshsadam", "createdAt": "2020-10-09T12:08:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MTY0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzcwNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502467704", "bodyText": "Updated and moved into a new file in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:30:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MTY0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MzA0NA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502383044", "bodyText": "Take a look at Row and Col from Ant Design. \u00a0You get a lot of this with proper height separations and media queries. Right now your cards stack on touching each other", "author": "joshsadam", "createdAt": "2020-10-09T12:10:09Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/BasicStats.jsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * This file renders the Basic Statistics component\n+ * with functionality to view advanced statistics\n+ * charts\n+ */\n+\n+import React, { useContext, useState } from \"react\";\n+import { Button, Card, Statistic } from \"antd\";\n+import { SPACE_LG, SPACE_XS } from \"../../../../styles/spacing\";\n+import AdvancedStatistics from \"./AdvancedStatistics\";\n+import {\n+  AdminStatisticsContext,\n+  defaultTimePeriod,\n+  statisticTypes,\n+  timePeriodMap\n+} from \"../../../../contexts/AdminStatisticsContext\";\n+\n+export default function BasicStats() {\n+  const [statsChartView, setStatsChartView] = useState(null);\n+\n+  const { adminStatisticsContext } = useContext(\n+    AdminStatisticsContext\n+  );\n+\n+  return (\n+    <div className=\"t-statistics\">\n+      <div style={{marginBottom: SPACE_LG}} className=\"t-stats-basic\">\n+        <div style={{display: \"flex\",\n+          justifyContent: \"flex-start\", flexWrap: \"wrap\"}}>\n+            <Card style={{width: 240, marginRight: SPACE_XS}}>", "originalCommit": "d013a64c4bbff49f15a22e1b73cd95521b88a51b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2ODA1OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502468058", "bodyText": "I ended up adding marginBottom to the cards. The Row/Col broke the display and the buttons would overlap", "author": "deepsidhu85", "createdAt": "2020-10-09T14:30:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MzA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2ODE3Mg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502468172", "bodyText": "Updated in ff7ec15", "author": "deepsidhu85", "createdAt": "2020-10-09T14:30:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjM4MzA0NA=="}], "type": "inlineReview"}, {"oid": "ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "url": "https://github.com/phac-nml/irida/commit/ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "message": "Changed api endpoints for statistics. Moved chart config into its own file rather than have it in the context. Refactored code", "committedDate": "2020-10-09T14:26:50Z", "type": "commit"}, {"oid": "a232353ca631dee6a88a033d3d350b33fc3d407b", "url": "https://github.com/phac-nml/irida/commit/a232353ca631dee6a88a033d3d350b33fc3d407b", "message": "Updated to use ant design charts 1.0.0. Refactored code in BasicStats component.", "committedDate": "2020-10-14T16:12:25Z", "type": "commit"}, {"oid": "aabc12d61cf03213a284be4781c734393b5c67a4", "url": "https://github.com/phac-nml/irida/commit/aabc12d61cf03213a284be4781c734393b5c67a4", "message": "Moved title from chart config into advancestatistics as new version of ant design charts no longer has a title field. Cleaned up chart config. Added a border to statistics card when hovered", "committedDate": "2020-10-14T19:16:59Z", "type": "commit"}, {"oid": "a82a9fd41e56400f006208d95d64b65927b17b8c", "url": "https://github.com/phac-nml/irida/commit/a82a9fd41e56400f006208d95d64b65927b17b8c", "message": "Added direct urls to stats for analyses, projects, samples, and users so a user can visit them via url", "committedDate": "2020-10-15T15:38:44Z", "type": "commit"}, {"oid": "f6ae5019dbec584463139ad561a5eda951e8d3e7", "url": "https://github.com/phac-nml/irida/commit/f6ae5019dbec584463139ad561a5eda951e8d3e7", "message": "Fixed logic to check which url the page is on", "committedDate": "2020-10-15T16:02:57Z", "type": "commit"}, {"oid": "e55597c169da58c3e48dcdb94c8b5c7e2eff8f08", "url": "https://github.com/phac-nml/irida/commit/e55597c169da58c3e48dcdb94c8b5c7e2eff8f08", "message": ":construction: Cleaned up routing and layout", "committedDate": "2020-10-15T17:42:18Z", "type": "commit"}, {"oid": "72d0ba92aff2b0bf3a50b1337602c938094c59e0", "url": "https://github.com/phac-nml/irida/commit/72d0ba92aff2b0bf3a50b1337602c938094c59e0", "message": "Merge pull request #828 from phac-nml/ui-stats-layout-tweaks\n\n Cleaned up routing and layout", "committedDate": "2020-10-15T20:12:02Z", "type": "commit"}, {"oid": "49131b6dd2cd47bfa40b1db41caff90046339d63", "url": "https://github.com/phac-nml/irida/commit/49131b6dd2cd47bfa40b1db41caff90046339d63", "message": "Removed files not required", "committedDate": "2020-10-15T20:24:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjU0OTE3Mg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502549172", "bodyText": "Maybe move these out into a constants file.", "author": "joshsadam", "createdAt": "2020-10-09T16:38:25Z", "path": "src/main/webapp/resources/js/pages/admin/chart-config.js", "diffHunk": "@@ -0,0 +1,87 @@\n+import merge from \"lodash/merge\";\n+import {\n+  chartTypes,\n+  statisticTypes,\n+  timePeriodMap\n+} from \"../../contexts/AdminStatisticsContext\";", "originalCommit": "ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MjE1MQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506442151", "bodyText": "Moved in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:48:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjU0OTE3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjU2NzM5Mw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502567393", "bodyText": "Move this logic into the context. \u00a0pass it the type and the time period. \u00a0Keep the logic out of your component", "author": "joshsadam", "createdAt": "2020-10-09T17:14:12Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/AdvancedStatistics.jsx", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * This file renders the Advanced Statistics component\n+ * which displays statistics in charts\n+ */\n+\n+import React, { useContext, useEffect, useState } from \"react\";\n+import { Bar, Column, Donut, Line, Pie } from \"@ant-design/charts\";\n+import { Form } from \"antd\";\n+import { TimePeriodSelect } from \"./TimePeriodSelect\";\n+import {\n+  AdminStatisticsContext,\n+  defaultTimePeriod,\n+  defaultChartType,\n+  chartTypes,\n+  statisticTypes\n+} from \"../../../../contexts/AdminStatisticsContext\";\n+import { SPACE_LG } from \"../../../../styles/spacing\";\n+import { ChartTypeButtons } from \"./ChartTypeButtons\";\n+\n+import { getChartConfiguration } from \"../../chart-config\"\n+\n+export default function AdvancedStatistics({statType}) {\n+\n+  const {\n+    adminStatisticsContext,\n+    updateAnalysesStatsTimePeriod,\n+    updateProjectStatsTimePeriod,\n+    updateSampleStatsTimePeriod,\n+    updateUserStatsTimePeriod\n+  } = useContext(AdminStatisticsContext);\n+\n+  const [timePeriod, setTimePeriod] = useState(defaultTimePeriod);\n+  const [chartType, setChartType] = useState(defaultChartType);\n+  const [form] = Form.useForm();\n+\n+  const components = {\n+    [chartTypes.BAR]: Bar,\n+    [chartTypes.COLUMN]: Column,\n+    [chartTypes.LINE]: Line,\n+    [chartTypes.PIE]: Pie,\n+    [chartTypes.DONUT]: Donut,\n+  };\n+\n+  useEffect(() => {\n+    setChartType(defaultChartType);\n+    setTimePeriod(defaultTimePeriod);\n+    form.setFieldsValue({\n+      \"time-period\": defaultTimePeriod,\n+    });\n+  }, [statType]);\n+\n+  function updateTimePeriod(currTimePeriod) {", "originalCommit": "ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MjMwNQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506442305", "bodyText": "Updated in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:48:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjU2NzM5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjU2ODUxMQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r502568511", "bodyText": "Just an FYI: this can also be written:\n<TimePeriodSelect onChange={updateTimePeriod} />\n\nSince you are just passing the argument.", "author": "joshsadam", "createdAt": "2020-10-09T17:16:31Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/AdvancedStatistics.jsx", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * This file renders the Advanced Statistics component\n+ * which displays statistics in charts\n+ */\n+\n+import React, { useContext, useEffect, useState } from \"react\";\n+import { Bar, Column, Donut, Line, Pie } from \"@ant-design/charts\";\n+import { Form } from \"antd\";\n+import { TimePeriodSelect } from \"./TimePeriodSelect\";\n+import {\n+  AdminStatisticsContext,\n+  defaultTimePeriod,\n+  defaultChartType,\n+  chartTypes,\n+  statisticTypes\n+} from \"../../../../contexts/AdminStatisticsContext\";\n+import { SPACE_LG } from \"../../../../styles/spacing\";\n+import { ChartTypeButtons } from \"./ChartTypeButtons\";\n+\n+import { getChartConfiguration } from \"../../chart-config\"\n+\n+export default function AdvancedStatistics({statType}) {\n+\n+  const {\n+    adminStatisticsContext,\n+    updateAnalysesStatsTimePeriod,\n+    updateProjectStatsTimePeriod,\n+    updateSampleStatsTimePeriod,\n+    updateUserStatsTimePeriod\n+  } = useContext(AdminStatisticsContext);\n+\n+  const [timePeriod, setTimePeriod] = useState(defaultTimePeriod);\n+  const [chartType, setChartType] = useState(defaultChartType);\n+  const [form] = Form.useForm();\n+\n+  const components = {\n+    [chartTypes.BAR]: Bar,\n+    [chartTypes.COLUMN]: Column,\n+    [chartTypes.LINE]: Line,\n+    [chartTypes.PIE]: Pie,\n+    [chartTypes.DONUT]: Donut,\n+  };\n+\n+  useEffect(() => {\n+    setChartType(defaultChartType);\n+    setTimePeriod(defaultTimePeriod);\n+    form.setFieldsValue({\n+      \"time-period\": defaultTimePeriod,\n+    });\n+  }, [statType]);\n+\n+  function updateTimePeriod(currTimePeriod) {\n+    if(statType === statisticTypes.ANALYSES) {\n+      updateAnalysesStatsTimePeriod(timePeriod);\n+    } else if (statType === statisticTypes.PROJECTS) {\n+      updateProjectStatsTimePeriod(timePeriod);\n+    } else if (statType === statisticTypes.SAMPLES) {\n+      updateSampleStatsTimePeriod(timePeriod)\n+    } else if (statType === statisticTypes.USERS) {\n+      updateUserStatsTimePeriod(timePeriod);\n+    }\n+    setTimePeriod(currTimePeriod);\n+  }\n+\n+  function displayChart() {\n+    const Component = components[chartType];\n+    return Component ? (\n+      <Component {...getChartConfiguration(chartType, statType, timePeriod, adminStatisticsContext.statistics)} />\n+    ) : null;\n+  }\n+\n+  return (\n+    <div style={{marginBottom: SPACE_LG}}>\n+      <Form\n+        form={form}\n+        initialValues={{\n+          \"time-period\": defaultTimePeriod,\n+        }}\n+      >\n+        <TimePeriodSelect onChange={(e) => updateTimePeriod(e)} />", "originalCommit": "ff7ec157807d1b1bc99e6e65236ed77a1bcee291", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MjQ0NQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506442445", "bodyText": "Updated in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:48:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjU2ODUxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY3Mjg0MQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r505672841", "bodyText": "Can you rename this file to statistics-context.js \u00a0you have it named like a jsx component.", "author": "joshsadam", "createdAt": "2020-10-15T16:19:41Z", "path": "src/main/webapp/resources/js/contexts/AdminStatisticsContext.js", "diffHunk": "@@ -0,0 +1,162 @@\n+/*", "originalCommit": "f6ae5019dbec584463139ad561a5eda951e8d3e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY3NDAzOA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r505674038", "bodyText": "Take a look at https://kentcdodds.com/blog/how-to-use-react-context-effectively I find it a highly effective way of setting up contexts.", "author": "joshsadam", "createdAt": "2020-10-15T16:21:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY3Mjg0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MjYwNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506442604", "bodyText": "Renamed in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:49:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY3Mjg0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY4MzQ1Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r505683457", "bodyText": "Is this just placeholder stuff? Why are you not just passing the data in directly? \u00a0I really thought all you would pass in here is the chartType. \u00a0If there is no data then you would not display any of this anyways.", "author": "joshsadam", "createdAt": "2020-10-15T16:35:11Z", "path": "src/main/webapp/resources/js/pages/admin/chart-config.js", "diffHunk": "@@ -0,0 +1,88 @@\n+import merge from \"lodash/merge\";\n+import {\n+  chartTypes,\n+  statisticTypes\n+} from \"../../contexts/AdminStatisticsContext\";\n+\n+/*\n+   * Gets the config required for the chart\n+   * @param chartType - The type of chart (bar, column, line, or pie)\n+   * @param data - The data for the chart\n+   * @param statsType - The type of statistics (projects, analyses, samples, users)\n+   */\n+export function getChartConfiguration(chartType, statsType, statistics) {\n+  let data = [{\"key\":\"\", \"value\":\"\"}];\n+\n+  if(statsType === statisticTypes.ANALYSES) {", "originalCommit": "f6ae5019dbec584463139ad561a5eda951e8d3e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MzAzNg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506443036", "bodyText": "Updated to pass data from the component directly in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:49:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY4MzQ1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY4Mzg5Nw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r505683897", "bodyText": "You might want a separate config setup for just tiny charts", "author": "joshsadam", "createdAt": "2020-10-15T16:35:52Z", "path": "src/main/webapp/resources/js/pages/admin/chart-config.js", "diffHunk": "@@ -0,0 +1,88 @@\n+import merge from \"lodash/merge\";\n+import {\n+  chartTypes,\n+  statisticTypes\n+} from \"../../contexts/AdminStatisticsContext\";\n+\n+/*\n+   * Gets the config required for the chart\n+   * @param chartType - The type of chart (bar, column, line, or pie)\n+   * @param data - The data for the chart\n+   * @param statsType - The type of statistics (projects, analyses, samples, users)\n+   */\n+export function getChartConfiguration(chartType, statsType, statistics) {\n+  let data = [{\"key\":\"\", \"value\":\"\"}];\n+\n+  if(statsType === statisticTypes.ANALYSES) {\n+    data = statistics.analysesStats;\n+  } else if (statsType === statisticTypes.PROJECTS) {\n+    data = statistics.projectStats;\n+  } else if (statsType === statisticTypes.SAMPLES)\n+  {\n+    data = statistics.sampleStats;\n+  } else if (statsType === statisticTypes.USERS) {\n+    data = statistics.userStats;\n+  }\n+\n+  /*\n+   * Tiny charts only require an array of values rather than\n+   * an array of objects.\n+   */\n+  if(chartType === chartTypes.TINYCOLUMN) {", "originalCommit": "f6ae5019dbec584463139ad561a5eda951e8d3e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MzE5MQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506443191", "bodyText": "Added in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:49:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY4Mzg5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk4NzQ1MA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r505987450", "bodyText": "Is this still needed after the way I refactored it?", "author": "joshsadam", "createdAt": "2020-10-16T02:15:34Z", "path": "src/main/webapp/resources/js/pages/admin/components/AdminSideMenu.jsx", "diffHunk": "@@ -43,7 +43,23 @@ export default function AdminHeader() {\n                 <img style={{ height: 64, width: 200 }} src={setBaseUrl(\"/resources/img/irida_logo_dark.svg\")}/>\n               </Link>\n               <Menu className={\"t-admin-side-menu\"} style={{ height: '100vh' }} theme={\"dark\"} mode={\"inline\"}\n-                    selectedKeys={[keyname ? parseKey(keyname) : ADMIN.USERS]}>\n+                    selectedKeys={[keyname ?\n+                      ( parseKey(keyname) !== \"admin\" ?\n+                          !statsPages.includes(parseKey(keyname)) ?", "originalCommit": "49131b6dd2cd47bfa40b1db41caff90046339d63", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQzNjI5NA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506436294", "bodyText": "If we remove it then if one of the tiny chart links are clicked on then the menu item is no longer highlighted", "author": "deepsidhu85", "createdAt": "2020-10-16T13:42:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk4NzQ1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjUzNDcwNg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506534706", "bodyText": "This should be fixed in the code I just sent you.", "author": "joshsadam", "createdAt": "2020-10-16T15:17:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk4NzQ1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk4ODEyNQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r505988125", "bodyText": "I am wondering if this should not also be a radio.group buttons?  Not to many options and easy to click.  Thoughts?", "author": "joshsadam", "createdAt": "2020-10-16T02:16:42Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/TimePeriodSelect.jsx", "diffHunk": "@@ -0,0 +1,52 @@\n+import React from \"react\";\n+import { Form, Select } from \"antd\";\n+\n+/**\n+ * React component for updating the time period for statistics.\n+ * @param {string} [name] - form name value\n+ * @param {function} [onChange] - called when the component changes value\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function TimePeriodSelect({ onChange = () => {} }) {\n+  return (\n+    <Form.Item\n+        label ={\n+          <span>\n+            Time Period\n+          </span>\n+        }\n+      name=\"time-period\"\n+    >\n+      <Select onChange={onChange} className={\"t-time-period\"} style={{width: 120}}>\n+        <Select.Option value={1}>", "originalCommit": "49131b6dd2cd47bfa40b1db41caff90046339d63", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQzNjU4NQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506436585", "bodyText": "I tried it out and it looks good with the radio group buttons", "author": "deepsidhu85", "createdAt": "2020-10-16T13:42:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk4ODEyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ0MzQzMA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506443430", "bodyText": "Updated to radio group buttons in 567cdb7", "author": "deepsidhu85", "createdAt": "2020-10-16T13:49:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk4ODEyNQ=="}], "type": "inlineReview"}, {"oid": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "url": "https://github.com/phac-nml/irida/commit/567cdb75bcedd68dc9d0811b02db3369cca719e4", "message": "Refactored code, renamed context file, moved constants into a constant file, changed select to radio group buttons for time period", "committedDate": "2020-10-16T13:48:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODE0NA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506458144", "bodyText": "Unused import", "author": "joshsadam", "createdAt": "2020-10-16T14:02:16Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,78 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ2OTEzMg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506469132", "bodyText": "This has been removed in the next PR", "author": "deepsidhu85", "createdAt": "2020-10-16T14:10:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODE0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODk3Ng==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506458976", "bodyText": "Your response entities should have a type associated e.g. ResponseEntity<String>", "author": "joshsadam", "createdAt": "2020-10-16T14:03:00Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/admin/AdminStatisticsAjaxController.java", "diffHunk": "@@ -0,0 +1,78 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.admin;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.context.annotation.Scope;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.RequestMethod;\n+import org.springframework.web.bind.annotation.RestController;\n+\n+\n+/**\n+ * Controller to handle ajax requests for the Admin Panel statistics page.\n+ */\n+\n+@RestController\n+@RequestMapping(\"/ajax/statistics\")\n+public class AdminStatisticsAjaxController {\n+\n+\t@Autowired\n+\tpublic AdminStatisticsAjaxController() {\n+\t}\n+\n+\t/**\n+\t * Get usage statistics for projects, samples, analyses, and users\n+\t * for the provided time period\n+\t *\n+\t * @param timePeriod The time period for which to retrieve usage stats for\n+\t * @return dto with usage stats\n+\t */\n+\t@RequestMapping(value = \"/basic\", method = RequestMethod.GET)\n+\tpublic ResponseEntity getAdminStatistics(Long timePeriod) {", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ2OTY0Mg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506469642", "bodyText": "This has been updated in the basic stats and advanced stats PRs that will come after this with the actual types", "author": "deepsidhu85", "createdAt": "2020-10-16T14:11:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1ODk3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1OTg4MA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506459880", "bodyText": "Do you need this logging statement?", "author": "joshsadam", "createdAt": "2020-10-16T14:03:45Z", "path": "src/main/webapp/resources/js/apis/admin/admin.js", "diffHunk": "@@ -0,0 +1,60 @@\n+import { setBaseUrl } from \"../../utilities/url-utilities\";\n+import axios from \"axios\";\n+\n+const ADMIN_URL = setBaseUrl(`/ajax/statistics`);\n+\n+/*\n+ * Get all the statistics for the admin panel\n+ * @return {Promise<*>} `data` contains the OK response and the details map;\n+ *                      `error` contains error information if an error occurred.\n+ */\n+export async function getAdminStatistics() {\n+  return await axios.get(`${ADMIN_URL}/basic`).then(({data}) => data).catch(error => {\n+    console.log(error.response.data);", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjU4NDcyNQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506584725", "bodyText": "Removed in 6c0aba7", "author": "deepsidhu85", "createdAt": "2020-10-16T16:23:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ1OTg4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ5MzkzNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506493934", "bodyText": "Can you add `layout=\"vertical\"` to the \u00a0Form it will line things up better for you.", "author": "joshsadam", "createdAt": "2020-10-16T14:37:22Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/AdvancedStatistics.jsx", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * This file renders the Advanced Statistics component\n+ * which displays statistics in charts\n+ */\n+\n+import React, { useContext, useEffect, useState } from \"react\";\n+import { Bar, Column, Line, Pie } from \"@ant-design/charts\";\n+import { Card, Form, PageHeader } from \"antd\";\n+import { TimePeriodSelect } from \"./TimePeriodSelect\";\n+import {\n+  AdminStatisticsContext\n+} from \"../../../../contexts/statistics-context\";\n+\n+import {\n+  chartTypes,\n+  defaultChartType,\n+  defaultTimePeriod,\n+  statisticTypes\n+} from \"../../statistics-constants\";\n+\n+import { SPACE_LG, SPACE_MD } from \"../../../../styles/spacing\";\n+import { ChartTypeButtons } from \"./ChartTypeButtons\";\n+import { getChartConfiguration } from \"../../chart-config\";\n+import { useNavigate } from \"@reach/router\";\n+import { setBaseUrl } from \"../../../../utilities/url-utilities\";\n+\n+export default function AdvancedStatistics({ statType }) {\n+  const {\n+    adminStatisticsContext,\n+    getUpdatedStatsForStatType\n+  } = useContext(AdminStatisticsContext);\n+\n+  const [chartType, setChartType] = useState(defaultChartType);\n+  const [form] = Form.useForm();\n+  const navigate = useNavigate();\n+\n+  const components = {\n+    [chartTypes.BAR]: Bar,\n+    [chartTypes.COLUMN]: Column,\n+    [chartTypes.LINE]: Line,\n+    [chartTypes.PIE]: Pie,\n+  };\n+\n+  useEffect(() => {\n+    setChartType(defaultChartType);\n+    form.setFieldsValue({\n+      \"time-period\": defaultTimePeriod,\n+    });\n+  }, [statType]);\n+\n+  function updateTimePeriod(currTimePeriod) {\n+    getUpdatedStatsForStatType(statType, currTimePeriod);\n+  }\n+\n+  const chartTitle =\n+    statType === statisticTypes.ANALYSES\n+      ? \"Number of Analyses Ran\"\n+      : statType === statisticTypes.PROJECTS\n+      ? \"Number of Projects Created\"\n+      : statType === statisticTypes.SAMPLES\n+      ? \"Number of Samples Created\"\n+      : statType === statisticTypes.USERS\n+      ? \"Number of Users Created\"\n+      : null;\n+\n+  function displayChart() {\n+    const Component = components[chartType];\n+    let data = [{\"key\":\"\", \"value\":\"\"}];\n+\n+    if(statType === statisticTypes.ANALYSES) {\n+      data = adminStatisticsContext.statistics.analysesStats;\n+    } else if (statType === statisticTypes.PROJECTS) {\n+      data = adminStatisticsContext.statistics.projectStats;\n+    } else if (statType === statisticTypes.SAMPLES) {\n+      data = adminStatisticsContext.statistics.sampleStats;\n+    } else if (statType === statisticTypes.USERS) {\n+      data = adminStatisticsContext.statistics.userStats;\n+    }\n+\n+    return Component ? (\n+      <Component\n+        {...getChartConfiguration(\n+          chartType,\n+          data\n+        )}\n+      />\n+    ) : null;\n+  }\n+\n+  return (\n+    <>\n+      <PageHeader\n+        title={chartTitle}\n+        onBack={() => navigate(setBaseUrl(`/admin/statistics`))}\n+      />\n+      <Card style={{ margin: SPACE_LG }}>\n+        <Form", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjU4NDc5Mg==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506584792", "bodyText": "Added in 6c0aba7", "author": "deepsidhu85", "createdAt": "2020-10-16T16:23:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ5MzkzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjUzOTAxMQ==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506539011", "bodyText": "This complex ternary statements are overly complicated. \u00a0Why not just create an object:\nconst TITLES = {\n    [statisticTypes.ANALYSES]: \"Number of Analyses Ran\",\n    [statisticTypes.PROJECTS]: \"Number of Projects Created\",\n    [statisticTypes.SAMPLES]: \"Number of Samples Created\",\n    [statisticTypes.USERS]: \"Number of Users Created\",\n  };\nThen in you JSX:\ntitle={TITLES[chartType]}\nI would do the same thing with the large ternary below as well.", "author": "joshsadam", "createdAt": "2020-10-16T15:21:43Z", "path": "src/main/webapp/resources/js/pages/admin/components/statistics/AdvancedStatistics.jsx", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * This file renders the Advanced Statistics component\n+ * which displays statistics in charts\n+ */\n+\n+import React, { useContext, useEffect, useState } from \"react\";\n+import { Bar, Column, Line, Pie } from \"@ant-design/charts\";\n+import { Card, Form, PageHeader } from \"antd\";\n+import { TimePeriodSelect } from \"./TimePeriodSelect\";\n+import {\n+  AdminStatisticsContext\n+} from \"../../../../contexts/statistics-context\";\n+\n+import {\n+  chartTypes,\n+  defaultChartType,\n+  defaultTimePeriod,\n+  statisticTypes\n+} from \"../../statistics-constants\";\n+\n+import { SPACE_LG, SPACE_MD } from \"../../../../styles/spacing\";\n+import { ChartTypeButtons } from \"./ChartTypeButtons\";\n+import { getChartConfiguration } from \"../../chart-config\";\n+import { useNavigate } from \"@reach/router\";\n+import { setBaseUrl } from \"../../../../utilities/url-utilities\";\n+\n+export default function AdvancedStatistics({ statType }) {\n+  const {\n+    adminStatisticsContext,\n+    getUpdatedStatsForStatType\n+  } = useContext(AdminStatisticsContext);\n+\n+  const [chartType, setChartType] = useState(defaultChartType);\n+  const [form] = Form.useForm();\n+  const navigate = useNavigate();\n+\n+  const components = {\n+    [chartTypes.BAR]: Bar,\n+    [chartTypes.COLUMN]: Column,\n+    [chartTypes.LINE]: Line,\n+    [chartTypes.PIE]: Pie,\n+  };\n+\n+  useEffect(() => {\n+    setChartType(defaultChartType);\n+    form.setFieldsValue({\n+      \"time-period\": defaultTimePeriod,\n+    });\n+  }, [statType]);\n+\n+  function updateTimePeriod(currTimePeriod) {\n+    getUpdatedStatsForStatType(statType, currTimePeriod);\n+  }\n+\n+  const chartTitle =\n+    statType === statisticTypes.ANALYSES\n+      ? \"Number of Analyses Ran\"\n+      : statType === statisticTypes.PROJECTS\n+      ? \"Number of Projects Created\"\n+      : statType === statisticTypes.SAMPLES\n+      ? \"Number of Samples Created\"\n+      : statType === statisticTypes.USERS\n+      ? \"Number of Users Created\"\n+      : null;", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjU4NDkyNA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506584924", "bodyText": "Updated both blocks of ternary statements in 6c0aba7", "author": "deepsidhu85", "createdAt": "2020-10-16T16:24:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjUzOTAxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjU0MTI0Mw==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506541243", "bodyText": "Comments please", "author": "joshsadam", "createdAt": "2020-10-16T15:24:00Z", "path": "src/main/webapp/resources/js/pages/admin/statistics-constants.js", "diffHunk": "@@ -0,0 +1,32 @@\n+export const timePeriodMap = {\n+  1: \"day\",", "originalCommit": "567cdb75bcedd68dc9d0811b02db3369cca719e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjU4NDk4OA==", "url": "https://github.com/phac-nml/irida/pull/824#discussion_r506584988", "bodyText": "Added comments in 6c0aba7", "author": "deepsidhu85", "createdAt": "2020-10-16T16:24:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjU0MTI0Mw=="}], "type": "inlineReview"}, {"oid": "6c0aba73217bab99d94702474de6064bf84e81c1", "url": "https://github.com/phac-nml/irida/commit/6c0aba73217bab99d94702474de6064bf84e81c1", "message": "Added comments, refactored logic in AdvancedStatistics component to get rid of ternary statements, updated logic for setting select menu item in admin panel, added a vertical layout to form, removed logging statement and unused import", "committedDate": "2020-10-16T16:22:41Z", "type": "commit"}, {"oid": "c1f8c5a368fc9635af43d8bbbdf5647db09ceec4", "url": "https://github.com/phac-nml/irida/commit/c1f8c5a368fc9635af43d8bbbdf5647db09ceec4", "message": "Added null check when returning a match to the regex for the url. Ignored test that is fixed in later branch", "committedDate": "2020-10-16T18:04:13Z", "type": "commit"}, {"oid": "65dc7cc5dd49918acabeaa255d74f849eeec9970", "url": "https://github.com/phac-nml/irida/commit/65dc7cc5dd49918acabeaa255d74f849eeec9970", "message": "Ignored test", "committedDate": "2020-10-16T19:19:07Z", "type": "commit"}]}