{"pr_number": 609, "pr_title": "Fix ngs-linker exporting >= 330 samples ", "pr_createdAt": "2020-02-26T21:34:47Z", "pr_url": "https://github.com/phac-nml/irida/pull/609", "timeline": [{"oid": "6b0c6a68713d5afebb157bdbf16b189164d09cd5", "url": "https://github.com/phac-nml/irida/commit/6b0c6a68713d5afebb157bdbf16b189164d09cd5", "message": "Working copy to clipboard with >400 samples.", "committedDate": "2020-02-26T21:22:38Z", "type": "commit"}, {"oid": "079eedcafcfc54109c63721c54ccc1e95459a36c", "url": "https://github.com/phac-nml/irida/commit/079eedcafcfc54109c63721c54ccc1e95459a36c", "message": "Fix issue with project table scroll.", "committedDate": "2020-02-26T21:32:51Z", "type": "commit"}, {"oid": "7d04e237d0ab37cfa808f2123946792f1d48effa", "url": "https://github.com/phac-nml/irida/commit/7d04e237d0ab37cfa808f2123946792f1d48effa", "message": "Fixed broken tests for linker.", "committedDate": "2020-02-27T16:14:55Z", "type": "commit"}, {"oid": "bc37a7505316d35959c63d90dcc46a3adcd6862c", "url": "https://github.com/phac-nml/irida/commit/bc37a7505316d35959c63d90dcc46a3adcd6862c", "message": "Added comments and cleaned up messages.", "committedDate": "2020-02-27T16:22:28Z", "type": "commit"}, {"oid": "04a1b635793a0045e30534fdf74a87eba234cf21", "url": "https://github.com/phac-nml/irida/commit/04a1b635793a0045e30534fdf74a87eba234cf21", "message": "Updated JavaDoc", "committedDate": "2020-02-27T18:52:36Z", "type": "commit"}, {"oid": "734f10041414fe27c6e019b7c25408659d60770c", "url": "https://github.com/phac-nml/irida/commit/734f10041414fe27c6e019b7c25408659d60770c", "message": "Updated JavaDoc", "committedDate": "2020-02-27T18:54:57Z", "type": "commit"}, {"oid": "179b3cabc41018de86cc2ef6e27af0335b38be48", "url": "https://github.com/phac-nml/irida/commit/179b3cabc41018de86cc2ef6e27af0335b38be48", "message": "Updated JavaDoc", "committedDate": "2020-02-27T19:05:12Z", "type": "commit"}, {"oid": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "url": "https://github.com/phac-nml/irida/commit/81fd79ec914274a4f6d27ad84a885e7ac78932eb", "message": "Updated CHANGELOG.md", "committedDate": "2020-02-27T20:21:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NDc2NQ==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385844765", "bodyText": "Any reason this commented out html is here? If not then it can be removed", "author": "deepsidhu85", "createdAt": "2020-02-28T18:11:05Z", "path": "src/main/webapp/pages/projects/partials/samples.tmpl.html", "diffHunk": "@@ -29,48 +29,49 @@\n \t\t\t<span th:text=\"#{project.samples.nav.remove}\"></span>\n \t\t</button>\n \t</div>\n-\n+\t<div id=\"linker\"></div>\n \t<!-- SAMPLE EXPORT -->\n-\t<div class=\"btn-group btn-group-sm\" uib-dropdown=\"\">\n-\t\t<button id=\"export-btn\" class=\"btn btn-default\" uib-dropdown-toggle=\"\"\n-\t\t        ng-disabled=\"samplesCtrl.disabled.lessThanOne\">\n-\t\t\t<span th:text=\"#{project.samples.export.label}\">Export</span>\n-\t\t\t<i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i>\n-\t\t</button>\n-\t\t<ul class=\"ng-cloak\" uib-dropdown-menu=\"\" role=\"menu\" aria-labelledby=\"export-btn\">\n-\t\t\t<li role=\"menuitem\">\n-\t\t\t\t<a id=\"exportDownloadBtn\" href=\"#\">\n-\t\t\t\t\t<i class=\"fa fa-download fa-fw\" aria-hidden=\"true\"></i>\n-\t\t\t\t\t<span th:text=\"#{form.download}\">_Download</span>\n-\t\t\t\t</a>\n-\t\t\t</li>\n-\t\t\t<!--TODO: Fix tooltip-->\n-\t\t\t<li role=\"menuitem\" th:if=\"${linkerAvailable}\" ng-class=\"{disabled: ! subnav.localSelected}\"\n-\t\t\t    ng-attr-uib-tooltip=\"{{subnav.showuib-tooltip()}}\" uib-tooltip-append-to-body=\"true\"\n-\t\t\t    uib-tooltip-placement=\"right\">\n-\t\t\t\t<a id=\"exportLinkerBtn\" href=\"#\" ng-click=\"subnav.export.linker()\">\n-\t\t\t\t\t<i class=\"fa fa-terminal fa-fw\" aria-hidden=\"true\"></i>\n-\t\t\t\t\t<span th:text=\"#{project.samples.export.linker}\"></span>\n-\t\t\t\t</a>\n-\t\t\t</li>\n-\t\t\t<li role=\"menuitem\">\n-\t\t\t\t<a id=\"exportNcbiButton\" href=\"#\" ng-click=\"subnav.export.ncbi()\">\n-\t\t\t\t\t<i class=\"fa fa-upload fa-fw\" aria-hidden=\"true\"></i>\n-\t\t\t\t\t<span th:text=\"#{project.samples.export.ncbi}\">_Upload to NCBI_</span>\n-\t\t\t\t</a>\n-\t\t\t</li>\n-\t\t\t<li role=\"menuitem\" th:if=\"${galaxyCallback}\">\n-\t\t\t\t<a href=\"#\" ng-click=\"subnav.export.galaxy(); cart.show=false\">\n-\t\t\t\t\t<i class=\"fa fa-cloud-upload fa-fw\" aria-hidden=\"true\"></i>\n-\t\t\t\t\t<span th:text=\"#{project.samples.export.galaxy}\"></span>\n-\t\t\t\t</a>\n-\t\t\t</li>\n-\t\t\t<li role=\"separator\" class=\"divider\"></li>\n-\t\t\t<li role=\"menuitem\">\n-\t\t\t\t<a href=\"\">Excel</a>\n-\t\t\t</li>\n-\t\t</ul>\n-\t</div>\n+<!--\t<div class=\"btn-group btn-group-sm\" uib-dropdown=\"\">-->", "originalCommit": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg2ODk0MA==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385868940", "bodyText": "This file should not even exist any more!  Removed in 5513dd2", "author": "joshsadam", "createdAt": "2020-02-28T19:02:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NDc2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NTA5Nw==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385845097", "bodyText": "Same as above. Can be removed", "author": "deepsidhu85", "createdAt": "2020-02-28T18:11:48Z", "path": "src/main/webapp/pages/projects/project_samples.html", "diffHunk": "@@ -171,14 +171,15 @@\n                                 </a>\n                             </li>\n                             <li th:if=\"${linkerAvailable}\" role=\"menuitem\">\n-                                <a href=\"#\" class=\"js-sample-tool-btn t-linker-btn\"\n-                                   data-toggle=\"tooltip\" data-enabled-at=\"0\"\n-                                   data:url=\"@{/projects/{projectId}/templates/linker-modal(projectId=${project.getId()})}\"\n-                                   data:script=\"@{/dist/js/project-samples-linker.bundle.js}\"\n-                                   data:associated-msg=\"#{project.samples.only-for-project-tooltip}\">\n-                                    <i class=\"fa fa-terminal fa-fw spaced-right__sm\" aria-hidden=\"true\"></i>\n-                                    <th:block th:text=\"#{project.samples.export.linker}\"/>\n-                                </a>\n+                                <a href=\"#\"><span id=\"linker\"></span></a>\n+<!--                                <a href=\"#\" class=\"js-sample-tool-btn t-linker-btn\"-->", "originalCommit": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg2OTUyMw==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385869523", "bodyText": "Removed in 24c9db3", "author": "joshsadam", "createdAt": "2020-02-28T19:03:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NTA5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NjUwMg==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385846502", "bodyText": "Instead of setting the base url in the POST call we should create a const before the function which will setbaseurl to ajax/ngs-linker. Just in case we need to add more to the file in the future.", "author": "deepsidhu85", "createdAt": "2020-02-28T18:14:53Z", "path": "src/main/webapp/resources/js/apis/linker/linker.js", "diffHunk": "@@ -0,0 +1,9 @@\n+import axios from \"axios\";\n+import { setBaseUrl } from \"../../utilities/url-utilities\";\n+", "originalCommit": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg3MzA1Mw==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385873053", "bodyText": "Sure sounds good, updated in 52966a5", "author": "joshsadam", "createdAt": "2020-02-28T19:11:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NjUwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NzIyMQ==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385847221", "bodyText": "Change detail to a more descriptive variable name", "author": "deepsidhu85", "createdAt": "2020-02-28T18:16:35Z", "path": "src/main/webapp/resources/js/pages/projects/samples/linker/Linker.jsx", "diffHunk": "@@ -0,0 +1,84 @@\n+import React from \"react\";\n+import { render } from \"react-dom\";\n+import { Button, Modal, Typography } from \"antd\";\n+import { CodeOutlined } from \"@ant-design/icons\";\n+import { grey2, grey4, grey9 } from \"../../../../styles/colors\";\n+import { getNGSLinkerCode } from \"../../../../apis/linker/linker\";\n+import { SPACE_SM } from \"../../../../styles/spacing\";\n+\n+const { Paragraph, Text } = Typography;\n+\n+/**\n+ * React component to display the ngs-linker command to a user based\n+ * on the currently selected samples.\n+ * @returns {*}\n+ * @constructor\n+ */\n+function Linker() {\n+  function handleSampleIds(e) {\n+    // Post data to get linker command.\n+    const { detail } = e;", "originalCommit": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg3MzM5Nw==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385873397", "bodyText": "Nope this is what it is called in the CustomEvent from the browser.", "author": "joshsadam", "createdAt": "2020-02-28T19:12:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NzIyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg3OTkzMQ==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385879931", "bodyText": "Sounds good", "author": "deepsidhu85", "createdAt": "2020-02-28T19:27:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0NzIyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0ODY0Nw==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385848647", "bodyText": "We created a border const for this did we not?", "author": "deepsidhu85", "createdAt": "2020-02-28T18:19:37Z", "path": "src/main/webapp/resources/js/pages/projects/samples/linker/Linker.jsx", "diffHunk": "@@ -0,0 +1,84 @@\n+import React from \"react\";\n+import { render } from \"react-dom\";\n+import { Button, Modal, Typography } from \"antd\";\n+import { CodeOutlined } from \"@ant-design/icons\";\n+import { grey2, grey4, grey9 } from \"../../../../styles/colors\";\n+import { getNGSLinkerCode } from \"../../../../apis/linker/linker\";\n+import { SPACE_SM } from \"../../../../styles/spacing\";\n+\n+const { Paragraph, Text } = Typography;\n+\n+/**\n+ * React component to display the ngs-linker command to a user based\n+ * on the currently selected samples.\n+ * @returns {*}\n+ * @constructor\n+ */\n+function Linker() {\n+  function handleSampleIds(e) {\n+    // Post data to get linker command.\n+    const { detail } = e;\n+    getNGSLinkerCode(detail).then(({ data }) => {\n+      Modal.success({\n+        className: \"t-linker-modal\",\n+        width: 500,\n+        title: i18n(\"Linker.title\"),\n+        content: (\n+          <>\n+            <Paragraph>{i18n(\"Linker.details\")}</Paragraph>\n+            <Text type=\"secondary\">\n+              <span\n+                dangerouslySetInnerHTML={{ __html: i18n(\"Linker.note\") }}\n+              />\n+            </Text>\n+            <Paragraph\n+              style={{\n+                fontFamily: \"monospace\",\n+                fontSize: 14,\n+                marginTop: SPACE_SM,\n+                padding: 2,\n+                border: `1px solid ${grey4}`,", "originalCommit": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg3NDE5Ng==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385874196", "bodyText": "That is in your branch, I will look through it and maybe copy it.", "author": "joshsadam", "createdAt": "2020-02-28T19:14:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0ODY0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg3NjY0MQ==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385876641", "bodyText": "Not there, made a new one in 63e7cae.", "author": "joshsadam", "createdAt": "2020-02-28T19:19:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0ODY0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg4MDAzMw==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385880033", "bodyText": "Awesome thanks", "author": "deepsidhu85", "createdAt": "2020-02-28T19:27:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0ODY0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0OTAzMQ==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385849031", "bodyText": "Since there are a lot of variables being set for this style maybe it would be a good idea to move it to the top of the file", "author": "deepsidhu85", "createdAt": "2020-02-28T18:20:31Z", "path": "src/main/webapp/resources/js/pages/projects/samples/linker/Linker.jsx", "diffHunk": "@@ -0,0 +1,84 @@\n+import React from \"react\";\n+import { render } from \"react-dom\";\n+import { Button, Modal, Typography } from \"antd\";\n+import { CodeOutlined } from \"@ant-design/icons\";\n+import { grey2, grey4, grey9 } from \"../../../../styles/colors\";\n+import { getNGSLinkerCode } from \"../../../../apis/linker/linker\";\n+import { SPACE_SM } from \"../../../../styles/spacing\";\n+\n+const { Paragraph, Text } = Typography;\n+\n+/**\n+ * React component to display the ngs-linker command to a user based\n+ * on the currently selected samples.\n+ * @returns {*}\n+ * @constructor\n+ */\n+function Linker() {\n+  function handleSampleIds(e) {\n+    // Post data to get linker command.\n+    const { detail } = e;\n+    getNGSLinkerCode(detail).then(({ data }) => {\n+      Modal.success({\n+        className: \"t-linker-modal\",\n+        width: 500,\n+        title: i18n(\"Linker.title\"),\n+        content: (\n+          <>\n+            <Paragraph>{i18n(\"Linker.details\")}</Paragraph>\n+            <Text type=\"secondary\">\n+              <span\n+                dangerouslySetInnerHTML={{ __html: i18n(\"Linker.note\") }}\n+              />\n+            </Text>\n+            <Paragraph\n+              style={{", "originalCommit": "81fd79ec914274a4f6d27ad84a885e7ac78932eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg3ODYyMQ==", "url": "https://github.com/phac-nml/irida/pull/609#discussion_r385878621", "bodyText": "Updated in b835389", "author": "joshsadam", "createdAt": "2020-02-28T19:24:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg0OTAzMQ=="}], "type": "inlineReview"}, {"oid": "5513dd21e810924e81fc2dfc6bd7b4e5c5049c50", "url": "https://github.com/phac-nml/irida/commit/5513dd21e810924e81fc2dfc6bd7b4e5c5049c50", "message": "Removed unused file.", "committedDate": "2020-02-28T19:02:16Z", "type": "commit"}, {"oid": "7e2123830d08216993f9ee30d9dcfb298023a706", "url": "https://github.com/phac-nml/irida/commit/7e2123830d08216993f9ee30d9dcfb298023a706", "message": "Merge branch 'development' into ngs-linker-modal", "committedDate": "2020-02-28T19:02:42Z", "type": "commit"}, {"oid": "24c9db3c703d87b5a0e071c19cb15a6e79048905", "url": "https://github.com/phac-nml/irida/commit/24c9db3c703d87b5a0e071c19cb15a6e79048905", "message": "Removed commented out code.", "committedDate": "2020-02-28T19:03:48Z", "type": "commit"}, {"oid": "52966a528b82fba549c91cc4d897647daa896a5f", "url": "https://github.com/phac-nml/irida/commit/52966a528b82fba549c91cc4d897647daa896a5f", "message": "Made a constant for the base url\n\nDon't need to call `setBaseUrl` since this is handle by the ajax interceptor.", "committedDate": "2020-02-28T19:11:38Z", "type": "commit"}, {"oid": "63e7cae5d2c7f6d864eb57e8f64057390df38a7f", "url": "https://github.com/phac-nml/irida/commit/63e7cae5d2c7f6d864eb57e8f64057390df38a7f", "message": "Made default styles for borders.", "committedDate": "2020-02-28T19:19:39Z", "type": "commit"}, {"oid": "b8353892b38050da0d1384e16b7e34dd282b0211", "url": "https://github.com/phac-nml/irida/commit/b8353892b38050da0d1384e16b7e34dd282b0211", "message": "Made the command a styled component.", "committedDate": "2020-02-28T19:24:01Z", "type": "commit"}]}