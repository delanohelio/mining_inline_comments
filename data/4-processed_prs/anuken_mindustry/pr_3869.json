{"pr_number": 3869, "pr_title": "[QoL] Chat Modes", "pr_createdAt": "2020-12-08T17:11:04Z", "pr_url": "https://github.com/Anuken/Mindustry/pull/3869", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg1NDQ0MA==", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r538854440", "bodyText": "Whitespace", "author": "skykatik", "createdAt": "2020-12-08T22:26:11Z", "path": "core/src/mindustry/ui/fragments/ChatFragment.java", "diffHunk": "@@ -216,14 +228,25 @@ public void hide(){\n     }\n \n     public void updateChat(){\n-        chatfield.setText(history.get(historyPos));\n-        chatfield.setCursorPosition(chatfield.getText().length());\n+        chatfield.setText(mode.normalizedPrefix() + history.get(historyPos));\n+        updateCursor();\n+    }\n+\n+    public void nextMode(){\n+        mode = mode.next();\n+        chatfield.setText(mode.normalizedPrefix() + chatfield.getText().substring(mode.prev().normalizedPrefix().length()));\n+        updateCursor();\n     }\n \n     public void clearChatInput(){\n         historyPos = 0;\n         history.set(0, \"\");\n-        chatfield.setText(\"\");\n+        chatfield.setText(mode.normalizedPrefix());\n+        updateCursor();\n+    }\n+\n+    public void updateCursor() {", "originalCommit": "d756361485a8b538cbc542968aa7c18a6f2f6d98", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c6d0ee2bc6d3fa1b2be004739804ca3ca5512117", "url": "https://github.com/Anuken/Mindustry/commit/c6d0ee2bc6d3fa1b2be004739804ca3ca5512117", "message": "Chat modes\n\nKorean translation by sk7725.", "committedDate": "2020-12-09T15:20:36Z", "type": "forcePushed"}, {"oid": "419d64e6f7ac75a4f5a921f5fccd9f9066837341", "url": "https://github.com/Anuken/Mindustry/commit/419d64e6f7ac75a4f5a921f5fccd9f9066837341", "message": "[QoL] Chat modes\n\nKorean translation by sk7725.", "committedDate": "2020-12-12T15:46:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NDc3NQ==", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r545264775", "bodyText": "Tab is already used for the player list.", "author": "Anuken", "createdAt": "2020-12-17T17:23:00Z", "path": "core/src/mindustry/input/Binding.java", "diffHunk": "@@ -69,6 +69,7 @@\n     chat_history_prev(KeyCode.up),\n     chat_history_next(KeyCode.down),\n     chat_scroll(new Axis(KeyCode.scroll)),\n+    chat_mode(KeyCode.tab),", "originalCommit": "419d64e6f7ac75a4f5a921f5fccd9f9066837341", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI3NjI3Mw==", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r545276273", "bodyText": "Player list isn't displayed by Tab when chat is open.\nWhat would be better key then? \ud83d\udc40", "author": "summetdev", "createdAt": "2020-12-17T17:38:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NDc3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODMwNjU5Mg==", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r548306592", "bodyText": "m.b. Ctrl + Tab", "author": "Remint32", "createdAt": "2020-12-23T22:49:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NDc3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NTAyMQ==", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r545265021", "bodyText": "Catching exceptions like these is just bad style; you should validate it instead.", "author": "Anuken", "createdAt": "2020-12-17T17:23:21Z", "path": "core/src/mindustry/ui/fragments/ChatFragment.java", "diffHunk": "@@ -216,14 +222,35 @@ public void hide(){\n     }\n \n     public void updateChat(){\n-        chatfield.setText(history.get(historyPos));\n-        chatfield.setCursorPosition(chatfield.getText().length());\n+        chatfield.setText(mode.normalizedPrefix() + history.get(historyPos));\n+        updateCursor();\n+    }\n+\n+    public void nextMode(){\n+        ChatMode prev = mode;\n+\n+        do{\n+            mode = mode.next();\n+        }while(!mode.isValid());\n+\n+        try{\n+            chatfield.setText(mode.normalizedPrefix() + chatfield.getText().substring(prev.normalizedPrefix().length()));\n+        }catch(IndexOutOfBoundsException e){ // in case the player removed a prefix", "originalCommit": "419d64e6f7ac75a4f5a921f5fccd9f9066837341", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE5OTk5Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r548199997", "bodyText": "Resolved.", "author": "summetdev", "createdAt": "2020-12-23T20:14:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NTAyMQ=="}], "type": "inlineReview"}, {"oid": "7546d323f25b969126fecfe7e907f17856be883c", "url": "https://github.com/Anuken/Mindustry/commit/7546d323f25b969126fecfe7e907f17856be883c", "message": "[QoL] Chat modes\n\nCredits: Remint32 (idea); sk7725 (korean i18n); Volas171 (spanish i18n).", "committedDate": "2020-12-24T18:58:58Z", "type": "commit"}, {"oid": "7546d323f25b969126fecfe7e907f17856be883c", "url": "https://github.com/Anuken/Mindustry/commit/7546d323f25b969126fecfe7e907f17856be883c", "message": "[QoL] Chat modes\n\nCredits: Remint32 (idea); sk7725 (korean i18n); Volas171 (spanish i18n).", "committedDate": "2020-12-24T18:58:58Z", "type": "forcePushed"}]}