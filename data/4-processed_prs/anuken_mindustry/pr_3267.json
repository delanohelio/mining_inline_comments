{"pr_number": 3267, "pr_title": "SearchBar class - add search bars to mods", "pr_createdAt": "2020-11-04T20:44:05Z", "pr_url": "https://github.com/Anuken/Mindustry/pull/3267", "timeline": [{"oid": "c78b5f3f870f9ce542b30a5a8808f60ae6002f87", "url": "https://github.com/Anuken/Mindustry/commit/c78b5f3f870f9ce542b30a5a8808f60ae6002f87", "message": "Create SearchBar and make ModsDialog use it", "committedDate": "2020-09-06T16:40:18Z", "type": "commit"}, {"oid": "8af14e10dca6bc39bb1eda8c41e871e29c4816e1", "url": "https://github.com/Anuken/Mindustry/commit/8af14e10dca6bc39bb1eda8c41e871e29c4816e1", "message": "Merge branch 'master' of https://github.com/Anuken/Mindustry into search", "committedDate": "2020-11-04T19:47:53Z", "type": "commit"}, {"oid": "60fe768e56c9a90c9ec892178d8e2c709e7fc879", "url": "https://github.com/Anuken/Mindustry/commit/60fe768e56c9a90c9ec892178d8e2c709e7fc879", "message": "add search bar to servers", "committedDate": "2020-11-04T20:36:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYzNTk5Mg==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r517635992", "bodyText": "Anuke hate spaces \ud83d\udc40\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Cons<String>[] rebuild = new Cons[] {null};\n          \n          \n            \n                    Table[] pane = new Table[] {null};\n          \n          \n            \n                    Cons<String>[] rebuild = new Cons[]{null};\n          \n          \n            \n                    Table[] pane = new Table[]{null};", "author": "summetdev", "createdAt": "2020-11-04T21:16:30Z", "path": "core/src/mindustry/ui/SearchBar.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package mindustry.ui;\n+\n+import arc.func.*;\n+import arc.scene.ui.layout.*;\n+import arc.struct.*;\n+import mindustry.gen.*;\n+\n+public class SearchBar{\n+    public static <T> Table add(Table parent, Seq<T> list, Func<String, String> queryf,\n+            Func<T, String> namef, Cons2<Table, T> itemf){\n+        Cons<String>[] rebuild = new Cons[] {null};\n+        Table[] pane = new Table[] {null};", "originalCommit": "60fe768e56c9a90c9ec892178d8e2c709e7fc879", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "27c0988623f850e3871477e1ee756a14786479d2", "url": "https://github.com/Anuken/Mindustry/commit/27c0988623f850e3871477e1ee756a14786479d2", "message": "Update core/src/mindustry/ui/SearchBar.java\n\nCo-authored-by: Antsiferov Andrew <summet.dev@gmail.com>", "committedDate": "2020-11-04T22:02:36Z", "type": "commit"}, {"oid": "2bfdc1545939e0a98e5d25f08661bc57c6c26151", "url": "https://github.com/Anuken/Mindustry/commit/2bfdc1545939e0a98e5d25f08661bc57c6c26151", "message": "a", "committedDate": "2020-11-04T22:03:59Z", "type": "commit"}, {"oid": "e8824f54ca559eefae4a02e9181f96162ea7023d", "url": "https://github.com/Anuken/Mindustry/commit/e8824f54ca559eefae4a02e9181f96162ea7023d", "message": "Merge branch 'master' into search", "committedDate": "2020-11-16T08:37:12Z", "type": "commit"}, {"oid": "89b59fa8c2b19f6f83e904a159808a4944efa3c1", "url": "https://github.com/Anuken/Mindustry/commit/89b59fa8c2b19f6f83e904a159808a4944efa3c1", "message": "Merge branch 'master' of https://github.com/Anuken/Mindustry into search", "committedDate": "2020-12-11T14:55:28Z", "type": "commit"}, {"oid": "dfb1298e845102044e78b35fe838b58187569b7a", "url": "https://github.com/Anuken/Mindustry/commit/dfb1298e845102044e78b35fe838b58187569b7a", "message": "fix mods menu not rowing", "committedDate": "2020-12-11T15:10:04Z", "type": "commit"}, {"oid": "f6c13dbbc1da9a11ecf2c1c4935b92ac48917b34", "url": "https://github.com/Anuken/Mindustry/commit/f6c13dbbc1da9a11ecf2c1c4935b92ac48917b34", "message": "remove search bar for remote servers", "committedDate": "2020-12-11T16:33:47Z", "type": "commit"}, {"oid": "7854cb6d24b5405a7ff56d703757a2fe83bcb07d", "url": "https://github.com/Anuken/Mindustry/commit/7854cb6d24b5405a7ff56d703757a2fe83bcb07d", "message": "h", "committedDate": "2020-12-18T16:46:56Z", "type": "commit"}, {"oid": "587c7a1ca58ef4572eb865ccae6da12b638a019d", "url": "https://github.com/Anuken/Mindustry/commit/587c7a1ca58ef4572eb865ccae6da12b638a019d", "message": "hide searchbar on landscape mobile", "committedDate": "2020-12-18T17:44:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwNzc5NA==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546007794", "bodyText": "The display name already has colors stripped.", "author": "Anuken", "createdAt": "2020-12-18T18:18:54Z", "path": "core/src/mindustry/ui/dialogs/ModsDialog.java", "diffHunk": "@@ -136,14 +139,12 @@ void setup(){\n         cont.row();\n \n         if(!mods.list().isEmpty()){\n-            cont.pane(table -> {\n-                table.margin(10f).top();\n-\n-                boolean anyDisabled = false;\n-                for(LoadedMod mod : mods.list()){\n-\n-                    if(!mod.enabled() && !anyDisabled && mods.list().size > 0){\n-                        anyDisabled = true;\n+            boolean[] anyDisabled = {false};\n+            SearchBar.add(cont, mods.list(),\n+                mod -> Strings.stripColors(mod.meta.displayName()),", "originalCommit": "587c7a1ca58ef4572eb865ccae6da12b638a019d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwOTY2MA==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546009660", "bodyText": "yes its an old pr", "author": "DeltaNedas", "createdAt": "2020-12-18T18:22:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwNzc5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwODEwMg==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546008102", "bodyText": "This is very hacky and will break without an obvious cause if any relevant layout is changed.", "author": "Anuken", "createdAt": "2020-12-18T18:19:36Z", "path": "core/src/mindustry/ui/dialogs/ModsDialog.java", "diffHunk": "@@ -217,20 +218,19 @@ void setup(){\n                                 }).size(50f);\n                             }\n                         }).growX().right().padRight(-8f).padTop(-8f);\n-\n-\n                     }, Styles.clearPartialt, () -> showMod(mod)).size(w, h).growX().pad(4f);\n                     table.row();\n-                }\n-            });\n+                }).margin(10f).top();\n \n+                if(mobile && !Core.graphics.isPortrait()){\n+                    //hide search bar on mobile, takes up too much space\n+                    cont.getCells().get(2).get().clear();", "originalCommit": "587c7a1ca58ef4572eb865ccae6da12b638a019d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwOTg0Mw==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546009843", "bodyText": "ok ill add a cons for search bar table", "author": "DeltaNedas", "createdAt": "2020-12-18T18:23:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwODEwMg=="}], "type": "inlineReview"}, {"oid": "c0e3dc7fc7adcc5d5092e0609812cd2df4271d03", "url": "https://github.com/Anuken/Mindustry/commit/c0e3dc7fc7adcc5d5092e0609812cd2df4271d03", "message": "anukes feedback", "committedDate": "2020-12-18T19:23:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQ2NTkwMg==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546465902", "bodyText": "probably should happen on desktop too", "author": "Anuken", "createdAt": "2020-12-21T01:15:55Z", "path": "core/src/mindustry/ui/dialogs/ModsDialog.java", "diffHunk": "@@ -30,6 +30,9 @@ public ModsDialog(){\n         buttons.button(\"@mods.guide\", Icon.link, () -> Core.app.openURI(modGuideURL)).size(210, 64f);\n \n         shown(this::setup);\n+        if(mobile){", "originalCommit": "c0e3dc7fc7adcc5d5092e0609812cd2df4271d03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjY5MzgwMA==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546693800", "bodyText": "but desktop is always landscape", "author": "DeltaNedas", "createdAt": "2020-12-21T13:03:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQ2NTkwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg2ODgyMQ==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546868821", "bodyText": "right, mistook it for portrait", "author": "Anuken", "createdAt": "2020-12-21T18:44:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQ2NTkwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg2OTMxMw==", "url": "https://github.com/Anuken/Mindustry/pull/3267#discussion_r546869313", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Cons<String>[] rebuild = new Cons[]{null};\n          \n          \n            \n                    Table[] pane = new Table[]{null};\n          \n          \n            \n                    Cons<String>[] rebuild = {null};\n          \n          \n            \n                    Table[] pane = {null};", "author": "Anuken", "createdAt": "2020-12-21T18:45:26Z", "path": "core/src/mindustry/ui/SearchBar.java", "diffHunk": "@@ -0,0 +1,57 @@\n+package mindustry.ui;\n+\n+import arc.func.*;\n+import arc.scene.ui.layout.*;\n+import arc.struct.*;\n+import mindustry.gen.*;\n+\n+public class SearchBar{\n+    public static <T> Table add(Table parent, Seq<T> list, Func<String, String> queryf,\n+            Func<T, String> namef, Cons2<Table, T> itemc, Cons<Cell<Table>> barc){\n+        Cons<String>[] rebuild = new Cons[]{null};\n+        Table[] pane = new Table[]{null};", "originalCommit": "c0e3dc7fc7adcc5d5092e0609812cd2df4271d03", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0b4ab9e72b659d255a96085ad32c3dd8e8d9681e", "url": "https://github.com/Anuken/Mindustry/commit/0b4ab9e72b659d255a96085ad32c3dd8e8d9681e", "message": "Update core/src/mindustry/ui/SearchBar.java\n\nCo-authored-by: Anuken <arnukren@gmail.com>", "committedDate": "2020-12-22T18:16:01Z", "type": "commit"}, {"oid": "6bcc6db9615581a409f8d6de3e8b132fa480da45", "url": "https://github.com/Anuken/Mindustry/commit/6bcc6db9615581a409f8d6de3e8b132fa480da45", "message": "java dumb", "committedDate": "2020-12-26T07:18:53Z", "type": "commit"}]}