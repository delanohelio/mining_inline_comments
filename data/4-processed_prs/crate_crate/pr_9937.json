{"pr_number": 9937, "pr_title": "Integrate es-server into server module", "pr_createdAt": "2020-05-11T09:06:36Z", "pr_url": "https://github.com/crate/crate/pull/9937", "timeline": [{"oid": "3378856b59780ef3f25db634865a28f29d06fb2e", "url": "https://github.com/crate/crate/commit/3378856b59780ef3f25db634865a28f29d06fb2e", "message": "Move azure related repository analyzer tests to plugin", "committedDate": "2020-05-11T12:13:14Z", "type": "forcePushed"}, {"oid": "1e1e5421117ec192dc97476992dcafefba80dd55", "url": "https://github.com/crate/crate/commit/1e1e5421117ec192dc97476992dcafefba80dd55", "message": "Fix app and enterprise functions test dependencies", "committedDate": "2020-05-11T13:42:04Z", "type": "forcePushed"}, {"oid": "56feb84a548d0764f166fb0797ba419895684e1f", "url": "https://github.com/crate/crate/commit/56feb84a548d0764f166fb0797ba419895684e1f", "message": "fixup! Fix app and enterprise functions test dependencies", "committedDate": "2020-05-11T15:23:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0MDc2Mw==", "url": "https://github.com/crate/crate/pull/9937#discussion_r423540763", "bodyText": "Is this actually used?", "author": "seut", "createdAt": "2020-05-12T08:05:54Z", "path": "server/src/test/java/Dummy.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+class Dummy {", "originalCommit": "27e33aed126d2a55acb48c16b8d8ee592143d01e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0NzMyNw==", "url": "https://github.com/crate/crate/pull/9937#discussion_r423547327", "bodyText": "Yes, there are some tests that load this class dynamically.", "author": "mfussenegger", "createdAt": "2020-05-12T08:16:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0MDc2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0MzU1NQ==", "url": "https://github.com/crate/crate/pull/9937#discussion_r423543555", "bodyText": "Should this be removed or re-enabled?", "author": "seut", "createdAt": "2020-05-12T08:10:23Z", "path": "server/src/test/java/io/crate/integrationtests/TransportSQLActionTest.java", "diffHunk": "@@ -1444,34 +1441,33 @@ public void testNumericScriptOnAllTypes() {\n \n     @Test\n     public void testWhereColumnEqColumnAndFunctionEqFunction() throws Exception {\n-        this.setup.setUpLocations();\n-        ensureYellow();\n-        refresh();\n+        execute(\"create table tbl (name text)\");\n+        execute(\"insert into tbl (name) values ('Arthur'), ('Trillian')\");\n+        execute(\"refresh table tbl\");\n \n-        execute(\"select name from locations where name = name\");\n-        assertThat(response.rowCount(), is(13L));\n+        execute(\"select name from tbl where name = name\");\n+        assertThat(response.rowCount(), is(2L));\n \n-        execute(\"select name from locations where substr(name, 1, 1) = substr(name, 1, 1)\");\n-        assertThat(response.rowCount(), is(13L));\n+        execute(\"select name from tbl where substr(name, 1, 1) = substr(name, 1, 1)\");\n+        assertThat(response.rowCount(), is(2L));\n     }\n \n     @Test\n     public void testNewColumn() throws Exception {\n         execute(\"create table t (name string) with (number_of_replicas=0, column_policy = 'dynamic')\");\n-        ensureYellow();\n         execute(\"insert into t (name, score) values ('Ford', 1.2)\");\n     }\n \n     @Test\n     public void testESGetSourceColumns() throws Exception {\n-        this.setup.setUpLocations();\n-        ensureYellow();\n+        execute(\"create table tbl (id int primary key, x int)\");\n+        execute(\"insert into tbl (id, x) values (1, 1), (2, 2), (3, 3)\");\n         refresh();\n \n-        execute(\"select _id, _version from locations where id=2\");\n-        assertNotNull(response.rows()[0][0]);\n-        assertNotNull(response.rows()[0][1]);\n+        execute(\"select _id, _version from tbl where id = 2\");\n+        assertThat(printedTable(response.rows()), is(\"2| 1\\n\"));\n \n+        /*", "originalCommit": "18162d2e31894c03ca2181e068cf0451fe8ee894", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0NzgwNQ==", "url": "https://github.com/crate/crate/pull/9937#discussion_r423547805", "bodyText": "They should be re-enabled, thanks for catching", "author": "mfussenegger", "createdAt": "2020-05-12T08:17:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0MzU1NQ=="}], "type": "inlineReview"}, {"oid": "5989e296b147ffb961f5e804502b12768a493100", "url": "https://github.com/crate/crate/commit/5989e296b147ffb961f5e804502b12768a493100", "message": "Integrate es-server into server", "committedDate": "2020-05-12T08:20:49Z", "type": "commit"}, {"oid": "5989e296b147ffb961f5e804502b12768a493100", "url": "https://github.com/crate/crate/commit/5989e296b147ffb961f5e804502b12768a493100", "message": "Integrate es-server into server", "committedDate": "2020-05-12T08:20:49Z", "type": "forcePushed"}]}