{"pr_number": 10686, "pr_title": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.", "pr_createdAt": "2020-10-21T13:03:40Z", "pr_url": "https://github.com/crate/crate/pull/10686", "timeline": [{"oid": "c1b4219b761386cf7259fd282396cfc1926a4c1f", "url": "https://github.com/crate/crate/commit/c1b4219b761386cf7259fd282396cfc1926a4c1f", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;", "committedDate": "2020-10-21T13:28:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5Mzc5OQ==", "url": "https://github.com/crate/crate/pull/10686#discussion_r509293799", "bodyText": "Maybe this could be rephrased to convey the user perspective a bit better. Something like this?\n\nFixed an issue that caused an error when a client using the PostgreSQL wire protocol is used to retrieve array values containing a escaped double quotes. For example, the JDBC client failed with Can't extract array data from JDBC array.\n\nNot sure if it's an improvement.", "author": "mfussenegger", "createdAt": "2020-10-21T13:42:30Z", "path": "docs/appendices/release-notes/unreleased.rst", "diffHunk": "@@ -58,4 +58,5 @@ None\n Fixes\n =====\n \n-None\n+- Fixed encoding string array type values that contain escaped double\n+  quotes. The issue occurred when using the PostgreSQL wire protocol.", "originalCommit": "c1b4219b761386cf7259fd282396cfc1926a4c1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5NTE5Mw==", "url": "https://github.com/crate/crate/pull/10686#discussion_r509295193", "bodyText": "\ud83d\udc4d tnx, will use this changelog entry", "author": "kovrus", "createdAt": "2020-10-21T13:44:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5Mzc5OQ=="}], "type": "inlineReview"}, {"oid": "9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "url": "https://github.com/crate/crate/commit/9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;", "committedDate": "2020-10-21T13:49:03Z", "type": "commit"}, {"oid": "9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "url": "https://github.com/crate/crate/commit/9eb483cb6c426a8b1e5a5873566873d8b73d36e2", "message": "Fix PgArray#encodeAsUTF8Text for escaped double quotes.\n\nThe issue occurred only when the pg wire protocol.\nThe querying of string arrays that contain values with\nescaped double quotes would fail. For example, the following\nselect query fails because the string representation of the\npg array is not convertible to internal array string type\ndue to the wrong encoding::\n\n    CREATE TABLE t (obj OBJECT(DYNAMIC));\n    INSERT INTO t VALUES('{\"k\":[{\"k\":\" foo\\\" \"}]}');\n    SELECT obj['k'] FROM t;", "committedDate": "2020-10-21T13:49:03Z", "type": "forcePushed"}]}