{"pr_number": 9946, "pr_title": "Merge HttpTransportPlugin with Netty4Plugin", "pr_createdAt": "2020-05-13T14:07:57Z", "pr_url": "https://github.com/crate/crate/pull/9946", "timeline": [{"oid": "102a78310db1a43bec8f1504b997395d89f255cc", "url": "https://github.com/crate/crate/commit/102a78310db1a43bec8f1504b997395d89f255cc", "message": "Merge HttpTransportPlugin with Netty4Plugin\n\nInstead of extending the `Netty4Http..` classes with sub-classes we can\nnow simply extend the functionality as needed.", "committedDate": "2020-05-14T08:29:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDk3NTg1Mg==", "url": "https://github.com/crate/crate/pull/9946#discussion_r424975852", "bodyText": "looks good to me \ud83d\udc4d\nthis setting was not used?", "author": "kovrus", "createdAt": "2020-05-14T08:53:30Z", "path": "server/src/main/java/io/crate/plugin/HttpTransportPlugin.java", "diffHunk": "@@ -1,116 +0,0 @@\n-/*\n- * Licensed to CRATE Technology GmbH (\"Crate\") under one or more contributor\n- * license agreements.  See the NOTICE file distributed with this work for\n- * additional information regarding copyright ownership.  Crate licenses\n- * this file to you under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.  You may\n- * obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n- * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n- * License for the specific language governing permissions and limitations\n- * under the License.\n- *\n- * However, if you have executed another commercial license agreement\n- * with Crate these terms will supersede the license and you may use the\n- * software solely pursuant to the terms of the relevant commercial agreement.\n- */\n-\n-package io.crate.plugin;\n-\n-import io.crate.protocols.http.CrateNettyHttpServerTransport;\n-import org.elasticsearch.client.Client;\n-import org.elasticsearch.client.node.NodeClient;\n-import org.elasticsearch.cluster.service.ClusterService;\n-import org.elasticsearch.common.io.stream.NamedWriteableRegistry;\n-import org.elasticsearch.common.network.NetworkService;\n-import org.elasticsearch.common.settings.Setting;\n-import org.elasticsearch.common.settings.Settings;\n-import org.elasticsearch.common.util.BigArrays;\n-import org.elasticsearch.common.xcontent.NamedXContentRegistry;\n-import org.elasticsearch.env.Environment;\n-import org.elasticsearch.env.NodeEnvironment;\n-import org.elasticsearch.http.HttpServerTransport;\n-import org.elasticsearch.indices.breaker.CircuitBreakerService;\n-import org.elasticsearch.plugins.ActionPlugin;\n-import org.elasticsearch.plugins.NetworkPlugin;\n-import org.elasticsearch.plugins.Plugin;\n-import org.elasticsearch.threadpool.ThreadPool;\n-\n-import java.util.Collection;\n-import java.util.Collections;\n-import java.util.List;\n-import java.util.Map;\n-import java.util.function.Supplier;\n-\n-import static org.elasticsearch.common.network.NetworkModule.HTTP_TYPE_KEY;\n-import static org.elasticsearch.http.HttpTransportSettings.SETTING_HTTP_COMPRESSION;\n-\n-\n-public class HttpTransportPlugin extends Plugin implements NetworkPlugin, ActionPlugin {\n-\n-    private static final String CRATE_HTTP_TRANSPORT_NAME = \"crate\";\n-\n-    private final PipelineRegistry pipelineRegistry;\n-\n-    public HttpTransportPlugin(Settings settings) {\n-        this.pipelineRegistry = new PipelineRegistry(settings);\n-    }\n-\n-    public String name() {\n-        return \"http\";\n-    }\n-\n-    public String description() {\n-        return \"Plugin for extending HTTP transport\";\n-    }\n-\n-    @Override\n-    public Collection<Object> createComponents(Client client,\n-                                               ClusterService clusterService,\n-                                               ThreadPool threadPool,\n-                                               NamedXContentRegistry xContentRegistry,\n-                                               Environment environment,\n-                                               NodeEnvironment nodeEnvironment,\n-                                               NamedWriteableRegistry namedWriteableRegistry) {\n-        // pipelineRegistry is returned here so that it's bound in guice and can be injected in other places\n-        return Collections.singletonList(pipelineRegistry);\n-    }\n-\n-    @Override\n-    public List<Setting<?>> getSettings() {\n-        return Collections.emptyList();\n-    }\n-\n-    @Override\n-    public Settings additionalSettings() {\n-        return Settings.builder()\n-            .put(HTTP_TYPE_KEY, CRATE_HTTP_TRANSPORT_NAME)", "originalCommit": "102a78310db1a43bec8f1504b997395d89f255cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDk3NzA5OQ==", "url": "https://github.com/crate/crate/pull/9946#discussion_r424977099", "bodyText": "It is set here:\nhttps://github.com/crate/crate/pull/9946/files#diff-ce1c2ef0997d0c94964f483274f72f4aR100", "author": "mfussenegger", "createdAt": "2020-05-14T08:55:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDk3NTg1Mg=="}], "type": "inlineReview"}, {"oid": "881342ca84b4f4019fe2a2f8277c764075d5f44b", "url": "https://github.com/crate/crate/commit/881342ca84b4f4019fe2a2f8277c764075d5f44b", "message": "Merge HttpTransportPlugin with Netty4Plugin\n\nInstead of extending the `Netty4Http..` classes with sub-classes we can\nnow simply extend the functionality as needed.", "committedDate": "2020-05-14T09:24:09Z", "type": "commit"}, {"oid": "881342ca84b4f4019fe2a2f8277c764075d5f44b", "url": "https://github.com/crate/crate/commit/881342ca84b4f4019fe2a2f8277c764075d5f44b", "message": "Merge HttpTransportPlugin with Netty4Plugin\n\nInstead of extending the `Netty4Http..` classes with sub-classes we can\nnow simply extend the functionality as needed.", "committedDate": "2020-05-14T09:24:09Z", "type": "forcePushed"}]}