{"pr_number": 10359, "pr_title": "Fix flaky GroupByAggregateTest#testGroupByUnknownGroupByColumn test", "pr_createdAt": "2020-08-12T13:46:19Z", "pr_url": "https://github.com/crate/crate/pull/10359", "timeline": [{"oid": "6b894d67a67b92aae111f27b21007278b4fa59b0", "url": "https://github.com/crate/crate/commit/6b894d67a67b92aae111f27b21007278b4fa59b0", "message": "Fix flaky GroupByAggregateTest#testGroupByUnknownGroupByColumn test\n\nThis adapts the flaky GroupByUnknownGroupByColumn test to its\noriginal behaviour checking only the error message and not\nthe type of exception.", "committedDate": "2020-08-12T13:48:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTM0Mw==", "url": "https://github.com/crate/crate/pull/10359#discussion_r469275343", "bodyText": "See original version \n  \n    \n      crate/server/src/test/java/io/crate/integrationtests/GroupByAggregateTest.java\n    \n    \n         Line 672\n      in\n      8ad9ecf\n    \n    \n    \n    \n\n        \n          \n           expectedException.expectMessage(\"Cannot GROUP BY type: undefined\");", "author": "mkleen", "createdAt": "2020-08-12T13:52:03Z", "path": "server/src/test/java/io/crate/integrationtests/GroupByAggregateTest.java", "diffHunk": "@@ -676,8 +677,9 @@ public void testGroupByUnknownResultColumn() throws Exception {\n     @Test\n     public void testGroupByUnknownGroupByColumn() throws Exception {", "originalCommit": "6b894d67a67b92aae111f27b21007278b4fa59b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI5OTcyOQ==", "url": "https://github.com/crate/crate/pull/10359#discussion_r469299729", "bodyText": "The error that is raised:\nCaused by: SQLActionException: 400 Bad Request 4000 SQLParseException: Couldn't create executionContexts from\nNodeOperations: [1=>NodeOp{ phase{id=1/distributed merge, nodes=[lRtAi887SCSp47-zAA2w-Q], dist=BROADCAST}, downstreamNodes=[pL8El7-xRqeJ54t7h40GKw], downstreamPhase=2, downstreamInputId=0}, 0=>NodeOp{ phase{id=0/collect, nodes=[lRtAi887SCSp47-zAA2w-Q], dist=MODULO}, downstreamNodes=[lRtAi887SCSp47-zAA2w-Q], downstreamPhase=1, downstreamInputId=0}]\nLeafs: []\ntarget-sources: [2=>[1], 1=>[0]]\noriginal-error: UnsupportedOperationException: Cannot GROUP BY type: undefined\n\nIs not an error that the user should ever see, as it points to a illegal execution plan.\nAlthough this change here is okay to fix the flakyness, I think we need to follow up here and also fix the error handling internally.", "author": "mfussenegger", "createdAt": "2020-08-12T14:25:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTM0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDkzNQ==", "url": "https://github.com/crate/crate/pull/10359#discussion_r469304935", "bodyText": "I created a ticket for that in the board.", "author": "mkleen", "createdAt": "2020-08-12T14:32:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTM0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc1OTAxNw==", "url": "https://github.com/crate/crate/pull/10359#discussion_r484759017", "bodyText": "So i think the error message should point out that it is impossible to group by the non-existing column details_ignored['lol'] . Currently we get a type error (undefined) which is not ideal.", "author": "mkleen", "createdAt": "2020-09-08T08:54:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTM0Mw=="}], "type": "inlineReview"}, {"oid": "8223b4fae322c80ef19be6919cb3b416a48a388c", "url": "https://github.com/crate/crate/commit/8223b4fae322c80ef19be6919cb3b416a48a388c", "message": "Fix flaky GroupByAggregateTest#testGroupByUnknownGroupByColumn test\n\nThis adapts the flaky GroupByUnknownGroupByColumn test to its\noriginal behaviour checking only the error message and not\nthe type of exception.", "committedDate": "2020-08-13T07:06:17Z", "type": "forcePushed"}, {"oid": "9b6aecbc8daf2fdc63b5a2bf26352559ce40b006", "url": "https://github.com/crate/crate/commit/9b6aecbc8daf2fdc63b5a2bf26352559ce40b006", "message": "Fix flaky GroupByAggregateTest#testGroupByUnknownGroupByColumn test\n\nThis adapts the flaky GroupByUnknownGroupByColumn test to its\noriginal behaviour checking only the error message and not\nthe type of exception.", "committedDate": "2020-08-13T08:52:26Z", "type": "commit"}, {"oid": "9b6aecbc8daf2fdc63b5a2bf26352559ce40b006", "url": "https://github.com/crate/crate/commit/9b6aecbc8daf2fdc63b5a2bf26352559ce40b006", "message": "Fix flaky GroupByAggregateTest#testGroupByUnknownGroupByColumn test\n\nThis adapts the flaky GroupByUnknownGroupByColumn test to its\noriginal behaviour checking only the error message and not\nthe type of exception.", "committedDate": "2020-08-13T08:52:26Z", "type": "forcePushed"}]}