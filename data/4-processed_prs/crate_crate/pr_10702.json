{"pr_number": 10702, "pr_title": "Fix test_implicit_cast_ISO_formats_with_time_zone", "pr_createdAt": "2020-10-26T08:08:11Z", "pr_url": "https://github.com/crate/crate/pull/10702", "timeline": [{"oid": "427d5f3cb8f111650c3e35f7dc8a5b3309eaea83", "url": "https://github.com/crate/crate/commit/427d5f3cb8f111650c3e35f7dc8a5b3309eaea83", "message": "Fix test_implicit_cast_ISO_formats_with_time_zone\n\nNeed to account for daylight savings", "committedDate": "2020-10-26T08:22:54Z", "type": "commit"}, {"oid": "427d5f3cb8f111650c3e35f7dc8a5b3309eaea83", "url": "https://github.com/crate/crate/commit/427d5f3cb8f111650c3e35f7dc8a5b3309eaea83", "message": "Fix test_implicit_cast_ISO_formats_with_time_zone\n\nNeed to account for daylight savings", "committedDate": "2020-10-26T08:22:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNTI3MQ==", "url": "https://github.com/crate/crate/pull/10702#discussion_r511825271", "bodyText": "Shouldn't it always result in isTZ(3600000000L, 3600) for timezone CET?", "author": "seut", "createdAt": "2020-10-26T09:34:15Z", "path": "server/src/test/java/io/crate/types/TimeTZTypeTest.java", "diffHunk": "@@ -36,7 +37,10 @@ public void test_implicit_cast_null() {\n \n     @Test\n     public void test_implicit_cast_ISO_formats_with_time_zone() {\n-        assertThat(TimeTZType.INSTANCE.implicitCast(\"01:00:00     CET\"), isTZ(3600000000L, 7200));\n+        assertThat(\n+            TimeTZType.INSTANCE.implicitCast(\"01:00:00     CET\"),\n+            Matchers.anyOf(isTZ(3600000000L, 3600), isTZ(3600000000L, 7200))", "originalCommit": "427d5f3cb8f111650c3e35f7dc8a5b3309eaea83", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNjA1MQ==", "url": "https://github.com/crate/crate/pull/10702#discussion_r511826051", "bodyText": "Is this wrong and should be fixed inside the implementation?\nPostgreSQL:\npostgres=# select '13:59:59.999999 CET'::timetz;\n       timetz       \n--------------------\n 13:59:59.999999+01\n(1 row)\n\npostgres=# select '13:59:59.999999 CEST'::timetz;\n       timetz       \n--------------------\n 13:59:59.999999+02\n(1 row)", "author": "seut", "createdAt": "2020-10-26T09:35:33Z", "path": "docs/general/ddl/data-types.rst", "diffHunk": "@@ -487,15 +487,7 @@ Time zone syntax as defined by `ISO 8601 time zone designators`_.\n     +------------------+\n     SELECT 1 row in set (... sec)\n \n-    cr> select '13:59:59.999999 CET'::timetz;\n-    +-----------------------+\n-    | 13:59:59.999999+02:00 |", "originalCommit": "427d5f3cb8f111650c3e35f7dc8a5b3309eaea83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg0NjU0Mg==", "url": "https://github.com/crate/crate/pull/10702#discussion_r511846542", "bodyText": "The same result is now also returned by CrateDB:\ncrate=> select '13:59:59.999999 CET'::timetz;\n 13:59:59.999999+01:00\n-----------------------\n 13:59:59.999999+01:00\n(1 row)\n\nThe problem is that the output is in relation to UTC, and depending on the\ndaylight savings CET can be +2 or +1 hour.", "author": "mfussenegger", "createdAt": "2020-10-26T10:09:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNjA1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg0ODA4MQ==", "url": "https://github.com/crate/crate/pull/10702#discussion_r511848081", "bodyText": "It is indeed a bit confusing. From https://time.is/nl/CET\n\nCET alternates between UTC+1 (standard time) and UTC+2 (when daylight saving time (DST) is observed). All countries in the CET time zone observe DST (UTC+2) from 02:00 am on the last Sunday of March until 03:00 am on the last Sunday of October.\n\n\nWarning: Many sources define CET as a constant UTC+1. In common usage however, CET usually refers to the time observed in most of Europe, be it standard time or daylight saving time.", "author": "mfussenegger", "createdAt": "2020-10-26T10:11:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNjA1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg0ODkzMQ==", "url": "https://github.com/crate/crate/pull/10702#discussion_r511848931", "bodyText": "Hm I don't understand this as CET is always +1 and never +2 and opposite for CEST which is always +2. What do I miss? ;)\nAh ok, I was not aware of this and treat CET wrongly as a constant UTC+1.", "author": "seut", "createdAt": "2020-10-26T10:13:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgyNjA1MQ=="}], "type": "inlineReview"}]}