{"pr_number": 10831, "pr_title": "Improve more links within the documentation", "pr_createdAt": "2020-11-27T15:41:26Z", "pr_url": "https://github.com/crate/crate/pull/10831", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY2ODY5Mg==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531668692", "bodyText": "I don't know whether this will break something on the downstream docs infrastructure or if it is okay to just bump within this repository. Please let me know.", "author": "amotl", "createdAt": "2020-11-27T15:42:25Z", "path": "blackbox/requirements.txt", "diffHunk": "@@ -8,19 +8,19 @@ asyncpg>=0.20.1\n cr8>=0.19.1\n tqdm==4.24.0\n sphinx-csv-filter>=0.2.0\n-pycodestyle==2.4.0\n+pycodestyle==2.6.0\n zc.customdoctests==1.0.1\n minio>=5.0.0\n \n # packages for local dev\n \n-sphinx-autobuild==0.7.1\n+sphinx-autobuild==2020.9.1\n \n # the next section should mirror the RTD environment\n \n alabaster>=0.7,<0.8,!=0.7.5\n setuptools<41\n-sphinx==1.8.5\n+sphinx==3.3.1", "originalCommit": "d769055421023385743ed5578c52aef80294dfd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY3MTYyMg==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531671622", "bodyText": "FWIW, I don't see any brokenness on https://crate--10831.org.readthedocs.build/en/10831/, which apparently has been derived from this patch.", "author": "amotl", "createdAt": "2020-11-27T15:48:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY2ODY5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY3NTIyOA==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531675228", "bodyText": "Why is it now necessary to use :ref: in some places, but not in all?\nhttps://github.com/crate/crate/pull/10831/files#diff-ed2a6369cdf047f097bfca45fa6b4367d8a969567bdbfdfc3fd744d55af1a516R43 seems to still be working without it?", "author": "mfussenegger", "createdAt": "2020-11-27T15:56:11Z", "path": "docs/appendices/release-notes/4.2.0.rst", "diffHunk": "@@ -150,13 +150,13 @@ SQL Standard and PostgreSQL compatibility improvements\n   :ref:`server_version <conf-session-server_version>` read-only session\n   settings.\n \n-- Added the `pg_catalog.pg_proc <postgres_pg_catalog>`_ table.\n+- Added the :ref:`pg_catalog.pg_proc <postgres_pg_catalog>` table.", "originalCommit": "d769055421023385743ed5578c52aef80294dfd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY3OTY3Nw==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531679677", "bodyText": "Inline links like `text <data-type-text_>`_ point to shortcuts like .. _data-type-text: lalala within the same .rst file (usually), but :ref: links resolve against the whole reference database across the whole tree.\nMany of them have been wrong and did not resolve properly but have apparently not been detected by the linkchecker of Sphinx 1.x. For example, try these at [1]:\n\nAdded the pg_catalog.pg_proc table.\nAdded the pg_catalog.pg_range table.\nAdded the pg_catalog.pg_enum table.\n\n[1] https://crate.io/docs/crate/reference/en/4.3/appendices/release-notes/4.2.0.html#sql-standard-and-postgresql-compatibility-improvements", "author": "amotl", "createdAt": "2020-11-27T16:06:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY3NTIyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY5Nzc0MA==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531697740", "bodyText": "this is an important point, @amotl\nlinks to internal labels should always be styled:\n:ref:\"link text <label-text>\"\n\nthis makes it clear they are internal links, and it also activates a different sort of internal cross-reference checking that does not take place if you are linking to bare URLs (absolute or relative)\nlinks to external URLs should always be styled:\n`link text`_\n\n[...]\n\n.. _link text: http://example.com/\n\nnever inline, like this:\n`link text <http://example.com/>`_\n\n(in case you take umbrage at this point: there will always be valid counterexamples to any style guide. \"'A foolish consistency is the hobgoblin of little minds...\", etc, etc)\nif you wanted to link to http://example.com/, but didn't want to duplicate the URL at the bottom of the file. you can do this:\n.. _link text: http://example.com/\n.. _different link text: `link text`_\n\n(yes you read that right, the second line defines the link by pointing to the previous link. @seut taught me this trick and it is awesome)\nthen you do:\n`link text`_, `different link text`_\n\nso the style for external links remains consistent\nthe stuff that I wrote, and the stuff that you wrote, combined would make a useful addition to https://github.com/crate/crate-docs/blob/master/style/rst.rst, I think. would you like to draft a PR, @amotl, or should I? happy to collab <3\n\nfootnote: anonymous links should be avoided altogether, but there are a few instances (typically involving long lists) where using them is genuinely less ugly than the alternatives", "author": "norosa", "createdAt": "2020-11-27T16:53:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY3NTIyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMDAyOA==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531700028", "bodyText": "the stuff that I wrote, and the stuff that you wrote, combined would make a useful addition to https://github.com/crate/crate-docs/blob/master/style/rst.rst, I think. would you like to draft a PR, @amotl, or should I? happy to collab <3\n\nI don't think we need to reinvent the rst doc or sphinx doc. We just need to get the link checker working correctly.", "author": "mfussenegger", "createdAt": "2020-11-27T16:59:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY3NTIyOA=="}], "type": "inlineReview"}, {"oid": "41da02f78ec3e3e3fc7c2c1820816972d54c9221", "url": "https://github.com/crate/crate/commit/41da02f78ec3e3e3fc7c2c1820816972d54c9221", "message": "Improve more links within the documentation\n\nWhen using Sphinx 3.3.1, the linkchecker became even more capable\nand reported many more broken links. For example, URLs derived\nfrom inline links within reStructuredText became visible.\n\nAlso, by using the \"--keep-going\" option, the report includes _all_\nbroken links instead of just one as before and \"-q\" reduces all\nnoise about the good/non-broken links. This tremendously helps when aiming to mitigate all errors coming from this within a single shot.", "committedDate": "2020-11-27T16:13:38Z", "type": "forcePushed"}, {"oid": "7802d6e4f71a0c5ca86e2d897ec09a6d460fe760", "url": "https://github.com/crate/crate/commit/7802d6e4f71a0c5ca86e2d897ec09a6d460fe760", "message": "Improve more links within the documentation\n\nWhen using Sphinx 3.3.1, the linkchecker became even more capable\nand reported many more broken links. For example, URLs derived\nfrom inline links within reStructuredText became visible.\n\nAlso, by using the \"--keep-going\" option, the report includes _all_\nbroken links instead of just one as before and \"-q\" reduces all\nnoise about the good/non-broken links. This tremendously helps when aiming to mitigate all errors coming from this within a single shot.", "committedDate": "2020-11-27T16:15:18Z", "type": "forcePushed"}, {"oid": "77eac555d3a46171398691f6eba3641ee8f98f68", "url": "https://github.com/crate/crate/commit/77eac555d3a46171398691f6eba3641ee8f98f68", "message": "Improve more links within the documentation\n\nWhen using Sphinx 3.3.1, the linkchecker became even more capable\nand reported many more broken links. For example, URLs derived\nfrom inline links within reStructuredText became visible.\n\nAlso, by using the \"--keep-going\" option, the report includes _all_\nbroken links instead of just one as before and \"-q\" reduces all\nnoise about the good/non-broken links. This tremendously helps when aiming to mitigate all errors coming from this within a single shot.", "committedDate": "2020-11-27T16:16:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMDgwNQ==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531700805", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      # Let's use Sphinx 3.x here because its link checker is much more capable.\n          \n          \n            \n                      # We default to sphinx 1.8 in blackbox/requirements.txt because that's what the crate-docs-theme needs. We want sphinx 3.x here for link checker improvements.", "author": "mfussenegger", "createdAt": "2020-11-27T17:01:50Z", "path": ".github/workflows/main.yml", "diffHunk": "@@ -42,6 +42,9 @@ jobs:\n           python -m pip install --upgrade pip setuptools\n           python -m pip install -r blackbox/requirements.txt\n \n+          # Let's use Sphinx 3.x here because its link checker is much more capable.", "originalCommit": "77eac555d3a46171398691f6eba3641ee8f98f68", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMTA1Nw==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531701057", "bodyText": "Could we remove the trailing whitespace in the marker declaration instead?", "author": "mfussenegger", "createdAt": "2020-11-27T17:02:28Z", "path": "docs/general/ddl/data-types.rst", "diffHunk": "@@ -40,7 +40,7 @@ or collections.\n * `bigint <numeric types_>`_\n * `real <numeric types_>`_\n * `double precision <numeric types_>`_\n-* `text <data-type-text>`_\n+* `text <data-type-text_>`_", "originalCommit": "77eac555d3a46171398691f6eba3641ee8f98f68", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMzE4OA==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531703188", "bodyText": "Not sure I am following here. Which trailing whitespace are you referring to?", "author": "amotl", "createdAt": "2020-11-27T17:08:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMTA1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwOTY3NA==", "url": "https://github.com/crate/crate/pull/10831#discussion_r531709674", "bodyText": "Ah sorry, due to the Github diff being underlined already I thought there was a whitespace at the end instead of an underscore. Nevermind :)", "author": "mfussenegger", "createdAt": "2020-11-27T17:28:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMTA1Nw=="}], "type": "inlineReview"}, {"oid": "e87f0879b6f754b83450c5d82263364d535fdfd7", "url": "https://github.com/crate/crate/commit/e87f0879b6f754b83450c5d82263364d535fdfd7", "message": "Improve more links within the documentation\n\nWhen using Sphinx 3.3.1, the linkchecker became even more capable\nand reported many more broken links. For example, URLs derived\nfrom inline links within reStructuredText became visible.\n\nAlso, by using the \"--keep-going\" option, the report includes _all_\nbroken links instead of just one as before and \"-q\" reduces all\nnoise about the good/non-broken links. This tremendously helps when aiming to mitigate all errors coming from this within a single shot.", "committedDate": "2020-11-27T17:09:55Z", "type": "commit"}, {"oid": "e87f0879b6f754b83450c5d82263364d535fdfd7", "url": "https://github.com/crate/crate/commit/e87f0879b6f754b83450c5d82263364d535fdfd7", "message": "Improve more links within the documentation\n\nWhen using Sphinx 3.3.1, the linkchecker became even more capable\nand reported many more broken links. For example, URLs derived\nfrom inline links within reStructuredText became visible.\n\nAlso, by using the \"--keep-going\" option, the report includes _all_\nbroken links instead of just one as before and \"-q\" reduces all\nnoise about the good/non-broken links. This tremendously helps when aiming to mitigate all errors coming from this within a single shot.", "committedDate": "2020-11-27T17:09:55Z", "type": "forcePushed"}]}