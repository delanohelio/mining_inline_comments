{"pr_number": 9788, "pr_title": "Allow using the system JDK  to compile code and execute tests.", "pr_createdAt": "2020-03-23T14:09:33Z", "pr_url": "https://github.com/crate/crate/pull/9788", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUyNjkyOA==", "url": "https://github.com/crate/crate/pull/9788#discussion_r396526928", "bodyText": "It is not needed. The compileJava and test tasks were configured in the root build file.", "author": "kovrus", "createdAt": "2020-03-23T15:14:29Z", "path": "es/build.gradle", "diffHunk": "@@ -13,20 +13,12 @@ subprojects {\n     }\n \n     compileJava {\n-        dependsOn rootProject.jdks.runtime", "originalCommit": "f6cbd50c4a886e04550be49fa5a1f2a4e58eae75", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUzNDU4MA==", "url": "https://github.com/crate/crate/pull/9788#discussion_r396534580", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Please note that the system JDK should be the same as the bundled JDK.\n          \n      \n    \n    \n  \n\nI'd remove this as it somewhat invalidates the previously mentioned use-case of doing a cross-platform build.", "author": "mfussenegger", "createdAt": "2020-03-23T15:24:23Z", "path": "devs/docs/basics.rst", "diffHunk": "@@ -74,15 +74,40 @@ To get a full list of all available tasks, run::\n \n     $ ./gradlew tasks\n \n-Such as CrateDB uses the pre-configured bundled version of OpenJDK_, it is\n-possible to run, compile, and test CrateDB by configuring the target JDK.\n-For instance::\n+By default, CrateDB uses the pre-configured bundled version of OpenJDK_. It\n+is also possible to run, compile, and test CrateDB by configuring the target\n+JDK. For instance::\n \n     $ ./gradlew distTar -Dbundled_jdk_os=linux \\\n                         -Dbundled_jdk_arch=aarch64 \\\n                         -Dbundled_jdk_vendor=adoptopenjdk \\\n                         -Dbundled_jdk_version=13.0.2+8\n \n+It is possible to compile the code base and run tests with the host system JDK.\n+To achieve that, pass the ``-DuseSystemJdk`` system parameter along with a\n+Gradle task. For example, to run unit tests with the host system JDK, execute\n+the following command::\n+\n+    $ ./gradlew test -DuseSystemJdk\n+\n+All the tasks related to packaging and releasing (``distTar``, ``release``) or\n+tasks that depend on them (``itest``) will ignore the ``-DuseSystemJdk``\n+parameter. This means that the compilation and test execution can be\n+done with the system JDK, but releasing and packaging will still use the\n+bundled JDK. The ``-DuseSystemJdk`` is useful for doing releases and\n+cross-platform builds. For instance, you can build a CrateDB package for\n+Windows with the corresponding to the platform bundled JDK on a Linux\n+machine::\n+\n+    $ ./gradlew distZip \\\n+                -Dbundled_jdk_os=windows \\\n+                -Dbundled_jdk_arch=x64 \\\n+                -Dbundled_jdk_vendor=adoptopenjdk \\\n+                -Dbundled_jdk_version=13.0.2+8 \\\n+                -DuseSystemJdk\n+\n+Please note that the system JDK should be the same as the bundled JDK.", "originalCommit": "f6cbd50c4a886e04550be49fa5a1f2a4e58eae75", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f2c43d8709d43d1795a222292b10cf56574b87a6", "url": "https://github.com/crate/crate/commit/f2c43d8709d43d1795a222292b10cf56574b87a6", "message": "Add the `releaseZip` gradle task.", "committedDate": "2020-03-23T15:31:30Z", "type": "forcePushed"}, {"oid": "9e85b58becdbb81c6f125a088835ec0c7159b128", "url": "https://github.com/crate/crate/commit/9e85b58becdbb81c6f125a088835ec0c7159b128", "message": "Add the ``useSystemJdk`` parameter for gradle compile and test tasks.\n\nBy default the bundled JDK is used to compile code and run tests.\nThe new system parameter makes Gradle to run its compile and test\ntask with the host system JDK.", "committedDate": "2020-03-24T09:07:23Z", "type": "commit"}, {"oid": "3dd3c074107152ba809dc835bef0c5a88f4bd3bb", "url": "https://github.com/crate/crate/commit/3dd3c074107152ba809dc835bef0c5a88f4bd3bb", "message": "Add the `releaseZip` gradle task.", "committedDate": "2020-03-24T09:07:23Z", "type": "commit"}, {"oid": "3dd3c074107152ba809dc835bef0c5a88f4bd3bb", "url": "https://github.com/crate/crate/commit/3dd3c074107152ba809dc835bef0c5a88f4bd3bb", "message": "Add the `releaseZip` gradle task.", "committedDate": "2020-03-24T09:07:23Z", "type": "forcePushed"}]}