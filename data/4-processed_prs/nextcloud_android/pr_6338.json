{"pr_number": 6338, "pr_title": "Removed legacy login", "pr_createdAt": "2020-06-23T05:48:47Z", "pr_url": "https://github.com/nextcloud/android/pull/6338", "timeline": [{"oid": "df92c54f288451449c0aad1c067a83eb417b575a", "url": "https://github.com/nextcloud/android/commit/df92c54f288451449c0aad1c067a83eb417b575a", "message": "Removed legacy login\ncleaned up a bit AuthenticatorActivity\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-23T09:08:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE2MDQ1Ng==", "url": "https://github.com/nextcloud/android/pull/6338#discussion_r444160456", "bodyText": "should be extracted to strings.xml", "author": "AndyScherzinger", "createdAt": "2020-06-23T11:44:02Z", "path": "src/main/java/com/owncloud/android/authentication/AuthenticatorActivity.java", "diffHunk": "@@ -529,39 +449,19 @@ private void parseAndLoginFromWebView(String dataString) {\n         String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n         LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);\n \n-        if (loginUrlInfo != null) {\n-            try {\n-                if (mHostUrlInput != null) {\n-                    mHostUrlInput.setText(\"\");\n-                }\n-                mServerInfo.mBaseUrl = AuthenticatorUrlUtils.normalizeUrlSuffix(loginUrlInfo.serverAddress);\n-                webViewUser = loginUrlInfo.username;\n-                webViewPassword = loginUrlInfo.password;\n-            } catch (Exception e) {\n-                mServerStatusIcon = R.drawable.ic_alert;\n-                mServerStatusText = \"QR Code could not be read!\";\n-                showServerStatus();\n-            }\n-            checkOcServer();\n-        }\n-    }\n-\n-    private void populateLoginFields(String dataString) throws IllegalArgumentException {\n-        // check if it is cloud://login/\n-        if (dataString.startsWith(getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\")) {\n-            String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n-            LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);\n-\n-            if (loginUrlInfo != null) {\n-                mHostUrlInput.setText(loginUrlInfo.serverAddress);\n-                mUsernameInput.setText(loginUrlInfo.username);\n-                mPasswordInput.setText(loginUrlInfo.password);\n-\n-                if (loginUrlInfo.serverAddress != null && !mServerIsChecked) {\n-                    onUrlInputFocusLost();\n-                }\n+        try {\n+            if (mHostUrlInput != null) {\n+                mHostUrlInput.setText(\"\");\n             }\n+            mServerInfo.mBaseUrl = AuthenticatorUrlUtils.normalizeUrlSuffix(loginUrlInfo.serverAddress);\n+            webViewUser = loginUrlInfo.username;\n+            webViewPassword = loginUrlInfo.password;\n+        } catch (Exception e) {\n+            mServerStatusIcon = R.drawable.ic_alert;\n+            mServerStatusText = \"QR Code could not be read!\";", "originalCommit": "ef9876c0f75bc96d620f1b01dae9a8afec3af476", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE2MTgyNw==", "url": "https://github.com/nextcloud/android/pull/6338#discussion_r444161827", "bodyText": "like mentioned above, should be extracted to strings.xml", "author": "AndyScherzinger", "createdAt": "2020-06-23T11:46:39Z", "path": "src/main/java/com/owncloud/android/authentication/AuthenticatorActivity.java", "diffHunk": "@@ -2017,17 +1393,15 @@ public void onServiceConnected(ComponentName component, IBinder service) {\n                     String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n                     LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, data.toString());\n \n-                    if (loginUrlInfo != null) {\n-                        try {\n-                            mServerInfo.mBaseUrl = AuthenticatorUrlUtils.normalizeUrlSuffix(loginUrlInfo.serverAddress);\n-                            webViewUser = loginUrlInfo.username;\n-                            webViewPassword = loginUrlInfo.password;\n-                            doOnResumeAndBound();\n-                        } catch (Exception e) {\n-                            mServerStatusIcon = R.drawable.ic_alert;\n-                            mServerStatusText = \"QR Code could not be read!\";\n-                            showServerStatus();\n-                        }\n+                    try {\n+                        mServerInfo.mBaseUrl = AuthenticatorUrlUtils.normalizeUrlSuffix(loginUrlInfo.serverAddress);\n+                        webViewUser = loginUrlInfo.username;\n+                        webViewPassword = loginUrlInfo.password;\n+                        doOnResumeAndBound();\n+                    } catch (Exception e) {\n+                        mServerStatusIcon = R.drawable.ic_alert;\n+                        mServerStatusText = \"QR Code could not be read!\";", "originalCommit": "ef9876c0f75bc96d620f1b01dae9a8afec3af476", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4d5136424b3f34306484d53f9e7ddd8ce7517d19", "url": "https://github.com/nextcloud/android/commit/4d5136424b3f34306484d53f9e7ddd8ce7517d19", "message": "changes due to CR\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-25T13:41:52Z", "type": "forcePushed"}, {"oid": "58ba15ac95ebf367033033bc83ca5419f9efd0a9", "url": "https://github.com/nextcloud/android/commit/58ba15ac95ebf367033033bc83ca5419f9efd0a9", "message": "Removed legacy login\ncleaned up a bit AuthenticatorActivity\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-25T20:57:22Z", "type": "commit"}, {"oid": "7ed4e2b24e2113d4c8eb695f34abcd69d0440bc7", "url": "https://github.com/nextcloud/android/commit/7ed4e2b24e2113d4c8eb695f34abcd69d0440bc7", "message": "changes due to CR\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-25T20:57:48Z", "type": "commit"}, {"oid": "7ed4e2b24e2113d4c8eb695f34abcd69d0440bc7", "url": "https://github.com/nextcloud/android/commit/7ed4e2b24e2113d4c8eb695f34abcd69d0440bc7", "message": "changes due to CR\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-25T20:57:48Z", "type": "forcePushed"}, {"oid": "e0d56761518fa7041ce00c8203b86bac5f0d1c40", "url": "https://github.com/nextcloud/android/commit/e0d56761518fa7041ce00c8203b86bac5f0d1c40", "message": "Drone: update FindBugs results to reflect reduced error/warning count [skip ci]\n\nSigned-off-by: nextcloud-android-bot <android@nextcloud.com>", "committedDate": "2020-06-25T21:18:34Z", "type": "commit"}]}