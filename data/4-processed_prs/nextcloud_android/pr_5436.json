{"pr_number": 5436, "pr_title": "Make user model parcelable", "pr_createdAt": "2020-02-09T11:39:18Z", "pr_url": "https://github.com/nextcloud/android/pull/5436", "timeline": [{"oid": "a20454522d275d4daab7d50f9ae3d0bc103a9915", "url": "https://github.com/nextcloud/android/commit/a20454522d275d4daab7d50f9ae3d0bc103a9915", "message": "Make user model parcelable", "committedDate": "2020-02-09T11:51:37Z", "type": "forcePushed"}, {"oid": "6378f3b7c8910032ebf5d490dcd8d0f5e1aad506", "url": "https://github.com/nextcloud/android/commit/6378f3b7c8910032ebf5d490dcd8d0f5e1aad506", "message": "Make user model parcelable\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>", "committedDate": "2020-02-09T22:57:58Z", "type": "forcePushed"}, {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83", "url": "https://github.com/nextcloud/android/commit/ef35c38d09cdec29481034704b555a7a6be12e83", "message": "Make user model parcelable\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>", "committedDate": "2020-02-09T23:34:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMTI5OA==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377021298", "bodyText": "That is not a valid accountName, it should be test@nextloud.localhost.localdomain.", "author": "tobiasKaminsky", "createdAt": "2020-02-10T12:01:23Z", "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+package com.nextcloud.client.account\n+\n+import android.accounts.Account\n+import android.net.Uri\n+import android.os.Parcel\n+import com.owncloud.android.lib.common.OwnCloudAccount\n+import com.owncloud.android.lib.common.OwnCloudBasicCredentials\n+import com.owncloud.android.lib.resources.status.OwnCloudVersion\n+import org.junit.Assert.assertEquals\n+import org.junit.Assert.assertFalse\n+import org.junit.Assert.assertNotSame\n+import org.junit.Assert.assertTrue\n+import org.junit.Before\n+import org.junit.Test\n+import java.net.URI\n+\n+class RegisteredUserTest {\n+\n+    private companion object {\n+        fun buildTestUser(accountName: String): RegisteredUser {\n+            val uri = Uri.parse(\"https://nextcloud.localhost.localdomain\")\n+            val credentials = OwnCloudBasicCredentials(\"user\", \"pass\")\n+            val account = Account(accountName, \"test-type\")\n+            val ownCloudAccount = OwnCloudAccount(uri, credentials)\n+            val server = Server(\n+                uri = URI(uri.toString()),\n+                version = OwnCloudVersion.nextcloud_17\n+            )\n+            return RegisteredUser(\n+                account = account,\n+                ownCloudAccount = ownCloudAccount,\n+                server = server\n+            )\n+        }\n+    }\n+\n+    private lateinit var user: RegisteredUser\n+\n+    @Before\n+    fun setUp() {\n+        user = buildTestUser(\"test.nextcloud.localhost.localdomain\")", "originalCommit": "ef35c38d09cdec29481034704b555a7a6be12e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODU5MA==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377218590", "bodyText": "account name is fixed", "author": "ezaquarii", "createdAt": "2020-02-10T17:49:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMTI5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjA3OQ==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377022079", "bodyText": "License", "author": "tobiasKaminsky", "createdAt": "2020-02-10T12:03:15Z", "path": "src/androidTest/java/com/nextcloud/client/account/AnonymousUserTest.kt", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.nextcloud.client.account", "originalCommit": "ef35c38d09cdec29481034704b555a7a6be12e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODY3NA==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377218674", "bodyText": "added licence", "author": "ezaquarii", "createdAt": "2020-02-10T17:49:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjEzMg==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377022132", "bodyText": "License", "author": "tobiasKaminsky", "createdAt": "2020-02-10T12:03:22Z", "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+package com.nextcloud.client.account", "originalCommit": "ef35c38d09cdec29481034704b555a7a6be12e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODc0NQ==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377218745", "bodyText": "added licence", "author": "ezaquarii", "createdAt": "2020-02-10T17:49:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjEzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyNDI0OA==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377024248", "bodyText": "Can we there then have also a screenshot test?\nIf you do not have time for this, just ping me, and I'll do it.", "author": "tobiasKaminsky", "createdAt": "2020-02-10T12:08:41Z", "path": "src/test/java/com/nextcloud/client/etm/TestEtmViewModel.kt", "diffHunk": "@@ -54,13 +55,15 @@ class TestEtmViewModel {\n         @get:Rule\n         val rule = InstantTaskExecutorRule()\n \n+        protected lateinit var platformAccountManager: AccountManager\n         protected lateinit var sharedPreferences: SharedPreferences\n         protected lateinit var vm: EtmViewModel\n \n         @Before\n         fun setUpBase() {\n             sharedPreferences = mock()\n-            vm = EtmViewModel(sharedPreferences)\n+            platformAccountManager = mock()\n+            vm = EtmViewModel(sharedPreferences, platformAccountManager)", "originalCommit": "ef35c38d09cdec29481034704b555a7a6be12e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMDM5MQ==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377220391", "bodyText": "@tobiasKaminsky View model does not contain any UI code - which makes unit testing very easy.\nIf we'd like to have a UI test for this part of the app, we'd need to test EtmAccountsFragment (and hosting activity).", "author": "ezaquarii", "createdAt": "2020-02-10T17:52:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyNDI0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQ5MjU1Mg==", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377492552", "bodyText": "Ah, I misread.", "author": "tobiasKaminsky", "createdAt": "2020-02-11T08:25:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyNDI0OA=="}], "type": "inlineReview"}, {"oid": "4ce54bc21ed9c8a1add24d2565a476c0f5530c49", "url": "https://github.com/nextcloud/android/commit/4ce54bc21ed9c8a1add24d2565a476c0f5530c49", "message": "Make user model parcelable\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>", "committedDate": "2020-02-10T15:49:12Z", "type": "commit"}, {"oid": "4ce54bc21ed9c8a1add24d2565a476c0f5530c49", "url": "https://github.com/nextcloud/android/commit/4ce54bc21ed9c8a1add24d2565a476c0f5530c49", "message": "Make user model parcelable\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>", "committedDate": "2020-02-10T15:49:12Z", "type": "forcePushed"}]}