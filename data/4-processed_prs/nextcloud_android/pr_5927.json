{"pr_number": 5927, "pr_title": "Bump shot from 3.1.0 to 4.1.1", "pr_createdAt": "2020-04-24T01:13:03Z", "pr_url": "https://github.com/nextcloud/android/pull/5927", "timeline": [{"oid": "7221131e037c266a06f381bb615c454eb3373109", "url": "https://github.com/nextcloud/android/commit/7221131e037c266a06f381bb615c454eb3373109", "message": "drone/ updateScreenshot update\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-04-29T11:55:19Z", "type": "forcePushed"}, {"oid": "49042f198c6dab670d2a4efce9ce72030517bbb4", "url": "https://github.com/nextcloud/android/commit/49042f198c6dab670d2a4efce9ce72030517bbb4", "message": "drone/ updateScreenshot update\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-05-08T12:03:46Z", "type": "forcePushed"}, {"oid": "19487c363a02dc907c16a862f50d5aa2d4d93873", "url": "https://github.com/nextcloud/android/commit/19487c363a02dc907c16a862f50d5aa2d4d93873", "message": "drone/ updateScreenshot update\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-05-08T13:28:01Z", "type": "forcePushed"}, {"oid": "07d8458a6471b0f8979a52034bd51aac164ec361", "url": "https://github.com/nextcloud/android/commit/07d8458a6471b0f8979a52034bd51aac164ec361", "message": "drone/ updateScreenshot update\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-05-27T15:06:18Z", "type": "forcePushed"}, {"oid": "e53b08461d2185fe9125e12a1506e007a8781b97", "url": "https://github.com/nextcloud/android/commit/e53b08461d2185fe9125e12a1506e007a8781b97", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-03T09:24:23Z", "type": "forcePushed"}, {"oid": "30ee8fc1c2fd5fde012b2ed004475dd06ebf3e35", "url": "https://github.com/nextcloud/android/commit/30ee8fc1c2fd5fde012b2ed004475dd06ebf3e35", "message": "wip\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-04T11:34:24Z", "type": "forcePushed"}, {"oid": "ee6e5311b83e62ba92ba5dd52bdd01ce530961b7", "url": "https://github.com/nextcloud/android/commit/ee6e5311b83e62ba92ba5dd52bdd01ce530961b7", "message": "Bump shot from 3.1.0 to 4.1.1\n\nBumps [shot](https://github.com/karumi/shot) from 3.1.0 to 4.1.1.\n- [Release notes](https://github.com/karumi/shot/releases)\n- [Changelog](https://github.com/Karumi/Shot/blob/master/release.gradle)\n- [Commits](https://github.com/karumi/shot/compare/3.1.0...4.1.1)\n\nSigned-off-by: dependabot-preview[bot] <support@dependabot.com>", "committedDate": "2020-06-05T06:06:42Z", "type": "commit"}, {"oid": "d0f3a00637a99ee6a618961b67dd6eb365d33388", "url": "https://github.com/nextcloud/android/commit/d0f3a00637a99ee6a618961b67dd6eb365d33388", "message": "drone/ updateScreenshot update\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-05T06:06:42Z", "type": "commit"}, {"oid": "80d83e47214f99c4704345761db4e0d0e372f0d8", "url": "https://github.com/nextcloud/android/commit/80d83e47214f99c4704345761db4e0d0e372f0d8", "message": "split up unit&IT tests from screenshot tests\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-05T06:06:42Z", "type": "commit"}, {"oid": "80d83e47214f99c4704345761db4e0d0e372f0d8", "url": "https://github.com/nextcloud/android/commit/80d83e47214f99c4704345761db4e0d0e372f0d8", "message": "split up unit&IT tests from screenshot tests\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>", "committedDate": "2020-06-05T06:06:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwODc3Ng==", "url": "https://github.com/nextcloud/android/pull/5927#discussion_r435708776", "bodyText": "Issue found: This word is outside of quotes. Did you intend to 'nest '\"'single quotes'\"' instead'?", "author": "nextcloud-android-bot", "createdAt": "2020-06-05T06:10:25Z", "path": "scripts/updateScreenshots.sh", "diffHunk": "@@ -29,55 +29,84 @@ if [[ $IP = \"\" ]]; then\n fi\n \n ## wait for server to finish\n-scripts/wait_for_server.sh $IP\n-\n-## run on server\n-cp gradle.properties gradle.properties_\n-sed -i s\"/server/$IP/\" gradle.properties\n-scripts/wait_for_emulator.sh\n+scripts/wait_for_server.sh \"$IP\"\n \n # setup test server\n+docker exec uiComparison /bin/sh -c \"echo $IP server >> /etc/hosts\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user1 php /var/www/html/occ user:add --password-from-env --display-name='User One' user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user2 php /var/www/html/occ user:add --password-from-env --display-name='User Two' user2\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user3 php /var/www/html/occ user:add --password-from-env --display-name='User Three' user3\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ user:setting user2 files quota 1G\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:add users\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user2\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/activity.git /var/www/html/apps/activity/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable activity\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/text.git /var/www/html/apps/text/\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable text\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n-docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/end_to_end_encryption/  /var/www/html/apps/end_to_end_encryption/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable end_to_end_encryption\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n+#docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n docker exec uiComparison /bin/sh -c \"/usr/local/bin/run.sh\"\n \n+## wait for server to finish\n+scripts/wait_for_server.sh \"$IP\"\n+\n+scripts/wait_for_emulator.sh\n+\n+# change server to ip on emulator\n+adb root\n+sleep 2\n+adb remount\n+sleep 2\n+adb shell \"mount -o remount,rw /system\"\n+sleep 2\n+adb shell \"echo $IP server >> /system/etc/hosts\"\n+\n+sed -i s'#<bool name=\"is_beta\">false</bool>#<bool name=\"is_beta\">true</bool>#'g src/main/res/values/setup.xml", "originalCommit": "80d83e47214f99c4704345761db4e0d0e372f0d8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwODc4Mg==", "url": "https://github.com/nextcloud/android/pull/5927#discussion_r435708782", "bodyText": "Issue found: This word is outside of quotes. Did you intend to 'nest '\"'single quotes'\"' instead'?", "author": "nextcloud-android-bot", "createdAt": "2020-06-05T06:10:27Z", "path": "scripts/updateScreenshots.sh", "diffHunk": "@@ -29,55 +29,84 @@ if [[ $IP = \"\" ]]; then\n fi\n \n ## wait for server to finish\n-scripts/wait_for_server.sh $IP\n-\n-## run on server\n-cp gradle.properties gradle.properties_\n-sed -i s\"/server/$IP/\" gradle.properties\n-scripts/wait_for_emulator.sh\n+scripts/wait_for_server.sh \"$IP\"\n \n # setup test server\n+docker exec uiComparison /bin/sh -c \"echo $IP server >> /etc/hosts\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user1 php /var/www/html/occ user:add --password-from-env --display-name='User One' user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user2 php /var/www/html/occ user:add --password-from-env --display-name='User Two' user2\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user3 php /var/www/html/occ user:add --password-from-env --display-name='User Three' user3\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ user:setting user2 files quota 1G\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:add users\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user2\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/activity.git /var/www/html/apps/activity/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable activity\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/text.git /var/www/html/apps/text/\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable text\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n-docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/end_to_end_encryption/  /var/www/html/apps/end_to_end_encryption/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable end_to_end_encryption\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n+#docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n docker exec uiComparison /bin/sh -c \"/usr/local/bin/run.sh\"\n \n+## wait for server to finish\n+scripts/wait_for_server.sh \"$IP\"\n+\n+scripts/wait_for_emulator.sh\n+\n+# change server to ip on emulator\n+adb root\n+sleep 2\n+adb remount\n+sleep 2\n+adb shell \"mount -o remount,rw /system\"\n+sleep 2\n+adb shell \"echo $IP server >> /system/etc/hosts\"\n+\n+sed -i s'#<bool name=\"is_beta\">false</bool>#<bool name=\"is_beta\">true</bool>#'g src/main/res/values/setup.xml\n+\n ## update/create all screenshots\n-./gradlew executeScreenshotTests -Precord\n+#./gradlew gplayDebugExecuteScreenshotTests -Precord \\\n+#-Pandroid.testInstrumentationRunnerArguments.annotation=com.owncloud.android.utils.ScreenshotTest\n \n ## update screenshots in a class\n-#./gradlew executeScreenshotTests \\\n+#./gradlew gplayDebugExecuteScreenshotTests \\\n #-Precord \\\n #-Pandroid.testInstrumentationRunnerArguments.class=\\\n #com.owncloud.android.ui.dialog.SyncFileNotEnoughSpaceDialogFragmentTest\n \n ## update single screenshot within a class\n-#./gradlew executeScreenshotTests \\\n+#./gradlew gplayDebugExecuteScreenshotTests \\\n #-Precord \\\n #-Pandroid.testInstrumentationRunnerArguments.class=\\\n-#com.owncloud.android.ui.dialog.SyncFileNotEnoughSpaceDialogFragmentTest#showNotEnoughSpaceDialogForFile\n+#com.nextcloud.client.FileDisplayActivityIT#showShares\n+\n+resultCode=-1\n+retryCount=0\n+until [ $resultCode -eq 0 ] || [ $retryCount -gt 2 ]\n+do\n+  # test all screenshots\n+  ./gradlew gplayDebugExecuteScreenshotTests \\\n+  -Pandroid.testInstrumentationRunnerArguments.annotation=com.owncloud.android.utils.ScreenshotTest\n+\n+resultCode=$?\n+((retryCount++))\n+done\n \n-mv gradle.properties_ gradle.properties\n+sed -i s'#<bool name=\"is_beta\">true</bool>#<bool name=\"is_beta\">false</bool>#'g src/main/res/values/setup.xml", "originalCommit": "80d83e47214f99c4704345761db4e0d0e372f0d8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}