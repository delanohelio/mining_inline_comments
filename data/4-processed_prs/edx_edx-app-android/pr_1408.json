{"pr_number": 1408, "pr_title": "Add Rewind/Forward option in Video Player", "pr_createdAt": "2020-04-24T10:45:16Z", "pr_url": "https://github.com/edx/edx-app-android/pull/1408", "timeline": [{"oid": "0002d937136d398be8a392b63d66730f1225da06", "url": "https://github.com/edx/edx-app-android/commit/0002d937136d398be8a392b63d66730f1225da06", "message": "Address the PR", "committedDate": "2020-05-07T08:04:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjAwMTQ4Ng==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422001486", "bodyText": "Need a new line.", "author": "farhan-arshad-dev", "createdAt": "2020-05-08T07:54:43Z", "path": "OpenEdXMobile/res/drawable/ripple_effect.xml", "diffHunk": "@@ -0,0 +1,11 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<ripple xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:color=\"@color/transparent_white_20\"\n+    tools:targetApi=\"lollipop\">\n+    <item>\n+        <shape android:shape=\"oval\">\n+            <solid android:color=\"@color/transparent_white_20\" />\n+        </shape>\n+    </item>\n+</ripple>", "originalCommit": "c413aa10783b961706ff98419986139d09ea5516", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjAwOTA2Mg==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422009062", "bodyText": "IMO, We can use semi_transparent_gray_circle as background.", "author": "farhan-arshad-dev", "createdAt": "2020-05-08T08:11:49Z", "path": "OpenEdXMobile/res/layout/player_controller.xml", "diffHunk": "@@ -102,12 +90,81 @@\n         android:contentDescription=\"@string/video_player_previous\"\r\n         app:iconName=\"fa-chevron-circle-left\" />\r\n \r\n+    <androidx.constraintlayout.widget.ConstraintLayout\r\n+        android:layout_width=\"wrap_content\"\r\n+        android:layout_height=\"wrap_content\"\r\n+        android:layout_gravity=\"center\">\r\n+\r\n+        <View\r\n+            android:layout_width=\"@dimen/video_player_rewind_forward_time_padding\"\r\n+            android:layout_height=\"0dp\"\r\n+            app:layout_constraintStart_toStartOf=\"@+id/rewind_time\"\r\n+            app:layout_constraintTop_toTopOf=\"parent\"\r\n+            app:layout_constraintBottom_toBottomOf=\"parent\" />\r\n+\r\n+        <TextView\r\n+            android:id=\"@+id/rewind_time\"\r\n+            style=\"@style/video_player_advance_control_time\"\r\n+            android:text=\"@string/video_player_rewind_time_sec\"\r\n+            app:layout_constraintBottom_toBottomOf=\"parent\"\r\n+            app:layout_constraintEnd_toStartOf=\"@id/rewind\"\r\n+            app:layout_constraintTop_toTopOf=\"parent\" />\r\n+\r\n+        <com.joanzapata.iconify.widget.IconImageButton\r\n+            android:id=\"@+id/rewind\"\r\n+            style=\"@style/video_player_side_control\"\r\n+            android:background=\"@drawable/ripple_effect\"\r", "originalCommit": "c413aa10783b961706ff98419986139d09ea5516", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjAwOTg2Mg==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422009862", "bodyText": "IMO We move center buttons into a constraint layout instated of placing blank Views (without background).", "author": "farhan-arshad-dev", "createdAt": "2020-05-08T08:13:37Z", "path": "OpenEdXMobile/res/layout/player_controller.xml", "diffHunk": "@@ -102,12 +90,81 @@\n         android:contentDescription=\"@string/video_player_previous\"\r\n         app:iconName=\"fa-chevron-circle-left\" />\r\n \r\n+    <androidx.constraintlayout.widget.ConstraintLayout\r\n+        android:layout_width=\"wrap_content\"\r\n+        android:layout_height=\"wrap_content\"\r\n+        android:layout_gravity=\"center\">\r\n+\r\n+        <View\r", "originalCommit": "c413aa10783b961706ff98419986139d09ea5516", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjAxNDYyOA==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422014628", "bodyText": "There is no need of ripple tag, as there is no use of ripple in this case", "author": "farhan-arshad-dev", "createdAt": "2020-05-08T08:24:09Z", "path": "OpenEdXMobile/res/drawable/ripple_effect.xml", "diffHunk": "@@ -0,0 +1,11 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<ripple xmlns:android=\"http://schemas.android.com/apk/res/android\"", "originalCommit": "c413aa10783b961706ff98419986139d09ea5516", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjA0OTcxNQ==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422049715", "bodyText": "Make a common method for the animation, create instance only while clicking on the buttons.", "author": "farhan-arshad-dev", "createdAt": "2020-05-08T09:43:13Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/player/PlayerController.java", "diffHunk": "@@ -233,7 +253,59 @@ private void initControllerView(View v) {\n         installPrevNextListeners();\r\n \r\n         mTitleTextView = (TextView) v.findViewById(R.id.video_title);\r\n+        mRewindTimeTextView = (TextView) v.findViewById(R.id.rewind_time);\r\n+        mForwardTimeTextView = (TextView) v.findViewById(R.id.forward_time);\r\n         mTopBar = v.findViewById(R.id.video_top_bar);\r\n+\r\n+        initializeAnimations();\r\n+    }\r\n+\r\n+    private void initializeAnimations(){\r\n+        boolean isLTR = (ViewCompat.getLayoutDirection(getRootView()) == ViewCompat.LAYOUT_DIRECTION_LTR);\r\n+            // new TranslateAnimation (float fromXDelta,float toXDelta, float fromYDelta, float toYDelta)\r\n+        mForwardAnimation = new TranslateAnimation(0.0f, isLTR ? ANIMATION_DISPLACEMENT : -ANIMATION_DISPLACEMENT,\r", "originalCommit": "c413aa10783b961706ff98419986139d09ea5516", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjA1MTQwOQ==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422051409", "bodyText": "Create an animation instance here instated of creating Data Member.", "author": "farhan-arshad-dev", "createdAt": "2020-05-08T09:47:01Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/player/PlayerController.java", "diffHunk": "@@ -706,34 +779,68 @@ public void onInitializeAccessibilityNodeInfo(AccessibilityNodeInfo info) {\n     }\r\n \r\n     /**\r\n-     * Listener for the rewind 30 seconds button in the media player\r\n+     * Listener for the rewind 10 seconds button in the media player\r\n      */\r\n-    private View.OnClickListener mRewListener = new View.OnClickListener() {\r\n+    private View.OnClickListener mRewindListener = new View.OnClickListener() {\r\n         public void onClick(View v) {\r\n             if (mPlayer == null) {\r\n                 return;\r\n             }\r\n+            hideTimeText();\r\n+            if(mRewindAnimation != null){\r\n+                mRewindTimeTextView.startAnimation(mRewindAnimation);\r\n+            }\r\n             long pos = mPlayer.getCurrentPosition();\r\n             try{\r\n-                mPlayer.callPlayerSeeked(pos, pos-30000, true);\r\n+                mPlayer.callPlayerSeeked(pos, pos-10000, true);\r\n             }catch(Exception e){\r\n                 logger.error(e);\r\n             }\r\n-            \r\n-            // apply 30 seconds rewind\r\n-            pos -= (30 * 1000); // milliseconds\r\n+\r\n+            // apply 10 seconds rewind\r\n+            pos -= (10 * 1000); // milliseconds\r\n             mPlayer.seekTo(pos);\r\n             setProgress();\r\n \r\n             show();\r\n+        }\r\n+    };\r\n \r\n-            // callback this event\r\n-//          if (mEventListener != null) {\r\n-//              mEventListener.onSeek(pos);\r\n-//          }\r\n+    /**\r\n+     * Listener for the forward 15 seconds button in the media player\r\n+     */\r\n+    private View.OnClickListener mForwardListener = new View.OnClickListener() {\r\n+        public void onClick(View v) {\r\n+            if (mPlayer == null) {\r\n+                return;\r\n+            }\r\n+            hideTimeText();\r\n+           if(mForwardAnimation != null){\r\n+               mForwardTimeTextView.startAnimation(mForwardAnimation);\r", "originalCommit": "c413aa10783b961706ff98419986139d09ea5516", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjk2ODQ3Mg==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422968472", "bodyText": "No need to add margins, as the Play/Pause button is already in the circle. Also, delete the corresponding dimens.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T11:19:08Z", "path": "OpenEdXMobile/res/values/styles.xml", "diffHunk": "@@ -192,7 +192,8 @@\n         <item name=\"android:layout_height\">@dimen/video_player_pause_btn_height</item>\n         <item name=\"android:background\">@drawable/semi_transparent_gray_circle</item>\n         <item name=\"android:padding\">@dimen/video_player_pause_btn_padding</item>\n-        <item name=\"android:layout_gravity\">center</item>\n+        <item name=\"android:layout_marginStart\">@dimen/video_player_pause_left_margin</item>\n+        <item name=\"android:layout_marginEnd\">@dimen/video_player_pause_right_margin</item>", "originalCommit": "995c43fc2e98d1127d81d94a31c05ed63f1d8b3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjk2OTk1Ng==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422969956", "bodyText": "New margins are unused need to remove.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T11:21:52Z", "path": "OpenEdXMobile/res/values/dimens.xml", "diffHunk": "@@ -108,13 +110,16 @@\n     <dimen name=\"video_player_side_control_padding\">5dp</dimen>\n     <dimen name=\"video_player_control_left_margin\">10dp</dimen>\n     <dimen name=\"video_player_control_right_margin\">10dp</dimen>\n+    <dimen name=\"video_player_advance_control_left_margin\">20dp</dimen>\n+    <dimen name=\"video_player_advance_control_right_margin\">20dp</dimen>", "originalCommit": "995c43fc2e98d1127d81d94a31c05ed63f1d8b3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjk3MDExMA==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422970110", "bodyText": "unused better to remove.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T11:22:10Z", "path": "OpenEdXMobile/res/values/dimens.xml", "diffHunk": "@@ -108,13 +110,16 @@\n     <dimen name=\"video_player_side_control_padding\">5dp</dimen>\n     <dimen name=\"video_player_control_left_margin\">10dp</dimen>\n     <dimen name=\"video_player_control_right_margin\">10dp</dimen>\n+    <dimen name=\"video_player_advance_control_left_margin\">20dp</dimen>\n+    <dimen name=\"video_player_advance_control_right_margin\">20dp</dimen>\n     <dimen name=\"video_player_bottom_control_left_margin\">4dp</dimen>\n     <dimen name=\"video_player_bottom_control_right_margin\">4dp</dimen>\n     <dimen name=\"video_player_seekbar_height\">24dp</dimen>\n     <dimen name=\"video_player_seekbar_line_width\">4dp</dimen>\n     <dimen name=\"video_player_seekbar_right_margin\">6dp</dimen>\n     <dimen name=\"video_player_duration_padding\">4dp</dimen>\n     <dimen name=\"video_player_settings_divider_height\">@dimen/edx_divider_length</dimen>\n+    <dimen name=\"video_player_rewind_forward_time_padding\">50dp</dimen>", "originalCommit": "995c43fc2e98d1127d81d94a31c05ed63f1d8b3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjk3MjMxOQ==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422972319", "bodyText": "IMO better to add _text at the end that describes the style is used in text views.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T11:26:35Z", "path": "OpenEdXMobile/res/values/styles.xml", "diffHunk": "@@ -214,6 +215,14 @@\n         <item name=\"iconColor\">@color/white</item>\n     </style>\n \n+    <style name=\"video_player_advance_control_time\">", "originalCommit": "995c43fc2e98d1127d81d94a31c05ed63f1d8b3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjk3NDM4NQ==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422974385", "bodyText": "IMO isLTRDirection is better name.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T11:30:38Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/player/PlayerController.java", "diffHunk": "@@ -233,7 +253,42 @@ private void initControllerView(View v) {\n         installPrevNextListeners();\r\n \r\n         mTitleTextView = (TextView) v.findViewById(R.id.video_title);\r\n+        mRewindTimeTextView = (TextView) v.findViewById(R.id.rewind_time);\r\n+        mForwardTimeTextView = (TextView) v.findViewById(R.id.forward_time);\r\n         mTopBar = v.findViewById(R.id.video_top_bar);\r\n+\r\n+        initializeAnimations();\r\n+    }\r\n+\r\n+    private void initializeAnimations() {\r\n+        boolean isAnimLTR = (ViewCompat.getLayoutDirection(getRootView()) == ViewCompat.LAYOUT_DIRECTION_LTR);\r", "originalCommit": "995c43fc2e98d1127d81d94a31c05ed63f1d8b3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjk3NTYyNQ==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r422975625", "bodyText": "As per doc The repeat count is 0 by default. so better to remove this statement.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T11:33:12Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/player/PlayerController.java", "diffHunk": "@@ -233,7 +253,42 @@ private void initControllerView(View v) {\n         installPrevNextListeners();\r\n \r\n         mTitleTextView = (TextView) v.findViewById(R.id.video_title);\r\n+        mRewindTimeTextView = (TextView) v.findViewById(R.id.rewind_time);\r\n+        mForwardTimeTextView = (TextView) v.findViewById(R.id.forward_time);\r\n         mTopBar = v.findViewById(R.id.video_top_bar);\r\n+\r\n+        initializeAnimations();\r\n+    }\r\n+\r\n+    private void initializeAnimations() {\r\n+        boolean isAnimLTR = (ViewCompat.getLayoutDirection(getRootView()) == ViewCompat.LAYOUT_DIRECTION_LTR);\r\n+        mForwardAnimation = getSeekTimeAnimation(mForwardTimeTextView, isAnimLTR);\r\n+        mRewindAnimation = getSeekTimeAnimation(mRewindTimeTextView, !isAnimLTR);\r\n+    }\r\n+\r\n+    private TranslateAnimation getSeekTimeAnimation(TextView timeText, boolean isAnimLTR) {\r\n+        TranslateAnimation translateAnimation = new TranslateAnimation(0.0f,\r\n+                isAnimLTR ? ANIMATION_DISPLACEMENT : -ANIMATION_DISPLACEMENT, 0.0f, 0.0f);\r\n+        translateAnimation.setDuration(DEFAULT_ANIMATION_DURATION_MS); // animation duration, change accordingly\r\n+        translateAnimation.setInterpolator(new DecelerateInterpolator());\r\n+        translateAnimation.setRepeatCount(0); // animation repeat count\r", "originalCommit": "995c43fc2e98d1127d81d94a31c05ed63f1d8b3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA1MTIyOQ==", "url": "https://github.com/edx/edx-app-android/pull/1408#discussion_r423051229", "bodyText": "need to remove the comment as the method call is self-explanatory.", "author": "farhan-arshad-dev", "createdAt": "2020-05-11T13:46:50Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ViewAnimationUtil.java", "diffHunk": "@@ -97,4 +107,34 @@ public void onAnimationEnd(Animator animation) {\n                 });\n \n     }\n+\n+    /**\n+     * Create & return object moving animation based on direction\n+     * @param textView     the view to animate\n+     * @param isAnimLTR    true if screen required animation is LTR false else wise\n+     * @return {@linkplain TranslateAnimation} \n+     */\n+    public static TranslateAnimation getSeekTimeAnimation(TextView textView, boolean isAnimLTR) {\n+        TranslateAnimation translateAnimation = new TranslateAnimation(0.0f,\n+                isAnimLTR ? ANIMATION_DISPLACEMENT : -ANIMATION_DISPLACEMENT, 0.0f, 0.0f);\n+        translateAnimation.setDuration(DEFAULT_ANIMATION_DURATION_MS); // animation duration, change accordingly", "originalCommit": "2ef3773305a5de81bdc504538c33b2e266cf9b6d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0856ba2d6c15e25cb5fda8fa1a4d5c1af9f3bb9b", "url": "https://github.com/edx/edx-app-android/commit/0856ba2d6c15e25cb5fda8fa1a4d5c1af9f3bb9b", "message": "Add Rewind/Forward option in Video Player\n- LEARNER-7701\n- on clicking forward video will be forwarded for 15 sec\n- on clicking rewind video will be rewind for 10 sec", "committedDate": "2020-05-12T06:49:39Z", "type": "commit"}, {"oid": "0856ba2d6c15e25cb5fda8fa1a4d5c1af9f3bb9b", "url": "https://github.com/edx/edx-app-android/commit/0856ba2d6c15e25cb5fda8fa1a4d5c1af9f3bb9b", "message": "Add Rewind/Forward option in Video Player\n- LEARNER-7701\n- on clicking forward video will be forwarded for 15 sec\n- on clicking rewind video will be rewind for 10 sec", "committedDate": "2020-05-12T06:49:39Z", "type": "forcePushed"}]}