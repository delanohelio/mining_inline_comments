{"pr_number": 1392, "pr_title": "Fix exceptions when some config is not present + Code optimization", "pr_createdAt": "2020-03-31T12:48:44Z", "pr_url": "https://github.com/edx/edx-app-android/pull/1392", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk4MzE5NQ==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r402983195", "bodyText": "Extra import needs to remove.", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T12:53:06Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -1,11 +1,14 @@\n package org.edx.mobile.util\n \n import android.text.TextUtils\n+import androidx.annotation.NonNull", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk4MzI0Ng==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r402983246", "bodyText": "Extra import needs to remove.", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T12:53:11Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -1,11 +1,14 @@\n package org.edx.mobile.util\n \n import android.text.TextUtils\n+import androidx.annotation.NonNull\n import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n import com.google.gson.Gson\n import com.google.gson.reflect.TypeToken\n import org.edx.mobile.BuildConfig\n+import org.edx.mobile.core.IEdxEnvironment\n import java.util.*\n+import javax.inject.Inject", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk5OTU4MQ==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r402999581", "bodyText": "IMO: this would be the better code.\n        /**\n         * Utility method to check the Course Discovery status\n         *\n         * @param environment       Relevant configuration environment.\n         * @return true if Discovery enabled in configurations false else wise\n         */\n        fun isCourseDiscoveryEnabled(environment: IEdxEnvironment): Boolean {\n            return environment.config.discoveryConfig?.courseDiscoveryConfig?.isDiscoveryEnabled == true\n        }", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T13:20:25Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -27,6 +30,56 @@ class ConfigUtil {\n             return false\n         }\n \n+        /**\n+         * Utility method to check the Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Discovery enabled in configurations false else wise\n+         */\n+        fun isDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isDiscoveryEnabled == true\n+        }", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk5OTg5Ng==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r402999896", "bodyText": "IMO: this would be the better code.\n        /**\n         * Utility method to check the Degree Discovery status\n         *\n         * @param environment       Relevant configuration environment.\n         * @return true if Degree Discovery enabled in configurations false else wise\n         */\n        fun isDegreeDiscoveryEnabled(environment: IEdxEnvironment): Boolean {\n            return environment.config.discoveryConfig?.degreeDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n        }", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T13:20:52Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -27,6 +30,56 @@ class ConfigUtil {\n             return false\n         }\n \n+        /**\n+         * Utility method to check the Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Discovery enabled in configurations false else wise\n+         */\n+        fun isDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isDiscoveryEnabled == true\n+        }\n+\n+        /**\n+         * Utility method to check the Degree Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Degree Discovery enabled in configurations false else wise\n+         */\n+        fun isDegreeDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.degreeDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n+        }", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwMTIxNA==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r403001214", "bodyText": "IMO: this would be the better code.\n        /**\n         * Utility method to check the Course Webview Discovery status\n         *\n         * @param environment       Relevant configuration environment.\n         * @return true if Course Webview Discovery enabled in configurations false else wise\n         */\n        fun isCourseWebviewDiscoveryEnabled(environment: IEdxEnvironment): Boolean {\n            return environment.config.discoveryConfig?.courseDiscoveryConfig?.isWebviewDiscoveryEnabled == true\n        }", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T13:23:01Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -27,6 +30,56 @@ class ConfigUtil {\n             return false\n         }\n \n+        /**\n+         * Utility method to check the Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Discovery enabled in configurations false else wise\n+         */\n+        fun isDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isDiscoveryEnabled == true\n+        }\n+\n+        /**\n+         * Utility method to check the Degree Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Degree Discovery enabled in configurations false else wise\n+         */\n+        fun isDegreeDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.degreeDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n+        }\n+\n+        /**\n+         * Utility method to check the Webview Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Webview Discovery enabled in configurations false else wise\n+         */\n+        fun isWebviewDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isWebviewDiscoveryEnabled == true\n+        }", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwMjY3Ng==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r403002676", "bodyText": "IMO: this would be the better code.\n        /**\n         * Utility method to check the Program Discovery status\n         *\n         * @param environment       Relevant configuration environment.\n         * @return true if Program Discovery enabled in configurations false else wise\n         */\n        fun isProgramDiscoveryEnabled(environment: IEdxEnvironment): Boolean {\n            return environment.config.discoveryConfig?.programDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n        }", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T13:25:07Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -27,6 +30,56 @@ class ConfigUtil {\n             return false\n         }\n \n+        /**\n+         * Utility method to check the Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Discovery enabled in configurations false else wise\n+         */\n+        fun isDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isDiscoveryEnabled == true\n+        }\n+\n+        /**\n+         * Utility method to check the Degree Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Degree Discovery enabled in configurations false else wise\n+         */\n+        fun isDegreeDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.degreeDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n+        }\n+\n+        /**\n+         * Utility method to check the Webview Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Webview Discovery enabled in configurations false else wise\n+         */\n+        fun isWebviewDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isWebviewDiscoveryEnabled == true\n+        }\n+\n+        /**\n+         * Utility method to check the Program Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Program Discovery enabled in configurations false else wise\n+         */\n+        fun isProgramDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.programDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n+        }", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwMzU1MQ==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r403003551", "bodyText": "IMO: this would be the better code.\n        /**\n         * Utility method to check the Program Webview Discovery status\n         *\n         * @param environment       Relevant configuration environment.\n         * @return true if Program Webview Discovery enabled in configurations false else wise\n         */\n        fun isProgramWebviewDiscoveryEnabled(environment: IEdxEnvironment): Boolean {\n            return environment.config.discoveryConfig?.programDiscoveryConfig?.isWebviewDiscoveryEnabled == true\n        }", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T13:26:33Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -27,6 +30,56 @@ class ConfigUtil {\n             return false\n         }\n \n+        /**\n+         * Utility method to check the Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Discovery enabled in configurations false else wise\n+         */\n+        fun isDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isDiscoveryEnabled == true\n+        }\n+\n+        /**\n+         * Utility method to check the Degree Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Degree Discovery enabled in configurations false else wise\n+         */\n+        fun isDegreeDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.degreeDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n+        }\n+\n+        /**\n+         * Utility method to check the Webview Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Webview Discovery enabled in configurations false else wise\n+         */\n+        fun isWebviewDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.courseDiscoveryConfig?.isWebviewDiscoveryEnabled == true\n+        }\n+\n+        /**\n+         * Utility method to check the Program Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Program Discovery enabled in configurations false else wise\n+         */\n+        fun isProgramDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.programDiscoveryConfig?.isDiscoveryEnabled(environment) == true\n+        }\n+\n+        /**\n+         * Utility method to check the Program Webview Discovery status\n+         *\n+         * @param environment       Relevant configuration environment.\n+         * @return True if Program Webview Discovery enabled in configurations false else wise\n+         */\n+        fun isProgramWebviewDiscoveryEnabled(environment: IEdxEnvironment? = null): Boolean {\n+            return environment?.config?.discoveryConfig?.programDiscoveryConfig?.isWebviewDiscoveryEnabled == true\n+        }", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwNTUzMQ==", "url": "https://github.com/edx/edx-app-android/pull/1392#discussion_r403005531", "bodyText": "irrelevant code should not be changed, needs to revert this code.", "author": "farhan-arshad-dev", "createdAt": "2020-04-03T13:29:25Z", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -39,19 +92,19 @@ class ConfigUtil {\n             if (config.firebaseConfig.isEnabled) {\n                 val firebaseRemoteConfig = FirebaseRemoteConfig.getInstance()\n                 firebaseRemoteConfig.fetchAndActivate().addOnCompleteListener {\n-                        val whiteListedReleasesJson = firebaseRemoteConfig\n-                                .getString(AppConstants.FirebaseConstants.REV_934_WHITELISTED_RELEASES)\n-                        if (!TextUtils.isEmpty(whiteListedReleasesJson)) {\n-                            val whiteListedReleases = Gson().fromJson<ArrayList<String>>(whiteListedReleasesJson,\n-                                    object : TypeToken<ArrayList<String>>() {}.type)\n-                            // Check current release is white listed in firebase remote config\n-                            for (release in whiteListedReleases) {\n-                                if (BuildConfig.VERSION_NAME.equals(release, ignoreCase = true)) {\n-                                    listener.onCourseUpgradeResult(true)\n-                                    return@addOnCompleteListener\n-                                }\n+                    val whiteListedReleasesJson = firebaseRemoteConfig\n+                            .getString(AppConstants.FirebaseConstants.REV_934_WHITELISTED_RELEASES)\n+                    if (!TextUtils.isEmpty(whiteListedReleasesJson)) {\n+                        val whiteListedReleases = Gson().fromJson<ArrayList<String>>(whiteListedReleasesJson,\n+                                object : TypeToken<ArrayList<String>>() {}.type)\n+                        // Check current release is white listed in firebase remote config\n+                        for (release in whiteListedReleases) {\n+                            if (BuildConfig.VERSION_NAME.equals(release, ignoreCase = true)) {\n+                                listener.onCourseUpgradeResult(true)\n+                                return@addOnCompleteListener", "originalCommit": "9a422807d56a821de803541cca40eb788b5c7086", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3b4090f3ea02b9f30f77c6d8ca33bdede4d07ac6", "url": "https://github.com/edx/edx-app-android/commit/3b4090f3ea02b9f30f77c6d8ca33bdede4d07ac6", "message": "Fix exceptions when some config is not present + Code optimization\n- LEARNER-7456", "committedDate": "2020-04-03T13:59:27Z", "type": "forcePushed"}, {"oid": "adf88827c070d50dca89e87cb4e7c73e5f8f9d46", "url": "https://github.com/edx/edx-app-android/commit/adf88827c070d50dca89e87cb4e7c73e5f8f9d46", "message": "Fix exceptions when some config is not present + Code optimization\n- LEARNER-7456", "committedDate": "2020-04-03T14:54:00Z", "type": "commit"}, {"oid": "adf88827c070d50dca89e87cb4e7c73e5f8f9d46", "url": "https://github.com/edx/edx-app-android/commit/adf88827c070d50dca89e87cb4e7c73e5f8f9d46", "message": "Fix exceptions when some config is not present + Code optimization\n- LEARNER-7456", "committedDate": "2020-04-03T14:54:00Z", "type": "forcePushed"}]}