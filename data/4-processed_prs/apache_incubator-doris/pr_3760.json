{"pr_number": 3760, "pr_title": "Support external users to contribute udf", "pr_createdAt": "2020-06-03T09:00:38Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3760", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk0ODA5Ng==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r434948096", "bodyText": "License Header", "author": "morningman", "createdAt": "2020-06-04T01:52:39Z", "path": "custom_udf/CMakeLists.txt", "diffHunk": "@@ -0,0 +1,58 @@\n+cmake_minimum_required(VERSION 2.8.10)", "originalCommit": "41c869e650669a5a482cf95a6a0457c0bdfcf379", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxNzE1OA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r435017158", "bodyText": "Added", "author": "EmmyMiao87", "createdAt": "2020-06-04T06:22:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk0ODA5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk0ODE4NA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r434948184", "bodyText": "Modify the command", "author": "morningman", "createdAt": "2020-06-04T01:52:58Z", "path": "custom_udf/build_custom_udf.sh", "diffHunk": "@@ -0,0 +1,156 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+##############################################################", "originalCommit": "41c869e650669a5a482cf95a6a0457c0bdfcf379", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxNzI3Ng==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r435017276", "bodyText": "Modified", "author": "EmmyMiao87", "createdAt": "2020-06-04T06:22:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk0ODE4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1MjkwOA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r434952908", "bodyText": "chang it to 7.3.0", "author": "morningman", "createdAt": "2020-06-04T02:12:18Z", "path": "custom_udf/CMakeLists.txt", "diffHunk": "@@ -0,0 +1,58 @@\n+cmake_minimum_required(VERSION 2.8.10)\n+ \n+# set CMAKE_C_COMPILER, this must set before project command\n+if (DEFINED ENV{DORIS_GCC_HOME})\n+    set(CMAKE_C_COMPILER \"$ENV{DORIS_GCC_HOME}/bin/gcc\")\n+    set(CMAKE_CXX_COMPILER \"$ENV{DORIS_GCC_HOME}/bin/g++\")\n+    set(GCC_HOME $ENV{DORIS_GCC_HOME})\n+else()\n+    message(FATAL_ERROR \"DORIS_GCC_HOME environment variable is not set\")\n+endif()\n+\n+project(doris)\n+\n+# set CMAKE_BUILD_TYPE\n+if (NOT CMAKE_BUILD_TYPE)\n+    set(CMAKE_BUILD_TYPE RELEASE)\n+endif()\n+\n+string(TOUPPER ${CMAKE_BUILD_TYPE} CMAKE_BUILD_TYPE)\n+message(STATUS \"Build type is ${CMAKE_BUILD_TYPE}\")\n+\n+set(BASE_DIR \"${CMAKE_CURRENT_SOURCE_DIR}\")\n+set(ENV{DORIS_HOME} \"${BASE_DIR}/../\")\n+set(THIRDPARTY_DIR \"$ENV{DORIS_THIRDPARTY}/installed/\")\n+set(BUILD_DIR \"${CMAKE_CURRENT_BINARY_DIR}\")\n+set(SRC_DIR \"${BASE_DIR}/src/\")\n+set(OUTPUT_DIR \"${BASE_DIR}/output\")\n+\n+# Check gcc\n+if (CMAKE_CXX_COMPILER_ID STREQUAL \"GNU\")\n+    if (CMAKE_CXX_COMPILER_VERSION VERSION_LESS \"4.8.2\")", "originalCommit": "41c869e650669a5a482cf95a6a0457c0bdfcf379", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1MzQ0Mg==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r434953442", "bodyText": "Add comment to let user know that they can add their subdirectory here", "author": "morningman", "createdAt": "2020-06-04T02:13:51Z", "path": "custom_udf/CMakeLists.txt", "diffHunk": "@@ -0,0 +1,58 @@\n+cmake_minimum_required(VERSION 2.8.10)\n+ \n+# set CMAKE_C_COMPILER, this must set before project command\n+if (DEFINED ENV{DORIS_GCC_HOME})\n+    set(CMAKE_C_COMPILER \"$ENV{DORIS_GCC_HOME}/bin/gcc\")\n+    set(CMAKE_CXX_COMPILER \"$ENV{DORIS_GCC_HOME}/bin/g++\")\n+    set(GCC_HOME $ENV{DORIS_GCC_HOME})\n+else()\n+    message(FATAL_ERROR \"DORIS_GCC_HOME environment variable is not set\")\n+endif()\n+\n+project(doris)\n+\n+# set CMAKE_BUILD_TYPE\n+if (NOT CMAKE_BUILD_TYPE)\n+    set(CMAKE_BUILD_TYPE RELEASE)\n+endif()\n+\n+string(TOUPPER ${CMAKE_BUILD_TYPE} CMAKE_BUILD_TYPE)\n+message(STATUS \"Build type is ${CMAKE_BUILD_TYPE}\")\n+\n+set(BASE_DIR \"${CMAKE_CURRENT_SOURCE_DIR}\")\n+set(ENV{DORIS_HOME} \"${BASE_DIR}/../\")\n+set(THIRDPARTY_DIR \"$ENV{DORIS_THIRDPARTY}/installed/\")\n+set(BUILD_DIR \"${CMAKE_CURRENT_BINARY_DIR}\")\n+set(SRC_DIR \"${BASE_DIR}/src/\")\n+set(OUTPUT_DIR \"${BASE_DIR}/output\")\n+\n+# Check gcc\n+if (CMAKE_CXX_COMPILER_ID STREQUAL \"GNU\")\n+    if (CMAKE_CXX_COMPILER_VERSION VERSION_LESS \"4.8.2\")\n+        message(FATAL_ERROR \"Need GCC version at least 4.8.2\")\n+    endif()\n+\n+    if (CMAKE_CXX_COMPILER_VERSION VERSION_GREATER \"7.3.0\")\n+        message(STATUS \"GCC version is greater than 7.3.0, disable -Werror. Be careful with compile warnings.\")\n+    else()\n+        #   -Werror: compile warnings should be errors when using the toolchain compiler.\n+        set(CXX_GCC_FLAGS \"${CXX_GCC_FLAGS} -Werror\")\n+    endif()\n+elseif (NOT APPLE)\n+    message(FATAL_ERROR \"Compiler should be GNU\")\n+endif()\n+\n+# Just for clang-tidy:  -Wno-expansion-to-defined -Wno-deprecated-declaration\n+SET(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -fPIC -g -ggdb -std=c++11 -Wall -Werror -Wno-unused-variable -Wno-expansion-to-defined -Wno-deprecated-declarations -O3\")\n+message(STATUS \"Compiler Flags: ${CMAKE_CXX_FLAGS}\")\n+\n+# Include udf\n+include_directories($ENV{DORIS_HOME}/output/udf/include)\n+\n+# Set all libraries\n+add_library(udf STATIC IMPORTED)\n+set_target_properties(udf PROPERTIES IMPORTED_LOCATION $ENV{DORIS_HOME}/output/udf/lib/libDorisUdf.a)\n+", "originalCommit": "41c869e650669a5a482cf95a6a0457c0bdfcf379", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1NTAwMg==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r434955002", "bodyText": "parameter udf is meaningless", "author": "morningman", "createdAt": "2020-06-04T02:20:30Z", "path": "custom_udf/build_custom_udf.sh", "diffHunk": "@@ -0,0 +1,156 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+##############################################################\n+# This script is used to compile Apache Doris(incubating)\n+# Usage:\n+#    sh build.sh        build both Backend and Frontend.\n+#    sh build.sh -clean clean previous output and build.\n+#\n+# You need to make sure all thirdparty libraries have been\n+# compiled and installed correctly.\n+##############################################################\n+\n+set -eo pipefail\n+\n+ROOT=`dirname \"$0\"`\n+ROOT=`cd \"$ROOT\"; pwd`\n+\n+export DORIS_HOME=$(dirname \"$PWD\")\n+echo ${DORIS_HOME}\n+export CUSTOM_UDF_HOME=${ROOT}\n+\n+. ${DORIS_HOME}/env.sh\n+\n+# build thirdparty libraries if necessary\n+if [[ ! -f ${DORIS_THIRDPARTY}/installed/lib/libs2.a ]]; then\n+    echo \"Thirdparty libraries need to be build ...\"\n+    ${DORIS_THIRDPARTY}/build-thirdparty.sh\n+fi\n+\n+PARALLEL=$[$(nproc)/4+1]\n+\n+# Check args\n+usage() {\n+  echo \"\n+Usage: $0 <options>\n+  Optional options:\n+     --udf              build custom UDF\n+     --clean            clean and build target\n+\n+  Eg.\n+    $0                                       build UDF without clean\n+    $0 --udf                                 build UDF without clean\n+    $0 --udf --clean                         clean and build UDF\n+  \"\n+  exit 1\n+}\n+\n+OPTS=$(getopt \\\n+  -n $0 \\\n+  -o '' \\\n+  -o 'h' \\\n+  -l 'udf' \\", "originalCommit": "41c869e650669a5a482cf95a6a0457c0bdfcf379", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE2MzgwNg==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r435163806", "bodyText": "\u8fd9\u91cc\u7528\u4e2d\u6587", "author": "morningman", "createdAt": "2020-06-04T10:50:05Z", "path": "docs/zh-CN/extending-doris/contribute_udf.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+{\n+    \"title\": \"Contribute UDF\",\n+    \"language\": \"zh-CN\"\n+}\n+---\n+\n+<!-- \n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+# Contribute UDF", "originalCommit": "1432b1a74166623801f0d691c00e69e420ea2c3b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTE2NzUzMg==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r435167532", "bodyText": "\u8fd9\u91cc\u5e94\u8be5\u662f\u6587\u6863\u6587\u4ef6\u540d\uff0c\u6bd4\u5982 udf-sample\uff0c\u800c\u4e0d\u662f\u6807\u9898", "author": "morningman", "createdAt": "2020-06-04T10:57:05Z", "path": "docs/zh-CN/extending-doris/contribute_udf.md", "diffHunk": "@@ -0,0 +1,117 @@\n+---\n+{\n+    \"title\": \"Contribute UDF\",\n+    \"language\": \"zh-CN\"\n+}\n+---\n+\n+<!-- \n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+# Contribute UDF\n+\n+\u8be5\u624b\u518c\u4e3b\u8981\u8bb2\u8ff0\u4e86\u5916\u90e8\u7528\u6237\u5982\u4f55\u5c06\u81ea\u5df1\u7f16\u5199\u7684 UDF \u51fd\u6570\u8d21\u732e\u7ed9 Doris \u793e\u533a\u3002\n+\n+# \u524d\u63d0\u6761\u4ef6\n+\n+1. UDF \u51fd\u6570\u5177\u6709\u901a\u7528\u6027\n+\n+    \u8fd9\u91cc\u7684\u901a\u7528\u6027\u4e3b\u8981\u6307\u7684\u662f\uff1aUDF \u51fd\u6570\u5728\u67d0\u4e9b\u4e1a\u52a1\u573a\u666f\u4e0b\uff0c\u88ab\u5e7f\u6cdb\u4f7f\u7528\u3002\u4e5f\u5c31\u662f\u8bf4 UDF \u51fd\u6570\u5177\u6709\u590d\u7528\u4ef7\u503c\uff0c\u53ef\u88ab\u793e\u533a\u5185\u5176\u4ed6\u7528\u6237\u76f4\u63a5\u4f7f\u7528\u3002\n+\n+    \u5982\u679c\u4f60\u4e0d\u786e\u5b9a\u81ea\u5df1\u5199\u7684 UDF \u51fd\u6570\u662f\u5426\u5177\u6709\u901a\u7528\u6027\uff0c\u53ef\u4ee5\u53d1\u90ae\u4ef6\u5230 `dev@doris.apache.org` \u6216\u76f4\u63a5\u521b\u5efa ISSUE \u53d1\u8d77\u8ba8\u8bba\u3002\n+\n+2. UDF \u5df2\u7ecf\u5b8c\u6210\u6d4b\u8bd5\uff0c\u5e76\u6b63\u5e38\u8fd0\u884c\u5728\u7528\u6237\u7684\u751f\u4ea7\u73af\u5883\u4e2d\n+\n+# \u51c6\u5907\u5de5\u4f5c\n+\n+1. UDF \u7684 source code\n+2. UDF \u7684\u4f7f\u7528\u624b\u518c\n+\n+## \u6e90\u4ee3\u7801\n+    \n+    \u5f85\u8d21\u732e\u7684\u6e90\u4ee3\u7801\u5e94\u8be5\u5305\u542b: `.h` , `.cpp`, `CMakeFile.txt`\u3002\u5b58\u653e\u8def\u5f84\u5e94\u8be5\u5728 `custom_udf/src/my_udf` \u4e0b\u3002\u8fd9\u91cc\u4ee5 udf_samples \u4e3a\u4f8b\uff0c\u9996\u5148\u5728 `custom_udf/src/` \u8def\u5f84\u4e0b\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u5939\uff0c\u5e76\u5b58\u653e\u6e90\u7801\u3002\n+\n+```\n+    \u251c\u2500\u2500 custom_udf\n+    \u2502   \u251c\u2500\u2500 CMakeLists.txt\n+    \u2502   \u2514\u2500\u2500 src\n+    \u2502       \u2514\u2500\u2500 udf_samples\n+    \u2502           \u251c\u2500\u2500 CMakeLists.txt\n+    \u2502           \u251c\u2500\u2500 uda_sample.cpp\n+    \u2502           \u251c\u2500\u2500 uda_sample.h\n+    \u2502           \u251c\u2500\u2500 udf_sample.cpp\n+    \u2502           \u2514\u2500\u2500 udf_sample.h\n+\n+```\n+\n+## \u4f7f\u7528\u624b\u518c\n+\n+    \u4f7f\u7528\u624b\u518c\u9700\u8981\u5305\u542b\uff1aUDF \u51fd\u6570\u542b\u4e49\u8bf4\u660e\uff0c\u9002\u7528\u7684\u573a\u666f\uff0c\u51fd\u6570\u7684\u8bed\u6cd5\uff0c\u5982\u4f55\u7f16\u8bd1 UDF \uff0c\u5982\u4f55\u5728 Doris \u96c6\u7fa4\u4e2d\u4f7f\u7528 UDF\uff0c \u4ee5\u53ca\u4f7f\u7528\u793a\u4f8b\u3002\n+\n+1. \u4f7f\u7528\u624b\u518c\u9700\u5305\u542b\u4e2d\u82f1\u6587\u4e24\u4e2a\u7248\u672c\uff0c\u5e76\u5206\u522b\u5b58\u653e\u5728 `docs/zh-CN/extending-doris/third-party-udf/` \u548c `docs/en/extending-doris/third-party-udf` \u4e0b\u3002\n+\n+    ```\n+    \u251c\u2500\u2500 docs\n+    \u2502\u00a0\u00a0 \u2514\u2500\u2500 zh-CN\n+    \u2502\u00a0\u00a0     \u2514\u2500\u2500extending-doris\n+    \u2502          \u2514\u2500\u2500third-party-udf\n+    \u2502             \u251c\u2500\u2500 udf simple \u4f7f\u7528\u624b\u518c\n+ \n+    ``` \n+\n+    ```\n+    \u251c\u2500\u2500 docs\n+    \u2502\u00a0\u00a0 \u2514\u2500\u2500 en\n+    \u2502\u00a0\u00a0     \u2514\u2500\u2500extending-doris\n+    \u2502          \u2514\u2500\u2500third-party-udf\n+    \u2502             \u251c\u2500\u2500 udf simple manual\n+    ```\n+\n+2. \u5c06\u4e24\u4e2a\u4f7f\u7528\u624b\u518c\u7684\u6587\u4ef6\uff0c\u52a0\u5165\u4e2d\u6587\u548c\u82f1\u6587\u7684 sidebar \u4e2d\u3002\n+\n+    ```\n+    vi docs/.vuepress/sidebar/zh-CN.js\n+    {\n+        title: \"\u7b2c\u4e09\u65b9 UDF\",\n+        directoryPath: \"third-party-udf/\",\n+        children:\n+        [\n+            \"udf simple \u4f7f\u7528\u624b\u518c\",", "originalCommit": "1432b1a74166623801f0d691c00e69e420ea2c3b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzMTc1MQ==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438631751", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            project(doris)\n          \n          \n            \n            project(doris_custom_udf)", "author": "morningman", "createdAt": "2020-06-11T08:40:19Z", "path": "custom_udf/CMakeLists.txt", "diffHunk": "@@ -0,0 +1,76 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+cmake_minimum_required(VERSION 2.8.10)\n+ \n+# set CMAKE_C_COMPILER, this must set before project command\n+if (DEFINED ENV{DORIS_GCC_HOME})\n+    set(CMAKE_C_COMPILER \"$ENV{DORIS_GCC_HOME}/bin/gcc\")\n+    set(CMAKE_CXX_COMPILER \"$ENV{DORIS_GCC_HOME}/bin/g++\")\n+    set(GCC_HOME $ENV{DORIS_GCC_HOME})\n+else()\n+    message(FATAL_ERROR \"DORIS_GCC_HOME environment variable is not set\")\n+endif()\n+\n+project(doris)", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzMjU3MA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438632570", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            #    sh build-custom-udf.sh -clean     clean previous output and build.\n          \n          \n            \n            #    sh build-custom-udf.sh --clean     clean previous output and build.", "author": "morningman", "createdAt": "2020-06-11T08:41:44Z", "path": "custom_udf/build_custom_udf.sh", "diffHunk": "@@ -0,0 +1,142 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+##############################################################\n+# This script is used to compile UDF \n+# Usage:\n+#    sh build-custom-udf.sh            build udf without clean.\n+#    sh build-custom-udf.sh -clean     clean previous output and build.", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzMzIwNw==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438633207", "bodyText": "no need to build thirdparty in this script.\nThis should be done build.sh.\nJust make this script simple.", "author": "morningman", "createdAt": "2020-06-11T08:42:41Z", "path": "custom_udf/build_custom_udf.sh", "diffHunk": "@@ -0,0 +1,142 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+##############################################################\n+# This script is used to compile UDF \n+# Usage:\n+#    sh build-custom-udf.sh            build udf without clean.\n+#    sh build-custom-udf.sh -clean     clean previous output and build.\n+#\n+##############################################################\n+\n+set -eo pipefail\n+\n+ROOT=`dirname \"$0\"`\n+ROOT=`cd \"$ROOT\"; pwd`\n+\n+export DORIS_HOME=$(dirname \"$PWD\")\n+echo ${DORIS_HOME}\n+export CUSTOM_UDF_HOME=${ROOT}\n+\n+. ${DORIS_HOME}/env.sh\n+\n+# build thirdparty libraries if necessary", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzNDgzMA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438634830", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    title: \"Third-party UDF\",\n          \n          \n            \n                    title: \"Custom UDF\",\n          \n      \n    \n    \n  \n\nMake it unify with build_custom_udf.sh", "author": "morningman", "createdAt": "2020-06-11T08:45:17Z", "path": "docs/.vuepress/sidebar/en.js", "diffHunk": "@@ -124,6 +124,12 @@ module.exports = [\n       \"plugin-development-manual\",\n       \"user-defined-function\",\n       \"spark-doris-connector\",\n+      \"contribute_udf\",\n+      {\n+        title: \"Third-party UDF\",", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzNDk2NQ==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438634965", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    directoryPath: \"third-party-udf/\",\n          \n          \n            \n                    directoryPath: \"custom-udf/\",", "author": "morningman", "createdAt": "2020-06-11T08:45:30Z", "path": "docs/.vuepress/sidebar/en.js", "diffHunk": "@@ -124,6 +124,12 @@ module.exports = [\n       \"plugin-development-manual\",\n       \"user-defined-function\",\n       \"spark-doris-connector\",\n+      \"contribute_udf\",\n+      {\n+        title: \"Third-party UDF\",\n+        directoryPath: \"third-party-udf/\",", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzNTczNA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438635734", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  \"contribute_udf\",\n          \n          \n            \n                  \"contribute-udf\",", "author": "morningman", "createdAt": "2020-06-11T08:46:54Z", "path": "docs/.vuepress/sidebar/en.js", "diffHunk": "@@ -124,6 +124,12 @@ module.exports = [\n       \"plugin-development-manual\",\n       \"user-defined-function\",\n       \"spark-doris-connector\",\n+      \"contribute_udf\",", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzNjYxOA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438636618", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            1. \u51c6\u5907 third_party \n          \n          \n            \n            1. \u51c6\u5907 thirdparty", "author": "morningman", "createdAt": "2020-06-11T08:48:29Z", "path": "docs/zh-CN/extending-doris/user-defined-function.md", "diffHunk": "@@ -74,23 +93,150 @@ under the License.\n |Varchar|StringVal|\n |Decimal|DecimalVal|\n \n-## \u7f16\u8bd1UDF\u51fd\u6570\n+\n+## \u7f16\u8bd1 UDF \u51fd\u6570\n+\n+    \u7531\u4e8e\u7528\u6237\u81ea\u5df1\u5b9e\u73b0\u7684 function \u4e2d\u4f9d\u8d56\u4e86 Doris \u7684 udf , \u6240\u4ee5\u5728\u7f16\u8bd1 UDF \u51fd\u6570\u7684\u65f6\u5019\u9996\u5148\u5bf9 Doris \u8fdb\u884c\u7f16\u8bd1\u3002\u7136\u540e\u518d\u7f16\u8bd1\u7528\u6237\u81ea\u5df1\u5b9e\u73b0\u7684 UDF \u5373\u53ef\u3002\n \n ### \u7f16\u8bd1Doris\n \n-\u5728Doris\u6839\u76ee\u5f55\u4e0b\u6267\u884c`sh build.sh`\u5c31\u4f1a\u5728`output/udf/`\u751f\u6210\u5bf9\u5e94`headers|libs`\n+\u5728Doris\u6839\u76ee\u5f55\u4e0b\u6267\u884c `sh build.sh` \u5c31\u4f1a\u5728 `output/udf/` \u751f\u6210\u5bf9\u5e94 `headers|libs`\n+\n+```\n+\u251c\u2500\u2500 output\n+\u2502\u00a0\u00a0 \u2514\u2500\u2500 udf\n+\u2502\u00a0\u00a0     \u251c\u2500\u2500 include\n+\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 uda_test_harness.h\n+\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 udf.h\n+\u2502\u00a0\u00a0     \u2514\u2500\u2500 lib\n+\u2502\u00a0\u00a0         \u2514\u2500\u2500 libDorisUdf.a\n+\n+```\n+\n+### \u7f16\u5199 UDF \u7f16\u8bd1\u6587\u4ef6\n+\n+1. \u51c6\u5907 third_party ", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYzNjkzMA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r438636930", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               `udf.h` \u662f UDF \u51fd\u6570\u5fc5\u987b\u4f9d\u8d56\u7684\u5934\u6587\u4ef6\u3002\u539f\u59cb\u5b58\u653e\u8def\u5f84\u4e3a `doris/be/src/udf/udf.h`\u3002 \u7528\u6237\u9700\u8981\u5c06 Doris \u5de5\u7a0b\u4e2d\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\u62f7\u8d1d\u5230\u81ea\u5df1\u7684 `third_party` \u7684 include \u6587\u4ef6\u5939\u4e0b\u3002\n          \n          \n            \n               `udf.h` \u662f UDF \u51fd\u6570\u5fc5\u987b\u4f9d\u8d56\u7684\u5934\u6587\u4ef6\u3002\u539f\u59cb\u5b58\u653e\u8def\u5f84\u4e3a `output/udf/include/udf.h`\u3002 \u7528\u6237\u9700\u8981\u5c06 Doris \u5de5\u7a0b\u4e2d\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\u62f7\u8d1d\u5230\u81ea\u5df1\u7684 `third_party` \u7684 include \u6587\u4ef6\u5939\u4e0b\u3002", "author": "morningman", "createdAt": "2020-06-11T08:49:05Z", "path": "docs/zh-CN/extending-doris/user-defined-function.md", "diffHunk": "@@ -74,23 +93,150 @@ under the License.\n |Varchar|StringVal|\n |Decimal|DecimalVal|\n \n-## \u7f16\u8bd1UDF\u51fd\u6570\n+\n+## \u7f16\u8bd1 UDF \u51fd\u6570\n+\n+    \u7531\u4e8e\u7528\u6237\u81ea\u5df1\u5b9e\u73b0\u7684 function \u4e2d\u4f9d\u8d56\u4e86 Doris \u7684 udf , \u6240\u4ee5\u5728\u7f16\u8bd1 UDF \u51fd\u6570\u7684\u65f6\u5019\u9996\u5148\u5bf9 Doris \u8fdb\u884c\u7f16\u8bd1\u3002\u7136\u540e\u518d\u7f16\u8bd1\u7528\u6237\u81ea\u5df1\u5b9e\u73b0\u7684 UDF \u5373\u53ef\u3002\n \n ### \u7f16\u8bd1Doris\n \n-\u5728Doris\u6839\u76ee\u5f55\u4e0b\u6267\u884c`sh build.sh`\u5c31\u4f1a\u5728`output/udf/`\u751f\u6210\u5bf9\u5e94`headers|libs`\n+\u5728Doris\u6839\u76ee\u5f55\u4e0b\u6267\u884c `sh build.sh` \u5c31\u4f1a\u5728 `output/udf/` \u751f\u6210\u5bf9\u5e94 `headers|libs`\n+\n+```\n+\u251c\u2500\u2500 output\n+\u2502\u00a0\u00a0 \u2514\u2500\u2500 udf\n+\u2502\u00a0\u00a0     \u251c\u2500\u2500 include\n+\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 uda_test_harness.h\n+\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 udf.h\n+\u2502\u00a0\u00a0     \u2514\u2500\u2500 lib\n+\u2502\u00a0\u00a0         \u2514\u2500\u2500 libDorisUdf.a\n+\n+```\n+\n+### \u7f16\u5199 UDF \u7f16\u8bd1\u6587\u4ef6\n+\n+1. \u51c6\u5907 third_party \n+\n+    third_party \u6587\u4ef6\u5939\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u7528\u6237 UDF \u51fd\u6570\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u5305\u62ec\u5934\u6587\u4ef6\u53ca\u9759\u6001\u5e93\u3002\u5176\u4e2d\u5fc5\u987b\u5305\u542b\u7684\u662f `udf.h` \u548c `libDorisUdf.a` \u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002\n+    \n+    \u8fd9\u91cc\u4ee5 udf_sample \u4e3a\u4f8b, \u5728 \u7528\u6237\u81ea\u5df1 `udf_samples` \u76ee\u5f55\u7528\u4e8e\u5b58\u653e source code\u3002\u5728\u540c\u7ea7\u76ee\u5f55\u4e0b\u518d\u521b\u5efa\u4e00\u4e2a `third_party` \u6587\u4ef6\u5939\u7528\u4e8e\u5b58\u653e\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u4f9d\u8d56\u9759\u6001\u5e93\u3002\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a\n+\n+    ```\n+    \u251c\u2500\u2500 third_party\n+    \u2502 \u2502\u2500\u2500 include\n+    \u2502 \u2502 \u2514\u2500\u2500 udf.h\n+    \u2502 \u2514\u2500\u2500 lib\n+    \u2502   \u2514\u2500\u2500 libDorisUdf.a\n+    \u2514\u2500\u2500 udf_samples\n+\n+    ```\n+\n+   `udf.h` \u662f UDF \u51fd\u6570\u5fc5\u987b\u4f9d\u8d56\u7684\u5934\u6587\u4ef6\u3002\u539f\u59cb\u5b58\u653e\u8def\u5f84\u4e3a `doris/be/src/udf/udf.h`\u3002 \u7528\u6237\u9700\u8981\u5c06 Doris \u5de5\u7a0b\u4e2d\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\u62f7\u8d1d\u5230\u81ea\u5df1\u7684 `third_party` \u7684 include \u6587\u4ef6\u5939\u4e0b\u3002", "originalCommit": "52c6a5b65059797c20a5902daa3b2c0a5e33ff19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bf1917aead3ac0386372587022252772683d4b93", "url": "https://github.com/apache/incubator-doris/commit/bf1917aead3ac0386372587022252772683d4b93", "message": "Support independently add and build custom udf in Doris\n\n*Source code:\nThe new directory nanmed `custom_udf` is used to add and build custom udf.\nThe directory structure is as follows:\nDoris\n-- be\n-- custom_udf\n-- fe\n\nIf user wants to add a new udf in Doris, the source code will be placed in custom_udf such as:\nDoris\n-- be\n-- custom_udf\n   -- src\n      -- udf_samples\n         -- udf_sample.h\n-- fe\n\n*Build:\nIt can be built independently also the udf does not effect BE.\nThe file 'build_custom_udf.sh' is used to build udf with 2 params: --udf, --clean.\nThe default behavior is that building udf only.\n\n*Output:\nThe dynamic link library will be placed in\nDoris\n-- be\n-- output\n   -- custom_udf\n      -- udf_samples\n         -- libUdfSample.so\n\nChange-Id: Ic8ae16d37b53a904c3ec04e25f99e63442850e5a", "committedDate": "2020-06-12T10:10:33Z", "type": "commit"}, {"oid": "ea6b300c9a987ecd60470caaeff63cb58ed22754", "url": "https://github.com/apache/incubator-doris/commit/ea6b300c9a987ecd60470caaeff63cb58ed22754", "message": "Change udf documents\n\nChange-Id: Iaac181a887a0e2855457e7a7dda3e3330cce6f12", "committedDate": "2020-06-12T10:10:33Z", "type": "commit"}, {"oid": "2932f915e31f2fe6aed395785bfbe2dd47cdbc94", "url": "https://github.com/apache/incubator-doris/commit/2932f915e31f2fe6aed395785bfbe2dd47cdbc94", "message": "Docs of contributing third-party udf to Doris\n\nChange-Id: Id5a36aca627c1d87a3c83920b2cc978e0131d9ca", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "05605f6c6dad8aec37ebd03206d69d9e86d13aa0", "url": "https://github.com/apache/incubator-doris/commit/05605f6c6dad8aec37ebd03206d69d9e86d13aa0", "message": "Add license\n\nChange-Id: I9391a79f12614e78cce19b11df1e5d92eb4817c4", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "7cbfa4692db360c9a6759653fdbf974461c2488f", "url": "https://github.com/apache/incubator-doris/commit/7cbfa4692db360c9a6759653fdbf974461c2488f", "message": "Fix compile error\n\nChange-Id: Iad5cd3be688731992709b080d1842530fe7a2a5b", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "ee299bee263c3694dbdd5e8046d1a51aa1f2b764", "url": "https://github.com/apache/incubator-doris/commit/ee299bee263c3694dbdd5e8046d1a51aa1f2b764", "message": "Fix error\n\nChange-Id: I2eb883be97ddab1548c817bc832cf7f205116d00", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "402ce1d496cf733557653cc26707e7c630602329", "url": "https://github.com/apache/incubator-doris/commit/402ce1d496cf733557653cc26707e7c630602329", "message": "Change udf doc\n\nChange-Id: I6f5ffe72463146046914c6c64d448d51901478fb", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "9dcab5618b3bc4e567e3787c9cbee5da9c8c20cc", "url": "https://github.com/apache/incubator-doris/commit/9dcab5618b3bc4e567e3787c9cbee5da9c8c20cc", "message": "Add doc\n\nChange-Id: Ic9e6567b2920bb465af8c7896d4ab22a0b53635d", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "0f119153d40624df1f33030c31ab9c038ae21850", "url": "https://github.com/apache/incubator-doris/commit/0f119153d40624df1f33030c31ab9c038ae21850", "message": "Change doc\n\nChange-Id: Ibfa7260193953611bf0cbdd3d3a38086230d0de6", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "81a7d46ba2628ead1da8fc70a7624f379dda4685", "url": "https://github.com/apache/incubator-doris/commit/81a7d46ba2628ead1da8fc70a7624f379dda4685", "message": "Remove --udf\n\nChange-Id: Idfcda8bede3d980618f5b249129c54f9b15567f5", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "22c684ea1e4f88de9ae598b38d582ecfe82728b0", "url": "https://github.com/apache/incubator-doris/commit/22c684ea1e4f88de9ae598b38d582ecfe82728b0", "message": "Change docs\n\nChange-Id: I167b7812a2d780a69c7f24183c9671a8053c6793", "committedDate": "2020-06-12T10:11:23Z", "type": "commit"}, {"oid": "285389b60a6db33c6b212d79e6218c777813bbc1", "url": "https://github.com/apache/incubator-doris/commit/285389b60a6db33c6b212d79e6218c777813bbc1", "message": "Change name contrib/udf\n\nChange-Id: I932a1759fbca676206a228193e6e7697aca68e8a", "committedDate": "2020-06-12T10:40:50Z", "type": "commit"}, {"oid": "b462cd526568794158547af3577add4366c8a7cf", "url": "https://github.com/apache/incubator-doris/commit/b462cd526568794158547af3577add4366c8a7cf", "message": "Change dir1\n\nChange-Id: I52bf4d19ae915444867f783f2e0534eaca9e8c36", "committedDate": "2020-06-15T02:30:48Z", "type": "commit"}, {"oid": "cade6a422fb8bb2139043155c1e3cfba321db41b", "url": "https://github.com/apache/incubator-doris/commit/cade6a422fb8bb2139043155c1e3cfba321db41b", "message": "Change docs\n\nChange-Id: If60dde5acb6cb7500f9e704636afabdf3907432d", "committedDate": "2020-06-21T08:50:50Z", "type": "commit"}, {"oid": "cade6a422fb8bb2139043155c1e3cfba321db41b", "url": "https://github.com/apache/incubator-doris/commit/cade6a422fb8bb2139043155c1e3cfba321db41b", "message": "Change docs\n\nChange-Id: If60dde5acb6cb7500f9e704636afabdf3907432d", "committedDate": "2020-06-21T08:50:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIyMjIwNw==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r443222207", "bodyText": "\u8d21\u732e UDF", "author": "morningman", "createdAt": "2020-06-21T13:58:21Z", "path": "docs/zh-CN/extending-doris/contribute_udf.md", "diffHunk": "@@ -0,0 +1,124 @@\n+---\n+{\n+    \"title\": \"\u8d21\u732e\u7528\u6237 UDF \u51fd\u6570\u5230\u793e\u533a\",", "originalCommit": "cade6a422fb8bb2139043155c1e3cfba321db41b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIyMjQ3Mg==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r443222472", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u5982\u679c\u7528\u6237\u4f7f\u7528 UDF \u529f\u80fd\u5e76\u6269\u5c55\u4e86 Doris \u7684\u51fd\u6570\u5206\u6790\uff0c\u5e76\u4e14\u5e0c\u671b\u5c06\u81ea\u5df1\u5b9e\u73b0\u7684 UDF \u51fd\u6570\u8d21\u732e\u56de Doris \u793e\u533a\u7ed9\u5176\u4ed6\u7528\u6237\u4f7f\u7528\uff0c\u8fd9\u65f6\u5019\u8bf7\u770b\u6587\u6863 [Contribute UDF to Doris](http://doris.apache.org/master/zh-CN/extending-doris/contribute_udf.html)\u3002\n          \n          \n            \n            \u5982\u679c\u7528\u6237\u4f7f\u7528 UDF \u529f\u80fd\u5e76\u6269\u5c55\u4e86 Doris \u7684\u51fd\u6570\u5206\u6790\uff0c\u5e76\u4e14\u5e0c\u671b\u5c06\u81ea\u5df1\u5b9e\u73b0\u7684 UDF \u51fd\u6570\u8d21\u732e\u56de Doris \u793e\u533a\u7ed9\u5176\u4ed6\u7528\u6237\u4f7f\u7528\uff0c\u8fd9\u65f6\u5019\u8bf7\u770b\u6587\u6863 [Contribute UDF](./contribute_udf.md)\u3002", "author": "morningman", "createdAt": "2020-06-21T14:01:18Z", "path": "docs/zh-CN/extending-doris/user-defined-function.md", "diffHunk": "@@ -26,18 +26,37 @@ under the License.\n \n # User Define Function\n \n-\u7528\u6237\u53ef\u4ee5\u901a\u8fc7UDF\u673a\u5236\u6765\u6269\u5c55Doris\u7684\u80fd\u529b\u3002\u901a\u8fc7\u8fd9\u7bc7\u6587\u6863\uff0c\u7528\u6237\u80fd\u591f\u521b\u5efa\u81ea\u5df1\u7684UDF\u3002\n+UDF \u4e3b\u8981\u9002\u7528\u4e8e\uff0c\u7528\u6237\u9700\u8981\u7684\u5206\u6790\u80fd\u529b Doris \u5e76\u4e0d\u5177\u5907\u7684\u573a\u666f\u3002\u7528\u6237\u53ef\u4ee5\u81ea\u884c\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\uff0c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u5e76\u4e14\u901a\u8fc7 UDF \u6846\u67b6\u6ce8\u518c\u5230 Doris \u4e2d\uff0c\u6765\u6269\u5c55 Doris \u7684\u80fd\u529b\uff0c\u5e76\u89e3\u51b3\u7528\u6237\u5206\u6790\u9700\u6c42\u3002\n+\n+UDF \u80fd\u6ee1\u8db3\u7684\u5206\u6790\u9700\u6c42\u5206\u4e3a\u4e24\u79cd\uff1aUDF \u548c UDAF\u3002\u672c\u6587\u4e2d\u7684 UDF \u6307\u7684\u662f\u4e8c\u8005\u7684\u7edf\u79f0\u3002\n+\n+1. UDF: \u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u8fd9\u79cd\u51fd\u6570\u4f1a\u5bf9\u5355\u884c\u8fdb\u884c\u64cd\u4f5c\uff0c\u5e76\u4e14\u8f93\u51fa\u5355\u884c\u7ed3\u679c\u3002\u5f53\u7528\u6237\u5728\u67e5\u8be2\u65f6\u4f7f\u7528 UDF \uff0c\u6bcf\u884c\u6570\u636e\u6700\u7ec8\u90fd\u4f1a\u51fa\u73b0\u5728\u7ed3\u679c\u96c6\u4e2d\u3002\u5178\u578b\u7684 UDF \u6bd4\u5982\u5b57\u7b26\u4e32\u64cd\u4f5c concat() \u7b49\u3002\n+2. UDAF: \u7528\u6237\u81ea\u5b9a\u4e49\u7684\u805a\u5408\u51fd\u6570\uff0c\u8fd9\u79cd\u51fd\u6570\u5bf9\u591a\u884c\u8fdb\u884c\u64cd\u4f5c\uff0c\u5e76\u4e14\u8f93\u51fa\u5355\u884c\u7ed3\u679c\u3002\u5f53\u7528\u6237\u5728\u67e5\u8be2\u65f6\u4f7f\u7528 UDAF\uff0c\u5206\u7ec4\u540e\u7684\u6bcf\u7ec4\u6570\u636e\u6700\u540e\u4f1a\u8ba1\u7b97\u51fa\u4e00\u4e2a\u503c\u5e76\u5c55\u7ed3\u679c\u96c6\u4e2d\u3002\u5178\u578b\u7684 UDAF \u6bd4\u5982\u96c6\u5408\u64cd\u4f5c sum() \u7b49\u3002\u4e00\u822c\u6765\u8bf4 UDAF \u90fd\u4f1a\u7ed3\u5408 group by \u4e00\u8d77\u4f7f\u7528\u3002 \n+\n+\u8fd9\u7bc7\u6587\u6863\u4e3b\u8981\u8bb2\u8ff0\u4e86\uff0c\u5982\u4f55\u7f16\u5199\u81ea\u5b9a\u4e49\u7684 UDF \u51fd\u6570\uff0c\u4ee5\u53ca\u5982\u4f55\u5728 Doris \u4e2d\u4f7f\u7528\u5b83\u3002\n+\n+\u5982\u679c\u7528\u6237\u4f7f\u7528 UDF \u529f\u80fd\u5e76\u6269\u5c55\u4e86 Doris \u7684\u51fd\u6570\u5206\u6790\uff0c\u5e76\u4e14\u5e0c\u671b\u5c06\u81ea\u5df1\u5b9e\u73b0\u7684 UDF \u51fd\u6570\u8d21\u732e\u56de Doris \u793e\u533a\u7ed9\u5176\u4ed6\u7528\u6237\u4f7f\u7528\uff0c\u8fd9\u65f6\u5019\u8bf7\u770b\u6587\u6863 [Contribute UDF to Doris](http://doris.apache.org/master/zh-CN/extending-doris/contribute_udf.html)\u3002", "originalCommit": "cade6a422fb8bb2139043155c1e3cfba321db41b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIyMjgyOA==", "url": "https://github.com/apache/incubator-doris/pull/3760#discussion_r443222828", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                third_party \u6587\u4ef6\u5939\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u7528\u6237 UDF \u51fd\u6570\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u5305\u62ec\u5934\u6587\u4ef6\u53ca\u9759\u6001\u5e93\u3002\u5176\u4e2d\u5fc5\u987b\u5305\u542b\u4f9d\u8d56\u7684 Doris UDF \u6846\u67b6\u4e2d `udf.h` \u548c `libDorisUdf.a` \u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002\n          \n          \n            \n                thirdparty \u6587\u4ef6\u5939\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u7528\u6237 UDF \u51fd\u6570\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u5305\u62ec\u5934\u6587\u4ef6\u53ca\u9759\u6001\u5e93\u3002\u5176\u4e2d\u5fc5\u987b\u5305\u542b\u4f9d\u8d56\u7684 Doris UDF \u6846\u67b6\u4e2d `udf.h` \u548c `libDorisUdf.a` \u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002\n          \n      \n    \n    \n  \n\n\u5176\u5b9e thirdparty \u53ef\u4ee5\u76f4\u63a5\u8fde\u8d77\u6765\u5199", "author": "morningman", "createdAt": "2020-06-21T14:05:40Z", "path": "docs/zh-CN/extending-doris/user-defined-function.md", "diffHunk": "@@ -74,23 +93,154 @@ under the License.\n |Varchar|StringVal|\n |Decimal|DecimalVal|\n \n-## \u7f16\u8bd1UDF\u51fd\u6570\n+\n+## \u7f16\u8bd1 UDF \u51fd\u6570\n+\n+    \u7531\u4e8e UDF \u5b9e\u73b0\u4e2d\u4f9d\u8d56\u4e86 Doris \u7684 UDF \u6846\u67b6 , \u6240\u4ee5\u5728\u7f16\u8bd1 UDF \u51fd\u6570\u7684\u65f6\u5019\u9996\u5148\u8981\u5bf9 Doris \u8fdb\u884c\u7f16\u8bd1\uff0c\u4e5f\u5c31\u662f\u5bf9 UDF \u6846\u67b6\u8fdb\u884c\u7f16\u8bd1\u3002\n+    \n+    \u7f16\u8bd1\u5b8c\u6210\u540e\u4f1a\u751f\u6210\uff0cUDF \u6846\u67b6\u7684\u9759\u6001\u5e93\u6587\u4ef6\u3002\u4e4b\u540e\u5f15\u5165 UDF \u6846\u67b6\u4f9d\u8d56\uff0c\u5e76\u7f16\u8bd1 UDF \u5373\u53ef\u3002\n \n ### \u7f16\u8bd1Doris\n \n-\u5728Doris\u6839\u76ee\u5f55\u4e0b\u6267\u884c`sh build.sh`\u5c31\u4f1a\u5728`output/udf/`\u751f\u6210\u5bf9\u5e94`headers|libs`\n+\u5728 Doris \u6839\u76ee\u5f55\u4e0b\u6267\u884c `sh build.sh` \u5c31\u4f1a\u5728 `output/udf/` \u751f\u6210 UDF \u6846\u67b6\u7684\u9759\u6001\u5e93\u6587\u4ef6 `headers|libs`\n+\n+```\n+\u251c\u2500\u2500 output\n+\u2502\u00a0\u00a0 \u2514\u2500\u2500 udf\n+\u2502\u00a0\u00a0     \u251c\u2500\u2500 include\n+\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 uda_test_harness.h\n+\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 udf.h\n+\u2502\u00a0\u00a0     \u2514\u2500\u2500 lib\n+\u2502\u00a0\u00a0         \u2514\u2500\u2500 libDorisUdf.a\n+\n+```\n+\n+### \u7f16\u5199 UDF \u7f16\u8bd1\u6587\u4ef6\n+\n+1. \u51c6\u5907 third_party \n+\n+    third_party \u6587\u4ef6\u5939\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u7528\u6237 UDF \u51fd\u6570\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u5305\u62ec\u5934\u6587\u4ef6\u53ca\u9759\u6001\u5e93\u3002\u5176\u4e2d\u5fc5\u987b\u5305\u542b\u4f9d\u8d56\u7684 Doris UDF \u6846\u67b6\u4e2d `udf.h` \u548c `libDorisUdf.a` \u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002", "originalCommit": "cade6a422fb8bb2139043155c1e3cfba321db41b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0590f37817684768b19e89159ca1f1298da95054", "url": "https://github.com/apache/incubator-doris/commit/0590f37817684768b19e89159ca1f1298da95054", "message": "Change docs\n\nChange-Id: Ief33d948febd28c9c9866d52e192ab84f561f397", "committedDate": "2020-06-22T03:11:12Z", "type": "commit"}, {"oid": "7c2eaa30df8e6273b6c06234acb48e597b1293ac", "url": "https://github.com/apache/incubator-doris/commit/7c2eaa30df8e6273b6c06234acb48e597b1293ac", "message": "Change docs\n\nChange-Id: I3bf09825e06d629dfeee8f8cc4b7e3ccd9e8d3a1", "committedDate": "2020-06-22T03:38:16Z", "type": "commit"}, {"oid": "a2d3eecfea64c46e75f01c035ca334f03affd2c0", "url": "https://github.com/apache/incubator-doris/commit/a2d3eecfea64c46e75f01c035ca334f03affd2c0", "message": "Change docs\n\nChange-Id: I930e3007e52a78678c420bbd4288565c3e06edf7", "committedDate": "2020-06-22T03:43:29Z", "type": "commit"}, {"oid": "44d4caa12d0871cd101d9ecd4acb471018e1e3d5", "url": "https://github.com/apache/incubator-doris/commit/44d4caa12d0871cd101d9ecd4acb471018e1e3d5", "message": "Change docs\n\nChange-Id: I53d93075e33e1a29293aa47d84d4995fef585c39", "committedDate": "2020-06-22T04:25:16Z", "type": "commit"}]}