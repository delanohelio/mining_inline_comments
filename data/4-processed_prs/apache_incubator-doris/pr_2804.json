{"pr_number": 2804, "pr_title": "[JDK] Support OpenJDK", "pr_createdAt": "2020-01-19T14:48:50Z", "pr_url": "https://github.com/apache/incubator-doris/pull/2804", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMwMTY1OQ==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r368301659", "bodyText": "Duplicated ?", "author": "yangzhg", "createdAt": "2020-01-19T15:19:41Z", "path": "fe/src/main/java/org/apache/doris/PaloFe.java", "diffHunk": "@@ -222,10 +274,12 @@ private static CommandLineOptions parseArgs(String[] args) {\n \n     private static void checkCommandLineOptions(CommandLineOptions cmdLineOpts) {\n         if (cmdLineOpts.isVersion()) {\n-            System.out.println(\"Build version: \" + Version.PALO_BUILD_VERSION);\n-            System.out.println(\"Build time: \" + Version.PALO_BUILD_TIME);\n-            System.out.println(\"Build info: \" + Version.PALO_BUILD_INFO);\n-            System.out.println(\"Build hash: \" + Version.PALO_BUILD_HASH);\n+            System.out.println(\"Build version: \" + Version.DORIS_BUILD_VERSION);\n+            System.out.println(\"Build time: \" + Version.DORIS_BUILD_TIME);\n+            System.out.println(\"Build info: \" + Version.DORIS_BUILD_INFO);\n+            System.out.println(\"Build hash: \" + Version.DORIS_BUILD_HASH);\n+            System.out.println(\"Build hash: \" + Version.DORIS_BUILD_HASH);", "originalCommit": "eae85ccfddbfbd80f2cd13ab15a7b46398578d62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMwMjMxNg==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r368302316", "bodyText": "removed", "author": "morningman", "createdAt": "2020-01-19T15:30:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMwMTY1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMwMTgxMA==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r368301810", "bodyText": "This may be removed", "author": "yangzhg", "createdAt": "2020-01-19T15:21:47Z", "path": "fe/src/main/java/org/apache/doris/rpc/BackendServiceProxy.java", "diffHunk": "@@ -31,6 +32,13 @@\n import org.apache.doris.thrift.TNetworkAddress;\n import org.apache.doris.thrift.TUniqueId;\n \n+//import com.baidu.jprotobuf.pbrpc.client.ProtobufRpcProxy;\n+//import com.baidu.jprotobuf.pbrpc.transport.RpcClient;\n+//import com.baidu.jprotobuf.pbrpc.transport.RpcClientOptions;\n+//import com.google.common.collect.Maps;", "originalCommit": "eae85ccfddbfbd80f2cd13ab15a7b46398578d62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMwMjMyMg==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r368302322", "bodyText": "ok", "author": "morningman", "createdAt": "2020-01-19T15:30:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMwMTgxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM0MjY3Ng==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r368342676", "bodyText": "If  JAVA_OPTS is different between jdks,  can we check the java version and chose the right JAVA_OPTS in start_fe.sh?", "author": "yangzhg", "createdAt": "2020-01-20T01:32:50Z", "path": "conf/fe.conf", "diffHunk": "@@ -25,7 +25,10 @@\n LOG_DIR = ${DORIS_HOME}/log\n \n DATE = `date +%Y%m%d-%H%M%S`\n-JAVA_OPTS=\"-Xmx4096m -XX:+UseMembar -XX:SurvivorRatio=8 -XX:MaxTenuringThreshold=7 -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+UseCMSCompactAtFullCollection -XX:CMSFullGCsBeforeCompaction=0 -XX:+CMSClassUnloadingEnabled -XX:-CMSParallelRemarkEnabled -XX:CMSInitiatingOccupancyFraction=80 -XX:SoftRefLRUPolicyMSPerMB=0 -Xloggc:$DORIS_HOME/log/fe.gc.log.$DATE\"\n+JAVA_OPTS=\"-Xmx4096m -XX:+UseMembar -XX:SurvivorRatio=8 -XX:MaxTenuringThreshold=7 -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:+CMSClassUnloadingEnabled -XX:-CMSParallelRemarkEnabled -XX:CMSInitiatingOccupancyFraction=80 -XX:SoftRefLRUPolicyMSPerMB=0 -Xloggc:$DORIS_HOME/log/fe.gc.log.$DATE\"\n+\n+# For jdk 9+, you may need to use thgis JAVA_OPTS\n+# JAVA_OPTS=\"-Xmx4096m -XX:SurvivorRatio=8 -XX:MaxTenuringThreshold=7 -XX:+CMSClassUnloadingEnabled -XX:-CMSParallelRemarkEnabled -XX:CMSInitiatingOccupancyFraction=80 -XX:SoftRefLRUPolicyMSPerMB=0 -Xlog:gc*:$DORIS_HOME/log/fe.gc.log.$DATE:time\"", "originalCommit": "697ee50d3ad3bfb5e82d86be3ed99773474b188a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE2MzY4OQ==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r372163689", "bodyText": "ok", "author": "morningman", "createdAt": "2020-01-29T02:39:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM0MjY3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODYxODI5Mg==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r368618292", "bodyText": "should check java version after configure initialized? Other wise the config isn't effective", "author": "imay", "createdAt": "2020-01-20T15:54:01Z", "path": "fe/src/main/java/org/apache/doris/PaloFe.java", "diffHunk": "@@ -53,6 +54,10 @@\n \n     // entrance for palo frontend\n     public static void main(String[] args) {\n+        if (!checkJavaVersion()) {", "originalCommit": "697ee50d3ad3bfb5e82d86be3ed99773474b188a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE2MzY1Nw==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r372163657", "bodyText": "checkJavaVersion() does not, and should not depend on any configurations of the program. It only depends on the java runtime environment, which should already be initialized\nwhen we get here.", "author": "morningman", "createdAt": "2020-01-29T02:39:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODYxODI5Mg=="}], "type": "inlineReview"}, {"oid": "eb5d4c82f475ecf6714e2e39f59bce6e6cf5a826", "url": "https://github.com/apache/incubator-doris/commit/eb5d4c82f475ecf6714e2e39f59bce6e6cf5a826", "message": "check JAVA_OPTS_FOR_JDK_9", "committedDate": "2020-02-10T15:01:25Z", "type": "forcePushed"}, {"oid": "9aad4579975b452d2487db485cf07cdf90f04772", "url": "https://github.com/apache/incubator-doris/commit/9aad4579975b452d2487db485cf07cdf90f04772", "message": "[FE Maven] Change maven repository url from http to https (#2786)\n\nFrom January 15th, 2020, Requests to http://repo1.maven.org/maven2/ return a 501 HTTPS Required status.\nSo switch central repository url from http to https\n\nfirst commit\n\nmodify script\n\nfix bugs\n\nadd runtime version\n\nfs broker\n\nfix ut\n\nfix bug\n\nmodify start_fe.sh to choose JAVA_OPTS automatically", "committedDate": "2020-02-17T15:14:14Z", "type": "commit"}, {"oid": "c9f4595f28af9a49a65974da897c3d9e693b659d", "url": "https://github.com/apache/incubator-doris/commit/c9f4595f28af9a49a65974da897c3d9e693b659d", "message": "check JAVA_OPTS_FOR_JDK_9", "committedDate": "2020-02-17T15:14:14Z", "type": "commit"}, {"oid": "c9f4595f28af9a49a65974da897c3d9e693b659d", "url": "https://github.com/apache/incubator-doris/commit/c9f4595f28af9a49a65974da897c3d9e693b659d", "message": "check JAVA_OPTS_FOR_JDK_9", "committedDate": "2020-02-17T15:14:14Z", "type": "forcePushed"}, {"oid": "e2f5ef493db22efafa443b9be55156a531a9ed48", "url": "https://github.com/apache/incubator-doris/commit/e2f5ef493db22efafa443b9be55156a531a9ed48", "message": "check after config init", "committedDate": "2020-02-17T15:19:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwMDAxMA==", "url": "https://github.com/apache/incubator-doris/pull/2804#discussion_r381300010", "bodyText": "I think this function is better to be put in JdkUtils not in PaloFe", "author": "imay", "createdAt": "2020-02-19T13:48:34Z", "path": "fe/src/main/java/org/apache/doris/rpc/BackendServiceProxy.java", "diffHunk": "@@ -53,6 +56,11 @@\n \n     private static BackendServiceProxy INSTANCE;\n \n+    static {\n+        int javaRuntimeVersion = PaloFe.getJavaVersionAsInteger(System.getProperty(\"java.version\"));", "originalCommit": "e2f5ef493db22efafa443b9be55156a531a9ed48", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3c04b801c674a2b7c0d1cfc9f5f68f41f39c6c33", "url": "https://github.com/apache/incubator-doris/commit/3c04b801c674a2b7c0d1cfc9f5f68f41f39c6c33", "message": "add jdk utils", "committedDate": "2020-02-19T14:43:39Z", "type": "commit"}, {"oid": "a2068ece8b1a845b2442db7331f3be3ab8f9fa0d", "url": "https://github.com/apache/incubator-doris/commit/a2068ece8b1a845b2442db7331f3be3ab8f9fa0d", "message": "fix bug", "committedDate": "2020-02-19T14:45:38Z", "type": "commit"}]}