{"pr_number": 3326, "pr_title": "[LSAN] Fix some memory leak detected by LSAN", "pr_createdAt": "2020-04-15T16:33:48Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3326", "timeline": [{"oid": "1ceca2f3da6effb63276a3122e00598c31121d1f", "url": "https://github.com/apache/incubator-doris/commit/1ceca2f3da6effb63276a3122e00598c31121d1f", "message": "[LSAN] Fix some memory leak dectected by LSAN", "committedDate": "2020-04-15T16:29:21Z", "type": "commit"}, {"oid": "11bce9790f65f933708797ff634220f5ba3380a4", "url": "https://github.com/apache/incubator-doris/commit/11bce9790f65f933708797ff634220f5ba3380a4", "message": "fix", "committedDate": "2020-04-15T17:30:32Z", "type": "commit"}, {"oid": "0ce9b93871d57161aa4382e83cd93b90169e3c0d", "url": "https://github.com/apache/incubator-doris/commit/0ce9b93871d57161aa4382e83cd93b90169e3c0d", "message": "fix ut failures in release mode", "committedDate": "2020-04-16T04:19:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3NDc4Mw==", "url": "https://github.com/apache/incubator-doris/pull/3326#discussion_r409274783", "bodyText": "It is safe to delete nullptr, and _disjuncts is cleared later on, so keep using delete is OK", "author": "imay", "createdAt": "2020-04-16T04:29:44Z", "path": "be/src/exec/es/es_predicate.cpp", "diffHunk": "@@ -178,7 +179,7 @@ EsPredicate::EsPredicate(ExprContext* context,\n \n EsPredicate::~EsPredicate() {\n     for(int i=0; i < _disjuncts.size(); i++) {\n-        delete _disjuncts[i];\n+        SAFE_DELETE(_disjuncts[i]);", "originalCommit": "0ce9b93871d57161aa4382e83cd93b90169e3c0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTI3NTE2Mg==", "url": "https://github.com/apache/incubator-doris/pull/3326#discussion_r409275162", "bodyText": "just delete is OK", "author": "imay", "createdAt": "2020-04-16T04:31:20Z", "path": "be/src/exec/es/es_query_builder.cpp", "diffHunk": "@@ -169,20 +170,16 @@ BooleanQueryBuilder::BooleanQueryBuilder() {\n }\n BooleanQueryBuilder::~BooleanQueryBuilder() {\n     for (auto clause : _must_clauses) {\n-        delete clause;\n-        clause = nullptr;\n+        SAFE_DELETE(clause);", "originalCommit": "0ce9b93871d57161aa4382e83cd93b90169e3c0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7aae33333e3174ef934b6fc59a0bdbf9f4186b4b", "url": "https://github.com/apache/incubator-doris/commit/7aae33333e3174ef934b6fc59a0bdbf9f4186b4b", "message": "revert some SAFE_DELETE", "committedDate": "2020-04-16T05:33:52Z", "type": "commit"}, {"oid": "9eea004ae71d28851b9a73d48b83b288f618bf36", "url": "https://github.com/apache/incubator-doris/commit/9eea004ae71d28851b9a73d48b83b288f618bf36", "message": "revert some SAFE_DELETE", "committedDate": "2020-04-16T05:35:13Z", "type": "commit"}, {"oid": "61ae8d832d99b156c21693fc4dc8a9ff5f0c0a54", "url": "https://github.com/apache/incubator-doris/commit/61ae8d832d99b156c21693fc4dc8a9ff5f0c0a54", "message": "fix", "committedDate": "2020-04-17T09:12:13Z", "type": "commit"}]}