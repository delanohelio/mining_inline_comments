{"pr_number": 5158, "pr_title": "[Config] change some static config to dynamic config and delete some unused config", "pr_createdAt": "2020-12-28T05:52:03Z", "pr_url": "https://github.com/apache/incubator-doris/pull/5158", "timeline": [{"oid": "9b18d79506e21c993014a4a1e727f56a61225729", "url": "https://github.com/apache/incubator-doris/commit/9b18d79506e21c993014a4a1e727f56a61225729", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T05:19:02Z", "type": "commit"}, {"oid": "96497f396918af7553ebcc54b4b4e7af189e6965", "url": "https://github.com/apache/incubator-doris/commit/96497f396918af7553ebcc54b4b4e7af189e6965", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T07:11:30Z", "type": "commit"}, {"oid": "0f14f6483379b4e116cc680c57c758b43105b7ed", "url": "https://github.com/apache/incubator-doris/commit/0f14f6483379b4e116cc680c57c758b43105b7ed", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T07:17:09Z", "type": "commit"}, {"oid": "4e306761cfd8e5f0c4108dbaa0a2efeb4836a44e", "url": "https://github.com/apache/incubator-doris/commit/4e306761cfd8e5f0c4108dbaa0a2efeb4836a44e", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T07:52:01Z", "type": "commit"}, {"oid": "172e824379d03cd6c7717ef2495c055476050590", "url": "https://github.com/apache/incubator-doris/commit/172e824379d03cd6c7717ef2495c055476050590", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T08:48:55Z", "type": "commit"}, {"oid": "25dc26d16f915cf929312c28fe82b89a854ce216", "url": "https://github.com/apache/incubator-doris/commit/25dc26d16f915cf929312c28fe82b89a854ce216", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T09:45:00Z", "type": "commit"}, {"oid": "9c7a35b14527c35e93d21d60717205f60bf4c940", "url": "https://github.com/apache/incubator-doris/commit/9c7a35b14527c35e93d21d60717205f60bf4c940", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-28T10:19:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5Nzk1Mg==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549597952", "bodyText": "There is a case that disable_storage_page_cache  is true at first, then changed to false, will the memory used by cache has no chance to free?", "author": "acelyc111", "createdAt": "2020-12-29T07:25:10Z", "path": "be/src/common/config.h", "diffHunk": "@@ -256,21 +222,18 @@ CONF_Int32(file_descriptor_cache_capacity, \"32768\");\n // modify them upon necessity\n CONF_Int32(min_file_descriptor_number, \"60000\");\n CONF_Int64(index_stream_cache_capacity, \"10737418240\");\n-// CONF_Int64(max_packed_row_block_size, \"20971520\");\n \n // Cache for storage page size\n CONF_String(storage_page_cache_limit, \"20%\");\n // whether to disable page cache feature in storage\n-CONF_Bool(disable_storage_page_cache, \"false\");\n+CONF_mBool(disable_storage_page_cache, \"false\");", "originalCommit": "9c7a35b14527c35e93d21d60717205f60bf4c940", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYxNTU1MQ==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549615551", "bodyText": "The config disable_storage_page_cacheis not used to close cache but to choose whether to use the cache during read.  So the memory used by cache will not be freed.", "author": "weizuo93", "createdAt": "2020-12-29T08:30:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5Nzk1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5ODkyNA==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549598924", "bodyText": "There is a memory leak risk, enable_partitioned_aggregation is true at first and then changed to false, memory allocated has no chance to free.", "author": "acelyc111", "createdAt": "2020-12-29T07:29:13Z", "path": "be/src/common/config.h", "diffHunk": "@@ -424,8 +378,7 @@ CONF_Bool(enable_quadratic_probing, \"false\");\n CONF_String(pprof_profile_dir, \"${DORIS_HOME}/log\");\n \n // for partition\n-// CONF_Bool(enable_partitioned_hash_join, \"false\")\n-CONF_Bool(enable_partitioned_aggregation, \"true\");\n+CONF_mBool(enable_partitioned_aggregation, \"true\");", "originalCommit": "9c7a35b14527c35e93d21d60717205f60bf4c940", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5OTg2OQ==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549599869", "bodyText": "I think you can remove this config, and define it as a static const value, there is no reason to update it.", "author": "acelyc111", "createdAt": "2020-12-29T07:33:39Z", "path": "be/src/common/config.h", "diffHunk": "@@ -472,7 +412,7 @@ CONF_String(buffer_pool_clean_pages_limit, \"20G\");\n CONF_mInt64(memory_maintenance_sleep_time_s, \"10\");\n \n // Alignment\n-CONF_Int32(memory_max_alignment, \"16\");\n+CONF_mInt32(memory_max_alignment, \"16\");", "originalCommit": "9c7a35b14527c35e93d21d60717205f60bf4c940", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYxNTkzOQ==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549615939", "bodyText": "OK.", "author": "weizuo93", "createdAt": "2020-12-29T08:31:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5OTg2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwMDQ5Mg==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549600492", "bodyText": "These 2 configs are only used in LoadChannelMgr's init function, which will be called only once when server start, they are immutable.", "author": "acelyc111", "createdAt": "2020-12-29T07:36:19Z", "path": "be/src/common/config.h", "diffHunk": "@@ -482,8 +422,8 @@ CONF_mInt64(write_buffer_size, \"104857600\");\n // NOTICE(cmy): set these default values very large because we don't want to\n // impact the load performance when user upgrading Doris.\n // user should set these configs properly if necessary.\n-CONF_Int64(load_process_max_memory_limit_bytes, \"107374182400\"); // 100GB\n-CONF_Int32(load_process_max_memory_limit_percent, \"80\");         // 80%\n+CONF_mInt64(load_process_max_memory_limit_bytes, \"107374182400\"); // 100GB\n+CONF_mInt32(load_process_max_memory_limit_percent, \"80\");         // 80%", "originalCommit": "9c7a35b14527c35e93d21d60717205f60bf4c940", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYxNjAyMQ==", "url": "https://github.com/apache/incubator-doris/pull/5158#discussion_r549616021", "bodyText": "OK.", "author": "weizuo93", "createdAt": "2020-12-29T08:31:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwMDQ5Mg=="}], "type": "inlineReview"}, {"oid": "6368f84796f936dd7e9a743177c9dcf48612a90b", "url": "https://github.com/apache/incubator-doris/commit/6368f84796f936dd7e9a743177c9dcf48612a90b", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-29T08:18:32Z", "type": "commit"}, {"oid": "ce5358442787b872a84bb5611ff605d2da141200", "url": "https://github.com/apache/incubator-doris/commit/ce5358442787b872a84bb5611ff605d2da141200", "message": "change some BE static config to dynamic config", "committedDate": "2020-12-29T10:53:26Z", "type": "commit"}]}