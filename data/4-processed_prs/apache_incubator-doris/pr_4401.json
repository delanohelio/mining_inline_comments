{"pr_number": 4401, "pr_title": "[Bug-Fix] Some deleted tablets are not recycled on BE", "pr_createdAt": "2020-08-20T05:18:40Z", "pr_url": "https://github.com/apache/incubator-doris/pull/4401", "timeline": [{"oid": "f55064622f56d347a9b369772575c6d6be3b6eaa", "url": "https://github.com/apache/incubator-doris/commit/f55064622f56d347a9b369772575c6d6be3b6eaa", "message": "[bugfix] Some deleted tablets are not recycled on BE and occupy too much disk space! #4400", "committedDate": "2020-08-20T05:11:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIyMjUzMQ==", "url": "https://github.com/apache/incubator-doris/pull/4401#discussion_r475222531", "bodyText": "Should it be WriteLock?", "author": "morningman", "createdAt": "2020-08-23T13:54:47Z", "path": "be/src/olap/tablet_manager.cpp", "diffHunk": "@@ -1086,6 +1094,52 @@ OLAPStatus TabletManager::start_trash_sweep() {\n     return OLAP_SUCCESS;\n } // start_trash_sweep\n \n+void TabletManager::register_clone_tablet(int64_t tablet_id) {\n+    RWMutex& tablet_map_lock = _get_tablet_map_lock(tablet_id);\n+    ReadLock rlock(&tablet_map_lock);\n+    _tablets_under_clone.insert(tablet_id);\n+}\n+\n+void TabletManager::unregister_clone_tablet(int64_t tablet_id) {\n+    RWMutex& tablet_map_lock = _get_tablet_map_lock(tablet_id);\n+    ReadLock rlock(&tablet_map_lock);", "originalCommit": "f55064622f56d347a9b369772575c6d6be3b6eaa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e5f25f55089c0523dc8f2d420f50cef35bb5bf0e", "url": "https://github.com/apache/incubator-doris/commit/e5f25f55089c0523dc8f2d420f50cef35bb5bf0e", "message": "[bugfix] Some deleted tablets are not recycled on BE and occupy too much disk space! #4400", "committedDate": "2020-08-24T06:24:26Z", "type": "commit"}, {"oid": "8b7a0a09b8738b30980c519ff97866a157d44921", "url": "https://github.com/apache/incubator-doris/commit/8b7a0a09b8738b30980c519ff97866a157d44921", "message": "Some deleted tablets are not recycled on BE and occupy too much disk space! #4400", "committedDate": "2020-08-26T05:11:06Z", "type": "commit"}]}