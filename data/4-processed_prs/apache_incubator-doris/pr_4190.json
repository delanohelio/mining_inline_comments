{"pr_number": 4190, "pr_title": "[Feature]Add fetch/update/clear proto of fe&be for cache", "pr_createdAt": "2020-07-27T07:06:40Z", "pr_url": "https://github.com/apache/incubator-doris/pull/4190", "timeline": [{"oid": "9b5ea6a6a165846575f734946b42da2d7077c447", "url": "https://github.com/apache/incubator-doris/commit/9b5ea6a6a165846575f734946b42da2d7077c447", "message": "[Feature]Add fetch/update/clear proto of fe&be for cache", "committedDate": "2020-07-27T06:57:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjcxMzU1OA==", "url": "https://github.com/apache/incubator-doris/pull/4190#discussion_r462713558", "bodyText": "For protobuf, we prefer optional than  required.", "author": "kangkaisen", "createdAt": "2020-07-30T03:31:28Z", "path": "gensrc/proto/internal_service.proto", "diffHunk": "@@ -147,6 +147,59 @@ message PFetchDataResult {\n     optional PQueryStatistics query_statistics = 4;\n };\n \n+//Add message definition to fetch and update cache\n+enum PCacheStatus {    \n+    DEFAULT = 0;\n+    CACHE_OK = 1;\n+    PARAM_ERROR = 2;\n+    SIZE_OVER_LIMIT = 3;\n+    NO_SQL_KEY = 4;\n+    NO_PARTITION_KEY = 5;\n+    INVALID_KEY_RANGE = 6;\n+    DATA_OVERDUE = 7;\n+    EMPTY_DATA = 8;\n+};\n+\n+message PCacheParam {\n+    required int64 partition_key = 1;", "originalCommit": "9b5ea6a6a165846575f734946b42da2d7077c447", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjcxMzc2Ng==", "url": "https://github.com/apache/incubator-doris/pull/4190#discussion_r462713766", "bodyText": "Would better define the clear_type to enum", "author": "kangkaisen", "createdAt": "2020-07-30T03:32:14Z", "path": "gensrc/proto/internal_service.proto", "diffHunk": "@@ -147,6 +147,59 @@ message PFetchDataResult {\n     optional PQueryStatistics query_statistics = 4;\n };\n \n+//Add message definition to fetch and update cache\n+enum PCacheStatus {    \n+    DEFAULT = 0;\n+    CACHE_OK = 1;\n+    PARAM_ERROR = 2;\n+    SIZE_OVER_LIMIT = 3;\n+    NO_SQL_KEY = 4;\n+    NO_PARTITION_KEY = 5;\n+    INVALID_KEY_RANGE = 6;\n+    DATA_OVERDUE = 7;\n+    EMPTY_DATA = 8;\n+};\n+\n+message PCacheParam {\n+    required int64 partition_key = 1;\n+    required int64 last_version = 2;\n+    required int64 last_version_time = 3;\n+};\n+\n+message PCacheValue {\n+    required PCacheParam param = 1;\n+    required int32 data_size = 2;\n+    repeated bytes row = 3;\n+};\n+\n+//for update&clear return\n+message PCacheResponse {\n+    required PCacheStatus status = 1;\n+};\n+\n+message PUpdateCacheRequest{\n+    required PUniqueId sql_key = 1;\n+    repeated PCacheValue value = 2;\n+};\n+\n+message PFetchCacheRequest {\n+    required PUniqueId sql_key = 1;\n+    repeated PCacheParam param = 2;\n+};\n+\n+message PFetchCacheResult {\n+    required PCacheStatus status = 1;\n+    repeated PCacheValue value = 2;\n+};\n+\n+message PClearCacheRequest {\n+    //0 clear all, 1 invoke prune,  2 clear before_time, 3 clear sql_key\n+    required int32 clear_type = 1;", "originalCommit": "9b5ea6a6a165846575f734946b42da2d7077c447", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "161187ff583e562c1737747802bf62fcf076159f", "url": "https://github.com/apache/incubator-doris/commit/161187ff583e562c1737747802bf62fcf076159f", "message": "define clear type enum", "committedDate": "2020-07-30T06:29:04Z", "type": "commit"}]}