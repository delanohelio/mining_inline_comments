{"pr_number": 4786, "pr_title": "[Bug] Fix some date functions to make their result same as MySQL", "pr_createdAt": "2020-10-25T15:52:32Z", "pr_url": "https://github.com/apache/incubator-doris/pull/4786", "timeline": [{"oid": "69a50b362ccd9907e61890dd9c2141dff0d1f19d", "url": "https://github.com/apache/incubator-doris/commit/69a50b362ccd9907e61890dd9c2141dff0d1f19d", "message": "fix ut", "committedDate": "2020-10-25T15:09:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY4NTQ4OQ==", "url": "https://github.com/apache/incubator-doris/pull/4786#discussion_r511685489", "bodyText": "Should add UT to cover this case.", "author": "kangkaisen", "createdAt": "2020-10-26T01:59:58Z", "path": "be/src/exprs/timestamp_functions.cpp", "diffHunk": "@@ -126,7 +126,10 @@ IntVal TimestampFunctions::day_of_week(\n         return IntVal::null();\n     }\n     const DateTimeValue& ts_value = DateTimeValue::from_datetime_val(ts_val);\n-    return IntVal((ts_value.weekday() + 1 ) % 7 + 1);\n+    if (ts_value.is_valid_date()) {\n+        return IntVal((ts_value.weekday() + 1 ) % 7 + 1);\n+    }\n+    return IntVal::null();", "originalCommit": "69a50b362ccd9907e61890dd9c2141dff0d1f19d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc2MTExNA==", "url": "https://github.com/apache/incubator-doris/pull/4786#discussion_r511761114", "bodyText": "done", "author": "morningman", "createdAt": "2020-10-26T07:32:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY4NTQ4OQ=="}], "type": "inlineReview"}, {"oid": "a4ecb658a68b4c84d87c295cf28b48739327e8d0", "url": "https://github.com/apache/incubator-doris/commit/a4ecb658a68b4c84d87c295cf28b48739327e8d0", "message": "add ut", "committedDate": "2020-10-26T07:31:42Z", "type": "commit"}]}