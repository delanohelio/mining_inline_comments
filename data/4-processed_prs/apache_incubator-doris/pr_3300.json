{"pr_number": 3300, "pr_title": "Use Google/CCTZ to replace boost at timezone function", "pr_createdAt": "2020-04-10T14:27:29Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3300", "timeline": [{"oid": "fa975cbeaddf8891ab50ee974acbb52a37f006c2", "url": "https://github.com/apache/incubator-doris/commit/fa975cbeaddf8891ab50ee974acbb52a37f006c2", "message": "fix ut", "committedDate": "2020-04-04T13:54:46Z", "type": "commit"}, {"oid": "c974314445f474c341879486e8f351b145f0e6b3", "url": "https://github.com/apache/incubator-doris/commit/c974314445f474c341879486e8f351b145f0e6b3", "message": "fix ut", "committedDate": "2020-04-05T13:28:55Z", "type": "commit"}, {"oid": "4787c6655901f025f49cd7e4e41ef0486aa15a69", "url": "https://github.com/apache/incubator-doris/commit/4787c6655901f025f49cd7e4e41ef0486aa15a69", "message": "fix ut", "committedDate": "2020-04-05T13:47:26Z", "type": "commit"}, {"oid": "919fa2751ae342c50dca564495227c2ab4d2d42c", "url": "https://github.com/apache/incubator-doris/commit/919fa2751ae342c50dca564495227c2ab4d2d42c", "message": "Merge branch 'cctz' of github.com:HangyuanLiu/incubator-doris into cctz\n\nConflicts:\n\tbe/src/runtime/datetime_value.cpp", "committedDate": "2020-04-05T13:49:07Z", "type": "commit"}, {"oid": "0a5f98e42f4d7f8844c6c4b548d9aa117900fc36", "url": "https://github.com/apache/incubator-doris/commit/0a5f98e42f4d7f8844c6c4b548d9aa117900fc36", "message": "Merge branch 'cctz' of github.com:HangyuanLiu/incubator-doris into cctz\n\nConflicts:\n\tbe/src/runtime/datetime_value.cpp", "committedDate": "2020-04-05T13:54:53Z", "type": "commit"}, {"oid": "20961d274ba62dce621efec48e80d9510a6ef510", "url": "https://github.com/apache/incubator-doris/commit/20961d274ba62dce621efec48e80d9510a6ef510", "message": "fix ut", "committedDate": "2020-04-05T14:50:09Z", "type": "commit"}, {"oid": "2e7dde30b5f4650e72c443793caa4de0441f6673", "url": "https://github.com/apache/incubator-doris/commit/2e7dde30b5f4650e72c443793caa4de0441f6673", "message": "Merge branch 'master' of https://github.com/apache/incubator-doris into cctz", "committedDate": "2020-04-10T07:55:22Z", "type": "commit"}, {"oid": "5ba25aa1a91a8bdcda0d0d944562afa26db49752", "url": "https://github.com/apache/incubator-doris/commit/5ba25aa1a91a8bdcda0d0d944562afa26db49752", "message": "Merge branch 'cctz' of github.com:HangyuanLiu/incubator-doris into cctz", "committedDate": "2020-04-10T14:17:00Z", "type": "commit"}, {"oid": "9c5f3a6f0e63cb1726c31c1984861e5762dff584", "url": "https://github.com/apache/incubator-doris/commit/9c5f3a6f0e63cb1726c31c1984861e5762dff584", "message": "fix code style", "committedDate": "2020-04-10T14:25:10Z", "type": "commit"}, {"oid": "060ff8dafaba3fe17e112f2fcf603157a58d3944", "url": "https://github.com/apache/incubator-doris/commit/060ff8dafaba3fe17e112f2fcf603157a58d3944", "message": "fix ut", "committedDate": "2020-04-15T09:41:50Z", "type": "commit"}, {"oid": "060ff8dafaba3fe17e112f2fcf603157a58d3944", "url": "https://github.com/apache/incubator-doris/commit/060ff8dafaba3fe17e112f2fcf603157a58d3944", "message": "fix ut", "committedDate": "2020-04-15T09:41:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg1NzUxMg==", "url": "https://github.com/apache/incubator-doris/pull/3300#discussion_r410857512", "bodyText": "Missing return value", "author": "morningman", "createdAt": "2020-04-19T09:07:13Z", "path": "be/src/runtime/datetime_value.h", "diffHunk": "@@ -494,6 +498,33 @@ class DateTimeValue {\n         return _neg ? -tmp : tmp;\n     }\n \n+    bool find_cctz_time_zone(const std::string& timezone, cctz::time_zone& ctz) const {\n+        re2::StringPiece value;\n+        if (time_zone_offset_format_reg.Match(timezone, 0, timezone.size(), RE2::UNANCHORED, &value, 1)) {\n+            bool postive = value[0] != '-';\n+\n+            //Regular expression guarantees hour and minute mush be int \n+            int hour = std::stoi(value.substr(1, 2).as_string());\n+            int minute = std::stoi(value.substr(4, 2).as_string());\n+\n+            // timezone offsets around the world extended from -12:00 to +14:00\n+            if (!postive && hour > 12) {\n+                return false;\n+            } else if (postive && hour > 14) {\n+                return false;\n+            }\n+            int offset = hour * 60 * 60 + minute * 60;\n+            offset *= postive ? 1 : -1;\n+            ctz = cctz::fixed_time_zone(cctz::seconds(offset));\n+            return true;\n+        } else if (timezone == \"CST\"){\n+            // Supports offset and region timezone type, \"CST\" use here is compatibility purposes.\n+            ctz = cctz::fixed_time_zone(cctz::seconds(8 * 60 * 60));", "originalCommit": "060ff8dafaba3fe17e112f2fcf603157a58d3944", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9520f6f268f43cfec950302717ae596c7a5c7ad4", "url": "https://github.com/apache/incubator-doris/commit/9520f6f268f43cfec950302717ae596c7a5c7ad4", "message": "fix bug", "committedDate": "2020-04-20T12:28:28Z", "type": "commit"}, {"oid": "ea5a7668b4b7d7b2d665d1a1cfbd14e55b95cb05", "url": "https://github.com/apache/incubator-doris/commit/ea5a7668b4b7d7b2d665d1a1cfbd14e55b95cb05", "message": "fix ut", "committedDate": "2020-04-20T12:45:24Z", "type": "commit"}, {"oid": "f581e58b792b4d4b305ac273039000af69cd1ad1", "url": "https://github.com/apache/incubator-doris/commit/f581e58b792b4d4b305ac273039000af69cd1ad1", "message": "Update timestamp_functions.cpp", "committedDate": "2020-04-21T02:51:00Z", "type": "commit"}, {"oid": "102baefc5a2fc6585d2116959ad30866c6cf18ff", "url": "https://github.com/apache/incubator-doris/commit/102baefc5a2fc6585d2116959ad30866c6cf18ff", "message": "fix ut", "committedDate": "2020-04-22T03:50:40Z", "type": "commit"}, {"oid": "eaf6c13c6c853c77266f19a1b1d6004bf3759050", "url": "https://github.com/apache/incubator-doris/commit/eaf6c13c6c853c77266f19a1b1d6004bf3759050", "message": "Merge branch 'cctz' of https://github.com/HangyuanLiu/incubator-doris into cctz", "committedDate": "2020-04-22T03:52:02Z", "type": "commit"}]}