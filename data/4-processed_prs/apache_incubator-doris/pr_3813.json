{"pr_number": 3813, "pr_title": "[Doris On ES] Skip function_call expr when process predicate", "pr_createdAt": "2020-06-09T10:49:37Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3813", "timeline": [{"oid": "a2c5c9204eed794f4caa88b382f5cb708e4d8d67", "url": "https://github.com/apache/incubator-doris/commit/a2c5c9204eed794f4caa88b382f5cb708e4d8d67", "message": "[Doris On ES] Skip function_call expr when process predicate", "committedDate": "2020-06-09T10:15:09Z", "type": "commit"}, {"oid": "99eac388cb0d879f9bab9da97009f672beeb3c06", "url": "https://github.com/apache/incubator-doris/commit/99eac388cb0d879f9bab9da97009f672beeb3c06", "message": "[Doris On ES] Skip function_call expr when process predicate", "committedDate": "2020-06-09T10:49:06Z", "type": "commit"}, {"oid": "5ae85fd0523ef36451378a49bc31811d16fb7bf3", "url": "https://github.com/apache/incubator-doris/commit/5ae85fd0523ef36451378a49bc31811d16fb7bf3", "message": "format code and delete extra comment", "committedDate": "2020-06-09T11:18:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgyMTY2NA==", "url": "https://github.com/apache/incubator-doris/pull/3813#discussion_r437821664", "bodyText": "what is slot ref? add some example otherwise  it will be very confusing once this error occurs.\ne.g. slot ref(xx, xxx)", "author": "blackfox1983", "createdAt": "2020-06-10T02:16:14Z", "path": "be/src/exec/es/es_predicate.cpp", "diffHunk": "@@ -49,6 +49,14 @@ namespace doris {\n \n using namespace std;\n \n+#define RETURN_ERROR_IF_EXPR_IS_NOT_SLOTREF(expr) \\\n+    do { \\\n+            const Expr* expr_without_cast = Expr::expr_without_cast(expr); \\\n+            if (expr_without_cast->node_type() != TExprNodeType::SLOT_REF) { \\\n+                return Status::InternalError(\"build disjuncts failed: child is not slot ref\"); \\", "originalCommit": "5ae85fd0523ef36451378a49bc31811d16fb7bf3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgyMTk5NA==", "url": "https://github.com/apache/incubator-doris/pull/3813#discussion_r437821994", "bodyText": "e.... remove my name from table .... I don't want to be famous this way:(", "author": "blackfox1983", "createdAt": "2020-06-10T02:17:34Z", "path": "be/src/exec/es/es_predicate.cpp", "diffHunk": "@@ -235,13 +243,16 @@ Status EsPredicate::build_disjuncts_list(const Expr* conjunct) {\n         if (TExprNodeType::SLOT_REF == conjunct->get_child(0)->node_type()\n             || TExprNodeType::CAST_EXPR == conjunct->get_child(0)->node_type()) {\n             expr = conjunct->get_child(1);\n+            // process such as sub-query: select * from (select split_part(k, \"_\", 1) as new_field from case_replay_for_milimin) t where t.new_field > 1;", "originalCommit": "5ae85fd0523ef36451378a49bc31811d16fb7bf3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}