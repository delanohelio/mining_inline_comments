{"pr_number": 3641, "pr_title": "[Bug] Ignore loading DELETE status tablet error when restarting BE", "pr_createdAt": "2020-05-20T07:01:22Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3641", "timeline": [{"oid": "df4ce5871a824a4a84801370bcb73e44b2d010e6", "url": "https://github.com/apache/incubator-doris/commit/df4ce5871a824a4a84801370bcb73e44b2d010e6", "message": "pre-0.12.11", "committedDate": "2020-05-20T01:51:59Z", "type": "commit"}, {"oid": "11679376d4ea5d9e3f1c8d53a1355bbc81cdb0ce", "url": "https://github.com/apache/incubator-doris/commit/11679376d4ea5d9e3f1c8d53a1355bbc81cdb0ce", "message": "support batch delete", "committedDate": "2020-05-20T05:10:06Z", "type": "commit"}, {"oid": "c2edb9fa31addd736f67571d79610931deffb6c8", "url": "https://github.com/apache/incubator-doris/commit/c2edb9fa31addd736f67571d79610931deffb6c8", "message": "add log", "committedDate": "2020-05-20T06:58:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg2Mzc0Mg==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r427863742", "bodyText": "how about log warning first, and then\nif (!config::ignore_load_tablet_failure) {\n    LOG(FATAL) << \"be will shutdown due to ignore_load_tablet_failure is false\"\n}", "author": "yangzhg", "createdAt": "2020-05-20T09:18:35Z", "path": "be/src/olap/data_dir.cpp", "diffHunk": "@@ -709,13 +716,29 @@ OLAPStatus DataDir::load() {\n         return true;\n     };\n     OLAPStatus load_tablet_status = TabletMetaManager::traverse_headers(_meta, load_tablet_func);\n-    if (failed_tablet_ids.size() != 0 && !config::ignore_load_tablet_failure) {\n-        LOG(FATAL) << \"load tablets from header failed, failed tablets size: \" << failed_tablet_ids.size();\n+    if (failed_tablet_ids.size() != 0) {\n+        if (!config::ignore_load_tablet_failure) {", "originalCommit": "c2edb9fa31addd736f67571d79610931deffb6c8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAxMzM1MQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428013351", "bodyText": "ok", "author": "morningman", "createdAt": "2020-05-20T13:32:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg2Mzc0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg2NzQzMg==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r427867432", "bodyText": "I think its better to use ',' as separation character,  it is more common, and likes a csv file", "author": "yangzhg", "createdAt": "2020-05-20T09:24:35Z", "path": "be/src/tools/meta_tool.cpp", "diffHunk": "@@ -122,13 +126,131 @@ void delete_meta(DataDir* data_dir) {\n     std::cout << \"delete meta successfully\" << std::endl;\n }\n \n+Status init_data_dir(const std::string dir, DataDir** ret) {\n+    std::string root_path;\n+    Status st = FileUtils::canonicalize(dir, &root_path);\n+    if (!st.ok()) {\n+        std::cout << \"invalid root path:\" << FLAGS_root_path\n+            << \", error: \" << st.to_string() << std::endl;\n+        return Status::InternalError(\"invalid root path\");\n+    }\n+    doris::StorePath path;\n+    auto res = parse_root_path(root_path, &path);\n+    if (res != OLAP_SUCCESS) {\n+        std::cout << \"parse root path failed:\" << root_path << std::endl;\n+        return Status::InternalError(\"parse root path failed\");\n+    }\n+\n+    *ret = new (std::nothrow) DataDir(path.path, path.capacity_bytes, path.storage_medium);\n+    if (*ret == nullptr) {\n+        std::cout << \"new data dir failed\" << std::endl;\n+        return Status::InternalError(\"new data dir failed\");\n+    }\n+    st = (*ret)->init();\n+    if (!st.ok()) {\n+        std::cout << \"data_dir load failed\" << std::endl;\n+        return Status::InternalError(\"data_dir load failed\");\n+    }\n+\n+    return Status::OK();\n+}\n+\n+void batch_delete_meta(const std::string tablet_file) {\n+    // each line in tablet file indicate a tablet to delete, format is:\n+    //      data_dir tablet_id schema_hash\n+    // eg:\n+    //      /data1/palo.HDD 100010 11212389324\n+    //      /data2/palo.HDD 100010 23049230234\n+    std::ifstream infile(tablet_file);\n+    std::string line;\n+    int err_num = 0;\n+    int delete_num = 0;\n+    int total_num = 0;\n+    std::unordered_map<std::string, std::unique_ptr<DataDir>> dir_map;\n+    while (std::getline(infile, line)) {\n+        total_num++;\n+        vector<string> v = strings::Split(line, \" \");", "originalCommit": "c2edb9fa31addd736f67571d79610931deffb6c8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAxMzMwMw==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428013303", "bodyText": "ok", "author": "morningman", "createdAt": "2020-05-20T13:32:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg2NzQzMg=="}], "type": "inlineReview"}, {"oid": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "url": "https://github.com/apache/incubator-doris/commit/01b9b2850af0abd8d068aef425c39505a2ac50cd", "message": "fix by review", "committedDate": "2020-05-20T13:37:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2MzI4NQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428463285", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    LOG(INFO) << \"load rowset from meta finished\"\n          \n          \n            \n                    LOG(INFO) << \"load tablet meta finished\"", "author": "kangpinghuang", "createdAt": "2020-05-21T06:08:36Z", "path": "be/src/olap/data_dir.cpp", "diffHunk": "@@ -709,13 +716,25 @@ OLAPStatus DataDir::load() {\n         return true;\n     };\n     OLAPStatus load_tablet_status = TabletMetaManager::traverse_headers(_meta, load_tablet_func);\n-    if (failed_tablet_ids.size() != 0 && !config::ignore_load_tablet_failure) {\n-        LOG(FATAL) << \"load tablets from header failed, failed tablets size: \" << failed_tablet_ids.size();\n+    if (failed_tablet_ids.size() != 0) {\n+        LOG(WARNING) << \"load tablets from header failed\"\n+            << \", loaded tablet: \" << tablet_ids.size()\n+            << \", error tablet: \" << failed_tablet_ids.size()\n+            << \", path: \" << _path;\n+        if (!config::ignore_load_tablet_failure) {\n+            LOG(FATAL) << \"load tablets encounter failure. stop BE process. path: \" << _path;\n+        }\n     }\n     if (load_tablet_status != OLAP_SUCCESS) {\n-        LOG(WARNING) << \"there is failure when loading tablet headers, path:\" << _path;\n+        LOG(WARNING) << \"there is failure when loading tablet headers\"\n+                << \", loaded tablet: \" << tablet_ids.size()\n+                << \", error tablet: \" << failed_tablet_ids.size()\n+                << \", path: \" << _path;\n     } else {\n-        LOG(INFO) << \"load rowset from meta finished, data dir: \" << _path;\n+        LOG(INFO) << \"load rowset from meta finished\"", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MDI0MQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428470241", "bodyText": "OK", "author": "morningman", "createdAt": "2020-05-21T06:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2MzI4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Mzc0Mw==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428463743", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Status init_data_dir(const std::string dir, DataDir** ret) {\n          \n          \n            \n            Status init_data_dir(const std::string& dir, DataDir** ret) {", "author": "kangpinghuang", "createdAt": "2020-05-21T06:10:11Z", "path": "be/src/tools/meta_tool.cpp", "diffHunk": "@@ -122,13 +126,131 @@ void delete_meta(DataDir* data_dir) {\n     std::cout << \"delete meta successfully\" << std::endl;\n }\n \n+Status init_data_dir(const std::string dir, DataDir** ret) {", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NTc5OA==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428465798", "bodyText": "and why here use DataDir**?\nI think DataDir* or std::unique_ptr* is ok", "author": "kangpinghuang", "createdAt": "2020-05-21T06:16:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Mzc0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MDMzNg==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428470336", "bodyText": "I will change it to unique_ptr", "author": "morningman", "createdAt": "2020-05-21T06:30:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Mzc0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Mzc5OQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428463799", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            void batch_delete_meta(const std::string tablet_file) {\n          \n          \n            \n            void batch_delete_meta(const std::string& tablet_file) {", "author": "kangpinghuang", "createdAt": "2020-05-21T06:10:26Z", "path": "be/src/tools/meta_tool.cpp", "diffHunk": "@@ -122,13 +126,131 @@ void delete_meta(DataDir* data_dir) {\n     std::cout << \"delete meta successfully\" << std::endl;\n }\n \n+Status init_data_dir(const std::string dir, DataDir** ret) {\n+    std::string root_path;\n+    Status st = FileUtils::canonicalize(dir, &root_path);\n+    if (!st.ok()) {\n+        std::cout << \"invalid root path:\" << FLAGS_root_path\n+            << \", error: \" << st.to_string() << std::endl;\n+        return Status::InternalError(\"invalid root path\");\n+    }\n+    doris::StorePath path;\n+    auto res = parse_root_path(root_path, &path);\n+    if (res != OLAP_SUCCESS) {\n+        std::cout << \"parse root path failed:\" << root_path << std::endl;\n+        return Status::InternalError(\"parse root path failed\");\n+    }\n+\n+    *ret = new (std::nothrow) DataDir(path.path, path.capacity_bytes, path.storage_medium);\n+    if (*ret == nullptr) {\n+        std::cout << \"new data dir failed\" << std::endl;\n+        return Status::InternalError(\"new data dir failed\");\n+    }\n+    st = (*ret)->init();\n+    if (!st.ok()) {\n+        std::cout << \"data_dir load failed\" << std::endl;\n+        return Status::InternalError(\"data_dir load failed\");\n+    }\n+\n+    return Status::OK();\n+}\n+\n+void batch_delete_meta(const std::string tablet_file) {", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MTk3MA==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428471970", "bodyText": "OK", "author": "morningman", "createdAt": "2020-05-21T06:35:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Mzc5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NDI0Nw==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428464247", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                std::string line;\n          \n          \n            \n                std::string line = \"\";", "author": "kangpinghuang", "createdAt": "2020-05-21T06:11:58Z", "path": "be/src/tools/meta_tool.cpp", "diffHunk": "@@ -122,13 +126,131 @@ void delete_meta(DataDir* data_dir) {\n     std::cout << \"delete meta successfully\" << std::endl;\n }\n \n+Status init_data_dir(const std::string dir, DataDir** ret) {\n+    std::string root_path;\n+    Status st = FileUtils::canonicalize(dir, &root_path);\n+    if (!st.ok()) {\n+        std::cout << \"invalid root path:\" << FLAGS_root_path\n+            << \", error: \" << st.to_string() << std::endl;\n+        return Status::InternalError(\"invalid root path\");\n+    }\n+    doris::StorePath path;\n+    auto res = parse_root_path(root_path, &path);\n+    if (res != OLAP_SUCCESS) {\n+        std::cout << \"parse root path failed:\" << root_path << std::endl;\n+        return Status::InternalError(\"parse root path failed\");\n+    }\n+\n+    *ret = new (std::nothrow) DataDir(path.path, path.capacity_bytes, path.storage_medium);\n+    if (*ret == nullptr) {\n+        std::cout << \"new data dir failed\" << std::endl;\n+        return Status::InternalError(\"new data dir failed\");\n+    }\n+    st = (*ret)->init();\n+    if (!st.ok()) {\n+        std::cout << \"data_dir load failed\" << std::endl;\n+        return Status::InternalError(\"data_dir load failed\");\n+    }\n+\n+    return Status::OK();\n+}\n+\n+void batch_delete_meta(const std::string tablet_file) {\n+    // each line in tablet file indicate a tablet to delete, format is:\n+    //      data_dir,tablet_id,schema_hash\n+    // eg:\n+    //      /data1/palo.HDD,100010,11212389324\n+    //      /data2/palo.HDD,100010,23049230234\n+    std::ifstream infile(tablet_file);\n+    std::string line;", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MjA4Mw==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428472083", "bodyText": "OK", "author": "morningman", "createdAt": "2020-05-21T06:36:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NDI0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NjQ3MA==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428466470", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            << FLAGS_tablet_id << \", schema_hash:\" << FLAGS_schema_hash\n          \n          \n            \n                            << tablet_id << \", schema_hash:\" << schema_hash", "author": "kangpinghuang", "createdAt": "2020-05-21T06:19:07Z", "path": "be/src/tools/meta_tool.cpp", "diffHunk": "@@ -122,13 +126,131 @@ void delete_meta(DataDir* data_dir) {\n     std::cout << \"delete meta successfully\" << std::endl;\n }\n \n+Status init_data_dir(const std::string dir, DataDir** ret) {\n+    std::string root_path;\n+    Status st = FileUtils::canonicalize(dir, &root_path);\n+    if (!st.ok()) {\n+        std::cout << \"invalid root path:\" << FLAGS_root_path\n+            << \", error: \" << st.to_string() << std::endl;\n+        return Status::InternalError(\"invalid root path\");\n+    }\n+    doris::StorePath path;\n+    auto res = parse_root_path(root_path, &path);\n+    if (res != OLAP_SUCCESS) {\n+        std::cout << \"parse root path failed:\" << root_path << std::endl;\n+        return Status::InternalError(\"parse root path failed\");\n+    }\n+\n+    *ret = new (std::nothrow) DataDir(path.path, path.capacity_bytes, path.storage_medium);\n+    if (*ret == nullptr) {\n+        std::cout << \"new data dir failed\" << std::endl;\n+        return Status::InternalError(\"new data dir failed\");\n+    }\n+    st = (*ret)->init();\n+    if (!st.ok()) {\n+        std::cout << \"data_dir load failed\" << std::endl;\n+        return Status::InternalError(\"data_dir load failed\");\n+    }\n+\n+    return Status::OK();\n+}\n+\n+void batch_delete_meta(const std::string tablet_file) {\n+    // each line in tablet file indicate a tablet to delete, format is:\n+    //      data_dir,tablet_id,schema_hash\n+    // eg:\n+    //      /data1/palo.HDD,100010,11212389324\n+    //      /data2/palo.HDD,100010,23049230234\n+    std::ifstream infile(tablet_file);\n+    std::string line;\n+    int err_num = 0;\n+    int delete_num = 0;\n+    int total_num = 0;\n+    std::unordered_map<std::string, std::unique_ptr<DataDir>> dir_map;\n+    while (std::getline(infile, line)) {\n+        total_num++;\n+        vector<string> v = strings::Split(line, \",\");\n+        if (v.size() != 3) {\n+            std::cout << \"invalid line in tablet_file: \" << line << std::endl;\n+            err_num++;\n+            continue;\n+        }\n+        // 1. get dir\n+        std::string dir;\n+        Status st = FileUtils::canonicalize(v[0], &dir);\n+        if (!st.ok()) {\n+            std::cout << \"invalid root dir in tablet_file: \" << line << std::endl;\n+            err_num++;\n+            continue;\n+        }\n+\n+        if (dir_map.find(dir) == dir_map.end()) {\n+            // new data dir, init it\n+            DataDir* data_dir_p = nullptr;\n+            Status st = init_data_dir(dir, &data_dir_p);\n+            if (!st.ok()) {\n+                std::cout << \"invalid root path:\" << FLAGS_root_path\n+                    << \", error: \" << st.to_string() << std::endl;\n+                err_num++;\n+                continue;\n+            }\n+            dir_map[dir] = std::unique_ptr<DataDir>(data_dir_p);\n+            std::cout << \"get a new data dir: \" << dir << std::endl;\n+        }\n+        DataDir* data_dir = dir_map[dir].get();\n+        if (data_dir == nullptr) {\n+            std::cout << \"failed to get data dir: \" << line << std::endl;\n+            err_num++;\n+            continue;\n+        }\n+\n+        // 2. get tablet id/schema_hash\n+        int64_t tablet_id;\n+        if (!safe_strto64(v[1].c_str(), &tablet_id)) {\n+            std::cout << \"invalid tablet id: \" << line << std::endl;\n+            err_num++;\n+            continue;\n+        }\n+        int64_t schema_hash;\n+        if (!safe_strto64(v[2].c_str(), &schema_hash)) {\n+            std::cout << \"invalid schema hash: \" << line << std::endl;\n+            err_num++;\n+            continue;\n+        }\n+\n+        OLAPStatus s = TabletMetaManager::remove(data_dir, tablet_id, schema_hash);\n+        if (s != OLAP_SUCCESS) {\n+            std::cout << \"delete tablet meta failed for tablet_id:\"\n+                << FLAGS_tablet_id << \", schema_hash:\" << FLAGS_schema_hash", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MjE5Nw==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428472197", "bodyText": "OK", "author": "morningman", "createdAt": "2020-05-21T06:36:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NjQ3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NzQ0Ng==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428467446", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\u53ef\u4ee5\u5355\u72ec\u5220\u9664\u4e00\u4e2a tablet\uff0c\u6216\u8005\u6279\u91cf\u5220\u9664\u4e00\u7ec4 tablet\u3002\n          \n          \n            \n            \u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u5143\u6570\u636e\u529f\u80fd\u3002\u53ef\u4ee5\u5355\u72ec\u5220\u9664\u4e00\u4e2a tablet\u5143\u6570\u636e\uff0c\u6216\u8005\u6279\u91cf\u5220\u9664\u4e00\u7ec4 tablet\u5143\u6570\u636e\u3002", "author": "kangpinghuang", "createdAt": "2020-05-21T06:22:19Z", "path": "docs/zh-CN/administrator-guide/operation/tablet-meta-tool.md", "diffHunk": "@@ -93,14 +93,39 @@ api\uff1a\n \n ### \u5220\u9664 header\n \n-\u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\n+\u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\u53ef\u4ee5\u5355\u72ec\u5220\u9664\u4e00\u4e2a tablet\uff0c\u6216\u8005\u6279\u91cf\u5220\u9664\u4e00\u7ec4 tablet\u3002", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NzUxMg==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428467512", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u5220\u9664\u5355\u4e2atablet\uff1a\n          \n          \n            \n            \u5220\u9664\u5355\u4e2atablet\u5143\u6570\u636e\uff1a", "author": "kangpinghuang", "createdAt": "2020-05-21T06:22:32Z", "path": "docs/zh-CN/administrator-guide/operation/tablet-meta-tool.md", "diffHunk": "@@ -93,14 +93,39 @@ api\uff1a\n \n ### \u5220\u9664 header\n \n-\u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\n+\u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\u53ef\u4ee5\u5355\u72ec\u5220\u9664\u4e00\u4e2a tablet\uff0c\u6216\u8005\u6279\u91cf\u5220\u9664\u4e00\u7ec4 tablet\u3002\n \n-\u547d\u4ee4:\n+\u5220\u9664\u5355\u4e2atablet\uff1a", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2NzY1NQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428467655", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u5220\u9664\u4e00\u7ec4tablet\uff1a\n          \n          \n            \n            \u5220\u9664\u4e00\u7ec4tablet\u5143\u6570\u636e\uff1a", "author": "kangpinghuang", "createdAt": "2020-05-21T06:22:56Z", "path": "docs/zh-CN/administrator-guide/operation/tablet-meta-tool.md", "diffHunk": "@@ -93,14 +93,39 @@ api\uff1a\n \n ### \u5220\u9664 header\n \n-\u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\n+\u4e3a\u4e86\u5b9e\u73b0\u4ece\u67d0\u4e2a be \u7684\u67d0\u4e2a\u76d8\u4e2d\u5220\u9664\u67d0\u4e2a tablet \u7684\u529f\u80fd\u3002\u53ef\u4ee5\u5355\u72ec\u5220\u9664\u4e00\u4e2a tablet\uff0c\u6216\u8005\u6279\u91cf\u5220\u9664\u4e00\u7ec4 tablet\u3002\n \n-\u547d\u4ee4:\n+\u5220\u9664\u5355\u4e2atablet\uff1a\n \n ```\n ./lib/meta_tool --operation=delete_meta --root_path=/path/to/root_path --tablet_id=xxx --schema_hash=xxx\n ```\n \n+\u5220\u9664\u4e00\u7ec4tablet\uff1a", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Nzk3MQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428467971", "bodyText": "will you need to support delete tablet data meanwhile?", "author": "kangpinghuang", "createdAt": "2020-05-21T06:23:54Z", "path": "docs/en/administrator-guide/operation/tablet-meta-tool.md", "diffHunk": "@@ -93,14 +93,39 @@ Order:\n \n ### Delete header\n \n-In order to realize the function of deleting a tablet from a disk of a be.\n+In order to realize the function of deleting a tablet from a disk of a BE. Support single delete and batch delete.\n \n-Order:\n+Single delete:\n \n ```\n ./lib/meta_tool --operation=delete_meta --root_path=/path/to/root_path --tablet_id=xxx --schema_hash=xxx`\n ```\n \n+Batch delete:\n+\n+```\n+./lib/meta_tool --operation=batch_delete_meta --tablet_file=/path/to/tablet_file.txt", "originalCommit": "01b9b2850af0abd8d068aef425c39505a2ac50cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3Mjg3MQ==", "url": "https://github.com/apache/incubator-doris/pull/3641#discussion_r428472871", "bodyText": "Maybe at another PR", "author": "morningman", "createdAt": "2020-05-21T06:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ2Nzk3MQ=="}], "type": "inlineReview"}, {"oid": "6a0a91b4cec7ea4ddce37af79c39c24172a8c0a0", "url": "https://github.com/apache/incubator-doris/commit/6a0a91b4cec7ea4ddce37af79c39c24172a8c0a0", "message": "fix", "committedDate": "2020-05-21T06:58:34Z", "type": "commit"}]}