{"pr_number": 4475, "pr_title": "[Refactor] Refactor storage medium migration task process", "pr_createdAt": "2020-08-27T15:22:37Z", "pr_url": "https://github.com/apache/incubator-doris/pull/4475", "timeline": [{"oid": "caed1bcbe3180ef167b0cc610078e99a1639ccfb", "url": "https://github.com/apache/incubator-doris/commit/caed1bcbe3180ef167b0cc610078e99a1639ccfb", "message": "refector migration task", "committedDate": "2020-10-09T06:30:45Z", "type": "forcePushed"}, {"oid": "ef22bf156b744b5ad079ff89ca3cd0a32b0cf31a", "url": "https://github.com/apache/incubator-doris/commit/ef22bf156b744b5ad079ff89ca3cd0a32b0cf31a", "message": "refector migration task", "committedDate": "2020-10-09T08:01:04Z", "type": "forcePushed"}, {"oid": "f000d5e3fa2749402e4c457eb97eec225d56efc5", "url": "https://github.com/apache/incubator-doris/commit/f000d5e3fa2749402e4c457eb97eec225d56efc5", "message": "refector migration task", "committedDate": "2020-10-20T03:03:33Z", "type": "forcePushed"}, {"oid": "a765b0b403af9bcd836f2a7f87d705da30378675", "url": "https://github.com/apache/incubator-doris/commit/a765b0b403af9bcd836f2a7f87d705da30378675", "message": "refector migration task", "committedDate": "2020-10-20T03:58:28Z", "type": "commit"}, {"oid": "a765b0b403af9bcd836f2a7f87d705da30378675", "url": "https://github.com/apache/incubator-doris/commit/a765b0b403af9bcd836f2a7f87d705da30378675", "message": "refector migration task", "committedDate": "2020-10-20T03:58:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ0MTg1OQ==", "url": "https://github.com/apache/incubator-doris/pull/4475#discussion_r508441859", "bodyText": "Doesn't it print out the reason for the check failure?", "author": "EmmyMiao87", "createdAt": "2020-10-20T12:01:46Z", "path": "be/src/agent/task_worker_pool.cpp", "diffHunk": "@@ -916,19 +916,26 @@ void TaskWorkerPool::_storage_medium_migrate_worker_thread_callback() {\n         }\n \n         TStatusCode::type status_code = TStatusCode::OK;\n-        vector<string> error_msgs;\n-        TStatus task_status;\n-        EngineStorageMigrationTask engine_task(storage_medium_migrate_req);\n-        OLAPStatus res = _env->storage_engine()->execute_task(&engine_task);\n-        if (res != OLAP_SUCCESS) {\n-            LOG(WARNING) << \"storage media migrate failed. status: \" << res\n-                         << \", signature: \" << agent_task_req.signature;\n-            status_code = TStatusCode::RUNTIME_ERROR;\n+        // check request and get info\n+        TabletSharedPtr tablet;\n+        DataDir* dest_store;\n+        if (_check_migrate_requset(storage_medium_migrate_req, tablet, &dest_store) != OLAP_SUCCESS) {\n+            status_code = TStatusCode::RUNTIME_ERROR; ", "originalCommit": "a765b0b403af9bcd836f2a7f87d705da30378675", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}