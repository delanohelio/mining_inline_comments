{"pr_number": 9082, "pr_title": "MERG CBUS - Add Reporter options CANRC522 / CANRCOM", "pr_createdAt": "2020-10-16T10:37:11Z", "pr_url": "https://github.com/JMRI/JMRI/pull/9082", "timeline": [{"oid": "0f89293f204faa3e52f0b6fd1187b4a2e968fe67", "url": "https://github.com/JMRI/JMRI/commit/0f89293f204faa3e52f0b6fd1187b4a2e968fe67", "message": "minor javadoc", "committedDate": "2020-10-15T13:01:21Z", "type": "commit"}, {"oid": "3ac05d09df521a6287822f06a0098473f103a61c", "url": "https://github.com/JMRI/JMRI/commit/3ac05d09df521a6287822f06a0098473f103a61c", "message": "minor code / javadoc", "committedDate": "2020-10-15T13:02:21Z", "type": "commit"}, {"oid": "cdc50cfc34b20e25a341dff30b101b1e6180bd54", "url": "https://github.com/JMRI/JMRI/commit/cdc50cfc34b20e25a341dff30b101b1e6180bd54", "message": "add describeState AbstractIdTagReporter", "committedDate": "2020-10-15T13:03:18Z", "type": "commit"}, {"oid": "be15b1d4c59fcabf7dca0056ebc0f0e9c6550ec2", "url": "https://github.com/JMRI/JMRI/commit/be15b1d4c59fcabf7dca0056ebc0f0e9c6550ec2", "message": "Update NamedBeanBundle.properties", "committedDate": "2020-10-15T13:03:42Z", "type": "commit"}, {"oid": "48415fe31cdd39253a7ae1aa80f908783de38c9d", "url": "https://github.com/JMRI/JMRI/commit/48415fe31cdd39253a7ae1aa80f908783de38c9d", "message": "add SelectionPropertyDescriptor", "committedDate": "2020-10-15T13:04:18Z", "type": "commit"}, {"oid": "3d50af30c63676d67cce7c489385ffc042691bd8", "url": "https://github.com/JMRI/JMRI/commit/3d50af30c63676d67cce7c489385ffc042691bd8", "message": "update beantables to recognise SelectionPropertyDescriptor / remove duplicate code\n\nAdds missing combobox finish editing listeners", "committedDate": "2020-10-15T13:06:44Z", "type": "commit"}, {"oid": "c5e98b8a4cce9bc6b8a7c74b0a516ff612009547", "url": "https://github.com/JMRI/JMRI/commit/c5e98b8a4cce9bc6b8a7c74b0a516ff612009547", "message": "CbusReporter / CbusReporterManager", "committedDate": "2020-10-15T13:07:23Z", "type": "commit"}, {"oid": "8df1f816692114c57f15e2ad9b89ae335ca87809", "url": "https://github.com/JMRI/JMRI/commit/8df1f816692114c57f15e2ad9b89ae335ca87809", "message": "remove setReporter from CbusSensor", "committedDate": "2020-10-15T13:07:53Z", "type": "commit"}, {"oid": "5daa483e069cd5dc089a1a258e7a67c310015f38", "url": "https://github.com/JMRI/JMRI/commit/5daa483e069cd5dc089a1a258e7a67c310015f38", "message": "Update current-draft-note.shtml", "committedDate": "2020-10-15T13:08:44Z", "type": "commit"}, {"oid": "cf6dce1844e06e4c812d00931746d64c4b6383fd", "url": "https://github.com/JMRI/JMRI/commit/cf6dce1844e06e4c812d00931746d64c4b6383fd", "message": "remove unnecessary cast", "committedDate": "2020-10-15T13:14:33Z", "type": "commit"}, {"oid": "242ad70a77e74f005ef313b3f4b86b2e13da0c7e", "url": "https://github.com/JMRI/JMRI/commit/242ad70a77e74f005ef313b3f4b86b2e13da0c7e", "message": "remove unnecessary cast", "committedDate": "2020-10-15T13:25:39Z", "type": "commit"}, {"oid": "2f40641260ae42828aa5ac98d5c1bfb52a971e08", "url": "https://github.com/JMRI/JMRI/commit/2f40641260ae42828aa5ac98d5c1bfb52a971e08", "message": "fix spotbugs", "committedDate": "2020-10-15T13:42:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjcyOTM4OQ==", "url": "https://github.com/JMRI/JMRI/pull/9082#discussion_r506729389", "bodyText": "A design question/suggestion triggered by this change in base class....\nI see later on in this revised class that you have 3 different types of tags ( RFID, RC522, and RailComm ) you might be handling here,  suggesting there are three different types of hardware involved.\nIf that is the case, this class as modified violates the Single Responsibility Principle because it has three reasons it could change.  For long term maintenance and testing reasons, It is advisable to have a different implementation for each of the three types.  That also simplified the logic, because each class has to handle only the information pertaining to the hardware it handles.\nFor an example of where we do this elsewhere, see the Z21 Reporter implementation.", "author": "pabender", "createdAt": "2020-10-16T21:29:11Z", "path": "java/src/jmri/jmrix/can/cbus/CbusReporter.java", "diffHunk": "@@ -25,40 +24,81 @@\n  * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\n  * <p>\n  *\n+ * CBUS Reporters can accept \n+ * 5-byte unique Classic RFID on DDES or ACDAT OPCs,\n+ * CANRC522 / CANRCOM DDES OPCs.\n+ * \n  * @author Mark Riddoch Copyright (C) 2015\n- * @author Steve Young Copyright (c) 2019\n+ * @author Steve Young Copyright (c) 2019, 2020\n  *\n  */\n-public class CbusReporter extends AbstractReporter implements CanListener {\n+public class CbusReporter extends AbstractRailComReporter implements CanListener {", "originalCommit": "2f40641260ae42828aa5ac98d5c1bfb52a971e08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk0NTg1OA==", "url": "https://github.com/JMRI/JMRI/pull/9082#discussion_r506945858", "bodyText": "Hi Paul, thanks for taking the time to look over, it is appreciated.\nI do hear what you are saying about Single Responsibility.\nEg, there's a high chance that CANRCOM will be able to implement the CollectingReporter interface, any code relying on instanceof CollectingReporter will show incorrect results for the other types.\nInspired by Z21ReporterManager, I'm thinking that the next step in development of this would be for \"describing\" system names, eg.\nMR123 - Classic RFID on device 123 - extends AbstractIdTagManager\nMR[CANRC522]123 - CANRC522 on device 123 - extends AbstractRailComReporter\nMR[CANRCOM]123 - CANRCOM on device 123 - extends AbstractRailComReporter implements CollectingReporter\nAs the OPC formats themselves are mid-development ( and I still need to add actual code for CANRCOM! ), there are likely to be a decent number of updates surrounding this, so I'll look at refactoring to unique classes soon.", "author": "icklesteve", "createdAt": "2020-10-17T13:55:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjcyOTM4OQ=="}], "type": "inlineReview"}]}