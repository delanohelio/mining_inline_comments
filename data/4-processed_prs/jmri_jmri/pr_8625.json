{"pr_number": 8625, "pr_title": "Handle doGet, doPost on AWT thread", "pr_createdAt": "2020-06-02T19:46:31Z", "pr_url": "https://github.com/JMRI/JMRI/pull/8625", "timeline": [{"oid": "c83190752552dcce563ea687947b69531ded1d92", "url": "https://github.com/JMRI/JMRI/commit/c83190752552dcce563ea687947b69531ded1d92", "message": "handle doGet, doPost on AWT thread", "committedDate": "2020-06-02T19:44:51Z", "type": "commit"}, {"oid": "c4fef8ea4615695507325eca6295ba2f4e5dec5b", "url": "https://github.com/JMRI/JMRI/commit/c4fef8ea4615695507325eca6295ba2f4e5dec5b", "message": "add first links to AssertJ", "committedDate": "2020-06-03T03:39:38Z", "type": "commit"}, {"oid": "de5d684a855484a88cb3cc839505b54c56aff2cd", "url": "https://github.com/JMRI/JMRI/commit/de5d684a855484a88cb3cc839505b54c56aff2cd", "message": "clean up curly quotes", "committedDate": "2020-06-03T03:48:46Z", "type": "commit"}, {"oid": "7ab0f55fbe1b94340a625952bef6141b7720a60a", "url": "https://github.com/JMRI/JMRI/commit/7ab0f55fbe1b94340a625952bef6141b7720a60a", "message": "better exception handling; add testing", "committedDate": "2020-06-03T03:49:09Z", "type": "commit"}, {"oid": "936e9db0d7259c107e802edbf9e9a16f31ef8bb3", "url": "https://github.com/JMRI/JMRI/commit/936e9db0d7259c107e802edbf9e9a16f31ef8bb3", "message": "protect cast", "committedDate": "2020-06-03T05:04:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5MTEzMQ==", "url": "https://github.com/JMRI/JMRI/pull/8625#discussion_r434391131", "bodyText": "Why do you catch these exceptions and throw a RuntimeException instead?", "author": "danielb987", "createdAt": "2020-06-03T08:19:09Z", "path": "java/src/jmri/web/servlet/frameimage/JmriJFrameServlet.java", "diffHunk": "@@ -207,6 +207,54 @@ private void sendClickSequence(MouseListener m, Component c, int x, int y) {\n \n     @Override\n     protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n+        // because we work with Swing, we do this on the AWT thread\n+        \n+        if (javax.swing.SwingUtilities.isEventDispatchThread()) {\n+            doGetOnSwing(request, response);\n+            return;\n+        }\n+        \n+        try {\n+            javax.swing.SwingUtilities.invokeAndWait(\n+                () -> { \n+                    try {\n+                        doGetOnSwing(request, response);\n+                    } catch ( ServletException | IOException ex ) {\n+                        throw new RuntimeException(ex);", "originalCommit": "936e9db0d7259c107e802edbf9e9a16f31ef8bb3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDYwODYwMA==", "url": "https://github.com/JMRI/JMRI/pull/8625#discussion_r434608600", "bodyText": "You can't throw ServletException or IOException out of Runnable#run() because it's not been declared there.", "author": "bobjacobsen", "createdAt": "2020-06-03T14:25:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5MTEzMQ=="}], "type": "inlineReview"}, {"oid": "ed0de1138fbd786cb59a51235cb11212b998de55", "url": "https://github.com/JMRI/JMRI/commit/ed0de1138fbd786cb59a51235cb11212b998de55", "message": "detab", "committedDate": "2020-06-03T15:03:50Z", "type": "commit"}]}