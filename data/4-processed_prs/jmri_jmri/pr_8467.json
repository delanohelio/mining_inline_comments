{"pr_number": 8467, "pr_title": "Report errors in web browser logs during cucumber tests.", "pr_createdAt": "2020-05-01T05:57:40Z", "pr_url": "https://github.com/JMRI/JMRI/pull/8467", "timeline": [{"oid": "56fab6894e7ea2101c41f112e2f548dff85fd7b2", "url": "https://github.com/JMRI/JMRI/commit/56fab6894e7ea2101c41f112e2f548dff85fd7b2", "message": "enable error log checking in firefox tests", "committedDate": "2020-04-30T05:49:01Z", "type": "commit"}, {"oid": "d6e0a983318e08ba424b4be1e31ce8875eedc490", "url": "https://github.com/JMRI/JMRI/commit/d6e0a983318e08ba424b4be1e31ce8875eedc490", "message": "log errors", "committedDate": "2020-04-30T20:37:55Z", "type": "commit"}, {"oid": "b11cafc231f077e766859c334dcd89dbc4b5cb50", "url": "https://github.com/JMRI/JMRI/commit/b11cafc231f077e766859c334dcd89dbc4b5cb50", "message": "correct capitalization", "committedDate": "2020-04-30T20:47:35Z", "type": "commit"}, {"oid": "153dff173a14904211abd0064a83800352884c2d", "url": "https://github.com/JMRI/JMRI/commit/153dff173a14904211abd0064a83800352884c2d", "message": "enable logging for firefox", "committedDate": "2020-04-30T22:26:28Z", "type": "commit"}, {"oid": "a6d22a0990833ae77d40e69a3a5bf1e5d9c4f10c", "url": "https://github.com/JMRI/JMRI/commit/a6d22a0990833ae77d40e69a3a5bf1e5d9c4f10c", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-02T16:31:26Z", "type": "commit"}, {"oid": "856493ccd003cfda5eef2b88f6098030eff18380", "url": "https://github.com/JMRI/JMRI/commit/856493ccd003cfda5eef2b88f6098030eff18380", "message": "only check Chrome logs.", "committedDate": "2020-05-03T05:18:30Z", "type": "commit"}, {"oid": "456ef3bc3cbcc5dafc028ccb65fead0118bd0a1f", "url": "https://github.com/JMRI/JMRI/commit/456ef3bc3cbcc5dafc028ccb65fead0118bd0a1f", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-03T05:18:49Z", "type": "commit"}, {"oid": "f448c1eaeed5918bdbd7ecee50970fea84287160", "url": "https://github.com/JMRI/JMRI/commit/f448c1eaeed5918bdbd7ecee50970fea84287160", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-12T01:05:08Z", "type": "commit"}, {"oid": "dedd586b6a53258a6ce460bdd9fe60b23f0316d6", "url": "https://github.com/JMRI/JMRI/commit/dedd586b6a53258a6ce460bdd9fe60b23f0316d6", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-12T04:24:42Z", "type": "commit"}, {"oid": "5b92abbc24d4b2aea75aa7558ea799db3e3f9aa8", "url": "https://github.com/JMRI/JMRI/commit/5b92abbc24d4b2aea75aa7558ea799db3e3f9aa8", "message": "more web browser logging", "committedDate": "2020-05-12T21:12:18Z", "type": "commit"}, {"oid": "69c8312ea17c4ae65a62c69bd413918bb9153de4", "url": "https://github.com/JMRI/JMRI/commit/69c8312ea17c4ae65a62c69bd413918bb9153de4", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-12T21:12:41Z", "type": "commit"}, {"oid": "034f9f55c7a5f56d7efd43564560fbef45616cca", "url": "https://github.com/JMRI/JMRI/commit/034f9f55c7a5f56d7efd43564560fbef45616cca", "message": "new line at end of file; adjust log level to ask for.", "committedDate": "2020-05-13T01:15:45Z", "type": "commit"}, {"oid": "a84efaf4e57ce4af1559da32999f6e93fb453f83", "url": "https://github.com/JMRI/JMRI/commit/a84efaf4e57ce4af1559da32999f6e93fb453f83", "message": "adjust log levels", "committedDate": "2020-05-13T03:35:01Z", "type": "commit"}, {"oid": "d42499af593eff152e2f023e605fed3899bcb1c0", "url": "https://github.com/JMRI/JMRI/commit/d42499af593eff152e2f023e605fed3899bcb1c0", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-14T00:31:37Z", "type": "commit"}, {"oid": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "url": "https://github.com/JMRI/JMRI/commit/2b0bf2cedd965b962ecfb104e21122468f2cc94e", "message": "adjust log levels", "committedDate": "2020-05-15T01:18:01Z", "type": "commit"}, {"oid": "1e7d5d79af91710fc818e66df19069a38e17fb25", "url": "https://github.com/JMRI/JMRI/commit/1e7d5d79af91710fc818e66df19069a38e17fb25", "message": "remove extra output", "committedDate": "2020-05-15T01:23:54Z", "type": "commit"}, {"oid": "a4163b0d966052c14de060db8590d059964509ca", "url": "https://github.com/JMRI/JMRI/commit/a4163b0d966052c14de060db8590d059964509ca", "message": "correct condition", "committedDate": "2020-05-15T02:37:58Z", "type": "commit"}, {"oid": "9a2c5e05c68df245b80337025c8379c239082d88", "url": "https://github.com/JMRI/JMRI/commit/9a2c5e05c68df245b80337025c8379c239082d88", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-15T04:49:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzA0MQ==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757041", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:08:10Z", "path": "web/js/jquery.jmri.js", "diffHunk": "@@ -965,7 +965,7 @@\n                             if (h) {\n                                 h.call(this, m);\n                             } else if (!m.type) {\n-                                jmri.log(\"ERROR: missing type property in \" + m);\n+                                console.error(\"ERROR: missing type property in \" + m);", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgxOTE3NQ==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425819175", "bodyText": "I see this as an aid to developer debugging.  Sending everything to console.log means we aren't using the developer tools provided by the browser effectively, because we aren't using the tools the browser gives us to flag error messages.  Per https://www.w3schools.com/jsref/met_console_error.asp every modern browser supports console.error, so we should be using that.\nIf we have to check to see if the console exists and that each function is available, I'll make that happen, but it will be wrapped inside of a new logger object that handles the checks appropriately.", "author": "pabender", "createdAt": "2020-05-15T13:56:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzA0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzMxNQ==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757315", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:08:43Z", "path": "web/js/panel.js", "diffHunk": "@@ -2048,11 +2048,11 @@ function $drawTrackSegment($widget) {\n     var $ep1, $ep2;\n     [$ep1, $ep2] = $getEndPoints$($widget);\n     if (typeof $ep1 === \"undefined\") {\n-    \t\tjmri.log(\"ERROR: can't draw tracksegment \" + $widget.ident + \": connect1: \" + $widget.connect1name + \".\" + $widget.type1 + \" undefined.\");\n+    \t\tconsole.error(\"ERROR: can't draw tracksegment \" + $widget.ident + \": connect1: \" + $widget.connect1name + \".\" + $widget.type1 + \" undefined.\");", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzM0Mw==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757343", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:08:47Z", "path": "web/js/jquery.jmri.js", "diffHunk": "@@ -955,7 +955,7 @@\n                                 if (h) {\n                                     h.call(this, o);\n                                 } else if (!o.type) {\n-                                    jmri.log(\"ERROR: missing type property in \" + o);\n+                                    console.error(\"ERROR: missing type property in \" + o);", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzM4Ng==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757386", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:08:52Z", "path": "web/js/panel.js", "diffHunk": "@@ -2048,11 +2048,11 @@ function $drawTrackSegment($widget) {\n     var $ep1, $ep2;\n     [$ep1, $ep2] = $getEndPoints$($widget);\n     if (typeof $ep1 === \"undefined\") {\n-    \t\tjmri.log(\"ERROR: can't draw tracksegment \" + $widget.ident + \": connect1: \" + $widget.connect1name + \".\" + $widget.type1 + \" undefined.\");\n+    \t\tconsole.error(\"ERROR: can't draw tracksegment \" + $widget.ident + \": connect1: \" + $widget.connect1name + \".\" + $widget.type1 + \" undefined.\");\n         return;\n     }\n     if (typeof $ep2 === \"undefined\") {\n-    \t\tjmri.log(\"ERROR: can't draw tracksegment \" + $widget.ident + \": connect2: \" + $widget.connect2name + \".\" + $widget.type2 + \" undefined.\");\n+    \t\tconsole.error(\"ERROR: can't draw tracksegment \" + $widget.ident + \": connect2: \" + $widget.connect2name + \".\" + $widget.type2 + \" undefined.\");", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzQyNg==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757426", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:08:57Z", "path": "web/js/panel.js", "diffHunk": "@@ -2257,7 +2257,7 @@ function $drawIcon($widget) {\n             $(\"#panel-area>#\" + $widget.id + \"-overlay\").css(ovlCSS);\n         }\n     } else {\n-        jmri.log(\"ERROR: image not defined for \" + $widget.widgetType + \" \" + $widget.id + \", state=\" + $widget.state + \", occ=\" + $widget.occupancystate);\n+        console.error(\"ERROR: image not defined for \" + $widget.widgetType + \" \" + $widget.id + \", state=\" + $widget.state + \", occ=\" + $widget.occupancystate);", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzQ4NA==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757484", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:09:04Z", "path": "web/js/panel.js", "diffHunk": "@@ -3473,7 +3473,7 @@ var $reDrawIcon = function($widget) {\n     } else if ($widget['defaulticon']) {  //if state icon not found, use default icon if provided\n         $('img#' + $widget.id).attr('src', $widget['defaulticon']);\n     } else {\n-        jmri.log(\"ERROR: image not defined for \" + $widget.widgetType + \" \" + $widget.id + \", state=\" + $widget.state + \", occ=\" + $widget.occupancystate);\n+        console.error(\"ERROR: image not defined for \" + $widget.widgetType + \" \" + $widget.id + \", state=\" + $widget.state + \", occ=\" + $widget.occupancystate);", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzUyMA==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757520", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:09:07Z", "path": "web/js/panel.js", "diffHunk": "@@ -2860,7 +2860,7 @@ function $drawLayoutShape($widget) {\n                 }\n                 $gCtx.quadraticCurveTo(p[0], p[1], midR[0], midR[1]);\n             } else {\n-                jmri.log(\"ERROR: unexpected LayoutShape point type '\" + lspt + \"' for \" + $widget.ide);\n+                console.error(\"ERROR: unexpected LayoutShape point type '\" + lspt + \"' for \" + $widget.ide);", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc1NzU4Mw==", "url": "https://github.com/JMRI/JMRI/pull/8467#discussion_r425757583", "bodyText": "Note: You cannot rely on the console existing--there is no reason not to expect console.error to crash out the JavaScript completely on user's devices, so please revert this, or come up with a reliable alternative.\nThere is zero benefit to writing code to making unit testing easy if if crashes out entirely for users.", "author": "rhwood", "createdAt": "2020-05-15T12:09:15Z", "path": "web/js/panel.js", "diffHunk": "@@ -4013,7 +4013,7 @@ function setBlockColor(blockName, newColor) {\n     if (isDefined($blk)) {\n         $gBlks[blockName].blockcolor = newColor;\n     } else {\n-        jmri.log(\"ERROR: block \" + blockName + \" not found for color \" + newColor);\n+        console.error(\"ERROR: block \" + blockName + \" not found for color \" + newColor);", "originalCommit": "2b0bf2cedd965b962ecfb104e21122468f2cc94e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "57858fb511592151ae0fd9d342bc73ec4c8fff50", "url": "https://github.com/JMRI/JMRI/commit/57858fb511592151ae0fd9d342bc73ec4c8fff50", "message": "introduce logger to javascript", "committedDate": "2020-05-16T02:03:44Z", "type": "commit"}, {"oid": "ebaf29346d259ad1c6cc8807bd923a6339107ee3", "url": "https://github.com/JMRI/JMRI/commit/ebaf29346d259ad1c6cc8807bd923a6339107ee3", "message": "Merge branch 'catchjavascripterrors' of github.com:pabender/JMRI into catchjavascripterrors", "committedDate": "2020-05-17T16:20:41Z", "type": "commit"}, {"oid": "ba2ea835b778dc99b7cc9638feda4f2b018bc4cf", "url": "https://github.com/JMRI/JMRI/commit/ba2ea835b778dc99b7cc9638feda4f2b018bc4cf", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-17T16:21:05Z", "type": "commit"}, {"oid": "5d335d7047abdd1b6bba2bf43ab46cd5a7f6b8f6", "url": "https://github.com/JMRI/JMRI/commit/5d335d7047abdd1b6bba2bf43ab46cd5a7f6b8f6", "message": "Merge branch 'master' of https://github.com/JMRI/JMRI into catchjavascripterrors", "committedDate": "2020-05-23T22:54:47Z", "type": "commit"}, {"oid": "79c6a87b5cd71c2816c805bc5abb5ea4b4ec0109", "url": "https://github.com/JMRI/JMRI/commit/79c6a87b5cd71c2816c805bc5abb5ea4b4ec0109", "message": "use Logger object", "committedDate": "2020-05-24T00:29:54Z", "type": "commit"}, {"oid": "d130f59c7554f920196175111fa3a99bae8c7c62", "url": "https://github.com/JMRI/JMRI/commit/d130f59c7554f920196175111fa3a99bae8c7c62", "message": "Merge branch 'catchjavascripterrors' of github.com:pabender/JMRI into catchjavascripterrors", "committedDate": "2020-05-24T00:30:31Z", "type": "commit"}, {"oid": "2e3b8608c5bec7583b1b4295fa7e5846d811f625", "url": "https://github.com/JMRI/JMRI/commit/2e3b8608c5bec7583b1b4295fa7e5846d811f625", "message": "warn not warning", "committedDate": "2020-05-24T01:16:25Z", "type": "commit"}]}