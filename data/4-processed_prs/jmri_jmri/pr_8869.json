{"pr_number": 8869, "pr_title": "Merge MQTT development branch", "pr_createdAt": "2020-07-26T19:46:23Z", "pr_url": "https://github.com/JMRI/JMRI/pull/8869", "timeline": [{"oid": "850be49625e986b6d22cb94f5654697b077c5edf", "url": "https://github.com/JMRI/JMRI/commit/850be49625e986b6d22cb94f5654697b077c5edf", "message": "a bit on saving", "committedDate": "2019-04-09T12:54:35Z", "type": "commit"}, {"oid": "8f4cbe1208bf5deba5bffb99a46a3855dd2e19f8", "url": "https://github.com/JMRI/JMRI/commit/8f4cbe1208bf5deba5bffb99a46a3855dd2e19f8", "message": "add options, even if not really working or in order", "committedDate": "2019-04-09T12:55:02Z", "type": "commit"}, {"oid": "1631759cc6dce746b857f2545cebff55803bd45c", "url": "https://github.com/JMRI/JMRI/commit/1631759cc6dce746b857f2545cebff55803bd45c", "message": "keep & display options in key-alpha order", "committedDate": "2019-04-09T13:11:03Z", "type": "commit"}, {"oid": "0fd1a3c7ec23b2ef9aee40ef3f3d07d577a29577", "url": "https://github.com/JMRI/JMRI/commit/0fd1a3c7ec23b2ef9aee40ef3f3d07d577a29577", "message": "added Sensor et al, but not compile, not run, no tests, no XML", "committedDate": "2019-06-01T13:54:26Z", "type": "commit"}, {"oid": "d54d92fbbf6175233707114f16630373c04a0bfd", "url": "https://github.com/JMRI/JMRI/commit/d54d92fbbf6175233707114f16630373c04a0bfd", "message": "merge to current master, fix SystemConnection-related conflicts", "committedDate": "2020-07-26T19:07:29Z", "type": "commit"}, {"oid": "360870617e5d9095421f18d17b3a1c91cfb4c815", "url": "https://github.com/JMRI/JMRI/commit/360870617e5d9095421f18d17b3a1c91cfb4c815", "message": "merge next-mqtt branch and de-conflict", "committedDate": "2020-07-26T19:34:55Z", "type": "commit"}, {"oid": "0dbc87a9c11c88aff222c6ae2addae0947d178c4", "url": "https://github.com/JMRI/JMRI/commit/0dbc87a9c11c88aff222c6ae2addae0947d178c4", "message": "release note", "committedDate": "2020-07-26T19:35:09Z", "type": "commit"}, {"oid": "7f6d4c60ba822f5f07b0f1067f86b81db2f0d618", "url": "https://github.com/JMRI/JMRI/commit/7f6d4c60ba822f5f07b0f1067f86b81db2f0d618", "message": "missed a conflict", "committedDate": "2020-07-26T19:36:04Z", "type": "commit"}, {"oid": "45151f115707e326f97b2c99babff342fcbab9dd", "url": "https://github.com/JMRI/JMRI/commit/45151f115707e326f97b2c99babff342fcbab9dd", "message": "javadoc fix", "committedDate": "2020-07-26T20:03:00Z", "type": "commit"}, {"oid": "49369887eb893a89362c552dc906beb981f489e3", "url": "https://github.com/JMRI/JMRI/commit/49369887eb893a89362c552dc906beb981f489e3", "message": "add detail to note", "committedDate": "2020-07-26T20:03:12Z", "type": "commit"}, {"oid": "edfb566e73bd81137192b5d77d979be16019e65d", "url": "https://github.com/JMRI/JMRI/commit/edfb566e73bd81137192b5d77d979be16019e65d", "message": "detab", "committedDate": "2020-07-26T20:59:50Z", "type": "commit"}, {"oid": "1a99bcad63b69847956e6200488550ff60ed3801", "url": "https://github.com/JMRI/JMRI/commit/1a99bcad63b69847956e6200488550ff60ed3801", "message": "add bundle test", "committedDate": "2020-07-26T21:02:08Z", "type": "commit"}, {"oid": "1d2bbec76ee500af106a97ea04b3235717021008", "url": "https://github.com/JMRI/JMRI/commit/1d2bbec76ee500af106a97ea04b3235717021008", "message": "Add MqttSensorTest; improvetestability; suppress messages", "committedDate": "2020-07-28T05:30:22Z", "type": "commit"}, {"oid": "4232494e5e735cde03aad8b5c2e1e03eb9b23964", "url": "https://github.com/JMRI/JMRI/commit/4232494e5e735cde03aad8b5c2e1e03eb9b23964", "message": "MqttSensorManagerTest", "committedDate": "2020-07-28T05:38:42Z", "type": "commit"}, {"oid": "3f00db2152938024b751242b07f80b61d0a66ff3", "url": "https://github.com/JMRI/JMRI/commit/3f00db2152938024b751242b07f80b61d0a66ff3", "message": "spotbugs adding to workload again", "committedDate": "2020-07-28T06:22:12Z", "type": "commit"}, {"oid": "27a491d62178befc67754b05c3021752e7c5d6ea", "url": "https://github.com/JMRI/JMRI/commit/27a491d62178befc67754b05c3021752e7c5d6ea", "message": "test coverage", "committedDate": "2020-07-29T02:45:30Z", "type": "commit"}, {"oid": "0ac7b553181c30ded5a388f841183fddd91be354", "url": "https://github.com/JMRI/JMRI/commit/0ac7b553181c30ded5a388f841183fddd91be354", "message": "Merge remote-tracking branch 'origin/master' into mqtt-dev-branch", "committedDate": "2020-08-05T15:04:46Z", "type": "commit"}, {"oid": "bde23c5e18603ec1c0ea16854375b1b8315baef3", "url": "https://github.com/JMRI/JMRI/commit/bde23c5e18603ec1c0ea16854375b1b8315baef3", "message": "index page update", "committedDate": "2020-08-06T02:38:54Z", "type": "commit"}, {"oid": "e523b91103b09f377e203f3e4df54010cb61e49d", "url": "https://github.com/JMRI/JMRI/commit/e523b91103b09f377e203f3e4df54010cb61e49d", "message": "copy option to sensor, turnout manager", "committedDate": "2020-08-06T02:39:26Z", "type": "commit"}, {"oid": "ee03f9d92f9e51e3469c1c04ad98f2e1b8bec6dd", "url": "https://github.com/JMRI/JMRI/commit/ee03f9d92f9e51e3469c1c04ad98f2e1b8bec6dd", "message": "start of text vs jcombobox", "committedDate": "2020-08-06T02:39:56Z", "type": "commit"}, {"oid": "0205b3fbb8e32b3132a094c051ddaac5ef95e3e8", "url": "https://github.com/JMRI/JMRI/commit/0205b3fbb8e32b3132a094c051ddaac5ef95e3e8", "message": "setting default option values", "committedDate": "2020-08-06T19:13:25Z", "type": "commit"}, {"oid": "3775be7962f16ffacf76ba08ce9a1935af6d9a76", "url": "https://github.com/JMRI/JMRI/commit/3775be7962f16ffacf76ba08ce9a1935af6d9a76", "message": "knownState vs outState", "committedDate": "2020-08-06T19:13:47Z", "type": "commit"}, {"oid": "754178e978c8b292b4c9ae0ccab018bdb403ace2", "url": "https://github.com/JMRI/JMRI/commit/754178e978c8b292b4c9ae0ccab018bdb403ace2", "message": "text box config option", "committedDate": "2020-08-06T19:14:29Z", "type": "commit"}, {"oid": "fadea781022fb127806913030e848e4e5c36a42d", "url": "https://github.com/JMRI/JMRI/commit/fadea781022fb127806913030e848e4e5c36a42d", "message": "load/store", "committedDate": "2020-08-06T19:14:44Z", "type": "commit"}, {"oid": "33dc1fd1ec079bb27b45f9d9ede161dc2cedcd8e", "url": "https://github.com/JMRI/JMRI/commit/33dc1fd1ec079bb27b45f9d9ede161dc2cedcd8e", "message": "doc update", "committedDate": "2020-08-06T20:02:48Z", "type": "commit"}, {"oid": "64335cdb8a18d24166067743466846ced24bfe2d", "url": "https://github.com/JMRI/JMRI/commit/64335cdb8a18d24166067743466846ced24bfe2d", "message": "javadoc", "committedDate": "2020-08-06T20:18:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY2MjE4OA==", "url": "https://github.com/JMRI/JMRI/pull/8869#discussion_r466662188", "bodyText": "Doesn't these two tests always fail? Seems like you forgot to change from turnout to sensor and the states here...", "author": "elestedt", "createdAt": "2020-08-06T20:17:29Z", "path": "java/test/jmri/jmrix/mqtt/MqttSensorTest.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package jmri.jmrix.mqtt;\n+\n+import jmri.util.*;\n+\n+import org.junit.Assert;\n+import org.junit.jupiter.api.*;\n+\n+/**\n+ *\n+ * @author Bob Jacobsen Coyright (C) 2020\n+ */\n+public class MqttSensorTest extends jmri.implementation.AbstractSensorTestBase {\n+    \n+    @Override\n+    public int numListeners() {return 0;}\n+\n+    @Override\n+    public void checkStatusRequestMsgSent() {}\n+\n+\n+    MqttAdapter a;\n+    String saveTopic;\n+    byte[] savePayload;\n+    \n+    @Override\n+    @BeforeEach\n+    public void setUp() {\n+        jmri.util.JUnitUtil.setUp();\n+        JUnitUtil.initDefaultUserMessagePreferences();\n+        // prepare an interface\n+        saveTopic = null;\n+        savePayload = null;\n+        a = new MqttAdapter(){\n+                @Override\n+                public void publish(String topic, byte[] payload) {\n+                    saveTopic = topic;\n+                    savePayload = payload;\n+                }\n+            };\n+        t = new MqttSensor(a, \"MS1\", \"track/sensor/1\");\n+        JUnitAppender.assertWarnMessage(\"Trying to subscribe before connect/configure is done\");\n+    }\n+\n+    @Override\n+    @AfterEach\n+    public void tearDown() {\n+        t.dispose();\n+        JUnitUtil.tearDown();\n+    }\n+\n+    @Override\n+    public void checkOnMsgSent() {\n+        Assert.assertEquals(\"topic\", \"track/turnout/2\", saveTopic);\n+        Assert.assertEquals(\"topic\", \"THROWN\", new String(savePayload));", "originalCommit": "33dc1fd1ec079bb27b45f9d9ede161dc2cedcd8e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY2MjE5NQ==", "url": "https://github.com/JMRI/JMRI/pull/8869#discussion_r466662195", "bodyText": "... and here", "author": "elestedt", "createdAt": "2020-08-06T20:17:30Z", "path": "java/test/jmri/jmrix/mqtt/MqttSensorTest.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package jmri.jmrix.mqtt;\n+\n+import jmri.util.*;\n+\n+import org.junit.Assert;\n+import org.junit.jupiter.api.*;\n+\n+/**\n+ *\n+ * @author Bob Jacobsen Coyright (C) 2020\n+ */\n+public class MqttSensorTest extends jmri.implementation.AbstractSensorTestBase {\n+    \n+    @Override\n+    public int numListeners() {return 0;}\n+\n+    @Override\n+    public void checkStatusRequestMsgSent() {}\n+\n+\n+    MqttAdapter a;\n+    String saveTopic;\n+    byte[] savePayload;\n+    \n+    @Override\n+    @BeforeEach\n+    public void setUp() {\n+        jmri.util.JUnitUtil.setUp();\n+        JUnitUtil.initDefaultUserMessagePreferences();\n+        // prepare an interface\n+        saveTopic = null;\n+        savePayload = null;\n+        a = new MqttAdapter(){\n+                @Override\n+                public void publish(String topic, byte[] payload) {\n+                    saveTopic = topic;\n+                    savePayload = payload;\n+                }\n+            };\n+        t = new MqttSensor(a, \"MS1\", \"track/sensor/1\");\n+        JUnitAppender.assertWarnMessage(\"Trying to subscribe before connect/configure is done\");\n+    }\n+\n+    @Override\n+    @AfterEach\n+    public void tearDown() {\n+        t.dispose();\n+        JUnitUtil.tearDown();\n+    }\n+\n+    @Override\n+    public void checkOnMsgSent() {\n+        Assert.assertEquals(\"topic\", \"track/turnout/2\", saveTopic);\n+        Assert.assertEquals(\"topic\", \"THROWN\", new String(savePayload));\n+    }\n+\n+    @Override\n+    public void checkOffMsgSent() {\n+        Assert.assertEquals(\"topic\", \"track/turnout/2\", saveTopic);\n+        Assert.assertEquals(\"topic\", \"CLOSED\", new String(savePayload));", "originalCommit": "33dc1fd1ec079bb27b45f9d9ede161dc2cedcd8e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "08d4651b5f92105e207701cfab00dff68e83ec81", "url": "https://github.com/JMRI/JMRI/commit/08d4651b5f92105e207701cfab00dff68e83ec81", "message": "add persistance", "committedDate": "2020-08-06T21:54:38Z", "type": "commit"}, {"oid": "9047f71fa47aa6170484ce99c52db70051243fff", "url": "https://github.com/JMRI/JMRI/commit/9047f71fa47aa6170484ce99c52db70051243fff", "message": "sensor xml test", "committedDate": "2020-08-06T21:57:30Z", "type": "commit"}, {"oid": "8decc39d3735a0d9a77bd13b5392141b00efbecd", "url": "https://github.com/JMRI/JMRI/commit/8decc39d3735a0d9a77bd13b5392141b00efbecd", "message": "test default method for coverage", "committedDate": "2020-08-07T04:21:31Z", "type": "commit"}, {"oid": "a1a8026232d189ab18dd8c507228f3c58f618b2d", "url": "https://github.com/JMRI/JMRI/commit/a1a8026232d189ab18dd8c507228f3c58f618b2d", "message": "remove default method impl OBE", "committedDate": "2020-08-07T06:34:27Z", "type": "commit"}]}