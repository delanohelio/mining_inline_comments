{"pr_number": 1693, "pr_title": "Map generator button #1321", "pr_createdAt": "2020-05-09T02:58:50Z", "pr_url": "https://github.com/FAForever/downlords-faf-client/pull/1693", "timeline": [{"oid": "fe8fd6ff9dd1b29450b2b24da28028d5332fbd56", "url": "https://github.com/FAForever/downlords-faf-client/commit/fe8fd6ff9dd1b29450b2b24da28028d5332fbd56", "message": "Implement #1321 first iteration map generator button\n\n- rearranged buttons in create game dialog\n- removed default button, instead is shown in list\n- map generator button \"new\" label and color", "committedDate": "2020-05-09T02:47:36Z", "type": "commit"}, {"oid": "2868950143184e588faf2a72532cf0c7a81376ed", "url": "https://github.com/FAForever/downlords-faf-client/commit/2868950143184e588faf2a72532cf0c7a81376ed", "message": "Finish #1321\n\n- Convert generator button code to fxml\n- Orange color for NEW tag", "committedDate": "2020-05-09T23:06:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDI4NDA2Ng==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r424284066", "bodyText": "Try avoid UI style set in java code at all costs, use Pseudoclass", "author": "1-alex98", "createdAt": "2020-05-13T09:01:41Z", "path": "src/main/java/com/faforever/client/game/CreateGameController.java", "diffHunk": "@@ -140,8 +148,19 @@ public void initialize() {\n       selectionModel.select(newMapIndex);\n       mapListView.scrollTo(newMapIndex);\n     });\n-\n-    featuredModListView.setCellFactory(param -> new StringListCell<>(FeaturedMod::getDisplayName));\n+    \n+    Function<FeaturedMod, String> isDefaultModString = mod ->\n+      Objects.equals(mod.getTechnicalName(), KnownFeaturedMod.DEFAULT.getTechnicalName()) ?\n+      \" \" + i18n.get(\"game.create.defaultGameTypeMarker\") : null;\n+    \n+    featuredModListView.setCellFactory(param ->\n+        new DualStringListCell<FeaturedMod>(FeaturedMod::getDisplayName, isDefaultModString, false) {\n+      @Override\n+      protected void init() {\n+        // use bind to overwrite updates from css\n+        right.textFillProperty().bind(new SimpleObjectProperty<Paint>(Color.GREY));", "originalCommit": "2868950143184e588faf2a72532cf0c7a81376ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUyNjc3Ng==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r424526776", "bodyText": "I can try but it might not be possible due to how DualStringListCell works.", "author": "Katharsas", "createdAt": "2020-05-13T15:25:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDI4NDA2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1OTMwNg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r427159306", "bodyText": "it is just give it a style class(possibly in code) and set this style class in css", "author": "1-alex98", "createdAt": "2020-05-19T09:25:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDI4NDA2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUwOTc5OA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r427509798", "bodyText": "Ok problem was that (default) ended up with other font/size than the other cell. Need to check when i have time.", "author": "Katharsas", "createdAt": "2020-05-19T18:23:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDI4NDA2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2MTEwOA==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r427161108", "bodyText": "This should lso be done in fxm", "author": "1-alex98", "createdAt": "2020-05-19T09:28:20Z", "path": "src/main/java/com/faforever/client/fx/DualStringListCell.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package com.faforever.client.fx;\n+\n+import java.util.function.Function;\n+\n+import javafx.application.Platform;\n+import javafx.scene.control.Label;\n+import javafx.scene.control.ListCell;\n+import javafx.scene.layout.HBox;\n+import javafx.scene.layout.Priority;\n+import javafx.scene.layout.Region;\n+\n+/**\n+ * Alternative to {@link StringListCell} that allows to display to differently styled strings in each cell.\n+ */\n+public class DualStringListCell<T> extends ListCell<T> {\n+  protected Label left = new Label();\n+  protected Label right = new Label();\n+  protected Region spacer = new Region();\n+  \n+  private HBox container = new HBox(left, spacer, right);", "originalCommit": "2868950143184e588faf2a72532cf0c7a81376ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1ef426e703f5f2db2988af9b866ff108dc7827d9", "url": "https://github.com/FAForever/downlords-faf-client/commit/1ef426e703f5f2db2988af9b866ff108dc7827d9", "message": "Neatly done in fxml and css", "committedDate": "2020-05-19T10:08:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUxMjAyMw==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r427512023", "bodyText": "This is not very performance friendly.\nThe JavaFX documentation (in some parent class) explicitely states that updateItem should ONLY reuse ui elements not create or recreate them.\nEdit: Ok maybe i got this wrong, this usually only happens once per object right?", "author": "Katharsas", "createdAt": "2020-05-19T18:27:32Z", "path": "src/main/java/com/faforever/client/fx/DualStringListCell.java", "diffHunk": "@@ -48,12 +26,15 @@ protected void updateItem(T item, boolean empty) {\n         setText(null);\n         setGraphic(null);\n       } else {\n-        left.setText(functionLeft.apply(item));\n-        right.setText(functionRight.apply(item));\n+        if (dualStringListCellController == null) {\n+          dualStringListCellController = uiService.loadFxml(\"theme/dual_string_list_cell.fxml\");", "originalCommit": "1ef426e703f5f2db2988af9b866ff108dc7827d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg2NzU4Mg==", "url": "https://github.com/FAForever/downlords-faf-client/pull/1693#discussion_r427867582", "bodyText": "yes, this is essentially the same as u did...", "author": "1-alex98", "createdAt": "2020-05-20T09:24:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUxMjAyMw=="}], "type": "inlineReview"}]}