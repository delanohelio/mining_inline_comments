{"pr_number": 836, "pr_title": "feat(samples): Add pnp Thermostat(no component) samples", "pr_createdAt": "2020-07-02T22:13:11Z", "pr_url": "https://github.com/Azure/azure-iot-sdk-java/pull/836", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzQ0OA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449297448", "bodyText": "Is this the name we want to use?", "author": "prmathur-microsoft", "createdAt": "2020-07-02T22:44:21Z", "path": "service/iot-service-samples/pnp-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/PnPNoComponentSample.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.io.IOException;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.TimeUnit;\n+\n+public class PnPNoComponentSample {", "originalCommit": "651aa0bb352de60f89668288aee724c3ff330ba1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzY3MA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449297670", "bodyText": "If it is targeting thermostat, wouldn't it be better to call it thermostat (Or the name that we used on Device)?", "author": "prmathur-microsoft", "createdAt": "2020-07-02T22:45:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzQ0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5OTY1NQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449299655", "bodyText": "Open to suggestions here. We were planning to add NoComponent and Component samples based on sync with Eric. This name seemed to point that out so I kept it this way.", "author": "vinagesh", "createdAt": "2020-07-02T22:53:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzQ0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwMDY5MA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449300690", "bodyText": "How do you differentiate Component and NoComponent? I do agree it might be nice to have the name Thermostat somewhere.", "author": "vinagesh", "createdAt": "2020-07-02T22:56:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzQ0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwMDc5Mw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449300793", "bodyText": "Or maybe we can just have one sample and call it thermostat and a switch for Component/Nocomponent?", "author": "vinagesh", "createdAt": "2020-07-02T22:57:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzQ0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwNDczNg==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449304736", "bodyText": "Updated based on discussion to Thermostat", "author": "vinagesh", "createdAt": "2020-07-02T23:13:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5NzQ0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5ODI3NA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449298274", "bodyText": "Can we add a readme explaining the usage of both Device and Service samples togther? And a brief explanation of both the samples?", "author": "prmathur-microsoft", "createdAt": "2020-07-02T22:47:28Z", "path": "service/iot-service-samples/pnp-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/PnPNoComponentSample.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+", "originalCommit": "651aa0bb352de60f89668288aee724c3ff330ba1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5OTUxMw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449299513", "bodyText": "That is a TODO for sure. We have not discussed where to add all that info but it is something we need to do. It would be another PR though.", "author": "vinagesh", "createdAt": "2020-07-02T22:52:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5ODI3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5ODQxMg==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449298412", "bodyText": "Is this suppose to be DeviceConString or IotHub connection string?", "author": "prmathur-microsoft", "createdAt": "2020-07-02T22:48:03Z", "path": "service/iot-service-samples/pnp-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/PnPNoComponentSample.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.io.IOException;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.TimeUnit;\n+\n+public class PnPNoComponentSample {\n+    private static final String propertyName = \"targetTemperature\";\n+    private static final double propertyValue = 75.5;\n+    private static final String methodName = \"reboot\";\n+    private static final Long responseTimeout = TimeUnit.SECONDS.toSeconds(200);\n+    private static final Long connectTimeout = TimeUnit.SECONDS.toSeconds(5);\n+\n+    public static void main(String[] args) throws Exception {\n+        System.out.println(\"Starting sample...\");\n+        // get user inputs from environment variables\n+        String iotHubConnectionString = System.getenv(\"IOTHUB_DEVICE_CONNECTION_STRING\");", "originalCommit": "651aa0bb352de60f89668288aee724c3ff330ba1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5OTE4NQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449299185", "bodyText": "This is hub connection string. I will update the env variable name to be appropriate.", "author": "vinagesh", "createdAt": "2020-07-02T22:51:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5ODQxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMwOTAxNw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449309017", "bodyText": "env var alignment with other SDKs:\n\n\n\nDevice\nIOTHUB_DEVICE_CONNECTION_STRING\n\n\n\n\nService\nIOTHUB_CONNECTION_STRING\n\n\n\n@bikamani FYI, as well", "author": "abhipsaMisra", "createdAt": "2020-07-02T23:31:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5ODQxMg=="}], "type": "inlineReview"}, {"oid": "c6e0ec3b08da4f4c5e3567a832f56d83a8927ec4", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/c6e0ec3b08da4f4c5e3567a832f56d83a8927ec4", "message": "feat(samples): Add pnp no component samples", "committedDate": "2020-07-02T22:54:08Z", "type": "forcePushed"}, {"oid": "7e7a6a96c951db1e109889227d9d3f79484069b8", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/7e7a6a96c951db1e109889227d9d3f79484069b8", "message": "feat(samples): Add pnp no component samples", "committedDate": "2020-07-02T23:07:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMxMDk4OA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449310988", "bodyText": "It would be good to add way to create payload based on user input as you have for methodname", "author": "bikamani", "createdAt": "2020-07-02T23:40:28Z", "path": "service/iot-service-samples/pnp-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/Thermostat.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package samples.com.microsoft.azure.sdk.iot;\n+\n+import com.microsoft.azure.sdk.iot.service.devicetwin.*;\n+\n+import java.io.IOException;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.TimeUnit;\n+\n+public class Thermostat {\n+    private static final String propertyName = \"targetTemperature\";\n+    private static final double propertyValue = 75.5;\n+    private static final String methodName = \"reboot\";\n+    private static final Long responseTimeout = TimeUnit.SECONDS.toSeconds(200);\n+    private static final Long connectTimeout = TimeUnit.SECONDS.toSeconds(5);\n+\n+    public static void main(String[] args) throws Exception {\n+        System.out.println(\"Starting sample...\");\n+\n+        // get user inputs from environment variables\n+        String iotHubConnectionString = System.getenv(\"IOTHUB_CONNECTION_STRING\");\n+        String deviceId = System.getenv(\"DEVICE_ID\");\n+\n+        // connect to the IotHub\n+        DeviceTwin twinClient = DeviceTwin.createFromConnectionString(iotHubConnectionString);\n+        DeviceTwinDevice device = new DeviceTwinDevice(deviceId);\n+\n+        // get the device twin\n+        System.out.println(\"Getting the Device twin\");\n+        twinClient.getTwin(device);\n+        // display the pnp model id property of the device\n+        System.out.println(\"The pnp model id is: \" + device.getModelId());\n+\n+        // update the device twin properties\n+        Set<Pair> desiredProperties = new HashSet<Pair>();\n+        desiredProperties.add(new Pair(propertyName, propertyValue));\n+        device.setDesiredProperties(desiredProperties);\n+        System.out.println(\"Updating Device twin (targetTemperature, 75)\");\n+        twinClient.updateTwin(device);\n+        System.out.println(\"The targetTemperature is set to: \" + device.getDesiredProperties().iterator().next().getValue());\n+\n+        // invoke command on the device\n+        System.out.println(\"Invoking Reboot command\");\n+        DeviceMethod methodClient = DeviceMethod.createFromConnectionString(iotHubConnectionString);\n+        Map<String, Object> payload = new HashMap<String, Object>()\n+        {\n+            {\n+                put(\"delay\", 1);", "originalCommit": "7e7a6a96c951db1e109889227d9d3f79484069b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMxNDgyOQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/836#discussion_r449314829", "bodyText": "I will do this in next PR when we change the payload to match the new one.", "author": "vinagesh", "createdAt": "2020-07-02T23:57:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMxMDk4OA=="}], "type": "inlineReview"}, {"oid": "dcc32548247c0cdc22b7267556f182285330e995", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/dcc32548247c0cdc22b7267556f182285330e995", "message": "feat(samples): Add pnp no component samples", "committedDate": "2020-07-02T23:55:38Z", "type": "forcePushed"}, {"oid": "2c46afaf3e9c1834d8537c3e8ad3f23d2f569257", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/2c46afaf3e9c1834d8537c3e8ad3f23d2f569257", "message": "feat(samples): Add pnp no component samples", "committedDate": "2020-07-03T00:21:29Z", "type": "commit"}, {"oid": "2c46afaf3e9c1834d8537c3e8ad3f23d2f569257", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/2c46afaf3e9c1834d8537c3e8ad3f23d2f569257", "message": "feat(samples): Add pnp no component samples", "committedDate": "2020-07-03T00:21:29Z", "type": "forcePushed"}]}