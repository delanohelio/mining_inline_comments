{"pr_number": 823, "pr_title": "feat(iot-dev): Adding client options for modules (edge)", "pr_createdAt": "2020-06-25T21:07:12Z", "pr_url": "https://github.com/Azure/azure-iot-sdk-java/pull/823", "timeline": [{"oid": "d836f60cfd2270091ac6e459a5fd0eb5f1894cf0", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/d836f60cfd2270091ac6e459a5fd0eb5f1894cf0", "message": "adding clientoptions for moduleclient", "committedDate": "2020-06-25T21:03:33Z", "type": "commit"}, {"oid": "adca73d57b39aaac49ccc790fe00df97d070dd4d", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/adca73d57b39aaac49ccc790fe00df97d070dd4d", "message": "remove imports", "committedDate": "2020-06-25T21:06:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1ODQ5OQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r445858499", "bodyText": "This is a tricky constructor in practice. Right now, AMQP is the default protocol, and the modelId changes are only applicable for MQTT. ClientOptions does encapsulate the SSLContext though, which may make this constructor worthwile. Can you double check that the SSLContext is used correctly from this constructor?", "author": "timtay-microsoft", "createdAt": "2020-06-25T21:50:12Z", "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/ModuleClient.java", "diffHunk": "@@ -185,13 +185,36 @@ public static ModuleClient createFromEnvironment() throws ModuleClientException\n         return createFromEnvironment(IotHubClientProtocol.AMQPS);\n     }\n \n+    /**\n+     * Create a module client instance from your environment variables\n+     * @param clientOptions The options that allow configuration of the module client instance during initialization\n+     * @return the created module client instance\n+     * @throws ModuleClientException if the module client cannot be created\n+     */\n+    public static ModuleClient createFromEnvironment(ClientOptions clientOptions) throws ModuleClientException", "originalCommit": "adca73d57b39aaac49ccc790fe00df97d070dd4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1OTkxNw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r445859917", "bodyText": "Especially check the case when the user provides certs in the environment variables", "author": "timtay-microsoft", "createdAt": "2020-06-25T21:53:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1ODQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg4MzAwMg==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r445883002", "bodyText": "yes right, checked, ssl context will be set correctly with this constructor by DeviceClientConfig", "author": "bikamani", "createdAt": "2020-06-25T22:58:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1ODQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg4NjA0NQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r445886045", "bodyText": "What happens if I pass in an SSLContext in the clientOptions and have extra trusted certs in my environment variables? Does the SSLContext take precedence? If so, you'll need to add a note in the javadoc about that", "author": "timtay-microsoft", "createdAt": "2020-06-25T23:08:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1ODQ5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1OTc4OA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r445859788", "bodyText": "use mqtt here instead", "author": "abhipsaMisra", "createdAt": "2020-06-25T21:53:15Z", "path": "device/iot-device-client/src/test/java/tests/unit/com/microsoft/azure/sdk/iot/device/ModuleClientTest.java", "diffHunk": "@@ -135,6 +138,38 @@ public void constructorThrowsForHTTP() throws URISyntaxException, ModuleClientEx\n         new ModuleClient(connectionString, IotHubClientProtocol.HTTPS);\n     }\n \n+    @Test\n+    public void constructorWithModelIdSuccess(final @Mocked System mockedSystem) throws URISyntaxException, IOException, ModuleClientException {\n+        //arrange\n+        final IotHubClientProtocol protocol = IotHubClientProtocol.AMQPS;", "originalCommit": "adca73d57b39aaac49ccc790fe00df97d070dd4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg4MzA0Mg==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r445883042", "bodyText": "will do", "author": "bikamani", "createdAt": "2020-06-25T22:58:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1OTc4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjMyMTUyNw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/823#discussion_r446321527", "bodyText": "Rethinking about this, it is actually fine to leave it as it is. Here we just want to make sure model id is set correctly with this constructor no matter which protocol", "author": "bikamani", "createdAt": "2020-06-26T17:39:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1OTc4OA=="}], "type": "inlineReview"}, {"oid": "03d9f240e1c3735b2077f9abeae1eb3bdfae213c", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/03d9f240e1c3735b2077f9abeae1eb3bdfae213c", "message": "remove constructor", "committedDate": "2020-06-26T17:52:43Z", "type": "commit"}, {"oid": "266d03f58c145424e78b12cb68853d3cda86c888", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/266d03f58c145424e78b12cb68853d3cda86c888", "message": "Merge branch 'master' into bikamani/edgeModules", "committedDate": "2020-06-26T18:48:18Z", "type": "commit"}, {"oid": "8597b18a66605a414af8f0be762f8d20000307f4", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/8597b18a66605a414af8f0be762f8d20000307f4", "message": "Merge branch 'master' into bikamani/edgeModules", "committedDate": "2020-06-29T17:56:49Z", "type": "commit"}]}