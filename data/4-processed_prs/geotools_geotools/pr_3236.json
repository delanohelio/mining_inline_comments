{"pr_number": 3236, "pr_title": "migrate OpenJDK 1.8 and 11 from travis to github actions", "pr_createdAt": "2020-11-25T01:51:42Z", "pr_url": "https://github.com/geotools/geotools/pull/3236", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIwMTkwOA==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r530201908", "bodyText": "Hey @bradh thanks a ton for doing this!\nJust a note, I believe we need sphinx here too, the maven build in GeoTools builds also the docs (it's not a separate build like in GeoServer).", "author": "aaime", "createdAt": "2020-11-25T08:53:59Z", "path": ".github/workflows/linux.yml", "diffHunk": "@@ -0,0 +1,73 @@\n+name: Linux with OpenJDK 1.8 and OpenJDK 11 GitHub CI\n+\n+on: [pull_request]\n+\n+env:\n+  MAVEN_OPTS: -Dmaven.wagon.httpconnectionManager.ttlSeconds=25 -Dmaven.wagon.http.retryHandler.count=3\n+\n+jobs:\n+  openjdk8:\n+    runs-on: [ubuntu-18.04]\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK 1.8\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 8\n+    - name: Maven repository caching\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2/repository\n+        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: |\n+          ${{ runner.os }}-maven-\n+    - name: Build with Maven\n+      run: |\n+        mvn -B clean install -Dfmt.skip=true -Dall -T2 --file pom.xml", "originalCommit": "0c05b2798e81eb0343997931c0c4a8c785431e52", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIwNTI4OQ==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r530205289", "bodyText": "Will fix. Just doing the geoserver part at the moment.  Looks like I have the pip part working on the docs for that, will copy it across.", "author": "bradh", "createdAt": "2020-11-25T08:59:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIwMTkwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIwNTcxMA==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r530205710", "bodyText": "Also, This should probably be considered draft for a while - would like to clean it up a bit more.", "author": "bradh", "createdAt": "2020-11-25T08:59:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIwMTkwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE2MDI4Mw==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r531160283", "bodyText": "What happened here, Java 8 is showing the same behavior?", "author": "aaime", "createdAt": "2020-11-26T17:24:23Z", "path": "modules/library/render/src/test/java/org/geotools/renderer/lite/LabelDisplacementModeTest.java", "diffHunk": "@@ -462,12 +460,7 @@ public void testMultiLineLabelDisplacementY() throws Exception {\n         String refPath =\n                 \"./src/test/resources/org/geotools/renderer/lite/test-data/displacementMode/testMultiLineLabelDisplacementY.png\";\n         // java 11 makes chars quite a bit bolder\n-        int tolerance = 1300;\n-        if (SystemUtils.isJavaVersionAtLeast(JavaVersion.JAVA_11)\n-                || SystemUtils.IS_OS_MAC_OSX\n-                || SystemUtils.IS_OS_WINDOWS) {\n-            tolerance = 2000;\n-        }\n+        int tolerance = 2000;", "originalCommit": "11bcc2f7c999e34770ba6e88293b0da387ba8aca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTIzMjY3Ng==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r531232676", "bodyText": "Yes. I saw ~1950 as the error.\nMy guess is that it isn't really a Java 11 rendering algorithm difference, but perhaps a font selection difference. So what you see depends on what font it gets (which in turn is a function of the font fallback options, and what fonts are installed). I'm optimistic that a follow-up activity can make this test more robust.", "author": "bradh", "createdAt": "2020-11-26T21:44:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE2MDI4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ2MzM5Nw==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r531463397", "bodyText": "The tests are loading up Vera fonts at the beginning, and using them in the SLDs, so it should be using those exact fonts. But I agree it should be looked at in follow up.", "author": "aaime", "createdAt": "2020-11-27T08:58:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE2MDI4Mw=="}], "type": "inlineReview"}, {"oid": "6209097400fe516ce187a17b90c6b1e2a50f1e8f", "url": "https://github.com/geotools/geotools/commit/6209097400fe516ce187a17b90c6b1e2a50f1e8f", "message": "ci: migrate from travis to github actions", "committedDate": "2020-11-26T22:21:24Z", "type": "commit"}, {"oid": "6209097400fe516ce187a17b90c6b1e2a50f1e8f", "url": "https://github.com/geotools/geotools/commit/6209097400fe516ce187a17b90c6b1e2a50f1e8f", "message": "ci: migrate from travis to github actions", "committedDate": "2020-11-26T22:21:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ2NjE0OQ==", "url": "https://github.com/geotools/geotools/pull/3236#discussion_r531466149", "bodyText": "Everything looks good, just have a hesitation about this title... it's long and makes it harder to find at a glance a particular build in the GitHub PR checks:\n\nJust calling it \"Linux\" or \"Linux GitHub CI\" would probably be enough, the name of the job is added at the end and clarifies which bit of the build is executed. E.g. may look like:\n``Linux GitHub CI / openjdk11 (pull request)\"", "author": "aaime", "createdAt": "2020-11-27T09:03:31Z", "path": ".github/workflows/linux.yml", "diffHunk": "@@ -0,0 +1,85 @@\n+name: Linux with OpenJDK 1.8 and OpenJDK 11 GitHub CI", "originalCommit": "6209097400fe516ce187a17b90c6b1e2a50f1e8f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "88f9b40378764a5d1a58e625278b2291bec14c55", "url": "https://github.com/geotools/geotools/commit/88f9b40378764a5d1a58e625278b2291bec14c55", "message": "ci: shorten Linux workflow display name", "committedDate": "2020-11-27T22:15:00Z", "type": "commit"}, {"oid": "9efaf17c06d51c2a263fcb3fa3503f30b610e158", "url": "https://github.com/geotools/geotools/commit/9efaf17c06d51c2a263fcb3fa3503f30b610e158", "message": "ci: Add -Dall to QA check", "committedDate": "2020-11-27T22:57:20Z", "type": "commit"}, {"oid": "317496e0809da7b4f77f5da490f988ee4e4c33d2", "url": "https://github.com/geotools/geotools/commit/317496e0809da7b4f77f5da490f988ee4e4c33d2", "message": "ci: add fail at end flag to QA build", "committedDate": "2020-11-27T23:00:34Z", "type": "commit"}]}