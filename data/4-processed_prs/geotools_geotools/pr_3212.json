{"pr_number": 3212, "pr_title": "[GEOT-6738] Mongo ComplexFeatures are not reprojected", "pr_createdAt": "2020-11-16T08:14:29Z", "pr_url": "https://github.com/geotools/geotools/pull/3212", "timeline": [{"oid": "3f7f4d29a23bf34c481d2d96dad9df225fe36e41", "url": "https://github.com/geotools/geotools/commit/3f7f4d29a23bf34c481d2d96dad9df225fe36e41", "message": "[GEOT-6738] Mongo ComplexFeatures are not reprojected", "committedDate": "2020-11-16T08:22:27Z", "type": "commit"}, {"oid": "3f7f4d29a23bf34c481d2d96dad9df225fe36e41", "url": "https://github.com/geotools/geotools/commit/3f7f4d29a23bf34c481d2d96dad9df225fe36e41", "message": "[GEOT-6738] Mongo ComplexFeatures are not reprojected", "committedDate": "2020-11-16T08:22:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDAzMTQzMw==", "url": "https://github.com/geotools/geotools/pull/3212#discussion_r524031433", "bodyText": "Thread locals can turn into memory leaks, and web containers do complain about TL that are not freed on web application un-deploy. That said, we already use something similar in JDBC stores, so it would not be a first. If there is no way to keep these as collection fields (creating the transformations once per collection instead of once per feature) it's not going to be the end of the world if it stays as is.", "author": "aaime", "createdAt": "2020-11-16T09:37:31Z", "path": "modules/plugin/mongodb/src/main/java/org/geotools/data/mongodb/complex/MongoComplexUtilities.java", "diffHunk": "@@ -41,6 +52,10 @@\n     // key used to store the parent JSON path in a feature user data map\n     public static final String MONGO_PARENT_PATH = \"MONGO_PARENT_PATH\";\n \n+    private static ThreadLocal<", "originalCommit": "3f7f4d29a23bf34c481d2d96dad9df225fe36e41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA3MDkwNQ==", "url": "https://github.com/geotools/geotools/pull/3212#discussion_r524070905", "bodyText": "Thanks for your point @aaime . I strove to found another way but looked to me a forced choice: it was possible to not keep it at a feature level when the static methods in the MongoConplexUtilities class are called from the MongoNestedMapping class but I did not find way to handle the case when the static method is called from the JsonSelectFunction", "author": "taba90", "createdAt": "2020-11-16T10:12:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDAzMTQzMw=="}], "type": "inlineReview"}]}