{"pr_number": 5685, "pr_title": "Apply tags from Correlation Context key/values to Spans", "pr_createdAt": "2020-10-18T14:44:12Z", "pr_url": "https://github.com/apache/skywalking/pull/5685", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzE3Mjg3Mg==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507172872", "bodyText": "Why do you still try to change this? You have the tracing context, and #extract is in your control already.", "author": "wu-sheng", "createdAt": "2020-10-18T14:54:28Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/ContextManager.java", "diffHunk": "@@ -83,23 +84,23 @@ public static AbstractSpan createEntrySpan(String operationName, ContextCarrier\n         AbstractSpan span;\n         AbstractTracerContext context;\n         operationName = StringUtil.cut(operationName, OPERATION_NAME_THRESHOLD);\n-        if (carrier != null && carrier.isValid()) {\n+        if (Objects.nonNull(carrier) && carrier.isValid()) {\n             SamplingService samplingService = ServiceManager.INSTANCE.findService(SamplingService.class);\n             samplingService.forceSampled();\n             context = getOrCreate(operationName, true);\n-            span = context.createEntrySpan(operationName);\n-            context.extract(carrier);\n         } else {\n             context = getOrCreate(operationName, false);\n-            span = context.createEntrySpan(operationName);\n         }\n-        return span;\n+        span = context.createEntrySpan(operationName);\n+        context.extract(carrier);\n+        return callback(span);", "originalCommit": "a41b714d2b17154ef5a49bdc22921d6d76e05843", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzE3NzY2NQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507177665", "bodyText": "NULL_DEREFERENCE:  object returned by context.getTraceSegment() could be null and is dereferenced at line 91.", "author": "sonatype-lift", "createdAt": "2020-10-18T15:37:06Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/ContextManagerExtendService.java", "diffHunk": "@@ -79,4 +84,23 @@ public AbstractTracerContext createTraceContext(String operationName, boolean fo\n     public void statusChanged(final GRPCChannelStatus status) {\n         this.status = status;\n     }\n+\n+    public void extract(ContextCarrier carrier, AbstractTracerContext context) {\n+        if (Objects.nonNull(carrier) && carrier.isValid()) {\n+            TraceSegmentRef ref = new TraceSegmentRef(carrier);\n+            context.getTraceSegment().ref(ref);", "originalCommit": "a41b714d2b17154ef5a49bdc22921d6d76e05843", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c8b5fcff217a9b6ac43296d79b76c2f1352d3928", "url": "https://github.com/apache/skywalking/commit/c8b5fcff217a9b6ac43296d79b76c2f1352d3928", "message": "remove injection code", "committedDate": "2020-10-18T16:28:41Z", "type": "commit"}, {"oid": "c8b5fcff217a9b6ac43296d79b76c2f1352d3928", "url": "https://github.com/apache/skywalking/commit/c8b5fcff217a9b6ac43296d79b76c2f1352d3928", "message": "remove injection code", "committedDate": "2020-10-18T16:28:41Z", "type": "forcePushed"}, {"oid": "f580e5b134428c8533b4e6f759e62e8ef0cd99d0", "url": "https://github.com/apache/skywalking/commit/f580e5b134428c8533b4e6f759e62e8ef0cd99d0", "message": "add unit test", "committedDate": "2020-10-18T17:03:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzMwNzM3MQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507307371", "bodyText": "I think these are out of update?", "author": "wu-sheng", "createdAt": "2020-10-19T01:06:50Z", "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -115,6 +118,10 @@ property key | Description | Default |\n `meter.max_meter_size`| Max size of the meter pool |`500`|\n `plugin.mount` | Mount the specific folders of the plugins. Plugins in mounted folders would work. | `plugins,activations` |\n `plugin.peer_max_length `|Peer maximum description limit.|`200`|\n+`plugin.extendcontextmanager.injection_tags `|These tags of the span are derived from correlations with the same name.|`\"\"`|\n+`plugin.extendcontextmanager.external_injection_switch `|The external injection switch.(Please notice the injection security)|`false`|\n+`plugin.extendcontextmanager.external_injection_key`|The correlation data which made up of external_injection_key and external_injection_token allows the other correlation data injected by external passing.|`\"sw-injection-key\"`|\n+`plugin.extendcontextmanager.external_injection_token `|The correlation data which made up of external_injection_key and external_injection_token allows the other correlation data injected by external passing.|`\"sw-injection-token\"`|", "originalCommit": "f580e5b134428c8533b4e6f759e62e8ef0cd99d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "url": "https://github.com/apache/skywalking/commit/6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "message": "remove unnecessary doc", "committedDate": "2020-10-19T02:03:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM0NjEyNQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507346125", "bodyText": "Should be a part of BeforeTest", "author": "wu-sheng", "createdAt": "2020-10-19T01:59:33Z", "path": "apm-sniffer/apm-agent-core/src/test/java/org/apache/skywalking/apm/agent/core/context/CorrelationContextTest.java", "diffHunk": "@@ -121,4 +126,21 @@ public void testDeserialize() {\n         Assert.assertNull(context.get(\"test1\").orElse(null));\n     }\n \n+    @Test\n+    public void testHandle() {\n+        Config.Correlation.INJECTION_TAGS = \"\";", "originalCommit": "f580e5b134428c8533b4e6f759e62e8ef0cd99d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM0NjQwOA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507346408", "bodyText": "Also, should be clear after test.", "author": "wu-sheng", "createdAt": "2020-10-19T01:59:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM0NjEyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM1NzY5MQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507357691", "bodyText": "Duplicated.\n\nIf you want to move those two at here, please remove the previous two.", "author": "wu-sheng", "createdAt": "2020-10-19T02:12:56Z", "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -102,6 +102,9 @@ property key | Description | Default |\n `logging.max_history_files`|The max history log files. When rollover happened, if log files exceed this number,then the oldest file will be delete. Negative or zero means off, by default.|`-1`|\n `statuscheck.ignored_exceptions`|Listed exceptions would not be treated as an error. Because in some codes, the exception is being used as a way of controlling business flow.|`\"\"`|\n `statuscheck.max_recursive_depth`|The max recursive depth when checking the exception traced by the agent. Typically, we don't recommend setting this more than 10, which could cause a performance issue. Negative value and 0 would be ignored, which means all exceptions would make the span tagged in error status.|`1`|\n+`correlation.element_max_number`|Max element count in the correlation context.|3|\n+`correlation.value_max_length`|Max value length of each element.|`128`|", "originalCommit": "6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM1ODEzMg==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507358132", "bodyText": "These are not widely used configurations, please don't add them in the agent.config.", "author": "wu-sheng", "createdAt": "2020-10-19T02:13:24Z", "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -92,6 +92,13 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n # The max recursive depth when checking the exception traced by the agent. Typically, we don't recommend setting this more than 10, which could cause a performance issue. Negative value and 0 would be ignored, which means all exceptions would make the span tagged in error status.\n # statuscheck.max_recursive_depth=${SW_STATUSCHECK_MAX_RECURSIVE_DEPTH:1}\n \n+# Max element count in the correlation context.\n+# correlation.element_max_number=${SW_CORRELATION_ELEMENT_MAX_NUMBER:3}\n+# Max value length of each element.\n+# correlation.value_max_length=${SW_CORRELATION_VALUE_MAX_LENGTH:128}\n+# These tags of the span are derived from correlations with the same name.\n+# correlation.injection_tags=${SW_CORRELATION_INJECTION_TAGS:}\n+", "originalCommit": "6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM1OTE2MA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507359160", "bodyText": "What are these for?", "author": "wu-sheng", "createdAt": "2020-10-19T02:14:36Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/tag/AbstractTag.java", "diffHunk": "@@ -60,4 +61,21 @@ public int getId() {\n     public boolean isCanOverwrite() {\n         return canOverwrite;\n     }\n+\n+    @Override\n+    public boolean equals(final Object o) {\n+        if (this == o)\n+            return true;\n+        if (!(o instanceof AbstractTag))\n+            return false;\n+        final AbstractTag<?> that = (AbstractTag<?>) o;\n+        return getId() == that.getId() &&\n+            isCanOverwrite() == that.isCanOverwrite() &&\n+            key.equals(that.key);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return Objects.hash(getId(), isCanOverwrite(), key);\n+    }", "originalCommit": "6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUxNDQ0NA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507514444", "bodyText": "For stringTag equals:", "author": "EvanLjp", "createdAt": "2020-10-19T06:59:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM1OTE2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM2MzE3NA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507363174", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    /**\n          \n          \n            \n                     * Extract tags from the correlation.\n          \n          \n            \n                     */\n          \n          \n            \n                    public static String INJECTION_TAGS = \"\";\n          \n          \n            \n                    /**\n          \n          \n            \n                     * Tag the span by the key/value in the correlation context, when the keys listed here exist.\n          \n          \n            \n                     */\n          \n          \n            \n                    public static String AUTO_TAG_KEYS = \"\";", "author": "wu-sheng", "createdAt": "2020-10-19T02:19:09Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -310,5 +310,10 @@\n          * Max value length of each element.\n          */\n         public static int VALUE_MAX_LENGTH = 128;\n+\n+        /**\n+         * Extract tags from the correlation.\n+         */\n+        public static String INJECTION_TAGS = \"\";", "originalCommit": "6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM2MzY4Mg==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r507363682", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            `correlation.injection_tags`|These tags of the span are derived from correlations with the same name.|`\"\"`|\n          \n          \n            \n            `correlation.injection_tags`|Tag the span by the key/value in the correlation context, when the keys listed here exist.|`\"\"`|", "author": "wu-sheng", "createdAt": "2020-10-19T02:19:48Z", "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -102,6 +102,9 @@ property key | Description | Default |\n `logging.max_history_files`|The max history log files. When rollover happened, if log files exceed this number,then the oldest file will be delete. Negative or zero means off, by default.|`-1`|\n `statuscheck.ignored_exceptions`|Listed exceptions would not be treated as an error. Because in some codes, the exception is being used as a way of controlling business flow.|`\"\"`|\n `statuscheck.max_recursive_depth`|The max recursive depth when checking the exception traced by the agent. Typically, we don't recommend setting this more than 10, which could cause a performance issue. Negative value and 0 would be ignored, which means all exceptions would make the span tagged in error status.|`1`|\n+`correlation.element_max_number`|Max element count in the correlation context.|3|\n+`correlation.value_max_length`|Max value length of each element.|`128`|\n+`correlation.injection_tags`|These tags of the span are derived from correlations with the same name.|`\"\"`|", "originalCommit": "6f716458f7160f75bc35eccbb4ffa2523ec34a4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "73d698846b7f9fd02305ab10a329fa88d404f7f1", "url": "https://github.com/apache/skywalking/commit/73d698846b7f9fd02305ab10a329fa88d404f7f1", "message": "logic optimization", "committedDate": "2020-10-19T07:11:40Z", "type": "commit"}, {"oid": "9a2d3f6bc5421cec3ae74be9fbfdff6d51c41616", "url": "https://github.com/apache/skywalking/commit/9a2d3f6bc5421cec3ae74be9fbfdff6d51c41616", "message": "Merge branch 'master' into correlation-inject-spans", "committedDate": "2020-10-20T01:33:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODE1NjUxOQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r508156519", "bodyText": "From my understanding, this should be in the static{} block, as it doesn't need to execute every time.", "author": "wu-sheng", "createdAt": "2020-10-20T01:36:23Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/CorrelationContext.java", "diffHunk": "@@ -17,26 +17,38 @@\n \n package org.apache.skywalking.apm.agent.core.context;\n \n-import org.apache.skywalking.apm.agent.core.base64.Base64;\n-import org.apache.skywalking.apm.agent.core.conf.Config;\n-import org.apache.skywalking.apm.util.StringUtil;\n-\n+import java.util.ArrayList;\n+import java.util.Arrays;\n import java.util.HashMap;\n+import java.util.List;\n import java.util.Map;\n import java.util.Objects;\n import java.util.Optional;\n import java.util.stream.Collectors;\n+import org.apache.skywalking.apm.agent.core.base64.Base64;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.tag.StringTag;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.util.StringUtil;\n+\n+import static org.apache.skywalking.apm.agent.core.conf.Config.Correlation.AUTO_TAG_KEYS;\n \n /**\n- * Correlation context, use to propagation user custom data.\n- * Working on the protocol and delegate set/get method.\n+ * Correlation context, use to propagation user custom data. Working on the protocol and delegate set/get method.\n  */\n public class CorrelationContext {\n \n     private final Map<String, String> data;\n \n+    private final List<String> autoTagKeys;\n+\n     public CorrelationContext() {\n         this.data = new HashMap<>(Config.Correlation.ELEMENT_MAX_NUMBER);\n+        if (StringUtil.isNotEmpty(AUTO_TAG_KEYS)) {\n+            autoTagKeys = Arrays.asList(AUTO_TAG_KEYS.split(\",\"));\n+        } else {", "originalCommit": "9a2d3f6bc5421cec3ae74be9fbfdff6d51c41616", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9483a10114c9a4b660734825df3f865654797a89", "url": "https://github.com/apache/skywalking/commit/9483a10114c9a4b660734825df3f865654797a89", "message": "add correlation-autotag-scenario && refactor some codes", "committedDate": "2020-10-22T15:07:15Z", "type": "commit"}, {"oid": "afb6a56b76618480278e0c4e9ca1ab6d8bd56837", "url": "https://github.com/apache/skywalking/commit/afb6a56b76618480278e0c4e9ca1ab6d8bd56837", "message": "Merge branch 'correlation-inject-spans' of https://github.com/EvanLjp/skywalking into correlation-inject-spans", "committedDate": "2020-10-22T15:07:44Z", "type": "commit"}, {"oid": "63991431911f3456f0389531dda4e83ad54b5c88", "url": "https://github.com/apache/skywalking/commit/63991431911f3456f0389531dda4e83ad54b5c88", "message": "Merge remote-tracking branch 'upstream/master' into correlation-inject-spans", "committedDate": "2020-10-22T15:10:15Z", "type": "commit"}, {"oid": "85b6a1f434f1764ce88c4b87583ca6f153f6685b", "url": "https://github.com/apache/skywalking/commit/85b6a1f434f1764ce88c4b87583ca6f153f6685b", "message": "fix unit test", "committedDate": "2020-10-23T02:41:46Z", "type": "commit"}, {"oid": "cc6ba87acb7a55ab64aafffd44709155bdca5aeb", "url": "https://github.com/apache/skywalking/commit/cc6ba87acb7a55ab64aafffd44709155bdca5aeb", "message": "fix unit test", "committedDate": "2020-10-23T04:29:16Z", "type": "commit"}, {"oid": "9c47b80baa004a51f8ecfbcbfbec8258bbddf7ad", "url": "https://github.com/apache/skywalking/commit/9c47b80baa004a51f8ecfbcbfbec8258bbddf7ad", "message": "unit test", "committedDate": "2020-10-23T05:44:32Z", "type": "commit"}, {"oid": "bf9574b7002a0d652cce22b196dd80657ce2c26f", "url": "https://github.com/apache/skywalking/commit/bf9574b7002a0d652cce22b196dd80657ce2c26f", "message": "Merge branch 'master' into correlation-inject-spans", "committedDate": "2020-10-29T23:35:21Z", "type": "commit"}, {"oid": "46c3c3a1b4023f9306902306edb0515d5e4372f6", "url": "https://github.com/apache/skywalking/commit/46c3c3a1b4023f9306902306edb0515d5e4372f6", "message": "fix jar conflict", "committedDate": "2020-10-31T14:00:22Z", "type": "commit"}, {"oid": "d3f468539bf7d7578e2a73e413ede9746bbb3074", "url": "https://github.com/apache/skywalking/commit/d3f468539bf7d7578e2a73e413ede9746bbb3074", "message": "Merge remote-tracking branch 'upstream/master' into correlation-inject-spans", "committedDate": "2020-10-31T14:00:25Z", "type": "commit"}, {"oid": "413e6a1a7e93dd7933ae7d0b172532726e7683ef", "url": "https://github.com/apache/skywalking/commit/413e6a1a7e93dd7933ae7d0b172532726e7683ef", "message": "Merge branch 'correlation-inject-spans' of https://github.com/EvanLjp/skywalking into correlation-inject-spans", "committedDate": "2020-10-31T14:02:19Z", "type": "commit"}, {"oid": "f4f214488d9c04a0e3c18d18fcc7b7ee6eb6e126", "url": "https://github.com/apache/skywalking/commit/f4f214488d9c04a0e3c18d18fcc7b7ee6eb6e126", "message": "only scenario test to test correlation auto tag", "committedDate": "2020-10-31T16:21:34Z", "type": "commit"}, {"oid": "e068296a835b22382c72597c260e6bc4468153ff", "url": "https://github.com/apache/skywalking/commit/e068296a835b22382c72597c260e6bc4468153ff", "message": "Merge remote-tracking branch 'upstream/master' into correlation-inject-spans", "committedDate": "2020-10-31T16:22:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5OTU4MQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r510699581", "bodyText": "I think this file should not be checked into the codebase, please set a maven phase to generate it, refer to the existing settings in other modules, apm-network, thrift-plugin tests, etc.", "author": "kezhenxu94", "createdAt": "2020-10-23T07:50:57Z", "path": "test/plugin/scenarios/correlation-autotag-scenario/src/main/java/org/apache/skywalking/apm/testcase/baidu.brpc/interfaces/Echo.java", "diffHunk": "@@ -0,0 +1,1040 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+// Generated by the protocol buffer compiler.  DO NOT EDIT!\n+// source: echo.proto\n+\n+package org.apache.skywalking.apm.testcase.baidu.brpc.interfaces;", "originalCommit": "9c47b80baa004a51f8ecfbcbfbec8258bbddf7ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUxNDUwMg==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515514502", "bodyText": "Generated files are seldom checked into the codebase, unless we have to", "author": "kezhenxu94", "createdAt": "2020-10-31T16:38:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5OTU4MQ=="}], "type": "inlineReview"}, {"oid": "66a7f9f02f27b8d4598db3ce7b9a035b275cab87", "url": "https://github.com/apache/skywalking/commit/66a7f9f02f27b8d4598db3ce7b9a035b275cab87", "message": "change scenario test with grpc", "committedDate": "2020-11-01T06:00:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4MDMyNA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515580324", "bodyText": "I think you should consider including this in your DevCon topic with many other commits you made, why they are important, how to use them.", "author": "wu-sheng", "createdAt": "2020-11-01T06:06:07Z", "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -103,6 +103,9 @@ property key | Description | Default |\n `logging.max_history_files`|The max history log files. When rollover happened, if log files exceed this number,then the oldest file will be delete. Negative or zero means off, by default.|`-1`|\n `statuscheck.ignored_exceptions`|Listed exceptions would not be treated as an error. Because in some codes, the exception is being used as a way of controlling business flow.|`\"\"`|\n `statuscheck.max_recursive_depth`|The max recursive depth when checking the exception traced by the agent. Typically, we don't recommend setting this more than 10, which could cause a performance issue. Negative value and 0 would be ignored, which means all exceptions would make the span tagged in error status.|`1`|\n+`correlation.element_max_number`|Max element count in the correlation context.|3|\n+`correlation.value_max_length`|Max value length of each element.|`128`|\n+`correlation.auto_tag_keys`|Tag the span by the key/value in the correlation context, when the keys listed here exist.|`\"\"`|", "originalCommit": "66a7f9f02f27b8d4598db3ce7b9a035b275cab87", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4MDQwOQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515580409", "bodyText": "This is exactly what I want to share", "author": "EvanLjp", "createdAt": "2020-11-01T06:07:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4MDMyNA=="}], "type": "inlineReview"}, {"oid": "94ccfce533b19bdbfd4c15052b8622b15d16876f", "url": "https://github.com/apache/skywalking/commit/94ccfce533b19bdbfd4c15052b8622b15d16876f", "message": "Merge remote-tracking branch 'upstream/master' into correlation-inject-spans", "committedDate": "2020-11-01T06:20:24Z", "type": "commit"}, {"oid": "a98ec873ead9bef5cce1e90e80dd71821f3f1e6d", "url": "https://github.com/apache/skywalking/commit/a98ec873ead9bef5cce1e90e80dd71821f3f1e6d", "message": "resolve the conflict", "committedDate": "2020-11-01T06:27:48Z", "type": "commit"}, {"oid": "be31e3bc9ad7209696a90794e58430fd0afc2194", "url": "https://github.com/apache/skywalking/commit/be31e3bc9ad7209696a90794e58430fd0afc2194", "message": "add change log", "committedDate": "2020-11-01T06:49:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4NTI0Nw==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515585247", "bodyText": "Move the new feature at the top of the list.", "author": "wu-sheng", "createdAt": "2020-11-01T07:07:08Z", "path": "CHANGES.md", "diffHunk": "@@ -10,12 +10,15 @@ Release Notes.\n * Make HttpClient 3.x, 4.x, and HttpAsyncClient 3.x plugins to support collecting HTTP parameters.\n * Make the Feign plugin to support Java 14\n * Make the okhttp3 plugin to support Java 14\n+* Support propagate the sending timestamp in MQ plugins to calculate the transfer latency in the async MQ scenarios.\n+* Support auto-tag with the fixed values propagated in the correlation context.   ", "originalCommit": "be31e3bc9ad7209696a90794e58430fd0afc2194", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4NTI3MQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515585271", "bodyText": "Please move add to follow the previous add. New feature comes first in the change log.", "author": "wu-sheng", "createdAt": "2020-11-01T07:07:29Z", "path": "CHANGES.md", "diffHunk": "@@ -10,12 +10,15 @@ Release Notes.\n * Make HttpClient 3.x, 4.x, and HttpAsyncClient 3.x plugins to support collecting HTTP parameters.\n * Make the Feign plugin to support Java 14\n * Make the okhttp3 plugin to support Java 14\n+* Support propagate the sending timestamp in MQ plugins to calculate the transfer latency in the async MQ scenarios.\n+* Support auto-tag with the fixed values propagated in the correlation context.   \n \n #### OAP-Backend\n * Add the `@SuperDataset` annotation for BrowserErrorLog.\n * Support keeping collecting the slowly segments in the sampling mechanism.\n * Support choose files to active the meter analyzer.\n * Improve Kubernetes service registry for ALS analysis.\n+* Add `contain` and `not contain` OPS in OAL.", "originalCommit": "be31e3bc9ad7209696a90794e58430fd0afc2194", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cf4988093e1c14a325e768d3b2a533e7eb48228a", "url": "https://github.com/apache/skywalking/commit/cf4988093e1c14a325e768d3b2a533e7eb48228a", "message": "Merge branch 'master' into correlation-inject-spans", "committedDate": "2020-11-01T07:29:15Z", "type": "commit"}, {"oid": "9e35423156f5cea195c4be9371402023255d3f30", "url": "https://github.com/apache/skywalking/commit/9e35423156f5cea195c4be9371402023255d3f30", "message": "polish the change log", "committedDate": "2020-11-01T07:32:54Z", "type": "commit"}, {"oid": "65528028f569370fe07519384691bc09735c0f5b", "url": "https://github.com/apache/skywalking/commit/65528028f569370fe07519384691bc09735c0f5b", "message": "Merge branch 'correlation-inject-spans' of https://github.com/EvanLjp/skywalking into correlation-inject-spans", "committedDate": "2020-11-01T07:35:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODEyNA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515588124", "bodyText": "What are these for?", "author": "wu-sheng", "createdAt": "2020-11-01T07:41:01Z", "path": "apm-sniffer/apm-agent-core/pom.xml", "diffHunk": "@@ -87,6 +86,20 @@\n             <artifactId>wiremock</artifactId>\n             <version>${wiremock.version}</version>\n             <scope>test</scope>\n+            <exclusions>\n+                <exclusion>\n+                    <artifactId>jackson-annotations</artifactId>\n+                    <groupId>com.fasterxml.jackson.core</groupId>\n+                </exclusion>\n+                <exclusion>\n+                    <artifactId>jackson-core</artifactId>\n+                    <groupId>com.fasterxml.jackson.core</groupId>\n+                </exclusion>\n+                <exclusion>\n+                    <artifactId>jackson-databind</artifactId>\n+                    <groupId>com.fasterxml.jackson.core</groupId>\n+                </exclusion>\n+            </exclusions>", "originalCommit": "65528028f569370fe07519384691bc09735c0f5b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODYyMA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515588620", "bodyText": "find some conflict in agent-core.pom", "author": "EvanLjp", "createdAt": "2020-11-01T07:46:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODEyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4OTYxOQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515589619", "bodyText": "This is just a test scope, wouldn't be included in the distribution. What issue do you face?", "author": "wu-sheng", "createdAt": "2020-11-01T07:57:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODEyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515588232", "bodyText": "What are these for?", "author": "wu-sheng", "createdAt": "2020-11-01T07:42:13Z", "path": "apm-sniffer/apm-agent-core/pom.xml", "diffHunk": "@@ -129,6 +141,16 @@\n                 <artifactId>guava</artifactId>\n                 <version>${guava.version}</version>\n             </dependency>\n+            <dependency>\n+                <groupId>net.bytebuddy</groupId>\n+                <artifactId>byte-buddy</artifactId>\n+                <version>${bytebuddy.version}</version>\n+            </dependency>\n+            <dependency>\n+                <groupId>org.slf4j</groupId>\n+                <artifactId>slf4j-api</artifactId>\n+                <version>${slf4j.version}</version>\n+            </dependency>", "originalCommit": "65528028f569370fe07519384691bc09735c0f5b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODYxOQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515588619", "bodyText": "find some conflict in agent-core.pom", "author": "EvanLjp", "createdAt": "2020-11-01T07:46:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4OTE0OQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515589149", "bodyText": "Could you show me the conflict?", "author": "wu-sheng", "createdAt": "2020-11-01T07:52:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4OTU4Mg==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515589582", "bodyText": "For this, you are just missing the dependency to dependecyManagement, which part have another dependency?", "author": "wu-sheng", "createdAt": "2020-11-01T07:57:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5NTk4MQ==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515595981", "bodyText": "OK, byte-buddy is rarely to trigger bugs usually. If you want to resolve, it is fine.", "author": "wu-sheng", "createdAt": "2020-11-01T09:06:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5MzI2MA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515593260", "bodyText": "just conflict on test scope", "author": "EvanLjp", "createdAt": "2020-11-01T09:37:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5MzI3Mw==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515593273", "bodyText": "", "author": "EvanLjp", "createdAt": "2020-11-01T09:38:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU4ODIzMg=="}], "type": "inlineReview"}, {"oid": "13ec05b8b5cbc6d603ad09ae4e42348c7ea4fd71", "url": "https://github.com/apache/skywalking/commit/13ec05b8b5cbc6d603ad09ae4e42348c7ea4fd71", "message": "Update test/plugin/scenarios/correlation-autotag-scenario/pom.xml", "committedDate": "2020-11-01T08:46:41Z", "type": "commit"}, {"oid": "afa5d30b90376bc9d7d4a11d02699e195a2a451c", "url": "https://github.com/apache/skywalking/commit/afa5d30b90376bc9d7d4a11d02699e195a2a451c", "message": "change tookit version", "committedDate": "2020-11-01T09:09:11Z", "type": "commit"}, {"oid": "3b8a5f4f5e6a901ca28a5ff55f47c04d6e35598b", "url": "https://github.com/apache/skywalking/commit/3b8a5f4f5e6a901ca28a5ff55f47c04d6e35598b", "message": "Merge branch 'correlation-inject-spans' of https://github.com/EvanLjp/skywalking into correlation-inject-spans", "committedDate": "2020-11-01T09:09:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5NjMzNw==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515596337", "bodyText": "This should be changed to carrier.extractCorrelationTo(span); right? handle should be hidden.", "author": "wu-sheng", "createdAt": "2020-11-01T09:10:01Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java", "diffHunk": "@@ -189,6 +189,7 @@ public void extract(ContextCarrier carrier) {\n \n         carrier.extractExtensionTo(span);\n         this.correlationContext.extract(carrier);\n+        this.correlationContext.handle(span);", "originalCommit": "13ec05b8b5cbc6d603ad09ae4e42348c7ea4fd71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5NjcwOA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515596708", "bodyText": "ContextManager#activeSpan could be NPE inside, try #isActive.", "author": "wu-sheng", "createdAt": "2020-11-01T09:14:05Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/CorrelationContext.java", "diffHunk": "@@ -70,7 +85,9 @@ public CorrelationContext() {\n         if (data.size() >= Config.Correlation.ELEMENT_MAX_NUMBER) {\n             return Optional.empty();\n         }\n-\n+        if (AUTO_TAG_KEYS.contains(key) && Objects.nonNull(ContextManager.activeSpan())) {", "originalCommit": "13ec05b8b5cbc6d603ad09ae4e42348c7ea4fd71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "68bd85844edc9a5c2c8e34fe2a1216eca98cb0f2", "url": "https://github.com/apache/skywalking/commit/68bd85844edc9a5c2c8e34fe2a1216eca98cb0f2", "message": "polish some codes", "committedDate": "2020-11-01T09:17:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5NDAxNA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515594014", "bodyText": "If you need the toolkit, use the 8.2.0, no snapshot for 8.3.0. We used 8.2.0-SNAPSHOT, because one committer pushed this before it is released.", "author": "wu-sheng", "createdAt": "2020-11-01T09:45:27Z", "path": "test/plugin/scenarios/correlation-autotag-scenario/pom.xml", "diffHunk": "@@ -0,0 +1,165 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <groupId>org.apache.skywalking.apm.testcase</groupId>\n+    <artifactId>correlation-autotag-scenario</artifactId>\n+    <version>1.0.0</version>\n+    <packaging>jar</packaging>\n+\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <properties>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+        <compiler.version>1.8</compiler.version>\n+        <os-maven-plugin.version>1.6.2</os-maven-plugin.version>\n+\n+        <test.framework.version>1.6.0</test.framework.version>\n+\n+        <spring-boot-version>2.1.6.RELEASE</spring-boot-version>\n+    </properties>\n+\n+    <name>skywalking-correlation-autotag-scenario</name>\n+\n+    <dependencyManagement>\n+        <dependencies>\n+            <dependency>\n+                <groupId>org.springframework.boot</groupId>\n+                <artifactId>spring-boot-dependencies</artifactId>\n+                <version>${spring-boot-version}</version>\n+                <type>pom</type>\n+                <scope>import</scope>\n+            </dependency>\n+        </dependencies>\n+    </dependencyManagement>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-web</artifactId>\n+            <exclusions>\n+                <exclusion>\n+                    <groupId>org.springframework.boot</groupId>\n+                    <artifactId>spring-boot-starter-logging</artifactId>\n+                </exclusion>\n+            </exclusions>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-log4j2</artifactId>\n+        </dependency>\n+\n+        <!--    grpc    -->\n+        <dependency>\n+            <groupId>io.grpc</groupId>\n+            <artifactId>grpc-all</artifactId>\n+            <version>${test.framework.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-toolkit-trace</artifactId>\n+            <version>8.3.0-SNAPSHOT</version>\n+            <scope>compile</scope>\n+        </dependency>", "originalCommit": "65528028f569370fe07519384691bc09735c0f5b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU5NDEzMA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515594130", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <version>8.3.0-SNAPSHOT</version>\n          \n          \n            \n                        <version>8.2.0</version>", "author": "wu-sheng", "createdAt": "2020-11-01T09:46:37Z", "path": "test/plugin/scenarios/correlation-autotag-scenario/pom.xml", "diffHunk": "@@ -0,0 +1,165 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <groupId>org.apache.skywalking.apm.testcase</groupId>\n+    <artifactId>correlation-autotag-scenario</artifactId>\n+    <version>1.0.0</version>\n+    <packaging>jar</packaging>\n+\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <properties>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+        <compiler.version>1.8</compiler.version>\n+        <os-maven-plugin.version>1.6.2</os-maven-plugin.version>\n+\n+        <test.framework.version>1.6.0</test.framework.version>\n+\n+        <spring-boot-version>2.1.6.RELEASE</spring-boot-version>\n+    </properties>\n+\n+    <name>skywalking-correlation-autotag-scenario</name>\n+\n+    <dependencyManagement>\n+        <dependencies>\n+            <dependency>\n+                <groupId>org.springframework.boot</groupId>\n+                <artifactId>spring-boot-dependencies</artifactId>\n+                <version>${spring-boot-version}</version>\n+                <type>pom</type>\n+                <scope>import</scope>\n+            </dependency>\n+        </dependencies>\n+    </dependencyManagement>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-web</artifactId>\n+            <exclusions>\n+                <exclusion>\n+                    <groupId>org.springframework.boot</groupId>\n+                    <artifactId>spring-boot-starter-logging</artifactId>\n+                </exclusion>\n+            </exclusions>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-log4j2</artifactId>\n+        </dependency>\n+\n+        <!--    grpc    -->\n+        <dependency>\n+            <groupId>io.grpc</groupId>\n+            <artifactId>grpc-all</artifactId>\n+            <version>${test.framework.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-toolkit-trace</artifactId>\n+            <version>8.3.0-SNAPSHOT</version>", "originalCommit": "65528028f569370fe07519384691bc09735c0f5b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c589f35314bf08a0170619e642452c4450d219e8", "url": "https://github.com/apache/skywalking/commit/c589f35314bf08a0170619e642452c4450d219e8", "message": "Ignore codecov error when reporting because it's harmless", "committedDate": "2020-11-01T10:48:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxMTgxNA==", "url": "https://github.com/apache/skywalking/pull/5685#discussion_r515611814", "bodyText": "I mean to create a method extractCorrelationTo.", "author": "wu-sheng", "createdAt": "2020-11-01T11:48:47Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/ContextCarrier.java", "diffHunk": "@@ -94,6 +94,7 @@ public ExtensionInjector extensionInjector() {\n      */\n     void extractExtensionTo(AbstractSpan span) {\n         this.extensionContext.handle(span);\n+        this.correlationContext.handle(span);", "originalCommit": "c589f35314bf08a0170619e642452c4450d219e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5762849027ee73b428809c251b0f66ec4dca7552", "url": "https://github.com/apache/skywalking/commit/5762849027ee73b428809c251b0f66ec4dca7552", "message": "polish some codes", "committedDate": "2020-11-01T11:57:26Z", "type": "commit"}, {"oid": "56cf1a7fdce8eae39ccb555d0baf783dc8e2cd09", "url": "https://github.com/apache/skywalking/commit/56cf1a7fdce8eae39ccb555d0baf783dc8e2cd09", "message": "Merge branch 'correlation-inject-spans' of https://github.com/EvanLjp/skywalking into correlation-inject-spans", "committedDate": "2020-11-01T11:58:04Z", "type": "commit"}]}