{"pr_number": 5955, "pr_title": "test: extract so11y test and add logs", "pr_createdAt": "2020-12-05T16:14:45Z", "pr_url": "https://github.com/apache/skywalking/pull/5955", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "887e175fff1d36936550f4014bc5061897fe6662", "url": "https://github.com/apache/skywalking/commit/887e175fff1d36936550f4014bc5061897fe6662", "message": "test: extract so11y test and add logs", "committedDate": "2020-12-06T03:07:40Z", "type": "commit"}, {"oid": "887e175fff1d36936550f4014bc5061897fe6662", "url": "https://github.com/apache/skywalking/commit/887e175fff1d36936550f4014bc5061897fe6662", "message": "test: extract so11y test and add logs", "committedDate": "2020-12-06T03:07:40Z", "type": "forcePushed"}, {"oid": "bfaf5ce81485645d5b01e0701567d47d0b05d68b", "url": "https://github.com/apache/skywalking/commit/bfaf5ce81485645d5b01e0701567d47d0b05d68b", "message": "Merge branch 'master' into e2e/ref", "committedDate": "2020-12-06T07:29:09Z", "type": "commit"}, {"oid": "ab26976d43d791a41e085b1367dabbfff745fdd4", "url": "https://github.com/apache/skywalking/commit/ab26976d43d791a41e085b1367dabbfff745fdd4", "message": "Increase metrics time range\n\nSigned-off-by: Hongtao Gao <hanahmily@gmail.com>", "committedDate": "2020-12-06T11:21:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzAyMDYzMQ==", "url": "https://github.com/apache/skywalking/pull/5955#discussion_r537020631", "bodyText": "@kezhenxu94 this line throws NPE", "author": "hanahmily", "createdAt": "2020-12-06T11:40:52Z", "path": "test/e2e/e2e-test/src/test/java/org/apache/skywalking/e2e/SO11yE2E.java", "diffHunk": "@@ -0,0 +1,136 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.e2e;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.skywalking.e2e.annotation.ContainerHostAndPort;\n+import org.apache.skywalking.e2e.annotation.DockerCompose;\n+import org.apache.skywalking.e2e.base.SkyWalkingE2E;\n+import org.apache.skywalking.e2e.base.SkyWalkingTestAdapter;\n+import org.apache.skywalking.e2e.common.HostAndPort;\n+import org.apache.skywalking.e2e.metrics.AtLeastOneOfMetricsMatcher;\n+import org.apache.skywalking.e2e.metrics.MetricsValueMatcher;\n+import org.apache.skywalking.e2e.metrics.ReadMetrics;\n+import org.apache.skywalking.e2e.metrics.ReadMetricsQuery;\n+import org.apache.skywalking.e2e.retryable.RetryableTest;\n+import org.apache.skywalking.e2e.service.Service;\n+import org.apache.skywalking.e2e.service.ServicesMatcher;\n+import org.apache.skywalking.e2e.service.ServicesQuery;\n+import org.apache.skywalking.e2e.service.instance.Instance;\n+import org.apache.skywalking.e2e.service.instance.Instances;\n+import org.apache.skywalking.e2e.service.instance.InstancesMatcher;\n+import org.apache.skywalking.e2e.service.instance.InstancesQuery;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.testcontainers.containers.DockerComposeContainer;\n+\n+import static org.apache.skywalking.e2e.metrics.MetricsQuery.ALL_SO11Y_LINER_METRICS;\n+import static org.apache.skywalking.e2e.utils.Times.now;\n+import static org.apache.skywalking.e2e.utils.Yamls.load;\n+\n+/**\n+ * A test case for simple functionality verification\n+ *\n+ * The components are typically:\n+ *\n+ * - an single agent, (provider), generating traffic data\n+ *\n+ * - an OAP node, (oap)\n+ *\n+ * - a webapp, (ui) for querying\n+ *\n+ * The verifications are:\n+ *\n+ * - services\n+ *\n+ * - services metrics\n+ *\n+ * - services relations\n+ *\n+ * - endpoints\n+ *\n+ * - endpoints metrics\n+ *\n+ * - instances\n+ *\n+ * - instance metrics\n+ *\n+ * - topology\n+ *\n+ * - traces\n+ *\n+ * if your case needs the same aforementioned verifications, consider simply provide a docker-compose.yml with the specific orchestration and reuse these codes.\n+ */\n+@Slf4j\n+@SkyWalkingE2E\n+public class SO11yE2E extends SkyWalkingTestAdapter {\n+    @SuppressWarnings(\"unused\")\n+    @DockerCompose(\"docker/simple/so11y/docker-compose.yml\")\n+    protected DockerComposeContainer<?> justForSideEffects;\n+\n+    @SuppressWarnings(\"unused\")\n+    @ContainerHostAndPort(name = \"ui\", port = 8080)\n+    protected HostAndPort swWebappHostPort;\n+\n+    @BeforeAll\n+    void setUp() {\n+        queryClient(swWebappHostPort);\n+    }\n+\n+    @AfterAll\n+    public void tearDown() {\n+        trafficController.stop();", "originalCommit": "ab26976d43d791a41e085b1367dabbfff745fdd4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2806cd2ba09a610fc75cab3a17bbbe8788f4df1b", "url": "https://github.com/apache/skywalking/commit/2806cd2ba09a610fc75cab3a17bbbe8788f4df1b", "message": "Remove unused codes", "committedDate": "2020-12-06T12:29:45Z", "type": "commit"}, {"oid": "ff55e9643ef3b7f279d3df9949b42661fe19247c", "url": "https://github.com/apache/skywalking/commit/ff55e9643ef3b7f279d3df9949b42661fe19247c", "message": "Update SO11yE2E.java", "committedDate": "2020-12-06T12:48:15Z", "type": "commit"}, {"oid": "3608a425162dcca163def1cf5734d8bbd62c45d1", "url": "https://github.com/apache/skywalking/commit/3608a425162dcca163def1cf5734d8bbd62c45d1", "message": "Merge branch 'master' into e2e/ref", "committedDate": "2020-12-06T12:49:26Z", "type": "commit"}, {"oid": "90c11900bf08ec626e492193eb41a258a0b82062", "url": "https://github.com/apache/skywalking/commit/90c11900bf08ec626e492193eb41a258a0b82062", "message": "Merge branch 'master' into e2e/ref", "committedDate": "2020-12-06T13:14:34Z", "type": "commit"}]}