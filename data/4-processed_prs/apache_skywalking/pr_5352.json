{"pr_number": 5352, "pr_title": "[plugin/test] Plugin test with jdk14", "pr_createdAt": "2020-08-19T03:50:07Z", "pr_url": "https://github.com/apache/skywalking/pull/5352", "timeline": [{"oid": "328d21c72e47010893b93fb096c2832519724159", "url": "https://github.com/apache/skywalking/commit/328d21c72e47010893b93fb096c2832519724159", "message": "plugin test with jdk14", "committedDate": "2020-08-19T03:46:15Z", "type": "commit"}, {"oid": "5eb469db8327757305cae912eebc42bad5f3d189", "url": "https://github.com/apache/skywalking/commit/5eb469db8327757305cae912eebc42bad5f3d189", "message": "enable preview feature", "committedDate": "2020-08-20T06:15:18Z", "type": "commit"}, {"oid": "c5ddaf5fe3946eb4b9540008d7ce51ee7e916ad6", "url": "https://github.com/apache/skywalking/commit/c5ddaf5fe3946eb4b9540008d7ce51ee7e916ad6", "message": "introduce jdk14 container", "committedDate": "2020-08-20T06:16:50Z", "type": "commit"}, {"oid": "8543a4de1187c6db3663d2afe001c1fa2d5d73b0", "url": "https://github.com/apache/skywalking/commit/8543a4de1187c6db3663d2afe001c1fa2d5d73b0", "message": "remove docker:build", "committedDate": "2020-08-20T06:27:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY2Mzg5Mw==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r473663893", "bodyText": "One version should be enough, we don't need to test GSON here :)", "author": "wu-sheng", "createdAt": "2020-08-20T06:52:42Z", "path": "test/plugin/scenarios/jdk14-with-gson-scenario/support-version.list", "diffHunk": "@@ -0,0 +1,25 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+# lists your version here\n+\n+2.8.6", "originalCommit": "8543a4de1187c6db3663d2afe001c1fa2d5d73b0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY2NzIzMA==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r473667230", "bodyText": "Why I can't find the place to declare using this image? Could you point out?", "author": "wu-sheng", "createdAt": "2020-08-20T06:57:01Z", "path": "test/plugin/containers/jvm-container/pom.xml", "diffHunk": "@@ -32,8 +32,63 @@\n     <artifactId>jvm-container</artifactId>\n     <name>SkyWalking JVM Runner Image</name>\n \n-    <properties>\n-        <skip.docker>false</skip.docker>\n-        <docker.image.name>skywalking/agent-test-jvm</docker.image.name>\n-    </properties>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>io.fabric8</groupId>\n+                <artifactId>docker-maven-plugin</artifactId>\n+                <version>0.33.0</version>\n+                <configuration>\n+                    <images>\n+                        <image>\n+                            <name>skywalking/agent-test-jvm:${BUILD_NO}</name>\n+                            <build>\n+                                <from>openjdk:8</from>\n+                                <workdir>/usr/local/skywalking/tools</workdir>\n+                                <assembly>\n+                                    <mode>dir</mode>\n+                                    <targetDir>/usr/local/skywalking</targetDir>\n+                                    <descriptor>assembly.xml</descriptor>\n+                                </assembly>\n+                                <runCmds>\n+                                    <run>chmod +x /usr/local/skywalking/run.sh</run>\n+                                    <run>tar -xvf ../tools/skywalking-mock-collector.tar.gz -C ../tools</run>\n+                                </runCmds>\n+                                <workdir>/usr/local/skywalking/scenario</workdir>\n+                                <cmd>/usr/local/skywalking/run.sh</cmd>\n+                            </build>\n+                        </image>\n+                        <image>\n+                            <name>skywalking/agent-test-jvm:jdk14-${BUILD_NO}</name>", "originalCommit": "8543a4de1187c6db3663d2afe001c1fa2d5d73b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY3MTI5MQ==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r473671291", "bodyText": "It just is used to jdk14 case. And now, I have not enabled it yet.", "author": "dmsolr", "createdAt": "2020-08-20T07:01:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY2NzIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY3NTE1Ng==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r473675156", "bodyText": "I have a big change in building docker image, so I push it for ensuring that is ok.", "author": "dmsolr", "createdAt": "2020-08-20T07:06:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY2NzIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY3Njk0OA==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r473676948", "bodyText": "Got it. I was trying to find, how to activate the jdk14 container, notice it is an option only.", "author": "wu-sheng", "createdAt": "2020-08-20T07:09:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY2NzIzMA=="}], "type": "inlineReview"}, {"oid": "0587da7fabc1b0fbf599c45c55ab6e85d7c79bd2", "url": "https://github.com/apache/skywalking/commit/0587da7fabc1b0fbf599c45c55ab6e85d7c79bd2", "message": "Merge branch 'master' into plugin/test/jdk14", "committedDate": "2020-08-20T07:15:47Z", "type": "commit"}, {"oid": "054ae5fe94fe6eac6b1c87c02671776dd21a43d6", "url": "https://github.com/apache/skywalking/commit/054ae5fe94fe6eac6b1c87c02671776dd21a43d6", "message": "remove BUILD_NO and introduct image_version", "committedDate": "2020-08-20T09:22:15Z", "type": "commit"}, {"oid": "8a89b62d5faa74437c3505fb93c93c22cd4c1cf6", "url": "https://github.com/apache/skywalking/commit/8a89b62d5faa74437c3505fb93c93c22cd4c1cf6", "message": "update", "committedDate": "2020-08-20T09:23:07Z", "type": "commit"}, {"oid": "74191cf198950950630a2a3a2ce878b31ba22729", "url": "https://github.com/apache/skywalking/commit/74191cf198950950630a2a3a2ce878b31ba22729", "message": "Merge branch 'plugin/test/jdk14' of https://github.com/dmsolr/skywalking into plugin/test/jdk14", "committedDate": "2020-08-20T09:23:29Z", "type": "commit"}, {"oid": "e987a575e49d3265c47285540ddb51aa8c67203d", "url": "https://github.com/apache/skywalking/commit/e987a575e49d3265c47285540ddb51aa8c67203d", "message": "test", "committedDate": "2020-08-20T10:55:59Z", "type": "commit"}, {"oid": "760b1fb721065463603f208b0c5f0bed012a36db", "url": "https://github.com/apache/skywalking/commit/760b1fb721065463603f208b0c5f0bed012a36db", "message": "fix some issue", "committedDate": "2020-08-20T11:19:46Z", "type": "commit"}, {"oid": "4592ed32c420828cdc3f1f859e1c36cebac17ef4", "url": "https://github.com/apache/skywalking/commit/4592ed32c420828cdc3f1f859e1c36cebac17ef4", "message": "fix some issue", "committedDate": "2020-08-20T12:37:56Z", "type": "commit"}, {"oid": "7a02e5743f8a0d69b467edae7f663d0a7a85d043", "url": "https://github.com/apache/skywalking/commit/7a02e5743f8a0d69b467edae7f663d0a7a85d043", "message": "update", "committedDate": "2020-08-20T13:06:48Z", "type": "commit"}, {"oid": "3b66428f3351bc07b6997b50f3d9816895e3f24f", "url": "https://github.com/apache/skywalking/commit/3b66428f3351bc07b6997b50f3d9816895e3f24f", "message": "stash", "committedDate": "2020-08-21T04:44:06Z", "type": "commit"}, {"oid": "903cdea61e7c242988a8964297a49fa583e4a169", "url": "https://github.com/apache/skywalking/commit/903cdea61e7c242988a8964297a49fa583e4a169", "message": "fixed", "committedDate": "2020-08-21T04:53:54Z", "type": "commit"}, {"oid": "2344b7b04a87d7d541d5254047d311e0b51415e6", "url": "https://github.com/apache/skywalking/commit/2344b7b04a87d7d541d5254047d311e0b51415e6", "message": "stash", "committedDate": "2020-08-21T12:33:15Z", "type": "commit"}, {"oid": "c0f56edc4d544f080e8afdac932621460dc9c34a", "url": "https://github.com/apache/skywalking/commit/c0f56edc4d544f080e8afdac932621460dc9c34a", "message": "fix", "committedDate": "2020-08-21T13:30:43Z", "type": "commit"}, {"oid": "8c03a779387dd254484b040b6743f30c12207348", "url": "https://github.com/apache/skywalking/commit/8c03a779387dd254484b040b6743f30c12207348", "message": "fix", "committedDate": "2020-08-21T15:14:33Z", "type": "commit"}, {"oid": "f04b4f9d4245d61fdf870fc452db30bfca8b9a20", "url": "https://github.com/apache/skywalking/commit/f04b4f9d4245d61fdf870fc452db30bfca8b9a20", "message": "update", "committedDate": "2020-08-22T04:53:04Z", "type": "commit"}, {"oid": "5bb9faa67694c7264e1557e8f29a474cd85ee2e6", "url": "https://github.com/apache/skywalking/commit/5bb9faa67694c7264e1557e8f29a474cd85ee2e6", "message": "Merge branch 'master' into plugin/test/jdk14", "committedDate": "2020-08-22T07:23:56Z", "type": "commit"}, {"oid": "88d0229ae0665c06b597a6c5eb6f5b7189375036", "url": "https://github.com/apache/skywalking/commit/88d0229ae0665c06b597a6c5eb6f5b7189375036", "message": "Merge branch 'master' into plugin/test/jdk14", "committedDate": "2020-08-22T09:24:00Z", "type": "commit"}, {"oid": "9faaf0ff0fa0794ef73c818f132fc40452efafcf", "url": "https://github.com/apache/skywalking/commit/9faaf0ff0fa0794ef73c818f132fc40452efafcf", "message": "fix", "committedDate": "2020-08-23T08:50:44Z", "type": "commit"}, {"oid": "38d29fdd9a4218ca927241581597b68e0e2c8355", "url": "https://github.com/apache/skywalking/commit/38d29fdd9a4218ca927241581597b68e0e2c8355", "message": "fix", "committedDate": "2020-08-23T08:54:05Z", "type": "commit"}, {"oid": "f770d7e44d31374123f3d0bba10f32331f4ae690", "url": "https://github.com/apache/skywalking/commit/f770d7e44d31374123f3d0bba10f32331f4ae690", "message": "remove compiling flag release", "committedDate": "2020-08-23T09:02:22Z", "type": "commit"}, {"oid": "7d5c6370b1a9a561ac3e394debe6e2ea81925307", "url": "https://github.com/apache/skywalking/commit/7d5c6370b1a9a561ac3e394debe6e2ea81925307", "message": "Merge branch 'master' into plugin/test/jdk14", "committedDate": "2020-08-23T11:01:46Z", "type": "commit"}, {"oid": "763caf337037a1a4c0d2ccb76832e10edca17b1c", "url": "https://github.com/apache/skywalking/commit/763caf337037a1a4c0d2ccb76832e10edca17b1c", "message": "Merge branch 'master' into plugin/test/jdk14", "committedDate": "2020-08-23T12:43:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxODUxMQ==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r475218511", "bodyText": "Separate this into another yaml control file.", "author": "wu-sheng", "createdAt": "2020-08-23T13:18:08Z", "path": ".github/workflows/plugins-test.3.yaml", "diffHunk": "@@ -95,3 +95,26 @@ jobs:\n           bash test/plugin/run.sh oracle-scenario\n       - name: Report Coverage\n         run: bash -x tools/coverage/report.sh\n+\n+  jdk14:", "originalCommit": "763caf337037a1a4c0d2ccb76832e10edca17b1c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxODM2MQ==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r475218361", "bodyText": "Sure you don't need set -ex now?", "author": "kezhenxu94", "createdAt": "2020-08-23T13:16:36Z", "path": "test/plugin/containers/jvm-container/src/main/docker/run.sh", "diffHunk": "@@ -16,7 +16,7 @@\n # See the License for the specific language governing permissions and\n # limitations under the License.\n \n-[[ -n $DEBUG_MODE ]] && set -ex\n+[[ -n $DEBUG_MODE ]] && export", "originalCommit": "763caf337037a1a4c0d2ccb76832e10edca17b1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIzMDk4Mg==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r475230982", "bodyText": "In fact, it still should be needed. But process will exit directly this when set -ex is enabled.\nThe process will exit why the result os the command executed is non-zero.", "author": "dmsolr", "createdAt": "2020-08-23T15:12:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxODM2MQ=="}], "type": "inlineReview"}, {"oid": "95d6f8af0ad163dde69323536e02248ec1e5b8a8", "url": "https://github.com/apache/skywalking/commit/95d6f8af0ad163dde69323536e02248ec1e5b8a8", "message": "stash", "committedDate": "2020-08-23T14:48:07Z", "type": "commit"}, {"oid": "557f0363b0f6c003a9dacdbee0aba9f6ff413b03", "url": "https://github.com/apache/skywalking/commit/557f0363b0f6c003a9dacdbee0aba9f6ff413b03", "message": "Merge branch 'plugin/test/jdk14' of https://github.com/dmsolr/skywalking into plugin/test/jdk14", "committedDate": "2020-08-23T14:48:54Z", "type": "commit"}, {"oid": "9cd2220e874f1b30cde5e3300ddecd9f0f1882fc", "url": "https://github.com/apache/skywalking/commit/9cd2220e874f1b30cde5e3300ddecd9f0f1882fc", "message": "add set -ex back", "committedDate": "2020-08-23T15:25:32Z", "type": "commit"}, {"oid": "00ad0c4489eea02a9a1ce06a32f0283591286943", "url": "https://github.com/apache/skywalking/commit/00ad0c4489eea02a9a1ce06a32f0283591286943", "message": "revert", "committedDate": "2020-08-23T17:26:57Z", "type": "commit"}, {"oid": "01ffb4e033cb3d272f7b2db8cd45da75ca4ce322", "url": "https://github.com/apache/skywalking/commit/01ffb4e033cb3d272f7b2db8cd45da75ca4ce322", "message": "revert", "committedDate": "2020-08-24T03:52:39Z", "type": "commit"}, {"oid": "8dc5b253a5ba7f658b0081f1e77036553508e813", "url": "https://github.com/apache/skywalking/commit/8dc5b253a5ba7f658b0081f1e77036553508e813", "message": "update doc and introduce profiles", "committedDate": "2020-08-24T07:26:15Z", "type": "commit"}, {"oid": "f989316723a9a73ede154d8928493da33409a43c", "url": "https://github.com/apache/skywalking/commit/f989316723a9a73ede154d8928493da33409a43c", "message": "Merge branch 'master' into plugin/test/jdk14", "committedDate": "2020-08-24T09:18:36Z", "type": "commit"}, {"oid": "cfc39820ab3662add964b2723cb74d9b8c9ebcc2", "url": "https://github.com/apache/skywalking/commit/cfc39820ab3662add964b2723cb74d9b8c9ebcc2", "message": "update", "committedDate": "2020-08-24T10:54:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUyMDY4NA==", "url": "https://github.com/apache/skywalking/pull/5352#discussion_r475520684", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The test framework provides `JVM-container` and `Tomcat-container` base images including JDK8, JDK14. You could choose the suitable one for your test case, if either is suitable, **recommend choose `JVM-container`**.\n          \n          \n            \n            The test framework provides `JVM-container` and `Tomcat-container` base images including JDK8, JDK14. You could choose the suitable one for your test case, if both are suitable, **`JVM-container` is preferred**.", "author": "kezhenxu94", "createdAt": "2020-08-24T11:01:17Z", "path": "docs/en/guides/Plugin-test.md", "diffHunk": "@@ -10,26 +10,27 @@ Every plugin maintained in the main repo requires corresponding test cases, also\n ## Environment Requirements\n \n 1. MacOS/Linux\n-2. jdk 8+\n+2. JDK 8+\n 3. Docker\n 4. Docker Compose\n \n ## Case Base Image Introduction\n \n-The test framework provides `JVM-container` and `Tomcat-container` base images. You could choose the suitable one for your test case, if either is suitable, **recommend choose `JVM-container`**.\n+The test framework provides `JVM-container` and `Tomcat-container` base images including JDK8, JDK14. You could choose the suitable one for your test case, if either is suitable, **recommend choose `JVM-container`**.", "originalCommit": "f989316723a9a73ede154d8928493da33409a43c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "637e29d4e02b0f321656478b130e72397910e2df", "url": "https://github.com/apache/skywalking/commit/637e29d4e02b0f321656478b130e72397910e2df", "message": "Update docs/en/guides/Plugin-test.md\n\nCo-authored-by: kezhenxu94 <kezhenxu94@163.com>", "committedDate": "2020-08-24T11:16:03Z", "type": "commit"}]}