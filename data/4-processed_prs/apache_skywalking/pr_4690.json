{"pr_number": 4690, "pr_title": "Fix profile recheck error", "pr_createdAt": "2020-04-22T04:39:55Z", "pr_url": "https://github.com/apache/skywalking/pull/4690", "timeline": [{"oid": "f853e802c0ac0a760769d285d9b05d77f0f0f4e1", "url": "https://github.com/apache/skywalking/commit/f853e802c0ac0a760769d285d9b05d77f0f0f4e1", "message": "fix profile recheck error", "committedDate": "2020-04-22T04:34:05Z", "type": "commit"}, {"oid": "010483efb670b4da1e2ebe5fb5c1bfc4a7f8d219", "url": "https://github.com/apache/skywalking/commit/010483efb670b4da1e2ebe5fb5c1bfc4a7f8d219", "message": "fix style error", "committedDate": "2020-04-22T04:51:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412670618", "bodyText": "What does the renaming fix? If it really fixes something, please add the directory to\n\n  \n    \n      skywalking/tools/coverage/report.sh\n    \n    \n        Lines 32 to 34\n      in\n      8e6a527\n    \n    \n    \n    \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/oap/server/core/query/entity || true \n        \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/testcase || true \n        \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/e2e || true \n        \n    \n  \n\n\ni.e. sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/test || true", "author": "kezhenxu94", "createdAt": "2020-04-22T04:59:58Z", "path": "test/e2e/e2e-service-provider/src/main/java/test/apache/skywalking/e2e/User.java", "diffHunk": "@@ -16,7 +16,7 @@\n  *\n  */\n \n-package org.apache.skywalking.e2e;\n+package test.apache.skywalking.e2e;", "originalCommit": "010483efb670b4da1e2ebe5fb5c1bfc4a7f8d219", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MTQ1Mw==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412671453", "bodyText": "So the package name rules need to be updated too, is the renaming a must?", "author": "kezhenxu94", "createdAt": "2020-04-22T05:02:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MTc1NQ==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412671755", "bodyText": "Use the org.apache.skywalking package prefix, then the SpringMVC plugin cannot be enhanced, because that package is ignored. So avoid using this package.", "author": "mrproliu", "createdAt": "2020-04-22T05:03:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MjQ5NQ==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412672495", "bodyText": "@kezhenxu94  I seem the e2e also has the style check, and It's must match the package name with regex, ^org\\.apache\\.skywalking(\\.[a-zA-Z][a-zA-Z0-9]*)+$, so how can I fix that?", "author": "mrproliu", "createdAt": "2020-04-22T05:05:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MzA5NA==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412673094", "bodyText": "Use the org.apache.skywalking package prefix, then the SpringMVC plugin cannot be enhanced, because that package is ignored. So avoid using this package.\n\nThen you need to:\n\nupdate the package name rules:\n\n\n  \n    \n      skywalking/apm-checkstyle/checkStyle.xml\n    \n    \n         Line 99\n      in\n      dcd66ee\n    \n    \n    \n    \n\n        \n          \n           <property name=\"format\" value=\"^org\\.apache\\.skywalking(\\.[a-zA-Z][a-zA-Z0-9]*)+$\"/> \n        \n    \n  \n\n\n\nadd the package to exclusion list\n\n\n  \n    \n      skywalking/tools/coverage/report.sh\n    \n    \n        Lines 32 to 34\n      in\n      8e6a527\n    \n    \n    \n    \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/oap/server/core/query/entity || true \n        \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/testcase || true \n        \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/e2e || true \n        \n    \n  \n\n\ni.e. sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/test || true", "author": "kezhenxu94", "createdAt": "2020-04-22T05:07:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3NTM5MA==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412675390", "bodyText": "I think test.apache.skywalking package is used in the spring plugin test too.", "author": "wu-sheng", "createdAt": "2020-04-22T05:14:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3NjY1MQ==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412676651", "bodyText": "I think test.apache.skywalking package is used in the spring plugin test too.\n\nYes.", "author": "mrproliu", "createdAt": "2020-04-22T05:18:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3Njk5Ng==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412676996", "bodyText": "Use the org.apache.skywalking package prefix, then the SpringMVC plugin cannot be enhanced, because that package is ignored. So avoid using this package.\n\nThen you need to:\n\nupdate the package name rules:\n\n\n  \n    \n      skywalking/apm-checkstyle/checkStyle.xml\n    \n    \n         Line 99\n      in\n      dcd66ee\n    \n    \n    \n    \n\n        \n          \n           <property name=\"format\" value=\"^org\\.apache\\.skywalking(\\.[a-zA-Z][a-zA-Z0-9]*)+$\"/> \n        \n    \n  \n\n\n\nadd the package to exclusion list\n\n\n  \n    \n      skywalking/tools/coverage/report.sh\n    \n    \n        Lines 32 to 34\n      in\n      8e6a527\n    \n    \n    \n    \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/oap/server/core/query/entity || true \n        \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/testcase || true \n        \n\n        \n          \n           sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/org/apache/skywalking/e2e || true \n        \n    \n  \n\n\ni.e. sudo rm -rf \"${JACOCO_HOME}\"/classes/\"${exec_data}\"/test || true \n\nI have changed, please take a look.", "author": "mrproliu", "createdAt": "2020-04-22T05:19:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY3MDYxOA=="}], "type": "inlineReview"}, {"oid": "c4702696af628cfd1284c3a845772e36aa319b71", "url": "https://github.com/apache/skywalking/commit/c4702696af628cfd1284c3a845772e36aa319b71", "message": "fix coverage and style check", "committedDate": "2020-04-22T05:14:51Z", "type": "commit"}, {"oid": "8e09bfba7da82455a474f0353d183424e356d0f4", "url": "https://github.com/apache/skywalking/commit/8e09bfba7da82455a474f0353d183424e356d0f4", "message": "Merge branch 'master' into profile-recheck-bug", "committedDate": "2020-04-22T06:19:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwMjM1NA==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412702354", "bodyText": "Question, in spring 4.1.x test case, we have this package name, so why we change this now? Does only e2e follow this style file, but plugin tests not?", "author": "wu-sheng", "createdAt": "2020-04-22T06:23:32Z", "path": "apm-checkstyle/checkStyle.xml", "diffHunk": "@@ -96,7 +96,7 @@\n             <property name=\"format\" value=\"(^[A-Z][A-Z0-9]*(_[A-Z0-9]+)*$)\"/>\n         </module>\n         <module name=\"PackageName\">\n-            <property name=\"format\" value=\"^org\\.apache\\.skywalking(\\.[a-zA-Z][a-zA-Z0-9]*)+$\"/>\n+            <property name=\"format\" value=\"^(org|test)\\.apache\\.skywalking(\\.[a-zA-Z][a-zA-Z0-9]*)+$\"/>", "originalCommit": "8e09bfba7da82455a474f0353d183424e356d0f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwNzY5OQ==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412707699", "bodyText": "@kezhenxu94 @dmsolr", "author": "wu-sheng", "createdAt": "2020-04-22T06:35:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwMjM1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcxMDYxNg==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412710616", "bodyText": "Question, in spring 4.1.x test case, we have this package name, so why we change this now? Does only e2e follow this style file, but plugin tests not?\n\nYes obviously, there is checkstyle plugin in E2E pom.xml, but not in the plugin tests,", "author": "kezhenxu94", "createdAt": "2020-04-22T06:40:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwMjM1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcxMTI1Mg==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412711252", "bodyText": "@dmsolr Please take care of plugin test codes when you have time.", "author": "wu-sheng", "createdAt": "2020-04-22T06:41:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwMjM1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc2MTg0OA==", "url": "https://github.com/apache/skywalking/pull/4690#discussion_r412761848", "bodyText": "PluginTests don't enable checkstyle yet. ref #4377", "author": "dmsolr", "createdAt": "2020-04-22T08:02:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjcwMjM1NA=="}], "type": "inlineReview"}, {"oid": "ecc792afb2f588f1b828b6275a58c55869e87aab", "url": "https://github.com/apache/skywalking/commit/ecc792afb2f588f1b828b6275a58c55869e87aab", "message": "Merge branch 'master' into profile-recheck-bug", "committedDate": "2020-04-22T09:10:12Z", "type": "commit"}, {"oid": "aacc737dbf3cd4ea0449d6fdda6502eebb73db18", "url": "https://github.com/apache/skywalking/commit/aacc737dbf3cd4ea0449d6fdda6502eebb73db18", "message": "move back to the org.apache.skywalking prefix, only profile e2e move to test.apache.skywalking", "committedDate": "2020-04-22T09:31:35Z", "type": "commit"}]}