{"pr_number": 5524, "pr_title": "Better witness class for mongo3.8.x", "pr_createdAt": "2020-09-20T15:31:06Z", "pr_url": "https://github.com/apache/skywalking/pull/5524", "timeline": [{"oid": "b614a4ec2105b36cc783489d522a779c43c19e1a", "url": "https://github.com/apache/skywalking/commit/b614a4ec2105b36cc783489d522a779c43c19e1a", "message": "modify witness class", "committedDate": "2020-09-20T13:33:31Z", "type": "commit"}, {"oid": "4968aacf5fd6edb40e6db4d4ebfa47f8af7887fb", "url": "https://github.com/apache/skywalking/commit/4968aacf5fd6edb40e6db4d4ebfa47f8af7887fb", "message": "modify witness class & add test case", "committedDate": "2020-09-20T15:24:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491704015", "bodyText": "You activated this, but can't see the param in the tags.", "author": "wu-sheng", "createdAt": "2020-09-20T15:47:16Z", "path": "test/plugin/scenarios/mongodb-3.x-scenario/bin/startup.sh", "diffHunk": "@@ -18,4 +18,4 @@\n \n home=\"$(cd \"$(dirname $0)\"; pwd)\"\n \n-java -jar ${agent_opts} ${home}/../libs/mongodb-3.x-scenario.jar &\n\\ No newline at end of file\n+java -jar -Dskywalking.plugin.mongodb.trace_param=true ${agent_opts} ${home}/../libs/mongodb-3.x-scenario.jar &", "originalCommit": "4968aacf5fd6edb40e6db4d4ebfa47f8af7887fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNTEzMg==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491705132", "bodyText": "param is db.statement,In terms of content judgment, I have encountered a problem, can you help me see it, for example,\n\nI can't see the difference between the estimated value and the actual value, but it is an error.", "author": "harvies", "createdAt": "2020-09-20T15:59:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNTk2Ng==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491705966", "bodyText": "What do you mean error? Why CI reports success?", "author": "wu-sheng", "createdAt": "2020-09-20T16:07:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNjA1Nw==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491706057", "bodyText": "param is db.statement,In terms of content judgment\n\nAlso, this place seems like a bug. The parameter should be another tag, like other plugins. Could you fix them too? And if no parameter exists, the tag should not be there too.", "author": "wu-sheng", "createdAt": "2020-09-20T16:08:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNjE2Nw==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491706167", "bodyText": "What do you mean error? Why CI reports success?\n\nThis pr uses not null judgment, I think it is better to use string equality judgment.", "author": "harvies", "createdAt": "2020-09-20T16:09:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNjQwNA==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491706404", "bodyText": "Let's adjust the tag and don't worry about this check for now, OK?", "author": "wu-sheng", "createdAt": "2020-09-20T16:11:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNjY1OA==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491706658", "bodyText": "Wait, is the statement including the entity name of the operation or not?", "author": "wu-sheng", "createdAt": "2020-09-20T16:14:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNjg2NQ==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491706865", "bodyText": "From my reading from your screenshot, only operation is a part of the statement, I think the plugin code has some issue about assembling the statement and parameter. Statement should be an expression and parameters are variable. I am not sure whether mongodb is friendly to this?", "author": "wu-sheng", "createdAt": "2020-09-20T16:16:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc1NjM2NQ==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491756365", "bodyText": "I just read the codes again, the statement tag should be removed, as this actually isn't a statement anymore. We should use DB_BIND_VARIABLES tag to replace DB_STATEMENT, because the statement is being used to check slow SQL. Also, please help to remove the executeMethod as the prefix, it has been the operation name of the span.", "author": "wu-sheng", "createdAt": "2020-09-21T00:51:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNzU0OQ==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491817549", "bodyText": "From my reading from your screenshot, only operation is a part of the statement, I think the plugin code has some issue about assembling the statement and parameter. Statement should be an expression and parameters are variable. I am not sure whether mongodb is friendly to this?\n\nMongo does not seem to have a placeholder similar to sql.", "author": "harvies", "createdAt": "2020-09-21T06:34:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxODk0MA==", "url": "https://github.com/apache/skywalking/pull/5524#discussion_r491818940", "bodyText": "I just read the codes again, the statement tag should be removed, as this actually isn't a statement anymore. We should use DB_BIND_VARIABLES tag to replace DB_STATEMENT, because the statement is being used to check slow SQL. Also, please help to remove the executeMethod as the prefix, it has been the operation name of the span.\n\nOkay, let me adjust.", "author": "harvies", "createdAt": "2020-09-21T06:38:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTcwNDAxNQ=="}], "type": "inlineReview"}, {"oid": "424bec579fd582633606a3d7a78debe62180e3db", "url": "https://github.com/apache/skywalking/commit/424bec579fd582633606a3d7a78debe62180e3db", "message": "replace DB_STATEMENT to DB_BIND_VARIABLES & remove executeMethod prefix", "committedDate": "2020-09-21T10:21:01Z", "type": "commit"}, {"oid": "459241eb77a9956c6fc1eb1d0d79814fc4b21cac", "url": "https://github.com/apache/skywalking/commit/459241eb77a9956c6fc1eb1d0d79814fc4b21cac", "message": "fix ci", "committedDate": "2020-09-21T13:15:53Z", "type": "commit"}, {"oid": "64db23394ddea64b01229d53401e91d6eade5e76", "url": "https://github.com/apache/skywalking/commit/64db23394ddea64b01229d53401e91d6eade5e76", "message": "Merge branch 'master' into better_witness_class_for_mongo3.x", "committedDate": "2020-09-21T23:15:07Z", "type": "commit"}]}