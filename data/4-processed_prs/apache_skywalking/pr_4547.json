{"pr_number": 4547, "pr_title": "Add PHP module support to e2e test", "pr_createdAt": "2020-03-20T11:52:51Z", "pr_url": "https://github.com/apache/skywalking/pull/4547", "timeline": [{"oid": "ce28bfd5aee5a8988c1ed6c7c907fef7cd2a07b5", "url": "https://github.com/apache/skywalking/commit/ce28bfd5aee5a8988c1ed6c7c907fef7cd2a07b5", "message": "fix #4539, add PHP to the query protocol", "committedDate": "2020-03-19T03:03:40Z", "type": "commit"}, {"oid": "1b7b154dc688bdc65a446aa990e78a30940aec7f", "url": "https://github.com/apache/skywalking/commit/1b7b154dc688bdc65a446aa990e78a30940aec7f", "message": "Merge branch 'master' into master", "committedDate": "2020-03-19T03:40:01Z", "type": "commit"}, {"oid": "c707f29c832908b0322a0945c1757b9573025b69", "url": "https://github.com/apache/skywalking/commit/c707f29c832908b0322a0945c1757b9573025b69", "message": "Add PHP module support to e2e test", "committedDate": "2020-03-20T11:43:37Z", "type": "commit"}, {"oid": "492de58c10ead41fc3bde448225a9c286a05affb", "url": "https://github.com/apache/skywalking/commit/492de58c10ead41fc3bde448225a9c286a05affb", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-03-20T11:50:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NjgyNg==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r395646826", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - ../php/index.php:/opt/www/index.php\n          \n          \n            \n                  - ../php/php-shadow.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini\n          \n          \n            \n                  - ./index.php:/opt/www/index.php\n          \n          \n            \n                  - ./php-shadow.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini", "author": "kezhenxu94", "createdAt": "2020-03-20T13:47:31Z", "path": "test/e2e/e2e-test/docker/php/docker-compose.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '2.1'\n+\n+services:\n+  oap:\n+    image: skywalking/oap:latest\n+    expose:\n+      - 11800\n+      - 12800\n+    networks:\n+      - e2e\n+    restart: on-failure\n+    healthcheck:\n+      test: [\"CMD\", \"bash\", \"-c\", \"cat < /dev/null > /dev/tcp/127.0.0.1/11800\"]\n+      interval: 5s\n+      timeout: 60s\n+      retries: 120\n+\n+  php:\n+    image: skyapm/skywalking-php:latest\n+    networks:\n+      e2e:\n+        aliases:\n+          - php\n+    expose:\n+      - 8080\n+    environment:\n+      - SW_AGENT_COLLECTOR_BACKEND_SERVICES=oap:11800\n+    depends_on:\n+      oap:\n+        condition: service_healthy\n+    volumes:\n+      - ../php/index.php:/opt/www/index.php\n+      - ../php/php.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini\n+\n+  php-shadow:\n+    image: skyapm/skywalking-php:latest\n+    networks:\n+      e2e:\n+        aliases:\n+          - php-shadow\n+    expose:\n+      - 8080\n+    environment:\n+      - SW_AGENT_COLLECTOR_BACKEND_SERVICES=oap:11800\n+    depends_on:\n+      php:\n+        condition: service_started\n+      oap:\n+        condition: service_healthy\n+    volumes:\n+      - ../php/index.php:/opt/www/index.php\n+      - ../php/php-shadow.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini", "originalCommit": "492de58c10ead41fc3bde448225a9c286a05affb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzMwNg==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r395647306", "bodyText": "do we need an alias? if not, let's make it minimal simple", "author": "kezhenxu94", "createdAt": "2020-03-20T13:48:11Z", "path": "test/e2e/e2e-test/docker/php/docker-compose.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '2.1'\n+\n+services:\n+  oap:\n+    image: skywalking/oap:latest\n+    expose:\n+      - 11800\n+      - 12800\n+    networks:\n+      - e2e\n+    restart: on-failure\n+    healthcheck:\n+      test: [\"CMD\", \"bash\", \"-c\", \"cat < /dev/null > /dev/tcp/127.0.0.1/11800\"]\n+      interval: 5s\n+      timeout: 60s\n+      retries: 120\n+\n+  php:\n+    image: skyapm/skywalking-php:latest\n+    networks:\n+      e2e:\n+        aliases:\n+          - php\n+    expose:\n+      - 8080\n+    environment:\n+      - SW_AGENT_COLLECTOR_BACKEND_SERVICES=oap:11800\n+    depends_on:\n+      oap:\n+        condition: service_healthy\n+    volumes:\n+      - ../php/index.php:/opt/www/index.php\n+      - ../php/php.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini\n+\n+  php-shadow:\n+    image: skyapm/skywalking-php:latest\n+    networks:\n+      e2e:\n+        aliases:\n+          - php-shadow", "originalCommit": "492de58c10ead41fc3bde448225a9c286a05affb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzM5Ng==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r395647396", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - ../php/index.php:/opt/www/index.php\n          \n          \n            \n                  - ../php/php.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini\n          \n          \n            \n                  - ./index.php:/opt/www/index.php\n          \n          \n            \n                  - ./php.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini", "author": "kezhenxu94", "createdAt": "2020-03-20T13:48:20Z", "path": "test/e2e/e2e-test/docker/php/docker-compose.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '2.1'\n+\n+services:\n+  oap:\n+    image: skywalking/oap:latest\n+    expose:\n+      - 11800\n+      - 12800\n+    networks:\n+      - e2e\n+    restart: on-failure\n+    healthcheck:\n+      test: [\"CMD\", \"bash\", \"-c\", \"cat < /dev/null > /dev/tcp/127.0.0.1/11800\"]\n+      interval: 5s\n+      timeout: 60s\n+      retries: 120\n+\n+  php:\n+    image: skyapm/skywalking-php:latest\n+    networks:\n+      e2e:\n+        aliases:\n+          - php\n+    expose:\n+      - 8080\n+    environment:\n+      - SW_AGENT_COLLECTOR_BACKEND_SERVICES=oap:11800\n+    depends_on:\n+      oap:\n+        condition: service_healthy\n+    volumes:\n+      - ../php/index.php:/opt/www/index.php\n+      - ../php/php.ini:/usr/local/etc/php/conf.d/ext-skywalking.ini", "originalCommit": "492de58c10ead41fc3bde448225a9c286a05affb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0Nzc2OQ==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r395647769", "bodyText": "remove if we don't need it", "author": "kezhenxu94", "createdAt": "2020-03-20T13:48:50Z", "path": "test/e2e/e2e-test/docker/php/docker-compose.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '2.1'\n+\n+services:\n+  oap:\n+    image: skywalking/oap:latest\n+    expose:\n+      - 11800\n+      - 12800\n+    networks:\n+      - e2e\n+    restart: on-failure\n+    healthcheck:\n+      test: [\"CMD\", \"bash\", \"-c\", \"cat < /dev/null > /dev/tcp/127.0.0.1/11800\"]\n+      interval: 5s\n+      timeout: 60s\n+      retries: 120\n+\n+  php:\n+    image: skyapm/skywalking-php:latest\n+    networks:\n+      e2e:\n+        aliases:\n+          - php", "originalCommit": "492de58c10ead41fc3bde448225a9c286a05affb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8eddc667159ad4ee623c3c53cdc423f0d3e888b9", "url": "https://github.com/apache/skywalking/commit/8eddc667159ad4ee623c3c53cdc423f0d3e888b9", "message": "Merge branch 'master' into master", "committedDate": "2020-03-21T02:09:59Z", "type": "commit"}, {"oid": "f84cb2cd3c8024f1c6a14a63c16c1841c2db920c", "url": "https://github.com/apache/skywalking/commit/f84cb2cd3c8024f1c6a14a63c16c1841c2db920c", "message": "Add PHP e2e test into the CI control file", "committedDate": "2020-03-21T07:51:27Z", "type": "commit"}, {"oid": "544200e5ebc3a25aa0fb720620fd6356c59f9f2c", "url": "https://github.com/apache/skywalking/commit/544200e5ebc3a25aa0fb720620fd6356c59f9f2c", "message": "Remove networks aliases", "committedDate": "2020-03-21T08:29:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4OTY1Ng==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r396089656", "bodyText": "@kezhenxu94 I have a doubt about the group naming principle. What are they? Why all these say FeatureGroupxx, and the last one shows Gateway?", "author": "wu-sheng", "createdAt": "2020-03-22T12:46:54Z", "path": ".github/workflows/e2e.yaml", "diffHunk": "@@ -80,6 +80,28 @@ jobs:\n           name: logs\n           path: logs\n \n+  FeatureGroup03:", "originalCommit": "f84cb2cd3c8024f1c6a14a63c16c1841c2db920c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA5MTY2MQ==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r396091661", "bodyText": "@kezhenxu94 I have a doubt about the group naming principle. What are they? Why all these say FeatureGroupxx, and the last one shows Gateway?\n\nThe Gateway should be also renamed to FeatureGroupXX I think, if @wu-sheng you have better suggestion, I'm good to follow :) as for the PHP job, as an individual language agent, I prefer to set up another workflow, named PHP Agent or PHP SDK, WDYT", "author": "kezhenxu94", "createdAt": "2020-03-22T13:07:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4OTY1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA5MTkzMg==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r396091932", "bodyText": "I prefer it keeps in a separated group, to avoid unexpected CI process conflict with other tests. Also, most PMC know little about the PHP agent, if conflict occurs, it is hard to follow.\n@heyanlong Please create e2e.php.yaml.\n@kezhenxu94 , please rename to FeatureGroupXX, at least keep consistent. I don't have better idea for now.", "author": "wu-sheng", "createdAt": "2020-03-22T13:10:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4OTY1Ng=="}], "type": "inlineReview"}, {"oid": "bc9d59559e88a506958fcb284ce10084c0061540", "url": "https://github.com/apache/skywalking/commit/bc9d59559e88a506958fcb284ce10084c0061540", "message": "Add PHP module support to e2e test", "committedDate": "2020-03-23T05:56:28Z", "type": "commit"}, {"oid": "458978f2e5235f110984f2ecab76f05642fab874", "url": "https://github.com/apache/skywalking/commit/458978f2e5235f110984f2ecab76f05642fab874", "message": "Add e2e.php.yaml", "committedDate": "2020-03-23T06:03:18Z", "type": "commit"}, {"oid": "7eae5a962bb53311bf62682d4ecc05faaa3eba10", "url": "https://github.com/apache/skywalking/commit/7eae5a962bb53311bf62682d4ecc05faaa3eba10", "message": "Merge branch 'master' into master", "committedDate": "2020-03-23T06:06:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjI0Nzc4OA==", "url": "https://github.com/apache/skywalking/pull/4547#discussion_r396247788", "bodyText": "I highly recommended don't use latest. Let's image what will happen in the next release? If something breaks in there?", "author": "wu-sheng", "createdAt": "2020-03-23T07:15:33Z", "path": "test/e2e/e2e-test/docker/php/docker-compose.yml", "diffHunk": "@@ -0,0 +1,82 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '2.1'\n+\n+services:\n+  oap:\n+    image: skywalking/oap:latest\n+    expose:\n+      - 11800\n+      - 12800\n+    networks:\n+      - e2e\n+    restart: on-failure\n+    healthcheck:\n+      test: [\"CMD\", \"bash\", \"-c\", \"cat < /dev/null > /dev/tcp/127.0.0.1/11800\"]\n+      interval: 5s\n+      timeout: 60s\n+      retries: 120\n+\n+  php-shadow:\n+    image: skyapm/skywalking-php:latest", "originalCommit": "7eae5a962bb53311bf62682d4ecc05faaa3eba10", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1411ec0cbccef81e88937833567b387d284b3579", "url": "https://github.com/apache/skywalking/commit/1411ec0cbccef81e88937833567b387d284b3579", "message": "Locked version", "committedDate": "2020-03-23T14:12:08Z", "type": "commit"}, {"oid": "6c98c584d15a375372efd5eb1a0a05a79a02afaf", "url": "https://github.com/apache/skywalking/commit/6c98c584d15a375372efd5eb1a0a05a79a02afaf", "message": "Merge remote-tracking branch 'origin/master'", "committedDate": "2020-03-23T14:12:39Z", "type": "commit"}, {"oid": "3147eebad65055e48d3fee0ffd6079704f0727d2", "url": "https://github.com/apache/skywalking/commit/3147eebad65055e48d3fee0ffd6079704f0727d2", "message": "Merge branch 'master' into master", "committedDate": "2020-03-23T14:15:31Z", "type": "commit"}]}