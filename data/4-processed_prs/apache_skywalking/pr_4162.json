{"pr_number": 4162, "pr_title": "Support collecting http parameters", "pr_createdAt": "2020-01-02T11:27:52Z", "pr_url": "https://github.com/apache/skywalking/pull/4162", "timeline": [{"oid": "32439e26bb9a5497651383332172a5188c6c89fc", "url": "https://github.com/apache/skywalking/commit/32439e26bb9a5497651383332172a5188c6c89fc", "message": "Support collecting http parameters\n\nPlugins of Tomcat, Spring MVC, Armeria are supported for now", "committedDate": "2020-01-02T11:23:52Z", "type": "commit"}, {"oid": "866e74b050af357b53797e451a2b9ab0a35b74e8", "url": "https://github.com/apache/skywalking/commit/866e74b050af357b53797e451a2b9ab0a35b74e8", "message": "Merge branch 'master' into feature/http-params", "committedDate": "2020-01-02T11:28:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ0NTI5Mg==", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362445292", "bodyText": "As far as I know, parallelStream() could cause high latency on high requests.", "author": "dmsolr", "createdAt": "2020-01-02T11:37:43Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/util/CollectionUtil.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.util;\n+\n+import java.util.Arrays;\n+import java.util.Map;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Some utility methods for collections.\n+ * Reinvent the wheels because importing third-party libs just for some methods is not worthwhile in agent side\n+ *\n+ * @author kezhenxu94\n+ * @since 7.0.0\n+ */\n+public final class CollectionUtil {\n+    public static String toString(final Map<String, String[]> map) {\n+        return map\n+            .entrySet()\n+            .parallelStream()", "originalCommit": "866e74b050af357b53797e451a2b9ab0a35b74e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "edb5f66d8560bcd677763d739f4db22f9aaad608", "url": "https://github.com/apache/skywalking/commit/edb5f66d8560bcd677763d739f4db22f9aaad608", "message": "Fix failed unit test", "committedDate": "2020-01-02T11:51:38Z", "type": "commit"}, {"oid": "bf1ee5025f50e7a1c4996052f5609997e97fb824", "url": "https://github.com/apache/skywalking/commit/bf1ee5025f50e7a1c4996052f5609997e97fb824", "message": "Fix failed plugin test", "committedDate": "2020-01-02T12:32:57Z", "type": "commit"}, {"oid": "bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04", "url": "https://github.com/apache/skywalking/commit/bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04", "message": "Merge branch 'master' into feature/http-params", "committedDate": "2020-01-02T12:33:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ2NTI4NQ==", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362465285", "bodyText": "Do we need to indicate this should work for UTF-8 encoding project? I think some vendors are using GBK in telecom, bank, etic", "author": "wu-sheng", "createdAt": "2020-01-02T13:02:16Z", "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -118,6 +118,8 @@ property key | Description | Default |\n `plugin.opgroup.*`|Support operation name customize group rules in different plugins. Read [Group rule supported plugins](op_name_group_rule.md)|Not set|\n `plugin.springtransaction.simplify_transaction_definition_name`|If true, the transaction definition name will be simplified.|false|\n `plugin.jdkthreading.threading_class_prefixes` | Threading classes (`java.lang.Runnable` and `java.util.concurrent.Callable`) and their subclasses, including anonymous inner classes whose name match any one of the `THREADING_CLASS_PREFIXES` (splitted by `,`) will be instrumented, make sure to only specify as narrow prefixes as what you're expecting to instrument, (`java.` and `javax.` will be ignored due to safety issues) | Not set |\n+`plugin.http.collect_http_params`| This config item controls that whether the plugins related to HTTP should collect the parameters of the request. The name `plugin.http.collect_http_params` is rather general, but it doesn't guarantee that all http plugins should be under its control, unless the plugin itself takes this config item into consideration, such as Tomcat, Spring MVC, and Armeria plugin. | `false` |", "originalCommit": "bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ3NTE5NQ==", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362475195", "bodyText": "Do we need to indicate this should work for UTF-8 encoding project? I think some vendors are using GBK in telecom, bank, etic\n\nI've modified the case to specify the encoding as GBK, and it works, still", "author": "kezhenxu94", "createdAt": "2020-01-02T13:38:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ2NTI4NQ=="}], "type": "inlineReview"}, {"oid": "ad47d6006bf2b8989263f6a32e451781024b2f37", "url": "https://github.com/apache/skywalking/commit/ad47d6006bf2b8989263f6a32e451781024b2f37", "message": "Add case when encoding is not UTF8 (say GBK)", "committedDate": "2020-01-02T13:37:17Z", "type": "commit"}, {"oid": "728d69fe4cdfaa73a45124cca3b404f8e1ca47bd", "url": "https://github.com/apache/skywalking/commit/728d69fe4cdfaa73a45124cca3b404f8e1ca47bd", "message": "Merge branch 'master' into feature/http-params", "committedDate": "2020-01-02T13:37:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ3NTY2OA==", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362475668", "bodyText": "@wu-sheng Here I meant", "author": "kezhenxu94", "createdAt": "2020-01-02T13:40:22Z", "path": "test/plugin/scenarios/spring-3.1.x-scenario/src/main/webapp/WEB-INF/web.xml", "diffHunk": "@@ -23,6 +23,20 @@\n          version=\"3.1\">\n     <display-name>skywalking-spring-3.1.x-scenario</display-name>\n \n+    <filter>\n+        <filter-name>setCharacterEncodingFilter</filter-name>\n+        <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n+        <init-param>\n+            <param-name>encoding</param-name>\n+            <param-value>GBK</param-value>\n+        </init-param>\n+    </filter>\n+\n+    <filter-mapping>\n+        <filter-name>setCharacterEncodingFilter</filter-name>\n+        <url-pattern>/*</url-pattern>\n+    </filter-mapping>\n+", "originalCommit": "728d69fe4cdfaa73a45124cca3b404f8e1ca47bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjUwODc4OQ==", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362508789", "bodyText": "Got it. Do we need to revert back? I don't want the GBK is a good example :)", "author": "wu-sheng", "createdAt": "2020-01-02T15:17:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ3NTY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjUxMzc3Mw==", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362513773", "bodyText": "Got it. Do we need to revert back? I don't want the GBK is a good example :)\n\nI\u2019m ok with both situations, will revert it", "author": "kezhenxu94", "createdAt": "2020-01-02T15:30:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ3NTY2OA=="}], "type": "inlineReview"}, {"oid": "6e4cf4b38eeea68a3a4871aa5fcfa9a1ec9517d1", "url": "https://github.com/apache/skywalking/commit/6e4cf4b38eeea68a3a4871aa5fcfa9a1ec9517d1", "message": "Update web.xml", "committedDate": "2020-01-02T15:31:47Z", "type": "commit"}, {"oid": "ce318b98d54069b01a87b39a12e69c933bc7163d", "url": "https://github.com/apache/skywalking/commit/ce318b98d54069b01a87b39a12e69c933bc7163d", "message": "Merge branch 'master' into feature/http-params", "committedDate": "2020-01-02T15:32:27Z", "type": "commit"}, {"oid": "6884f86a815e5c013d390441c4326a04cca97029", "url": "https://github.com/apache/skywalking/commit/6884f86a815e5c013d390441c4326a04cca97029", "message": "Update web.xml", "committedDate": "2020-01-02T15:33:39Z", "type": "commit"}]}