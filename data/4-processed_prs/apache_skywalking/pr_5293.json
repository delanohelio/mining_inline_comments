{"pr_number": 5293, "pr_title": "agent plugins selector", "pr_createdAt": "2020-08-11T05:52:53Z", "pr_url": "https://github.com/apache/skywalking/pull/5293", "timeline": [{"oid": "002f4c2573399a96649a64fb399dc8b7e80cd175", "url": "https://github.com/apache/skywalking/commit/002f4c2573399a96649a64fb399dc8b7e80cd175", "message": "add SuperDataset tag for add super size dataset shards config in es", "committedDate": "2020-05-16T09:46:41Z", "type": "commit"}, {"oid": "3fead29fe6379c1784feb1e21b28888266242d69", "url": "https://github.com/apache/skywalking/commit/3fead29fe6379c1784feb1e21b28888266242d69", "message": "explain the meaning of indexShardsNumber and superDatasetIndexShardsFactor", "committedDate": "2020-05-16T13:40:59Z", "type": "commit"}, {"oid": "f84bf3ea704ac9c0b7d751d6533d8ad25ba94625", "url": "https://github.com/apache/skywalking/commit/f84bf3ea704ac9c0b7d751d6533d8ad25ba94625", "message": "code style format", "committedDate": "2020-05-17T08:19:36Z", "type": "commit"}, {"oid": "b9c0d17a67d7213e7426b1449410700079b0ac2a", "url": "https://github.com/apache/skywalking/commit/b9c0d17a67d7213e7426b1449410700079b0ac2a", "message": "Merge branch 'master' into master", "committedDate": "2020-05-17T08:35:47Z", "type": "commit"}, {"oid": "f176bdbb28a466f0683d341d7b5eb1782068438f", "url": "https://github.com/apache/skywalking/commit/f176bdbb28a466f0683d341d7b5eb1782068438f", "message": "code style format", "committedDate": "2020-05-17T08:55:05Z", "type": "commit"}, {"oid": "34df4295c55fb7343a4e3e3dc86ff417d44f0010", "url": "https://github.com/apache/skywalking/commit/34df4295c55fb7343a4e3e3dc86ff417d44f0010", "message": "code style format and change notes", "committedDate": "2020-05-17T08:59:25Z", "type": "commit"}, {"oid": "e698ddf0b0d522894d94b4f1143210afabffd8d5", "url": "https://github.com/apache/skywalking/commit/e698ddf0b0d522894d94b4f1143210afabffd8d5", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-05-20T08:01:53Z", "type": "commit"}, {"oid": "52e21a287727aeffa241533f3c208a7b9c4fb215", "url": "https://github.com/apache/skywalking/commit/52e21a287727aeffa241533f3c208a7b9c4fb215", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-05-27T13:54:44Z", "type": "commit"}, {"oid": "87cc6a2c405f3b31deaf8d5a47f718edd6c0eee5", "url": "https://github.com/apache/skywalking/commit/87cc6a2c405f3b31deaf8d5a47f718edd6c0eee5", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-06-10T04:41:26Z", "type": "commit"}, {"oid": "39669e67a8b738f7cf5030b3277ddc1668a88835", "url": "https://github.com/apache/skywalking/commit/39669e67a8b738f7cf5030b3277ddc1668a88835", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-06-22T09:47:59Z", "type": "commit"}, {"oid": "172145bdc3ca85d0876cbd8f0b113c571fdb8c79", "url": "https://github.com/apache/skywalking/commit/172145bdc3ca85d0876cbd8f0b113c571fdb8c79", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-07-12T14:33:34Z", "type": "commit"}, {"oid": "2c32e00ae24a9f7ec30510ce292006172356a7cf", "url": "https://github.com/apache/skywalking/commit/2c32e00ae24a9f7ec30510ce292006172356a7cf", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-07-14T07:36:38Z", "type": "commit"}, {"oid": "7be9f078d9264919eb1158e31c39fb2c5c3fdd0d", "url": "https://github.com/apache/skywalking/commit/7be9f078d9264919eb1158e31c39fb2c5c3fdd0d", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-07-20T02:13:49Z", "type": "commit"}, {"oid": "9bf0783eb1f479ba7c17bc0d5c44c9a1fc3bfd40", "url": "https://github.com/apache/skywalking/commit/9bf0783eb1f479ba7c17bc0d5c44c9a1fc3bfd40", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-07-29T15:07:45Z", "type": "commit"}, {"oid": "2dd54c30375f24bc5f46f3a84a284893b0adb105", "url": "https://github.com/apache/skywalking/commit/2dd54c30375f24bc5f46f3a84a284893b0adb105", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-01T09:14:36Z", "type": "commit"}, {"oid": "3d67538404afe862216472843f94ec376bbd7a14", "url": "https://github.com/apache/skywalking/commit/3d67538404afe862216472843f94ec376bbd7a14", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-09T14:50:36Z", "type": "commit"}, {"oid": "b87c3de4b9ef94ef82d3a01f43e3ad3e0663dbce", "url": "https://github.com/apache/skywalking/commit/b87c3de4b9ef94ef82d3a01f43e3ad3e0663dbce", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-10T06:55:52Z", "type": "commit"}, {"oid": "de1c3a89eae512f6dde4275856a3d42107c61794", "url": "https://github.com/apache/skywalking/commit/de1c3a89eae512f6dde4275856a3d42107c61794", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-11T03:31:37Z", "type": "commit"}, {"oid": "fe3b139fab9516ef4c6f5c29ecce140d7677ff94", "url": "https://github.com/apache/skywalking/commit/fe3b139fab9516ef4c6f5c29ecce140d7677ff94", "message": "plugin selector for common agent packages", "committedDate": "2020-08-11T05:47:47Z", "type": "commit"}, {"oid": "206e096125befaf9b8dbc76a616a7e88026728fc", "url": "https://github.com/apache/skywalking/commit/206e096125befaf9b8dbc76a616a7e88026728fc", "message": "plugin excludes selector", "committedDate": "2020-08-11T06:54:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM2NzMzMw==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r468367333", "bodyText": "You forgot to update the name includes, should be excludes", "author": "kezhenxu94", "createdAt": "2020-08-11T07:00:56Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/plugin/PluginSelector.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.plugin;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import static org.apache.skywalking.apm.agent.core.conf.Config.Plugin.EXCLUDE_PLUGINS;\n+\n+public class PluginSelector {\n+\n+    public List<PluginDefine> select(List<PluginDefine> pluginDefines) {\n+        if (!EXCLUDE_PLUGINS.isEmpty()) {\n+            List<String> includes = Arrays.asList(EXCLUDE_PLUGINS.toLowerCase().split(\",\"));", "originalCommit": "206e096125befaf9b8dbc76a616a7e88026728fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM3MTAyOA==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r468371028", "bodyText": "fix", "author": "EvanLjp", "createdAt": "2020-08-11T07:09:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM2NzMzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM2Nzg2Nw==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r468367867", "bodyText": "This config item should go to the doc as well", "author": "kezhenxu94", "createdAt": "2020-08-11T07:02:22Z", "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -90,3 +90,6 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # Kafka producer configuration\n plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n+\n+# elclude some plugins which define in plugins dir,\n+plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:\"\"}", "originalCommit": "206e096125befaf9b8dbc76a616a7e88026728fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM3MTk5Mw==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r468371993", "bodyText": "add doc", "author": "EvanLjp", "createdAt": "2020-08-11T07:11:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM2Nzg2Nw=="}], "type": "inlineReview"}, {"oid": "1df99ab9f95b04bedfe8e2dc8661ca8466f491c4", "url": "https://github.com/apache/skywalking/commit/1df99ab9f95b04bedfe8e2dc8661ca8466f491c4", "message": "plugin excludes selector doc", "committedDate": "2020-08-11T07:08:53Z", "type": "commit"}, {"oid": "433408a6c0689df93634011e1412b135e493856c", "url": "https://github.com/apache/skywalking/commit/433408a6c0689df93634011e1412b135e493856c", "message": "add agent plugin list doc", "committedDate": "2020-08-12T02:57:04Z", "type": "commit"}, {"oid": "6951f589a7f9e9c29306af69979abe7e426f0494", "url": "https://github.com/apache/skywalking/commit/6951f589a7f9e9c29306af69979abe7e426f0494", "message": "Merge branch 'master' into activate-plugins", "committedDate": "2020-08-12T03:33:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNTgxOQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469105819", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * Excludes some plugins which define in plugins dir\n          \n          \n            \n                     * Exclude activated plugins", "author": "wu-sheng", "createdAt": "2020-08-12T08:49:43Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -266,6 +266,11 @@\n          * Control the length of the peer field.\n          */\n         public static int PEER_MAX_LENGTH = 200;\n+\n+        /**\n+         * Excludes some plugins which define in plugins dir", "originalCommit": "6951f589a7f9e9c29306af69979abe7e426f0494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4NzY5MA==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469287690", "bodyText": "fix", "author": "EvanLjp", "createdAt": "2020-08-12T14:09:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNTgxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNjA5OQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469106099", "bodyText": "Comments required.", "author": "wu-sheng", "createdAt": "2020-08-12T08:50:08Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/plugin/PluginSelector.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.plugin;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import static org.apache.skywalking.apm.agent.core.conf.Config.Plugin.EXCLUDE_PLUGINS;\n+\n+public class PluginSelector {", "originalCommit": "6951f589a7f9e9c29306af69979abe7e426f0494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4NzY0Ng==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469287646", "bodyText": "fix", "author": "EvanLjp", "createdAt": "2020-08-12T14:09:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNjA5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTc3NA==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469109774", "bodyText": "Don't open this in default.", "author": "wu-sheng", "createdAt": "2020-08-12T08:56:03Z", "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -90,3 +90,6 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # Kafka producer configuration\n plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n+\n+# exclude some plugins define in plugins dir\n+plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:\"\"}", "originalCommit": "6951f589a7f9e9c29306af69979abe7e426f0494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4NzYwMQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469287601", "bodyText": "fix", "author": "EvanLjp", "createdAt": "2020-08-12T14:09:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTc3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNzE1MA==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469117150", "bodyText": "@kezhenxu94 Do you have any change to use some mechanisms to check this? Such as building a mock agent core main?", "author": "wu-sheng", "createdAt": "2020-08-12T09:08:57Z", "path": "docs/en/setup/service-agent/java-agent/Plugin-list.md", "diffHunk": "@@ -0,0 +1,101 @@\n+- Skywalking Agent List\n+    - activemq-5.x\n+    - armeria-063-084\n+    - armeria-085\n+    - armeria-086\n+    - armeria-098\n+    - avro-1.x\n+    - brpc-java\n+    - canal-1.x\n+    - cassandra-java-driver-3.x\n+    - dubbo\n+    - ehcache-2.x\n+    - elastic-job-2.x\n+    - elastic-job-3.x\n+    - elasticsearch-5.x\n+    - elasticsearch-6.x\n+    - feign-default-http-9.x\n+    - feign-pathvar-9.x\n+    - finagle\n+    - graphql\n+    - grpc-1.x\n+    - gson-2.8.x\n+    - h2-1.x\n+    - hbase-1.x\n+    - httpasyncclient-4.x\n+    - httpclient-3.x\n+    - httpclient-4.x\n+    - hystrix-1.x\n+    - influxdb-2.x\n+    - jdk-http-plugin\n+    - jdk-threading-plugin\n+    - jedis-2.x\n+    - jetty-client-9.0\n+    - jetty-client-9.x\n+    - jetty-server-9.x\n+    - kafka-0.11.x/1.x/2.x\n+    - kotlin-coroutine\n+    - lettuce-5.x\n+    - light4j\n+    - mariadb-2.x\n+    - memcache-2.x\n+    - mongodb-2.x\n+    - mongodb-3.x\n+    - motan-0.x\n+    - mysql-5.x\n+    - mysql-6.x\n+    - mysql-8.x\n+    - netty-socketio\n+    - nutz-http-1.x\n+    - nutz-mvc-annotation-1.x\n+    - okhttp-3.x\n+    - play-2.x\n+    - postgresql-8.x\n+    - pulsar\n+    - quasar\n+    - rabbitmq-5.x\n+    - redisson-3.x\n+    - resteasy-server-3.x\n+    - rocketMQ-3.x\n+    - rocketMQ-4.x\n+    - servicecomb-0.x\n+    - servicecomb-1.x\n+    - sharding-jdbc-1.5.x\n+    - sharding-sphere-3.x\n+    - sharding-sphere-4.0.0\n+    - sharding-sphere-4.1.0\n+    - sharding-sphere-4.x\n+    - sharding-sphere-4.x-rc3\n+    - sofarpc\n+    - solrj-7.x\n+    - spring-annotation\n+    - spring-async-annotation-5.x\n+    - spring-cloud-feign-1.x\n+    - spring-cloud-feign-2.x\n+    - spring-cloud-gateway-2.0.x\n+    - spring-cloud-gateway-2.1.x\n+    - spring-concurrent-util-4.x\n+    - spring-core-patch\n+    - spring-kafka-2.x\n+    - spring-mvc-annotation\n+    - spring-mvc-annotation-3.x\n+    - spring-mvc-annotation-4.x\n+    - spring-mvc-annotation-5.x\n+    - spring-resttemplate-4.x\n+    - spring-tx\n+    - spring-webflux-5.x\n+    - spymemcached-2.x\n+    - struts2-2.x\n+    - tomcat-7.x/8.x\n+    - toolkit-counter\n+    - toolkit-gauge\n+    - toolkit-histogram\n+    - toolkit-log4j\n+    - toolkit-log4j2\n+    - toolkit-logback\n+    - toolkit-opentracing\n+    - toolkit-tag\n+    - toolkit-trace\n+    - undertow-2.x-plugin\n+    - vertx-core-3.x\n+    - zookeeper-3.4.x   ", "originalCommit": "6951f589a7f9e9c29306af69979abe7e426f0494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI5NTU1OQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469295559", "bodyText": "possible", "author": "kezhenxu94", "createdAt": "2020-08-12T14:20:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNzE1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwMDExOQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469300119", "bodyText": "the list is got from my shell tools, already push", "author": "EvanLjp", "createdAt": "2020-08-12T14:26:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNzE1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExOTE0MQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469119141", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # exclude some plugins define in plugins dir\n          \n          \n            \n            # Exclude activated plugins", "author": "wu-sheng", "createdAt": "2020-08-12T09:12:19Z", "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -90,3 +90,6 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # Kafka producer configuration\n plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n+\n+# exclude some plugins define in plugins dir", "originalCommit": "6951f589a7f9e9c29306af69979abe7e426f0494", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4NzU0Ng==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469287546", "bodyText": "fix", "author": "EvanLjp", "createdAt": "2020-08-12T14:09:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExOTE0MQ=="}], "type": "inlineReview"}, {"oid": "dcad9cc044aa0bccdd495453b42015c1ea5d7d14", "url": "https://github.com/apache/skywalking/commit/dcad9cc044aa0bccdd495453b42015c1ea5d7d14", "message": "fix some nits", "committedDate": "2020-08-12T14:07:01Z", "type": "commit"}, {"oid": "a0bd235338b8d8c4a188c4aefa2a2496e6936fb8", "url": "https://github.com/apache/skywalking/commit/a0bd235338b8d8c4a188c4aefa2a2496e6936fb8", "message": "Merge branch 'activate-plugins' of https://github.com/EvanLjp/skywalking into activate-plugins", "committedDate": "2020-08-12T14:07:41Z", "type": "commit"}, {"oid": "e2cb9d776c1b7e230388975a6f8ba54222ee87a7", "url": "https://github.com/apache/skywalking/commit/e2cb9d776c1b7e230388975a6f8ba54222ee87a7", "message": "Merge remote-tracking branch 'upstream/master' into activate-plugins", "committedDate": "2020-08-12T14:08:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjg0MQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469312841", "bodyText": "@kezhenxu94 Please review this script.\n@EvanLjp Tool script should be used in the CI process. Like the license check script. Check the result with the markdown document, make sure the new contributors have updated the doc.", "author": "wu-sheng", "createdAt": "2020-08-12T14:43:46Z", "path": "tools/plugin/scan-agent-plugins.sh", "diffHunk": "@@ -0,0 +1,39 @@\n+#!/usr/bin/env bash", "originalCommit": "e2cb9d776c1b7e230388975a6f8ba54222ee87a7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTM2NzM4Mw==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469367383", "bodyText": "LGTM except for the code style", "author": "dmsolr", "createdAt": "2020-08-12T15:56:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjg0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTM3Mjg5Mg==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469372892", "bodyText": "@kezhenxu94 Please review this script.\n@EvanLjp Tool script should be used in the CI process. Like the license check script. Check the result with the markdown document, make sure the new contributors have updated the doc.\n\nRefer to the check-LICENSE.sh script, your scrip is expected to be rewrote to check actual plugin list and the md doc, instead of simply generating a list, of course you can print the diff so that one knows what's wrong when running your script, another tip is to put this check at the very beginning of the CI stages, because it's more lightweight and doesn't depends on the final tar (while check-LICENSE.sh does)", "author": "kezhenxu94", "createdAt": "2020-08-12T16:04:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjg0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY5OTM2NQ==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469699365", "bodyText": "push again, the script looks like check-LICENSE.sh", "author": "EvanLjp", "createdAt": "2020-08-13T05:07:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjg0MQ=="}], "type": "inlineReview"}, {"oid": "71a0a4320d6238091ad3793571b1bbd11bd54e9c", "url": "https://github.com/apache/skywalking/commit/71a0a4320d6238091ad3793571b1bbd11bd54e9c", "message": "add check-javaagent-plugin-list.sh", "committedDate": "2020-08-13T04:59:49Z", "type": "commit"}, {"oid": "32e14700cf474c03a92a0f60d9765cf15e4ed035", "url": "https://github.com/apache/skywalking/commit/32e14700cf474c03a92a0f60d9765cf15e4ed035", "message": "Merge remote-tracking branch 'upstream/master' into activate-plugins", "committedDate": "2020-08-13T05:05:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc1NzQzMg==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469757432", "bodyText": "Need to pay attention on the details.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            #  Exclude activated plugins\n          \n          \n            \n            #plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:\"\"}\n          \n          \n            \n            # Exclude activated plugins\n          \n          \n            \n            # plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:\"\"}", "author": "wu-sheng", "createdAt": "2020-08-13T07:40:44Z", "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -90,3 +90,5 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # Kafka producer configuration\n # plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n+#  Exclude activated plugins\n+#plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:\"\"}", "originalCommit": "32e14700cf474c03a92a0f60d9765cf15e4ed035", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc1ODI2MA==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r469758260", "bodyText": "thx", "author": "EvanLjp", "createdAt": "2020-08-13T07:42:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc1NzQzMg=="}], "type": "inlineReview"}, {"oid": "dd1f1c7e689aaab4f2a5cffa90942dc6a3fb4a6c", "url": "https://github.com/apache/skywalking/commit/dd1f1c7e689aaab4f2a5cffa90942dc6a3fb4a6c", "message": "format", "committedDate": "2020-08-13T07:42:47Z", "type": "commit"}, {"oid": "44f158c362d453e7fa9b926212b6c3517fd7d254", "url": "https://github.com/apache/skywalking/commit/44f158c362d453e7fa9b926212b6c3517fd7d254", "message": "Update apm-sniffer/config/agent.config\r\n\r\nFix format.", "committedDate": "2020-08-13T07:49:10Z", "type": "commit"}, {"oid": "b89f822f9ae6bcf583c6d4ac2fef1bdaf5a5d8e5", "url": "https://github.com/apache/skywalking/commit/b89f822f9ae6bcf583c6d4ac2fef1bdaf5a5d8e5", "message": "Merge branch 'master' into activate-plugins", "committedDate": "2020-08-13T08:08:57Z", "type": "commit"}, {"oid": "d3a81b84581a0698bdfd2ccb369e819bf126a356", "url": "https://github.com/apache/skywalking/commit/d3a81b84581a0698bdfd2ccb369e819bf126a356", "message": "add ci process", "committedDate": "2020-08-13T09:19:00Z", "type": "commit"}, {"oid": "c4d220658588e65b928b1a3e364275ed6816bc8c", "url": "https://github.com/apache/skywalking/commit/c4d220658588e65b928b1a3e364275ed6816bc8c", "message": "Merge branch 'activate-plugins' of https://github.com/EvanLjp/skywalking into activate-plugins", "committedDate": "2020-08-13T09:20:33Z", "type": "commit"}, {"oid": "eaa19e18182e8cf9ea9984068cfd16fe01225cf3", "url": "https://github.com/apache/skywalking/commit/eaa19e18182e8cf9ea9984068cfd16fe01225cf3", "message": "chmod +x check-javaagent-plugin-list.sh", "committedDate": "2020-08-13T12:03:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwMTEzNw==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470001137", "bodyText": "should pass this exit code to the end of the script, the CI status depends on the final exit code, 0 == success, otherwise == failure", "author": "kezhenxu94", "createdAt": "2020-08-13T14:37:42Z", "path": "tools/plugin/check-javaagent-plugin-list.sh", "diffHunk": "@@ -0,0 +1,51 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+\n+SRC_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\n+WORK_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" &&cd ../.. && pwd)\"\n+GENERNATE_PLUGINS_LIST=${SRC_DIR}/genernate-javaagent-plugin-list.txt\n+MD_PLUGINS_LIST=${SRC_DIR}/md-javaagent-plugin-list.txt\n+\n+function genernateJavaagentPluginList() {\n+    position_file=\"javaagent-position.txt\"\n+    find ${WORK_DIR}/apm-sniffer -name \"skywalking-plugin.def\"|grep \"src/main/resources\" > ${position_file}\n+    cat ${position_file} | while read line\n+    do\n+        cat ${line}|grep -v \"#\"|grep -v \"^$\"|awk -F \"=\" '{print $1}' >> temp.txt\n+    done\n+    cat temp.txt|sort|uniq|awk NF  > ${GENERNATE_PLUGINS_LIST}\n+    rm -rf temp.txt\n+}\n+\n+function getMdJavaagentPluginList() {\n+    md_javaagent_plugins_file=${WORK_DIR}/docs/en/setup/service-agent/java-agent/Plugin-list.md\n+    cat  ${md_javaagent_plugins_file}|grep -v \"#\" |awk -F \" \" '{ print $2}'|sort >${MD_PLUGINS_LIST}\n+}\n+\n+function checkDiff() {\n+    diff -w -bB -U0 ${MD_PLUGINS_LIST} ${GENERNATE_PLUGINS_LIST}", "originalCommit": "eaa19e18182e8cf9ea9984068cfd16fe01225cf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwMjU1Mw==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470002553", "bodyText": "yes,already fix,try again", "author": "EvanLjp", "createdAt": "2020-08-13T14:39:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwMTEzNw=="}], "type": "inlineReview"}, {"oid": "c1281d127ec78ae5f0d7bc8f8ba16859d30c391b", "url": "https://github.com/apache/skywalking/commit/c1281d127ec78ae5f0d7bc8f8ba16859d30c391b", "message": "fix ci script tool", "committedDate": "2020-08-13T14:38:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwNTA4Ng==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470005086", "bodyText": "I suggest to move this to the beginning of the the steps (line 42) because this script is more lightweight that can fail quickly, and thus prevents unnecessary Install & Test, Install & Test is much more expensive", "author": "kezhenxu94", "createdAt": "2020-08-13T14:43:10Z", "path": ".github/workflows/ci-it.yaml", "diffHunk": "@@ -45,6 +45,8 @@ jobs:\n           bash <(curl -s https://codecov.io/bash)\n       - name: 'Check Dependencies Licenses'\n         run: tools/dependencies/check-LICENSE.sh\n+      - name: 'Check Javaagent Plugin List'\n+        run: tools/plugin/check-javaagent-plugin-list.sh", "originalCommit": "c1281d127ec78ae5f0d7bc8f8ba16859d30c391b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwNjY1Mg==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470006652", "bodyText": "Make sense, it could fail fast.", "author": "wu-sheng", "createdAt": "2020-08-13T14:45:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwNTA4Ng=="}], "type": "inlineReview"}, {"oid": "978e1b06b189a0c9d303cf3ec966cc2dfbca7f69", "url": "https://github.com/apache/skywalking/commit/978e1b06b189a0c9d303cf3ec966cc2dfbca7f69", "message": "move position", "committedDate": "2020-08-13T14:56:05Z", "type": "commit"}, {"oid": "1a20492dcf4447a9abf21cfc2e17b42ca01e6a94", "url": "https://github.com/apache/skywalking/commit/1a20492dcf4447a9abf21cfc2e17b42ca01e6a94", "message": "Merge branch 'master' into activate-plugins", "committedDate": "2020-08-13T16:23:41Z", "type": "commit"}, {"oid": "f67f493b9bfc82e867fe82a1f3832295855dea74", "url": "https://github.com/apache/skywalking/commit/f67f493b9bfc82e867fe82a1f3832295855dea74", "message": "fix plugin list doc", "committedDate": "2020-08-14T00:46:10Z", "type": "commit"}, {"oid": "085739e693ed5f58d517f1e1d574de4629cf7639", "url": "https://github.com/apache/skywalking/commit/085739e693ed5f58d517f1e1d574de4629cf7639", "message": "fix script", "committedDate": "2020-08-14T02:16:20Z", "type": "commit"}, {"oid": "5d158ae46d7e47e61e5e10897677693ffb3f8340", "url": "https://github.com/apache/skywalking/commit/5d158ae46d7e47e61e5e10897677693ffb3f8340", "message": "add echo", "committedDate": "2020-08-14T03:05:39Z", "type": "commit"}, {"oid": "4e802435935d853bda3ddf2011a4713065cb8a1c", "url": "https://github.com/apache/skywalking/commit/4e802435935d853bda3ddf2011a4713065cb8a1c", "message": "remove rm", "committedDate": "2020-08-14T04:32:11Z", "type": "commit"}, {"oid": "a2a002056b57dae6a4647d991b381a4e3ee55550", "url": "https://github.com/apache/skywalking/commit/a2a002056b57dae6a4647d991b381a4e3ee55550", "message": "test script", "committedDate": "2020-08-14T04:46:18Z", "type": "commit"}, {"oid": "ce1f724e4501952092a094068dbaa4479a7901ef", "url": "https://github.com/apache/skywalking/commit/ce1f724e4501952092a094068dbaa4479a7901ef", "message": "test", "committedDate": "2020-08-14T05:35:37Z", "type": "commit"}, {"oid": "941c3ecddb0e0e54098b50a58ac5967196abbf92", "url": "https://github.com/apache/skywalking/commit/941c3ecddb0e0e54098b50a58ac5967196abbf92", "message": "Merge branch 'master' into activate-plugins", "committedDate": "2020-08-14T05:54:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MDEyNA==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470440124", "bodyText": "What are you testing? I think we need the exit code to fail the CI process.", "author": "wu-sheng", "createdAt": "2020-08-14T06:45:02Z", "path": "tools/plugin/check-javaagent-plugin-list.sh", "diffHunk": "@@ -41,10 +41,5 @@ function getMdJavaagentPluginList() {\n genernateJavaagentPluginList\n getMdJavaagentPluginList\n diff -w -bB -U0 ${MD_PLUGINS_LIST} ${GENERNATE_PLUGINS_LIST}\n-status=$?\n-echo ${status}\n-rm -rf  ${MD_PLUGINS_LIST}\n-rm -rf ${GENERNATE_PLUGINS_LIST}\n-[[ ${status} -ne 0 ]] && exit ${status}", "originalCommit": "ce1f724e4501952092a094068dbaa4479a7901ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MDM4Mg==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470440382", "bodyText": "We need the thing you deleted.", "author": "wu-sheng", "createdAt": "2020-08-14T06:45:43Z", "path": "tools/plugin/check-javaagent-plugin-list.sh", "diffHunk": "@@ -0,0 +1,45 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+\n+SRC_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\n+WORK_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" &&cd ../.. && pwd)\"\n+GENERNATE_PLUGINS_LIST=${SRC_DIR}/genernate-javaagent-plugin-list.txt\n+MD_PLUGINS_LIST=${SRC_DIR}/md-javaagent-plugin-list.txt\n+\n+function genernateJavaagentPluginList() {\n+    position_file=\"javaagent-position.txt\"\n+    find ${WORK_DIR}/apm-sniffer -name \"skywalking-plugin.def\"|grep \"src/main/resources\" > ${position_file}\n+    cat ${position_file} | while read line\n+    do\n+        cat ${line}|grep -v \"#\"|awk -F \"=\" '{print $1}' >> temp.txt\n+    done\n+    cat temp.txt|sort|uniq|awk NF|grep -E '^[a-z].*'  > ${GENERNATE_PLUGINS_LIST}\n+    rm -rf temp.txt\n+}\n+\n+function getMdJavaagentPluginList() {\n+    md_javaagent_plugins_file=${WORK_DIR}/docs/en/setup/service-agent/java-agent/Plugin-list.md\n+    cat  ${md_javaagent_plugins_file}|grep -v \"#\" |awk -F \" \" '{ print $2}'|grep -E '^[a-z].*'|sort|uniq|awk NF >${MD_PLUGINS_LIST}\n+}\n+\n+genernateJavaagentPluginList\n+getMdJavaagentPluginList\n+diff -w -bB -U0 ${MD_PLUGINS_LIST} ${GENERNATE_PLUGINS_LIST}", "originalCommit": "941c3ecddb0e0e54098b50a58ac5967196abbf92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MjkyNg==", "url": "https://github.com/apache/skywalking/pull/5293#discussion_r470442926", "bodyText": "The exit code of the last line of script will serve as the final exit code of the entire script, it's ok here", "author": "kezhenxu94", "createdAt": "2020-08-14T06:52:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MDM4Mg=="}], "type": "inlineReview"}]}