{"pr_number": 5426, "pr_title": "exception-ignore-plugin", "pr_createdAt": "2020-09-01T16:04:33Z", "pr_url": "https://github.com/apache/skywalking/pull/5426", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUyNjY2NA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481526664", "bodyText": "This could be overridden, such as two exceptions happened.", "author": "wu-sheng", "createdAt": "2020-09-02T01:27:06Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/AbstractTracingSpan.java", "diffHunk": "@@ -96,6 +99,8 @@\n      */\n     protected boolean skipAnalysis;\n \n+    protected String exceptionKind = \"\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTYwMTEzOQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481601139", "bodyText": "in local span only may be 1 exception at most\nmany exceptions log may be only entry span or exist span.\n(entry1)-->(entry2)-->(local3)-->(exit4)-->(exit5)\nthe exceptions in entry2,entry3,entry4 should be thought as exception Kind.\nthe exceptions in entry1,exit5 should not be thought as exception kind.\nhow do u think about it?", "author": "EvanLjp", "createdAt": "2020-09-02T03:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUyNjY2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY2MzkxMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481663911", "bodyText": "Whether one or mutiple error logs are based on plugin, not core. They didn't say that API is allowed to be called max once per span in any document", "author": "wu-sheng", "createdAt": "2020-09-02T04:28:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUyNjY2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUyNzQyNA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481527424", "bodyText": "Adding two methods in the core level is unexpected. Usually, the span APIs are not providing capabilities to read fields.", "author": "wu-sheng", "createdAt": "2020-09-02T01:28:22Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/AbstractSpan.java", "diffHunk": "@@ -62,6 +62,10 @@\n \n     AbstractSpan errorOccurred();\n \n+    AbstractSpan undoErrorOccurred();\n+\n+    String exceptionKind();", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481545006", "bodyText": "We can't do this in the agent, because some classes are not in this classloader, such as in Tomcat case, all user exception classes can't be scanned.", "author": "wu-sheng", "createdAt": "2020-09-02T01:55:54Z", "path": "apm-sniffer/optional-plugins/exception-ignore-plugin/src/main/java/org/apache/skywalking/apm/plugin/exception/ignore/ExceptionIgnorerService.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.exception.ignore;\n+\n+import com.google.common.collect.ImmutableSet;\n+import com.google.common.reflect.ClassPath;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.context.DefaultExceptionIgnorerService;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n+import org.apache.skywalking.apm.agent.core.plugin.PluginBootstrap;\n+import org.apache.skywalking.apm.toolkit.trace.IgnoredException;\n+import org.apache.skywalking.apm.util.StringUtil;\n+\n+import static org.apache.skywalking.apm.plugin.exception.ignore.ExceptionAnalyzerConfig.Plugin.IgnoredException.IGNORED_EXCEPTION_CLASS_NAMES;\n+import static org.apache.skywalking.apm.plugin.exception.ignore.ExceptionAnalyzerConfig.Plugin.IgnoredException.IGNORED_EXCEPTION_SCAN_SCOPE;\n+\n+@OverrideImplementor(DefaultExceptionIgnorerService.class)\n+public class ExceptionIgnorerService extends DefaultExceptionIgnorerService {\n+\n+    private final Set<String> exceptionClassNames = new HashSet<>();\n+\n+    @Override\n+    public void prepare() throws Throwable {\n+        if (StringUtil.isNotEmpty(IGNORED_EXCEPTION_CLASS_NAMES)) {\n+            exceptionClassNames.addAll(Arrays.asList(IGNORED_EXCEPTION_CLASS_NAMES.split(\",\")));\n+        }\n+        if (StringUtil.isNotEmpty(IGNORED_EXCEPTION_SCAN_SCOPE)) {\n+            ClassPath classpath = ClassPath.from(PluginBootstrap.class.getClassLoader());\n+            ImmutableSet<ClassPath.ClassInfo> classes = classpath.getTopLevelClasses(IGNORED_EXCEPTION_SCAN_SCOPE);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU4NTUzMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481585531", "bodyText": "I've done this before in inner apm system,there is some thinking about this feature.\n\nthe package classes scan is only for the exceptions tagged with @IgnoredException in  user code,so we don't need to scan all classes.PluginBootstrap.class.getClassLoader() have been meet the demand.\nIf some exception defined in other lib which out of user control, the exceptions cannot be tagged be @IgnoredException,so package scan scope is no sense to it. the kind of exception should be ignored by hard code config.\n\nIn my mind , user would be like to add a new  ignored exception by @IgnoredException annotation rather than change skywalking agent config frequency.\nHow do you think about it? @wu-sheng", "author": "EvanLjp", "createdAt": "2020-09-02T02:59:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTYyODAxNw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481628017", "bodyText": "In my mind , user would be like to add a new ignored exception by @IgnoredException annotation rather than change skywalking agent config frequency.\n\nI don't agree, for those exceptions thrown by some frameworks, users cannot do anything to ignore them but only change the agent config, and I suppose that's a common case where users want to ignore exceptions from frameworks, if they have control to where the exceptions are thrown, they can choose not to throw the exceptions and only log some errors", "author": "kezhenxu94", "createdAt": "2020-09-02T03:51:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTYzNjAyMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481636021", "bodyText": "I don't agree, for those exceptions thrown by some frameworks, users cannot do anything to ignore them but only change the agent config\n\nyes, that is the 2 point what i thought.\n\n2. If some exception defined in other lib which out of user control, the exceptions cannot be tagged be @IgnoredException,so package scan scope is no sense to it. the kind of exception should be ignored by hard code config.\n\nmy option is @IgnoredException is more friendly to use in user service code.\n\n\nthe package classes scan is only for the exceptions tagged with @IgnoredException in  user code,so we don't need to scan all classes.PluginBootstrap.class.getClassLoader() have been meet the demand.", "author": "EvanLjp", "createdAt": "2020-09-02T03:59:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY0MDQ3Ng==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481640476", "bodyText": "the package classes scan is only for the exceptions tagged with @IgnoredException in user code,so we don't need to scan all classes.PluginBootstrap.class.getClassLoader() have been meet the demand.\n\nThat would not be the case. Once you open @IgnoredException you can't tell where it will be used. PluginBootstrap.class.getClassLoader() wouldn't be able to access many classes when you use the standard J2EE container. Scan tech is not allowed in the agent core stack or plugin stack.", "author": "wu-sheng", "createdAt": "2020-09-02T04:04:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY0MTY5MA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481641690", "bodyText": "User code is the wrong statement. All codes are user codes from the agent's perspective. And the user could have a class loader, the framework could have a class loader.", "author": "wu-sheng", "createdAt": "2020-09-02T04:05:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY1NDk1NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481654955", "bodyText": "this would be cause so many problems.\n\nPluginBootstrap.class.getClassLoader() is application classloader, cannot access custom classloder classes.\nSo we cannot to solve it but for to judge it at run time,for excample have following steps.\n2.1 find classes in every call by the hard config\n2.2 check the status\nI don't know if this has a performance impact when find classes instance every time\n\n@wu-sheng @kezhenxu94\nDo you have any ideas to implement this feature?", "author": "EvanLjp", "createdAt": "2020-09-02T04:19:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY1Njc3OA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481656778", "bodyText": "That is why, I asked you don't do the scan for class match. You should determine the flow after exception happens and logs.", "author": "wu-sheng", "createdAt": "2020-09-02T04:21:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY3MzA0Ng==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481673046", "bodyText": "PluginBootstrap.class.getClassLoader() is application classloader, cannot access custom classloder classes.\n\n\nIf you check the exception only when it's thrown(in the Span#log(Throwable e)), you can simply use the same class loader (i.e. e.getClass().getClassLoader()) to load the configured class by name\n\n\nSo we cannot to solve it but for to judge it at run time,for excample have following steps.\n2.1 find classes in every call by the hard config\n2.2 check the status\nI don't know if this has a performance impact when find classes instance every time\n\n\nSome simple caching should be enough, I don't think the Ignored Exception list would be very long", "author": "kezhenxu94", "createdAt": "2020-09-02T04:37:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY3ODMzMA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r481678330", "bodyText": "it's almost similar to a custom implement skywalking plugin in our company, i would push it laster,thx\n\nSome simple caching should be enough, I don't think the Ignored Exception list would be very long", "author": "EvanLjp", "createdAt": "2020-09-02T04:43:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTU0NTAwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwMzk3Mg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482103972", "bodyText": "Why still use annotation?", "author": "wu-sheng", "createdAt": "2020-09-02T14:16:22Z", "path": "apm-application-toolkit/apm-toolkit-trace/src/main/java/org/apache/skywalking/apm/toolkit/trace/IgnoredException.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.toolkit.trace;\n+\n+import java.lang.annotation.Documented;\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * the annotation is declared on business exception class\n+ **/\n+@Target(ElementType.TYPE)\n+@Retention(RetentionPolicy.RUNTIME)\n+@Documented\n+public @interface IgnoredException {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNDAwOQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482104009", "bodyText": "This depedency is not allowed, related to you are still using annotation.", "author": "wu-sheng", "createdAt": "2020-09-02T14:16:26Z", "path": "apm-sniffer/apm-agent-core/pom.xml", "diffHunk": "@@ -53,6 +53,11 @@\n     </properties>\n \n     <dependencies>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-toolkit-trace</artifactId>\n+            <version>8.2.0-SNAPSHOT</version>\n+        </dependency>", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEzMzc3OA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482133778", "bodyText": "If i was a user,i would to add ignore exception by annotation,this would be easy to control rather than change env config frequency. in our department,skywalking is throught as a platform, env is a only way to custom config.But env config is out of user code config, user would not like to frequency config.Env should keep stable.\nthat is why i want to keep annotation . Could i extract a common light sdk for tookit and agent together?", "author": "EvanLjp", "createdAt": "2020-09-02T14:54:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNDAwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMTc4Mg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482631782", "bodyText": "If you want to use annotation, consider using toolkit + activation mode. My point is, the core should not depend on the toolkit. It is not safe in the class loader manipulation.", "author": "wu-sheng", "createdAt": "2020-09-03T01:01:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNDAwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNTQ0NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482105445", "bodyText": "Should this be removed?", "author": "wu-sheng", "createdAt": "2020-09-02T14:18:23Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/DefaultExceptionIgnorerService.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context;\n+\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultImplementor;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n+\n+@DefaultImplementor\n+public class DefaultExceptionIgnorerService implements ExceptionIgnorer, BootService {\n+\n+    @Override\n+    public void prepare() throws Throwable {\n+\n+    }\n+\n+    @Override\n+    public void boot() throws Throwable {\n+\n+    }\n+\n+    @Override\n+    public void onComplete() throws Throwable {\n+\n+    }\n+\n+    @Override\n+    public void shutdown() throws Throwable {\n+\n+    }\n+\n+    @Override\n+    public AbstractTracingSpan ignore(final AbstractTracingSpan span) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjExMjA4OQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482112089", "bodyText": "yes", "author": "EvanLjp", "createdAt": "2020-09-02T14:26:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNTQ0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEzMTkzOA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482131938", "bodyText": "i would remove the past version codes if the idea of this version is passed", "author": "EvanLjp", "createdAt": "2020-09-02T14:52:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNTQ0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNjc5Nw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482106797", "bodyText": "I still don't like the idea use the annotation.\n\nThe toolkit classes are in the user class loader zone, you can't assume it is usable in the agent core.\nWhy simply use the exception name string match? This is much safer and easier than this.\nLike (2), the exception class could be cached.", "author": "wu-sheng", "createdAt": "2020-09-02T14:20:09Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.lang.annotation.Annotation;\n+import java.util.HashSet;\n+import java.util.Objects;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class AnnotationMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final HashSet<Class<? extends Throwable>> ignoredExceptions = new HashSet<>(16);\n+\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        if (ignoredExceptions.contains(e.getClass())) {\n+            return false;\n+        }\n+        StatusCheckService statusTriggerService = ServiceManager.INSTANCE.findService(StatusCheckService.class);\n+        Class<? extends Annotation> ignoredExceptionAnnotationClass = statusTriggerService.ignoredExceptionAnnotationClass;\n+        if (Objects.isNull(ignoredExceptionAnnotationClass)) {\n+            return true;\n+        }\n+        if (e.getClass().isAnnotationPresent(ignoredExceptionAnnotationClass)) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEzMTAwNg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482131006", "bodyText": "The toolkit classes are in the user class loader zone, you can't assume it is usable in the agent core.\n\n\n\nload the ignoredExceptionAnnotationClass by application classloader, it is already passed in the manual test.\n\n\n2. Why simply use the exception name string match? This is much safer and easier than this.\n\nIf i was a user,i would to add ignore exception by annotation,this would be easy to control rather than change env config frequency. in our department,skywalking is throught as a platform, env is a only way to custom config.But env config is out of user code config, user would not like to frequency config.Env should keep stable.\n\n3. Like (2), the exception class could be cached.\n\nprivate final HashSet<Class<? extends Throwable>> ignoredExceptions = new HashSet<>(16);\nalready cache ignored exceptions.\nwe should add a new cache to store unignored exceptions.Is that what you're saying?", "author": "EvanLjp", "createdAt": "2020-09-02T14:50:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNjc5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMjI0Mg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482632242", "bodyText": "load the ignoredExceptionAnnotationClass by application classloader, it is already passed in the manual test.\n\nignoredExceptionAnnotationClass by application classloader, it could not be.\n\nprivate final HashSet<Class<? extends Throwable>> ignoredExceptions = new HashSet<>(16);\nalready cache ignored exceptions.\nwe should add a new cache to store unignored exceptions.Is that what you're saying?\n\nWe could use a Map directly.", "author": "wu-sheng", "createdAt": "2020-09-03T01:03:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNjc5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMjk5Mw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482632993", "bodyText": "Also, the key is not right, you need to use classLoaderInstance + Exception class as the key. The same class could be loaded by different class loaders with the same name.", "author": "wu-sheng", "createdAt": "2020-09-03T01:06:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNjc5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzYxMw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482107613", "bodyText": "Accessing the field directly is not allowed.", "author": "wu-sheng", "createdAt": "2020-09-02T14:21:15Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.lang.annotation.Annotation;\n+import java.util.HashSet;\n+import java.util.Objects;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class AnnotationMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final HashSet<Class<? extends Throwable>> ignoredExceptions = new HashSet<>(16);\n+\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        if (ignoredExceptions.contains(e.getClass())) {\n+            return false;\n+        }\n+        StatusCheckService statusTriggerService = ServiceManager.INSTANCE.findService(StatusCheckService.class);\n+        Class<? extends Annotation> ignoredExceptionAnnotationClass = statusTriggerService.ignoredExceptionAnnotationClass;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjExNjk5Mw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482116993", "bodyText": "package access", "author": "EvanLjp", "createdAt": "2020-09-02T14:32:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzYxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEyMzI0Nw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482123247", "bodyText": "The same thing, all accesses should be through methods unless it is in the same class and children. But this is not the key, please check comments about the annotation, which is my primary concern.", "author": "wu-sheng", "createdAt": "2020-09-02T14:41:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzYxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEzNTA0NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482135045", "bodyText": "The same thing, all accesses should be through methods unless it is in the same class and children. But this is\n\nalready reply", "author": "EvanLjp", "createdAt": "2020-09-02T14:56:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzYxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzk0MA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482107940", "bodyText": "What is this? Why are you doing this?", "author": "wu-sheng", "createdAt": "2020-09-02T14:21:41Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/FastFailExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+public class FastFailExceptionCheckStrategy implements ExceptionCheckStrategy {\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        return !(e instanceof Exception);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjExNjE2NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482116165", "bodyText": "in throwable, there are 2parts error or exception.\n\nerror occurs mostly occurs when system error\nexception mostly occurs  when  application error\nso we should only allow adjust exception status", "author": "EvanLjp", "createdAt": "2020-09-02T14:31:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzk0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3NzM0OA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482177348", "bodyText": "We are doing the name match and getCause, why we need to check this? instanceof is fast in JDK8, but this is not necessary.", "author": "wu-sheng", "createdAt": "2020-09-02T15:48:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjEwNzk0MA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3MzM5MQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482173391", "bodyText": "These two methods can be simply replaced by java.lang.Class#isAssignableFrom", "author": "kezhenxu94", "createdAt": "2020-09-02T15:43:09Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/InheriteMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.HashSet;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class InheriteMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final HashSet<Class<? extends Throwable>> ignoredExceptions = new HashSet<>(16);\n+\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        Class<? extends Throwable> clazz = e.getClass();\n+        if (ignoredExceptions.contains(clazz)) {\n+            return false;\n+        }\n+        StatusCheckService statusTriggerService = ServiceManager.INSTANCE.findService(StatusCheckService.class);\n+        String[] ignoredExceptionNames = statusTriggerService.getIgnoredExceptionNames();\n+        if (isInheritMatch(getSuperclasses(clazz), ignoredExceptionNames)) {\n+            ignoredExceptions.add(clazz);\n+            return false;\n+        }\n+        return true;\n+    }\n+\n+    private boolean isInheritMatch(final List<String> superclasses, final String[] ignoredExceptionNames) {\n+        for (final String superclass : superclasses) {\n+            for (final String ignoreExceptionName : ignoredExceptionNames) {\n+                if (superclass.equals(ignoreExceptionName)) {\n+                    return true;\n+                }\n+            }\n+        }\n+        return false;\n+    }\n+\n+    List<String> getSuperclasses(Class<? extends Throwable> clazz) {\n+        List<String> superClasses = new ArrayList<>();\n+        superClasses.add(clazz.getName());\n+        Class<?> superclass = clazz.getSuperclass();\n+        while (superclass != null && !superclass.equals(Exception.class)) {\n+            superClasses.add(superclass.getName());\n+            superclass = superclass.getSuperclass();\n+        }\n+        return superClasses;\n+    }", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjIwOTM1MQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482209351", "bodyText": "i know \uff0cbut i want to ignore classloader affect. we don't know how to load config class by which classloader.so I only judged it by class name.because of only little class in loop,it would not cost much time.", "author": "EvanLjp", "createdAt": "2020-09-02T16:37:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3MzM5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMjcyNw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482632727", "bodyText": "If you want this, use this way\n\nc = e.getClass().getClassLoader()\nIf c.forName(exception Class) has classNotFound, then should not ignore\nIf c.forName(exception Class) has a class reference, you could do isAssignableFrom", "author": "wu-sheng", "createdAt": "2020-09-03T01:05:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3MzM5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3Njk0NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482176945", "bodyText": "regex == regular expression, so there is no need to add _expression\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # plugin.springannotation.classname_match_regex_expression=${SW_SPRINGANNOTATION_CLASSNAME_MATCH_REGEX_EXPRESSION:}\n          \n          \n            \n            # plugin.springannotation.classname_match_regex=${SW_SPRINGANNOTATION_CLASSNAME_MATCH_REGEX:}", "author": "kezhenxu94", "createdAt": "2020-09-02T15:48:17Z", "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -92,7 +96,7 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n # plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n \n # Exclude activated plugins\n-# plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:\"\"}\n+# plugin.exclude_plugins=${SW_EXCLUDE_PLUGINS:}\n \n # Match spring bean with regex expression for classname\n-# plugin.springannotation.classname_match_regex_expression=${SW_SPRINGANNOTATION_CLASSNAME_MATCH_REGEX_EXPRESSION:\"\"}\n+# plugin.springannotation.classname_match_regex_expression=${SW_SPRINGANNOTATION_CLASSNAME_MATCH_REGEX_EXPRESSION:}", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MDI2Mw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482180263", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    errorOccurred = errorOccurred || ServiceManager.INSTANCE.findService(StatusCheckService.class).isError(t);\n          \n          \n            \n                    if (!errorOccurred  && ServiceManager.INSTANCE.findService(StatusCheckService.class).isError(t)) {\n          \n          \n            \n                        errorOccurred();\n          \n          \n            \n                    }", "author": "kezhenxu94", "createdAt": "2020-09-02T15:52:53Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/AbstractTracingSpan.java", "diffHunk": "@@ -163,6 +165,7 @@ public AbstractTracingSpan log(Throwable t) {\n         if (logs == null) {\n             logs = new LinkedList<>();\n         }\n+        errorOccurred = errorOccurred || ServiceManager.INSTANCE.findService(StatusCheckService.class).isError(t);", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MTcxMw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482181713", "bodyText": "Better to have a recursive depth here, for the sake of performance", "author": "kezhenxu94", "createdAt": "2020-09-02T15:54:52Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+public enum StatusChecker {\n+\n+    /**\n+     * All exception is thought as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy()), new ArrayList<>()),\n+\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy()\n+        )\n+    ),\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/> 3. The exception superclass name is exist in ignoreExceptions,\n+     * return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    INHERIT_NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy(),\n+            new InheriteMatchExceptionCheckStrategy()\n+        )\n+    );\n+\n+    /**\n+     * If any strategy check the status is error,the error status is true.\n+     */\n+    private final List<ExceptionCheckStrategy> logicOrStrategies;\n+    /**\n+     * If all strategy check the status is error,the error status is true.\n+     */\n+    private final List<ExceptionCheckStrategy> logicAndStrategies;\n+\n+    StatusChecker(final List<ExceptionCheckStrategy> logicOrStrategies,\n+                  final List<ExceptionCheckStrategy> logicAndStrategies) {\n+        this.logicOrStrategies = logicOrStrategies;\n+        this.logicAndStrategies = logicAndStrategies;\n+    }\n+\n+    public boolean recursiveCheckStatus(Throwable e) {\n+        if (e == null) {\n+            return true;\n+        }\n+        if (checkStatus(e)) {\n+            return recursiveCheckStatus(e.getCause());\n+        }\n+        return false;\n+    }", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MzI2NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482183265", "bodyText": "Typo, Inherite -> Inherit", "author": "kezhenxu94", "createdAt": "2020-09-02T15:56:59Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/InheriteMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.HashSet;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class InheriteMatchExceptionCheckStrategy implements ExceptionCheckStrategy {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4NDQ5Nw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482184497", "bodyText": "Don't need @DefaultImplementor ?", "author": "kezhenxu94", "createdAt": "2020-09-02T15:58:50Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusCheckService.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Arrays;\n+import lombok.Getter;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.util.StringUtil;\n+\n+import static org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck.OPEN_RECURSIVE_CHECK;\n+import static org.apache.skywalking.apm.agent.core.context.status.StatusChecker.OFF;\n+\n+public class StatusCheckService implements BootService {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3NjU3Mg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482176572", "bodyText": "This is not necessary for explicit configuration. IGNORED_EXCEPTIONS==\"\" means STATUS_CHECKER = OFF", "author": "wu-sheng", "createdAt": "2020-09-02T15:47:44Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -268,6 +270,12 @@\n         public static String PATTERN = \"%level %timestamp %thread %class : %msg %throwable\";\n     }\n \n+    public static class StatusCheck {\n+        public static String IGNORED_EXCEPTIONS = \"\";\n+        public static StatusChecker STATUS_CHECKER = OFF;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MTUxMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482181511", "bodyText": "You are facing racing conditions for this hash set.", "author": "wu-sheng", "createdAt": "2020-09-02T15:54:37Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/InheriteMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.HashSet;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class InheriteMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final HashSet<Class<? extends Throwable>> ignoredExceptions = new HashSet<>(16);", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MjE2OA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482182168", "bodyText": "Why there is a D suffix?", "author": "wu-sheng", "createdAt": "2020-09-02T15:55:27Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+public enum StatusChecker {\n+\n+    /**\n+     * All exception is thought as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy()), new ArrayList<>()),\n+\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    NAMED_MATCH(", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MjY3NA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482182674", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                NAMED_MATCH(\n          \n          \n            \n                NAME_MATCH(", "author": "wu-sheng", "createdAt": "2020-09-02T15:56:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4MjE2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4Mjk0Mw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482182943", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                INHERIT_NAMED_MATCH(\n          \n          \n            \n                HIERARCHY_MATCH(", "author": "wu-sheng", "createdAt": "2020-09-02T15:56:35Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+public enum StatusChecker {\n+\n+    /**\n+     * All exception is thought as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy()), new ArrayList<>()),\n+\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy()\n+        )\n+    ),\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/> 3. The exception superclass name is exist in ignoreExceptions,\n+     * return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    INHERIT_NAMED_MATCH(", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4NTI1OA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482185258", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n          \n          \n            \n                 * ignoreExceptions, return normal status.<br/> 3. The exception superclass name is exist in ignoreExceptions,\n          \n          \n            \n                 * return normal status.<br/>\n          \n          \n            \n                 * Do hierarchy check for the exception. Tag span as error status unless it is listed in Config.StatusCheck#IGNORED_EXCEPTIONS", "author": "wu-sheng", "createdAt": "2020-09-02T15:59:57Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+public enum StatusChecker {\n+\n+    /**\n+     * All exception is thought as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy()), new ArrayList<>()),\n+\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy()\n+        )\n+    ),\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/> 3. The exception superclass name is exist in ignoreExceptions,\n+     * return normal status.<br/>", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4NjkzMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482186931", "bodyText": "Inherite -> hierarchy", "author": "wu-sheng", "createdAt": "2020-09-02T16:02:28Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/InheriteMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.HashSet;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class InheriteMatchExceptionCheckStrategy implements ExceptionCheckStrategy {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4NzMwMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482187301", "bodyText": "If I read the codes right, InheriteMatchExceptionCheckStrategy should have included the logic of NamedMatchExceptionCheckStrategy.", "author": "wu-sheng", "createdAt": "2020-09-02T16:03:05Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+public enum StatusChecker {\n+\n+    /**\n+     * All exception is thought as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy()), new ArrayList<>()),\n+\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy()\n+        )\n+    ),\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/> 3. The exception superclass name is exist in ignoreExceptions,\n+     * return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    INHERIT_NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy(),\n+            new InheriteMatchExceptionCheckStrategy()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4Nzg3OQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482187879", "bodyText": "Do we really this complex constructor? From the coding perspective, this should be an And ExceptionCheckStrategy(s1, s2), but I doubt whether this is really necessary for now.", "author": "wu-sheng", "createdAt": "2020-09-02T16:04:04Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+public enum StatusChecker {\n+\n+    /**\n+     * All exception is thought as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy()), new ArrayList<>()),\n+\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy()\n+        )\n+    ),\n+    /**\n+     * 1. The throwable is not instance of exception, return error status. <br/> 2. The exception name is exist in\n+     * ignoreExceptions, return normal status.<br/> 3. The exception superclass name is exist in ignoreExceptions,\n+     * return normal status.<br/>\n+     *\n+     * @see Config.StatusCheck#IGNORED_EXCEPTIONS\n+     */\n+    INHERIT_NAMED_MATCH(\n+        Collections.singletonList(new FastFailExceptionCheckStrategy()),\n+        Arrays.asList(\n+            new NamedMatchExceptionCheckStrategy(),\n+            new InheriteMatchExceptionCheckStrategy()\n+        )\n+    );\n+\n+    /**\n+     * If any strategy check the status is error,the error status is true.\n+     */\n+    private final List<ExceptionCheckStrategy> logicOrStrategies;\n+    /**\n+     * If all strategy check the status is error,the error status is true.\n+     */\n+    private final List<ExceptionCheckStrategy> logicAndStrategies;\n+\n+    StatusChecker(final List<ExceptionCheckStrategy> logicOrStrategies,\n+                  final List<ExceptionCheckStrategy> logicAndStrategies) {\n+        this.logicOrStrategies = logicOrStrategies;\n+        this.logicAndStrategies = logicAndStrategies;\n+    }", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b6b7bbf5cbf8a8167d46168eb0c887528074ebf0", "url": "https://github.com/apache/skywalking/commit/b6b7bbf5cbf8a8167d46168eb0c887528074ebf0", "message": "v4: annotation with  Activation", "committedDate": "2020-09-03T05:53:09Z", "type": "commit"}, {"oid": "b6b7bbf5cbf8a8167d46168eb0c887528074ebf0", "url": "https://github.com/apache/skywalking/commit/b6b7bbf5cbf8a8167d46168eb0c887528074ebf0", "message": "v4: annotation with  Activation", "committedDate": "2020-09-03T05:53:09Z", "type": "forcePushed"}, {"oid": "614887acfc0c778d497b6500d54c87938adbf7e0", "url": "https://github.com/apache/skywalking/commit/614887acfc0c778d497b6500d54c87938adbf7e0", "message": "inject value for annotation", "committedDate": "2020-09-03T07:51:58Z", "type": "commit"}, {"oid": "6e9d49d667b963c4731277841ec9ab002b90deac", "url": "https://github.com/apache/skywalking/commit/6e9d49d667b963c4731277841ec9ab002b90deac", "message": "fix unit test", "committedDate": "2020-09-03T09:02:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzMTk0Mw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482831943", "bodyText": "Why return directly?", "author": "wu-sheng", "createdAt": "2020-09-03T09:16:50Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/HierarchyMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.CopyOnWriteArraySet;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class HierarchyMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final Set<Class<? extends Throwable>> ignoredExceptions = new CopyOnWriteArraySet<>();\n+\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        Class<? extends Throwable> clazz = e.getClass();\n+        if (ignoredExceptions.contains(clazz)) {\n+            return false;\n+        }\n+        ClassLoader classLoader = clazz.getClassLoader();\n+        StatusCheckService statusTriggerService = ServiceManager.INSTANCE.findService(StatusCheckService.class);\n+        String[] ignoredExceptionNames = statusTriggerService.getIgnoredExceptionNames();\n+        for (final String ignoredExceptionName : ignoredExceptionNames) {\n+            try {\n+                Class<?> parentClazz = Class.forName(ignoredExceptionName, true, classLoader);\n+                if (parentClazz.isAssignableFrom(clazz)) {\n+                    ignoredExceptions.add(clazz);\n+                    return false;\n+                }\n+            } catch (ClassNotFoundException ignore) {\n+                return true;", "originalCommit": "6e9d49d667b963c4731277841ec9ab002b90deac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzMjQzNw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482832437", "bodyText": "You don't cache the checked class, so basically, most exceptions have to be checked every time, which is a performance issue.", "author": "wu-sheng", "createdAt": "2020-09-03T09:17:42Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/HierarchyMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.CopyOnWriteArraySet;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+public class HierarchyMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final Set<Class<? extends Throwable>> ignoredExceptions = new CopyOnWriteArraySet<>();", "originalCommit": "6e9d49d667b963c4731277841ec9ab002b90deac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzNDYyNw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r482834627", "bodyText": "This could do instanceof EnhancedInstance, should not use reflect.", "author": "wu-sheng", "createdAt": "2020-09-03T09:21:01Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.CopyOnWriteArraySet;\n+\n+public class AnnotationMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final Set<Class<? extends Throwable>> ignoredExceptions = new CopyOnWriteArraySet<>();\n+\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        Class<? extends Throwable> clazz = e.getClass();\n+        if (ignoredExceptions.contains(clazz)) {\n+            return false;\n+        }\n+        try {\n+            String value = (String) clazz.getMethod(\"getSkyWalkingDynamicField\").invoke(e);", "originalCommit": "6e9d49d667b963c4731277841ec9ab002b90deac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "244df648cce7449378b74c853215ddd92d1f53ac", "url": "https://github.com/apache/skywalking/commit/244df648cce7449378b74c853215ddd92d1f53ac", "message": "add cache", "committedDate": "2020-09-03T09:51:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMDE2MA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483020160", "bodyText": "Don't provide no limitation. That could cause OOM", "author": "wu-sheng", "createdAt": "2020-09-03T14:27:00Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -268,6 +267,19 @@\n         public static String PATTERN = \"%level %timestamp %thread %class : %msg %throwable\";\n     }\n \n+    public static class StatusCheck {\n+        /**\n+         * Ignored exception list, also affect their subclasses.\n+         */\n+        public static String IGNORED_EXCEPTIONS = \"\";\n+\n+        /**\n+         * Agent would do hierarchy check for the exception unless the max_recursive_depth equals to 0.And -1 means no limit.", "originalCommit": "244df648cce7449378b74c853215ddd92d1f53ac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMDUzNQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483020535", "bodyText": "All negative value should be considered as 0.", "author": "wu-sheng", "createdAt": "2020-09-03T14:27:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMDE2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3NTMxMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483075311", "bodyText": "ok", "author": "EvanLjp", "createdAt": "2020-09-03T15:41:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMDE2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMDk4NQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483020985", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private final Set<Class<? extends Throwable>> exceptions = new CopyOnWriteArraySet<>();\n          \n          \n            \n                private final Set<Class<? extends Throwable>> errorStatusExceptions = new CopyOnWriteArraySet<>();", "author": "wu-sheng", "createdAt": "2020-09-03T14:28:05Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.CopyOnWriteArraySet;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+\n+public class AnnotationMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final Set<Class<? extends Throwable>> ignoredExceptions = new CopyOnWriteArraySet<>();\n+    private final Set<Class<? extends Throwable>> exceptions = new CopyOnWriteArraySet<>();", "originalCommit": "244df648cce7449378b74c853215ddd92d1f53ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMjE1Ng==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483022156", "bodyText": "@kezhenxu94 @EvanLjp Any of you know the performance difference between CopyOnWriteArraySet and ConcurrentHashMap? This check is highly performance sensitive.", "author": "wu-sheng", "createdAt": "2020-09-03T14:29:39Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.CopyOnWriteArraySet;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+\n+public class AnnotationMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final Set<Class<? extends Throwable>> ignoredExceptions = new CopyOnWriteArraySet<>();", "originalCommit": "244df648cce7449378b74c853215ddd92d1f53ac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3ODkzMg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483078932", "bodyText": "Read some doc , and replace it  with the  set view of concurrentHashMap to store exception class.", "author": "EvanLjp", "createdAt": "2020-09-03T15:46:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMjE1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA0Nw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483024047", "bodyText": "Use TAG_NAME.equals... to avoid NPE.", "author": "wu-sheng", "createdAt": "2020-09-03T14:31:57Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.CopyOnWriteArraySet;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+\n+public class AnnotationMatchExceptionCheckStrategy implements ExceptionCheckStrategy {\n+\n+    private final Set<Class<? extends Throwable>> ignoredExceptions = new CopyOnWriteArraySet<>();\n+    private final Set<Class<? extends Throwable>> exceptions = new CopyOnWriteArraySet<>();\n+    private static final String TAG_NAME = AnnotationMatchExceptionCheckStrategy.class.getSimpleName();\n+\n+    @Override\n+    public boolean isError(final Throwable e) {\n+        Class<? extends Throwable> clazz = e.getClass();\n+        if (ignoredExceptions.contains(clazz)) {\n+            return false;\n+        }\n+        if (exceptions.contains(clazz)) {\n+            return true;\n+        }\n+        if (e instanceof EnhancedInstance && ((EnhancedInstance) e).getSkyWalkingDynamicField().equals(TAG_NAME)) {", "originalCommit": "244df648cce7449378b74c853215ddd92d1f53ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3873e713fa234b06a463b67440c4e66aee8ceb6d", "url": "https://github.com/apache/skywalking/commit/3873e713fa234b06a463b67440c4e66aee8ceb6d", "message": "refactor plugins", "committedDate": "2020-09-03T14:36:44Z", "type": "commit"}, {"oid": "376d73267bb1dad0d2d0f7a0ec33c87162254a2d", "url": "https://github.com/apache/skywalking/commit/376d73267bb1dad0d2d0f7a0ec33c87162254a2d", "message": "add doc", "committedDate": "2020-09-03T15:25:01Z", "type": "commit"}, {"oid": "b5f109a3977b35574536fa3f549aea9b3bbc61af", "url": "https://github.com/apache/skywalking/commit/b5f109a3977b35574536fa3f549aea9b3bbc61af", "message": "replace with concurrentHashMap set view to store exception class", "committedDate": "2020-09-03T15:38:55Z", "type": "commit"}, {"oid": "17609aef0c56b0d7bfa1616f78f1900a70c85130", "url": "https://github.com/apache/skywalking/commit/17609aef0c56b0d7bfa1616f78f1900a70c85130", "message": "remove no limit", "committedDate": "2020-09-03T15:44:38Z", "type": "commit"}, {"oid": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "url": "https://github.com/apache/skywalking/commit/965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "message": "add doc", "committedDate": "2020-09-03T17:40:39Z", "type": "commit"}, {"oid": "e76a85fcf36c28817f8f8d8cf823d2dde6d50084", "url": "https://github.com/apache/skywalking/commit/e76a85fcf36c28817f8f8d8cf823d2dde6d50084", "message": "Merge branch 'master' into exception-ignore-plugin", "committedDate": "2020-09-04T00:52:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMyOTcwOA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483329708", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * Ignored exception list, also affect their subclasses.\n          \n          \n            \n                     * Listed exceptions would not be treated as an error. Because in some codes, the exception is being used as a way of controlling business flow.", "author": "wu-sheng", "createdAt": "2020-09-04T01:02:23Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -268,6 +267,21 @@\n         public static String PATTERN = \"%level %timestamp %thread %class : %msg %throwable\";\n     }\n \n+    public static class StatusCheck {\n+        /**\n+         * Ignored exception list, also affect their subclasses.", "originalCommit": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzMDEyNQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483330125", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * The max depth for recursive check exception status. Default 0 means all exceptions will be thought of as\n          \n          \n            \n                     * error status. If an exception is listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS\n          \n          \n            \n                     * or tagged with org.apache.skywalking.apm.toolkit.trace.IgnoredException, the exception will not be thought of\n          \n          \n            \n                     * as error status, also affects its subclasses.\n          \n          \n            \n                     * The max recursive depth when checking the exception traced by the agent. Typically, we don't recommend setting this more than 10, which could cause a performance issue. Negative value and 0 would be ignored, which means all exceptions would make the span tagged in error status.", "author": "wu-sheng", "createdAt": "2020-09-04T01:04:13Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -268,6 +267,21 @@\n         public static String PATTERN = \"%level %timestamp %thread %class : %msg %throwable\";\n     }\n \n+    public static class StatusCheck {\n+        /**\n+         * Ignored exception list, also affect their subclasses.\n+         */\n+        public static String IGNORED_EXCEPTIONS = \"\";\n+\n+        /**\n+         * The max depth for recursive check exception status. Default 0 means all exceptions will be thought of as\n+         * error status. If an exception is listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS\n+         * or tagged with org.apache.skywalking.apm.toolkit.trace.IgnoredException, the exception will not be thought of\n+         * as error status, also affects its subclasses.", "originalCommit": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzMDIwNg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483330206", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    public static Integer MAX_RECURSIVE_DEPTH = 0;\n          \n          \n            \n                    public static Integer MAX_RECURSIVE_DEPTH = 1;", "author": "wu-sheng", "createdAt": "2020-09-04T01:04:32Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -268,6 +267,21 @@\n         public static String PATTERN = \"%level %timestamp %thread %class : %msg %throwable\";\n     }\n \n+    public static class StatusCheck {\n+        /**\n+         * Ignored exception list, also affect their subclasses.\n+         */\n+        public static String IGNORED_EXCEPTIONS = \"\";\n+\n+        /**\n+         * The max depth for recursive check exception status. Default 0 means all exceptions will be thought of as\n+         * error status. If an exception is listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS\n+         * or tagged with org.apache.skywalking.apm.toolkit.trace.IgnoredException, the exception will not be thought of\n+         * as error status, also affects its subclasses.\n+         */\n+        public static Integer MAX_RECURSIVE_DEPTH = 0;", "originalCommit": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzMjMzNQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483332335", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * The exception tagged with org.apache.skywalking.apm.toolkit.trace.IgnoredException will not be thought as an error,\n          \n          \n            \n             * The exception annotated with org.apache.skywalking.apm.toolkit.trace.IgnoredException would not set the span in the error status.", "author": "wu-sheng", "createdAt": "2020-09-04T01:13:22Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/AnnotationMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.ConcurrentHashMap;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+\n+/**\n+ * The exception tagged with org.apache.skywalking.apm.toolkit.trace.IgnoredException will not be thought as an error,", "originalCommit": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzMzExNw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483333117", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * The exception listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS will not be\n          \n          \n            \n             * thought as an error, also affects its subclasses.\n          \n          \n            \n             * HierarchyMatchExceptionCheckStrategy does a hierarchy check for a traced exception. If it or its parent has been listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS, the error status of the span wouldn't be changed.", "author": "wu-sheng", "createdAt": "2020-09-04T01:16:31Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/HierarchyMatchExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Set;\n+import java.util.concurrent.ConcurrentHashMap;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+\n+/**\n+ * The exception listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS will not be\n+ * thought as an error, also affects its subclasses.", "originalCommit": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzMzMxMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483333311", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * All exceptions will be thought of as error status.\n          \n          \n            \n             * All exceptions would make the span tagged as the error status.", "author": "wu-sheng", "createdAt": "2020-09-04T01:17:17Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/OffExceptionCheckStrategy.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+/**\n+ * All exceptions will be thought of as error status.", "originalCommit": "965f8f7cbfe0aeb916cdaf8f943122ee3381ea46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4e150044fa51f3640bf62bf446633bafd8ef8681", "url": "https://github.com/apache/skywalking/commit/4e150044fa51f3640bf62bf446633bafd8ef8681", "message": "update doc", "committedDate": "2020-09-04T09:30:46Z", "type": "commit"}, {"oid": "28ef37bdcf45509ff7da9ce11cfaa5068c982822", "url": "https://github.com/apache/skywalking/commit/28ef37bdcf45509ff7da9ce11cfaa5068c982822", "message": "Merge branch 'exception-ignore-plugin' of https://github.com/EvanLjp/skywalking into exception-ignore-plugin", "committedDate": "2020-09-04T09:31:14Z", "type": "commit"}, {"oid": "f13cf625c380eb74538ca6608aa517bfe0b1fb1e", "url": "https://github.com/apache/skywalking/commit/f13cf625c380eb74538ca6608aa517bfe0b1fb1e", "message": "Merge remote-tracking branch 'upstream/master' into exception-ignore-plugin", "committedDate": "2020-09-04T09:31:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUwNjUzNw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483506537", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * When opening the exception status checker in the agent, a traced exception wouldn't be marked as error status which\n          \n          \n            \n             * tagged with this annotation in a span. Besides the annotation supports integration, the subclasses would be also\n          \n          \n            \n             * annotated with it.\n          \n          \n            \n             * After the exception status checker activated in the agent, the span wouldn't be marked as error status if the exception\n          \n          \n            \n             * has this annotation. \n          \n      \n    \n    \n  \n\n\nBesides the annotation supports integration, the subclasses would be also annotated with it.\n\nI think subclass status is determined by the MAX_RECURSIVE_DEPTH, isn't it?", "author": "wu-sheng", "createdAt": "2020-09-04T09:37:18Z", "path": "apm-application-toolkit/apm-toolkit-trace/src/main/java/org/apache/skywalking/apm/toolkit/trace/IgnoredException.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.toolkit.trace;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Inherited;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * When opening the exception status checker in the agent, a traced exception wouldn't be marked as error status which\n+ * tagged with this annotation in a span. Besides the annotation supports integration, the subclasses would be also\n+ * annotated with it.", "originalCommit": "f13cf625c380eb74538ca6608aa517bfe0b1fb1e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUxMDUxMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483510511", "bodyText": "Yes, 2 ways are all controlled by MAX_RECURSIVE_DEPTH . They are almost equivalent, and both support inheritance.\norg.apache.skywalking.apm.toolkit.trace.IgnoredException\norg.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS", "author": "EvanLjp", "createdAt": "2020-09-04T09:45:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUwNjUzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUxMjcxMQ==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483512711", "bodyText": "Then, please correct the comment.", "author": "wu-sheng", "createdAt": "2020-09-04T09:49:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUwNjUzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUwNzI4Nw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483507287", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * The <code>StatusCheckService</code> checks the status of a exception traced in a span.\n          \n          \n            \n             * The <code>StatusCheckService</code> determines whether the span should be tagged in error status if an exception captured in the scope.", "author": "wu-sheng", "createdAt": "2020-09-04T09:38:39Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusCheckService.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Arrays;\n+import lombok.Getter;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultImplementor;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.util.StringUtil;\n+\n+import static org.apache.skywalking.apm.agent.core.context.status.StatusChecker.HIERARCHY_MATCH;\n+import static org.apache.skywalking.apm.agent.core.context.status.StatusChecker.OFF;\n+\n+/**\n+ * The <code>StatusCheckService</code> checks the status of a exception traced in a span.", "originalCommit": "f13cf625c380eb74538ca6608aa517bfe0b1fb1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "34e388b0f97394a7739c1612545f774205944b48", "url": "https://github.com/apache/skywalking/commit/34e388b0f97394a7739c1612545f774205944b48", "message": "update doc", "committedDate": "2020-09-04T10:16:09Z", "type": "commit"}, {"oid": "59b923dc4e6d304c0f25aa77ddaaff86c4325264", "url": "https://github.com/apache/skywalking/commit/59b923dc4e6d304c0f25aa77ddaaff86c4325264", "message": "Merge branch 'master' into exception-ignore-plugin", "committedDate": "2020-09-04T13:34:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM4OTQzNg==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r483389436", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    while (isError && Objects.nonNull(e) && maxDepth-- != 0) {\n          \n          \n            \n                    while (isError && Objects.nonNull(e) && maxDepth-- > 0) {\n          \n      \n    \n    \n  \n\nin case the user set maxDepth = -1", "author": "kezhenxu94", "createdAt": "2020-09-04T05:08:39Z", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.context.status;\n+\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Objects;\n+import lombok.AllArgsConstructor;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+@AllArgsConstructor\n+public enum StatusChecker {\n+\n+    /**\n+     * All exceptions will be thought of as error status.\n+     */\n+    OFF(Collections.singletonList(new OffExceptionCheckStrategy())),\n+\n+    /**\n+     * If a exception is listed in org.apache.skywalking.apm.agent.core.conf.Config.StatusCheck#IGNORED_EXCEPTIONS or\n+     * tagged with org.apache.skywalking.apm.toolkit.trace.IgnoredException, the exception will not be thought as an\n+     * error status, also affects its subclasses.\n+     */\n+    HIERARCHY_MATCH(Arrays.asList(\n+        new HierarchyMatchExceptionCheckStrategy(),\n+        new AnnotationMatchExceptionCheckStrategy()\n+    ));\n+\n+    private final List<ExceptionCheckStrategy> strategies;\n+\n+    public boolean checkStatus(Throwable e) {\n+        int maxDepth = Config.StatusCheck.MAX_RECURSIVE_DEPTH;\n+        boolean isError = true;\n+        while (isError && Objects.nonNull(e) && maxDepth-- != 0) {", "originalCommit": "e76a85fcf36c28817f8f8d8cf823d2dde6d50084", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e8e820e1070cd770e9f2bf81202da19c9ddb432f", "url": "https://github.com/apache/skywalking/commit/e8e820e1070cd770e9f2bf81202da19c9ddb432f", "message": "Update apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/status/StatusChecker.java\n\nCo-authored-by: kezhenxu94 <kezhenxu94@163.com>", "committedDate": "2020-09-04T15:22:53Z", "type": "commit"}, {"oid": "22269d2b26724f2ab0a1107696e4850d8baa2222", "url": "https://github.com/apache/skywalking/commit/22269d2b26724f2ab0a1107696e4850d8baa2222", "message": "add ExceptionCheckContext to store the exceptions that have checked before.", "committedDate": "2020-09-06T10:34:56Z", "type": "commit"}, {"oid": "e0f6c87c3130c8f927ac2d0d18b6b901543b3dea", "url": "https://github.com/apache/skywalking/commit/e0f6c87c3130c8f927ac2d0d18b6b901543b3dea", "message": "add exception-checker-spring-scenario", "committedDate": "2020-09-06T10:49:08Z", "type": "commit"}, {"oid": "603b9625d23bc2d1f95039dc23c47bad6396bc41", "url": "https://github.com/apache/skywalking/commit/603b9625d23bc2d1f95039dc23c47bad6396bc41", "message": "add exception-checker-spring-scenario github workflows", "committedDate": "2020-09-06T10:52:24Z", "type": "commit"}, {"oid": "f4677e85e8d685e6f99506b04466cc15ef538595", "url": "https://github.com/apache/skywalking/commit/f4677e85e8d685e6f99506b04466cc15ef538595", "message": "Merge branch 'exception-ignore-plugin' of https://github.com/EvanLjp/skywalking into exception-ignore-plugin", "committedDate": "2020-09-06T10:53:56Z", "type": "commit"}, {"oid": "ab9e5c9c1f23882282116b2667336b3ceef8464b", "url": "https://github.com/apache/skywalking/commit/ab9e5c9c1f23882282116b2667336b3ceef8464b", "message": "Merge remote-tracking branch 'upstream/master' into exception-ignore-plugin", "committedDate": "2020-09-06T10:54:40Z", "type": "commit"}, {"oid": "3d7c50dd3d488d5708579119c662cea359b8be50", "url": "https://github.com/apache/skywalking/commit/3d7c50dd3d488d5708579119c662cea359b8be50", "message": "fix unit test", "committedDate": "2020-09-06T11:06:40Z", "type": "commit"}, {"oid": "8a17e406cc2f82c5c4f65108942a886d677d63c0", "url": "https://github.com/apache/skywalking/commit/8a17e406cc2f82c5c4f65108942a886d677d63c0", "message": "fix operation name with RequestMapping", "committedDate": "2020-09-06T12:31:02Z", "type": "commit"}, {"oid": "f516ff565f3dbc843ccf9df5f1bf646b1716cab6", "url": "https://github.com/apache/skywalking/commit/f516ff565f3dbc843ccf9df5f1bf646b1716cab6", "message": "add exception-checker-tomcat-scenario", "committedDate": "2020-09-07T04:35:38Z", "type": "commit"}, {"oid": "be25218e98cbd337604f1744a84bb1ebda37c935", "url": "https://github.com/apache/skywalking/commit/be25218e98cbd337604f1744a84bb1ebda37c935", "message": "add exception-checker-tomcat-scenario github workflow", "committedDate": "2020-09-07T04:38:48Z", "type": "commit"}, {"oid": "3691456a92bfbdc7d112c0eaa9e0f136ffcc9acb", "url": "https://github.com/apache/skywalking/commit/3691456a92bfbdc7d112c0eaa9e0f136ffcc9acb", "message": "add exception checker callback", "committedDate": "2020-09-07T05:28:02Z", "type": "commit"}, {"oid": "4a73e659c45ae166aaebc4ab282dcf74f31199f0", "url": "https://github.com/apache/skywalking/commit/4a73e659c45ae166aaebc4ab282dcf74f31199f0", "message": "Merge branch 'master' into exception-ignore-plugin", "committedDate": "2020-09-08T08:46:51Z", "type": "commit"}, {"oid": "85052c7817496c4dafe0b2a64121e843d72028f3", "url": "https://github.com/apache/skywalking/commit/85052c7817496c4dafe0b2a64121e843d72028f3", "message": "Merge remote-tracking branch 'upstream/master' into exception-ignore-plugin", "committedDate": "2020-09-08T09:26:23Z", "type": "commit"}, {"oid": "35c565c9a6f8de8516ac6c7e98010045fcc7c6cc", "url": "https://github.com/apache/skywalking/commit/35c565c9a6f8de8516ac6c7e98010045fcc7c6cc", "message": "Merge branch 'exception-ignore-plugin' of https://github.com/EvanLjp/skywalking into exception-ignore-plugin", "committedDate": "2020-09-08T09:28:09Z", "type": "commit"}, {"oid": "0ee57114228c784184228ddf5ed04f8599bcd4b6", "url": "https://github.com/apache/skywalking/commit/0ee57114228c784184228ddf5ed04f8599bcd4b6", "message": "fix grpc-plugin-test expectedData.yaml", "committedDate": "2020-09-08T14:43:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk3OTEwNA==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r484979104", "bodyText": "I think you missed the toolkit document update about how to use this annotation.", "author": "wu-sheng", "createdAt": "2020-09-08T14:47:13Z", "path": "test/plugin/scenarios/exception-checker-spring-scenario/src/main/java/org/apache/skywalking/apm/toolkit/trace/IgnoredException.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.toolkit.trace;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Inherited;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * After the exception status checker activated in the agent, the span wouldn't be marked as error status if the\n+ * exception has this annotation.\n+ */\n+@Target(ElementType.TYPE)\n+@Retention(RetentionPolicy.RUNTIME)\n+@Inherited\n+public @interface IgnoredException {", "originalCommit": "0ee57114228c784184228ddf5ed04f8599bcd4b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk5MzE0Mw==", "url": "https://github.com/apache/skywalking/pull/5426#discussion_r484993143", "bodyText": "thx for your notice will add it later", "author": "EvanLjp", "createdAt": "2020-09-08T15:04:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk3OTEwNA=="}], "type": "inlineReview"}, {"oid": "63001c130e01f7cdef752d62e47ea2030056fd9a", "url": "https://github.com/apache/skywalking/commit/63001c130e01f7cdef752d62e47ea2030056fd9a", "message": "Merge branch 'master' into exception-ignore-plugin", "committedDate": "2020-09-08T23:41:05Z", "type": "commit"}, {"oid": "e742fe994a7444886e8fd53c75bb1e274fd6c030", "url": "https://github.com/apache/skywalking/commit/e742fe994a7444886e8fd53c75bb1e274fd6c030", "message": "add doc", "committedDate": "2020-09-09T01:58:43Z", "type": "commit"}, {"oid": "6433644d6ab1b6adfe3ebb6d8060e537b103d7f5", "url": "https://github.com/apache/skywalking/commit/6433644d6ab1b6adfe3ebb6d8060e537b103d7f5", "message": "Merge branch 'exception-ignore-plugin' of https://github.com/EvanLjp/skywalking into exception-ignore-plugin", "committedDate": "2020-09-09T01:59:13Z", "type": "commit"}, {"oid": "3d7c9fbe6df3cd5153d400a26c80cf8dcca03655", "url": "https://github.com/apache/skywalking/commit/3d7c9fbe6df3cd5153d400a26c80cf8dcca03655", "message": "Update README.md", "committedDate": "2020-09-09T05:29:55Z", "type": "commit"}, {"oid": "f238085b5b96afc25cb5dadf6fd1496269b784c0", "url": "https://github.com/apache/skywalking/commit/f238085b5b96afc25cb5dadf6fd1496269b784c0", "message": "Update How-to-tolerate-exceptions.md", "committedDate": "2020-09-09T05:37:48Z", "type": "commit"}, {"oid": "8f2d1c6899f397863f04ed4f7a69993fa6f2e76b", "url": "https://github.com/apache/skywalking/commit/8f2d1c6899f397863f04ed4f7a69993fa6f2e76b", "message": "Merge branch 'master' into exception-ignore-plugin", "committedDate": "2020-09-09T05:38:33Z", "type": "commit"}]}