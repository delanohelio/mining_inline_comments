{"pr_number": 472, "pr_title": "[OC-1082] UI - Remove use of  method askUserApplicationRegistered", "pr_createdAt": "2020-09-15T10:21:05Z", "pr_url": "https://github.com/opfab/operatorfabric-core/pull/472", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYyNzUxNw==", "url": "https://github.com/opfab/operatorfabric-core/pull/472#discussion_r488627517", "bodyText": "These three line should be put out of the subscribe", "author": "freddidierRTE", "createdAt": "2020-09-15T12:31:17Z", "path": "ui/main/src/app/modules/free-message/free-message.component.ts", "diffHunk": "@@ -122,21 +122,17 @@ export class FreeMessageComponent implements OnDestroy {\n         this.entityOptions$ = this.store.select(selectAllEntities).pipe(\n             takeUntil(this.unsubscribe$),\n             map((allEntities: Entity[]) => allEntities.map((entity: Entity) => {\n-                    return {value: entity.id, label: entity.name};\n-                })\n+                return { value: entity.id, label: entity.name };\n+            })\n             )\n         );\n-        this.store.select(selectIdentifier)\n-            .pipe(\n-                switchMap(id => this.userService.askUserApplicationRegistered(id)),\n-                withLatestFrom(this.store.select(selectProcesses))\n-            )\n-            .subscribe(([user, allProcesses]: [User, Process[]]) => {\n-\n-                this.currentUser = user;\n+        this.store.select(selectProcesses).pipe(takeUntil(this.unsubscribe$)).\n+            subscribe((allProcesses: Process[]) => {\n+                const userWithPerimeters = this.userService.getCurrentUserWithPerimeters();\n+                if (userWithPerimeters) {\n+                    this.currentUser = userWithPerimeters.userData;", "originalCommit": "0c1686891c2a7a7b58f0b92558b530bbf9d92b22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY1MzU4OQ==", "url": "https://github.com/opfab/operatorfabric-core/pull/472#discussion_r488653589", "bodyText": "Ok", "author": "taoufikbermaki", "createdAt": "2020-09-15T13:10:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYyNzUxNw=="}], "type": "inlineReview"}, {"oid": "865ab2caf94a23c2ca8562702764f2dc37c85ff7", "url": "https://github.com/opfab/operatorfabric-core/commit/865ab2caf94a23c2ca8562702764f2dc37c85ff7", "message": "[OC-1082] UI - Remove use of  method askUserApplicationRegistered", "committedDate": "2020-09-15T13:17:16Z", "type": "commit"}, {"oid": "865ab2caf94a23c2ca8562702764f2dc37c85ff7", "url": "https://github.com/opfab/operatorfabric-core/commit/865ab2caf94a23c2ca8562702764f2dc37c85ff7", "message": "[OC-1082] UI - Remove use of  method askUserApplicationRegistered", "committedDate": "2020-09-15T13:17:16Z", "type": "forcePushed"}]}