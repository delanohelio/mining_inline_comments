{"pr_number": 505, "pr_title": "[OC-1117] Remove template and css arrays in bundle defintion", "pr_createdAt": "2020-10-05T08:09:25Z", "pr_url": "https://github.com/opfab/operatorfabric-core/pull/505", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ3Mjk4MA==", "url": "https://github.com/opfab/operatorfabric-core/pull/505#discussion_r499472980", "bodyText": "More explicit in the name of the method\nProposal of name :   doesFileNameContainsIllegalValuesForReadAccess()", "author": "freddidierRTE", "createdAt": "2020-10-05T09:44:46Z", "path": "tools/generic/utilities/src/main/java/org/lfenergy/operatorfabric/utilities/SecurityUtils.java", "diffHunk": "@@ -0,0 +1,25 @@\n+/* Copyright (c) 2018-2020, RTE (http://www.rte-france.com)\n+ * See AUTHORS.txt\n+ * This Source Code Form is subject to the terms of the Mozilla Public\n+ * License, v. 2.0. If a copy of the MPL was not distributed with this\n+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n+ * SPDX-License-Identifier: MPL-2.0\n+ * This file is part of the OperatorFabric project.\n+ */\n+\n+\n+\n+package org.lfenergy.operatorfabric.utilities;\n+\n+import java.util.regex.Pattern;\n+\n+public class SecurityUtils {\n+\n+    public final static String FILENAME_ILLEGAL_VALUES = \"^\\\\\\\\|^/|^\\\\.\\\\.\\\\\\\\|^\\\\.\\\\./|^~\\\\\\\\|^~/\";\n+\n+    public static boolean checkFilename(String filename) {\n+        Pattern pattern = Pattern.compile(FILENAME_ILLEGAL_VALUES);\n+        return !pattern.matcher(filename).find();\n+    }", "originalCommit": "e98f74d62720ec386f531235cab3c675a5f550f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ5NjQ5NQ==", "url": "https://github.com/opfab/operatorfabric-core/pull/505#discussion_r499496495", "bodyText": "You shall test locale and version parameters to not contains forbidden characters", "author": "freddidierRTE", "createdAt": "2020-10-05T10:25:49Z", "path": "services/core/businessconfig/src/main/java/org/lfenergy/operatorfabric/businessconfig/services/ProcessesService.java", "diffHunk": "@@ -202,11 +203,17 @@ public Resource fetchResource(String processId, ResourceTypeEnum type, String ve\n \n         if (process == null)\n             throw new FileNotFoundException(\"Unknown version (\" + finalVersion + \") for \" + processId);\n-        validateResourceParameters(processId, type, name, finalVersion, locale);\n+\n+        if (type.isLocalized() && locale == null)\n+            throw new FileNotFoundException(\"Unable to determine resource for undefined locale\");\n+\n         String finalName;\n         if (type == ResourceTypeEnum.I18N) {\n             finalName = locale;\n         } else {\n+            if (!SecurityUtils.checkFilename(name)) {\n+                throw new FileNotFoundException(\"Filename contains forbidden characters\");\n+            }", "originalCommit": "e98f74d62720ec386f531235cab3c675a5f550f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA2NDEyMA==", "url": "https://github.com/opfab/operatorfabric-core/pull/505#discussion_r501064120", "bodyText": "Ok to check the locale. I think that the version parameter is already validated against the available process versions and if it does not match an Exception is thrown.", "author": "quinarygio", "createdAt": "2020-10-07T14:35:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ5NjQ5NQ=="}], "type": "inlineReview"}, {"oid": "44cae05ed8761be9a6548fea234dce852df2cf5c", "url": "https://github.com/opfab/operatorfabric-core/commit/44cae05ed8761be9a6548fea234dce852df2cf5c", "message": "[OC-1117] Remove template and css arrays in bundle defintion.\n\nSigned-off-by: Giovanni Ferrari <giovanni.ferrari@acotel-group.com>", "committedDate": "2020-10-09T07:06:43Z", "type": "forcePushed"}, {"oid": "35d93c13e7c247887f4af295f88392734876bce6", "url": "https://github.com/opfab/operatorfabric-core/commit/35d93c13e7c247887f4af295f88392734876bce6", "message": "[OC-1117] Remove template and css arrays in bundle defintion.\n\nSigned-off-by: Giovanni Ferrari <giovanni.ferrari@acotel-group.com>", "committedDate": "2020-10-09T08:45:07Z", "type": "commit"}, {"oid": "35d93c13e7c247887f4af295f88392734876bce6", "url": "https://github.com/opfab/operatorfabric-core/commit/35d93c13e7c247887f4af295f88392734876bce6", "message": "[OC-1117] Remove template and css arrays in bundle defintion.\n\nSigned-off-by: Giovanni Ferrari <giovanni.ferrari@acotel-group.com>", "committedDate": "2020-10-09T08:45:07Z", "type": "forcePushed"}]}