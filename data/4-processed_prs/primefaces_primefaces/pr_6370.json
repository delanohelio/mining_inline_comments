{"pr_number": 6370, "pr_title": "Fix #5014: Wrong calculation of width for scrollable tables", "pr_createdAt": "2020-09-29T11:52:05Z", "pr_url": "https://github.com/primefaces/primefaces/pull/6370", "timeline": [{"oid": "a57adc8a2ccc039ed366b0b9692e0977f7a4c9d6", "url": "https://github.com/primefaces/primefaces/commit/a57adc8a2ccc039ed366b0b9692e0977f7a4c9d6", "message": "Fix primefaces#5014: Wrong calculation of width for scrollable tables\n\nif box-sizing is border-box", "committedDate": "2020-09-29T11:51:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MTI2Ng==", "url": "https://github.com/primefaces/primefaces/pull/6370#discussion_r496661266", "bodyText": "indenting issue", "author": "melloware", "createdAt": "2020-09-29T12:04:39Z", "path": "src/main/resources/META-INF/resources/primefaces/datatable/datatable.js", "diffHunk": "@@ -1560,14 +1560,46 @@ PrimeFaces.widget.DataTable = PrimeFaces.widget.DeferredWidget.extend({\n      */\n     setOuterWidth: function(element, width) {\n         if (element.css('box-sizing') === 'border-box') { // Github issue: #5014\n-            var diff = element.outerWidth() - element.width();\n-            element.width(parseFloat(width) - diff);\n+            element.outerWidth(width);\n         }\n         else {\n             element.width(width);\n         }\n     },\n \n+    getColumnWidthInfo: function(col, isIncludeResizeableState) {\n+        var width, isOuterWidth;\n+\n+    \tif(isIncludeResizeableState && this.cfg.multiViewState && this.resizableStateHolder && this.resizableStateHolder.attr('value')) {\n+    \t\twidth = $this.findColWidthInResizableState(col.attr('id'));\n+    \t\tisOuterWidth = false;\n+        }\n+\n+        if(!width) {\n+        \twidth = col[0].style.width;\n+        \tisOuterWidth = width && (col.css('box-sizing') === 'border-box');\n+        }\n+\n+        if(!width) {\n+            width = col.width();\n+            isOuterWidth = false;\n+        }\n+\n+        return {\n+        \twidth: width,\n+            isOuterWidth: isOuterWidth", "originalCommit": "a57adc8a2ccc039ed366b0b9692e0977f7a4c9d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MTMyNg==", "url": "https://github.com/primefaces/primefaces/pull/6370#discussion_r496661326", "bodyText": "indenting issue", "author": "melloware", "createdAt": "2020-09-29T12:04:45Z", "path": "src/main/resources/META-INF/resources/primefaces/datatable/datatable.js", "diffHunk": "@@ -1560,14 +1560,46 @@ PrimeFaces.widget.DataTable = PrimeFaces.widget.DeferredWidget.extend({\n      */\n     setOuterWidth: function(element, width) {\n         if (element.css('box-sizing') === 'border-box') { // Github issue: #5014\n-            var diff = element.outerWidth() - element.width();\n-            element.width(parseFloat(width) - diff);\n+            element.outerWidth(width);\n         }\n         else {\n             element.width(width);\n         }\n     },\n \n+    getColumnWidthInfo: function(col, isIncludeResizeableState) {\n+        var width, isOuterWidth;\n+\n+    \tif(isIncludeResizeableState && this.cfg.multiViewState && this.resizableStateHolder && this.resizableStateHolder.attr('value')) {\n+    \t\twidth = $this.findColWidthInResizableState(col.attr('id'));\n+    \t\tisOuterWidth = false;\n+        }\n+\n+        if(!width) {\n+        \twidth = col[0].style.width;\n+        \tisOuterWidth = width && (col.css('box-sizing') === 'border-box');\n+        }\n+\n+        if(!width) {\n+            width = col.width();\n+            isOuterWidth = false;\n+        }\n+\n+        return {\n+        \twidth: width,\n+            isOuterWidth: isOuterWidth\n+        };\n+    },\n+\n+    applyWidthInfo: function(element, widthInfo) {\n+        if(widthInfo.isOuterWidth) {\n+\t        element.outerWidth(widthInfo.width);", "originalCommit": "a57adc8a2ccc039ed366b0b9692e0977f7a4c9d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2NTMwMA==", "url": "https://github.com/primefaces/primefaces/pull/6370#discussion_r496665300", "bodyText": "I hate my eclipse instance...", "author": "fanste", "createdAt": "2020-09-29T12:11:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2MTMyNg=="}], "type": "inlineReview"}, {"oid": "53076a37ad199a7734a9ef857cbecdb13915994e", "url": "https://github.com/primefaces/primefaces/commit/53076a37ad199a7734a9ef857cbecdb13915994e", "message": "Fix indention", "committedDate": "2020-09-29T12:10:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE2NTIyNw==", "url": "https://github.com/primefaces/primefaces/pull/6370#discussion_r498165227", "bodyText": "Can you add JSDOC to this method and test that the build works with mvn clean package -Pjsdoc please?", "author": "melloware", "createdAt": "2020-10-01T11:13:29Z", "path": "src/main/resources/META-INF/resources/primefaces/datatable/datatable.js", "diffHunk": "@@ -1560,14 +1560,46 @@ PrimeFaces.widget.DataTable = PrimeFaces.widget.DeferredWidget.extend({\n      */\n     setOuterWidth: function(element, width) {\n         if (element.css('box-sizing') === 'border-box') { // Github issue: #5014\n-            var diff = element.outerWidth() - element.width();\n-            element.width(parseFloat(width) - diff);\n+            element.outerWidth(width);\n         }\n         else {\n             element.width(width);\n         }\n     },\n \n+    getColumnWidthInfo: function(col, isIncludeResizeableState) {", "originalCommit": "53076a37ad199a7734a9ef857cbecdb13915994e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzkwMTQ0Ng==", "url": "https://github.com/primefaces/primefaces/pull/6370#discussion_r503901446", "bodyText": "Done", "author": "fanste", "createdAt": "2020-10-13T12:15:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE2NTIyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE2NTI5NA==", "url": "https://github.com/primefaces/primefaces/pull/6370#discussion_r498165294", "bodyText": "JSDoc", "author": "melloware", "createdAt": "2020-10-01T11:13:38Z", "path": "src/main/resources/META-INF/resources/primefaces/datatable/datatable.js", "diffHunk": "@@ -1560,14 +1560,46 @@ PrimeFaces.widget.DataTable = PrimeFaces.widget.DeferredWidget.extend({\n      */\n     setOuterWidth: function(element, width) {\n         if (element.css('box-sizing') === 'border-box') { // Github issue: #5014\n-            var diff = element.outerWidth() - element.width();\n-            element.width(parseFloat(width) - diff);\n+            element.outerWidth(width);\n         }\n         else {\n             element.width(width);\n         }\n     },\n \n+    getColumnWidthInfo: function(col, isIncludeResizeableState) {\n+        var width, isOuterWidth;\n+\n+        if(isIncludeResizeableState && this.cfg.multiViewState && this.resizableStateHolder && this.resizableStateHolder.attr('value')) {\n+            width = $this.findColWidthInResizableState(col.attr('id'));\n+            isOuterWidth = false;\n+        }\n+\n+        if(!width) {\n+            width = col[0].style.width;\n+            isOuterWidth = width && (col.css('box-sizing') === 'border-box');\n+        }\n+\n+        if(!width) {\n+            width = col.width();\n+            isOuterWidth = false;\n+        }\n+\n+        return {\n+            width: width,\n+            isOuterWidth: isOuterWidth\n+        };\n+    },\n+\n+    applyWidthInfo: function(element, widthInfo) {", "originalCommit": "53076a37ad199a7734a9ef857cbecdb13915994e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7eebbb6f63ad55554d452d47e8937877aa315ccd", "url": "https://github.com/primefaces/primefaces/commit/7eebbb6f63ad55554d452d47e8937877aa315ccd", "message": "Add JSDoc for new width-info methods", "committedDate": "2020-10-13T12:14:10Z", "type": "commit"}, {"oid": "1d83b8a048aa3398c1807063c86f2d2c088adfab", "url": "https://github.com/primefaces/primefaces/commit/1d83b8a048aa3398c1807063c86f2d2c088adfab", "message": "Merge branch 'master' into patch-5014", "committedDate": "2021-01-05T20:58:21Z", "type": "commit"}, {"oid": "fca3076695ae83a361c8d231a6469f8b6eacbb15", "url": "https://github.com/primefaces/primefaces/commit/fca3076695ae83a361c8d231a6469f8b6eacbb15", "message": "Update datatable.js", "committedDate": "2021-01-05T21:01:41Z", "type": "commit"}, {"oid": "5ed1f8e10b2ea88eb6e10097b6e2edfcda961a68", "url": "https://github.com/primefaces/primefaces/commit/5ed1f8e10b2ea88eb6e10097b6e2edfcda961a68", "message": "Merge branch 'master' into patch-5014", "committedDate": "2021-02-12T21:31:43Z", "type": "commit"}]}