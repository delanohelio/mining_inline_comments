{"pr_number": 6252, "pr_title": "Fix #4374 menuButton: Add support for submenus", "pr_createdAt": "2020-08-26T10:15:41Z", "pr_url": "https://github.com/primefaces/primefaces/pull/6252", "timeline": [{"oid": "20ecf547c76f719d93106d43cb691bf19ed89c27", "url": "https://github.com/primefaces/primefaces/commit/20ecf547c76f719d93106d43cb691bf19ed89c27", "message": "Fix #4374 menuButton: Add support for submenus", "committedDate": "2020-08-26T09:54:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNzc4NA==", "url": "https://github.com/primefaces/primefaces/pull/6252#discussion_r477227784", "bodyText": "Not sure why you moved this out of the init method?  Usually initialization of values like this is done in the init method.", "author": "melloware", "createdAt": "2020-08-26T11:25:57Z", "path": "src/main/resources/META-INF/resources/primefaces/menu/menu.menubutton.js", "diffHunk": "@@ -54,6 +75,14 @@ PrimeFaces.widget.MenuButton = PrimeFaces.widget.BaseWidget.extend({\n      * @private\n      */\n     bindEvents: function() {\n+        this.menuId = this.jqId + '_menu';\n+        this.button = this.jq.children('button');\n+        this.menu = this.jq.children('.ui-menu');\n+        this.menuitems = this.jq.find('.ui-menuitem');\n+        this.cfg.disabled = this.button.is(':disabled');", "originalCommit": "20ecf547c76f719d93106d43cb691bf19ed89c27", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Nzc5NzkzOQ==", "url": "https://github.com/primefaces/primefaces/pull/6252#discussion_r477797939", "bodyText": "If initialization is in init method, bindEvents called from TieredMenu#init before initialization and raised script error\ncaused by undefined reference.\nBut I found another solution. I'll fix this.\nI'm sorry for my lack of experience with JavaScript.", "author": "maruTA-bis5", "createdAt": "2020-08-27T00:42:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyNzc4NA=="}], "type": "inlineReview"}, {"oid": "6a255bb02bec977990c6ddb53098985b6e081408", "url": "https://github.com/primefaces/primefaces/commit/6a255bb02bec977990c6ddb53098985b6e081408", "message": "remove meaningless initialziation", "committedDate": "2020-08-27T00:33:09Z", "type": "commit"}, {"oid": "0347d94ac35ee27e7ed6950f63dfcc42dcce06fb", "url": "https://github.com/primefaces/primefaces/commit/0347d94ac35ee27e7ed6950f63dfcc42dcce06fb", "message": "move initialization of values into init method", "committedDate": "2020-08-27T00:42:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMzNzQ5Nw==", "url": "https://github.com/primefaces/primefaces/pull/6252#discussion_r478337497", "bodyText": "You can remove the @OverRide and @inheritdoc here as now that you have renamed the method its no longer overriding the parent.", "author": "melloware", "createdAt": "2020-08-27T11:10:44Z", "path": "src/main/resources/META-INF/resources/primefaces/menu/menu.menubutton.js", "diffHunk": "@@ -35,11 +35,37 @@ PrimeFaces.widget.MenuButton = PrimeFaces.widget.BaseWidget.extend({\n         this.cfg.disabled = this.button.is(':disabled');\n \n         if(!this.cfg.disabled) {\n-            this.bindEvents();\n+            this.bindButtonEvents();\n             PrimeFaces.utils.registerDynamicOverlay(this, this.menu, this.id + '_menu');\n         }\n     },\n \n+    /**\n+     * @override\n+     * @inheritdoc\n+     * @param {JQuery} menuitem \n+     * @param {JQuery} submenu \n+     */\n+    showSubmenu: function(menuitem, submenu) {\n+        var pos = {\n+            my: 'left top',\n+            at: 'right top',\n+            of: menuitem,\n+            collision: 'flipfit'\n+        };\n+\n+        //avoid queuing multiple runs\n+        if(this.timeoutId) {\n+            clearTimeout(this.timeoutId);\n+        }\n+\n+        this.timeoutId = setTimeout(function () {\n+           submenu.css('z-index', PrimeFaces.nextZindex())\n+                  .show()\n+                  .position(pos)\n+        }, this.cfg.delay);\n+    },\n+\n     /**\n      * @override", "originalCommit": "0347d94ac35ee27e7ed6950f63dfcc42dcce06fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQyNzAzNQ==", "url": "https://github.com/primefaces/primefaces/pull/6252#discussion_r478427035", "bodyText": "bindButtonEvents method does not have @override and @inheritdoc. This line is for refresh method.", "author": "maruTA-bis5", "createdAt": "2020-08-27T13:40:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMzNzQ5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQzMjYyMQ==", "url": "https://github.com/primefaces/primefaces/pull/6252#discussion_r478432621", "bodyText": "sorry the way the review looks the code folding confused me. I see it in the raw file now.", "author": "melloware", "createdAt": "2020-08-27T13:48:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMzNzQ5Nw=="}], "type": "inlineReview"}]}