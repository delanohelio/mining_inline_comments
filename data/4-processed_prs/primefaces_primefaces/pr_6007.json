{"pr_number": 6007, "pr_title": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "pr_createdAt": "2020-06-07T09:37:33Z", "pr_url": "https://github.com/primefaces/primefaces/pull/6007", "timeline": [{"oid": "e6ffe47badbcb376cae31f29221aa1d7072fc7ed", "url": "https://github.com/primefaces/primefaces/commit/e6ffe47badbcb376cae31f29221aa1d7072fc7ed", "message": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "committedDate": "2020-06-05T19:09:37Z", "type": "commit"}, {"oid": "ba3d6591a83804e8dcc0568c489fda3984157244", "url": "https://github.com/primefaces/primefaces/commit/ba3d6591a83804e8dcc0568c489fda3984157244", "message": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "committedDate": "2020-06-06T05:44:04Z", "type": "commit"}, {"oid": "8c594d39b28394ef32c4239609452e20ed031b9f", "url": "https://github.com/primefaces/primefaces/commit/8c594d39b28394ef32c4239609452e20ed031b9f", "message": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "committedDate": "2020-06-06T10:50:04Z", "type": "commit"}, {"oid": "2b30eb8ab191e3826b26769cd4461d5183c3e3a4", "url": "https://github.com/primefaces/primefaces/commit/2b30eb8ab191e3826b26769cd4461d5183c3e3a4", "message": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "committedDate": "2020-06-06T11:23:40Z", "type": "commit"}, {"oid": "7040fcf7ded9631cf71faf6f5446a82e0f4dbbda", "url": "https://github.com/primefaces/primefaces/commit/7040fcf7ded9631cf71faf6f5446a82e0f4dbbda", "message": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "committedDate": "2020-06-07T09:35:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0OTI1Nw==", "url": "https://github.com/primefaces/primefaces/pull/6007#discussion_r436349257", "bodyText": "@blutorange : Is it right this way? IntelliJ had not been happy because it thought cfg does not contain multiViewState.", "author": "christophs78", "createdAt": "2020-06-07T10:41:14Z", "path": "src/main/resources/META-INF/resources/primefaces/tabview/tabview.js", "diffHunk": "@@ -58,6 +58,7 @@\n  * @prop {boolean} cfg.scrollable When enabled, tab headers can be scrolled horizontally instead of wrapping.\n  * @prop {number} cfg.selected The currently selected tab.\n  * @prop {number} cfg.tabindex Position of the element in the tabbing order.\n+ * @prop {boolean} cfg.multiViewState Whether to keep TabView state across views.", "originalCommit": "7040fcf7ded9631cf71faf6f5446a82e0f4dbbda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM1MTA2Mw==", "url": "https://github.com/primefaces/primefaces/pull/6007#discussion_r436351063", "bodyText": "@christophs78 Looks good to me. The IDE support for the JSDocs is not perfect, we would probably have to switch to ES6 classes and/or TypeScript for that. That said, IntelliJ probably reads the current PrimeFaces.d.ts file, where this property does not exist yet. That file is generated automatically via mvn clean install -P release I guess we should run that occasionally and commit the generated files.\nAlso, once you open a PR, the Travis build check whether the JSDocs are valid. You can also check that locally by running mvn clean install -P jsdoc (see also the readme https://github.com/primefaces/primefaces/blob/master/src/main/type-definitions/README.md#build)", "author": "blutorange", "createdAt": "2020-06-07T11:04:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0OTI1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0OTU4Mw==", "url": "https://github.com/primefaces/primefaces/pull/6007#discussion_r436349583", "bodyText": "For dynamic=\"true\" we have activeIndex on the server. Also when tabview includes tabChange-Ajax-Event.\nThis tries to send activeIndex-updates to the server for the other usecases. Is there a other (better) way to do this. (At least this way seems to work.)\nAnd i have to remove the comment afterwards.", "author": "christophs78", "createdAt": "2020-06-07T10:45:50Z", "path": "src/main/resources/META-INF/resources/primefaces/tabview/tabview.js", "diffHunk": "@@ -459,8 +461,36 @@ PrimeFaces.widget.TabView = PrimeFaces.widget.DeferredWidget.extend({\n         else {\n             this.show(newPanel);\n \n-            if(this.hasBehavior('tabChange') && !silent) {\n-                this.fireTabChangeEvent(newPanel);\n+            if (!silent) {\n+                if (this.hasBehavior('tabChange')) {\n+                    this.fireTabChangeEvent(newPanel);\n+                }\n+                else if (this.cfg.multiViewState) {\n+                    var options = {\n+                        source: this.id,\n+                        partialSubmit: true,\n+                        /*\n+                        TODO: How to set partialSubmitFilter to only send and process activeIndex-hidden-field to the server?\n+                        partialSubmitFilter: \"@none\",\n+                        partialSubmitFilter: \":input:hidden\",\n+                        partialSubmitFilter: \"@form:\" + this.id + '_activeIndex',\n+                        partialSubmitFilter: \":\" + this.cfg.formId + \":\" + this.id + '_activeIndex',\n+                        partialSubmitFilter: \"@form:\" + this.id + '_activeIndex',\n+                        partialSubmitFilter: this.id + '_activeIndex',\n+\n+                        process: \"@none\",\n+                        process: this.id + '_activeIndex',\n+                         */\n+                        partialSubmitFilter: this.id + '_activeIndex',\n+                        process: this.id,\n+                        ignoreAutoUpdate: true,\n+                        params: [\n+                            {name: this.id + '_activeIndex', value: this.getActiveIndex()}\n+                        ]\n+                    };\n+\n+                    PrimeFaces.ajax.Request.handle(options);\n+                }", "originalCommit": "7040fcf7ded9631cf71faf6f5446a82e0f4dbbda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM1NjAxMg==", "url": "https://github.com/primefaces/primefaces/pull/6007#discussion_r436356012", "bodyText": "To me this seems perfectly reasonable to do.", "author": "melloware", "createdAt": "2020-06-07T12:03:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0OTU4Mw=="}], "type": "inlineReview"}, {"oid": "d9dd7147c6cb5e6904f3e37710f9a59ab4ba9ed2", "url": "https://github.com/primefaces/primefaces/commit/d9dd7147c6cb5e6904f3e37710f9a59ab4ba9ed2", "message": "Implement #5987: TabView: add multiViewState to keep activeIndex across views", "committedDate": "2020-06-07T14:32:04Z", "type": "commit"}]}