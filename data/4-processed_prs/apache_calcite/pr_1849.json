{"pr_number": 1849, "pr_title": "[CALCITE-3815] Add missing SQL standard aggregate functions: EVERY, SO\u2026", "pr_createdAt": "2020-03-09T01:23:47Z", "pr_url": "https://github.com/apache/calcite/pull/1849", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0MjI1Ng==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r389442256", "bodyText": "Since SOME and EVERY are also SQL standard aggregate functions, should we add them in ReservedFunctionNames?", "author": "DonnyZone", "createdAt": "2020-03-09T02:47:05Z", "path": "core/src/main/codegen/templates/Parser.jj", "diffHunk": "@@ -6405,6 +6423,7 @@ SqlIdentifier ReservedFunctionName() :\n     |   <FIRST_VALUE>\n     |   <FLOOR>\n     |   <FUSION>\n+    |   <INTERSECTION>", "originalCommit": "06bbf26434209f3e97dfa3f3f5111a5ffb02c164", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDc0OTIzMw==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r390749233", "bodyText": "Thanks @DonnyZone  for the review. I put the comment for this question in JIRA. Please kindly refer to it and let me know  if I am missing anything.", "author": "HanumathRao", "createdAt": "2020-03-11T05:12:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0MjI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0MzE5NQ==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r389443195", "bodyText": "nitpicking: keep the indent style for new line, or put them in the same line", "author": "DonnyZone", "createdAt": "2020-03-09T02:52:16Z", "path": "core/src/main/java/org/apache/calcite/adapter/enumerable/RexImpTable.java", "diffHunk": "@@ -1540,6 +1542,43 @@ public Expression implementResult(AggContext info,\n     }\n   }\n \n+  /** Implementor for the {@code INTERSECTION} aggregate function. */\n+  static class IntersectionImplementor extends StrictAggImplementor {\n+    @Override protected void implementNotNullReset(AggContext info,\n+                                                   AggResetContext reset) {", "originalCommit": "06bbf26434209f3e97dfa3f3f5111a5ffb02c164", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0NDk4OA==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r389444988", "bodyText": "If no rows are selected, the result is NULL\n\nIs this an expected behavior?", "author": "DonnyZone", "createdAt": "2020-03-09T03:02:50Z", "path": "site/_docs/reference.md", "diffHunk": "@@ -1766,12 +1766,15 @@ and `LISTAGG`).\n | COUNT( [ ALL &#124; DISTINCT ] value [, value ]*) | Returns the number of input rows for which *value* is not null (wholly not null if *value* is composite)\n | COUNT(*)                           | Returns the number of input rows\n | FUSION(multiset)                   | Returns the multiset union of *multiset* across all input values\n+| INTERSECTION(multiset)             | Returns the multiset intersection of *multiset* across all input values\n | APPROX_COUNT_DISTINCT(value [, value ]*)      | Returns the approximate number of distinct values of *value*; the database is allowed to use an approximation but is not required to\n | AVG( [ ALL &#124; DISTINCT ] numeric)         | Returns the average (arithmetic mean) of *numeric* across all input values\n | SUM( [ ALL &#124; DISTINCT ] numeric)         | Returns the sum of *numeric* across all input values\n | MAX( [ ALL &#124; DISTINCT ] value)           | Returns the maximum value of *value* across all input values\n | MIN( [ ALL &#124; DISTINCT ] value)           | Returns the minimum value of *value* across all input values\n | ANY_VALUE( [ ALL &#124; DISTINCT ] value)     | Returns one of the values of *value* across all input values; this is NOT specified in the SQL standard\n+| SOME( [ condition ] )                         | Returns true if any expression is true. If no rows are selected, the result is NULL", "originalCommit": "06bbf26434209f3e97dfa3f3f5111a5ffb02c164", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDc0OTM4OA==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r390749388", "bodyText": "I assumed that the semantics for SOME and EVERY are similar to MIN and MAX respectively. Please let me know if it is misleading, I will remove it.", "author": "HanumathRao", "createdAt": "2020-03-11T05:13:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0NDk4OA=="}], "type": "inlineReview"}, {"oid": "372f4f9a907eae5dbb6a944408b4e468dc986fc2", "url": "https://github.com/apache/calcite/commit/372f4f9a907eae5dbb6a944408b4e468dc986fc2", "message": "[CALCITE-3815] Addressing review comments.", "committedDate": "2020-03-11T04:45:41Z", "type": "forcePushed"}, {"oid": "bcdb1287c452b4952a9e4959741977b3057af2d2", "url": "https://github.com/apache/calcite/commit/bcdb1287c452b4952a9e4959741977b3057af2d2", "message": "[CALCITE-3815] fixing the SOME and EVERY function to use ReservedFunctionName.", "committedDate": "2020-03-13T05:35:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjA1MTE5MA==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r392051190", "bodyText": "Please also add INTERSECTION in AGGREGATE EnumSet [1].\n[1] \n  \n    \n      calcite/core/src/main/java/org/apache/calcite/sql/SqlKind.java\n    \n    \n         Line 1159\n      in\n      4c3cef9\n    \n    \n    \n    \n\n        \n          \n           public static final EnumSet<SqlKind> AGGREGATE =", "author": "DonnyZone", "createdAt": "2020-03-13T06:31:27Z", "path": "core/src/main/java/org/apache/calcite/sql/SqlKind.java", "diffHunk": "@@ -966,6 +966,9 @@\n   /** The {@code FUSION} aggregate function. */\n   FUSION,\n \n+  /** The {@code INTERSECTION} aggregate function. */\n+  INTERSECTION,", "originalCommit": "bcdb1287c452b4952a9e4959741977b3057af2d2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM1NjUzNw==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r392356537", "bodyText": "@DonnyZone  Thank you for the suggestion. I added INTESECTION, to the Aggregate enumset. I also noticed that ANY_VALUE was missing, so added it.", "author": "HanumathRao", "createdAt": "2020-03-13T17:02:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjA1MTE5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU1NTQzNQ==", "url": "https://github.com/apache/calcite/pull/1849#discussion_r392555435", "bodyText": "That's great! Thanks;)", "author": "DonnyZone", "createdAt": "2020-03-14T04:22:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjA1MTE5MA=="}], "type": "inlineReview"}, {"oid": "741b7f1ad37012bf3f8bd95fcc2de6fb14303aac", "url": "https://github.com/apache/calcite/commit/741b7f1ad37012bf3f8bd95fcc2de6fb14303aac", "message": "[CALCITE-3815] Add missing SQL standard aggregate functions: EVERY, SOME, INTERSECTION", "committedDate": "2020-03-13T16:21:27Z", "type": "commit"}, {"oid": "741b7f1ad37012bf3f8bd95fcc2de6fb14303aac", "url": "https://github.com/apache/calcite/commit/741b7f1ad37012bf3f8bd95fcc2de6fb14303aac", "message": "[CALCITE-3815] Add missing SQL standard aggregate functions: EVERY, SOME, INTERSECTION", "committedDate": "2020-03-13T16:21:27Z", "type": "forcePushed"}]}