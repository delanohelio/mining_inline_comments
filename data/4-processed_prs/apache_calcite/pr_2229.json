{"pr_number": 2229, "pr_title": "Update release instructions", "pr_createdAt": "2020-10-23T09:12:30Z", "pr_url": "https://github.com/apache/calcite/pull/2229", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyODQ3MQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r511028471", "bodyText": "Give an example commit that people can cherry-pick.", "author": "julianhyde", "createdAt": "2020-10-23T17:19:57Z", "path": "site/_docs/howto.md", "diffHunk": "@@ -990,6 +992,12 @@ address. You can use\n [the 1.20.0 announcement](https://mail-archives.apache.org/mod_mbox/www-announce/201906.mbox/%3CCA%2BEpF8tcJcZ41rVuwJODJmyRy-qAxZUQm9OxKsoDi07c2SKs_A%40mail.gmail.com%3E)\n as a template. Be sure to include a brief description of the project.\n \n+Finally, increase the `calcite.version` value in `/gradle.properties` and commit & push", "originalCommit": "f45aca47cc260f87b9ca51c57a9a60a8b9d10f99", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyODU3Ng==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r511028576", "bodyText": "Remove 'finally'.", "author": "julianhyde", "createdAt": "2020-10-23T17:20:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyODQ3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc1NzgzOQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r519757839", "bodyText": "Modified.", "author": "rubenada", "createdAt": "2020-11-09T12:03:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyODQ3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyOTQyNA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r511029424", "bodyText": "Change to 'Re-open the master branch. Send an email ...'. Documentation is clearer if you lead with the purpose/high-level action.", "author": "julianhyde", "createdAt": "2020-10-23T17:21:45Z", "path": "site/_docs/howto.md", "diffHunk": "@@ -990,6 +992,12 @@ address. You can use\n [the 1.20.0 announcement](https://mail-archives.apache.org/mod_mbox/www-announce/201906.mbox/%3CCA%2BEpF8tcJcZ41rVuwJODJmyRy-qAxZUQm9OxKsoDi07c2SKs_A%40mail.gmail.com%3E)\n as a template. Be sure to include a brief description of the project.\n \n+Finally, increase the `calcite.version` value in `/gradle.properties` and commit & push\n+the change with the message \"Prepare for next development iteration\".\n+\n+Send an email to [dev@calcite.apache.org](mailto:dev@calcite.apache.org) notifying\n+that `master` code freeze is over and commits can resume.", "originalCommit": "f45aca47cc260f87b9ca51c57a9a60a8b9d10f99", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc1NjU1MA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r519756550", "bodyText": "Changed", "author": "rubenada", "createdAt": "2020-11-09T12:01:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyOTQyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMDE0NQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r511030145", "bodyText": "Move the 'upload your key' to the 'set up signing keys' section. Maybe add a troubleshooting point 'If xxx happens make sure that you uploaded your key to ubuntu'.", "author": "julianhyde", "createdAt": "2020-10-23T17:23:09Z", "path": "site/_docs/howto.md", "diffHunk": "@@ -684,8 +684,14 @@ Note: release artifacts (dist.apache.org and repository.apache.org) are managed\n \n Before you start:\n \n+* Send an email to [dev@calcite.apache.org](mailto:dev@calcite.apache.org) notifying that RC build process\n+  is starting and therefore `master` branch is in code freeze until further notice.\n * Set up signing keys as described above.\n+* Upload your key to [https://keyserver.ubuntu.com](https://keyserver.ubuntu.com) and/or\n+  [http://pool.sks-keyservers.net:11371](http://pool.sks-keyservers.net:11371) (keyservers used by Nexus).", "originalCommit": "f45aca47cc260f87b9ca51c57a9a60a8b9d10f99", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc3NDcwMg==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r511774702", "bodyText": "Also notice that upload the key is only needed for the first time release manager.", "author": "danny0405", "createdAt": "2020-10-26T08:04:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMDE0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc1Nzk5MQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r519757991", "bodyText": "Changed.", "author": "rubenada", "createdAt": "2020-11-09T12:04:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMDE0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMDc4NA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r511030784", "bodyText": "You can check by doing something like 'git checkout site; git rebase -i master'.", "author": "julianhyde", "createdAt": "2020-10-23T17:24:26Z", "path": "site/_docs/howto.md", "diffHunk": "@@ -684,8 +684,14 @@ Note: release artifacts (dist.apache.org and repository.apache.org) are managed\n \n Before you start:\n \n+* Send an email to [dev@calcite.apache.org](mailto:dev@calcite.apache.org) notifying that RC build process\n+  is starting and therefore `master` branch is in code freeze until further notice.\n * Set up signing keys as described above.\n+* Upload your key to [https://keyserver.ubuntu.com](https://keyserver.ubuntu.com) and/or\n+  [http://pool.sks-keyservers.net:11371](http://pool.sks-keyservers.net:11371) (keyservers used by Nexus).\n * Make sure you are using JDK 8 (not 9 or 10).\n+* Make sure `master` branch and `site` branch are in sync, i.e. there is no commit on `site` that has not\n+  been applied also to `master`. If this the case, cherry-pick the missing commit(s) into `master`.", "originalCommit": "f45aca47cc260f87b9ca51c57a9a60a8b9d10f99", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "05f092314070febc4f7f214d8b48fad595b0caa2", "url": "https://github.com/apache/calcite/commit/05f092314070febc4f7f214d8b48fad595b0caa2", "message": "Update release instructions", "committedDate": "2020-10-26T09:23:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516059392", "bodyText": "If they are not in sync, cherry-pick the missing commit(s) into master.\n\nThis is exactly what git checkout site; git rebase -i master does, so it might be misleading to recommend rebase -i master and then suggest to cherry-pick.", "author": "vlsi", "createdAt": "2020-11-02T15:39:53Z", "path": "site/_docs/howto.md", "diffHunk": "@@ -684,8 +688,13 @@ Note: release artifacts (dist.apache.org and repository.apache.org) are managed\n \n Before you start:\n \n+* Send an email to [dev@calcite.apache.org](mailto:dev@calcite.apache.org) notifying that RC build process\n+  is starting and therefore `master` branch is in code freeze until further notice.\n * Set up signing keys as described above.\n * Make sure you are using JDK 8 (not 9 or 10).\n+* Make sure `master` branch and `site` branch are in sync, i.e. there is no commit on `site` that has not\n+  been applied also to `master`. You can check by doing `git checkout site; git rebase -i master`.\n+  If they are not in sync, cherry-pick the missing commit(s) into `master`.", "originalCommit": "05f092314070febc4f7f214d8b48fad595b0caa2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA2NzUzNQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516067535", "bodyText": "You're right, I will re-phrase it.", "author": "rubenada", "createdAt": "2020-11-02T15:50:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA3Mjc3OQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516072779", "bodyText": "It would be nice to publish documentation for all the versions (all released and the current development), then we could drop site branch altogether :)", "author": "vlsi", "createdAt": "2020-11-02T15:58:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA3Nzc1NA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516077754", "bodyText": "Agree, there was a discussion about that some time ago [1], but I think no action has been taken in that direction.\n[1] https://lists.apache.org/thread.html/0d9829f7e32f51bc03fc350fe7c782c03dedb2ecca90e983917abf53%40%3Cdev.calcite.apache.org%3E", "author": "rubenada", "createdAt": "2020-11-02T16:04:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA5MDUzNA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516090534", "bodyText": "@vlsi correct me if I'm wrong. The goal of this point is to ensure that \"there is no commit on site that has not been applied also to master\", otherwise we should apply these commits (onto master).\nDoing a git checkout site; git rebase -i master will point the commits on site that are not in master (if any); but will not modify the master branch. That is why the cherry-pick tried to express; or am I wrong?", "author": "rubenada", "createdAt": "2020-11-02T16:23:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEwMDQ3MA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516100470", "bodyText": "You are right. Something like git checkout master; git reset --hard site is required to update master to the \"new site\".", "author": "vlsi", "createdAt": "2020-11-02T16:36:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEwNTYzOQ==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516105639", "bodyText": "We need to be careful because there can be site-related commits in master that are not in site, this is \"allowed\" and we must not lose them.\nHaving commits in site that are not in master should not happen, but it can be possible if someone makes a (small) mistake.\nAll in all, I think the current phrase (git checkout site; git rebase -i master + cherry-pick any missing commits into master) might be the safest approach to achieve this without losing any master commit. wdyt?", "author": "rubenada", "createdAt": "2020-11-02T16:43:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEyMjEyOA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r516122128", "bodyText": "AFAIK git switch site; git rebase --empty=drop master; git switch master; git reset --hard site should so the trick.\nFrankly speaking, the key problem for me was to understand the intention behind site vs master branch. The actual commands are not that hard once you understand why site and master can differ.", "author": "vlsi", "createdAt": "2020-11-02T17:06:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc1NzM4NA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r519757384", "bodyText": "Ok, rephrased. I'll trust you on this git magic :)", "author": "rubenada", "createdAt": "2020-11-09T12:03:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc3NjMwNA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r519776304", "bodyText": "Oh, I guess it would be better to use git switch site && git rebase --empty=drop master && git switch master && git reset --hard site to avoid accidental git reset --hard in case one of the previous commands fail :)", "author": "vlsi", "createdAt": "2020-11-09T12:39:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgwODQ3MA==", "url": "https://github.com/apache/calcite/pull/2229#discussion_r519808470", "bodyText": "OK, changed.", "author": "rubenada", "createdAt": "2020-11-09T13:19:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA1OTM5Mg=="}], "type": "inlineReview"}, {"oid": "1f3945e2ca16b956c0eee43874764653d595942c", "url": "https://github.com/apache/calcite/commit/1f3945e2ca16b956c0eee43874764653d595942c", "message": "Update release instructions", "committedDate": "2020-11-09T12:00:02Z", "type": "forcePushed"}, {"oid": "abf4bdc8b2533386ef0ce8f5e01335bc93d4c14b", "url": "https://github.com/apache/calcite/commit/abf4bdc8b2533386ef0ce8f5e01335bc93d4c14b", "message": "Update release instructions", "committedDate": "2020-11-09T13:17:54Z", "type": "commit"}, {"oid": "abf4bdc8b2533386ef0ce8f5e01335bc93d4c14b", "url": "https://github.com/apache/calcite/commit/abf4bdc8b2533386ef0ce8f5e01335bc93d4c14b", "message": "Update release instructions", "committedDate": "2020-11-09T13:17:54Z", "type": "forcePushed"}]}