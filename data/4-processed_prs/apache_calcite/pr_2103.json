{"pr_number": 2103, "pr_title": "[CALCITE-4171] Support named parameters for table window functions", "pr_createdAt": "2020-08-10T12:44:55Z", "pr_url": "https://github.com/apache/calcite/pull/2103", "timeline": [{"oid": "aadb605decd6bb6a853e23fac4b0f479b2397e06", "url": "https://github.com/apache/calcite/commit/aadb605decd6bb6a853e23fac4b0f479b2397e06", "message": "[CALCITE-4167] Group by COALESCE IN throws NullPointerException\n\nThe root cause is that the COALESCE operand type was wrongly replaced by\n`SqlToRelConverter#adjustInputRef`, actually, for an agg as bb root, there\nis no need to do such adjust. Because the nullability does not change and\nthe agg type is not same with the bb's scope.\n\nTweak the `#adjustInputRef` to only fix type nullability, if there\nare cases that the type name also changes, just return the original node\nand let the subsequent conversion work flow throw.", "committedDate": "2020-08-10T03:19:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA3MjkxMA==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r468072910", "bodyText": "This is really nice. I actually tried to add named parameter support but failed on making non-scalar case (i.e. table function) work.\nI wasn't aware that this can be as simple as override this parameter in SqlArgumentAssignmentOperator.java", "author": "amaliujia", "createdAt": "2020-08-10T17:45:30Z", "path": "core/src/main/java/org/apache/calcite/sql/fun/SqlArgumentAssignmentOperator.java", "diffHunk": "@@ -47,4 +47,8 @@\n     writer.keyword(getName());\n     call.operand(0).unparse(writer, getRightPrec(), rightPrec);\n   }\n+\n+  @Override public boolean argumentMustBeScalar(int ordinal) {\n+    return false;", "originalCommit": "613a7839366af41ace767d770ef57b38b0cc545a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "00cdab0e549916c408ba200daa72d6d9133bd605", "url": "https://github.com/apache/calcite/commit/00cdab0e549916c408ba200daa72d6d9133bd605", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as operand\n* In SqlCallBinding, matches the permuted operand by name with name matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-11T04:39:32Z", "type": "forcePushed"}, {"oid": "b1a3c39a4a0ea5af5f5d43f97fae1b3f6e3ab4e6", "url": "https://github.com/apache/calcite/commit/b1a3c39a4a0ea5af5f5d43f97fae1b3f6e3ab4e6", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as operand\n* In SqlCallBinding, matches the permuted operand by name with name matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-11T04:45:23Z", "type": "forcePushed"}, {"oid": "ea97a42e6773b1a4397770c9359dfff291152449", "url": "https://github.com/apache/calcite/commit/ea97a42e6773b1a4397770c9359dfff291152449", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as operand\n* In SqlCallBinding, matches the permuted operand by name with name matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-11T05:27:57Z", "type": "forcePushed"}, {"oid": "283b736cb84220176a08453e8434bb38e9fbfd1b", "url": "https://github.com/apache/calcite/commit/283b736cb84220176a08453e8434bb38e9fbfd1b", "message": "[CALCITE-4167] Group by COALESCE IN throws NullPointerException\n\nThe root cause is that the COALESCE operand type was wrongly replaced by\n`SqlToRelConverter#adjustInputRef`, actually, for an agg as bb root, there\nis no need to do such adjust. Because the nullability does not change and\nthe agg type is not same with the bb's scope.\n\nTweak the `#adjustInputRef` to only fix type nullability, if there\nare cases that the type name also changes, just return the original node\nand let the subsequent conversion work flow throw.", "committedDate": "2020-08-11T08:12:56Z", "type": "forcePushed"}, {"oid": "8408237cd81ea61ef0a4e00fa7bb7ddbc4fe6f6b", "url": "https://github.com/apache/calcite/commit/8408237cd81ea61ef0a4e00fa7bb7ddbc4fe6f6b", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as operand\n* In SqlCallBinding, matches the permuted operand by name with name matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-11T08:21:20Z", "type": "forcePushed"}, {"oid": "a8366ac62a6cfedaf8c67fd3eb051756d72f9675", "url": "https://github.com/apache/calcite/commit/a8366ac62a6cfedaf8c67fd3eb051756d72f9675", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as operand\n* In SqlCallBinding, matches the permuted operand by name with name matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-11T08:45:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk2NjIyNA==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r468966224", "bodyText": "Why use i < descriptors + 1 rather than i <= descriptors?", "author": "chunweilei", "createdAt": "2020-08-12T02:18:02Z", "path": "core/src/main/java/org/apache/calcite/sql/SqlWindowTableFunction.java", "diffHunk": "@@ -66,7 +86,53 @@ protected boolean throwValidationSignatureErrorOrReturnFalse(SqlCallBinding call\n     }\n   }\n \n-  protected void validateColumnNames(SqlValidator validator,\n+  /**\n+   * Validate the heading operands are in the form:\n+   * (ROW, DESCRIPTOR, DESCRIPTOR ..., other params).\n+   *\n+   * @param callBinding The call binding\n+   * @param descriptors The number of descriptors following the first operand (e.g. the table)\n+   *\n+   * @return true if validation passes\n+   */\n+  protected boolean validateTableWithFollowingDescriptors(\n+      SqlCallBinding callBinding, int descriptors) {\n+    final SqlNode operand0 = callBinding.operand(0);\n+    final SqlValidator validator = callBinding.getValidator();\n+    final RelDataType type = validator.getValidatedNodeType(operand0);\n+    if (type.getSqlTypeName() != SqlTypeName.ROW) {\n+      return false;\n+    }\n+    for (int i = 1; i < descriptors + 1; i++) {\n+      final SqlNode operand = callBinding.operand(i);", "originalCommit": "a8366ac62a6cfedaf8c67fd3eb051756d72f9675", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAzNjkxMg==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469036912", "bodyText": "Because the descriptors  represent the number of the descriptors.", "author": "danny0405", "createdAt": "2020-08-12T06:39:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk2NjIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTA1OTI4MQ==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469059281", "bodyText": "i <= descriptors is better since it has fewer operations.", "author": "chunweilei", "createdAt": "2020-08-12T07:27:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk2NjIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxOTIyNw==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469619227", "bodyText": "Hi @danny0405\nany suggestions on https://issues.apache.org/jira/browse/CALCITE-3780?focusedCommentId=17169620&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17169620?\nYour change will assume that the structure of window table functions be row, (ROW, DESCRIPTOR, DESCRIPTOR ..., other params), in the comment we are thinking to make key descriptor of SESSION as optional, which might mean it will be moved to the last of the arguments so it becomes SESSION(data TABLE, ts DESCRIPTOR, gap interval, key DESCRIPTOR optional)", "author": "amaliujia", "createdAt": "2020-08-13T00:19:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk2NjIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgxMjQwNw==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469812407", "bodyText": "I think it is still straight-forward when it is the form (ROW, DESCRIPTOR ..., other params), in this form, we always assume that the DESCRIPTOR has the column as the time column.", "author": "danny0405", "createdAt": "2020-08-13T09:14:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk2NjIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0ODQ0OQ==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r470248449", "bodyText": "Ok. I will take a look what is the best way when authoring that PR.", "author": "amaliujia", "createdAt": "2020-08-13T21:06:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk2NjIyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyOTYxMA==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469029610", "bodyText": "does the order of parameters matter?", "author": "chunweilei", "createdAt": "2020-08-12T06:20:23Z", "path": "core/src/test/java/org/apache/calcite/test/SqlValidatorTest.java", "diffHunk": "@@ -10287,13 +10287,41 @@ private void checkCustomColumnResolving(String table) {\n   }\n \n   @Test public void testTumbleTableFunction() {\n-    sql(\"select * from table(\\n\"\n-        + \"^tumble(table orders, descriptor(rowtime))^)\")\n-        .fails(\"Invalid number of arguments to function 'TUMBLE'. Was expecting 3 arguments\");\n     sql(\"select rowtime, productid, orderid, 'window_start', 'window_end' from table(\\n\"\n         + \"tumble(table orders, descriptor(rowtime), interval '2' hour))\").ok();\n     sql(\"select rowtime, productid, orderid, 'window_start', 'window_end' from table(\\n\"\n         + \"tumble(table orders, descriptor(rowtime), interval '2' hour, interval '1' hour))\").ok();\n+    // test named params.\n+    sql(\"select rowtime, productid, orderid, 'window_start', 'window_end'\\n\"\n+        + \"from table(\\n\"\n+        + \"tumble(\\n\"\n+        + \"data => table orders,\\n\"\n+        + \"timecol => descriptor(rowtime),\\n\"\n+        + \"size => interval '2' hour))\").ok();\n+    sql(\"select rowtime, productid, orderid, 'window_start', 'window_end'\\n\"\n+        + \"from table(\\n\"\n+        + \"tumble(\\n\"\n+        + \"data => table orders,\\n\"\n+        + \"timecol => descriptor(rowtime),\\n\"\n+        + \"size => interval '2' hour,\\n\"\n+        + \"\\\"OFFSET\\\" => interval '1' hour))\").ok();\n+    // negative tests.\n+    sql(\"select rowtime, productid, orderid, 'window_start', 'window_end'\\n\"\n+        + \"from table(\\n\"\n+        + \"tumble(\\n\"\n+        + \"^\\\"data\\\"^ => table orders,\\n\"\n+        + \"TIMECOL => descriptor(rowtime),\\n\"\n+        + \"SIZE => interval '2' hour))\")\n+        .fails(\"Param 'data' not found in function 'TUMBLE'; did you mean 'DATA'\\\\?\");", "originalCommit": "a8366ac62a6cfedaf8c67fd3eb051756d72f9675", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAzNjM1NA==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469036354", "bodyText": "No, but only the first data param, because for a table function, only the first param can be a query.", "author": "danny0405", "createdAt": "2020-08-12T06:37:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyOTYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTA1OTY5Mw==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469059693", "bodyText": "Should we add some tests about it? (Ignore it if it already has)", "author": "chunweilei", "createdAt": "2020-08-12T07:28:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyOTYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEzMjEwMw==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469132103", "bodyText": "Already added in the SqlToRelConverterTest.", "author": "danny0405", "createdAt": "2020-08-12T09:34:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyOTYxMA=="}], "type": "inlineReview"}, {"oid": "d900acad2a4e9db2a5e0f5f72f8cbdea8ab6227d", "url": "https://github.com/apache/calcite/commit/d900acad2a4e9db2a5e0f5f72f8cbdea8ab6227d", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false\n* Replace column window_start with wstart, window_end with wend as\n  suggesed in the One SQL paper", "committedDate": "2020-08-12T07:10:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxMDMxMg==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469610312", "bodyText": "Note that I asked one of the authors of the \"one sql to rule them all\" paper. The only reason that they use wstart and wend was because of the layout for a paper. I got suggestion to use window_start and window_end.\nI also believe in a JIRA or an email (sorry I cannot recall which one it is) we agreed to switch to window_start and window_end.\nSo I will suggest we keep window_start and window_end, which can be understood easier than wstart/wend.", "author": "amaliujia", "createdAt": "2020-08-12T23:53:36Z", "path": "core/src/main/java/org/apache/calcite/sql/SqlWindowTableFunction.java", "diffHunk": "@@ -98,8 +173,8 @@ private static RelDataType inferRowType(SqlOperatorBinding opBinding) {\n     return typeFactory.builder()\n         .kind(inputRowType.getStructKind())\n         .addAll(inputRowType.getFieldList())\n-        .add(\"window_start\", timestampType)\n-        .add(\"window_end\", timestampType)\n+        .add(\"wstart\", timestampType)\n+        .add(\"wend\", timestampType)", "originalCommit": "d900acad2a4e9db2a5e0f5f72f8cbdea8ab6227d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYzNDEyOQ==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469634129", "bodyText": "Well, I didn\u2019t notice that, can you share the discussion?", "author": "danny0405", "createdAt": "2020-08-13T01:01:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxMDMxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY0MjYzMA==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469642630", "bodyText": "I will spend some time to search for that JIRA.", "author": "amaliujia", "createdAt": "2020-08-13T01:25:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxMDMxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc0Nzg0OA==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469747848", "bodyText": "ok. I might or might not discussed this in Calcite (because I cannot find a JIRA that about it), but\n\n\nThis is the acknowledge from Kenneth Knowles, one of the paper authors: https://docs.google.com/document/d/138uA7VTpbF84CFrd--cz3YVe0-AQ9ALnsavaSE2JeE4/edit?disco=AAAAEAjWvxg\n\n\nI started to use window_start and window_end in https://issues.apache.org/jira/browse/CALCITE-3272. Julian, as another paper author, didn't against it I think.", "author": "amaliujia", "createdAt": "2020-08-13T07:21:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxMDMxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgxMjc0Ng==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r469812746", "bodyText": "Thanks for the share, i have reverted the rename back.", "author": "danny0405", "createdAt": "2020-08-13T09:14:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxMDMxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0ODQ4Nw==", "url": "https://github.com/apache/calcite/pull/2103#discussion_r470248487", "bodyText": "Thank you!", "author": "amaliujia", "createdAt": "2020-08-13T21:06:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYxMDMxMg=="}], "type": "inlineReview"}, {"oid": "970f8107a622860949dcba840823732dd7c4c351", "url": "https://github.com/apache/calcite/commit/970f8107a622860949dcba840823732dd7c4c351", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-13T08:28:22Z", "type": "forcePushed"}, {"oid": "1dde91dd4734bba38f358d5797f4607083d04bbb", "url": "https://github.com/apache/calcite/commit/1dde91dd4734bba38f358d5797f4607083d04bbb", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-14T08:41:34Z", "type": "forcePushed"}, {"oid": "2888ce904d8bd0414459f01facd149ae8ebd3026", "url": "https://github.com/apache/calcite/commit/2888ce904d8bd0414459f01facd149ae8ebd3026", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic\n* Add SqlOperator#paramFallbackToDefault to decide if to replace the\n  non-specified param with a DEFAULT call, for SqlWindowTableFunction,\n  it always return false", "committedDate": "2020-08-14T08:43:46Z", "type": "forcePushed"}, {"oid": "42f6d0dabe4ddc93552dfea0e898229430de1c42", "url": "https://github.com/apache/calcite/commit/42f6d0dabe4ddc93552dfea0e898229430de1c42", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same logic", "committedDate": "2020-08-14T08:56:21Z", "type": "forcePushed"}, {"oid": "60af4aaf492929b677cee28eb0800369c723cb17", "url": "https://github.com/apache/calcite/commit/60af4aaf492929b677cee28eb0800369c723cb17", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same\n  logic\n* Do not patch up the SqlWindowTableFunction with DEFAULTs when sql\n  validation", "committedDate": "2020-08-17T05:44:44Z", "type": "forcePushed"}, {"oid": "8ab35a73f78a63770bd77082ba0970f7cba7fe3c", "url": "https://github.com/apache/calcite/commit/8ab35a73f78a63770bd77082ba0970f7cba7fe3c", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same\n  logic\n* Do not patch up the SqlWindowTableFunction with DEFAULTs when sql\n  validation", "committedDate": "2020-08-18T02:20:28Z", "type": "commit"}, {"oid": "8ab35a73f78a63770bd77082ba0970f7cba7fe3c", "url": "https://github.com/apache/calcite/commit/8ab35a73f78a63770bd77082ba0970f7cba7fe3c", "message": "[CALCITE-4171] Support named parameters for table window functions\n\n[CALCITE-4171] Support named parameters for table window functions\n\n* Changes SqlArgumentAssignmentOperator to allow non-scala query as\n  operand\n* In SqlCallBinding, matches the permuted operand by name with name\n  matcher\n* Refactor SqlWindowTableFunction and its sub-class to reuse same\n  logic\n* Do not patch up the SqlWindowTableFunction with DEFAULTs when sql\n  validation", "committedDate": "2020-08-18T02:20:28Z", "type": "forcePushed"}]}