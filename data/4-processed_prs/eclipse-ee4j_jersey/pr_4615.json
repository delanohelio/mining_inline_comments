{"pr_number": 4615, "pr_title": "Allow for org.glassfish.jersey.servlet.ServletContainer in web.xml", "pr_createdAt": "2020-10-20T08:24:00Z", "pr_url": "https://github.com/eclipse-ee4j/jersey/pull/4615", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODMyNDYwMA==", "url": "https://github.com/eclipse-ee4j/jersey/pull/4615#discussion_r508324600", "bodyText": "no instances of LinkedList are created, this can be removed", "author": "senivam", "createdAt": "2020-10-20T08:52:17Z", "path": "containers/jersey-servlet/src/main/java/org/glassfish/jersey/servlet/init/JerseyServletContainerInitializer.java", "diffHunk": "@@ -21,6 +21,7 @@\n import java.util.HashMap;\n import java.util.HashSet;\n import java.util.LinkedHashSet;\n+import java.util.LinkedList;", "originalCommit": "552df9fb408d64fea763b10e8dbfeb7465072cae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODMyNDkxMw==", "url": "https://github.com/eclipse-ee4j/jersey/pull/4615#discussion_r508324913", "bodyText": "this could be final (as most of variables declared here)", "author": "senivam", "createdAt": "2020-10-20T08:52:45Z", "path": "containers/jersey-servlet/src/main/java/org/glassfish/jersey/servlet/init/JerseyServletContainerInitializer.java", "diffHunk": "@@ -129,11 +130,13 @@ public void onStartup(Set<Class<?>> classes, final ServletContext servletContext\n \n     private void onStartupImpl(final Set<Class<?>> classes, final ServletContext servletContext) throws ServletException {\n         // first see if there are any application classes in the web app\n+        Set<ServletRegistration> registrationsWithApplication = new HashSet<>();", "originalCommit": "552df9fb408d64fea763b10e8dbfeb7465072cae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODMyOTcwOQ==", "url": "https://github.com/eclipse-ee4j/jersey/pull/4615#discussion_r508329709", "bodyText": "it seems LinkedSet can contain NULL, so it's possible to\nregistrationsWithApplication.add(addServletWithApplication(servletContext, applicationClass, classes));\n\nafterwards it's beeing checked for (contains(..)) but context.getServletRegistrations().values() would not have NULLs so it won't be an issue.\nAll of that is just to eliminate an instance creation... can be ignored though/but that instance (just in case) can also be final :)", "author": "senivam", "createdAt": "2020-10-20T08:59:46Z", "path": "containers/jersey-servlet/src/main/java/org/glassfish/jersey/servlet/init/JerseyServletContainerInitializer.java", "diffHunk": "@@ -145,17 +148,21 @@ private void onStartupImpl(final Set<Class<?>> classes, final ServletContext ser\n                         if (sr instanceof ServletRegistration) {\n                             addServletWithExistingRegistration(servletContext, (ServletRegistration) sr,\n                                     applicationClass, classes);\n+                            registrationsWithApplication.add((ServletRegistration) sr);\n                         }\n                     }\n                 } else {\n                     // app not handled by any servlet/filter -> add it\n-                    addServletWithApplication(servletContext, applicationClass, classes);\n+                    ServletRegistration sr = addServletWithApplication(servletContext, applicationClass, classes);\n+                    if (sr != null) {", "originalCommit": "552df9fb408d64fea763b10e8dbfeb7465072cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODU5MDYwMQ==", "url": "https://github.com/eclipse-ee4j/jersey/pull/4615#discussion_r508590601", "bodyText": "The instance is created anyways, ServletRegistration is just a reference to that instance. But sure, I'll make it final. I'd better have the set without nulls, not to catch NPE when later modified.", "author": "jansupol", "createdAt": "2020-10-20T15:07:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODMyOTcwOQ=="}], "type": "inlineReview"}, {"oid": "1a35ca09379aac2e2a5552c063bb76af2be8b3d6", "url": "https://github.com/eclipse-ee4j/jersey/commit/1a35ca09379aac2e2a5552c063bb76af2be8b3d6", "message": "Allow for org.glassfish.jersey.servlet.ServletContainer class name without init parameters in web.xml\n\nSigned-off-by: Jan Supol <jan.supol@oracle.com>", "committedDate": "2020-10-20T13:40:21Z", "type": "forcePushed"}, {"oid": "7f4058bc37b753f2102a049050abd12e25270268", "url": "https://github.com/eclipse-ee4j/jersey/commit/7f4058bc37b753f2102a049050abd12e25270268", "message": "Allow for org.glassfish.jersey.servlet.ServletContainer class name without init parameters in web.xml\n\nSigned-off-by: Jan Supol <jan.supol@oracle.com>", "committedDate": "2020-10-20T15:08:09Z", "type": "commit"}, {"oid": "7f4058bc37b753f2102a049050abd12e25270268", "url": "https://github.com/eclipse-ee4j/jersey/commit/7f4058bc37b753f2102a049050abd12e25270268", "message": "Allow for org.glassfish.jersey.servlet.ServletContainer class name without init parameters in web.xml\n\nSigned-off-by: Jan Supol <jan.supol@oracle.com>", "committedDate": "2020-10-20T15:08:09Z", "type": "forcePushed"}]}