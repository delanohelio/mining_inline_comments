{"pr_number": 226, "pr_title": "fix(lerna): Lerna packages should no longer be reported as missing de\u2026", "pr_createdAt": "2020-09-14T18:35:08Z", "pr_url": "https://github.com/blackducksoftware/synopsys-detect/pull/226", "timeline": [{"oid": "72f7c33e6cee16a7559f61eef2b48abf1228b071", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/72f7c33e6cee16a7559f61eef2b48abf1228b071", "message": "fix(lerna): Lerna packages should no longer be reported as missing dependencies. (Fixes IDETECT-2108)", "committedDate": "2020-09-14T18:21:29Z", "type": "commit"}, {"oid": "c93c45d06d8db7b658c0a91407feac3750b9df62", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/c93c45d06d8db7b658c0a91407feac3750b9df62", "message": "Merge branch 'master' into lerna-missing-packages\n\n# Conflicts:\n#\tdocs/templates/content/90-releasenotes.ftl", "committedDate": "2020-09-14T18:34:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE0ODM1MQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/226#discussion_r488148351", "bodyText": "This is definitely not worth delaying the code freeze for, but the noun-like method names caught my eye. Then I saw that they are kinda used like objects (method references), but even so... since they're doing real work, I think I'd lean toward something more verb-like (say, handleMissingXxxDependency())", "author": "stevebillings", "createdAt": "2020-09-14T18:49:00Z", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/lerna/LernaMissingDependencyHandler.java", "diffHunk": "@@ -0,0 +1,43 @@\n+package com.synopsys.integration.detectable.detectables.lerna;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import org.slf4j.Logger;\n+\n+import com.synopsys.integration.bdio.graph.builder.LazyExternalIdDependencyGraphBuilder;\n+import com.synopsys.integration.bdio.model.Forge;\n+import com.synopsys.integration.bdio.model.dependencyid.DependencyId;\n+import com.synopsys.integration.bdio.model.externalid.ExternalId;\n+import com.synopsys.integration.bdio.model.externalid.ExternalIdFactory;\n+import com.synopsys.integration.detectable.detectables.lerna.model.LernaPackage;\n+import com.synopsys.integration.detectable.detectables.npm.lockfile.model.NpmRequires;\n+import com.synopsys.integration.detectable.detectables.npm.lockfile.parse.NpmLockfilePackager;\n+import com.synopsys.integration.detectable.detectables.yarn.parse.YarnTransformer;\n+\n+public class LernaMissingDependencyHandler {\n+    private final List<LernaPackage> lernaPackages;\n+\n+    public LernaMissingDependencyHandler(List<LernaPackage> lernaPackages) {\n+        this.lernaPackages = lernaPackages;\n+    }\n+\n+    public void missingNpmDependencyHandler(Logger logger, NpmRequires missingDependency) {\n+        boolean isLernaPackage = lernaPackages.stream()\n+                                     .anyMatch(lernaPackage -> lernaPackage.getName().equalsIgnoreCase(missingDependency.getName()));\n+        if (!isLernaPackage) {\n+            NpmLockfilePackager.handleMissingDependency(logger, missingDependency);\n+        }\n+    }\n+\n+    public ExternalId missingYarnDependencyHandler(Logger logger, ExternalIdFactory externalIdFactory, DependencyId dependencyId, LazyExternalIdDependencyGraphBuilder.LazyDependencyInfo lazyDependencyInfo, String yarnLockFilePath) {", "originalCommit": "c93c45d06d8db7b658c0a91407feac3750b9df62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE1NzE4Ng==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/226#discussion_r488157186", "bodyText": "Good catch. That's a quick fix", "author": "JakeMathews", "createdAt": "2020-09-14T19:04:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODE0ODM1MQ=="}], "type": "inlineReview"}, {"oid": "b5d0ff271d6758630af3dfca9810839c2de75f1f", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/b5d0ff271d6758630af3dfca9810839c2de75f1f", "message": "refactor(lerna): Fixing noun-like method names.", "committedDate": "2020-09-14T19:04:38Z", "type": "commit"}, {"oid": "d76538c5dbf275b38157beff52742d744775322e", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/d76538c5dbf275b38157beff52742d744775322e", "message": "test-fix(lerna): Removed unfinished test.", "committedDate": "2020-09-14T19:34:37Z", "type": "commit"}, {"oid": "10cdc7d6ad369c660829021291364409768e7698", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/10cdc7d6ad369c660829021291364409768e7698", "message": "test-fix(yarn): Adding missing dependency to YarnTransformerTest.", "committedDate": "2020-09-14T19:44:32Z", "type": "commit"}, {"oid": "d621906c4a2bffbbd20d9fc40d4abff27e0ef60d", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/d621906c4a2bffbbd20d9fc40d4abff27e0ef60d", "message": "style(license): Updated license headers.", "committedDate": "2020-09-14T19:44:52Z", "type": "commit"}]}