{"pr_number": 158, "pr_title": "fix(): Edits to resolve sonar cloud vulnerabilites", "pr_createdAt": "2020-04-22T17:53:45Z", "pr_url": "https://github.com/blackducksoftware/synopsys-detect/pull/158", "timeline": [{"oid": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "message": "fix(): Edits to resolve sonar cloud vulnerabilites", "committedDate": "2020-04-22T17:51:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMxNDgyNg==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r413314826", "bodyText": "Add @SerializedName instead.", "author": "taikuukaits", "createdAt": "2020-04-22T20:42:01Z", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/godep/model/GoLock.java", "diffHunk": "@@ -28,8 +28,12 @@\n \n public class GoLock {\n     // see https://github.com/golang/dep/blob/master/lock.go for the source of the lock file\n-    public List<Project> projects;\n+    private List<Project> projects;", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MDk3Ng==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414050976", "bodyText": "Instead add a constructor, make fields final and add getters.", "author": "taikuukaits", "createdAt": "2020-04-23T19:05:19Z", "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorToolResult.java", "diffHunk": "@@ -37,13 +37,60 @@\n import com.synopsys.integration.util.NameVersion;\n \n public class DetectorToolResult {", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MTE3Nw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414051177", "bodyText": "Add @SerializedName instead.", "author": "taikuukaits", "createdAt": "2020-04-23T19:05:37Z", "path": "src/main/java/com/synopsys/integration/detect/workflow/report/output/FormattedCodeLocationOutput.java", "diffHunk": "@@ -23,9 +23,17 @@\n package com.synopsys.integration.detect.workflow.report.output;\n \n public class FormattedCodeLocationOutput {\n-    public String codeLocationName;\n+    private String codeLocationName;", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MTI3MA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414051270", "bodyText": "Add @SerializedName instead.", "author": "taikuukaits", "createdAt": "2020-04-23T19:05:45Z", "path": "src/main/java/com/synopsys/integration/detect/workflow/report/output/FormattedDetectorOutput.java", "diffHunk": "@@ -26,27 +26,171 @@\n import java.util.List;\n \n public class FormattedDetectorOutput {", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MTM2MA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414051360", "bodyText": "Add @SerializedName instead.", "author": "taikuukaits", "createdAt": "2020-04-23T19:05:54Z", "path": "src/main/java/com/synopsys/integration/detect/workflow/report/output/FormattedExitCodeOutput.java", "diffHunk": "@@ -23,13 +23,25 @@\n package com.synopsys.integration.detect.workflow.report.output;", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MTQxOQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414051419", "bodyText": "Add @SerializedName instead.", "author": "taikuukaits", "createdAt": "2020-04-23T19:05:59Z", "path": "src/main/java/com/synopsys/integration/detect/workflow/report/output/FormattedOutput.java", "diffHunk": "@@ -26,15 +26,87 @@\n import java.util.List;\n \n public class FormattedOutput {\n-    public String formatVersion = \"\";", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA1MTU4Ng==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414051586", "bodyText": "Add @SerializedName instead.", "author": "taikuukaits", "createdAt": "2020-04-23T19:06:10Z", "path": "src/main/java/com/synopsys/integration/detect/workflow/report/output/FormattedResultOutput.java", "diffHunk": "@@ -23,11 +23,27 @@\n package com.synopsys.integration.detect.workflow.report.output;\n \n public class FormattedResultOutput {", "originalCommit": "6096dac30c12e3b662ba0c2a50bbb1847ee5735e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b67299c59121975d1306f980180d07dd831764e6", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/b67299c59121975d1306f980180d07dd831764e6", "message": "refactor(): Annotate serializable names of public data class fields", "committedDate": "2020-04-23T20:25:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDEwNjA2OQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414106069", "bodyText": "Please remove the getter.", "author": "taikuukaits", "createdAt": "2020-04-23T20:36:08Z", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/godep/model/GoLock.java", "diffHunk": "@@ -28,8 +28,13 @@\n \n public class GoLock {\n     // see https://github.com/golang/dep/blob/master/lock.go for the source of the lock file\n-    public List<Project> projects;\n+    @SerializedName(\"projects\")\n+    private List<Project> projects;\n \n     @SerializedName(\"solve-meta\")\n     public SolveMeta solveMeta;\n+\n+    public List<Project> getProjects() {", "originalCommit": "b67299c59121975d1306f980180d07dd831764e6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4cf3e634de8afc557d9ad8d2770b34bc1e63fbb8", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/4cf3e634de8afc557d9ad8d2770b34bc1e63fbb8", "message": "refactor: Removed getter for GoLock.projects", "committedDate": "2020-04-23T20:39:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwMDY4MA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414700680", "bodyText": "Why is this .get() but the other was not? Did we change the type? Also why do we take in null as one of the parameters?", "author": "taikuukaits", "createdAt": "2020-04-24T16:20:49Z", "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorTool.java", "diffHunk": "@@ -173,25 +174,16 @@ public DetectorToolResult performDetectors(final File directory, final DetectorR\n             }\n         }\n \n-        final DetectorToolResult detectorToolResult = new DetectorToolResult();\n+        Map<CodeLocation, DetectCodeLocation> codeLocationMap = createCodeLocationMap(detectorEvaluations, directory);\n \n-        detectorToolResult.rootDetectorEvaluationTree = Optional.of(rootEvaluation);\n-\n-        detectorToolResult.applicableDetectorTypes = applicable;\n-\n-        detectorToolResult.codeLocationMap = detectorEvaluations.stream()\n-                                                 .filter(DetectorEvaluation::wasExtractionSuccessful)\n-                                                 .map(it -> codeLocationConverter.toDetectCodeLocation(directory, it))\n-                                                 .map(Map::entrySet)\n-                                                 .flatMap(Collection::stream)\n-                                                 .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));\n-\n-        detectorToolResult.bomToolCodeLocations = new ArrayList<>(detectorToolResult.codeLocationMap.values());\n-\n-        logger.info(\"\");\n-        final NameVersionDecision nameVersionDecision = detectorNameVersionHandler.finalDecision();\n-        nameVersionDecision.printDescription(logger);\n-        detectorToolResult.bomToolProjectNameVersion = nameVersionDecision.getChosenNameVersion();\n+        final DetectorToolResult detectorToolResult = new DetectorToolResult(\n+            detectorNameVersionHandler.finalDecision().getChosenNameVersion().get(),", "originalCommit": "4cf3e634de8afc557d9ad8d2770b34bc1e63fbb8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwNjQ1MQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414706451", "bodyText": "I made the constructor take in a NameVersion and then set the field to Optional.of()\nas for why we pass in null for failedDetectorTypes, there wasn't one provided in the original code.  I could change it to pass in an empty HashSet", "author": "crowleySynopsys", "createdAt": "2020-04-24T16:29:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwMDY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDgyNzQ2OA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414827468", "bodyText": "But what happens when the ChosenNameVersion is Empty() - won't there be an exception? You shouldn't do a get without an isPresent check or use orElse(null).\nCan we just remove the field then?", "author": "taikuukaits", "createdAt": "2020-04-24T19:57:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwMDY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg1OTgwMQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414859801", "bodyText": "I commented on DetectorToolResult. Once you make those changes, use the below code to not throw an exception.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        detectorNameVersionHandler.finalDecision().getChosenNameVersion().get(),\n          \n          \n            \n                        detectorNameVersionHandler.finalDecision().getChosenNameVersion().orElse(null),", "author": "JakeMathews", "createdAt": "2020-04-24T20:59:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwMDY4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwMTAwNA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414701004", "bodyText": "Who creates this tool result?", "author": "taikuukaits", "createdAt": "2020-04-24T16:21:18Z", "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorToolResult.java", "diffHunk": "@@ -37,13 +37,57 @@\n import com.synopsys.integration.util.NameVersion;\n \n public class DetectorToolResult {\n-    public Optional<NameVersion> bomToolProjectNameVersion = Optional.empty();\n-    public List<DetectCodeLocation> bomToolCodeLocations = new ArrayList<>();\n+    private final Optional<NameVersion> bomToolProjectNameVersion;\n+    private final List<DetectCodeLocation> bomToolCodeLocations;\n \n-    public Set<DetectorType> applicableDetectorTypes = new HashSet<>();\n-    public Set<DetectorType> failedDetectorTypes = new HashSet<>();\n+    private final Set<DetectorType> applicableDetectorTypes;\n+    private final Set<DetectorType> failedDetectorTypes;\n \n-    public Optional<DetectorEvaluationTree> rootDetectorEvaluationTree = Optional.empty();\n-    public Map<CodeLocation, DetectCodeLocation> codeLocationMap = new HashMap<>();\n+    private final Optional<DetectorEvaluationTree> rootDetectorEvaluationTree;\n+    private final Map<CodeLocation, DetectCodeLocation> codeLocationMap;\n+\n+    public DetectorToolResult(final NameVersion bomToolProjectNameVersion, final List<DetectCodeLocation> bomToolCodeLocations, final Set<DetectorType> applicableDetectorTypes,\n+        final Set<DetectorType> failedDetectorTypes, final DetectorEvaluationTree rootDetectorEvaluationTree,\n+        final Map<CodeLocation, DetectCodeLocation> codeLocationMap) {\n+        this.bomToolProjectNameVersion = Optional.of(bomToolProjectNameVersion);\n+        this.bomToolCodeLocations = bomToolCodeLocations;\n+        this.applicableDetectorTypes = applicableDetectorTypes;\n+        this.failedDetectorTypes = failedDetectorTypes;\n+        this.rootDetectorEvaluationTree = Optional.of(rootDetectorEvaluationTree);\n+        this.codeLocationMap = codeLocationMap;\n+    }\n+\n+    public DetectorToolResult() {", "originalCommit": "4cf3e634de8afc557d9ad8d2770b34bc1e63fbb8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcxMzI1NQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414713255", "bodyText": "DetectorTool uses parameter-less constructor on line 95", "author": "crowleySynopsys", "createdAt": "2020-04-24T16:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcwMTAwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg1ODU3OA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414858578", "bodyText": "Optional should not be a field. Make it a regular NameVersion. Annotate the field with @Nullable as well as the constructor paramter. Use Optional.ofNullable(bomToolProjectNameVersion) in getBomToolProjectNameVersion().\nDo the same for rootDetectorEvaluationTree below.", "author": "JakeMathews", "createdAt": "2020-04-24T20:57:13Z", "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorToolResult.java", "diffHunk": "@@ -37,13 +37,57 @@\n import com.synopsys.integration.util.NameVersion;\n \n public class DetectorToolResult {\n-    public Optional<NameVersion> bomToolProjectNameVersion = Optional.empty();\n-    public List<DetectCodeLocation> bomToolCodeLocations = new ArrayList<>();\n+    private final Optional<NameVersion> bomToolProjectNameVersion;", "originalCommit": "4cf3e634de8afc557d9ad8d2770b34bc1e63fbb8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4119d79a69425dc7b863e562ef188060e122e9e5", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/4119d79a69425dc7b863e562ef188060e122e9e5", "message": "refactor: Made fields in DetectorToolResult not Optionals", "committedDate": "2020-04-24T21:11:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg3MDgzNQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/158#discussion_r414870835", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public DetectorToolResult(final NameVersion bomToolProjectNameVersion, final List<DetectCodeLocation> bomToolCodeLocations, final Set<DetectorType> applicableDetectorTypes,\n          \n          \n            \n                    final Set<DetectorType> failedDetectorTypes, final DetectorEvaluationTree rootDetectorEvaluationTree,\n          \n          \n            \n                    final Map<CodeLocation, DetectCodeLocation> codeLocationMap) {\n          \n          \n            \n                public DetectorToolResult(@Nullable final NameVersion bomToolProjectNameVersion, final List<DetectCodeLocation> bomToolCodeLocations, final Set<DetectorType> applicableDetectorTypes,\n          \n          \n            \n                    final Set<DetectorType> failedDetectorTypes, @Nullable final DetectorEvaluationTree rootDetectorEvaluationTree,\n          \n          \n            \n                    final Map<CodeLocation, DetectCodeLocation> codeLocationMap) {", "author": "JakeMathews", "createdAt": "2020-04-24T21:22:20Z", "path": "src/main/java/com/synopsys/integration/detect/tool/detector/DetectorToolResult.java", "diffHunk": "@@ -30,20 +31,68 @@\n import java.util.Optional;\n import java.util.Set;\n \n+import org.jetbrains.annotations.Nullable;\n+\n import com.synopsys.integration.detect.workflow.codelocation.DetectCodeLocation;\n import com.synopsys.integration.detectable.detectable.codelocation.CodeLocation;\n import com.synopsys.integration.detector.base.DetectorEvaluationTree;\n import com.synopsys.integration.detector.base.DetectorType;\n import com.synopsys.integration.util.NameVersion;\n \n public class DetectorToolResult {\n-    public Optional<NameVersion> bomToolProjectNameVersion = Optional.empty();\n-    public List<DetectCodeLocation> bomToolCodeLocations = new ArrayList<>();\n+    @Nullable\n+    private final NameVersion bomToolProjectNameVersion;\n+    private final List<DetectCodeLocation> bomToolCodeLocations;\n+\n+    private final Set<DetectorType> applicableDetectorTypes;\n+    private final Set<DetectorType> failedDetectorTypes;\n+\n+    @Nullable\n+    private final DetectorEvaluationTree rootDetectorEvaluationTree;\n+    private final Map<CodeLocation, DetectCodeLocation> codeLocationMap;\n+\n+    public DetectorToolResult(final NameVersion bomToolProjectNameVersion, final List<DetectCodeLocation> bomToolCodeLocations, final Set<DetectorType> applicableDetectorTypes,\n+        final Set<DetectorType> failedDetectorTypes, final DetectorEvaluationTree rootDetectorEvaluationTree,\n+        final Map<CodeLocation, DetectCodeLocation> codeLocationMap) {", "originalCommit": "4119d79a69425dc7b863e562ef188060e122e9e5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6a0bd4c36498d3c7c821ab37729065f7a34c66fb", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/6a0bd4c36498d3c7c821ab37729065f7a34c66fb", "message": "refactor: Made constructor parameters Nullable", "committedDate": "2020-04-24T21:48:38Z", "type": "commit"}, {"oid": "15cd7a94e5aaaba5be0b96a519354ac319a0cf3b", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/15cd7a94e5aaaba5be0b96a519354ac319a0cf3b", "message": "Merge branch 'master' into sonarCloudVulnerabilities", "committedDate": "2020-04-24T21:50:31Z", "type": "commit"}]}