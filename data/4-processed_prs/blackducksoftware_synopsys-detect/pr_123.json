{"pr_number": 123, "pr_title": "Npm detectable test", "pr_createdAt": "2020-02-27T20:07:21Z", "pr_url": "https://github.com/blackducksoftware/synopsys-detect/pull/123", "timeline": [{"oid": "eb57582380858d4ccafdf86d42c378e0edd7c81e", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/eb57582380858d4ccafdf86d42c378e0edd7c81e", "message": "feat(test): Created test for NpmShrinkwrapDetectable, added assertions for NpmLockDetectableTest", "committedDate": "2020-02-21T16:55:52Z", "type": "commit"}, {"oid": "75f0645ac5b9bc8517537a090d0423e493eb91fb", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/75f0645ac5b9bc8517537a090d0423e493eb91fb", "message": "fix(test): Removed unnecessary test from NpmLockfileParserTest", "committedDate": "2020-02-21T18:08:46Z", "type": "commit"}, {"oid": "c24da768d75d6c929455a119be5943d2db4cd85d", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/c24da768d75d6c929455a119be5943d2db4cd85d", "message": "Merge branch 'master' into npmDetectableTest", "committedDate": "2020-02-27T16:37:33Z", "type": "commit"}, {"oid": "11f08066cdee76a9e5d8031f52e594aa3207f8a0", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/11f08066cdee76a9e5d8031f52e594aa3207f8a0", "message": "fix(test): Replaced use of GraphCompare with graph assertions in NpmOutputParserTest", "committedDate": "2020-02-27T20:00:53Z", "type": "commit"}, {"oid": "d315451772f1ea508b0b2532c21b544fd7466f0d", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/d315451772f1ea508b0b2532c21b544fd7466f0d", "message": "Merged master", "committedDate": "2020-03-02T16:37:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY4NjY3Ng==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/123#discussion_r386686676", "bodyText": "Can you make an assert for this dependency?", "author": "JakeMathews", "createdAt": "2020-03-02T22:21:35Z", "path": "detectable/src/test/java/com/synopsys/integration/detectable/detectables/npm/lockfile/functional/NpmLockDetectableTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.synopsys.integration.detectable.detectables.npm.lockfile.functional;\n+\n+import java.io.IOException;\n+import java.nio.file.Paths;\n+\n+import org.jetbrains.annotations.NotNull;\n+import org.junit.jupiter.api.Assertions;\n+\n+import com.synopsys.integration.bdio.model.Forge;\n+import com.synopsys.integration.detectable.Detectable;\n+import com.synopsys.integration.detectable.DetectableEnvironment;\n+import com.synopsys.integration.detectable.Extraction;\n+import com.synopsys.integration.detectable.detectables.npm.lockfile.NpmLockfileOptions;\n+import com.synopsys.integration.detectable.functional.DetectableFunctionalTest;\n+import com.synopsys.integration.detectable.util.graph.NameVersionGraphAssert;\n+\n+public class NpmLockDetectableTest extends DetectableFunctionalTest {\n+\n+    public NpmLockDetectableTest() throws IOException {\n+        super(\"npmLock\");\n+    }\n+\n+    @Override\n+    public void setup() throws IOException {\n+        addFile(Paths.get(\"package-lock.json\"),\n+            \"{\",\n+            \"   \\\"name\\\": \\\"knockout-tournament\\\",\",\n+            \"   \\\"version\\\": \\\"1.0.0\\\",\",\n+            \"   \\\"lockfileVersion\\\": 1,\",\n+            \"   \\\"requires\\\": true,\",\n+            \"   \\\"dependencies\\\": {\",\n+            \"       \\\"balanced-match\\\": {\",\n+            \"           \\\"version\\\": \\\"1.0.0\\\",\",\n+            \"           \\\"resolved\\\": \\\"https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.0.tgz\\\",\",\n+            \"           \\\"integrity\\\": \\\"sha1-ibTRmasr7kneFk6gK4nORi1xt2c=\\\",\",\n+            \"           \\\"dev\\\": true\",\n+            \"       },\",\n+            \"       \\\"brace-expansion\\\": {\",\n+            \"           \\\"version\\\": \\\"1.1.8\\\",\",\n+            \"           \\\"resolved\\\": \\\"https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.8.tgz\\\",\",\n+            \"           \\\"integrity\\\": \\\"sha1-wHshHHyVLsH479Uad+8NHTmQopI=\\\",\",\n+            \"           \\\"dev\\\": true,\",\n+            \"           \\\"requires\\\": {\",\n+            \"               \\\"balanced-match\\\": \\\"1.0.0\\\",\",\n+            \"               \\\"concat-map\\\": \\\"0.0.1\\\"\",", "originalCommit": "d315451772f1ea508b0b2532c21b544fd7466f0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY4ODQzMw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/123#discussion_r386688433", "bodyText": "Can you move the resources file into the test.", "author": "JakeMathews", "createdAt": "2020-03-02T22:25:38Z", "path": "detectable/src/test/java/com/synopsys/integration/detectable/detectables/npm/lockfile/functional/NpmOutputParserTest.java", "diffHunk": "@@ -24,23 +24,31 @@\n \n import org.junit.jupiter.api.Assertions;\n import org.junit.jupiter.api.Test;\n-import org.junit.jupiter.api.Disabled;\n+\n+import com.synopsys.integration.bdio.model.Forge;\n import com.synopsys.integration.bdio.model.externalid.ExternalIdFactory;\n import com.synopsys.integration.detectable.detectables.npm.cli.parse.NpmCliParser;\n import com.synopsys.integration.detectable.detectables.npm.lockfile.model.NpmParseResult;\n import com.synopsys.integration.detectable.util.FunctionalTestFiles;\n-import com.synopsys.integration.detectable.util.GraphCompare;\n+import com.synopsys.integration.detectable.util.graph.NameVersionGraphAssert;\n \n public class NpmOutputParserTest {\n     @Test\n-    @Disabled\n     public void npmCliDependencyFinder() {\n         final NpmCliParser parser = new NpmCliParser(new ExternalIdFactory());\n         final String testIn = FunctionalTestFiles.asString(\"/npm/packman_proj_dependencies.json\");", "originalCommit": "d315451772f1ea508b0b2532c21b544fd7466f0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY4ODgzNw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/123#discussion_r386688837", "bodyText": "Can you assert on this dependency.", "author": "JakeMathews", "createdAt": "2020-03-02T22:26:27Z", "path": "detectable/src/test/java/com/synopsys/integration/detectable/detectables/npm/lockfile/functional/NpmShrinkwrapDetectableTest.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package com.synopsys.integration.detectable.detectables.npm.lockfile.functional;\n+\n+import java.io.IOException;\n+import java.nio.file.Paths;\n+\n+import org.jetbrains.annotations.NotNull;\n+import org.junit.jupiter.api.Assertions;\n+\n+import com.synopsys.integration.bdio.model.Forge;\n+import com.synopsys.integration.detectable.Detectable;\n+import com.synopsys.integration.detectable.DetectableEnvironment;\n+import com.synopsys.integration.detectable.Extraction;\n+import com.synopsys.integration.detectable.detectables.npm.lockfile.NpmLockfileOptions;\n+import com.synopsys.integration.detectable.functional.DetectableFunctionalTest;\n+import com.synopsys.integration.detectable.util.graph.NameVersionGraphAssert;\n+\n+public class NpmShrinkwrapDetectableTest extends DetectableFunctionalTest {\n+\n+    public NpmShrinkwrapDetectableTest() throws IOException {\n+        super(\"npmShrinkwrap\");\n+    }\n+\n+    @Override\n+    protected void setup() throws IOException {\n+        addFile(Paths.get(\"npm-shrinkwrap.json\"),\n+            \"{\",\n+            \"   \\\"name\\\": \\\"fec-builder\\\",\",\n+            \"   \\\"version\\\": \\\"1.3.7\\\",\",\n+            \"   \\\"lockfileVersion\\\": 1,\",\n+            \"   \\\"requires\\\": true,\",\n+            \"   \\\"dependencies\\\": {\",\n+            \"       \\\"abbrev\\\": {\",\n+            \"           \\\"version\\\": \\\"1.0.9\\\"\",\n+            \"       },\",\n+            \"       \\\"accepts\\\": {\",\n+            \"           \\\"version\\\": \\\"1.3.3\\\",\",\n+            \"           \\\"requires\\\": {\",\n+            \"               \\\"mime-types\\\": \\\"2.1.14\\\",\",\n+            \"               \\\"negotiator\\\": \\\"0.6.1\\\"\",\n+            \"           }\",\n+            \"       },\",\n+            \"        \\\"mime-types\\\": {\",\n+            \"           \\\"version\\\": \\\"https://registry.npmjs.org/mime-types/-/mime-types-2.1.13.tgz\\\",\",\n+            \"           \\\"integrity\\\": \\\"sha1-4HqqnGxrmnyjASxpADrSWjnpKog=\\\",\",\n+            \"           \\\"requires\\\": {\",\n+            \"               \\\"mime-db\\\": \\\"https://registry.npmjs.org/mime-db/-/mime-db-1.25.0.tgz\\\"\",", "originalCommit": "d315451772f1ea508b0b2532c21b544fd7466f0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2bb38380407c3b6019918f73d40d4a100cda744c", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/2bb38380407c3b6019918f73d40d4a100cda744c", "message": "fix(test): Moved test resources for npm detectable into test files, added assertions", "committedDate": "2020-03-03T21:28:56Z", "type": "commit"}, {"oid": "d161dd0696f95e1804a9ea9935fc34b7961d218c", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/d161dd0696f95e1804a9ea9935fc34b7961d218c", "message": "fix(test): Deleted unused resources", "committedDate": "2020-03-03T21:32:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk1NTc2OA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/123#discussion_r389955768", "bodyText": "I'd prefer something like the following.\nStringUtils.join(\n            \"line1\",\n            \"line2\",\n            \"line3\"\n        , System.lineSeparator()\n);\n\nThat's a lot of String concatenation, its hard to read, and the \"\\n\" might cause issues on Windows.", "author": "JakeMathews", "createdAt": "2020-03-09T20:54:24Z", "path": "detectable/src/test/java/com/synopsys/integration/detectable/detectables/npm/lockfile/functional/NpmOutputParserTest.java", "diffHunk": "@@ -24,23 +24,65 @@\n \n import org.junit.jupiter.api.Assertions;\n import org.junit.jupiter.api.Test;\n-import org.junit.jupiter.api.Disabled;\n+\n+import com.synopsys.integration.bdio.model.Forge;\n import com.synopsys.integration.bdio.model.externalid.ExternalIdFactory;\n import com.synopsys.integration.detectable.detectables.npm.cli.parse.NpmCliParser;\n import com.synopsys.integration.detectable.detectables.npm.lockfile.model.NpmParseResult;\n-import com.synopsys.integration.detectable.util.FunctionalTestFiles;\n-import com.synopsys.integration.detectable.util.GraphCompare;\n+import com.synopsys.integration.detectable.util.graph.NameVersionGraphAssert;\n \n public class NpmOutputParserTest {\n     @Test\n-    @Disabled\n     public void npmCliDependencyFinder() {\n         final NpmCliParser parser = new NpmCliParser(new ExternalIdFactory());\n-        final String testIn = FunctionalTestFiles.asString(\"/npm/packman_proj_dependencies.json\");\n+        final String testIn =\n+            \"{\" + \"\\n\" +\n+                \"   \\\"name\\\": \\\"node-js\\\",\" + \"\\n\" +\n+                \"   \\\"version\\\": \\\"0.2.0\\\",\" + \"\\n\" +\n+                \"   \\\"dependencies\\\": {\" + \"\\n\" +\n+                \"       \\\"upper-case\\\": {\" + \"\\n\" +\n+                \"       \\\"version\\\": \\\"1.1.3\\\",\" + \"\\n\" +\n+                \"       \\\"from\\\": \\\"upper-case@latest\\\",\" + \"\\n\" +\n+                \"       \\\"resolved\\\": \\\"https://registry.npmjs.org/upper-case/-/upper-case-1.1.3.tgz\\\"\" + \"\\n\" +\n+                \"       },\" + \"\\n\" +\n+                \"       \\\"xml2js\\\": {\" + \"\\n\" +\n+                \"           \\\"version\\\": \\\"0.4.17\\\",\" + \"\\n\" +\n+                \"           \\\"from\\\": \\\"xml2js@latest\\\",\" + \"\\n\" +\n+                \"           \\\"resolved\\\": \\\"https://registry.npmjs.org/xml2js/-/xml2js-0.4.17.tgz\\\",\" + \"\\n\" +\n+                \"            \\\"dependencies\\\": {\" + \"\\n\" +\n+                \"               \\\"sax\\\": {\" + \"\\n\" +\n+                \"                   \\\"version\\\": \\\"1.2.2\\\",\" + \"\\n\" +\n+                \"                   \\\"from\\\": \\\"sax@>=0.6.0\\\",\" + \"\\n\" +\n+                \"                   \\\"resolved\\\": \\\"https://registry.npmjs.org/sax/-/sax-1.2.2.tgz\\\"\" + \"\\n\" +\n+                \"               },\" + \"\\n\" +\n+                \"               \\\"xmlbuilder\\\": {\" + \"\\n\" +\n+                \"                   \\\"version\\\": \\\"4.2.1\\\",\" + \"\\n\" +\n+                \"                   \\\"from\\\": \\\"xmlbuilder@>=4.1.0 <5.0.0\\\",\" + \"\\n\" +\n+                \"                   \\\"resolved\\\": \\\"https://registry.npmjs.org/xmlbuilder/-/xmlbuilder-4.2.1.tgz\\\",\" + \"\\n\" +\n+                \"                   \\\"dependencies\\\": {\" + \"\\n\" +\n+                \"                       \\\"lodash\\\": {\" + \"\\n\" +\n+                \"                           \\\"version\\\": \\\"4.17.4\\\",\" + \"\\n\" +\n+                \"                           \\\"from\\\": \\\"lodash@>=4.0.0 <5.0.0\\\",\" + \"\\n\" +\n+                \"                           \\\"resolved\\\": \\\"https://registry.npmjs.org/lodash/-/lodash-4.17.4.tgz\\\"\" + \"\\n\" +\n+                \"                       }\" + \"\\n\" +\n+                \"                   }\" + \"\\n\" +\n+                \"               }\" + \"\\n\" +\n+                \"           }\" + \"\\n\" +\n+                \"       }\" + \"\\n\" +\n+                \"   }\" + \"\\n\" +\n+                \"}\";", "originalCommit": "d161dd0696f95e1804a9ea9935fc34b7961d218c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9ad55ecb1aafdb38f5825f1f0207c94253bc6038", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/9ad55ecb1aafdb38f5825f1f0207c94253bc6038", "message": "fix(test): replaced concatenation with String.join in NpmOutputParserTest", "committedDate": "2020-03-09T21:27:08Z", "type": "commit"}, {"oid": "605328271aeccac59c4e6df5a466a65237086d52", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/605328271aeccac59c4e6df5a466a65237086d52", "message": "fix(test): Updated assertions in detectable tests to check for exact expected number of code locations", "committedDate": "2020-03-24T20:59:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM1OTc3Nw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/123#discussion_r406359777", "bodyText": "These seem redundant with the new Detectable test. Feel free to remove.", "author": "JakeMathews", "createdAt": "2020-04-09T17:24:37Z", "path": "detectable/src/test/java/com/synopsys/integration/detectable/detectables/npm/lockfile/functional/NpmLockfileParserTest.java", "diffHunk": "@@ -47,24 +47,15 @@ public void init() {\n         npmLockfileParser = new NpmLockfileParser(new GsonBuilder().setPrettyPrinting().create(), new ExternalIdFactory());\n     }\n \n-    @Test\n-    @Disabled\n-    public void parseLockFileWithRecreatedJsonTest() {\n-        final String lockFileText = FunctionalTestFiles.asString(\"/npm/package-lock.json\");\n \n-        final NpmParseResult result = npmLockfileParser.parse(recreatePackageJsonFromLock(lockFileText), lockFileText, true);\n-\n-        Assertions.assertEquals(\"knockout-tournament\", result.getProjectName());\n-        Assertions.assertEquals(\"1.0.0\", result.getProjectVersion());\n-        GraphCompare.assertEqualsResource(\"/npm/packageLockExpected_graph.json\", result.getCodeLocation().getDependencyGraph());\n-    }\n+    /*  Are these <...>WithRecreatedJson tests important? */", "originalCommit": "605328271aeccac59c4e6df5a466a65237086d52", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2917c34d5bbea1776e3e23756bd37ba45724d28f", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/2917c34d5bbea1776e3e23756bd37ba45724d28f", "message": "fix(test): Deleted redundant NpmPackageLockDetectableTest", "committedDate": "2020-04-09T19:17:47Z", "type": "commit"}, {"oid": "3da30477a269ffb96dba621fd7bbbbf450e61ddb", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/3da30477a269ffb96dba621fd7bbbbf450e61ddb", "message": "fix(test): Deleted redundant NpmLockfileParserTest", "committedDate": "2020-04-09T19:36:37Z", "type": "commit"}]}