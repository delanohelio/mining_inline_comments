{"pr_number": 1303, "pr_title": "Add overwrite property", "pr_createdAt": "2020-03-05T20:34:02Z", "pr_url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303", "timeline": [{"oid": "e9fa2925c3e4b69a5419637ea23b8597d73ff276", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e9fa2925c3e4b69a5419637ea23b8597d73ff276", "message": "Added overwrite property to SdlFile", "committedDate": "2020-03-04T20:55:12Z", "type": "commit"}, {"oid": "d925025ac9ce71fc5d602ee2c8063044b1aafe57", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/d925025ac9ce71fc5d602ee2c8063044b1aafe57", "message": "Added a call  in SdlArtwork default constructor to call Super empty constructor to set overwrite property", "committedDate": "2020-03-04T20:59:13Z", "type": "commit"}, {"oid": "0c97f663f71df092ebdd749bebdc5ca6aeab9799", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/0c97f663f71df092ebdd749bebdc5ca6aeab9799", "message": "Added logic to check overwrite property for uploadFile in baseFileManager", "committedDate": "2020-03-04T21:03:12Z", "type": "commit"}, {"oid": "032c400e5cc4d4ccbbbafc330b3b6d76f2a5789a", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/032c400e5cc4d4ccbbbafc330b3b6d76f2a5789a", "message": "Fixed formatting in BaseFileManager uploadFile", "committedDate": "2020-03-04T21:14:33Z", "type": "commit"}, {"oid": "d8e4b5283d41ec38fb0cc87445ffa58a1f3c96bd", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/d8e4b5283d41ec38fb0cc87445ffa58a1f3c96bd", "message": "Added overWrite property check in baseFileManager uploadFiles", "committedDate": "2020-03-04T21:25:05Z", "type": "commit"}, {"oid": "823c495fb4a1c85ac533575a0f3bef0dc8e4e19e", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/823c495fb4a1c85ac533575a0f3bef0dc8e4e19e", "message": "added overwrite property to SdlFile in javaSE", "committedDate": "2020-03-05T14:35:22Z", "type": "commit"}, {"oid": "091fab86d9c7f7f4f3c9999d0b8e6b5ca511007f", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/091fab86d9c7f7f4f3c9999d0b8e6b5ca511007f", "message": "Since overwrite is set to true by default, I removed it form constructors and added it to the top of the classes", "committedDate": "2020-03-05T15:25:07Z", "type": "commit"}, {"oid": "8c27a093540f838348978bb4d9a42aed916594ed", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8c27a093540f838348978bb4d9a42aed916594ed", "message": "fixed spelling", "committedDate": "2020-03-05T20:01:22Z", "type": "commit"}, {"oid": "448c66c152412f9dfd6c90b8fcbcf7b5528bb18b", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/448c66c152412f9dfd6c90b8fcbcf7b5528bb18b", "message": "Added testOverwriteFileProperty() to FileManagerTest.java", "committedDate": "2020-03-05T21:11:40Z", "type": "commit"}, {"oid": "738af48f45a92ac568a075a8ef44a4e31a68f11d", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/738af48f45a92ac568a075a8ef44a4e31a68f11d", "message": "Added testOverWriteFilePropertyListFiles to FileManagerTest", "committedDate": "2020-03-05T22:01:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMwMDkwMw==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390300903", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public boolean isOverwrite() {\n          \n          \n            \n                public boolean getOverwrite() {", "author": "bilal-alsharifi", "createdAt": "2020-03-10T13:11:27Z", "path": "javaSE/src/main/java/com/smartdevicelink/managers/file/filetypes/SdlFile.java", "diffHunk": "@@ -185,4 +187,20 @@ public void setStaticIcon(boolean staticIcon) {\n     public boolean isStaticIcon() {\n         return isStaticIcon;\n     }\n+\n+    /**\n+     * Gets the overwrite property for an SdlFile by default its set to true\n+     * @return a boolean value that indicates if a file can be overwritten.\n+     */\n+    public boolean isOverwrite() {", "originalCommit": "738af48f45a92ac568a075a8ef44a4e31a68f11d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMwMTA5Nw==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390301097", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public boolean isOverwrite() {\n          \n          \n            \n                public boolean getOverwrite() {", "author": "bilal-alsharifi", "createdAt": "2020-03-10T13:11:44Z", "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/file/filetypes/SdlFile.java", "diffHunk": "@@ -219,4 +221,20 @@ public void setStaticIcon(boolean staticIcon) {\n     public boolean isStaticIcon() {\n         return isStaticIcon;\n     }\n+\n+    /**\n+     * Gets the overwrite property for an SdlFile by default its set to true\n+     * @return a boolean value that indicates if a file can be overwritten.\n+     */\n+    public boolean isOverwrite() {", "originalCommit": "738af48f45a92ac568a075a8ef44a4e31a68f11d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM3OTA1NA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390379054", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tLog.w(TAG, \"Files that have already uploaded and have an Overwrite property set to false will not be re-Upload\");\n          \n          \n            \n            \t\t\t\tLog.w(TAG, String.format(\"%s has already been uploaded and the overwrite property is set to false. It will not be uploaded again\", file.getName()));", "author": "bilal-alsharifi", "createdAt": "2020-03-10T14:59:32Z", "path": "base/src/main/java/com/smartdevicelink/managers/file/BaseFileManager.java", "diffHunk": "@@ -392,13 +402,23 @@ public void uploadFiles(@NonNull List<? extends SdlFile> files, final MultipleFi\n \t\t}\n \t\tfinal List<PutFile> putFileRequests = new ArrayList<>();\n \t\tfor (SdlFile file : files) {\n-\t\t\tif (!file.isStaticIcon()) {\n-\t\t\t\tputFileRequests.add(createPutFile(file));\n+\t\t\tif (file.isStaticIcon()) {\n+\t\t\t\tLog.w(TAG, \"Static icons don't need to be uploaded\");\n+\t\t\t\tcontinue;\n \t\t\t}\n+\t\t\t// In sdl_ios: HAX: [#827](https://github.com/smartdevicelink/sdl_ios/issues/827) Older versions of Core had a bug where list files would cache incorrectly.\n+\t\t\t// This led to attempted uploads failing due to the system thinking they were already there when they were not.\n+\t\t\tif (!file.isPersistent() && !hasUploadedFile(file)) {\n+\t\t\t\tfile.setOverwrite(true);\n+\t\t\t}\n+\t\t\tif (!file.isOverwrite() && hasUploadedFile(file)) {\n+\t\t\t\tLog.w(TAG, \"Files that have already uploaded and have an Overwrite property set to false will not be re-Upload\");", "originalCommit": "738af48f45a92ac568a075a8ef44a4e31a68f11d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM3OTI3MQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390379271", "bodyText": "it is better to print the name to know which file exactly is not being uploaded.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tLog.w(TAG, \"Static icons don't need to be uploaded\");\n          \n          \n            \n            \t\t\t\tLog.w(TAG, String.format(\"%s is a static icon and doesn't need to be uploaded\", file.getName()));", "author": "bilal-alsharifi", "createdAt": "2020-03-10T14:59:52Z", "path": "base/src/main/java/com/smartdevicelink/managers/file/BaseFileManager.java", "diffHunk": "@@ -392,13 +402,23 @@ public void uploadFiles(@NonNull List<? extends SdlFile> files, final MultipleFi\n \t\t}\n \t\tfinal List<PutFile> putFileRequests = new ArrayList<>();\n \t\tfor (SdlFile file : files) {\n-\t\t\tif (!file.isStaticIcon()) {\n-\t\t\t\tputFileRequests.add(createPutFile(file));\n+\t\t\tif (file.isStaticIcon()) {\n+\t\t\t\tLog.w(TAG, \"Static icons don't need to be uploaded\");", "originalCommit": "738af48f45a92ac568a075a8ef44a4e31a68f11d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MDU5OQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390380599", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tLog.w(TAG, \"Files that have already uploaded and have an Overwrite property set to false will not be re-Upload\");\n          \n          \n            \n            \t\t\tLog.w(TAG, String.format(\"%s has already been uploaded and the overwrite property is set to false. It will not be uploaded again\", file.getName()));", "author": "bilal-alsharifi", "createdAt": "2020-03-10T15:01:32Z", "path": "base/src/main/java/com/smartdevicelink/managers/file/BaseFileManager.java", "diffHunk": "@@ -329,6 +329,16 @@ public void uploadFile(@NonNull final SdlFile file, final CompletionListener lis\n \t\t\tlistener.onComplete(true);\n \t\t\treturn;\n \t\t}\n+\t\t// In sdl_ios: HAX: [#827](https://github.com/smartdevicelink/sdl_ios/issues/827) Older versions of Core had a bug where list files would cache incorrectly.\n+\t\t// This led to attempted uploads failing due to the system thinking they were already there when they were not.\n+\t\tif (!file.isPersistent() && !hasUploadedFile(file)) {\n+\t\t\tfile.setOverwrite(true);\n+\t\t}\n+\t\tif (!file.isOverwrite() && hasUploadedFile(file)) {\n+\t\t\tLog.w(TAG, \"Files that have already uploaded and have an Overwrite property set to false will not be re-Upload\");", "originalCommit": "738af48f45a92ac568a075a8ef44a4e31a68f11d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MjE3MQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390382171", "bodyText": "Can we also update the static icon warning message to show the file name?", "author": "bilal-alsharifi", "createdAt": "2020-03-10T15:03:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM4MDU5OQ=="}], "type": "inlineReview"}, {"oid": "21450c41b8bcbf95d826a2aa8687bd195e85862d", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/21450c41b8bcbf95d826a2aa8687bd195e85862d", "message": "Merge branch 'develop' into add_Overwrite_Property", "committedDate": "2020-03-10T16:27:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUzNjc2OA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1303#discussion_r390536768", "bodyText": "In java suite, this not necessary since we are covering that case in hasUploadedFile(). So that if statement can be removed. This also applies to uploadFiles()", "author": "bilal-alsharifi", "createdAt": "2020-03-10T18:48:56Z", "path": "base/src/main/java/com/smartdevicelink/managers/file/BaseFileManager.java", "diffHunk": "@@ -329,6 +329,16 @@ public void uploadFile(@NonNull final SdlFile file, final CompletionListener lis\n \t\t\tlistener.onComplete(true);\n \t\t\treturn;\n \t\t}\n+\t\t// In sdl_ios: HAX: [#827](https://github.com/smartdevicelink/sdl_ios/issues/827) Older versions of Core had a bug where list files would cache incorrectly.\n+\t\t// This led to attempted uploads failing due to the system thinking they were already there when they were not.\n+\t\tif (!file.isPersistent() && !hasUploadedFile(file)) {", "originalCommit": "21450c41b8bcbf95d826a2aa8687bd195e85862d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c4d6e48ac37a40e70f0b47da0671046da63b259c", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c4d6e48ac37a40e70f0b47da0671046da63b259c", "message": "Removed unnecessary if statements in uploadFile and uploadFiles", "committedDate": "2020-03-11T14:05:24Z", "type": "commit"}, {"oid": "e9752831bf093f5acd759a59a3d76af092660d09", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e9752831bf093f5acd759a59a3d76af092660d09", "message": "ReFormatted Log.w statements for uploading static icons and Overwrite property in uploadFiles and uploadFile", "committedDate": "2020-03-11T14:10:10Z", "type": "commit"}, {"oid": "b0fd97f39056370e4b9d8bd47bb488e2f6da1794", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b0fd97f39056370e4b9d8bd47bb488e2f6da1794", "message": "changed isOverwrite to getOverwrite in sdlFIle in both projects and BaseFileManager", "committedDate": "2020-03-11T14:12:27Z", "type": "commit"}]}