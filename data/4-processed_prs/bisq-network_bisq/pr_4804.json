{"pr_number": 4804, "pr_title": "Improve persistence manager", "pr_createdAt": "2020-11-13T21:50:27Z", "pr_url": "https://github.com/bisq-network/bisq/pull/4804", "timeline": [{"oid": "a64c11ebe4fb3b8519101bc729bf4d1c7facb34f", "url": "https://github.com/bisq-network/bisq/commit/a64c11ebe4fb3b8519101bc729bf4d1c7facb34f", "message": "Add additional guards to ensure that the shut down routine is not called multiple times\n(which can happen in rare cases) and add guards that we never create multiple instances\nfor a given file as well not call initialize or other API methods after shutdown was started.", "committedDate": "2020-11-13T19:08:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQzNTAzOQ==", "url": "https://github.com/bisq-network/bisq/pull/4804#discussion_r523435039", "bodyText": "initCalled is always false as it's only set here", "author": "sqrrm", "createdAt": "2020-11-14T16:11:46Z", "path": "common/src/main/java/bisq/common/persistence/PersistenceManager.java", "diffHunk": "@@ -166,6 +183,7 @@ private static void onWriteCompleted(ResultHandler completeHandler,\n     @Nullable\n     private Timer timer;\n     private ExecutorService writeToDiskExecutor;\n+    public final AtomicBoolean initCalled = new AtomicBoolean(false);", "originalCommit": "a64c11ebe4fb3b8519101bc729bf4d1c7facb34f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQ2MTk3MA==", "url": "https://github.com/bisq-network/bisq/pull/4804#discussion_r523461970", "bodyText": "Ups, thanks for spotting that...", "author": "chimp1984", "createdAt": "2020-11-14T20:52:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQzNTAzOQ=="}], "type": "inlineReview"}, {"oid": "755ea4d792420c99909508eb747beaa29a7df28f", "url": "https://github.com/bisq-network/bisq/commit/755ea4d792420c99909508eb747beaa29a7df28f", "message": "Add missing initCalled.set(true);", "committedDate": "2020-11-14T20:51:51Z", "type": "commit"}]}