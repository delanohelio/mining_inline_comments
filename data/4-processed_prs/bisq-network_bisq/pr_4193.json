{"pr_number": 4193, "pr_title": "Display \"Payment Method\" column in Open Offers view", "pr_createdAt": "2020-04-23T21:19:01Z", "pr_url": "https://github.com/bisq-network/bisq/pull/4193", "timeline": [{"oid": "434e3848353273ea50babc0f162c5059f4c0958a", "url": "https://github.com/bisq-network/bisq/commit/434e3848353273ea50babc0f162c5059f4c0958a", "message": "Display payment method column in Open Offers view\n\nAdjust widths of existing columns to fit in a column for payment method.\nFixes #3902\nFixes #4125", "committedDate": "2020-04-25T16:07:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE3MTUyOA==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425171528", "bodyText": "Is the null check necessary? The above calls to result of o.getOffer() don't null check.", "author": "dmos62", "createdAt": "2020-05-14T14:16:12Z", "path": "desktop/src/main/java/bisq/desktop/main/portfolio/openoffer/OpenOffersView.java", "diffHunk": "@@ -116,6 +118,10 @@ public void initialize() {\n         priceColumn.setComparator(Comparator.comparing(o -> o.getOffer().getPrice(), Comparator.nullsFirst(Comparator.naturalOrder())));\n         volumeColumn.setComparator(Comparator.comparing(o -> o.getOffer().getVolume(), Comparator.nullsFirst(Comparator.naturalOrder())));\n         dateColumn.setComparator(Comparator.comparing(o -> o.getOffer().getDate()));\n+        paymentMethodColumn.setComparator(Comparator.comparing(\n+                o -> o.getOffer() != null ? o.getOffer().getPaymentMethod().getId() : null,", "originalCommit": "434e3848353273ea50babc0f162c5059f4c0958a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIxMDI2MQ==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425210261", "bodyText": "I agree, and will modify to bring it into line with the code above it.\nJust to note, this line was copied from the existing PendingTradesView.java in which there is a payment method column.  Should I also make a change to do the same in PendingTradesView.java or would that need to be a separate code-cleanup type PR?", "author": "jmacxx", "createdAt": "2020-05-14T15:06:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE3MTUyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MjUwNQ==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425262505", "bodyText": "I think it's fine if you leave the other one as is.", "author": "dmos62", "createdAt": "2020-05-14T16:17:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE3MTUyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE3NTY0MA==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425175640", "bodyText": "Unused import.", "author": "dmos62", "createdAt": "2020-05-14T14:21:39Z", "path": "desktop/src/main/java/bisq/desktop/main/portfolio/openoffer/OpenOffersViewModel.java", "diffHunk": "@@ -19,6 +19,7 @@\n \n import bisq.desktop.common.model.ActivatableWithDataModel;\n import bisq.desktop.common.model.ViewModel;\n+import bisq.desktop.main.portfolio.pendingtrades.PendingTradesListItem;", "originalCommit": "434e3848353273ea50babc0f162c5059f4c0958a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIxMjQ1OA==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425212458", "bodyText": "\ud83d\udc4d will remove.", "author": "jmacxx", "createdAt": "2020-05-14T15:09:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE3NTY0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE4MDA3MA==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425180070", "bodyText": "Can we guarantee that Res.get(paymentMethod.getId() + \"_SHORT\") will always find the translation? If unsure, should wrap in try-catch.", "author": "dmos62", "createdAt": "2020-05-14T14:27:11Z", "path": "desktop/src/main/java/bisq/desktop/main/portfolio/openoffer/OpenOffersViewModel.java", "diffHunk": "@@ -118,6 +121,23 @@ String getMarketLabel(OpenOfferListItem item) {\n         return CurrencyUtil.getCurrencyPair(item.getOffer().getCurrencyCode());\n     }\n \n+    String getPaymentMethod(OpenOfferListItem item) {\n+        String result = \"\";\n+        if (item != null) {\n+            Offer offer = item.getOffer();\n+            checkNotNull(offer);\n+            checkNotNull(offer.getPaymentMethod());\n+            String method = Res.get(offer.getPaymentMethod().getId() + \"_SHORT\");", "originalCommit": "434e3848353273ea50babc0f162c5059f4c0958a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIxMjEzMw==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425212133", "bodyText": "This method is copied directly from PendingTradesViewModel.java (line 273).  I presume since the code is already working, no need to change it.  I'm open to suggestions of changing both though, if you have strong worries about it.", "author": "jmacxx", "createdAt": "2020-05-14T15:09:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE4MDA3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1MDE0Mg==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425250142", "bodyText": "It would be good to move this duplicating logic to Offer itself (Offer.getPaymentMethodNameWithCountryCode() or something better). Put in a try-catch in that method for java.util.MissingResourceException (that's what Res.get might throw) and use an Option return type to distinguish whether or not the translation was found (again, since we can't guarantee (I presume) that someone won't forget to put in a translation when adding a new payment method). Extra points for extracting the Res.get(paymentMethod().getId() + \"_SHORT\") part into something like PaymentMethod.getShortName() (returns an Option). If you do less than I suggest, no one will probably mind, but it's great to leave the code just a little better.\nEdit: at first suggested moving to PaymentMethod, but then realised the logic relies on Offer. Corrected.", "author": "dmos62", "createdAt": "2020-05-14T15:59:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE4MDA3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzAyMQ==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425307021", "bodyText": "\ud83d\udc4d Done / refactored.  Res.get handles MissingResourceException itself and in that case returns the key.  I think that is a good way of handling the case of missing translations since it alleviates the caller from having to write custom error handling everywhere.", "author": "jmacxx", "createdAt": "2020-05-14T17:23:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE4MDA3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgwODY3MA==", "url": "https://github.com/bisq-network/bisq/pull/4193#discussion_r425808670", "bodyText": "@jmacxx I missed that, good catch.", "author": "dmos62", "createdAt": "2020-05-15T13:39:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE4MDA3MA=="}], "type": "inlineReview"}, {"oid": "d516ba4a5983dc6377e008fff13b1b25e1b64f7c", "url": "https://github.com/bisq-network/bisq/commit/d516ba4a5983dc6377e008fff13b1b25e1b64f7c", "message": "Display payment method column in Open Offers view\n\nAdjust widths of existing columns to fit in a column for payment method.\nFixes #3902\nFixes #4125", "committedDate": "2020-05-15T14:06:48Z", "type": "commit"}, {"oid": "d516ba4a5983dc6377e008fff13b1b25e1b64f7c", "url": "https://github.com/bisq-network/bisq/commit/d516ba4a5983dc6377e008fff13b1b25e1b64f7c", "message": "Display payment method column in Open Offers view\n\nAdjust widths of existing columns to fit in a column for payment method.\nFixes #3902\nFixes #4125", "committedDate": "2020-05-15T14:06:48Z", "type": "forcePushed"}]}