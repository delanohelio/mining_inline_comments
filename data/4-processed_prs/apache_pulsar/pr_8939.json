{"pr_number": 8939, "pr_title": "[ISSUE 8832] Avro custom schema not working in consumer", "pr_createdAt": "2020-12-12T15:56:05Z", "pr_url": "https://github.com/apache/pulsar/pull/8939", "timeline": [{"oid": "fc7b1fe49c47d40b266e7c0ed61774e3771f512f", "url": "https://github.com/apache/pulsar/commit/fc7b1fe49c47d40b266e7c0ed61774e3771f512f", "message": "fix avro custom schema", "committedDate": "2020-12-12T15:42:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3ODk4Mw==", "url": "https://github.com/apache/pulsar/pull/8939#discussion_r541878983", "bodyText": "Please close this PulsarClient", "author": "eolivelli", "createdAt": "2020-12-13T08:47:40Z", "path": "pulsar-broker/src/test/java/org/apache/pulsar/client/impl/BrokerClientIntegrationTest.java", "diffHunk": "@@ -858,8 +861,40 @@ public void asyncClose(org.apache.bookkeeper.client.AsyncCallback.CloseCallback\n         consumer.close();\n     }\n \n+\n+    @Test\n+    public void testAvroSchemaProducerConsumerWithSpecifiedReaderAndWriter() throws PulsarClientException {\n+        final String topicName = \"persistent://my-property/my-ns/my-topic1\";\n+        TestMessageObject object = new TestMessageObject();\n+        SchemaReader<TestMessageObject> reader = Mockito.mock(SchemaReader.class);\n+        SchemaWriter<TestMessageObject> writer = Mockito.mock(SchemaWriter.class);\n+        Mockito.when(reader.read(Mockito.any(byte[].class), Mockito.any(byte[].class))).thenReturn(object);\n+        Mockito.when(writer.write(Mockito.any(TestMessageObject.class))).thenReturn(\"fake data\".getBytes(StandardCharsets.UTF_8));\n+        SchemaDefinition<TestMessageObject> schemaDefinition = new SchemaDefinitionBuilderImpl<TestMessageObject>()\n+                .withPojo(TestMessageObject.class)\n+                .withSchemaReader(reader)\n+                .withSchemaWriter(writer)\n+                .build();\n+        Schema<TestMessageObject> schema = Schema.AVRO(schemaDefinition);\n+        PulsarClient client =  PulsarClient.builder()", "originalCommit": "fc7b1fe49c47d40b266e7c0ed61774e3771f512f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg4MTEzNg==", "url": "https://github.com/apache/pulsar/pull/8939#discussion_r541881136", "bodyText": "Thank you, it has been fixed.", "author": "reswqa", "createdAt": "2020-12-13T09:00:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3ODk4Mw=="}], "type": "inlineReview"}, {"oid": "f24a463fbac6644a3887f118e1a1058d667ad106", "url": "https://github.com/apache/pulsar/commit/f24a463fbac6644a3887f118e1a1058d667ad106", "message": "close flient", "committedDate": "2020-12-13T08:59:10Z", "type": "commit"}, {"oid": "5347c6478bc7cd437bec8d057192e4e96c055605", "url": "https://github.com/apache/pulsar/commit/5347c6478bc7cd437bec8d057192e4e96c055605", "message": "remove unused import", "committedDate": "2020-12-13T09:02:20Z", "type": "commit"}]}