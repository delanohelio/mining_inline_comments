{"pr_number": 8310, "pr_title": "[Offload] Make the field name in `OffloadPolicies` match with config file", "pr_createdAt": "2020-10-20T14:30:30Z", "pr_url": "https://github.com/apache/pulsar/pull/8310", "timeline": [{"oid": "ab65cb6e0dcb48ef01c88f96231918aa7409185b", "url": "https://github.com/apache/pulsar/commit/ab65cb6e0dcb48ef01c88f96231918aa7409185b", "message": "make the field name in `OffloadPolicies` match with config file.\n\n1. managedLedgerOffloadAutoTriggerSizeThresholdBytes\n2. managedLedgerOffloadDeletionLagMs", "committedDate": "2020-10-20T14:20:49Z", "type": "commit"}, {"oid": "cc3741dddcdde2d56b8d330a1f75ac6e5316dd5a", "url": "https://github.com/apache/pulsar/commit/cc3741dddcdde2d56b8d330a1f75ac6e5316dd5a", "message": "fix license header", "committedDate": "2020-10-21T02:09:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk5NjA0NQ==", "url": "https://github.com/apache/pulsar/pull/8310#discussion_r508996045", "bodyText": "What is the backward compatibility story here because we are changing the field name for OffloadPolicies? If there is already a namespace policy written using previous field names, how do we guarantee the new code is able to read the offload policies written using the old code?", "author": "sijie", "createdAt": "2020-10-21T05:20:16Z", "path": "pulsar-common/src/main/java/org/apache/pulsar/common/policies/data/OffloadPolicies.java", "diffHunk": "@@ -51,8 +51,8 @@\n     private String managedLedgerOffloadDriver = null;\n     private int managedLedgerOffloadMaxThreads = DEFAULT_OFFLOAD_MAX_THREADS;\n     private int managedLedgerOffloadPrefetchRounds = DEFAULT_OFFLOAD_MAX_PREFETCH_ROUNDS;\n-    private long managedLedgerOffloadThresholdInBytes = DEFAULT_OFFLOAD_THRESHOLD_IN_BYTES;\n-    private Long managedLedgerOffloadDeletionLagInMillis = DEFAULT_OFFLOAD_DELETION_LAG_IN_MILLIS;\n+    private long managedLedgerOffloadAutoTriggerSizeThresholdBytes = DEFAULT_OFFLOAD_THRESHOLD_IN_BYTES;", "originalCommit": "cc3741dddcdde2d56b8d330a1f75ac6e5316dd5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE4MDcyOQ==", "url": "https://github.com/apache/pulsar/pull/8310#discussion_r510180729", "bodyText": "Yes, this change will cause the compatible problem, I resolved it.", "author": "gaoran10", "createdAt": "2020-10-22T13:54:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk5NjA0NQ=="}], "type": "inlineReview"}, {"oid": "0ff8da4e695913ee68c30db649178d4ad1a1f109", "url": "https://github.com/apache/pulsar/commit/0ff8da4e695913ee68c30db649178d4ad1a1f109", "message": "make offload policies configurations are compatible with the broker config file(`broker.conf` or `standalone.conf`).", "committedDate": "2020-10-21T16:41:50Z", "type": "commit"}, {"oid": "5085627dbf5b1d4818e354f8eefda8edca35fc9b", "url": "https://github.com/apache/pulsar/commit/5085627dbf5b1d4818e354f8eefda8edca35fc9b", "message": "fix stylecheck", "committedDate": "2020-10-22T07:52:44Z", "type": "commit"}, {"oid": "0458642f361754030c4bef462537682d7aab3a06", "url": "https://github.com/apache/pulsar/commit/0458642f361754030c4bef462537682d7aab3a06", "message": "fix", "committedDate": "2020-10-22T15:23:42Z", "type": "commit"}, {"oid": "eb47a83bd682252793d53501a4839bca62f4c77d", "url": "https://github.com/apache/pulsar/commit/eb47a83bd682252793d53501a4839bca62f4c77d", "message": "fix set offload threshold command and set offload deletion command", "committedDate": "2020-10-22T15:31:49Z", "type": "commit"}, {"oid": "67acaf451714a95c953fba383ee70481722dd26a", "url": "https://github.com/apache/pulsar/commit/67acaf451714a95c953fba383ee70481722dd26a", "message": "fix", "committedDate": "2020-10-25T13:21:46Z", "type": "commit"}, {"oid": "c5ffd9629d2fc4dd1bf040706a55483e041b4ca2", "url": "https://github.com/apache/pulsar/commit/c5ffd9629d2fc4dd1bf040706a55483e041b4ca2", "message": "fix test", "committedDate": "2020-10-25T17:40:49Z", "type": "commit"}, {"oid": "39a5308577fc024e22326ad97cf2085ef041296a", "url": "https://github.com/apache/pulsar/commit/39a5308577fc024e22326ad97cf2085ef041296a", "message": "fix", "committedDate": "2020-10-26T01:40:55Z", "type": "commit"}, {"oid": "6cea5fd9b900d1926ad726bbe31e5baeca2e4ec8", "url": "https://github.com/apache/pulsar/commit/6cea5fd9b900d1926ad726bbe31e5baeca2e4ec8", "message": "fix", "committedDate": "2020-10-26T02:44:13Z", "type": "commit"}, {"oid": "454a382509236fe64a3d5a743762aefd8c22fb20", "url": "https://github.com/apache/pulsar/commit/454a382509236fe64a3d5a743762aefd8c22fb20", "message": "offload policies merged by topic level policies, namespace level policies, broker level configuration.", "committedDate": "2020-10-26T17:55:27Z", "type": "commit"}, {"oid": "b8147326df12253c57c614404aebede304807d40", "url": "https://github.com/apache/pulsar/commit/b8147326df12253c57c614404aebede304807d40", "message": "fix", "committedDate": "2020-10-26T18:24:26Z", "type": "commit"}, {"oid": "cf14c5b46e8132e86b1ec77271b65290514c1b0e", "url": "https://github.com/apache/pulsar/commit/cf14c5b46e8132e86b1ec77271b65290514c1b0e", "message": "fix", "committedDate": "2020-10-26T18:35:37Z", "type": "commit"}, {"oid": "2f525f829264a70f6308b469e34c7f28d5be33d1", "url": "https://github.com/apache/pulsar/commit/2f525f829264a70f6308b469e34c7f28d5be33d1", "message": "fix", "committedDate": "2020-10-26T18:52:41Z", "type": "commit"}, {"oid": "9c4589a565f0cbfc708b673c5267099aa829ea94", "url": "https://github.com/apache/pulsar/commit/9c4589a565f0cbfc708b673c5267099aa829ea94", "message": "fix", "committedDate": "2020-10-26T19:17:51Z", "type": "commit"}, {"oid": "3fba947b31091f8b74bec7d8059b19f428532ab3", "url": "https://github.com/apache/pulsar/commit/3fba947b31091f8b74bec7d8059b19f428532ab3", "message": "fix", "committedDate": "2020-10-26T20:01:20Z", "type": "commit"}, {"oid": "97717f2f4b391520ae051f29126b7c0c28bf1a42", "url": "https://github.com/apache/pulsar/commit/97717f2f4b391520ae051f29126b7c0c28bf1a42", "message": "fix", "committedDate": "2020-10-27T02:05:40Z", "type": "commit"}, {"oid": "820d6a039cf580101aab06772fee0b5c3aa133fb", "url": "https://github.com/apache/pulsar/commit/820d6a039cf580101aab06772fee0b5c3aa133fb", "message": "fix", "committedDate": "2020-10-27T05:44:10Z", "type": "commit"}, {"oid": "07288e179b5f7bdeef50ac6467daa3c1ef5c2ae8", "url": "https://github.com/apache/pulsar/commit/07288e179b5f7bdeef50ac6467daa3c1ef5c2ae8", "message": "fix", "committedDate": "2020-10-27T06:26:43Z", "type": "commit"}, {"oid": "8aa3332294677fa610b951016a4277076e6b0292", "url": "https://github.com/apache/pulsar/commit/8aa3332294677fa610b951016a4277076e6b0292", "message": "fix", "committedDate": "2020-10-27T07:45:39Z", "type": "commit"}, {"oid": "b51fd1479bcb3e4427ba8e58b230c08df00965a9", "url": "https://github.com/apache/pulsar/commit/b51fd1479bcb3e4427ba8e58b230c08df00965a9", "message": "fix", "committedDate": "2020-10-27T11:19:07Z", "type": "commit"}, {"oid": "405180f4cc3f69aec0950410916c449bafb1343d", "url": "https://github.com/apache/pulsar/commit/405180f4cc3f69aec0950410916c449bafb1343d", "message": "fix", "committedDate": "2020-10-27T11:39:39Z", "type": "commit"}, {"oid": "1e912cc3341c9071fce9d2ee37f2eaf51a7d8d10", "url": "https://github.com/apache/pulsar/commit/1e912cc3341c9071fce9d2ee37f2eaf51a7d8d10", "message": "fix", "committedDate": "2020-10-27T12:35:15Z", "type": "commit"}]}