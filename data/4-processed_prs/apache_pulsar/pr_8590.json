{"pr_number": 8590, "pr_title": "Update ZooKeeper to 3.6.2 and Curator to 5.1.0", "pr_createdAt": "2020-11-17T08:52:26Z", "pr_url": "https://github.com/apache/pulsar/pull/8590", "timeline": [{"oid": "add680a6d2105349e2c3f97c592ed87e92823efd", "url": "https://github.com/apache/pulsar/commit/add680a6d2105349e2c3f97c592ed87e92823efd", "message": "Update ZooKeeper to 3.6.2 and Curator to 5.1.0", "committedDate": "2020-11-17T08:48:23Z", "type": "commit"}, {"oid": "47cbe3320fa71a97441df20a8ffcae1c5e64b3d1", "url": "https://github.com/apache/pulsar/commit/47cbe3320fa71a97441df20a8ffcae1c5e64b3d1", "message": "port from #8348", "committedDate": "2020-11-17T08:53:41Z", "type": "commit"}, {"oid": "b33b9bab8bf6fb1c7efdaea761ce268a746e02af", "url": "https://github.com/apache/pulsar/commit/b33b9bab8bf6fb1c7efdaea761ce268a746e02af", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-01-14T08:56:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI2NTI4MQ==", "url": "https://github.com/apache/pulsar/pull/8590#discussion_r557265281", "bodyText": "Can you explain why do we need this? I failed to see this dependency was used here. The same question apply to the other dependency.", "author": "sijie", "createdAt": "2021-01-14T09:44:49Z", "path": "managed-ledger/pom.xml", "diffHunk": "@@ -84,7 +84,16 @@\n       <classifier>tests</classifier>\n       <scope>test</scope>\n     </dependency>\n-\n+    <dependency>\n+       <groupId>io.dropwizard.metrics</groupId>", "originalCommit": "b33b9bab8bf6fb1c7efdaea761ce268a746e02af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI5Mzk5Mg==", "url": "https://github.com/apache/pulsar/pull/8590#discussion_r557293992", "bodyText": "because from zk 3.6 onwards the \"zookeeper\" Maven artifact does not import those dependencies anymore to the dependant projects.\nThis is because we (ZooKeeper project community) want to say that this artifact is only the \"zookeeper java client\" and the zookeeper java client does not need such jars.\nBut we still do not provide a \"zookeeper server\" jar\nIn Pulsar we are also running the ZooKeeper server (both for production and for tests) and so we need to explicitly add those two jar to the build, otherwise the ZooKeeper server won't start", "author": "eolivelli", "createdAt": "2021-01-14T10:29:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI2NTI4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDM3MzkxNA==", "url": "https://github.com/apache/pulsar/pull/8590#discussion_r560373914", "bodyText": "It would be good to leave a comment with the reason we're adding these, otherwise down the road it will be difficult to remember the rationale.", "author": "merlimat", "createdAt": "2021-01-19T17:57:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI2NTI4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODI1NDI5NQ==", "url": "https://github.com/apache/pulsar/pull/8590#discussion_r568254295", "bodyText": "@sijie  PTAL the description was added on the new deps", "author": "merlimat", "createdAt": "2021-02-02T01:14:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI2NTI4MQ=="}], "type": "inlineReview"}, {"oid": "60835b1f232cee0ecc6d70959b11791c4a4e1c1b", "url": "https://github.com/apache/pulsar/commit/60835b1f232cee0ecc6d70959b11791c4a4e1c1b", "message": "Exclude shaded ZooKeeper from spotbugs", "committedDate": "2021-01-14T10:42:07Z", "type": "commit"}, {"oid": "e30bf3267b9047860db2f7d1545ad53642e87599", "url": "https://github.com/apache/pulsar/commit/e30bf3267b9047860db2f7d1545ad53642e87599", "message": "fix spotbugs", "committedDate": "2021-01-14T11:11:30Z", "type": "commit"}, {"oid": "d01491fffceffc5582dc70e931004ee575d7797e", "url": "https://github.com/apache/pulsar/commit/d01491fffceffc5582dc70e931004ee575d7797e", "message": "fix licenses and tests", "committedDate": "2021-01-14T14:36:14Z", "type": "commit"}, {"oid": "fe2f2dbb310a45fc610be12c4f907634459204fd", "url": "https://github.com/apache/pulsar/commit/fe2f2dbb310a45fc610be12c4f907634459204fd", "message": "fix more tests", "committedDate": "2021-01-14T15:26:56Z", "type": "commit"}, {"oid": "9e62f7c4bfb42b22e9aeba33e3346fa038169ad0", "url": "https://github.com/apache/pulsar/commit/9e62f7c4bfb42b22e9aeba33e3346fa038169ad0", "message": "More test deps", "committedDate": "2021-01-15T08:30:47Z", "type": "commit"}, {"oid": "54406991288b316eef4a8c85fdc73fa80d626139", "url": "https://github.com/apache/pulsar/commit/54406991288b316eef4a8c85fdc73fa80d626139", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-01-18T16:30:34Z", "type": "commit"}, {"oid": "d887b9ed08acad6fb876e5defddcb4c50473b6a7", "url": "https://github.com/apache/pulsar/commit/d887b9ed08acad6fb876e5defddcb4c50473b6a7", "message": "Upgrade Curator in Flume connector", "committedDate": "2021-01-19T11:11:45Z", "type": "commit"}, {"oid": "39143a7b261921258ab1e97c7f7fab76438d7627", "url": "https://github.com/apache/pulsar/commit/39143a7b261921258ab1e97c7f7fab76438d7627", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-01-20T08:36:18Z", "type": "commit"}, {"oid": "a90fe83e98ff8add57d31e3cd42d3c22727706ba", "url": "https://github.com/apache/pulsar/commit/a90fe83e98ff8add57d31e3cd42d3c22727706ba", "message": "Fix refletion usage of ZK internals", "committedDate": "2021-01-20T10:45:18Z", "type": "commit"}, {"oid": "c8f571d70e973ede744e1ecb31d13d38619674a4", "url": "https://github.com/apache/pulsar/commit/c8f571d70e973ede744e1ecb31d13d38619674a4", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-01-21T07:21:17Z", "type": "commit"}, {"oid": "624441ffb3ee4420d376916a54309d3954738e5f", "url": "https://github.com/apache/pulsar/commit/624441ffb3ee4420d376916a54309d3954738e5f", "message": "Make AdminApiOffloadTest less flaky", "committedDate": "2021-01-21T08:15:48Z", "type": "commit"}, {"oid": "58a5dff943afc5656ef4bed2d9e27f0b75d7ff66", "url": "https://github.com/apache/pulsar/commit/58a5dff943afc5656ef4bed2d9e27f0b75d7ff66", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-01-22T07:48:13Z", "type": "commit"}, {"oid": "a7220ecc1c4a6e6a7bbb2573e49cb79e479e82e6", "url": "https://github.com/apache/pulsar/commit/a7220ecc1c4a6e6a7bbb2573e49cb79e479e82e6", "message": "Fix MockZooKeeper", "committedDate": "2021-01-22T08:57:13Z", "type": "commit"}, {"oid": "c3a9c2d30b09cdb596128f81eb420bf75b1cf8dc", "url": "https://github.com/apache/pulsar/commit/c3a9c2d30b09cdb596128f81eb420bf75b1cf8dc", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-01-25T07:44:50Z", "type": "commit"}, {"oid": "d604fc39d19b91983537ff65e758ffd143a0cf7e", "url": "https://github.com/apache/pulsar/commit/d604fc39d19b91983537ff65e758ffd143a0cf7e", "message": "Merge branch 'master' into fix/zk-3.6", "committedDate": "2021-01-29T07:30:26Z", "type": "commit"}, {"oid": "40e527565be80974d66486527d39dfe42e88b0ef", "url": "https://github.com/apache/pulsar/commit/40e527565be80974d66486527d39dfe42e88b0ef", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-02-01T09:46:46Z", "type": "commit"}, {"oid": "dffbfb4740c469a8bff675830c0841e89f30e521", "url": "https://github.com/apache/pulsar/commit/dffbfb4740c469a8bff675830c0841e89f30e521", "message": "remove line", "committedDate": "2021-02-01T13:30:16Z", "type": "commit"}, {"oid": "930f84d80f204cf7ac79d34a6747e9ee412a5a99", "url": "https://github.com/apache/pulsar/commit/930f84d80f204cf7ac79d34a6747e9ee412a5a99", "message": "Fixed use of multi() in MockZookeeper", "committedDate": "2021-02-02T00:23:13Z", "type": "commit"}, {"oid": "c2015a84b33629ba51cafe65cd8500179f3ea72a", "url": "https://github.com/apache/pulsar/commit/c2015a84b33629ba51cafe65cd8500179f3ea72a", "message": "More ZK dependency fixes", "committedDate": "2021-02-02T04:46:23Z", "type": "commit"}, {"oid": "bf3e784ed984eb7fc39844b4d1726f9c94cf3f43", "url": "https://github.com/apache/pulsar/commit/bf3e784ed984eb7fc39844b4d1726f9c94cf3f43", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-02-02T09:04:26Z", "type": "commit"}, {"oid": "822b1dc5aaa81af0528785c3b986b2ae7674aee1", "url": "https://github.com/apache/pulsar/commit/822b1dc5aaa81af0528785c3b986b2ae7674aee1", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-02-05T14:58:12Z", "type": "commit"}, {"oid": "822b1dc5aaa81af0528785c3b986b2ae7674aee1", "url": "https://github.com/apache/pulsar/commit/822b1dc5aaa81af0528785c3b986b2ae7674aee1", "message": "Merge remote-tracking branch 'origin/master' into fix/zk-3.6", "committedDate": "2021-02-05T14:58:12Z", "type": "forcePushed"}, {"oid": "8b2c460d6a8b224a5ce1588577468aea9df4c26d", "url": "https://github.com/apache/pulsar/commit/8b2c460d6a8b224a5ce1588577468aea9df4c26d", "message": "Merge branch 'master' into fix/zk-3.6", "committedDate": "2021-02-08T07:30:22Z", "type": "commit"}, {"oid": "957ea1e397108a260bf4d3de12b66099c5434e26", "url": "https://github.com/apache/pulsar/commit/957ea1e397108a260bf4d3de12b66099c5434e26", "message": "Merge branch 'master' into fix/zk-3.6", "committedDate": "2021-02-09T07:24:12Z", "type": "commit"}, {"oid": "10487e0247b9f2743daff4733a50f12ab957e53b", "url": "https://github.com/apache/pulsar/commit/10487e0247b9f2743daff4733a50f12ab957e53b", "message": "Fix license check", "committedDate": "2021-02-09T13:33:52Z", "type": "commit"}, {"oid": "379dac7854db9509a25e1c6dd79e70f25a11a936", "url": "https://github.com/apache/pulsar/commit/379dac7854db9509a25e1c6dd79e70f25a11a936", "message": "Merge branch 'master' into fix/zk-3.6", "committedDate": "2021-02-10T07:31:59Z", "type": "commit"}, {"oid": "a300cac01d1284454f07f6b73a99228cbc191031", "url": "https://github.com/apache/pulsar/commit/a300cac01d1284454f07f6b73a99228cbc191031", "message": "revert typo", "committedDate": "2021-02-10T08:06:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDEyMDkxNw==", "url": "https://github.com/apache/pulsar/pull/8590#discussion_r574120917", "bodyText": "Bookkeeper uses Zookeeper 3.6.2 and dropwizard 3.1.0, I think it makes sense to keep dependency versions in sync to avoid surprises later", "author": "dlg99", "createdAt": "2021-02-10T22:23:57Z", "path": "distribution/server/src/assemble/LICENSE.bin.txt", "diffHunk": "@@ -494,9 +494,9 @@ The Apache Software License, Version 2.0\n     - joda-time-2.10.1.jar\n     - joda-time-joda-time-2.10.1.jar\n   * Dropwizard\n-    - io.dropwizard.metrics-metrics-core-3.1.0.jar\n-    - io.dropwizard.metrics-metrics-graphite-3.1.0.jar\n-    - io.dropwizard.metrics-metrics-jvm-3.1.0.jar\n+    - io.dropwizard.metrics-metrics-core-3.2.5.jar", "originalCommit": "a300cac01d1284454f07f6b73a99228cbc191031", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDI5MDE3OA==", "url": "https://github.com/apache/pulsar/pull/8590#discussion_r574290178", "bodyText": "@dlg99 I can't remember why I had to make this bump.\nProbably it is the same version as in ZK.\nI would prefer to upgrade this dep in BK 4.13.", "author": "eolivelli", "createdAt": "2021-02-11T07:24:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDEyMDkxNw=="}], "type": "inlineReview"}]}