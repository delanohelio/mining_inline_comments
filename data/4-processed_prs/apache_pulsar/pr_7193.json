{"pr_number": 7193, "pr_title": "function to read compacted topics", "pr_createdAt": "2020-06-07T18:32:03Z", "pr_url": "https://github.com/apache/pulsar/pull/7193", "timeline": [{"oid": "a290ce2db30775833fddae75a21d02c50e80c48d", "url": "https://github.com/apache/pulsar/commit/a290ce2db30775833fddae75a21d02c50e80c48d", "message": "add read compacted for function", "committedDate": "2020-06-07T13:49:21Z", "type": "commit"}, {"oid": "d644a4fc9042cdcb7b6fc852e18694b81a4ea98a", "url": "https://github.com/apache/pulsar/commit/d644a4fc9042cdcb7b6fc852e18694b81a4ea98a", "message": "add read compacted for sink", "committedDate": "2020-06-07T18:25:50Z", "type": "commit"}, {"oid": "3d5b4115706e7f87367189744b4caccfbcfea643", "url": "https://github.com/apache/pulsar/commit/3d5b4115706e7f87367189744b4caccfbcfea643", "message": "fix npe", "committedDate": "2020-06-08T01:25:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ0Nzg0Ng==", "url": "https://github.com/apache/pulsar/pull/7193#discussion_r436447846", "bodyText": "Is this related to this PR?", "author": "codelipenghui", "createdAt": "2020-06-08T04:06:51Z", "path": "pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdFunctions.java", "diffHunk": "@@ -233,6 +234,8 @@ void processArguments() throws Exception {\n         protected String customSerdeInputString;\n         @Parameter(names = \"--custom-schema-inputs\", description = \"The map of input topics to Schema class names (as a JSON string)\")\n         protected String customSchemaInputString;\n+        @Parameter(names = \"--input-specs\", description = \"The map of inputs to custom configuration (as a JSON string)\")", "originalCommit": "3d5b4115706e7f87367189744b4caccfbcfea643", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ0Nzg2NQ==", "url": "https://github.com/apache/pulsar/pull/7193#discussion_r436447865", "bodyText": "Is this related to this PR?", "author": "codelipenghui", "createdAt": "2020-06-08T04:06:58Z", "path": "pulsar-client-tools/src/main/java/org/apache/pulsar/admin/cli/CmdSinks.java", "diffHunk": "@@ -276,6 +277,9 @@ protected void validateSinkConfigs(SinkConfig sinkConfig) {\n         @Parameter(names = \"--custom-schema-inputs\", description = \"The map of input topics to Schema types or class names (as a JSON string)\")\n         protected String customSchemaInputString;\n \n+        @Parameter(names = \"--input-specs\", description = \"The map of inputs to custom configuration (as a JSON string)\")", "originalCommit": "3d5b4115706e7f87367189744b4caccfbcfea643", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUzOTgwOA==", "url": "https://github.com/apache/pulsar/pull/7193#discussion_r436539808", "bodyText": "I think a more generic approach is to add a Map<String, String> to the consumer spec. So we can use \n  \n    \n      pulsar/pulsar-client/src/main/java/org/apache/pulsar/client/impl/ConsumerBuilderImpl.java\n    \n    \n         Line 86\n      in\n      870a637\n    \n    \n    \n    \n\n        \n          \n           public ConsumerBuilder<T> loadConf(Map<String, Object> config) { \n        \n    \n  \n\n to load the consumer configuration when building the consumers.", "author": "sijie", "createdAt": "2020-06-08T08:40:40Z", "path": "pulsar-functions/proto/src/main/proto/Function.proto", "diffHunk": "@@ -94,6 +94,7 @@ message ConsumerSpec {\n         int32 value = 1;\n     }\n     ReceiverQueueSize receiverQueueSize = 4;\n+    bool readCompacted = 5;", "originalCommit": "3d5b4115706e7f87367189744b4caccfbcfea643", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYxNDI5Mw==", "url": "https://github.com/apache/pulsar/pull/7193#discussion_r437614293", "bodyText": "We already have a ConsumerConfig class:\nhttps://github.com/apache/pulsar/blob/master/pulsar-common/src/main/java/org/apache/pulsar/common/functions/ConsumerConfig.java\nThough I am for refactoring this to be generic Map so we don't have to make code changes for new consumer configs that are added.", "author": "jerrypeng", "createdAt": "2020-06-09T17:54:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUzOTgwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU4NDQ1MQ==", "url": "https://github.com/apache/pulsar/pull/7193#discussion_r438584451", "bodyText": "We already have a ConsumerConfig class:\nhttps://github.com/apache/pulsar/blob/master/pulsar-common/src/main/java/org/apache/pulsar/common/functions/ConsumerConfig.java\nThough I am for refactoring this to be generic Map so we don't have to make code changes for new consumer configs that are added.\n\nThanks very much. But schemaProperties are properties belonging to the schema. Put the Consumer parameters with them, I don\u2019t think it\u2019s a good way. I think it is necessary to add a new Map to save the general parameters of Consumer.And this make it easier to convert Map to object", "author": "315157973", "createdAt": "2020-06-11T07:07:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUzOTgwOA=="}], "type": "inlineReview"}, {"oid": "3c2b3d989b4a47306580b1ee70ad727445595526", "url": "https://github.com/apache/pulsar/commit/3c2b3d989b4a47306580b1ee70ad727445595526", "message": "merge master", "committedDate": "2020-06-10T12:58:44Z", "type": "commit"}, {"oid": "ee1c480c95ac17894e45fa3f108998b962ea2086", "url": "https://github.com/apache/pulsar/commit/ee1c480c95ac17894e45fa3f108998b962ea2086", "message": "use generic map to set consumer parameters", "committedDate": "2020-06-14T03:57:23Z", "type": "commit"}, {"oid": "6107e460d5a7b2c3ff9bf2a216c4a0828a61795a", "url": "https://github.com/apache/pulsar/commit/6107e460d5a7b2c3ff9bf2a216c4a0828a61795a", "message": "fix npe", "committedDate": "2020-06-14T06:11:27Z", "type": "commit"}]}