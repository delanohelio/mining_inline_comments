{"pr_number": 8880, "pr_title": "[logging] Upgrade Log4j2 version to 2.14.0 and replace legacy log4j dependency", "pr_createdAt": "2020-12-09T14:55:13Z", "pr_url": "https://github.com/apache/pulsar/pull/8880", "timeline": [{"oid": "df88026f79aa17608f306987f22578c5bb644eb5", "url": "https://github.com/apache/pulsar/commit/df88026f79aa17608f306987f22578c5bb644eb5", "message": "[logging] Upgrade Log4j2 version to 2.14.0, replace legacy log4j dependency with log4j-1.2-api\n\n- import Log4j2's BOM into Pulsar's dependency management instead of\n  defining versions separately for each Log4j2 library\n\n- distribution/server/pom.xml included log4j:log4j dependency.\n  - replace with org.apache.logging.log4j:log4j-1.2-api to\n    keep supporting the legacy logging api in the case something\n    depends on it", "committedDate": "2020-12-09T14:25:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ3NDQ0NQ==", "url": "https://github.com/apache/pulsar/pull/8880#discussion_r539474445", "bodyText": "This depedency could be possibly removed alltogether, no?", "author": "merlimat", "createdAt": "2020-12-09T16:52:15Z", "path": "managed-ledger/pom.xml", "diffHunk": "@@ -97,8 +97,8 @@\n     </dependency>\n \n     <dependency>", "originalCommit": "df88026f79aa17608f306987f22578c5bb644eb5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ4NzEyNQ==", "url": "https://github.com/apache/pulsar/pull/8880#discussion_r539487125", "bodyText": "I'll check that after investigating why the legacy log4j dependency was there previously.", "author": "lhotari", "createdAt": "2020-12-09T17:08:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ3NDQ0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ3NDk0Mg==", "url": "https://github.com/apache/pulsar/pull/8880#discussion_r539474942", "bodyText": "For this we need the read depedency, since this determines what goes inside the distribution tar", "author": "merlimat", "createdAt": "2020-12-09T16:52:55Z", "path": "distribution/server/pom.xml", "diffHunk": "@@ -95,8 +95,8 @@\n     </dependency>\n \n     <dependency>\n-      <artifactId>log4j</artifactId>\n-      <groupId>log4j</groupId>\n+      <groupId>org.apache.logging.log4j</groupId>", "originalCommit": "df88026f79aa17608f306987f22578c5bb644eb5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ4NjIxOQ==", "url": "https://github.com/apache/pulsar/pull/8880#discussion_r539486219", "bodyText": "Thanks for the review.\nI'm just trying to understand that how the legacy log4j dependency is used. The log4j-1.2-api as part of Log4j2 provides the legacy log4j API but routes the log events to log4j2. I'd assume that this would be the correct approach if legacy log4j and log4j2 co-exist.\nHowever is legacy log4j even needed? I see that legacy log4j is excluded from many dependencies. mvn dependency:tree didn't give a direct answer, but I can try to investigate by temporarily removing the exclusions locally.", "author": "lhotari", "createdAt": "2020-12-09T17:06:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ3NDk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ4NzgzMg==", "url": "https://github.com/apache/pulsar/pull/8880#discussion_r539487832", "bodyText": "Oh, I got confused with log4j2. I think here we're adding this dependency because of ZK. Your change is probably the correct one then.", "author": "merlimat", "createdAt": "2020-12-09T17:09:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQ3NDk0Mg=="}], "type": "inlineReview"}]}