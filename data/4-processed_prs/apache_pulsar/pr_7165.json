{"pr_number": 7165, "pr_title": "Attach names for all producers/readers in worker service", "pr_createdAt": "2020-06-04T05:10:30Z", "pr_url": "https://github.com/apache/pulsar/pull/7165", "timeline": [{"oid": "3d73e65302239e07090f97e8e14a37cbbb40220a", "url": "https://github.com/apache/pulsar/commit/3d73e65302239e07090f97e8e14a37cbbb40220a", "message": "Attach names for all producers/readers in worker service", "committedDate": "2020-06-04T05:08:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5NzAwNQ==", "url": "https://github.com/apache/pulsar/pull/7165#discussion_r434997005", "bodyText": "I don't know if its needed to add \"-function-metadata-manager\".  I would say that this information as a property e.g. component: function-metadata-manager but properties is not exposed for the reader", "author": "jerrypeng", "createdAt": "2020-06-04T05:15:47Z", "path": "pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/FunctionMetaDataManager.java", "diffHunk": "@@ -91,6 +91,7 @@ public void initialize() {\n             Reader<byte[]> reader = pulsarClient.newReader()\n                     .topic(this.workerConfig.getFunctionMetadataTopic())\n                     .startMessageId(MessageId.earliest)\n+                    .readerName(workerConfig.getWorkerId() + \"-function-metadata-manager\")", "originalCommit": "3d73e65302239e07090f97e8e14a37cbbb40220a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAwMjcyNw==", "url": "https://github.com/apache/pulsar/pull/7165#discussion_r435002727", "bodyText": "I would rather prefer it to be more specific than just assumed.", "author": "srkukarni", "createdAt": "2020-06-04T05:36:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5NzAwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY5MjQ5NQ==", "url": "https://github.com/apache/pulsar/pull/7165#discussion_r435692495", "bodyText": "I meant to add it here\ncan you also add\n\n.subscriptionRolePrefix(workerConfig.getWorkerId())", "author": "jerrypeng", "createdAt": "2020-06-05T05:07:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5NzAwNQ=="}], "type": "inlineReview"}, {"oid": "669793d77111975bc048b8f2afc1c9c7e00480fc", "url": "https://github.com/apache/pulsar/commit/669793d77111975bc048b8f2afc1c9c7e00480fc", "message": "Fix tests", "committedDate": "2020-06-04T06:52:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ3MTAzNQ==", "url": "https://github.com/apache/pulsar/pull/7165#discussion_r435471035", "bodyText": "can you also add\n.subscriptionRolePrefix(workerConfig.getWorkerId())", "author": "jerrypeng", "createdAt": "2020-06-04T18:38:21Z", "path": "pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/SchedulerManager.java", "diffHunk": "@@ -106,6 +106,7 @@ public SchedulerManager(WorkerConfig workerConfig, PulsarClient pulsarClient, Pu\n                                 .blockIfQueueFull(true)\n                                 .compressionType(CompressionType.LZ4)\n                                 .sendTimeout(0, TimeUnit.MILLISECONDS)\n+                                .producerName(config.getWorkerId() + \"-scheduler-manager\")", "originalCommit": "669793d77111975bc048b8f2afc1c9c7e00480fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyNDYxMA==", "url": "https://github.com/apache/pulsar/pull/7165#discussion_r435624610", "bodyText": "Producer name needs to be unique, so we better put this in the producer properties instead.", "author": "merlimat", "createdAt": "2020-06-05T00:14:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ3MTAzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyNDkzNQ==", "url": "https://github.com/apache/pulsar/pull/7165#discussion_r435624935", "bodyText": "Actually, in this case it should be good since there's only 1 writer.", "author": "merlimat", "createdAt": "2020-06-05T00:15:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ3MTAzNQ=="}], "type": "inlineReview"}, {"oid": "af2db0d3f41448e8cc5238fe22c4d34a14310382", "url": "https://github.com/apache/pulsar/commit/af2db0d3f41448e8cc5238fe22c4d34a14310382", "message": "Merge branch 'master' into reader_producer_names", "committedDate": "2020-06-04T23:25:18Z", "type": "commit"}]}