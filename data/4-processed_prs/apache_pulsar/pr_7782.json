{"pr_number": 7782, "pr_title": "make pulsar executor pool size configurable", "pr_createdAt": "2020-08-07T09:09:40Z", "pr_url": "https://github.com/apache/pulsar/pull/7782", "timeline": [{"oid": "a6d10f99065559c88de3cea59985b81aad91799c", "url": "https://github.com/apache/pulsar/commit/a6d10f99065559c88de3cea59985b81aad91799c", "message": "make pulsar executor pool size configurable", "committedDate": "2020-08-07T09:03:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MTc5Ng==", "url": "https://github.com/apache/pulsar/pull/7782#discussion_r467481796", "bodyText": "I would be better to default to something like Runtime.getRuntime().availableProcessors()", "author": "merlimat", "createdAt": "2020-08-08T16:35:37Z", "path": "conf/broker.conf", "diffHunk": "@@ -61,6 +61,12 @@ numIOThreads=\n # Number of threads to use for HTTP requests processing. Default is set to 2 * Runtime.getRuntime().availableProcessors()\n numHttpServerThreads=\n \n+# Number of thread pool size to use for pulsar broker service.\n+# The executor in thread pool will do basic broker operation like load/unload bundle, update managedLedgerConfig,\n+# update topic/subscription/replicator message dispatch rate, do leader election etc.\n+# Default is 20\n+numExecutorThreadPoolSize=", "originalCommit": "a6d10f99065559c88de3cea59985b81aad91799c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5NzQ1NA==", "url": "https://github.com/apache/pulsar/pull/7782#discussion_r467597454", "bodyText": "ok, it's better to change it to Runtime.getRuntime().availableProcessors(). it will update the pr.", "author": "hangc0276", "createdAt": "2020-08-09T15:33:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4MTc5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5MTgyOQ==", "url": "https://github.com/apache/pulsar/pull/7782#discussion_r467591829", "bodyText": "@hangc0276  would you please help changed this value as Matteo suggested? Runtime.getRuntime().availableProcessors()", "author": "jiazhai", "createdAt": "2020-08-09T14:41:24Z", "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/PulsarService.java", "diffHunk": "@@ -170,8 +170,8 @@\n     private LocalZooKeeperConnectionService localZooKeeperConnectionProvider;\n     private Compactor compactor;\n \n-    private final ScheduledExecutorService executor = Executors.newScheduledThreadPool(20,\n-            new DefaultThreadFactory(\"pulsar\"));", "originalCommit": "a6d10f99065559c88de3cea59985b81aad91799c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5NzM4Mg==", "url": "https://github.com/apache/pulsar/pull/7782#discussion_r467597382", "bodyText": "Thanks for your review, i will update the pr.", "author": "hangc0276", "createdAt": "2020-08-09T15:32:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5MTgyOQ=="}], "type": "inlineReview"}, {"oid": "d4da45ad8a5f5d1b6cf8f2d21d506e2874b0f578", "url": "https://github.com/apache/pulsar/commit/d4da45ad8a5f5d1b6cf8f2d21d506e2874b0f578", "message": "change default executor thread pool size to Runtime.getRuntime().availableProcessors() and reduce executor thread pool size when running unit tests", "committedDate": "2020-08-10T01:27:28Z", "type": "commit"}]}