{"pr_number": 7228, "pr_title": "Protobuf-shaded package can not update version", "pr_createdAt": "2020-06-10T06:24:49Z", "pr_url": "https://github.com/apache/pulsar/pull/7228", "timeline": [{"oid": "694bbb18f14c5077d874a0ba71e114816db34e31", "url": "https://github.com/apache/pulsar/commit/694bbb18f14c5077d874a0ba71e114816db34e31", "message": "Protobuf-shaeded package can not udpate version\n---\n\n*Motivation*\n\nUsing `set-project-version.sh` always failed with updating\nprotobuf-shaded parent version.\n\nerror log:\n\n```\n[INFO] Scanning for projects...\n[ERROR] [ERROR] Some problems were encountered while processing the POMs:\n[FATAL] Non-resolvable parent POM for org.apache.pulsar:protobuf-shaded:2.6.0-SNAPSHOT: Could not find artifact org.apache.pulsar:pulsar:pom:2.6.0-SNAPSHOT and 'parent.relativePath' points at wrong local POM @ line 26, column 11\n @\n [ERROR] The build could not read 1 project > [Help 1]\n [ERROR]\n [ERROR]   The project org.apache.pulsar:protobuf-shaded:2.6.0-SNAPSHOT (/home/zhangyong/actions-runner/_work/streamnative-ci/streamnative-ci/pulsar/protobuf-shaded/pom.xml) has 1 error\n [ERROR]     Non-resolvable parent POM for org.apache.pulsar:protobuf-shaded:2.6.0-SNAPSHOT: Could not find artifact org.apache.pulsar:pulsar:pom:2.6.0-SNAPSHOT and 'parent.relativePath' points at wrong local POM @ line 26, column 11 > [Help 2]\n [ERROR]\n [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\n [ERROR] Re-run Maven using the -X switch to enable full debug logging.\n [ERROR]\n [ERROR] For more information about the errors and possible solutions, please read the following articles:\n [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/ProjectBuildingException-''-''\n```", "committedDate": "2020-06-10T06:16:42Z", "type": "commit"}, {"oid": "ec4b3e85c5354f73015173dcc83ec9374e5c7d49", "url": "https://github.com/apache/pulsar/commit/ec4b3e85c5354f73015173dcc83ec9374e5c7d49", "message": "Using 'sed' to replace the old version", "committedDate": "2020-06-10T07:07:31Z", "type": "commit"}, {"oid": "e54cdc0dd8b367160db4deae8f8c30bf6e1a04ec", "url": "https://github.com/apache/pulsar/commit/e54cdc0dd8b367160db4deae8f8c30bf6e1a04ec", "message": "Fix scripts", "committedDate": "2020-06-10T08:02:50Z", "type": "commit"}, {"oid": "e54cdc0dd8b367160db4deae8f8c30bf6e1a04ec", "url": "https://github.com/apache/pulsar/commit/e54cdc0dd8b367160db4deae8f8c30bf6e1a04ec", "message": "Fix scripts", "committedDate": "2020-06-10T08:02:50Z", "type": "forcePushed"}, {"oid": "239045026a4868975a95bb11b4f2a0dc9ab60cfd", "url": "https://github.com/apache/pulsar/commit/239045026a4868975a95bb11b4f2a0dc9ab60cfd", "message": "Merge remote-tracking branch 'upstream/master' into fix-update-version", "committedDate": "2020-06-10T10:56:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4NjQ5MQ==", "url": "https://github.com/apache/pulsar/pull/7228#discussion_r438286491", "bodyText": "There's already a script that we use in multiple places to get the version: ./src/get-project-version.py", "author": "merlimat", "createdAt": "2020-06-10T17:18:53Z", "path": "src/set-project-version.sh", "diffHunk": "@@ -30,12 +30,13 @@ NEW_VERSION=$1\n # Go to top level project directory\n pushd $(dirname \"$0\")/..\n \n+# Get the current version\n+OLD_VERSION=`mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec`", "originalCommit": "239045026a4868975a95bb11b4f2a0dc9ab60cfd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMjg4Mw==", "url": "https://github.com/apache/pulsar/pull/7228#discussion_r438512883", "bodyText": "Thanks for reminding me. I change to use the script to get the version. PTAL. Thanks.", "author": "zymap", "createdAt": "2020-06-11T02:48:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4NjQ5MQ=="}], "type": "inlineReview"}, {"oid": "a12f7d421c504d109f6a46bf32d61f8319579b9e", "url": "https://github.com/apache/pulsar/commit/a12f7d421c504d109f6a46bf32d61f8319579b9e", "message": "Address comments", "committedDate": "2020-06-11T02:46:34Z", "type": "commit"}]}