{"pr_number": 8269, "pr_title": "[Issue 8130] Refine BookKeeper metadata service uri when init metadata", "pr_createdAt": "2020-10-15T11:00:17Z", "pr_url": "https://github.com/apache/pulsar/pull/8269", "timeline": [{"oid": "1232d2d9e2c6f584635823ae0059395dc0de4865", "url": "https://github.com/apache/pulsar/commit/1232d2d9e2c6f584635823ae0059395dc0de4865", "message": "Refine BookKeeper metadata service uri when init metadata", "committedDate": "2020-10-15T10:59:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYxMzU3NA==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505613574", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            > If you want to use an existing BookKeeper cluster, you can add `--existing-bk-metadata-service-uri` flag at the mean time like below:\n          \n          \n            \n            > If you want to use an existing BookKeeper cluster, you can add the `--existing-bk-metadata-service-uri` flag as follows:", "author": "Jennifer88huang", "createdAt": "2020-10-15T14:59:13Z", "path": "site2/docs/deploy-bare-metal.md", "diffHunk": "@@ -253,6 +253,17 @@ Flag | Description\n > --broker-service-url-tls pulsar+ssl://host1:6651,host2:6651,host3:6651\n > ```\n \n+> If you want to use an existing BookKeeper cluster, you can add `--existing-bk-metadata-service-uri` flag at the mean time like below:", "originalCommit": "1232d2d9e2c6f584635823ae0059395dc0de4865", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk2MTg5Mw==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505961893", "bodyText": "done.", "author": "murong00", "createdAt": "2020-10-16T01:23:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYxMzU3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYxNzQ1MA==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505617450", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            > The metadata service uri of existing BookKeeper cluster can be fetched via `bin/bookkeeper shell whatisinstanceid` command. Note that the value need to be enclosed in double quotes since the multi metadata service uri is semicolon separated.\n          \n          \n            \n            > You can obtain the metadata service URI of the existing BookKeeper cluster by using the `bin/bookkeeper shell whatisinstanceid` command. You must enclose the value in double quotes since the multiple metadata service URIs are separated with semicolons.", "author": "Jennifer88huang", "createdAt": "2020-10-15T15:03:55Z", "path": "site2/docs/deploy-bare-metal.md", "diffHunk": "@@ -253,6 +253,17 @@ Flag | Description\n > --broker-service-url-tls pulsar+ssl://host1:6651,host2:6651,host3:6651\n > ```\n \n+> If you want to use an existing BookKeeper cluster, you can add `--existing-bk-metadata-service-uri` flag at the mean time like below:\n+>\n+> ```properties\n+> --existing-bk-metadata-service-uri \"zk+null://bk1:2181;bk2:2181/ledgers\" \\\n+> --web-service-url http://host1:8080,host2:8080,host3:8080 \\\n+> --web-service-url-tls https://host1:8443,host2:8443,host3:8443 \\\n+> --broker-service-url pulsar://host1:6650,host2:6650,host3:6650 \\\n+> --broker-service-url-tls pulsar+ssl://host1:6651,host2:6651,host3:6651\n+> ```\n+> The metadata service uri of existing BookKeeper cluster can be fetched via `bin/bookkeeper shell whatisinstanceid` command. Note that the value need to be enclosed in double quotes since the multi metadata service uri is semicolon separated.", "originalCommit": "1232d2d9e2c6f584635823ae0059395dc0de4865", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk2MjAwNA==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505962004", "bodyText": "thanks, done.", "author": "murong00", "createdAt": "2020-10-16T01:23:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYxNzQ1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYxOTg0Ng==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505619846", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||\n          \n          \n            \n            |`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster you want to use||", "author": "Jennifer88huang", "createdAt": "2020-10-15T15:06:34Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -174,10 +174,15 @@ Options\n |`-ub` , `--broker-service-url`|The broker service URL for the new cluster||\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n-|`--configuration-store`|The configuration store quorum connection string||\n+|`-cs` , `--configuration-store`|The configuration store quorum connection string||\n+|`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||", "originalCommit": "1232d2d9e2c6f584635823ae0059395dc0de4865", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk2MjExOA==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505962118", "bodyText": "done.", "author": "murong00", "createdAt": "2020-10-16T01:23:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYxOTg0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYyMDYwMg==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505620602", "bodyText": "what  does \"Num\" mean?", "author": "Jennifer88huang", "createdAt": "2020-10-15T15:07:31Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -174,10 +174,15 @@ Options\n |`-ub` , `--broker-service-url`|The broker service URL for the new cluster||\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n-|`--configuration-store`|The configuration store quorum connection string||\n+|`-cs` , `--configuration-store`|The configuration store quorum connection string||\n+|`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||\n+|`-h` , `--help`|Cluster name|false|\n+|`--initial-num-stream-storage-containers`|Num storage containers of BookKeeper stream storage|16|", "originalCommit": "1232d2d9e2c6f584635823ae0059395dc0de4865", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk2MjUyOQ==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505962529", "bodyText": "\"Num\" is short for number.", "author": "murong00", "createdAt": "2020-10-16T01:24:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYyMDYwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYyMDgwMw==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505620803", "bodyText": "What does \"ms\" stand for in \"Local zookeeper session timeout ms\"?", "author": "Jennifer88huang", "createdAt": "2020-10-15T15:07:47Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -174,10 +174,15 @@ Options\n |`-ub` , `--broker-service-url`|The broker service URL for the new cluster||\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n-|`--configuration-store`|The configuration store quorum connection string||\n+|`-cs` , `--configuration-store`|The configuration store quorum connection string||\n+|`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||\n+|`-h` , `--help`|Cluster name|false|\n+|`--initial-num-stream-storage-containers`|Num storage containers of BookKeeper stream storage|16|\n+|`--initial-num-transaction-coordinators`|Num transaction coordinators will assigned in cluster|16|\n |`-uw` , `--web-service-url`|The web service URL for the new cluster||\n |`-tw` , `--web-service-url-tls`|The web service URL for the new cluster with TLS encryption||\n |`-zk` , `--zookeeper`|The local ZooKeeper quorum connection string||\n+|`--zookeeper-session-timeout-ms`|Local zookeeper session timeout ms|30000|", "originalCommit": "1232d2d9e2c6f584635823ae0059395dc0de4865", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk2MzA2Nw==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505963067", "bodyText": "ms is the time unit which is short for millisecond.", "author": "murong00", "createdAt": "2020-10-16T01:25:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYyMDgwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjAwMzAwNw==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r506003007", "bodyText": "Thanks for your clarification. Maybe we can add it in the description, so it will be clear to users.", "author": "Jennifer88huang", "createdAt": "2020-10-16T02:43:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYyMDgwMw=="}], "type": "inlineReview"}, {"oid": "04bb1b3dee3e0dee0ee4d05279bb4966952bd13c", "url": "https://github.com/apache/pulsar/commit/04bb1b3dee3e0dee0ee4d05279bb4966952bd13c", "message": "address the review comments", "committedDate": "2020-10-16T01:21:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk5OTIyMA==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505999220", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster you want to us||\n          \n          \n            \n            |`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster that you want to use||", "author": "Jennifer88huang", "createdAt": "2020-10-16T02:36:29Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -175,7 +175,7 @@ Options\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n |`-cs` , `--configuration-store`|The configuration store quorum connection string||\n-|`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||\n+|`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster you want to us||", "originalCommit": "04bb1b3dee3e0dee0ee4d05279bb4966952bd13c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk5OTY3Mw==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r505999673", "bodyText": "So shall we use \"The number of storage containers of BookKeeper stream storage\"", "author": "Jennifer88huang", "createdAt": "2020-10-16T02:37:28Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -175,7 +175,7 @@ Options\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n |`-cs` , `--configuration-store`|The configuration store quorum connection string||\n-|`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||\n+|`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster you want to us||\n |`-h` , `--help`|Cluster name|false|\n |`--initial-num-stream-storage-containers`|Num storage containers of BookKeeper stream storage|16|", "originalCommit": "04bb1b3dee3e0dee0ee4d05279bb4966952bd13c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjAwMDAxOQ==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r506000019", "bodyText": "The number of transaction coordinators assigned in a cluster", "author": "Jennifer88huang", "createdAt": "2020-10-16T02:38:01Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -175,7 +175,7 @@ Options\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n |`-cs` , `--configuration-store`|The configuration store quorum connection string||\n-|`--existing-bk-metadata-service-uri`|The metadata service uri of existing BookKeeper cluster you want to use||\n+|`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster you want to us||\n |`-h` , `--help`|Cluster name|false|\n |`--initial-num-stream-storage-containers`|Num storage containers of BookKeeper stream storage|16|\n |`--initial-num-transaction-coordinators`|Num transaction coordinators will assigned in cluster|16|", "originalCommit": "04bb1b3dee3e0dee0ee4d05279bb4966952bd13c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjAwMjcxOQ==", "url": "https://github.com/apache/pulsar/pull/8269#discussion_r506002719", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`--zookeeper-session-timeout-ms`|Local zookeeper session timeout ms|30000|\n          \n          \n            \n            |`--zookeeper-session-timeout-ms`|The local ZooKeeper session timeout. The time unit is in millisecond(ms).|30000|", "author": "Jennifer88huang", "createdAt": "2020-10-16T02:42:57Z", "path": "site2/docs/reference-cli-tools.md", "diffHunk": "@@ -174,10 +174,15 @@ Options\n |`-ub` , `--broker-service-url`|The broker service URL for the new cluster||\n |`-tb` , `--broker-service-url-tls`|The broker service URL for the new cluster with TLS encryption||\n |`-c` , `--cluster`|Cluster name||\n-|`--configuration-store`|The configuration store quorum connection string||\n+|`-cs` , `--configuration-store`|The configuration store quorum connection string||\n+|`--existing-bk-metadata-service-uri`|The metadata service URI of the existing BookKeeper cluster you want to us||\n+|`-h` , `--help`|Cluster name|false|\n+|`--initial-num-stream-storage-containers`|Num storage containers of BookKeeper stream storage|16|\n+|`--initial-num-transaction-coordinators`|Num transaction coordinators will assigned in cluster|16|\n |`-uw` , `--web-service-url`|The web service URL for the new cluster||\n |`-tw` , `--web-service-url-tls`|The web service URL for the new cluster with TLS encryption||\n |`-zk` , `--zookeeper`|The local ZooKeeper quorum connection string||\n+|`--zookeeper-session-timeout-ms`|Local zookeeper session timeout ms|30000|", "originalCommit": "04bb1b3dee3e0dee0ee4d05279bb4966952bd13c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d4477c3e96d92e399ff6e909062abd87b85d918d", "url": "https://github.com/apache/pulsar/commit/d4477c3e96d92e399ff6e909062abd87b85d918d", "message": "address Jennifer's comment", "committedDate": "2020-10-16T04:01:48Z", "type": "commit"}]}