{"pr_number": 1815, "pr_title": "Removes need to disable triggers on PostgresQL", "pr_createdAt": "2020-11-20T20:26:59Z", "pr_url": "https://github.com/fcrepo/fcrepo/pull/1815", "timeline": [{"oid": "b88dcf60e6e38e0f5eb73e4266b1d2f497c4515f", "url": "https://github.com/fcrepo/fcrepo/commit/b88dcf60e6e38e0f5eb73e4266b1d2f497c4515f", "message": "With this update, We no longer disable triggers in postgresql which was causing a problem database administrator does not have super admin control as is the case on AWS RDS.\n\nResolves: https://jira.lyrasis.org/browse/FCREPO-3540", "committedDate": "2020-11-20T21:19:44Z", "type": "commit"}, {"oid": "b88dcf60e6e38e0f5eb73e4266b1d2f497c4515f", "url": "https://github.com/fcrepo/fcrepo/commit/b88dcf60e6e38e0f5eb73e4266b1d2f497c4515f", "message": "With this update, We no longer disable triggers in postgresql which was causing a problem database administrator does not have super admin control as is the case on AWS RDS.\n\nResolves: https://jira.lyrasis.org/browse/FCREPO-3540", "committedDate": "2020-11-20T21:19:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODA1MTMyNg==", "url": "https://github.com/fcrepo/fcrepo/pull/1815#discussion_r528051326", "bodyText": "Your description says this is now only needed for H2, so could we stop doing this for MySQL and MariaDB too. Maybe repurpose the isPostgres() into isH2()?", "author": "whikloj", "createdAt": "2020-11-21T01:47:18Z", "path": "fcrepo-search-impl/src/main/java/org/fcrepo/search/impl/DbSearchIndexImpl.java", "diffHunk": "@@ -471,11 +472,7 @@ public void reset() {\n     private List<String> toggleForeignKeyChecks(final boolean enable) {\n \n         if (isPostgres()) {\n-            return List.of(\n-                    togglePostgresTriggers(SEARCH_RESOURCE_RDF_TYPE_TABLE, enable),\n-                    togglePostgresTriggers(SEARCH_RDF_TYPE_TABLE, enable),\n-                    togglePostgresTriggers(SIMPLE_SEARCH_TABLE, enable)\n-            );\n+            return EMPTY_LIST;\n         } else {\n             return List.of(\"SET FOREIGN_KEY_CHECKS = \" + (enable ? 1 : 0) + \";\");", "originalCommit": "b88dcf60e6e38e0f5eb73e4266b1d2f497c4515f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg1MDY0Nw==", "url": "https://github.com/fcrepo/fcrepo/pull/1815#discussion_r528850647", "bodyText": "@whikloj :  I was wrong - we need the foreign key enable/disable on mysql, h2, and mariadb after all.", "author": "dbernstein", "createdAt": "2020-11-23T16:50:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODA1MTMyNg=="}], "type": "inlineReview"}]}