{"pr_number": 1809, "pr_title": "More integration tests", "pr_createdAt": "2020-11-18T04:50:50Z", "pr_url": "https://github.com/fcrepo/fcrepo/pull/1809", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5MjYxNQ==", "url": "https://github.com/fcrepo/fcrepo/pull/1809#discussion_r526492615", "bodyText": "Could we keep this request with the change to If-Match?", "author": "awoods", "createdAt": "2020-11-18T23:33:37Z", "path": "fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java", "diffHunk": "@@ -1428,25 +1424,18 @@ public void testBinaryEtags() throws IOException, InterruptedException {\n                 \"INSERT { <> <http://purl.org/dc/elements/1.1/title> 'this is a title' } WHERE {}\"));\n         assertEquals(NO_CONTENT.getStatusCode(), getStatus(httpPatch));\n \n-        // Next, check headers for the binary; they should not have changed\n-        final HttpHead head1 = new HttpHead(location);\n+        // Next, check headers for the binary; they should have changed as binaries and their descriptions are\n+        // versioned together.\n+        final HttpHead head1 = new HttpHead(binaryLocation);\n         try (final CloseableHttpResponse response = execute(head1)) {\n             binaryEtag2 = response.getFirstHeader(\"ETag\").getValue();\n             binaryLastModed2 = response.getFirstHeader(\"Last-Modified\").getValue();\n         }\n \n-        assertEquals(\"ETags should be the same\", binaryEtag1, binaryEtag2);\n-        assertEquals(\"Last-Modified should be the same\", binaryLastModed1, binaryLastModed2);\n-\n-        final HttpGet get6 = new HttpGet(location);\n-        get6.addHeader(\"If-None-Match\", binaryEtag1);", "originalCommit": "1303c8068cbd04c75278a278601dbbcb02fe9066", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5Mjc1Mw==", "url": "https://github.com/fcrepo/fcrepo/pull/1809#discussion_r526492753", "bodyText": "Could we keep this request with the change to If-Unmodified-Since?", "author": "awoods", "createdAt": "2020-11-18T23:33:58Z", "path": "fcrepo-http-api/src/test/java/org/fcrepo/integration/http/api/FedoraLdpIT.java", "diffHunk": "@@ -1428,25 +1424,18 @@ public void testBinaryEtags() throws IOException, InterruptedException {\n                 \"INSERT { <> <http://purl.org/dc/elements/1.1/title> 'this is a title' } WHERE {}\"));\n         assertEquals(NO_CONTENT.getStatusCode(), getStatus(httpPatch));\n \n-        // Next, check headers for the binary; they should not have changed\n-        final HttpHead head1 = new HttpHead(location);\n+        // Next, check headers for the binary; they should have changed as binaries and their descriptions are\n+        // versioned together.\n+        final HttpHead head1 = new HttpHead(binaryLocation);\n         try (final CloseableHttpResponse response = execute(head1)) {\n             binaryEtag2 = response.getFirstHeader(\"ETag\").getValue();\n             binaryLastModed2 = response.getFirstHeader(\"Last-Modified\").getValue();\n         }\n \n-        assertEquals(\"ETags should be the same\", binaryEtag1, binaryEtag2);\n-        assertEquals(\"Last-Modified should be the same\", binaryLastModed1, binaryLastModed2);\n-\n-        final HttpGet get6 = new HttpGet(location);\n-        get6.addHeader(\"If-None-Match\", binaryEtag1);\n-        assertEquals(\"Expected 304 Not Modified\", NOT_MODIFIED.getStatusCode(), getStatus(get6));\n+        assertNotEquals(\"ETags should not be the same\", binaryEtag1, binaryEtag2);\n+        assertNotEquals(\"Last-Modified should not be the same\", binaryLastModed1, binaryLastModed2);\n \n-        final HttpGet get7 = new HttpGet(location);\n-        get7.addHeader(\"If-Modified-Since\", binaryLastModed1);", "originalCommit": "1303c8068cbd04c75278a278601dbbcb02fe9066", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9e25388548f907750b0d1322bf99c777aa840b2f", "url": "https://github.com/fcrepo/fcrepo/commit/9e25388548f907750b0d1322bf99c777aa840b2f", "message": "More tests", "committedDate": "2020-11-19T15:15:34Z", "type": "commit"}, {"oid": "8624aa8c017676433799dd33100f4b4e033909b7", "url": "https://github.com/fcrepo/fcrepo/commit/8624aa8c017676433799dd33100f4b4e033909b7", "message": "Re-add precondition test and alter memento URI comparison", "committedDate": "2020-11-19T16:56:58Z", "type": "commit"}, {"oid": "8624aa8c017676433799dd33100f4b4e033909b7", "url": "https://github.com/fcrepo/fcrepo/commit/8624aa8c017676433799dd33100f4b4e033909b7", "message": "Re-add precondition test and alter memento URI comparison", "committedDate": "2020-11-19T16:56:58Z", "type": "forcePushed"}, {"oid": "54632fb3b19e55d9b7dfb18f2c5bf1d8dcf2afd3", "url": "https://github.com/fcrepo/fcrepo/commit/54632fb3b19e55d9b7dfb18f2c5bf1d8dcf2afd3", "message": "Bad use of substring", "committedDate": "2020-11-19T17:02:50Z", "type": "commit"}]}