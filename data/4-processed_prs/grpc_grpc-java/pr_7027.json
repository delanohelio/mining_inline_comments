{"pr_number": 7027, "pr_title": "grpc-context: add a option to create Context.Key with default name", "pr_createdAt": "2020-05-09T15:18:25Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7027", "timeline": [{"oid": "3b0b9b8dd55897a036e77e59f262d222ead606ef", "url": "https://github.com/grpc/grpc-java/commit/3b0b9b8dd55897a036e77e59f262d222ead606ef", "message": "grpc-context: add a option to create Context.Key with default name", "committedDate": "2020-05-09T14:48:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEyOTI1OQ==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423129259", "bodyText": "A disadvantage of this API is that, by default, debugging issues involving more than Context.Key would become very difficult as they would all have the same name. I think we want to instead encourage the use of different identifiers when creating the keys.", "author": "ericgribkoff", "createdAt": "2020-05-11T15:35:33Z", "path": "context/src/main/java/io/grpc/Context.java", "diffHunk": "@@ -152,6 +152,14 @@ private static Storage createStorage(\n     }\n   }\n \n+  /**\n+   * Create a {@link Key} with {@value io.grpc.Context.Key#DEFAULT_NAME} value as a debug name. Multiple different keys may have the same name;\n+   * the name is intended for debugging purposes and does not impact behavior.", "originalCommit": "3b0b9b8dd55897a036e77e59f262d222ead606ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEzMTMxMw==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423131313", "bodyText": "Rather than adding the parameter-less #key() API above, it might be more helpful to avoid confusion around whether the name of a key \"matters\" (as in #7024) if the Javadoc for Context.Key specifies here as well that Key values will only be compared using by reference equality, which otherwise is only specified on the Context#key creation methods.\n@ejona86 What do you think?", "author": "ericgribkoff", "createdAt": "2020-05-11T15:38:29Z", "path": "context/src/main/java/io/grpc/Context.java", "diffHunk": "@@ -946,9 +954,14 @@ public void close() {\n    * Key for indexing values stored in a context.", "originalCommit": "3b0b9b8dd55897a036e77e59f262d222ead606ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMzMDQ0Ng==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423330446", "bodyText": "We can't really be reviewing code that hasn't had the CLA signed, but I'm fine with adding documentation to Context.Key. I'm not sure it will help much, but it doesn't hurt.\nWhat looks broken is that we are still saying 'name' in Context.key(String name). That should be Context.key(String debugName). Do you think that'd help?", "author": "ejona86", "createdAt": "2020-05-11T21:28:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEzMTMxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMzMDc4MA==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423330780", "bodyText": "Actually, debugString to match Attributes.Key.", "author": "ejona86", "createdAt": "2020-05-11T21:28:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEzMTMxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMzMTUyMA==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423331520", "bodyText": "See also #1764 (comment)", "author": "ejona86", "createdAt": "2020-05-11T21:30:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEzMTMxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg1Nzc2MA==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423857760", "bodyText": "Thank you for fast and helpful your feedback.\nI also think it is more safe and useful to change parameter name of the #key(name) API rather than to add parameter-less Context#key() API.\nI updated my code. I think it will clarify the purpose of the parameter of #key(debugString) API.\nPlease review the new change. Thank you.", "author": "hojongs", "createdAt": "2020-05-12T16:10:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEzMTMxMw=="}], "type": "inlineReview"}, {"oid": "8d53a748bf916aedd4fce957e53598398f66c209", "url": "https://github.com/grpc/grpc-java/commit/8d53a748bf916aedd4fce957e53598398f66c209", "message": "grpc-context: remove parameter-less #key() API", "committedDate": "2020-05-12T15:52:20Z", "type": "commit"}, {"oid": "3e849332c436a6ee45e2e588103dcf4da78bf436", "url": "https://github.com/grpc/grpc-java/commit/3e849332c436a6ee45e2e588103dcf4da78bf436", "message": "grpc-context: change Context#key(name) parameter name more clearly", "committedDate": "2020-05-12T15:58:07Z", "type": "commit"}, {"oid": "9bf78cce18e46967ac98b0eedcf9df16d56bb78d", "url": "https://github.com/grpc/grpc-java/commit/9bf78cce18e46967ac98b0eedcf9df16d56bb78d", "message": "grpc-context: add Nonnull annotation for debugString parameter", "committedDate": "2020-05-12T16:29:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkzNzQ1NQ==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423937455", "bodyText": "Add a line between the description and the @param; we separate the @ stuff from the description with a line to make it more readable.", "author": "ejona86", "createdAt": "2020-05-12T18:15:02Z", "path": "context/src/main/java/io/grpc/Context.java", "diffHunk": "@@ -153,19 +155,21 @@ private static Storage createStorage(\n   }\n \n   /**\n-   * Create a {@link Key} with the given debug name. Multiple different keys may have the same name;\n-   * the name is intended for debugging purposes and does not impact behavior.\n+   * Create a {@link Key} with the given debug name.\n+   * @param debugString a name is intended for debugging purposes and does not impact behavior;", "originalCommit": "9bf78cce18e46967ac98b0eedcf9df16d56bb78d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk3NTIxNA==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423975214", "bodyText": "\"a name intended for debugging\"", "author": "ejona86", "createdAt": "2020-05-12T19:19:47Z", "path": "context/src/main/java/io/grpc/Context.java", "diffHunk": "@@ -153,19 +155,21 @@ private static Storage createStorage(\n   }\n \n   /**\n-   * Create a {@link Key} with the given debug name. Multiple different keys may have the same name;\n-   * the name is intended for debugging purposes and does not impact behavior.\n+   * Create a {@link Key} with the given debug name.\n+   * @param debugString a name is intended for debugging purposes and does not impact behavior;", "originalCommit": "9bf78cce18e46967ac98b0eedcf9df16d56bb78d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk3NTYyNA==", "url": "https://github.com/grpc/grpc-java/pull/7027#discussion_r423975624", "bodyText": "If you use a semicolon, then Multiple should be lower-case. It is probably better to put a period after the first part and have this capitalized.", "author": "ejona86", "createdAt": "2020-05-12T19:20:27Z", "path": "context/src/main/java/io/grpc/Context.java", "diffHunk": "@@ -153,19 +155,21 @@ private static Storage createStorage(\n   }\n \n   /**\n-   * Create a {@link Key} with the given debug name. Multiple different keys may have the same name;\n-   * the name is intended for debugging purposes and does not impact behavior.\n+   * Create a {@link Key} with the given debug name.\n+   * @param debugString a name is intended for debugging purposes and does not impact behavior;\n+   *                    Multiple different keys may have the same debugString.", "originalCommit": "9bf78cce18e46967ac98b0eedcf9df16d56bb78d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6a634e0434157a2eaa252a26860ec2db77ef86e4", "url": "https://github.com/grpc/grpc-java/commit/6a634e0434157a2eaa252a26860ec2db77ef86e4", "message": "grpc-context: fix javadoc of Context#key() API", "committedDate": "2020-05-13T00:14:00Z", "type": "commit"}, {"oid": "16e651e3c777c0901feec727bcd5f3780a6e066e", "url": "https://github.com/grpc/grpc-java/commit/16e651e3c777c0901feec727bcd5f3780a6e066e", "message": "grpc-context: add a documetation about not null", "committedDate": "2020-05-13T00:18:48Z", "type": "commit"}, {"oid": "d9880c17f77660a1a2b22475fe6c5d00214d0322", "url": "https://github.com/grpc/grpc-java/commit/d9880c17f77660a1a2b22475fe6c5d00214d0322", "message": "grpc-context: fix typo in javadoc", "committedDate": "2020-05-13T00:34:19Z", "type": "commit"}]}