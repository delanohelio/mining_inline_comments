{"pr_number": 6829, "pr_title": "android-interop-testing: include android interop testing in main build", "pr_createdAt": "2020-03-13T20:55:39Z", "pr_url": "https://github.com/grpc/grpc-java/pull/6829", "timeline": [{"oid": "fc656b10ebc73b0d45db652ebf944bfb38e373a8", "url": "https://github.com/grpc/grpc-java/commit/fc656b10ebc73b0d45db652ebf944bfb38e373a8", "message": "Include android-interop-testing in main buildscript.", "committedDate": "2020-03-13T20:07:10Z", "type": "commit"}, {"oid": "c94de965a18331e3943ead22799e64d1b95c9247", "url": "https://github.com/grpc/grpc-java/commit/c94de965a18331e3943ead22799e64d1b95c9247", "message": "Flatten android-interop-testing project structure.", "committedDate": "2020-03-13T20:09:55Z", "type": "commit"}, {"oid": "613e6f07276ec0793297bb0e61f02de5ae631042", "url": "https://github.com/grpc/grpc-java/commit/613e6f07276ec0793297bb0e61f02de5ae631042", "message": "Add android application plugin in the main build's configuration.", "committedDate": "2020-03-13T20:47:36Z", "type": "commit"}, {"oid": "3497fa7eca0fd72199c4fc653e49834de332cd7a", "url": "https://github.com/grpc/grpc-java/commit/3497fa7eca0fd72199c4fc653e49834de332cd7a", "message": "Clean up android-interop-testing's buildscript. Temporarily disable code minification due to proguard issue.", "committedDate": "2020-03-13T20:49:08Z", "type": "commit"}, {"oid": "2116297faf3d170bdfbd7e25a6991ffc7bc5fcba", "url": "https://github.com/grpc/grpc-java/commit/2116297faf3d170bdfbd7e25a6991ffc7bc5fcba", "message": "Clean up TODO in README.", "committedDate": "2020-03-13T20:49:38Z", "type": "commit"}, {"oid": "61a3d75c740197d7896df70cf911e6a70dd72070", "url": "https://github.com/grpc/grpc-java/commit/61a3d75c740197d7896df70cf911e6a70dd72070", "message": "Completely exclude apache.http dependencies.", "committedDate": "2020-03-16T09:13:24Z", "type": "commit"}, {"oid": "d5e5855afb043f73ed30ccfae39755467493ab51", "url": "https://github.com/grpc/grpc-java/commit/d5e5855afb043f73ed30ccfae39755467493ab51", "message": "Remove android/cronet/android-interop-testing from RELEASING.md", "committedDate": "2020-03-16T17:47:53Z", "type": "commit"}, {"oid": "c9956a2de57ba080ae50ead5d6b084c3a23f10e6", "url": "https://github.com/grpc/grpc-java/commit/c9956a2de57ba080ae50ead5d6b084c3a23f10e6", "message": "Fix small errorprone issues.", "committedDate": "2020-03-16T18:49:11Z", "type": "commit"}, {"oid": "c9956a2de57ba080ae50ead5d6b084c3a23f10e6", "url": "https://github.com/grpc/grpc-java/commit/c9956a2de57ba080ae50ead5d6b084c3a23f10e6", "message": "Fix small errorprone issues.", "committedDate": "2020-03-16T18:49:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI2MjUzOA==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r393262538", "bodyText": "CURRENT_GRPC_VERSION should be removed from android/build.gradle?", "author": "creamsoup", "createdAt": "2020-03-16T19:27:46Z", "path": "RELEASING.md", "diffHunk": "@@ -32,10 +32,7 @@ them before continuing, and set them again when resuming.\n $ MAJOR=1 MINOR=7 PATCH=0 # Set appropriately for new release\n $ VERSION_FILES=(\n   build.gradle\n-  android/build.gradle", "originalCommit": "c9956a2de57ba080ae50ead5d6b084c3a23f10e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5Mjg1Mg==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r393292852", "bodyText": "Yep. It's already no longer there. I should have removed this in the change for adding grpc-android into main build (same for grpc-cronet), but forgot to do so. So just do the simple cleanup here.", "author": "voidzcy", "createdAt": "2020-03-16T20:31:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI2MjUzOA=="}], "type": "inlineReview"}, {"oid": "f7c160c84c9ce911b045212c9c04c68e530013b2", "url": "https://github.com/grpc/grpc-java/commit/f7c160c84c9ce911b045212c9c04c68e530013b2", "message": "Add checkStyle tasks.", "committedDate": "2020-03-16T21:32:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzg3ODYwMw==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r393878603", "bodyText": "change seems okay. i am wondering if it is a good idea to split this into two sections; android and java.", "author": "creamsoup", "createdAt": "2020-03-17T18:16:03Z", "path": "build.gradle", "diffHunk": "@@ -53,6 +54,7 @@ subprojects {\n         opencensusVersion = '0.24.0'\n \n         configureProtoCompilation = {\n+            boolean isAndroid = project.getName().contains('android')", "originalCommit": "f7c160c84c9ce911b045212c9c04c68e530013b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzg4NzI2OA==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r393887268", "bodyText": "Configurations for android and java are mostly the same except:\n\nAndroid needs the extra \"lite\" option for code generation.\nThe build unit for Java project is sourceSet while for Android is variant.\n\nOther than those, they still shares the same configuration in common. I thought about having android's own configureProtoCompilation block, but it turned out that majority lines are the same as Java's.", "author": "voidzcy", "createdAt": "2020-03-17T18:30:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzg3ODYwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzg5NDI1MQ==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r393894251", "bodyText": "okay. yeah little worried about the build becoming more complicated, but splitting sounds like could be harder to maintain", "author": "creamsoup", "createdAt": "2020-03-17T18:42:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzg3ODYwMw=="}], "type": "inlineReview"}, {"oid": "46b407fab5d7566a0a9a47c0f6aaf8c055c0b415", "url": "https://github.com/grpc/grpc-java/commit/46b407fab5d7566a0a9a47c0f6aaf8c055c0b415", "message": "Supress ProGuard warning for java.nio.ByteBuffer limit(int) when compile against JDK 9+.", "committedDate": "2020-03-18T19:20:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU0OTIxNg==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r394549216", "bodyText": "Why move the comment after a different plugin?", "author": "dapengzhang0", "createdAt": "2020-03-18T18:16:24Z", "path": "build.gradle", "diffHunk": "@@ -1,5 +1,6 @@\n plugins {\n-    id \"com.android.library\" apply false // Necessary for Android plugin to find its classes\n+    id \"com.android.application\" apply false // Necessary for Android plugin to find its classes", "originalCommit": "f7c160c84c9ce911b045212c9c04c68e530013b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY3MTY5OA==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r394671698", "bodyText": "The comment also applies to the application plugin.", "author": "voidzcy", "createdAt": "2020-03-18T22:19:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU0OTIxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NjM4OA==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r394686388", "bodyText": "This will not be needed once #6839 is in.", "author": "dapengzhang0", "createdAt": "2020-03-18T22:58:19Z", "path": "android-interop-testing/proguard-rules.pro", "diffHunk": "@@ -21,3 +21,7 @@\n \n # Ignores: can't find referenced method from grpc-testing's compileOnly dependency on Truth\n -dontwarn io.grpc.testing.DeadlineSubject\n+\n+# Ignores: can't find referenced method for java.nio.ByteBuffer limit(int) due to JDK ABI\n+# incompatibility.\n+-dontwarn java.nio.ByteBuffer", "originalCommit": "46b407fab5d7566a0a9a47c0f6aaf8c055c0b415", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NzAyMw==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r394687023", "bodyText": "Yep", "author": "voidzcy", "createdAt": "2020-03-18T23:00:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NjM4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MzY4OQ==", "url": "https://github.com/grpc/grpc-java/pull/6829#discussion_r394693689", "bodyText": "Reverted.", "author": "voidzcy", "createdAt": "2020-03-18T23:21:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4NjM4OA=="}], "type": "inlineReview"}, {"oid": "ddcbf2bab8353f411445da6f7202683f56d7818b", "url": "https://github.com/grpc/grpc-java/commit/ddcbf2bab8353f411445da6f7202683f56d7818b", "message": "Revert \"Supress ProGuard warning for java.nio.ByteBuffer limit(int) when compile against JDK 9+.\"\n\nThis reverts commit 46b407fab5d7566a0a9a47c0f6aaf8c055c0b415.", "committedDate": "2020-03-18T23:19:43Z", "type": "commit"}, {"oid": "afeb15375dc1e4773587af23560c75032dc12ac5", "url": "https://github.com/grpc/grpc-java/commit/afeb15375dc1e4773587af23560c75032dc12ac5", "message": "Merge branch 'master' of github.com:grpc/grpc-java into build/add_android_interop_testing_into_main_build", "committedDate": "2020-03-18T23:19:56Z", "type": "commit"}]}