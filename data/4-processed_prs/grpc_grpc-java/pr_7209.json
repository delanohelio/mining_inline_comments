{"pr_number": 7209, "pr_title": "xds: support load reporting all clusters option and fix actual report interval measurement", "pr_createdAt": "2020-07-14T19:53:12Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7209", "timeline": [{"oid": "935c057e0195cda57ba247cb48909555f04243ad", "url": "https://github.com/grpc/grpc-java/commit/935c057e0195cda57ba247cb48909555f04243ad", "message": "Support reporting loads for all clusters option. Fix load reporting interval measurement for each individual cluster:eds_service.", "committedDate": "2020-07-14T19:36:11Z", "type": "commit"}, {"oid": "b2e4762f208b8f95554747c1ecac0d4c9eac4770", "url": "https://github.com/grpc/grpc-java/commit/b2e4762f208b8f95554747c1ecac0d4c9eac4770", "message": "Fix tests.", "committedDate": "2020-07-14T19:36:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ0ODAxOA==", "url": "https://github.com/grpc/grpc-java/pull/7209#discussion_r458448018", "bodyText": "Better to pass a StopwatchSupplier in constructor, and create a new stopwatch here, so that it's clear that the stopwatch's lifecycle is solely managed by the LoadStatsEntity.", "author": "dapengzhang0", "createdAt": "2020-07-21T23:33:47Z", "path": "xds/src/main/java/io/grpc/xds/LoadReportClient.java", "diffHunk": "@@ -401,6 +387,28 @@ private void cleanUp() {\n     }\n   }\n \n+  private static final class LoadStatsEntity {\n+    private final LoadStatsStore loadStatsStore;\n+    private final Stopwatch stopwatch;\n+\n+    private LoadStatsEntity(LoadStatsStore loadStatsStore, Stopwatch stopwatch) {\n+      this.loadStatsStore = loadStatsStore;\n+      this.stopwatch = stopwatch;\n+      stopwatch.reset().start();", "originalCommit": "b2e4762f208b8f95554747c1ecac0d4c9eac4770", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ2Mjk3NA==", "url": "https://github.com/grpc/grpc-java/pull/7209#discussion_r458462974", "bodyText": "Updated to take the stopwatch supplier from the LrsClient directly.", "author": "voidzcy", "createdAt": "2020-07-22T00:23:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ0ODAxOA=="}], "type": "inlineReview"}, {"oid": "deb5186e6d4bbcb0d8bd6e8024d1788ce90feea1", "url": "https://github.com/grpc/grpc-java/commit/deb5186e6d4bbcb0d8bd6e8024d1788ce90feea1", "message": "Clearer lifecylce of stopwatch in LoadStatsEntity.", "committedDate": "2020-07-22T00:22:54Z", "type": "commit"}]}