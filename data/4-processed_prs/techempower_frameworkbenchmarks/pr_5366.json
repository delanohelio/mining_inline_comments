{"pr_number": 5366, "pr_title": "Optimize some tests of drogon", "pr_createdAt": "2020-01-04T02:40:21Z", "pr_url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5366", "timeline": [{"oid": "a9f2ff6f71bf2fa977fc728ccbe365164dbd5b78", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/a9f2ff6f71bf2fa977fc728ccbe365164dbd5b78", "message": "Optimize some tests of drogon", "committedDate": "2020-01-04T03:18:22Z", "type": "commit"}, {"oid": "a9f2ff6f71bf2fa977fc728ccbe365164dbd5b78", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/a9f2ff6f71bf2fa977fc728ccbe365164dbd5b78", "message": "Optimize some tests of drogon", "committedDate": "2020-01-04T03:18:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMjIzNg==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5366#discussion_r363402236", "bodyText": "@an-tao Can you clarify what this addition does? Is it reserving space? (We want to make sure there's no prior knowledge of the size of the fortunes array)\nEdit: Someone in-house has pointed out to me it's probably this http://www.cplusplus.com/reference/string/string/reserve/ and about the size of the total fortunes string. Please remove when you have a chance :)\n(Also, if you've seen other frameworks using this you can point them out. Want to make sure everyone is on the same page!)", "author": "nbrady-techempower", "createdAt": "2020-01-06T17:43:12Z", "path": "frameworks/C++/drogon/drogon_benchmark/views/fortune.csp", "diffHunk": "@@ -4,6 +4,7 @@ using namespace drogon_model::hello_world;\n %>\n <%c++\n auto &rows=@@.get<std::vector<Fortune>>(\"rows\");\n+$$.reserve(1300);", "originalCommit": "a9f2ff6f71bf2fa977fc728ccbe365164dbd5b78", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU2MDA1OQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5366#discussion_r363560059", "bodyText": "Thanks for clearifying this, I've removed it.\nHow if I calculate the size of array like follows?\nsize_t size=0;\nfor(auto &row : rows)\n{\n     size += row.getValueOfMessage().length();\n}\n$$.reserve(800 + size);", "author": "an-tao", "createdAt": "2020-01-07T01:42:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMjIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU2MjE4OQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5366#discussion_r363562189", "bodyText": "That looks fine to me though I don\u2019t understand what the 800 is for?", "author": "nbrady-techempower", "createdAt": "2020-01-07T01:52:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMjIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU2MjE5Ng==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5366#discussion_r363562196", "bodyText": "That looks fine to me though I don\u2019t understand what the 800 is for?", "author": "nbrady-techempower", "createdAt": "2020-01-07T01:52:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMjIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU2NTE3OA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5366#discussion_r363565178", "bodyText": "I didn't calculate it carefully, it represents the size of the fixed part of this page, but I don't plan to change it this way now, I think these actually have little effect on the result :) You could merge it now, thanks!", "author": "an-tao", "createdAt": "2020-01-07T02:08:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMjIzNg=="}], "type": "inlineReview"}, {"oid": "feec1eef251c24a47a3a617b306c52213ea72a05", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/feec1eef251c24a47a3a617b306c52213ea72a05", "message": "Modify views of fortune tests", "committedDate": "2020-01-07T01:33:53Z", "type": "commit"}]}