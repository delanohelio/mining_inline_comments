{"pr_number": 5618, "pr_title": "add Simps", "pr_createdAt": "2020-04-20T12:06:28Z", "pr_url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618", "timeline": [{"oid": "10ad4e0011c46928b6a9ef4094afcf2ff2415e1d", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/10ad4e0011c46928b6a9ef4094afcf2ff2415e1d", "message": "add Simps", "committedDate": "2020-04-20T12:03:26Z", "type": "commit"}, {"oid": "45b5bfd5617f90862dd415d2e5419581a18d7c01", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/45b5bfd5617f90862dd415d2e5419581a18d7c01", "message": "update docker", "committedDate": "2020-04-20T12:21:32Z", "type": "commit"}, {"oid": "526107515a3721345b6cadee2d94b2fdfacc1b70", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/526107515a3721345b6cadee2d94b2fdfacc1b70", "message": "update readme", "committedDate": "2020-04-20T12:34:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNDMxOQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411604319", "bodyText": "For me that don't look like a full ORM,\nYou are using the PDO directly and with SQL.\nMicro ORM at most.", "author": "joanhey", "createdAt": "2020-04-20T18:39:30Z", "path": "frameworks/PHP/simps/app/Model/DbModel.php", "diffHunk": "@@ -0,0 +1,97 @@\n+<?php\n+\n+declare(strict_types=1);\n+/**\n+ * This file is part of Simps.\n+ *\n+ * @link     https://simps.io\n+ * @document https://doc.simps.io\n+ * @license  https://github.com/simple-swoole/simps/blob/master/LICENSE\n+ */\n+\n+namespace App\\Model;\n+\n+use Simps\\DB\\BaseModel;\n+\n+class DbModel extends BaseModel\n+{\n+    public function fortunes()\n+    {\n+        $fortune = [];\n+        $this->pdo->fortune_test = $this->pdo->fortune_test ?? $this->pdo->prepare('SELECT id, message FROM Fortune');", "originalCommit": "526107515a3721345b6cadee2d94b2fdfacc1b70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczMjI3MQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411732271", "bodyText": "I used the pdo connection pool and did not use orm. How should it be modified?", "author": "sy-records", "createdAt": "2020-04-20T22:24:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNDMxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczMjkwNg==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411732906", "bodyText": "I want to add a separate ORM pr in the future.", "author": "sy-records", "createdAt": "2020-04-20T22:25:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNDMxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNzU1NA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411607554", "bodyText": "You are sorting an array, not the array of Fortunes objects.\nRead the requiriments:\nhttps://github.com/TechEmpower/FrameworkBenchmarks/wiki/Project-Information-Framework-Tests-Overview#requirements-3\nPlease update the code, or change the benchmark_config to raw db.", "author": "joanhey", "createdAt": "2020-04-20T18:44:38Z", "path": "frameworks/PHP/simps/app/Model/DbModel.php", "diffHunk": "@@ -0,0 +1,97 @@\n+<?php\n+\n+declare(strict_types=1);\n+/**\n+ * This file is part of Simps.\n+ *\n+ * @link     https://simps.io\n+ * @document https://doc.simps.io\n+ * @license  https://github.com/simple-swoole/simps/blob/master/LICENSE\n+ */\n+\n+namespace App\\Model;\n+\n+use Simps\\DB\\BaseModel;\n+\n+class DbModel extends BaseModel\n+{\n+    public function fortunes()\n+    {\n+        $fortune = [];\n+        $this->pdo->fortune_test = $this->pdo->fortune_test ?? $this->pdo->prepare('SELECT id, message FROM Fortune');\n+        $this->pdo->fortune_test->execute();\n+        $arr = $this->pdo->fortune_test->fetchAll();\n+        foreach ($arr as $row) {\n+            $fortune[$row['id']] = $row['message'];\n+        }\n+        $fortune[0] = 'Additional fortune added at request time.';\n+        \\asort($fortune);", "originalCommit": "526107515a3721345b6cadee2d94b2fdfacc1b70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwODQzNA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411608434", "bodyText": "All the db tests should use objects: db, updates and fortunes.", "author": "joanhey", "createdAt": "2020-04-20T18:46:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNzU1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczNzU0MA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411737540", "bodyText": "Does this need to be revised again?", "author": "sy-records", "createdAt": "2020-04-20T22:36:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNzU1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczODM2Mw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411738363", "bodyText": "No, thanks for the changes.\nI liked the code for this fw.", "author": "joanhey", "createdAt": "2020-04-20T22:38:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNzU1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczOTIzMg==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411739232", "bodyText": "Thanks for the review.", "author": "sy-records", "createdAt": "2020-04-20T22:40:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYwNzU1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczNTEzNg==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411735136", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"orm\": \"Full\",\n          \n          \n            \n                    \"orm\": \"Raw\",\n          \n      \n    \n    \n  \n\nIf you aren't using the ORM.", "author": "joanhey", "createdAt": "2020-04-20T22:30:41Z", "path": "frameworks/PHP/simps/benchmark_config.json", "diffHunk": "@@ -0,0 +1,29 @@\n+{\n+  \"framework\": \"simps\",\n+  \"tests\": [\n+    {\n+      \"default\": {\n+        \"json_url\": \"/json\",\n+        \"plaintext_url\": \"/plaintext\",\n+        \"db_url\": \"/db\",\n+        \"fortune_url\": \"/fortunes\",\n+        \"update_url\": \"/updates/\",\n+        \"port\": 8080,\n+        \"approach\": \"Realistic\",\n+        \"classification\": \"Micro\",\n+        \"database\": \"mysql\",\n+        \"framework\": \"Simps\",\n+        \"language\": \"PHP\",\n+        \"flavor\": \"None\",\n+        \"orm\": \"Full\",", "originalCommit": "526107515a3721345b6cadee2d94b2fdfacc1b70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczNjE3MA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r411736170", "bodyText": "ok.", "author": "sy-records", "createdAt": "2020-04-20T22:33:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczNTEzNg=="}], "type": "inlineReview"}, {"oid": "4916e4a1a564cdbe418ea5aa8b689343fb9ded7e", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/4916e4a1a564cdbe418ea5aa8b689343fb9ded7e", "message": "Update frameworks/PHP/simps/benchmark_config.json\n\nCo-Authored-By: Joan Miquel <joanhey@kumbiaphp.com>", "committedDate": "2020-04-20T22:32:55Z", "type": "commit"}, {"oid": "cbcd86f77e9c2b0e17246b7efed30d499b0b0b37", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/cbcd86f77e9c2b0e17246b7efed30d499b0b0b37", "message": "add query_url", "committedDate": "2020-04-21T03:48:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyMzc5OQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5618#discussion_r412523799", "bodyText": "Need to select id here as well.\nOther than that, this is ready to go.", "author": "nbrady-techempower", "createdAt": "2020-04-21T22:05:16Z", "path": "frameworks/PHP/simps/app/Model/DbModel.php", "diffHunk": "@@ -0,0 +1,97 @@\n+<?php\n+\n+declare(strict_types=1);\n+/**\n+ * This file is part of Simps.\n+ *\n+ * @link     https://simps.io\n+ * @document https://doc.simps.io\n+ * @license  https://github.com/simple-swoole/simps/blob/master/LICENSE\n+ */\n+\n+namespace App\\Model;\n+\n+use Simps\\DB\\BaseModel;\n+\n+class DbModel extends BaseModel\n+{\n+    public function fortunes()\n+    {\n+        $fortune = [];\n+        $this->pdo->fortune_test = $this->pdo->fortune_test ?? $this->pdo->prepare('SELECT id, message FROM Fortune');\n+        $this->pdo->fortune_test->execute();\n+        $arr = $this->pdo->fortune_test->fetchAll();\n+        foreach ($arr as $row) {\n+            $fortune[$row['id']] = $row['message'];\n+        }\n+        $fortune[0] = 'Additional fortune added at request time.';\n+        \\asort($fortune);\n+        return $fortune;\n+    }\n+\n+    public function updates(int $queries = 0)\n+    {\n+        $query_count = 1;\n+        if ($queries > 1) {\n+            $query_count = $queries > 500 ? 500 : $queries;\n+        }\n+\n+        $arr = [];\n+        $this->pdo->updates_test_select = $this->pdo->updates_test_select ?? $this->pdo->prepare(\n+                'SELECT randomNumber FROM World WHERE id = ?'", "originalCommit": "cbcd86f77e9c2b0e17246b7efed30d499b0b0b37", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8ef21f4f3f9171cdd7c1212b3e9765beaed0eb7f", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/8ef21f4f3f9171cdd7c1212b3e9765beaed0eb7f", "message": "Update DbModel.php", "committedDate": "2020-04-21T22:11:20Z", "type": "commit"}]}