{"pr_number": 5937, "pr_title": "Update index-micro.php", "pr_createdAt": "2020-08-18T16:49:08Z", "pr_url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937", "timeline": [{"oid": "4a7ac5733ed81374e01923b6e7878c84b884f246", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/4a7ac5733ed81374e01923b6e7878c84b884f246", "message": "Update index-micro.php\n\nAdd root entry point and modify `$url` source for handler.", "committedDate": "2020-08-18T16:48:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2MjMxMQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472362311", "bodyText": "here must return:\nheader(\"Content-Type: text/plain; charset=UTF-8\");\necho \"Hello, World!\";\n\nAnd add the test in benchmark_config.json\nhttps://github.com/TechEmpower/FrameworkBenchmarks/blob/master/frameworks/PHP/phalcon/benchmark_config.json#L49\n\"plaintext_url\": \"/plaintext\",\nNow need to be /palintext the url for that test.", "author": "joanhey", "createdAt": "2020-08-18T17:27:02Z", "path": "frameworks/PHP/phalcon/public/index-micro.php", "diffHunk": "@@ -39,6 +39,11 @@\n \n         return $view;\n     };\n+    \n+    $app->map('/', function() {", "originalCommit": "4a7ac5733ed81374e01923b6e7878c84b884f246", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQwMzI1Mw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472403253", "bodyText": "Add the line:\n\"plaintext_url\": \"/plaintext\",\nin\nhttps://github.com/TechEmpower/FrameworkBenchmarks/blob/master/frameworks/PHP/phalcon/benchmark_config.json#L49", "author": "joanhey", "createdAt": "2020-08-18T18:38:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2MjMxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2MzU3Nw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472363577", "bodyText": "Normally with a realistic approach, It's better to use the Request Class from the framework for that.\nBut it's a micro and perhaps by pass it. I don't know if use it inside for another things.", "author": "joanhey", "createdAt": "2020-08-18T17:29:12Z", "path": "frameworks/PHP/phalcon/public/index-micro.php", "diffHunk": "@@ -96,8 +101,9 @@\n         ));\n \n     });\n-    $request = new Phalcon\\Http\\Request();\n-    $app->handle($request->getURI());\n+    \n+    $url = $_REQUEST['_url'] ?? '/';", "originalCommit": "4a7ac5733ed81374e01923b6e7878c84b884f246", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM5OTQ2Ng==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472399466", "bodyText": "Phalcon\\Http\\Request() works fine, it's only this particular case calling the handler; it's not been used anywhere else on the test, but if it would, it shouldn't be a problem.", "author": "diplopito", "createdAt": "2020-08-18T18:31:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2MzU3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQwNTM5Nw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472405397", "bodyText": "Normally all frameworks in this bench use a realistic approach, and try to avoid an striped version.", "author": "joanhey", "createdAt": "2020-08-18T18:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2MzU3Nw=="}], "type": "inlineReview"}, {"oid": "3bed1bc841dc3a8922adf295f0f8ec54b56c5cfb", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/3bed1bc841dc3a8922adf295f0f8ec54b56c5cfb", "message": "Update index-micro.php\n\nModify response and text after comment.", "committedDate": "2020-08-18T18:24:35Z", "type": "commit"}, {"oid": "0b558eaecbd227e27d420bd564a87249fa7b7339", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/0b558eaecbd227e27d420bd564a87249fa7b7339", "message": "Update index-micro.php\n\nModify entrypoint for `/plaintext`", "committedDate": "2020-08-18T18:27:24Z", "type": "commit"}, {"oid": "a47640e2e68e956247f3d7bce2c61455546211e2", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/a47640e2e68e956247f3d7bce2c61455546211e2", "message": "Update index-micro.php\n\nUpdate connection settings", "committedDate": "2020-08-18T18:39:08Z", "type": "commit"}, {"oid": "17df5bb3f535a95a718377af568e3d6c9735a80e", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/17df5bb3f535a95a718377af568e3d6c9735a80e", "message": "Update index-micro.php\n\nAdd PDO options to connection settings", "committedDate": "2020-08-18T18:48:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxMDk4OA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472410988", "bodyText": "Perhaps now will work the persistent db connection.\nBut the manual have a bug if it's working now.", "author": "joanhey", "createdAt": "2020-08-18T18:53:09Z", "path": "frameworks/PHP/phalcon/public/index-micro.php", "diffHunk": "@@ -9,11 +9,13 @@\n \n         return new \\Phalcon\\Db\\Adapter\\Pdo\\Mysql(array(\n             'host'       => 'tfb-database',\n-            'dbname'       =>  'hello_world',\n-            'charset'    =>  'utf8',\n+            'dbname'     =>  'hello_world',\n             'username'   => 'benchmarkdbuser',\n             'password'   => 'benchmarkdbpass',\n-            'persistent' => true\n+            'options'    => [", "originalCommit": "17df5bb3f535a95a718377af568e3d6c9735a80e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxMTk2MA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472411960", "bodyText": "Could be, docs are still being updated for v4.", "author": "diplopito", "createdAt": "2020-08-18T18:54:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxMDk4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU3OTI5OA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472579298", "bodyText": "$app->handle($_SERVER['REQUEST_URI']);\nseems simpler", "author": "jcheron", "createdAt": "2020-08-19T01:17:12Z", "path": "frameworks/PHP/phalcon/public/index-micro.php", "diffHunk": "@@ -96,8 +105,9 @@\n         ));\n \n     });\n-    $request = new Phalcon\\Http\\Request();\n-    $app->handle($request->getURI());\n+    \n+    $url = $_REQUEST['_url'] ?? '/';\n+    $app->handle($url);", "originalCommit": "17df5bb3f535a95a718377af568e3d6c9735a80e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAxMjA4Nw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r473012087", "bodyText": "It is, except that it only works when the app is running from root; from a subdirectory, the suggested change has to be made (which works for both, but trivial for the tests).", "author": "diplopito", "createdAt": "2020-08-19T13:03:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU3OTI5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU4MDI3NQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5937#discussion_r472580275", "bodyText": "The charset can be defined directly\n'charset'=>'utf8'", "author": "jcheron", "createdAt": "2020-08-19T01:20:44Z", "path": "frameworks/PHP/phalcon/public/index-micro.php", "diffHunk": "@@ -8,10 +8,14 @@\n     $app['db'] = function() {\n \n         return new \\Phalcon\\Db\\Adapter\\Pdo\\Mysql(array(\n-            'dsn'       => 'host=tfb-database;dbname=hello_world;charset=utf8',\n+            'host'       => 'tfb-database',\n+            'dbname'     =>  'hello_world',\n             'username'   => 'benchmarkdbuser',\n             'password'   => 'benchmarkdbpass',\n-            'persistent' => true\n+            'options'    => [", "originalCommit": "17df5bb3f535a95a718377af568e3d6c9735a80e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}