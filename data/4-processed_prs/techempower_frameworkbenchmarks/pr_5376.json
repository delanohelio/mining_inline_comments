{"pr_number": 5376, "pr_title": "Added concurrent queries & test for Crystal/kemal", "pr_createdAt": "2020-01-07T07:22:03Z", "pr_url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5376", "timeline": [{"oid": "c70bf043409753147ed99e6cea8b2b4aa9ecad7d", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/c70bf043409753147ed99e6cea8b2b4aa9ecad7d", "message": "Added concurrent query impl", "committedDate": "2020-01-07T07:14:50Z", "type": "commit"}, {"oid": "a8b95f3abc9d12c954a2e79e78201831935cc536", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/a8b95f3abc9d12c954a2e79e78201831935cc536", "message": "Create kemal-concurrent-queries.dockerfile", "committedDate": "2020-01-07T07:18:42Z", "type": "commit"}, {"oid": "d153e6f3089d36b613291b46debe684b9435df99", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/d153e6f3089d36b613291b46debe684b9435df99", "message": "Added concurrent-queries test", "committedDate": "2020-01-07T07:20:47Z", "type": "commit"}, {"oid": "96ba718b2f64ffb01139a585f86c56c17b686131", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/96ba718b2f64ffb01139a585f86c56c17b686131", "message": "Updated concurrency to 2", "committedDate": "2020-01-07T07:29:02Z", "type": "commit"}, {"oid": "ac8dabf2393290e21c440cb3bcac4ad190d08fb3", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/ac8dabf2393290e21c440cb3bcac4ad190d08fb3", "message": "Updated pool size", "committedDate": "2020-01-07T07:30:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYyMzAyOA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5376#discussion_r363623028", "bodyText": "Time.now is deprecated in favor of Time.utc", "author": "snluu", "createdAt": "2020-01-07T07:40:36Z", "path": "frameworks/Crystal/kemal/server-postgres.cr", "diffHunk": "@@ -37,14 +38,19 @@ private def fortunes\n end\n \n private def sanitized_query_count(request)\n-  queries = request.params.query[\"queries\"].as(String)\n+  queries = request.params.query[\"queries\"]? || \"1\"\n   queries = queries.to_i? || 1\n   queries.clamp(1..500)\n end\n \n+private def sanitized_concurrency(request)\n+  concurrency = request.params.query[\"concurrency\"]? || \"1\"\n+  concurrency.to_i? || 1\n+end\n+\n before_all do |env|\n   env.response.headers[\"Server\"] = \"Kemal\"\n-  env.response.headers[\"Date\"] = HTTP.format_time(Time.now)\n+  env.response.headers[\"Date\"] = HTTP.format_time(Time.utc)", "originalCommit": "ac8dabf2393290e21c440cb3bcac4ad190d08fb3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}