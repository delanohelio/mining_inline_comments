{"pr_number": 5420, "pr_title": "Update V deps", "pr_createdAt": "2020-01-21T04:17:04Z", "pr_url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420", "timeline": [{"oid": "9bfd1eaf7473b92b66c03b873495423a5c694d3b", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/9bfd1eaf7473b92b66c03b873495423a5c694d3b", "message": "update v deps", "committedDate": "2020-01-21T03:37:21Z", "type": "commit"}, {"oid": "6f7f8376f2914a7dc8e97e29dd7a2841bed196f0", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/6f7f8376f2914a7dc8e97e29dd7a2841bed196f0", "message": "use tag instead of branch", "committedDate": "2020-01-21T16:06:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNDEyMw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420#discussion_r369104123", "bodyText": "We prefer official bases so we can see in the dockerfile here all the steps taken to get your framework built and running. Also, it helps with the docker cache and testing speed in our main environment.", "author": "nbrady-techempower", "createdAt": "2020-01-21T16:25:05Z", "path": "frameworks/V/pico.v/pico.v.dockerfile", "diffHunk": "@@ -1,15 +1,13 @@\n-FROM debian:sid\n+FROM syou/v-dev:0.1", "originalCommit": "6f7f8376f2914a7dc8e97e29dd7a2841bed196f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNzQ3MA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420#discussion_r369107470", "bodyText": "@nbrady-techempower , Framework is built under that in pico.v.dockerfile, docker image is the compiling V language itself with some commits picked from master.\nRegarding cache, it only took 10s, as you can see in travis log, I believe apt-get and compiling is much longer than that.", "author": "S-YOU", "createdAt": "2020-01-21T16:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNDEyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTExNDAzNg==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420#discussion_r369114036", "bodyText": "But just let me know if you insist @nbrady-techempower . I could just go ahead and copy paste parent docker commands.\nOne thing I am aware is V is self compiled, and it pull latest generated C code dynamically to self compile, So, I am not sure new compiler can compile old V every time. Fixed docker tag is much reliable IMO.", "author": "S-YOU", "createdAt": "2020-01-21T16:41:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNDEyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEyMTU2NA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420#discussion_r369121564", "bodyText": "This is ok for now, then. If part of updating the framework means you'll be updating this base, when you do that, can you please copy and paste the commands in a comment here for quick review. We want to make sure that it's not always pulling the latest commit, etc. There's just some things we need to audit.", "author": "nbrady-techempower", "createdAt": "2020-01-21T16:53:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNDEyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEyNDgxMw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420#discussion_r369124813", "bodyText": "@nbrady-techempower, here is the base docker file on docker hub - https://hub.docker.com/r/syou/v-dev/dockerfile\nand it is tagged as 0.1 (not latest), so there is no addition pull once it is in cache, I think - https://hub.docker.com/r/syou/v-dev/tags\n\nIf part of updating the framework means you'll be updating this base\n\nFramework is not in the base image, it is just V language itself in base (but with upcoming V release with some cherry picks).\nTo be clear\n\nwhen there is V language update is needed, docker base will be like 0.2 or something like that.\nwhen there is framework update, line 7 or 8 or 9 in pico.v.dockerfile will be updated to specific tag.\nlike, git checkout v0.0.4 -> git checkout v0.0.5\n\nAll of those changes will require a PR here. That's the point, am I correct?", "author": "S-YOU", "createdAt": "2020-01-21T16:59:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNDEyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEzNzMxOQ==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5420#discussion_r369137319", "bodyText": "when there is framework update, line 7 or 8 or 9 in pico.v.dockerfile will be updated to specific tag. like, git checkout v0.0.4 -> git checkout v0.0.5\n\nYes, this is my point. We want to make sure that the base you're pulling from isn't pulling the latest from master inside the docker container; we clear the docker cache every few runs. When I talk about the docker cache, I mean it in the context of a single run, such that a lot of frameworks share the same base like buildpack-deps:xenial and the first few lines are often the same, like apt updating.", "author": "nbrady-techempower", "createdAt": "2020-01-21T17:22:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEwNDEyMw=="}], "type": "inlineReview"}]}