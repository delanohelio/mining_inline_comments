{"pr_number": 6066, "pr_title": "Add Morph OCaml framework", "pr_createdAt": "2020-10-10T20:52:31Z", "pr_url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/6066", "timeline": [{"oid": "0f2253fcf43a507f86da886d519e6ca060ac0e4a", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/0f2253fcf43a507f86da886d519e6ca060ac0e4a", "message": "Add Morph OCaml framework", "committedDate": "2020-10-10T20:54:22Z", "type": "forcePushed"}, {"oid": "a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "message": "Add Morph OCaml framework", "committedDate": "2020-10-10T20:55:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk0ODgzMA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/6066#discussion_r503948830", "bodyText": "hey @ulrikstrid explicitly listing the testdir does not seem to be necessary - for example \n  \n    \n      FrameworkBenchmarks/.travis.yml\n    \n    \n        Lines 15 to 16\n      in\n      30bb2a4\n    \n    \n    \n    \n\n        \n          \n           - \"TESTLANG=C\" \n        \n\n        \n          \n           - \"TESTLANG=CSharp\" \n        \n    \n  \n\n\n(my PR for opium was also merged yesterday, so the list is not full)", "author": "mudrz", "createdAt": "2020-10-13T13:25:13Z", "path": ".travis.yml", "diffHunk": "@@ -65,6 +65,8 @@ env:\n     - \"TESTLANG=Nim\"\n     - 'TESTDIR=\"Nim/httpbeast Nim/jester Nim/basolato\"'\n     - \"TESTLANG=OCaml\"\n+    - \"TESTDIR=OCaml/morph\"", "originalCommit": "a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk0OTgwMw==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/6066#discussion_r503949803", "bodyText": "is this esy build intended?", "author": "mudrz", "createdAt": "2020-10-13T13:26:34Z", "path": "frameworks/OCaml/morph/morph.dockerfile", "diffHunk": "@@ -0,0 +1,35 @@\n+FROM alpine:latest as certs\n+RUN apk --update add ca-certificates\n+\n+FROM reasonnative/web:4.10.0 as builder\n+\n+RUN mkdir /app\n+WORKDIR /app\n+\n+COPY src/esy.json src/morph-tfb.opam /app/\n+\n+RUN esy install\n+RUN esy build --release", "originalCommit": "a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk0OTk3MA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/6066#discussion_r503949970", "bodyText": "is the second esy install intended?", "author": "mudrz", "createdAt": "2020-10-13T13:26:48Z", "path": "frameworks/OCaml/morph/morph.dockerfile", "diffHunk": "@@ -0,0 +1,35 @@\n+FROM alpine:latest as certs\n+RUN apk --update add ca-certificates\n+\n+FROM reasonnative/web:4.10.0 as builder\n+\n+RUN mkdir /app\n+WORKDIR /app\n+\n+COPY src/esy.json src/morph-tfb.opam /app/\n+\n+RUN esy install\n+RUN esy build --release\n+\n+COPY ./src/bin /app/src/bin\n+\n+RUN esy install", "originalCommit": "a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk1MTE0Mg==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/6066#discussion_r503951142", "bodyText": "are these certs automatically used by morph?", "author": "mudrz", "createdAt": "2020-10-13T13:28:16Z", "path": "frameworks/OCaml/morph/morph.dockerfile", "diffHunk": "@@ -0,0 +1,35 @@\n+FROM alpine:latest as certs\n+RUN apk --update add ca-certificates\n+\n+FROM reasonnative/web:4.10.0 as builder\n+\n+RUN mkdir /app\n+WORKDIR /app\n+\n+COPY src/esy.json src/morph-tfb.opam /app/\n+\n+RUN esy install\n+RUN esy build --release\n+\n+COPY ./src/bin /app/src/bin\n+\n+RUN esy install\n+\n+RUN esy dune build --profile=docker --release\n+\n+RUN esy mv \"#{self.target_dir / 'default' / 'bin' / 'tfb.exe'}\" main.exe\n+\n+RUN strip main.exe\n+\n+FROM scratch as runtime\n+\n+ENV OPENSSL_STATIC=1\n+ENV SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt\n+ENV SSL_CERT_DIR=/etc/ssl/certs\n+COPY --from=certs /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/", "originalCommit": "a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk1MzU4NA==", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/6066#discussion_r503953584", "bodyText": "I added a .gitignore to /OCaml: \n  \n    \n      FrameworkBenchmarks/frameworks/OCaml/.gitignore\n    \n    \n        Lines 1 to 4\n      in\n      30bb2a4\n    \n    \n    \n    \n\n        \n          \n           **/_opam \n        \n\n        \n          \n           **/_build \n        \n\n        \n          \n           .merlin \n        \n\n        \n          \n           .ocamlformat \n        \n    \n  \n\n\nthese ignores seems to be very common for OCaml and esy, should they be at that level for convenience for others?", "author": "mudrz", "createdAt": "2020-10-13T13:31:28Z", "path": "frameworks/OCaml/morph/src/.gitignore", "diffHunk": "@@ -0,0 +1,4 @@\n+_esy\n+*.install\n+.merlin\n+!bin/", "originalCommit": "a2140585972fe3c2f4cf4d11481a2a6c1f70f67f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b6908abd0128615fcb91df3be3e7283caf642333", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/b6908abd0128615fcb91df3be3e7283caf642333", "message": "Add Morph OCaml framework", "committedDate": "2020-10-14T11:41:53Z", "type": "commit"}, {"oid": "48b154d7d09855d58cd4ddd8e126c0ebbf05d968", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/48b154d7d09855d58cd4ddd8e126c0ebbf05d968", "message": "Fix running tests", "committedDate": "2020-10-14T11:41:53Z", "type": "commit"}, {"oid": "48b154d7d09855d58cd4ddd8e126c0ebbf05d968", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/48b154d7d09855d58cd4ddd8e126c0ebbf05d968", "message": "Fix running tests", "committedDate": "2020-10-14T11:41:53Z", "type": "forcePushed"}, {"oid": "b44131d4b246fd997f002623d05805f0a4a76cab", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/b44131d4b246fd997f002623d05805f0a4a76cab", "message": "Update meta files", "committedDate": "2020-10-14T11:44:48Z", "type": "commit"}, {"oid": "dc4148b0efd564f1bcd3b17ed28cc04fc5aa081e", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/dc4148b0efd564f1bcd3b17ed28cc04fc5aa081e", "message": "Simplify dockerfile", "committedDate": "2020-10-14T11:57:03Z", "type": "commit"}, {"oid": "098d1b89a85ba95efdaa377486ccac3296fbe8a0", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/098d1b89a85ba95efdaa377486ccac3296fbe8a0", "message": "Minor refactor", "committedDate": "2020-10-16T07:40:30Z", "type": "commit"}, {"oid": "2053e18b9d6258fa8a6965f569d6a48e45376510", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/2053e18b9d6258fa8a6965f569d6a48e45376510", "message": "Fix copy of esy.lock", "committedDate": "2020-10-16T08:55:39Z", "type": "commit"}, {"oid": "82996219984ee483d6e6be7fe10f1e357a7b723f", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/82996219984ee483d6e6be7fe10f1e357a7b723f", "message": "Add static option", "committedDate": "2020-10-16T11:47:06Z", "type": "commit"}, {"oid": "6f6cebf082cb07ed5cc8fdc34b4b4a868e092403", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/6f6cebf082cb07ed5cc8fdc34b4b4a868e092403", "message": "Make sure libev is used", "committedDate": "2020-10-16T19:37:32Z", "type": "commit"}]}