{"pr_number": 8268, "pr_title": "DOCS-3625: Add section to config topic: parameters controlled by Kafka Streams", "pr_createdAt": "2020-03-10T23:30:32Z", "pr_url": "https://github.com/apache/kafka/pull/8268", "timeline": [{"oid": "bd3eedfdde3aab83ad64b93bc936ac78fee9bc93", "url": "https://github.com/apache/kafka/commit/bd3eedfdde3aab83ad64b93bc936ac78fee9bc93", "message": "DOCS-3625: Add section to config topic: parameters controlled by KStreams", "committedDate": "2020-03-10T23:27:19Z", "type": "commit"}, {"oid": "b43ab072f400f0d74a12b043d65536e9eeba6969", "url": "https://github.com/apache/kafka/commit/b43ab072f400f0d74a12b043d65536e9eeba6969", "message": "Add auto.create.topics.enable to parameters controlled by KStreams table", "committedDate": "2020-03-10T23:42:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MDYyMA==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397290620", "bodyText": "Not sure what are balanced but may be unevenly distributed across consumers means?", "author": "mjsax", "createdAt": "2020-03-24T16:28:32Z", "path": "docs/streams/architecture.html", "diffHunk": "@@ -80,6 +80,10 @@ <h3><a id=\"streams_architecture_tasks\" href=\"#streams_architecture_tasks\">Stream\n         tasks will be automatically restarted on other instances and continue to consume from the same stream partitions.\n     </p>\n \n+    <p><b>NOTE:</b> Topic partitions are balanced but may be unevenly distributed across consumers. Kafka Streams uses the", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxOTgyMA==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397319820", "bodyText": "I'm not sure either! :) It's what we ended up with in confluentinc/docs#3604.", "author": "JimGalasyn", "createdAt": "2020-03-24T17:07:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MDYyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5Mzk3Mw==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397993973", "bodyText": "@JimGalasyn Can we update this to (also in CP docs):\nTopic partitions are assigned to tasks, and tasks are assigned to all threads over all instances in an best-effort manner try to trade-off load-balancing and stickiness of stateful tasks. For this assignment, Kafka Streams uses ...", "author": "mjsax", "createdAt": "2020-03-25T16:28:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MDYyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAzNjc4OQ==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r398036789", "bodyText": "Much better, thanks!", "author": "JimGalasyn", "createdAt": "2020-03-25T17:26:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MDYyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MTk2Nw==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397291967", "bodyText": "Just a question: what is the row-even vs row-odd tag? Seems we don't use is consistently (there are multiple row-even tags in a row above) and it does also not seem to make any difference how the rows are rendered? Why do we even have this tag?", "author": "mjsax", "createdAt": "2020-03-24T16:30:18Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -269,6 +269,11 @@ <h4><a class=\"toc-backref\" href=\"#id5\">bootstrap.servers</a><a class=\"headerlink\n               <td colspan=\"2\">The amount of time in milliseconds, before a request is retried. This applies if the <code class=\"docutils literal\"><span class=\"pre\">retries</span></code> parameter is configured to be greater than 0. </td>\n               <td>100</td>\n           </tr>\n+          <tr class=\"row-even\"><td>rocksdb.config.setter</td>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMyMDE1Ng==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397320156", "bodyText": "Good question, I added it just to keep the style consistent.", "author": "JimGalasyn", "createdAt": "2020-03-24T17:08:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MTk2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5Mjk1Mw==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397292953", "bodyText": "implement -> you can implement ?", "author": "mjsax", "createdAt": "2020-03-24T16:31:32Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -474,6 +479,57 @@ <h4><a class=\"toc-backref\" href=\"#id11\">num.stream.threads</a><a class=\"headerli\n               </dl>\n             </div></blockquote>\n         </div>\n+        <div class=\"section\" id=\"rocksdb-config-setter\">\n+          <span id=\"streams-developer-guide-rocksdb-config\"></span><h4><a class=\"toc-backref\" href=\"#id20\">rocksdb.config.setter</a><a class=\"headerlink\" href=\"#rocksdb-config-setter\" title=\"Permalink to this headline\"></a></h4>\n+          <blockquote>\n+            <div><p>The RocksDB configuration. Kafka Streams uses RocksDB as the default storage engine for persistent stores. To change the default\n+              configuration for RocksDB, implement <code class=\"docutils literal\"><span class=\"pre\">RocksDBConfigSetter</span></code> and provide your custom class via <a class=\"reference external\" href=\"/{{version}}/javadoc/org/apache/kafka/streams/state/RocksDBConfigSetter.html\">rocksdb.config.setter</a>.</p>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5MzQ4Mw==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397293483", "bodyText": "can be closed -> should be closed (or must be closed) ?", "author": "mjsax", "createdAt": "2020-03-24T16:32:17Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -474,6 +479,57 @@ <h4><a class=\"toc-backref\" href=\"#id11\">num.stream.threads</a><a class=\"headerli\n               </dl>\n             </div></blockquote>\n         </div>\n+        <div class=\"section\" id=\"rocksdb-config-setter\">\n+          <span id=\"streams-developer-guide-rocksdb-config\"></span><h4><a class=\"toc-backref\" href=\"#id20\">rocksdb.config.setter</a><a class=\"headerlink\" href=\"#rocksdb-config-setter\" title=\"Permalink to this headline\"></a></h4>\n+          <blockquote>\n+            <div><p>The RocksDB configuration. Kafka Streams uses RocksDB as the default storage engine for persistent stores. To change the default\n+              configuration for RocksDB, implement <code class=\"docutils literal\"><span class=\"pre\">RocksDBConfigSetter</span></code> and provide your custom class via <a class=\"reference external\" href=\"/{{version}}/javadoc/org/apache/kafka/streams/state/RocksDBConfigSetter.html\">rocksdb.config.setter</a>.</p>\n+              <p>Here is an example that adjusts the memory size consumed by RocksDB.</p>\n+              <div class=\"highlight-java\"><div class=\"highlight\"><pre><span></span>    <span class=\"kd\">public</span> <span class=\"kd\">static</span> <span class=\"kd\">class</span> <span class=\"nc\">CustomRocksDBConfig</span> <span class=\"kd\">implements</span> <span class=\"n\">RocksDBConfigSetter</span> <span class=\"o\">{</span>\n+                    <span class=\"c1\">// This object should be a member variable so it can be closed in RocksDBConfigSetter#close.</span>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5NDAyMQ==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397294021", "bodyText": "I cannot really read this part with all the markup... :( I trust you that it's fine :)", "author": "mjsax", "createdAt": "2020-03-24T16:33:01Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -474,6 +479,57 @@ <h4><a class=\"toc-backref\" href=\"#id11\">num.stream.threads</a><a class=\"headerli\n               </dl>\n             </div></blockquote>\n         </div>\n+        <div class=\"section\" id=\"rocksdb-config-setter\">\n+          <span id=\"streams-developer-guide-rocksdb-config\"></span><h4><a class=\"toc-backref\" href=\"#id20\">rocksdb.config.setter</a><a class=\"headerlink\" href=\"#rocksdb-config-setter\" title=\"Permalink to this headline\"></a></h4>\n+          <blockquote>\n+            <div><p>The RocksDB configuration. Kafka Streams uses RocksDB as the default storage engine for persistent stores. To change the default\n+              configuration for RocksDB, implement <code class=\"docutils literal\"><span class=\"pre\">RocksDBConfigSetter</span></code> and provide your custom class via <a class=\"reference external\" href=\"/{{version}}/javadoc/org/apache/kafka/streams/state/RocksDBConfigSetter.html\">rocksdb.config.setter</a>.</p>\n+              <p>Here is an example that adjusts the memory size consumed by RocksDB.</p>\n+              <div class=\"highlight-java\"><div class=\"highlight\"><pre><span></span>    <span class=\"kd\">public</span> <span class=\"kd\">static</span> <span class=\"kd\">class</span> <span class=\"nc\">CustomRocksDBConfig</span> <span class=\"kd\">implements</span> <span class=\"n\">RocksDBConfigSetter</span> <span class=\"o\">{</span>\n+                    <span class=\"c1\">// This object should be a member variable so it can be closed in RocksDBConfigSetter#close.</span>\n+                    <span class=\"kd\">private</span> <span class=\"n\">org.rocksdb.Cache</span> <span class=\"n\">cache</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"n\">org</span><span class=\"o\">.</span><span class=\"na\">rocksdb</span><span class=\"o\">.</span><span class=\"na\">LRUCache</span><span class=\"o\">(</span><span class=\"mi\">16</span> <span class=\"o\">*</span> <span class=\"mi\">1024L</span> <span class=\"o\">*</span> <span class=\"mi\">1024L</span><span class=\"o\">);</span>\n+\n+                    <span class=\"nd\">@Override</span>\n+                    <span class=\"kd\">public</span> <span class=\"kt\">void</span> <span class=\"nf\">setConfig</span><span class=\"o\">(</span><span class=\"kd\">final</span> <span class=\"n\">String</span> <span class=\"n\">storeName</span><span class=\"o\">,</span> <span class=\"kd\">final</span> <span class=\"n\">Options</span> <span class=\"n\">options</span><span class=\"o\">,</span> <span class=\"kd\">final</span> <span class=\"n\">Map</span><span class=\"o\">&lt;</span><span class=\"n\">String</span><span class=\"o\">,</span> <span class=\"n\">Object</span><span class=\"o\">&gt;</span> <span class=\"n\">configs</span><span class=\"o\">)</span> <span class=\"o\">{</span>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5NDg5NA==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397294894", "bodyText": "Required ? I thought those are the one a user cannot set?", "author": "mjsax", "createdAt": "2020-03-24T16:34:09Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -684,70 +728,64 @@ <h4><a class=\"toc-backref\" href=\"#id18\">Default Values</a><a class=\"headerlink\"\n               <td>Consumer</td>\n               <td>1000</td>\n             </tr>\n-            <tr class=\"row-odd\"><td>rocksdb.config.setter</td>\n-              <td>Consumer</td>\n-              <td>&nbsp;</td>\n-            </tr>\n             </tbody>\n           </table>\n         </div>\n+        <div class=\"section\" id=\"parameters-controlled-by-kafka-streams\">\n+          <h3><a class=\"toc-backref\" href=\"#id26\">Required configuration parameters</a><a class=\"headerlink\" href=\"#parameters-controlled-by-kafka-streams\" title=\"Permalink to this headline\"></a></h3>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMyOTU1MA==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397329550", "bodyText": "D'oh! The perils of copy-paste.", "author": "JimGalasyn", "createdAt": "2020-03-24T17:21:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5NDg5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5NjUzMw==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397296533", "bodyText": "Users can overwrite auto.offset.reset -- it's just a different default that for the plain KafkaConsumer -- same for the following 4 configs.", "author": "mjsax", "createdAt": "2020-03-24T16:36:19Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -684,70 +728,64 @@ <h4><a class=\"toc-backref\" href=\"#id18\">Default Values</a><a class=\"headerlink\"\n               <td>Consumer</td>\n               <td>1000</td>\n             </tr>\n-            <tr class=\"row-odd\"><td>rocksdb.config.setter</td>\n-              <td>Consumer</td>\n-              <td>&nbsp;</td>\n-            </tr>\n             </tbody>\n           </table>\n         </div>\n+        <div class=\"section\" id=\"parameters-controlled-by-kafka-streams\">\n+          <h3><a class=\"toc-backref\" href=\"#id26\">Required configuration parameters</a><a class=\"headerlink\" href=\"#parameters-controlled-by-kafka-streams\" title=\"Permalink to this headline\"></a></h3>\n+          <p>Kafka Streams assigns the following configuration parameters. If you try to change\n+            these settings, your values are ignored and setting them has no effect in a\n+            Kafka Streams application.\n+          <p>Kafka Streams uses the <code class=\"docutils literal\"><span class=\"pre\">client.id</span></code>\n+            parameter to compute derived client IDs for internal clients. If you don't set\n+            <code class=\"docutils literal\"><span class=\"pre\">client.id</span></code>, Kafka Streams sets it to\n+            <code class=\"docutils literal\"><span class=\"pre\">&lt;application.id&gt;-&lt;random-UUID&gt;</span></code>.\n+            <table border=\"1\" class=\"non-scrolling-table docutils\">\n+              <colgroup>\n+              <col width=\"50%\">\n+              <col width=\"19%\">\n+              <col width=\"31%\">\n+              </colgroup>\n+              <thead valign=\"bottom\">\n+              <tr class=\"row-odd\"><th class=\"head\">Parameter Name</th>\n+              <th class=\"head\">Corresponding Client</th>\n+              <th class=\"head\">Streams Default</th>\n+              </tr>\n+              </thead>\n+              <tbody valign=\"top\">\n+              <tr class=\"row-even\"><td>auto.create.topics.enable</td>\n+              <td>Consumer</td>\n+              <td>false</td>\n+              </tr>\n+              <tr class=\"row-even\"><td>auto.offset.reset</td>\n+              <td>Consumer</td>\n+              <td>earliest</td>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM1NTg5MQ==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397355891", "bodyText": "I reworked this a bit, is it accurate?", "author": "JimGalasyn", "createdAt": "2020-03-24T18:00:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5NjUzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI5OTU2Mg==", "url": "https://github.com/apache/kafka/pull/8268#discussion_r397299562", "bodyText": "The config name is allow.auto.create.topics", "author": "mjsax", "createdAt": "2020-03-24T16:40:20Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -684,70 +728,64 @@ <h4><a class=\"toc-backref\" href=\"#id18\">Default Values</a><a class=\"headerlink\"\n               <td>Consumer</td>\n               <td>1000</td>\n             </tr>\n-            <tr class=\"row-odd\"><td>rocksdb.config.setter</td>\n-              <td>Consumer</td>\n-              <td>&nbsp;</td>\n-            </tr>\n             </tbody>\n           </table>\n         </div>\n+        <div class=\"section\" id=\"parameters-controlled-by-kafka-streams\">\n+          <h3><a class=\"toc-backref\" href=\"#id26\">Required configuration parameters</a><a class=\"headerlink\" href=\"#parameters-controlled-by-kafka-streams\" title=\"Permalink to this headline\"></a></h3>\n+          <p>Kafka Streams assigns the following configuration parameters. If you try to change\n+            these settings, your values are ignored and setting them has no effect in a\n+            Kafka Streams application.\n+          <p>Kafka Streams uses the <code class=\"docutils literal\"><span class=\"pre\">client.id</span></code>\n+            parameter to compute derived client IDs for internal clients. If you don't set\n+            <code class=\"docutils literal\"><span class=\"pre\">client.id</span></code>, Kafka Streams sets it to\n+            <code class=\"docutils literal\"><span class=\"pre\">&lt;application.id&gt;-&lt;random-UUID&gt;</span></code>.\n+            <table border=\"1\" class=\"non-scrolling-table docutils\">\n+              <colgroup>\n+              <col width=\"50%\">\n+              <col width=\"19%\">\n+              <col width=\"31%\">\n+              </colgroup>\n+              <thead valign=\"bottom\">\n+              <tr class=\"row-odd\"><th class=\"head\">Parameter Name</th>\n+              <th class=\"head\">Corresponding Client</th>\n+              <th class=\"head\">Streams Default</th>\n+              </tr>\n+              </thead>\n+              <tbody valign=\"top\">\n+              <tr class=\"row-even\"><td>auto.create.topics.enable</td>", "originalCommit": "b43ab072f400f0d74a12b043d65536e9eeba6969", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cb8c3112a0a37b4b51f311cfad6434d4817273a0", "url": "https://github.com/apache/kafka/commit/cb8c3112a0a37b4b51f311cfad6434d4817273a0", "message": "Incorporate feedback.", "committedDate": "2020-03-24T17:58:39Z", "type": "commit"}, {"oid": "657950b06591033676c419c11582687c0b6a1eca", "url": "https://github.com/apache/kafka/commit/657950b06591033676c419c11582687c0b6a1eca", "message": "Rework topic partitions note", "committedDate": "2020-03-25T17:25:40Z", "type": "commit"}]}