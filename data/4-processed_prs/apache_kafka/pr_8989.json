{"pr_number": 8989, "pr_title": "KAFKA-10239: Make GroupInstanceId ignorable in DescribeGroups", "pr_createdAt": "2020-07-06T21:10:53Z", "pr_url": "https://github.com/apache/kafka/pull/8989", "timeline": [{"oid": "9840f7a71a9503c38857c9bb4766dd8a4eb53d36", "url": "https://github.com/apache/kafka/commit/9840f7a71a9503c38857c9bb4766dd8a4eb53d36", "message": "make GroupInstanceId ignorable in DescribeGroup", "committedDate": "2020-07-06T20:08:23Z", "type": "commit"}, {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825", "url": "https://github.com/apache/kafka/commit/a9c2eb6c279688a5e1bd7f57103165be493f7825", "message": "tests and cleanups", "committedDate": "2020-07-06T21:10:47Z", "type": "commit"}, {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825", "url": "https://github.com/apache/kafka/commit/a9c2eb6c279688a5e1bd7f57103165be493f7825", "message": "tests and cleanups", "committedDate": "2020-07-06T21:10:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDEwMA==", "url": "https://github.com/apache/kafka/pull/8989#discussion_r450490100", "bodyText": "nit: may as well fix alignment as well", "author": "hachikuji", "createdAt": "2020-07-06T21:30:11Z", "path": "clients/src/test/java/org/apache/kafka/common/message/MessageTest.java", "diffHunk": "@@ -933,7 +983,7 @@ private void verifyWriteRaisesNpe(short version, Message message) throws Excepti\n \n     private void verifyWriteRaisesUve(short version,\n                                       String problemText,\n-                                     Message message) throws Exception {\n+                                     Message message) {", "originalCommit": "a9c2eb6c279688a5e1bd7f57103165be493f7825", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDY0OQ==", "url": "https://github.com/apache/kafka/pull/8989#discussion_r450490649", "bodyText": "Should we test the expected behavior for all versions?", "author": "hachikuji", "createdAt": "2020-07-06T21:31:27Z", "path": "clients/src/test/java/org/apache/kafka/common/message/MessageTest.java", "diffHunk": "@@ -218,6 +220,59 @@ public void testOffsetCommitDefaultGroupInstanceId() throws Exception {\n         testAllMessageRoundTripsFromVersion((short) 7, request.get().setGroupInstanceId(instanceId));\n     }\n \n+    @Test\n+    public void testDescribeGroupsRequestVersions() throws Exception {\n+        testAllMessageRoundTrips(new DescribeGroupsRequestData()\n+                .setGroups(Collections.singletonList(\"group\"))\n+                .setIncludeAuthorizedOperations(false));\n+    }\n+\n+    @Test\n+    public void testDescribeGroupsResponseVersions() throws Exception {\n+        DescribedGroupMember baseMember = new DescribedGroupMember()\n+            .setMemberId(memberId);\n+\n+        DescribedGroup baseGroup = new DescribedGroup()\n+                                       .setGroupId(\"group\")\n+                                       .setGroupState(\"Stable\").setErrorCode(Errors.NONE.code())\n+                                       .setMembers(Collections.singletonList(baseMember))\n+                                       .setProtocolType(\"consumer\");\n+        DescribeGroupsResponseData baseResponse = new DescribeGroupsResponseData()\n+                                                  .setGroups(Collections.singletonList(baseGroup));\n+        testAllMessageRoundTrips(baseResponse);\n+\n+        testAllMessageRoundTripsFromVersion((short) 1, baseResponse.setThrottleTimeMs(10));", "originalCommit": "a9c2eb6c279688a5e1bd7f57103165be493f7825", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDUxMDI1Nw==", "url": "https://github.com/apache/kafka/pull/8989#discussion_r450510257", "bodyText": "We would check for equality only with versions that already introduced the new fields IMHO?", "author": "abbccdda", "createdAt": "2020-07-06T22:23:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDY0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDUxNDI4NQ==", "url": "https://github.com/apache/kafka/pull/8989#discussion_r450514285", "bodyText": "Then we wouldn't have caught this bug \ud83d\ude09 . The most dangerous aspect of the generated protocols is the down-conversion to older formats since it gets poor test coverage.", "author": "hachikuji", "createdAt": "2020-07-06T22:35:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDY0OQ=="}], "type": "inlineReview"}, {"oid": "bba3797eb3cbfbe46fad0a33fb7eecef007ac7c2", "url": "https://github.com/apache/kafka/commit/bba3797eb3cbfbe46fad0a33fb7eecef007ac7c2", "message": "add throttle test coverage", "committedDate": "2020-07-06T23:13:45Z", "type": "commit"}]}