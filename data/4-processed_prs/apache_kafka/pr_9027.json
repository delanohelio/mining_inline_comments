{"pr_number": 9027, "pr_title": "KAFKA-9161: add docs for KIP-441 and KIP-613 and other configs that need fixing", "pr_createdAt": "2020-07-15T02:46:08Z", "pr_url": "https://github.com/apache/kafka/pull/9027", "timeline": [{"oid": "f6427aebf07a5c0f946c7bfbe133fd4e98d723d2", "url": "https://github.com/apache/kafka/commit/f6427aebf07a5c0f946c7bfbe133fd4e98d723d2", "message": "KIP-441 docs", "committedDate": "2020-07-15T02:23:38Z", "type": "commit"}, {"oid": "8a970ef6c3a59021e825f3c51fe170387e8027f5", "url": "https://github.com/apache/kafka/commit/8a970ef6c3a59021e825f3c51fe170387e8027f5", "message": "add KIP-613 note to upgrade guide", "committedDate": "2020-07-15T02:34:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1ODc4MQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454758781", "bodyText": "Just moved this down to the \"M\" section", "author": "ableegoldman", "createdAt": "2020-07-15T02:51:05Z", "path": "streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java", "diffHunk": "@@ -360,11 +360,6 @@\n         \" (Note, if <code>processing.guarantee</code> is set to <code>\" + EXACTLY_ONCE + \"</code>, the default value is <code>\" + EOS_DEFAULT_COMMIT_INTERVAL_MS + \"</code>,\" +\n         \" otherwise the default value is <code>\" + DEFAULT_COMMIT_INTERVAL_MS + \"</code>.\";\n \n-    /** {@code max.task.idle.ms} */\n-    public static final String MAX_TASK_IDLE_MS_CONFIG = \"max.task.idle.ms\";\n-    private static final String MAX_TASK_IDLE_MS_DOC = \"Maximum amount of time a stream task will stay idle when not all of its partition buffers contain records,\" +\n-        \" to avoid potential out-of-order record processing across multiple input streams.\";\n-", "originalCommit": "8a970ef6c3a59021e825f3c51fe170387e8027f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1OTA0Mw==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454759043", "bodyText": "Moved up since this is not a consumer or producer config...", "author": "ableegoldman", "createdAt": "2020-07-15T02:52:00Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -63,24 +63,29 @@\n           </ul>\n           </li>\n           <li><a class=\"reference internal\" href=\"#optional-configuration-parameters\" id=\"id6\">Optional configuration parameters</a><ul>\n+            <li><a class=\"reference internal\" href=\"#acceptable-recovery-lag\" id=\"id27\">acceptable.recovery.lag</a></li>\n             <li><a class=\"reference internal\" href=\"#default-deserialization-exception-handler\" id=\"id7\">default.deserialization.exception.handler</a></li>\n             <li><a class=\"reference internal\" href=\"#default-production-exception-handler\" id=\"id24\">default.production.exception.handler</a></li>\n             <li><a class=\"reference internal\" href=\"#default-key-serde\" id=\"id8\">default.key.serde</a></li>\n             <li><a class=\"reference internal\" href=\"#default-value-serde\" id=\"id9\">default.value.serde</a></li>\n+            <li><a class=\"reference internal\" href=\"#max-task-idle-ms\" id=\"id28\">max.task.idle.ms</a></li>\n+            <li><a class=\"reference internal\" href=\"#max-warmup-replicas\" id=\"id29\">max.warmup.replicas</a></li>\n             <li><a class=\"reference internal\" href=\"#num-standby-replicas\" id=\"id10\">num.standby.replicas</a></li>\n             <li><a class=\"reference internal\" href=\"#num-stream-threads\" id=\"id11\">num.stream.threads</a></li>\n+            <li><a class=\"reference internal\" href=\"#probing-rebalance-interval-ms\" id=\"id30\">probing.rebalance.interval.ms</a></li>\n             <li><a class=\"reference internal\" href=\"#partition-grouper\" id=\"id12\">partition.grouper</a></li>\n             <li><a class=\"reference internal\" href=\"#processing-guarantee\" id=\"id25\">processing.guarantee</a></li>\n             <li><a class=\"reference internal\" href=\"#replication-factor\" id=\"id13\">replication.factor</a></li>\n+            <li><a class=\"reference internal\" href=\"#rocksdb-config-setter\" id=\"id20\">rocksdb.config.setter</a></li>\n             <li><a class=\"reference internal\" href=\"#state-dir\" id=\"id14\">state.dir</a></li>\n             <li><a class=\"reference internal\" href=\"#timestamp-extractor\" id=\"id15\">timestamp.extractor</a></li>\n+            <li><a class=\"reference internal\" href=\"#topology-optimization\" id=\"id31\">topology.optimization</a></li>\n           </ul>\n           </li>\n           <li><a class=\"reference internal\" href=\"#kafka-consumers-and-producer-configuration-parameters\" id=\"id16\">Kafka consumers and producer configuration parameters</a><ul>\n             <li><a class=\"reference internal\" href=\"#naming\" id=\"id17\">Naming</a></li>\n             <li><a class=\"reference internal\" href=\"#default-values\" id=\"id18\">Default Values</a></li>\n             <li><a class=\"reference internal\" href=\"#enable-auto-commit\" id=\"id19\">enable.auto.commit</a></li>\n-            <li><a class=\"reference internal\" href=\"#rocksdb-config-setter\" id=\"id20\">rocksdb.config.setter</a></li>", "originalCommit": "8a970ef6c3a59021e825f3c51fe170387e8027f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1OTI1Ng==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454759256", "bodyText": "No wonder we get so many questions about this, the config has been missing from the docs the whole time", "author": "ableegoldman", "createdAt": "2020-07-15T02:52:46Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -63,24 +63,29 @@\n           </ul>\n           </li>\n           <li><a class=\"reference internal\" href=\"#optional-configuration-parameters\" id=\"id6\">Optional configuration parameters</a><ul>\n+            <li><a class=\"reference internal\" href=\"#acceptable-recovery-lag\" id=\"id27\">acceptable.recovery.lag</a></li>\n             <li><a class=\"reference internal\" href=\"#default-deserialization-exception-handler\" id=\"id7\">default.deserialization.exception.handler</a></li>\n             <li><a class=\"reference internal\" href=\"#default-production-exception-handler\" id=\"id24\">default.production.exception.handler</a></li>\n             <li><a class=\"reference internal\" href=\"#default-key-serde\" id=\"id8\">default.key.serde</a></li>\n             <li><a class=\"reference internal\" href=\"#default-value-serde\" id=\"id9\">default.value.serde</a></li>\n+            <li><a class=\"reference internal\" href=\"#max-task-idle-ms\" id=\"id28\">max.task.idle.ms</a></li>", "originalCommit": "8a970ef6c3a59021e825f3c51fe170387e8027f5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2MDkyMA==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454860920", "bodyText": "Thank you for adding this here.\nFYI, here we have the docs for max.task.idle.ms: https://kafka.apache.org/documentation/#streamsconfigs.\nThis relates to the issue Matthias brought up once that we have this config docs in two places on the website which makes it harder to maintain. Until Matthias brought up this issues I was not aware that we had this docs twice.", "author": "cadonna", "createdAt": "2020-07-15T07:52:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1OTI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNTA0MA==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455225040", "bodyText": "Huh, oh yeah. I wonder if these are the docs that are autogenerated? Not sure, since it seems to still be missing some configs, but only configs that don't have an associated {CONFIG_NAME}_DOC string...\nedit: they're definitely autogenerated\nAnyways, I totally agree we should not have this listed in two places, but imo we should continue to list them in the Streams docs where we can go into much more detail, and where users are more likely to look first. Personally, I forgot that we also listed configs here and only ever looked at the Streams page. I'd imagine I'm not alone in that.\nMaybe we can remove the listing here and just link to the Streams config page?", "author": "ableegoldman", "createdAt": "2020-07-15T17:37:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1OTI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0Nzk1OQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455247959", "bodyText": "Not necessarily as part of this PR. I guess we can discuss what to do going forward; for now, I think it's best to just make sure both pages reflect the current reality", "author": "ableegoldman", "createdAt": "2020-07-15T18:14:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1OTI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1OTMyMQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454759321", "bodyText": "Also missing from the config docs", "author": "ableegoldman", "createdAt": "2020-07-15T02:52:57Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -63,24 +63,29 @@\n           </ul>\n           </li>\n           <li><a class=\"reference internal\" href=\"#optional-configuration-parameters\" id=\"id6\">Optional configuration parameters</a><ul>\n+            <li><a class=\"reference internal\" href=\"#acceptable-recovery-lag\" id=\"id27\">acceptable.recovery.lag</a></li>\n             <li><a class=\"reference internal\" href=\"#default-deserialization-exception-handler\" id=\"id7\">default.deserialization.exception.handler</a></li>\n             <li><a class=\"reference internal\" href=\"#default-production-exception-handler\" id=\"id24\">default.production.exception.handler</a></li>\n             <li><a class=\"reference internal\" href=\"#default-key-serde\" id=\"id8\">default.key.serde</a></li>\n             <li><a class=\"reference internal\" href=\"#default-value-serde\" id=\"id9\">default.value.serde</a></li>\n+            <li><a class=\"reference internal\" href=\"#max-task-idle-ms\" id=\"id28\">max.task.idle.ms</a></li>\n+            <li><a class=\"reference internal\" href=\"#max-warmup-replicas\" id=\"id29\">max.warmup.replicas</a></li>\n             <li><a class=\"reference internal\" href=\"#num-standby-replicas\" id=\"id10\">num.standby.replicas</a></li>\n             <li><a class=\"reference internal\" href=\"#num-stream-threads\" id=\"id11\">num.stream.threads</a></li>\n+            <li><a class=\"reference internal\" href=\"#probing-rebalance-interval-ms\" id=\"id30\">probing.rebalance.interval.ms</a></li>\n             <li><a class=\"reference internal\" href=\"#partition-grouper\" id=\"id12\">partition.grouper</a></li>\n             <li><a class=\"reference internal\" href=\"#processing-guarantee\" id=\"id25\">processing.guarantee</a></li>\n             <li><a class=\"reference internal\" href=\"#replication-factor\" id=\"id13\">replication.factor</a></li>\n+            <li><a class=\"reference internal\" href=\"#rocksdb-config-setter\" id=\"id20\">rocksdb.config.setter</a></li>\n             <li><a class=\"reference internal\" href=\"#state-dir\" id=\"id14\">state.dir</a></li>\n             <li><a class=\"reference internal\" href=\"#timestamp-extractor\" id=\"id15\">timestamp.extractor</a></li>\n+            <li><a class=\"reference internal\" href=\"#topology-optimization\" id=\"id31\">topology.optimization</a></li>", "originalCommit": "8a970ef6c3a59021e825f3c51fe170387e8027f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8dea9e5d69911f179629f2c9d9d4576efca40be0", "url": "https://github.com/apache/kafka/commit/8dea9e5d69911f179629f2c9d9d4576efca40be0", "message": "add warning about rocksdb cache limit", "committedDate": "2020-07-15T03:06:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg1ODgwOA==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454858808", "bodyText": "Should we add 10 minutes in parenthesis to make the default better readable?", "author": "cadonna", "createdAt": "2020-07-15T07:48:46Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -244,10 +265,15 @@ <h4><a class=\"toc-backref\" href=\"#id5\">bootstrap.servers</a><a class=\"headerlink\n             <td colspan=\"2\">Partition grouper class that implements the <code class=\"docutils literal\"><span class=\"pre\">PartitionGrouper</span></code> interface.</td>\n             <td>See <a class=\"reference internal\" href=\"#streams-developer-guide-partition-grouper\"><span class=\"std std-ref\">Partition Grouper</span></a></td>\n           </tr>\n+          <tr class=\"row-odd\"><td>probing.rebalance.interval.ms</td>\n+            <td>Low</td>\n+            <td colspan=\"2\">The maximum time to wait before triggering a rebalance to probe for warmup replicas that have sufficiently caught up.</td>\n+            <td>600000 milliseconds</td>", "originalCommit": "8dea9e5d69911f179629f2c9d9d4576efca40be0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2MjExMw==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454862113", "bodyText": "Shouldn't that be row-even?", "author": "cadonna", "createdAt": "2020-07-15T07:54:48Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -270,21 +296,26 @@ <h4><a class=\"toc-backref\" href=\"#id5\">bootstrap.servers</a><a class=\"headerlink\n               <td colspan=\"2\">The amount of time in milliseconds, before a request is retried. This applies if the <code class=\"docutils literal\"><span class=\"pre\">retries</span></code> parameter is configured to be greater than 0. </td>\n               <td>100</td>\n           </tr>\n-          <tr class=\"row-even\"><td>rocksdb.config.setter</td>\n+          <tr class=\"row-odd\"><td>rocksdb.config.setter</td>\n             <td>Medium</td>\n             <td colspan=\"2\">The RocksDB configuration.</td>\n             <td></td>\n           </tr>\n-          <tr class=\"row-odd\"><td>state.cleanup.delay.ms</td>\n+          <tr class=\"row-even\"><td>state.cleanup.delay.ms</td>\n             <td>Low</td>\n             <td colspan=\"2\">The amount of time in milliseconds to wait before deleting state when a partition has migrated.</td>\n             <td>600000 milliseconds</td>\n           </tr>\n-          <tr class=\"row-even\"><td>state.dir</td>\n+          <tr class=\"row-odd\"><td>state.dir</td>\n             <td>High</td>\n             <td colspan=\"2\">Directory location for state stores.</td>\n             <td><code class=\"docutils literal\"><span class=\"pre\">/tmp/kafka-streams</span></code></td>\n           </tr>\n+          <tr class=\"row-odd\"><td>topology.optimization</td>", "originalCommit": "8dea9e5d69911f179629f2c9d9d4576efca40be0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNjc1Nw==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455216757", "bodyText": "Yep, thanks (to be honest I'm not sure what this even does, since a few of these were incorrect already and no one ever noticed AFAICT. But better to be correct)", "author": "ableegoldman", "createdAt": "2020-07-15T17:29:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2MjExMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY4NzczMQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455687731", "bodyText": "I guess it tells the renderer which CSS to use to have alternating row colours. Apparently, CSS3 already offers ways to accomplish this without these classes (see https://www.textfixer.com/tutorials/css-table-alternating-rows.php).", "author": "cadonna", "createdAt": "2020-07-16T10:30:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2MjExMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2NDE0Ng==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454864146", "bodyText": "nit: Could you put </blockquote> to a new line?", "author": "cadonna", "createdAt": "2020-07-15T07:58:19Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -425,6 +465,24 @@ <h4><a class=\"toc-backref\" href=\"#id9\">default.value.serde</a><a class=\"headerli\n               <p>This is discussed in more detail in <a class=\"reference internal\" href=\"datatypes.html#streams-developer-guide-serdes\"><span class=\"std std-ref\">Data types and serialization</span></a>.</p>\n             </div></blockquote>\n         </div>\n+        <div class=\"section\" id=\"max-task-idle-ms\">\n+          <span id=\"streams-developer-guide-max-task-idle-ms\"></span><h4><a class=\"toc-backref\" href=\"#id28\">max.task.idle.ms</a><a class=\"headerlink\" href=\"#max-task-idle-ms\" title=\"Permalink to this headline\"></a></h4>\n+          <blockquote>\n+            <div>\n+              The maximum amount of time a task will idle without processing data when waiting for all of its input partition buffers to contain records. This can help avoid potential out-of-order\n+              processing when the task has multiple input streams, as in a join, for example. Setting this to a nonzero value may increase latency but will improve time synchronization.\n+            </div></blockquote>\n+        </div>\n+        <div class=\"section\" id=\"max-warmup-replicas\">\n+          <span id=\"streams-developer-guide-max-warmup-replicas\"></span><h4><a class=\"toc-backref\" href=\"#id29\">max.warmup.replicas</a><a class=\"headerlink\" href=\"#max-warmup-replicas\" title=\"Permalink to this headline\"></a></h4>\n+          <blockquote>\n+            <div>\n+              The maximum number of warmup replicas (extra standbys beyond the configured num.standbys) that can be assigned at once for the purpose of keeping\n+              the task available on one instance while it is warming up on another instance it has been reassigned to. Used to throttle how much extra broker\n+              traffic and cluster state can be used for high availability. Increasing this will allow Streams to warm up more tasks at once, speeding up the time\n+              for the reassigned warmups to restore sufficient state for them to be transitioned to active tasks. Must be at least 1.\n+            </div></blockquote>", "originalCommit": "8dea9e5d69911f179629f2c9d9d4576efca40be0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxODAzMg==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455218032", "bodyText": "Ack. I was trying to be consistent since this is done elsewhere, but looking through all the code, it's already really inconsistent...", "author": "ableegoldman", "createdAt": "2020-07-15T17:30:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2NDE0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2NzAwNA==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r454867004", "bodyText": "Did you mean to write \"If you set this to true\" or is it also correct to say \"If you set this true\"?\nCould you put WriteBufferManager into <code> tags?", "author": "cadonna", "createdAt": "2020-07-15T08:03:35Z", "path": "docs/streams/developer-guide/memory-mgmt.html", "diffHunk": "@@ -206,7 +206,10 @@ <h2><a class=\"toc-backref\" href=\"#id3\">RocksDB</a><a class=\"headerlink\" href=\"#r\n        <span class=\"o\">}</span>\n     <span class=\"o\">}</span>\n       </div>\n-        <sup id=\"fn1\">1. INDEX_FILTER_BLOCK_RATIO can be used to set a fraction of the block cache to set aside for \"high priority\" (aka index and filter) blocks, preventing them from being evicted by data blocks. See the full signature of the <a class=\"reference external\" href=\"https://github.com/facebook/rocksdb/blob/master/java/src/main/java/org/rocksdb/LRUCache.java#L72\">LRUCache constructor</a>. </sup>\n+        <sup id=\"fn1\">1. INDEX_FILTER_BLOCK_RATIO can be used to set a fraction of the block cache to set aside for \"high priority\" (aka index and filter) blocks, preventing them from being evicted by data blocks. See the full signature of the <a class=\"reference external\" href=\"https://github.com/facebook/rocksdb/blob/master/java/src/main/java/org/rocksdb/LRUCache.java#L72\">LRUCache constructor</a>.\n+                        NOTE: the boolean parameter in the cache constructor lets you control whether the cache should enforce a strict memory limit by failing the read or iteration in the rare cases where it might go larger than its capacity. Due to a\n+                        <a class=\"reference external\" href=\"https://github.com/facebook/rocksdb/issues/6247\">bug in RocksDB</a>, this option cannot be used\n+                        if the write buffer memory is also counted against the cache. If you set this true, you should NOT pass the cache in to the WriteBufferManager and just control the write buffer and cache memory separately.</sup>", "originalCommit": "8dea9e5d69911f179629f2c9d9d4576efca40be0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3e0641bd9eab1ba5f47d74802bb7f951ad0948f2", "url": "https://github.com/apache/kafka/commit/3e0641bd9eab1ba5f47d74802bb7f951ad0948f2", "message": "add definition for default windowed serde classes", "committedDate": "2020-07-15T18:05:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0ODM2Mw==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455248363", "bodyText": "Moved the \"N\" configs down below the \"M\"s", "author": "ableegoldman", "createdAt": "2020-07-15T18:15:12Z", "path": "streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java", "diffHunk": "@@ -639,16 +643,16 @@\n                     Serdes.ByteArraySerde.class.getName(),\n                     Importance.MEDIUM,\n                     DEFAULT_VALUE_SERDE_CLASS_DOC)\n-            .define(NUM_STANDBY_REPLICAS_CONFIG,", "originalCommit": "3e0641bd9eab1ba5f47d74802bb7f951ad0948f2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5a655f7a4e0580f940b04437eb48ea358da8c3d6", "url": "https://github.com/apache/kafka/commit/5a655f7a4e0580f940b04437eb48ea358da8c3d6", "message": "fix inconsistent style", "committedDate": "2020-07-15T18:22:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1MzE1OQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455253159", "bodyText": "This is all newly added: we weren't defining these configs before at all, which means they had no default value, no description, were left out of the autogenerated docs, etc\nI checked the KIP and it didn't specify what the default should be, so I figured I could freely choose null (see KAFKA-9559)", "author": "ableegoldman", "createdAt": "2020-07-15T18:23:19Z", "path": "streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java", "diffHunk": "@@ -639,16 +643,16 @@\n                     Serdes.ByteArraySerde.class.getName(),\n                     Importance.MEDIUM,\n                     DEFAULT_VALUE_SERDE_CLASS_DOC)\n-            .define(NUM_STANDBY_REPLICAS_CONFIG,\n-                    Type.INT,\n-                    0,\n+            .define(DEFAULT_WINDOWED_KEY_SERDE_INNER_CLASS,\n+                    Type.CLASS,\n+                    null,\n                     Importance.MEDIUM,\n-                    NUM_STANDBY_REPLICAS_DOC)\n-            .define(NUM_STREAM_THREADS_CONFIG,\n-                    Type.INT,\n-                    1,\n+                    DEFAULT_WINDOWED_KEY_SERDE_INNER_CLASS_DOC)\n+            .define(DEFAULT_WINDOWED_VALUE_SERDE_INNER_CLASS,\n+                    Type.CLASS,\n+                    null,\n                     Importance.MEDIUM,\n-                    NUM_STREAM_THREADS_DOC)\n+                    DEFAULT_WINDOWED_VALUE_SERDE_INNER_CLASS_DOC)", "originalCommit": "3e0641bd9eab1ba5f47d74802bb7f951ad0948f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3OTEwNg==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455879106", "bodyText": "Woah. Good catch.", "author": "vvcephei", "createdAt": "2020-07-16T15:34:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1MzE1OQ=="}], "type": "inlineReview"}, {"oid": "2cb978fdc4880b8c692487a8b3db7a9e8c00765d", "url": "https://github.com/apache/kafka/commit/2cb978fdc4880b8c692487a8b3db7a9e8c00765d", "message": "add windowed serdes to streams config docs", "committedDate": "2020-07-15T18:35:15Z", "type": "commit"}, {"oid": "90a97d8d890512ad0d39dc97aacaff0fad0a1bab", "url": "https://github.com/apache/kafka/commit/90a97d8d890512ad0d39dc97aacaff0fad0a1bab", "message": "fix missing default in timestamp extractor", "committedDate": "2020-07-15T18:42:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY4MTM2Mg==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455681362", "bodyText": "This line seems a duplicate.", "author": "cadonna", "createdAt": "2020-07-16T10:18:54Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -181,6 +193,7 @@ <h4><a class=\"toc-backref\" href=\"#id5\">bootstrap.servers</a><a class=\"headerlink\n           <tr class=\"row-even\"><td>cache.max.bytes.buffering</td>\n             <td>Medium</td>\n             <td colspan=\"2\">Maximum number of memory bytes to be used for record caches across all threads.</td>\n+            <td colspan=\"2\">Maximum number of memory bytes to be used for record caches across all threads.</td>", "originalCommit": "90a97d8d890512ad0d39dc97aacaff0fad0a1bab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI5OTMwMw==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455299303", "bodyText": "duplicate?", "author": "vvcephei", "createdAt": "2020-07-15T19:45:14Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -181,6 +193,7 @@ <h4><a class=\"toc-backref\" href=\"#id5\">bootstrap.servers</a><a class=\"headerlink\n           <tr class=\"row-even\"><td>cache.max.bytes.buffering</td>\n             <td>Medium</td>\n             <td colspan=\"2\">Maximum number of memory bytes to be used for record caches across all threads.</td>\n+            <td colspan=\"2\">Maximum number of memory bytes to be used for record caches across all threads.</td>", "originalCommit": "90a97d8d890512ad0d39dc97aacaff0fad0a1bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0NzQxOQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r456147419", "bodyText": "How did that happen \ud83e\udd14", "author": "ableegoldman", "createdAt": "2020-07-17T00:14:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI5OTMwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3NDAzMQ==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455874031", "bodyText": "Maybe we can also mention that if you set it to Long.MAX_VALUE, it effectively disables warmups and HA task migration, allowing Streams to produce a balanced assignment in one shot.", "author": "vvcephei", "createdAt": "2020-07-16T15:27:52Z", "path": "docs/streams/developer-guide/config-streams.html", "diffHunk": "@@ -270,43 +319,47 @@ <h4><a class=\"toc-backref\" href=\"#id5\">bootstrap.servers</a><a class=\"headerlink\n               <td colspan=\"2\">The amount of time in milliseconds, before a request is retried. This applies if the <code class=\"docutils literal\"><span class=\"pre\">retries</span></code> parameter is configured to be greater than 0. </td>\n               <td>100</td>\n           </tr>\n-          <tr class=\"row-even\"><td>rocksdb.config.setter</td>\n+          <tr class=\"row-odd\"><td>rocksdb.config.setter</td>\n             <td>Medium</td>\n             <td colspan=\"2\">The RocksDB configuration.</td>\n             <td></td>\n           </tr>\n-          <tr class=\"row-odd\"><td>state.cleanup.delay.ms</td>\n+          <tr class=\"row-even\"><td>state.cleanup.delay.ms</td>\n             <td>Low</td>\n             <td colspan=\"2\">The amount of time in milliseconds to wait before deleting state when a partition has migrated.</td>\n             <td>600000 milliseconds</td>\n           </tr>\n-          <tr class=\"row-even\"><td>state.dir</td>\n+          <tr class=\"row-odd\"><td>state.dir</td>\n             <td>High</td>\n             <td colspan=\"2\">Directory location for state stores.</td>\n             <td><code class=\"docutils literal\"><span class=\"pre\">/tmp/kafka-streams</span></code></td>\n           </tr>\n-          <tr class=\"row-odd\"><td>timestamp.extractor</td>\n+          <tr class=\"row-even\"><td>topology.optimization</td>\n             <td>Medium</td>\n-            <td colspan=\"2\">Timestamp extractor class that implements the <code class=\"docutils literal\"><span class=\"pre\">TimestampExtractor</span></code> interface.</td>\n-            <td>See <a class=\"reference internal\" href=\"#streams-developer-guide-timestamp-extractor\"><span class=\"std std-ref\">Timestamp Extractor</span></a></td>\n+            <td colspan=\"2\">A configuration telling Kafka Streams if it should optimize the topology</td>\n+            <td>none</td>\n           </tr>\n-          <tr class=\"row-even\"><td>upgrade.from</td>\n+          <tr class=\"row-odd\"><td>upgrade.from</td>\n             <td>Medium</td>\n             <td colspan=\"2\">The version you are upgrading from during a rolling upgrade.</td>\n             <td>See <a class=\"reference internal\" href=\"#streams-developer-guide-upgrade-from\"><span class=\"std std-ref\">Upgrade From</span></a></td>\n           </tr>\n-          <tr class=\"row-odd\"><td>value.serde</td>\n-            <td>Medium</td>\n-            <td colspan=\"2\">Default serializer/deserializer class for record values, implements the <code class=\"docutils literal\"><span class=\"pre\">Serde</span></code> interface (see also key.serde).</td>\n-            <td><code class=\"docutils literal\"><span class=\"pre\">Serdes.ByteArray().getClass().getName()</span></code></td>\n-          </tr>\n           <tr class=\"row-even\"><td>windowstore.changelog.additional.retention.ms</td>\n             <td>Low</td>\n             <td colspan=\"2\">Added to a windows maintainMs to ensure data is not deleted from the log prematurely. Allows for clock drift.</td>\n             <td>86400000 milliseconds = 1 day</td>\n           </tr>\n           </tbody>\n         </table>\n+        <div class=\"section\" id=\"acceptable-recovery-lag\">\n+          <h4><a class=\"toc-backref\" href=\"#id27\">acceptable.recovery.lag</a><a class=\"headerlink\" href=\"#acceptable-recovery-lag\" title=\"Permalink to this headline\"></a></h4>\n+          <blockquote>\n+            <div>\n+              The maximum acceptable lag (total number of offsets to catch up from the changelog) for an instance to be considered caught-up and able to receive an active task. Streams will only assign\n+              stateful active tasks to instances whose state stores are within the acceptable recovery lag, if any exist, and assign warmup replicas to restore state in the background for instances\n+              that are not yet caught up. Should correspond to a recovery time of well under a minute for a given workload. Must be at least 0.", "originalCommit": "90a97d8d890512ad0d39dc97aacaff0fad0a1bab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3NjE0OA==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r455876148", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  A stateful active task will only be assigned to an instance once it's state is within the configured\n          \n          \n            \n                                  A stateful active task will only be assigned to an instance once its state is within the configured", "author": "vvcephei", "createdAt": "2020-07-16T15:30:43Z", "path": "docs/streams/developer-guide/running-app.html", "diffHunk": "@@ -110,6 +110,18 @@ <h3><a class=\"toc-backref\" href=\"#id6\">Removing capacity from your application</\n                       <li>If a local state store exists, the changelog is replayed from the previously checkpointed offset. The changes are applied and the state is restored to the most recent snapshot. This method takes less time because it is applying a smaller portion of the changelog.</li>\n                   </ul>\n                   <p>For more information, see <a class=\"reference internal\" href=\"config-streams.html#num-standby-replicas\"><span class=\"std std-ref\">Standby Replicas</span></a>.</p>\n+                  <p>\n+                      As of version 2.6, Streams will now do most of a task's restoration in the background through warmup replicas. These will be assigned to instances that need to restore a lot of state for a task.\n+                      A stateful active task will only be assigned to an instance once it's state is within the configured", "originalCommit": "90a97d8d890512ad0d39dc97aacaff0fad0a1bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0ODkzNg==", "url": "https://github.com/apache/kafka/pull/9027#discussion_r456148936", "bodyText": "Thanks", "author": "ableegoldman", "createdAt": "2020-07-17T00:19:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3NjE0OA=="}], "type": "inlineReview"}, {"oid": "181356a7043478969d6664de3ba161b414f1a703", "url": "https://github.com/apache/kafka/commit/181356a7043478969d6664de3ba161b414f1a703", "message": "github suggestions", "committedDate": "2020-07-17T00:21:11Z", "type": "commit"}]}