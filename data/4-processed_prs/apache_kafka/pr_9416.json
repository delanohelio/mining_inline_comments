{"pr_number": 9416, "pr_title": "MINOR: more log4j entry on elect / resignation of coordinators", "pr_createdAt": "2020-10-12T22:23:25Z", "pr_url": "https://github.com/apache/kafka/pull/9416", "timeline": [{"oid": "a7e03d51d3d318d6f2e1c3bb6a6ce84b332298ce", "url": "https://github.com/apache/kafka/commit/a7e03d51d3d318d6f2e1c3bb6a6ce84b332298ce", "message": "more log4j", "committedDate": "2020-10-12T22:18:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczMjQ0OA==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r503732448", "bodyText": "Shouldn't this be Resigning as the group coordinator or Resigning as group coordinator?", "author": "cadonna", "createdAt": "2020-10-13T07:39:50Z", "path": "core/src/main/scala/kafka/coordinator/group/GroupCoordinator.scala", "diffHunk": "@@ -917,6 +918,7 @@ class GroupCoordinator(val brokerId: Int,\n    * @param offsetTopicPartitionId The partition we are no longer leading\n    */\n   def onResignation(offsetTopicPartitionId: Int): Unit = {\n+    info(s\"Resigning the group coordinator for partition $offsetTopicPartitionId\")", "originalCommit": "a7e03d51d3d318d6f2e1c3bb6a6ce84b332298ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczMjYyNQ==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r503732625", "bodyText": "Same as above.", "author": "cadonna", "createdAt": "2020-10-13T07:40:04Z", "path": "core/src/main/scala/kafka/coordinator/transaction/TransactionCoordinator.scala", "diffHunk": "@@ -329,6 +330,7 @@ class TransactionCoordinator(brokerId: Int,\n    *                         are resigning after receiving a StopReplica request from the controller\n    */\n   def onResignation(txnTopicPartitionId: Int, coordinatorEpoch: Option[Int]): Unit = {\n+    info(s\"Resigning the txn coordinator for partition $txnTopicPartitionId at epoch $coordinatorEpoch\")", "originalCommit": "a7e03d51d3d318d6f2e1c3bb6a6ce84b332298ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU3MzM5OA==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r505573398", "bodyText": "This still needs to be changed.", "author": "cadonna", "createdAt": "2020-10-15T14:08:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczMjYyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg2NDgyMw==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r503864823", "bodyText": "It would also be nice to have the groups that are coordinated in the log message. I guess that is hardly possible, isn't it?", "author": "cadonna", "createdAt": "2020-10-13T11:10:59Z", "path": "core/src/main/scala/kafka/coordinator/group/GroupCoordinator.scala", "diffHunk": "@@ -908,6 +908,7 @@ class GroupCoordinator(val brokerId: Int,\n    * @param offsetTopicPartitionId The partition we are now leading\n    */\n   def onElection(offsetTopicPartitionId: Int): Unit = {\n+    info(s\"Becoming the group coordinator for partition $offsetTopicPartitionId\")", "originalCommit": "a7e03d51d3d318d6f2e1c3bb6a6ce84b332298ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTE2NDI5Mg==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r505164292", "bodyText": "Yeah that cannot be known until loading is completed.", "author": "guozhangwang", "createdAt": "2020-10-15T04:58:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg2NDgyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTE3MDg3MQ==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r505170871", "bodyText": "But during the loading process, we do have log entry as\nLoading / Unloading group metadata for ...\n\nper group.", "author": "guozhangwang", "createdAt": "2020-10-15T05:22:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg2NDgyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU4ODM2Nw==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r505588367", "bodyText": "That is correct. Thank you for reminding me!", "author": "cadonna", "createdAt": "2020-10-15T14:27:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg2NDgyMw=="}], "type": "inlineReview"}, {"oid": "4b789a7b9db3837d15a5591650509c47e1ddc8cd", "url": "https://github.com/apache/kafka/commit/4b789a7b9db3837d15a5591650509c47e1ddc8cd", "message": "Merge branch 'trunk' of https://github.com/apache/kafka into KMinor-broker-log-upon-elecion", "committedDate": "2020-10-15T04:13:16Z", "type": "commit"}, {"oid": "10808ca01c3c2de974803b1bdf848a27a057f3de", "url": "https://github.com/apache/kafka/commit/10808ca01c3c2de974803b1bdf848a27a057f3de", "message": "github comments", "committedDate": "2020-10-15T05:22:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU3MjU1OA==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r505572558", "bodyText": "Shouldn't that read Elected as the group coordinator ...?", "author": "cadonna", "createdAt": "2020-10-15T14:07:47Z", "path": "core/src/main/scala/kafka/coordinator/group/GroupCoordinator.scala", "diffHunk": "@@ -908,6 +908,7 @@ class GroupCoordinator(val brokerId: Int,\n    * @param offsetTopicPartitionId The partition we are now leading\n    */\n   def onElection(offsetTopicPartitionId: Int): Unit = {\n+    info(s\"Electing as the group coordinator for partition $offsetTopicPartitionId\")", "originalCommit": "10808ca01c3c2de974803b1bdf848a27a057f3de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU3MzE3Mg==", "url": "https://github.com/apache/kafka/pull/9416#discussion_r505573172", "bodyText": "Do you also plan to change this to Elected as ...?", "author": "cadonna", "createdAt": "2020-10-15T14:08:35Z", "path": "core/src/main/scala/kafka/coordinator/transaction/TransactionCoordinator.scala", "diffHunk": "@@ -311,6 +311,7 @@ class TransactionCoordinator(brokerId: Int,\n    * @param coordinatorEpoch The partition coordinator (or leader) epoch from the received LeaderAndIsr request\n    */\n   def onElection(txnTopicPartitionId: Int, coordinatorEpoch: Int): Unit = {\n+    info(s\"Becoming the txn coordinator for partition $txnTopicPartitionId at epoch $coordinatorEpoch\")", "originalCommit": "10808ca01c3c2de974803b1bdf848a27a057f3de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fc2b6ea03067095ac4f0a9939ac3bd54f973ded6", "url": "https://github.com/apache/kafka/commit/fc2b6ea03067095ac4f0a9939ac3bd54f973ded6", "message": "github comments", "committedDate": "2020-10-15T16:27:30Z", "type": "commit"}]}