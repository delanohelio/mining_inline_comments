{"pr_number": 8853, "pr_title": "KAFKA-10147 MockAdminClient#describeConfigs(Collection<ConfigResource\u2026", "pr_createdAt": "2020-06-11T08:12:47Z", "pr_url": "https://github.com/apache/kafka/pull/8853", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMTY3Nw==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r439101677", "bodyText": "Maybe just deprecate public method instead of removing it", "author": "abbccdda", "createdAt": "2020-06-11T22:16:52Z", "path": "clients/src/test/java/org/apache/kafka/clients/admin/MockAdminClient.java", "diffHunk": "@@ -365,51 +366,6 @@ synchronized public DescribeTopicsResult describeTopics(Collection<String> topic\n         return new DescribeTopicsResult(topicDescriptions);\n     }\n \n-    @Override\n-    public DescribeConfigsResult describeConfigs(Collection<ConfigResource> resources) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE2NzYxNA==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r439167614", "bodyText": "this method has default implementation (see https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/admin/Admin.java#L340) which calls the variety describeConfigs(Collection<ConfigResource>, DescribeConfigsOptions) so it is ok to remove the new implementation.", "author": "chia7712", "createdAt": "2020-06-12T02:01:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMTY3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMTg3Ng==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r439101876", "bodyText": "nit: topicMetadata.fetchesRemainingUntilVisible = Math.max(0, topicMetadata.fetchesRemainingUntilVisible -1);", "author": "abbccdda", "createdAt": "2020-06-11T22:17:31Z", "path": "clients/src/test/java/org/apache/kafka/clients/admin/MockAdminClient.java", "diffHunk": "@@ -560,10 +529,14 @@ synchronized private Config getResourceDescription(ConfigResource resource) {\n             }\n             case TOPIC: {\n                 TopicMetadata topicMetadata = allTopics.get(resource.name());\n-                if (topicMetadata == null) {\n-                    throw new UnknownTopicOrPartitionException();\n+                if (topicMetadata != null && !topicMetadata.markedForDeletion) {\n+                    if (topicMetadata.fetchesRemainingUntilVisible > 0) topicMetadata.fetchesRemainingUntilVisible--;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE3MDE3Nw==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r439170177", "bodyText": "done", "author": "chia7712", "createdAt": "2020-06-12T02:12:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMTg3Ng=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7", "url": "https://github.com/apache/kafka/commit/184f83ab32b4a0caf4d0566d687f81efb611a5f7", "message": "KAFKA-10147 MockAdminClient#describeConfigs(Collection<ConfigResource>) is unable to handle broker resource", "committedDate": "2020-06-13T10:33:49Z", "type": "commit"}, {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7", "url": "https://github.com/apache/kafka/commit/184f83ab32b4a0caf4d0566d687f81efb611a5f7", "message": "KAFKA-10147 MockAdminClient#describeConfigs(Collection<ConfigResource>) is unable to handle broker resource", "committedDate": "2020-06-13T10:33:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwOTg4MA==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r441609880", "bodyText": "nit: I think that we can use toConfigObject(topicMetadata.configs) here.", "author": "dajac", "createdAt": "2020-06-17T14:55:50Z", "path": "clients/src/test/java/org/apache/kafka/clients/admin/MockAdminClient.java", "diffHunk": "@@ -560,10 +529,15 @@ synchronized private Config getResourceDescription(ConfigResource resource) {\n             }\n             case TOPIC: {\n                 TopicMetadata topicMetadata = allTopics.get(resource.name());\n-                if (topicMetadata == null) {\n-                    throw new UnknownTopicOrPartitionException();\n+                if (topicMetadata != null && !topicMetadata.markedForDeletion) {\n+                    if (topicMetadata.fetchesRemainingUntilVisible > 0)\n+                        topicMetadata.fetchesRemainingUntilVisible = Math.max(0, topicMetadata.fetchesRemainingUntilVisible - 1);\n+                    else return new Config(topicMetadata.configs.entrySet().stream()\n+                                .map(entry -> new ConfigEntry(entry.getKey(), entry.getValue()))\n+                                .collect(Collectors.toList()));", "originalCommit": "184f83ab32b4a0caf4d0566d687f81efb611a5f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYxNDg3Mw==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r441614873", "bodyText": "It has been merged when I notice your comment. Let me address it in another PR :)", "author": "chia7712", "createdAt": "2020-06-17T15:02:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwOTg4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYyNTQ3OQ==", "url": "https://github.com/apache/kafka/pull/8853#discussion_r441625479", "bodyText": "#8889", "author": "chia7712", "createdAt": "2020-06-17T15:15:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwOTg4MA=="}], "type": "inlineReview"}]}