{"pr_number": 8171, "pr_title": "Adapt docs about metrics of Streams according to KIP-444", "pr_createdAt": "2020-02-26T13:09:05Z", "pr_url": "https://github.com/apache/kafka/pull/8171", "timeline": [{"oid": "c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "url": "https://github.com/apache/kafka/commit/c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "message": "Adapt metrics docs of Streams according to KIP-444", "committedDate": "2020-02-26T13:05:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0MzA0Ng==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384643046", "bodyText": "Are those non-streams changes piggy-backed or it was due to unclean rebase?", "author": "guozhangwang", "createdAt": "2020-02-26T17:19:53Z", "path": "docs/ops.html", "diffHunk": "@@ -85,16 +85,16 @@ <h4><a id=\"basic_ops_restarting\" href=\"#basic_ops_restarting\">Graceful shutdown<\n \n   <h4><a id=\"basic_ops_leader_balancing\" href=\"#basic_ops_leader_balancing\">Balancing leadership</a></h4>\n \n-  Whenever a broker stops or crashes, leadership for that broker's partitions transfers to other replicas. When the broker is restarted it will only be a follower for all its partitions, meaning it will not be used for client reads and writes.\n+  Whenever a broker stops or crashes leadership for that broker's partitions transfers to other replicas. This means that by default when the broker is restarted it will only be a follower for all its partitions, meaning it will not be used for client reads and writes.", "originalCommit": "c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY3NTUzNw==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384675537", "bodyText": "My bad! Will remove.", "author": "cadonna", "createdAt": "2020-02-26T18:18:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0MzA0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0Mzg4NA==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384643884", "bodyText": "nit: polls -> consumer poll calls? Ditto below.", "author": "guozhangwang", "createdAt": "2020-02-26T17:21:20Z", "path": "docs/ops.html", "diffHunk": "@@ -1662,157 +1661,189 @@ <h5><a id=\"kafka_streams_thread_monitoring\" href=\"#kafka_streams_thread_monitori\n         <th>Description</th>\n         <th>Mbean name</th>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>commit-latency-avg</td>\n-        <td>The average execution time in ms for committing, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-        <tr>\n+        <td>The average execution time in ms, for committing, across all running tasks of this thread.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>commit-latency-max</td>\n-        <td>The maximum execution time in ms for committing across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for committing, across all running tasks of this thread.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>poll-latency-avg</td>\n-        <td>The average execution time in ms for polling, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-        <tr>\n+        <td>The average execution time in ms, for polling.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>poll-latency-max</td>\n-        <td>The maximum execution time in ms for polling across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for polling.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>process-latency-avg</td>\n-        <td>The average execution time in ms for processing, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The average execution time in ms, for processing.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>process-latency-max</td>\n-        <td>The maximum execution time in ms for processing across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for processing.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>punctuate-latency-avg</td>\n-        <td>The average execution time in ms for punctuating, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The average execution time in ms, for punctuating.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>punctuate-latency-max</td>\n-        <td>The maximum execution time in ms for punctuating across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for punctuating.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>commit-rate</td>\n         <td>The average number of commits per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>commit-total</td>\n-        <td>The total number of commit calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of commit calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>poll-rate</td>\n         <td>The average number of polls per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>", "originalCommit": "c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDcwNzA3Nw==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384707077", "bodyText": "Done!", "author": "cadonna", "createdAt": "2020-02-26T19:17:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0Mzg4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NjQ5MQ==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384646491", "bodyText": "This should be stream-task-metrics right?\nAlso do you remember what's the rationale of adding the processor-node-id=all tag, could we just drop this from this task sensor -- I know it maybe too late to drop, but wondering why we needed this tag in the map.", "author": "guozhangwang", "createdAt": "2020-02-26T17:25:51Z", "path": "docs/ops.html", "diffHunk": "@@ -1662,157 +1661,189 @@ <h5><a id=\"kafka_streams_thread_monitoring\" href=\"#kafka_streams_thread_monitori\n         <th>Description</th>\n         <th>Mbean name</th>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>commit-latency-avg</td>\n-        <td>The average execution time in ms for committing, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-        <tr>\n+        <td>The average execution time in ms, for committing, across all running tasks of this thread.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>commit-latency-max</td>\n-        <td>The maximum execution time in ms for committing across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for committing, across all running tasks of this thread.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>poll-latency-avg</td>\n-        <td>The average execution time in ms for polling, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-        <tr>\n+        <td>The average execution time in ms, for polling.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>poll-latency-max</td>\n-        <td>The maximum execution time in ms for polling across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for polling.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>process-latency-avg</td>\n-        <td>The average execution time in ms for processing, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The average execution time in ms, for processing.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>process-latency-max</td>\n-        <td>The maximum execution time in ms for processing across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for processing.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>punctuate-latency-avg</td>\n-        <td>The average execution time in ms for punctuating, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The average execution time in ms, for punctuating.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>punctuate-latency-max</td>\n-        <td>The maximum execution time in ms for punctuating across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for punctuating.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>commit-rate</td>\n         <td>The average number of commits per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>commit-total</td>\n-        <td>The total number of commit calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of commit calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>poll-rate</td>\n         <td>The average number of polls per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>poll-total</td>\n-        <td>The total number of poll calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of poll calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>process-rate</td>\n-        <td>The average number of process calls per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>The average number of processed records per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>process-total</td>\n-        <td>The total number of process calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of processed records.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>punctuate-rate</td>\n-        <td>The average number of punctuates per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The average number of punctuate calls per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>punctuate-total</td>\n-        <td>The total number of punctuate calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of punctuate calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-created-rate</td>\n-        <td>The average number of newly created tasks per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The average number of tasks created per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-created-total</td>\n         <td>The total number of tasks created.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-closed-rate</td>\n         <td>The average number of tasks closed per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-closed-total</td>\n         <td>The total number of tasks closed.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>skipped-records-rate</td>\n-        <td>The average number of skipped records per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>skipped-records-total</td>\n-        <td>The total number of skipped records.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n  </tbody>\n </table>\n \n <h5><a id=\"kafka_streams_task_monitoring\" href=\"#kafka_streams_task_monitoring\">Task Metrics</a></h5>\n-All the following metrics have a recording level of <code>debug</code>:\n+All the following metrics have a recording level of <code>debug</code>,\n+except for metrics dropped-records-(rate | total) which have a recording level\n+of <code>info</code>:\n  <table class=\"data-table\">\n       <tbody>\n       <tr>\n         <th>Metric/Attribute name</th>\n         <th>Description</th>\n         <th>Mbean name</th>\n       </tr>\n+      <tr>\n+        <td>process-latency-avg</td>\n+        <td>The average execution time in ns, for processing.</td>\n+        <td>kafka.streams:type=stream-task-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n+        <td>process-latency-max</td>\n+        <td>The maximum execution time in ns, for processing.</td>\n+        <td>kafka.streams:type=stream-task-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n+        <td>process-rate</td>\n+        <td>The average number of processed records per second across all source processor nodes of this task.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=all</td>", "originalCommit": "c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDcwNTY0Mw==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384705643", "bodyText": "Good catch!\nI guess we have that tag because the metric is a roll-up metric which measures across all processor nodes. I took over the tag from the previous built-in metrics version.\nI removed the tag from the docs.", "author": "cadonna", "createdAt": "2020-02-26T19:14:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NjQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDczMTM5NA==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384731394", "bodyText": "Actually in the source code we do add the processor-node-id=all so we cannot just remove it from the docs -- what I was asking is, if we can remove this tag in the code, so that we can remove it in the docs -- anyways we need to make the doc consistent with code, which currently add this tag to the map, and I'm wondering if it is necessary or can be removed (in both code and then docs).", "author": "guozhangwang", "createdAt": "2020-02-26T19:58:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NjQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDczNDMyOQ==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384734329", "bodyText": "Currently, I do not see a reason we would need this tag. However, I have to try to remove it to be completely sure.", "author": "cadonna", "createdAt": "2020-02-26T20:04:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NjQ5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDczNTQ5NA==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384735494", "bodyText": "Cool, could you try removing that in the source code and then see if that it still okay from unit tests?", "author": "guozhangwang", "createdAt": "2020-02-26T20:06:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NjQ5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NzE2MQ==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384647161", "bodyText": "It's better to add a note at the beginning of Processor Node Metrics that the following four metrics are only available in certain types of nodes, e.g. process-rate and process-total would only be available for source nodes.", "author": "guozhangwang", "createdAt": "2020-02-26T17:26:58Z", "path": "docs/ops.html", "diffHunk": "@@ -1826,111 +1857,25 @@ <h5><a id=\"kafka_streams_node_monitoring\" href=\"#kafka_streams_node_monitoring\">\n         <th>Description</th>\n         <th>Mbean name</th>\n       </tr>\n-      <tr>\n-        <td>process-latency-avg</td>\n-        <td>The average process execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>process-latency-max</td>\n-        <td>The maximum process execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>punctuate-latency-avg</td>\n-        <td>The average punctuate execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>punctuate-latency-max</td>\n-        <td>The maximum punctuate execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>create-latency-avg</td>\n-        <td>The average create execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>create-latency-max</td>\n-        <td>The maximum create execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>destroy-latency-avg</td>\n-        <td>The average destroy execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>destroy-latency-max</td>\n-        <td>The maximum destroy execution time in ns. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n-      </tr>\n       <tr>\n         <td>process-rate</td>\n-        <td>The average number of process operations per second. </td>\n-        <td>kafka.streams:type=stream-processor-node-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),processor-node-id=([-.\\w]+)</td>\n+        <td>The average number of records processed by a source processor node per second.</td>", "originalCommit": "c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDcwNTc5Mg==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384705792", "bodyText": "Done", "author": "cadonna", "createdAt": "2020-02-26T19:14:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NzE2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0ODQzNQ==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384648435", "bodyText": "Ditto here, mention that the following metrics are only available for certain types of stores.", "author": "guozhangwang", "createdAt": "2020-02-26T17:29:15Z", "path": "docs/ops.html", "diffHunk": "@@ -1957,182 +1903,157 @@ <h5><a id=\"kafka_streams_store_monitoring\" href=\"#kafka_streams_store_monitoring\n       <tr>\n         <td>put-latency-avg</td>\n         <td>The average put execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-latency-max</td>\n         <td>The maximum put execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-if-absent-latency-avg</td>\n         <td>The average put-if-absent execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-if-absent-latency-max</td>\n         <td>The maximum put-if-absent execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>get-latency-avg</td>\n         <td>The average get execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>get-latency-max</td>\n         <td>The maximum get execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>delete-latency-avg</td>\n         <td>The average delete execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>delete-latency-max</td>\n         <td>The maximum delete execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-all-latency-avg</td>\n         <td>The average put-all execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-all-latency-max</td>\n         <td>The maximum put-all execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>all-latency-avg</td>\n         <td>The average all operation execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>all-latency-max</td>\n         <td>The maximum all operation execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>range-latency-avg</td>\n         <td>The average range execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>range-latency-max</td>\n         <td>The maximum range execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n        <tr>\n         <td>flush-latency-avg</td>\n         <td>The average flush execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>flush-latency-max</td>\n         <td>The maximum flush execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>restore-latency-avg</td>\n         <td>The average restore execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>restore-latency-max</td>\n         <td>The maximum restore execution time in ns. </td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-rate</td>\n         <td>The average put rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>put-total</td>\n-        <td>The total number of put calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-if-absent-rate</td>\n         <td>The average put-if-absent rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>put-if-absent-total</td>\n-        <td>The total number of put-if-absent calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>get-rate</td>\n         <td>The average get rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>get-total</td>\n-        <td>The total number of get calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>delete-rate</td>\n         <td>The average delete rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>delete-total</td>\n-        <td>The total number of delete calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>put-all-rate</td>\n         <td>The average put-all rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>put-all-total</td>\n-        <td>The total number of put-all calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>all-rate</td>\n         <td>The average all operation rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>all-total</td>\n-        <td>The total number of all operation calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>range-rate</td>\n         <td>The average range rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>range-total</td>\n-        <td>The total number of range calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>flush-rate</td>\n         <td>The average flush rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>flush-total</td>\n-        <td>The total number of flush calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>restore-rate</td>\n         <td>The average restore rate for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-state-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n-        <td>restore-total</td>\n-        <td>The total number of restore calls for this store.</td>\n-        <td>kafka.streams:type=stream-[store-scope]-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),[store-scope]-id=([-.\\w]+)</td>\n+        <td>suppression-buffer-size-avg</td>", "originalCommit": "c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDcwNTk0Ng==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384705946", "bodyText": "Done", "author": "cadonna", "createdAt": "2020-02-26T19:15:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0ODQzNQ=="}], "type": "inlineReview"}, {"oid": "8d2c2f95c2c1761f3151ac53a61d47755ab8f07a", "url": "https://github.com/apache/kafka/commit/8d2c2f95c2c1761f3151ac53a61d47755ab8f07a", "message": "Revert \"Adapt metrics docs of Streams according to KIP-444\"\n\nThis reverts commit c0c9aa8028de476cf30036f3fe7e0ceaa52b38b9.", "committedDate": "2020-02-26T18:48:22Z", "type": "commit"}, {"oid": "7ba7b1429190d1359e577f71388770877c98b2b0", "url": "https://github.com/apache/kafka/commit/7ba7b1429190d1359e577f71388770877c98b2b0", "message": "Adapt docs about metrics of Streams according to KIP-444", "committedDate": "2020-02-26T18:55:47Z", "type": "commit"}, {"oid": "2f49ab241a5113d20eccedf3c098014218332965", "url": "https://github.com/apache/kafka/commit/2f49ab241a5113d20eccedf3c098014218332965", "message": "Include feedback", "committedDate": "2020-02-26T19:18:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1MDEyNg==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384750126", "bodyText": "Just for my own education, why this one is set to ns instead of ms?", "author": "abbccdda", "createdAt": "2020-02-26T20:36:21Z", "path": "docs/ops.html", "diffHunk": "@@ -1654,298 +1653,248 @@ <h5><a id=\"kafka_streams_client_monitoring\" href=\"#kafka_streams_client_monitori\n </table>\n \n <h5><a id=\"kafka_streams_thread_monitoring\" href=\"#kafka_streams_thread_monitoring\">Thread Metrics</a></h5>\n-All the following metrics have a recording level of <code>info</code>:\n+All of the following metrics have a recording level of <code>info</code>:\n <table class=\"data-table\">\n     <tbody>\n       <tr>\n         <th>Metric/Attribute name</th>\n         <th>Description</th>\n         <th>Mbean name</th>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>commit-latency-avg</td>\n-        <td>The average execution time in ms for committing, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-        <tr>\n+        <td>The average execution time in ms, for committing, across all running tasks of this thread.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>commit-latency-max</td>\n-        <td>The maximum execution time in ms for committing across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for committing, across all running tasks of this thread.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>poll-latency-avg</td>\n-        <td>The average execution time in ms for polling, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-        <tr>\n+        <td>The average execution time in ms, for consumer polling.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>poll-latency-max</td>\n-        <td>The maximum execution time in ms for polling across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for consumer polling.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>process-latency-avg</td>\n-        <td>The average execution time in ms for processing, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The average execution time in ms, for processing.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>process-latency-max</td>\n-        <td>The maximum execution time in ms for processing across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for processing.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>punctuate-latency-avg</td>\n-        <td>The average execution time in ms for punctuating, across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The average execution time in ms, for punctuating.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>punctuate-latency-max</td>\n-        <td>The maximum execution time in ms for punctuating across all running tasks of this thread.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n-       <tr>\n+        <td>The maximum execution time in ms, for punctuating.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n         <td>commit-rate</td>\n         <td>The average number of commits per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>commit-total</td>\n-        <td>The total number of commit calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of commit calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>poll-rate</td>\n-        <td>The average number of polls per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>The average number of consumer poll calls per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>poll-total</td>\n-        <td>The total number of poll calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of consumer poll calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>process-rate</td>\n-        <td>The average number of process calls per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-       </tr>\n+        <td>The average number of processed records per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>process-total</td>\n-        <td>The total number of process calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of processed records.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n-       <tr>\n+      <tr>\n         <td>punctuate-rate</td>\n-        <td>The average number of punctuates per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The average number of punctuate calls per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>punctuate-total</td>\n-        <td>The total number of punctuate calls across all tasks.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The total number of punctuate calls.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-created-rate</td>\n-        <td>The average number of newly created tasks per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>The average number of tasks created per second.</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-created-total</td>\n         <td>The total number of tasks created.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-closed-rate</td>\n         <td>The average number of tasks closed per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n       <tr>\n         <td>task-closed-total</td>\n         <td>The total number of tasks closed.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>skipped-records-rate</td>\n-        <td>The average number of skipped records per second.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>skipped-records-total</td>\n-        <td>The total number of skipped records.</td>\n-        <td>kafka.streams:type=stream-metrics,client-id=([-.\\w]+)</td>\n+        <td>kafka.streams:type=stream-thread-metrics,thread-id=([-.\\w]+)</td>\n       </tr>\n  </tbody>\n </table>\n \n <h5><a id=\"kafka_streams_task_monitoring\" href=\"#kafka_streams_task_monitoring\">Task Metrics</a></h5>\n-All the following metrics have a recording level of <code>debug</code>:\n+All of the following metrics have a recording level of <code>debug</code>, except for metrics\n+dropped-records-rate and dropped-records-total which have a recording level of <code>info</code>:\n  <table class=\"data-table\">\n       <tbody>\n       <tr>\n         <th>Metric/Attribute name</th>\n         <th>Description</th>\n         <th>Mbean name</th>\n       </tr>\n+      <tr>\n+        <td>process-latency-avg</td>\n+        <td>The average execution time in ns, for processing.</td>\n+        <td>kafka.streams:type=stream-task-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n+        <td>process-latency-max</td>\n+        <td>The maximum execution time in ns, for processing.</td>\n+        <td>kafka.streams:type=stream-task-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+      </tr>\n+      <tr>\n+        <td>process-rate</td>\n+        <td>The average number of processed records per second across all source processor nodes of this task.</td>\n+        <td>kafka.streams:type=stream-task-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+       </tr>\n+      <tr>\n+        <td>process-total</td>\n+        <td>The total number of processed records across all source processor nodes of this task.</td>\n+        <td>kafka.streams:type=stream-task-metrics,thread-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+      </tr>\n       <tr>\n         <td>commit-latency-avg</td>\n-        <td>The average commit time in ns for this task. </td>\n-        <td>kafka.streams:type=stream-task-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+)</td>\n+        <td>The average execution time in ns, for committing.</td>", "originalCommit": "2f49ab241a5113d20eccedf3c098014218332965", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1NTExMg==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384755112", "bodyText": "It has been always that way. This was not part of KIP-444. I guess because since this metric is on task level, the values may be smaller than on thread level where the metrics measure ms.", "author": "cadonna", "createdAt": "2020-02-26T20:46:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1MDEyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1MjMwNA==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384752304", "bodyText": "Where did we document the deprecation of suppression related metrics?", "author": "abbccdda", "createdAt": "2020-02-26T20:40:53Z", "path": "docs/ops.html", "diffHunk": "@@ -2250,57 +2174,19 @@ <h5><a id=\"kafka_streams_cache_monitoring\" href=\"#kafka_streams_cache_monitoring\n         <th>Mbean name</th>\n       </tr>\n       <tr>\n-        <td>hitRatio-avg</td>\n-        <td>The average cache hit ratio defined as the ratio of cache read hits over the total cache read requests. </td>\n-        <td>kafka.streams:type=stream-record-cache-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),record-cache-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>hitRatio-min</td>\n-        <td>The mininum cache hit ratio. </td>\n-        <td>kafka.streams:type=stream-record-cache-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),record-cache-id=([-.\\w]+)</td>\n-      </tr>\n-      <tr>\n-        <td>hitRatio-max</td>\n-        <td>The maximum cache hit ratio. </td>\n-        <td>kafka.streams:type=stream-record-cache-metrics,client-id=([-.\\w]+),task-id=([-.\\w]+),record-cache-id=([-.\\w]+)</td>\n-      </tr>\n-    </tbody>\n- </table>\n-\n-  <h5><a id=\"kafka_streams_buffer_monitoring\" href=\"#kafka_streams_buffer_monitoring\">Suppression Buffer Metrics</a></h5>\n-  All the following metrics have a recording level of <code>debug</code>:\n-\n-  <table class=\"data-table\">\n-      <tbody>\n-      <tr>\n-        <td>suppression-buffer-size-current</td>", "originalCommit": "2f49ab241a5113d20eccedf3c098014218332965", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1NDI4OQ==", "url": "https://github.com/apache/kafka/pull/8171#discussion_r384754289", "bodyText": "They were not deprecated but moved to state store metrics.", "author": "cadonna", "createdAt": "2020-02-26T20:44:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1MjMwNA=="}], "type": "inlineReview"}]}