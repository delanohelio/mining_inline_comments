{"pr_number": 8495, "pr_title": "MINOR: downgrade test should wait for ISR rejoin between rolls", "pr_createdAt": "2020-04-16T00:50:04Z", "pr_url": "https://github.com/apache/kafka/pull/8495", "timeline": [{"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c", "url": "https://github.com/apache/kafka/commit/4cd8804b440eda70bb132139ded3eb5f4f54f96c", "message": "MINOR: downgrade test should wait for ISR rejoin between rolls", "committedDate": "2020-04-16T00:48:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkzMTkxNQ==", "url": "https://github.com/apache/kafka/pull/8495#discussion_r409931915", "bodyText": "These additions don't work because of the changes to allow for static group membership. I will revert them and we can address it in a follow up PR.", "author": "lbradstreet", "createdAt": "2020-04-17T00:56:21Z", "path": "tests/kafkatest/tests/core/downgrade_test.py", "diffHunk": "@@ -71,7 +76,16 @@ def setup_services(self, kafka_version, compression_types, security_protocol):\n                              version=kafka_version)\n         self.consumer.start()\n \n+    def wait_until_rejoin(self):\n+        for partition in range(0, self.PARTITIONS):\n+            wait_until(lambda: len(self.kafka.isr_idx_list(self.topic, partition)) == self.REPLICATION_FACTOR, \n+                    timeout_sec=60, backoff_sec=1, err_msg=\"Replicas did not rejoin the ISR in a reasonable amount of time\")\n+\n     @cluster(num_nodes=7)\n+    @parametrize(version=str(LATEST_2_5), compression_types=[\"none\"])", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c", "url": "https://github.com/apache/kafka/commit/4cd8804b440eda70bb132139ded3eb5f4f54f96c", "message": "MINOR: downgrade test should wait for ISR rejoin between rolls", "committedDate": "2020-04-16T00:48:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE5OTQxMQ==", "url": "https://github.com/apache/kafka/pull/8495#discussion_r413199411", "bodyText": "Is this necessary to be defined as constants?", "author": "abbccdda", "createdAt": "2020-04-22T18:00:42Z", "path": "tests/kafkatest/tests/core/downgrade_test.py", "diffHunk": "@@ -26,10 +27,12 @@\n from kafkatest.version import LATEST_0_9, LATEST_0_10, LATEST_0_10_0, LATEST_0_10_1, LATEST_0_10_2, LATEST_0_11_0, LATEST_1_0, LATEST_1_1, LATEST_2_0, LATEST_2_1, LATEST_2_2, LATEST_2_3, V_0_9_0_0, V_0_11_0_0, DEV_BRANCH, KafkaVersion\n \n class TestDowngrade(EndToEndTest):\n+    PARTITIONS = 3\n+    REPLICATION_FACTOR = 3\n \n     TOPIC_CONFIG = {\n-        \"partitions\": 3,\n-        \"replication-factor\": 3,\n+        \"partitions\": PARTITIONS,", "originalCommit": "4cd8804b440eda70bb132139ded3eb5f4f54f96c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNjQwMw==", "url": "https://github.com/apache/kafka/pull/8495#discussion_r413216403", "bodyText": "Yes, see https://github.com/apache/kafka/pull/8495/files#diff-11673271221c04c0861f9c5e074a9783R80", "author": "lbradstreet", "createdAt": "2020-04-22T18:24:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE5OTQxMQ=="}], "type": "inlineReview"}]}