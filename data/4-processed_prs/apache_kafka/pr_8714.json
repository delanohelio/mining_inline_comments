{"pr_number": 8714, "pr_title": "MINOR: Improve broker registration and Log logging", "pr_createdAt": "2020-05-22T13:31:20Z", "pr_url": "https://github.com/apache/kafka/pull/8714", "timeline": [{"oid": "de5450e5e414aeca0a88f6f4564b56883a186816", "url": "https://github.com/apache/kafka/commit/de5450e5e414aeca0a88f6f4564b56883a186816", "message": "MINOR: Improve broker registration message\n\nIt was previously:\n\n> INFO Registered broker 0 at path /brokers/ids/0 with addresses: ArraySeq(EndPoint(localhost,9092,ListenerName(PLAINTEXT),PLAINTEXT),EndPoint(localhost,9093,ListenerName(SSL),SSL)), czxid (broker epoch):\n4294967320 (kafka.zk.KafkaZkClient)\n\nIt's now:\n\n> INFO Registered broker 0 at path /brokers/ids/0 with addresses: PLAINTEXT://localhost:9092,SSL://localhost:9093, czxid (broker epoch):\n4294967320 (kafka.zk.KafkaZkClient)", "committedDate": "2020-05-22T13:28:12Z", "type": "commit"}, {"oid": "dbd9df44d6a0fe94e4aca4d21078be4d0815878c", "url": "https://github.com/apache/kafka/commit/dbd9df44d6a0fe94e4aca4d21078be4d0815878c", "message": "Logging improvements to Log", "committedDate": "2020-05-22T14:34:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI4NTk0Mg==", "url": "https://github.com/apache/kafka/pull/8714#discussion_r429285942", "bodyText": "This doesn't change behavior, but makes the code a bit less weird. Previously, we would special case the log, but rely on the called method to check again if deletable is empty.", "author": "ijuma", "createdAt": "2020-05-22T14:37:57Z", "path": "core/src/main/scala/kafka/log/Log.scala", "diffHunk": "@@ -1694,9 +1694,10 @@ class Log(@volatile private var _dir: File,\n   private def deleteOldSegments(predicate: (LogSegment, Option[LogSegment]) => Boolean, reason: String): Int = {\n     lock synchronized {\n       val deletable = deletableSegments(predicate)\n-      if (deletable.nonEmpty)\n+      if (deletable.nonEmpty) {\n         info(s\"Found deletable segments with base offsets [${deletable.map(_.baseOffset).mkString(\",\")}] due to $reason\")\n-      deleteSegments(deletable)\n+        deleteSegments(deletable)\n+      } else 0", "originalCommit": "dbd9df44d6a0fe94e4aca4d21078be4d0815878c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}