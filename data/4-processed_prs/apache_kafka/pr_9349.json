{"pr_number": 9349, "pr_title": "MINOR: add proper checks to KafkaConsumer.groupMetadata", "pr_createdAt": "2020-09-29T05:05:45Z", "pr_url": "https://github.com/apache/kafka/pull/9349", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY4MTM5NQ==", "url": "https://github.com/apache/kafka/pull/9349#discussion_r497681395", "bodyText": "Another way to test this might be to use MockClient.enableBlockingUntilWakeup. That would let us block in Consumer.poll.", "author": "hachikuji", "createdAt": "2020-09-30T17:26:52Z", "path": "clients/src/test/java/org/apache/kafka/clients/consumer/KafkaConsumerTest.java", "diffHunk": "@@ -1994,6 +1995,24 @@ public void testGetGroupMetadata() {\n         assertEquals(groupInstanceId, groupMetadataAfterPoll.groupInstanceId());\n     }\n \n+    @Test\n+    public void testInvalidGroupMetadata() {\n+        Properties props = new Properties();\n+        props.setProperty(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9999\");\n+        props.setProperty(ConsumerConfig.METRIC_REPORTER_CLASSES_CONFIG, MockMetricsReporter.class.getName());\n+        KafkaConsumer<String, String> consumer = new KafkaConsumer<>(\n+                props, new StringDeserializer(), new StringDeserializer());\n+\n+        // concurrent access is illegal\n+        consumer.currentThread.set(123);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE3NjUxNQ==", "url": "https://github.com/apache/kafka/pull/9349#discussion_r498176515", "bodyText": "will Roger that!", "author": "chia7712", "createdAt": "2020-10-01T11:36:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY4MTM5NQ=="}], "type": "inlineReview"}, {"oid": "031070aa8b99721f0c65050e8a05e4b05ea94733", "url": "https://github.com/apache/kafka/commit/031070aa8b99721f0c65050e8a05e4b05ea94733", "message": "MINOR: add proper checks to KafkaConsumer.groupMetadata", "committedDate": "2020-10-01T10:51:32Z", "type": "commit"}, {"oid": "52fb914eda91dfdc1f52d1b6b4eeeef0f9f65741", "url": "https://github.com/apache/kafka/commit/52fb914eda91dfdc1f52d1b6b4eeeef0f9f65741", "message": "improve unit test", "committedDate": "2020-10-01T11:35:59Z", "type": "commit"}, {"oid": "52fb914eda91dfdc1f52d1b6b4eeeef0f9f65741", "url": "https://github.com/apache/kafka/commit/52fb914eda91dfdc1f52d1b6b4eeeef0f9f65741", "message": "improve unit test", "committedDate": "2020-10-01T11:35:59Z", "type": "forcePushed"}]}