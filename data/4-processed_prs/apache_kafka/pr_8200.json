{"pr_number": 8200, "pr_title": "KAFKA-5876: IQ should throw different exceptions for different errors(part 1)", "pr_createdAt": "2020-03-02T13:59:10Z", "pr_url": "https://github.com/apache/kafka/pull/8200", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njc0Mzg4Ng==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r386743886", "bodyText": "I guess here should not a exception about invalid partition and not sure which type of InvalidStateStoreException we should use. Using InvalidStateStorePartitionException here maybe not a correct choice.\nAny comment?", "author": "vitojeng", "createdAt": "2020-03-03T01:06:03Z", "path": "streams/src/main/java/org/apache/kafka/streams/state/internals/StreamThreadStateStoreProvider.java", "diffHunk": "@@ -119,7 +121,7 @@ private TaskId createKeyTaskId(final String storeName, final Integer partition)\n                 return new TaskId(topicGroup.getKey(), partition);\n             }\n         }\n-        throw new InvalidStateStoreException(\"Cannot get state store \" + storeName + \" because the requested partition \" +\n+        throw new InvalidStateStorePartitionException(\"Cannot get state store \" + storeName + \" because the requested partition \" +", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0ODQ0OQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438348449", "bodyText": "If we are not gonna use this class at all to throw exceptions, is there any need for it?\nDoesn't look like it is solving any extra purpose than StreamsException. Can we directly extend StreamsException in the subclasses which are extending this class?", "author": "brary", "createdAt": "2020-06-10T19:08:27Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/InvalidStateStoreException.java", "diffHunk": "@@ -18,13 +18,11 @@\n \n \n /**\n- * Indicates that there was a problem when trying to access a\n- * {@link org.apache.kafka.streams.processor.StateStore StateStore}, i.e, the Store is no longer valid because it is\n- * closed or doesn't exist any more due to a rebalance.\n- * <p>\n- * These exceptions may be transient, i.e., during a rebalance it won't be possible to query the stores as they are\n- * being (re)-initialized. Once the rebalance has completed the stores will be available again. Hence, it is valid\n- * to backoff and retry when handling this exception.\n+ * <p>Indicates that there was a problem when trying to access a {@link org.apache.kafka.streams.processor.StateStore StateStore}.\n+ * InvalidStateStoreException not thrown directly but only following sub-classes:</p>\n+ * {@link StreamsNotStartedException}, {@link StreamsRebalancingException},\n+ * {@link StateStoreMigratedException}, {@link StateStoreNotAvailableException},\n+ * {@link UnknownStateStoreException}, {@link InvalidStateStorePartitionException}\n  */\n public class InvalidStateStoreException extends StreamsException {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ3ODQwMg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438478402", "bodyText": "@brary Thanks for reviewing. In KIP-216, the main purpose of keeping InvalidStateStoreException is to keep compatibility, this should be important to users. Your suggestion still valuable, we can do it in the future.", "author": "vitojeng", "createdAt": "2020-06-11T00:29:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0ODQ0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUzMTU5OQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438531599", "bodyText": "Sure @vitojeng . cc @mjsax", "author": "brary", "createdAt": "2020-06-11T04:09:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0ODQ0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1MDc1NQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438350755", "bodyText": "\"Indicates that the specific state store being queried via StoreQueryParams used an invalid partition\"?\nDoes this sound better?", "author": "brary", "createdAt": "2020-06-10T19:13:00Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/InvalidStateStorePartitionException.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a state store from Kafka Streams by invalid partition.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ3OTg5OA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438479898", "bodyText": "Looks great!\nBTW, I would use StoreQueryParameters instead of StoreQueryParams. :)", "author": "vitojeng", "createdAt": "2020-06-11T00:34:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1MDc1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1NDA3Ng==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438354076", "bodyText": "Indicates that the state store being queried is closed although the Kafka Streams state is\n{@link org.apache.kafka.streams.KafkaStreams.State#RUNNING RUNNING} or\n{@link org.apache.kafka.streams.KafkaStreams.State#REBALANCING REBALANCING}.\nIt could happen because the partition moved to some other instance during a rebalance so\nrediscovery of the state store is required before retrying.", "author": "brary", "createdAt": "2020-06-10T19:19:23Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StateStoreMigratedException.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a closed state store when Kafka Streams state is", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ4NDAxOA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438484018", "bodyText": "Copy that", "author": "vitojeng", "createdAt": "2020-06-11T00:51:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1NDA3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1NTM1Nw==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438355357", "bodyText": "*Indicates that the state store being queried is already closed. It could happen when Kafka Streams is in\n\n{@link org.apache.kafka.streams.KafkaStreams.State#PENDING_SHUTDOWN PENDING_SHUTDOWN} or\n{@link org.apache.kafka.streams.KafkaStreams.State#NOT_RUNNING NOT_RUNNING} or\n{@link org.apache.kafka.streams.KafkaStreams.State#ERROR ERROR} state.", "author": "brary", "createdAt": "2020-06-10T19:21:50Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StateStoreNotAvailableException.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a closed state store when Kafka Streams state is", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ4NDI1OQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438484259", "bodyText": "Copy that.", "author": "vitojeng", "createdAt": "2020-06-11T00:52:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM1NTM1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM2MTAxNA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438361014", "bodyText": "Indicates that the state store being queried is invalid. Hence, it will be futile to retry again.", "author": "brary", "createdAt": "2020-06-10T19:33:07Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/UnknownStateStoreException.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a unknown state store from Kafka Streams.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ4NDQyOQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r438484429", "bodyText": "Copy that.", "author": "vitojeng", "createdAt": "2020-06-11T00:52:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM2MTAxNA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyMDczMg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456620732", "bodyText": "nit: JavaDocs does support HTML, but <p> is actually not HTML but a JavaDoc annotation and the closing tag </p> is not required. In fact, we only have a single paragraph and thus don't need any tags at all.\nInvalidStateStoreException -> {@code InvalidStateStoreException}\n...but only it subclasses.\nI would not list the sub-classes because the JavaDocs will link to them automatically. Also, if we add new sub-classes in the future, I am sure we would forget to update the JavaDocs here. If we don' list them, we can't forget to update as there is nothing to be updated. :)", "author": "mjsax", "createdAt": "2020-07-17T18:58:08Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/InvalidStateStoreException.java", "diffHunk": "@@ -18,13 +18,11 @@\n \n \n /**\n- * Indicates that there was a problem when trying to access a\n- * {@link org.apache.kafka.streams.processor.StateStore StateStore}, i.e, the Store is no longer valid because it is\n- * closed or doesn't exist any more due to a rebalance.\n- * <p>\n- * These exceptions may be transient, i.e., during a rebalance it won't be possible to query the stores as they are\n- * being (re)-initialized. Once the rebalance has completed the stores will be available again. Hence, it is valid\n- * to backoff and retry when handling this exception.\n+ * <p>Indicates that there was a problem when trying to access a {@link org.apache.kafka.streams.processor.StateStore StateStore}.\n+ * InvalidStateStoreException not thrown directly but only following sub-classes:</p>", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0NTIxMA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456745210", "bodyText": "Got it!", "author": "vitojeng", "createdAt": "2020-07-18T03:59:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyMDczMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyMzQ4Mw==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456623483", "bodyText": "It's a little bit unclear what \"invalid\" means. Maybe better:\n...used a partitioning that is not assigned to this instance. You can use {@link KafkaStreams#allMetadata()} to discover the correct instance that hosts the requested partition.", "author": "mjsax", "createdAt": "2020-07-17T19:03:58Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/InvalidStateStorePartitionException.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicates that the specific state store being queried via\n+ * {@link org.apache.kafka.streams.StoreQueryParameters} used an invalid partition.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMjAyNA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456802024", "bodyText": "copy that", "author": "vitojeng", "createdAt": "2020-07-18T15:48:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyMzQ4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNDA0OQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456624049", "bodyText": "It -> This\npartition -> store ?", "author": "mjsax", "createdAt": "2020-07-17T19:05:10Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StateStoreMigratedException.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicates that the state store being queried is closed although the Kafka Streams state is\n+ * {@link org.apache.kafka.streams.KafkaStreams.State#RUNNING RUNNING} or\n+ * {@link org.apache.kafka.streams.KafkaStreams.State#REBALANCING REBALANCING}.\n+ * It could happen because the partition moved to some other instance during a rebalance so", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0NTc2Ng==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456745766", "bodyText": "Nice catch. It's my bad... :(", "author": "vitojeng", "createdAt": "2020-07-18T04:05:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNDA0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNjU4Mg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456626582", "bodyText": "To query state stores, it's required to first start Kafka Streams via {@link KafkaStreams#start()}. You can retry to query the state after the state transitioned to ...", "author": "mjsax", "createdAt": "2020-07-17T19:10:53Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StreamsNotStartedException.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a state store when Kafka Streams state is {@link org.apache.kafka.streams.KafkaStreams.State#CREATED CREATED}.\n+ * User can just retry and wait until to {@link org.apache.kafka.streams.KafkaStreams.State#RUNNING RUNNING}", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMDc2Nw==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456800767", "bodyText": "copy that", "author": "vitojeng", "createdAt": "2020-07-18T15:33:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNjU4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNzE5NQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456627195", "bodyText": "It -> This", "author": "mjsax", "createdAt": "2020-07-17T19:12:19Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StateStoreNotAvailableException.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicates that the state store being queried is already closed. It could happen when Kafka Streams is in", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMDc3Mg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456800772", "bodyText": "copy that", "author": "vitojeng", "createdAt": "2020-07-18T15:33:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNzE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNzgwMA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456627800", "bodyText": "Indicate[s] that Kafka Streams is in state {@link org.apache.kafka.streams.KafkaStreams.State#CREATED CREATED} and thus state stores cannot be queries yet.", "author": "mjsax", "createdAt": "2020-07-17T19:13:49Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StreamsNotStartedException.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a state store when Kafka Streams state is {@link org.apache.kafka.streams.KafkaStreams.State#CREATED CREATED}.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMDc5MQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456800791", "bodyText": "copy that", "author": "vitojeng", "createdAt": "2020-07-18T15:33:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYyNzgwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYzMDU5Mg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456630592", "bodyText": "Indicate[s] that Kafka Streams is in state {@link org.apache.kafka.streams.KafkaStreams.State#REBALANCING REBALANCING} and thus cannot be queried by default. You can retry to query after the rebalance finished. As an alternative, you can also query (potentially stale) state stores during a rebalance via {@link StoreQueryParameters#enableStaleStores()}.", "author": "mjsax", "createdAt": "2020-07-17T19:20:15Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StreamsRebalancingException.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicate query a state store and stream thread state is not running when Kafka Streams state is", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMDgwMg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456800802", "bodyText": "copy that", "author": "vitojeng", "createdAt": "2020-07-18T15:33:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYzMDU5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYzMTM5Nw==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456631397", "bodyText": "invalid -> unknown, i.e., the state store does either not exist in your topology or it is not queryable.\nI would remove Hence, it will be futile to retry again.", "author": "mjsax", "createdAt": "2020-07-17T19:22:18Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/UnknownStateStoreException.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+/**\n+ * Indicates that the state store being queried is invalid. Hence, it will be futile to retry again.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwMDgxNg==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r456800816", "bodyText": "copy that", "author": "vitojeng", "createdAt": "2020-07-18T15:34:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjYzMTM5Nw=="}], "type": "inlineReview"}, {"oid": "12ae09000a8ff0ed3e5a7dd4e47b41b5560544a1", "url": "https://github.com/apache/kafka/commit/12ae09000a8ff0ed3e5a7dd4e47b41b5560544a1", "message": "KAFKA-5876: IQ should throw different exceptions for different errors(part 1)\n\nAdd new sub-classes of InvalidStateStoreException", "committedDate": "2020-07-18T15:17:39Z", "type": "commit"}, {"oid": "f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "url": "https://github.com/apache/kafka/commit/f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "message": "address comments", "committedDate": "2020-07-18T15:24:46Z", "type": "commit"}, {"oid": "f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "url": "https://github.com/apache/kafka/commit/f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "message": "address comments", "committedDate": "2020-07-18T15:24:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1MTYxMA==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r457751610", "bodyText": "Nit: we don't need the <p> tag because there is only one paragraph.", "author": "mjsax", "createdAt": "2020-07-20T23:40:51Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/InvalidStateStoreException.java", "diffHunk": "@@ -18,13 +18,8 @@\n \n \n /**\n- * Indicates that there was a problem when trying to access a\n- * {@link org.apache.kafka.streams.processor.StateStore StateStore}, i.e, the Store is no longer valid because it is\n- * closed or doesn't exist any more due to a rebalance.\n- * <p>\n- * These exceptions may be transient, i.e., during a rebalance it won't be possible to query the stores as they are\n- * being (re)-initialized. Once the rebalance has completed the stores will be available again. Hence, it is valid\n- * to backoff and retry when handling this exception.\n+ * <p>Indicates that there was a problem when trying to access a {@link org.apache.kafka.streams.processor.StateStore StateStore}.", "originalCommit": "f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1MTgyMQ==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r457751821", "bodyText": "Nit: Note that {@code InvalidStateStoreException} [is] not thrown directly but only [its] sub-classes.", "author": "mjsax", "createdAt": "2020-07-20T23:41:30Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/InvalidStateStoreException.java", "diffHunk": "@@ -18,13 +18,8 @@\n \n \n /**\n- * Indicates that there was a problem when trying to access a\n- * {@link org.apache.kafka.streams.processor.StateStore StateStore}, i.e, the Store is no longer valid because it is\n- * closed or doesn't exist any more due to a rebalance.\n- * <p>\n- * These exceptions may be transient, i.e., during a rebalance it won't be possible to query the stores as they are\n- * being (re)-initialized. Once the rebalance has completed the stores will be available again. Hence, it is valid\n- * to backoff and retry when handling this exception.\n+ * <p>Indicates that there was a problem when trying to access a {@link org.apache.kafka.streams.processor.StateStore StateStore}.\n+ * {@code InvalidStateStoreException} not thrown directly but only following sub-classes.", "originalCommit": "f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1MjE5Mw==", "url": "https://github.com/apache/kafka/pull/8200#discussion_r457752193", "bodyText": "typo to to\n(also missing . at the end of the sentence)", "author": "mjsax", "createdAt": "2020-07-20T23:42:52Z", "path": "streams/src/main/java/org/apache/kafka/streams/errors/StreamsNotStartedException.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.errors;\n+\n+import org.apache.kafka.streams.KafkaStreams;\n+\n+/**\n+ * Indicates that Kafka Streams is in state {@link KafkaStreams.State#CREATED CREATED} and thus state stores cannot be queries yet.\n+ * To query state stores, it's required to first start Kafka Streams via {@link KafkaStreams#start()}.\n+ * You can retry to query the state after the state transitioned to to {@link KafkaStreams.State#RUNNING RUNNING}", "originalCommit": "f3136d4c3bf74c09c039ae4df2cc070ebb743a09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6cf8ee4017df723614875ff131eedb5aa5a4cb14", "url": "https://github.com/apache/kafka/commit/6cf8ee4017df723614875ff131eedb5aa5a4cb14", "message": "address comments", "committedDate": "2020-07-21T05:30:17Z", "type": "commit"}]}