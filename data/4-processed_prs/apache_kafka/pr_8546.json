{"pr_number": 8546, "pr_title": "MINOR: document how to escape json parameters to ducktape tests", "pr_createdAt": "2020-04-24T21:04:08Z", "pr_url": "https://github.com/apache/kafka/pull/8546", "timeline": [{"oid": "9aa835dfdc8266fc8b682293675493f8fd4865d8", "url": "https://github.com/apache/kafka/commit/9aa835dfdc8266fc8b682293675493f8fd4865d8", "message": "MINOR: document how to escape json parameters to ducktape tests", "committedDate": "2020-04-24T21:01:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg3ODUxMg==", "url": "https://github.com/apache/kafka/pull/8546#discussion_r414878512", "bodyText": "Great example. Wondering if it is correct?\n--parameters '\\''\n\nShould this be\n--parameters '\\'\n\nbecause that the end there is '\\'", "author": "mjsax", "createdAt": "2020-04-24T21:39:07Z", "path": "tests/README.md", "diffHunk": "@@ -36,6 +36,10 @@ TC_PATHS=\"tests/kafkatest/tests/client/pluggable_test.py::PluggableConsumerTest\"\n ```\n TC_PATHS=\"tests/kafkatest/tests/client/pluggable_test.py::PluggableConsumerTest.test_start_stop\" bash tests/docker/run_tests.sh\n ```\n+* Run a specific test method with specific parameters\n+```\n+TC_PATHS=\"tests/kafkatest/tests/streams/streams_upgrade_test.py::StreamsUpgradeTest.test_metadata_upgrade\" _DUCKTAPE_OPTIONS='--parameters '\\''{\"from_version\":\"0.10.1.1\",\"to_version\":\"2.6.0-SNAPSHOT\"}'\\' bash tests/docker/run_tests.sh", "originalCommit": "9aa835dfdc8266fc8b682293675493f8fd4865d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg5NzE2MQ==", "url": "https://github.com/apache/kafka/pull/8546#discussion_r414897161", "bodyText": "Haha, having just spent several hours settling on this exact sequence of characters, I can certify that it's correct ;)\nActually, I would like to get at least one other person to try it out. Do you mind?\nTo answer your question, here's how it works:\nfirst string (wrapped in single quotes for consistency with the second string): --parameters \nfirst escaped single quote: \\'\nsecond string (wrapped in single quotes to avoid evaluating the special characters): {\"from_version\":\"0.10.1.1\",\"to_version\":\"2.6.0-SNAPSHOT\"}\nsecond escaped single quote: \\'\nFollowing Bash rules, a sequence of strings and characters just get concatenated, so all of the above gets smashed together to form the desired final string:\n--parameters '{\"from_version\":\"0.10.1.1\",\"to_version\":\"2.6.0-SNAPSHOT\"}'\nwhich will then be evaluated again by Bash inside the docker container, so that the final argument to ducktape is the desired argument list: --parameters, followed by {\"from_version\":\"0.10.1.1\",\"to_version\":\"2.6.0-SNAPSHOT\"}.", "author": "vvcephei", "createdAt": "2020-04-24T22:26:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg3ODUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk5NDM4NQ==", "url": "https://github.com/apache/kafka/pull/8546#discussion_r415994385", "bodyText": "I tried it out on Friday but left it running and forgot to report back. It passed for me \ud83d\udc4d", "author": "ableegoldman", "createdAt": "2020-04-27T17:10:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg3ODUxMg=="}], "type": "inlineReview"}]}