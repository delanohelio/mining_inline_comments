{"pr_number": 8048, "pr_title": "KAFKA-9509: Fixing flakiness of MirrorConnectorsIntegrationTest.testReplication", "pr_createdAt": "2020-02-05T21:59:24Z", "pr_url": "https://github.com/apache/kafka/pull/8048", "timeline": [{"oid": "353f550377fe76f60eec1fa59b9d47cd0477b8d5", "url": "https://github.com/apache/kafka/commit/353f550377fe76f60eec1fa59b9d47cd0477b8d5", "message": "KAFKA-9509: Fixing flaky mm2 integration test", "committedDate": "2020-02-05T21:54:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTIyMA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375539220", "bodyText": "Do we need to do these one at a time or could we start all these connectors together and then wait for them to come up? Does it matter?", "author": "hachikuji", "createdAt": "2020-02-05T22:16:42Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +152,73 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorSourceConnector\");", "originalCommit": "353f550377fe76f60eec1fa59b9d47cd0477b8d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MzM4NQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375543385", "bodyText": "We definitely can start all the connectors together and then wait for them to come up. In either case I don't think it necessarily matters. What I did notice though was that once configureConnector is called, if you hit the REST endpoint that lists all the connectors, it almost immediately lists that connector that was just configured. However, what the bottle neck here seems to be is the actual REST url being served for that specific connector takes a while to come up. Since we have to check if the tasks for each connector are up one at a time, I figured for consistency's sake in the code we could also check for the connector to be up one at time. What do you think is the better way to go here?", "author": "skaundinya15", "createdAt": "2020-02-05T22:26:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTIyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTgwMQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375539801", "bodyText": "If we let this take a set of connector names, we could test them all at once.", "author": "hachikuji", "createdAt": "2020-02-05T22:18:06Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +152,73 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorSourceConnector\");\n \n         backup.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorCheckpointConnector\");\n \n         backup.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorHeartbeatConnector\");\n \n         primary.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorSourceConnector\");\n \n         primary.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorCheckpointConnector\");\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorHeartbeatConnector\");\n+\n+    }\n+\n+    private void waitForConnectorToBeUp(EmbeddedConnectCluster connectCluster, String connName)", "originalCommit": "353f550377fe76f60eec1fa59b9d47cd0477b8d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MzYzMA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375543630", "bodyText": "Yes, this is correct, we could change this to take in a set of connector names, but as I mentioned in my previous comment, I separated it out for consistency sake with checking tasks. However, happy to change it to a set if that makes more sense.", "author": "skaundinya15", "createdAt": "2020-02-05T22:27:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTgwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU2ODA0OQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375568049", "bodyText": "I'm mostly concerned about the time to run tests. If it does not make a substantial difference either way, then we can leave it.", "author": "hachikuji", "createdAt": "2020-02-05T23:33:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTgwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU3ODczNA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375578734", "bodyText": "With the latest code that I pushed, I still check after each connector is configured, however the new method checks both that the connector is up and that the tasks are running as well. Checking that the tasks are running has to be done separately for each connector anyway, which is the main bottleneck in this case. Having this in mind, I think we might not be able to get around checking that the connector and tasks are up individually - what do you think?", "author": "skaundinya15", "createdAt": "2020-02-06T00:10:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTgwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4OTA4Mw==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375589083", "bodyText": "Yes, you have to check each task individually, but nothing prevents you from submitting them all at the same time. I am assuming that any overhead here is really associated with task startup time, so this allows for it to be parallelized.", "author": "hachikuji", "createdAt": "2020-02-06T00:49:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTgwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5MDkwNg==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375590906", "bodyText": "Fair enough, I'll change it to make the submission per connect cluster.", "author": "skaundinya15", "createdAt": "2020-02-06T00:56:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTUzOTgwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDAzMQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375540031", "bodyText": "Could we use TestUtils.waitForCondition? Similarly in waitForTasksToBeUp.", "author": "hachikuji", "createdAt": "2020-02-05T22:18:37Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +152,73 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorSourceConnector\");\n \n         backup.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorCheckpointConnector\");\n \n         backup.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorHeartbeatConnector\");\n \n         primary.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorSourceConnector\");\n \n         primary.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorCheckpointConnector\");\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorHeartbeatConnector\");\n+\n+    }\n+\n+    private void waitForConnectorToBeUp(EmbeddedConnectCluster connectCluster, String connName)\n+        throws InterruptedException {\n+        Collection<String> connectors = connectCluster.connectors();\n+        while (!connectors.contains(connName)) {", "originalCommit": "353f550377fe76f60eec1fa59b9d47cd0477b8d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0NDg0MQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375544841", "bodyText": "Ah I was not aware of TestUtils.waitForCondition. That can definitely be used in this case. I'll make the change.", "author": "skaundinya15", "createdAt": "2020-02-05T22:30:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDAzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDQ4MQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375540481", "bodyText": "I think this could be shorter. We don't want to add unnecessarily to build time. maybe 100ms?", "author": "hachikuji", "createdAt": "2020-02-05T22:19:40Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +152,73 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorSourceConnector\");\n \n         backup.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorCheckpointConnector\");\n \n         backup.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorHeartbeatConnector\");\n \n         primary.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorSourceConnector\");\n \n         primary.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorCheckpointConnector\");\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorHeartbeatConnector\");\n+\n+    }\n+\n+    private void waitForConnectorToBeUp(EmbeddedConnectCluster connectCluster, String connName)\n+        throws InterruptedException {\n+        Collection<String> connectors = connectCluster.connectors();\n+        while (!connectors.contains(connName)) {\n+            // this means the connector hasn't been registered yet in the REST endpoint, so we\n+            // sleep for 3 seconds and try again\n+            Thread.sleep(3_000);", "originalCommit": "353f550377fe76f60eec1fa59b9d47cd0477b8d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0NTY5OQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375545699", "bodyText": "Sure we can definitely do that. After running the test a bunch of times, I found that on average it took about 3 seconds for the tasks to come up, so I tried to optimize for CPU usage (by not constantly hitting the REST endpoint until the tasks were up) instead of build time, but in this case if we don't want to add unnecessarily to build time we can definitely shorten it. With respect to how long we want to sleep, do you think 100ms is good enough to not put a lot of load on the REST endpoint or do you think we could go a bit higher?", "author": "skaundinya15", "createdAt": "2020-02-05T22:32:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDQ4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDY4NQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375540685", "bodyText": "nit: waitForTasksToBeUp -> waitForTasksToStart?", "author": "hachikuji", "createdAt": "2020-02-05T22:20:11Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +152,73 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorSourceConnector\");\n \n         backup.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorCheckpointConnector\");\n \n         backup.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(backup, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(backup, \"MirrorHeartbeatConnector\");\n \n         primary.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorSourceConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorSourceConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorSourceConnector\");\n \n         primary.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorCheckpointConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorCheckpointConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorCheckpointConnector\");\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+        waitForConnectorToBeUp(primary, \"MirrorHeartbeatConnector\");\n+        waitForTasksToBeUp(primary, \"MirrorHeartbeatConnector\");\n+\n+    }\n+\n+    private void waitForConnectorToBeUp(EmbeddedConnectCluster connectCluster, String connName)\n+        throws InterruptedException {\n+        Collection<String> connectors = connectCluster.connectors();\n+        while (!connectors.contains(connName)) {\n+            // this means the connector hasn't been registered yet in the REST endpoint, so we\n+            // sleep for 3 seconds and try again\n+            Thread.sleep(3_000);\n+            connectors = connectCluster.connectors();\n+        }\n+    }\n+\n+    private void waitForTasksToBeUp(EmbeddedConnectCluster connectCluster, String connectorName)", "originalCommit": "353f550377fe76f60eec1fa59b9d47cd0477b8d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0NTg0Ng==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375545846", "bodyText": "That does make it a lot more readable, will make the change.", "author": "skaundinya15", "createdAt": "2020-02-05T22:33:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1MzczNA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375553734", "bodyText": "I'd suggest copying and using what we've been using elsewhere to assert that a connector and its tasks are up and running:\nhttps://github.com/apache/kafka/blob/trunk/connect/runtime/src/test/java/org/apache/kafka/connect/integration/RebalanceSourceConnectorsIntegrationTest.java#L324-L337\nIt works fine with the waitForCondition method that accepts a timeout.\nEventually (maybe soon) this type of assertion will go to EmbeddedConnectCluster and will be made available for every Connect integration test. However, I suggest we don't take on this refactoring now and we just copy the method from the test above.", "author": "kkonstantine", "createdAt": "2020-02-05T22:53:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1OTUzOQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375559539", "bodyText": "Thanks for the suggestion @kkonstantine - this is super useful! I'll incorporate it into the code.", "author": "skaundinya15", "createdAt": "2020-02-05T23:08:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU0MDY4NQ=="}], "type": "inlineReview"}, {"oid": "fc207fb76b2479e861265a33a4fe3138e5582f5a", "url": "https://github.com/apache/kafka/commit/fc207fb76b2479e861265a33a4fe3138e5582f5a", "message": "condesning logic for clarity based on PR comments", "committedDate": "2020-02-05T23:59:15Z", "type": "commit"}, {"oid": "a6d3e754698340627c6882f96cfefb9589d473aa", "url": "https://github.com/apache/kafka/commit/a6d3e754698340627c6882f96cfefb9589d473aa", "message": "removing extra newline", "committedDate": "2020-02-06T00:00:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4MDYzMQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375580631", "bodyText": "If you need to assert that at least numTasks are running, probably it's safer to use >= here. If you are starting more than 1 tasks, these tasks might start fast enough and you might miss your assertion, e.g. the number will go from 0 to 4. Again assuming that your assertion is that at least the connector and 1 task are running.", "author": "kkonstantine", "createdAt": "2020-02-06T00:17:24Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +156,67 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorSourceConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorSourceConnector was up on\"\n+                + \" backup cluster!\");\n \n         backup.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorCheckpointConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorCheckpointConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorCheckpointConnector was up on\"\n+                + \" backup cluster!\");\n \n         backup.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorHeartbeatConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorHeartbeatConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorHeartbeatConnector was up on\"\n+                + \" backup cluster!\");\n \n         primary.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorSourceConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(primary,\n+            \"MirrorSourceConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorSourceConnector was up on\"\n+                + \" primary cluster!\");\n \n         primary.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorCheckpointConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(primary,\n+            \"MirrorCheckpointConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorCheckpointConnector was up on\"\n+                + \" primary cluster!\");\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(primary,\n+            \"MirrorHeartbeatConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorHeartbeatConnector was up on\"\n+                + \" primary cluster!\");\n+    }\n+\n+    private Optional<Boolean> assertConnectorAndTasksRunning(EmbeddedConnectCluster connectCluster,\n+        String connectorName, int numTasks) {\n+        try {\n+            ConnectorStateInfo info = connectCluster.connectorStatus(connectorName);\n+            boolean result = info != null\n+                && info.tasks().size() == numTasks", "originalCommit": "a6d3e754698340627c6882f96cfefb9589d473aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4MTg1OQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375581859", "bodyText": "Ah good point, I think in this case we are trying to assert at least the connector and 1 task are running (when running the tasks I always only saw 1 task running even though max.tasks=10, but I guess with this small volume of messages the Connect framework only spawns 1 task). I'll make the change.", "author": "skaundinya15", "createdAt": "2020-02-06T00:22:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4MDYzMQ=="}], "type": "inlineReview"}, {"oid": "5cff8b1f15813712ae7670ad3a1d549a034ac445", "url": "https://github.com/apache/kafka/commit/5cff8b1f15813712ae7670ad3a1d549a034ac445", "message": "addressing PR comments", "committedDate": "2020-02-06T00:26:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDY1Mg==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375584652", "bodyText": "One more comment that I missed.\nisPresent is not perfectly correct here. You'll need to use orElse(false)\nBasically the idea is that this is successful only if it returns true. But if it's Optional.empty() or false then the assertion is not ready yet.", "author": "kkonstantine", "createdAt": "2020-02-06T00:32:24Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +156,67 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorSourceConnector\", MIN_TASKS).isPresent(),", "originalCommit": "5cff8b1f15813712ae7670ad3a1d549a034ac445", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NjIwOA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375586208", "bodyText": "Just for my understanding, why would isPresent() not work as well as orElse(false)? I thought isPresent() only returns true when there is a value, and false otherwise? Does that not do the same thing as doing orElse(false)? I could definitely be missing something here, but just trying to better understand.", "author": "skaundinya15", "createdAt": "2020-02-06T00:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDY1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NzgyNA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375587824", "bodyText": "This assertion tries to capture 3 cases:\n\nAll good, return Optional.of(true)\nThe boolean logic in the method is false (e.g. tasks are not ready, connector is not ready, an error response was returned etc). Please return Optional.of(false)\nException was thrown and I can't say. Return Optional.empty()\n\nSo based on this, how you'll interpret (3) is up to you on the waitForCondition. And here you want to treat it as false. That's why orElse(false) is more appropriate.", "author": "kkonstantine", "createdAt": "2020-02-06T00:44:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDY1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4ODIyNA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375588224", "bodyText": "Ah okay that makes sense. isPresent() would only cover the Optional.empty() case and would give a false positive if it returned Optional.of(false). orElse(false) would make it wait until it's true. I'll make the change.", "author": "skaundinya15", "createdAt": "2020-02-06T00:46:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDY1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5MjQzNw==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375592437", "bodyText": "After looking at @hachikuji's suggestion, I think it might just be easier (and cleaner) to return the actual boolean instead of an Optional.", "author": "skaundinya15", "createdAt": "2020-02-06T01:01:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDY1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5NTEwMA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375595100", "bodyText": "That's fine. There are cases that you might want to invert the answer that says \"I can't say\". But we haven't finalized the design, that's why this helper method hasn't found its way to the base class yet. Still the goal will be to provide generic methods.\nAs a reference, here's an example of negation of the above with orElse(true):\nhttps://github.com/apache/kafka/blob/trunk/connect/runtime/src/test/java/org/apache/kafka/connect/integration/RebalanceSourceConnectorsIntegrationTest.java#L227\nIt's fine to simplify here. We can change if we ever generalize this checks.", "author": "kkonstantine", "createdAt": "2020-02-06T01:11:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDY1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4ODgxNA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375588814", "bodyText": "Unless I'm missing something, we are not actually using the boolean value anywhere. All we do is check if the optional is present. Would it be simpler to just return the boolean directly?\nalso nit: having assert in the name is misleading since there are no assertions. I would suggest isConnectorAndTasksRunning or checkConnectorAndTasksRunning", "author": "hachikuji", "createdAt": "2020-02-06T00:48:25Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -150,23 +156,67 @@ public void setup() throws IOException {\n         mm2Props.put(\"backup.bootstrap.servers\", backup.kafka().bootstrapServers());\n         mm2Config = new MirrorMakerConfig(mm2Props);\n \n+        // we wait for the connector and tasks to come up for each connector, so that when we do the\n+        // actual testing, we are certain that the tasks are up and running; this will prevent\n+        // flaky tests where the connector and tasks didn't start up in time for the tests to be\n+        // run\n         backup.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorSourceConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorSourceConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorSourceConnector was up on\"\n+                + \" backup cluster!\");\n \n         backup.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorCheckpointConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorCheckpointConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorCheckpointConnector was up on\"\n+                + \" backup cluster!\");\n \n         backup.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"primary\", \"backup\"),\n             MirrorHeartbeatConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup,\n+            \"MirrorHeartbeatConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorHeartbeatConnector was up on\"\n+                + \" backup cluster!\");\n \n         primary.configureConnector(\"MirrorSourceConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorSourceConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(primary,\n+            \"MirrorSourceConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorSourceConnector was up on\"\n+                + \" primary cluster!\");\n \n         primary.configureConnector(\"MirrorCheckpointConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorCheckpointConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(primary,\n+            \"MirrorCheckpointConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorCheckpointConnector was up on\"\n+                + \" primary cluster!\");\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+        TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(primary,\n+            \"MirrorHeartbeatConnector\", MIN_TASKS).isPresent(),\n+            \"Timed out trying to verify connector MirrorHeartbeatConnector was up on\"\n+                + \" primary cluster!\");\n+    }\n+\n+    private Optional<Boolean> assertConnectorAndTasksRunning(EmbeddedConnectCluster connectCluster,", "originalCommit": "5cff8b1f15813712ae7670ad3a1d549a034ac445", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5MDY4NA==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375590684", "bodyText": "I'll change the method name to isConnectorAndTasksRunning. With respect to the boolean value, As @kkonstantine mentioned, the condition to be checking should be TestUtils.waitForCondition(() -> assertConnectorAndTasksRunning(backup, \"MirrorHeartbeatConnector\", MIN_TASKS).orElse(false)\nHowever, to your point, I think it might just be simpler and more readable to return the actual boolean instead of an Optional. I'll make that change.", "author": "skaundinya15", "createdAt": "2020-02-06T00:55:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4ODgxNA=="}], "type": "inlineReview"}, {"oid": "4f120fc774ad03ac0463d7d2d737d6807a634d3f", "url": "https://github.com/apache/kafka/commit/4f120fc774ad03ac0463d7d2d737d6807a634d3f", "message": "addressing PR comments", "committedDate": "2020-02-06T01:17:05Z", "type": "commit"}, {"oid": "a2d9431335c479054b4cd1b4b27658e32323e073", "url": "https://github.com/apache/kafka/commit/a2d9431335c479054b4cd1b4b27658e32323e073", "message": "Merge branch 'trunk' into KAFKA-9509", "committedDate": "2020-02-06T01:27:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5ODQ4Mg==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375598482", "bodyText": "nit: can we make this debug level? Otherwise it will make this test a little spammy.", "author": "hachikuji", "createdAt": "2020-02-06T01:25:04Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -167,6 +182,35 @@ public void setup() throws IOException {\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+\n+        waitUntilMirrorMakerIsRunning(primary, connectorNames);\n+    }\n+\n+\n+    private void waitUntilMirrorMakerIsRunning(EmbeddedConnectCluster connectCluster,\n+        Set<String> connNames) throws InterruptedException {\n+        for (String connector : connNames) {\n+            TestUtils.waitForCondition(() -> areConnectorAndTasksRunning(connectCluster,\n+                connector, MIN_TASKS), \"Timed out trying to verify connector \" +\n+                connector + \" was up!\" );\n+        }\n+\n+    }\n+\n+    private boolean areConnectorAndTasksRunning(EmbeddedConnectCluster connectCluster,\n+        String connectorName, int numTasks) {\n+        try {\n+            ConnectorStateInfo info = connectCluster.connectorStatus(connectorName);\n+            boolean result = info != null\n+                && info.tasks().size() >= numTasks\n+                && info.connector().state().equals(AbstractStatus.State.RUNNING.toString())\n+                && info.tasks().stream().allMatch(s -> s.state().equals(AbstractStatus.State.RUNNING.toString()));\n+            log.info(\"Found connector and tasks running: {}\", result);", "originalCommit": "4f120fc774ad03ac0463d7d2d737d6807a634d3f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5OTQ2MQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375599461", "bodyText": "Sure, will make it debug.", "author": "skaundinya15", "createdAt": "2020-02-06T01:29:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5ODQ4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5ODg1OQ==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375598859", "bodyText": "nit: do we need the numTasks argument since the only caller is passing MIN_TASKS? Alternatively, we could replace info.tasks().size() >= numTasks with !info.tasks().isEmpty() and get rid of MIN_TASKS.", "author": "hachikuji", "createdAt": "2020-02-06T01:26:35Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -167,6 +182,35 @@ public void setup() throws IOException {\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+\n+        waitUntilMirrorMakerIsRunning(primary, connectorNames);\n+    }\n+\n+\n+    private void waitUntilMirrorMakerIsRunning(EmbeddedConnectCluster connectCluster,\n+        Set<String> connNames) throws InterruptedException {\n+        for (String connector : connNames) {\n+            TestUtils.waitForCondition(() -> areConnectorAndTasksRunning(connectCluster,\n+                connector, MIN_TASKS), \"Timed out trying to verify connector \" +\n+                connector + \" was up!\" );\n+        }\n+\n+    }\n+\n+    private boolean areConnectorAndTasksRunning(EmbeddedConnectCluster connectCluster,\n+        String connectorName, int numTasks) {", "originalCommit": "4f120fc774ad03ac0463d7d2d737d6807a634d3f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5OTU0Ng==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375599546", "bodyText": "That's a good idea, I'll replace it with !info.tasks().isEmpty() and get rid of MIN_TASKS.", "author": "skaundinya15", "createdAt": "2020-02-06T01:29:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5ODg1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5OTI1Ng==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375599256", "bodyText": "nit: unneeded newline", "author": "hachikuji", "createdAt": "2020-02-06T01:28:22Z", "path": "connect/mirror/src/test/java/org/apache/kafka/connect/mirror/MirrorConnectorsIntegrationTest.java", "diffHunk": "@@ -167,6 +182,35 @@ public void setup() throws IOException {\n \n         primary.configureConnector(\"MirrorHeartbeatConnector\", mm2Config.connectorBaseConfig(new SourceAndTarget(\"backup\", \"primary\"),\n             MirrorHeartbeatConnector.class));\n+\n+        waitUntilMirrorMakerIsRunning(primary, connectorNames);\n+    }\n+\n+\n+    private void waitUntilMirrorMakerIsRunning(EmbeddedConnectCluster connectCluster,\n+        Set<String> connNames) throws InterruptedException {\n+        for (String connector : connNames) {\n+            TestUtils.waitForCondition(() -> areConnectorAndTasksRunning(connectCluster,\n+                connector, MIN_TASKS), \"Timed out trying to verify connector \" +\n+                connector + \" was up!\" );\n+        }\n+", "originalCommit": "4f120fc774ad03ac0463d7d2d737d6807a634d3f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5OTU3Mw==", "url": "https://github.com/apache/kafka/pull/8048#discussion_r375599573", "bodyText": "Will remove it.", "author": "skaundinya15", "createdAt": "2020-02-06T01:29:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU5OTI1Ng=="}], "type": "inlineReview"}, {"oid": "bc23aae47230a82fbad0f00be5cf8ad1422a0edc", "url": "https://github.com/apache/kafka/commit/bc23aae47230a82fbad0f00be5cf8ad1422a0edc", "message": "addressing PR comments", "committedDate": "2020-02-06T01:37:51Z", "type": "commit"}, {"oid": "7f0d2f5409f3cfcfc9b819962150a0fc2213ce35", "url": "https://github.com/apache/kafka/commit/7f0d2f5409f3cfcfc9b819962150a0fc2213ce35", "message": "fixing checkstyle issues", "committedDate": "2020-02-06T17:35:22Z", "type": "commit"}]}