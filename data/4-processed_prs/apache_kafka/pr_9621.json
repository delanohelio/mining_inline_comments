{"pr_number": 9621, "pr_title": "KAFKA-9892: Producer state snapshot needs to be forced to disk", "pr_createdAt": "2020-11-19T11:16:49Z", "pr_url": "https://github.com/apache/kafka/pull/9621", "timeline": [{"oid": "86bdedb21a56c9be1d30e4d10393ec8319b1ae04", "url": "https://github.com/apache/kafka/commit/86bdedb21a56c9be1d30e4d10393ec8319b1ae04", "message": "Forcing producer snapshot to write on disk. #KAFKA-9892", "committedDate": "2020-11-19T11:05:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNTI1Mg==", "url": "https://github.com/apache/kafka/pull/9621#discussion_r527105252", "bodyText": "I think we need to do force and then close.", "author": "junrao", "createdAt": "2020-11-19T18:25:44Z", "path": "core/src/main/scala/kafka/log/ProducerStateManager.scala", "diffHunk": "@@ -437,7 +437,7 @@ object ProducerStateManager {\n \n     val fileChannel = FileChannel.open(file.toPath, StandardOpenOption.CREATE, StandardOpenOption.WRITE)\n     try fileChannel.write(buffer)\n-    finally fileChannel.close()\n+    finally fileChannel.force(true)", "originalCommit": "86bdedb21a56c9be1d30e4d10393ec8319b1ae04", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU2MjYwNw==", "url": "https://github.com/apache/kafka/pull/9621#discussion_r539562607", "bodyText": "Fixed. Please check", "author": "bristy", "createdAt": "2020-12-09T18:53:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEwNTI1Mg=="}], "type": "inlineReview"}, {"oid": "9ced3d0d9c2956aa8d433d1eff8f2482f3dee330", "url": "https://github.com/apache/kafka/commit/9ced3d0d9c2956aa8d433d1eff8f2482f3dee330", "message": "Addressed CR comments", "committedDate": "2020-12-09T18:52:57Z", "type": "commit"}]}