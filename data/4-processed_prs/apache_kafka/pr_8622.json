{"pr_number": 8622, "pr_title": "MINOR: Update stream documentation", "pr_createdAt": "2020-05-06T03:27:09Z", "pr_url": "https://github.com/apache/kafka/pull/8622", "timeline": [{"oid": "e0cab36313b5ac4235804fedd3c4b9430454687f", "url": "https://github.com/apache/kafka/commit/e0cab36313b5ac4235804fedd3c4b9430454687f", "message": "update stream documentation\n\n1. fix broken links\n2. rephrase a sentence\n3. update the version number", "committedDate": "2020-05-06T03:23:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNjIzNw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r420526237", "bodyText": "2.4 is now the possible old version value", "author": "showuon", "createdAt": "2020-05-06T03:28:48Z", "path": "docs/streams/upgrade-guide.html", "diffHunk": "@@ -35,7 +35,7 @@ <h1>Upgrade Guide and API Changes</h1>\n \n     <p>\n         Upgrading from any older version to {{fullDotVersion}} is possible: you will need to do two rolling bounces, where during the first rolling bounce phase you set the config <code>upgrade.from=\"older version\"</code>\n-        (possible values are <code>\"0.10.0\" - \"2.3\"</code>) and during the second you remove it. This is required to safely upgrade to the new cooperative rebalancing protocol of the embedded consumer. Note that you will remain using the old eager\n+        (possible values are <code>\"0.10.0\" - \"2.4\"</code>) and during the second you remove it. This is required to safely upgrade to the new cooperative rebalancing protocol of the embedded consumer. Note that you will remain using the old eager", "originalCommit": "e0cab36313b5ac4235804fedd3c4b9430454687f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEyMTc0Mw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r426121743", "bodyText": "I think 2.4 already launches the incremental rebalancing, cc @ableegoldman", "author": "abbccdda", "createdAt": "2020-05-16T05:46:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNjIzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE2MzY1Mw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r426163653", "bodyText": "I think this change is ok as it describes the rolling upgrades from an older version. But we should @ableegoldman to confirm.", "author": "bbejeck", "createdAt": "2020-05-16T15:29:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNjIzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwODQzMQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r426808431", "bodyText": "@showuon Boyang is right, there is no upgrade.from config for 2.4 since that's when cooperative rebalancing was enabled. So if you upgrade to 2.5 from any version lower than 2.4, you will need to go through this upgrade path and set the config.", "author": "ableegoldman", "createdAt": "2020-05-18T18:12:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNjIzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTkzMw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427009933", "bodyText": "Thank you, @ableegoldman @abbccdda @bbejeck , I've reverted back this version to 2.3 now in this commit 460768e. Thank you very much!", "author": "showuon", "createdAt": "2020-05-19T03:32:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNjIzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNjU4MQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r420526581", "bodyText": "Rephrase this sentence.\nBefore: We refer to the developer guide for more details.\nAfter: Please refer to the developer guide for more details.", "author": "showuon", "createdAt": "2020-05-06T03:30:25Z", "path": "docs/streams/upgrade-guide.html", "diffHunk": "@@ -77,7 +77,7 @@ <h3><a id=\"streams_api_changes_250\" href=\"#streams_api_changes_250\">Streams API\n         We add a new <code>cogroup()</code> operator (via <a href=\"https://cwiki.apache.org/confluence/display/KAFKA/KIP-150+-+Kafka-Streams+Cogroup\">KIP-150</a>>)\n         that allows to aggregate multiple streams in a single operation.\n         Cogrouped streams can also be windowed before they are aggregated.\n-        We refer to the <a href=\"/{{version}}/documentation/streams/developer-guide/dsl-api.html\">developer guide</a> for more details.\n+        Please refer to the <a href=\"/{{version}}/documentation/streams/developer-guide/dsl-api.html\">developer guide</a> for more details.", "originalCommit": "e0cab36313b5ac4235804fedd3c4b9430454687f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUyNzAyMQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r420527021", "bodyText": "#kafka_streams_monitoring is located in /documentation, not the current path (i.e. documentation/streams/upgrade-guide)", "author": "showuon", "createdAt": "2020-05-06T03:32:16Z", "path": "docs/streams/upgrade-guide.html", "diffHunk": "@@ -688,7 +688,7 @@ <h3><a id=\"streams_api_changes_100\" href=\"#streams_api_changes_100\">Streams API\n         If you are monitoring on task level or processor-node / state store level Streams metrics, please note that the metrics sensor name and hierarchy was changed:\n         The task ids, store names and processor names are no longer in the sensor metrics names, but instead are added as tags of the sensors to achieve consistent metrics hierarchy.\n         As a result you may need to make corresponding code changes on your metrics reporting and monitoring tools when upgrading to 1.0.0.\n-        Detailed metrics sensor can be found in the <a href=\"#kafka_streams_monitoring\">Streams Monitoring</a> section.\n+        Detailed metrics sensor can be found in the <a href=\"/{{version}}/documentation/#kafka_streams_monitoring\">Streams Monitoring</a> section.", "originalCommit": "e0cab36313b5ac4235804fedd3c4b9430454687f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c0e3a971d2e21d9a0f552344cf6f6b19c6180215", "url": "https://github.com/apache/kafka/commit/c0e3a971d2e21d9a0f552344cf6f6b19c6180215", "message": "Merge branch 'trunk' of https://github.com/apache/kafka into stream_doc_update", "committedDate": "2020-05-14T10:45:19Z", "type": "commit"}, {"oid": "3165ae7c1c2e9fb385b8c3c84f6daff8be9ebfc0", "url": "https://github.com/apache/kafka/commit/3165ae7c1c2e9fb385b8c3c84f6daff8be9ebfc0", "message": "fix broken links and HTML format error", "committedDate": "2020-05-14T11:00:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTA1NDI5Nw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r425054297", "bodyText": "Currently, the TESTING A STREAMS APPLICATION header is in blue, which is different from others. Turns out that it's because we put <h2> tag inside <a>, and cause to apply the wrong css format.", "author": "showuon", "createdAt": "2020-05-14T11:06:17Z", "path": "docs/streams/developer-guide/dsl-api.html", "diffHunk": "@@ -3738,7 +3738,7 @@ <h5><a class=\"toc-backref\" href=\"#id34\">KTable-KTable Foreign-Key\n             </div>\n         </div>\n         <div class=\"section\" id=\"testing-a-streams-app\">\n-            <a class=\"headerlink\" href=\"#testing-a-streams-app\" title=\"Permalink to this headline\"><h2>Testing a Streams application</h2></a>\n+            <h2><a class=\"headerlink\" href=\"#testing-a-streams-app\" title=\"Permalink to this headline\">Testing a Streams application</a></h2>", "originalCommit": "3165ae7c1c2e9fb385b8c3c84f6daff8be9ebfc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTA1NDcxMQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r425054711", "bodyText": "fix the broken link from wrong href=\"../architecture.html#streams-architecture-threads\" to href=\"../architecture.html#streams_architecture_threads\" (the one with underscore)", "author": "showuon", "createdAt": "2020-05-14T11:07:05Z", "path": "docs/streams/developer-guide/write-streams.html", "diffHunk": "@@ -154,7 +154,7 @@ <h2>Using Kafka Streams within your application code<a class=\"headerlink\" href=\"\n       </div>\n       <p>If there are other instances of this stream processing application running elsewhere (e.g., on another machine), Kafka\n         Streams transparently re-assigns tasks from the existing instances to the new instance that you just started.\n-        For more information, see <a class=\"reference internal\" href=\"../architecture.html#streams_architecture_tasks\"><span class=\"std std-ref\">Stream Partitions and Tasks</span></a> and <a class=\"reference internal\" href=\"../architecture.html#streams-architecture-threads\"><span class=\"std std-ref\">Threading Model</span></a>.</p>\n+        For more information, see <a class=\"reference internal\" href=\"../architecture.html#streams_architecture_tasks\"><span class=\"std std-ref\">Stream Partitions and Tasks</span></a> and <a class=\"reference internal\" href=\"../architecture.html#streams_architecture_threads\"><span class=\"std std-ref\">Threading Model</span></a>.</p>", "originalCommit": "3165ae7c1c2e9fb385b8c3c84f6daff8be9ebfc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTA1NTAyMw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r425055023", "bodyText": "wrong HTML formatting. The starting/ending <h2> tag and <a> tag are mixed places.", "author": "showuon", "createdAt": "2020-05-14T11:07:43Z", "path": "docs/streams/developer-guide/write-streams.html", "diffHunk": "@@ -208,7 +208,7 @@ <h2>Using Kafka Streams within your application code<a class=\"headerlink\" href=\"\n </div>\n \n       <div class=\"section\" id=\"testing-a-streams-app\">\n-          <a class=\"headerlink\" href=\"#testing-a-streams-app\" title=\"Permalink to this headline\"><h2>Testing a Streams application</a></h2>\n+          <h2><a class=\"headerlink\" href=\"#testing-a-streams-app\" title=\"Permalink to this headline\">Testing a Streams application</a></h2>", "originalCommit": "3165ae7c1c2e9fb385b8c3c84f6daff8be9ebfc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTA1NTQ0Mg==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r425055442", "bodyText": "Fix the broken link.", "author": "showuon", "createdAt": "2020-05-14T11:08:26Z", "path": "docs/streams/developer-guide/running-app.html", "diffHunk": "@@ -51,7 +51,7 @@\n           <span id=\"streams-developer-guide-execution\"></span><h1>Running Streams Applications<a class=\"headerlink\" href=\"#running-streams-applications\" title=\"Permalink to this headline\"></a></h1>\n           <p>You can run Java applications that use the Kafka Streams library without any additional configuration or requirements. Kafka Streams\n               also provides the ability to receive notification of the various states of the application. The ability to monitor the runtime\n-              status is discussed in <a class=\"reference internal\" href=\"../monitoring.html#streams-monitoring\"><span class=\"std std-ref\">the monitoring guide</span></a>.</p>\n+              status is discussed in <a class=\"reference internal\" href=\"/documentation/#kafka_streams_monitoring\"><span class=\"std std-ref\">the monitoring guide</span></a>.</p>", "originalCommit": "3165ae7c1c2e9fb385b8c3c84f6daff8be9ebfc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "460768e71f5c7d427a6faffdded9b0478ade1db1", "url": "https://github.com/apache/kafka/commit/460768e71f5c7d427a6faffdded9b0478ade1db1", "message": "revert back to version 2.3 since since 2.4, we have cooperative rebalancing after 2.4", "committedDate": "2020-05-19T03:26:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTk5MQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427009991", "bodyText": "@showuon Can we clarify that you only need to do this if you're upgrading from 2.3 or below? I know this seems implied by the fact that the config's possible values stop at 2.3 but there are always creative interpretations of seemingly obvious things \ud83d\ude42", "author": "ableegoldman", "createdAt": "2020-05-19T03:32:17Z", "path": "docs/streams/upgrade-guide.html", "diffHunk": "@@ -35,7 +35,7 @@ <h1>Upgrade Guide and API Changes</h1>\n \n     <p>\n         Upgrading from any older version to {{fullDotVersion}} is possible: you will need to do two rolling bounces, where during the first rolling bounce phase you set the config <code>upgrade.from=\"older version\"</code>\n-        (possible values are <code>\"0.10.0\" - \"2.4\"</code>) and during the second you remove it. This is required to safely upgrade to the new cooperative rebalancing protocol of the embedded consumer. Note that you will remain using the old eager\n+        (possible values are <code>\"0.10.0\" - \"2.3\"</code>) and during the second you remove it. This is required to safely upgrade to the new cooperative rebalancing protocol of the embedded consumer. Note that you will remain using the old eager", "originalCommit": "460768e71f5c7d427a6faffdded9b0478ade1db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAxMjc5Nw==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427012797", "bodyText": "hi @ableegoldman , After reading the whole paragraph again, I think you're right.\n\n(possible values are \"0.10.0\" - \"2.3\") and during the second you remove it. ....\nThis is required to safely upgrade to the new cooperative rebalancing protocol of the embedded consumer. ....\nyou can safely switch over to cooperative at any time once the entire group is on 2.4+ by removing the config value and bouncing.\n\nSo, Because we explicitly said since 2.4+, there'll be cooperative rebalancing protocol available, I think here we keep it as 2.3 is fine and correct.\nOr do you have any other suggestion?\nThank you.", "author": "showuon", "createdAt": "2020-05-19T03:42:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTk5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAxMzkzNA==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427013934", "bodyText": "Can we just add a small qualifier in the first line?\nyou will need to do two rolling bounces --> if upgrading from 2.3 or below, you will need to do two rolling bounces", "author": "ableegoldman", "createdAt": "2020-05-19T03:47:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTk5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAxODc1OQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427018759", "bodyText": "Thanks for suggestion, @ableegoldman , it makes it more clear! I've updated in this commit a3accf6. Thank you.", "author": "showuon", "createdAt": "2020-05-19T04:09:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTk5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAxOTg0NA==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427019844", "bodyText": "Awesome, thank you!", "author": "ableegoldman", "createdAt": "2020-05-19T04:13:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTk5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAyODE2NQ==", "url": "https://github.com/apache/kafka/pull/8622#discussion_r427028165", "bodyText": "I've also updated in the kafka-site repo: apache/kafka-site@513a820. Thank you.", "author": "showuon", "createdAt": "2020-05-19T04:49:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwOTk5MQ=="}], "type": "inlineReview"}, {"oid": "a3accf681e72bbba9a774a464253c1ccd7746188", "url": "https://github.com/apache/kafka/commit/a3accf681e72bbba9a774a464253c1ccd7746188", "message": "addressing reviewer's comments", "committedDate": "2020-05-19T04:06:43Z", "type": "commit"}]}