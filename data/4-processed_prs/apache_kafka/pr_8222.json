{"pr_number": 8222, "pr_title": "KAFKA-9650: include human readable units in ms and bytes configs", "pr_createdAt": "2020-03-04T17:01:48Z", "pr_url": "https://github.com/apache/kafka/pull/8222", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU1OTc1Mg==", "url": "https://github.com/apache/kafka/pull/8222#discussion_r409559752", "bodyText": "The prefix for kilo, is lowercase k", "author": "mimaison", "createdAt": "2020-04-16T13:34:42Z", "path": "clients/src/main/java/org/apache/kafka/common/config/ConfigDef.java", "diffHunk": "@@ -1179,6 +1186,50 @@ protected String getConfigValue(ConfigKey key, String headerName) {\n         }\n     }\n \n+    private static String niceMemoryUnits(ConfigKey key) {\n+        final long defaultValueBytes = ((Number) key.defaultValue).longValue();\n+        long defaultValue = defaultValueBytes;\n+        int i = 0;\n+        while (i < 5) {\n+            if (defaultValue % 1024 != 0) {\n+                break;\n+            }\n+            defaultValue /= 1024;\n+            i++;\n+        }\n+        switch (i) {\n+            case 1:\n+                return \" (=\" + defaultValue + \"KiB)\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI5NTgxNQ==", "url": "https://github.com/apache/kafka/pull/8222#discussion_r411295815", "bodyText": "You're right, but in this case we're dealing with kibibytes, not kilobyes, and it seems in this case KiB is the standard abbreviation.", "author": "tombentley", "createdAt": "2020-04-20T11:17:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU1OTc1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU2MDI0Nw==", "url": "https://github.com/apache/kafka/pull/8222#discussion_r409560247", "bodyText": "Do we need this extra variable? It seems like defaultValueBytes is not used", "author": "mimaison", "createdAt": "2020-04-16T13:35:28Z", "path": "clients/src/main/java/org/apache/kafka/common/config/ConfigDef.java", "diffHunk": "@@ -1179,6 +1186,50 @@ protected String getConfigValue(ConfigKey key, String headerName) {\n         }\n     }\n \n+    private static String niceMemoryUnits(ConfigKey key) {\n+        final long defaultValueBytes = ((Number) key.defaultValue).longValue();\n+        long defaultValue = defaultValueBytes;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU2MjYwNw==", "url": "https://github.com/apache/kafka/pull/8222#discussion_r409562607", "bodyText": "I wonder if using Durations would make this more readable. For example Duration.ofDays(1).toMillis() instead of 1000L * 60 * 60 * 24. WDYT?", "author": "mimaison", "createdAt": "2020-04-16T13:38:20Z", "path": "clients/src/main/java/org/apache/kafka/common/config/ConfigDef.java", "diffHunk": "@@ -1179,6 +1186,50 @@ protected String getConfigValue(ConfigKey key, String headerName) {\n         }\n     }\n \n+    private static String niceMemoryUnits(ConfigKey key) {\n+        final long defaultValueBytes = ((Number) key.defaultValue).longValue();\n+        long defaultValue = defaultValueBytes;\n+        int i = 0;\n+        while (i < 5) {\n+            if (defaultValue % 1024 != 0) {\n+                break;\n+            }\n+            defaultValue /= 1024;\n+            i++;\n+        }\n+        switch (i) {\n+            case 1:\n+                return \" (=\" + defaultValue + \"KiB)\";\n+            case 2:\n+                return \" (=\" + defaultValue + \"MiB)\";\n+            case 3:\n+                return \" (=\" + defaultValue + \"GiB)\";\n+            case 4:\n+                return \" (=\" + defaultValue + \"TiB)\";\n+            default:\n+                return \"\";\n+        }\n+    }\n+\n+    private static String niceTimeUnits(ConfigKey key) {\n+        final long defaultValueBytes = ((Number) key.defaultValue).longValue();\n+        long defaultValue = defaultValueBytes;\n+        if (defaultValueBytes % 1000L * 60 * 60 * 24 == 0) {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "18cf7a815e9c914a8367af324650126a61c1cb67", "url": "https://github.com/apache/kafka/commit/18cf7a815e9c914a8367af324650126a61c1cb67", "message": "KAFKA-9650: include human readable units in ms and bytes configs", "committedDate": "2020-04-20T10:40:56Z", "type": "commit"}, {"oid": "c73c00f8cad5ea6dd6bbf52caa4ebeb68239382e", "url": "https://github.com/apache/kafka/commit/c73c00f8cad5ea6dd6bbf52caa4ebeb68239382e", "message": "Rewrite niceTimeUnits", "committedDate": "2020-04-20T11:18:20Z", "type": "commit"}, {"oid": "c73c00f8cad5ea6dd6bbf52caa4ebeb68239382e", "url": "https://github.com/apache/kafka/commit/c73c00f8cad5ea6dd6bbf52caa4ebeb68239382e", "message": "Rewrite niceTimeUnits", "committedDate": "2020-04-20T11:18:20Z", "type": "forcePushed"}, {"oid": "8cebbece95ddafd12636cb9d30d5cb76536f5ac5", "url": "https://github.com/apache/kafka/commit/8cebbece95ddafd12636cb9d30d5cb76536f5ac5", "message": "Test+fixes", "committedDate": "2020-05-07T14:42:01Z", "type": "commit"}, {"oid": "0d228eb78e05f92c48fb1614e6cf196b16b18968", "url": "https://github.com/apache/kafka/commit/0d228eb78e05f92c48fb1614e6cf196b16b18968", "message": "Remove = and spell out memory units", "committedDate": "2020-05-11T10:40:20Z", "type": "commit"}]}