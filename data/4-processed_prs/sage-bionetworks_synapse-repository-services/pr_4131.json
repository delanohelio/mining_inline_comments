{"pr_number": 4131, "pr_title": "Plfm 6325 b", "pr_createdAt": "2020-07-10T00:57:02Z", "pr_url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4131", "timeline": [{"oid": "93324cbe04636376316f585732991a12255a2245", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/93324cbe04636376316f585732991a12255a2245", "message": "code review changes", "committedDate": "2020-07-08T00:09:20Z", "type": "commit"}, {"oid": "ac5523d55284a93a66a4c04eeaf59078ef21a1c2", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/ac5523d55284a93a66a4c04eeaf59078ef21a1c2", "message": "added get validation worker and tests", "committedDate": "2020-07-10T00:55:08Z", "type": "commit"}, {"oid": "44fafd41a94c697b961518dfe6851521d2ae4688", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/44fafd41a94c697b961518dfe6851521d2ae4688", "message": "saved file", "committedDate": "2020-07-10T02:22:55Z", "type": "commit"}, {"oid": "d299ba2d16c75d79315a7220efd0244504341789", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/d299ba2d16c75d79315a7220efd0244504341789", "message": "test fix", "committedDate": "2020-07-10T04:07:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzExNjQ3Nw==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4131#discussion_r453116477", "bodyText": "We can do a bit of cleanup of this unit test", "author": "marcomarasca", "createdAt": "2020-07-10T23:13:07Z", "path": "services/workers/src/test/java/org/sagebionetworks/schema/worker/GetValidationSchemaWorkerTest.java", "diffHunk": "@@ -0,0 +1,110 @@\n+package org.sagebionetworks.schema.worker;\n+\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.never;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Date;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.sagebionetworks.common.util.progress.ProgressCallback;\n+import org.sagebionetworks.repo.manager.asynch.AsynchJobStatusManager;\n+import org.sagebionetworks.repo.manager.schema.JsonSchemaManager;\n+import org.sagebionetworks.repo.model.UserInfo;\n+import org.sagebionetworks.repo.model.asynch.AsynchronousJobStatus;\n+import org.sagebionetworks.repo.model.schema.GetValidationSchemaRequest;\n+import org.sagebionetworks.repo.model.schema.GetValidationSchemaResponse;\n+import org.sagebionetworks.repo.model.schema.JsonSchema;\n+import org.sagebionetworks.repo.model.schema.JsonSchemaVersionInfo;\n+import org.sagebionetworks.repo.web.NotFoundException;\n+import org.sagebionetworks.workers.util.aws.message.RecoverableMessageException;\n+\n+import com.amazonaws.services.sqs.model.Message;\n+\n+/**\n+ * Unit test for CreateJsonSchemaWorker\n+ *\n+ */\n+@ExtendWith(MockitoExtension.class)\n+public class GetValidationSchemaWorkerTest {\n+\t\n+\t@Mock\n+\tprivate AsynchJobStatusManager mockAsynchJobStatusManager;\n+\t@Mock\n+\tprivate JsonSchemaManager mockJsonSchemaManager;\n+\t@Mock\n+\tprivate ProgressCallback mockProgressCallback;\n+\t@Mock\n+\tprivate Message mockMessage;\n+\t\n+\t@InjectMocks\n+\tGetValidationSchemaWorker worker;\n+\t\n+\tString jobId;\n+\tJsonSchema schema;\n+\tAsynchronousJobStatus jobStatus;\n+\tGetValidationSchemaRequest requestBody;\n+\tLong startedByUserId;\n+\tUserInfo user;\n+\tJsonSchemaVersionInfo newVersionInfo;\n+\tGetValidationSchemaResponse response;\n+\t\n+\t@BeforeEach\n+\tpublic void before() {\n+\t\tjobId = \"123\";\n+\t\tstartedByUserId = 987L;\n+\t\tboolean isAdmin = false;\n+\t\tuser = new UserInfo(isAdmin, startedByUserId);\n+\t\tschema = new JsonSchema();\n+\t\tschema.set$id(\"org/path.name/1.0.1\");\n+\t\trequestBody = new GetValidationSchemaRequest();\n+\t\trequestBody.set$id(schema.get$id());\n+\t\tjobStatus = new AsynchronousJobStatus();\n+\t\tjobStatus.setJobId(jobId);\n+\t\tjobStatus.setRequestBody(requestBody);\n+\t\tjobStatus.setStartedByUserId(startedByUserId);\n+\t\t\n+\t\tnewVersionInfo = new JsonSchemaVersionInfo();", "originalCommit": "d299ba2d16c75d79315a7220efd0244504341789", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}