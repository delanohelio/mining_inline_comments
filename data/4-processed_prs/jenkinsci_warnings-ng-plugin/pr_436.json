{"pr_number": 436, "pr_title": "[JENKINS-56594] - Hide empty trend charts", "pr_createdAt": "2020-04-07T19:06:17Z", "pr_url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436", "timeline": [{"oid": "f28e21f94b95a9e3dd9c501f2368e6cf15b40546", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/f28e21f94b95a9e3dd9c501f2368e6cf15b40546", "message": "Candidate Solution for Jenkins-56594. Displays congratulation if no warnings", "committedDate": "2020-04-07T18:59:03Z", "type": "commit"}, {"oid": "898b4e0b65b8e9c00226de35c450a1b58b869075", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/898b4e0b65b8e9c00226de35c450a1b58b869075", "message": "Update floatingBox.jelly", "committedDate": "2020-04-08T19:00:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMDM1OQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406100359", "bodyText": "Seems that this change breaks 2 existing tests: https://github.com/jenkinsci/warnings-ng-plugin/pull/436/checks?check_run_id=571774271", "author": "uhafner", "createdAt": "2020-04-09T10:10:48Z", "path": "plugin/src/main/resources/io/jenkins/plugins/analysis/core/model/JobAction/floatingBox.jelly", "diffHunk": "@@ -1,6 +1,18 @@\n <?jelly escape-by-default='true'?>\n-<j:jelly xmlns:j=\"jelly:core\" xmlns:c=\"/charts\">\n+<j:jelly xmlns:j=\"jelly:core\" xmlns:c=\"/charts\" xmlns:i=\"/issues\">\n \n-  <c:trend-chart it=\"${from}\" title=\"${from.trendName}\" enableLinks=\"true\"/>\n+ <j:choose>", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg1Nzc5Nw==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r416857797", "bodyText": "The tests are expecting a chart which is not there anymore.", "author": "uhafner", "createdAt": "2020-04-28T19:11:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMDM1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMDcxNg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406100716", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public boolean noWarnings(){\n          \n          \n            \n                public boolean hasNoIssues() {", "author": "uhafner", "createdAt": "2020-04-09T10:11:32Z", "path": "plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java", "diffHunk": "@@ -202,6 +206,20 @@ public boolean isTrendVisible() {\n         return trendChartType != TrendChartType.NONE && createBuildHistory().hasMultipleResults();\n     }\n \n+    public boolean noWarnings(){", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMTUyNQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406101525", "bodyText": "This check should not be necessary", "author": "uhafner", "createdAt": "2020-04-09T10:12:56Z", "path": "plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java", "diffHunk": "@@ -202,6 +206,20 @@ public boolean isTrendVisible() {\n         return trendChartType != TrendChartType.NONE && createBuildHistory().hasMultipleResults();\n     }\n \n+    public boolean noWarnings(){\n+        History results =createBuildHistory(); //Get past build history\n+        if(results instanceof AnalysisHistory){", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MDIzNg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406280236", "bodyText": "As far as I understand, createBuildHistory() could return two types of objects: NullAnalysisHistory or AnalysisHistory. When NullAnalysisHistory is returned, it means there is no build history, so we are going to return true directly. If it's AnalysisHistory, we will start iterating through it.", "author": "Allancgx", "createdAt": "2020-04-09T15:16:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMxMTkyOQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406311929", "bodyText": "But this is the clue of the NullObjectPattern, you really do not need to care: your algorithm will terminate with true anyway since there are no build results.", "author": "uhafner", "createdAt": "2020-04-09T16:03:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMTUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406103670", "bodyText": "All warnings are included in total. Or what exactly do you want to achieve with the subtraction?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(nextResult.getResult().getTotalSize() - nextResult.getResult().getTotalSizeOf(Severity.ERROR) != 0){\n          \n          \n            \n                            if (nextResult.getResult().getTotalSize() > 0) {", "author": "uhafner", "createdAt": "2020-04-09T10:16:54Z", "path": "plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java", "diffHunk": "@@ -202,6 +206,20 @@ public boolean isTrendVisible() {\n         return trendChartType != TrendChartType.NONE && createBuildHistory().hasMultipleResults();\n     }\n \n+    public boolean noWarnings(){\n+        History results =createBuildHistory(); //Get past build history\n+        if(results instanceof AnalysisHistory){\n+            Iterator<BuildResult<AnalysisBuildResult>> it = results.iterator();\n+            while(it.hasNext()) {\n+                BuildResult<AnalysisBuildResult> nextResult = it.next();\n+                if(nextResult.getResult().getTotalSize() - nextResult.getResult().getTotalSizeOf(Severity.ERROR) != 0){", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MTI5MQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406281291", "bodyText": "Doesn't nextResult.getResult() returns the total number of warnings+errors? If we are only checking the number of warnings, shouldn't we subtract the number of errors from the total number?", "author": "Allancgx", "createdAt": "2020-04-09T15:18:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MTkwMg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406281902", "bodyText": "In case there is one error but no warnings, this new method is expected to return true, right?", "author": "Allancgx", "createdAt": "2020-04-09T15:19:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MzkzOQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406283939", "bodyText": "I noticed that you changed the method name to hasNoIssues(). Are we including errors then? I thought the graph only displayed the number of warnings\ud83d\ude05.", "author": "Allancgx", "createdAt": "2020-04-09T15:22:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMxNDMwMA==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406314300", "bodyText": "No, the chart draws \"everything\": actually the individual tools decide which things should be shown (I called them issues since these items can be warnings, errors, code duplications, TODO tags, unit test failures, etc.). So if at least one build has number of issues > 0, then the chart should be shown.", "author": "uhafner", "createdAt": "2020-04-09T16:07:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMxNzkzMg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406317932", "bodyText": "Thank you for the clarification!", "author": "Allancgx", "createdAt": "2020-04-09T16:13:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}], "type": "inlineReview"}, {"oid": "9dbd6843ff6045bb138acf204b17853c2a90dab0", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/9dbd6843ff6045bb138acf204b17853c2a90dab0", "message": "Update plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java\r\n\r\nClarifying name change\n\nCo-Authored-By: Ullrich Hafner <ullrich.hafner@gmail.com>", "committedDate": "2020-04-17T17:43:59Z", "type": "commit"}, {"oid": "28a80b04bf1d001f5c96e64829d312853dac09c7", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/28a80b04bf1d001f5c96e64829d312853dac09c7", "message": "Updated Commit for hasNoIssues\n\nRemoved Instance check and updated to check size of all issues, not just warnings.", "committedDate": "2020-04-17T17:51:28Z", "type": "commit"}, {"oid": "6678b79594c85073f32579bcb1b2cd6b2b8387ed", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/6678b79594c85073f32579bcb1b2cd6b2b8387ed", "message": "Updated Java Function Name\n\nUpdated Java function name in jelly file to updated name in JobAction from noWarnings() to hasNoIssues().", "committedDate": "2020-04-17T17:56:13Z", "type": "commit"}]}