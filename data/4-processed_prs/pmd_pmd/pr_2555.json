{"pr_number": 2555, "pr_title": "[java] Improve UseDiamondOperator rule", "pr_createdAt": "2020-05-30T08:55:50Z", "pr_url": "https://github.com/pmd/pmd/pull/2555", "timeline": [{"oid": "c2cea9d15bcf512dbfce8d67c466ff0d17774ded", "url": "https://github.com/pmd/pmd/commit/c2cea9d15bcf512dbfce8d67c466ff0d17774ded", "message": "[java] UseDiamondOperator - support nested type arguments\n\nFixes #2545 partially", "committedDate": "2020-05-30T08:23:52Z", "type": "commit"}, {"oid": "cae13164726eb86e7c9cd91c42783e493db8703f", "url": "https://github.com/pmd/pmd/commit/cae13164726eb86e7c9cd91c42783e493db8703f", "message": "[java] UseDiamondOperator - add property java7compatibility\n\nThis property is disabled by default, so that the rule\nsuggests changes that work on java8+ only by default.\n\nEnable the version dependent tests.", "committedDate": "2020-05-30T08:38:09Z", "type": "commit"}, {"oid": "7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b", "url": "https://github.com/pmd/pmd/commit/7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b", "message": "[doc] Update release notes, fixes #2545", "committedDate": "2020-05-30T08:43:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgxMjAyMA==", "url": "https://github.com/pmd/pmd/pull/2555#discussion_r439812020", "bodyText": "In proper camelCase this would be java7Compatibility", "author": "oowekyala", "createdAt": "2020-06-14T09:55:47Z", "path": "pmd-java/src/main/resources/category/java/codestyle.xml", "diffHunk": "@@ -2004,15 +2009,17 @@ which makes the code also more readable.\n |\n //StatementExpression[AssignmentOperator and PrimaryExpression/PrimaryPrefix[not(Expression)]]\n )\n-/Expression/PrimaryExpression[not(PrimarySuffix) and not(ancestor::ArgumentList)]\n+/(Expression | Expression[$java7compatibility = false()]/ConditionalExpression | Expression[$java7compatibility = false()]/ConditionalExpression/Expression)\n+/PrimaryExpression[not(PrimarySuffix) and not(ancestor::ArgumentList)]\n /PrimaryPrefix\n /AllocationExpression\n     [@AnonymousClass=false()]\n-    [ClassOrInterfaceType/TypeArguments[@Diamond=false() and not(TypeArgument//TypeArguments)]]\n+    [ClassOrInterfaceType/TypeArguments[@Diamond=false() and not($java7compatibility = true() and .//TypeArgument[@Wildcard=true()])]]\n     [not(ArrayDimsAndInits)]\n ]]>\n                 </value>\n             </property>\n+            <property name=\"java7compatibility\" type=\"Boolean\" description=\"If disabled, the rule shows also violations that are applicable for java8+\" value=\"false\" />", "originalCommit": "7b6a70bd0f42ad0cbf00cb6176d5dee0fd718e3b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}