{"pr_number": 2747, "pr_title": "[java] Don't trigger FinalFieldCouldBeStatic when field is annotated with lombok @Builder.Default", "pr_createdAt": "2020-08-27T07:49:46Z", "pr_url": "https://github.com/pmd/pmd/pull/2747", "timeline": [{"oid": "cd98a36b66548aca5c5867283c99d1f39211643a", "url": "https://github.com/pmd/pmd/commit/cd98a36b66548aca5c5867283c99d1f39211643a", "message": "[java] Fix 2708: False positive FinalFieldCouldBeStatic", "committedDate": "2020-08-26T15:52:13Z", "type": "commit"}, {"oid": "363c3a30ff59b5d7f16e6e28ba90ed8ffc0f92bc", "url": "https://github.com/pmd/pmd/commit/363c3a30ff59b5d7f16e6e28ba90ed8ffc0f92bc", "message": "Trigger for non lombok Builder.Default", "committedDate": "2020-08-27T07:45:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc4MTQ3MQ==", "url": "https://github.com/pmd/pmd/pull/2747#discussion_r479781471", "bodyText": "This test could probably be moved to right after the [@Final= true() and @Static= false()] for clarity. That way you don't need to put the other path (the one that starts with VariableDeclarator) entirely inside a [...] predicate.\nThough I noticed the violation is now reported on the FieldDeclaration node whereas it was previously reported on the expression. Probably the correct place to report it is actually the VariableDeclaratorId, since there may be several of them in the same field declaration.\nSo the expression should most likely have the form\n//FieldDeclaration\n[@Final= true() and @Static= false()]\n[/* test for lombok.Builder */]\n/VariableDeclarator[VariableInitializer/...]/VariableDeclaratorId", "author": "oowekyala", "createdAt": "2020-08-30T15:10:30Z", "path": "pmd-java/src/main/resources/category/java/design.xml", "diffHunk": "@@ -740,8 +740,10 @@ in each object at runtime.\n <![CDATA[\n //FieldDeclaration\n  [@Final= true() and @Static= false()]\n-   /VariableDeclarator/VariableInitializer/Expression\n-    /PrimaryExpression[not(PrimarySuffix)]/PrimaryPrefix/Literal\n+   [VariableDeclarator/VariableInitializer/Expression\n+    /PrimaryExpression[not(PrimarySuffix)]/PrimaryPrefix/Literal]\n+    [not(preceding-sibling::Annotation/MarkerAnnotation/Name[@Image=\"Builder.Default\"]", "originalCommit": "363c3a30ff59b5d7f16e6e28ba90ed8ffc0f92bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDk1MTI3MQ==", "url": "https://github.com/pmd/pmd/pull/2747#discussion_r480951271", "bodyText": "Cheers for the comments @oowekyala , I've made that change and added a test for the\nclass MyClass {\n    private final String myField = \"something\", myOtherField = \"somethingElse\";\n}\n\ncase to make sure it triggers twice.", "author": "ollieabbey", "createdAt": "2020-09-01T08:07:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc4MTQ3MQ=="}], "type": "inlineReview"}, {"oid": "ba5c2f428890b1a31bd75bc1d6754b501d3f24b1", "url": "https://github.com/pmd/pmd/commit/ba5c2f428890b1a31bd75bc1d6754b501d3f24b1", "message": "Merge pull request #1 from pmd/master\n\nUpdate with changes", "committedDate": "2020-09-01T07:52:34Z", "type": "commit"}, {"oid": "776c0c154fa224074c9dff969312ef29d49db2eb", "url": "https://github.com/pmd/pmd/commit/776c0c154fa224074c9dff969312ef29d49db2eb", "message": "Addressed review comments", "committedDate": "2020-09-01T07:55:52Z", "type": "commit"}, {"oid": "85754378f72f069510c39179789086799443b95f", "url": "https://github.com/pmd/pmd/commit/85754378f72f069510c39179789086799443b95f", "message": "Added test for multiple VariableDecoratorIds", "committedDate": "2020-09-01T08:02:48Z", "type": "commit"}, {"oid": "b3e0c54a80af931ef4369ac01baa261da7b15b28", "url": "https://github.com/pmd/pmd/commit/b3e0c54a80af931ef4369ac01baa261da7b15b28", "message": "Fixed a typo", "committedDate": "2020-09-01T08:03:28Z", "type": "commit"}]}