{"pr_number": 2487, "pr_title": "[all] Cleanup rule test xml", "pr_createdAt": "2020-05-16T17:09:33Z", "pr_url": "https://github.com/pmd/pmd/pull/2487", "timeline": [{"oid": "f930491538ddd16dae07420899c9b44a14d25bbe", "url": "https://github.com/pmd/pmd/commit/f930491538ddd16dae07420899c9b44a14d25bbe", "message": "[apex] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:55:58Z", "type": "commit"}, {"oid": "b9828c2acb27b5766a6331d285b4994c1e32a34f", "url": "https://github.com/pmd/pmd/commit/b9828c2acb27b5766a6331d285b4994c1e32a34f", "message": "[java] Cleanup rule test xml files (bestpractices)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:04Z", "type": "commit"}, {"oid": "b19b888a6e1d5bcf3aa3ec278e29fd17788913dd", "url": "https://github.com/pmd/pmd/commit/b19b888a6e1d5bcf3aa3ec278e29fd17788913dd", "message": "[java] Cleanup rule test xml files (codestyle)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:04Z", "type": "commit"}, {"oid": "6c914a2a5542cdb5c1d889b753c30fa36a0a823a", "url": "https://github.com/pmd/pmd/commit/6c914a2a5542cdb5c1d889b753c30fa36a0a823a", "message": "[java] Cleanup rule test xml files (design)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:04Z", "type": "commit"}, {"oid": "9ec063b63879b182db69d2745439feb6da48c776", "url": "https://github.com/pmd/pmd/commit/9ec063b63879b182db69d2745439feb6da48c776", "message": "[java] Cleanup rule test xml files (documentation)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "a80bc88276ba83ab7809138c209c6c657ba107ff", "url": "https://github.com/pmd/pmd/commit/a80bc88276ba83ab7809138c209c6c657ba107ff", "message": "[java] Cleanup rule test xml files (errorprone)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "11d886ec4164263bac67346b5d0d65f9adbc478b", "url": "https://github.com/pmd/pmd/commit/11d886ec4164263bac67346b5d0d65f9adbc478b", "message": "[java] Cleanup rule test xml files (multithreading)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "3fd74794c82e8fa7d3673c8283a3d8a025465b47", "url": "https://github.com/pmd/pmd/commit/3fd74794c82e8fa7d3673c8283a3d8a025465b47", "message": "[java] Cleanup rule test xml files (performance)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "5ed25a9277f9e6159b0027f770c5ab878c2ae626", "url": "https://github.com/pmd/pmd/commit/5ed25a9277f9e6159b0027f770c5ab878c2ae626", "message": "[java] Cleanup rule test xml files (security)\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "4c2c111492e49c59137f3d1f7868baa24285c19c", "url": "https://github.com/pmd/pmd/commit/4c2c111492e49c59137f3d1f7868baa24285c19c", "message": "[javascript] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "edc40521a3517bd016b262d933ca9812c45ba72e", "url": "https://github.com/pmd/pmd/commit/edc40521a3517bd016b262d933ca9812c45ba72e", "message": "[visualforce] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "48da3feee0094c6de6546f61e5ccb0cc0519b588", "url": "https://github.com/pmd/pmd/commit/48da3feee0094c6de6546f61e5ccb0cc0519b588", "message": "[modelica] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "7334738a975fce080cace8943808cdac64e4ed20", "url": "https://github.com/pmd/pmd/commit/7334738a975fce080cace8943808cdac64e4ed20", "message": "[plsql] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "fef1ad76c6198387df487f3e36c630836292fd2c", "url": "https://github.com/pmd/pmd/commit/fef1ad76c6198387df487f3e36c630836292fd2c", "message": "[vm] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "b3215c830d8d5247a4faa9e3e4e78e4b56eda244", "url": "https://github.com/pmd/pmd/commit/b3215c830d8d5247a4faa9e3e4e78e4b56eda244", "message": "[xml] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "b53edfd3503ce6a2c5872c9177594a6f9c5362fc", "url": "https://github.com/pmd/pmd/commit/b53edfd3503ce6a2c5872c9177594a6f9c5362fc", "message": "[java] Cleanup rule test xml files for metrics\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "7de968a5c903afadcb33fb38fae0b2e34b20658b", "url": "https://github.com/pmd/pmd/commit/7de968a5c903afadcb33fb38fae0b2e34b20658b", "message": "[jsp] Cleanup rule test xml files\n\nAvoid unnecessary CDATA for description\nUse 4 space indentation instead of tabs\nRemove trailing whitespace\nEnd file with a newline", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"oid": "09a30d2ef50f534b838fca045f26d68ebb8e2bec", "url": "https://github.com/pmd/pmd/commit/09a30d2ef50f534b838fca045f26d68ebb8e2bec", "message": "[doc] Fix indentation in rule testing doc, add note about CDATA", "committedDate": "2020-05-16T16:56:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgzNjU5Nw==", "url": "https://github.com/pmd/pmd/pull/2487#discussion_r426836597", "bodyText": "I would also explain why source-type is optional, and not needed in most cases. It's just used to select a specific language version, not the language. Most PRs that add a new language add source-type in the xml files, but this is not needed and throws off schema validation, because of this line:\n\n  \n    \n      pmd/pmd-test/src/main/resources/rule-tests_1_0_0.xsd\n    \n    \n         Line 53\n      in\n      0cc0027\n    \n    \n    \n    \n\n        \n          \n           <pattern value=\"(apex|ecmascript|java|jsp|modelica|plsql|pom|scala|vf|vm|wsdl|xml|xsl)( [\\w\\d._-]+)?\"></pattern> \n        \n    \n  \n\n\nSchema validation fails until the schema is updated.\nI'm not sure it's documented somewhere, how to update the schema (eg on which server to put the new file). This is an item in #597\nI think anyway, this validation constraint should be removed from the schema. It forces us to update the schema each time we add a language, and couples the schema to standard language modules.", "author": "oowekyala", "createdAt": "2020-05-18T19:07:16Z", "path": "docs/pages/pmd/userdocs/extending/testing.md", "diffHunk": "@@ -195,41 +197,49 @@ in a \"CDATA\" section, so that no further XML escapes (entity references such as\n             <message>Violation message 2</message>\n         </expected-messages>\n         <code><![CDATA[\n-    public class ConsistentReturn {\n-        public Boolean foo() {\n-        }\n+public class ConsistentReturn {\n+    public Boolean foo() {\n     }\n-         ]]></code>\n-            <source-type>apex</source-type>                             <!-- optional -->\n-        </test-code>\n+}\n+        ]]></code>\n+        <source-type>apex</source-type>                             <!-- optional -->", "originalCommit": "09a30d2ef50f534b838fca045f26d68ebb8e2bec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM1OTEwOA==", "url": "https://github.com/pmd/pmd/pull/2487#discussion_r429359108", "bodyText": "I'll describe, when source-type needs to be added.\nChanging the rule-test schema can be part of PMD 7 (it's one of the APIs of PMD).\nDocumenting how to update the schema will be part of #1139 (I removed this item from #597 because it's unrelated to rulechain).", "author": "adangel", "createdAt": "2020-05-22T17:03:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgzNjU5Nw=="}], "type": "inlineReview"}]}