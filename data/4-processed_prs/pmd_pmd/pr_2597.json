{"pr_number": 2597, "pr_title": "[dependencies] Fix issue #2594, update exec-maven-plugin everywhere", "pr_createdAt": "2020-06-17T21:49:58Z", "pr_url": "https://github.com/pmd/pmd/pull/2597", "timeline": [{"oid": "2b882e8655f12d9233d518760bbdeb3bd6fa64fe", "url": "https://github.com/pmd/pmd/commit/2b882e8655f12d9233d518760bbdeb3bd6fa64fe", "message": "fix issue #2594, update exec-maven-plugin everywhere", "committedDate": "2020-06-17T21:48:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MjY1NQ==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442042655", "bodyText": "I think, we should check, whether this profile actually still works and whether this is documented.\nThe goal was, if I remember correctly, to easily start the designer from the current workspace like\ncd pmd-apex\n./mvnw -Pdesigner org.codehaus.mojo:exec-maven-plugin:java\n# or ./mvnw -Pdesigner org.codehaus.mojo:exec-maven-plugin:exec ??\n\nI'm not sure, whether this still works, since the designer is maybe not on the classpath? And it is anyway in a different repository (https://github.com/pmd/pmd-designer)...\nTo start the designer, one should follow the instructions on https://github.com/pmd/pmd/wiki/Setup-IDE\nI'd suggest to remove this profile completely", "author": "adangel", "createdAt": "2020-06-18T08:04:40Z", "path": "pmd-apex/pom.xml", "diffHunk": "@@ -105,7 +105,7 @@\n           <plugin>", "originalCommit": "2b882e8655f12d9233d518760bbdeb3bd6fa64fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA3NDYxMw==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442074613", "bodyText": "That'll require some time to investigate. I'll check whether this works. Is it correct that pmd-designer was once in this pmd repository?", "author": "KroArtem", "createdAt": "2020-06-18T08:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MjY1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjIzNzg4NA==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442237884", "bodyText": "I think, it's a good idea to remove this. Probably the designer pom could have a runnable profile, but it's kind of random to put one in the apex module.", "author": "oowekyala", "createdAt": "2020-06-18T13:46:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MjY1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyNTY3Mg==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442425672", "bodyText": "Is it correct that pmd-designer was once in this pmd repository?\n\nYes, it was once part of the main repo (see https://github.com/pmd/pmd/tree/master/pmd-ui) but is now a separate project. The designer is pulled in via a dependency (in pmd-dist: \n  \n    \n      pmd/pmd-dist/pom.xml\n    \n    \n        Lines 262 to 266\n      in\n      534bfe3\n    \n    \n    \n    \n\n        \n          \n           <dependency> \n        \n\n        \n          \n               <groupId>net.sourceforge.pmd</groupId> \n        \n\n        \n          \n               <artifactId>pmd-ui</artifactId> \n        \n\n        \n          \n               <version>${pmd-designer.version}</version> \n        \n\n        \n          \n           </dependency> \n        \n    \n  \n\n)", "author": "adangel", "createdAt": "2020-06-18T18:36:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MjY1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkwOTQ4Mg==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r455909482", "bodyText": "cd pmd-apex\n../mvnw -Pdesigner org.codehaus.mojo:exec-maven-plugin:java\n\nactually works - it starts the old, deprecated, designer, which we shouldn't promote.\nI'll remove this profile.", "author": "adangel", "createdAt": "2020-07-16T16:18:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MjY1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MzA1Mw==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442043053", "bodyText": "Let's define the version in the main parent pom under \"pluginManagment\" and remove the explicit version here in pmd-doc", "author": "adangel", "createdAt": "2020-06-18T08:05:22Z", "path": "pmd-doc/pom.xml", "diffHunk": "@@ -24,7 +24,7 @@\n                     <plugin>\n                         <groupId>org.codehaus.mojo</groupId>\n                         <artifactId>exec-maven-plugin</artifactId>\n-                        <version>1.6.0</version>\n+                        <version>3.0.0</version>", "originalCommit": "2b882e8655f12d9233d518760bbdeb3bd6fa64fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA3MzQ1Ng==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442073456", "bodyText": "I thought about it but forgot and did just find/replace. Will fix", "author": "KroArtem", "createdAt": "2020-06-18T08:54:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0MzA1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0NTAwMA==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442045000", "bodyText": "It looks like this should be refactored and reused. We could define a function in .travis/common-functions.sh - then we have in the future only one place, where we need to update the plugin version.\nOn a side note: The goal of this is, to figure out, which version we are currently building. Calling the exec-maven-plugin is one way to do this, which works, but it's very heavy (starting maven to only read the <version> element of the pom.xml file....). Maybe you know a better way to read/parse the version from the file in the shell?", "author": "adangel", "createdAt": "2020-06-18T08:08:44Z", "path": ".travis/build-coveralls.sh", "diffHunk": "@@ -4,7 +4,7 @@ set -e\n source .travis/logger.sh\n source .travis/common-functions.sh\n \n-VERSION=$(./mvnw -q -Dexec.executable=\"echo\" -Dexec.args='${project.version}' --non-recursive org.codehaus.mojo:exec-maven-plugin:1.5.0:exec)\n+VERSION=$(./mvnw -q -Dexec.executable=\"echo\" -Dexec.args='${project.version}' --non-recursive org.codehaus.mojo:exec-maven-plugin:3.0.0:exec)", "originalCommit": "2b882e8655f12d9233d518760bbdeb3bd6fa64fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExNzU1Ng==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442117556", "bodyText": "It's indeed a good idea to define a function in common-functions.sh \ud83d\udc4c\nHowever it sounds easier (more lightweight) to read pom.xml and find project.version from there, wdyt? I see it either as a maven exec or maven help plugin OR bash + some scripting for parsing pom.\nMost of the comments are related to maven-help-plugin but it means changing one maven call to another one", "author": "KroArtem", "createdAt": "2020-06-18T10:09:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0NTAwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyNDE0Ng==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r442424146", "bodyText": "I've found this page: https://html.developreference.com/article/20765025/How+to+get+Maven+groupId%2C+artifactId+%26+project+version+to+the+command+line\nThe shell script variant looks like this:\nVERSION=$(echo -e 'setns x=http://maven.apache.org/POM/4.0.0\\ncat /x:project/x:version/text()' | xmllint --shell pom.xml | grep -v /)\n\nIt uses xmllint, but I don't know, whether this is available on travis. You could try this in one commit and see, whether the build still works. Or we just stay with maven here...", "author": "adangel", "createdAt": "2020-06-18T18:33:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0NTAwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkyNzI3MA==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r455927270", "bodyText": "ok, xmlint is not available:\nhttps://travis-ci.org/github/pmd/pmd/jobs/708823277#L280\nI'll revert my change and merge this PR then.", "author": "adangel", "createdAt": "2020-07-16T16:47:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0NTAwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA1NzI3NA==", "url": "https://github.com/pmd/pmd/pull/2597#discussion_r456057274", "bodyText": "I wanted to finish this but was a bit overwhelmed with daily work :/\n\nIt uses xmllint, but I don't know, whether this is available on travis. You could try this in one commit and see, whether the build still works. Or we just stay with maven here...\n\nIMO there was no use of changing one crutch by another one :) So staying with exec-maven-plugin is not a bad idea.", "author": "KroArtem", "createdAt": "2020-07-16T20:26:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjA0NTAwMA=="}], "type": "inlineReview"}, {"oid": "9180b479cb77eeb315ddf78d866d6e280f1b0620", "url": "https://github.com/pmd/pmd/commit/9180b479cb77eeb315ddf78d866d6e280f1b0620", "message": "[apex] Remove profile designer, which started the deprecated designer\n\nUsers are encouraged to use https://github.com/pmd/pmd-designer instead.", "committedDate": "2020-07-16T16:20:43Z", "type": "commit"}, {"oid": "bb005ea5d4122bcc49e8599fe5bf3d4c13839024", "url": "https://github.com/pmd/pmd/commit/bb005ea5d4122bcc49e8599fe5bf3d4c13839024", "message": "Refactor exec-maven-plugin version and usage", "committedDate": "2020-07-16T16:21:26Z", "type": "commit"}, {"oid": "34f185b03a41e5df1ed52897cf279c0607dee181", "url": "https://github.com/pmd/pmd/commit/34f185b03a41e5df1ed52897cf279c0607dee181", "message": "Use xmlint to get the pom version", "committedDate": "2020-07-16T16:21:26Z", "type": "commit"}, {"oid": "2adc457d23bb5582a5dae9e94eb955fdfb9ebacf", "url": "https://github.com/pmd/pmd/commit/2adc457d23bb5582a5dae9e94eb955fdfb9ebacf", "message": "[doc] Update release notes, refs #2597, fixes #2594", "committedDate": "2020-07-16T16:23:37Z", "type": "commit"}, {"oid": "17e57633b5a38c1008dfaab6536c9298dd7535da", "url": "https://github.com/pmd/pmd/commit/17e57633b5a38c1008dfaab6536c9298dd7535da", "message": "Merge branch 'master' into pr-2597", "committedDate": "2020-07-16T16:25:59Z", "type": "commit"}, {"oid": "59acd6d969c7bca48969bb554cf1ec7e00a917f2", "url": "https://github.com/pmd/pmd/commit/59acd6d969c7bca48969bb554cf1ec7e00a917f2", "message": "Revert \"Use xmlint to get the pom version\"\n\nThis reverts commit 34f185b03a41e5df1ed52897cf279c0607dee181.", "committedDate": "2020-07-16T16:46:40Z", "type": "commit"}]}