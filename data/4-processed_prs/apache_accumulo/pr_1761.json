{"pr_number": 1761, "pr_title": "Refactor TabletGroupWatcher", "pr_createdAt": "2020-10-30T16:30:18Z", "pr_url": "https://github.com/apache/accumulo/pull/1761", "timeline": [{"oid": "1f6be352d86ec8b47c35240f44f016ead62222c5", "url": "https://github.com/apache/accumulo/commit/1f6be352d86ec8b47c35240f44f016ead62222c5", "message": "Refactor TabletGroupWatcher\n\n* Create TabletLists to hold the many different data structures being\ntracked in the run method of TabletGroupWatcher\n* Create methods for some of the logic in the switch case\n* Pass TabletLists to the flush method and break flush into methods\n* Rename TabletLocationState.getServer() to getLocation() as location is\na more meaningful name instead of server", "committedDate": "2020-10-30T16:29:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM2OTcwMg==", "url": "https://github.com/apache/accumulo/pull/1761#discussion_r515369702", "bodyText": "Introducing this class is really nice, really reduces a lot of methods parameters.", "author": "keith-turner", "createdAt": "2020-10-30T20:40:53Z", "path": "server/manager/src/main/java/org/apache/accumulo/master/TabletGroupWatcher.java", "diffHunk": "@@ -134,6 +134,37 @@ synchronized boolean isSameTserversAsLastScan(Set<TServerInstance> candidates) {\n     return candidates.equals(lastScanServers);\n   }\n \n+  /**\n+   * Collection of data structures used to track Tablet assignments\n+   */\n+  private static class TabletLists {", "originalCommit": "1f6be352d86ec8b47c35240f44f016ead62222c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQxMTgxNw==", "url": "https://github.com/apache/accumulo/pull/1761#discussion_r515411817", "bodyText": "I think this method can be static now.", "author": "ctubbsii", "createdAt": "2020-10-30T22:39:22Z", "path": "server/manager/src/main/java/org/apache/accumulo/master/Master.java", "diffHunk": "@@ -1675,9 +1675,8 @@ public boolean delegationTokensAvailable() {\n     }\n   }\n \n-  public void markDeadServerLogsAsClosed(Map<TServerInstance,List<Path>> logsForDeadServers)\n-      throws WalMarkerException {\n-    WalStateManager mgr = new WalStateManager(getContext());\n+  public void markDeadServerLogsAsClosed(WalStateManager mgr,", "originalCommit": "1f6be352d86ec8b47c35240f44f016ead62222c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjAzMDI2Nw==", "url": "https://github.com/apache/accumulo/pull/1761#discussion_r516030267", "bodyText": "TabletGroupWatcher was the only thing using this method so I moved it from Master and made it private static.", "author": "milleruntime", "createdAt": "2020-11-02T14:59:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQxMTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjAzMDc1MQ==", "url": "https://github.com/apache/accumulo/pull/1761#discussion_r516030751", "bodyText": "In 7355894", "author": "milleruntime", "createdAt": "2020-11-02T15:00:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQxMTgxNw=="}], "type": "inlineReview"}, {"oid": "73558943033d1a0e0167424e9f06cf834cfb0f39", "url": "https://github.com/apache/accumulo/commit/73558943033d1a0e0167424e9f06cf834cfb0f39", "message": "Move method from Master and make private", "committedDate": "2020-11-02T14:58:26Z", "type": "commit"}]}