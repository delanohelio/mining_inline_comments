{"pr_number": 1772, "pr_title": "Improve tool tip for hold time in Monitor", "pr_createdAt": "2020-11-10T21:13:25Z", "pr_url": "https://github.com/apache/accumulo/pull/1772", "timeline": [{"oid": "d7b6c312842fa9e8b8470c179ca29f4ba66d3f64", "url": "https://github.com/apache/accumulo/commit/d7b6c312842fa9e8b8470c179ca29f4ba66d3f64", "message": "Improve tool tip for hold time in Monitor", "committedDate": "2020-11-10T21:09:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r520886460", "bodyText": "I like the first sentence, but I suggest: s/is suspended/has been suspended/.\nI'm not sure I understand what the second sentence is trying to say. It may not be necessary. Or maybe it would be simpler to say something about the tserver awaiting a flush / minc?", "author": "ctubbsii", "createdAt": "2020-11-10T21:31:23Z", "path": "server/monitor/src/main/resources/org/apache/accumulo/monitor/templates/table.ftl", "diffHunk": "@@ -44,7 +44,7 @@\n                 <th title=\"Key/value pairs over each instance, table or tablet.\">Entries&nbsp;</th>\n                 <th title=\"The number of Key/Value pairs inserted. (Note that deletes are considered inserted)\">Ingest&nbsp;</th>\n                 <th title=\"The number of key/value pairs returned to clients. (Not the number of scans)\">Query&nbsp;</th>\n-                <th title=\"The amount of time that ingest operations are suspended while waiting for data to be written to disk.\">Hold&nbsp;Time&nbsp;</th>\n+                <th title=\"The amount of time live ingest (mutations, batch writer) is suspended while waiting for tserver memory to free up. Writes are attempting to exceed tserver.memory.maps.max\">Hold&nbsp;Time&nbsp;</th>", "originalCommit": "d7b6c312842fa9e8b8470c179ca29f4ba66d3f64", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg5Mzc3NA==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r520893774", "bodyText": "I'm not sure I understand what the second sentence is trying to say. It may not be necessary. Or maybe it would be simpler to say something about the tserver awaiting a flush / minc?\n\nI was trying to describe why it has a hold time in as few words possible.  This seems to be the only spot in the code where we decide to hold commits up: \n  \n    \n      accumulo/server/tserver/src/main/java/org/apache/accumulo/tserver/TabletServerResourceManager.java\n    \n    \n         Line 575\n      in\n      62110a3\n    \n    \n    \n    \n\n        \n          \n           if (totalMemUsed > 0.95 * maxMem) {", "author": "milleruntime", "createdAt": "2020-11-10T21:45:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg5NDE3Ng==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r520894176", "bodyText": "And provide a pointer to the configuration property determining when to hold.", "author": "milleruntime", "createdAt": "2020-11-10T21:46:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkxMTE4NA==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r520911184", "bodyText": "Reading the docs for that property implies that it's not so simple as just this property. How, and by which properties, memory is managed, is complicated and can change over time, as that's implementation.\nIt might be better to stick to a high-level description, rather than pointing to specific properties / implementations, and explain that it's simply being held because its buffers are full and it needs to free up memory by flushing / minor compacting.\nAlso, these are just tool-tips, not supposed to be complete docs. I think \"The duration over which commits have been held, waiting for the tserver to clear up memory.\"\nI have reservations on your wording, because it didn't seem clear to me, and might be misleading, but I don't know what's best.", "author": "ctubbsii", "createdAt": "2020-11-10T22:20:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkxNDg2Nw==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r520914867", "bodyText": "I wanted to make more clear to admin what is happening for this number to be high.  To make it clear that live ingest is held up vs bulk imports.\nWhat about \"The duration live ingest ops (mutations, batch writes) have been held while waiting for tserver to free up memory\"", "author": "milleruntime", "createdAt": "2020-11-10T22:28:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkyNTg4Mw==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r520925883", "bodyText": "Or \"The amount of time live ingest operations (mutations, batch writes) have been waiting for the tserver to free up memory\"", "author": "milleruntime", "createdAt": "2020-11-10T22:53:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTA3NzQ1Ng==", "url": "https://github.com/apache/accumulo/pull/1772#discussion_r521077456", "bodyText": "Either of those would be fine... I didn't mean to omit the part that emphasized live ingest in my suggestion. I only meant to drop the part implying that a specific single property was the culprit, from the second sentence.\nThe only part I thought should be changed for the first sentence is to make it \"past-tense and ongoing\", rather than imply \"present tense and instantaneous\" (\"has/have been suspended\" vs. \"is suspended\"). Both of your last two suggestions encapsulate what I was going for there.", "author": "ctubbsii", "createdAt": "2020-11-11T03:20:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4NjQ2MA=="}], "type": "inlineReview"}, {"oid": "f62d1f9292a84d3c03604cdbce3be805fcf37cb4", "url": "https://github.com/apache/accumulo/commit/f62d1f9292a84d3c03604cdbce3be805fcf37cb4", "message": "Rewording", "committedDate": "2020-11-12T15:33:33Z", "type": "commit"}]}