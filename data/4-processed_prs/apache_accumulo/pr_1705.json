{"pr_number": 1705, "pr_title": "Clean up a few forEach loops", "pr_createdAt": "2020-09-15T21:33:34Z", "pr_url": "https://github.com/apache/accumulo/pull/1705", "timeline": [{"oid": "c0e5da14d99cf03105deebf4cb48832e395121e5", "url": "https://github.com/apache/accumulo/commit/c0e5da14d99cf03105deebf4cb48832e395121e5", "message": "Clean up a few forEach loops\n\nMiscellaneous minor clean up found while working on unrelated code,\nincluding:\n\n* Using forEach loops on collections to streamline loops\n* Inline one-time-use simple private methods\n* Remove braces in some simple one-statement lambdas", "committedDate": "2020-09-15T21:31:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAzMzU2OA==", "url": "https://github.com/apache/accumulo/pull/1705#discussion_r489033568", "bodyText": "Would a comment be appropriate?  The method name explains what is happening, when merged it looks harder to reason why this is being done.", "author": "EdColeman", "createdAt": "2020-09-15T22:32:49Z", "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TabletServerBatchWriter.java", "diffHunk": "@@ -509,19 +509,13 @@ private void updateAuthorizationFailures(Map<KeyExtent,SecurityErrorCode> author\n \n       synchronized (this) {\n         somethingFailed = true;\n-        mergeAuthorizationFailures(this.authorizationFailures, authorizationFailures);", "originalCommit": "c0e5da14d99cf03105deebf4cb48832e395121e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA3NjgzNg==", "url": "https://github.com/apache/accumulo/pull/1705#discussion_r489076836", "bodyText": "Sure, I can add that.", "author": "ctubbsii", "createdAt": "2020-09-15T23:38:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAzMzU2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAzNzQ1Mw==", "url": "https://github.com/apache/accumulo/pull/1705#discussion_r489037453", "bodyText": "Possibly add a comment to document the method reason?", "author": "EdColeman", "createdAt": "2020-09-15T22:37:54Z", "path": "server/tserver/src/main/java/org/apache/accumulo/tserver/FileManager.java", "diffHunk": "@@ -372,7 +368,8 @@ private void releaseReaders(KeyExtent tablet, List<FileSKVIterator> readers,\n       for (FileSKVIterator reader : readers) {\n         String fileName = reservedReaders.remove(reader);\n         if (!sawIOException)\n-          getFileList(fileName, openFiles).add(new OpenReader(fileName, reader));", "originalCommit": "c0e5da14d99cf03105deebf4cb48832e395121e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA4NDc4MA==", "url": "https://github.com/apache/accumulo/pull/1705#discussion_r489084780", "bodyText": "For this one, the previous method was an undocumented private one-liner with an unhelpful name that was used only once. I inline'd it automatically with the IDE and verified that the automated inline was performed correctly.\nI have no idea what any of this code in this entire class is trying to do, without possibly hours of investigation, as none of it has helpful comments at all. At this point, I don't think I could come up with anything other than the existing mediocre put files in openFiles comment at the top of the method. I'm disinclined to spend the time it would require to investigate enough to be capable of adding a more useful comment, so I would prefer to defer to the next meaningful refactor of this code. \ud83d\ude3a", "author": "ctubbsii", "createdAt": "2020-09-16T00:04:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAzNzQ1Mw=="}], "type": "inlineReview"}, {"oid": "08847984d887f5948f7893855eb5441968831179", "url": "https://github.com/apache/accumulo/commit/08847984d887f5948f7893855eb5441968831179", "message": "Add comment", "committedDate": "2020-09-15T23:44:37Z", "type": "commit"}]}