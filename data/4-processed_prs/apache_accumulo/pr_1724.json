{"pr_number": 1724, "pr_title": "Update release candidate script", "pr_createdAt": "2020-10-07T06:59:45Z", "pr_url": "https://github.com/apache/accumulo/pull/1724", "timeline": [{"oid": "fbf6780470e7c22182ef46d94b09775b2ab319b8", "url": "https://github.com/apache/accumulo/commit/fbf6780470e7c22182ef46d94b09775b2ab319b8", "message": "Update release candidate script\n\nImproving generated output:\n* show link to staging repo website\n* show full commits\n* show reminders of which buttons to click on the staging site\n* show reminder to replace `$origin` with actual remote name\n* place `-s` in `git tag` command with the other options\n* update draft release notes link to point to staged site\n\nOptimizing performance:\n* create the `-next` branch and switch to it in one command\n* skip tests during release prep because the release can (and should) be\n  tested outside of the actual release candidate creation process and\n  this speeds things up significantly\n* change release prep goal to only do `package`, because it's not\n  necessary to run `verify` during `release:prepare`; all the QA checks\n  done at `verify` can be done before/after release candidate staging\n\nBeing more interactive:\n* prompt for gpg key to use\n* prompt for the `remote` to push to (do not assume `origin`)\n\nRemoving junk:\n* remove check for `gpg2` (modern Linux uses version 2 for the `gpg` binary)\n* remove unnecessary `--test` option and related `runOrFail` function\n* remove `extraReleaseArguments` to simplify things", "committedDate": "2020-10-07T07:09:18Z", "type": "commit"}, {"oid": "fbf6780470e7c22182ef46d94b09775b2ab319b8", "url": "https://github.com/apache/accumulo/commit/fbf6780470e7c22182ef46d94b09775b2ab319b8", "message": "Update release candidate script\n\nImproving generated output:\n* show link to staging repo website\n* show full commits\n* show reminders of which buttons to click on the staging site\n* show reminder to replace `$origin` with actual remote name\n* place `-s` in `git tag` command with the other options\n* update draft release notes link to point to staged site\n\nOptimizing performance:\n* create the `-next` branch and switch to it in one command\n* skip tests during release prep because the release can (and should) be\n  tested outside of the actual release candidate creation process and\n  this speeds things up significantly\n* change release prep goal to only do `package`, because it's not\n  necessary to run `verify` during `release:prepare`; all the QA checks\n  done at `verify` can be done before/after release candidate staging\n\nBeing more interactive:\n* prompt for gpg key to use\n* prompt for the `remote` to push to (do not assume `origin`)\n\nRemoving junk:\n* remove check for `gpg2` (modern Linux uses version 2 for the `gpg` binary)\n* remove unnecessary `--test` option and related `runOrFail` function\n* remove `extraReleaseArguments` to simplify things", "committedDate": "2020-10-07T07:09:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA2OTQ3Nw==", "url": "https://github.com/apache/accumulo/pull/1724#discussion_r501069477", "bodyText": "The prompt to select the fingerprint is nice, this was something I missed.", "author": "milleruntime", "createdAt": "2020-10-07T14:41:57Z", "path": "assemble/build.sh", "diffHunk": "@@ -72,8 +74,43 @@ gitCommits() { pretty %H \"$@\"; }\n gitCommit()  { gitCommits -n1 \"$@\"; }\n gitSubject() { pretty %s \"$@\"; }\n \n+selectFingerprint() {\n+  local f fingerprints=()\n+  if [[ $SELECTED_FINGERPRINT =~ ^[0-9a-fA-F]{40}$ ]]; then\n+    # it's already set, don't set it again\n+    return 0\n+  fi\n+  mapfile -t fingerprints < <(gpg --list-secret-keys --with-colons --with-fingerprint 2>/dev/null | awk -F: '$1 == \"fpr\" {print $10}')\n+  fingerprints+=('Other')\n+  echo\n+  echo \"Select the $(green gpg) key to use:\"\n+  COLUMNS=1\n+  select f in \"${fingerprints[@]}\"; do\n+    if [[ -z $f ]]; then\n+      return 1\n+    elif [[ $f == 'Other' ]]; then\n+      SELECTED_FINGERPRINT=$(prompter \"$(green gpg) key's $(green fingerprint)\" '[0-9a-fA-F]{40}')\n+      return 0\n+    else\n+      SELECTED_FINGERPRINT=\"$f\"\n+      return 0\n+    fi\n+  done\n+}\n+", "originalCommit": "fbf6780470e7c22182ef46d94b09775b2ab319b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NzM2NA==", "url": "https://github.com/apache/accumulo/pull/1724#discussion_r501177364", "bodyText": "Yeah, it helps me, too, because I have several subkeys, and before this change, it was putting all three in the email and I had to delete the extras. Now, I just have to pick the correct one. :)", "author": "ctubbsii", "createdAt": "2020-10-07T17:12:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA2OTQ3Nw=="}], "type": "inlineReview"}]}