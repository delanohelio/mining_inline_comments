{"pr_number": 1716, "pr_title": "Update tool.sh to set correct ZOOKEEPER_CMD.", "pr_createdAt": "2020-09-28T18:21:23Z", "pr_url": "https://github.com/apache/accumulo/pull/1716", "timeline": [{"oid": "b2b229cce71624244edf9850c9e2987b371b8b14", "url": "https://github.com/apache/accumulo/commit/b2b229cce71624244edf9850c9e2987b371b8b14", "message": "Update tool.sh to set correct ZOOKEEPER_CMD.\n\nZooKeeper changed directory structure between versions 3.4 and 3.5. This\nupdate sets the correct ZooKeeper depending upon version used.", "committedDate": "2020-09-28T17:18:25Z", "type": "commit"}, {"oid": "7b755611f3afc9b706dae3147af9c40b1b3dbad5", "url": "https://github.com/apache/accumulo/commit/7b755611f3afc9b706dae3147af9c40b1b3dbad5", "message": "Update tool.sh to set correct ZOOKEEPER_CMD.\n\nRemoved duplicate export line.", "committedDate": "2020-09-28T18:18:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2ODk1MQ==", "url": "https://github.com/apache/accumulo/pull/1716#discussion_r496168951", "bodyText": "I find the regex pattern matching feature of bash to be more reliable than the glob equality feature. Also, the quotes and braces on the left side aren't neeeded.\nHowever, a more fundamental problem: where is ZOOKEEPER_VERSION defined? There is no guarantee it is defined anywhere by anything that calls this script. It should probably do something like what assemble/bin/start-all.sh does.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            if [[ \"${ZOOKEEPER_VERSION}\" = 3.[01234].* ]]; then\n          \n          \n            \n            ZOOKEEPER_VERSION=$(find -L \"$ZOOKEEPER_HOME\" -maxdepth 2 -name \"zookeeper-[0-9]*.jar\" | head -1)\n          \n          \n            \n            if [[ $ZOOKEEPER_VERSION =~ ^3[.][01234].*$ ]]; then", "author": "ctubbsii", "createdAt": "2020-09-28T19:02:12Z", "path": "assemble/bin/tool.sh", "diffHunk": "@@ -36,7 +36,10 @@ if [[ -z \"$ZOOKEEPER_HOME\" ]] ; then\n    exit 1\n fi\n \n-ZOOKEEPER_CMD='ls -1 $ZOOKEEPER_HOME/zookeeper-[0-9]*[^csn].jar '\n+ZOOKEEPER_CMD='ls -1 $ZOOKEEPER_HOME/lib/zookeeper-[0-9]*[^csn].jar '\n+if [[ \"${ZOOKEEPER_VERSION}\" = 3.[01234].* ]]; then", "originalCommit": "7b755611f3afc9b706dae3147af9c40b1b3dbad5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b7209f34a02553da5de8f427e0ea1da6056ea527", "url": "https://github.com/apache/accumulo/commit/b7209f34a02553da5de8f427e0ea1da6056ea527", "message": "Update assemble/bin/tool.sh\r\n\r\nAdd suggested change to guarantee ZOOKEEPER_VERSION is defined. Also update to use regex pattern checking for version.\n\nCo-authored-by: Christopher Tubbs <ctubbsii@apache.org>", "committedDate": "2020-09-28T19:23:14Z", "type": "commit"}]}