{"pr_number": 1934, "pr_title": "Adding per API log feature's and log4j2 UI manipulation docs", "pr_createdAt": "2020-09-22T03:35:00Z", "pr_url": "https://github.com/wso2/docs-apim/pull/1934", "timeline": [{"oid": "9fcb542822aeef51443b37a468420761d226079c", "url": "https://github.com/wso2/docs-apim/commit/9fcb542822aeef51443b37a468420761d226079c", "message": "Setting carbon logs via UI.", "committedDate": "2020-08-31T18:47:04Z", "type": "commit"}, {"oid": "4c6b57bc6f3b8452c09492a16d467ba1474b5921", "url": "https://github.com/wso2/docs-apim/commit/4c6b57bc6f3b8452c09492a16d467ba1474b5921", "message": "Setting carbon logs via UI with images", "committedDate": "2020-08-31T18:52:09Z", "type": "commit"}, {"oid": "ce148f95d75fc9ece4f2e4aa2a6ef736489838cd", "url": "https://github.com/wso2/docs-apim/commit/ce148f95d75fc9ece4f2e4aa2a6ef736489838cd", "message": "Fixing images issue.", "committedDate": "2020-09-03T03:05:55Z", "type": "commit"}, {"oid": "fb527d35da22e3f789a7df9b6506c1e00cf6f5f4", "url": "https://github.com/wso2/docs-apim/commit/fb527d35da22e3f789a7df9b6506c1e00cf6f5f4", "message": "Adding docuementation for log4j and per log features.", "committedDate": "2020-09-22T03:31:34Z", "type": "commit"}, {"oid": "8a96d64e10eb33d166c5b26982231fb528967720", "url": "https://github.com/wso2/docs-apim/commit/8a96d64e10eb33d166c5b26982231fb528967720", "message": "Removing unnecessary doc.", "committedDate": "2020-09-22T06:34:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjU5OTUzOA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492599538", "bodyText": "if you give context/version of the API, how do you enable it for multiple APIs? shall we add an example?", "author": "shaniR", "createdAt": "2020-09-22T09:33:50Z", "path": "en/docs/administer/logging-and-monitoring/logging/gw-api.yaml", "diffHunk": "@@ -0,0 +1,167 @@\n+swagger: '2.0'\n+info:\n+  title: WSO2 API Manager - Gateway\n+  version: v0.9\n+  description: This document specifies a **RESTful API** for WSO2 **API Manager** - Gateway\n+  contact:\n+    name: WSO2\n+    url: 'http://wso2.com/products/api-manager/'\n+    email: architecture@wso2.com\n+  license:\n+    name: Apache 2.0\n+    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'\n+basePath: /api/am/gwapi/v0.9\n+consumes:\n+  - application/json\n+produces:\n+  - application/json\n+paths:\n+  /api-logging:\n+    post:\n+      summary: |\n+        POST logging data of the API with its context template and version\n+      description: |\n+        This operation enables you to provide the API context template(context/version) with the log level (headers, body or all). You should either provide a payload or context and logLevel as query parameters with this API request.\n+      parameters:\n+        - name: Payload\n+          description: |\n+            context and the logLevel can be provided as a payload. This is useful if you want to enable logs for multiple APIs at once.\n+          required: false\n+          in: body\n+          schema:\n+            $ref: '#/definitions/APIList'\n+        - name: context\n+          in: query\n+          description: |\n+            API context ( context/version eg: pizzashack/1.0.0)", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMDUzNQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492630535", "bodyText": "This is already shown once you expand the swagger console.Reference scheme has been provided.", "author": "dinusha92", "createdAt": "2020-09-22T10:29:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjU5OTUzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMTMwOA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492601308", "bodyText": "we usually give out the date the WUM was released. Can we add that info?", "author": "shaniR", "createdAt": "2020-09-22T09:36:48Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging-per-api.md", "diffHunk": "@@ -0,0 +1,62 @@\n+---\n+template: templates/swagger.html\n+---\n+# Setting up logging per API in API Manager\n+\n+!!! note\n+    Enabling logs per API is only available after the WUM update with the timestamp \"1600491803101\"", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMDU4Mg==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492630582", "bodyText": "Fixed", "author": "dinusha92", "createdAt": "2020-09-22T10:30:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMTMwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMTY0Mw==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492601643", "bodyText": "HTTP message flow -> the HTTP message flow", "author": "shaniR", "createdAt": "2020-09-22T09:37:18Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging-per-api.md", "diffHunk": "@@ -0,0 +1,62 @@\n+---\n+template: templates/swagger.html\n+---\n+# Setting up logging per API in API Manager\n+\n+!!! note\n+    Enabling logs per API is only available after the WUM update with the timestamp \"1600491803101\"\n+\n+In a production envrionment, having the feasbility to monitor HTTP message flow for a given API is important in identifying issues in the HTTP message flow.", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMDYzNw==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492630637", "bodyText": "fixed", "author": "dinusha92", "createdAt": "2020-09-22T10:30:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMTY0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMjA3MA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492602070", "bodyText": "API request logging -> logging API requests", "author": "shaniR", "createdAt": "2020-09-22T09:38:08Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging-per-api.md", "diffHunk": "@@ -0,0 +1,62 @@\n+---\n+template: templates/swagger.html\n+---\n+# Setting up logging per API in API Manager\n+\n+!!! note\n+    Enabling logs per API is only available after the WUM update with the timestamp \"1600491803101\"\n+\n+In a production envrionment, having the feasbility to monitor HTTP message flow for a given API is important in identifying issues in the HTTP message flow.\n+\n+This feature enables API requests logging at four levels.", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMDY5MQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492630691", "bodyText": "fixed", "author": "dinusha92", "createdAt": "2020-09-22T10:30:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMjA3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMjc0Ng==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492602746", "bodyText": "Only a user with admin privileges is able to invoke the API", "author": "shaniR", "createdAt": "2020-09-22T09:39:14Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging-per-api.md", "diffHunk": "@@ -0,0 +1,62 @@\n+---\n+template: templates/swagger.html\n+---\n+# Setting up logging per API in API Manager\n+\n+!!! note\n+    Enabling logs per API is only available after the WUM update with the timestamp \"1600491803101\"\n+\n+In a production envrionment, having the feasbility to monitor HTTP message flow for a given API is important in identifying issues in the HTTP message flow.\n+\n+This feature enables API requests logging at four levels.\n+\n+\n+1. Request coming to the gateway from client (request-in>>)\n+2. Request leaving the gateway to backend (request-out<<)\n+3. Request coming to the gateway from backend (response-in>>)\n+4. Request leaving to the client from gateway (response-out<<)\n+\n+Depending on the nature of the request, you can chose only to log headers, body or both.\n+\n+A REST API secured with basic authentication is provided to enable/disable API logs at the run time. Only a user with admin role has priviledges to invoke the API.", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMDc2NA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492630764", "bodyText": "fixed", "author": "dinusha92", "createdAt": "2020-09-22T10:30:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMjc0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMjg3NA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492602874", "bodyText": "remove empty lines", "author": "shaniR", "createdAt": "2020-09-22T09:39:27Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging-per-api.md", "diffHunk": "@@ -0,0 +1,62 @@\n+---\n+template: templates/swagger.html\n+---\n+# Setting up logging per API in API Manager\n+\n+!!! note\n+    Enabling logs per API is only available after the WUM update with the timestamp \"1600491803101\"\n+\n+In a production envrionment, having the feasbility to monitor HTTP message flow for a given API is important in identifying issues in the HTTP message flow.\n+\n+This feature enables API requests logging at four levels.\n+\n+\n+1. Request coming to the gateway from client (request-in>>)\n+2. Request leaving the gateway to backend (request-out<<)\n+3. Request coming to the gateway from backend (response-in>>)\n+4. Request leaving to the client from gateway (response-out<<)\n+\n+Depending on the nature of the request, you can chose only to log headers, body or both.\n+\n+A REST API secured with basic authentication is provided to enable/disable API logs at the run time. Only a user with admin role has priviledges to invoke the API.\n+\n+", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMDgxMA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492630810", "bodyText": "fixed", "author": "dinusha92", "createdAt": "2020-09-22T10:30:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMjg3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMzQ1MQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492603451", "bodyText": "We need to provide steps to find this, to guide a user from the UI.", "author": "shaniR", "createdAt": "2020-09-22T09:40:29Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging-per-api.md", "diffHunk": "@@ -0,0 +1,62 @@\n+---\n+template: templates/swagger.html\n+---\n+# Setting up logging per API in API Manager\n+\n+!!! note\n+    Enabling logs per API is only available after the WUM update with the timestamp \"1600491803101\"\n+\n+In a production envrionment, having the feasbility to monitor HTTP message flow for a given API is important in identifying issues in the HTTP message flow.\n+\n+This feature enables API requests logging at four levels.\n+\n+\n+1. Request coming to the gateway from client (request-in>>)\n+2. Request leaving the gateway to backend (request-out<<)\n+3. Request coming to the gateway from backend (response-in>>)\n+4. Request leaving to the client from gateway (response-out<<)\n+\n+Depending on the nature of the request, you can chose only to log headers, body or both.\n+\n+A REST API secured with basic authentication is provided to enable/disable API logs at the run time. Only a user with admin role has priviledges to invoke the API.\n+\n+\n+\n+\n+??? info \"Click here to see how to try out the APIs\"\n+    Do the following to try out the REST APIs with your local instance of WSO2 API Manager.\n+\n+       1. Expand the relevant API operation and click the **Try It Out** button.", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMTAzNQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492631035", "bodyText": "Swagger UI is there to populate the documentation from the given swagger definition.", "author": "dinusha92", "createdAt": "2020-09-22T10:30:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwMzQ1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwNTc1Mw==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492605753", "bodyText": "same as above.", "author": "shaniR", "createdAt": "2020-09-22T09:44:37Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging.md", "diffHunk": "@@ -66,6 +66,29 @@ Please follow below steps to enable logs for a given service component available\n     loggers = org-wso2-carbon-user-core, trace-messages, org-apache-coyote,com-hazelcast\n     ```\n \n+###Enable Logs for a Component via UI\n+\n+!!! note\n+    Enabling logs via UI is only available after the WUM update with the timestamp \"1600491803101\"", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMTA5NQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492631095", "bodyText": "fixed", "author": "dinusha92", "createdAt": "2020-09-22T10:30:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwNTc1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwNjExNw==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492606117", "bodyText": "please use {{base_path}}", "author": "shaniR", "createdAt": "2020-09-22T09:45:14Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging.md", "diffHunk": "@@ -66,6 +66,29 @@ Please follow below steps to enable logs for a given service component available\n     loggers = org-wso2-carbon-user-core, trace-messages, org-apache-coyote,com-hazelcast\n     ```\n \n+###Enable Logs for a Component via UI\n+\n+!!! note\n+    Enabling logs via UI is only available after the WUM update with the timestamp \"1600491803101\"\n+\n+Please follow below steps to enable logs for a given service component available in WSO2 API Manager.\n+\n+1.  Navigate to the carbon console [https://localhost:9443/carbon](https://localhost:9443/carbon) and sign in with **`admin/admin`** as the credentials.\n+Go to \"Configure\" -> \"Logging\"\n+                                                 \n+    ![Logger Carbon UI](../../../assets/img/administer/logging.png)", "originalCommit": "8a96d64e10eb33d166c5b26982231fb528967720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYzMTQ3Ng==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r492631476", "bodyText": "The local setup did not show the images when the basePath was provided. Could be an issue with local setup. But now I modified using the basepath.", "author": "dinusha92", "createdAt": "2020-09-22T10:31:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYwNjExNw=="}], "type": "inlineReview"}, {"oid": "250da3ec732dad155ca33ae3c593ecf06c73a9aa", "url": "https://github.com/wso2/docs-apim/commit/250da3ec732dad155ca33ae3c593ecf06c73a9aa", "message": "Fixing review changes.", "committedDate": "2020-09-22T10:28:40Z", "type": "commit"}, {"oid": "e48acc21c67f77a03979b05251792ae712c099e1", "url": "https://github.com/wso2/docs-apim/commit/e48acc21c67f77a03979b05251792ae712c099e1", "message": "Reviewed and updated the entire doc\n\nReviewed and updated the entire document", "committedDate": "2020-09-23T00:38:17Z", "type": "commit"}, {"oid": "effb5ec5eae583bb1b4ba4e3110a4142455cef4a", "url": "https://github.com/wso2/docs-apim/commit/effb5ec5eae583bb1b4ba4e3110a4142455cef4a", "message": "Reviewed and updated the full doc\n\nReviewed and updated the full document.", "committedDate": "2020-09-23T01:25:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzEyNDM2NQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r493124365", "bodyText": "@dinusha92 , is it ok to mention Hazelcast here in the note and in the configurations?", "author": "Mariangela", "createdAt": "2020-09-23T01:27:41Z", "path": "en/docs/administer/logging-and-monitoring/logging/setting-up-logging.md", "diffHunk": "@@ -1,74 +1,105 @@\n-# Setting up logging in API Manager\n+# Setting up Logging in API Manager\n \n Logging is one of the most important aspects of a production-grade server. A properly configured logging system is vital for identifying errors, security threats, and usage patterns.\n \n-WSO2 API Manager uses various types of logs to track realtime internal and external activities. Separate log files are created for each of those log types in the `<APIM_HOME>/repository/logs` directory. Following illustrates the log types supported by the APIM and how those logs can be configured.\n+WSO2 API Manager uses various types of logs to track real-time internal and external activities. Separate log files are created for each of those log types in the `<APIM_HOME>/repository/logs` directory. The following illustrates the log types supported by the WSO2 API-M and how those logs can be configured.\n \n-##Carbon Logs\n+## Carbon Logs\n \n-WSO2 API Manager is shipped with log4j2 logging capabilities which generate logs for administrative and server-side activities. By default, carbon logs are persisted in `wso2carbon.log` which is located in `<APIM_HOME>/repository/logs` directory. You can configure the details that are captured in this log file by configuring the `<APIM_HOME>/repository/conf/log4j2.properties`.\n+WSO2 API Manager is shipped with the log4j2 logging capabilities that generate logs for administrative and server-side activities. By default, Carbon Logs are persisted in the `wso2carbon.log` file, which is located in thee `<APIM_HOME>/repository/logs` directory. You can configure the details that are captured in this log file by configuring the `<APIM_HOME>/repository/conf/log4j2.properties` file.\n \n-!!!Java logging and Log4j integration\n+!!! text \"Java Logging and Log4j integration\"\n     In addition to the logs from libraries that use Log4j, all logs from libraries such as, Tomcat and Hazelcast that use Java logging framework are also visible in the same log files. That is, when Java logging is enabled in Carbon, only the Log4j appenders will write to the log files. If the Java Logging Handlers have logs, these logs will be delegated to the log events of the corresponding Log4j appenders. A Pub/Sub registry pattern implementation has been used in the latter mentioned scenario to plug the handlers and appenders. ", "originalCommit": "effb5ec5eae583bb1b4ba4e3110a4142455cef4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE4ODEzNA==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r493188134", "bodyText": "@Mariangela this has been there for a time. Actually I am not aware why this has been added initially.", "author": "dinusha92", "createdAt": "2020-09-23T04:21:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzEyNDM2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzM5MTQ5MQ==", "url": "https://github.com/wso2/docs-apim/pull/1934#discussion_r493391491", "bodyText": "@ruks , please comment whether it is correct to state Hazelcast here", "author": "Mariangela", "createdAt": "2020-09-23T09:54:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzEyNDM2NQ=="}], "type": "inlineReview"}, {"oid": "394b374cd37e392a801a2c2bcc450324861af5af", "url": "https://github.com/wso2/docs-apim/commit/394b374cd37e392a801a2c2bcc450324861af5af", "message": "Minor fix", "committedDate": "2020-09-23T01:32:54Z", "type": "commit"}, {"oid": "45d3f31f3a645bc055e6d5f3cc339db72f402add", "url": "https://github.com/wso2/docs-apim/commit/45d3f31f3a645bc055e6d5f3cc339db72f402add", "message": "minor fix", "committedDate": "2020-09-23T01:33:30Z", "type": "commit"}]}