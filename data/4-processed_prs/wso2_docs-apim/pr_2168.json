{"pr_number": 2168, "pr_title": "[3.2.0] Update Monitoring Server Health Docs", "pr_createdAt": "2020-10-29T05:45:30Z", "pr_url": "https://github.com/wso2/docs-apim/pull/2168", "timeline": [{"oid": "0ad51cf75d361b994c92122f23d76afcef581ab7", "url": "https://github.com/wso2/docs-apim/commit/0ad51cf75d361b994c92122f23d76afcef581ab7", "message": "Adding Server health DOC", "committedDate": "2020-10-29T05:42:16Z", "type": "commit"}, {"oid": "62184b6463320cfe293a5a3f2528269e84fae95d", "url": "https://github.com/wso2/docs-apim/commit/62184b6463320cfe293a5a3f2528269e84fae95d", "message": "Refractor the doc", "committedDate": "2020-10-29T05:53:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc3MzA2Mg==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r517773062", "bodyText": "Why are we skipping the tests? This is not a good thing to mention in the docs.", "author": "pubudu538", "createdAt": "2020-11-05T03:34:20Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n+2.  **User store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n \n !!! note\n-**Note:** This API is only supported for WSO2 Carbon products that are running on Java 8 or a later version.\n-\n-\n-There are three health checkers available by default:\n-\n-1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `master-datasources.xml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n-2.  **Server startup health checker** - This checker uses the ServerAdmin service to check if the server status is RUNNING.\n-3.  **Super tenant user store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n+    This API is only supported for WSO2 API Manager that runs on Java 8 or a later version.\n \n ### Deploying the API\n \n-!!! warning\n-This API is supported by default from WSO2 Identity Server 5.7.0 onwards. It is available by default for WSO2 IS versions 5.5.0 and 5.6.0 only as a WUM update. For more information on how to update using WUM, see [Getting WSO2 Updates](https://docs.wso2.com/display/ADMIN44x/Getting+WSO2+Updates) documentation.\n+This section guides you through deploying the Carbon Health Check components in WSO2 API Manager\n \n-**If you are using a WSO2 product version that supports this feature by default (either in a fresh pack or via a WUM update), skip the instructions in this section and proceed **to the [configuring the API](#MonitoringServerHealth-ConfiguringtheAPI) section.**\n+1. Fork the following GitHub repository.\n \n+     ```https://github.com/wso2/carbon-health-check```\n+     \n+2. Navigate to the place where you want to clone the repo and clone the forked repository. \n \n+     ```git clone https://github.com/[git-username]/carbon-health-check```  \n+   \n+3. Forked Repository is referred to as `<HEALTH_CHECK_HOME>` in this document. Navigate to `<HEALTH_CHECK_HOME>` and build the product.\n+    \n+      ```mvn clean install -Dmaven.test.skip=true```", "originalCommit": "62184b6463320cfe293a5a3f2528269e84fae95d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc3NDY2Mg==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r517774662", "bodyText": "59c40af", "author": "Sarangan0219", "createdAt": "2020-11-05T03:40:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc3MzA2Mg=="}], "type": "inlineReview"}, {"oid": "59c40af02ce240f227fc32c65e2fc722789baa77", "url": "https://github.com/wso2/docs-apim/commit/59c40af02ce240f227fc32c65e2fc722789baa77", "message": "Address review comments", "committedDate": "2020-11-05T03:39:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0ODg1NQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526648855", "bodyText": "can we configure the healthy percentage limit?\nThe \"connection is successful\"  means whether it is alive connection?", "author": "shaniR", "createdAt": "2020-11-19T07:37:05Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc1NTY3OQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526755679", "bodyText": "Yes we can configure it using pool_usage_limit_percentage  . This is documented in DataSource Health Checker section.\nyes it is an alive connection", "author": "Sarangan0219", "createdAt": "2020-11-19T10:33:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0ODg1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0ODkyMg==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526648922", "bodyText": "What does ths JSON Object include?", "author": "shaniR", "createdAt": "2020-11-19T07:37:12Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc1NzI3MA==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526757270", "bodyText": "{\n       \"health\":[\n          {\n             \"key\":\"jdbc/SHARED_DB.connectivity.time.ms\",\n             \"value\":\"0\"\n          },\n          {\n             \"key\":\"WSO2MBStoreDB.connectivity.time.ms\",\n             \"value\":\"0\"\n          },\n          {\n             \"key\":\"jdbc/WSO2CarbonDB.connectivity.time.ms\",\n             \"value\":\"0\"\n          },\n          {\n             \"key\":\"jdbc/WSO2AM_DB.connectivity.time.ms\",\n             \"value\":\"0\"\n          },\n          {\n             \"key\":\"jdbc/WSO2CarbonDB.active.connection.count\",\n             \"value\":\"1\"\n          },\n          {\n             \"key\":\"jdbc/WSO2MetricsDB.active.connection.count\",\n             \"value\":\"1\"\n          },\n          {\n             \"key\":\"jdbc/WSO2MetricsDB.connectivity.time.ms\",\n             \"value\":\"33\"\n          },\n          {\n             \"key\":\"jdbc/WSO2AM_DB.active.connection.count\",\n             \"value\":\"1\"\n          },\n          {\n             \"key\":\"jdbc/SHARED_DB.active.connection.count\",\n             \"value\":\"1\"\n          },\n          {\n             \"key\":\"WSO2MBStoreDB.active.connection.count\",\n             \"value\":\"1\"\n          }\n       ]\n    }\n\nIt has been included in the latter part of this doc.", "author": "Sarangan0219", "createdAt": "2020-11-19T10:36:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0ODkyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0OTI4OA==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526649288", "bodyText": "checks for which user? failure indicating the user is not in the user store?", "author": "shaniR", "createdAt": "2020-11-19T07:38:01Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n+2.  **User store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc5NzM3NQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526797375", "bodyText": "The tool will create a dummy user role in the configured user store manager and try to do the validation. But as it corresponds to the implementation , we can remove this.", "author": "Sarangan0219", "createdAt": "2020-11-19T11:33:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0OTI4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1MDk0Ng==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526650946", "bodyText": "why have we not included this into the product?", "author": "shaniR", "createdAt": "2020-11-19T07:41:31Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n+2.  **User store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n \n !!! note\n-**Note:** This API is only supported for WSO2 Carbon products that are running on Java 8 or a later version.\n-\n-\n-There are three health checkers available by default:\n-\n-1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `master-datasources.xml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n-2.  **Server startup health checker** - This checker uses the ServerAdmin service to check if the server status is RUNNING.\n-3.  **Super tenant user store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n+    This API is only supported for WSO2 API Manager that runs on Java 8 or a later version.\n \n ### Deploying the API\n \n-!!! warning\n-This API is supported by default from WSO2 Identity Server 5.7.0 onwards. It is available by default for WSO2 IS versions 5.5.0 and 5.6.0 only as a WUM update. For more information on how to update using WUM, see [Getting WSO2 Updates](https://docs.wso2.com/display/ADMIN44x/Getting+WSO2+Updates) documentation.\n+This section guides you through deploying the Carbon Health Check components in WSO2 API Manager\n \n-**If you are using a WSO2 product version that supports this feature by default (either in a fresh pack or via a WUM update), skip the instructions in this section and proceed **to the [configuring the API](#MonitoringServerHealth-ConfiguringtheAPI) section.**\n+1. Fork the following GitHub repository.\n \n+     ```https://github.com/wso2/carbon-health-check```\n+     \n+2. Navigate to the place where you want to clone the repo and clone the forked repository. \n \n+     ```git clone https://github.com/[git-username]/carbon-health-check```  \n+   \n+3. Forked Repository is referred to as `<HEALTH_CHECK_HOME>` in this document. Navigate to `<HEALTH_CHECK_HOME>` and build the product.\n+    \n+      ```mvn clean install```\n+      \n+4.  Rename `org.wso2.carbon.healthcheck.api.core-<version-number>-SNAPSHOT.jar` found in the `<HEALTH_CHECK_HOME>/components/org.wso2.carbon.healthcheck.api.core/target` directory as `org.wso2.carbon.healthcheck.api.core-<version-number>.jar`  and paste it in the `<APIM_HOME>/repository/components/dropins` directory.", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc5MzM1MQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526793351", "bodyText": "@pubudu538 Could you please answer this ?", "author": "Sarangan0219", "createdAt": "2020-11-19T11:26:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1MDk0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI1Mjc3Mw==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r534252773", "bodyText": "We can consider adding this to the product. @tharindu1st", "author": "pubudu538", "createdAt": "2020-12-02T15:23:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1MDk0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1MzIzMQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526653231", "bodyText": "what do you mean by the properties will be available at runtime?", "author": "shaniR", "createdAt": "2020-11-19T07:46:14Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n+2.  **User store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n \n !!! note\n-**Note:** This API is only supported for WSO2 Carbon products that are running on Java 8 or a later version.\n-\n-\n-There are three health checkers available by default:\n-\n-1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `master-datasources.xml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n-2.  **Server startup health checker** - This checker uses the ServerAdmin service to check if the server status is RUNNING.\n-3.  **Super tenant user store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n+    This API is only supported for WSO2 API Manager that runs on Java 8 or a later version.\n \n ### Deploying the API\n \n-!!! warning\n-This API is supported by default from WSO2 Identity Server 5.7.0 onwards. It is available by default for WSO2 IS versions 5.5.0 and 5.6.0 only as a WUM update. For more information on how to update using WUM, see [Getting WSO2 Updates](https://docs.wso2.com/display/ADMIN44x/Getting+WSO2+Updates) documentation.\n+This section guides you through deploying the Carbon Health Check components in WSO2 API Manager\n \n-**If you are using a WSO2 product version that supports this feature by default (either in a fresh pack or via a WUM update), skip the instructions in this section and proceed **to the [configuring the API](#MonitoringServerHealth-ConfiguringtheAPI) section.**\n+1. Fork the following GitHub repository.\n \n+     ```https://github.com/wso2/carbon-health-check```\n+     \n+2. Navigate to the place where you want to clone the repo and clone the forked repository. \n \n+     ```git clone https://github.com/[git-username]/carbon-health-check```  \n+   \n+3. Forked Repository is referred to as `<HEALTH_CHECK_HOME>` in this document. Navigate to `<HEALTH_CHECK_HOME>` and build the product.\n+    \n+      ```mvn clean install```\n+      \n+4.  Rename `org.wso2.carbon.healthcheck.api.core-<version-number>-SNAPSHOT.jar` found in the `<HEALTH_CHECK_HOME>/components/org.wso2.carbon.healthcheck.api.core/target` directory as `org.wso2.carbon.healthcheck.api.core-<version-number>.jar`  and paste it in the `<APIM_HOME>/repository/components/dropins` directory.\n \n-This section guides you through deploying the Carbon Health Check components in a WSO2 Carbon product that does not support this feature by default.\n+5.  Copy the webapp `api#health-check#v1.0.war` found in the `<HEALTH_CHECK_HOME>//components/org.wso2.carbon.healthcheck.api.endpoint/target/` directory and paste it in the the `<APIM_HOME>/repository/deployment/server/webapps` directory.\n \n-1.  Download the [org.wso2.carbon.healthcheck.server.feature-&lt;version-number&gt;.zip]({{base_path}}/assets/attachments/126562954/126562955.zip) and extract it. This folder is reffered to as `<API_HOME>` in this document.\n-2.  Copy the `org.wso2.carbon.healthcheck.api.core-<version-number>.jar` found in the `<API_HOME>/plugins` directory and paste it in the `<PRODUCT_HOME>/repository/components/dropins` directory.\n-3.  Copy the webapp `api#health-check#v1.0.war` found in the `<API_HOME>/features/org.wso2.carbon.healthcheck.server_1.0.0` directory and paste it in the the `<PRODUCT_HOME>/repository/deployment/server/webapps` directory.\n-4.  **(Optional step)** Copy the `health-check.config.xml` configuration file found in the `<API_HOME>/features/org.wso2.carbon.healthcheck.server_1.0.0` directory to your `<PRODUCT_HOME>/repository/conf/` directory.\n+### Configuring and invoking the API\n \n-### Configuring the API\n+This feature is disabled by default. To enable the API open the `<API-M_HOME>/repository/conf/deployment.toml` configuration file and update it as follows:.\n+    \n+```\n+[carbon_health_check]\n+enable = true\n+```\n \n-This feature is disabled by default. To enable the API, set the `<Enable>` property in the `health-check-config.xml` file to **true** .\n+This is an open API that should ideally be blocked at the load balancer level. To invoke it, start the WSO2 product and send a GET request to the health check API. A sample cURL command is shown below.\n \n-!!! tip\n-If the feature has not been enabled successfully , a request to the API will only return a 200 OK response.\n+``` java\n+    curl -k -v https://{hostname}:{port}/api/health-check/v1.0/health\n+```  \n+   \n+Data sources health checker and User store health checker will get enabled when you enable health checkers using above global configuration. \n+The properties configured under each health checker will be available for each health checker at runtime.", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc5Mjk4Ng==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526792986", "bodyText": "When the restAPI call is given it will fetch these config values and execute the request on top of these config values.", "author": "Sarangan0219", "createdAt": "2020-11-19T11:26:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1MzIzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1Mzg2Mw==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526653863", "bodyText": "can I select which user stories to be configured? if so how do I specify which user store? what is the value I should add?", "author": "shaniR", "createdAt": "2020-11-19T07:47:31Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n+2.  **User store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n \n !!! note\n-**Note:** This API is only supported for WSO2 Carbon products that are running on Java 8 or a later version.\n-\n-\n-There are three health checkers available by default:\n-\n-1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `master-datasources.xml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n-2.  **Server startup health checker** - This checker uses the ServerAdmin service to check if the server status is RUNNING.\n-3.  **Super tenant user store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n+    This API is only supported for WSO2 API Manager that runs on Java 8 or a later version.\n \n ### Deploying the API\n \n-!!! warning\n-This API is supported by default from WSO2 Identity Server 5.7.0 onwards. It is available by default for WSO2 IS versions 5.5.0 and 5.6.0 only as a WUM update. For more information on how to update using WUM, see [Getting WSO2 Updates](https://docs.wso2.com/display/ADMIN44x/Getting+WSO2+Updates) documentation.\n+This section guides you through deploying the Carbon Health Check components in WSO2 API Manager\n \n-**If you are using a WSO2 product version that supports this feature by default (either in a fresh pack or via a WUM update), skip the instructions in this section and proceed **to the [configuring the API](#MonitoringServerHealth-ConfiguringtheAPI) section.**\n+1. Fork the following GitHub repository.\n \n+     ```https://github.com/wso2/carbon-health-check```\n+     \n+2. Navigate to the place where you want to clone the repo and clone the forked repository. \n \n+     ```git clone https://github.com/[git-username]/carbon-health-check```  \n+   \n+3. Forked Repository is referred to as `<HEALTH_CHECK_HOME>` in this document. Navigate to `<HEALTH_CHECK_HOME>` and build the product.\n+    \n+      ```mvn clean install```\n+      \n+4.  Rename `org.wso2.carbon.healthcheck.api.core-<version-number>-SNAPSHOT.jar` found in the `<HEALTH_CHECK_HOME>/components/org.wso2.carbon.healthcheck.api.core/target` directory as `org.wso2.carbon.healthcheck.api.core-<version-number>.jar`  and paste it in the `<APIM_HOME>/repository/components/dropins` directory.\n \n-This section guides you through deploying the Carbon Health Check components in a WSO2 Carbon product that does not support this feature by default.\n+5.  Copy the webapp `api#health-check#v1.0.war` found in the `<HEALTH_CHECK_HOME>//components/org.wso2.carbon.healthcheck.api.endpoint/target/` directory and paste it in the the `<APIM_HOME>/repository/deployment/server/webapps` directory.\n \n-1.  Download the [org.wso2.carbon.healthcheck.server.feature-&lt;version-number&gt;.zip]({{base_path}}/assets/attachments/126562954/126562955.zip) and extract it. This folder is reffered to as `<API_HOME>` in this document.\n-2.  Copy the `org.wso2.carbon.healthcheck.api.core-<version-number>.jar` found in the `<API_HOME>/plugins` directory and paste it in the `<PRODUCT_HOME>/repository/components/dropins` directory.\n-3.  Copy the webapp `api#health-check#v1.0.war` found in the `<API_HOME>/features/org.wso2.carbon.healthcheck.server_1.0.0` directory and paste it in the the `<PRODUCT_HOME>/repository/deployment/server/webapps` directory.\n-4.  **(Optional step)** Copy the `health-check.config.xml` configuration file found in the `<API_HOME>/features/org.wso2.carbon.healthcheck.server_1.0.0` directory to your `<PRODUCT_HOME>/repository/conf/` directory.\n+### Configuring and invoking the API\n \n-### Configuring the API\n+This feature is disabled by default. To enable the API open the `<API-M_HOME>/repository/conf/deployment.toml` configuration file and update it as follows:.\n+    \n+```\n+[carbon_health_check]\n+enable = true\n+```\n \n-This feature is disabled by default. To enable the API, set the `<Enable>` property in the `health-check-config.xml` file to **true** .\n+This is an open API that should ideally be blocked at the load balancer level. To invoke it, start the WSO2 product and send a GET request to the health check API. A sample cURL command is shown below.\n \n-!!! tip\n-If the feature has not been enabled successfully , a request to the API will only return a 200 OK response.\n+``` java\n+    curl -k -v https://{hostname}:{port}/api/health-check/v1.0/health\n+```  \n+   \n+Data sources health checker and User store health checker will get enabled when you enable health checkers using above global configuration. \n+The properties configured under each health checker will be available for each health checker at runtime.\n \n+#### DataSource Health Checker\n \n-**Sample health-check-config.xml file**\n+This health checker returns the status of the data sources available in the system.\n+To indicate the data source connection pool usage and specify the order, use the following configurations to the `/repository/conf/deployment` file.\n \n-``` java\n-    <CarbonHealthCheckConfigs>\n-        <Enable>true</Enable>\n-        <HealthCheckers>\n-            <HealthChecker name=\"DataSourceHealthChecker\" orderId=\"97\" enable=\"true\">\n-                <!--<Property name=\"monitored.datasources\">jdbc/WSO2CarbonDB,jdbc/WSO2MetricsDB,jdbc/WSO2UMDB</Property>-->\n-                <Property name=\"pool.usage.limit.percentage\">80</Property>\n-            </HealthChecker>\n-            <HealthChecker name=\"SuperTenantUSHealthChecker\" orderId=\"98\" enable=\"true\">\n-                <!--<Property name=\"monitored.user.stores\">primary,sec</Property>-->\n-            </HealthChecker>\n-        </HealthCheckers>\n-    </CarbonHealthCheckConfigs>\n ```\n+    [carbon_health_check.health_checker.data_source_health_checker]\n+    enable = true\n+    pool_usage_limit_percentage = \"80\"\n+    order = \"97\"\n \n--   A health checker can be enabled or disabled using the **`enable`** attribute.\n--   The execution order in which the health checkers are executes can be configured using the **`orderId`** attribute.\n--   The properties configured under each health checker will be available for each heath checker at runtime.\n+    [carbon_health_check.health_checker.data_source_health_checker.properties]\n+    'monitored.datasources' = \"jdbc/WSO2CarbonDB,jdbc/WSO2AM_DB,jdbc/SHARED_DB\"\n+```   \n \n-### Invoking the API\n+| **Configuration**                               | **Description**                          |\n+    | ---------------------------------------------| ------------------------------------ |\n+    |enable                                        | The configuration element is to enable DataSource Health Checker. When `carbon_health_check` is enabled this config will get enabled by default.  |\n+    |pool_usage_limit_percentage                   | This config is used to specify a healthy percentage limit of the maximum allowed connections count. Data health checker checks if the active connection count surpasses the given healthy percentage limit. The default value is `80`. |\n+    |order                                         | The execution order in which the Data Source Health checker is executed. The default value is `97`.|\n+    |monitored.datasources                         | This config is used to specify the Data Sources to be monitored as comma-separated values.|\n+ \n \n-This is an open API which should ideally be blocked at the load balancer level. To invoke it, start the WSO2 product and send a GET request to the health check API. A sample cURL command is shown below.\n+When you invoke the API and User Stores are healthy you can see a response as below:\n \n-``` java\n-    curl -k -v https://{hostname}:{port}/api/health-check/v1.0/health\n ```\n-\n-If the request is successful, you will recieve a 200 OK response (similar to the one shown below) with a list of health check results.\n-\n-``` java\n-    {  \n-       \"health\":[  \n-          {  \n+    {\n+       \"health\":[\n+          {\n+             \"key\":\"jdbc/SHARED_DB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n+             \"key\":\"WSO2MBStoreDB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n+             \"key\":\"jdbc/WSO2CarbonDB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n+             \"key\":\"jdbc/WSO2AM_DB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n              \"key\":\"jdbc/WSO2CarbonDB.active.connection.count\",\n              \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"bpsds.active.connection.count\",\n+          {\n+             \"key\":\"jdbc/WSO2MetricsDB.active.connection.count\",\n              \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"jdbc/WSO2MetricsDB.connectivityTime.ms\",\n-             \"value\":\"81\"\n+          {\n+             \"key\":\"jdbc/WSO2MetricsDB.connectivity.time.ms\",\n+             \"value\":\"33\"\n           },\n-          {  \n-             \"key\":\"jdbc/WSO2MetricsDB.active.connection.count\",\n+          {\n+             \"key\":\"jdbc/WSO2AM_DB.active.connection.count\",\n              \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"jdbc/WSO2CarbonDB.connectivityTime.ms\",\n-             \"value\":\"0\"\n+          {\n+             \"key\":\"jdbc/SHARED_DB.active.connection.count\",\n+             \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"bpsds.connectivityTime.ms\",\n-             \"value\":\"0\"\n+          {\n+             \"key\":\"WSO2MBStoreDB.active.connection.count\",\n+             \"value\":\"1\"\n           }\n        ]\n     }\n ```\n \n -   The `active.connection.count` parameter reflects the number of connections that are active.\n \n--`ConnectivityTime` refers to the the duration of the connection.\n+-   `ConnectivityTime` refers to the duration of the connection.\n+\n+#### User Store Health Checker\n+\n+This health checker returns the status of the user stores available in the system. You can configure the user stores to be monitored by adding the following configuration.", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc5MTg2NA==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526791864", "bodyText": "Yes you can configure the user stores to be configured.\n    [carbon_health_check.health_checker.super_tenant_health_checker.properties]\n    'monitored.user.stores' = \"primary\" \n\nThis config is included in the latter part of the doc", "author": "Sarangan0219", "createdAt": "2020-11-19T11:24:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1Mzg2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1NTU0NQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526655545", "bodyText": "highest is given priorty or lowest?", "author": "shaniR", "createdAt": "2020-11-19T07:50:58Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-server-health.md", "diffHunk": "@@ -1,118 +1,163 @@\n # Monitoring Server Health\n \n-!!! warning\n-This document is work in progress!\n+**Health Check API** is used to validate and verify the status of the APIM server and its dependencies\n+It is a REST service which returns the operational status, performance information of the configured endpoints with appropriate HTTP return code and a JSON object\n+There are two health checkers available by default:\n \n-\n-The Carbon Health Check API can be used to check the health of a Carbon server. The sections below guide you through using this API.\n-\n--   [Deploying the API](#MonitoringServerHealth-DeployingtheAPI)\n--   [Configuring the API](#MonitoringServerHealth-ConfiguringtheAPI)\n--   [Invoking the API](#MonitoringServerHealth-InvokingtheAPI)\n--   [Error responses](#MonitoringServerHealth-Errorresponses)\n--   [Adding new health checkers](#MonitoringServerHealth-Addingnewhealthcheckers)\n+1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `<API-M_HOME>/repository/conf/deployment.toml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n+2.  **User store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n \n !!! note\n-**Note:** This API is only supported for WSO2 Carbon products that are running on Java 8 or a later version.\n-\n-\n-There are three health checkers available by default:\n-\n-1.  **Data sources health checker** - This checker goes through the data sources that are configured in the `master-datasources.xml` file and checks if the active connection count surpasses a healthy percentage limit (e.g., 80%) of the maximum allowed connections count. This checker also tests the connection from each data source to see whether the connection is successful.\n-2.  **Server startup health checker** - This checker uses the ServerAdmin service to check if the server status is RUNNING.\n-3.  **Super tenant user store health checker** - This checker iterates through configured user stores of the super tenant domain and attempts to invoke the `isExistingUser` method to check whether a failure occurs.\n+    This API is only supported for WSO2 API Manager that runs on Java 8 or a later version.\n \n ### Deploying the API\n \n-!!! warning\n-This API is supported by default from WSO2 Identity Server 5.7.0 onwards. It is available by default for WSO2 IS versions 5.5.0 and 5.6.0 only as a WUM update. For more information on how to update using WUM, see [Getting WSO2 Updates](https://docs.wso2.com/display/ADMIN44x/Getting+WSO2+Updates) documentation.\n+This section guides you through deploying the Carbon Health Check components in WSO2 API Manager\n \n-**If you are using a WSO2 product version that supports this feature by default (either in a fresh pack or via a WUM update), skip the instructions in this section and proceed **to the [configuring the API](#MonitoringServerHealth-ConfiguringtheAPI) section.**\n+1. Fork the following GitHub repository.\n \n+     ```https://github.com/wso2/carbon-health-check```\n+     \n+2. Navigate to the place where you want to clone the repo and clone the forked repository. \n \n+     ```git clone https://github.com/[git-username]/carbon-health-check```  \n+   \n+3. Forked Repository is referred to as `<HEALTH_CHECK_HOME>` in this document. Navigate to `<HEALTH_CHECK_HOME>` and build the product.\n+    \n+      ```mvn clean install```\n+      \n+4.  Rename `org.wso2.carbon.healthcheck.api.core-<version-number>-SNAPSHOT.jar` found in the `<HEALTH_CHECK_HOME>/components/org.wso2.carbon.healthcheck.api.core/target` directory as `org.wso2.carbon.healthcheck.api.core-<version-number>.jar`  and paste it in the `<APIM_HOME>/repository/components/dropins` directory.\n \n-This section guides you through deploying the Carbon Health Check components in a WSO2 Carbon product that does not support this feature by default.\n+5.  Copy the webapp `api#health-check#v1.0.war` found in the `<HEALTH_CHECK_HOME>//components/org.wso2.carbon.healthcheck.api.endpoint/target/` directory and paste it in the the `<APIM_HOME>/repository/deployment/server/webapps` directory.\n \n-1.  Download the [org.wso2.carbon.healthcheck.server.feature-&lt;version-number&gt;.zip]({{base_path}}/assets/attachments/126562954/126562955.zip) and extract it. This folder is reffered to as `<API_HOME>` in this document.\n-2.  Copy the `org.wso2.carbon.healthcheck.api.core-<version-number>.jar` found in the `<API_HOME>/plugins` directory and paste it in the `<PRODUCT_HOME>/repository/components/dropins` directory.\n-3.  Copy the webapp `api#health-check#v1.0.war` found in the `<API_HOME>/features/org.wso2.carbon.healthcheck.server_1.0.0` directory and paste it in the the `<PRODUCT_HOME>/repository/deployment/server/webapps` directory.\n-4.  **(Optional step)** Copy the `health-check.config.xml` configuration file found in the `<API_HOME>/features/org.wso2.carbon.healthcheck.server_1.0.0` directory to your `<PRODUCT_HOME>/repository/conf/` directory.\n+### Configuring and invoking the API\n \n-### Configuring the API\n+This feature is disabled by default. To enable the API open the `<API-M_HOME>/repository/conf/deployment.toml` configuration file and update it as follows:.\n+    \n+```\n+[carbon_health_check]\n+enable = true\n+```\n \n-This feature is disabled by default. To enable the API, set the `<Enable>` property in the `health-check-config.xml` file to **true** .\n+This is an open API that should ideally be blocked at the load balancer level. To invoke it, start the WSO2 product and send a GET request to the health check API. A sample cURL command is shown below.\n \n-!!! tip\n-If the feature has not been enabled successfully , a request to the API will only return a 200 OK response.\n+``` java\n+    curl -k -v https://{hostname}:{port}/api/health-check/v1.0/health\n+```  \n+   \n+Data sources health checker and User store health checker will get enabled when you enable health checkers using above global configuration. \n+The properties configured under each health checker will be available for each health checker at runtime.\n \n+#### DataSource Health Checker\n \n-**Sample health-check-config.xml file**\n+This health checker returns the status of the data sources available in the system.\n+To indicate the data source connection pool usage and specify the order, use the following configurations to the `/repository/conf/deployment` file.\n \n-``` java\n-    <CarbonHealthCheckConfigs>\n-        <Enable>true</Enable>\n-        <HealthCheckers>\n-            <HealthChecker name=\"DataSourceHealthChecker\" orderId=\"97\" enable=\"true\">\n-                <!--<Property name=\"monitored.datasources\">jdbc/WSO2CarbonDB,jdbc/WSO2MetricsDB,jdbc/WSO2UMDB</Property>-->\n-                <Property name=\"pool.usage.limit.percentage\">80</Property>\n-            </HealthChecker>\n-            <HealthChecker name=\"SuperTenantUSHealthChecker\" orderId=\"98\" enable=\"true\">\n-                <!--<Property name=\"monitored.user.stores\">primary,sec</Property>-->\n-            </HealthChecker>\n-        </HealthCheckers>\n-    </CarbonHealthCheckConfigs>\n ```\n+    [carbon_health_check.health_checker.data_source_health_checker]\n+    enable = true\n+    pool_usage_limit_percentage = \"80\"\n+    order = \"97\"\n \n--   A health checker can be enabled or disabled using the **`enable`** attribute.\n--   The execution order in which the health checkers are executes can be configured using the **`orderId`** attribute.\n--   The properties configured under each health checker will be available for each heath checker at runtime.\n+    [carbon_health_check.health_checker.data_source_health_checker.properties]\n+    'monitored.datasources' = \"jdbc/WSO2CarbonDB,jdbc/WSO2AM_DB,jdbc/SHARED_DB\"\n+```   \n \n-### Invoking the API\n+| **Configuration**                               | **Description**                          |\n+    | ---------------------------------------------| ------------------------------------ |\n+    |enable                                        | The configuration element is to enable DataSource Health Checker. When `carbon_health_check` is enabled this config will get enabled by default.  |\n+    |pool_usage_limit_percentage                   | This config is used to specify a healthy percentage limit of the maximum allowed connections count. Data health checker checks if the active connection count surpasses the given healthy percentage limit. The default value is `80`. |\n+    |order                                         | The execution order in which the Data Source Health checker is executed. The default value is `97`.|\n+    |monitored.datasources                         | This config is used to specify the Data Sources to be monitored as comma-separated values.|\n+ \n \n-This is an open API which should ideally be blocked at the load balancer level. To invoke it, start the WSO2 product and send a GET request to the health check API. A sample cURL command is shown below.\n+When you invoke the API and User Stores are healthy you can see a response as below:\n \n-``` java\n-    curl -k -v https://{hostname}:{port}/api/health-check/v1.0/health\n ```\n-\n-If the request is successful, you will recieve a 200 OK response (similar to the one shown below) with a list of health check results.\n-\n-``` java\n-    {  \n-       \"health\":[  \n-          {  \n+    {\n+       \"health\":[\n+          {\n+             \"key\":\"jdbc/SHARED_DB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n+             \"key\":\"WSO2MBStoreDB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n+             \"key\":\"jdbc/WSO2CarbonDB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n+             \"key\":\"jdbc/WSO2AM_DB.connectivity.time.ms\",\n+             \"value\":\"0\"\n+          },\n+          {\n              \"key\":\"jdbc/WSO2CarbonDB.active.connection.count\",\n              \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"bpsds.active.connection.count\",\n+          {\n+             \"key\":\"jdbc/WSO2MetricsDB.active.connection.count\",\n              \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"jdbc/WSO2MetricsDB.connectivityTime.ms\",\n-             \"value\":\"81\"\n+          {\n+             \"key\":\"jdbc/WSO2MetricsDB.connectivity.time.ms\",\n+             \"value\":\"33\"\n           },\n-          {  \n-             \"key\":\"jdbc/WSO2MetricsDB.active.connection.count\",\n+          {\n+             \"key\":\"jdbc/WSO2AM_DB.active.connection.count\",\n              \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"jdbc/WSO2CarbonDB.connectivityTime.ms\",\n-             \"value\":\"0\"\n+          {\n+             \"key\":\"jdbc/SHARED_DB.active.connection.count\",\n+             \"value\":\"1\"\n           },\n-          {  \n-             \"key\":\"bpsds.connectivityTime.ms\",\n-             \"value\":\"0\"\n+          {\n+             \"key\":\"WSO2MBStoreDB.active.connection.count\",\n+             \"value\":\"1\"\n           }\n        ]\n     }\n ```\n \n -   The `active.connection.count` parameter reflects the number of connections that are active.\n \n--`ConnectivityTime` refers to the the duration of the connection.\n+-   `ConnectivityTime` refers to the duration of the connection.\n+\n+#### User Store Health Checker\n+\n+This health checker returns the status of the user stores available in the system. You can configure the user stores to be monitored by adding the following configuration.\n+\n+```\n+    [carbon_health_check.health_checker.data_source_health_checker]\n+    enable =false\n+    order = 98\n+\n+    [carbon_health_check.health_checker.super_tenant_health_checker.properties]\n+    'monitored.user.stores' = \"primary\" \n+```\n+\n+| **Configuration**                               | **Description**                          |\n+    | ---------------------------------------------| ------------------------------------ |\n+    |enable                                        | The configuration element is to enable DataSource Health Checker. When `carbon_health_check` is enabled this config will get enabled by default.  |\n+    |order                                         | The execution order in which the User Store Health checker is executed. The default value is `98`.|", "originalCommit": "59c40af02ce240f227fc32c65e2fc722789baa77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc5MDI4Mw==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r526790283", "bodyText": "Lowest is given the priority", "author": "Sarangan0219", "createdAt": "2020-11-19T11:23:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY1NTU0NQ=="}], "type": "inlineReview"}, {"oid": "b46531bca7e350464bf524c5402cd32d6bdb0311", "url": "https://github.com/wso2/docs-apim/commit/b46531bca7e350464bf524c5402cd32d6bdb0311", "message": "Reviewed and updated the full doc", "committedDate": "2020-12-02T13:37:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE3Mzk4OQ==", "url": "https://github.com/wso2/docs-apim/pull/2168#discussion_r534173989", "bodyText": "Add // in the path is incorrect.", "author": "Mariangela", "createdAt": "2020-12-02T13:41:01Z", "path": "en/mkdocs.yml", "diffHunk": "@@ -501,6 +501,7 @@ nav:\n                 - Enabling Tracing with OpenTracing: administer/logging-and-monitoring/monitoring//monitoring-with-opentracing.md\n                 - JMX-Based Monitoring: administer/logging-and-monitoring/monitoring//jmx-based-monitoring.md\n                 - Monitoring TCP-Based Messages: administer/logging-and-monitoring/monitoring//monitoring-tcp-based-messages.md\n+                - Monitoring Server Health: administer/logging-and-monitoring/monitoring//monitoring-server-health.md", "originalCommit": "b46531bca7e350464bf524c5402cd32d6bdb0311", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bf6718d6c408ddf35e2f3ffb75826996f600d7ee", "url": "https://github.com/wso2/docs-apim/commit/bf6718d6c408ddf35e2f3ffb75826996f600d7ee", "message": "Fixed syntax", "committedDate": "2020-12-02T13:45:52Z", "type": "commit"}, {"oid": "c67fcb6d7e8567ad4cc97566b4ad7a1c3728485f", "url": "https://github.com/wso2/docs-apim/commit/c67fcb6d7e8567ad4cc97566b4ad7a1c3728485f", "message": "Fixed typo in username", "committedDate": "2020-12-02T14:09:45Z", "type": "commit"}]}