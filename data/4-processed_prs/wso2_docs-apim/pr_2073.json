{"pr_number": 2073, "pr_title": "[3.0.0] Add docs to configure IS as extenral IDP using OIDC and SAML", "pr_createdAt": "2020-10-15T04:33:01Z", "pr_url": "https://github.com/wso2/docs-apim/pull/2073", "timeline": [{"oid": "f0057032271d7b740f39ed87afce1fa55858bc91", "url": "https://github.com/wso2/docs-apim/commit/f0057032271d7b740f39ed87afce1fa55858bc91", "message": "Add docs to configure IS as IDP using OIDC", "committedDate": "2020-10-14T11:38:43Z", "type": "commit"}, {"oid": "c65b1c5ab701c18d4925682dfba10ddfd4eb16e8", "url": "https://github.com/wso2/docs-apim/commit/c65b1c5ab701c18d4925682dfba10ddfd4eb16e8", "message": "Add images related to sso configuration with IS", "committedDate": "2020-10-15T04:30:35Z", "type": "commit"}, {"oid": "0f0cd5563c42c035e28880ea56cf68cb383d8a27", "url": "https://github.com/wso2/docs-apim/commit/0f0cd5563c42c035e28880ea56cf68cb383d8a27", "message": "Add docs to configure external IS as IDP with SAML", "committedDate": "2020-10-20T06:06:12Z", "type": "commit"}, {"oid": "5ef87748de878bdfaea51c5406f6d8081b7f7a22", "url": "https://github.com/wso2/docs-apim/commit/5ef87748de878bdfaea51c5406f6d8081b7f7a22", "message": "Reviewed and updated full doc", "committedDate": "2020-11-03T17:54:45Z", "type": "commit"}, {"oid": "c39c6c8dd722712aef8ffa39ea66c7f70dda4082", "url": "https://github.com/wso2/docs-apim/commit/c39c6c8dd722712aef8ffa39ea66c7f70dda4082", "message": "Reviewed and updated full doc", "committedDate": "2020-11-03T18:10:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg2MzQwMw==", "url": "https://github.com/wso2/docs-apim/pull/2073#discussion_r516863403", "bodyText": "Rename \"upload-certificate-in-SP-for-saml2-sso.png\" as capital letters should not be added in images and file names.", "author": "Mariangela", "createdAt": "2020-11-03T18:11:29Z", "path": "en/docs/install-and-setup/sso/configure-identity-server-as-external-idp-using-saml.md", "diffHunk": "@@ -0,0 +1,262 @@\n+# Configuring Identity Server as External IDP using SAML\n+\n+The Single Sign-On with SAML 2.0 feature in the API Manager is implemented according to the SAML 2.0 browser-based SSO support that is facilitated by WSO2 Identity Server. This feature is available in any WSO2 IS version from 4.1.0 onwards. WSO2 IS 5.9.0 is used in this guide. WSO2 Identity Server acts as an identity Service Provider of systems enabled with single sign-on, while the Web applications act as SSO Service Providers. Using this feature, you can configure SSO with SAML 2.0 across the API Publisher and Developer Portal. After configuring, you can access the Developer Portal or API Publisher in a single authentication attempt.\n+\n+## Prerequisites\n+\n+1. Download the API Manager 3.0.0 distribution.\n+     1. Access the [previous WSO2 API Manager related releases](https://wso2.com/api-management/previous-releases/).\n+     2. Select version 3.0.0.\n+     3. Download the API Manager.\n+\n+2. Download the Identity Server 5.9.0 distribution from [https://wso2.com/identity-and-access-management/](https://wso2.com/identity-and-access-management/).\n+\n+    !!! Info\n+        To use WSO2 IS as the Key Manager, download the **WSO2 Identity Server 5.9.0 as a Key Manager** pack, with pre-packaged Key Manager features as follows:\n+\n+        1. Access the [previous WSO2 API Manager related releases](https://wso2.com/api-management/previous-releases/).\n+        2. Select version 3.0.0.\n+        3. Click on the **Identity Server as a Key Manager** download option.\n+\n+    !!! Tip\n+        For **testing purposes** if you want to run both the WSO2 API Manager and WSO2 Identity Server on the same server, then you can go to the `<IS_HOME>/repository/conf/deployment.toml` file and offset the port by 1 by adding the following configuration:\n+\n+        ``` toml\n+        [server]\n+        offset=1\n+        ```\n+\n+3.  Start the servers using the following commands:\n+\n+    ``` tab=\"On Windows\"\n+    wso2server.bat --run\n+    ```\n+\n+    ``` tab=\"On Linux/Mac OS\"\n+    sh wso2server.sh\n+    ```\n+\n+## Step 1 - Configure WSO2 Identity Server\n+\n+### Step 1.1 - Configure the Service Provider\n+\n+1.  Sign in to the Management Console of IS server.  \n+\n+    ```\n+    https://{is-ip}:9444/carbon\n+    ```\n+\n+2.  Navigate to the **Service Providers** section under **Main** \u2192 **Identity** and create a new Service Provider.\n+\n+3.  Edit the created Service Provider:\n+\n+    1.  Expand the **Inbound Authentication Configuration** section and configure the **SAML2 Web SSO Configuration** by providing the following information:\n+\n+        <table>\n+        <tbody>\n+            <tr>\n+                <td>Issuer</td>\n+                <td>Specify the Issuer</td>\n+            </tr>\n+            <tr>\n+                <td>Assertion Consumer URLs</td>\n+                <td>`https://{apim-ip}:9443/commonauth`</td>\n+            </tr>\n+            <tr>\n+                <td>Response Signing Algorithm</td>\n+                <td>`http://www.w3.org/2001/04/xmldsig-more#rsa-sha256`</td>\n+            </tr>\n+            <tr>\n+                <td>Enable Response Signing</td>\n+                <td>true</td>\n+            </tr>\n+            <tr>\n+                <td>Enable Signature Validation in Authentication Requests and Logout Requests</td>\n+                <td>true</td>\n+            </tr>\n+            <tr>\n+                <td>Enable Single Logout</td>\n+                <td>true</td>\n+            </tr>\n+            <tr>\n+                <td>Enable Attribute Profile</td>\n+                <td>true</td>\n+            </tr>\n+            <tr>\n+                <td>Include Attributes in the Response Always</td>\n+                <td>true</td>\n+            </tr>\n+        </tbody>\n+        </table>\n+\n+        The following image shows the sample values for SAML2 Web SSO configuration:\n+\n+        [![SAML configuration in Service Provider]({{base_path}}/assets/img/setup-and-install/saml-configuration-in-service-provider.png)]({{base_path}}/assets/img/setup-and-install/saml-configuration-in-service-provider.png)\n+\n+        ??? Info \"Enable a tenant-specific SSO for the Publisher and Developer Portal\"\n+\n+            To enable a tenant-specific SSO with IS 5.9.0 for Publisher and the Developer Portal, enable the **Use tenant domain in local subject identifier** option under the **Local & Outbound Authentication Configuration** section.\n+\n+            [![saml-configuration-in-service-provider]({{base_path}}/assets/img/setup-and-install/enable-tenant-domain-in-local-sub-identifier.png)]({{base_path}}/assets/img/setup-and-install/enable-tenant-domain-in-local-sub-identifier.png)\n+\n+    2.  Expand the **Claim Configuration** section and add **http://wso2.org/claims/role** as a mandatory claim.\n+\n+        [![Claim configuration in Service Provider for SAML2 SSO]({{base_path}}/assets/img/setup-and-install/claim-configuration-in-service-provider-for-saml2-sso.png)]({{base_path}}/assets/img/setup-and-install/claim-configuration-in-service-provider-for-saml2-sso.png)\n+\n+    3.  Update the Service Provider configurations.\n+\n+        !!! Info \"In multi-tenanted environments\"\n+            Carry out the instruction given below for all the tenants to be able to sign in to the API-M Web applications in a multi-tenanted environment.\n+\n+            1. Click the **SaaS Application** option that appears after registering the Service Provider.\n+\n+               [![saas-configuration-in-service-provider]({{base_path}}/assets/img/setup-and-install/saas.png)]({{base_path}}/assets/img/setup-and-install/saas.png)            \n+\n+            If you do not select the **SaaS Application** option, only users in the current tenant domain will be allowed to sign in to the portals. You will need to register separate Service Providers for portals from each tenant.\n+\n+4.  Upload the public certificate of the API Manager by selecting **Select SP Certificate Type**.\n+\n+    [![Upload certificate in SP for SAML2 SSO]({{base_path}}/assets/img/setup-and-install/upload-certificate-in-SP-for-saml2-sso.png)]({{base_path}}/assets/img/setup-and-install/upload-certificate-in-SP-for-saml2-sso.png)", "originalCommit": "c39c6c8dd722712aef8ffa39ea66c7f70dda4082", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI1NTI1Mg==", "url": "https://github.com/wso2/docs-apim/pull/2073#discussion_r517255252", "bodyText": "Created action item [1] for this issue.\n[1] #2195", "author": "Mariangela", "createdAt": "2020-11-04T10:48:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg2MzQwMw=="}], "type": "inlineReview"}, {"oid": "f13e5e621d26778f49bdbdaf066bde8f067f75ed", "url": "https://github.com/wso2/docs-apim/commit/f13e5e621d26778f49bdbdaf066bde8f067f75ed", "message": "Reviewed fix", "committedDate": "2020-11-03T18:13:55Z", "type": "commit"}, {"oid": "aa17fc2fe1b2b476dda11814179ecdea6307656d", "url": "https://github.com/wso2/docs-apim/commit/aa17fc2fe1b2b476dda11814179ecdea6307656d", "message": "Updated", "committedDate": "2020-11-03T18:17:52Z", "type": "commit"}, {"oid": "2f7a9300b7abd84cfdb872b0110edbb83b6e667d", "url": "https://github.com/wso2/docs-apim/commit/2f7a9300b7abd84cfdb872b0110edbb83b6e667d", "message": "Removed upper case in image\n\nRemoved upper case in upload-certificate-in-SP-for-saml2-sso.png", "committedDate": "2020-11-04T10:45:40Z", "type": "commit"}]}