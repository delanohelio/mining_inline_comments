{"pr_number": 965, "pr_title": "add sso using okta docs", "pr_createdAt": "2020-04-02T05:08:56Z", "pr_url": "https://github.com/wso2/docs-apim/pull/965", "timeline": [{"oid": "0160af021a2c52f6c9271c8aecdff4d154e6e03e", "url": "https://github.com/wso2/docs-apim/commit/0160af021a2c52f6c9271c8aecdff4d154e6e03e", "message": "initial external idp sso", "committedDate": "2020-04-02T04:50:53Z", "type": "commit"}, {"oid": "13a560fc6c50968fed76711976cd92d547abb0a5", "url": "https://github.com/wso2/docs-apim/commit/13a560fc6c50968fed76711976cd92d547abb0a5", "message": "move okta sso doc", "committedDate": "2020-04-02T04:50:53Z", "type": "commit"}, {"oid": "5b69b8e6572e742a3b90ce0ffc3d6f01827a19b9", "url": "https://github.com/wso2/docs-apim/commit/5b69b8e6572e742a3b90ce0ffc3d6f01827a19b9", "message": "okta external idp sso saml", "committedDate": "2020-04-02T04:52:13Z", "type": "commit"}, {"oid": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "url": "https://github.com/wso2/docs-apim/commit/7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "message": "update okta link", "committedDate": "2020-04-02T04:52:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NTExMw==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402055113", "bodyText": "pre-requisite/pre-requisites", "author": "isharac", "createdAt": "2020-04-02T05:12:12Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTM0OQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081349", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:35:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NTExMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NzA0MA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402057040", "bodyText": "This is not compulsory since wso2 server can facilitate both normal and email user names at once .So how about adding a note on that and how one can do it if needed as well.", "author": "isharac", "createdAt": "2020-04-02T05:19:02Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA3NDAxMA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402074010", "bodyText": "If this is not enabled email username will fail. Tried it and seems like it does not work without enabling. If it is enabled both normal and email works", "author": "dushansilva", "createdAt": "2020-04-02T06:15:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NzA0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTY4OA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081688", "bodyText": "+1", "author": "isharac", "createdAt": "2020-04-02T06:36:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NzA0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NzUxMQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402057511", "bodyText": "typo\na the user role.", "author": "isharac", "createdAt": "2020-04-02T05:20:51Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTM4NA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081384", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:35:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1NzUxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1ODcwNw==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402058707", "bodyText": "publisher/ Publisher\ndevportal/Developer Portal\n@shaniR @Mariangela wdyt?", "author": "isharac", "createdAt": "2020-04-02T05:25:11Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+4. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+5. Next we need to add the claims that needs to be returned from the ID Token in okta. These are the claims we will be used to map the user details to WSO2 API-Manager side. Navigate to API -> Authorization Servers and select the default server\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims.png)]({{base_path}}/assets/img/learn/okta-add-new-claims.png) \n+\n+6. Add the following two claims\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png) \n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+\n+### Setup API-Manager\n+\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to publisher and devportal", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTQyNQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081425", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:35:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1ODcwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1OTQ2Mw==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402059463", "bodyText": "publisher/ apim_publisher", "author": "isharac", "createdAt": "2020-04-02T05:28:03Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+4. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+5. Next we need to add the claims that needs to be returned from the ID Token in okta. These are the claims we will be used to map the user details to WSO2 API-Manager side. Navigate to API -> Authorization Servers and select the default server\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims.png)]({{base_path}}/assets/img/learn/okta-add-new-claims.png) \n+\n+6. Add the following two claims\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png) \n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+\n+### Setup API-Manager\n+\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to publisher and devportal\n+\n+4. Login in to `https://localhost:9443/carbon` & Click on add in identity providers section. Enter Identity Provider Name. Expand Federated authenticators -> OAuth2/OpenID connect configuration add the following details. \n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png) \n+<table>\n+    <colgroup>\n+        <col />\n+        <col />\n+        <col />\n+    </colgroup>\n+    <tbody>\n+        <tr>\n+            <th colspan=\"2\">Field</th>\n+            <th>Sample value</th>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Enable OAuth2/OpenIDConnect</td>\n+            <td class=\"confluenceTd\">True</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client id</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client secret</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Authorization Endpoint URL</td>\n+            <td class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/authorize</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Token Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/token</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">callback url</td>\n+            <td class=\"confluenceTd\">\n+                https://localhost:9443/commonauth\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Userinfo Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/userinfo\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Logout Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/logout\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Additional Query Parameters</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                scope=openid%20profile\n+            </td>\n+        </tr>\n+    </tbody>\n+</table>\n+\n+5. Expand Claim configuration -> Basic claim configuration and add the following claim configurations\n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png) \n+\n+6. Expand Role configuration and add the following role. Here we check if the user that is being logged in has the role `any` and assign him the local role okta_role\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-role-mapping.png\"/>\n+\n+7. Enable Just in time provisioning so that the user will be saved in the API-Manager user store\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-jit.png\"/>\n+\n+8. Navigate to Service providers -> list as shown below. There are two service providers created apim_publisher, apim_devportal. Click on edit on publisher.", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTQ1OA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081458", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:35:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA1OTQ2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MDExNg==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402060116", "bodyText": "Publisher\nDeveloper Portal", "author": "isharac", "createdAt": "2020-04-02T05:30:23Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+4. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+5. Next we need to add the claims that needs to be returned from the ID Token in okta. These are the claims we will be used to map the user details to WSO2 API-Manager side. Navigate to API -> Authorization Servers and select the default server\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims.png)]({{base_path}}/assets/img/learn/okta-add-new-claims.png) \n+\n+6. Add the following two claims\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png) \n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+\n+### Setup API-Manager\n+\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to publisher and devportal\n+\n+4. Login in to `https://localhost:9443/carbon` & Click on add in identity providers section. Enter Identity Provider Name. Expand Federated authenticators -> OAuth2/OpenID connect configuration add the following details. \n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png) \n+<table>\n+    <colgroup>\n+        <col />\n+        <col />\n+        <col />\n+    </colgroup>\n+    <tbody>\n+        <tr>\n+            <th colspan=\"2\">Field</th>\n+            <th>Sample value</th>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Enable OAuth2/OpenIDConnect</td>\n+            <td class=\"confluenceTd\">True</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client id</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client secret</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Authorization Endpoint URL</td>\n+            <td class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/authorize</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Token Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/token</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">callback url</td>\n+            <td class=\"confluenceTd\">\n+                https://localhost:9443/commonauth\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Userinfo Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/userinfo\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Logout Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/logout\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Additional Query Parameters</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                scope=openid%20profile\n+            </td>\n+        </tr>\n+    </tbody>\n+</table>\n+\n+5. Expand Claim configuration -> Basic claim configuration and add the following claim configurations\n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png) \n+\n+6. Expand Role configuration and add the following role. Here we check if the user that is being logged in has the role `any` and assign him the local role okta_role\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-role-mapping.png\"/>\n+\n+7. Enable Just in time provisioning so that the user will be saved in the API-Manager user store\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-jit.png\"/>\n+\n+8. Navigate to Service providers -> list as shown below. There are two service providers created apim_publisher, apim_devportal. Click on edit on publisher.\n+\n+    !!!warning\n+        You will have to logged into the devportal and publisher at least once for the two service providers to appear as it is created during first login.", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTQ4Ng==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081486", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:35:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MDExNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MDI0Nw==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402060247", "bodyText": "Expand local and outbound authentication configuration and under federated authentication,", "author": "isharac", "createdAt": "2020-04-02T05:30:55Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+4. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+5. Next we need to add the claims that needs to be returned from the ID Token in okta. These are the claims we will be used to map the user details to WSO2 API-Manager side. Navigate to API -> Authorization Servers and select the default server\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims.png)]({{base_path}}/assets/img/learn/okta-add-new-claims.png) \n+\n+6. Add the following two claims\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png) \n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+\n+### Setup API-Manager\n+\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to publisher and devportal\n+\n+4. Login in to `https://localhost:9443/carbon` & Click on add in identity providers section. Enter Identity Provider Name. Expand Federated authenticators -> OAuth2/OpenID connect configuration add the following details. \n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png) \n+<table>\n+    <colgroup>\n+        <col />\n+        <col />\n+        <col />\n+    </colgroup>\n+    <tbody>\n+        <tr>\n+            <th colspan=\"2\">Field</th>\n+            <th>Sample value</th>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Enable OAuth2/OpenIDConnect</td>\n+            <td class=\"confluenceTd\">True</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client id</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client secret</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Authorization Endpoint URL</td>\n+            <td class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/authorize</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Token Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/token</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">callback url</td>\n+            <td class=\"confluenceTd\">\n+                https://localhost:9443/commonauth\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Userinfo Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/userinfo\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Logout Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/logout\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Additional Query Parameters</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                scope=openid%20profile\n+            </td>\n+        </tr>\n+    </tbody>\n+</table>\n+\n+5. Expand Claim configuration -> Basic claim configuration and add the following claim configurations\n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png) \n+\n+6. Expand Role configuration and add the following role. Here we check if the user that is being logged in has the role `any` and assign him the local role okta_role\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-role-mapping.png\"/>\n+\n+7. Enable Just in time provisioning so that the user will be saved in the API-Manager user store\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-jit.png\"/>\n+\n+8. Navigate to Service providers -> list as shown below. There are two service providers created apim_publisher, apim_devportal. Click on edit on publisher.\n+\n+    !!!warning\n+        You will have to logged into the devportal and publisher at least once for the two service providers to appear as it is created during first login.\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-sp.png\"/>\n+\n+    Expand local and outbound authentication configuration and under federated authentation select the name of the identity provider you created.", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTUyMg==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081522", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:35:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MDI0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MDg2MQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402060861", "bodyText": "Repeat the same for Developer Portal service provider apim-devportal.", "author": "isharac", "createdAt": "2020-04-02T05:33:22Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+4. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+5. Next we need to add the claims that needs to be returned from the ID Token in okta. These are the claims we will be used to map the user details to WSO2 API-Manager side. Navigate to API -> Authorization Servers and select the default server\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims.png)]({{base_path}}/assets/img/learn/okta-add-new-claims.png) \n+\n+6. Add the following two claims\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png) \n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+\n+### Setup API-Manager\n+\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to publisher and devportal\n+\n+4. Login in to `https://localhost:9443/carbon` & Click on add in identity providers section. Enter Identity Provider Name. Expand Federated authenticators -> OAuth2/OpenID connect configuration add the following details. \n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-odic-details.png) \n+<table>\n+    <colgroup>\n+        <col />\n+        <col />\n+        <col />\n+    </colgroup>\n+    <tbody>\n+        <tr>\n+            <th colspan=\"2\">Field</th>\n+            <th>Sample value</th>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Enable OAuth2/OpenIDConnect</td>\n+            <td class=\"confluenceTd\">True</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client id</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Client secret</td>\n+            <td class=\"confluenceTd\">Can be found in the okta application you created</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Authorization Endpoint URL</td>\n+            <td class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/authorize</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Token Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">https://your_okta_url/oauth2/default/v1/token</td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">callback url</td>\n+            <td class=\"confluenceTd\">\n+                https://localhost:9443/commonauth\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Userinfo Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/userinfo\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Logout Endpoint URL</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                https://your_okta_url/oauth2/default/v1/logout\n+            </td>\n+        </tr>\n+        <tr>\n+            <td colspan=\"2\" class=\"confluenceTd\">Additional Query Parameters</td>\n+            <td colspan=\"1\" class=\"confluenceTd\">\n+                scope=openid%20profile\n+            </td>\n+        </tr>\n+    </tbody>\n+</table>\n+\n+5. Expand Claim configuration -> Basic claim configuration and add the following claim configurations\n+    [![]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png)]({{base_path}}/assets/img/learn/okta-apim-idp-claims-details.png) \n+\n+6. Expand Role configuration and add the following role. Here we check if the user that is being logged in has the role `any` and assign him the local role okta_role\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-role-mapping.png\"/>\n+\n+7. Enable Just in time provisioning so that the user will be saved in the API-Manager user store\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-jit.png\"/>\n+\n+8. Navigate to Service providers -> list as shown below. There are two service providers created apim_publisher, apim_devportal. Click on edit on publisher.\n+\n+    !!!warning\n+        You will have to logged into the devportal and publisher at least once for the two service providers to appear as it is created during first login.\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-sp.png\"/>\n+\n+    Expand local and outbound authentication configuration and under federated authentation select the name of the identity provider you created.\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-sp-outbound.png\"/>\n+    \n+    Repeat the same for devportal service provider.", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTU0NA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081544", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:36:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MDg2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MTcxNw==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402061717", "bodyText": "provisioned", "author": "isharac", "createdAt": "2020-04-02T05:36:26Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-oidc.md", "diffHunk": "@@ -0,0 +1,177 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Go to the OKTA admin portal and navigate to Applications -> Add Application\n+[![]({{base_path}}/assets/img/learn/okta-add-new-application.png)]({{base_path}}/assets/img/learn/okta-add-new-application.png)\n+\n+2. Select type web and use the following details\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)]({{base_path}}/assets/img/learn/okta-add-new-application-web.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)]({{base_path}}/assets/img/learn/okta-add-new-application-details.png)\n+3. Next we need to add a new attribute to the default user profile of OKTA represent a the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+4. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+5. Next we need to add the claims that needs to be returned from the ID Token in okta. These are the claims we will be used to map the user details to WSO2 API-Manager side. Navigate to API -> Authorization Servers and select the default server\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims.png)]({{base_path}}/assets/img/learn/okta-add-new-claims.png) \n+\n+6. Add the following two claims\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-user.png) \n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png)]({{base_path}}/assets/img/learn/okta-add-new-claims-role.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+\n+### Setup API-Manager\n+\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provioned from okta. click on add in Users and Roles section and add a new role.", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4MTU5Ng==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402081596", "bodyText": "fixed 35a30b0", "author": "dushansilva", "createdAt": "2020-04-02T06:36:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA2MTcxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA3MDg4NQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402070885", "bodyText": "Please check for the similar comments in above doc", "author": "isharac", "createdAt": "2020-04-02T06:07:00Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-saml.md", "diffHunk": "@@ -0,0 +1,153 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisite mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)", "originalCommit": "7c5c315eeb780ea79b53df2b7bf5e4df159f0331", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "35a30b0ab31168b682968dd1831c83ac5eb0d731", "url": "https://github.com/wso2/docs-apim/commit/35a30b0ab31168b682968dd1831c83ac5eb0d731", "message": "fix review comments", "committedDate": "2020-04-02T06:31:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NTQ3MA==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402085470", "bodyText": "publisher/Publisher", "author": "isharac", "createdAt": "2020-04-02T06:45:52Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-saml.md", "diffHunk": "@@ -0,0 +1,163 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisites mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Login to the okta developer console and switch to the classic UI. \n+    [![]({{base_path}}/assets/img/learn/okta-classic-ui.png)]({{base_path}}/assets/img/learn/okta-classic-ui.png)\n+\n+2. Go to Applications -> add application -> create new application and follow the details below\n+    [![]({{base_path}}/assets/img/learn/okta-saml-add-app.png)]({{base_path}}/assets/img/learn/okta-saml-add-app.png)\n+    <br/>\n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app.png)\n+    <br/>\n+    <br/>\n+    <br/>\n+    Select web type and saml 2.0\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-saml-app.png)]({{base_path}}/assets/img/learn/okta-saml-create-saml-app.png)\n+\n+    Enter the following details\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-name.png)]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-name.png)\n+    <br/>\n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-details.png)]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-details.png)\n+\n+    !!!warning\n+        **Audience URI** should be same as the identity provider entity id name that is created in WSO2 API-Manager\n+\n+3. Inside the saml app you created go to sign on -> view setup instructions which will redirect you to a another page which contains okta saml related configurations. \n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config1.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config1.png)\n+\n+    Scroll to the bottom of the page which has **Provide the following IDP metadata to your SP provider.**. Copy and save the details given to a xml file.\n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config2.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config2.png)\n+\n+    Go to assignments -> assign -> assign to people and assign your current user\n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app-assign.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app-assign.png)\n+    \n+4. Switch back to the developer console same as step 1\n+\n+5. Next we need to add a new attribute to the default user profile of OKTA to epresent the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+6. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+### Setup API-Manager\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provisioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to Publisher and Developer Portal\n+\n+4. Login in to `https://localhost:9443/carbon` & Click on add in identity providers section. Enter Identity Provider Name. Expand the federated authenticators -> SAML2 Web SSO Configuration section and under Select Mode select Metadata File Configuration and update the xml file that was saved during the okta setup process.\n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-apim-idp.png)]({{base_path}}/assets/img/learn/okta-saml-apim-idp.png) \n+\n+    <table>\n+        <colgroup>\n+            <col />\n+            <col />\n+            <col />\n+        </colgroup>\n+        <tbody>\n+            <tr>\n+                <th colspan=\"2\">Field</th>\n+                <th>Sample value</th>\n+            </tr>\n+            <tr>\n+                <td colspan=\"2\" class=\"confluenceTd\">specifies if SAML2 Web SSO is enabled for this identity provider</td>\n+                <td class=\"confluenceTd\">True</td>\n+            </tr>\n+            <tr>\n+                <td colspan=\"2\" class=\"confluenceTd\">Service Provider Entity ID</td>\n+                <td class=\"confluenceTd\">Entity id specified when creating saml app (eg: oktasaml)</td>\n+            </tr>\n+        </tbody>\n+    </table>\n+\n+5. Expand Claim configuration -> Basic claim configuration and add the following claim configurations\n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-apim-idp-claim.png)]({{base_path}}/assets/img/learn/okta-saml-apim-idp-claim.png) \n+\n+6. Expand Role configuration and add the following role. Here we check if the user that is being logged in has the role `any` and assign him the local role okta_role\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-role-mapping.png\"/>\n+\n+7. Enable Just in time provisioning so that the user will be saved in the API-Manager user store\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-oidc-jit.png\"/>\n+\n+8. Navigate to Service providers -> list as shown below. There are two service providers created apim_publisher, apim_devportal. Click on edit on apim_publisher.\n+\n+    !!!warning\n+        You will have to logged into the Developer Portal and publisher at least once for the two service providers to appear as it is created during first login.", "originalCommit": "35a30b0ab31168b682968dd1831c83ac5eb0d731", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc0NDQ3NQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402744475", "bodyText": "fixed 2fc1ae7", "author": "dushansilva", "createdAt": "2020-04-03T05:28:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NTQ3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NzEyMQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402087121", "bodyText": "better if we highlight texts extracted from the UI.", "author": "isharac", "createdAt": "2020-04-02T06:49:33Z", "path": "en/docs/install-and-setup/sso/okta-as-an-external-idp-using-saml.md", "diffHunk": "@@ -0,0 +1,163 @@\n+In the following document we will explain how to connect OKTA as a third party Identity provier to WSO2 API-Manager. Before we start first make sure you have all the pre-requisites mentioned below.\n+\n+### Pre-requisites\n+\n+1. Create an account in [https://developer.okta.com/](https://developer.okta.com/)\n+2. Download the latest API-Manager distribution from [https://wso2.com/api-management/](https://wso2.com/api-management/)\n+3. Unzip the distribution and open the `deployment.toml` file located in `<APIM_HOME>/repository/conf/` and add the following configuration\n+    ```\n+    [tenant_mgt]\n+    enable_email_domain= true\n+    ```\n+    This is needed since OKTA uses the email as the username by default,  therefore to  use the email as the username in WSO2 API-Manager we have to enable it since it not enabled by default.\n+4. Start the Server.\n+\n+### Setup OKTA\n+\n+1. Login to the okta developer console and switch to the classic UI. \n+    [![]({{base_path}}/assets/img/learn/okta-classic-ui.png)]({{base_path}}/assets/img/learn/okta-classic-ui.png)\n+\n+2. Go to Applications -> add application -> create new application and follow the details below\n+    [![]({{base_path}}/assets/img/learn/okta-saml-add-app.png)]({{base_path}}/assets/img/learn/okta-saml-add-app.png)\n+    <br/>\n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app.png)\n+    <br/>\n+    <br/>\n+    <br/>\n+    Select web type and saml 2.0\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-saml-app.png)]({{base_path}}/assets/img/learn/okta-saml-create-saml-app.png)\n+\n+    Enter the following details\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-name.png)]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-name.png)\n+    <br/>\n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-details.png)]({{base_path}}/assets/img/learn/okta-saml-create-saml-app-details.png)\n+\n+    !!!warning\n+        **Audience URI** should be same as the identity provider entity id name that is created in WSO2 API-Manager\n+\n+3. Inside the saml app you created go to sign on -> view setup instructions which will redirect you to a another page which contains okta saml related configurations. \n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config1.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config1.png)\n+\n+    Scroll to the bottom of the page which has **Provide the following IDP metadata to your SP provider.**. Copy and save the details given to a xml file.\n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config2.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app-config2.png)\n+\n+    Go to assignments -> assign -> assign to people and assign your current user\n+\n+    [![]({{base_path}}/assets/img/learn/okta-saml-create-new-app-assign.png)]({{base_path}}/assets/img/learn/okta-saml-create-new-app-assign.png)\n+    \n+4. Switch back to the developer console same as step 1\n+\n+5. Next we need to add a new attribute to the default user profile of OKTA to epresent the user role. Navigate to Users -> Profile Editor and click on the pencil icon to edit the default profile\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute.png)\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-add.png) \n+\n+6. Enter the following details and click save\n+\n+    [![]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png)]({{base_path}}/assets/img/learn/okta-add-new-attribute-details.png) \n+\n+7. Go to Users -> People and click on your profile name. And navigate to the profile edit page as shown below\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit.png\" />\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit2.png\" width=\"600\" height=\"400\"/>\n+    <br/>\n+    <br/>\n+\n+    add the following role value. This will be used in the API-Manager to map an internal role to user that will be provisioned.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-profile-edit3.png\"/>\n+\n+### Setup API-Manager\n+1. Login in to `https://localhost:9443/carbon`.\n+\n+2. First we need to create a role that needs to be assinged to users that will be provisioned from okta. click on add in Users and Roles section and add a new role.\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role.png\" width=\"400\" height=\"200\"/>\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-name.png\" width=\"400\" height=\"200\"/>\n+\n+    Assign the following permissions to the role and save\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions3.png\" width=\"300\" height=\"300\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions2.png\" width=\"300\" height=\"350\"/>\n+    <br/>\n+    <br/>\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-add-role-permissions1.png\" width=\"300\" height=\"300\"/>\n+\n+3. Login to `https://localhost:9443/admin` expand settings & click on scope mapping\n+\n+    <img src=\"{{base_path}}/assets/img/learn/okta-apim-role-scope-mapping.png\" width=\"300\" height=\"500\"/>\n+\n+    Update the following scopes with the okta_role\n+\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit1.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit2.png) \n+    <br/>\n+    <br/>\n+    [![]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png)]({{base_path}}/assets/img/learn/okta-apim-role-scope-mapping-edit3.png) \n+\n+    This will allow the user a user having the okta_role to login to Publisher and Developer Portal\n+\n+4. Login in to `https://localhost:9443/carbon` & Click on add in identity providers section. Enter Identity Provider Name. Expand the federated authenticators -> SAML2 Web SSO Configuration section and under Select Mode select Metadata File Configuration and update the xml file that was saved during the okta setup process.", "originalCommit": "35a30b0ab31168b682968dd1831c83ac5eb0d731", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjEwMjMyNg==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402102326", "bodyText": "highlight texts extracted from the UI.\n\nDidn't get what did you mean here", "author": "dushansilva", "createdAt": "2020-04-02T07:22:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NzEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjYzNjI1NQ==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402636255", "bodyText": "ex:\nClick on Add in  Identity Providers section. Enter Identity Provider Name etc", "author": "isharac", "createdAt": "2020-04-02T22:38:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NzEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc0NDQ1Mw==", "url": "https://github.com/wso2/docs-apim/pull/965#discussion_r402744453", "bodyText": "fixed 2fc1ae7", "author": "dushansilva", "createdAt": "2020-04-03T05:28:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4NzEyMQ=="}], "type": "inlineReview"}, {"oid": "2fc1ae7e318fc9d5bc274b7a3d09e86158228e7c", "url": "https://github.com/wso2/docs-apim/commit/2fc1ae7e318fc9d5bc274b7a3d09e86158228e7c", "message": "fix review comments", "committedDate": "2020-04-03T05:27:54Z", "type": "commit"}]}