{"pr_number": 2456, "pr_title": "[3.1.0] Add sample opentracer configs", "pr_createdAt": "2020-12-03T10:31:33Z", "pr_url": "https://github.com/wso2/docs-apim/pull/2456", "timeline": [{"oid": "8ebc5d4c754d88722ce0155e3259c136c9f21612", "url": "https://github.com/wso2/docs-apim/commit/8ebc5d4c754d88722ce0155e3259c136c9f21612", "message": "Add sample opentracer configs", "committedDate": "2020-12-03T10:30:24Z", "type": "commit"}, {"oid": "1b78c65b31b14103d77afc23077a85dde474d857", "url": "https://github.com/wso2/docs-apim/commit/1b78c65b31b14103d77afc23077a85dde474d857", "message": "Reviewed full doc", "committedDate": "2020-12-03T15:50:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5MzA1MA==", "url": "https://github.com/wso2/docs-apim/pull/2456#discussion_r552393050", "bodyText": "shouldn't this be \"Open tracing --> openTracing\"?", "author": "dinusha92", "createdAt": "2021-01-06T06:26:54Z", "path": "en/docs/administer/logging-and-monitoring/monitoring/monitoring-with-opentracing.md", "diffHunk": "@@ -1,82 +1,106 @@\n-# Open tracing\n+# Enabling Tracing with OpenTracing\n \n In a distributed API Manager architecture, tracing a message is important to debug and observe a message path. This is known as distributed tracing. OpenTracing allows you to enable distributed tracing for WSO2 API Manager.\n-OpenTracing aims to be an open, vendor-neutral standard for distributed systems instrumentation. It offers a way for developers to follow the thread \u2014 to trace requests from beginning to end across touchpoints and understand distributed systems at scale. Open tracing will also help to trace the message and identify the latencies happened in each process/ method. This will help to do the time-related analysis.\n-\n- In WSO2-APIM, We supports following types of ways to retrieve instrumented data.\n-\n- 1. Jaeger\n- 2. Zipkin\n- 3. Log\n-\n-### How to Enable Jaeger Tracing.\n-\n-1. Copy following configuration into the deployment.toml and start the server.\n-\n-```toml\n-[apim.open_tracer]\n-remote_tracer.enable = true\n-remote_tracer.name = \"jaeger\"\n-remote_tracer.properties.hostname = \"<hostname of jaeger endpoint>\"\n-remote_tracer.properties.port = \"<port of jaeger endpoint>\"\n-```\n-2. Start the Server.\n-3. Once you invoke the APIS you'll be able to see tracing data in jaeger as follow.\n-\n-![Distributed tracing jaeger]({{base_path}}/assets/img/administer/opentracing-jaeger.png)\n-\n-\n-### How to Enable Zipkin Tracing.\n-\n-1. Copy following configuration into the deployment.toml and start the server.\n-\n-```toml\n-[apim.open_tracer]\n-remote_tracer.enable = true\n-remote_tracer.name = \"zipkin\"\n-remote_tracer.properties.hostname = \"<hostname of zikin endpoint>\"\n-remote_tracer.properties.port = \"<port of zipkin endpoint>\"\n-```\n-2. Start the Server.\n-3. Once you invoke the APIS you'll be able to see tracing data in zipkin as follow.\n-\n-![Distributed tracing zipkin]({{base_path}}/assets/img/administer/opentracing-zipkin.png)\n-\n-\n-### How to Enable Log Tracing.\n-1. Copy following configuration into the deployment.toml and start the server.\n-\n-```toml\n-[apim.open_tracer]\n-remote_tracer.enable = false\n-log_tracer.enable = true\n-```\n-2. Start the Server.\n-3. Once you invoke the APIS you'll be able to see tracing data in the __wso2-apimgt-open-tracing.log__ under __\\<API-M_HOME>/repository/logs__    folder.\n-\n-```log\n-20:19:46,937 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":0,\"Operation\":\"API:CORS_Request_Handler\",\"Tags\":{}}\n-n20:19:46,938 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":0,\"Operation\":\"API:Get_Client_Domain()\",\"Tags\":{}}\n-n20:19:46,939 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":0,\"Operation\":\"API:Find_matching_verb()\",\"Tags\":{}}\n-n20:19:46,939 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":1,\"Operation\":\"API:Get_Resource_Authentication_Scheme()\",\"Tags\":{}}\n-n20:19:46,956 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":0,\"Operation\":\"API:Get_Access_Token_Cache_key()\",\"Tags\":{}}\n-n20:19:46,958 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":0,\"Operation\":\"API:Fetching_API_iNFO_DTO_FROM_CACHE()\",\"Tags\":{}}\n-n20:19:46,959 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":0,\"Operation\":\"API:Validate_Token()\",\"Tags\":{}}\n-n20:19:46,972 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":12,\"Operation\":\"API:Validate_Subscription()\",\"Tags\":{}}\n-n20:19:46,973 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":0,\"Operation\":\"API:Validate_Scopes()\",\"Tags\":{}}\n-n20:19:46,974 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":0,\"Operation\":\"API:Write_To_Key_Manager_Cache()\",\"Tags\":{}}\n-n20:19:46,975 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":0,\"Operation\":\"API:Publishing_Key_Validation_Response\",\"Tags\":{}}\n-n20:19:46,976 [-] [https-jsse-nio-9443-exec-23] TRACE {\"Latency\":20,\"Operation\":\"API:Validate_Main\",\"Tags\":{}}\n-n20:19:46,991 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":51,\"Operation\":\"API:Key_Validation_From_Gateway_Node\",\"Tags\":{}}\n-n20:19:46,992 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":52,\"Operation\":\"API:Get_Key_Validation_Info()\",\"Tags\":{}}\n-n20:19:46,993 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":56,\"Operation\":\"API:Key_Validation_Latency\",\"Tags\":{}}\n-n20:19:46,994 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":0,\"Operation\":\"API:Throttle_Latency\",\"Tags\":{}}\n-n20:19:46,995 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":0,\"Operation\":\"API:API_Mgt_Usage_Handler\",\"Tags\":{}}\n-n20:19:46,996 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":1,\"Operation\":\"API:Google_Analytics_Handler\",\"Tags\":{}}\n-n20:19:46,996 [-] [PassThroughMessageProcessor-14] TRACE {\"Latency\":0,\"Operation\":\"API:Request_Mediation_Latency\",\"Tags\":{}}\n-n20:19:47,016 [-] [PassThroughMessageProcessor-15] TRACE {\"Latency\":19,\"Operation\":\"API:Backend_Latency\",\"Tags\":{\"span.endpoint\":\"https://localhost:9443/am/sample/pizzashack/v1/api/\"}}\n-n20:19:47,017 [-] [PassThroughMessageProcessor-15] TRACE {\"Latency\":0,\"Operation\":\"API:Response_Mediation_Latency\",\"Tags\":{}}\n-n20:19:47,018 [-] [PassThroughMessageProcessor-15] TRACE {\"Latency\":0,\"Operation\":\"API:API_MGT_Response_Handler\",\"Tags\":{}}\n-n20:19:47,019 [-] [PassThroughMessageProcessor-15] TRACE {\"Latency\":83,\"Operation\":\"API:Response_Latency\",\"Tags\":{\"span.resource\":\"/menu\",\"span.kind\":\"server\",\"span.api.name\":\"PizzaShackAPI\",\"span.consumerkey\":\"Fn9RGuFeefEe7W07jOq_mvQvLJwa\",\"span.request.method\":\"GET\",\"span.request.path\":\"pizzashack/1.0.0/menu\",\"span.api.version\":\"1.0.0\",\"span.activity.id\":\"urn:uuid:339f337a-8848-41ec-adba-73da367fa66e\"}}\n-n\n-```\n+OpenTracing aims to be an open, vendor-neutral standard for distributed systems instrumentation. It offers a way for developers to follow the thread \u2014 to trace requests from beginning to end across touchpoints and understand distributed systems at scale. Open tracing will also help to trace the message and identify the latencies that took place in each process or method. Thereby, open tracing will help you to carry out a time-related analysis.", "originalCommit": "1b78c65b31b14103d77afc23077a85dde474d857", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDk0NzY2Nw==", "url": "https://github.com/wso2/docs-apim/pull/2456#discussion_r554947667", "bodyText": "Fixed in #2906", "author": "RakhithaRR", "createdAt": "2021-01-11T10:26:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5MzA1MA=="}], "type": "inlineReview"}]}