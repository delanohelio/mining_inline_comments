{"pr_number": 969, "pr_title": "TSK-1029: Proper distinction between delete and markForFeletion for", "pr_createdAt": "2020-03-09T16:25:34Z", "pr_url": "https://github.com/Taskana/taskana/pull/969", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTgxNzczMQ==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r389817731", "bodyText": "This is not documented. Please include this snipped in the rest documentation.", "author": "mustaphazorgati", "createdAt": "2020-03-09T16:45:00Z", "path": "rest/taskana-rest-spring/src/test/java/pro/taskana/doc/api/WorkbasketControllerRestDocumentation.java", "diffHunk": "@@ -494,6 +494,18 @@ void markWorkbasketForDeletionDocTest() throws Exception {\n         .andDo(MockMvcRestDocumentation.document(\"MarkWorkbasketForDeletionDocTest\"));\n   }\n \n+  @Test\n+  void deleteWorkbasketDocTest() throws Exception {\n+    this.mockMvc\n+        .perform(\n+            RestDocumentationRequestBuilders.delete(\n+                    restHelper.toUrl(\n+                        Mapping.URL_WORKBASKET_ID, \"WBI:100000000000000000000000000000000009\"))\n+                .header(\"Authorization\", \"Basic YWRtaW46YWRtaW4=\"))\n+        .andExpect(MockMvcResultMatchers.status().isNoContent())\n+        .andDo(MockMvcRestDocumentation.document(\"DeleteWorkbasketDocTest\"));", "originalCommit": "90eb7bb8dac2552546408b4f512014fcdc262feb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTgxODE0Mw==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r389818143", "bodyText": "Please properly document the distinction between marked for deletion <-> deleted. Currently there's only a snipped for marked for deletion", "author": "mustaphazorgati", "createdAt": "2020-03-09T16:45:39Z", "path": "rest/taskana-rest-spring/src/test/java/pro/taskana/doc/api/WorkbasketControllerRestDocumentation.java", "diffHunk": "@@ -494,6 +494,18 @@ void markWorkbasketForDeletionDocTest() throws Exception {\n         .andDo(MockMvcRestDocumentation.document(\"MarkWorkbasketForDeletionDocTest\"));\n   }\n \n+  @Test\n+  void deleteWorkbasketDocTest() throws Exception {\n+    this.mockMvc\n+        .perform(\n+            RestDocumentationRequestBuilders.delete(\n+                    restHelper.toUrl(\n+                        Mapping.URL_WORKBASKET_ID, \"WBI:100000000000000000000000000000000009\"))\n+                .header(\"Authorization\", \"Basic YWRtaW46YWRtaW4=\"))\n+        .andExpect(MockMvcResultMatchers.status().isNoContent())\n+        .andDo(MockMvcRestDocumentation.document(\"DeleteWorkbasketDocTest\"));\n+  }\n+", "originalCommit": "90eb7bb8dac2552546408b4f512014fcdc262feb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTgyMzk4OQ==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r389823989", "bodyText": "You don't have to change this. This is just to show you something cool:\ninstead of that lambda we could use a method reference.\nnoneMatch(\"WBI:100000000000000000000000000000000007\"::equals)\nPersonally I think this is much easier to read and should be used whenever possible.", "author": "mustaphazorgati", "createdAt": "2020-03-09T16:54:59Z", "path": "rest/taskana-rest-spring/src/test/java/pro/taskana/rest/WorkbasketControllerIntTest.java", "diffHunk": "@@ -213,9 +220,9 @@ void testRemoveWorkbasketAsDistributionTarget() {\n             ParameterizedTypeReference.forType(DistributionTargetListResource.class));\n     assertThat(response2.getStatusCode()).isEqualTo(HttpStatus.OK);\n     assertThat(\n-        response2.getBody().getContent().stream()\n-            .map(DistributionTargetResource::getWorkbasketId)\n-            .noneMatch(id -> (id.equals(\"WBI:100000000000000000000000000000000007\"))))\n+            response2.getBody().getContent().stream()\n+                .map(DistributionTargetResource::getWorkbasketId)\n+                .noneMatch(id -> (id.equals(\"WBI:100000000000000000000000000000000007\"))))", "originalCommit": "90eb7bb8dac2552546408b4f512014fcdc262feb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg4Njg2Ng==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r389886866", "bodyText": "Please mark this key with a TODO: message changed so that I'll find it during my work on TSK-931.", "author": "mustaphazorgati", "createdAt": "2020-03-09T18:40:10Z", "path": "web/src/app/administration/workbasket/details/information/workbasket-information.component.ts", "diffHunk": "@@ -280,16 +280,16 @@ implements OnInit, OnChanges, OnDestroy {\n         response => {\n           this.requestInProgressService.setRequestInProgress(false);\n           this.workbasketService.triggerWorkBasketSaved();\n-          if (response) {\n+          if (response.status === 202) {\n             // new Key ERROR_TYPES.MARK_ERR", "originalCommit": "a56fb21e07c9ef844b06a927813a78d877f6ab4c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDYxMTg2Ng==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r390611866", "bodyText": "This is still not done and important. :)", "author": "mustaphazorgati", "createdAt": "2020-03-10T21:06:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg4Njg2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg4Njk0MQ==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r389886941", "bodyText": "Please mark this key with a TODO: message changed so that I'll find it during my work on TSK-931.", "author": "mustaphazorgati", "createdAt": "2020-03-09T18:40:17Z", "path": "web/src/app/administration/workbasket/details/information/workbasket-information.component.ts", "diffHunk": "@@ -280,16 +280,16 @@ implements OnInit, OnChanges, OnDestroy {\n         response => {\n           this.requestInProgressService.setRequestInProgress(false);\n           this.workbasketService.triggerWorkBasketSaved();\n-          if (response) {\n+          if (response.status === 202) {\n             // new Key ERROR_TYPES.MARK_ERR\n             this.generalModalService.triggerMessage(\n-              new MessageModal('There was an error marking workbasket for deletion',\n-                'It not possible to mark the workbasket for deletion, It has been deleted.')\n+              new MessageModal('Workbasket was marked for deletion.',\n+              `The Workbasket ${this.workbasket.workbasketId} still contains completed tasks and could not be deleted. Instead is was marked for deletion and will be deleted automatically as soon as the completed tasks are deleted from the database.`)\n             );\n           } else {\n             // new Key ALERT_TYPES.SUCCESS_ALERT_12", "originalCommit": "a56fb21e07c9ef844b06a927813a78d877f6ab4c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDYxMTkzMQ==", "url": "https://github.com/Taskana/taskana/pull/969#discussion_r390611931", "bodyText": "This is still not done and important. :)", "author": "mustaphazorgati", "createdAt": "2020-03-10T21:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg4Njk0MQ=="}], "type": "inlineReview"}, {"oid": "000faa6d9d99b109a65989c78d3ca35028c4867c", "url": "https://github.com/Taskana/taskana/commit/000faa6d9d99b109a65989c78d3ca35028c4867c", "message": "TSK-1029: Proper distinction between delete and markForFeletion for\nworkbaskets", "committedDate": "2020-03-18T11:22:09Z", "type": "commit"}]}