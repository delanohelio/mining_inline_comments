{"pr_number": 1154, "pr_title": "TSK-1305: Adapt classification type when entering a deep link", "pr_createdAt": "2020-06-29T11:31:36Z", "pr_url": "https://github.com/Taskana/taskana/pull/1154", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQyNTk0Mg==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447425942", "bodyText": "what's the reason for this timeout? is this really necessary? If yes, please document the reason", "author": "mustaphazorgati", "createdAt": "2020-06-30T05:52:40Z", "path": "web/src/app/administration/components/classification-overview/classification-overview.component.ts", "diffHunk": "@@ -36,6 +37,7 @@ export class ClassificationOverviewComponent implements OnInit, OnDestroy {\n           if (this.routerParams.id) {\n             this.showDetail = true;\n             this.store.dispatch(new SelectClassification(this.routerParams.id));\n+            setTimeout(() => this.store.dispatch(new GetClassifications()), 0);", "originalCommit": "e03332d9c8d54b2324b4a7a6e9898eca3a8d67a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ5NDQ5MA==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447494490", "bodyText": "I changed this to a subscription. We have to wait for the first action to finish in order to get the classifications which belong to the new classification type.", "author": "sofie29", "createdAt": "2020-06-30T08:10:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQyNTk0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQyNjEzMg==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447426132", "bodyText": "Can't we just do this always within the patchState call above?", "author": "mustaphazorgati", "createdAt": "2020-06-30T05:53:19Z", "path": "web/src/app/shared/store/classification-store/classification.state.ts", "diffHunk": "@@ -53,6 +53,13 @@ export class ClassificationState implements NgxsAfterBootstrap {\n             selectedClassification,\n             action: ACTION.DEFAULT\n           });\n+\n+          // Change the type when entering a deep link and old / new types don't match\n+          if (selectedClassification.type !== ctx.getState().selectedClassificationType) {\n+            ctx.patchState({\n+              selectedClassificationType: selectedClassification.type\n+            });\n+          }", "originalCommit": "e03332d9c8d54b2324b4a7a6e9898eca3a8d67a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUxOTE4Mw==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447519183", "bodyText": "@cnguyen-de is this pipe necessary? I don't think so.", "author": "mustaphazorgati", "createdAt": "2020-06-30T08:48:19Z", "path": "web/src/app/administration/components/classification-overview/classification-overview.component.ts", "diffHunk": "@@ -35,7 +36,9 @@ export class ClassificationOverviewComponent implements OnInit, OnDestroy {\n \n           if (this.routerParams.id) {\n             this.showDetail = true;\n-            this.store.dispatch(new SelectClassification(this.routerParams.id));\n+            this.store.dispatch(new SelectClassification(this.routerParams.id))\n+              .pipe(takeUntil(this.destroy$))", "originalCommit": "38cac2c08cda4201d1b3a93de05c70539d831a0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyMjg1OQ==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447522859", "bodyText": "imo it can be removed. \"The observable would complete when the dispatched action's handling (and 'child' action handling) is completed. No unsubscription necessary.\"", "author": "cnguyen-de", "createdAt": "2020-06-30T08:53:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUxOTE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyMzQwMA==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447523400", "bodyText": "@sofie29 you can remove it then :)\nSorry for the double roundtrip", "author": "mustaphazorgati", "createdAt": "2020-06-30T08:54:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUxOTE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyODY2NA==", "url": "https://github.com/Taskana/taskana/pull/1154#discussion_r447528664", "bodyText": "removed", "author": "sofie29", "createdAt": "2020-06-30T09:03:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUxOTE4Mw=="}], "type": "inlineReview"}, {"oid": "eb0d8b70fc7f5c36c6c855d9c570211e5e4c72dc", "url": "https://github.com/Taskana/taskana/commit/eb0d8b70fc7f5c36c6c855d9c570211e5e4c72dc", "message": "TSK-1305: Adapt classification type when entering a deep link", "committedDate": "2020-06-30T09:02:03Z", "type": "commit"}]}