{"pr_number": 1212, "pr_title": "TSK-1085: Hateoas self-links which contain variables are not working \u2026", "pr_createdAt": "2020-08-05T14:19:15Z", "pr_url": "https://github.com/Taskana/taskana/pull/1212", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM0MzA2Mg==", "url": "https://github.com/Taskana/taskana/pull/1212#discussion_r466343062", "bodyText": "Why do we add the metadata twice and do not simply get it from the model?", "author": "holgerhagen", "createdAt": "2020-08-06T11:21:17Z", "path": "rest/taskana-rest-spring/src/main/java/pro/taskana/task/rest/assembler/TaskCommentRepresentationModelAssembler.java", "diffHunk": "@@ -70,9 +68,9 @@ public TaskanaPagedModelKeys getProperty() {\n   }\n \n   @Override\n-  @PageLinks(Mapping.URL_TASK_COMMENTS)\n   public TaskanaPagedModel<TaskCommentRepresentationModel> toPageModel(\n       Iterable<TaskComment> taskComments, PageMetadata pageMetadata) {\n-    return TaskanaPagingAssembler.super.toPageModel(taskComments, pageMetadata);\n+    return addLinksToPageResource(\n+        TaskanaPagingAssembler.super.toPageModel(taskComments, pageMetadata), pageMetadata);", "originalCommit": "8374780a1e1a0d8367f1be5f5060d93a36591bc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODczNTAxOA==", "url": "https://github.com/Taskana/taskana/pull/1212#discussion_r468735018", "bodyText": "You're right! Thank you!", "author": "nkolytschew", "createdAt": "2020-08-11T17:09:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM0MzA2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM0MzUxMg==", "url": "https://github.com/Taskana/taskana/pull/1212#discussion_r466343512", "bodyText": "I understand that we do not change the history events to the representation model structure in this PR? Is there a ticket for it to do it later on?", "author": "holgerhagen", "createdAt": "2020-08-06T11:22:20Z", "path": "history/taskana-simplehistory-rest-spring/src/main/java/pro/taskana/simplehistory/rest/assembler/TaskHistoryEventListResourceAssembler.java", "diffHunk": "@@ -4,53 +4,57 @@\n \n import java.util.ArrayList;\n import java.util.List;\n+import java.util.Map;\n+import javax.servlet.http.HttpServletRequest;\n import org.springframework.hateoas.IanaLinkRelations;\n import org.springframework.hateoas.Link;\n import org.springframework.hateoas.PagedModel.PageMetadata;\n+import org.springframework.web.context.request.RequestContextHolder;\n+import org.springframework.web.context.request.ServletRequestAttributes;\n+import org.springframework.web.servlet.support.ServletUriComponentsBuilder;\n+import org.springframework.web.util.UriComponentsBuilder;\n \n-import pro.taskana.resource.rest.AbstractRessourcesAssembler;\n import pro.taskana.simplehistory.impl.HistoryEventImpl;\n import pro.taskana.simplehistory.rest.TaskHistoryEventController;\n import pro.taskana.simplehistory.rest.models.TaskHistoryEventListResource;\n import pro.taskana.simplehistory.rest.models.TaskHistoryEventRepresentationModel;\n \n /** Mapper to convert from a list of HistoryEventImpl to a TaskHistoryEventResource. */\n-public class TaskHistoryEventListResourceAssembler extends AbstractRessourcesAssembler {\n+public class TaskHistoryEventListResourceAssembler {", "originalCommit": "8374780a1e1a0d8367f1be5f5060d93a36591bc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM0NTc1NQ==", "url": "https://github.com/Taskana/taskana/pull/1212#discussion_r466345755", "bodyText": "would addLinksToPage'd'Resource be the better name?", "author": "holgerhagen", "createdAt": "2020-08-06T11:27:10Z", "path": "rest/taskana-rest-spring/src/main/java/pro/taskana/common/rest/assembler/TaskanaPagingAssembler.java", "diffHunk": "@@ -25,4 +33,46 @@\n   default TaskanaPagedModel<D> toPageModel(Iterable<T> entities) {\n     return toPageModel(entities, null);\n   }\n+\n+  default TaskanaPagedModel<D> addLinksToPageResource(", "originalCommit": "8374780a1e1a0d8367f1be5f5060d93a36591bc0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6ddb2c113432e75c8c54adb18b294120a455811f", "url": "https://github.com/Taskana/taskana/commit/6ddb2c113432e75c8c54adb18b294120a455811f", "message": "TSK-1085: Hateoas self-links which contain variables are not working for Paged representationmodels\n\n* remove Aspect\n* remove PageLinks\n* remove AbstractRessourcesAssembler\n* update TaskanaPagingAssembler\n* update *Assembler implementing TaskanaPagingAssembler for self-links\n\n* update unit-test and test \"href-self\" part of json\n* fix checkstyl-finding", "committedDate": "2020-08-12T09:43:55Z", "type": "forcePushed"}, {"oid": "a100f8824152ea3b2cf256e577db78ffa813075e", "url": "https://github.com/Taskana/taskana/commit/a100f8824152ea3b2cf256e577db78ffa813075e", "message": "TSK-1085: Hateoas self-links which contain variables are not working for Paged representationmodels\n\n* remove Aspect\n* remove PageLinks\n* remove AbstractRessourcesAssembler\n* update TaskanaPagingAssembler\n* update *Assembler implementing TaskanaPagingAssembler for self-links\n\n* update unit-test and test \"href-self\" part of json\n* fix checkstyl-finding", "committedDate": "2020-08-12T09:47:54Z", "type": "forcePushed"}, {"oid": "39f037bcaeb685ff0d0c032f081b9a9bdc6c67e4", "url": "https://github.com/Taskana/taskana/commit/39f037bcaeb685ff0d0c032f081b9a9bdc6c67e4", "message": "TSK-1085: Hateoas self-links which contain variables are not working for Paged representationmodels\n\n* remove Aspect\n* remove PageLinks\n* remove AbstractRessourcesAssembler\n* update TaskanaPagingAssembler\n* update *Assembler implementing TaskanaPagingAssembler for self-links\n\n* update unit-test and test \"href-self\" part of json\n* fix checkstyl-finding", "committedDate": "2020-08-12T13:49:32Z", "type": "forcePushed"}, {"oid": "604b0a7dec956e7d3473baa80fc5f07499e659dc", "url": "https://github.com/Taskana/taskana/commit/604b0a7dec956e7d3473baa80fc5f07499e659dc", "message": "TSK-1085: Hateoas self-links which contain variables are not working for Paged representationmodels\n\n* remove Aspect\n* remove PageLinks\n* remove AbstractRessourcesAssembler\n* update TaskanaPagingAssembler\n* update *Assembler implementing TaskanaPagingAssembler for self-links\n\n* update unit-test and test \"href-self\" part of json\n* fix checkstyl-finding", "committedDate": "2020-08-12T13:55:16Z", "type": "commit"}, {"oid": "604b0a7dec956e7d3473baa80fc5f07499e659dc", "url": "https://github.com/Taskana/taskana/commit/604b0a7dec956e7d3473baa80fc5f07499e659dc", "message": "TSK-1085: Hateoas self-links which contain variables are not working for Paged representationmodels\n\n* remove Aspect\n* remove PageLinks\n* remove AbstractRessourcesAssembler\n* update TaskanaPagingAssembler\n* update *Assembler implementing TaskanaPagingAssembler for self-links\n\n* update unit-test and test \"href-self\" part of json\n* fix checkstyl-finding", "committedDate": "2020-08-12T13:55:16Z", "type": "forcePushed"}]}