{"pr_number": 8064, "pr_title": "Validate length of HGVSp_Short values", "pr_createdAt": "2020-11-16T16:43:42Z", "pr_url": "https://github.com/cBioPortal/cbioportal/pull/8064", "timeline": [{"oid": "4183c29310be289b93d16303d2eb881584ca259c", "url": "https://github.com/cBioPortal/cbioportal/commit/4183c29310be289b93d16303d2eb881584ca259c", "message": "Validate length of HGVSp_Short values", "committedDate": "2020-11-23T10:41:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA2NzM5MA==", "url": "https://github.com/cBioPortal/cbioportal/pull/8064#discussion_r530067390", "bodyText": "Should we assert that there is no error logged for the first record? If some logic flaw in the scripts package caused flagging every record as too long I'm sure we would notice, so maybe we don't have to worry about it - but since there are two records in the test set, it would feel more complete to test the code behavior for both cases. I'm not sure how you assert an absence of error .. maybe self.assertNotEqual(record.levelno, logging.ERROR)?\nHowever, I think this PR can be merged without this added test.", "author": "sheridancbio", "createdAt": "2020-11-25T02:27:42Z", "path": "core/src/test/scripts/unit_tests_validate_data.py", "diffHunk": "@@ -1365,6 +1365,22 @@ def test_isValidAminoAcidChange(self):\n         self.assertIn('HGVSp_Short', record.getMessage())\n         self.assertEqual(record.line_number, 8)\n \n+    def throw_error_if_hgvsp_short_is_too_long(self):\n+        \"\"\"Test that an error is thrown if HGVSp_Short value is too long.\"\"\"\n+        # set level according to this test case:\n+        self.logger.setLevel(logging.WARNING)\n+        record_list = self.validate(\n+                'mutations/data_mutations_too_long_hgvsp_short.maf',\n+                validateData.MutationsExtendedValidator,\n+                extra_meta_fields={'swissprot_identifier': 'accession'})\n+        self.assertEqual(len(record_list), 2)\n+        record_iterator = iter(record_list)\n+        # expect an error for the second entry", "originalCommit": "4183c29310be289b93d16303d2eb881584ca259c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg5MDcwMA==", "url": "https://github.com/cBioPortal/cbioportal/pull/8064#discussion_r530890700", "bodyText": "Good catch! I've fixed the test", "author": "oplantalech", "createdAt": "2020-11-26T09:33:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA2NzM5MA=="}], "type": "inlineReview"}, {"oid": "58da307b6770b3ef19c96b7c42b37a2b0c7289a2", "url": "https://github.com/cBioPortal/cbioportal/commit/58da307b6770b3ef19c96b7c42b37a2b0c7289a2", "message": "Validate length of HGVSp_Short values", "committedDate": "2020-11-26T08:45:49Z", "type": "commit"}, {"oid": "58da307b6770b3ef19c96b7c42b37a2b0c7289a2", "url": "https://github.com/cBioPortal/cbioportal/commit/58da307b6770b3ef19c96b7c42b37a2b0c7289a2", "message": "Validate length of HGVSp_Short values", "committedDate": "2020-11-26T08:45:49Z", "type": "forcePushed"}]}