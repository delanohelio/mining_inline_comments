{"pr_number": 7259, "pr_title": "updating database schema for resource feature", "pr_createdAt": "2020-03-03T19:20:45Z", "pr_url": "https://github.com/cBioPortal/cbioportal/pull/7259", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwNzAxMg==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387307012", "bodyText": "may be declare it as enum\nRESOURCE_TYPE ENUM('STUDY', 'PATIENT', 'SAMPLE') NOT NULL,", "author": "kalletlak", "createdAt": "2020-03-03T21:34:39Z", "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,46 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,\n+  `RESOURCE_TYPE` varchar(255) NOT NULL COMMENT 'STUDY, PATIENT or SAMPLE',", "originalCommit": "b1ec4ceb008a8f725a20f4b862524a1df119e616", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwNzg3Mg==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387307872", "bodyText": "@adamabeshouse just want to confirm that there won't be a duplicate RESOURCE_ID for different types within a study", "author": "kalletlak", "createdAt": "2020-03-03T21:36:27Z", "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,46 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,\n+  `RESOURCE_TYPE` varchar(255) NOT NULL COMMENT 'STUDY, PATIENT or SAMPLE',\n+  `OPEN_BY_DEFAULT` BOOLEAN NOT NULL,\n+  `PRIORITY` int(11) NOT NULL,\n+  `CANCER_STUDY_ID` int(11) NOT NULL,\n+  PRIMARY KEY (`RESOURCE_ID`,`CANCER_STUDY_ID`),", "originalCommit": "b1ec4ceb008a8f725a20f4b862524a1df119e616", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk1MTUwOQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387951509", "bodyText": "correct, that's what I think it should be. thats how it works with clinical attributes, right? (clinical attr, study) is unique? @kalletlak", "author": "adamabeshouse", "createdAt": "2020-03-04T21:42:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwNzg3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMyNzYyOQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r388327629", "bodyText": "yes", "author": "kalletlak", "createdAt": "2020-03-05T14:28:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwNzg3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcxODY2NA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387718664", "bodyText": "set default value to false(0)", "author": "kalletlak", "createdAt": "2020-03-04T14:55:31Z", "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,46 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,\n+  `RESOURCE_TYPE` varchar(255) NOT NULL COMMENT 'STUDY, PATIENT or SAMPLE',\n+  `OPEN_BY_DEFAULT` BOOLEAN NOT NULL,", "originalCommit": "b1ec4ceb008a8f725a20f4b862524a1df119e616", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7", "url": "https://github.com/cBioPortal/cbioportal/commit/16bd41483886fd183bd98a189bd2e31f48d9f7b7", "message": "update resources schema", "committedDate": "2020-03-04T20:23:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMxNTYxNQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r388315615", "bodyText": "@dippindots @adamabeshouse any specific reason why DISPLAY_NAME could be null and DESCRIPTION not to be?", "author": "kalletlak", "createdAt": "2020-03-05T14:09:44Z", "path": "db-scripts/src/main/resources/migration.sql", "diffHunk": "@@ -812,3 +812,41 @@ WHERE NOT EXISTS (SELECT * FROM genetic_profile WHERE  STABLE_ID=CONCAT(`fusion_\n     AND CANCER_STUDY_ID = `fusion_studies`.CANCER_STUDY_ID);\n DROP TEMPORARY TABLE fusion_studies;\n UPDATE `info` SET `DB_SCHEMA_VERSION`=\"2.12.3\";\n+\n+##version: 2.12.4\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) DEFAULT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,", "originalCommit": "16bd41483886fd183bd98a189bd2e31f48d9f7b7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0862994b01798eee690841311aeb28eb44ad94d0", "url": "https://github.com/cBioPortal/cbioportal/commit/0862994b01798eee690841311aeb28eb44ad94d0", "message": "update resources schema", "committedDate": "2020-03-05T19:30:19Z", "type": "forcePushed"}, {"oid": "7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "url": "https://github.com/cBioPortal/cbioportal/commit/7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "message": "update resources schema", "committedDate": "2020-03-06T18:09:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NzIzMA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r389067230", "bodyText": "Since this ID is never used at all, why. not make (INTERNAL_ID, RESOURCE_ID, URL) as primary key?", "author": "kalletlak", "createdAt": "2020-03-06T18:24:40Z", "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,52 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) DEFAULT NULL,\n+  `RESOURCE_TYPE` ENUM('STUDY', 'PATIENT', 'SAMPLE') NOT NULL,\n+  `OPEN_BY_DEFAULT` BOOLEAN DEFAULT 0,\n+  `PRIORITY` int(11) NOT NULL,\n+  `CANCER_STUDY_ID` int(11) NOT NULL,\n+  PRIMARY KEY (`RESOURCE_ID`,`CANCER_STUDY_ID`),\n+  FOREIGN KEY (`CANCER_STUDY_ID`) REFERENCES `cancer_study` (`CANCER_STUDY_ID`) ON DELETE CASCADE\n+);\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_sample` (\n+  `ID` INT(11) NOT NULL auto_increment,", "originalCommit": "7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA4Njc4NA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r389086784", "bodyText": "technially someone could have a duplicate entry though", "author": "adamabeshouse", "createdAt": "2020-03-06T19:05:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NzIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA4ODc5NQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r389088795", "bodyText": "I think it should be detected and blocked while importing", "author": "kalletlak", "createdAt": "2020-03-06T19:09:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NzIzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTExOTI5NA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r389119294", "bodyText": "Thanks @kalletlak @adamabeshouse. Updated!", "author": "dippindots", "createdAt": "2020-03-06T20:08:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NzIzMA=="}], "type": "inlineReview"}, {"oid": "966212da755752fc6ca4192d9cea90f008b4bade", "url": "https://github.com/cBioPortal/cbioportal/commit/966212da755752fc6ca4192d9cea90f008b4bade", "message": "update resources schema", "committedDate": "2020-03-06T20:06:57Z", "type": "commit"}, {"oid": "966212da755752fc6ca4192d9cea90f008b4bade", "url": "https://github.com/cBioPortal/cbioportal/commit/966212da755752fc6ca4192d9cea90f008b4bade", "message": "update resources schema", "committedDate": "2020-03-06T20:06:57Z", "type": "forcePushed"}]}