{"pr_number": 7457, "pr_title": "Use public oncokb instance for portal without token", "pr_createdAt": "2020-04-29T23:55:40Z", "pr_url": "https://github.com/cBioPortal/cbioportal/pull/7457", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3OTM3Nw==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r417679377", "bodyText": "@jjgao could you take a look these instructions? Thank you.", "author": "zhx828", "createdAt": "2020-04-29T23:56:13Z", "path": "docs/OncoKB-Data-Access.md", "diffHunk": "@@ -1,13 +1,23 @@\n # Introduction", "originalCommit": "b1cbf2fef1aceff7f39dba31def1094b241a3c4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3OTY0NA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r417679644", "bodyText": "@jjgao I still remained the message. But let me know if you think it's no longer needed.", "author": "zhx828", "createdAt": "2020-04-29T23:57:01Z", "path": "web/src/main/java/org/cbioportal/web/config/WebServletContextListener.java", "diffHunk": "@@ -41,12 +44,11 @@ public void afterPropertiesSet() throws Exception {\n     }\n \n     private void checkOncokbInfo() {", "originalCommit": "b1cbf2fef1aceff7f39dba31def1094b241a3c4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwNjYwNQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419606605", "bodyText": "Should we move by default to the end of the last sentence?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Using OncoKB does not require a data access token by default. But the instance you are connecting to only includes biological information. \n          \n          \n            \n            Using OncoKB does not require a data access token. But the instance you are connecting to only includes biological information by default.", "author": "onursumer", "createdAt": "2020-05-04T17:34:39Z", "path": "docs/OncoKB-Data-Access.md", "diffHunk": "@@ -1,13 +1,23 @@\n # Introduction\n \n-A data access token is required for versions `v3.2.4` and greater to use OncoKB. Please review \n-OncoKB [terms](https://www.oncokb.org/terms) and request for [data access](https://www.oncokb.org/dataAccess) \n-if you would like to use OncoKB data with your private cBioPortal instance.\n+Using OncoKB does not require a data access token by default. But the instance you are connecting to only includes biological information. ", "originalCommit": "b1cbf2fef1aceff7f39dba31def1094b241a3c4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwODI2Mg==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419608262", "bodyText": "I couldn't spot the change in this line, am I missing something?", "author": "onursumer", "createdAt": "2020-05-04T17:37:26Z", "path": "docs/FAQ.md", "diffHunk": "@@ -132,7 +132,7 @@ The Network tab was retired on November 1, 2019. We will soon release a new feat\n #### Does the portal contain cancer study X?\n Check out the [Data Sets Page](https://www.cbioportal.org/data_sets.jsp) for the complete set of cancer studies currently stored in the portal. If you do not see your specific cancer study of interest, please [contact us](mailto:cbioportal@googlegroups.com), and we will let you know if it's in the queue.\n #### Which resources are integrated for variant annotation?\n-cBioPortal supports the annotation of variants from several different databases. These databases provide information about the recurrence of, or prior knowledge about, specific amino acid changes. For each variant, the number of occurrences of mutations at the same amino acid position present in the COSMIC database are reported. Furthermore, variants are annotated as \u201chotspots\u201d if the amino acid positions were found to be recurrent linear hotspots, as defined by the Cancer Hotspots method ([cancerhotspots.org](http://www.cancerhotspots.org/)), or three-dimensional hotspots, as defined by 3D Hotspots ([3dhotspots.org](https://www.3dhotspots.org/)). Prior knowledge about variants, including clinical actionability information, is provided from three different sources: OncoKB ([oncokb.org](http://oncokb.org/)), CIViC ([civicdb.org](https://civicdb.org/)), as well as My Cancer Genome ([mycancergenome.org](https://www.mycancergenome.org/)). For OncoKB, exact levels of clinical actionability are displayed in cBioPortal, as defined by [the OncoKB paper](http://ascopubs.org/doi/full/10.1200/PO.17.00011).\n+cBioPortal supports the annotation of variants from several different databases. These databases provide information about the recurrence of, or prior knowledge about, specific amino acid changes. For each variant, the number of occurrences of mutations at the same amino acid position present in the COSMIC database are reported. Furthermore, variants are annotated as \u201chotspots\u201d if the amino acid positions were found to be recurrent linear hotspots, as defined by the Cancer Hotspots method ([cancerhotspots.org](http://www.cancerhotspots.org/)), or three-dimensional hotspots, as defined by 3D Hotspots ([3dhotspots.org](https://www.3dhotspots.org/)). Prior knowledge about variants, including clinical actionability information, is provided from three different sources: OncoKB ([www.oncokb.org](https://www.oncokb.org/)), CIViC ([civicdb.org](https://civicdb.org/)), as well as My Cancer Genome ([mycancergenome.org](https://www.mycancergenome.org/)). For OncoKB, exact levels of clinical actionability are displayed in cBioPortal, as defined by [the OncoKB paper](http://ascopubs.org/doi/full/10.1200/PO.17.00011).", "originalCommit": "b1cbf2fef1aceff7f39dba31def1094b241a3c4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNzA0NQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419637045", "bodyText": "@onursumer only changing http:oncokb.org to https://www.oncokb.org", "author": "zhx828", "createdAt": "2020-05-04T18:24:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwODI2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYyODgzMg==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419628832", "bodyText": "Is it possible to specify the API URL?", "author": "jjgao", "createdAt": "2020-05-04T18:10:52Z", "path": "src/main/resources/portal.properties.EXAMPLE", "diffHunk": "@@ -165,7 +165,7 @@ segfile.url=http://cbio.mskcc.org/cancergenomics/gdac-portal/seg/\n show.oncokb=true", "originalCommit": "b1cbf2fef1aceff7f39dba31def1094b241a3c4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjY0Mg==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419636642", "bodyText": "Please see below. oncokb.public_api.url can be used", "author": "zhx828", "createdAt": "2020-05-04T18:24:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYyODgzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzMDQ4OQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419630489", "bodyText": "Is there a different parameter for authenticated API?", "author": "jjgao", "createdAt": "2020-05-04T18:13:31Z", "path": "docs/OncoKB-Data-Access.md", "diffHunk": "@@ -1,13 +1,23 @@\n # Introduction\n \n-A data access token is required for versions `v3.2.4` and greater to use OncoKB. Please review \n-OncoKB [terms](https://www.oncokb.org/terms) and request for [data access](https://www.oncokb.org/dataAccess) \n-if you would like to use OncoKB data with your private cBioPortal instance.\n+Using OncoKB does not require a data access token by default. But the instance you are connecting to only includes biological information. \n+If you want to include tumor type summary, therapeutic levels and more, please consider obtaining a license from OncoKB.\n \n-# Configuration\n+# How to obtain an OncoKB license\n+1. Please review OncoKB [terms](https://www.oncokb.org/terms) \n+2. Please request for [data access](https://www.oncokb.org/dataAccess)\n+3. You can find your token in your [Account Settings](https://www.oncokb.org/account/settings) after login.\n+\n+# Set up cBioPortal to include therapeutic information\n+\n+Following properties can be edited in the `portal.properties` file or set in system variables if you are using docker. \n+- `show.oncokb` should be set to `true`\n+- `oncokb.token` should be set to a valid OncoKB access token value\n+- `oncokb.public_api.url` should be set to `https://www.oncokb.org`", "originalCommit": "b1cbf2fef1aceff7f39dba31def1094b241a3c4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjQyMw==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419636423", "bodyText": "@jjgao no, there are only three parameters for oncokb and all listed here. As long as they supply the token, we will attach that to the authentication header.", "author": "zhx828", "createdAt": "2020-05-04T18:23:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzMDQ4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY0MDk5NA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419640994", "bodyText": "I think we have a default value: DEFAULT_ONCOKB_URL = \"https://public.api.oncokb.org/api/v1\", any difference between public.api.oncokb.org/api/v1 and www.oncokb.org?", "author": "leexgh", "createdAt": "2020-05-04T18:30:55Z", "path": "docs/OncoKB-Data-Access.md", "diffHunk": "@@ -1,13 +1,22 @@\n # Introduction\n \n-A data access token is required for versions `v3.2.4` and greater to use OncoKB. Please review \n-OncoKB [terms](https://www.oncokb.org/terms) and request for [data access](https://www.oncokb.org/dataAccess) \n-if you would like to use OncoKB data with your private cBioPortal instance.\n+Using OncoKB does not require a data access token. But the instance you are connecting to only includes biological information by default. \n+If you want to include tumor type summary, therapeutic levels and more, please consider obtaining a license from OncoKB.\n \n-# Configuration\n+# How to obtain an OncoKB license\n+1. Please review OncoKB [terms](https://www.oncokb.org/terms) \n+2. Please request for [data access](https://www.oncokb.org/dataAccess)\n+3. You can find your token in your [Account Settings](https://www.oncokb.org/account/settings) after login.\n \n-OncoKB data can be enabled by configuring `show.oncokb` and `oncokb.token` values in `portal.properties`. \n-`show.oncokb` should be set to `true` and `oncokb.token` should be set to a valid OncoKB access token value.\n-`oncokb.token` has to be provided in case `show.oncokb` is set to `true`, otherwise cBioPortal instance will \n-stop working with an OncoKB specific error message. To avoid such an error, set `show.oncokb` to `false` if \n-there is no OncoKB access token is available.\n\\ No newline at end of file\n+# Set up cBioPortal to include therapeutic information\n+\n+Following properties can be edited in the `portal.properties` file or set in system variables if you are using docker. \n+- `show.oncokb` should be set to `true`\n+- `oncokb.token` should be set to a valid OncoKB access token value\n+- `oncokb.public_api.url` should be set to `https://www.oncokb.org`", "originalCommit": "3fdb263f64290dcfa1f929bfbf5cce1544aa7d52", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY0MzU4NA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419643584", "bodyText": "@leexgh we actually changed the default to public.api.oncokb.org which does not require authentication. But good catch! Here should be www.oncokb.org/api/v1", "author": "zhx828", "createdAt": "2020-05-04T18:35:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY0MDk5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwMjQ2OA==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419702468", "bodyText": "@zhx828 do you think we need to set a default url for this one?", "author": "leexgh", "createdAt": "2020-05-04T20:18:44Z", "path": "web/src/main/java/org/cbioportal/web/config/WebServletContextListener.java", "diffHunk": "@@ -30,6 +32,7 @@ public void contextInitialized(ServletContextEvent arg0) {\n         \n         this.showOncokb = Boolean.parseBoolean(getProperty(\"show.oncokb\", \"true\"));\n         this.oncokbToken = getProperty(\"oncokb.token\", \"\");\n+        this.oncokbURL = getProperty(\"oncokb.public_api.url\", \"\");", "originalCommit": "5313ddf333d903573c36d39922d22d427468feb3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwMzg4NQ==", "url": "https://github.com/cBioPortal/cbioportal/pull/7457#discussion_r419703885", "bodyText": "@leexgh I don't think so. We use its empty status for later printing out the warning message.", "author": "zhx828", "createdAt": "2020-05-04T20:21:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcwMjQ2OA=="}], "type": "inlineReview"}, {"oid": "d0db996a0fcfe7266b001f2238417000b233f1c3", "url": "https://github.com/cBioPortal/cbioportal/commit/d0db996a0fcfe7266b001f2238417000b233f1c3", "message": "Give warning when the instance is connecting to a public oncokb instance\n\nUpdate documentation for using oncokb token to access therapeutic info\n\nUpdate all oncokb url to https\n\nCo-authored-by: Onur Sumer <s.onur.sumer@gmail.com>\n\nSigned-off-by: Hongxin Zhang <hongxin@cbio.mskcc.org>", "committedDate": "2020-05-05T21:59:10Z", "type": "forcePushed"}, {"oid": "b06888bf4f6472b44fbc2254fcc9558ac2e7da17", "url": "https://github.com/cBioPortal/cbioportal/commit/b06888bf4f6472b44fbc2254fcc9558ac2e7da17", "message": "Give warning when the instance is connecting to a public oncokb instance\n\nUpdate documentation for using oncokb token to access therapeutic info\n\nUpdate all oncokb url to https\n\nCo-authored-by: Onur Sumer <s.onur.sumer@gmail.com>\n\nSigned-off-by: Hongxin Zhang <hongxin@cbio.mskcc.org>", "committedDate": "2020-05-07T21:19:04Z", "type": "commit"}, {"oid": "b06888bf4f6472b44fbc2254fcc9558ac2e7da17", "url": "https://github.com/cBioPortal/cbioportal/commit/b06888bf4f6472b44fbc2254fcc9558ac2e7da17", "message": "Give warning when the instance is connecting to a public oncokb instance\n\nUpdate documentation for using oncokb token to access therapeutic info\n\nUpdate all oncokb url to https\n\nCo-authored-by: Onur Sumer <s.onur.sumer@gmail.com>\n\nSigned-off-by: Hongxin Zhang <hongxin@cbio.mskcc.org>", "committedDate": "2020-05-07T21:19:04Z", "type": "forcePushed"}]}