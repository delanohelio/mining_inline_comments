{"pr_number": 11529, "pr_title": "Prevent TTL from being set on synced inodes", "pr_createdAt": "2020-06-08T20:47:01Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11529", "timeline": [{"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25", "url": "https://github.com/Alluxio/alluxio/commit/9f879dd6609e4ee51ae88b20e52329ded7d68b25", "message": "Prevent TTL from being set on synced inodes", "committedDate": "2020-06-08T20:55:41Z", "type": "commit"}, {"oid": "9f879dd6609e4ee51ae88b20e52329ded7d68b25", "url": "https://github.com/Alluxio/alluxio/commit/9f879dd6609e4ee51ae88b20e52329ded7d68b25", "message": "Prevent TTL from being set on synced inodes", "committedDate": "2020-06-08T20:55:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAzNjczOQ==", "url": "https://github.com/Alluxio/alluxio/pull/11529#discussion_r437036739", "bodyText": "Do we have to set this explicitly? If so, why isn't it set in the other method above?\nAlso, can we have a constant for this \"no ttl\" common option. instead of building each time?", "author": "gpang", "createdAt": "2020-06-08T22:30:21Z", "path": "core/server/master/src/main/java/alluxio/master/file/InodeSyncStream.java", "diffHunk": "@@ -645,6 +650,11 @@ private void loadMetadata(LockedInodePath inodePath, LoadMetadataContext context\n             LoadMetadataContext loadMetadataContext =\n                 LoadMetadataContext.mergeFrom(LoadMetadataPOptions.newBuilder()\n                     .setLoadDescendantType(LoadDescendantPType.NONE)\n+                    // No Ttl on loaded files\n+                    .setCommonOptions(FileSystemMasterCommonPOptions.newBuilder()\n+                        .setTtl(-1)\n+                        .setTtlAction(TtlAction.DELETE)", "originalCommit": "9f879dd6609e4ee51ae88b20e52329ded7d68b25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA0MjA0Nw==", "url": "https://github.com/Alluxio/alluxio/pull/11529#discussion_r437042047", "bodyText": "Do we have to set this explicitly? If so, why isn't it set in the other method above?\n\n\"Other method above\" is not clear to me.", "author": "ZacBlanco", "createdAt": "2020-06-08T22:45:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAzNjczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEyODEyMA==", "url": "https://github.com/Alluxio/alluxio/pull/11529#discussion_r437128120", "bodyText": "I see 2 setCommonOptions() calls in this file. This one and the one earlier. They are slightly different because this one sets the action, and the other one doesn't.", "author": "gpang", "createdAt": "2020-06-09T04:17:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAzNjczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODMyMzgwMA==", "url": "https://github.com/Alluxio/alluxio/pull/11529#discussion_r438323800", "bodyText": "I see now, updated", "author": "ZacBlanco", "createdAt": "2020-06-10T18:22:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAzNjczOQ=="}], "type": "inlineReview"}, {"oid": "d7825653177138ae30132b6b358314f037114277", "url": "https://github.com/Alluxio/alluxio/commit/d7825653177138ae30132b6b358314f037114277", "message": "Use common no_ttl option", "committedDate": "2020-06-10T18:21:33Z", "type": "commit"}]}