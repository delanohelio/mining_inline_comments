{"pr_number": 11394, "pr_title": "[DOCFIX] Update port list on Docker doc", "pr_createdAt": "2020-05-07T14:39:17Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11394", "timeline": [{"oid": "33f1cd353cf5925962f9965c4a252fc1855d562b", "url": "https://github.com/Alluxio/alluxio/commit/33f1cd353cf5925962f9965c4a252fc1855d562b", "message": "update doc on ports", "committedDate": "2020-05-07T14:32:59Z", "type": "commit"}, {"oid": "881788ea8484a7d945c559cdb6230db996a3ac7b", "url": "https://github.com/Alluxio/alluxio/commit/881788ea8484a7d945c559cdb6230db996a3ac7b", "message": "add -p", "committedDate": "2020-05-07T14:35:36Z", "type": "commit"}, {"oid": "847e33de916973730db0fbc8b8fc1ce8d0f5e4d0", "url": "https://github.com/Alluxio/alluxio/commit/847e33de916973730db0fbc8b8fc1ce8d0f5e4d0", "message": "whitespace", "committedDate": "2020-05-07T14:41:15Z", "type": "commit"}, {"oid": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "url": "https://github.com/Alluxio/alluxio/commit/0b85073f2afb0087ad0bd937afcc2355a9daab6c", "message": "formatting never ends", "committedDate": "2020-05-07T14:42:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NjkwNQ==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425556905", "bodyText": "nit: Internal leader election", "author": "ZacBlanco", "createdAt": "2020-05-15T04:16:15Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -93,6 +93,18 @@ both of the following services:\n + Master RPC on port 19998\n + Worker RPC on port 29999\n \n+Within the Alluxio cluster, please also make sure the master and worker containers can reach\n+each other on the following ports.\n+You can find all the ports used by Alluxio components in [Alluxio configurations]({{ '/en/reference/Properties-List.html?q=port' | relativize_url }})\n+\n++ Master RPC on port 19998\n++ Master embedded journal on port 19200 if you are using [Internal leader selection]({{ '/en/deploy/Running-Alluxio-On-Docker.html#option-a-internal-leader-election' | relativize_url }})", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NjkyOQ==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425556929", "bodyText": "Internal leader election", "author": "ZacBlanco", "createdAt": "2020-05-15T04:16:24Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -93,6 +93,18 @@ both of the following services:\n + Master RPC on port 19998\n + Worker RPC on port 29999\n \n+Within the Alluxio cluster, please also make sure the master and worker containers can reach\n+each other on the following ports.\n+You can find all the ports used by Alluxio components in [Alluxio configurations]({{ '/en/reference/Properties-List.html?q=port' | relativize_url }})\n+\n++ Master RPC on port 19998\n++ Master embedded journal on port 19200 if you are using [Internal leader selection]({{ '/en/deploy/Running-Alluxio-On-Docker.html#option-a-internal-leader-election' | relativize_url }})\n++ Job master RPC on port 20001\n++ Job master embedded journal on port 20003 if you are using [Internal leader selection]({{ '/en/deploy/Running-Alluxio-On-Docker.html#option-a-internal-leader-election' | relativize_url }})", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzA4MA==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425557080", "bodyText": "We can also refer users to the Requirements page that lists out all of these ports? I think it would be better to do that rather than having the information duplicated", "author": "ZacBlanco", "createdAt": "2020-05-15T04:17:06Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -93,6 +93,18 @@ both of the following services:\n + Master RPC on port 19998\n + Worker RPC on port 29999\n \n+Within the Alluxio cluster, please also make sure the master and worker containers can reach\n+each other on the following ports.\n+You can find all the ports used by Alluxio components in [Alluxio configurations]({{ '/en/reference/Properties-List.html?q=port' | relativize_url }})\n+\n++ Master RPC on port 19998\n++ Master embedded journal on port 19200 if you are using [Internal leader selection]({{ '/en/deploy/Running-Alluxio-On-Docker.html#option-a-internal-leader-election' | relativize_url }})\n++ Job master RPC on port 20001\n++ Job master embedded journal on port 20003 if you are using [Internal leader selection]({{ '/en/deploy/Running-Alluxio-On-Docker.html#option-a-internal-leader-election' | relativize_url }})\n++ Worker RPC on port 29999\n++ Job worker RPC on port 30001\n++ Job worker data on port 30001\n+", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg5NDE0Ng==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425894146", "bodyText": "Good call. The table of contents in missing on the Requirements page. This will be fixed once #11438 is in.", "author": "jiacheliu3", "createdAt": "2020-05-15T15:53:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzA4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkyODE0NA==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425928144", "bodyText": "I still think we should remove this section?", "author": "ZacBlanco", "createdAt": "2020-05-15T16:53:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzA4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0ODQ0MA==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r426148440", "bodyText": "Yes PTAL at the latest change. #11438 fixes the Requirements.html page by adding the table of contents (and generates the missing links).", "author": "jiacheliu3", "createdAt": "2020-05-16T12:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzA4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzI3OQ==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425557279", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 unless firewall policies are defined specifically. \n          \n          \n            \n                 unless firewall policies are defined.", "author": "ZacBlanco", "createdAt": "2020-05-15T04:18:01Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -193,17 +208,23 @@ Notes:\n \n   1. The argument `--net=alluxio_network` tells Docker to use the user-defined bridge network ```alluxio_network```.\n      All containers will use their own container IDs as their hostname, and each of them has a different IP\n-     address within the network's subnet. Only the specified ports (-p option) are exposed to the Docker host.\n-  1. You must explicitly expose the two ports 19999 and 19998 for the Master container and the port 29999 and 30000 for the\n-     Worker container. Otherwise, the clients can't communicate with the the master and worker.\n+     address within the network's subnet.\n+     Containers connected to the same user-defined bridge network effectively expose all ports to each other,\n+     unless firewall policies are defined specifically. ", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzMyNA==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425557324", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 You can find more details about bridge network [here](https://docs.docker.com/network/bridge/).\n          \n          \n            \n                 You can find more details about the bridge network driver [here](https://docs.docker.com/network/bridge/).", "author": "ZacBlanco", "createdAt": "2020-05-15T04:18:13Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -193,17 +208,23 @@ Notes:\n \n   1. The argument `--net=alluxio_network` tells Docker to use the user-defined bridge network ```alluxio_network```.\n      All containers will use their own container IDs as their hostname, and each of them has a different IP\n-     address within the network's subnet. Only the specified ports (-p option) are exposed to the Docker host.\n-  1. You must explicitly expose the two ports 19999 and 19998 for the Master container and the port 29999 and 30000 for the\n-     Worker container. Otherwise, the clients can't communicate with the the master and worker.\n+     address within the network's subnet.\n+     Containers connected to the same user-defined bridge network effectively expose all ports to each other,\n+     unless firewall policies are defined specifically. \n+     You can find more details about bridge network [here](https://docs.docker.com/network/bridge/).", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzM4MQ==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425557381", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              1. Only the specified ports (-p option) are exposed to the outside network, where the client may be run.\n          \n          \n            \n              1. Only the specified ports (`-p` option) are exposed to the outside network, where the client may be run.", "author": "ZacBlanco", "createdAt": "2020-05-15T04:18:29Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -193,17 +208,23 @@ Notes:\n \n   1. The argument `--net=alluxio_network` tells Docker to use the user-defined bridge network ```alluxio_network```.\n      All containers will use their own container IDs as their hostname, and each of them has a different IP\n-     address within the network's subnet. Only the specified ports (-p option) are exposed to the Docker host.\n-  1. You must explicitly expose the two ports 19999 and 19998 for the Master container and the port 29999 and 30000 for the\n-     Worker container. Otherwise, the clients can't communicate with the the master and worker.\n+     address within the network's subnet.\n+     Containers connected to the same user-defined bridge network effectively expose all ports to each other,\n+     unless firewall policies are defined specifically. \n+     You can find more details about bridge network [here](https://docs.docker.com/network/bridge/).\n+  1. Only the specified ports (-p option) are exposed to the outside network, where the client may be run.", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1NzcwNA==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425557704", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 In host network, the master can't be referenced to by the master container name `alluxio-master` or\n          \n          \n            \n                 When using the `host` network driver, the master can't be referenced to by the master container name `alluxio-master` or", "author": "ZacBlanco", "createdAt": "2020-05-15T04:20:09Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -133,19 +145,22 @@ $ docker run -d --rm \\\n \n Notes:\n \n-  1. The argument `--net=host ` tells Docker to use the host network.  All containers\n-    will have the same hostname and IP address as the Docker host,\n-    and all the host's ports are directly mapped to containers. Therefore, all the required container\n-    ports `19999, 19998, 29999, 30000` are available for the clients via the Docker host.\n+  1. The argument `--net=host ` tells Docker to use the host network.\n+     Under this setup, the containers are directly using the host's network adapter.  \n+     All containers will have the same hostname and IP address as the Docker host,\n+     and all the host's ports are directly mapped to containers. Therefore, all the required container\n+     ports `19999, 19998, 29999, 30000` are available for the clients via the Docker host.\n+     You can find more details about this setting [here](https://docs.docker.com/network/host/).\n   1. The argument  `-e ALLUXIO_JAVA_OPTS=\"-Dalluxio.worker.memory.size=1G -Dalluxio.master.hostname=$(hostname -i)\"`\n-    allocates the worker's memory capacity and bind the master address. In host network,\n-\tthe master can't be referenced to by the master container name `alluxio-master` or\n-    it will throw `\"No Alluxio worker available\" ` error.\n-    Instead, it should be referenced to by the host IP address.\n-    The substitution `$(hostname -i)` does the trick.\n+     allocates the worker's memory capacity and bind the master address. \n+     In host network, the master can't be referenced to by the master container name `alluxio-master` or", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1ODE2MQ==", "url": "https://github.com/Alluxio/alluxio/pull/11394#discussion_r425558161", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 The substitution `$(hostname -i)` does the trick.\n          \n          \n            \n                 The substitution `$(hostname -i)` uses the docker host's name instead.", "author": "ZacBlanco", "createdAt": "2020-05-15T04:22:14Z", "path": "docs/en/deploy/Running-Alluxio-On-Docker.md", "diffHunk": "@@ -133,19 +145,22 @@ $ docker run -d --rm \\\n \n Notes:\n \n-  1. The argument `--net=host ` tells Docker to use the host network.  All containers\n-    will have the same hostname and IP address as the Docker host,\n-    and all the host's ports are directly mapped to containers. Therefore, all the required container\n-    ports `19999, 19998, 29999, 30000` are available for the clients via the Docker host.\n+  1. The argument `--net=host ` tells Docker to use the host network.\n+     Under this setup, the containers are directly using the host's network adapter.  \n+     All containers will have the same hostname and IP address as the Docker host,\n+     and all the host's ports are directly mapped to containers. Therefore, all the required container\n+     ports `19999, 19998, 29999, 30000` are available for the clients via the Docker host.\n+     You can find more details about this setting [here](https://docs.docker.com/network/host/).\n   1. The argument  `-e ALLUXIO_JAVA_OPTS=\"-Dalluxio.worker.memory.size=1G -Dalluxio.master.hostname=$(hostname -i)\"`\n-    allocates the worker's memory capacity and bind the master address. In host network,\n-\tthe master can't be referenced to by the master container name `alluxio-master` or\n-    it will throw `\"No Alluxio worker available\" ` error.\n-    Instead, it should be referenced to by the host IP address.\n-    The substitution `$(hostname -i)` does the trick.\n+     allocates the worker's memory capacity and bind the master address. \n+     In host network, the master can't be referenced to by the master container name `alluxio-master` or\n+     it will throw `\"No Alluxio worker available\" ` error.\n+     Instead, it should be referenced to by the host IP address.\n+     The substitution `$(hostname -i)` does the trick.", "originalCommit": "0b85073f2afb0087ad0bd937afcc2355a9daab6c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "de6f9a5a4f1155f683e18655e85b589da084d27f", "url": "https://github.com/Alluxio/alluxio/commit/de6f9a5a4f1155f683e18655e85b589da084d27f", "message": "resolve comments", "committedDate": "2020-05-15T15:45:10Z", "type": "commit"}, {"oid": "7a731aa0b8fbb6964cc8f5a875e99536f26f9230", "url": "https://github.com/Alluxio/alluxio/commit/7a731aa0b8fbb6964cc8f5a875e99536f26f9230", "message": "refer to requirements.html page", "committedDate": "2020-05-16T12:13:02Z", "type": "commit"}]}