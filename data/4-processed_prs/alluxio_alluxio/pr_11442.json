{"pr_number": 11442, "pr_title": "Add more traces for worker management tasks", "pr_createdAt": "2020-05-16T04:21:24Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11442", "timeline": [{"oid": "dadc14b9ce654d123b71324690ef29c7213ef3a0", "url": "https://github.com/Alluxio/alluxio/commit/dadc14b9ce654d123b71324690ef29c7213ef3a0", "message": "Add more traces for worker management tasks", "committedDate": "2020-05-16T04:47:53Z", "type": "forcePushed"}, {"oid": "cc7852e7889cd0deab50d8e6225ab4a44968f777", "url": "https://github.com/Alluxio/alluxio/commit/cc7852e7889cd0deab50d8e6225ab4a44968f777", "message": "Add more traces for worker management tasks", "committedDate": "2020-05-16T08:11:24Z", "type": "commit"}, {"oid": "cc7852e7889cd0deab50d8e6225ab4a44968f777", "url": "https://github.com/Alluxio/alluxio/commit/cc7852e7889cd0deab50d8e6225ab4a44968f777", "message": "Add more traces for worker management tasks", "committedDate": "2020-05-16T08:11:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MzI1Ng==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426793256", "bodyText": "Do we not want to show the ANY information anymore?", "author": "calvinjia", "createdAt": "2020-05-18T17:43:56Z", "path": "core/common/src/main/java/alluxio/worker/block/BlockStoreLocation.java", "diffHunk": "@@ -150,25 +152,17 @@ public boolean belongsTo(BlockStoreLocation location) {\n    */\n   @Override\n   public String toString() {\n-    StringBuilder result = new StringBuilder();\n-    if (mDirIndex == ANY_DIR) {\n-      result.append(\"any dir\");\n-    } else {\n-      result.append(\"dir \").append(mDirIndex);\n+    MoreObjects.ToStringHelper strHelper = MoreObjects.toStringHelper(this);", "originalCommit": "cc7852e7889cd0deab50d8e6225ab4a44968f777", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg0NTgwMA==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426845800", "bodyText": "It's implicit by not having it shown.\nI couldn't find any justification to generate a human-readable string.\nHowever this helps a great deal during investigations.", "author": "ggezer", "createdAt": "2020-05-18T19:25:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MzI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg5NDI0Nw==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426894247", "bodyText": "Right, I would prefer explicit for easier debugging.", "author": "calvinjia", "createdAt": "2020-05-18T21:08:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MzI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyNzc0NA==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426927744", "bodyText": "Made it explicit, but with the new string helper format.", "author": "ggezer", "createdAt": "2020-05-18T22:32:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MzI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MzQ0Mw==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426793443", "bodyText": "Can this fit on one line? (applies in general)", "author": "calvinjia", "createdAt": "2020-05-18T17:44:17Z", "path": "core/server/worker/src/main/java/alluxio/worker/block/annotator/DefaultBlockIterator.java", "diffHunk": "@@ -116,7 +116,8 @@ private void blockUpdated(long blockId, BlockStoreLocation location) {\n     }\n \n     if (LOG.isDebugEnabled()) {\n-      LOG.debug(\"Block:{} updated at location:{}. Size:{}\", blockId, location, sortedSet.size());\n+      LOG.debug(\"Block:{} updated at {} with {} blocks.\",", "originalCommit": "cc7852e7889cd0deab50d8e6225ab4a44968f777", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg0NjIyOA==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426846228", "bodyText": "This and one other fit indeed. However I did this mostly when the last or two parameter spilled to the second line.", "author": "ggezer", "createdAt": "2020-05-18T19:26:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MzQ0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwMTQ1OQ==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426801459", "bodyText": "Do we need to wrap in isDebugEnabled? Also, based on our logging framework, will just using debug be sufficient to avoid the expensive portions for most of these?", "author": "calvinjia", "createdAt": "2020-05-18T17:58:49Z", "path": "core/server/worker/src/main/java/alluxio/worker/block/management/tier/AlignTask.java", "diffHunk": "@@ -143,6 +163,8 @@ public void run() {\n           blockLocPairListDst.get(i).getFirst()));\n     }\n \n+    LOG.debug(\"Generated {} swap transfers: \\n ->{}\", transferInfos.size(),", "originalCommit": "cc7852e7889cd0deab50d8e6225ab4a44968f777", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg0NDAyNQ==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426844025", "bodyText": "Yes, otherwise the parameters will be evaluated before making the decision to print.", "author": "ggezer", "createdAt": "2020-05-18T19:22:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwMTQ1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg0NjgxMw==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426846813", "bodyText": "I also validated this on debugger.", "author": "ggezer", "createdAt": "2020-05-18T19:27:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwMTQ1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg5NDU5NQ==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426894595", "bodyText": "This message is not wrapped in isDebugEnabled?", "author": "calvinjia", "createdAt": "2020-05-18T21:09:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwMTQ1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyNzU2NQ==", "url": "https://github.com/Alluxio/alluxio/pull/11442#discussion_r426927565", "bodyText": "Oh. right.", "author": "ggezer", "createdAt": "2020-05-18T22:31:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjgwMTQ1OQ=="}], "type": "inlineReview"}, {"oid": "982c09bdd84b32c5b2386c29ba5b0d861211dd06", "url": "https://github.com/Alluxio/alluxio/commit/982c09bdd84b32c5b2386c29ba5b0d861211dd06", "message": "Unwrap few debug logs", "committedDate": "2020-05-18T19:27:03Z", "type": "commit"}, {"oid": "4d2b9aa28199ed7bdfd6aa2e5aa43f2b5fb75bd5", "url": "https://github.com/Alluxio/alluxio/commit/4d2b9aa28199ed7bdfd6aa2e5aa43f2b5fb75bd5", "message": "PR feedback", "committedDate": "2020-05-18T22:31:28Z", "type": "commit"}]}