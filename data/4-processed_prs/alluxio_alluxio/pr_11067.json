{"pr_number": 11067, "pr_title": "Fix K8s job worker java opts", "pr_createdAt": "2020-02-28T20:49:22Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11067", "timeline": [{"oid": "77b34ad75be1b5a6a108abdbfca8ada8fdec3a76", "url": "https://github.com/Alluxio/alluxio/commit/77b34ad75be1b5a6a108abdbfca8ada8fdec3a76", "message": "Fix K8s job worker java opts", "committedDate": "2020-02-28T20:45:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5NzM5Mw==", "url": "https://github.com/Alluxio/alluxio/pull/11067#discussion_r386197393", "bodyText": "since these are simply a space-separated list, is it possible for us to simply split this into a key-value format in yaml and run some post-processing to generate the string needed when we pass all of these values to the containers? I think it is harder to maintain and more prone to errors like this\nEx:\n ALLUXIO_JOB_WORKER_JAVA_OPTS:\n  alluxio.job.worker.rpc.port: 30001\n  alluxio.job.worker.data.port: 30002\n  alluxio.job.worker.web.port: 30003  \n  alluxio.worker.hostname: ${ALLUXIO_WORKER_HOSTNAME}\nAnd then somewhere later on down the pipeline..\nopts = \"\"\nfor key, value in ALLUXIO_JOB_WORKER_JAVA_OPTS:\n  opts += \" -D$key=\\\"$value\\\" \"\n\nIs this feasible?", "author": "ZacBlanco", "createdAt": "2020-03-02T04:55:57Z", "path": "integration/kubernetes/singleMaster-localJournal/alluxio-configmap.yaml.template", "diffHunk": "@@ -36,7 +36,7 @@ data:\n   ALLUXIO_WORKER_JAVA_OPTS: |-\n     -Dalluxio.worker.bind.host=0.0.0.0  -Dalluxio.worker.data.server.domain.socket.address=/opt/domain -Dalluxio.worker.data.server.domain.socket.as.uuid=true -Dalluxio.worker.memory.size=2G -Dalluxio.worker.rpc.port=29999 -Dalluxio.worker.web.port=30000 -Dalluxio.worker.hostname=${ALLUXIO_WORKER_HOSTNAME} -Dalluxio.worker.tieredstore.levels=1 -Dalluxio.worker.tieredstore.level0.dirs.mediumtype=MEM -Dalluxio.worker.tieredstore.level0.dirs.path=/dev/shm -Dalluxio.worker.tieredstore.level0.dirs.quota=1G -Dalluxio.worker.tieredstore.level0.watermark.high.ratio=0.95 -Dalluxio.worker.tieredstore.level0.watermark.low.ratio=0.7 \n   ALLUXIO_JOB_WORKER_JAVA_OPTS: |-\n-    -Dalluxio.job.worker.rpc.port=30001  -Dalluxio.job.worker.data.port=30002 -Dalluxio.job.worker.web.port=30003 -Dalluxio.worker.hostname=${ALLUXIO_WORKER_HOSTNAME}\n+    -Dalluxio.job.worker.rpc.port=30001  -Dalluxio.job.worker.data.port=30002 -Dalluxio.job.worker.web.port=30003 -Dalluxio.worker.hostname=${ALLUXIO_WORKER_HOSTNAME} ", "originalCommit": "77b34ad75be1b5a6a108abdbfca8ada8fdec3a76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5ODI0NA==", "url": "https://github.com/Alluxio/alluxio/pull/11067#discussion_r386198244", "bodyText": "Logged #11081\nThis should be a low-hanging fruit.", "author": "jiacheliu3", "createdAt": "2020-03-02T05:01:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5NzM5Mw=="}], "type": "inlineReview"}]}