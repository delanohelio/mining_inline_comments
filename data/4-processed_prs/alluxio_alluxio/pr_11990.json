{"pr_number": 11990, "pr_title": "Fix tools.jar dependency", "pr_createdAt": "2020-08-14T18:07:20Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11990", "timeline": [{"oid": "8636d387ea47a08bcfe74bf92c5f7760a12dbecb", "url": "https://github.com/Alluxio/alluxio/commit/8636d387ea47a08bcfe74bf92c5f7760a12dbecb", "message": "try fixing tests", "committedDate": "2020-08-14T18:06:54Z", "type": "commit"}, {"oid": "338d6852133f6f3c8321bfc73a8642148836009a", "url": "https://github.com/Alluxio/alluxio/commit/338d6852133f6f3c8321bfc73a8642148836009a", "message": "exclude tools.jar", "committedDate": "2020-08-14T19:31:18Z", "type": "commit"}, {"oid": "42e02a6eac452fe78e582329a2660c4e540e13ae", "url": "https://github.com/Alluxio/alluxio/commit/42e02a6eac452fe78e582329a2660c4e540e13ae", "message": "fix dependency to be jdk aware", "committedDate": "2020-08-14T20:33:14Z", "type": "commit"}, {"oid": "4d5ada5c8cab0b4fba103167e0448e6042300b18", "url": "https://github.com/Alluxio/alluxio/commit/4d5ada5c8cab0b4fba103167e0448e6042300b18", "message": "remove exclusion", "committedDate": "2020-08-14T20:37:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg1NDcxNw==", "url": "https://github.com/Alluxio/alluxio/pull/11990#discussion_r470854717", "bodyText": "this is the main part of the change. the rest of the file was wrongly indented", "author": "yuzhu", "createdAt": "2020-08-14T20:39:20Z", "path": "table/server/underdb/glue/pom.xml", "diffHunk": "@@ -77,5 +77,38 @@\n         </dependency>\n     </dependencies>\n \n-\n+  <profiles>\n+    <profile>\n+      <id>java11</id>\n+      <activation>\n+        <jdk>11</jdk>\n+      </activation>\n+      <dependencies>\n+        <dependency>\n+          <groupId>org.apache.hive</groupId>\n+          <artifactId>hive-metastore</artifactId>\n+          <version>${hive-metastore.version}</version>\n+          <scope>compile</scope>\n+          <exclusions>\n+            <exclusion>\n+              <groupId>org.apache.logging.log4j</groupId>\n+              <artifactId>log4j-1.2-api</artifactId>\n+            </exclusion>\n+            <exclusion>\n+              <groupId>org.apache.logging.log4j</groupId>\n+              <artifactId>log4j-slf4j-impl</artifactId>\n+            </exclusion>\n+            <exclusion>\n+              <groupId>com.google.protobuf</groupId>\n+              <artifactId>protobuf-java</artifactId>\n+            </exclusion>\n+            <exclusion>\n+              <groupId>jdk.tools</groupId>", "originalCommit": "4d5ada5c8cab0b4fba103167e0448e6042300b18", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "913a42bf70a631b5191948d4e50700a8e1a44063", "url": "https://github.com/Alluxio/alluxio/commit/913a42bf70a631b5191948d4e50700a8e1a44063", "message": "glue library exclusion", "committedDate": "2020-08-14T22:15:57Z", "type": "commit"}, {"oid": "8b7a571af720548f9d02f2f97c31978e7b624d30", "url": "https://github.com/Alluxio/alluxio/commit/8b7a571af720548f9d02f2f97c31978e7b624d30", "message": "more pom adjustment", "committedDate": "2020-08-14T22:24:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwODM2OA==", "url": "https://github.com/Alluxio/alluxio/pull/11990#discussion_r470908368", "bodyText": "do we not need to exclude this any more?", "author": "ZacBlanco", "createdAt": "2020-08-14T23:52:08Z", "path": "table/server/underdb/glue/pom.xml", "diffHunk": "@@ -13,69 +13,98 @@\n <project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n          xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n-    <parent>\n-        <artifactId>alluxio-table-server-underdb</artifactId>\n-        <groupId>org.alluxio</groupId>\n-        <version>2.4.0-SNAPSHOT</version>\n-    </parent>\n-    <modelVersion>4.0.0</modelVersion>\n+  <parent>\n+      <artifactId>alluxio-table-server-underdb</artifactId>\n+      <groupId>org.alluxio</groupId>\n+      <version>2.4.0-SNAPSHOT</version>\n+  </parent>\n+  <modelVersion>4.0.0</modelVersion>\n \n-    <artifactId>alluxio-table-server-underdb-glue</artifactId>\n-    <packaging>jar</packaging>\n-    <name>Alluxio Table - Server - UnderDB - Glue</name>\n-    <description>Alluxio table underDB implementation for aws glue</description>\n+  <artifactId>alluxio-table-server-underdb-glue</artifactId>\n+  <packaging>jar</packaging>\n+  <name>Alluxio Table - Server - UnderDB - Glue</name>\n+  <description>Alluxio table underDB implementation for aws glue</description>\n \n-    <properties>\n-        <!-- The following paths need to be defined here as well as in the parent pom so that mvn can -->\n-        <!-- run properly from sub-project directories -->\n-        <build.path>${project.parent.parent.parent.parent.basedir}/build</build.path>\n-        <glue.version>1.11.820</glue.version>\n-        <aws.java.jdk.version>1.11.820</aws.java.jdk.version>\n-        <hive-metastore.version>2.3.7</hive-metastore.version>\n-    </properties>\n+  <properties>\n+      <!-- The following paths need to be defined here as well as in the parent pom so that mvn can -->\n+      <!-- run properly from sub-project directories -->\n+      <build.path>${project.parent.parent.parent.parent.basedir}/build</build.path>\n+      <glue.version>1.11.820</glue.version>\n+      <aws.java.jdk.version>1.11.820</aws.java.jdk.version>\n+      <hive-metastore.version>2.3.7</hive-metastore.version>\n+  </properties>\n \n-    <dependencies>\n-        <!-- External dependencies -->\n-        <dependency>\n-            <groupId>com.amazonaws</groupId>\n-            <artifactId>aws-java-sdk-glue</artifactId>\n-            <version>${glue.version}</version>\n-        </dependency>\n+  <dependencies>\n+      <!-- External dependencies -->\n+      <dependency>\n+          <groupId>com.amazonaws</groupId>\n+          <artifactId>aws-java-sdk-glue</artifactId>\n+          <version>${glue.version}</version>\n+      </dependency>\n \n-        <dependency>\n-            <groupId>com.amazonaws</groupId>\n-            <artifactId>aws-java-sdk-core</artifactId>\n-            <version>${aws.java.jdk.version}</version>\n-        </dependency>\n+      <dependency>\n+          <groupId>com.amazonaws</groupId>\n+          <artifactId>aws-java-sdk-core</artifactId>\n+          <version>${aws.java.jdk.version}</version>\n+      </dependency>\n \n-        <!--aws sdk requires jaxb binding at runtime-->\n-        <dependency>\n-            <groupId>com.sun.xml.bind</groupId>\n-            <artifactId>jaxb-impl</artifactId>\n-            <scope>runtime</scope>\n-        </dependency>\n+      <!--aws sdk requires jaxb binding at runtime-->\n+      <dependency>\n+          <groupId>com.sun.xml.bind</groupId>\n+          <artifactId>jaxb-impl</artifactId>\n+          <scope>runtime</scope>\n+      </dependency>\n+\n+      <dependency>\n+          <groupId>org.apache.hive</groupId>\n+          <artifactId>hive-common</artifactId>\n+          <version>${hive-metastore.version}</version>\n+          <scope>compile</scope>\n+          <exclusions>\n+              <exclusion>\n+                  <groupId>org.apache.logging.log4j</groupId>\n+                  <artifactId>log4j-1.2-api</artifactId>\n+              </exclusion>\n+              <exclusion>\n+                  <groupId>org.apache.logging.log4j</groupId>\n+                  <artifactId>log4j-slf4j-impl</artifactId>\n+              </exclusion>\n+              <exclusion>\n+                  <groupId>com.google.protobuf</groupId>\n+                  <artifactId>protobuf-java</artifactId>\n+              </exclusion>\n+          </exclusions>\n+      </dependency>\n+  </dependencies>\n \n+  <profiles>\n+    <profile>\n+      <id>java11</id>\n+      <activation>\n+        <jdk>11</jdk>\n+      </activation>\n+      <dependencies>\n         <dependency>\n-            <groupId>org.apache.hive</groupId>\n-            <artifactId>hive-common</artifactId>\n-            <version>${hive-metastore.version}</version>\n-            <scope>compile</scope>\n-            <exclusions>\n-                <exclusion>\n-                    <groupId>org.apache.logging.log4j</groupId>\n-                    <artifactId>log4j-1.2-api</artifactId>\n-                </exclusion>\n-                <exclusion>\n-                    <groupId>org.apache.logging.log4j</groupId>\n-                    <artifactId>log4j-slf4j-impl</artifactId>\n-                </exclusion>\n-                <exclusion>\n-                    <groupId>com.google.protobuf</groupId>\n-                    <artifactId>protobuf-java</artifactId>\n-                </exclusion>", "originalCommit": "8b7a571af720548f9d02f2f97c31978e7b624d30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMjU5OA==", "url": "https://github.com/Alluxio/alluxio/pull/11990#discussion_r470912598", "bodyText": "fixed, keeping the files consistent", "author": "yuzhu", "createdAt": "2020-08-15T00:17:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwODM2OA=="}], "type": "inlineReview"}, {"oid": "edd26524703b1d4e623a6a43356ce943463c1c3a", "url": "https://github.com/Alluxio/alluxio/commit/edd26524703b1d4e623a6a43356ce943463c1c3a", "message": "address comments", "committedDate": "2020-08-15T00:11:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMjM0OA==", "url": "https://github.com/Alluxio/alluxio/pull/11990#discussion_r470912348", "bodyText": "is this added now to be consistent with the other dependency? Can we make this a dependency in table/server or table/server/underdb and share it between hive and glue so we don't have to name the exclusions list twice?\nedit: by \"make this a dependency\" I mean the hive-metastore a higher level dependency so we don't need the exclusions multiple places", "author": "ZacBlanco", "createdAt": "2020-08-15T00:15:52Z", "path": "table/server/underdb/hive/pom.xml", "diffHunk": "@@ -151,6 +151,10 @@\n               <groupId>org.apache.logging.log4j</groupId>\n               <artifactId>log4j-slf4j-impl</artifactId>\n             </exclusion>\n+            <exclusion>\n+              <groupId>com.google.protobuf</groupId>\n+              <artifactId>protobuf-java</artifactId>\n+            </exclusion>", "originalCommit": "edd26524703b1d4e623a6a43356ce943463c1c3a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMzMzNg==", "url": "https://github.com/Alluxio/alluxio/pull/11990#discussion_r470913336", "bodyText": "my goal is to soon remove the dependency on hive from glue. i think right now it uses some string manipulation functions from hive....", "author": "yuzhu", "createdAt": "2020-08-15T00:22:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMjM0OA=="}], "type": "inlineReview"}]}