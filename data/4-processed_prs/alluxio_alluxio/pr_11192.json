{"pr_number": 11192, "pr_title": "Fix categoryList parsing in docs check", "pr_createdAt": "2020-03-19T23:50:53Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/11192", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395383799", "bodyText": "would it just be easier to add a yaml parsing command line tool in the CI container, and then use that to query for this?\nex:  https://kislyuk.github.io/yq/", "author": "ZacBlanco", "createdAt": "2020-03-20T00:00:57Z", "path": "docs/check.go", "diffHunk": "@@ -145,11 +145,16 @@ func parseCategoryNames(configPath string) (StringSet, error) {\n \t\t\tcontinue\n \t\t}\n \t\tif found {\n-\t\t\tif !strings.HasPrefix(l, categoryPrefix) {\n-\t\t\t\tfound = false\n+\t\t\tif strings.HasPrefix(l, commentPrefix) {\n+\t\t\t\t// skip commented lines\n \t\t\t\tcontinue\n \t\t\t}\n-\t\t\tcategoryNames.Add(strings.TrimPrefix(l, categoryPrefix))\n+\t\t\tif strings.HasPrefix(l, categoryPrefix) {\n+\t\t\t\tcategoryNames.Add(strings.TrimPrefix(l, categoryPrefix))\n+\t\t\t\tcontinue\n+\t\t\t}\n+\t\t\t// stop parsing if line is neither comment or category\n+\t\t\tfound = false", "originalCommit": "c91c41712c900352b3f07cd196434204791a282f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4NDkzMw==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395384933", "bodyText": "pip -> python -> i have nothing more to say\nwe don't have python in the image, i would have given more consideration if it was already present and used for something else", "author": "Xenorith", "createdAt": "2020-03-20T00:05:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4NTIxNw==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395385217", "bodyText": "but the next search result:\nhttps://github.com/mikefarah/yq", "author": "Xenorith", "createdAt": "2020-03-20T00:06:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4OTM1NA==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395389354", "bodyText": "I am ok adding to the CI image. It will help make the code here more readable", "author": "ZacBlanco", "createdAt": "2020-03-20T00:23:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4OTkzMw==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395389933", "bodyText": "ok adding python + pip + yq or wget yq && mv /usr/local/bin/?", "author": "Xenorith", "createdAt": "2020-03-20T00:26:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM5MDE4Nw==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395390187", "bodyText": "Isn't go installed? Can we not use GO111MODULE=on go get github.com/mikefarah/yq/v3 from the link you gave above?", "author": "ZacBlanco", "createdAt": "2020-03-20T00:27:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM5MDI4Nw==", "url": "https://github.com/Alluxio/alluxio/pull/11192#discussion_r395390287", "bodyText": "Either way, I'm good with adding the go-based one", "author": "ZacBlanco", "createdAt": "2020-03-20T00:27:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM4Mzc5OQ=="}], "type": "inlineReview"}, {"oid": "034bf3e285c719dd989a276a25709be2c92db14c", "url": "https://github.com/Alluxio/alluxio/commit/034bf3e285c719dd989a276a25709be2c92db14c", "message": "Update docs check with yaml library", "committedDate": "2020-03-30T23:07:30Z", "type": "commit"}, {"oid": "034bf3e285c719dd989a276a25709be2c92db14c", "url": "https://github.com/Alluxio/alluxio/commit/034bf3e285c719dd989a276a25709be2c92db14c", "message": "Update docs check with yaml library", "committedDate": "2020-03-30T23:07:30Z", "type": "forcePushed"}, {"oid": "5a8cf5eec702ddaf410072416c9ddac87e5c0855", "url": "https://github.com/Alluxio/alluxio/commit/5a8cf5eec702ddaf410072416c9ddac87e5c0855", "message": "move vendored libs into alluxio.org/vendor and update license exclusions", "committedDate": "2020-03-30T23:26:32Z", "type": "commit"}, {"oid": "1b1684276c31561ca8ac2d004dd5d3f2ad733940", "url": "https://github.com/Alluxio/alluxio/commit/1b1684276c31561ca8ac2d004dd5d3f2ad733940", "message": "add license headers", "committedDate": "2020-03-30T23:37:56Z", "type": "commit"}, {"oid": "0b7259e513836fe74dfbfe4948584ac6f3d815d5", "url": "https://github.com/Alluxio/alluxio/commit/0b7259e513836fe74dfbfe4948584ac6f3d815d5", "message": "remove test files from vendored yaml", "committedDate": "2020-03-30T23:45:24Z", "type": "commit"}]}