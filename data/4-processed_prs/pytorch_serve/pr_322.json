{"pr_number": 322, "pr_title": "Issue 312 install from src", "pr_createdAt": "2020-05-09T01:31:36Z", "pr_url": "https://github.com/pytorch/serve/pull/322", "timeline": [{"oid": "c1dbc2a671bfdc08030afd272a8a3c6a0f8fe4b6", "url": "https://github.com/pytorch/serve/commit/c1dbc2a671bfdc08030afd272a8a3c6a0f8fe4b6", "message": "documentation: fixed issues in installation and quick start in README.md", "committedDate": "2020-05-02T01:48:50Z", "type": "commit"}, {"oid": "e13bfc184e7323ce4d990702f4a34537acd8165d", "url": "https://github.com/pytorch/serve/commit/e13bfc184e7323ce4d990702f4a34537acd8165d", "message": "documentation: Reverting conda related doc changes from PR#286\n\nFixes https://github.com/pytorch/serve/issues/297", "committedDate": "2020-05-02T23:41:37Z", "type": "commit"}, {"oid": "296116b8ea2ec36ad412b80a12743408d7ad4b69", "url": "https://github.com/pytorch/serve/commit/296116b8ea2ec36ad412b80a12743408d7ad4b69", "message": "Merge pull request #298 from maaquib/issue_297\n\ndocumentation: Reverting conda related doc changes from PR#286", "committedDate": "2020-05-02T23:56:11Z", "type": "commit"}, {"oid": "85dbef426688c5d0fe2a47fc56cad6a79b179718", "url": "https://github.com/pytorch/serve/commit/85dbef426688c5d0fe2a47fc56cad6a79b179718", "message": "remove minus y (#311)\n\nupdate pip install instructions", "committedDate": "2020-05-08T17:14:30Z", "type": "commit"}, {"oid": "044f8d23d50a093b9d6f2c0f69afc147cf9eb746", "url": "https://github.com/pytorch/serve/commit/044f8d23d50a093b9d6f2c0f69afc147cf9eb746", "message": "Update instructions for installation from source\n\nThis commit aims to address Issue #312\n\nTested on a fresh EC2 P3.2 instance:\n* Followed instructions under\nhttps://github.com/pytorch/serve#install-torchserve-for-development\n* Started the server manually from command line\n* Ran a ping query\n\nReceived a response from server with \"Healthy\" status\n\nSigned-off-by: Manoj Rao <mail@mycpu.org>", "committedDate": "2020-05-08T22:28:45Z", "type": "commit"}, {"oid": "231f18ca958d74570410235a28c5bcfb927ccae7", "url": "https://github.com/pytorch/serve/commit/231f18ca958d74570410235a28c5bcfb927ccae7", "message": "add separate files for installation\n\none each for linux and macos", "committedDate": "2020-05-08T23:32:14Z", "type": "commit"}, {"oid": "eef731fac8ff92a7117f199659e7847f76742788", "url": "https://github.com/pytorch/serve/commit/eef731fac8ff92a7117f199659e7847f76742788", "message": "update README and remove relative path from script", "committedDate": "2020-05-09T00:25:09Z", "type": "commit"}, {"oid": "9e083890ffe67dfd76769fd760a29d3fc291e40a", "url": "https://github.com/pytorch/serve/commit/9e083890ffe67dfd76769fd760a29d3fc291e40a", "message": "Install script - Dont uninstall if not previously installed - #132", "committedDate": "2020-05-09T01:27:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ1NDE5Mg==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422454192", "bodyText": "we should remove powerai channel as well, it is only required for sentencepiece.", "author": "harshbafna", "createdAt": "2020-05-09T05:11:32Z", "path": "README.md", "diffHunk": "@@ -40,13 +47,13 @@ pip install torchserve torch-model-archiver\n     For CPU\n \n     ```bash\n-    conda create --name torchserve torchserve torch-model-archiver psutil future pytorch sentencepiece torchtext torchvision -c pytorch -c powerai\n+    conda create --name torchserve torchserve torch-model-archiver psutil future pytorch torchtext torchvision -c pytorch -c powerai", "originalCommit": "9e083890ffe67dfd76769fd760a29d3fc291e40a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA3NzQyOQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423077429", "bodyText": "I think basic setup should be stripped down to just conda create --name torchserve torchserve torch-model-archiver -c pytorch. It seems to work fine that way for basic usage and doesn't add extra deps in the setup command.", "author": "aaronmarkham", "createdAt": "2020-05-11T14:24:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ1NDE5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NzU2NQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423347565", "bodyText": "Can we please limit our reviews to the section for installing from source? This will help us stay focused in this commit.\nThis commit only tries to fix what's reported in the issue #312\nFor other issues than what this commit is trying to address please feel free to create an issue and we can track them. Thanks.", "author": "mycpuorg", "createdAt": "2020-05-11T22:06:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ1NDE5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ1NDE5NQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422454195", "bodyText": "we should remove powerai channel as well, it is only required for sentencepiece.", "author": "harshbafna", "createdAt": "2020-05-09T05:11:43Z", "path": "README.md", "diffHunk": "@@ -40,13 +47,13 @@ pip install torchserve torch-model-archiver\n     For CPU\n \n     ```bash\n-    conda create --name torchserve torchserve torch-model-archiver psutil future pytorch sentencepiece torchtext torchvision -c pytorch -c powerai\n+    conda create --name torchserve torchserve torch-model-archiver psutil future pytorch torchtext torchvision -c pytorch -c powerai\n     ```\n \n     For GPU\n \n     ```bash\n-    conda create --name torchserve torchserve torch-model-archiver psutil future pytorch sentencepiece torchtext torchvision cudatoolkit=10.1 -c pytorch -c powerai\n+    conda create --name torchserve torchserve torch-model-archiver psutil future pytorch torchtext torchvision cudatoolkit=10.1 -c pytorch -c powerai", "originalCommit": "9e083890ffe67dfd76769fd760a29d3fc291e40a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYwODk2OA==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422608968", "bodyText": "The name of the script file is incorrect. Please update to correct name ./scripts/install_from_src_ubuntu", "author": "chauhang", "createdAt": "2020-05-10T08:24:48Z", "path": "README.md", "diffHunk": "@@ -77,36 +89,32 @@ pip install torchserve torch-model-archiver\n     source activate torchserve\n     ```\n \n+2. Optional if using torchtext models\n+    ```bash\n+    pip install sentencepiece\n+    ```\n+\n Now you are ready to [package and serve models with TorchServe](#serve-a-model).\n \n ### Install TorchServe for development\n \n If you plan to develop with TorchServe and change some of the source code, you must install it from source code.\n \n-1. Install dependencies\n+Please deactivate any conda env that you might be within.\n+Run the following script from the top of the source directory.\n \n-    ```bash\n-    pip install psutil future -y\n-    ```\n-\n-1. Clone the repo\n-\n-    ```bash\n-    git clone https://github.com/pytorch/serve\n-    cd serve\n-    ```\n-\n-1. Make your changes executable\n+NOTE: This script uninstalls existing `torchserve` and `torch-model-archiver` installations\n \n-    ```bash\n-    pip install -e .\n-    ```\n+#### For Debian Based Systems\n+Verified on EC2 instances running Ubuntu DL AMI 28.x\n \n-* To develop with torch-model-archiver:\n+```\n+./scripts/install_from_src_linux", "originalCommit": "9e083890ffe67dfd76769fd760a29d3fc291e40a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjc3NjA3MQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422776071", "bodyText": "fixed in a subsequent commit", "author": "mycpuorg", "createdAt": "2020-05-11T04:38:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYwODk2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYwOTU2OA==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422609568", "bodyText": "@mycpuorg Why do we still need this extra step for uninstall for updgrade? The new scripts should take care of this automatically", "author": "chauhang", "createdAt": "2020-05-10T08:28:56Z", "path": "README.md", "diffHunk": "@@ -77,36 +89,32 @@ pip install torchserve torch-model-archiver\n     source activate torchserve\n     ```\n \n+2. Optional if using torchtext models\n+    ```bash\n+    pip install sentencepiece\n+    ```\n+\n Now you are ready to [package and serve models with TorchServe](#serve-a-model).\n \n ### Install TorchServe for development\n \n If you plan to develop with TorchServe and change some of the source code, you must install it from source code.\n \n-1. Install dependencies\n+Please deactivate any conda env that you might be within.\n+Run the following script from the top of the source directory.\n \n-    ```bash\n-    pip install psutil future -y\n-    ```\n-\n-1. Clone the repo\n-\n-    ```bash\n-    git clone https://github.com/pytorch/serve\n-    cd serve\n-    ```\n-\n-1. Make your changes executable\n+NOTE: This script uninstalls existing `torchserve` and `torch-model-archiver` installations\n \n-    ```bash\n-    pip install -e .\n-    ```\n+#### For Debian Based Systems\n+Verified on EC2 instances running Ubuntu DL AMI 28.x\n \n-* To develop with torch-model-archiver:\n+```\n+./scripts/install_from_src_linux\n+```\n+#### For MAC OS\n \n-```bash\n-cd serve/model-archiver\n-pip install -e .\n+```\n+./scripts/install_from_src_macos\n ```\n \n * To upgrade TorchServe or model archiver from source code and make changes executable, run:", "originalCommit": "9e083890ffe67dfd76769fd760a29d3fc291e40a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjc1MTc3NQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422751775", "bodyText": "We should not need the extra steps for upgrade, let's remove this.", "author": "mycpuorg", "createdAt": "2020-05-11T02:49:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYwOTU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjc3NjE0NQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r422776145", "bodyText": "removed in a later commit", "author": "mycpuorg", "createdAt": "2020-05-11T04:38:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjYwOTU2OA=="}], "type": "inlineReview"}, {"oid": "09f9163648a71b09127dda97bcc861a53df7ea5d", "url": "https://github.com/pytorch/serve/commit/09f9163648a71b09127dda97bcc861a53df7ea5d", "message": "explicitly build the source code with gradle prior to install", "committedDate": "2020-05-11T04:30:29Z", "type": "commit"}, {"oid": "d6bc33030826c3753e77a823e442399523494e15", "url": "https://github.com/pytorch/serve/commit/d6bc33030826c3753e77a823e442399523494e15", "message": "remove upgrade instructions in favor of clean reinstall from source", "committedDate": "2020-05-11T04:32:34Z", "type": "commit"}, {"oid": "74c6825b770d01909d9b1c5d0275c4a37774efea", "url": "https://github.com/pytorch/serve/commit/74c6825b770d01909d9b1c5d0275c4a37774efea", "message": "Merge branch 'staging_0_1_1' into issue_312_install_from_src", "committedDate": "2020-05-11T04:34:17Z", "type": "commit"}, {"oid": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "url": "https://github.com/pytorch/serve/commit/421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "message": "update instructions to contain the correct script name", "committedDate": "2020-05-11T04:37:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA3NjUxOQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423076519", "bodyText": "Can't we get rid of this line for basic user installation? People don't need any of these, especially sentencepiece... they can download that later as part of the example's setup steps.\nIn my recent tests, I can get the needed deps just by doing pip install torchserve torch-model-archiver.", "author": "aaronmarkham", "createdAt": "2020-05-11T14:22:58Z", "path": "README.md", "diffHunk": "@@ -18,14 +18,21 @@ Conda instructions are provided in more detail, but you may also use `pip` and `\n \n ### Install with pip\n \n-To use `pip` to install TorchServe and the model archiver:\n+1. Install Java 11\n \n-``` bash\n-pip install torch torchtext torchvision sentencepiece psutil future\n-pip install torchserve torch-model-archiver\n-```\n+    ```bash\n+    sudo apt-get install openjdk-11-jdk\n+    ```\n+\n+1. Use `pip` to install TorchServe and the model archiver:\n+\n+    ``` bash\n+    pip install torch torchtext torchvision sentencepiece psutil future", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA3ODg3Mw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423078873", "bodyText": "I'd remove this and add instructions to the torchtext models folder.\nThere are many issues with this and it confuses the flow for basic setup.\nFor example, this doesn't work on mac w/ py3.8 - so does that get mentioned here? No, it's too specific.", "author": "aaronmarkham", "createdAt": "2020-05-11T14:26:10Z", "path": "README.md", "diffHunk": "@@ -55,6 +62,11 @@ pip install torchserve torch-model-archiver\n     source activate torchserve\n     ```\n \n+2. Optional if using torchtext models\n+    ```bash\n+    pip install sentencepiece", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA3OTI3MA==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423079270", "bodyText": "Like mentioned earlier, I'd move to a torchtext page.", "author": "aaronmarkham", "createdAt": "2020-05-11T14:26:42Z", "path": "README.md", "diffHunk": "@@ -77,43 +89,32 @@ pip install torchserve torch-model-archiver\n     source activate torchserve\n     ```\n \n+2. Optional if using torchtext models", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA4MDY5Nw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423080697", "bodyText": "I saw ncs come in here sort of randomly and w/o explanation in recent runs. What is it for? As we've somewhat described each element already, it's weird to have this setting go unmentioned.", "author": "aaronmarkham", "createdAt": "2020-05-11T14:28:42Z", "path": "README.md", "diffHunk": "@@ -162,7 +162,7 @@ For more information about the model archiver, see [Torch Model archiver for Tor\n After you archive and store the model, use the `torchserve` command to serve the model.\n \n ```bash\n-torchserve --start --model-store ./model_store --models ./model_store/densenet161.mar\n+torchserve --start --ncs --model-store model_store --models densenet161.mar", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA4NTkwOA==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423085908", "bodyText": "I don't think this is true. I tested it on 3.6, 3.7, 2.7... vanilla installs and upgrading the existing conda envs on DLAMI. Sounds like testing is needed again, but anyways... don't think this is accurate and shouldn't be the case anyway...", "author": "aaronmarkham", "createdAt": "2020-05-11T14:35:40Z", "path": "README.md", "diffHunk": "@@ -18,14 +18,21 @@ Conda instructions are provided in more detail, but you may also use `pip` and `\n \n ### Install with pip\n \n-To use `pip` to install TorchServe and the model archiver:\n+1. Install Java 11\n \n-``` bash\n-pip install torch torchtext torchvision sentencepiece psutil future\n-pip install torchserve torch-model-archiver\n-```\n+    ```bash\n+    sudo apt-get install openjdk-11-jdk\n+    ```\n+\n+1. Use `pip` to install TorchServe and the model archiver:\n+\n+    ``` bash\n+    pip install torch torchtext torchvision sentencepiece psutil future\n+    pip install torchserve torch-model-archiver\n+    ```\n \n ### Install with Conda\n+**Note:** For Conda, Python 3.8 is required to run Torchserve", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE0NTM5Nw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423145397", "bodyText": "Even if we have been testing for many versions and different combinations, it is in our favor to explicitly call out one version number for each package that we are confident having tested with, and against which we are testing while running our UTs, CI/CD, Integration tests etc.", "author": "lokeshgupta1975", "createdAt": "2020-05-11T15:58:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA4NTkwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE0NTg2Mw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423145863", "bodyText": "Such a scoping is useful for our users so that they are using a consistent environment, which has already been tested.", "author": "lokeshgupta1975", "createdAt": "2020-05-11T15:59:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA4NTkwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzNjc0Nw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423436747", "bodyText": "Remove cd .. as we are running the script from serve home directory.", "author": "harshbafna", "createdAt": "2020-05-12T03:12:56Z", "path": "scripts/install_from_src_macos", "diffHunk": "@@ -0,0 +1,47 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"\n+\techo \"                      If you don't want to proceed kill this script in the next 10 seconds!\"\n+\techo \"                      ==============================================\"\n+\n+\tsleep 10\n+\n+\techo \"Cleaning up state\"\n+\t# uninstall any global installations\n+\tpip uninstall --yes torchserve\n+\tpip uninstall --yes torch-model-archiver\n+\tsleep 5\n+}\n+\n+install_java_deps()\n+{\n+\tbrew tap AdoptOpenJDK/openjdk\n+\tbrew cask install adoptopenjdk11\n+}\n+\n+install_torch_deps()\n+{\n+\t# replace this with requirements.txt when ready\n+\tpip install torch torchtext torchvision sentencepiece psutil future\n+}\n+\n+build_install_server()\n+{\n+\tcd ../ && pip install .", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzNjc5NA==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423436794", "bodyText": "Remove cd .. as we are running the script from serve home directory.", "author": "harshbafna", "createdAt": "2020-05-12T03:13:08Z", "path": "scripts/install_from_src_macos", "diffHunk": "@@ -0,0 +1,47 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"\n+\techo \"                      If you don't want to proceed kill this script in the next 10 seconds!\"\n+\techo \"                      ==============================================\"\n+\n+\tsleep 10\n+\n+\techo \"Cleaning up state\"\n+\t# uninstall any global installations\n+\tpip uninstall --yes torchserve\n+\tpip uninstall --yes torch-model-archiver\n+\tsleep 5\n+}\n+\n+install_java_deps()\n+{\n+\tbrew tap AdoptOpenJDK/openjdk\n+\tbrew cask install adoptopenjdk11\n+}\n+\n+install_torch_deps()\n+{\n+\t# replace this with requirements.txt when ready\n+\tpip install torch torchtext torchvision sentencepiece psutil future\n+}\n+\n+build_install_server()\n+{\n+\tcd ../ && pip install .\n+}\n+\n+build_install_archiver()\n+{\n+\tcd ../model-archiver && pip install .", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgzNzgyOQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423837829", "bodyText": "Stale comment", "author": "mycpuorg", "createdAt": "2020-05-12T15:43:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzNjc5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzODg2OQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423438869", "bodyText": "We don't want to support install from source on conda environment?\nAs per manual testing the installation works fine on conda environment as well.\nThe script should support installation on pip/pyenv and conda environments.", "author": "harshbafna", "createdAt": "2020-05-12T03:21:42Z", "path": "scripts/install_from_src_macos", "diffHunk": "@@ -0,0 +1,47 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzOTUyNg==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423439526", "bodyText": "psutil/future preinstallation is only required in conda environments", "author": "harshbafna", "createdAt": "2020-05-12T03:24:36Z", "path": "scripts/install_from_src_macos", "diffHunk": "@@ -0,0 +1,47 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"\n+\techo \"                      If you don't want to proceed kill this script in the next 10 seconds!\"\n+\techo \"                      ==============================================\"\n+\n+\tsleep 10\n+\n+\techo \"Cleaning up state\"\n+\t# uninstall any global installations\n+\tpip uninstall --yes torchserve\n+\tpip uninstall --yes torch-model-archiver\n+\tsleep 5\n+}\n+\n+install_java_deps()\n+{\n+\tbrew tap AdoptOpenJDK/openjdk\n+\tbrew cask install adoptopenjdk11\n+}\n+\n+install_torch_deps()\n+{\n+\t# replace this with requirements.txt when ready\n+\tpip install torch torchtext torchvision sentencepiece psutil future", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgzNDczNg==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423834736", "bodyText": "@harshbafna I disagree with the approach you are taking here. This is exactly why I want  requirements.txt to be solid. Can you look into my comment on #228 ? If you can resolve that all the deps will automatically be resolved until then I will err on the side of caution and prevent any build and installation failures due to missing deps.", "author": "mycpuorg", "createdAt": "2020-05-12T15:39:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzOTUyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzOTY4Mw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423439683", "bodyText": "psutil/future preinstallation is only required in conda environments", "author": "harshbafna", "createdAt": "2020-05-12T03:25:13Z", "path": "scripts/install_from_src_ubuntu", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"\n+\techo \"                      If you don't want to proceed kill this script in the next 10 seconds!\"\n+\techo \"                      ==============================================\"\n+\n+\tsleep 10\n+\n+\techo \"Cleaning up state\"\n+\t# uninstall any global installations\n+\tpip uninstall --yes torchserve || true\n+\tpip uninstall --yes torch-model-archiver || true\n+\tsleep 5\n+}\n+\n+install_java_deps()\n+{\n+\tsudo apt-get install -y openjdk-11-jdk\n+}\n+\n+install_torch_deps()\n+{\n+\t# replace this with requirements.txt when ready\n+\tpip install torch torchtext torchvision sentencepiece psutil future", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ0MDIwMw==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423440203", "bodyText": "Refer to comment in install_from_source_mac.\nAlso in EC2 environment DL AMI is the most preferred environment which comes in with conda for package/environment management.", "author": "harshbafna", "createdAt": "2020-05-12T03:27:28Z", "path": "scripts/install_from_src_ubuntu", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ0MTcxMA==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423441710", "bodyText": "This will run the build process twice.", "author": "harshbafna", "createdAt": "2020-05-12T03:33:59Z", "path": "scripts/install_from_src_ubuntu", "diffHunk": "@@ -0,0 +1,48 @@\n+#!/bin/bash\n+set -euo pipefail\n+\n+clean_slate()\n+{\n+\techo \"                      ==============================================\"\n+\techo \"                      If you are within a conda env please deactivate it and come back\"\n+\techo \"                      If you don't want to proceed kill this script in the next 10 seconds!\"\n+\techo \"                      ==============================================\"\n+\n+\tsleep 10\n+\n+\techo \"Cleaning up state\"\n+\t# uninstall any global installations\n+\tpip uninstall --yes torchserve || true\n+\tpip uninstall --yes torch-model-archiver || true\n+\tsleep 5\n+}\n+\n+install_java_deps()\n+{\n+\tsudo apt-get install -y openjdk-11-jdk\n+}\n+\n+install_torch_deps()\n+{\n+\t# replace this with requirements.txt when ready\n+\tpip install torch torchtext torchvision sentencepiece psutil future\n+}\n+\n+build_install_server()\n+{\n+\tpython setup.py build\n+\tpip install .", "originalCommit": "421f2ab20ceb9f18fdc4091d9a1b9d8dc5700ca7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ0MTg3Ng==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423441876", "bodyText": "pip install . already dumps complete logs on console if the build fails.", "author": "harshbafna", "createdAt": "2020-05-12T03:34:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ0MTcxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgzNjA0OQ==", "url": "https://github.com/pytorch/serve/pull/322#discussion_r423836049", "bodyText": "This was proposed by Vamshi from his prior background. Can you please check with him? Until then I will err on the side of caution (we can always remove if we're convinced that it's redundant)", "author": "mycpuorg", "createdAt": "2020-05-12T15:41:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ0MTcxMA=="}], "type": "inlineReview"}, {"oid": "5be6d6dc011d925fcb87f031b938d040af14e80a", "url": "https://github.com/pytorch/serve/commit/5be6d6dc011d925fcb87f031b938d040af14e80a", "message": "Merge branch 'staging_0_1_1' into issue_312_install_from_src", "committedDate": "2020-05-12T15:54:07Z", "type": "commit"}]}