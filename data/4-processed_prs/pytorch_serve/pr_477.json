{"pr_number": 477, "pr_title": "Issue#466", "pr_createdAt": "2020-06-23T20:14:37Z", "pr_url": "https://github.com/pytorch/serve/pull/477", "timeline": [{"oid": "1cdc16cd2163ab9c994739981a620ae073181d26", "url": "https://github.com/pytorch/serve/commit/1cdc16cd2163ab9c994739981a620ae073181d26", "message": " Add manual seed and finetune setting", "committedDate": "2020-06-23T20:03:58Z", "type": "commit"}, {"oid": "b3b71f4e82d3ec9a751b77de9bcb641a71c2e86d", "url": "https://github.com/pytorch/serve/commit/b3b71f4e82d3ec9a751b77de9bcb641a71c2e86d", "message": "add finetune settiing", "committedDate": "2020-06-23T20:05:08Z", "type": "commit"}, {"oid": "d136deecffc719be20e2e360e0304b78eea7257c", "url": "https://github.com/pytorch/serve/commit/d136deecffc719be20e2e360e0304b78eea7257c", "message": "Add manual setting and fine tune option", "committedDate": "2020-06-23T20:05:42Z", "type": "commit"}, {"oid": "ae6c28d8d90ea11ab6908657a2285fd04a494f9a", "url": "https://github.com/pytorch/serve/commit/ae6c28d8d90ea11ab6908657a2285fd04a494f9a", "message": "Add finetune setting", "committedDate": "2020-06-23T20:06:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ4ODU4NQ==", "url": "https://github.com/pytorch/serve/pull/477#discussion_r444488585", "bodyText": "What is the purpose of setting the seed? We are not training the model here, only downloading a trained model, so not clear why this is needed", "author": "chauhang", "createdAt": "2020-06-23T20:30:44Z", "path": "examples/Huggingface_Transformers/Download_Transformer_models.py", "diffHunk": "@@ -5,25 +5,26 @@\n import torch\n from transformers import (AutoModelForSequenceClassification, AutoTokenizer, AutoModelForQuestionAnswering,\n  AutoModelForTokenClassification, AutoConfig)\n+from transformers import set_seed\n \"\"\" This function, save the checkpoint, config file along with tokenizer config and vocab files\n     of a transformer model of your choice.\n \"\"\"\n print('Transformers version',transformers.__version__)\n-\n-def transformers_model_dowloader(mode,pretrained_model_name,num_labels,do_lower_case,max_length,torchscript):\n+set_seed(1)", "originalCommit": "ae6c28d8d90ea11ab6908657a2285fd04a494f9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU1MDAwNg==", "url": "https://github.com/pytorch/serve/pull/477#discussion_r444550006", "bodyText": "Thanks Geeta, without setting the seed in the Download script, it does not show consistent behavior/ reproducible results  between eager mode and torchscript, when we are not using fine-tuned models. I believe this can be result of using torch.jit.trace as it may introduce some randomness.", "author": "HamidShojanazeri", "createdAt": "2020-06-23T22:48:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ4ODU4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ4OTYxMw==", "url": "https://github.com/pytorch/serve/pull/477#discussion_r444489613", "bodyText": "Why is this needed for model predictions?", "author": "chauhang", "createdAt": "2020-06-23T20:32:43Z", "path": "examples/Huggingface_Transformers/Transformer_handler_generalized.py", "diffHunk": "@@ -5,11 +5,11 @@\n import ast\n import torch\n from transformers import AutoModelForSequenceClassification, AutoTokenizer, AutoModelForQuestionAnswering,AutoModelForTokenClassification\n-\n+from transformers import set_seed\n from ts.torch_handler.base_handler import BaseHandler\n \n logger = logging.getLogger(__name__)\n-\n+set_seed(1)", "originalCommit": "ae6c28d8d90ea11ab6908657a2285fd04a494f9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU1MDA4NQ==", "url": "https://github.com/pytorch/serve/pull/477#discussion_r444550085", "bodyText": "it's been removed.", "author": "HamidShojanazeri", "createdAt": "2020-06-23T22:48:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ4OTYxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxNTkzNg==", "url": "https://github.com/pytorch/serve/pull/477#discussion_r444515936", "bodyText": "There is already a model_name field. Can that not be used for fine tuned models name/path for the finetuned models as well? Please explain why we need a second field.", "author": "chauhang", "createdAt": "2020-06-23T21:21:44Z", "path": "examples/Huggingface_Transformers/README.md", "diffHunk": "@@ -58,6 +58,8 @@ In the setup_config.json :\n \n *model_name* : bert-base-uncased , roberta-base or other available pre-trained models.\n \n+*fine_tuned* : name or path to the finetuned model if available, for example \"distilbert-base-cased-distilled-squad\", leave it blank if not available.", "originalCommit": "ae6c28d8d90ea11ab6908657a2285fd04a494f9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU1MTAwOA==", "url": "https://github.com/pytorch/serve/pull/477#discussion_r444551008", "bodyText": "In the current setting , when we do not pass the vocab.txt as the artifacts, tokenizer uses the pretrained version as being passed by Model_name. In that case fine_tuned version can not be used for the tokenizer.", "author": "HamidShojanazeri", "createdAt": "2020-06-23T22:51:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxNTkzNg=="}], "type": "inlineReview"}, {"oid": "f94aad1fb284596479f788457697e8ba7e6065a6", "url": "https://github.com/pytorch/serve/commit/f94aad1fb284596479f788457697e8ba7e6065a6", "message": "Remove the seed setting", "committedDate": "2020-06-23T22:09:32Z", "type": "commit"}, {"oid": "95159f455ffdab47f40f9665d61c8688d51207e0", "url": "https://github.com/pytorch/serve/commit/95159f455ffdab47f40f9665d61c8688d51207e0", "message": " Remove fine_tuned field and added mapping to device to input of trace model", "committedDate": "2020-06-25T15:55:58Z", "type": "commit"}, {"oid": "70492f5c850308b8f6e9f578d10862c84d90e501", "url": "https://github.com/pytorch/serve/commit/70492f5c850308b8f6e9f578d10862c84d90e501", "message": "Add calrification on passing required files for passing customized vocab and removing fine_tuned field", "committedDate": "2020-06-25T16:05:54Z", "type": "commit"}, {"oid": "a743145ac08026a6bcacd829b2bbe1eeefced8f3", "url": "https://github.com/pytorch/serve/commit/a743145ac08026a6bcacd829b2bbe1eeefced8f3", "message": "Add check for availabilty of vocab files txt or json", "committedDate": "2020-06-25T16:09:29Z", "type": "commit"}, {"oid": "ab403224e8d233a00e601f93447bef0415ce7333", "url": "https://github.com/pytorch/serve/commit/ab403224e8d233a00e601f93447bef0415ce7333", "message": "remove finetuned filed", "committedDate": "2020-06-25T18:15:48Z", "type": "commit"}, {"oid": "46d095be7fcdc21685f4cc660006f850368d7b32", "url": "https://github.com/pytorch/serve/commit/46d095be7fcdc21685f4cc660006f850368d7b32", "message": "clean up", "committedDate": "2020-06-25T19:16:14Z", "type": "commit"}, {"oid": "bc1ef3e6bc7cf15d18098ce7bd91ca85715bf82b", "url": "https://github.com/pytorch/serve/commit/bc1ef3e6bc7cf15d18098ce7bd91ca85715bf82b", "message": "Merge branch 'master' into issue#466", "committedDate": "2020-06-26T00:37:01Z", "type": "commit"}]}