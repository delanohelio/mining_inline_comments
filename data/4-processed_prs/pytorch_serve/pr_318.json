{"pr_number": 318, "pr_title": "Removed duplicate snapshot server property", "pr_createdAt": "2020-05-08T16:35:11Z", "pr_url": "https://github.com/pytorch/serve/pull/318", "timeline": [{"oid": "87c003498b397d4d48f96e7c1b74f1d9a373d01a", "url": "https://github.com/pytorch/serve/commit/87c003498b397d4d48f96e7c1b74f1d9a373d01a", "message": "Refactored code , updated docs", "committedDate": "2020-05-08T15:27:00Z", "type": "commit"}, {"oid": "4cea48401dd42420048cbd46e7a6fb7f8a39d241", "url": "https://github.com/pytorch/serve/commit/4cea48401dd42420048cbd46e7a6fb7f8a39d241", "message": "fixed formatting", "committedDate": "2020-05-08T15:51:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NTcxMw==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r422285713", "bodyText": "Why is this change required? This seems to be a breaking change and without any functionality change.", "author": "vdantu", "createdAt": "2020-05-08T17:58:36Z", "path": "frontend/server/src/main/java/org/pytorch/serve/util/ConfigManager.java", "diffHunk": "@@ -53,7 +53,8 @@\n     private static final String TS_MANAGEMENT_ADDRESS = \"management_address\";\n     private static final String TS_LOAD_MODELS = \"load_models\";\n     private static final String TS_BLACKLIST_ENV_VARS = \"blacklist_env_vars\";\n-    private static final String TS_DEFAULT_WORKERS_PER_MODEL = \"default_workers_per_model\";\n+    private static final String TS_DEFAULT_WORKERS_PER_INIT_MODEL =", "originalCommit": "4cea48401dd42420048cbd46e7a6fb7f8a39d241", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjU4NQ==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r422286585", "bodyText": "Why are we modifying the original configuration? Can't we simply change the snapshot to follow what exists in main configuration?", "author": "vdantu", "createdAt": "2020-05-08T18:00:12Z", "path": "docs/configuration.md", "diffHunk": "@@ -183,7 +183,7 @@ Most of the following properties are designed for performance tuning. Adjusting\n * `enable_envvars_config`: Enable configuring TorchServe through environment variables. When this option is set to \"true\", all the static configurations of TorchServe can come through environment variables as well. Default: false\n * `number_of_netty_threads`: number frontend netty thread. Default: number of logical processors available to the JVM.\n * `netty_client_threads`: number of backend netty thread. Default: number of logical processors available to the JVM.\n-* `default_workers_per_model`: number of workers to create for each model that loaded at startup time. Default: available GPUs in system or number of logical processors available to the JVM.\n+* `default_workers_per_init_model`: number of workers to create for each model that loaded at startup time. Default: available GPUs in system or number of logical processors available to the JVM.", "originalCommit": "4cea48401dd42420048cbd46e7a6fb7f8a39d241", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI5MjAzOA==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r422292038", "bodyText": "@vdantu : The actual configuration parameter documented is default_workers_per_model. However, the config manager internally uses both default_workers_per_model and NUM_WORKERS. Further, the snapshots generated is a combination of config properties and state of all registered models. The config manager dumps NUM_WORKERS param in the snapshot instead of default_workers_per_model.\nThus it makes sense to use only the documented parameter.\nWe are also renaming the config parameter as it is only applicable for the models which are loaded/initialized at the time of starting torchserve. For all other models registered through API, the user needs to provide the number of workers.", "author": "harshbafna", "createdAt": "2020-05-08T18:11:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjU4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjMyODkzOA==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r422328938", "bodyText": "I was thinking from customers view point. If a customer was using previously released version of TorchServe and they are moving to newer version of TorchServe, would changing this option break their experience or not? Variables used internally can be modified while maintaining backwards compatibility would be my thought here. Changing the customer experience here seems odd. Can't we keep this variable as it is and change the NUM_WORKERS to current_num_workers or to some other better name? Also, init in default_workers_per_init_model seems redundant. I am open for other views here, but it seems like we are changing UX for something that can be fully kept internal to codebase. Correct me if I am wrong.", "author": "vdantu", "createdAt": "2020-05-08T19:26:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjU4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjMzOTIzMg==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r422339232", "bodyText": "The only idea to introduce the init keyword here is to indicate that it applies to the startup/initialization models and not to every model.\nJust default_workers_per_model sounds like it will apply to every model if no worker is provided.\nI agree this will impact the UX where the parameter is already being used in config.properties.", "author": "harshbafna", "createdAt": "2020-05-08T19:48:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjU4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NzUwMg==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r422287502", "bodyText": "Can we just call this default_workers_per_model?", "author": "vdantu", "createdAt": "2020-05-08T18:02:11Z", "path": "frontend/server/src/test/resources/snapshots/snapshot4.cfg", "diffHunk": "@@ -6,7 +6,7 @@ enable_envvars_config=true\n load_models=noop.mar\n private_key_file=src/test/resources/key.pem\n snapshot_store=FS\n-NUM_WORKERS=4\n+default_workers_per_init_model=4", "originalCommit": "4cea48401dd42420048cbd46e7a6fb7f8a39d241", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NjMwNg==", "url": "https://github.com/pytorch/serve/pull/318#discussion_r432256306", "bodyText": "done", "author": "shivamshriwas", "createdAt": "2020-05-29T05:00:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NzUwMg=="}], "type": "inlineReview"}, {"oid": "7bcad04d98bac0bc64a82be5c48fb678f77eae2c", "url": "https://github.com/pytorch/serve/commit/7bcad04d98bac0bc64a82be5c48fb678f77eae2c", "message": "Merge branch 'staging_0_1_1' into issue_154", "committedDate": "2020-05-16T00:57:30Z", "type": "commit"}, {"oid": "7032fb30f4dc67243591e1c4bfb56fb53ebb6182", "url": "https://github.com/pytorch/serve/commit/7032fb30f4dc67243591e1c4bfb56fb53ebb6182", "message": "merged branch staging_0_1_1", "committedDate": "2020-05-19T19:35:43Z", "type": "commit"}, {"oid": "24b23b0e450845fa3ef6d9fa0d48556b0a80d4d3", "url": "https://github.com/pytorch/serve/commit/24b23b0e450845fa3ef6d9fa0d48556b0a80d4d3", "message": "reverted back default_workers_per_init_model to default_workers_per_model", "committedDate": "2020-05-19T19:50:09Z", "type": "commit"}, {"oid": "c542df2fad67e7027114bd1619c9dbd0c0f31390", "url": "https://github.com/pytorch/serve/commit/c542df2fad67e7027114bd1619c9dbd0c0f31390", "message": "Merge branch 'staging_0_1_1' into issue_154", "committedDate": "2020-05-20T19:35:43Z", "type": "commit"}, {"oid": "68c523c15c299f1ee957f1b139a6c22fcbdede1c", "url": "https://github.com/pytorch/serve/commit/68c523c15c299f1ee957f1b139a6c22fcbdede1c", "message": "Merge branch 'staging_0_1_1' into issue_154", "committedDate": "2020-05-27T04:41:03Z", "type": "commit"}, {"oid": "117fb158aff92488c0019cf17c9f1dd8716e8dd1", "url": "https://github.com/pytorch/serve/commit/117fb158aff92488c0019cf17c9f1dd8716e8dd1", "message": "Merge branch 'staging_0_1_1' into issue_154", "committedDate": "2020-05-29T06:29:09Z", "type": "commit"}, {"oid": "41adc52b21a3787e209cc744696527c1c99e0553", "url": "https://github.com/pytorch/serve/commit/41adc52b21a3787e209cc744696527c1c99e0553", "message": "Merge branch 'staging_0_1_1' into issue_154", "committedDate": "2020-06-10T03:04:29Z", "type": "commit"}, {"oid": "c5990ddaf432efe4bba5feb64000571790a782bb", "url": "https://github.com/pytorch/serve/commit/c5990ddaf432efe4bba5feb64000571790a782bb", "message": "Merge branch 'master' of https://github.com/pytorch/serve into issue_154\n\n# Conflicts:\n#\tdocker/README.md\n#\ttest/README.md\n#\ttest/regression_tests.sh", "committedDate": "2020-06-21T20:44:07Z", "type": "commit"}, {"oid": "d227ea27f5742df7e6f014f1263ce158eca940db", "url": "https://github.com/pytorch/serve/commit/d227ea27f5742df7e6f014f1263ce158eca940db", "message": "Merge branch 'master' into issue_154", "committedDate": "2020-07-02T11:33:14Z", "type": "commit"}, {"oid": "0d202b103ebc5c69ec4ab85e5d06b850d3e6c127", "url": "https://github.com/pytorch/serve/commit/0d202b103ebc5c69ec4ab85e5d06b850d3e6c127", "message": "Merge branch 'master' into issue_154", "committedDate": "2020-07-06T19:15:33Z", "type": "commit"}]}