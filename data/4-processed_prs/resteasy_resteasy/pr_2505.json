{"pr_number": 2505, "pr_title": "[RESTEASY-2686] Prepare TS profile for bootable jar testing", "pr_createdAt": "2020-09-04T12:09:33Z", "pr_url": "https://github.com/resteasy/resteasy/pull/2505", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDc3Mw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r483940773", "bodyText": "2.0.0.Beta4 was released yesterday.", "author": "fabiobrz", "createdAt": "2020-09-05T11:16:22Z", "path": "pom.xml", "diffHunk": "@@ -30,6 +30,7 @@\n         <surefire.system.args>-Xms512m -Xmx512m ${modular.jdk.args}</surefire.system.args>\r\n         <!-- Plugins versions -->\r\n         <version.org.jacoco.plugin>0.7.9</version.org.jacoco.plugin>\r\n+        <version.org.wildfly.jar.plugin>2.0.0.Beta1</version.org.wildfly.jar.plugin>\r", "originalCommit": "a70b838dddee006080ada41bc8889f88c8561c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0MzQzMQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484243431", "bodyText": "Thanks, I will update it and start new CI run", "author": "marekkopecky", "createdAt": "2020-09-07T07:45:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDc3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY4ODc2OA==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484688768", "bodyText": "Updated to 2.0.0.Beta5 as we discussed on google chat ...", "author": "marekkopecky", "createdAt": "2020-09-08T06:51:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDc3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY5ODA5Mg==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484698092", "bodyText": "Marking this thread as resolved, let me know if you have some objections ...", "author": "marekkopecky", "createdAt": "2020-09-08T07:11:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDc3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDg2Mw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r483940863", "bodyText": "What is -Dserver.home used for when testing Bootable JAR?", "author": "fabiobrz", "createdAt": "2020-09-05T11:17:25Z", "path": "testsuite/README.MD", "diffHunk": "@@ -90,6 +90,12 @@ the usage of `standalone-microprofile.xml` configuration file:\n \n > mvn clean verify -Dserver.home=PATH_TO_WIDLFLY_HOME -Dts.standalone.microprofile\n \n+### Bootable jar testing\n+Run testsuite or test against Bootable jar, not against Wildfly:\n+\n+> mvn clean verify -Dts.bootable -Ddefault=false -Ddisable.microprofile.tests -Dserver.version=21.0.0.Beta1-SNAPSHOT -Dserver.home=placeholder ", "originalCommit": "a70b838dddee006080ada41bc8889f88c8561c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDIzNzEwMQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484237101", "bodyText": "This disable download profile, which is not necessary for bootable jar testing", "author": "marekkopecky", "createdAt": "2020-09-07T07:36:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMzODM2NA==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484338364", "bodyText": "Makes sense, thanks, although I'd change it to something like not-needed-for-bootable.jar, otherwise a user could not understand at first glance. WDYT?", "author": "fabiobrz", "createdAt": "2020-09-07T10:18:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5MTUxMg==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484391512", "bodyText": "Sure, updated", "author": "marekkopecky", "createdAt": "2020-09-07T12:07:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY5ODYyNw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484698627", "bodyText": "Marking this thread as resolved, let me know if you have some objections ...", "author": "marekkopecky", "createdAt": "2020-09-08T07:12:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDg2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDk2OQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r483940969", "bodyText": "When moving to wildfly-jar-maven-plugin:2.0.0.Beta4 this will have to be removed.", "author": "fabiobrz", "createdAt": "2020-09-05T11:18:48Z", "path": "testsuite/integration-tests/pom.xml", "diffHunk": "@@ -203,6 +203,152 @@\n                 <microprofile.excluded.groups>org.jboss.resteasy.category.ExpectedFailingWithStandaloneMicroprofileConfiguration,org.jboss.resteasy.category.ExpectedFailingBecauseOfSmallRyeMicroprofileOpenApi11</microprofile.excluded.groups>\n             </properties>\n         </profile>\n+\n+        <profile>\n+            <id>bootablejar.profile</id>\n+            <activation>\n+                <property>\n+                    <name>ts.bootable</name>\n+                </property>\n+            </activation>\n+            <build>\n+                <plugins>\n+                    <!-- Disable the standard copy-based provisioning -->\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-antrun-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <id>initialize-basedirs</id>\n+                                <phase>none</phase>\n+                                <goals>\n+                                    <goal>run</goal>\n+                                </goals>\n+                            </execution>\n+                        </executions>\n+                    </plugin>\n+                    <plugin>\n+                        <groupId>org.wildfly.plugins</groupId>\n+                        <artifactId>wildfly-jar-maven-plugin</artifactId>\n+                        <executions>\n+                            <!-- Package a datasources-web-server with observability decorator added -->\n+                            <execution>\n+                                <id>bootable-jar-observability-packaging</id>\n+                                <goals>\n+                                    <goal>package</goal>\n+                                </goals>\n+                                <phase>process-test-resources</phase>\n+                                <configuration>\n+                                    <output-file-name>jaxrs-server.jar</output-file-name>\n+                                    <hollowJar>true</hollowJar>\n+                                    <record-state>false</record-state>\n+                                    <log-time>true</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>true</jboss-fork-embedded>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>org.wildfly</groupId>\n+                                            <artifactId>wildfly-galleon-pack</artifactId>\n+                                            <version>${server.version}</version>\n+                                            <inherit-configs>false</inherit-configs>", "originalCommit": "a70b838dddee006080ada41bc8889f88c8561c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0NTQ2MQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484245461", "bodyText": "Updated, thanks!", "author": "marekkopecky", "createdAt": "2020-09-07T07:47:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY5ODE2OA==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484698168", "bodyText": "Marking this thread as resolved, let me know if you have some objections ...", "author": "marekkopecky", "createdAt": "2020-09-08T07:11:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDk2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDk4MQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r483940981", "bodyText": "When moving to wildfly-jar-maven-plugin:2.0.0.Beta4 this will have to be removed.", "author": "fabiobrz", "createdAt": "2020-09-05T11:18:56Z", "path": "testsuite/integration-tests/pom.xml", "diffHunk": "@@ -203,6 +203,152 @@\n                 <microprofile.excluded.groups>org.jboss.resteasy.category.ExpectedFailingWithStandaloneMicroprofileConfiguration,org.jboss.resteasy.category.ExpectedFailingBecauseOfSmallRyeMicroprofileOpenApi11</microprofile.excluded.groups>\n             </properties>\n         </profile>\n+\n+        <profile>\n+            <id>bootablejar.profile</id>\n+            <activation>\n+                <property>\n+                    <name>ts.bootable</name>\n+                </property>\n+            </activation>\n+            <build>\n+                <plugins>\n+                    <!-- Disable the standard copy-based provisioning -->\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-antrun-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <id>initialize-basedirs</id>\n+                                <phase>none</phase>\n+                                <goals>\n+                                    <goal>run</goal>\n+                                </goals>\n+                            </execution>\n+                        </executions>\n+                    </plugin>\n+                    <plugin>\n+                        <groupId>org.wildfly.plugins</groupId>\n+                        <artifactId>wildfly-jar-maven-plugin</artifactId>\n+                        <executions>\n+                            <!-- Package a datasources-web-server with observability decorator added -->\n+                            <execution>\n+                                <id>bootable-jar-observability-packaging</id>\n+                                <goals>\n+                                    <goal>package</goal>\n+                                </goals>\n+                                <phase>process-test-resources</phase>\n+                                <configuration>\n+                                    <output-file-name>jaxrs-server.jar</output-file-name>\n+                                    <hollowJar>true</hollowJar>\n+                                    <record-state>false</record-state>\n+                                    <log-time>true</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>true</jboss-fork-embedded>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>org.wildfly</groupId>\n+                                            <artifactId>wildfly-galleon-pack</artifactId>\n+                                            <version>${server.version}</version>\n+                                            <inherit-configs>false</inherit-configs>\n+                                            <inherit-packages>false</inherit-packages>", "originalCommit": "a70b838dddee006080ada41bc8889f88c8561c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0NTU1MQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484245551", "bodyText": "Updated, thanks!", "author": "marekkopecky", "createdAt": "2020-09-07T07:47:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDk4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY5ODUwNg==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484698506", "bodyText": "Marking this thread as resolved, let me know if you have some objections ...", "author": "marekkopecky", "createdAt": "2020-09-08T07:11:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MDk4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTE3OQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r483941179", "bodyText": "I see different configuration with respect to the observability layer which was mentioned in the comment above. Am I missing something?", "author": "fabiobrz", "createdAt": "2020-09-05T11:21:12Z", "path": "testsuite/integration-tests/pom.xml", "diffHunk": "@@ -203,6 +203,152 @@\n                 <microprofile.excluded.groups>org.jboss.resteasy.category.ExpectedFailingWithStandaloneMicroprofileConfiguration,org.jboss.resteasy.category.ExpectedFailingBecauseOfSmallRyeMicroprofileOpenApi11</microprofile.excluded.groups>\n             </properties>\n         </profile>\n+\n+        <profile>\n+            <id>bootablejar.profile</id>\n+            <activation>\n+                <property>\n+                    <name>ts.bootable</name>\n+                </property>\n+            </activation>\n+            <build>\n+                <plugins>\n+                    <!-- Disable the standard copy-based provisioning -->\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-antrun-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <id>initialize-basedirs</id>\n+                                <phase>none</phase>\n+                                <goals>\n+                                    <goal>run</goal>\n+                                </goals>\n+                            </execution>\n+                        </executions>\n+                    </plugin>\n+                    <plugin>\n+                        <groupId>org.wildfly.plugins</groupId>\n+                        <artifactId>wildfly-jar-maven-plugin</artifactId>\n+                        <executions>\n+                            <!-- Package a datasources-web-server with observability decorator added -->\n+                            <execution>\n+                                <id>bootable-jar-observability-packaging</id>\n+                                <goals>\n+                                    <goal>package</goal>\n+                                </goals>\n+                                <phase>process-test-resources</phase>\n+                                <configuration>\n+                                    <output-file-name>jaxrs-server.jar</output-file-name>\n+                                    <hollowJar>true</hollowJar>\n+                                    <record-state>false</record-state>\n+                                    <log-time>true</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>true</jboss-fork-embedded>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>org.wildfly</groupId>\n+                                            <artifactId>wildfly-galleon-pack</artifactId>\n+                                            <version>${server.version}</version>\n+                                            <inherit-configs>false</inherit-configs>\n+                                            <inherit-packages>false</inherit-packages>\n+                                        </feature-pack>\n+                                    </feature-packs>\n+                                    <layers>\n+                                        <layer>jaxrs-server</layer>", "originalCommit": "a70b838dddee006080ada41bc8889f88c8561c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0NjM0Ng==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484246346", "bodyText": "Hmm, which comment?", "author": "marekkopecky", "createdAt": "2020-09-07T07:48:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTE3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMzOTAzNw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484339037", "bodyText": "This one: https://github.com/resteasy/Resteasy/pull/2505/files#diff-8c7ea03eb619e46657b96e8fe8d4f09eR234\nI cannot see that the layers config is not just observability, or am I missing something?", "author": "fabiobrz", "createdAt": "2020-09-07T10:19:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTE3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM4MDk4Nw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484380987", "bodyText": "Ah, no, you don't miss anything. That comment above is just my copy-paste mistake. Fixing ...", "author": "marekkopecky", "createdAt": "2020-09-07T11:45:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTE3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY5ODI3Mg==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484698272", "bodyText": "Marking this thread as resolved, let me know if you have some objections ...", "author": "marekkopecky", "createdAt": "2020-09-08T07:11:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTE3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTM4Mw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r483941383", "bodyText": "is wildfly-arquillian-container-remote no longer used at all?", "author": "fabiobrz", "createdAt": "2020-09-05T11:24:00Z", "path": "resteasy-dependencies-bom/pom.xml", "diffHunk": "@@ -80,7 +80,7 @@\n         <version.org.wildfly.core.wildfly-cli>7.0.0.Final</version.org.wildfly.core.wildfly-cli>\n         <version.org.wildfly.extras.creaper>1.6.1</version.org.wildfly.extras.creaper>\n         <version.org.wildfly.wildfly-arquillian-container-managed>2.2.0.Final</version.org.wildfly.wildfly-arquillian-container-managed>\n-        <version.org.wildfly.wildfly-arquillian-container-remote>2.1.1.Final</version.org.wildfly.wildfly-arquillian-container-remote>", "originalCommit": "a70b838dddee006080ada41bc8889f88c8561c19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0MTU5OA==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484241598", "bodyText": "Yes, remote was intended to be removed in RESTEASY-2466, but this is some leftover", "author": "marekkopecky", "createdAt": "2020-09-07T07:43:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTM4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY5ODQwMQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484698401", "bodyText": "Marking this thread as resolved, let me know if you have some objections ...", "author": "marekkopecky", "createdAt": "2020-09-08T07:11:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0MTM4Mw=="}], "type": "inlineReview"}, {"oid": "b3f78a920011ba149eb1f45ba99093d3cc61ab35", "url": "https://github.com/resteasy/resteasy/commit/b3f78a920011ba149eb1f45ba99093d3cc61ab35", "message": "[RESTEASY-2686] Prepare TS profile for bootable jar testing", "committedDate": "2020-09-07T07:47:33Z", "type": "forcePushed"}, {"oid": "bb748241421b64050f905b5b8638881bae2239ea", "url": "https://github.com/resteasy/resteasy/commit/bb748241421b64050f905b5b8638881bae2239ea", "message": "[RESTEASY-2686] Prepare TS profile for bootable jar testing", "committedDate": "2020-09-07T11:47:07Z", "type": "forcePushed"}, {"oid": "eaf7365cc6ba4ab6775e295c08c0a3841146f129", "url": "https://github.com/resteasy/resteasy/commit/eaf7365cc6ba4ab6775e295c08c0a3841146f129", "message": "[RESTEASY-2686] Prepare TS profile for bootable jar testing", "committedDate": "2020-09-07T11:53:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNTgzNw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484505837", "bodyText": "These could be correct or not (I haven't checked), but are they really related to this PR / RESTEASY-2686?", "author": "asoldano", "createdAt": "2020-09-07T16:00:42Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/providers/sse/resource/SseBroadcastResource.java", "diffHunk": "@@ -15,18 +14,17 @@\n import javax.ws.rs.sse.SseEventSink;\n import java.io.IOException;\n \n-@Singleton\n @Path(\"/broadcast\")\n public class SseBroadcastResource {\n \n-   private final Object sseBroadcasterLock = new Object();\n-   private volatile SseBroadcaster sseBroadcaster;\n-   private volatile boolean onErrorCalled = false;\n-   private volatile boolean onCloseCalled = false;\n+   private static final Object sseBroadcasterLock = new Object();\n+   private static volatile SseBroadcaster sseBroadcaster;\n+   private static volatile boolean onErrorCalled = false;\n+   private static volatile boolean onCloseCalled = false;\n \n    private static final Logger logger = Logger.getLogger(SseBroadcastResource.class);\n \n-   SseEventSink subscribedSink = null;\n+   static SseEventSink subscribedSink = null;", "originalCommit": "eaf7365cc6ba4ab6775e295c08c0a3841146f129", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY3NzAwMw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484677003", "bodyText": "The point here is that there is no EJB galleon layer ready. But this test was originally using @singleton annotation, see https://github.com/resteasy/Resteasy/blob/3.12/testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/providers/sse/resource/SseBroadcastResource.java#L18\nSo basically we have a few choices here:\n\nignore this test now and unignore it once EJB layer is ready\nremove Singleton annotation and replace \"singleton\" variables by static variables\nuse ApplicationScope CDI bean instead of  (I don't test it, but it should probably works)\n\nI chose the second option, but I can also try some another, I don't have strong feelings here ...", "author": "marekkopecky", "createdAt": "2020-09-08T06:23:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNTgzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNTkxOQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484505919", "bodyText": "These could be correct or not (I haven't checked), but are they really related to this PR / RESTEASY-2686?", "author": "asoldano", "createdAt": "2020-09-07T16:01:01Z", "path": "testsuite/integration-tests/src/test/java/org/jboss/resteasy/test/providers/sse/resource/SseReconnectResource.java", "diffHunk": "@@ -18,15 +17,14 @@\n import javax.ws.rs.sse.SseEventSink;\n import java.util.concurrent.TimeUnit;\n \n-@Singleton\n @Path(\"/reconnect\")\n public class SseReconnectResource {\n \n-   private volatile boolean isServiceAvailable = false;\n+   private static volatile boolean isServiceAvailable = false;\n \n-   private volatile long startTime = 0L;\n-   private volatile long endTime = 0L;\n-   private volatile long lastEventDeliveryTime;\n+   private static volatile long startTime = 0L;\n+   private static volatile long endTime = 0L;\n+   private static volatile long lastEventDeliveryTime;", "originalCommit": "eaf7365cc6ba4ab6775e295c08c0a3841146f129", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY3NzI5Ng==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r484677296", "bodyText": "See my previous comment #2505 (comment)", "author": "marekkopecky", "createdAt": "2020-09-08T06:24:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNTkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE0NTgyNw==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r486145827", "bodyText": "OK, thanks for the explanation, makes sense (here and in the other discussion)", "author": "asoldano", "createdAt": "2020-09-10T08:06:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNTkxOQ=="}], "type": "inlineReview"}, {"oid": "b6073a833d3be1aaf98f93ec0bec4acb0c64ef13", "url": "https://github.com/resteasy/resteasy/commit/b6073a833d3be1aaf98f93ec0bec4acb0c64ef13", "message": "[RESTEASY-2686] Prepare TS profile for bootable jar testing", "committedDate": "2020-09-08T06:50:50Z", "type": "commit"}, {"oid": "b6073a833d3be1aaf98f93ec0bec4acb0c64ef13", "url": "https://github.com/resteasy/resteasy/commit/b6073a833d3be1aaf98f93ec0bec4acb0c64ef13", "message": "[RESTEASY-2686] Prepare TS profile for bootable jar testing", "committedDate": "2020-09-08T06:50:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxNjIxOQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r495016219", "bodyText": "@marekkopecky shouldnt this be parametrized as well, to be able to use other distros? E.g. EAP or EAP XP?", "author": "mchoma", "createdAt": "2020-09-25T14:12:20Z", "path": "testsuite/integration-tests/pom.xml", "diffHunk": "@@ -203,6 +203,150 @@\n                 <microprofile.excluded.groups>org.jboss.resteasy.category.ExpectedFailingWithStandaloneMicroprofileConfiguration,org.jboss.resteasy.category.ExpectedFailingBecauseOfSmallRyeMicroprofileOpenApi11</microprofile.excluded.groups>\n             </properties>\n         </profile>\n+\n+        <profile>\n+            <id>bootablejar.profile</id>\n+            <activation>\n+                <property>\n+                    <name>ts.bootable</name>\n+                </property>\n+            </activation>\n+            <build>\n+                <plugins>\n+                    <!-- Disable the standard copy-based provisioning -->\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-antrun-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <id>initialize-basedirs</id>\n+                                <phase>none</phase>\n+                                <goals>\n+                                    <goal>run</goal>\n+                                </goals>\n+                            </execution>\n+                        </executions>\n+                    </plugin>\n+                    <plugin>\n+                        <groupId>org.wildfly.plugins</groupId>\n+                        <artifactId>wildfly-jar-maven-plugin</artifactId>\n+                        <executions>\n+                            <!-- Package a jaxrs-server layer with a few other layers -->\n+                            <execution>\n+                                <id>bootable-jar-observability-packaging</id>\n+                                <goals>\n+                                    <goal>package</goal>\n+                                </goals>\n+                                <phase>process-test-resources</phase>\n+                                <configuration>\n+                                    <output-file-name>jaxrs-server.jar</output-file-name>\n+                                    <hollowJar>true</hollowJar>\n+                                    <record-state>false</record-state>\n+                                    <log-time>true</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>true</jboss-fork-embedded>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>org.wildfly</groupId>", "originalCommit": "b6073a833d3be1aaf98f93ec0bec4acb0c64ef13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ1NjA2NQ==", "url": "https://github.com/resteasy/resteasy/pull/2505#discussion_r496456065", "bodyText": "Good point, thanks for this. @fabiobrz Can you please incorporate this to #2526 ?", "author": "marekkopecky", "createdAt": "2020-09-29T06:50:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxNjIxOQ=="}], "type": "inlineReview"}]}