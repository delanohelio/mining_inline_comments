{"pr_number": 2320, "pr_title": "RESTEASY-2519", "pr_createdAt": "2020-03-11T13:25:26Z", "pr_url": "https://github.com/resteasy/resteasy/pull/2320", "timeline": [{"oid": "6d770a84a2ae884c9a4c732a5a31cf0c762f33b1", "url": "https://github.com/resteasy/resteasy/commit/6d770a84a2ae884c9a4c732a5a31cf0c762f33b1", "message": "RESTEASY-2519", "committedDate": "2020-03-11T13:24:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDYzNA==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r390974634", "bodyText": "Should the message be returned here or the original value?", "author": "gastaldi", "createdAt": "2020-03-11T13:37:34Z", "path": "resteasy-core/src/main/java/org/jboss/resteasy/core/StringParameterInjector.java", "diffHunk": "@@ -755,11 +758,19 @@ else if (valueOf != null)\n       }\r\n       catch (Exception e)\r\n       {\r\n-         throwProcessingException(Messages.MESSAGES.unableToExtractParameter(getParamSignature(), strVal, target), e);\r\n+         throwProcessingException(Messages.MESSAGES.unableToExtractParameter(getParamSignature(), _encode(strVal), target), e);\r\n       }\r\n       return null;\r\n    }\r\n \r\n+   private String _encode(String strVal) {\r\n+      try {\r\n+         return URLEncoder.encode(strVal, StandardCharsets.UTF_8.toString());\r\n+      } catch (UnsupportedEncodingException e) {\r\n+         return e.getMessage();\r", "originalCommit": "6d770a84a2ae884c9a4c732a5a31cf0c762f33b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NTA5MQ==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r390975091", "bodyText": "Perhaps it would be better to log.debug() this exception and return the original value", "author": "gastaldi", "createdAt": "2020-03-11T13:38:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAyNzY3Nw==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r391027677", "bodyText": "@gastaldi the original value is unescaped and still unsafe right?", "author": "liweinan", "createdAt": "2020-03-11T14:50:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAyODgwOQ==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r391028809", "bodyText": "adding a debug log is fine, let me add it in this PR. For return value, I'm not sure what to return for an exception, maybe assume this won't happen?", "author": "liweinan", "createdAt": "2020-03-11T14:52:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzNDI1NQ==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r391034255", "bodyText": "@gastaldi the original value is unescaped and still unsafe right?\n\nYes. I just mentioned that because e.getMessage() will return UTF-8", "author": "gastaldi", "createdAt": "2020-03-11T14:59:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDYzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzODc3MQ==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r391038771", "bodyText": "Perhaps in this case the best is to just rethrow the exception as a RuntimeException", "author": "gastaldi", "createdAt": "2020-03-11T15:05:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NDYzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzNzM1Mw==", "url": "https://github.com/resteasy/resteasy/pull/2320#discussion_r391037353", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     return URLEncoder.encode(strVal, StandardCharsets.UTF_8.toString());\n          \n          \n            \n                     return URLEncoder.encode(strVal, StandardCharsets.UTF_8.name());", "author": "gastaldi", "createdAt": "2020-03-11T15:03:15Z", "path": "resteasy-core/src/main/java/org/jboss/resteasy/core/StringParameterInjector.java", "diffHunk": "@@ -755,11 +758,19 @@ else if (valueOf != null)\n       }\r\n       catch (Exception e)\r\n       {\r\n-         throwProcessingException(Messages.MESSAGES.unableToExtractParameter(getParamSignature(), strVal, target), e);\r\n+         throwProcessingException(Messages.MESSAGES.unableToExtractParameter(getParamSignature(), _encode(strVal), target), e);\r\n       }\r\n       return null;\r\n    }\r\n \r\n+   private String _encode(String strVal) {\r\n+      try {\r\n+         return URLEncoder.encode(strVal, StandardCharsets.UTF_8.toString());\r", "originalCommit": "6d770a84a2ae884c9a4c732a5a31cf0c762f33b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "02d49663e0ce23e5b49937db198237bbaa55f7fa", "url": "https://github.com/resteasy/resteasy/commit/02d49663e0ce23e5b49937db198237bbaa55f7fa", "message": "update", "committedDate": "2020-03-12T04:13:17Z", "type": "commit"}]}