{"pr_number": 19430, "pr_title": "#18834 Avoid mess sort order when try to save multiple fields", "pr_createdAt": "2020-10-12T19:36:01Z", "pr_url": "https://github.com/dotCMS/core/pull/19430", "timeline": [{"oid": "3e7a8c97d1c252711516e1e55f4d0db92296d7ed", "url": "https://github.com/dotCMS/core/commit/3e7a8c97d1c252711516e1e55f4d0db92296d7ed", "message": "#18834 Avoid mess sort order when try to save multiple fields", "committedDate": "2020-10-12T19:34:53Z", "type": "commit"}, {"oid": "52e425c80e5e3fa926a7c6e1068f6ee37ea552a3", "url": "https://github.com/dotCMS/core/commit/52e425c80e5e3fa926a7c6e1068f6ee37ea552a3", "message": "#18834 Avoid mess sort order when try to save multiple fields", "committedDate": "2020-10-12T19:54:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI0OTIyMQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r504249221", "bodyText": "let's rephrase this", "author": "dsilvam", "createdAt": "2020-10-13T20:48:19Z", "path": "dotCMS/src/main/java/com/dotcms/contenttype/business/FieldAPI.java", "diffHunk": "@@ -128,7 +128,19 @@\n \t * @throws DotSecurityException The user does not have permissions to perform this action.\n \t */\n \tField save(Field field, User user) throws DotDataException, DotSecurityException;\n-\t\n+\n+\t/**\n+\t * Saves a new Field\n+\t *\n+\t * @param field\n+\t * @param user\n+\t * @param reorderIfNeed if it true then reorder all the fields,according to the field to save sort order", "originalCommit": "52e425c80e5e3fa926a7c6e1068f6ee37ea552a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c11e7aa5cae250a4a18364a709b5a52c4313f6d1", "url": "https://github.com/dotCMS/core/commit/c11e7aa5cae250a4a18364a709b5a52c4313f6d1", "message": "Update FieldAPI.java", "committedDate": "2020-10-13T22:35:12Z", "type": "commit"}, {"oid": "232bfc0b67405366ab824892655842d984b511e8", "url": "https://github.com/dotCMS/core/commit/232bfc0b67405366ab824892655842d984b511e8", "message": "refactring", "committedDate": "2020-10-14T14:31:30Z", "type": "commit"}, {"oid": "37ddd6a0a48eb16810905f9866621f59a177879f", "url": "https://github.com/dotCMS/core/commit/37ddd6a0a48eb16810905f9866621f59a177879f", "message": "refactring", "committedDate": "2020-10-14T14:33:44Z", "type": "commit"}, {"oid": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "url": "https://github.com/dotCMS/core/commit/f881a55ae5949e4068fdc5b442f6f9d691481c0a", "message": "#18834 not mess sort_order property in PP", "committedDate": "2020-10-14T22:28:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODEzMg==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028132", "bodyText": "Codacy found an issue: Field hint has the same name as a method", "author": "dev-dotcms", "createdAt": "2020-10-14T22:34:58Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -8,16 +8,14 @@\n \n public class FieldDataGen extends AbstractDataGen<Field> {\n \n-    private final long currentTime = System.currentTimeMillis();\n-\n-    private String name = \"testFieldName\" + currentTime;\n+    private String name;\n     private Class type = TextField.class;\n     private boolean required = Boolean.FALSE;\n-    private String velocityVarName = \"testFieldVarname\" + currentTime;\n+    private String velocityVarName;\n     private int sortOrder = 1;\n-    private String values = \"testValue\" + currentTime;\n-    private String hint = \"testHint\" + currentTime;\n-    private String defaultValue = \"testDefaultValue\" + currentTime;\n+    private String values;\n+    private String hint;", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODE1NQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028155", "bodyText": "Codacy found an issue: Avoid using short method names", "author": "dev-dotcms", "createdAt": "2020-10-14T22:34:59Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -26,13 +24,29 @@\n     private boolean unique = Boolean.FALSE;\n     private String contentTypeId;\n     private String relationType;\n+    private String id;\n+\n+    public FieldDataGen() {\n+\n+        final long currentTime = System.currentTimeMillis();\n+        name = \"testFieldName\" + currentTime;\n+        velocityVarName = \"testFieldVarname\" + currentTime;\n+        values = \"testValue\" + currentTime;\n+        hint = \"testHint\" + currentTime;\n+        defaultValue = \"testDefaultValue\" + currentTime;\n+    }\n \n     @SuppressWarnings(\"unused\")\n     public FieldDataGen name(final String name) {\n         this.name = name;\n         return this;\n     }\n \n+    public FieldDataGen id(final String id) {", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODE2OA==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028168", "bodyText": "Codacy found an issue: Field id has the same name as a method", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:00Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -26,13 +24,29 @@\n     private boolean unique = Boolean.FALSE;\n     private String contentTypeId;\n     private String relationType;\n+    private String id;", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODE3NQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028175", "bodyText": "Codacy found an issue: Field name has the same name as a method", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:01Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -8,16 +8,14 @@\n \n public class FieldDataGen extends AbstractDataGen<Field> {\n \n-    private final long currentTime = System.currentTimeMillis();\n-\n-    private String name = \"testFieldName\" + currentTime;\n+    private String name;", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODE4OQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028189", "bodyText": "Codacy found an issue: A method/constructor should not explicitly throw java.lang.Exception", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:02Z", "path": "dotCMS/src/integration-test/java/com/dotcms/contenttype/business/FieldAPIImplIntegrationTest.java", "diffHunk": "@@ -0,0 +1,171 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.model.field.ColumnField;\n+import com.dotcms.contenttype.model.field.Field;\n+import com.dotcms.contenttype.model.field.RowField;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.datagen.ContentTypeDataGen;\n+import com.dotcms.datagen.FieldDataGen;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.exception.DotSecurityException;\n+import com.liferay.portal.model.User;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static org.junit.Assert.assertEquals;\n+\n+public class FieldAPIImplIntegrationTest {\n+\n+    @BeforeClass\n+    public static void prepare () throws Exception {", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODIwMg==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028202", "bodyText": "Codacy found an issue: Field velocityVarName has the same name as a method", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:04Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -8,16 +8,14 @@\n \n public class FieldDataGen extends AbstractDataGen<Field> {\n \n-    private final long currentTime = System.currentTimeMillis();\n-\n-    private String name = \"testFieldName\" + currentTime;\n+    private String name;\n     private Class type = TextField.class;\n     private boolean required = Boolean.FALSE;\n-    private String velocityVarName = \"testFieldVarname\" + currentTime;\n+    private String velocityVarName;", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODIxOQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028219", "bodyText": "Codacy found an issue: Avoid variables with short names like id", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:05Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -26,13 +24,29 @@\n     private boolean unique = Boolean.FALSE;\n     private String contentTypeId;\n     private String relationType;\n+    private String id;\n+\n+    public FieldDataGen() {\n+\n+        final long currentTime = System.currentTimeMillis();\n+        name = \"testFieldName\" + currentTime;\n+        velocityVarName = \"testFieldVarname\" + currentTime;\n+        values = \"testValue\" + currentTime;\n+        hint = \"testHint\" + currentTime;\n+        defaultValue = \"testDefaultValue\" + currentTime;\n+    }\n \n     @SuppressWarnings(\"unused\")\n     public FieldDataGen name(final String name) {\n         this.name = name;\n         return this;\n     }\n \n+    public FieldDataGen id(final String id) {", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODIzNQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028235", "bodyText": "Codacy found an issue: It is a good practice to call super() in a constructor", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:06Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -26,13 +24,29 @@\n     private boolean unique = Boolean.FALSE;\n     private String contentTypeId;\n     private String relationType;\n+    private String id;\n+\n+    public FieldDataGen() {", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAyODI1MQ==", "url": "https://github.com/dotCMS/core/pull/19430#discussion_r505028251", "bodyText": "Codacy found an issue: Avoid variables with short names like id", "author": "dev-dotcms", "createdAt": "2020-10-14T22:35:07Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/FieldDataGen.java", "diffHunk": "@@ -26,13 +24,29 @@\n     private boolean unique = Boolean.FALSE;\n     private String contentTypeId;\n     private String relationType;\n+    private String id;", "originalCommit": "f881a55ae5949e4068fdc5b442f6f9d691481c0a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}