{"pr_number": 18433, "pr_title": "#18401: Implements the Drop Zone web component in WYSIWYG", "pr_createdAt": "2020-05-04T22:29:16Z", "pr_url": "https://github.com/dotCMS/core/pull/18433", "timeline": [{"oid": "862bf67d15a45d0e811a691b8b48d8d0175cc1ef", "url": "https://github.com/dotCMS/core/commit/862bf67d15a45d0e811a691b8b48d8d0175cc1ef", "message": "feat: implemented the drag & drop webcomponent in the WYSIWYG editor", "committedDate": "2020-05-04T22:17:17Z", "type": "commit"}, {"oid": "7abe9b40e8f549c5a225726b89800ff74aa803de", "url": "https://github.com/dotCMS/core/commit/7abe9b40e8f549c5a225726b89800ff74aa803de", "message": "fixed a typo and incread the height", "committedDate": "2020-05-04T22:25:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc2NzkyOA==", "url": "https://github.com/dotCMS/core/pull/18433#discussion_r419767928", "bodyText": "remove", "author": "alfredo-dotcms", "createdAt": "2020-05-04T22:32:47Z", "path": "dotCMS/src/main/webapp/html/portlet/ext/contentlet/field/edit_field_js.jsp", "diffHunk": "@@ -368,10 +375,30 @@ var cmsfile=null;\n \t\t\t}else if(tinyConf.plugins != undefined ){\r\n \t\t\t    tinyConf.plugins=tinyConf.plugins.replace(\"compat3x\",\"\");\r\n \t\t\t}\r\n-            console.log(textAreaId, tinyConf );\r\n+            console.log(textAreaId, tinyConf);\r", "originalCommit": "7abe9b40e8f549c5a225726b89800ff74aa803de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc3MjMxNA==", "url": "https://github.com/dotCMS/core/pull/18433#discussion_r419772314", "bodyText": "why not the dot-asset-drop-zone wrap the textarea ?", "author": "hmoreras", "createdAt": "2020-05-04T22:45:12Z", "path": "dotCMS/src/main/webapp/html/portlet/ext/contentlet/field/edit_field.jsp", "diffHunk": "@@ -236,10 +236,22 @@\n         %>\n         <div class=\"wysiwyg-wrapper\">\n             <div id=\"<%=field.getVelocityVarName()%>aceEditor\" class=\"classAce aceTall\" style=\"display: none\"></div>\n-            <textarea <%= isReadOnly?\"readonly=\\\"readonly\\\"\":\"\" %>\n-                    class=\"editWYSIWYGField aceText aceTall\" \n-                    name=\"<%=field.getFieldContentlet()%>\"\n-                    id=\"<%=field.getVelocityVarName()%>\"><%=UtilMethods.htmlifyString(textValue)%></textarea>\n+\n+                <style type=\"text/css\">\n+                   dot-asset-drop-zone {\n+                     width: 100%;\n+                     height: 91%;\n+                     position: absolute;\n+                     z-index: 1;\n+                     pointer-events: none;\n+                   }\n+                </style>\n+                <dot-asset-drop-zone id=\"dot-asset-drop-zone-<%=field.getVelocityVarName()%>\"></dot-asset-drop-zone>", "originalCommit": "7abe9b40e8f549c5a225726b89800ff74aa803de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk2MzY1MA==", "url": "https://github.com/dotCMS/core/pull/18433#discussion_r419963650", "bodyText": "I understand this was its intended usage, however, when wrapping the textarea with it I had issues with pointer-events in the editor. If this is a problem please let me know.\nRelated \n  \n    \n      core/dotCMS/src/main/webapp/html/portlet/ext/contentlet/field/edit_field_js.jsp\n    \n    \n        Lines 381 to 393\n      in\n      f6352f9\n    \n    \n    \n    \n\n        \n          \n           \t\t\t  tinyConf = { \n        \n\n        \n          \n           \t\t\t    ...tinyConf, \n        \n\n        \n          \n           \t\t\t    init_instance_callback: (editor) => { \n        \n\n        \n          \n           \t\t\t      let dropZone = document.getElementById( \n        \n\n        \n          \n           \t\t\t        `dot-asset-drop-zone-${textAreaId}` \n        \n\n        \n          \n           \t\t\t      ); \n        \n\n        \n          \n           \t\t\t      editor.on(\"dragover\", function (e) { \n        \n\n        \n          \n           \t\t\t        dropZone.style.pointerEvents = \"all\"; \n        \n\n        \n          \n           \t\t\t      }); \n        \n\n        \n          \n           \t\t\t      editor.dom.bind(document, \"dragleave\", function (e) { \n        \n\n        \n          \n           \t\t\t        dropZone.style.pointerEvents = \"none\"; \n        \n\n        \n          \n           \t\t\t        return false; \n        \n\n        \n          \n           \t\t\t      });", "author": "ivorpad", "createdAt": "2020-05-05T09:03:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc3MjMxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTc3MjQxOA==", "url": "https://github.com/dotCMS/core/pull/18433#discussion_r419772418", "bodyText": "remove", "author": "hmoreras", "createdAt": "2020-05-04T22:45:28Z", "path": "dotCMS/src/main/webapp/html/portlet/ext/contentlet/field/edit_field_js.jsp", "diffHunk": "@@ -368,10 +375,30 @@ var cmsfile=null;\n \t\t\t}else if(tinyConf.plugins != undefined ){\r\n \t\t\t    tinyConf.plugins=tinyConf.plugins.replace(\"compat3x\",\"\");\r\n \t\t\t}\r\n-            console.log(textAreaId, tinyConf );\r\n+            console.log(textAreaId, tinyConf);\r", "originalCommit": "7abe9b40e8f549c5a225726b89800ff74aa803de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "19d45fbdac55b88732dbaee6f7c3f8acd37ac596", "url": "https://github.com/dotCMS/core/commit/19d45fbdac55b88732dbaee6f7c3f8acd37ac596", "message": "removed console.log", "committedDate": "2020-05-05T08:46:54Z", "type": "commit"}, {"oid": "92bf5ff2476e764ba2f1fc5dad90dd455268d8fb", "url": "https://github.com/dotCMS/core/commit/92bf5ff2476e764ba2f1fc5dad90dd455268d8fb", "message": "clean up formatting", "committedDate": "2020-05-05T08:59:40Z", "type": "commit"}, {"oid": "f6352f95de7842889b29490cca8246088ceedf13", "url": "https://github.com/dotCMS/core/commit/f6352f95de7842889b29490cca8246088ceedf13", "message": "formatting issues again", "committedDate": "2020-05-05T09:01:32Z", "type": "commit"}, {"oid": "4b17d67f5b5519f086e8286756bac879617c6f30", "url": "https://github.com/dotCMS/core/commit/4b17d67f5b5519f086e8286756bac879617c6f30", "message": "Moved the CSS to dotcms-dojo-theme", "committedDate": "2020-05-05T17:01:30Z", "type": "commit"}, {"oid": "8a4c55afdb09c5c8fc3acbfadc00fe32aebe46c4", "url": "https://github.com/dotCMS/core/commit/8a4c55afdb09c5c8fc3acbfadc00fe32aebe46c4", "message": "Added the compiled dotcms.css file", "committedDate": "2020-05-05T17:10:09Z", "type": "commit"}, {"oid": "51d3f8be84530f951c05c557745374dc3ae651fe", "url": "https://github.com/dotCMS/core/commit/51d3f8be84530f951c05c557745374dc3ae651fe", "message": "Assets can now be uploaded by folder or host", "committedDate": "2020-05-05T22:45:13Z", "type": "commit"}, {"oid": "553b0624d77d6fec0868aec8d96ba822eef2754e", "url": "https://github.com/dotCMS/core/commit/553b0624d77d6fec0868aec8d96ba822eef2754e", "message": "Improved the conditions", "committedDate": "2020-05-05T23:07:49Z", "type": "commit"}]}