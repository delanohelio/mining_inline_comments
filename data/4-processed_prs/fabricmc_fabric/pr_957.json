{"pr_number": 957, "pr_title": "Entity Events v1", "pr_createdAt": "2020-07-26T05:59:42Z", "pr_url": "https://github.com/FabricMC/fabric/pull/957", "timeline": [{"oid": "4b564b2b4de8564e4cafba16a26a432d11543c29", "url": "https://github.com/FabricMC/fabric/commit/4b564b2b4de8564e4cafba16a26a432d11543c29", "message": "Call AFTER_KILLED_OTHER on a ServerPlayerEntity upon death.", "committedDate": "2020-08-07T02:00:19Z", "type": "forcePushed"}, {"oid": "9cfdf61d0ebb1b6215e8ece3cf6a1a9f5dc41f04", "url": "https://github.com/FabricMC/fabric/commit/9cfdf61d0ebb1b6215e8ece3cf6a1a9f5dc41f04", "message": "Add event which is fired when a player first joined a server and add functional interface annotations", "committedDate": "2020-08-13T02:07:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY2Mzk0MQ==", "url": "https://github.com/FabricMC/fabric/pull/957#discussion_r469663941", "bodyText": "Hmm, what's the point of Area Helper from minecraft then", "author": "liach", "createdAt": "2020-08-13T02:43:16Z", "path": "fabric-entity-events-v1/src/main/java/net/fabricmc/fabric/api/entity/event/v1/EntityTeleportationHelper.java", "diffHunk": "@@ -0,0 +1,117 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.entity.event.v1;\n+\n+import java.util.Optional;\n+\n+import net.minecraft.client.world.ClientWorld;\n+import net.minecraft.entity.Entity;\n+import net.minecraft.entity.EntityType;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.entity.mob.PathAwareEntity;\n+import net.minecraft.server.network.ServerPlayerEntity;\n+import net.minecraft.server.world.ServerWorld;\n+import net.minecraft.util.math.MathHelper;\n+\n+/**\n+ * A utility class providing methods to help teleport entities to other server worlds.\n+ */\n+public final class EntityTeleportationHelper {", "originalCommit": "123eadc0156d3780a81b4c705e3890199c3eeefb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY2NTUwOA==", "url": "https://github.com/FabricMC/fabric/pull/957#discussion_r469665508", "bodyText": "AreaHelper does not teleport the entity. The only teleport logic is Server player, entity moveToWorld and teleport command.\nHowever an event for the after world change is gonna be a pain for other mod devs since they would have to go pretty manual. This just makes a lazy one method call to teleport an entity straight to another world.", "author": "i509VCB", "createdAt": "2020-08-13T02:49:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY2Mzk0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc5MTQ1NQ==", "url": "https://github.com/FabricMC/fabric/pull/957#discussion_r527791455", "bodyText": "I feel like this class should be in another module as it's more generalized than just for entity events.", "author": "LambdAurora", "createdAt": "2020-11-20T16:03:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY2Mzk0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODAzOTM2OQ==", "url": "https://github.com/FabricMC/fabric/pull/957#discussion_r528039369", "bodyText": "I believe that a method in updated dimension api pull request would suffice here and reduces duplicate logic.", "author": "i509VCB", "createdAt": "2020-11-21T00:37:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTY2Mzk0MQ=="}], "type": "inlineReview"}, {"oid": "5d9b506811e265c6107f00e87129458ba0a09c13", "url": "https://github.com/FabricMC/fabric/commit/5d9b506811e265c6107f00e87129458ba0a09c13", "message": "mispelled", "committedDate": "2020-10-22T07:16:01Z", "type": "forcePushed"}, {"oid": "abb1682540e07eb5501b2325bc173ccdc146041c", "url": "https://github.com/FabricMC/fabric/commit/abb1682540e07eb5501b2325bc173ccdc146041c", "message": "Update for mappings", "committedDate": "2020-10-22T20:00:44Z", "type": "forcePushed"}, {"oid": "9ed153b36f61de5a02bc0775df29b7c558171440", "url": "https://github.com/FabricMC/fabric/commit/9ed153b36f61de5a02bc0775df29b7c558171440", "message": "Warning comment", "committedDate": "2020-11-20T04:05:38Z", "type": "forcePushed"}, {"oid": "8577bb1dcfece3d6fb35280f136760c2f51c3673", "url": "https://github.com/FabricMC/fabric/commit/8577bb1dcfece3d6fb35280f136760c2f51c3673", "message": "Entity Events v1.\n\nFirst up is an event fired after a living entity is damaged. All vanilla living entities except armor stands work with this event.", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "fbda16d5237c1c95cd9b2aef9dcf48ccd8c1f808", "url": "https://github.com/FabricMC/fabric/commit/fbda16d5237c1c95cd9b2aef9dcf48ccd8c1f808", "message": "Events related to killing of entities, changing world, player respawn/copyFrom\n\nDeath related:\nan entity killing something and an entity being killed by an adversary\n\nPlayer related:\nAfter respawn, copy to", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "b10b6b0c248be0d776cb681bc70cc9f6982c2781", "url": "https://github.com/FabricMC/fabric/commit/b10b6b0c248be0d776cb681bc70cc9f6982c2781", "message": "Adversary stuff isn't needed", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "5a7b5b593f7797b617530afa46d706029bf542b7", "url": "https://github.com/FabricMC/fabric/commit/5a7b5b593f7797b617530afa46d706029bf542b7", "message": "checkstyle again", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "589bfdd4132658f45983729e4a23033abf9af10c", "url": "https://github.com/FabricMC/fabric/commit/589bfdd4132658f45983729e4a23033abf9af10c", "message": "Call AFTER_KILLED_OTHER on a ServerPlayerEntity upon death.", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "95836187a619c6ae31d43572ad9e7480e836d1e3", "url": "https://github.com/FabricMC/fabric/commit/95836187a619c6ae31d43572ad9e7480e836d1e3", "message": "Add event which is fired when a player first joined a server and add functional interface annotations", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "cadc396b6e39c655f412858f21a37f66085db89c", "url": "https://github.com/FabricMC/fabric/commit/cadc396b6e39c655f412858f21a37f66085db89c", "message": "Update build.gradle", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "a25a277ac0ef9c2cbc81757bf402ff3e2a5e045c", "url": "https://github.com/FabricMC/fabric/commit/a25a277ac0ef9c2cbc81757bf402ff3e2a5e045c", "message": "mispelled", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "c0a29855879e1473e79ca9f0f31573b68f18323d", "url": "https://github.com/FabricMC/fabric/commit/c0a29855879e1473e79ca9f0f31573b68f18323d", "message": "Some renames, test events, drop damage event\n\nDamage events need further consideration in future", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "d1e44f0c2112f33d2fbf398bb353231e7f7732f4", "url": "https://github.com/FabricMC/fabric/commit/d1e44f0c2112f33d2fbf398bb353231e7f7732f4", "message": "Comments and null check", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "9451b72936de2fdf5a4ea4ecbe48ecff05a74f2d", "url": "https://github.com/FabricMC/fabric/commit/9451b72936de2fdf5a4ea4ecbe48ecff05a74f2d", "message": "Update for mappings", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "e6e11f8b98b34915b37078f793eac8bafbb43bee", "url": "https://github.com/FabricMC/fabric/commit/e6e11f8b98b34915b37078f793eac8bafbb43bee", "message": "Warning comment", "committedDate": "2020-11-22T09:05:34Z", "type": "commit"}, {"oid": "0e503ec42442fc3d19a46b4528fb066d1880ccf4", "url": "https://github.com/FabricMC/fabric/commit/0e503ec42442fc3d19a46b4528fb066d1880ccf4", "message": "Remove first join event and teleport helper\n\nFirst join does not work atm and teleport is in dimensions pr", "committedDate": "2020-11-22T09:09:29Z", "type": "commit"}, {"oid": "0e503ec42442fc3d19a46b4528fb066d1880ccf4", "url": "https://github.com/FabricMC/fabric/commit/0e503ec42442fc3d19a46b4528fb066d1880ccf4", "message": "Remove first join event and teleport helper\n\nFirst join does not work atm and teleport is in dimensions pr", "committedDate": "2020-11-22T09:09:29Z", "type": "forcePushed"}, {"oid": "cbf1b563180b0738faca28b7a65b6210fbd5297d", "url": "https://github.com/FabricMC/fabric/commit/cbf1b563180b0738faca28b7a65b6210fbd5297d", "message": "Module dependencies", "committedDate": "2020-11-22T09:24:10Z", "type": "commit"}, {"oid": "928edbe3bbd24399f615228ca45a2d1b59a442dc", "url": "https://github.com/FabricMC/fabric/commit/928edbe3bbd24399f615228ca45a2d1b59a442dc", "message": "Javadoc tweaks", "committedDate": "2020-11-23T08:16:30Z", "type": "commit"}, {"oid": "5a4d6f6d25e04e71df8f3e0f3c2ed7c09e4e7092", "url": "https://github.com/FabricMC/fabric/commit/5a4d6f6d25e04e71df8f3e0f3c2ed7c09e4e7092", "message": "Merge branch '1.16' into entity-post-damage-event", "committedDate": "2020-12-22T20:42:19Z", "type": "commit"}, {"oid": "a88deb2113d013701d1d6fc5dc92ae40285dec49", "url": "https://github.com/FabricMC/fabric/commit/a88deb2113d013701d1d6fc5dc92ae40285dec49", "message": "The serverening", "committedDate": "2020-12-23T23:43:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODM4NzgyNA==", "url": "https://github.com/FabricMC/fabric/pull/957#discussion_r548387824", "bodyText": "Imo we should just capture failhard than generate an exception stub. same for other local captures.", "author": "liach", "createdAt": "2020-12-24T05:25:59Z", "path": "fabric-entity-events-v1/src/main/java/net/fabricmc/fabric/mixin/entity/event/LivingEntityMixin.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.entity.event;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+import org.spongepowered.asm.mixin.injection.callback.LocalCapture;\n+\n+import net.minecraft.entity.Entity;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.entity.damage.DamageSource;\n+import net.minecraft.server.world.ServerWorld;\n+\n+import net.fabricmc.fabric.api.entity.event.v1.ServerEntityCombatEvents;\n+\n+@Mixin(LivingEntity.class)\n+abstract class LivingEntityMixin extends EntityMixin {\n+\t@Inject(method = \"onDeath\", at = @At(value = \"INVOKE\", target = \"Lnet/minecraft/entity/Entity;onKilledOther(Lnet/minecraft/server/world/ServerWorld;Lnet/minecraft/entity/LivingEntity;)V\", shift = At.Shift.AFTER), locals = LocalCapture.CAPTURE_FAILEXCEPTION)", "originalCommit": "a88deb2113d013701d1d6fc5dc92ae40285dec49", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}