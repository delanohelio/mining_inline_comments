{"pr_number": 4293, "pr_title": "DHFPROD-5425: Prevent creating flow with existing name", "pr_createdAt": "2020-07-27T21:45:12Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4293", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTUxODExNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4293#discussion_r461518116", "bodyText": "Can you add a small test to manageFlow.sjs as well? Generally, an HC test alone won't suffice - we want to have coverage of ML code within the DHF core project.", "author": "rjrudin", "createdAt": "2020-07-28T11:45:57Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/data-services/flow/createFlow.sjs", "diffHunk": "@@ -16,10 +16,20 @@\n 'use strict';\n \n const Artifacts = require('/data-hub/5/artifacts/core.sjs');\n+const ds = require(\"/data-hub/5/data-services/ds-utils.sjs\");\n \n var name;\n var description;\n \n+let existingFlow = null;\n+try {\n+  existingFlow = Artifacts.getArtifact('flow', name);\n+} catch (e) {\n+  // swallowing error, as we don't want there to be an existing flow with the given name.\n+}\n+if (existingFlow) {\n+  ds.throwBadRequest(`Cannot create flow; flow with the name '${name}' already exists`);\n+}", "originalCommit": "ed16096818e986ca586282855007e4e93fbcbe79", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "20917d098a7cff80e4cccf2a259792ead4a7abc2", "url": "https://github.com/marklogic/marklogic-data-hub/commit/20917d098a7cff80e4cccf2a259792ead4a7abc2", "message": "DHFPROD-5425: Prevent creating flow with existing name", "committedDate": "2020-07-28T18:33:48Z", "type": "commit"}, {"oid": "20917d098a7cff80e4cccf2a259792ead4a7abc2", "url": "https://github.com/marklogic/marklogic-data-hub/commit/20917d098a7cff80e4cccf2a259792ead4a7abc2", "message": "DHFPROD-5425: Prevent creating flow with existing name", "committedDate": "2020-07-28T18:33:48Z", "type": "forcePushed"}]}