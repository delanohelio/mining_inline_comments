{"pr_number": 4045, "pr_title": "DHFPROD-5052: login e2e tests and refactoring of page object imports", "pr_createdAt": "2020-06-03T02:02:50Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4045", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxOTk4MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4045#discussion_r434719980", "bodyText": "This is a half baked test. I will comment it out for now.", "author": "bsrikan", "createdAt": "2020-06-03T17:00:58Z", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/authorization.spec.tsx", "diffHunk": "@@ -1,48 +1,172 @@\n /// <reference types=\"cypress\"/>\n \n-import LoginPage from '../support/pages/login';\n+import loginPage from '../support/pages/login';\n import { Application } from '../support/application.config';\n+import { toolbar, tiles, projectInfo } from '../support/components/common/index';\n \n-const loginPage = new LoginPage();\n \n describe('login', () => {\n   before(() => {\n     cy.visit('/');\n   });\n \n-  it('greets with Data Hub Central', () => {\n-    cy.contains(Application.title);\n+  after(() => {\n+    //resetting the test user back to only have 'hub-central-user' role\n+    cy.resetTestUser();\n   });\n \n-  it('has links to privacy statement/policies', () => {\n+  it('greets with Data Hub Central title and footer links', () => {\n+      cy.contains(Application.title);\n+\n       cy.contains('Policies');\n+      cy.contains('Terms and Conditions');\n   });\n \n-  it('has link to terms and conditions ', () => {\n-    cy.contains('Terms and Conditions');\n+  it('should verify all the error conditions for login', () => {\n+      //Verify username/password is required and login button is disabled\n+      loginPage.getUsername().type('{enter}').blur();\n+      loginPage.getPassword().type('{enter}').blur();\n+      cy.contains('Username is required');\n+      cy.contains('Password is required');\n+      loginPage.getLoginButton().should('be.disabled');\n+\n+      //Verify invalid credentials error message\n+      loginPage.getUsername().type('test');\n+      loginPage.getPassword().type('password');\n+      loginPage.getLoginButton().click();\n+      cy.contains('The username and password combination is not recognized by MarkLogic.');\n+\n+      //Verify admin cannot login\n+      loginPage.getUsername().clear();\n+      loginPage.getPassword().clear();\n+      loginPage.getUsername().type('admin');\n+      loginPage.getPassword().type('admin');\n+      loginPage.getLoginButton().click();\n+      cy.contains('User does not have the required permissions to run Data Hub.');\n+\n   });\n \n-  xit('has forgot password link', () => {\n-    loginPage.getforgotPasswordLink()\n-      .should('have.attr', 'href'); \n+  it('should verify auto logout after inactivity', () => {", "originalCommit": "b6d81697d95fdb9f7baf6a1ee7efde1473de8f26", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcyMDQyNA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4045#discussion_r434720424", "bodyText": "Realizing now that this test might not run in DHS. Will push a change.", "author": "bsrikan", "createdAt": "2020-06-03T17:01:47Z", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/authorization.spec.tsx", "diffHunk": "@@ -1,48 +1,172 @@\n /// <reference types=\"cypress\"/>\n \n-import LoginPage from '../support/pages/login';\n+import loginPage from '../support/pages/login';\n import { Application } from '../support/application.config';\n+import { toolbar, tiles, projectInfo } from '../support/components/common/index';\n \n-const loginPage = new LoginPage();\n \n describe('login', () => {\n   before(() => {\n     cy.visit('/');\n   });\n \n-  it('greets with Data Hub Central', () => {\n-    cy.contains(Application.title);\n+  after(() => {\n+    //resetting the test user back to only have 'hub-central-user' role\n+    cy.resetTestUser();\n   });\n \n-  it('has links to privacy statement/policies', () => {\n+  it('greets with Data Hub Central title and footer links', () => {\n+      cy.contains(Application.title);\n+\n       cy.contains('Policies');\n+      cy.contains('Terms and Conditions');\n   });\n \n-  it('has link to terms and conditions ', () => {\n-    cy.contains('Terms and Conditions');\n+  it('should verify all the error conditions for login', () => {\n+      //Verify username/password is required and login button is disabled\n+      loginPage.getUsername().type('{enter}').blur();\n+      loginPage.getPassword().type('{enter}').blur();\n+      cy.contains('Username is required');\n+      cy.contains('Password is required');\n+      loginPage.getLoginButton().should('be.disabled');\n+\n+      //Verify invalid credentials error message\n+      loginPage.getUsername().type('test');\n+      loginPage.getPassword().type('password');\n+      loginPage.getLoginButton().click();\n+      cy.contains('The username and password combination is not recognized by MarkLogic.');\n+\n+      //Verify admin cannot login\n+      loginPage.getUsername().clear();\n+      loginPage.getPassword().clear();\n+      loginPage.getUsername().type('admin');\n+      loginPage.getPassword().type('admin');\n+      loginPage.getLoginButton().click();", "originalCommit": "b6d81697d95fdb9f7baf6a1ee7efde1473de8f26", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3dde2c9b99624589a6de06f39cd0742a75f8ac7e", "url": "https://github.com/marklogic/marklogic-data-hub/commit/3dde2c9b99624589a6de06f39cd0742a75f8ac7e", "message": "DHFPROD-5052: login e2e tests and refactoring of page object imports", "committedDate": "2020-06-03T17:49:25Z", "type": "forcePushed"}, {"oid": "fdd9e8999e48065231b87e7f15b80def7f95f7ec", "url": "https://github.com/marklogic/marklogic-data-hub/commit/fdd9e8999e48065231b87e7f15b80def7f95f7ec", "message": "DHFPROD-5052: login e2e tests and refactoring of page object imports", "committedDate": "2020-06-05T19:37:20Z", "type": "commit"}, {"oid": "fdd9e8999e48065231b87e7f15b80def7f95f7ec", "url": "https://github.com/marklogic/marklogic-data-hub/commit/fdd9e8999e48065231b87e7f15b80def7f95f7ec", "message": "DHFPROD-5052: login e2e tests and refactoring of page object imports", "committedDate": "2020-06-05T19:37:20Z", "type": "forcePushed"}]}