{"pr_number": 3767, "pr_title": "DHFPROD-3841: Can now reference $URI in mappings", "pr_createdAt": "2020-03-27T04:00:11Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3767", "timeline": [{"oid": "adbeda7f8203bcda8226d1113e57c43b424700dd", "url": "https://github.com/marklogic/marklogic-data-hub/commit/adbeda7f8203bcda8226d1113e57c43b424700dd", "message": "DHFPROD-3841: Can now reference $URI in mappings\n\nThis opens the door to all sorts of variables in a mapping artifact. However, to achieve this, I had to make a copy of the ES functions map-to-canonical and node-map-to-canonical so that I can pass in a map of params to the underlying xdmp:xslt calls. I opened up bug 54632 so that the ES functions will allow this in a future version.", "committedDate": "2020-03-27T03:59:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNzUzMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3767#discussion_r399407530", "bodyText": "@rjrudin ,\nCan \"sourcedFrom\" be set to something like concat($URI, 'test-uri') ? If so, adding a test for that would be good.", "author": "srinathgit", "createdAt": "2020-03-27T16:56:09Z", "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/builtins/steps/mapping/entity-services/test-data/mappings/PersonMapping/PersonMapping-7.mapping.json", "diffHunk": "@@ -0,0 +1,24 @@\n+{\n+  \"lang\": \"zxx\",\n+  \"name\": \"PersonMapping\",\n+  \"version\": 7,\n+  \"sourceContext\": \"/\",\n+  \"targetEntityType\": \"http://marklogic.com/data-hub/example/Person-1.0.0/Person\",\n+  \"properties\": {\n+    \"id\": {\n+      \"sourcedFrom\": \"personId\"\n+    },\n+    \"nickname\": {\n+      \"sourcedFrom\": \"$URI\"", "originalCommit": "adbeda7f8203bcda8226d1113e57c43b424700dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNDc1MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3767#discussion_r399414750", "bodyText": "I don't think it would prove anything additional. The contents of sourcedFrom are evaluated by ML, and thus from a DHF testing perspective, there's no difference between \"$URI\" and an expression that incorporates multiple functions and predicates. Either \"$URI\" gets resolved, or it doesn't - the complexity of the expression doesn't affect that.", "author": "rjrudin", "createdAt": "2020-03-27T17:07:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNzUzMA=="}], "type": "inlineReview"}]}