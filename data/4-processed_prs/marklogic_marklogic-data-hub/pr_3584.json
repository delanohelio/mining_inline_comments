{"pr_number": 3584, "pr_title": "DHFPROD-4310: Cleanup data sets when load data config is deleted", "pr_createdAt": "2020-02-15T06:18:28Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3584", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTgzODA4NA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3584#discussion_r379838084", "bodyText": "I'm wondering if this should really rethrow the error. If a dataset cannot be deleted, how much of a problem is that? And the user wouldn't really be able to do anything about it, right? I'm wondering if this should just be logged at the \"warn\" level.", "author": "rjrudin", "createdAt": "2020-02-15T15:30:56Z", "path": "one-ui/src/main/java/com/marklogic/hub/curation/controllers/LoadDataController.java", "diffHunk": "@@ -139,4 +133,19 @@ private void enrichLoadData(ObjectNode loadDataConfig) {\n         loadDataConfig.put(\"fileCount\", fileCount);\n         loadDataConfig.put(\"filesNeedReuploaded\", fileCount == 0);\n     }\n+\n+    private void deleteDataSetDirectory(String artifactName) {\n+        Path dataSetDirectoryPath = dataSetDirectory(artifactName);\n+        if (dataSetDirectoryPath.toFile().exists()) {\n+            try {\n+                FileUtils.deleteDirectory(dataSetDirectoryPath.toFile());\n+            } catch (IOException e) {\n+                throw new RuntimeException(e);", "originalCommit": "a638f5fe910e67935c6c2cfbd04b6054827cac89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk3MjA1NA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3584#discussion_r380972054", "bodyText": "@ryanjdew I got the \"{\"code\":500,\"message\":\"java.io.IOException: Unable to delete directory /Users/hliu/dhf/data-sets/validArtifact.\",\"suggestion\":\"Contact your server administrator.\"}\" exception because the //data-sets does not exists or inpuFilePath does not exist. I agree with Rob and think that we do not need to throw a runtime exception here but logging it with the warning level.", "author": "hao1st", "createdAt": "2020-02-18T22:24:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTgzODA4NA=="}], "type": "inlineReview"}, {"oid": "df5abcd01ed390d4b8e7d2109a29843e4e1a5a44", "url": "https://github.com/marklogic/marklogic-data-hub/commit/df5abcd01ed390d4b8e7d2109a29843e4e1a5a44", "message": "DHFPROD-4310: Cleanup data sets when load data config is deleted", "committedDate": "2020-02-18T17:55:42Z", "type": "commit"}, {"oid": "df5abcd01ed390d4b8e7d2109a29843e4e1a5a44", "url": "https://github.com/marklogic/marklogic-data-hub/commit/df5abcd01ed390d4b8e7d2109a29843e4e1a5a44", "message": "DHFPROD-4310: Cleanup data sets when load data config is deleted", "committedDate": "2020-02-18T17:55:42Z", "type": "forcePushed"}]}