{"pr_number": 3883, "pr_title": "DHFPROD-4775: New endpoint for clearing user data", "pr_createdAt": "2020-04-28T14:28:03Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3883", "timeline": [{"oid": "b99a0d10eca714bbd9ee8a7a1e27274394d6a9e0", "url": "https://github.com/marklogic/marklogic-data-hub/commit/b99a0d10eca714bbd9ee8a7a1e27274394d6a9e0", "message": "DHFPROD-4775: New endpoint for clearing user data\n\nThe interesting new stuff is all in DataHubImpl.\n\nTossed a bunch of the download-testing stuff into AllArtifactsProject so that it can be reused easily by ClearUserDataTest.\n\nNot updating mocks.json/mocks.yaml yet - going to look into springfox again to see if we can get this stuff generated dynamically from the middle tier endpoints.", "committedDate": "2020-04-28T18:42:18Z", "type": "forcePushed"}, {"oid": "4e22ac9cfab194ac054474fcd015009b066198a4", "url": "https://github.com/marklogic/marklogic-data-hub/commit/4e22ac9cfab194ac054474fcd015009b066198a4", "message": "DHFPROD-4775: New endpoint for clearing user data\n\nThe interesting new stuff is all in DataHubImpl.\n\nTossed a bunch of the download-testing stuff into AllArtifactsProject so that it can be reused easily by ClearUserDataTest.\n\nNot updating mocks.json/mocks.yaml yet - going to look into springfox again to see if we can get this stuff generated dynamically from the middle tier endpoints.", "committedDate": "2020-04-28T20:11:39Z", "type": "forcePushed"}, {"oid": "d07c7e7d711e6186f3ffd2d95dd23d234f67125d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/d07c7e7d711e6186f3ffd2d95dd23d234f67125d", "message": "DHFPROD-4775: New endpoint for clearing user data\n\nThe interesting new stuff is all in DataHubImpl.\n\nTossed a bunch of the download-testing stuff into AllArtifactsProject so that it can be reused easily by ClearUserDataTest.\n\nModified the \"runAs*\" methods so that the ManageClient runs as the given user too to avoid confusion. This caused a number of existing tests to break, as they were assuming that the ManageClient was still associated with an admin or flow-developer. So I fixed up those tests to ensure they're running as the proper user based on the operation being performed.", "committedDate": "2020-04-29T01:08:12Z", "type": "forcePushed"}, {"oid": "931c35580dc4f0a18419c1071b9ccabba37eb8b0", "url": "https://github.com/marklogic/marklogic-data-hub/commit/931c35580dc4f0a18419c1071b9ccabba37eb8b0", "message": "DHFPROD-4775: New endpoint for clearing user data\n\nThe interesting new stuff is all in DataHubImpl.\n\nTossed a bunch of the download-testing stuff into AllArtifactsProject so that it can be reused easily by ClearUserDataTest.\n\nModified the \"runAs*\" methods so that the ManageClient runs as the given user too to avoid confusion. This caused a number of existing tests to break, as they were assuming that the ManageClient was still associated with an admin or flow-developer. So I fixed up those tests to ensure they're running as the proper user based on the operation being performed.", "committedDate": "2020-04-29T13:17:14Z", "type": "commit"}, {"oid": "931c35580dc4f0a18419c1071b9ccabba37eb8b0", "url": "https://github.com/marklogic/marklogic-data-hub/commit/931c35580dc4f0a18419c1071b9ccabba37eb8b0", "message": "DHFPROD-4775: New endpoint for clearing user data\n\nThe interesting new stuff is all in DataHubImpl.\n\nTossed a bunch of the download-testing stuff into AllArtifactsProject so that it can be reused easily by ClearUserDataTest.\n\nModified the \"runAs*\" methods so that the ManageClient runs as the given user too to avoid confusion. This caused a number of existing tests to break, as they were assuming that the ManageClient was still associated with an admin or flow-developer. So I fixed up those tests to ensure they're running as the proper user based on the operation being performed.", "committedDate": "2020-04-29T13:17:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU4NDExNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3883#discussion_r417584115", "bodyText": "Is this just a name refactor to the download story already merged?", "author": "bsrikan", "createdAt": "2020-04-29T20:15:24Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/impl/security.sjs", "diffHunk": "@@ -64,7 +64,10 @@ class Security {\n     }\n \n     if (currentRoleNames.includes(\"hub-central-downloader\")) {\n-      response.authorities.push(\"canDownloadConfigurationFiles\");\n+      response.authorities.push(\"downloadConfigurationFiles\");", "originalCommit": "931c35580dc4f0a18419c1071b9ccabba37eb8b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU5NTQyNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3883#discussion_r417595427", "bodyText": "Right - I had pointed out to @ryanjdew that it's redundant to include the word \"can\".\nI'm also hoping for a day where we can dynamically build authorities based on patterns in role and privilege names, and we're not likely to have the word \"can\" in either of those names.", "author": "rjrudin", "createdAt": "2020-04-29T20:36:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU4NDExNQ=="}], "type": "inlineReview"}]}