{"pr_number": 4695, "pr_title": "DHFPROD-6109: Spark connector can now run on Java 8", "pr_createdAt": "2020-10-09T20:17:41Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4695", "timeline": [{"oid": "b6be1f14f26225a0bf4c82a7d7af2bf8f0a8de3a", "url": "https://github.com/marklogic/marklogic-data-hub/commit/b6be1f14f26225a0bf4c82a7d7af2bf8f0a8de3a", "message": "DHFPROD-6109: Spark connector can now run on Java 8\n\nHad to do some refactoring of HubClient/HubConfig to accomplish this:\n\n1. HubClient is now in a new api subproject that can run on Java 8\n1. All of HubConfigImpl needed to construct HubClient is now in HubClientConfig in the api project\n1. Bumped all of DHF to Java Client 5.3\n1. Bumped up Gradle to 6.4 so its version of kotlin matches that of Java Client 5.3", "committedDate": "2020-10-09T20:18:56Z", "type": "forcePushed"}, {"oid": "3000bcf9d7814da9a1c50b98fb0d943047b2c30a", "url": "https://github.com/marklogic/marklogic-data-hub/commit/3000bcf9d7814da9a1c50b98fb0d943047b2c30a", "message": "DHFPROD-6109: Spark connector can now run on Java 8\n\nHad to do some refactoring of HubClient/HubConfig to accomplish this:\n\n1. HubClient is now in a new api subproject that can run on Java 8\n1. All of HubConfigImpl needed to construct HubClient is now in HubClientConfig in the api project\n1. Bumped all of DHF to Java Client 5.3\n1. Bumped up Gradle to 6.4 so its version of kotlin matches that of Java Client 5.3", "committedDate": "2020-10-10T01:12:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk5MjI5OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4695#discussion_r502992299", "bodyText": "@anu3990  @SameeraPriyathamTadikonda  I had to get rid of this field - Spark complained about this field because it's not serializable.", "author": "rjrudin", "createdAt": "2020-10-12T01:01:32Z", "path": "marklogic-data-hub-spark-connector/src/main/java/com/marklogic/hub/spark/sql/sources/v2/writer/HubDataWriterFactory.java", "diffHunk": "@@ -30,45 +29,37 @@\n public class HubDataWriterFactory extends LoggingObject implements DataWriterFactory<InternalRow> {\n \n     private StructType schema;\n-    private HubClient hubClient;", "originalCommit": "3000bcf9d7814da9a1c50b98fb0d943047b2c30a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNzQ4OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4695#discussion_r503427489", "bodyText": "We might need a publish task to publish it to our internal nexus(distro)", "author": "SameeraPriyathamTadikonda", "createdAt": "2020-10-12T17:09:30Z", "path": "marklogic-data-hub-api/build.gradle", "diffHunk": "@@ -0,0 +1,38 @@\n+plugins {\n+    id 'java-library'\n+    id 'java-test-fixtures'\n+    id 'maven-publish'\n+}\n+\n+group = 'com.marklogic'\n+\n+sourceCompatibility = \"8\"\n+targetCompatibility = \"8\"\n+\n+repositories {\n+    jcenter()\n+}\n+\n+dependencies {\n+    api \"com.marklogic:marklogic-client-api:5.3.0\"\n+\n+    // Needed for ManageClient, and we need the latest 3.x release, which can run on Java 8\n+    api \"com.marklogic:ml-app-deployer:3.17.0\"\n+}\n+\n+task sourcesJar(type: Jar, dependsOn: classes) {\n+    classifier 'sources'\n+    from sourceSets.main.allJava\n+}\n+\n+publishing {\n+    publications {\n+        mainJava(MavenPublication) {\n+            from components.java\n+        }\n+        sourcesJava(MavenPublication) {\n+            from components.java\n+            artifact sourcesJar\n+        }\n+    }\n+}", "originalCommit": "3000bcf9d7814da9a1c50b98fb0d943047b2c30a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzNzIxNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4695#discussion_r503437215", "bodyText": "Let's add that via a separate JIRA ticket that focus on everything we need for publishing. The goal of this ticket is just to get our connector in a state where it reuses DHF code and runs on Java 8 too.", "author": "rjrudin", "createdAt": "2020-10-12T17:30:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNzQ4OQ=="}], "type": "inlineReview"}, {"oid": "0140242c85e64211206463f604fcacd352691432", "url": "https://github.com/marklogic/marklogic-data-hub/commit/0140242c85e64211206463f604fcacd352691432", "message": "DHFPROD-6109: Spark connector can now run on Java 8\n\nHad to do some refactoring of HubClient/HubConfig to accomplish this:\n\n1. HubClient is now in a new api subproject that can run on Java 8\n1. All of HubConfigImpl needed to construct HubClient is now in HubClientConfig in the api project\n1. Bumped all of DHF to Java Client 5.3\n1. Bumped up Gradle to 6.4 so its version of kotlin matches that of Java Client 5.3", "committedDate": "2020-10-12T20:41:38Z", "type": "commit"}, {"oid": "0140242c85e64211206463f604fcacd352691432", "url": "https://github.com/marklogic/marklogic-data-hub/commit/0140242c85e64211206463f604fcacd352691432", "message": "DHFPROD-6109: Spark connector can now run on Java 8\n\nHad to do some refactoring of HubClient/HubConfig to accomplish this:\n\n1. HubClient is now in a new api subproject that can run on Java 8\n1. All of HubConfigImpl needed to construct HubClient is now in HubClientConfig in the api project\n1. Bumped all of DHF to Java Client 5.3\n1. Bumped up Gradle to 6.4 so its version of kotlin matches that of Java Client 5.3", "committedDate": "2020-10-12T20:41:38Z", "type": "forcePushed"}]}