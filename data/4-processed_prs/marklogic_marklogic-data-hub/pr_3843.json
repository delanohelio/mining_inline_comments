{"pr_number": 3843, "pr_title": "DHFPROD-3992: Add mapping step to flow and run it ", "pr_createdAt": "2020-04-20T17:36:50Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3843", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU3OTA5Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411579092", "bodyText": "Can we please get rid of all the console.log and only have console.error where applicable.", "author": "bsrikan", "createdAt": "2020-04-20T17:58:27Z", "path": "marklogic-data-hub-central/ui/src/pages/EntityTypes.tsx", "diffHunk": "@@ -43,18 +47,92 @@ const EntityTypes: React.FC = () => {\n           }\n \n     }\n+\n+  //GET all the flow artifacts\n+  const getFlows = async () => {\n+        try {\n+            let response = await axios.get('/api/flows');\n+            if (response.status === 200) {\n+                setFlows(response.data);\n+                console.log('GET flows successful', response);", "originalCommit": "f30208c4ea6a4f88d30b2b6c1e2e59256f9777ec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MjA1MQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411582051", "bodyText": "Are these specific to loadData?", "author": "bsrikan", "createdAt": "2020-04-20T18:03:06Z", "path": "marklogic-data-hub-central/ui/src/pages/EntityTypes.tsx", "diffHunk": "@@ -43,18 +47,92 @@ const EntityTypes: React.FC = () => {\n           }\n \n     }\n+\n+  //GET all the flow artifacts\n+  const getFlows = async () => {\n+        try {\n+            let response = await axios.get('/api/flows');\n+            if (response.status === 200) {\n+                setFlows(response.data);\n+                console.log('GET flows successful', response);\n+            } \n+        } catch (error) {\n+            let message = error.response.data.message;\n+            console.log('Error getting flows', message);\n+        } finally {\n+        resetSessionTime();\n+        }\n+    }\n+\n+  // POST load data step to new flow\n+  const addStepToNew = async () => {", "originalCommit": "f30208c4ea6a4f88d30b2b6c1e2e59256f9777ec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MjYyMg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411582622", "bodyText": "Same as above. Is this specific to loadData?", "author": "bsrikan", "createdAt": "2020-04-20T18:03:57Z", "path": "marklogic-data-hub-central/ui/src/pages/EntityTypes.tsx", "diffHunk": "@@ -43,18 +47,92 @@ const EntityTypes: React.FC = () => {\n           }\n \n     }\n+\n+  //GET all the flow artifacts\n+  const getFlows = async () => {\n+        try {\n+            let response = await axios.get('/api/flows');\n+            if (response.status === 200) {\n+                setFlows(response.data);\n+                console.log('GET flows successful', response);\n+            } \n+        } catch (error) {\n+            let message = error.response.data.message;\n+            console.log('Error getting flows', message);\n+        } finally {\n+        resetSessionTime();\n+        }\n+    }\n+\n+  // POST load data step to new flow\n+  const addStepToNew = async () => {\n+    try {\n+      setIsLoading(true);\n+      //let response = await axios.post(`/api/artifacts/????/${flowName}`);\n+      \n+      //if (response.status === 200) {\n+        console.log('POST addStepToNew');\n+        setIsLoading(false);\n+      //} \n+    } catch (error) {\n+        let message = error.response.data.message;\n+        console.log('Error while adding load data step to new flow.', message);\n+        setIsLoading(false);\n+        handleError(error);\n+    } finally {\n+      resetSessionTime();\n+    }\n+  }\n+\n+  // POST load data step to existing flow\n+  const addStepToFlow = async (loadArtifactName, flowName) => {", "originalCommit": "f30208c4ea6a4f88d30b2b6c1e2e59256f9777ec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MzQ1Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411583452", "bodyText": "We should try and refactor api calls under \" marklogic-data-hub-central/ui/src/api/\" for anything that gets committed to develop. I will create a story for refactoring existing axios get and post requests in develop branch.", "author": "bsrikan", "createdAt": "2020-04-20T18:05:24Z", "path": "marklogic-data-hub-central/ui/src/pages/EntityTypes.tsx", "diffHunk": "@@ -43,18 +47,92 @@ const EntityTypes: React.FC = () => {\n           }\n \n     }\n+\n+  //GET all the flow artifacts\n+  const getFlows = async () => {\n+        try {\n+            let response = await axios.get('/api/flows');\n+            if (response.status === 200) {\n+                setFlows(response.data);\n+                console.log('GET flows successful', response);\n+            } \n+        } catch (error) {\n+            let message = error.response.data.message;\n+            console.log('Error getting flows', message);\n+        } finally {\n+        resetSessionTime();\n+        }\n+    }\n+\n+  // POST load data step to new flow\n+  const addStepToNew = async () => {\n+    try {\n+      setIsLoading(true);\n+      //let response = await axios.post(`/api/artifacts/????/${flowName}`);\n+      \n+      //if (response.status === 200) {\n+        console.log('POST addStepToNew');\n+        setIsLoading(false);\n+      //} \n+    } catch (error) {\n+        let message = error.response.data.message;\n+        console.log('Error while adding load data step to new flow.', message);\n+        setIsLoading(false);\n+        handleError(error);\n+    } finally {\n+      resetSessionTime();\n+    }\n+  }\n+\n+  // POST load data step to existing flow\n+  const addStepToFlow = async (loadArtifactName, flowName) => {\n+    let stepToAdd = {\n+      \"name\": loadArtifactName,\n+      \"stepDefinitionName\": \"default-ingestion\",\n+      \"stepDefinitionType\": \"INGESTION\",\n+      options: {\n+        \"loadData\": { \n+          \"name\": loadArtifactName\n+        }\n+      }\n+    };\n+    try {\n+      setIsLoading(true);\n+      let url = '/api/flows/' + flowName + '/steps';\n+      let body = stepToAdd;\n+      let response = await axios.post(url, body);", "originalCommit": "f30208c4ea6a4f88d30b2b6c1e2e59256f9777ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYyNjM4Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411626387", "bodyText": "Refactoring will be done in separate story", "author": "srinathgit", "createdAt": "2020-04-20T19:15:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MzQ1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTY5NjQ3NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411696475", "bodyText": "Refactoring existing code can be part of a separate story. These are new API requests right?", "author": "bsrikan", "createdAt": "2020-04-20T21:14:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MzQ1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcwMTcwMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3843#discussion_r411701703", "bodyText": "Adding loadData, mapping and other artifacts to flow will all be using the same endpoint which will be created in that new refactoring storing .", "author": "srinathgit", "createdAt": "2020-04-20T21:23:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MzQ1Mg=="}], "type": "inlineReview"}, {"oid": "a9dbdc21554b96a126005975ec350341c27788a3", "url": "https://github.com/marklogic/marklogic-data-hub/commit/a9dbdc21554b96a126005975ec350341c27788a3", "message": "DHFPROD-3992: Add mouseover links to mapping card\n\nDHFPROD-3992: Get \"add step to flow\" working for mapping", "committedDate": "2020-04-20T19:02:38Z", "type": "commit"}, {"oid": "c4dacea0f74596cb2e1a443b1757b7ed116f4e14", "url": "https://github.com/marklogic/marklogic-data-hub/commit/c4dacea0f74596cb2e1a443b1757b7ed116f4e14", "message": "DHFPROD-3992:Backend work for running the mapping", "committedDate": "2020-04-20T19:13:23Z", "type": "commit"}, {"oid": "c4dacea0f74596cb2e1a443b1757b7ed116f4e14", "url": "https://github.com/marklogic/marklogic-data-hub/commit/c4dacea0f74596cb2e1a443b1757b7ed116f4e14", "message": "DHFPROD-3992:Backend work for running the mapping", "committedDate": "2020-04-20T19:13:23Z", "type": "forcePushed"}]}