{"pr_number": 4740, "pr_title": "DHFPROD-6051: The connector should point to java-client-api version 5.3", "pr_createdAt": "2020-10-20T18:12:53Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4740", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2OTY3MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4740#discussion_r508769670", "bodyText": "Don't we still need ingestEndpointState? Or is that not relevant at all to input-only endpoints?", "author": "rjrudin", "createdAt": "2020-10-20T19:01:25Z", "path": "marklogic-data-hub-spark-connector/src/test/java/com/marklogic/hub/spark/sql/sources/v2/Options.java", "diffHunk": "@@ -21,8 +21,7 @@\n     private String permissions;\n     private String sourceName;\n     private String sourceType;\n-    private JsonNode ingestWorkUnit;\n-    private JsonNode ingestEndpointState;\n+    private JsonNode ingestEndpointConstants;", "originalCommit": "c676f2518148ccf99243f3653e2d239b62f36820", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTA0MTUxMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4740#discussion_r509041513", "bodyText": "Done.", "author": "anu3990", "createdAt": "2020-10-21T07:15:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2OTY3MA=="}], "type": "inlineReview"}, {"oid": "73d369ca34b830400e0e6b5665b2879ab5829d2b", "url": "https://github.com/marklogic/marklogic-data-hub/commit/73d369ca34b830400e0e6b5665b2879ab5829d2b", "message": "DHFPROD-6051: The connector should point to java-client-api version - 5.3", "committedDate": "2020-10-21T07:10:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTMxNjgwOA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4740#discussion_r509316808", "bodyText": "This custom endpoint should still have endpointState in it; that's a critical part of verifying that if Ernie uses a custom endpoint, he can define both endpointState and endpointConstants in it.", "author": "rjrudin", "createdAt": "2020-10-21T14:05:34Z", "path": "marklogic-data-hub-spark-connector/src/test/resources/custom-ingestion-endpoint/endpoint.api", "diffHunk": "@@ -3,13 +3,7 @@\n     \"desc\": \"This is for testing a custom ingestion endpoint\",\n     \"params\": [\n         {\n-            \"name\": \"endpointState\",\n-            \"datatype\": \"jsonDocument\",\n-            \"multiple\": false,\n-            \"nullable\": true\n-        },\n-        {\n-            \"name\": \"workUnit\",\n+            \"name\": \"endpointConstants\",", "originalCommit": "73d369ca34b830400e0e6b5665b2879ab5829d2b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTMxNzA0MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4740#discussion_r509317040", "bodyText": "We still want to include this and test for it.", "author": "rjrudin", "createdAt": "2020-10-21T14:05:50Z", "path": "marklogic-data-hub-spark-connector/src/test/resources/custom-ingestion-endpoint/endpoint.sjs", "diffHunk": "@@ -20,13 +20,11 @@ declareUpdate();\n var endpointState;\n var input;\n \n-const state = fn.head(xdmp.fromJSON(endpointState));\n-const work = fn.head(xdmp.fromJSON(workUnit));\n+const work = fn.head(xdmp.fromJSON(endpointConstants));\n \n const doc = {\n   input: input,\n-  endpointState: state,\n-  workUnit: work", "originalCommit": "73d369ca34b830400e0e6b5665b2879ab5829d2b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTMxNzI1OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4740#discussion_r509317258", "bodyText": "We still want to verify that if Ernie has custom endpointState, his endpoint gets access to it.", "author": "rjrudin", "createdAt": "2020-10-21T14:06:07Z", "path": "marklogic-data-hub-spark-connector/src/test/java/com/marklogic/hub/spark/sql/sources/v2/WriteDataViaCustomEndpointTest.java", "diffHunk": "@@ -60,8 +60,7 @@ private void thenTheExpectedDocumentExists() {\n         assertEquals(\"apple\", doc.get(\"input\").get(\"fruitName\").asText(), message);\n         assertEquals(\"red\", doc.get(\"input\").get(\"fruitColor\").asText(), message);\n \n-        assertEquals(\"value\", doc.get(\"workUnit\").get(\"someString\").asText(), message);\n-        assertEquals(123, doc.get(\"workUnit\").get(\"someNumber\").asInt(), message);\n-        assertEquals(\"hello world\", doc.get(\"endpointState\").get(\"someState\").asText(), message);", "originalCommit": "73d369ca34b830400e0e6b5665b2879ab5829d2b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bab561baec6b5e1e362233824cb84dce7c8b7f42", "url": "https://github.com/marklogic/marklogic-data-hub/commit/bab561baec6b5e1e362233824cb84dce7c8b7f42", "message": "DHFPROD-6051: The connector should point to java-client-api version - 5.3", "committedDate": "2020-10-21T17:27:15Z", "type": "forcePushed"}, {"oid": "81ff21919bf2b041a37c0fca0363d4213be9ee79", "url": "https://github.com/marklogic/marklogic-data-hub/commit/81ff21919bf2b041a37c0fca0363d4213be9ee79", "message": "DHFPROD-6051: The connector should point to java-client-api version - 5.3", "committedDate": "2020-10-21T21:21:12Z", "type": "commit"}, {"oid": "81ff21919bf2b041a37c0fca0363d4213be9ee79", "url": "https://github.com/marklogic/marklogic-data-hub/commit/81ff21919bf2b041a37c0fca0363d4213be9ee79", "message": "DHFPROD-6051: The connector should point to java-client-api version - 5.3", "committedDate": "2020-10-21T21:21:12Z", "type": "forcePushed"}]}