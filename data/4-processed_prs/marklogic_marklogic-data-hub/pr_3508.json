{"pr_number": 3508, "pr_title": "DHFPROD-4222:Create endpoints for getting all flows, all steps in a flow", "pr_createdAt": "2020-01-27T04:37:58Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3508", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MTIzNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3508#discussion_r371241235", "bodyText": "Shouldn't this method be on FlowManager? FlowManager has knowledge of how to read files and get flow names, so I think it should know how to return a list of flows as well (and sort them too).", "author": "rjrudin", "createdAt": "2020-01-27T13:33:51Z", "path": "one-ui/src/main/java/com/marklogic/hub/curation/services/FlowManagerService.java", "diffHunk": "@@ -100,6 +99,30 @@ public void deleteFlow(String flowName) {\n         flowManager.deleteFlow(flowName);\n     }\n \n+    public List<Flow> getFlows() {", "originalCommit": "b795cd0de81138bae215262c190e61aca0af3aee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjE3Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3508#discussion_r371242172", "bodyText": "What's the point of having separate Step and StepModel classes? This seems confusing and is unnecessary work of having to translate between the two.\nAlso, couldn't a \"getFlow\" method just return a JsonNode, in which case this method isn't even needed?\nIsn't life a lot easier if we just pass JSON around??", "author": "rjrudin", "createdAt": "2020-01-27T13:35:55Z", "path": "one-ui/src/main/java/com/marklogic/hub/curation/services/FlowManagerService.java", "diffHunk": "@@ -100,6 +99,30 @@ public void deleteFlow(String flowName) {\n         flowManager.deleteFlow(flowName);\n     }\n \n+    public List<Flow> getFlows() {\n+        List<String> flowNames = flowManager.getFlowNames();\n+        List<Flow> flows = new ArrayList<>();\n+        flowNames.forEach((flowName)->{\n+            flows.add(getFlow(flowName));\n+        });\n+        Collections.sort(flows, (a, b) -> a.getName().compareTo(b.getName()));\n+        return flows;\n+    }\n+\n+    public List<StepModel> getSteps(String flowName) {", "originalCommit": "b795cd0de81138bae215262c190e61aca0af3aee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTMyNDg4MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3508#discussion_r371324880", "bodyText": "The UI doesn't know anything about step definition. So, when some one creates a custom step, we have to create a custom step definition, main.sjs in addition to the step itself that goes inside the flow. So, the core and web models for steps are different, webModel (called StepModel.java) has 'modulePath' which provides the uri of the main.sjs\nwhereas it is not present in the core step model (Step.java). This is all inherited from 5.0 code codebase .", "author": "srinathgit", "createdAt": "2020-01-27T15:57:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjE3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ0NTczMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3508#discussion_r371445733", "bodyText": "@rjrudin As to the comment about using JsonNode, the goal is to move to generic JSON in most cases. I think Flows/Steps are unique given the need for Java to really understand the values for ingestion, so I think that is an outside case where it is better to have solid classes with a more rigid schema.", "author": "ryanjdew", "createdAt": "2020-01-27T19:46:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjE3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ4NzM4Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3508#discussion_r371487383", "bodyText": "I don't understand why the UI doesn't know anything about a step definition. \"Step\" and \"Step Definition\" are distinct concepts in the DHF domain model; a client should understand both of them.\nIs \"StepModel\" really a synonym for \"StepDefinition\"? If so, can StepModel be renamed to StepDefinition?\nI think the core problem here is if someone looks at the Step and StepModel classes, there's no way to know why they both exist. Perhaps the immediate solution is class comments to explain what concept each class represents, and in the StepModel case, why it differs from Step. Those can be in a separate PR; I'll stand down on this point for now.", "author": "rjrudin", "createdAt": "2020-01-27T21:18:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI0MjE3Mg=="}], "type": "inlineReview"}, {"oid": "8a0e75643ff85d816c6ba2032f2568036f9a38e3", "url": "https://github.com/marklogic/marklogic-data-hub/commit/8a0e75643ff85d816c6ba2032f2568036f9a38e3", "message": "DHFPROD-4222:Create endpoints for getting all flows, all steps in a flow", "committedDate": "2020-01-27T19:27:32Z", "type": "commit"}, {"oid": "8a0e75643ff85d816c6ba2032f2568036f9a38e3", "url": "https://github.com/marklogic/marklogic-data-hub/commit/8a0e75643ff85d816c6ba2032f2568036f9a38e3", "message": "DHFPROD-4222:Create endpoints for getting all flows, all steps in a flow", "committedDate": "2020-01-27T19:27:32Z", "type": "forcePushed"}]}