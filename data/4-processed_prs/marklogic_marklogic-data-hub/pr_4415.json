{"pr_number": 4415, "pr_title": "DHFPROD-5666:Create \"matching\" and \"merging\" steps, add them to flow", "pr_createdAt": "2020-08-17T06:25:43Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4415", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI1NjAxMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4415#discussion_r471256013", "bodyText": "@rdew, @rjrudin\nShould 'artifactName' be added to the \"collections\" array ?", "author": "srinathgit", "createdAt": "2020-08-17T06:27:48Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/artifacts/merging.sjs", "diffHunk": "@@ -65,14 +65,33 @@ function validateArtifact(artifact) {\n function defaultArtifact(artifactName) {\n   const defaultPermissions = 'data-hub-common,read,data-hub-common,update';\n   return {\n-    artifactName,\n-    collections: ['default-mastering'],\n-    additionalCollections: [],\n+    batchSize: 100,\n+    threadCount: 1,\n     sourceDatabase: dataHub.config.FINALDATABASE,\n     targetDatabase: dataHub.config.FINALDATABASE,\n-    provenanceGranularityLevel: 'coarse',\n     permissions: defaultPermissions,\n-    batchSize: 100\n+    targetEntity: \"Change this to a valid entity type name; e.g. Customer\",\n+    sourceQuery: \"cts.collectionQuery('mastering-summary')\",\n+    collections: [", "originalCommit": "1609171dd3c8b3a665de21910948bdb29bca1ae1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQzNjQxNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4415#discussion_r471436415", "bodyText": "I defer to @ryanjdew on that.", "author": "rjrudin", "createdAt": "2020-08-17T12:12:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI1NjAxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyMjcyMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4415#discussion_r471622723", "bodyText": "@srinathgit No. For merging, an empty array is best since the merging will set collections appropriately on a per dcoument basis.", "author": "ryanjdew", "createdAt": "2020-08-17T17:08:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI1NjAxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU2MDMyNA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4415#discussion_r471560324", "bodyText": "I dont think we generate a curated document with this collection. Should this also be changed to read something like:\n\"cts.collectionQuery('Change this to a valid collection name; e.g. Customer')\" ?", "author": "bsrikan", "createdAt": "2020-08-17T15:31:40Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/artifacts/matching.sjs", "diffHunk": "@@ -65,14 +65,43 @@ function validateArtifact(artifact) {\n function defaultArtifact(artifactName) {\n   const defaultPermissions = 'data-hub-common,read,data-hub-common,update';\n   return {\n-    artifactName,\n-    collections: ['default-mastering'],\n-    additionalCollections: [],\n+    batchSize: 100,\n+    threadCount: 1,\n     sourceDatabase: dataHub.config.FINALDATABASE,\n     targetDatabase: dataHub.config.FINALDATABASE,\n-    provenanceGranularityLevel: 'coarse',\n+    targetEntity: \"Change this to a valid entity type name; e.g. Customer\",\n+    sourceQuery: \"cts.collectionQuery('default-mapping')\",", "originalCommit": "1609171dd3c8b3a665de21910948bdb29bca1ae1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4OTk3NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4415#discussion_r471589975", "bodyText": "As per the story, the values should be from defaultFlow.flow.json; nevertheless I think this can be changed.\n@ryanjdew ,\nCan you please weigh in on this as well ?", "author": "srinathgit", "createdAt": "2020-08-17T16:17:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU2MDMyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYyNDc4NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4415#discussion_r471624785", "bodyText": "@bsrikan Is correct. We should adjust this as a value for the user to change.", "author": "ryanjdew", "createdAt": "2020-08-17T17:10:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU2MDMyNA=="}], "type": "inlineReview"}, {"oid": "49205de0bad91d7d7342b2352d4d80bfa947e593", "url": "https://github.com/marklogic/marklogic-data-hub/commit/49205de0bad91d7d7342b2352d4d80bfa947e593", "message": "DHFPROD-5666:Create \"matching\" and \"merging\" steps, add them to flow", "committedDate": "2020-08-17T17:19:06Z", "type": "commit"}, {"oid": "49205de0bad91d7d7342b2352d4d80bfa947e593", "url": "https://github.com/marklogic/marklogic-data-hub/commit/49205de0bad91d7d7342b2352d4d80bfa947e593", "message": "DHFPROD-5666:Create \"matching\" and \"merging\" steps, add them to flow", "committedDate": "2020-08-17T17:19:06Z", "type": "forcePushed"}]}