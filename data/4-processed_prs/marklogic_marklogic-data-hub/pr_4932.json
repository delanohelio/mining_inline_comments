{"pr_number": 4932, "pr_title": "DHFPROD-6304: Update the java client api to version 5.3.2", "pr_createdAt": "2020-12-02T23:11:53Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4932", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzQ5NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4932#discussion_r534547495", "bodyText": "I don't think this is needed here and web/build.gradle  but it's going to be deleted, so I think it's fine for now.", "author": "srinathgit", "createdAt": "2020-12-02T23:16:10Z", "path": "ml-data-hub-plugin/build.gradle", "diffHunk": "@@ -49,6 +49,8 @@ repositories {\n     mavenCentral()\n     maven { url 'http://repo.spring.io/milestone' }\n     maven { url 'http://developer.marklogic.com/maven2' }\n+    //ToDo: Remove this once java-client-api-5.3.2 is released\n+    maven {url 'http://distro.marklogic.com/nexus/repository/maven-releases/'}", "originalCommit": "8e96bab797738ab1b69983a70afd7eddb0a7b600", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0ODA0Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4932#discussion_r534548043", "bodyText": "If I don't add the repo, QS is not getting compiled.", "author": "SameeraPriyathamTadikonda", "createdAt": "2020-12-02T23:17:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU0NzQ5NQ=="}], "type": "inlineReview"}, {"oid": "e1c6979ea4df5c76ea12249ea3837ff39d4ceab7", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e1c6979ea4df5c76ea12249ea3837ff39d4ceab7", "message": "excluding the kotlin jar", "committedDate": "2020-12-03T00:00:34Z", "type": "forcePushed"}, {"oid": "30349ffa9b756dde456e2b95cc2d1ea76ceb69f4", "url": "https://github.com/marklogic/marklogic-data-hub/commit/30349ffa9b756dde456e2b95cc2d1ea76ceb69f4", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0", "committedDate": "2020-12-03T02:46:49Z", "type": "forcePushed"}, {"oid": "0487cd15a2c6c54d5871d97495eeb7096ab94b65", "url": "https://github.com/marklogic/marklogic-data-hub/commit/0487cd15a2c6c54d5871d97495eeb7096ab94b65", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0", "committedDate": "2020-12-03T03:01:33Z", "type": "forcePushed"}, {"oid": "e345ed4187abe15d27be9bd4ac9356ebfac9bb95", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e345ed4187abe15d27be9bd4ac9356ebfac9bb95", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0", "committedDate": "2020-12-03T06:56:42Z", "type": "forcePushed"}, {"oid": "0fbc9e015c35cadc407306212fccb47f9e65b088", "url": "https://github.com/marklogic/marklogic-data-hub/commit/0fbc9e015c35cadc407306212fccb47f9e65b088", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0", "committedDate": "2020-12-03T07:08:46Z", "type": "forcePushed"}, {"oid": "9e9e4986d2a950700c0ac4c66939962ccd1ad757", "url": "https://github.com/marklogic/marklogic-data-hub/commit/9e9e4986d2a950700c0ac4c66939962ccd1ad757", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0", "committedDate": "2020-12-03T07:24:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIyNzg2Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4932#discussion_r535227863", "bodyText": "This still needs to be 3.16.3 - can't go to 4.x because it requires Java 9. Be sure to test out the DHF Gradle plugin on one of the example projects after making the changes here, and be sure to run Java 8, as that's what DHF 5.2.x supports.", "author": "rjrudin", "createdAt": "2020-12-03T13:29:52Z", "path": "marklogic-data-hub/build.gradle", "diffHunk": "@@ -32,17 +35,32 @@ ext.junitPlatformVersion = '1.4.0'\n ext.junitJupiterVersion  = '5.4.0'\n \n dependencies {\n-    compile 'com.marklogic:marklogic-client-api:4.2.0'\n-    compile('com.marklogic:ml-app-deployer:3.16.3'){\n+    // Forcing use of 1.3.71 - which is what OkHttp 4.7.2 wants, which is what Java Client 5.3 uses - so that 1.2.x\n+    // versions don't come onto the classpath\n+    compile \"org.jetbrains.kotlin:kotlin-stdlib:1.3.71\"\n+    compile \"org.jetbrains.kotlin:kotlin-stdlib-common:1.3.71\"\n+    compile ('com.marklogic:marklogic-client-api:5.3.2'){\n+        exclude group: 'com.fasterxml.woodstox', module: 'woodstox-core'\n+        // Oddly, the OkHttp 4.4.0 dependency includes version 1.2.70 and 1.3.x of these dependencies. This causes\n+        // class conflict errors. So they're excluded from here, and we force inclusion of 1.3.x below.\n+        exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib'\n+        exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib-common'\n+    }\n+    compile('com.marklogic:ml-app-deployer:4.1.0'){", "originalCommit": "9e9e4986d2a950700c0ac4c66939962ccd1ad757", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIyNzk1OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4932#discussion_r535227959", "bodyText": "Can't upgrade this either", "author": "rjrudin", "createdAt": "2020-12-03T13:30:00Z", "path": "marklogic-data-hub/build.gradle", "diffHunk": "@@ -32,17 +35,32 @@ ext.junitPlatformVersion = '1.4.0'\n ext.junitJupiterVersion  = '5.4.0'\n \n dependencies {\n-    compile 'com.marklogic:marklogic-client-api:4.2.0'\n-    compile('com.marklogic:ml-app-deployer:3.16.3'){\n+    // Forcing use of 1.3.71 - which is what OkHttp 4.7.2 wants, which is what Java Client 5.3 uses - so that 1.2.x\n+    // versions don't come onto the classpath\n+    compile \"org.jetbrains.kotlin:kotlin-stdlib:1.3.71\"\n+    compile \"org.jetbrains.kotlin:kotlin-stdlib-common:1.3.71\"\n+    compile ('com.marklogic:marklogic-client-api:5.3.2'){\n+        exclude group: 'com.fasterxml.woodstox', module: 'woodstox-core'\n+        // Oddly, the OkHttp 4.4.0 dependency includes version 1.2.70 and 1.3.x of these dependencies. This causes\n+        // class conflict errors. So they're excluded from here, and we force inclusion of 1.3.x below.\n+        exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib'\n+        exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib-common'\n+    }\n+    compile('com.marklogic:ml-app-deployer:4.1.0'){\n         exclude group: 'org.springframework', module: 'http'\n+        // prefer the version declared above\n+        exclude group: 'com.marklogic', module: 'marklogic-client-api'\n     }\n \n     compile group: 'org.springframework.boot', name: 'spring-boot', version: '2.1.3.RELEASE'\n     compile group: 'org.springframework.integration', name: 'spring-integration-http', version: '5.1.3.RELEASE'\n     compile group: 'org.springframework.boot', name: 'spring-boot-autoconfigure', version: '2.1.3.RELEASE'\n \n     compile 'com.marklogic:mlcp-util:0.9.0'\n-    compile 'com.marklogic:marklogic-data-movement-components:1.0'\n+    compile ('com.marklogic:marklogic-data-movement-components:2.2.0'){", "originalCommit": "9e9e4986d2a950700c0ac4c66939962ccd1ad757", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIyODMxMQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4932#discussion_r535228311", "bodyText": "Shouldn't need this once you're back to 3.16.3", "author": "rjrudin", "createdAt": "2020-12-03T13:30:29Z", "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/deploy/commands/GenerateHubTDETemplateCommand.java", "diffHunk": "@@ -74,7 +74,7 @@ public void execute(CommandContext context) {\n \n             if (!entityNameFileMap.isEmpty()) {\n                 logger.warn(\"About to generate a template for the following entities: {} into directory {} \",\n-                    this.entityNamesList.isEmpty() ? entityNameFileMap.keySet() : this.entityNamesList, hubConfig.getAppConfig().getSchemasPath());\n+                    this.entityNamesList.isEmpty() ? entityNameFileMap.keySet() : this.entityNamesList, hubConfig.getAppConfig().getSchemaPaths());", "originalCommit": "9e9e4986d2a950700c0ac4c66939962ccd1ad757", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c60d36fe6305ee1ed196565293fef408a85ae834", "url": "https://github.com/marklogic/marklogic-data-hub/commit/c60d36fe6305ee1ed196565293fef408a85ae834", "message": "Upgrading to gradle 5.6.4", "committedDate": "2020-12-03T19:00:26Z", "type": "forcePushed"}, {"oid": "eb057530b2f153d1fdac4fac22910a5a04206168", "url": "https://github.com/marklogic/marklogic-data-hub/commit/eb057530b2f153d1fdac4fac22910a5a04206168", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0\n\nUpgrading to gradle 5.6.4\n\nadding kotlin", "committedDate": "2020-12-03T23:37:20Z", "type": "forcePushed"}, {"oid": "70921c72413ceb0c793d56b523bd30d207626d28", "url": "https://github.com/marklogic/marklogic-data-hub/commit/70921c72413ceb0c793d56b523bd30d207626d28", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0\n\nUpgrading to gradle 5.6.4\n\nadding kotlin", "committedDate": "2020-12-03T23:42:06Z", "type": "commit"}, {"oid": "70921c72413ceb0c793d56b523bd30d207626d28", "url": "https://github.com/marklogic/marklogic-data-hub/commit/70921c72413ceb0c793d56b523bd30d207626d28", "message": "DHFPROD-6304: Upgrading to Javaclient 5.3.0\n\nUpgrading to gradle 5.6.4\n\nadding kotlin", "committedDate": "2020-12-03T23:42:06Z", "type": "forcePushed"}]}