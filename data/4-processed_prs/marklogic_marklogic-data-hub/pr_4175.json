{"pr_number": 4175, "pr_title": "DHFPROD-4661: Verify custom steps can be run", "pr_createdAt": "2020-06-30T19:52:17Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4175", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAzOTM1Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4175#discussion_r448039352", "bodyText": "Can you add a property to the step and confirm that it is available in 'options' in the module ?", "author": "srinathgit", "createdAt": "2020-06-30T23:46:04Z", "path": "marklogic-data-hub-central/src/test/resources/test-projects/run-flow-test/modules/root/custom-modules/custom/testStep.sjs", "diffHunk": "@@ -0,0 +1,11 @@\n+'use strict';\n+\n+function main(content, options) {\n+    const valueObj = content.value.toObject();", "originalCommit": "b4ecfe70e3e5083e3dcad44907ebbd5c7a3e7a89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAzOTYyMg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4175#discussion_r448039622", "bodyText": "Can this line 162 be removed as it seems to be duplicate of 159 ?", "author": "srinathgit", "createdAt": "2020-06-30T23:47:00Z", "path": "marklogic-data-hub-central/src/test/java/com/marklogic/hub/central/controllers/FlowControllerTest.java", "diffHunk": "@@ -146,6 +145,46 @@ void test() throws Exception {\n             });\n     }\n \n+    @Test\n+    void testCustomStepRun() throws Exception {\n+        runAsDataHubDeveloper();\n+        installProjectInFolder(\"test-projects/run-flow-test\");\n+\n+        loginAsTestUserWithRoles(\"hub-central-step-runner\");\n+\n+        final String flowName = \"testFlow\";\n+        final String flowPath = PATH + \"/\" + flowName;\n+\n+        // Run the step\n+        flowController.setFlowRunnerConsumer((FlowRunner::awaitCompletion));\n+        MockMultipartFile file1 = new MockMultipartFile(\"files\",\"file1.json\", MediaType.APPLICATION_JSON, \"{\\\"name\\\": \\\"Joe\\\"}\".getBytes(StandardCharsets.UTF_8));\n+        MockMultipartFile file2 = new MockMultipartFile(\"files\",\"file2.json\", MediaType.APPLICATION_JSON, \"{\\\"name\\\": \\\"John\\\"}\".getBytes(StandardCharsets.UTF_8));\n+        flowController.setFlowRunnerConsumer((FlowRunner::awaitCompletion));", "originalCommit": "b4ecfe70e3e5083e3dcad44907ebbd5c7a3e7a89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "93de599f766e7cfb6073afe00e100c5f0498d532", "url": "https://github.com/marklogic/marklogic-data-hub/commit/93de599f766e7cfb6073afe00e100c5f0498d532", "message": "DHFPROD-4661: Verify custom steps can be run", "committedDate": "2020-07-01T19:15:30Z", "type": "commit"}, {"oid": "93de599f766e7cfb6073afe00e100c5f0498d532", "url": "https://github.com/marklogic/marklogic-data-hub/commit/93de599f766e7cfb6073afe00e100c5f0498d532", "message": "DHFPROD-4661: Verify custom steps can be run", "committedDate": "2020-07-01T19:15:30Z", "type": "forcePushed"}]}