{"pr_number": 4857, "pr_title": "DHFPROD-6244:Create match and merge step in the new format by default", "pr_createdAt": "2020-11-12T21:01:06Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4857", "timeline": [{"oid": "40869165f685256026b9f874ef0d352e09973e9c", "url": "https://github.com/marklogic/marklogic-data-hub/commit/40869165f685256026b9f874ef0d352e09973e9c", "message": "DHFPROD-6244:Create match and merge step in the new format by default", "committedDate": "2020-11-12T20:58:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzMzA1Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4857#discussion_r522433052", "bodyText": "This change is backing out the changes that I just made for DHFPROD-6178 and -6179, so that the match and merge options are created in either the old or new format depending on the roles of the user. Do we not want to support the creation of QuickStart-compatible steps?", "author": "fsnow", "createdAt": "2020-11-12T21:20:06Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/artifacts/matching.sjs", "diffHunk": "@@ -78,40 +77,8 @@ function defaultArtifact(artifactName) {\n     permissions: defaultPermissions,\n     targetFormat: \"json\"\n   };\n-\n-  if (Security.currentUserHasRole(\"hub-central-match-merge-writer\")) {\n-    artifact[\"matchRulesets\"] = artifact.matchRulesets || [];\n-    artifact[\"thresholds\"] = artifact.thresholds || [];\n-  }\n-  else {\n-    artifact[\"matchOptions\"] = {\n-      dataFormat: \"json\",\n-      propertyDefs: {\n-        property: []\n-      },\n-      algorithms: {\n-        algorithm: []\n-      },\n-      collections: {\n-        content: []\n-      },\n-      scoring: {\n-        add: [],\n-        expand: [],\n-        reduce: []\n-      },\n-      actions: {\n-        action: []\n-      },\n-      thresholds: {\n-        threshold: []\n-      },\n-      tuning: {\n-        maxScan: 200\n-      }\n-    }\n-  }\n-", "originalCommit": "40869165f685256026b9f874ef0d352e09973e9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzODIzMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4857#discussion_r522438233", "bodyText": "While working on test failures in 9.0-x, we realized that when a step is created in QS, it doesn't follow this codepath. This codepath is meant for creating steps either in HC or using hubCreateStep (which creates step in HC format);  so we might as well create the steps in the new format", "author": "srinathgit", "createdAt": "2020-11-12T21:30:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjQzMzA1Mg=="}], "type": "inlineReview"}]}