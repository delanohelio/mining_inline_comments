{"pr_number": 4829, "pr_title": "DHFPROD-5613: fixed save button consistency", "pr_createdAt": "2020-11-05T16:14:13Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4829", "timeline": [{"oid": "100b1bf2df463269ca36a7758403196f9e4ba151", "url": "https://github.com/marklogic/marklogic-data-hub/commit/100b1bf2df463269ca36a7758403196f9e4ba151", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-05T17:20:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODMzOTIwNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518339205", "bodyText": "Looks like there is a cypress failure on this line. Please modify the code to be\nloadPage.saveButton().should('be.enabled');\nThat should fix it.", "author": "briantang", "createdAt": "2020-11-05T20:18:09Z", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/curation/curate/mapping.spec.tsx", "diffHunk": "@@ -41,6 +41,7 @@ describe('Mapping', () => {\n     toolbar.getLoadToolbarIcon().click();\n     cy.waitUntil(() => loadPage.stepName('ingestion-step').should('be.visible'));\n     loadPage.addNewButton('card').click();\n+    loadPage.saveButton.should('be.enabled');", "originalCommit": "100b1bf2df463269ca36a7758403196f9e4ba151", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM4MDMxOQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518380319", "bodyText": "thanks", "author": "jyangML", "createdAt": "2020-11-05T21:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODMzOTIwNQ=="}], "type": "inlineReview"}, {"oid": "71bde1e05d0350d9077365f074a03b7e22fb5e98", "url": "https://github.com/marklogic/marklogic-data-hub/commit/71bde1e05d0350d9077365f074a03b7e22fb5e98", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-05T21:29:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxMTUyMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518411520", "bodyText": "Seems like we already have a boolean flag for mapName as \"isMapNameTouched\" which we can leverage to see of mapName has ever been modified or not. Same goes for other mandatory fields in the form.\nI would suggest to just utilize the required field values and the corresponding '...touched' fields to get the desired output instead of creating additional flags.", "author": "xnikhil08", "createdAt": "2020-11-05T22:35:07Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/create-edit-mapping-dialog/create-edit-mapping-dialog.tsx", "diffHunk": "@@ -17,11 +17,14 @@ const CreateEditMappingDialog = (props) => {\n   const [selectedSource, setSelectedSource] = useState(props.mapData && props.mapData != {} ? props.mapData.selectedSource : 'collection')\n   const [srcQuery, setSrcQuery] = useState(props.mapData && props.mapData != {} ? props.mapData.sourceQuery : '');\n   const [isQuerySelected, setIsQuerySelected] = useState(false);\n+\n   //To check submit validity\n   const [isMapNameTouched, setMapNameTouched] = useState(false);\n+  const [isNameMissingOnSave, setNameMissingOnSave] = useState(false);", "originalCommit": "71bde1e05d0350d9077365f074a03b7e22fb5e98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NTE4NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518875185", "bodyText": "Fixed!", "author": "jyangML", "createdAt": "2020-11-06T16:48:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxMTUyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxMTc5NA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518411794", "bodyText": "Same suggestion as given for mapName earlier.", "author": "xnikhil08", "createdAt": "2020-11-05T22:35:42Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/create-edit-mapping-dialog/create-edit-mapping-dialog.tsx", "diffHunk": "@@ -17,11 +17,14 @@ const CreateEditMappingDialog = (props) => {\n   const [selectedSource, setSelectedSource] = useState(props.mapData && props.mapData != {} ? props.mapData.selectedSource : 'collection')\n   const [srcQuery, setSrcQuery] = useState(props.mapData && props.mapData != {} ? props.mapData.sourceQuery : '');\n   const [isQuerySelected, setIsQuerySelected] = useState(false);\n+\n   //To check submit validity\n   const [isMapNameTouched, setMapNameTouched] = useState(false);\n+  const [isNameMissingOnSave, setNameMissingOnSave] = useState(false);\n   const [isDescriptionTouched, setDescriptionTouched] = useState(false);\n   const [isCollectionsTouched, setCollectionsTouched] = useState(false);\n   const [isSrcQueryTouched, setSrcQueryTouched] = useState(false);\n+  const [isQueryMissingOnSave, setQueryMissingOnSave] = useState(false);", "originalCommit": "71bde1e05d0350d9077365f074a03b7e22fb5e98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NTIzNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518875236", "bodyText": "Fixed!", "author": "jyangML", "createdAt": "2020-11-06T16:48:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxMTc5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxNDEwNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518414106", "bodyText": "Looks like we can update the existing onSubmit function only with an if condition like given below and get rid of this onSave function.\nif(mapName && (collections || srcQuery)) {\n// Current logic within onSubmit\n} else {\n//Just set the corresponding '~touched' flags for the properties for example isMapNameTouched as true.\n}", "author": "xnikhil08", "createdAt": "2020-11-05T22:41:05Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/create-edit-mapping-dialog/create-edit-mapping-dialog.tsx", "diffHunk": "@@ -136,6 +140,27 @@ const CreateEditMappingDialog = (props) => {\n     </div>\n   </Modal>;\n \n+  const onSave = async (event) => {", "originalCommit": "71bde1e05d0350d9077365f074a03b7e22fb5e98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NTM3Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r518875372", "bodyText": "I added all the changes you suggested.  Thanks for the feedback!", "author": "jyangML", "createdAt": "2020-11-06T16:48:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxNDEwNg=="}], "type": "inlineReview"}, {"oid": "6c35556ea395959402288cf83b5855c180f3ec03", "url": "https://github.com/marklogic/marklogic-data-hub/commit/6c35556ea395959402288cf83b5855c180f3ec03", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-06T16:46:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTAzMzA2OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519033069", "bodyText": "It seems we want to check here if srcQuery has a value or not but used 'collections' again in the 'if' condition.\nThe conditions in line 161 and 165 looks the same and redundant.", "author": "xnikhil08", "createdAt": "2020-11-06T22:17:55Z", "path": "marklogic-data-hub-central/ui/src/components/entities/create-edit-step-dialog/create-edit-step-dialog.tsx", "diffHunk": "@@ -149,9 +149,30 @@ const CreateEditStepDialog: React.FC<Props>  = (props) => {\n   const confirmAction = () => {\n     toggleConfirmModal(false);\n     props.toggleModal(false);\n+\n+    resetTouchedValues()\n   };\n \n   const handleSubmit = async (event: { preventDefault: () => void; }) => {\n+    if (!stepName) {\n+      // missing name\n+      setStepNameTouched(true);\n+    }\n+    if ((!collections && selectedSource === 'collection') || (!srcQuery && selectedSource !== 'collection')) {\n+      // missing collection (if collection is selected)\n+      setCollectionsTouched(true);\n+    }\n+    if ((!collections && selectedSource === 'collection') || (!srcQuery && selectedSource !== 'collection')) {", "originalCommit": "6c35556ea395959402288cf83b5855c180f3ec03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg5MjU3Ng==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519892576", "bodyText": "Oops.  That was a mistake.  Glad you caught it.  Fixed now", "author": "jyangML", "createdAt": "2020-11-09T15:20:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTAzMzA2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA0MDM2Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519040363", "bodyText": "Let's verify all the mandatory fields in one test only to avoid unnecessary re-renders of CreateEditStepDialog component in a separate test, wherever possible. We can describe the test heading may be like \"Verify clicking 'Save' with no value for mandatory fields show error\" and then just do your assertions like below:-\nSet a non-null value for name.\nverify if error for collection field appears on clicking \"save\".\nReset name value to empty('') and set valid collection value.\nClick on save button and verify if error for name field is available in the document or not.", "author": "xnikhil08", "createdAt": "2020-11-06T22:39:49Z", "path": "marklogic-data-hub-central/ui/src/components/entities/create-edit-step-dialog/create-edit-step-dialog.test.tsx", "diffHunk": "@@ -63,9 +64,39 @@ describe('Create Edit Step Dialog component', () => {\n \n         fireEvent.change(nameInput, { target: {value: ''}});\n         expect(getByText('Name is required')).toBeInTheDocument();\n-        expect(saveButton).toBeDisabled();\n+        expect(saveButton).toBeEnabled();\n+    });\n+\n+    test('Verify clicking \"Save\" with no collection shows error', async () => {\n+      const { getByText, getByLabelText, getByPlaceholderText } = render(<CreateEditStepDialog {...data.newMerging} />);\n+\n+      fireEvent.change(getByPlaceholderText('Enter name'), { target: {value: ''}});\n+  \n+      fireEvent.click(getByText('Save'));\n+  \n+      // both messages should show when both boxes are empty\n+      expect(getByText('Name is required')).toBeInTheDocument();", "originalCommit": "6c35556ea395959402288cf83b5855c180f3ec03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg5MjkxMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519892910", "bodyText": "Squashed all the new tests together.", "author": "jyangML", "createdAt": "2020-11-09T15:20:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA0MDM2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA0MTEyOA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519041128", "bodyText": "This test can be clubbed together with the previous one for collection as the expect statements are more or less the same and would avoid a re-render of the component to improve test performance.\nCheck my previous comment.", "author": "xnikhil08", "createdAt": "2020-11-06T22:41:57Z", "path": "marklogic-data-hub-central/ui/src/components/entities/create-edit-step-dialog/create-edit-step-dialog.test.tsx", "diffHunk": "@@ -63,9 +64,39 @@ describe('Create Edit Step Dialog component', () => {\n \n         fireEvent.change(nameInput, { target: {value: ''}});\n         expect(getByText('Name is required')).toBeInTheDocument();\n-        expect(saveButton).toBeDisabled();\n+        expect(saveButton).toBeEnabled();\n+    });\n+\n+    test('Verify clicking \"Save\" with no collection shows error', async () => {\n+      const { getByText, getByLabelText, getByPlaceholderText } = render(<CreateEditStepDialog {...data.newMerging} />);\n+\n+      fireEvent.change(getByPlaceholderText('Enter name'), { target: {value: ''}});\n+  \n+      fireEvent.click(getByText('Save'));\n+  \n+      // both messages should show when both boxes are empty\n+      expect(getByText('Name is required')).toBeInTheDocument();\n+      expect(getByText('Collection or Query is required')).toBeInTheDocument();\n     });\n \n+    test('Verify clicking \"Save\" with no name shows error', async () => {", "originalCommit": "6c35556ea395959402288cf83b5855c180f3ec03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg5MzEyOA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519893128", "bodyText": "fixed", "author": "jyangML", "createdAt": "2020-11-09T15:21:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA0MTEyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA0MTkxNA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519041914", "bodyText": "Same as my earlier comment. We can club these tests for errors in name and collection field together here as well, to avoid re-renders.", "author": "xnikhil08", "createdAt": "2020-11-06T22:44:22Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/create-edit-mapping-dialog/create-edit-mapping-dialog.test.tsx", "diffHunk": "@@ -151,6 +151,46 @@ describe('Create/Edit Mapping Step artifact component', () => {\n \n   });\n \n+  test('Verify clicking \"Save\" with neither name nor collection shows error', () => {\n+    const { getByText, getByLabelText, getByPlaceholderText } = render(<CreateEditMappingDialog {...data.newMap} />);\n+\n+    fireEvent.click(getByText('Save'));\n+\n+    // both messages should show when both boxes are empty\n+    expect(getByText('Name is required')).toBeInTheDocument(); \n+    expect(getByText('Collection or Query is required')).toBeInTheDocument();\n+  });\n+\n+  test('Verify clicking \"Save\" with name but no collection shows error', () => {", "originalCommit": "6c35556ea395959402288cf83b5855c180f3ec03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg5Mjk4OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r519892988", "bodyText": "fixed", "author": "jyangML", "createdAt": "2020-11-09T15:20:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA0MTkxNA=="}], "type": "inlineReview"}, {"oid": "5e85112becfdf97b1490c71d329db4545443b2ad", "url": "https://github.com/marklogic/marklogic-data-hub/commit/5e85112becfdf97b1490c71d329db4545443b2ad", "message": "added fix for comments", "committedDate": "2020-11-09T15:03:46Z", "type": "forcePushed"}, {"oid": "4ea6789f93a345532bb8d4aa85d11b648ec27ab4", "url": "https://github.com/marklogic/marklogic-data-hub/commit/4ea6789f93a345532bb8d4aa85d11b648ec27ab4", "message": "fix", "committedDate": "2020-11-09T15:02:37Z", "type": "forcePushed"}, {"oid": "6c35556ea395959402288cf83b5855c180f3ec03", "url": "https://github.com/marklogic/marklogic-data-hub/commit/6c35556ea395959402288cf83b5855c180f3ec03", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-06T16:46:59Z", "type": "forcePushed"}, {"oid": "6c35556ea395959402288cf83b5855c180f3ec03", "url": "https://github.com/marklogic/marklogic-data-hub/commit/6c35556ea395959402288cf83b5855c180f3ec03", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-06T16:46:59Z", "type": "forcePushed"}, {"oid": "c5f11860e084c70ebcccb257408a587efe16bf5a", "url": "https://github.com/marklogic/marklogic-data-hub/commit/c5f11860e084c70ebcccb257408a587efe16bf5a", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-09T15:18:19Z", "type": "forcePushed"}, {"oid": "8753f3808eed8efb97264c1f8906c5855e8de979", "url": "https://github.com/marklogic/marklogic-data-hub/commit/8753f3808eed8efb97264c1f8906c5855e8de979", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-09T16:58:13Z", "type": "forcePushed"}, {"oid": "db126b5047a35268fc6f88549e569cd87b524eda", "url": "https://github.com/marklogic/marklogic-data-hub/commit/db126b5047a35268fc6f88549e569cd87b524eda", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-09T22:02:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwMTUxNA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520201514", "bodyText": "Remove this comment since the Save button now is always enabled. Similarly, remove comments on lines: 49, 70, 85, 89", "author": "wooldridge", "createdAt": "2020-11-10T00:09:54Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/create-edit-mapping-dialog/create-edit-mapping-dialog.test.tsx", "diffHunk": "@@ -22,21 +22,21 @@ describe('Create/Edit Mapping Step artifact component', () => {\n     expect(getByLabelText('Collection')).toBeInTheDocument();\n     expect(getByLabelText('Query')).toBeInTheDocument();\n     expect(getByLabelText('collection-input')).toBeInTheDocument();\n-    expect(getByText('Save')).toBeDisabled();\n+    expect(getByText('Save')).toBeEnabled();\n     expect(getByText('Cancel')).toBeEnabled();\n     //Collection radio button should be selected by default\n     expect(getByLabelText('Collection')).toBeChecked();\n   });\n \n-  test('Verify mapping name, source query is mandatory and Save button is disabled', async () => {\n+  test('Verify mapping name, source query is mandatory and Save button is always enabled', async () => {\n     const { getByText, getByPlaceholderText, getByLabelText } = render(<CreateEditMappingDialog {...data.newMap} />);\n     const nameInput = getByPlaceholderText('Enter name');\n     const saveButton = getByText('Save');\n \n     // Enter the value for name input.\n     fireEvent.change(nameInput, { target: {value: 'testCreateMap'}});\n     expect(nameInput).toHaveValue('testCreateMap');\n-    expect(saveButton).toBeDisabled(); // It should be disabled since no value is provided yet for Collection or Query.\n+    expect(saveButton).toBeEnabled(); // Consistency change: button is now always enabled; will produce warning instead\n \n     //Providing the value for Collection field now so that Save button can be enabled.", "originalCommit": "db126b5047a35268fc6f88549e569cd87b524eda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkxNzQwOA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520917408", "bodyText": "removed all extra comments", "author": "jyangML", "createdAt": "2020-11-10T22:34:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwMTUxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwMjcwNA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520202704", "bodyText": "Can we add an enabled check on the Save button upon load of the form (line 60)? It's slightly different from the last case in the test in that the the required field (name) has never been touched: expect(saveButton).toBeEnabled();", "author": "wooldridge", "createdAt": "2020-11-10T00:13:31Z", "path": "marklogic-data-hub-central/ui/src/components/entities/create-edit-step-dialog/create-edit-step-dialog.test.tsx", "diffHunk": "@@ -46,13 +47,13 @@ describe('Create Edit Step Dialog component', () => {\n     expect(getByLabelText('Collection')).toBeInTheDocument();\n     expect(getByLabelText('Query')).toBeInTheDocument();\n     expect(getByLabelText('collection-input')).toBeInTheDocument();\n-    expect(getByText('Save')).toBeDisabled();\n+    expect(getByText('Save')).toBeEnabled();\n     expect(getByText('Cancel')).toBeEnabled();\n     //Collection radio button should be selected by default\n     expect(getByLabelText('Collection')).toBeChecked();\n   });\n \n-    test('Verify merging name is mandatory and Save button is disabled', () => {\n+    test('Verify save button is always enabled', () => {", "originalCommit": "db126b5047a35268fc6f88549e569cd87b524eda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkxNzYwNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520917605", "bodyText": "added", "author": "jyangML", "createdAt": "2020-11-10T22:35:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwMjcwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwMzMzMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520203330", "bodyText": "Can we also check that when content is entered in the name field, the error messaging goes away? You could update the test description to something like: \"Verify name is required for form submission and error messaging appears\"", "author": "wooldridge", "createdAt": "2020-11-10T00:15:19Z", "path": "marklogic-data-hub-central/ui/src/components/load/new-load-dialog/new-load-dialog.test.tsx", "diffHunk": "@@ -102,4 +102,29 @@ describe('New/edit load data configuration', () => {\n     expect(queryByText('Source Type')).not.toBeInTheDocument();\n   });\n \n+  test('Verify clicking \"Save\" with no name shows error', () => {", "originalCommit": "db126b5047a35268fc6f88549e569cd87b524eda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkxODE2Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520918167", "bodyText": "added", "author": "jyangML", "createdAt": "2020-11-10T22:36:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwMzMzMA=="}], "type": "inlineReview"}, {"oid": "2832f89d4796b0f70cb142bd7945ad6bf064e862", "url": "https://github.com/marklogic/marklogic-data-hub/commit/2832f89d4796b0f70cb142bd7945ad6bf064e862", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-10T22:31:17Z", "type": "forcePushed"}, {"oid": "bbf2e6e591c38b4599eb5211bb66d3733a2c727b", "url": "https://github.com/marklogic/marklogic-data-hub/commit/bbf2e6e591c38b4599eb5211bb66d3733a2c727b", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-10T22:32:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk2NTY1Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r520965657", "bodyText": "This check was failing for me locally, I was able to get it to work by updating it to the following:\n    fireEvent.change(nameInput, { target: {value: 'testLoadStep'} });\n    await wait(() => {\n      expect(nameInput).toHaveValue('testLoadStep');\n    }); \n    expect(queryByText('Name is required')).toBeNull();", "author": "wooldridge", "createdAt": "2020-11-11T00:44:32Z", "path": "marklogic-data-hub-central/ui/src/components/load/new-load-dialog/new-load-dialog.test.tsx", "diffHunk": "@@ -102,4 +102,36 @@ describe('New/edit load data configuration', () => {\n     expect(queryByText('Source Type')).not.toBeInTheDocument();\n   });\n \n+  test('Verify name is required for form submission and error messaging appears', async () => {\n+    const { debug, baseElement, queryByText, getByText} = \n+    render(\n+      <BrowserRouter><NewLoadDialog newLoad={true}\n+      title={'New Loading Step'}\n+      setNewLoad={() => {}}\n+      createLoadArtifact={() => {}}\n+      stepData={{}}\n+      canReadWrite={true}\n+      canReadOnly={false}/></BrowserRouter>\n+    );\n+    const nameInput = baseElement.querySelector('#name');\n+\n+    // error should not appear before anything is touched\n+    expect(queryByText('Name is required')).toBeNull();\n+\n+    fireEvent.click(getByText('Save'));\n+\n+    // message should appear when save button is clicked\n+    expect(queryByText('Name is required')).toBeInTheDocument();\n+\n+    // enter in a name and verify message disappears\n+    await wait(() => {\n+      if(nameInput){\n+        fireEvent.change(nameInput, { target: {value: 'testLoadStep'} });\n+      }\n+    }); \n+    expect(nameInput).toHaveValue('testLoadStep');\n+    \n+    expect(queryByText('Name is required')).toBeNull();", "originalCommit": "bbf2e6e591c38b4599eb5211bb66d3733a2c727b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQwNTk4OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4829#discussion_r521405989", "bodyText": "I was also able to reproduce on my local system.  But that is extremely strange, because I swear we both sat there and saw it pass yesterday.  In any event, it's fixed now.", "author": "jyangML", "createdAt": "2020-11-11T14:43:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk2NTY1Nw=="}], "type": "inlineReview"}, {"oid": "e789b4e3b0328943f79d8f7d2f36807b7c7ca762", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e789b4e3b0328943f79d8f7d2f36807b7c7ca762", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-11T14:42:13Z", "type": "commit"}, {"oid": "e789b4e3b0328943f79d8f7d2f36807b7c7ca762", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e789b4e3b0328943f79d8f7d2f36807b7c7ca762", "message": "DHFPROD-5613: fixed save button consistency", "committedDate": "2020-11-11T14:42:13Z", "type": "forcePushed"}]}