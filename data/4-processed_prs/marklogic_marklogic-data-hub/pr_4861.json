{"pr_number": 4861, "pr_title": "DHFPROD-6174: added existing step confirmation in Run Tile", "pr_createdAt": "2020-11-13T19:20:11Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4861", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQzOTAyNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r524439026", "bodyText": "@MLjyang, let's make the styling here consistent with what's in the other confirmation boxes (the styling was updated recently). Use bold styling instead of quotes:", "author": "wooldridge", "createdAt": "2020-11-16T17:19:10Z", "path": "marklogic-data-hub-central/ui/src/components/flows/flows.tsx", "diffHunk": "@@ -323,7 +331,15 @@ const Flows: React.FC<Props> = (props) => {\n             onCancel={() => onCancel()}\n             width={350}\n         >\n-            <div style={{fontSize: '16px', padding: '10px'}}>Are you sure you want to add step \"{stepName}\" to flow \"{flowName}\"?</div>\n+            <div style={{fontSize: '16px', padding: '10px'}}>\n+                {\n+                    isStepInFlow(stepName, flowName)\n+                    ?\n+                    <p>The step \"{stepName}\" is already in the flow \"{flowName}\". Would you like to add another instance?</p>", "originalCommit": "df2a3fd327049f1ee0379a067e7f7c4fb7b8143e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY4MzIyNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r524683227", "bodyText": "Fixed.  Added changes to unit tests for this update", "author": "jyangML", "createdAt": "2020-11-16T22:30:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQzOTAyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ1MTE2NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r524451165", "bodyText": "Can we move these styles into a CSS class? You may need to apply the class via flows.scss (instead of flows.module.scss) in order to override what's applied by Ant Design.", "author": "wooldridge", "createdAt": "2020-11-16T17:36:30Z", "path": "marklogic-data-hub-central/ui/src/components/flows/flows.tsx", "diffHunk": "@@ -323,7 +331,15 @@ const Flows: React.FC<Props> = (props) => {\n             onCancel={() => onCancel()}\n             width={350}\n         >\n-            <div style={{fontSize: '16px', padding: '10px'}}>Are you sure you want to add step \"{stepName}\" to flow \"{flowName}\"?</div>\n+            <div style={{fontSize: '16px', padding: '10px'}}>", "originalCommit": "df2a3fd327049f1ee0379a067e7f7c4fb7b8143e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY4Mjg0Mg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r524682842", "bodyText": "Made a new style in flows.modules.scss.", "author": "jyangML", "createdAt": "2020-11-16T22:30:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ1MTE2NQ=="}], "type": "inlineReview"}, {"oid": "358e48566860116b1de9720114d8d476a9c25141", "url": "https://github.com/marklogic/marklogic-data-hub/commit/358e48566860116b1de9720114d8d476a9c25141", "message": "DHFPROD-6174: added existing step confirmation in Run Tile", "committedDate": "2020-11-16T22:15:30Z", "type": "forcePushed"}, {"oid": "f5cb59ecb0a6febdd5c248948122610e567fe4d0", "url": "https://github.com/marklogic/marklogic-data-hub/commit/f5cb59ecb0a6febdd5c248948122610e567fe4d0", "message": "DHFPROD-6174: added existing step confirmation in Run Tile", "committedDate": "2020-11-16T22:16:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc0NTEzOQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r524745139", "bodyText": "Instead of creating a new Matcher function, you can use 'getSubElements', ex:\n        expect(await(waitForElement(() => getByText((content, node) => {\n            return getSubElements(content, node,`Are you sure you to add step ${data.steps.data['ingestionSteps'][0].name} to flow ${data.flows.data[0].name}?`);\n        })))).toBeInTheDocument();\n\nPlease try using that and removing the snippet creating a new function.", "author": "briantang", "createdAt": "2020-11-16T23:26:08Z", "path": "marklogic-data-hub-central/ui/src/pages/Run.test.tsx", "diffHunk": "@@ -775,7 +790,7 @@ describe('Verify Add Step function', () => {\n         fireEvent.click(step);\n \n         // Click to confirm the add in the dialog\n-        expect(getByText(`Are you sure you want to add step \"${data.steps.data['ingestionSteps'][0].name}\" to flow \"${data.flows.data[0].name}\"?`)).toBeInTheDocument();\n+        expect(getByTextWithMarkup(`Are you sure you want to add step ${data.steps.data['ingestionSteps'][0].name} to flow ${data.flows.data[0].name}?`)).toBeInTheDocument();", "originalCommit": "f5cb59ecb0a6febdd5c248948122610e567fe4d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIyNjQwMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r525226403", "bodyText": "Nice catch.  I didn't even see the snippet that I could have used underneath.  Thanks for pointing it out.", "author": "jyangML", "createdAt": "2020-11-17T15:05:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc0NTEzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc0NTYzOA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r524745638", "bodyText": "Same situation here. Everything else looks good!", "author": "briantang", "createdAt": "2020-11-16T23:26:37Z", "path": "marklogic-data-hub-central/ui/src/pages/Run.test.tsx", "diffHunk": "@@ -830,7 +860,7 @@ describe('Verify Add Step function', () => {\n         fireEvent.click(step);\n \n         // Click to confirm the add in the dialog\n-        expect(getByText(`Are you sure you want to add step \"${data.steps.data['ingestionSteps'][0].name}\" to flow \"${data.flows.data[0].name}\"?`)).toBeInTheDocument();\n+        expect(getByTextWithMarkup(`Are you sure you want to add step ${data.steps.data['ingestionSteps'][0].name} to flow ${data.flows.data[0].name}?`)).toBeInTheDocument();", "originalCommit": "f5cb59ecb0a6febdd5c248948122610e567fe4d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIyNjQ3Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4861#discussion_r525226473", "bodyText": "also fixed", "author": "jyangML", "createdAt": "2020-11-17T15:05:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDc0NTYzOA=="}], "type": "inlineReview"}, {"oid": "5c95ed492b806d0e2336d0c8baca8df6dc93994b", "url": "https://github.com/marklogic/marklogic-data-hub/commit/5c95ed492b806d0e2336d0c8baca8df6dc93994b", "message": "DHFPROD-6174: added existing step confirmation in Run Tile", "committedDate": "2020-11-17T15:03:29Z", "type": "forcePushed"}, {"oid": "ee21fc2986d18ce8e83b6f57e1e517fed11ca439", "url": "https://github.com/marklogic/marklogic-data-hub/commit/ee21fc2986d18ce8e83b6f57e1e517fed11ca439", "message": "DHFPROD-6174: added existing step confirmation in Run Tile", "committedDate": "2020-11-17T15:04:22Z", "type": "commit"}, {"oid": "ee21fc2986d18ce8e83b6f57e1e517fed11ca439", "url": "https://github.com/marklogic/marklogic-data-hub/commit/ee21fc2986d18ce8e83b6f57e1e517fed11ca439", "message": "DHFPROD-6174: added existing step confirmation in Run Tile", "committedDate": "2020-11-17T15:04:22Z", "type": "forcePushed"}]}