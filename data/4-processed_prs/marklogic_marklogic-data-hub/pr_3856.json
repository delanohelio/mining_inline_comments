{"pr_number": 3856, "pr_title": "DHFPROD-4720: Can now download user configuration files", "pr_createdAt": "2020-04-21T23:44:36Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3856", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE3MjQ1MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3856#discussion_r413172450", "bodyText": "How are we differentiating from a 400 Bad Request and a 500 internal server error in this case?", "author": "ryanjdew", "createdAt": "2020-04-22T17:23:39Z", "path": "marklogic-data-hub-central/src/main/java/com/marklogic/hub/central/managers/MapSearchManager.java", "diffHunk": "@@ -117,7 +117,7 @@ public StringHandle search(MapSearchQuery mapSearchQuery) {\n \n     public JsonNode sjsSearch(SJSSearchQuery SJSSearchQuery) {\n         if (SJSSearchQuery.sourceQuery == null && SJSSearchQuery.database == null) {\n-            throw new BadRequestException(\"Query requires database or sourceQuery\");\n+            throw new DataHubException(\"Query requires database or sourceQuery\");", "originalCommit": "9d06ef3a49ca924bd4478b7634433bc16658fbdf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzIxNTQ2OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3856#discussion_r413215468", "bodyText": "The BadRequestException wasn't actually doing anything - it wasn't capturing a 400, and it wasn't being handled by CustomExceptionHandler. It was also extending Spring Security's AuthenticationException, but it's not an authentication exception. So the class effectively wasn't doing anything, so I removed it and switched this over to the generic DataHubException.  That exception isn't really do anything either - CustomExceptionHandler handles it in its generic exception handler - but it's better than an exception that wasn't doing what its name implies.", "author": "rjrudin", "createdAt": "2020-04-22T18:22:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE3MjQ1MA=="}], "type": "inlineReview"}, {"oid": "ec4c8508e95f814cb362f7b1c51bad619573af6d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/ec4c8508e95f814cb362f7b1c51bad619573af6d", "message": "DHFPROD-4720: Can now download user configuration files\n\nAdded an \"all-artifacts\" project in core to support this. \n\nAdded our first use of \"Secured\" in HC, along with a pattern for how to verify that a user can or cannot access a Secured controller method. \n\nAlso removed a number of unused classes that aren't needed now that we're not checking if the user can install DH - ForbiddenException(LoginFailureHandler can assume that any failure is due to the user being unauthorized); ProjectDirectoryException (no more project); UIDeployListener (no more install); DataHubProjectUtils (no more upload). Also removed BadRequestException - CustomExceptionHandler wasn't doing anything with it, and it was being improperly thrown by MapSearchManager instead of the generic DataHubException (it shouldn't have been thrown there, since it was extending AuthenticationException).", "committedDate": "2020-04-22T22:13:11Z", "type": "forcePushed"}, {"oid": "ec4c8508e95f814cb362f7b1c51bad619573af6d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/ec4c8508e95f814cb362f7b1c51bad619573af6d", "message": "DHFPROD-4720: Can now download user configuration files\n\nAdded an \"all-artifacts\" project in core to support this. \n\nAdded our first use of \"Secured\" in HC, along with a pattern for how to verify that a user can or cannot access a Secured controller method. \n\nAlso removed a number of unused classes that aren't needed now that we're not checking if the user can install DH - ForbiddenException(LoginFailureHandler can assume that any failure is due to the user being unauthorized); ProjectDirectoryException (no more project); UIDeployListener (no more install); DataHubProjectUtils (no more upload). Also removed BadRequestException - CustomExceptionHandler wasn't doing anything with it, and it was being improperly thrown by MapSearchManager instead of the generic DataHubException (it shouldn't have been thrown there, since it was extending AuthenticationException).", "committedDate": "2020-04-22T22:13:11Z", "type": "commit"}]}