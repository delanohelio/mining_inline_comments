{"pr_number": 4227, "pr_title": "DHFPROD-3671: Support more formats for parseDate and parseDateTime", "pr_createdAt": "2020-07-16T22:38:29Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4227", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQwMjA5OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4227#discussion_r456402099", "bodyText": "The story mentions that every error should be of the form - \"Also, every Error result should be a message of \"The pattern '$pattern' cannot be applied to the value '$value'\".\" - is that possible to do - which includes not showing the XSLT path where it failed, which a commenter on the story described as \"user hostile\"?", "author": "rjrudin", "createdAt": "2020-07-17T12:11:14Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/mapping-functions/core.sjs", "diffHunk": "@@ -137,7 +138,11 @@ function parseDate(value, pattern) {\n     }\n   }\n   else {\n-    fn.error(null, \"The given date pattern (\" + pattern + \") is not supported.\");\n+    try {\n+      response = xs.date(xdmp.parseYymmdd(originalPattern, value));\n+    } catch(e) {\n+      fn.error(null, \"The given date pattern (\" + originalPattern + \") is not supported.\");", "originalCommit": "ea107207802b0178865d632e53b174ae1bf0e895", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a9a0c3160057e59a5a5b43a99d2c299148bcda1c", "url": "https://github.com/marklogic/marklogic-data-hub/commit/a9a0c3160057e59a5a5b43a99d2c299148bcda1c", "message": "DHFPROD-3671: Support more formats for parseDate and parseDateTime", "committedDate": "2020-07-17T16:38:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU2NzA4Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4227#discussion_r456567087", "bodyText": "Should we still keep the earlier error message for the case when pattern is not supported.\nFor ex, if \"Mon YYYY DD\" is not supported and the value is \"Jan 2019 16\", the error message would say\nThe pattern 'Mon YYYY DD' cannot be applied to the value 'Jan 2019 16'\nThe value seems to match the pattern and we should probably say it is not supported(?)", "author": "bsrikan", "createdAt": "2020-07-17T17:08:18Z", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/mapping-functions/core.sjs", "diffHunk": "@@ -137,24 +138,33 @@ function parseDate(value, pattern) {\n     }\n   }\n   else {\n-    fn.error(null, \"The given date pattern (\" + pattern + \") is not supported.\");\n+    try {", "originalCommit": "a9a0c3160057e59a5a5b43a99d2c299148bcda1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU4OTgwNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4227#discussion_r456589806", "bodyText": "I think that makes sense for the 3 non-standard formats.", "author": "rjrudin", "createdAt": "2020-07-17T17:53:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU2NzA4Nw=="}], "type": "inlineReview"}, {"oid": "e350fd535009f6e534eddfb2e8279dcda4cac7eb", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e350fd535009f6e534eddfb2e8279dcda4cac7eb", "message": "DHFPROD-3671: Support more formats for parseDate and parseDateTime", "committedDate": "2020-07-17T23:45:37Z", "type": "commit"}, {"oid": "e350fd535009f6e534eddfb2e8279dcda4cac7eb", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e350fd535009f6e534eddfb2e8279dcda4cac7eb", "message": "DHFPROD-3671: Support more formats for parseDate and parseDateTime", "committedDate": "2020-07-17T23:45:37Z", "type": "forcePushed"}]}