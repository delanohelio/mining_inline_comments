{"pr_number": 4236, "pr_title": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "pr_createdAt": "2020-07-19T20:03:18Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4236", "timeline": [{"oid": "d8cfeb0421051c3fdd367a051aa99afe1d9f7ac5", "url": "https://github.com/marklogic/marklogic-data-hub/commit/d8cfeb0421051c3fdd367a051aa99afe1d9f7ac5", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-19T20:01:47Z", "type": "forcePushed"}, {"oid": "b4c8857e05a8fd88aef4a78d4c3b8b9724530080", "url": "https://github.com/marklogic/marklogic-data-hub/commit/b4c8857e05a8fd88aef4a78d4c3b8b9724530080", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-19T20:06:49Z", "type": "forcePushed"}, {"oid": "7f9bcb52adbf876eca35526be87d55de5b7dd0a3", "url": "https://github.com/marklogic/marklogic-data-hub/commit/7f9bcb52adbf876eca35526be87d55de5b7dd0a3", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-19T20:19:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzcwNzg4Ng==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4236#discussion_r457707886", "bodyText": "@AkshayBajajML instead of having the name as callback function, could you name the function with what it exactly does", "author": "Sanjeevani19", "createdAt": "2020-07-20T21:41:33Z", "path": "marklogic-data-hub-central/ui/src/components/sidebar/sidebar.tsx", "diffHunk": "@@ -380,15 +382,18 @@ const Sidebar: React.FC<Props> = (props) => {\n     borderBottom: 'none',\n     backgroundColor: '#F1F2F5'\n   }\n-\n+     const callback = (key) => {", "originalCommit": "7f9bcb52adbf876eca35526be87d55de5b7dd0a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "936727465ff0305f3b9466ce45838285d1e8978d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/936727465ff0305f3b9466ce45838285d1e8978d", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-21T18:16:20Z", "type": "forcePushed"}, {"oid": "63c1db7d276f9035f51a1607d067d4c141bf62fd", "url": "https://github.com/marklogic/marklogic-data-hub/commit/63c1db7d276f9035f51a1607d067d4c141bf62fd", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-21T18:22:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMwOTEzNg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4236#discussion_r458309136", "bodyText": "is it expected for hub-properties to be collapsed when an entity is selected?", "author": "bsrikan", "createdAt": "2020-07-21T18:38:06Z", "path": "marklogic-data-hub-central/ui/src/components/sidebar/sidebar-rtl.test.tsx", "diffHunk": "@@ -35,12 +34,44 @@ describe(\"Sidebar createdOn face time window dropdown\", () => {\n             facetRender = {jest.fn()}\n             checkFacetRender = {jest.fn()}\n         />);\n-        userEvent.click(getByText('Hub Properties'));\n         expect(getByText(\"Select time\")).toBeInTheDocument();\n         userEvent.click(getByText('select time'));\n         expect(getByText(\"Custom\")).toBeInTheDocument();\n         fireEvent.click(getByText(\"Custom\"));\n         expect(getByPlaceholderText(\"Start date\")).toBeInTheDocument();\n         expect(getByPlaceholderText(\"End date\")).toBeInTheDocument();\n     });\n-});\n\\ No newline at end of file\n+\n+    test('Verify that hub properties is expanded by default', () => {\n+        const parsedModelData = entityFromJSON(modelResponse);\n+        const entityDefArray = entityParser(parsedModelData);\n+        const { getByText,querySelector } = render(<Sidebar\n+            entityDefArray={entityDefArray}\n+            facets={searchPayloadFacets}\n+            selectedEntities={[]}\n+            facetRender = {jest.fn()}\n+            checkFacetRender = {jest.fn()}\n+        />);\n+        expect(document.querySelector('#hub-properties div')).toHaveAttribute('aria-expanded','true');\n+        userEvent.click(getByText('Hub Properties'));\n+        expect(document.querySelector('#hub-properties div')).toHaveAttribute('aria-expanded','false');\n+    });\n+\n+    test('Verify that entity properties is expanded when entity is selected', () => {\n+        const parsedModelData = entityFromJSON(modelResponse);\n+        const entityDefArray = entityParser(parsedModelData);\n+        const { getByText,querySelector } = render(<Sidebar\n+            entityDefArray={entityDefArray}\n+            facets={searchPayloadFacets}\n+            selectedEntities={['Customer']}\n+            facetRender = {jest.fn()}\n+            checkFacetRender = {jest.fn()}\n+        />);\n+        expect(document.querySelector('#entity-properties div')).toHaveAttribute('aria-expanded','true');\n+        expect(document.querySelector('#hub-properties div')).toHaveAttribute('aria-expanded','false');", "originalCommit": "63c1db7d276f9035f51a1607d067d4c141bf62fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMxODkxMQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4236#discussion_r458318911", "bodyText": "Yes, that is expected. We just need to change hub properties to be expand by default as part of this story while keeping rest of functionality same. This is how it is working on nightly instance too.", "author": "AkshayBajajML", "createdAt": "2020-07-21T18:55:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMwOTEzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMxOTUwMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4236#discussion_r458319500", "bodyText": "*hub properties to be expand by default when all entities is selected", "author": "AkshayBajajML", "createdAt": "2020-07-21T18:56:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMwOTEzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMxMjMyMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4236#discussion_r458312323", "bodyText": "entityProperties dont show up when \"All Entities\" is selected. So I think it is safe to say\nprops.selectedEntities.length === 0 ? setActiveKey(['hubProperties']) : setActiveKey(['entityProperties']);", "author": "bsrikan", "createdAt": "2020-07-21T18:43:39Z", "path": "marklogic-data-hub-central/ui/src/components/sidebar/sidebar.tsx", "diffHunk": "@@ -44,9 +44,11 @@ const Sidebar: React.FC<Props> = (props) => {\n   let integers = ['int', 'integer', 'short', 'long'];\n   let decimals = ['decimal', 'double', 'float'];\n   const dateRangeOptions = ['Today', 'This Week', 'This Month', 'Custom'];\n+  const [activeKey, setActiveKey] = useState<any[]>([]);\n \n   useEffect(() => {\n     if (props.facets) {\n+      props.selectedEntities.length === 0 ? setActiveKey(['entityProperties','hubProperties']) : setActiveKey(['entityProperties']);", "originalCommit": "63c1db7d276f9035f51a1607d067d4c141bf62fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMxOTEyMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4236#discussion_r458319120", "bodyText": "I agree, Will make the change.", "author": "AkshayBajajML", "createdAt": "2020-07-21T18:55:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMxMjMyMw=="}], "type": "inlineReview"}, {"oid": "39e783eab653fbaeaa7121f030bb231679678f73", "url": "https://github.com/marklogic/marklogic-data-hub/commit/39e783eab653fbaeaa7121f030bb231679678f73", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-21T19:10:27Z", "type": "forcePushed"}, {"oid": "1dc9e2abaab59213d6993dc32df06a64c1c0996d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/1dc9e2abaab59213d6993dc32df06a64c1c0996d", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-22T18:52:21Z", "type": "commit"}, {"oid": "1dc9e2abaab59213d6993dc32df06a64c1c0996d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/1dc9e2abaab59213d6993dc32df06a64c1c0996d", "message": "DHFPROD-5392: Make \"Hub Properties\" expanded by default in \"all entities\" results view side-pane under Explorer tile", "committedDate": "2020-07-22T18:52:21Z", "type": "forcePushed"}]}