{"pr_number": 4263, "pr_title": "DHFPROD-5362: Add Entity button disabled if duplicate name is used fix", "pr_createdAt": "2020-07-22T23:30:00Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4263", "timeline": [{"oid": "71766ff0759de5a18d4f307063b398703020cbf1", "url": "https://github.com/marklogic/marklogic-data-hub/commit/71766ff0759de5a18d4f307063b398703020cbf1", "message": "DHFPROD-5362: Add Entity disabled if duplicate  fix", "committedDate": "2020-07-22T23:26:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE3NjU0NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#discussion_r460176545", "bodyText": "I would prefer to update existing unit test 'Creating duplicate entity shows error message' to verify Add button is enabled, than verifying this in e2e. This is ok now and something to keep in mind for future tests.", "author": "bsrikan", "createdAt": "2020-07-24T16:59:47Z", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/modeling/scenarios.modeling.tsx", "diffHunk": "@@ -89,30 +89,47 @@ describe('Entity Modeling', () => {\n \n     propertyTable.editProperty('fname');\n     cy.waitUntil(() => propertyModal.getToggleStepsButton().should('exist')).click();\n-    cy.contains('mapPersonJSON');\n-    cy.contains('match-person');\n-    cy.contains('merge-person');\n-    cy.contains('master-person');\n-    cy.contains('Hide Steps...');\n+    cy.contains('mapPersonJSON').should('be.visible');\n+    cy.contains('match-person').should('be.visible');\n+    cy.contains('merge-person').should('be.visible');\n+    cy.contains('master-person').should('be.visible');\n+    cy.contains('Hide Steps...').should('be.visible');\n+\n+    cy.contains('Show Steps...').should('not.be.visible');\n+\n     propertyModal.getToggleStepsButton().click();\n-    cy.contains('Show Steps...');\n+\n+    cy.contains('Show Steps...').should('be.visible');\n+\n+    cy.contains('mapPersonJSON').should('not.be.visible');\n+    cy.contains('match-person').should('not.be.visible');\n+    cy.contains('merge-person').should('not.be.visible');\n+    cy.contains('master-person').should('not.be.visible');\n+    cy.contains('Hide Steps...').should('not.be.visible');\n     propertyModal.getCancelButton().click();\n \n     entityTypeTable.getDeleteEntityIcon('Person').click();\n-    cy.contains('Entity type is used in one or more steps.');\n-    cy.contains('Show Steps...');\n+    cy.contains('Entity type is used in one or more steps.').should('be.visible');\n+    cy.contains('Show Steps...').should('be.visible');\n+    cy.contains('Hide Steps...').should('not.be.visible');\n \n     confirmationModal.getToggleStepsButton().click();\n-    cy.contains('mapPersonJSON');\n-    cy.contains('Hide Steps...');\n+    cy.contains('mapPersonJSON').should('be.visible');\n+    cy.contains('Hide Steps...').should('be.visible');\n+    cy.contains('Show Steps...').should('not.be.visible');\n \n     confirmationModal.getCloseButton(ConfirmationType.DeleteEntityStepWarn).click();\n     entityTypeTable.getEntity('Person').should('exist');\n   });\n \n-  it('can create a new entity, add relationship type, and add identifier confirmation, delete property from modal, and delete entity', () => {\n-    modelPage.getAddEntityButton().should('exist');\n-    modelPage.getAddEntityButton().click();\n+  it('can check for duplicate entity, create a new entity, add relationship type, and add identifier confirmation, delete property from modal, and delete entity', () => {\n+    cy.waitUntil(() => modelPage.getAddEntityButton()).click();\n+    entityTypeModal.newEntityName('Person');\n+    entityTypeModal.getAddButton().click();\n+    cy.contains('An entity type already exists with a name of Person').should('be.visible');\n+    entityTypeModal.getAddButton().should('not.be.disabled');", "originalCommit": "71766ff0759de5a18d4f307063b398703020cbf1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDIxMTkwMA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#discussion_r460211900", "bodyText": "I still think we need this test since the message depends on the server response.", "author": "brucean52", "createdAt": "2020-07-24T18:11:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE3NjU0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDIyODQyMg==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#discussion_r460228422", "bodyText": "ok.", "author": "bsrikan", "createdAt": "2020-07-24T18:47:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE3NjU0NQ=="}], "type": "inlineReview"}]}