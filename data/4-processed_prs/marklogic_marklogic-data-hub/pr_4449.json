{"pr_number": 4449, "pr_title": "DHFPROD-5428: Reset URI nav in source mapping", "pr_createdAt": "2020-08-19T23:41:05Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4449", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI5OTM4OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4449#discussion_r474299388", "bodyText": "This is a good test. Couple of nitpicky items:\n\nDo we need a separate test suite? We tried to test URI navigation and verify source table data, didnt work out at the time. If we are able to assert doc content on navigation, then we can keep this in a separate suite and add more tests later to assert source data.\nuriStart, uriNext, uriReset are really aliases to the same locator?", "author": "bsrikan", "createdAt": "2020-08-20T22:07:58Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -1084,3 +1084,29 @@ describe('RTL Source Selector/Source Search tests', () => {\n     });\n });\n \n+describe('Source URI navigation', () => {\n+\n+    afterEach(cleanup);\n+\n+    test('Index resets on close of mapping',  async() => {\n+        const { getByLabelText, getByTestId } = render(<SourceToEntityMap {...data.mapProps}  mappingVisible={true}/>);\n+\n+        // URI index starts at 1\n+        let uriStart = within(getByLabelText('uriIndex'));\n+        expect(uriStart.getByText('1')).toBeInTheDocument();\n+\n+        // Click next, URI index is 2\n+        fireEvent.click(getByTestId('navigate-uris-right'));\n+        let uriNext = within(getByLabelText('uriIndex'));\n+        expect(uriNext.getByText('2')).toBeInTheDocument();\n+\n+        // Close mapping modal\n+        fireEvent.click(getByLabelText('icon: close'));\n+\n+        // URI index reset to 1\n+        let uriReset = within(getByLabelText('uriIndex'));\n+        expect(uriReset.getByText('1')).toBeInTheDocument();\n+    });", "originalCommit": "06e8c433a310a47580525943411562cea6715408", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg1MDMwNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4449#discussion_r474850307", "bodyText": "I moved the test into \"RTL Source-to-entity map tests\" and updated the URI variable.\nThis set of tests should be better organized be given the complexity of the component, that can be taken care of in a future refactor.", "author": "wooldridge", "createdAt": "2020-08-21T18:07:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI5OTM4OA=="}], "type": "inlineReview"}, {"oid": "6a39294b8301b7d1ff20831b4a66c83b92fc8a73", "url": "https://github.com/marklogic/marklogic-data-hub/commit/6a39294b8301b7d1ff20831b4a66c83b92fc8a73", "message": "WIP", "committedDate": "2020-08-21T18:03:18Z", "type": "forcePushed"}, {"oid": "0ced25b498a8701f3da3f789fc977d97e714c41d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/0ced25b498a8701f3da3f789fc977d97e714c41d", "message": "DHFPROD-5428: Reset URI nav in source mapping\n\nReset URI index to 0 for source doc navigation when the mapping modal is closed. Next mapping modal opened will start at the first doc.\n\nAlso remove unused onOk() code for modal.", "committedDate": "2020-08-21T18:27:05Z", "type": "commit"}, {"oid": "0ced25b498a8701f3da3f789fc977d97e714c41d", "url": "https://github.com/marklogic/marklogic-data-hub/commit/0ced25b498a8701f3da3f789fc977d97e714c41d", "message": "DHFPROD-5428: Reset URI nav in source mapping\n\nReset URI index to 0 for source doc navigation when the mapping modal is closed. Next mapping modal opened will start at the first doc.\n\nAlso remove unused onOk() code for modal.", "committedDate": "2020-08-21T18:27:05Z", "type": "forcePushed"}]}