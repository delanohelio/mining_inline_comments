{"pr_number": 4403, "pr_title": "DHFPROD-5565: Unauthorized user can view Model content via URL route,\u2026", "pr_createdAt": "2020-08-13T23:07:31Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4403", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5NzAyNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4403#discussion_r470297027", "bodyText": "Doing this to address this e2e test failure on windows.\n\nI believe this is due to toolbar component using inline style instead of CSS.\nhttps://reactjs.org/docs/faq-styling.html#are-inline-styles-bad", "author": "brucean52", "createdAt": "2020-08-13T23:08:46Z", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/modeling/writer.spec.tsx", "diffHunk": "@@ -21,7 +21,7 @@ describe('Entity Modeling: Writer Role', () => {\n     cy.contains(Application.title);\n     console.log(Cypress.env('mlHost'));\n     cy.loginAsTestUserWithRoles(\"hub-central-entity-model-reader\", \"hub-central-entity-model-writer\", \"hub-central-saved-query-user\").withRequest()\n-    cy.waitUntil(() => toolbar.getModelToolbarIcon()).click();\n+    cy.waitUntil(() => toolbar.getModelToolbarIcon().should('have.css', 'cursor', 'pointer')).click();", "originalCommit": "8525fd4d5bbb400e2c9e46b22559d42ae6b1f28e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDM2MjU4OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4403#discussion_r470362588", "bodyText": "I doubt if that is the case. Other tool icons are clicked the same way and in windows, in this instance, load test didnt fail there. To me it seems to be the async issue. We are using wait(500) in withRequest() and the websocket get request might not have completed in that time resulting in that click timeout error. Will try to replace explicit wait with something else to ensure overview page is completely loaded with all XHR requests complete.", "author": "bsrikan", "createdAt": "2020-08-14T01:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5NzAyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDM3MDcwOQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4403#discussion_r470370709", "bodyText": "It\u2019s an intermittent failure where it sometimes fails and sometimes passes. The log output above shows the style has not been set correctly. But if you see the attached image below of where the video fails, the icon doesn\u2019t have the style that\u2019s in the error log.", "author": "brucean52", "createdAt": "2020-08-14T02:05:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI5NzAyNw=="}], "type": "inlineReview"}, {"oid": "9126bef3a95bcea81f3ebadda8aecc32352c2ccb", "url": "https://github.com/marklogic/marklogic-data-hub/commit/9126bef3a95bcea81f3ebadda8aecc32352c2ccb", "message": "DHFPROD-5565: Unauthorized user can view Model content via URL route, DHFPROD-5619: disabled icon color", "committedDate": "2020-08-14T02:04:36Z", "type": "commit"}, {"oid": "9126bef3a95bcea81f3ebadda8aecc32352c2ccb", "url": "https://github.com/marklogic/marklogic-data-hub/commit/9126bef3a95bcea81f3ebadda8aecc32352c2ccb", "message": "DHFPROD-5565: Unauthorized user can view Model content via URL route, DHFPROD-5619: disabled icon color", "committedDate": "2020-08-14T02:04:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDg5NTQ0Ng==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4403#discussion_r470895446", "bodyText": "This is ok. Another example is use an authority for ex readRole who doesnt have rights to model tile. If setting all the authority to false is same as a user with hub-central-user role, then this test looks good.\nconst authorityService = new AuthoritiesService();\nauthorityService.setAuthorities(['readLoad']);", "author": "bsrikan", "createdAt": "2020-08-14T22:48:12Z", "path": "marklogic-data-hub-central/ui/src/pages/Modeling.test.tsx", "diffHunk": "@@ -85,6 +86,29 @@ describe(\"Modeling Page\", () => {\n     expect(getByLabelText(\"save-all\")).toBeDisabled();\n     expect(queryByLabelText('entity-modified-alert')).toBeNull();\n   });\n+\n+  test(\"Modeling: can not see data if user does not have entity model reader role\", async () => {\n+    mockPrimaryEntityType.mockResolvedValueOnce({ status: 200, data: getEntityTypes });\n+\n+    const { queryByText, queryByLabelText } = render(\n+      <AuthoritiesContext.Provider value={mockHCUserRolesService}>", "originalCommit": "9126bef3a95bcea81f3ebadda8aecc32352c2ccb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}