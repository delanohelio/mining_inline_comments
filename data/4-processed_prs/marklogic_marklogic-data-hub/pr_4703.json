{"pr_number": 4703, "pr_title": "DHFPROD-6113: Removing need to include skipUi and skipWeb", "pr_createdAt": "2020-10-12T19:26:32Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4703", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUwNzQ0Nw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r503507447", "bodyText": "We need this while building the jars too.", "author": "SameeraPriyathamTadikonda", "createdAt": "2020-10-12T20:05:26Z", "path": "marklogic-data-hub/build.gradle", "diffHunk": "@@ -227,26 +227,10 @@ task generateDataServiceInterfaces {\n     }\n }\n \n-if (!(\n-    gradle.startParameter.taskNames*.toLowerCase().contains(\"bootrun\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"test\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"testunit\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"publishplugins\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"publishtomavenlocal\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bintrayupload\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"javadoc\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bootjar\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"marklogic-data-hub:bootjar\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"clientjar\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"marklogic-data-hub:clientjar\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"generatedataservice\") ||\n-        // Added for Hub Central\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bootrun\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"buildrpm\") ||\n-\n-        project.hasProperty('skipui')\n-)\n-) {\n+// When publishing the DHF core jar, it needs to have the compiled trace-ui files in it so that the trace-ui feature\n+// is available for those users that are aware of it. Otherwise, copyUIAssets is not executed as it can take a couple\n+// minutes to finish, and it's not typically needed during local development.\n+if (gradle.startParameter.taskNames*.toLowerCase().contains(\"publish\")) {", "originalCommit": "19827dcb75ccbe3f0dc51fa9a2a592f0aefbf7c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7339bb475c64df15c13369ca21a162c4a24c42f8", "url": "https://github.com/marklogic/marklogic-data-hub/commit/7339bb475c64df15c13369ca21a162c4a24c42f8", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it.", "committedDate": "2020-10-12T21:08:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUzNTY1Mw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r503535653", "bodyText": "Are we going to run all these tests on PR too?", "author": "SameeraPriyathamTadikonda", "createdAt": "2020-10-12T21:15:10Z", "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -179,24 +178,13 @@ task copyUiFiles(type: Copy, dependsOn: deleteSpringBootUiFiles, group: taskGrou\n     into springBootUiPath\n }\n \n-// Before the Spring Boot jar is built, build the UI files and copy them over\n-if (!(\n-    gradle.startParameter.taskNames*.toLowerCase().contains(\"publishplugins\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bintrayUpload\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"javadoc\") ||\n-        // bootRun doesn't need the UI, as it's assumed that the UI is being run separately via npm start\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bootrun\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"generateschemapojos\") ||\n-        project.hasProperty('skipui')\n-)\n-) {\n+// When creating the HC war file, need to build the UI files and add them to the classpath so that the war file includes them\n+if (gradle.startParameter.taskNames*.toLowerCase().contains(\"bootwar\")) {\n     tasks.processResources.dependsOn(buildUi, copyUiFiles)\n }\n \n+\n test {\n-\texclude 'com/marklogic/hub/curation/integrationtests/**'", "originalCommit": "7339bb475c64df15c13369ca21a162c4a24c42f8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU0OTAwNA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r503549004", "bodyText": "None of the 3 excluded packages exist anymore", "author": "rjrudin", "createdAt": "2020-10-12T21:41:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzUzNTY1Mw=="}], "type": "inlineReview"}, {"oid": "320708abde9dc40e327f8be4149d793751b7e6dc", "url": "https://github.com/marklogic/marklogic-data-hub/commit/320708abde9dc40e327f8be4149d793751b7e6dc", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it.", "committedDate": "2020-10-12T21:42:59Z", "type": "forcePushed"}, {"oid": "2205b6276cba141971948e3970c58064891ce4b7", "url": "https://github.com/marklogic/marklogic-data-hub/commit/2205b6276cba141971948e3970c58064891ce4b7", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it. Also removed publishing from this, as we have no use case for that yet.", "committedDate": "2020-10-13T12:05:08Z", "type": "forcePushed"}, {"oid": "aa8648821179f01ad0392567871748bca5615d54", "url": "https://github.com/marklogic/marklogic-data-hub/commit/aa8648821179f01ad0392567871748bca5615d54", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it. Also removed publishing from this, as we have no use case for that yet.", "committedDate": "2020-10-13T19:36:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMwMzgyNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r504303827", "bodyText": "Does bootRun need to be added here as well?", "author": "ryanjdew", "createdAt": "2020-10-13T22:53:51Z", "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -185,28 +184,17 @@ task copyUiFiles(type: Copy, dependsOn: deleteSpringBootUiFiles, group: taskGrou\n     into springBootUiPath\n }\n \n-// Before the Spring Boot jar is built, build the UI files and copy them over\n-if (!(\n-    gradle.startParameter.taskNames*.toLowerCase().contains(\"publishplugins\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bintrayUpload\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"javadoc\") ||\n-        // bootRun doesn't need the UI, as it's assumed that the UI is being run separately via npm start\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"bootrun\") ||\n-        gradle.startParameter.taskNames*.toLowerCase().contains(\"generateschemapojos\") ||\n-        project.hasProperty('skipui')\n-)\n-) {\n+// When creating the HC war file, need to build the UI files and add them to the classpath so that the war file includes them\n+if (gradle.startParameter.taskNames*.toLowerCase().contains(\"bootwar\") || gradle.startParameter.taskNames*.toLowerCase().contains(\"buildrpm\")) {", "originalCommit": "aa8648821179f01ad0392567871748bca5615d54", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyMjkwOQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r504322909", "bodyText": "@SameeraPriyathamTadikonda  What gradle task is being run for the cypress tests? And are the cypress tests expecting the middle tier to contain all of the UI code? I looked for \"bootRun\" but didn't see it under ui/e2e, but I don't really know where the cypress stuff runs.", "author": "rjrudin", "createdAt": "2020-10-13T23:54:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMwMzgyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyNTU2MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r504325560", "bodyText": "I'll start hubcentral using the RPM and run tests using the npm command 'npm run cy:run'", "author": "SameeraPriyathamTadikonda", "createdAt": "2020-10-14T00:03:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMwMzgyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg1Mjk0NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4703#discussion_r504852945", "bodyText": "The cypress tests do expect the middle tier to contain all of the UI code. At least locally, I've had to build UI, run the server, and then run cypress tests using the cy:run command.", "author": "akshaysonvane", "createdAt": "2020-10-14T17:32:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMwMzgyNw=="}], "type": "inlineReview"}, {"oid": "85ebd5baaeadf7a7547160f6ff3af31cc76900e8", "url": "https://github.com/marklogic/marklogic-data-hub/commit/85ebd5baaeadf7a7547160f6ff3af31cc76900e8", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it. Also removed publishing from this, as we have no use case for that yet.", "committedDate": "2020-10-14T16:33:11Z", "type": "forcePushed"}, {"oid": "4c714f5bc300735f0aa148d30751c65f4784dd94", "url": "https://github.com/marklogic/marklogic-data-hub/commit/4c714f5bc300735f0aa148d30751c65f4784dd94", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it. Also removed publishing from this, as we have no use case for that yet.", "committedDate": "2020-10-14T18:44:57Z", "type": "forcePushed"}, {"oid": "e429fef4aa151fb52cf0d6a7350db39557769334", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e429fef4aa151fb52cf0d6a7350db39557769334", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it. Also removed publishing from this, as we have no use case for that yet.", "committedDate": "2020-10-14T18:45:30Z", "type": "commit"}, {"oid": "e429fef4aa151fb52cf0d6a7350db39557769334", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e429fef4aa151fb52cf0d6a7350db39557769334", "message": "DHFPROD-6113: Removing need to include skipUi or skipWeb\n\nThe UI files for core will only be built when running \"publish\" and \"build\" now. \n\nSame goes for HC, except only when \"bootWar\" is run. Removed the maven-publish plugin from this project too, as it is not needed. \n\nskipWeb is no longer needed as QS will only publish something when \"publish\" is run. Removed publishing from the web project too; confirmed with team it's no longer needed. \n\nRemoved the Spark README, as the only thing it was doing was mentioning the need to include skipui. We'll add it back once we have stuff to say in it. Also removed publishing from this, as we have no use case for that yet.", "committedDate": "2020-10-14T18:45:30Z", "type": "forcePushed"}]}