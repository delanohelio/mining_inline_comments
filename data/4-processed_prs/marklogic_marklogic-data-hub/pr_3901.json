{"pr_number": 3901, "pr_title": "DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.", "pr_createdAt": "2020-05-01T03:38:22Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/3901", "timeline": [{"oid": "e79093577a661399790d5683c46854dfc88d5702", "url": "https://github.com/marklogic/marklogic-data-hub/commit/e79093577a661399790d5683c46854dfc88d5702", "message": "DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Removing unnecessary debug statements (+1 squashed commit)\nSquashed commits:\n[9e93a5f55] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Fixed few tests after updating the unique key in source table (+2 squashed commits)\nSquashed commits:\n[85100b6ac] DHFPROD-4216: Fixing issue sin collapse/expand rows and added unit tests\n[4d8cc289b] DHFPROD-4216: Expand all / Collapse all buttons for Mapping UI tables", "committedDate": "2020-05-01T03:43:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE2MzExMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r419163113", "bodyText": "Can we update the testid to say expandCollapseBtn-source and expandCollapseBtn-entity so its clear than rowKey and key.", "author": "bsrikan", "createdAt": "2020-05-03T21:30:46Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.tsx", "diffHunk": "@@ -954,20 +1072,23 @@ const SourceToEntityMap = (props) => {\n                             </div>\n                             :\n                             <div id=\"dataPresent\">\n-                                <div className={styles.navigationCollapseButtons}>{navigationButtons}</div>\n+                                \n+                                <div className={styles.navigationCollapseButtons}><span><Button data-testid=\"expandCollapseBtn-rowKey\" onClick={() => handleExpandCollapse('rowKey')} className={styles.expandCollapseBtn}>{expandedSourceFlag ? 'Collapse All' : 'Expand All'}</Button></span><span>{navigationButtons}</span></div>", "originalCommit": "e79093577a661399790d5683c46854dfc88d5702", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTkyMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r420321923", "bodyText": "Done", "author": "xnikhil08", "createdAt": "2020-05-05T18:32:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE2MzExMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjQ3OQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r419172479", "bodyText": "can we add an assertion for indentation check. Something similar to this used in this test file:\nexpect(getByText('suffix')).toHaveStyle(\"line-height: 2vh; text-indent: 20px;\"); as applicable", "author": "bsrikan", "createdAt": "2020-05-03T23:05:50Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -390,6 +398,79 @@ describe('RTL Source-to-entity map tests', () => {\n          */\n     })\n \n+    test('CollapseAll/Expand All feature in JSON Source data table and Entity table', () => {\n+\n+        const { getByTestId, getByText, debug, queryByText } = render(<SourceToEntityMap {...data.mapProps}\n+            mappingVisible={true}\n+        />);\n+\n+        /* Validate collapse-expand in source table */\n+        //Check if the expected source table elements are present in the DOM before hittting the Expan/Collapse button\n+        expect(queryByText('suffix')).not.toBeInTheDocument();\n+        expect(getByText('nutFreeName')).toBeInTheDocument();\n+        expect(getByText('FirstNamePreferred')).toBeInTheDocument();\n+        expect(getByText('LastName')).toBeInTheDocument();\n+\n+        let expandCollapseBtn = getByTestId('expandCollapseBtn-rowKey');\n+\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+\n+        fireEvent.click(expandCollapseBtn); //Expanding all nested levels\n+        expect(expandCollapseBtn.textContent).toBe('Collapse All'); // Validating the button label \n+        expect(getByText('suffix')).toBeInTheDocument();", "originalCommit": "e79093577a661399790d5683c46854dfc88d5702", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTgzMw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r420321833", "bodyText": "Done", "author": "xnikhil08", "createdAt": "2020-05-05T18:32:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjQ3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjgyNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r419172825", "bodyText": "can you try using onClosestTableRow from the test-util.ts\nexpect(onClosesTableRow(getByText('suffix')).style.display).toBe('none')", "author": "bsrikan", "createdAt": "2020-05-03T23:09:19Z", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -390,6 +398,79 @@ describe('RTL Source-to-entity map tests', () => {\n          */\n     })\n \n+    test('CollapseAll/Expand All feature in JSON Source data table and Entity table', () => {\n+\n+        const { getByTestId, getByText, debug, queryByText } = render(<SourceToEntityMap {...data.mapProps}\n+            mappingVisible={true}\n+        />);\n+\n+        /* Validate collapse-expand in source table */\n+        //Check if the expected source table elements are present in the DOM before hittting the Expan/Collapse button\n+        expect(queryByText('suffix')).not.toBeInTheDocument();\n+        expect(getByText('nutFreeName')).toBeInTheDocument();\n+        expect(getByText('FirstNamePreferred')).toBeInTheDocument();\n+        expect(getByText('LastName')).toBeInTheDocument();\n+\n+        let expandCollapseBtn = getByTestId('expandCollapseBtn-rowKey');\n+\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+\n+        fireEvent.click(expandCollapseBtn); //Expanding all nested levels\n+        expect(expandCollapseBtn.textContent).toBe('Collapse All'); // Validating the button label \n+        expect(getByText('suffix')).toBeInTheDocument();\n+\n+        fireEvent.click(expandCollapseBtn); //Collapsing back to the default view (root and 1st level)\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+        expect(getByText('suffix').closest('tr')?.style.display).toBe('none'); // Checking if the row is marked hidden in DOM. All collapsed rows are marked hidden(display: none) once you click on Collapse All button.", "originalCommit": "e79093577a661399790d5683c46854dfc88d5702", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTY1MA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r420321650", "bodyText": "Done.", "author": "xnikhil08", "createdAt": "2020-05-05T18:32:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjgyNQ=="}], "type": "inlineReview"}, {"oid": "2d1eb0dccb696d369d1d812f5a47f3081042d50b", "url": "https://github.com/marklogic/marklogic-data-hub/commit/2d1eb0dccb696d369d1d812f5a47f3081042d50b", "message": "DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Implement suggestions in unit/functional tests (+1 squashed commit)\nSquashed commits:\n[bf888c83e] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Removing unnecessary debug statements (+1 squashed commit)\nSquashed commits:\n[9e93a5f55] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Fixed few tests after updating the unique key in source table (+2 squashed commits)\nSquashed commits:\n[85100b6ac] DHFPROD-4216: Fixing issue sin collapse/expand rows and added unit tests\n[4d8cc289b] DHFPROD-4216: Expand all / Collapse all buttons for Mapping UI tables", "committedDate": "2020-05-05T18:20:25Z", "type": "forcePushed"}, {"oid": "267fb3dc373f4f306ed672c860f715b237684a08", "url": "https://github.com/marklogic/marklogic-data-hub/commit/267fb3dc373f4f306ed672c860f715b237684a08", "message": "DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Another fix in xml test for collapse expand (+1 squashed commit)\nSquashed commits:\n[2d1eb0dcc] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Implement suggestions in unit/functional tests (+1 squashed commit)\nSquashed commits:\n[bf888c83e] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Removing unnecessary debug statements (+1 squashed commit)\nSquashed commits:\n[9e93a5f55] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Fixed few tests after updating the unique key in source table (+2 squashed commits)\nSquashed commits:\n[85100b6ac] DHFPROD-4216: Fixing issue sin collapse/expand rows and added unit tests\n[4d8cc289b] DHFPROD-4216: Expand all / Collapse all buttons for Mapping UI tables", "committedDate": "2020-05-05T18:31:33Z", "type": "commit"}, {"oid": "267fb3dc373f4f306ed672c860f715b237684a08", "url": "https://github.com/marklogic/marklogic-data-hub/commit/267fb3dc373f4f306ed672c860f715b237684a08", "message": "DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Another fix in xml test for collapse expand (+1 squashed commit)\nSquashed commits:\n[2d1eb0dcc] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Implement suggestions in unit/functional tests (+1 squashed commit)\nSquashed commits:\n[bf888c83e] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Removing unnecessary debug statements (+1 squashed commit)\nSquashed commits:\n[9e93a5f55] DHFPROD-4216: Collapse All/Expand All buttons for Source and Entity tables in Mapping UI.\nDHFPROD-4216: Fixed few tests after updating the unique key in source table (+2 squashed commits)\nSquashed commits:\n[85100b6ac] DHFPROD-4216: Fixing issue sin collapse/expand rows and added unit tests\n[4d8cc289b] DHFPROD-4216: Expand all / Collapse all buttons for Mapping UI tables", "committedDate": "2020-05-05T18:31:33Z", "type": "forcePushed"}]}