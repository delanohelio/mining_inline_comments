{"pr_number": 4010, "pr_title": "DHFPROD-4914: Adding support for hubDhs and hubSsl properties", "pr_createdAt": "2020-05-27T21:17:21Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4010", "timeline": [{"oid": "2f31cbe305da4b2f9d62943d4e8cd728e18e42b0", "url": "https://github.com/marklogic/marklogic-data-hub/commit/2f31cbe305da4b2f9d62943d4e8cd728e18e42b0", "message": "DHFPROD-4914: Adding support for hubDhs and hubSsl properties\n\nReworked/simplified HubConfigImpl so that refreshProject / loadConfigurationFromProperties go through applyProperties now, ensuring that the propertyConsumerMap is the only thing that applies properties, and does so in a consistent fashion. \n\nOne tricky thing was ensuring that DataHubPlugin uses the *Config objects constructed by ml-gradle. I think how that works is now more clear in the code. \n\nMost of the changes in here are to HubConfigImpl, and most of the changes involved deleting code. \n\nA number of test classes were updated as well based on some updated method signatures in HubConfigImpl. The HubConfig interface itself has not changed.", "committedDate": "2020-05-27T21:11:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ0ODc0OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4010#discussion_r431448748", "bodyText": "This just gets its default property values from a new HubConfigImpl instead of dhf-defaults.properties.", "author": "rjrudin", "createdAt": "2020-05-27T21:19:40Z", "path": "web/src/main/java/com/marklogic/hub/web/model/HubSettings.java", "diffHunk": "@@ -238,73 +202,63 @@ public void setProjectDir(String projectDir) {\n         this.projectDir = projectDir;\n     }\n \n-    @Value(\"${mlHost}\")\n-    String host = null;\n-\n-    String name = \"data-hub\";\n-\n-    @Value(\"${mlStagingDbName}\")\n-    String stagingDbName = null;\n-\n-    @Value(\"${mlStagingTriggersDbName}\")\n-    String stagingTriggersDbName = null;\n-\n-    @Value(\"${mlStagingSchemasDbName}\")\n-    String stagingSchemasDbName = null;\n-\n-    @Value(\"${mlStagingAppserverName}\")\n-    String stagingHttpName = null;\n-\n-    @Value(\"${mlStagingForestsPerHost}\")\n-    Integer stagingForestsPerHost = null;\n-\n-    @Value(\"${mlStagingPort}\")\n-    Integer stagingPort = null;\n-\n-    @Value(\"${mlStagingAuth}\")\n-    String stagingAuthMethod = null;\n+    public HubSettings() {\n+        HubConfig config = new HubConfigImpl();", "originalCommit": "2f31cbe305da4b2f9d62943d4e8cd728e18e42b0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUzMzk3MQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4010#discussion_r431533971", "bodyText": "I am guessing ,we need 2 separate properties because we aren't sure if HC will need SSL to talk to ML. If we decide that we need SSL, one property should be sufficient ?", "author": "srinathgit", "createdAt": "2020-05-28T01:34:45Z", "path": "marklogic-data-hub-central/src/main/resources/application.properties", "diffHunk": "@@ -7,20 +7,8 @@ spring.thymeleaf.prefix=classpath:/static/\n \n # Data Hub connection properties. These default to the expected values for DHS.\n mlHost=localhost\n-mlIsHostLoadBalancer=true\n-mlIsProvisionedEnvironment=true\n-mlManageScheme=https\n-mlManageSimpleSsl=true\n-mlAppServicesAuthentication=basic\n-mlFinalAuth=basic\n-mlJobAuth=basic\n-mlStagingAuth=basic\n-mlAppServicesSimpleSsl=true\n-mlFinalSimpleSsl=true\n-mlJobSimpleSsl=true\n-mlStagingSimpleSsl=true\n-# Need this for getting the version of MarkLogic via the Versions class\n-mlAppServicesPort=8010\n+hubDhs=true\n+hubSsl=true", "originalCommit": "2f31cbe305da4b2f9d62943d4e8cd728e18e42b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MTM0NQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4010#discussion_r431551345", "bodyText": "Exactly - hopefully we only need one soon, just not there yet.", "author": "rjrudin", "createdAt": "2020-05-28T02:44:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUzMzk3MQ=="}], "type": "inlineReview"}]}