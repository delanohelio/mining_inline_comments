{"pr_number": 4554, "pr_title": "DHFPROD-5863: Detail page renders merged xml documents", "pr_createdAt": "2020-09-11T16:33:48Z", "pr_url": "https://github.com/marklogic/marklogic-data-hub/pull/4554", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI0Njk0OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4554#discussion_r487246948", "bodyText": "Let's move the xmlString to UI/src/assets/mock-data folder, may be under 'common.data.ts' or some other appropriate file and then import here so you can use it in multiple places. It makes the tests look cleaner.", "author": "xnikhil08", "createdAt": "2020-09-11T19:27:11Z", "path": "marklogic-data-hub-central/ui/src/components/xml-view/xml-view.test.tsx", "diffHunk": "@@ -0,0 +1,20 @@\n+import {getByText, render} from \"@testing-library/react\";\n+import XmlView from \"../xml-view/xml-view\";\n+import React from \"react\";\n+\n+describe(\"XML view detail component - RTL\", () => {\n+    test('Rendering xml document with es namespace in instance document', () => {\n+        const xmlString = \"<Document><content><es:envelope xmlns:es=\\\"http://marklogic.com/entity-services\\\"><es:instance><Person><fname xsi:type=\\\"xs:string\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xs=\\\"http://www.w3.org/2001/XMLSchema\\\">Alexandra</fname></Person></es:instance></es:envelope></content></Document>\";", "originalCommit": "e33f7c87de646a245e25271ac9c5a58055c8b966", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI4MDU4OA==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4554#discussion_r487280588", "bodyText": "The data is very specific to this test. Should the xmlString go into the UI/src/assets/mock-data folder", "author": "rahulvudutala", "createdAt": "2020-09-11T20:41:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI0Njk0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI5MDY1MQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4554#discussion_r487290651", "bodyText": "@rahulvudutala general guidelines here: https://wiki.marklogic.com/display/ENGINEERING/Writing+Data+Hub+Tests#WritingDataHubTests-RTLTests\nexport it in a file and import in the test even if its specific to a test. Later you might have to enhance it to reuse in another test.\nLets call it namespacedXMLInstance instance of xmlString.", "author": "bsrikan", "createdAt": "2020-09-11T21:06:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI0Njk0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI0NzQzNw==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4554#discussion_r487247437", "bodyText": "Similar changes here as mentioned earlier.", "author": "xnikhil08", "createdAt": "2020-09-11T19:28:32Z", "path": "marklogic-data-hub-central/ui/src/components/xml-view/xml-view.test.tsx", "diffHunk": "@@ -0,0 +1,20 @@\n+import {getByText, render} from \"@testing-library/react\";\n+import XmlView from \"../xml-view/xml-view\";\n+import React from \"react\";\n+\n+describe(\"XML view detail component - RTL\", () => {\n+    test('Rendering xml document with es namespace in instance document', () => {\n+        const xmlString = \"<Document><content><es:envelope xmlns:es=\\\"http://marklogic.com/entity-services\\\"><es:instance><Person><fname xsi:type=\\\"xs:string\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xs=\\\"http://www.w3.org/2001/XMLSchema\\\">Alexandra</fname></Person></es:instance></es:envelope></content></Document>\";\n+        const {  getByTestId, getByText } = render(<XmlView document={xmlString}/>);\n+        expect(getByTestId(\"xml-document\")).toBeInTheDocument();\n+        expect(getByText(\"Alexandra\")).toBeInTheDocument();\n+    });\n+\n+    test('Rendering xml document with no namespace in instance document', () => {\n+        const xmlString = \"<Document><content><envelope xmlns:es=\\\"http://marklogic.com/entity-services\\\"><instance><Person><fname xsi:type=\\\"xs:string\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xmlns:xs=\\\"http://www.w3.org/2001/XMLSchema\\\">Alexandra</fname></Person></instance></envelope></content></Document>\";", "originalCommit": "e33f7c87de646a245e25271ac9c5a58055c8b966", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "65385c8d3db71af7b414afdef832d43c4875c131", "url": "https://github.com/marklogic/marklogic-data-hub/commit/65385c8d3db71af7b414afdef832d43c4875c131", "message": "DHFPROD-5863: Detail page renders merged xml documents", "committedDate": "2020-09-11T21:18:28Z", "type": "forcePushed"}, {"oid": "858a9d22c53149456c779dd17ccc79a051ac0a17", "url": "https://github.com/marklogic/marklogic-data-hub/commit/858a9d22c53149456c779dd17ccc79a051ac0a17", "message": "DHFPROD-5863: Detail page renders merged xml documents\n\nDHFPROD-5863: e2e test for the bug", "committedDate": "2020-09-15T19:50:02Z", "type": "forcePushed"}, {"oid": "cecaf3be51db9c15cdce74a3026c9ee0c5c02542", "url": "https://github.com/marklogic/marklogic-data-hub/commit/cecaf3be51db9c15cdce74a3026c9ee0c5c02542", "message": "DHFPROD-5863: Detail page renders merged xml documents\n\nDHFPROD-5863: e2e test for the bug", "committedDate": "2020-09-15T21:30:44Z", "type": "forcePushed"}, {"oid": "14efa813fce496f54de9e500d304d66d7ae157ef", "url": "https://github.com/marklogic/marklogic-data-hub/commit/14efa813fce496f54de9e500d304d66d7ae157ef", "message": "DHFPROD-5863: Detail page renders merged xml documents\n\nDHFPROD-5863: e2e test for the bug\n\nFix failing unit and e2e test. Committing package-lock.json as well", "committedDate": "2020-09-16T00:27:03Z", "type": "forcePushed"}, {"oid": "cad1cf2d3f4f31dc52c639770a1da956645202e2", "url": "https://github.com/marklogic/marklogic-data-hub/commit/cad1cf2d3f4f31dc52c639770a1da956645202e2", "message": "DHFPROD-5863: Detail page renders merged xml documents\n\nDHFPROD-5863: e2e test for the bug\n\nFix failing unit and e2e test. Committing package-lock.json as well", "committedDate": "2020-09-16T14:11:26Z", "type": "commit"}, {"oid": "cad1cf2d3f4f31dc52c639770a1da956645202e2", "url": "https://github.com/marklogic/marklogic-data-hub/commit/cad1cf2d3f4f31dc52c639770a1da956645202e2", "message": "DHFPROD-5863: Detail page renders merged xml documents\n\nDHFPROD-5863: e2e test for the bug\n\nFix failing unit and e2e test. Committing package-lock.json as well", "committedDate": "2020-09-16T14:11:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUyMDUwNQ==", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4554#discussion_r489520505", "bodyText": "removed getSelectedFacet to reuse existing locators. getSelectedFacet didnt work for null check of an element since it was using contains to match target element.", "author": "bsrikan", "createdAt": "2020-09-16T15:18:07Z", "path": "marklogic-data-hub-central/ui/e2e/cypress/support/pages/browse.tsx", "diffHunk": "@@ -144,8 +144,13 @@ class BrowsePage {\n     return cy.get('[data-cy=selected-facet-block]');\n   }\n \n-  getSelectedFacet(facet: string) {\n-    return cy.get('#selected-facets > button').contains(facet);\n+  computeStartDateOfTheWeek() {", "originalCommit": "cad1cf2d3f4f31dc52c639770a1da956645202e2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}