{"pr_number": 4899, "pr_title": "FISH-326 Add Profile to Deploy Internal JARs", "pr_createdAt": "2020-09-22T15:39:32Z", "pr_url": "https://github.com/payara/Payara/pull/4899", "timeline": [{"oid": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "url": "https://github.com/payara/Payara/commit/427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "message": "FISH-326 Add Profile to Deploy Internal JARs\n\nThe new profile \"deployinternals\" can be used with the deploy goal to\ndeploy to the new Nexus based payara-artifacts repository. Any\nJARs deployed to Maven central are excluded from this goal to prevent\nduplication. The exception is the Payara-API and Payara-BOM, as these\nmay be dependencies of other artifacts.\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>", "committedDate": "2020-09-22T14:24:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODgwNg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r492858806", "bodyText": "Rather than setting all these <skip>false</skip> you can remove any deploy config. None of it is currently used", "author": "MarkWareham", "createdAt": "2020-09-22T16:06:16Z", "path": "pom.xml", "diffHunk": "@@ -347,6 +341,31 @@\n             </build>\n         </profile>\n \n+        <profile>\n+            <id>deployinternals</id>\n+            <activation>\n+                <activeByDefault>false</activeByDefault>\n+            </activation>\n+\n+            <distributionManagement>\n+                <repository>\n+                    <id>payara-nexus</id>\n+                    <url>https://nexus.payara.fish/repository/payara-artifacts/</url>\n+                </repository>\n+            </distributionManagement>\n+\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <artifactId>maven-deploy-plugin</artifactId>\n+                        <configuration>\n+                            <skip>false</skip>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg3Mzk2Ng==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r492873966", "bodyText": "It's currently set to skip every module's deploy phase except for the distribution modules (hence ff4617f). I believe this is needed to override that in this profile.", "author": "MattGill98", "createdAt": "2020-09-22T16:28:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ2NTAxNg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494465016", "bodyText": "This seems redundant. deploy.skip is already set to false by default within this very pom.", "author": "Pandrex247", "createdAt": "2020-09-24T16:47:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk0NjUyNg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494946526", "bodyText": "Nucleus overrides deploy.skip to be true, and then several JARs ignore this property. Would you rather I remove any explicit skip properties and correct the deploy.skip property everywhere?", "author": "MattGill98", "createdAt": "2020-09-25T12:15:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTA2MTkwNQ==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r495061905", "bodyText": "Yes please - only using a property sporadically is abhorrent to me", "author": "Pandrex247", "createdAt": "2020-09-25T15:22:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1ODgwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODExOQ==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458119", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>\n          \n      \n    \n    \n  \n\n\ud83d\udde1", "author": "Pandrex247", "createdAt": "2020-09-24T16:36:06Z", "path": "appserver/extras/embedded/web/pom.xml", "diffHunk": "@@ -371,6 +371,19 @@\n     </dependencies>\n \n     <profiles>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODI0Mg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458242", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:36:17Z", "path": "appserver/extras/embedded/all/pom.xml", "diffHunk": "@@ -468,5 +468,18 @@\n                 </plugins>\n             </build>\n         </profile>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODMyNg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458326", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:36:26Z", "path": "appserver/ejb/ejb-http-remoting/client/pom.xml", "diffHunk": "@@ -133,6 +133,22 @@\n         </plugins>\n     </build>\n \n+    <profiles>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODQzNA==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458434", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:36:35Z", "path": "appserver/distributions/payara/pom.xml", "diffHunk": "@@ -136,6 +136,19 @@\n                 </plugins>\n             </build>\n         </profile>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODUyNg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458526", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:36:44Z", "path": "appserver/distributions/payara-web/pom.xml", "diffHunk": "@@ -134,6 +134,19 @@\n                 </plugins>\n             </build>\n         </profile>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODY0Ng==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458646", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:36:53Z", "path": "appserver/distributions/payara-web-ml/pom.xml", "diffHunk": "@@ -133,6 +133,19 @@\n                 </plugins>\n             </build>\n         </profile>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODcyMQ==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458721", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:37:00Z", "path": "appserver/distributions/payara-ml/pom.xml", "diffHunk": "@@ -131,6 +131,19 @@\n                 </plugins>\n             </build>\n         </profile>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1ODg3Mg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494458872", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:37:15Z", "path": "appserver/extras/payara-micro/payara-micro-distribution/pom.xml", "diffHunk": "@@ -523,5 +523,18 @@\n                 <product.name>Payara Micro Enterprise</product.name>\n             </properties>\n         </profile>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ2MTc1Mg==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494461752", "bodyText": "Doesn't this make specifying the profile activation on each of payara, payara-web, payara-ml,and payara-web-ml redundant?\nYou've set it to uncategorically skip deployment here, and then also told it to skip deployment when the deploy-internal profile is activated.", "author": "Pandrex247", "createdAt": "2020-09-24T16:42:00Z", "path": "nucleus/distributions/pom.xml", "diffHunk": "@@ -168,7 +168,12 @@\n                     </execution>\n                 </executions>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-deploy-plugin</artifactId>\n+                <configuration>\n+                    <skip>true</skip>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk0Njc1NQ==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494946755", "bodyText": "This is nucleus/distributions, not appserver, so only affects minimal", "author": "MattGill98", "createdAt": "2020-09-25T12:15:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ2MTc1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAwMTE4Nw==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r495001187", "bodyText": "\ud83e\udd26\u200d\u2642\ufe0f\nWell the point kind of stands - could we not just do a similar thing over in appserver/distributions rather than specifying it on each distribution there?", "author": "Pandrex247", "createdAt": "2020-09-25T13:50:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ2MTc1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ2MjU1NQ==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494462555", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:43:24Z", "path": "pom.xml", "diffHunk": "@@ -347,6 +341,31 @@\n             </build>\n         </profile>\n \n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ2Mjc5Mw==", "url": "https://github.com/payara/Payara/pull/4899#discussion_r494462793", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <id>deployinternals</id>\n          \n          \n            \n                        <id>deploy-internals</id>", "author": "Pandrex247", "createdAt": "2020-09-24T16:43:49Z", "path": "nucleus/pom.xml", "diffHunk": "@@ -992,6 +992,12 @@ Parent is ${project.parent}</echo>\n     </dependencyManagement>\n \n     <profiles>\n+        <profile>\n+            <id>deployinternals</id>", "originalCommit": "427d50f4188956b4af1dcb3ba2d03fb6d8b9ba7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "76bf98519bf74e85431b9ad591e93daa9a59625a", "url": "https://github.com/payara/Payara/commit/76bf98519bf74e85431b9ad591e93daa9a59625a", "message": "FISH-326 Refactor Deployment Profiles\n\n- Rename 'deployinternals' profile to 'deploy-internals'\n- Reuse 'deploy.skip' property, and remove most overrides that ignore\nthis property\n- Remove all artifacts except for subgroups of 'fish.payara.server' from\nthe 'deploy-internals' profile\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>", "committedDate": "2020-09-28T13:52:28Z", "type": "commit"}, {"oid": "76bf98519bf74e85431b9ad591e93daa9a59625a", "url": "https://github.com/payara/Payara/commit/76bf98519bf74e85431b9ad591e93daa9a59625a", "message": "FISH-326 Refactor Deployment Profiles\n\n- Rename 'deployinternals' profile to 'deploy-internals'\n- Reuse 'deploy.skip' property, and remove most overrides that ignore\nthis property\n- Remove all artifacts except for subgroups of 'fish.payara.server' from\nthe 'deploy-internals' profile\n\nSigned-off-by: Matthew Gill <matthew.gill@live.co.uk>", "committedDate": "2020-09-28T13:52:28Z", "type": "forcePushed"}]}