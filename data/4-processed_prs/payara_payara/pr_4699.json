{"pr_number": 4699, "pr_title": "CUSTCOM-14 Improvements in stop-domain process", "pr_createdAt": "2020-06-04T14:42:25Z", "pr_url": "https://github.com/payara/Payara/pull/4699", "timeline": [{"oid": "3207e1130e128102d148df3b2e7a9b9b98ae5452", "url": "https://github.com/payara/Payara/commit/3207e1130e128102d148df3b2e7a9b9b98ae5452", "message": "CUSTCOM-14 Improvements in stop-domain process", "committedDate": "2020-06-04T14:15:02Z", "type": "commit"}, {"oid": "a32d0a75bbedfba50b1650b180bce0c79b002da0", "url": "https://github.com/payara/Payara/commit/a32d0a75bbedfba50b1650b180bce0c79b002da0", "message": "Removed debugging code", "committedDate": "2020-06-04T14:25:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5Njc3Ng==", "url": "https://github.com/payara/Payara/pull/4699#discussion_r435396776", "bodyText": "Doesn't this change make the TODO comment obsolete?", "author": "svendiedrichsen", "createdAt": "2020-06-04T16:38:34Z", "path": "nucleus/admin/server-mgmt/src/main/java/com/sun/enterprise/admin/servermgmt/cli/StopDomainCommand.java", "diffHunk": "@@ -98,7 +99,7 @@ protected void initDomain() throws CommandException {\n         // TODO Byron said in April 2013 that we should probably just check if\n         // NetUtils says that the getHost() --> isThisMe() rather than merely\n         // checking for the magic \"localhost\" string.  Too risky to fool with it today.\n-        if (programOpts.getHost().equals(CLIConstants.DEFAULT_HOSTNAME)) {\n+        if (NetUtils.isThisHostLocal(programOpts.getHost())) {", "originalCommit": "a32d0a75bbedfba50b1650b180bce0c79b002da0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5MTgxNQ==", "url": "https://github.com/payara/Payara/pull/4699#discussion_r435791815", "bodyText": "This seems like a stronger way of checking the startup state of the server - why has this been removed?", "author": "MattGill98", "createdAt": "2020-06-05T09:10:04Z", "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/server/AppServerStartup.java", "diffHunk": "@@ -222,18 +220,10 @@ public synchronized void start() {\n             // See issue #5596 to know why we set context CL as common CL.\n             Thread.currentThread().setContextClassLoader(\n                     commonCLS.getCommonClassLoader());\n-            if (state.compareAndSet(State.INITIAL, State.STARTING) || state.compareAndSet(State.SHUT_DOWN, State.STARTING)) {", "originalCommit": "a32d0a75bbedfba50b1650b180bce0c79b002da0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkyMzg1OQ==", "url": "https://github.com/payara/Payara/pull/4699#discussion_r435923859", "bodyText": "I messed up my commit history and mistakenly removed the previous commit made by Patrick. I will fix it and update the PR. Thanks for pointing out", "author": "MeroRai", "createdAt": "2020-06-05T13:33:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5MTgxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5MjIxOQ==", "url": "https://github.com/payara/Payara/pull/4699#discussion_r435792219", "bodyText": "Who's Jerome? \ud83d\ude02", "author": "MattGill98", "createdAt": "2020-06-05T09:10:42Z", "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/server/AppServerStartup.java", "diffHunk": "@@ -475,23 +466,31 @@ public static void printModuleStatus(ModulesRegistry registry, Level level) {\n         logger.log(level, sb.toString());\n     }\n \n+    // TODO(Sahoo): Revisit this method after discussing with Jerome.", "originalCommit": "a32d0a75bbedfba50b1650b180bce0c79b002da0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkyNDAyNQ==", "url": "https://github.com/payara/Payara/pull/4699#discussion_r435924025", "bodyText": "Read the above comment", "author": "MeroRai", "createdAt": "2020-06-05T13:34:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5MjIxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk3NTMzMQ==", "url": "https://github.com/payara/Payara/pull/4699#discussion_r435975331", "bodyText": "Is there a parameter AppServerActivator missing? At least you have added the comment about one.", "author": "svendiedrichsen", "createdAt": "2020-06-05T14:53:05Z", "path": "nucleus/core/kernel/src/main/java/com/sun/enterprise/v3/server/AppServerStartup.java", "diffHunk": "@@ -543,9 +543,11 @@ public synchronized void stop() {\n     }\n \n     /**\n-     * Proceed to the given run level.\n+     * Proceed to the given run level using the given {@link AppServerActivator}.\n      *\n      * @param runLevel   the run level to proceed to\n+     * @param activator  an {@link AppServerActivator activator} used to\n+     *                   activate/deactivate the services\n      * @return false if an error occurred that required server shutdown; true otherwise\n      */\n     private boolean proceedTo(int runLevel) {", "originalCommit": "a32d0a75bbedfba50b1650b180bce0c79b002da0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b9a52c2c53767f5a22f459052a6011f353da4ca2", "url": "https://github.com/payara/Payara/commit/b9a52c2c53767f5a22f459052a6011f353da4ca2", "message": "* Removed obsolete comments\n* Added back Patrik's commit which was removed by mistake\"", "committedDate": "2020-06-09T09:50:50Z", "type": "commit"}]}