{"pr_number": 5074, "pr_title": "[FISH-759] sort instances in admin console", "pr_createdAt": "2020-12-29T00:24:55Z", "pr_url": "https://github.com/payara/Payara/pull/5074", "timeline": [{"oid": "4e668b7d650872018b8a8d2827e1cfd8c4b7f757", "url": "https://github.com/payara/Payara/commit/4e668b7d650872018b8a8d2827e1cfd8c4b7f757", "message": "FISH-759 Sort instance list by name", "committedDate": "2020-12-29T00:20:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzc4Mg==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549827782", "bodyText": "final", "author": "lprimak", "createdAt": "2020-12-29T19:52:16Z", "path": "nucleus/cluster/admin/src/main/java/com/sun/enterprise/v3/admin/cluster/ListInstancesCommand.java", "diffHunk": "@@ -214,32 +214,32 @@ private boolean notDas(String name) {\n         return !SystemPropertyConstants.DAS_SERVER_NAME.equals(name);\n     }\n \n-    private void yesStatus(List<Server> serverList, int timeoutInMsec, Logger logger) {\n+    private void yesStatus(final List<Server> serverList, final int timeoutInMsec, final Logger logger) {\n         // Gather a list of InstanceInfo -- one per instance in domain.xml\n-        RemoteInstanceCommandHelper helper = new RemoteInstanceCommandHelper(habitat);\n+        final RemoteInstanceCommandHelper helper = new RemoteInstanceCommandHelper(habitat);", "originalCommit": "ab69439f4c43aabfdf90e062c8880fcb1162186f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg4NTQ5MQ==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549885491", "bodyText": "Please remove final in your changes. That just adds clutter to the code and doesn't really do anything\n\nI have to disagree with following reasons:\n\nit should help to distinguish which variables are variable and\nfinal variables does the code flow pretty staight forward. I mean if variable is final, there are no side effects and I can concentrate to pitfals of reused variables (wich may be really nasty). For example trying to find where regis variable comes consumes a lot of brain power (which have to be gathered from chocolate or coffe): \n  \n    \n      Payara/appserver/web/web-core/src/main/java/org/apache/catalina/core/StandardContext.java\n    \n    \n         Line 3624\n      in\n      75cc478\n    \n    \n    \n    \n\n        \n          \n           return regis; \n        \n    \n  \n\n\nfinal variables reduces scope where variable might be set and improves learning curve of code for contributors (by reducing possibilities where variable can be changed)\nnon final variables are like exclamation mark and acts like point of interest in case of hunting bugs\nin old codebase final reveals scoping problems (\n\nbefore (C89 declaration style):\nString x = null;\nwhile (...) {\n  x = \"some String\";\n  ...\n}\n\nafter (Java style):\nwhile (...) {\n  final String x = \"some String\";\n  ...\n}\n\nI know some time ago there was a discussion, but I do not know the final decision.\nFor reference there is PR in commons-lang3 with the similar idiom. apache/commons-lang@37c2231\nAnother insteresting references\n\nhttps://softwareengineering.stackexchange.com/questions/98691/excessive-use-final-keyword-in-java\nhttps://stackoverflow.com/questions/137868/using-the-final-modifier-whenever-applicable-in-java\n\nSo if there is consensus on that the final is just garbage, I can discard the last commit.\nPersonally I would preffer to use final at least in methods that are longer than usual and contains if constructs. In case final keyword is not wanted in all possible places.", "author": "sgflt", "createdAt": "2020-12-29T23:24:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzc4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg4NjU2Ng==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549886566", "bodyText": "This reminds me of putting const everywhere you can in C++.\nEverything is good in moderation, this is way beyond the scope of this PR\nand doesn't go with the rest of the code.\nPlease remove finals.\nthank you", "author": "lprimak", "createdAt": "2020-12-29T23:30:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzc4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk2NDkyOA==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549964928", "bodyText": "But you are right in code review, it should be in different PR.", "author": "sgflt", "createdAt": "2020-12-30T07:00:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzc4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzgwOA==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549827808", "bodyText": "final", "author": "lprimak", "createdAt": "2020-12-29T19:52:22Z", "path": "nucleus/cluster/admin/src/main/java/com/sun/enterprise/v3/admin/cluster/ListInstancesCommand.java", "diffHunk": "@@ -214,32 +214,32 @@ private boolean notDas(String name) {\n         return !SystemPropertyConstants.DAS_SERVER_NAME.equals(name);\n     }\n \n-    private void yesStatus(List<Server> serverList, int timeoutInMsec, Logger logger) {\n+    private void yesStatus(final List<Server> serverList, final int timeoutInMsec, final Logger logger) {\n         // Gather a list of InstanceInfo -- one per instance in domain.xml\n-        RemoteInstanceCommandHelper helper = new RemoteInstanceCommandHelper(habitat);\n+        final RemoteInstanceCommandHelper helper = new RemoteInstanceCommandHelper(habitat);\n \n-        for (Server server : serverList) {\n-            boolean clustered = server.getCluster() != null;\n-            int port = helper.getAdminPort(server);\n-            String host = server.getAdminHost();\n+        for (final Server server : serverList) {", "originalCommit": "ab69439f4c43aabfdf90e062c8880fcb1162186f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4e668b7d650872018b8a8d2827e1cfd8c4b7f757", "url": "https://github.com/payara/Payara/commit/4e668b7d650872018b8a8d2827e1cfd8c4b7f757", "message": "FISH-759 Sort instance list by name", "committedDate": "2020-12-29T00:20:45Z", "type": "forcePushed"}, {"oid": "c567dace5328ecb9c0ad43768e905992d91e4ad4", "url": "https://github.com/payara/Payara/commit/c567dace5328ecb9c0ad43768e905992d91e4ad4", "message": "FISH-759 Sort also configurations", "committedDate": "2020-12-30T08:05:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzgyNQ==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549827825", "bodyText": "final", "author": "lprimak", "createdAt": "2020-12-29T19:52:27Z", "path": "nucleus/cluster/admin/src/main/java/com/sun/enterprise/v3/admin/cluster/ListInstancesCommand.java", "diffHunk": "@@ -214,32 +214,32 @@ private boolean notDas(String name) {\n         return !SystemPropertyConstants.DAS_SERVER_NAME.equals(name);\n     }\n \n-    private void yesStatus(List<Server> serverList, int timeoutInMsec, Logger logger) {\n+    private void yesStatus(final List<Server> serverList, final int timeoutInMsec, final Logger logger) {\n         // Gather a list of InstanceInfo -- one per instance in domain.xml\n-        RemoteInstanceCommandHelper helper = new RemoteInstanceCommandHelper(habitat);\n+        final RemoteInstanceCommandHelper helper = new RemoteInstanceCommandHelper(habitat);\n \n-        for (Server server : serverList) {\n-            boolean clustered = server.getCluster() != null;\n-            int port = helper.getAdminPort(server);\n-            String host = server.getAdminHost();\n+        for (final Server server : serverList) {\n+            final boolean clustered = server.getCluster() != null;\n+            final int port = helper.getAdminPort(server);\n+            final String host = server.getAdminHost();\n \n             if (standaloneonly && clustered) {\n                 continue;\n             }\n \n-            String name = server.getName();\n+            final String name = server.getName();\n \n             if (name == null) {\n                 continue;   // can this happen?!?\n             }\n             \n-            StringBuilder deploymentGroup = new StringBuilder();\n-            for (DeploymentGroup dg : server.getDeploymentGroup()) {\n+            final StringBuilder deploymentGroup = new StringBuilder();\n+            for (final DeploymentGroup dg : server.getDeploymentGroup()) {\n                 deploymentGroup.append(dg.getName()).append(' ');\n             }\n \n-            Cluster cluster = domain.getClusterForInstance(name);\n-            String clusterName = (cluster != null) ? cluster.getName() : null;\n+            final Cluster cluster = domain.getClusterForInstance(name);\n+            final String clusterName = (cluster != null) ? cluster.getName() : null;", "originalCommit": "ab69439f4c43aabfdf90e062c8880fcb1162186f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzg0MQ==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549827841", "bodyText": "final", "author": "lprimak", "createdAt": "2020-12-29T19:52:31Z", "path": "nucleus/cluster/admin/src/main/java/com/sun/enterprise/v3/admin/cluster/ListInstancesCommand.java", "diffHunk": "@@ -262,24 +262,26 @@ private void yesStatus(List<Server> serverList, int timeoutInMsec, Logger logger\n             return;\n         }\n \n-        Properties extraProps = new Properties();\n-        List instanceList = new ArrayList();\n \n-        for (InstanceInfo ii : infos) {\n-            String name = ii.getName();\n+        final Properties extraProps = new Properties();", "originalCommit": "ab69439f4c43aabfdf90e062c8880fcb1162186f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNzg2NA==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r549827864", "bodyText": "final", "author": "lprimak", "createdAt": "2020-12-29T19:52:37Z", "path": "nucleus/cluster/admin/src/main/java/com/sun/enterprise/v3/admin/cluster/ListInstancesCommand.java", "diffHunk": "@@ -262,24 +262,26 @@ private void yesStatus(List<Server> serverList, int timeoutInMsec, Logger logger\n             return;\n         }\n \n-        Properties extraProps = new Properties();\n-        List instanceList = new ArrayList();\n \n-        for (InstanceInfo ii : infos) {\n-            String name = ii.getName();\n+        final Properties extraProps = new Properties();\n+        final List<Map<String, Object>> instanceList = new ArrayList<>();\n+\n+        infos.sort(Comparator.comparing(InstanceInfo::getName));\n+        for (final InstanceInfo ii : infos) {\n+            final String name = ii.getName();\n             String value = (ii.isRunning()) ? InstanceState.StateType.RUNNING.getDescription()\n                     : InstanceState.StateType.NOT_RUNNING.getDescription();\n-            InstanceState.StateType state = (ii.isRunning())\n+            final InstanceState.StateType state = (ii.isRunning())\n                     ? (stateService.setState(name, InstanceState.StateType.RUNNING, false))\n                     : (stateService.setState(name, InstanceState.StateType.NOT_RUNNING, false));\n-            List<String> failedCmds = stateService.getFailedCommands(name);\n+            final List<String> failedCmds = stateService.getFailedCommands(name);", "originalCommit": "ab69439f4c43aabfdf90e062c8880fcb1162186f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d77a4862350fd16b0d091ca96f24a616733faf5e", "url": "https://github.com/payara/Payara/commit/d77a4862350fd16b0d091ca96f24a616733faf5e", "message": "FISH-759 Got rid of wildcard import", "committedDate": "2020-12-30T19:05:48Z", "type": "commit"}, {"oid": "41f5bb1ec1c129fd51388a99ad9815cc78bca45a", "url": "https://github.com/payara/Payara/commit/41f5bb1ec1c129fd51388a99ad9815cc78bca45a", "message": "FISH-759 Updated JDK 1.4 generics to JDK 8 style in ClusterHandler", "committedDate": "2020-12-30T19:21:01Z", "type": "commit"}, {"oid": "3695d6ca87032f12056284935c95c7d29d7a0be5", "url": "https://github.com/payara/Payara/commit/3695d6ca87032f12056284935c95c7d29d7a0be5", "message": "FISH-759 Updated JDK 1.5 generics to JDK 8 style in ListInstancesCommand", "committedDate": "2020-12-30T19:24:46Z", "type": "commit"}, {"oid": "3a4a6f17a8144d98985485a1b4a6aadfa7eb6b90", "url": "https://github.com/payara/Payara/commit/3a4a6f17a8144d98985485a1b4a6aadfa7eb6b90", "message": "FISH-759 Updated JDK 1.4 generics to JDK 8 style in ListInstancesCommand", "committedDate": "2020-12-30T19:32:43Z", "type": "commit"}, {"oid": "bce5974248f414f1da37496900d07973ca17ae7e", "url": "https://github.com/payara/Payara/commit/bce5974248f414f1da37496900d07973ca17ae7e", "message": "FISH-759 Removed unused import", "committedDate": "2020-12-30T19:38:52Z", "type": "commit"}, {"oid": "524ba46ef046c9857d7176d9c1eb23835317913f", "url": "https://github.com/payara/Payara/commit/524ba46ef046c9857d7176d9c1eb23835317913f", "message": "FISH-759 Removed unused variable", "committedDate": "2020-12-30T19:39:00Z", "type": "commit"}, {"oid": "fc0c0901397c5c8f499ceac951b2bc74c1a017c7", "url": "https://github.com/payara/Payara/commit/fc0c0901397c5c8f499ceac951b2bc74c1a017c7", "message": "FISH-759 Fixed spacing around =", "committedDate": "2020-12-30T19:39:33Z", "type": "commit"}, {"oid": "8e06150a197c1c96ee3a22810a58397b6c676e59", "url": "https://github.com/payara/Payara/commit/8e06150a197c1c96ee3a22810a58397b6c676e59", "message": "FISH-759 IntelliJ automatic code clean up", "committedDate": "2020-12-30T19:40:22Z", "type": "commit"}, {"oid": "ca2115f0889a9e01ef70ae17bfe29d97fa0e85fc", "url": "https://github.com/payara/Payara/commit/ca2115f0889a9e01ef70ae17bfe29d97fa0e85fc", "message": "FISH-759 Fixed whitespaces", "committedDate": "2020-12-30T19:42:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODM3NjkwNg==", "url": "https://github.com/payara/Payara/pull/5074#discussion_r558376906", "bodyText": "Ha!", "author": "dmatej", "createdAt": "2021-01-15T15:21:24Z", "path": "nucleus/cluster/admin/src/main/java/com/sun/enterprise/v3/admin/cluster/ListInstancesCommand.java", "diffHunk": "@@ -263,8 +263,9 @@ private void yesStatus(List<Server> serverList, int timeoutInMsec, Logger logger\n         }\n \n         Properties extraProps = new Properties();\n-        List instanceList = new ArrayList();\n+        List<Map<String, Object>> instanceList = new ArrayList<>();\n \n+        infos.sort(Comparator.comparing(InstanceInfo::getName));", "originalCommit": "ca2115f0889a9e01ef70ae17bfe29d97fa0e85fc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}