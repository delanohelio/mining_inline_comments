{"pr_number": 1326, "pr_title": "Fix service name caching based on context path", "pr_createdAt": "2020-08-05T05:59:27Z", "pr_url": "https://github.com/elastic/apm-agent-java/pull/1326", "timeline": [{"oid": "1d7306a864f4773e9ca65b89ec2645f2c409b37b", "url": "https://github.com/elastic/apm-agent-java/commit/1d7306a864f4773e9ca65b89ec2645f2c409b37b", "message": "Fix service name caching based on context path", "committedDate": "2020-08-05T05:55:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU4NzI0OQ==", "url": "https://github.com/elastic/apm-agent-java/pull/1326#discussion_r465587249", "bodyText": "Just FYT, in #1303, I've create a WeakMapSupplier.createSet() method.", "author": "felixbarny", "createdAt": "2020-08-05T09:13:55Z", "path": "apm-agent-plugins/apm-servlet-plugin/src/main/java/co/elastic/apm/agent/servlet/ServletGlobalState.java", "diffHunk": "@@ -33,7 +35,7 @@\n @GlobalState\n public class ServletGlobalState {\n \n-    public static final Set<String> nameInitialized = Collections.newSetFromMap(new ConcurrentHashMap<String, Boolean>());\n+    public static final WeakConcurrentMap<ClassLoader, Boolean> nameInitialized = WeakMapSupplier.createMap();", "originalCommit": "1d7306a864f4773e9ca65b89ec2645f2c409b37b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTYyMDM1MA==", "url": "https://github.com/elastic/apm-agent-java/pull/1326#discussion_r465620350", "bodyText": "If I remember that after merging #1303, I will switch to using it instead.", "author": "eyalkoren", "createdAt": "2020-08-05T10:12:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU4NzI0OQ=="}], "type": "inlineReview"}, {"oid": "6236fdd79477916f39787fe3e382948f0ecf1b41", "url": "https://github.com/elastic/apm-agent-java/commit/6236fdd79477916f39787fe3e382948f0ecf1b41", "message": "Add to CHANGELOG", "committedDate": "2020-08-05T09:51:51Z", "type": "commit"}]}