{"pr_number": 1564, "pr_title": "[JJBB] Load testing MBP", "pr_createdAt": "2020-12-09T10:18:14Z", "pr_url": "https://github.com/elastic/apm-agent-java/pull/1564", "timeline": [{"oid": "dcc1260300e121428feb09a480bc1ace0622a513", "url": "https://github.com/elastic/apm-agent-java/commit/dcc1260300e121428feb09a480bc1ace0622a513", "message": "[JJBB] Load testing MBP", "committedDate": "2020-12-09T10:16:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4MTI3MA==", "url": "https://github.com/elastic/apm-agent-java/pull/1564#discussion_r539181270", "bodyText": "Filter only master and PRs", "author": "v1v", "createdAt": "2020-12-09T10:18:28Z", "path": ".ci/jobs/apm-agent-java-load-mbp.yml", "diffHunk": "@@ -0,0 +1,44 @@\n+---\n+##### MBP JOB\n+- job:\n+    name: apm-agent-java/apm-agent-java-load-mbp\n+    display-name: APM Agent Java Load Testing\n+    description: APM Agent Java Load Testing\n+    script-path: .ci/load/Jenkinsfile\n+    project-type: multibranch\n+    scm:\n+        - github:\n+            branch-discovery: no-pr\n+            discover-pr-forks-strategy: merge-current\n+            discover-pr-forks-trust: permission\n+            discover-pr-origin: merge-current\n+            discover-tags: false\n+            disable-pr-notifications: true\n+            notification-context: 'apm-ci'\n+            head-filter-regex: '(master|PR-.*)'", "originalCommit": "dcc1260300e121428feb09a480bc1ace0622a513", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4OTY4Ng==", "url": "https://github.com/elastic/apm-agent-java/pull/1564#discussion_r539189686", "bodyText": "Since the repository is the agent repository, not all PRs are related to load-testing.\n\ncould we have a way to filter those, maybe on branch/PR name pattern ?\n\nFor example, if we want to filter on branch name, would having (master|wip-load-testing-.*) instead allow to have:\n\none instance of the job for master\none instance of the job for each branch matching pattern wip-load-testing-*.\n\nOne very minor downside of relying on branch name and not on PR would be to require pushing to the upstream repository.", "author": "SylvainJuge", "createdAt": "2020-12-09T10:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4MTI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE5MjY4OA==", "url": "https://github.com/elastic/apm-agent-java/pull/1564#discussion_r539192688", "bodyText": "Let me explain a bit better:\nThe requirement we had in mind was to support the run of PRs that are related to the load testing, for such we took in consideration:\n\nthere will no be automated builds for any PRs, or commits into the master branch.\nThe only way to interact with it would be manually -> apm-agent-java-load-mbp (once the job is created)", "author": "v1v", "createdAt": "2020-12-09T10:34:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4MTI3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4MTM5OA==", "url": "https://github.com/elastic/apm-agent-java/pull/1564#discussion_r539181398", "bodyText": "Avoid GH status checks", "author": "v1v", "createdAt": "2020-12-09T10:18:40Z", "path": ".ci/jobs/apm-agent-java-load-mbp.yml", "diffHunk": "@@ -0,0 +1,44 @@\n+---\n+##### MBP JOB\n+- job:\n+    name: apm-agent-java/apm-agent-java-load-mbp\n+    display-name: APM Agent Java Load Testing\n+    description: APM Agent Java Load Testing\n+    script-path: .ci/load/Jenkinsfile\n+    project-type: multibranch\n+    scm:\n+        - github:\n+            branch-discovery: no-pr\n+            discover-pr-forks-strategy: merge-current\n+            discover-pr-forks-trust: permission\n+            discover-pr-origin: merge-current\n+            discover-tags: false\n+            disable-pr-notifications: true", "originalCommit": "dcc1260300e121428feb09a480bc1ace0622a513", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4MTYyMQ==", "url": "https://github.com/elastic/apm-agent-java/pull/1564#discussion_r539181621", "bodyText": "Avoid running when a PR is created or a merge to master happens automatically", "author": "v1v", "createdAt": "2020-12-09T10:19:01Z", "path": ".ci/jobs/apm-agent-java-load-mbp.yml", "diffHunk": "@@ -0,0 +1,44 @@\n+---\n+##### MBP JOB\n+- job:\n+    name: apm-agent-java/apm-agent-java-load-mbp\n+    display-name: APM Agent Java Load Testing\n+    description: APM Agent Java Load Testing\n+    script-path: .ci/load/Jenkinsfile\n+    project-type: multibranch\n+    scm:\n+        - github:\n+            branch-discovery: no-pr\n+            discover-pr-forks-strategy: merge-current\n+            discover-pr-forks-trust: permission\n+            discover-pr-origin: merge-current\n+            discover-tags: false\n+            disable-pr-notifications: true\n+            notification-context: 'apm-ci'\n+            head-filter-regex: '(master|PR-.*)'\n+            repo: apm-agent-java\n+            repo-owner: elastic\n+            credentials-id: 2a9602aa-ab9f-4e52-baf3-b71ca88469c7-UserAndToken\n+            ssh-checkout:\n+            credentials: f6c7695a-671e-4f4f-a331-acdce44ff9ba\n+            property-strategies:\n+                all-branches:\n+                - suppress-scm-triggering: true", "originalCommit": "dcc1260300e121428feb09a480bc1ace0622a513", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE4MTc4MA==", "url": "https://github.com/elastic/apm-agent-java/pull/1564#discussion_r539181780", "bodyText": "Ensure the first time contributor check happens", "author": "v1v", "createdAt": "2020-12-09T10:19:15Z", "path": ".ci/load/Jenkinsfile", "diffHunk": "@@ -40,7 +40,7 @@ pipeline {\n     stages {\n         stage('Pre-flight') {\n             steps {\n-                checkout scm\n+                gitCheckout(basedir: '.', githubNotifyFirstTimeContributor: true, shallow: false)", "originalCommit": "dcc1260300e121428feb09a480bc1ace0622a513", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}