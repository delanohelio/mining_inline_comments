{"pr_number": 1659, "pr_title": "Add check for unzip", "pr_createdAt": "2020-05-18T14:16:39Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659", "timeline": [{"oid": "fed2cb95c8a49a52705c8447d77bcce7601effed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fed2cb95c8a49a52705c8447d77bcce7601effed", "message": "Add check for unzip", "committedDate": "2020-05-14T17:58:26Z", "type": "commit"}, {"oid": "edc548f89223143b3c58b5e69269693477e5128a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/edc548f89223143b3c58b5e69269693477e5128a", "message": "update wordings", "committedDate": "2020-05-18T14:15:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY4NjgxOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426686819", "bodyText": "LGTM.\nMinor nits for the SEVEREs:  I think it helps to put '' around each keywords like 'tar', 'gzip', 'unzip', and 'FromModel', and end sentences with a period '.'.", "author": "tbarnes-us", "createdAt": "2020-05-18T14:55:12Z", "path": "operator/src/main/resources/scripts/introspectDomain.sh", "diffHunk": "@@ -119,19 +119,23 @@ if [ ${DOMAIN_SOURCE_TYPE} == \"FromModel\" ]; then\n     trace \"Beginning Model In Image\"\n     command -v gzip\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"gzip is missing - image must have gzip installed \" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, gzip is missing in the image. Please use an image with gzip installed\" && exit 1\n     fi\n     command -v tar\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"tar is missing - image must have tar installed \" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, tar is missing in the image. Please use an image with tar installed\" && exit 1\n+    fi\n+    command -v unzip\n+    if [ $? -ne 0 ] ; then\n+      trace SEVERE \"DomainSourceType is FromModel, unzip is missing in the image. Please use an image with unzip installed\" && exit 1\n     fi\n     mkdir -p ${DOMAIN_HOME}\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"cannot create domain home directory '${DOMAIN_HOME}'\" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, cannot create domain home directory '${DOMAIN_HOME}'\" && exit 1", "originalCommit": "edc548f89223143b3c58b5e69269693477e5128a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg0MzA0OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426843049", "bodyText": "Let's make these edits and then I'll commit.", "author": "rjeberhard", "createdAt": "2020-05-18T19:20:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY4NjgxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg2NzIwNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426867205", "bodyText": "done", "author": "jshum2479", "createdAt": "2020-05-18T20:10:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY4NjgxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg2ODQ2Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426868466", "bodyText": "Minor nits still buzzing around:  Still missing periods at end of each SEVERE sentence.  Would be nice to have quotes around FromModel too.", "author": "tbarnes-us", "createdAt": "2020-05-18T20:13:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY4NjgxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY5MDc0MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426690740", "bodyText": "Minor nit:  It'd be nice to put a test file in the domain home directory just to verify that it's  accessible - so we can  'fail fast' when hitting a directory access issue.\ntouch ${DOMAIN_HOME}/testaccess.tmp\nif [ $? -ne 0 ]; then\nyadayada Cannot write to domain home directory '${DOMAIN_HOME}' yadayayada\nexit 1\nfi\nrm -f ${DOMAIN_HOME}/testaccess.tmp", "author": "tbarnes-us", "createdAt": "2020-05-18T15:00:20Z", "path": "operator/src/main/resources/scripts/introspectDomain.sh", "diffHunk": "@@ -119,19 +119,23 @@ if [ ${DOMAIN_SOURCE_TYPE} == \"FromModel\" ]; then\n     trace \"Beginning Model In Image\"\n     command -v gzip\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"gzip is missing - image must have gzip installed \" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, gzip is missing in the image. Please use an image with gzip installed\" && exit 1\n     fi\n     command -v tar\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"tar is missing - image must have tar installed \" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, tar is missing in the image. Please use an image with tar installed\" && exit 1\n+    fi\n+    command -v unzip\n+    if [ $? -ne 0 ] ; then\n+      trace SEVERE \"DomainSourceType is FromModel, unzip is missing in the image. Please use an image with unzip installed\" && exit 1\n     fi\n     mkdir -p ${DOMAIN_HOME}\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"cannot create domain home directory '${DOMAIN_HOME}'\" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, cannot create domain home directory '${DOMAIN_HOME}'\" && exit 1\n     fi", "originalCommit": "edc548f89223143b3c58b5e69269693477e5128a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg2NzE2NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426867164", "bodyText": "done", "author": "jshum2479", "createdAt": "2020-05-18T20:10:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY5MDc0MA=="}], "type": "inlineReview"}, {"oid": "18d63354bc55cacbde30ed3b544c4c6275db78a4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/18d63354bc55cacbde30ed3b544c4c6275db78a4", "message": "minor fix", "committedDate": "2020-05-18T20:09:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjg2NzY1Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1659#discussion_r426867657", "bodyText": "Missing period.", "author": "tbarnes-us", "createdAt": "2020-05-18T20:11:27Z", "path": "operator/src/main/resources/scripts/introspectDomain.sh", "diffHunk": "@@ -119,20 +119,25 @@ if [ ${DOMAIN_SOURCE_TYPE} == \"FromModel\" ]; then\n     trace \"Beginning Model In Image\"\n     command -v gzip\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"DomainSourceType is FromModel, gzip is missing in the image. Please use an image with gzip installed\" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, 'gzip' is missing in the image. Please use an image with 'gzip' installed\" && exit 1\n     fi\n     command -v tar\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"DomainSourceType is FromModel, tar is missing in the image. Please use an image with tar installed\" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, 'tar' is missing in the image. Please use an image with 'tar' installed\" && exit 1\n     fi\n     command -v unzip\n     if [ $? -ne 0 ] ; then\n-      trace SEVERE \"DomainSourceType is FromModel, unzip is missing in the image. Please use an image with unzip installed\" && exit 1\n+      trace SEVERE \"DomainSourceType is FromModel, 'unzip' is missing in the image. Please use an image with 'unzip' installed\" && exit 1\n     fi\n     mkdir -p ${DOMAIN_HOME}\n     if [ $? -ne 0 ] ; then\n       trace SEVERE \"DomainSourceType is FromModel, cannot create domain home directory '${DOMAIN_HOME}'\" && exit 1\n     fi\n+    touch ${DOMAIN_HOME}/testaccess.tmp\n+    if [ $? -ne 0 ]; then\n+      trace SEVERE \"DomainSourceType is FromModel, cannot write to domain home directory '${DOMAIN_HOME}'\" && exit 1", "originalCommit": "18d63354bc55cacbde30ed3b544c4c6275db78a4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "05957c78aefa66c0364dad8b31f0f57c42f3fbf4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/05957c78aefa66c0364dad8b31f0f57c42f3fbf4", "message": "Update introspectDomain.sh", "committedDate": "2020-05-20T15:06:40Z", "type": "commit"}]}