{"pr_number": 1682, "pr_title": "Implement distribution strategy for config override changes", "pr_createdAt": "2020-05-27T15:52:48Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682", "timeline": [{"oid": "383b0be3c3409f923dac5b421c620a5093a7cd3f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/383b0be3c3409f923dac5b421c620a5093a7cd3f", "message": "When configured, tell server pod to copy changed overrides", "committedDate": "2020-05-27T15:41:50Z", "type": "commit"}, {"oid": "a992bd73323c3d97be1b863cf8b4ebb7e31dca25", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a992bd73323c3d97be1b863cf8b4ebb7e31dca25", "message": "Rename copySitCfg functions in livenessProbe.sh and startServer.sh", "committedDate": "2020-05-27T15:42:10Z", "type": "commit"}, {"oid": "20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "message": "make copy conditional", "committedDate": "2020-05-27T15:42:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431288477", "bodyText": "or overridesConfigMaps fields. --> or overridesConfigMaps fields once the introspectVersion is changed.\n\nOr something similar.\nThe idea is to make it clear that the strategy is related to handling a change to the introspectVersion field.\nDo the same edit for all related discussion of distributionStrategy since they're all tied to introspectVersion.\nAlso, consider changing the name to 'introspectVersionDistributionStrategy' or similar...", "author": "tbarnes-us", "createdAt": "2020-05-27T16:43:19Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -183,6 +183,14 @@\n           \"description\": \"Model in image model files and properties.\",\n           \"$ref\": \"#/definitions/Model\"\n         },\n+        \"distributionStrategy\": {\n+          \"description\": \"The strategy for handling changes to the secrets or overridesConfigMap fields. Legal values are DYNAMIC and ON_RESTART.\",", "originalCommit": "20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5MTQxNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431291415", "bodyText": "As far as I know, this has nothing to do with introspection. It is triggered by a change to the specified fields in the domain resource only.", "author": "russgold", "createdAt": "2020-05-27T16:48:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMxNzA5Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431317093", "bodyText": "Wait, what?  We need to discuss with @rjeberhard", "author": "tbarnes-us", "createdAt": "2020-05-27T17:28:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMzODEzOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431338139", "bodyText": "Here is my understanding of this field. In operator 2.5.0, introspection could only happen on initial domain creation or following a cold shutdown, so no servers presently running. Therefore, we had no issues about how changes to any of the inputs that affect the final configuration overrides would affect running servers. Now, we have a specific need to run introspection when servers are running and even to distribute updated configuration overrides to those running servers. However, since we can't test every combination of changes to these various inputs we introduced two guards: 1) The introspectVersion, which lets the customer explicitly trigger introspection and thereby confirming that all of the inputs are ready, and 2) the distribution strategy, which lets the customer select not distributing the updated strategy dynamically to already running servers.", "author": "rjeberhard", "createdAt": "2020-05-27T17:58:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM0NDI1Mg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431344252", "bodyText": "I guess I don't know what Russ means by 'It' and 'specified fields' in 'It is triggered by a change to the specified fields in the domain resource only.'\nI've been assuming a re-introspect for a running in-pv or in-image domain only occurs if the introspectVersion changes.  Is that wrong?", "author": "tbarnes-us", "createdAt": "2020-05-27T18:08:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM0NzgzMw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431347833", "bodyText": "Or following a cold restart, as before. We had to increase the cases where we ran introspection for model-in-image, but that was not supposed to affect in-pv or image.", "author": "rjeberhard", "createdAt": "2020-05-27T18:14:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM0OTE0MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431349140", "bodyText": "I know what he might mean. There was a question about how and when changes to the distribution strategy field itself should be activated. Since we proposed that the distribution strategy would be realized as an env. variable in the server container then the active distribution strategy would be the value set when a given pod was started.", "author": "rjeberhard", "createdAt": "2020-05-27T18:17:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1OTc4Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431359783", "bodyText": "So, back to my original comment in this thread, is it valid?", "author": "tbarnes-us", "createdAt": "2020-05-27T18:36:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ1OTc0Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431459747", "bodyText": "We tell customers about introspection, so we can reference that.  How about... \"The strategy for how configuration overrides are distributed to WebLogic servers following introspection. Configuration overrides are generated during introspection from secrets, the overrideConfigMap field, and WebLogic domain topology. Legal values are DYNAMIC and ON_RESTART.\"", "author": "rjeberhard", "createdAt": "2020-05-27T21:43:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3MDU5Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431470596", "bodyText": "Ah, so simply changing the domain spec to reference a different override config map will not  have any effect until the next introspection?", "author": "russgold", "createdAt": "2020-05-27T22:08:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3MzI5Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431473297", "bodyText": "That's correct.  It's also intentional here since the customer will likely make coordinating changes to secrets, the input overrides config map, and even domain topology (using online WLST) and so we only want to do introspection when the customer is ready.", "author": "rjeberhard", "createdAt": "2020-05-27T22:14:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NDI2Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431474263", "bodyText": "What about changing the distribution strategy? Should that force the pods to roll? Currently (in this change) it does, which seems troubling.\nSo it sounds to me as though what we're now calling the domain config map is the one which contains the generated overrides, as opposed to the overrideConfigMap, which contains information for describing the overrides. Where can I find more information on the contents of those maps?\nI've tried to be specific about the effects of this feature by writing up a testing JIRA https://jira.****/jira/browse/OWLS-82325. I think that may be the best way to communicate about it, and based on what you've just said, it's wrong.\nThat suggests that we're back to wanting the operator to take an action to prod the pods into copying the override configuration on introspection, rather than giving them an envVar up front to control liveness processing. Can we use a k8s exec to start a script that will run for some reasonable time, watching for the change? Or can we schedule a k8s exec command for some time after the introspection but long enough that the generated configuration overrides should have become available on the pods?", "author": "russgold", "createdAt": "2020-05-27T22:17:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NTI3OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431475279", "bodyText": "Yes, I agree that changing the distribution strategy should not cause the pods to roll. I'd prefer a behavior like, \"the active distribution strategy is the distribution strategy configured when the server was started.\"  We have the same behavior for the shutdown-related options.", "author": "rjeberhard", "createdAt": "2020-05-27T22:19:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ5NzM4NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431497384", "bodyText": "Ah. The distinction between podModel and podRecipe. I'd forgotten that.", "author": "russgold", "createdAt": "2020-05-27T23:22:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxMDIwMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431510201", "bodyText": "\"So it sounds to me as though what we're now calling the domain config map is the one which contains the generated overrides, as opposed to the overrideConfigMap, which contains information for describing the overrides. \"   Again, calling it 'domain config map' is quite confusing name IMO, for the reasons I stated in the other thread.    How about 'introspector config map, which contains output from the introspector, as opposed to the override and model config maps, which are inputs to the introspector'.", "author": "tbarnes-us", "createdAt": "2020-05-28T00:04:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxMTUyNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431511527", "bodyText": "Ryan:  How about  \"The strategy for how configuration overrides are distributed to WebLogic servers following introspection. Configuration overrides are generated during introspection from secrets, the overrideConfigMap field, and WebLogic domain topology. Legal values are DYNAMIC and ON_RESTART.\"\nSounds good to me.  Please also add:   \"The default is WHATEVER.\"   And  please also use the same wording in the other locations that describe the new field.", "author": "tbarnes-us", "createdAt": "2020-05-28T00:09:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxNTcxNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431515715", "bodyText": "The strategy for configuration override distribution to WebLogic servers following introspection. Configuration overrides are generated during introspection from secrets, the overrideConfigMap field, and WebLogic domain topology. Legal values are DYNAMIC and ON_RESTART. The default value is XXXXX. Changes to the strategy require a full domain restart to take effect.", "author": "tbarnes-us", "createdAt": "2020-05-28T00:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4ODQ3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4OTYzNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431289637", "bodyText": "All descriptions for 'introspectVersion' should also have something like 'See also 'distributionStrategy'.'.", "author": "tbarnes-us", "createdAt": "2020-05-27T16:45:06Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -183,6 +183,14 @@\n           \"description\": \"Model in image model files and properties.\",\n           \"$ref\": \"#/definitions/Model\"\n         },\n+        \"distributionStrategy\": {\n+          \"description\": \"The strategy for handling changes to the secrets or overridesConfigMap fields. Legal values are DYNAMIC and ON_RESTART.\",\n+          \"type\": \"string\",\n+          \"enum\": [", "originalCommit": "20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NjM3Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431296376", "bodyText": "This is a confusing rename IMO.\nWe have at least four config maps:   'Scripts' configmap deployed per namespace, Introspector Output per domain, Optional Custom Situational Config Input per domain, and Optional Model Input per domain.\nThis change renames situational to 'Domain' which is a bit confusing because (a) both Situational and Model are both domain scoped, and (b) the namespaced cm is called 'weblogic-domain-cm'.", "author": "tbarnes-us", "createdAt": "2020-05-27T16:54:14Z", "path": "operator/src/main/java/oracle/kubernetes/operator/DomainProcessorImpl.java", "diffHunk": "@@ -675,7 +675,7 @@ Step createDomainUpPlan(DomainPresenceInfo info) {\n \n     return Step.chain(\n           createDomainUpInitialStep(info),\n-          ConfigMapHelper.readExistingSituConfigMap(info.getNamespace(), info.getDomainUid()),\n+          ConfigMapHelper.readExistingDomainConfigMap(info.getNamespace(), info.getDomainUid()),", "originalCommit": "20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5ODE4MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431298180", "bodyText": "Suggested nomenclature:   Model, Situational, Introspector, Scripts ???", "author": "tbarnes-us", "createdAt": "2020-05-27T16:56:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NjM3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMxOTM4NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431319384", "bodyText": "@rjeberhard noted that the config map in question started with just situation config, but now can includes other elements. It's worth bringing up again, though, if it's confusing.", "author": "russgold", "createdAt": "2020-05-27T17:31:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NjM3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ2Mjg3Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431462873", "bodyText": "There are input config maps, but this is the one generated per-domain config map, correct? The changed name here seems okay to me.", "author": "rjeberhard", "createdAt": "2020-05-27T21:49:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NjM3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxMjk1Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431512953", "bodyText": "It's not OK by me - i find it quite confusing.  The 'script' config map is literally named 'weblogic-domain-cm' but the domain cm is not the 'script' config map.   The domain config map is the introspector config map.  I find this all very confusing. Why not simply call it the introspector config map?  It's contents mirror the contents of the introspector output?  And the name of the config map in k8s has the keyword 'introspectsor' right in it.", "author": "tbarnes-us", "createdAt": "2020-05-28T00:14:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NjM3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4OTU2NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r436189565", "bodyText": "Looks like this was fixed.", "author": "tbarnes-us", "createdAt": "2020-06-05T22:19:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NjM3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMwMTg3NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431301875", "bodyText": "Does this trace have a side effect on eventing/logging?  This will be called every 10 seconds, which seems distracting if so.    Maybe only trace at line 38 (just before the cp) to only trace when copying a change over?", "author": "tbarnes-us", "createdAt": "2020-05-27T17:02:02Z", "path": "operator/src/main/resources/scripts/livenessProbe.sh", "diffHunk": "@@ -7,6 +7,49 @@\n # the pod should be restarted. The script checks a WebLogic Server state file which\n # is updated by the node manager.\n \n+function copySitCfgWhileRunning() {\n+  # Helper fn to copy sit cfg xml files to the WL server's domain home.\n+  #   - params $1/$2/$3 == 'src_dir tgt_dir fil_prefix'\n+  #   - $src_dir files are assumed to start with $fil_prefix and end with .xml\n+  #   - copied $tgt_dir files are stripped of their $fil_prefix\n+  #   - any .xml files in $tgt_dir that are not in $src_dir/$fil_prefix+FILE are deleted\n+  #\n+  # This method is called while the server is already running, see \n+  # 'copySitCfgWhileBooting' in 'startServer.sh' for a similar method that\n+  # is called just before the server boots.\n+  #\n+  # It will do nothing unless the environment variable DYNAMIC_CONFIG_OVERRIDE is set.\n+\n+if [ ! \"${DYNAMIC_CONFIG_OVERRIDE:-notset}\" = notset ]; then\n+    (\n+    shopt -s nullglob  # force file matching 'glob' for loops below to run 0 times if 0 matches\n+    local src_dir=${1?}\n+    local tgt_dir=${2?}\n+    local fil_prefix=${3?}\n+    local local_fname\n+    local tgt_file\n+    trace \"Copying files starting with '$src_dir/$fil_prefix' to '$tgt_dir' without the prefix.\"", "originalCommit": "20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMyMDc5NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431320794", "bodyText": "That's in a loop, isn't it? Wouldn't that result in multiple log messages?", "author": "russgold", "createdAt": "2020-05-27T17:34:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMwMTg3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMyNjA4NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431326084", "bodyText": "The liveness probe is called every  10 seconds.  So this trace will occur every 10 seconds in theory somewhere.   I'm suggesting moving the trace down to the copy - which only occurs when the file in question changed - so yes, multiple log messages, but only when a file changes instead of every 10 seconds...", "author": "tbarnes-us", "createdAt": "2020-05-27T17:43:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMwMTg3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3MTAxNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431471017", "bodyText": "Agreed, although without an opinion on exactly where the trace belongs, as a trace every 10 seconds will overwhelm other logging.", "author": "rjeberhard", "createdAt": "2020-05-27T22:09:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMwMTg3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE5MTU5OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r436191598", "bodyText": "Looks fixed.", "author": "tbarnes-us", "createdAt": "2020-06-05T22:27:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTMwMTg3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxNjc5NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431516795", "bodyText": "Can we consider changing the name to something like 'situationalConfigurationDistributionStrategy'?   The distribution strategy term is very generic - it doesn't let you know what the field is meant for.  Also the generic nature introduces potential conflicts - for example, we'll likely have a 'modelDistributionStrategy' at some point.", "author": "tbarnes-us", "createdAt": "2020-05-28T00:27:48Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -183,6 +183,14 @@\n           \"description\": \"Model in image model files and properties.\",\n           \"$ref\": \"#/definitions/Model\"\n         },\n+        \"distributionStrategy\": {", "originalCommit": "20cba0d40a5ca06899e5cbb0df95c996fcdeadd8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUzOTQxNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431539417", "bodyText": "It's under the configuration element. That should give it the relevant context. If it were at the spec level, I'd agree with you.", "author": "russgold", "createdAt": "2020-05-28T01:55:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxNjc5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU2NzkzNg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r431567936", "bodyText": "I disagree. The configuration element is getting crowded - there are attributes that have nothing to do with the new setting.  And there are attribute(s) that may have there own 'strategy' setting soon enough.", "author": "tbarnes-us", "createdAt": "2020-05-28T03:57:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxNjc5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA1OTM5MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r432059390", "bodyText": "After some discussion:  'overridesDistributionStrategy'.", "author": "tbarnes-us", "createdAt": "2020-05-28T19:09:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUxNjc5NQ=="}], "type": "inlineReview"}, {"oid": "23ea8016d2e58623bdefdf7ae4c22156854fbb53", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/23ea8016d2e58623bdefdf7ae4c22156854fbb53", "message": "Generate trace only on actual copy", "committedDate": "2020-05-28T02:12:15Z", "type": "commit"}, {"oid": "f6207642f1cf8783a88f60ea6dbbeb1eb2b7089a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f6207642f1cf8783a88f60ea6dbbeb1eb2b7089a", "message": "Don't roll pods when distribution strategy changes", "committedDate": "2020-05-28T02:12:37Z", "type": "commit"}, {"oid": "4099ddd208fc49c072a9648c6ceb88d9e41e16f8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4099ddd208fc49c072a9648c6ceb88d9e41e16f8", "message": "Use agreed-upon names", "committedDate": "2020-06-01T15:13:03Z", "type": "commit"}, {"oid": "fe3e09069208084577050841840d77323fd3cd68", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fe3e09069208084577050841840d77323fd3cd68", "message": "Change introspect stand-alone test to use new name 'weblogic-script-cm' instead of 'weblogic-domain-cm'.", "committedDate": "2020-06-01T16:27:00Z", "type": "commit"}, {"oid": "a445eb5b781db1de3190a4facdb5ed55d73edb6a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a445eb5b781db1de3190a4facdb5ed55d73edb6a", "message": "Rename script CM, improve docs", "committedDate": "2020-06-01T17:11:41Z", "type": "commit"}, {"oid": "90a4eef5a17579e0995fbe748fd7c8f20aa46513", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/90a4eef5a17579e0995fbe748fd7c8f20aa46513", "message": "ignore introspectVersion setting for model-in-image domains", "committedDate": "2020-06-01T23:24:00Z", "type": "commit"}, {"oid": "e4cad2298be88ad3eb70ae625b7443e1062eda33", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e4cad2298be88ad3eb70ae625b7443e1062eda33", "message": "Update description of 'introspectVersion' to indicate when it is ignored.", "committedDate": "2020-06-02T13:50:25Z", "type": "commit"}, {"oid": "7ed5a6aa0fbb8cfe94281a5fcd1918df8e02af8e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7ed5a6aa0fbb8cfe94281a5fcd1918df8e02af8e", "message": "update descriptions", "committedDate": "2020-06-02T18:50:57Z", "type": "commit"}, {"oid": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "message": "update description further", "committedDate": "2020-06-02T20:40:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxMzk1Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435413953", "bodyText": "Typo missing space after the period  -> \".  Legal values are DYNAMIC (the default) and ON_RESTART.\"", "author": "mriccell", "createdAt": "2020-06-04T17:06:32Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -95,6 +95,7 @@ An element representing a cluster in the domain configuration.\n | `introspectorJobActiveDeadlineSeconds` | number | The introspector job timeout value in seconds. If this field is specified it overrides the Operator's config map data.introspectorJobActiveDeadlineSeconds value. |\n | `model` | [Model](#model) | Model in image model files and properties. |\n | `opss` | [Opss](#opss) | Configuration for OPSS security. |\n+| `overrideDistributionStrategy` | string | Determines how updated configuration overrides are distributed to already running WebLogic servers following introspection when the domainHomeSourceType is PersistentVolume or Image.  Configuration overrides are generated during introspection from secrets, the overrideConfigMap field, and WebLogic domain topology.Legal values are DYNAMIC (the default) and ON_RESTART. |", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNDcyNg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435414726", "bodyText": "Typo missing space after the period -> \". Legal values are DYNAMIC (the default) and ON_RESTART.\"", "author": "mriccell", "createdAt": "2020-06-04T17:07:53Z", "path": "docs/domains/index.html", "diffHunk": "@@ -1095,6 +1095,14 @@\n     \"Configuration\": {\n       \"type\": \"object\",\n       \"properties\": {\n+        \"overrideDistributionStrategy\": {\n+          \"description\": \"Determines how updated configuration overrides are distributed to already running WebLogic servers following introspection when the domainHomeSourceType is PersistentVolume or Image.  Configuration overrides are generated during introspection from secrets, the overrideConfigMap field, and WebLogic domain topology.Legal values are DYNAMIC (the default) and ON_RESTART.\",", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNTUxNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435415517", "bodyText": "Typo missing space after the period -> \".  This field is ignored when the domainHomeSourceType source type is FromModel.\"", "author": "mriccell", "createdAt": "2020-06-04T17:09:18Z", "path": "docs/domains/index.html", "diffHunk": "@@ -1279,7 +1287,7 @@\n           \"type\": \"string\"\n         },\n         \"introspectVersion\": {\n-          \"description\": \"If present, every time this value is updated, the operator will start introspect domain job\",\n+          \"description\": \"If the domain is running, the operator will restart its introspector job when this value is changed.This field is ignored when the domainHomeSourceType source type is FromModel.\",", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNTk5Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435415997", "bodyText": "Typo missing space after the period -> \". Legal values are DYNAMIC (the default) and ON_RESTART.\"", "author": "mriccell", "createdAt": "2020-06-04T17:10:05Z", "path": "kubernetes/crd/domain-crd.yaml", "diffHunk": "@@ -29,6 +29,17 @@ spec:\n                 type: object\n                 description: Models and overrides affecting the WebLogic domain configuration.\n                 properties:\n+                  overrideDistributionStrategy:\n+                    type: string\n+                    description: Determines how updated configuration overrides are\n+                      distributed to already running WebLogic servers following introspection\n+                      when the domainHomeSourceType is PersistentVolume or Image.  Configuration\n+                      overrides are generated during introspection from secrets, the\n+                      overrideConfigMap field, and WebLogic domain topology.Legal", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNjM1Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435416353", "bodyText": "Typo missing space after the period -> \". This field is ignored when the domainHomeSourceType source type is FromModel.\"", "author": "mriccell", "createdAt": "2020-06-04T17:10:41Z", "path": "kubernetes/crd/domain-crd.yaml", "diffHunk": "@@ -10861,8 +10872,9 @@ spec:\n                   will restart the required servers.\n               introspectVersion:\n                 type: string\n-                description: If present, every time this value is updated, the operator\n-                  will start introspect domain job\n+                description: If the domain is running, the operator will restart its\n+                  introspector job when this value is changed.This field is ignored", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNjY5Mg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435416692", "bodyText": "Typo missing space after the period -> \". Legal values are DYNAMIC (the default) and ON_RESTART.\"", "author": "mriccell", "createdAt": "2020-06-04T17:11:13Z", "path": "kubernetes/crd/domain-v1beta1-crd.yaml", "diffHunk": "@@ -32,6 +32,17 @@ spec:\n               type: object\n               description: Models and overrides affecting the WebLogic domain configuration.\n               properties:\n+                overrideDistributionStrategy:\n+                  type: string\n+                  description: Determines how updated configuration overrides are\n+                    distributed to already running WebLogic servers following introspection\n+                    when the domainHomeSourceType is PersistentVolume or Image.  Configuration\n+                    overrides are generated during introspection from secrets, the\n+                    overrideConfigMap field, and WebLogic domain topology.Legal values", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNjg3Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435416877", "bodyText": "Typo missing space after the period -> \". This field is ignored when the domainHomeSourceType source type is FromModel.\"", "author": "mriccell", "createdAt": "2020-06-04T17:11:30Z", "path": "kubernetes/crd/domain-v1beta1-crd.yaml", "diffHunk": "@@ -10643,8 +10654,9 @@ spec:\n                 will restart the required servers.\n             introspectVersion:\n               type: string\n-              description: If present, every time this value is updated, the operator\n-                will start introspect domain job\n+              description: If the domain is running, the operator will restart its\n+                introspector job when this value is changed.This field is ignored", "originalCommit": "7ba63924dbf2018ef114fe93cfad4cbe66d70d8a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyNjkyNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435626925", "bodyText": "This file is generated. It looks correct in Git. Why doesn't it look right in the review?!", "author": "russgold", "createdAt": "2020-06-05T00:24:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNjg3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYzODk0Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r435638947", "bodyText": "Could you please check out the branch locally and see if these errors are there?", "author": "russgold", "createdAt": "2020-06-05T01:14:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQxNjg3Nw=="}], "type": "inlineReview"}, {"oid": "97d32c276588ea4fd5234ef1779b31277ffd7041", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/97d32c276588ea4fd5234ef1779b31277ffd7041", "message": "Add misses space before period", "committedDate": "2020-06-05T00:08:40Z", "type": "commit"}, {"oid": "45e03a49287e7802cba62748c6dc3ef765daf99a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/45e03a49287e7802cba62748c6dc3ef765daf99a", "message": "and build the generate docs", "committedDate": "2020-06-05T00:11:03Z", "type": "commit"}, {"oid": "dae65608bdb6f56723c84350e4d2ff6f24d7f069", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dae65608bdb6f56723c84350e4d2ff6f24d7f069", "message": "update index", "committedDate": "2020-06-05T00:20:17Z", "type": "commit"}, {"oid": "3c38cd826c7b08421bf4e2a475af6c84d7e48fc2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3c38cd826c7b08421bf4e2a475af6c84d7e48fc2", "message": "Merge branch 'develop' into owls_823236", "committedDate": "2020-06-05T01:06:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE5MDE5Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1682#discussion_r436190196", "bodyText": "Add \"See also introspectVersion.\"", "author": "tbarnes-us", "createdAt": "2020-06-05T22:21:41Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -175,6 +175,14 @@\n     \"Configuration\": {\n       \"type\": \"object\",\n       \"properties\": {\n+        \"overrideDistributionStrategy\": {\n+          \"description\": \"Determines how updated configuration overrides are distributed to already running WebLogic servers following introspection when the domainHomeSourceType is PersistentVolume or Image.  Configuration overrides are generated during introspection from secrets, the overrideConfigMap field, and WebLogic domain topology. Legal values are DYNAMIC (the default) and ON_RESTART.\",", "originalCommit": "3c38cd826c7b08421bf4e2a475af6c84d7e48fc2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ce54f038a78973e8ebddb45b030da3e98e8ebc62", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ce54f038a78973e8ebddb45b030da3e98e8ebc62", "message": "Add 'see also'", "committedDate": "2020-06-05T23:44:21Z", "type": "commit"}, {"oid": "e38b1920cd5149e510c86b57603b4660a20d0e3c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e38b1920cd5149e510c86b57603b4660a20d0e3c", "message": "Merge branch 'develop' into owls_823236", "committedDate": "2020-06-07T09:32:08Z", "type": "commit"}]}