{"pr_number": 1860, "pr_title": "Namespace management enhancements", "pr_createdAt": "2020-08-10T21:16:43Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860", "timeline": [{"oid": "f8fe33ce89cbae00d9a665894158f6bd95dae95a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f8fe33ce89cbae00d9a665894158f6bd95dae95a", "message": "Work in progress", "committedDate": "2020-07-22T21:13:40Z", "type": "commit"}, {"oid": "7c420f0028763fda0d3cde89a3cf27af7ccf0698", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7c420f0028763fda0d3cde89a3cf27af7ccf0698", "message": "Work in progess", "committedDate": "2020-07-24T21:06:33Z", "type": "commit"}, {"oid": "32284984c0bf8b7a4a337f1e1781815c05fe8b9c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/32284984c0bf8b7a4a337f1e1781815c05fe8b9c", "message": "Work in progress", "committedDate": "2020-07-28T14:51:04Z", "type": "commit"}, {"oid": "65e9fe20a03d35c09444e1ab320cdeef98171135", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/65e9fe20a03d35c09444e1ab320cdeef98171135", "message": "List, Dedicated working", "committedDate": "2020-07-29T19:39:55Z", "type": "commit"}, {"oid": "2daa4183fe4eff6a352fb66e3320183f6226b758", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2daa4183fe4eff6a352fb66e3320183f6226b758", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-07-30T13:16:56Z", "type": "commit"}, {"oid": "1b9f269461f5b18009e5b27a60e10bb00ae3741c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1b9f269461f5b18009e5b27a60e10bb00ae3741c", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-07-30T18:19:24Z", "type": "commit"}, {"oid": "a4608c3ea72a4d0aa74f13235837333b35806891", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a4608c3ea72a4d0aa74f13235837333b35806891", "message": "Update chart build", "committedDate": "2020-07-30T18:44:11Z", "type": "commit"}, {"oid": "b0eec347340576687e57b1528e06e9f690a09b54", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b0eec347340576687e57b1528e06e9f690a09b54", "message": "Use enableClusterRoleBinding", "committedDate": "2020-07-30T21:44:29Z", "type": "commit"}, {"oid": "278dd0e54c71adf66ff26a316a5ba52d06362db8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/278dd0e54c71adf66ff26a316a5ba52d06362db8", "message": "Use lookup", "committedDate": "2020-07-31T14:31:18Z", "type": "commit"}, {"oid": "8dd1487a272bd79e475b8ae86c58e93f0ac5491e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8dd1487a272bd79e475b8ae86c58e93f0ac5491e", "message": "Preserve debugging", "committedDate": "2020-07-31T21:44:33Z", "type": "commit"}, {"oid": "efb4f4d89181e34ddecfbac3a74af06c786d6771", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/efb4f4d89181e34ddecfbac3a74af06c786d6771", "message": "Complete label selector", "committedDate": "2020-08-03T12:43:52Z", "type": "commit"}, {"oid": "c138de32d26cee707043a8a1c406d239e0c06418", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c138de32d26cee707043a8a1c406d239e0c06418", "message": "Correct typos", "committedDate": "2020-08-03T14:56:57Z", "type": "commit"}, {"oid": "33bf34a29063a3898ceeb3a13ef418f0eb8efa0d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/33bf34a29063a3898ceeb3a13ef418f0eb8efa0d", "message": "Debugging", "committedDate": "2020-08-03T22:02:25Z", "type": "commit"}, {"oid": "c1305b4fd254ebc07dd039d37a60a008dfa6ad49", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c1305b4fd254ebc07dd039d37a60a008dfa6ad49", "message": "More working", "committedDate": "2020-08-03T22:23:36Z", "type": "commit"}, {"oid": "14f234c38b604a861efb4f11469c25a0b3fc331e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/14f234c38b604a861efb4f11469c25a0b3fc331e", "message": "Debugging more complicated label selectors", "committedDate": "2020-08-04T12:37:09Z", "type": "commit"}, {"oid": "6c3095bfe30f36e2cb61fe2aa9be8e46747e817b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6c3095bfe30f36e2cb61fe2aa9be8e46747e817b", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-08-04T15:21:31Z", "type": "commit"}, {"oid": "8ef9874b30af6612eab80776e3465f436f7f7f5f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8ef9874b30af6612eab80776e3465f436f7f7f5f", "message": "Update chart build", "committedDate": "2020-08-04T15:34:24Z", "type": "commit"}, {"oid": "02ed9ca3f9318ef5f1d9c7978235568f5e117418", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/02ed9ca3f9318ef5f1d9c7978235568f5e117418", "message": "Update chart build", "committedDate": "2020-08-04T16:19:08Z", "type": "commit"}, {"oid": "3727e53d1dd765fd6b2f9717f770066e2240311e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3727e53d1dd765fd6b2f9717f770066e2240311e", "message": "Begin updating samples", "committedDate": "2020-08-04T21:29:12Z", "type": "commit"}, {"oid": "df3b56135ee0aab22866e3912bb98b35cc2e8de0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/df3b56135ee0aab22866e3912bb98b35cc2e8de0", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-08-04T21:44:33Z", "type": "commit"}, {"oid": "e95e172a78a4b192b39ccd1b3c963adabbf8916a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e95e172a78a4b192b39ccd1b3c963adabbf8916a", "message": "Documentation work", "committedDate": "2020-08-05T22:50:02Z", "type": "commit"}, {"oid": "02e9567dc34ef8b470bba32e78cde1315b50451d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/02e9567dc34ef8b470bba32e78cde1315b50451d", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-08-05T22:50:18Z", "type": "commit"}, {"oid": "09b66b883b41542bb663aee7f0742ff0c81b1f27", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/09b66b883b41542bb663aee7f0742ff0c81b1f27", "message": "Update charts", "committedDate": "2020-08-05T22:54:27Z", "type": "commit"}, {"oid": "5b6ecf2eade8115edf6162ed2633b1288f3c22a3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5b6ecf2eade8115edf6162ed2633b1288f3c22a3", "message": "Complete doc. updates", "committedDate": "2020-08-10T12:31:57Z", "type": "commit"}, {"oid": "441620cab0c19ef8e1b767f09c840e537191a50a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/441620cab0c19ef8e1b767f09c840e537191a50a", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-08-10T12:50:09Z", "type": "commit"}, {"oid": "7df031c48af7b98fa3f30854d4ec37d46b2c7cbc", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7df031c48af7b98fa3f30854d4ec37d46b2c7cbc", "message": "Additional unit tests", "committedDate": "2020-08-10T21:12:51Z", "type": "commit"}, {"oid": "f61097c0a5db04c78ab042367fcf7b205cf450cd", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f61097c0a5db04c78ab042367fcf7b205cf450cd", "message": "Add additional mementos", "committedDate": "2020-08-10T21:48:39Z", "type": "commit"}, {"oid": "4377dcef55a4685aecf16b03b8abc79156886db5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4377dcef55a4685aecf16b03b8abc79156886db5", "message": "Test code to diagnose build failure on Jenkins", "committedDate": "2020-08-10T22:08:45Z", "type": "commit"}, {"oid": "6855ca49fc420e5a964211c95a9b077599b53a93", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6855ca49fc420e5a964211c95a9b077599b53a93", "message": "More debug code", "committedDate": "2020-08-10T22:13:05Z", "type": "commit"}, {"oid": "c22e97ebe5718e9c4d29428c512f6f74573bc280", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c22e97ebe5718e9c4d29428c512f6f74573bc280", "message": "More debug code", "committedDate": "2020-08-10T22:23:44Z", "type": "commit"}, {"oid": "af7d21f8775aa6d8ff9019c2e20c02e6fc332af3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/af7d21f8775aa6d8ff9019c2e20c02e6fc332af3", "message": "Hopefully fixed unit tests", "committedDate": "2020-08-11T12:55:19Z", "type": "commit"}, {"oid": "04908fc2a439e5c67232e8f843a4a159cb5f938c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/04908fc2a439e5c67232e8f843a4a159cb5f938c", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-08-11T15:47:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk0MDU5OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r468940599", "bodyText": "Do we default domainNamespaceSelectionStrategy to List?", "author": "alai8", "createdAt": "2020-08-12T00:40:00Z", "path": "docs-source/content/userguide/managing-operators/using-the-operator/using-helm.md", "diffHunk": "@@ -155,21 +125,58 @@ imagePullSecrets:\n - name: \"my-image-pull-secret\"\n ```\n \n-#### WebLogic domain management\n+##### `enableClusterRoleBinding`\n+Specifies whether the roles necessary for the operator to manage domains\n+will be granted using a ClusterRoleBinding rather than using RoleBindings in each managed namespace.\n \n-##### `domainNamespaces`\n+Defaults to `false`.\n+\n+This option greatly simplifies managing namespaces when the selection is done using label selectors or\n+regular expressions as the operator will already have privilege in any namespace.\n \n-Specifies a list of WebLogic domain namespaces which the operator manages. The names must be lower case. You are responsible for creating these namespaces.\n+Customers who deploy the operator in Kubernetes clusters that run unrelated workloads will likely\n+not want to use enable this option.\n \n-This property is required.\n+If `enableClusterRoleBinding` is `false` and you select namespaces that the operator will\n+manage using label selectors or a regular expression, then the Helm release will only include\n+RoleBindings in each namespace that match at the time the Helm release is created. If you later\n+create namespaces that the operator should manage, the new namespaces will not yet have the necessary\n+RoleBinding.\n+\n+You can correct this by upgrading the Helm release and reusing values:\n+```\n+$ helm upgrade \\\n+  --reuse-values \\\n+  weblogic-operator \\\n+  kubernetes/charts/weblogic-operator\n+```\n+\n+#### WebLogic domain management\n+\n+##### `domainNamespaceSelectionStrategy`\n+Specifies how the operator will select the set of namespaces that it will manage. \n+Legal values are: `List`, `LabelSelector`, `RegExp`, and `Dedicated`. If set to `List`,\n+then the operator will manage the set of namespaces listed by the `domainNamespaces` value.\n+If set to `LabelSelector`, then the operator will manage the set of namespaces discovered by a list\n+of namespaces using the value specified by `domainNamespaceLabelSelector` as a label selector.\n+If set to `RegExp`, then the operator will manage the set of namespaces discovered by a list\n+of namespaces using the value specified by `domainNamespaceRegExp` as a regular expression matched\n+against the namespace names.\n+Finally, if set to `Dedicated`, then operator will manage WebLogic Domains only in the same namespace\n+which the operator itself is deployed, which is the namespace of the Helm release.", "originalCommit": "04908fc2a439e5c67232e8f843a4a159cb5f938c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTIyNTc5NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469225794", "bodyText": "Yes, domainNamespaceSelectionStrategy defaults to List. I'll mention that here.", "author": "rjeberhard", "createdAt": "2020-08-12T12:34:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk0MDU5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI5Mzc4Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469293787", "bodyText": "I've updated the documentation to describe the default.", "author": "rjeberhard", "createdAt": "2020-08-12T14:17:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk0MDU5OQ=="}], "type": "inlineReview"}, {"oid": "fca48c3d90752f4520194341d42404028a3c2cf4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fca48c3d90752f4520194341d42404028a3c2cf4", "message": "Merge remote-tracking branch 'origin/develop' into owls-82046", "committedDate": "2020-08-12T13:34:46Z", "type": "commit"}, {"oid": "0c469785f7f75306654352385546d9bb8bd6e4d5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0c469785f7f75306654352385546d9bb8bd6e4d5", "message": "Review comment", "committedDate": "2020-08-12T14:16:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4MDIzOA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469280238", "bodyText": "command line (n), command-line (adj) -> command-line tool", "author": "rosemarymarano", "createdAt": "2020-08-12T13:58:41Z", "path": "docs-source/content/faq/namespace-management.md", "diffHunk": "@@ -49,7 +52,19 @@ logStashImage: logstash:6.6.0\n remoteDebugNodePortEnabled: false\n serviceAccount: default\n suspendOnDebugStartup: false\n+```\n+\n+For operators that select namespaces with a selector, simply list namespaces using that selector:\n+\n+```\n+$ kubectl get ns --selector=\"weblogic-operator=enabled\"\n+```\n+\n+For operators that select namespaces with a regular expression matching the name, you can use a combination of `kubectl`\n+and any command line tool that can process the regular expression, such as `grep`:", "originalCommit": "fca48c3d90752f4520194341d42404028a3c2cf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4NTkwMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469285901", "bodyText": "If you want to limit the operator's privilege to just the set of namespaces that it will manage then -> If you want to limit the operator's privilege to just the set of namespaces that it will manage, then (need a comma before then; also helps readability of this long sentence)", "author": "rosemarymarano", "createdAt": "2020-08-12T14:06:39Z", "path": "docs-source/content/quickstart/install.md", "diffHunk": "@@ -67,15 +48,20 @@ $ helm install traefik-operator traefik/traefik \\\n \n 3.  Use `helm` to install and start the operator from the directory you just cloned:\t \n \n-\n     ```bash\n     $ helm install sample-weblogic-operator kubernetes/charts/weblogic-operator \\\n       --namespace sample-weblogic-operator-ns \\\n-      --set image=oracle/weblogic-kubernetes-operator:3.0.0 \\\n+      --set image=oracle/weblogic-kubernetes-operator:3.1.0 \\\n       --set serviceAccount=sample-weblogic-operator-sa \\\n-      --set \"domainNamespaces={}\" \\\n+      --set \"enableClusterRoleBinding=true\" \\\n+      --set \"domainNamespaceSelectionStrategy=LabelSelector\" \\\n+      --set \"domainNamespaceLabelSelector=weblogic-operator\\=enabled\" \\\n       --wait\n     ```\n+    \n+    This Helm release deploys the operator and configures it to manage Domains in any Kubernetes namespace with the label, \"weblogic-operator=enabled\". Because of the \"enableClusterRoleBinding\" option, the operator will have privilege in all Kubernetes namespaces. This simplifies adding and removing managed namespaces as you will only have to adjust labels on those namespaces. If you want to limit the operator's privilege to just the set of namespaces that it will manage then remove this option, but this will mean that the operator only has privilege in the set of namespaces that match the selection strategy at the time the Helm release was installed or upgraded.", "originalCommit": "fca48c3d90752f4520194341d42404028a3c2cf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4OTUzNg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469289536", "bodyText": "not want to use enable this option -> not want to use this option", "author": "rosemarymarano", "createdAt": "2020-08-12T14:11:59Z", "path": "docs-source/content/userguide/managing-operators/using-the-operator/using-helm.md", "diffHunk": "@@ -155,21 +125,58 @@ imagePullSecrets:\n - name: \"my-image-pull-secret\"\n ```\n \n-#### WebLogic domain management\n+##### `enableClusterRoleBinding`\n+Specifies whether the roles necessary for the operator to manage domains\n+will be granted using a ClusterRoleBinding rather than using RoleBindings in each managed namespace.\n \n-##### `domainNamespaces`\n+Defaults to `false`.\n+\n+This option greatly simplifies managing namespaces when the selection is done using label selectors or\n+regular expressions as the operator will already have privilege in any namespace.\n \n-Specifies a list of WebLogic domain namespaces which the operator manages. The names must be lower case. You are responsible for creating these namespaces.\n+Customers who deploy the operator in Kubernetes clusters that run unrelated workloads will likely\n+not want to use enable this option.", "originalCommit": "fca48c3d90752f4520194341d42404028a3c2cf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI5MTY3MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469291671", "bodyText": "If ...., then the operator (If/then construct)", "author": "rosemarymarano", "createdAt": "2020-08-12T14:14:53Z", "path": "docs-source/content/userguide/managing-operators/using-the-operator/using-helm.md", "diffHunk": "@@ -188,8 +195,73 @@ This value is ignored if `dedicated` is set to `true`. Then, the operator will m\n \n For more information about managing `domainNamespaces`, see [Managing domain namespaces]({{< relref \"/faq/namespace-management.md\" >}}).\n \n-##### `domainPresenceFailureRetryMaxCount` and `domainPresenceFailureRetrySeconds`\n+##### `domainNamespaceLabelSelector`\n+Specifies a [label selector](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors) that will be used when searching for namespaces that the operator will manage.\n+The operator will only manage Domains found in namespaces matching this selector.\n+This value is required if `domainNamespaceSelectionStrategy` is `LabelSelector` and ignored otherwise.\n+\n+If `enableClusterRoleBinding` is `false`, the Helm chart will create RoleBindings in each namespace that matches the selector.\n+These RoleBindings give the operator's service account the necessary privileges in the namespace. The Helm chart will only create\n+these RoleBindings in namespaces that match the label selector at the time the chart is installed. If you later create namespaces\n+that match the selector or label existing namespaces that make them now match the selector, the operator will not have", "originalCommit": "fca48c3d90752f4520194341d42404028a3c2cf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwMjIzNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469302237", "bodyText": "expression then -> expression, then", "author": "rosemarymarano", "createdAt": "2020-08-12T14:29:06Z", "path": "docs-source/content/userguide/managing-operators/using-the-operator/using-helm.md", "diffHunk": "@@ -188,8 +195,73 @@ This value is ignored if `dedicated` is set to `true`. Then, the operator will m\n \n For more information about managing `domainNamespaces`, see [Managing domain namespaces]({{< relref \"/faq/namespace-management.md\" >}}).\n \n-##### `domainPresenceFailureRetryMaxCount` and `domainPresenceFailureRetrySeconds`\n+##### `domainNamespaceLabelSelector`\n+Specifies a [label selector](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors) that will be used when searching for namespaces that the operator will manage.\n+The operator will only manage Domains found in namespaces matching this selector.\n+This value is required if `domainNamespaceSelectionStrategy` is `LabelSelector` and ignored otherwise.\n+\n+If `enableClusterRoleBinding` is `false`, the Helm chart will create RoleBindings in each namespace that matches the selector.\n+These RoleBindings give the operator's service account the necessary privileges in the namespace. The Helm chart will only create\n+these RoleBindings in namespaces that match the label selector at the time the chart is installed. If you later create namespaces\n+that match the selector or label existing namespaces that make them now match the selector, the operator will not have\n+privilege in these namespaces until you upgrade the Helm release.\n+\n+Example 1: In the configuration below, the operator will manage namespaces that have the label \"weblogic-operator\"\n+regardless of the value of that label:\n+```\n+domainNamespaceLabelSelector: weblogic-operator\n+```\n+\n+Example 2: In the configuration below, the operator will manage all namespaces that have the label \"environment\",\n+but where the value of that label is not \"production\" or \"systemtest\":\n+```\n+domainNamespaceLabelSelector: environment notin (production,systemtest)\n+```\n+\n+{{% notice note %}}\n+To specify the above sample on the Helm command line, escape spaces and commas as follows:\n+```\n+--set \"domainNamespaceLabelSelector=environment\\\\ notin\\\\ (production\\\\,systemtest)\"\n+```\n+{{% /notice %}}\n+\n+##### `domainNamespaceRegExp`\n+Specifies a regular expression that will be used when searching for namespaces that the operator will manage.\n+The operator will only manage Domains found in namespaces matching this regular expression.\n+This value is required if `domainNamespaceSelectionStrategy` is `RegExp` and ignored otherwise.\n+\n+If `enableClusterRoleBinding` is `false`, the Helm chart will create RoleBindings in each namespace that matches the regular expression.\n+These RoleBindings give the operator's service account the necessary privileges in the namespace. The Helm chart will only create\n+these RoleBindings in namespaces that match the regular expression at the time the chart is installed. If you later create namespaces\n+that match the selector or label existing namespaces that make them now match the selector, the operator will not have\n+privilege in these namespaces until you upgrade the Helm release.\n+\n+{{% notice note %}}\n+The regular expression functionality included with Helm is restricted to linear time constructs and,\n+in particular, does not support lookarounds. The operator, written in Java, supports these\n+complicated expressions. If you need to use a complex regular expression then either set", "originalCommit": "fca48c3d90752f4520194341d42404028a3c2cf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6c35497f86913daf926c19b15b9406849670a0ab", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6c35497f86913daf926c19b15b9406849670a0ab", "message": "Review comments", "committedDate": "2020-08-12T15:03:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTM3MTIwMg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469371202", "bodyText": "can the regexp be invalid, and Pattern.compile(regexp) may throw PatternSyntaxException? Perhaps it has been validated elsewhere that I missed.", "author": "alai8", "createdAt": "2020-08-12T16:02:02Z", "path": "operator/src/main/java/oracle/kubernetes/operator/Main.java", "diffHunk": "@@ -929,31 +1025,57 @@ public NextAction onSuccess(Packet packet, CallResponse<V1NamespaceList> callRes\n       String intialResourceVersion = getInitialResourceVersion(result);\n       List<String> nsList = getExistingNamespaces(result);\n       \n-      Set<String> namespacesToStart = new TreeSet<>(targetNamespaces);\n-      for (String ns : targetNamespaces) {\n-        if (!nsList.contains(ns)) {\n-          try (LoggingContext stack = LoggingContext.setThreadContext().namespace(ns)) {\n-            LOGGER.warning(MessageKeys.NAMESPACE_IS_MISSING, ns);\n+      Set<String> namespacesToStart;\n+      if (selectionStrategy.isRequireList()) {\n+        namespacesToStart = new TreeSet<>(nsList);\n+        String regexp = selectionStrategy.getRegExp();\n+        if (regexp != null) {\n+          namespacesToStart = namespacesToStart.stream().filter(\n+                  Pattern.compile(regexp).asPredicate()).collect(Collectors.toSet());", "originalCommit": "6c35497f86913daf926c19b15b9406849670a0ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxOTY1Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469319656", "bodyText": "Since list is the default strategy, should this section be removed for the quick start?", "author": "lennyphan", "createdAt": "2020-08-12T14:52:51Z", "path": "docs-source/content/quickstart/prepare.md", "diffHunk": "@@ -12,16 +12,6 @@ weight: 5\n     $ kubectl create namespace sample-domain1-ns\n     ```\n \n-1.\tUse `helm` to configure the operator to manage domains in this namespace:\n-\n-    ```bash\n-    $ helm upgrade sample-weblogic-operator  kubernetes/charts/weblogic-operator \\\n-        --namespace sample-weblogic-operator-ns \\\n-        --reuse-values \\\n-        --set \"domainNamespaces={sample-domain1-ns}\" \\\n-        --wait\n-    ```\n-", "originalCommit": "0c469785f7f75306654352385546d9bb8bd6e4d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU0MzI0OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1860#discussion_r469543248", "bodyText": "List is the default if you don't specify a strategy, but I've updated the quick start to specify the LabelSelector strategy. In the namespace management guide, I've preserved the description of updating the domainNamespaces value in the List section.", "author": "rjeberhard", "createdAt": "2020-08-12T20:59:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxOTY1Ng=="}], "type": "inlineReview"}, {"oid": "2677f1ffffc89f0ebd46958fc18d3bca581543ad", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2677f1ffffc89f0ebd46958fc18d3bca581543ad", "message": "Review comments", "committedDate": "2020-08-12T21:54:07Z", "type": "commit"}]}